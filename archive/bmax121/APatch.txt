Project Path: arc_bmax121_APatch_07zb8yap

Source Tree:

```txt
arc_bmax121_APatch_07zb8yap
├── LICENSE
├── README.md
├── apd
│   ├── Cargo.lock
│   ├── Cargo.toml
│   ├── build.rs
│   └── src
│       ├── apd.rs
│       ├── assets.rs
│       ├── banner
│       ├── cli.rs
│       ├── defs.rs
│       ├── event.rs
│       ├── installer.sh
│       ├── installer_bind.sh
│       ├── lua.rs
│       ├── main.rs
│       ├── metamodule.rs
│       ├── module.rs
│       ├── package.rs
│       ├── pty.rs
│       ├── restorecon.rs
│       ├── sepolicy.rs
│       ├── supercall.rs
│       └── utils.rs
├── app
│   ├── build.gradle.kts
│   ├── libs
│   │   └── arm64-v8a
│   │       ├── libbootctl.so
│   │       ├── libbusybox.so
│   │       ├── libmagiskpolicy.so
│   │       └── libresetprop.so
│   ├── proguard-rules.pro
│   └── src
│       └── main
│           ├── AndroidManifest.xml
│           ├── aidl
│           │   └── me
│           │       └── bmax
│           │           └── apatch
│           │               └── IAPRootService.aidl
│           ├── assets
│           │   ├── InstallAP.sh
│           │   ├── UninstallAP.sh
│           │   ├── boot_extract.sh
│           │   ├── boot_patch.sh
│           │   ├── boot_unpatch.sh
│           │   └── util_functions.sh
│           ├── cpp
│           │   ├── CMakeLists.txt
│           │   ├── apjni.cpp
│           │   ├── apjni.hpp
│           │   ├── jni_helper.hpp
│           │   ├── supercall.h
│           │   ├── type_traits.hpp
│           │   ├── uapi
│           │   │   └── scdefs.h
│           │   └── version
│           ├── ic_launcher-playstore.png
│           ├── java
│           │   └── me
│           │       └── bmax
│           │           └── apatch
│           │               ├── APatchApp.kt
│           │               ├── Natives.kt
│           │               ├── services
│           │               │   └── RootServices.java
│           │               ├── ui
│           │               │   ├── CrashHandleActivity.kt
│           │               │   ├── MainActivity.kt
│           │               │   ├── WebUIActivity.kt
│           │               │   ├── component
│           │               │   │   ├── Dialog.kt
│           │               │   │   ├── DropdownMenu.kt
│           │               │   │   ├── KeyEventBlocker.kt
│           │               │   │   ├── ModuleCardComponents.kt
│           │               │   │   ├── SearchBar.kt
│           │               │   │   ├── SettingsItem.kt
│           │               │   │   └── WarningCard.kt
│           │               │   ├── screen
│           │               │   │   ├── APM.kt
│           │               │   │   ├── AboutScreen.kt
│           │               │   │   ├── BottomBarDestination.kt
│           │               │   │   ├── ExecuteAPMAction.kt
│           │               │   │   ├── Home.kt
│           │               │   │   ├── Install.kt
│           │               │   │   ├── InstallModeSelect.kt
│           │               │   │   ├── KPM.kt
│           │               │   │   ├── Patches.kt
│           │               │   │   ├── Settings.kt
│           │               │   │   └── SuperUser.kt
│           │               │   ├── theme
│           │               │   │   ├── AmberTheme.kt
│           │               │   │   ├── BlueGreyTheme.kt
│           │               │   │   ├── BlueTheme.kt
│           │               │   │   ├── BrownTheme.kt
│           │               │   │   ├── CyanTheme.kt
│           │               │   │   ├── DeepOrangeTheme.kt
│           │               │   │   ├── DeepPurpleTheme.kt
│           │               │   │   ├── GreenTheme.kt
│           │               │   │   ├── IndigoTheme.kt
│           │               │   │   ├── LightBlueTheme.kt
│           │               │   │   ├── LightGreenTheme.kt
│           │               │   │   ├── LimeTheme.kt
│           │               │   │   ├── OrangeTheme.kt
│           │               │   │   ├── PinkTheme.kt
│           │               │   │   ├── PurpleTheme.kt
│           │               │   │   ├── RedTheme.kt
│           │               │   │   ├── SakuraTheme.kt
│           │               │   │   ├── TealTheme.kt
│           │               │   │   ├── Theme.kt
│           │               │   │   ├── Type.kt
│           │               │   │   └── YellowTheme.kt
│           │               │   ├── viewmodel
│           │               │   │   ├── APModuleViewModel.kt
│           │               │   │   ├── KPModel.kt
│           │               │   │   ├── KPModuleViewModel.kt
│           │               │   │   ├── PatchesViewModel.kt
│           │               │   │   └── SuperUserViewModel.kt
│           │               │   └── webui
│           │               │       ├── AppIconUtil.kt
│           │               │       ├── Insets.kt
│           │               │       ├── MimeUtil.java
│           │               │       ├── MonetColorsProvider.kt
│           │               │       ├── SuFilePathHandler.java
│           │               │       └── WebViewInterface.kt
│           │               └── util
│           │                   ├── APatchCli.kt
│           │                   ├── APatchKeyHelper.java
│           │                   ├── DeviceInfoUtils.kt
│           │                   ├── Downloader.kt
│           │                   ├── HanziToPinyin.java
│           │                   ├── IOStreamUtils.kt
│           │                   ├── LatestVersionInfo.kt
│           │                   ├── LogEvent.kt
│           │                   ├── PkgConfig.kt
│           │                   ├── Version.kt
│           │                   └── ui
│           │                       ├── APDialogBlurBehindUtils.kt
│           │                       ├── CompositionProvider.kt
│           │                       ├── HyperlinkText.kt
│           │                       └── NavigationBarsSpacer.kt
│           └── res
│               ├── drawable
│               │   ├── device_mobile_down.xml
│               │   ├── github.xml
│               │   ├── ic_launcher_background.xml
│               │   ├── ic_launcher_foreground.xml
│               │   ├── ic_launcher_monochrome.xml
│               │   ├── info_circle_filled.xml
│               │   ├── launcher_splash.xml
│               │   ├── package_import.xml
│               │   ├── play_circle.xml
│               │   ├── settings.xml
│               │   ├── telegram.xml
│               │   ├── trash.xml
│               │   ├── weblate.xml
│               │   └── webui.xml
│               ├── mipmap-anydpi
│               │   └── ic_launcher.xml
│               ├── resources.properties
│               ├── values
│               │   ├── arrays.xml
│               │   ├── ic_launcher_background.xml
│               │   ├── strings.xml
│               │   └── themes.xml
│               ├── values-ab
│               │   └── strings.xml
│               ├── values-apc
│               │   └── strings.xml
│               ├── values-ar
│               │   └── strings.xml
│               ├── values-arq
│               │   └── strings.xml
│               ├── values-az
│               │   └── strings.xml
│               ├── values-bn
│               │   └── strings.xml
│               ├── values-ca
│               │   └── strings.xml
│               ├── values-cs
│               │   └── strings.xml
│               ├── values-da
│               │   └── strings.xml
│               ├── values-de
│               │   └── strings.xml
│               ├── values-el
│               │   └── strings.xml
│               ├── values-es
│               │   └── strings.xml
│               ├── values-fa
│               │   └── strings.xml
│               ├── values-fi
│               │   └── strings.xml
│               ├── values-fil
│               │   └── strings.xml
│               ├── values-fr
│               │   └── strings.xml
│               ├── values-gl
│               │   └── strings.xml
│               ├── values-hr
│               │   └── strings.xml
│               ├── values-hu
│               │   └── strings.xml
│               ├── values-in
│               │   └── strings.xml
│               ├── values-it
│               │   └── strings.xml
│               ├── values-ja
│               │   └── strings.xml
│               ├── values-jv
│               │   └── strings.xml
│               ├── values-ko
│               │   └── strings.xml
│               ├── values-lt
│               │   └── strings.xml
│               ├── values-lv
│               │   └── strings.xml
│               ├── values-ms
│               │   └── strings.xml
│               ├── values-nb-rNO
│               │   └── strings.xml
│               ├── values-night
│               │   └── themes.xml
│               ├── values-nl
│               │   └── strings.xml
│               ├── values-pl
│               │   └── strings.xml
│               ├── values-pt
│               │   └── strings.xml
│               ├── values-pt-rBR
│               │   └── strings.xml
│               ├── values-ro
│               │   └── strings.xml
│               ├── values-ru
│               │   └── strings.xml
│               ├── values-si
│               │   └── strings.xml
│               ├── values-sv
│               │   └── strings.xml
│               ├── values-ta
│               │   └── strings.xml
│               ├── values-th
│               │   └── strings.xml
│               ├── values-tr
│               │   └── strings.xml
│               ├── values-uk
│               │   └── strings.xml
│               ├── values-vi
│               │   └── strings.xml
│               ├── values-zh-rCN
│               │   └── strings.xml
│               ├── values-zh-rTW
│               │   └── strings.xml
│               └── xml
│                   ├── backup_rules.xml
│                   ├── data_extraction_rules.xml
│                   ├── file_paths.xml
│                   └── network_security_config.xml
├── build.gradle.kts
├── docs
│   ├── BG
│   │   └── faq_bg.md
│   ├── ar
│   │   └── faq_ar.md
│   ├── az
│   │   └── faq_az.md
│   ├── cn
│   │   ├── ap_module.md
│   │   └── faq_cn.md
│   ├── cn_tw
│   │   └── faq_cn_tw.md
│   ├── de
│   │   └── faq_de.md
│   ├── en
│   │   └── faq.md
│   ├── es
│   │   └── faq_es.md
│   ├── fr
│   │   └── faq_fr.md
│   ├── id
│   │   └── faq.md
│   ├── it
│   │   └── faq_it.md
│   ├── kr
│   │   └── faq_kr.md
│   ├── pt_br
│   │   └── faq_pt_br.md
│   ├── ru
│   │   └── faq_ru.md
│   ├── tr
│   │   └── faq_tr.md
│   └── uk
│       └── faq_uk.md
├── fastlane
│   └── metadata
│       └── android
│           └── en-US
│               ├── full_description.txt
│               ├── images
│               │   └── icon.png
│               └── short_description.txt
├── gradle
│   ├── libs.versions.toml
│   └── wrapper
│       ├── gradle-wrapper.jar
│       └── gradle-wrapper.properties
├── gradle.properties
├── gradlew
├── gradlew.bat
├── scripts
│   ├── update_binary.sh
│   └── update_script.sh
└── settings.gradle.kts

```

`LICENSE`:

```
                    GNU GENERAL PUBLIC LICENSE
                       Version 3, 29 June 2007

 Copyright (C) 2007 Free Software Foundation, Inc. <https://fsf.org/>
 Everyone is permitted to copy and distribute verbatim copies
 of this license document, but changing it is not allowed.

                            Preamble

  The GNU General Public License is a free, copyleft license for
software and other kinds of works.

  The licenses for most software and other practical works are designed
to take away your freedom to share and change the works.  By contrast,
the GNU General Public License is intended to guarantee your freedom to
share and change all versions of a program--to make sure it remains free
software for all its users.  We, the Free Software Foundation, use the
GNU General Public License for most of our software; it applies also to
any other work released this way by its authors.  You can apply it to
your programs, too.

  When we speak of free software, we are referring to freedom, not
price.  Our General Public Licenses are designed to make sure that you
have the freedom to distribute copies of free software (and charge for
them if you wish), that you receive source code or can get it if you
want it, that you can change the software or use pieces of it in new
free programs, and that you know you can do these things.

  To protect your rights, we need to prevent others from denying you
these rights or asking you to surrender the rights.  Therefore, you have
certain responsibilities if you distribute copies of the software, or if
you modify it: responsibilities to respect the freedom of others.

  For example, if you distribute copies of such a program, whether
gratis or for a fee, you must pass on to the recipients the same
freedoms that you received.  You must make sure that they, too, receive
or can get the source code.  And you must show them these terms so they
know their rights.

  Developers that use the GNU GPL protect your rights with two steps:
(1) assert copyright on the software, and (2) offer you this License
giving you legal permission to copy, distribute and/or modify it.

  For the developers' and authors' protection, the GPL clearly explains
that there is no warranty for this free software.  For both users' and
authors' sake, the GPL requires that modified versions be marked as
changed, so that their problems will not be attributed erroneously to
authors of previous versions.

  Some devices are designed to deny users access to install or run
modified versions of the software inside them, although the manufacturer
can do so.  This is fundamentally incompatible with the aim of
protecting users' freedom to change the software.  The systematic
pattern of such abuse occurs in the area of products for individuals to
use, which is precisely where it is most unacceptable.  Therefore, we
have designed this version of the GPL to prohibit the practice for those
products.  If such problems arise substantially in other domains, we
stand ready to extend this provision to those domains in future versions
of the GPL, as needed to protect the freedom of users.

  Finally, every program is threatened constantly by software patents.
States should not allow patents to restrict development and use of
software on general-purpose computers, but in those that do, we wish to
avoid the special danger that patents applied to a free program could
make it effectively proprietary.  To prevent this, the GPL assures that
patents cannot be used to render the program non-free.

  The precise terms and conditions for copying, distribution and
modification follow.

                       TERMS AND CONDITIONS

  0. Definitions.

  "This License" refers to version 3 of the GNU General Public License.

  "Copyright" also means copyright-like laws that apply to other kinds of
works, such as semiconductor masks.

  "The Program" refers to any copyrightable work licensed under this
License.  Each licensee is addressed as "you".  "Licensees" and
"recipients" may be individuals or organizations.

  To "modify" a work means to copy from or adapt all or part of the work
in a fashion requiring copyright permission, other than the making of an
exact copy.  The resulting work is called a "modified version" of the
earlier work or a work "based on" the earlier work.

  A "covered work" means either the unmodified Program or a work based
on the Program.

  To "propagate" a work means to do anything with it that, without
permission, would make you directly or secondarily liable for
infringement under applicable copyright law, except executing it on a
computer or modifying a private copy.  Propagation includes copying,
distribution (with or without modification), making available to the
public, and in some countries other activities as well.

  To "convey" a work means any kind of propagation that enables other
parties to make or receive copies.  Mere interaction with a user through
a computer network, with no transfer of a copy, is not conveying.

  An interactive user interface displays "Appropriate Legal Notices"
to the extent that it includes a convenient and prominently visible
feature that (1) displays an appropriate copyright notice, and (2)
tells the user that there is no warranty for the work (except to the
extent that warranties are provided), that licensees may convey the
work under this License, and how to view a copy of this License.  If
the interface presents a list of user commands or options, such as a
menu, a prominent item in the list meets this criterion.

  1. Source Code.

  The "source code" for a work means the preferred form of the work
for making modifications to it.  "Object code" means any non-source
form of a work.

  A "Standard Interface" means an interface that either is an official
standard defined by a recognized standards body, or, in the case of
interfaces specified for a particular programming language, one that
is widely used among developers working in that language.

  The "System Libraries" of an executable work include anything, other
than the work as a whole, that (a) is included in the normal form of
packaging a Major Component, but which is not part of that Major
Component, and (b) serves only to enable use of the work with that
Major Component, or to implement a Standard Interface for which an
implementation is available to the public in source code form.  A
"Major Component", in this context, means a major essential component
(kernel, window system, and so on) of the specific operating system
(if any) on which the executable work runs, or a compiler used to
produce the work, or an object code interpreter used to run it.

  The "Corresponding Source" for a work in object code form means all
the source code needed to generate, install, and (for an executable
work) run the object code and to modify the work, including scripts to
control those activities.  However, it does not include the work's
System Libraries, or general-purpose tools or generally available free
programs which are used unmodified in performing those activities but
which are not part of the work.  For example, Corresponding Source
includes interface definition files associated with source files for
the work, and the source code for shared libraries and dynamically
linked subprograms that the work is specifically designed to require,
such as by intimate data communication or control flow between those
subprograms and other parts of the work.

  The Corresponding Source need not include anything that users
can regenerate automatically from other parts of the Corresponding
Source.

  The Corresponding Source for a work in source code form is that
same work.

  2. Basic Permissions.

  All rights granted under this License are granted for the term of
copyright on the Program, and are irrevocable provided the stated
conditions are met.  This License explicitly affirms your unlimited
permission to run the unmodified Program.  The output from running a
covered work is covered by this License only if the output, given its
content, constitutes a covered work.  This License acknowledges your
rights of fair use or other equivalent, as provided by copyright law.

  You may make, run and propagate covered works that you do not
convey, without conditions so long as your license otherwise remains
in force.  You may convey covered works to others for the sole purpose
of having them make modifications exclusively for you, or provide you
with facilities for running those works, provided that you comply with
the terms of this License in conveying all material for which you do
not control copyright.  Those thus making or running the covered works
for you must do so exclusively on your behalf, under your direction
and control, on terms that prohibit them from making any copies of
your copyrighted material outside their relationship with you.

  Conveying under any other circumstances is permitted solely under
the conditions stated below.  Sublicensing is not allowed; section 10
makes it unnecessary.

  3. Protecting Users' Legal Rights From Anti-Circumvention Law.

  No covered work shall be deemed part of an effective technological
measure under any applicable law fulfilling obligations under article
11 of the WIPO copyright treaty adopted on 20 December 1996, or
similar laws prohibiting or restricting circumvention of such
measures.

  When you convey a covered work, you waive any legal power to forbid
circumvention of technological measures to the extent such circumvention
is effected by exercising rights under this License with respect to
the covered work, and you disclaim any intention to limit operation or
modification of the work as a means of enforcing, against the work's
users, your or third parties' legal rights to forbid circumvention of
technological measures.

  4. Conveying Verbatim Copies.

  You may convey verbatim copies of the Program's source code as you
receive it, in any medium, provided that you conspicuously and
appropriately publish on each copy an appropriate copyright notice;
keep intact all notices stating that this License and any
non-permissive terms added in accord with section 7 apply to the code;
keep intact all notices of the absence of any warranty; and give all
recipients a copy of this License along with the Program.

  You may charge any price or no price for each copy that you convey,
and you may offer support or warranty protection for a fee.

  5. Conveying Modified Source Versions.

  You may convey a work based on the Program, or the modifications to
produce it from the Program, in the form of source code under the
terms of section 4, provided that you also meet all of these conditions:

    a) The work must carry prominent notices stating that you modified
    it, and giving a relevant date.

    b) The work must carry prominent notices stating that it is
    released under this License and any conditions added under section
    7.  This requirement modifies the requirement in section 4 to
    "keep intact all notices".

    c) You must license the entire work, as a whole, under this
    License to anyone who comes into possession of a copy.  This
    License will therefore apply, along with any applicable section 7
    additional terms, to the whole of the work, and all its parts,
    regardless of how they are packaged.  This License gives no
    permission to license the work in any other way, but it does not
    invalidate such permission if you have separately received it.

    d) If the work has interactive user interfaces, each must display
    Appropriate Legal Notices; however, if the Program has interactive
    interfaces that do not display Appropriate Legal Notices, your
    work need not make them do so.

  A compilation of a covered work with other separate and independent
works, which are not by their nature extensions of the covered work,
and which are not combined with it such as to form a larger program,
in or on a volume of a storage or distribution medium, is called an
"aggregate" if the compilation and its resulting copyright are not
used to limit the access or legal rights of the compilation's users
beyond what the individual works permit.  Inclusion of a covered work
in an aggregate does not cause this License to apply to the other
parts of the aggregate.

  6. Conveying Non-Source Forms.

  You may convey a covered work in object code form under the terms
of sections 4 and 5, provided that you also convey the
machine-readable Corresponding Source under the terms of this License,
in one of these ways:

    a) Convey the object code in, or embodied in, a physical product
    (including a physical distribution medium), accompanied by the
    Corresponding Source fixed on a durable physical medium
    customarily used for software interchange.

    b) Convey the object code in, or embodied in, a physical product
    (including a physical distribution medium), accompanied by a
    written offer, valid for at least three years and valid for as
    long as you offer spare parts or customer support for that product
    model, to give anyone who possesses the object code either (1) a
    copy of the Corresponding Source for all the software in the
    product that is covered by this License, on a durable physical
    medium customarily used for software interchange, for a price no
    more than your reasonable cost of physically performing this
    conveying of source, or (2) access to copy the
    Corresponding Source from a network server at no charge.

    c) Convey individual copies of the object code with a copy of the
    written offer to provide the Corresponding Source.  This
    alternative is allowed only occasionally and noncommercially, and
    only if you received the object code with such an offer, in accord
    with subsection 6b.

    d) Convey the object code by offering access from a designated
    place (gratis or for a charge), and offer equivalent access to the
    Corresponding Source in the same way through the same place at no
    further charge.  You need not require recipients to copy the
    Corresponding Source along with the object code.  If the place to
    copy the object code is a network server, the Corresponding Source
    may be on a different server (operated by you or a third party)
    that supports equivalent copying facilities, provided you maintain
    clear directions next to the object code saying where to find the
    Corresponding Source.  Regardless of what server hosts the
    Corresponding Source, you remain obligated to ensure that it is
    available for as long as needed to satisfy these requirements.

    e) Convey the object code using peer-to-peer transmission, provided
    you inform other peers where the object code and Corresponding
    Source of the work are being offered to the general public at no
    charge under subsection 6d.

  A separable portion of the object code, whose source code is excluded
from the Corresponding Source as a System Library, need not be
included in conveying the object code work.

  A "User Product" is either (1) a "consumer product", which means any
tangible personal property which is normally used for personal, family,
or household purposes, or (2) anything designed or sold for incorporation
into a dwelling.  In determining whether a product is a consumer product,
doubtful cases shall be resolved in favor of coverage.  For a particular
product received by a particular user, "normally used" refers to a
typical or common use of that class of product, regardless of the status
of the particular user or of the way in which the particular user
actually uses, or expects or is expected to use, the product.  A product
is a consumer product regardless of whether the product has substantial
commercial, industrial or non-consumer uses, unless such uses represent
the only significant mode of use of the product.

  "Installation Information" for a User Product means any methods,
procedures, authorization keys, or other information required to install
and execute modified versions of a covered work in that User Product from
a modified version of its Corresponding Source.  The information must
suffice to ensure that the continued functioning of the modified object
code is in no case prevented or interfered with solely because
modification has been made.

  If you convey an object code work under this section in, or with, or
specifically for use in, a User Product, and the conveying occurs as
part of a transaction in which the right of possession and use of the
User Product is transferred to the recipient in perpetuity or for a
fixed term (regardless of how the transaction is characterized), the
Corresponding Source conveyed under this section must be accompanied
by the Installation Information.  But this requirement does not apply
if neither you nor any third party retains the ability to install
modified object code on the User Product (for example, the work has
been installed in ROM).

  The requirement to provide Installation Information does not include a
requirement to continue to provide support service, warranty, or updates
for a work that has been modified or installed by the recipient, or for
the User Product in which it has been modified or installed.  Access to a
network may be denied when the modification itself materially and
adversely affects the operation of the network or violates the rules and
protocols for communication across the network.

  Corresponding Source conveyed, and Installation Information provided,
in accord with this section must be in a format that is publicly
documented (and with an implementation available to the public in
source code form), and must require no special password or key for
unpacking, reading or copying.

  7. Additional Terms.

  "Additional permissions" are terms that supplement the terms of this
License by making exceptions from one or more of its conditions.
Additional permissions that are applicable to the entire Program shall
be treated as though they were included in this License, to the extent
that they are valid under applicable law.  If additional permissions
apply only to part of the Program, that part may be used separately
under those permissions, but the entire Program remains governed by
this License without regard to the additional permissions.

  When you convey a copy of a covered work, you may at your option
remove any additional permissions from that copy, or from any part of
it.  (Additional permissions may be written to require their own
removal in certain cases when you modify the work.)  You may place
additional permissions on material, added by you to a covered work,
for which you have or can give appropriate copyright permission.

  Notwithstanding any other provision of this License, for material you
add to a covered work, you may (if authorized by the copyright holders of
that material) supplement the terms of this License with terms:

    a) Disclaiming warranty or limiting liability differently from the
    terms of sections 15 and 16 of this License; or

    b) Requiring preservation of specified reasonable legal notices or
    author attributions in that material or in the Appropriate Legal
    Notices displayed by works containing it; or

    c) Prohibiting misrepresentation of the origin of that material, or
    requiring that modified versions of such material be marked in
    reasonable ways as different from the original version; or

    d) Limiting the use for publicity purposes of names of licensors or
    authors of the material; or

    e) Declining to grant rights under trademark law for use of some
    trade names, trademarks, or service marks; or

    f) Requiring indemnification of licensors and authors of that
    material by anyone who conveys the material (or modified versions of
    it) with contractual assumptions of liability to the recipient, for
    any liability that these contractual assumptions directly impose on
    those licensors and authors.

  All other non-permissive additional terms are considered "further
restrictions" within the meaning of section 10.  If the Program as you
received it, or any part of it, contains a notice stating that it is
governed by this License along with a term that is a further
restriction, you may remove that term.  If a license document contains
a further restriction but permits relicensing or conveying under this
License, you may add to a covered work material governed by the terms
of that license document, provided that the further restriction does
not survive such relicensing or conveying.

  If you add terms to a covered work in accord with this section, you
must place, in the relevant source files, a statement of the
additional terms that apply to those files, or a notice indicating
where to find the applicable terms.

  Additional terms, permissive or non-permissive, may be stated in the
form of a separately written license, or stated as exceptions;
the above requirements apply either way.

  8. Termination.

  You may not propagate or modify a covered work except as expressly
provided under this License.  Any attempt otherwise to propagate or
modify it is void, and will automatically terminate your rights under
this License (including any patent licenses granted under the third
paragraph of section 11).

  However, if you cease all violation of this License, then your
license from a particular copyright holder is reinstated (a)
provisionally, unless and until the copyright holder explicitly and
finally terminates your license, and (b) permanently, if the copyright
holder fails to notify you of the violation by some reasonable means
prior to 60 days after the cessation.

  Moreover, your license from a particular copyright holder is
reinstated permanently if the copyright holder notifies you of the
violation by some reasonable means, this is the first time you have
received notice of violation of this License (for any work) from that
copyright holder, and you cure the violation prior to 30 days after
your receipt of the notice.

  Termination of your rights under this section does not terminate the
licenses of parties who have received copies or rights from you under
this License.  If your rights have been terminated and not permanently
reinstated, you do not qualify to receive new licenses for the same
material under section 10.

  9. Acceptance Not Required for Having Copies.

  You are not required to accept this License in order to receive or
run a copy of the Program.  Ancillary propagation of a covered work
occurring solely as a consequence of using peer-to-peer transmission
to receive a copy likewise does not require acceptance.  However,
nothing other than this License grants you permission to propagate or
modify any covered work.  These actions infringe copyright if you do
not accept this License.  Therefore, by modifying or propagating a
covered work, you indicate your acceptance of this License to do so.

  10. Automatic Licensing of Downstream Recipients.

  Each time you convey a covered work, the recipient automatically
receives a license from the original licensors, to run, modify and
propagate that work, subject to this License.  You are not responsible
for enforcing compliance by third parties with this License.

  An "entity transaction" is a transaction transferring control of an
organization, or substantially all assets of one, or subdividing an
organization, or merging organizations.  If propagation of a covered
work results from an entity transaction, each party to that
transaction who receives a copy of the work also receives whatever
licenses to the work the party's predecessor in interest had or could
give under the previous paragraph, plus a right to possession of the
Corresponding Source of the work from the predecessor in interest, if
the predecessor has it or can get it with reasonable efforts.

  You may not impose any further restrictions on the exercise of the
rights granted or affirmed under this License.  For example, you may
not impose a license fee, royalty, or other charge for exercise of
rights granted under this License, and you may not initiate litigation
(including a cross-claim or counterclaim in a lawsuit) alleging that
any patent claim is infringed by making, using, selling, offering for
sale, or importing the Program or any portion of it.

  11. Patents.

  A "contributor" is a copyright holder who authorizes use under this
License of the Program or a work on which the Program is based.  The
work thus licensed is called the contributor's "contributor version".

  A contributor's "essential patent claims" are all patent claims
owned or controlled by the contributor, whether already acquired or
hereafter acquired, that would be infringed by some manner, permitted
by this License, of making, using, or selling its contributor version,
but do not include claims that would be infringed only as a
consequence of further modification of the contributor version.  For
purposes of this definition, "control" includes the right to grant
patent sublicenses in a manner consistent with the requirements of
this License.

  Each contributor grants you a non-exclusive, worldwide, royalty-free
patent license under the contributor's essential patent claims, to
make, use, sell, offer for sale, import and otherwise run, modify and
propagate the contents of its contributor version.

  In the following three paragraphs, a "patent license" is any express
agreement or commitment, however denominated, not to enforce a patent
(such as an express permission to practice a patent or covenant not to
sue for patent infringement).  To "grant" such a patent license to a
party means to make such an agreement or commitment not to enforce a
patent against the party.

  If you convey a covered work, knowingly relying on a patent license,
and the Corresponding Source of the work is not available for anyone
to copy, free of charge and under the terms of this License, through a
publicly available network server or other readily accessible means,
then you must either (1) cause the Corresponding Source to be so
available, or (2) arrange to deprive yourself of the benefit of the
patent license for this particular work, or (3) arrange, in a manner
consistent with the requirements of this License, to extend the patent
license to downstream recipients.  "Knowingly relying" means you have
actual knowledge that, but for the patent license, your conveying the
covered work in a country, or your recipient's use of the covered work
in a country, would infringe one or more identifiable patents in that
country that you have reason to believe are valid.

  If, pursuant to or in connection with a single transaction or
arrangement, you convey, or propagate by procuring conveyance of, a
covered work, and grant a patent license to some of the parties
receiving the covered work authorizing them to use, propagate, modify
or convey a specific copy of the covered work, then the patent license
you grant is automatically extended to all recipients of the covered
work and works based on it.

  A patent license is "discriminatory" if it does not include within
the scope of its coverage, prohibits the exercise of, or is
conditioned on the non-exercise of one or more of the rights that are
specifically granted under this License.  You may not convey a covered
work if you are a party to an arrangement with a third party that is
in the business of distributing software, under which you make payment
to the third party based on the extent of your activity of conveying
the work, and under which the third party grants, to any of the
parties who would receive the covered work from you, a discriminatory
patent license (a) in connection with copies of the covered work
conveyed by you (or copies made from those copies), or (b) primarily
for and in connection with specific products or compilations that
contain the covered work, unless you entered into that arrangement,
or that patent license was granted, prior to 28 March 2007.

  Nothing in this License shall be construed as excluding or limiting
any implied license or other defenses to infringement that may
otherwise be available to you under applicable patent law.

  12. No Surrender of Others' Freedom.

  If conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot convey a
covered work so as to satisfy simultaneously your obligations under this
License and any other pertinent obligations, then as a consequence you may
not convey it at all.  For example, if you agree to terms that obligate you
to collect a royalty for further conveying from those to whom you convey
the Program, the only way you could satisfy both those terms and this
License would be to refrain entirely from conveying the Program.

  13. Use with the GNU Affero General Public License.

  Notwithstanding any other provision of this License, you have
permission to link or combine any covered work with a work licensed
under version 3 of the GNU Affero General Public License into a single
combined work, and to convey the resulting work.  The terms of this
License will continue to apply to the part which is the covered work,
but the special requirements of the GNU Affero General Public License,
section 13, concerning interaction through a network will apply to the
combination as such.

  14. Revised Versions of this License.

  The Free Software Foundation may publish revised and/or new versions of
the GNU General Public License from time to time.  Such new versions will
be similar in spirit to the present version, but may differ in detail to
address new problems or concerns.

  Each version is given a distinguishing version number.  If the
Program specifies that a certain numbered version of the GNU General
Public License "or any later version" applies to it, you have the
option of following the terms and conditions either of that numbered
version or of any later version published by the Free Software
Foundation.  If the Program does not specify a version number of the
GNU General Public License, you may choose any version ever published
by the Free Software Foundation.

  If the Program specifies that a proxy can decide which future
versions of the GNU General Public License can be used, that proxy's
public statement of acceptance of a version permanently authorizes you
to choose that version for the Program.

  Later license versions may give you additional or different
permissions.  However, no additional obligations are imposed on any
author or copyright holder as a result of your choosing to follow a
later version.

  15. Disclaimer of Warranty.

  THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY
APPLICABLE LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT
HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY
OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO,
THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM
IS WITH YOU.  SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF
ALL NECESSARY SERVICING, REPAIR OR CORRECTION.

  16. Limitation of Liability.

  IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MODIFIES AND/OR CONVEYS
THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY
GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE
USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF
DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD
PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS),
EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF
SUCH DAMAGES.

  17. Interpretation of Sections 15 and 16.

  If the disclaimer of warranty and limitation of liability provided
above cannot be given local legal effect according to their terms,
reviewing courts shall apply local law that most closely approximates
an absolute waiver of all civil liability in connection with the
Program, unless a warranty or assumption of liability accompanies a
copy of the Program in return for a fee.

                     END OF TERMS AND CONDITIONS

            How to Apply These Terms to Your New Programs

  If you develop a new program, and you want it to be of the greatest
possible use to the public, the best way to achieve this is to make it
free software which everyone can redistribute and change under these terms.

  To do so, attach the following notices to the program.  It is safest
to attach them to the start of each source file to most effectively
state the exclusion of warranty; and each file should have at least
the "copyright" line and a pointer to where the full notice is found.

    <one line to give the program's name and a brief idea of what it does.>
    Copyright (C) <year>  <name of author>

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <https://www.gnu.org/licenses/>.

Also add information on how to contact you by electronic and paper mail.

  If the program does terminal interaction, make it output a short
notice like this when it starts in an interactive mode:

    <program>  Copyright (C) <year>  <name of author>
    This program comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
    This is free software, and you are welcome to redistribute it
    under certain conditions; type `show c' for details.

The hypothetical commands `show w' and `show c' should show the appropriate
parts of the General Public License.  Of course, your program's commands
might be different; for a GUI interface, you would use an "about box".

  You should also get your employer (if you work as a programmer) or school,
if any, to sign a "copyright disclaimer" for the program, if necessary.
For more information on this, and how to apply and follow the GNU GPL, see
<https://www.gnu.org/licenses/>.

  The GNU General Public License does not permit incorporating your program
into proprietary programs.  If your program is a subroutine library, you
may consider it more useful to permit linking proprietary applications with
the library.  If this is what you want to do, use the GNU Lesser General
Public License instead of this License.  But first, please read
<https://www.gnu.org/licenses/why-not-lgpl.html>.

```

`README.md`:

```md
<div align="center">
<a href="https://github.com/bmax121/APatch/releases/latest"><img src="https://images.weserv.nl/?url=https://raw.githubusercontent.com/bmax121/APatch/main/app/src/main/ic_launcher-playstore.png&mask=circle" style="width: 128px;" alt="logo"></a>

<h1 align="center">APatch</h1>

[![Latest Release](https://img.shields.io/github/v/release/bmax121/APatch?label=Release&logo=github)](https://github.com/bmax121/APatch/releases/latest)
[![Nightly Release](https://img.shields.io/badge/Nightly%20release-gray?logo=hackthebox&logoColor=fff)](https://nightly.link/bmax121/APatch/workflows/build/main/APatch)
[![Weblate](https://img.shields.io/badge/Localization-Weblate-teal?logo=weblate)](https://hosted.weblate.org/engage/APatch)
[![Channel](https://img.shields.io/badge/Follow-Telegram-blue.svg?logo=telegram)](https://t.me/APatchGroup)
[![GitHub License](https://img.shields.io/github/license/bmax121/APatch?logo=gnu)](/LICENSE)

</div>

The patching of Android kernel and Android system.

- A new kernel-based root solution for Android devices.
- APM: Support for modules similar to Magisk.
- KPM: Support for modules that allow you to inject any code into the kernel (Provides kernel function `inline-hook` and `syscall-table-hook`).
- APatch relies on [KernelPatch](https://github.com/bmax121/KernelPatch/).
- The APatch UI and the APModule source code have been derived and modified from [KernelSU](https://github.com/tiann/KernelSU).

[<img src="https://fdroid.gitlab.io/artwork/badge/get-it-on.png"
     alt="Get it on F-Droid"
     height="80">](https://f-droid.org/packages/me.bmax.apatch/)

Or download the latest APK from the [Releases Section](https://github.com/bmax121/APatch/releases/latest).

## Supported Versions

- Only supports the ARM64 architecture.
- Only supports Android kernel versions 3.18 - 6.12

Support for Samsung devices with security protection: Planned

## Requirement

Kernel configs:

- `CONFIG_KALLSYMS=y` and `CONFIG_KALLSYMS_ALL=y`

- `CONFIG_KALLSYMS=y` and `CONFIG_KALLSYMS_ALL=n`: Initial support

## Security Alert

The **SuperKey** has higher privileges than root access.  
Weak or compromised keys can lead to unauthorized control of your device.  
It is critical to use robust keys and safeguard them from exposure to maintain the security of your device.

## Translation

To help translate APatch or improve existing translations, please use [Weblate](https://hosted.weblate.org/engage/apatch/). PR of APatch translation is no longer accepted, because it will conflict with Weblate.

<div align="center">

[![Translation Status](https://hosted.weblate.org/widget/APatch/open-graph.png)](https://hosted.weblate.org/engage/APatch/)

</div>

## Get Help

### Usage

For usage, please refer to [our official documentation](https://apatch.dev).  
It's worth noting that the documentation is currently not quite complete, and the content may change at any time.  
Furthermore, we need more volunteers to [contribute to the documentation](https://github.com/AndroidPatch/APatchDocs) in other languages.

### Updates

- Telegram Channel: [@APatchUpdates](https://t.me/APatchChannel)

### Discussions

- Telegram Group: [@APatchDiscussions(EN/CN)](https://t.me/Apatch_discuss)
- Telegram Group: [中文](https://t.me/APatch_CN_Group)

### More Information

- [Documents](docs/)

## Credits

- [KernelPatch](https://github.com/bmax121/KernelPatch/): The core.
- [Magisk](https://github.com/topjohnwu/Magisk): magiskpolicy.
- [KernelSU](https://github.com/tiann/KernelSU): App UI, and Magisk module like support.

## License

APatch is licensed under the GNU General Public License v3 [GPL-3](http://www.gnu.org/copyleft/gpl.html).

```

`apd/Cargo.lock`:

```lock
# This file is automatically @generated by Cargo.
# It is not intended for manual editing.
version = 4

[[package]]
name = "adler2"
version = "2.0.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "320119579fcad9c21884f5c4861d16174d0e06250625266f50fe6898340abefa"

[[package]]
name = "aho-corasick"
version = "1.1.4"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "ddd31a130427c27518df266943a5308ed92d4b226cc639f5a8f1002816174301"
dependencies = [
 "memchr",
]

[[package]]
name = "android-properties"
version = "0.2.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "fc7eb209b1518d6bb87b283c20095f5228ecda460da70b44f0802523dea6da04"

[[package]]
name = "android_log-sys"
version = "0.3.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "84521a3cf562bc62942e294181d9eef17eb38ceb8c68677bc49f144e4c3d4f8d"

[[package]]
name = "android_logger"
version = "0.15.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "dbb4e440d04be07da1f1bf44fb4495ebd58669372fe0cffa6e48595ac5bd88a3"
dependencies = [
 "android_log-sys",
 "env_filter",
 "log",
]

[[package]]
name = "android_system_properties"
version = "0.1.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "819e7219dbd41043ac279b19830f2efc897156490d7fd6ea916720117ee66311"
dependencies = [
 "libc",
]

[[package]]
name = "anstream"
version = "0.6.21"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "43d5b281e737544384e969a5ccad3f1cdd24b48086a0fc1b2a5262a26b8f4f4a"
dependencies = [
 "anstyle",
 "anstyle-parse",
 "anstyle-query",
 "anstyle-wincon",
 "colorchoice",
 "is_terminal_polyfill",
 "utf8parse",
]

[[package]]
name = "anstyle"
version = "1.0.13"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "5192cca8006f1fd4f7237516f40fa183bb07f8fbdfedaa0036de5ea9b0b45e78"

[[package]]
name = "anstyle-parse"
version = "0.2.7"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "4e7644824f0aa2c7b9384579234ef10eb7efb6a0deb83f9630a49594dd9c15c2"
dependencies = [
 "utf8parse",
]

[[package]]
name = "anstyle-query"
version = "1.1.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "40c48f72fd53cd289104fc64099abca73db4166ad86ea0b4341abe65af83dadc"
dependencies = [
 "windows-sys 0.61.2",
]

[[package]]
name = "anstyle-wincon"
version = "3.0.11"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "291e6a250ff86cd4a820112fb8898808a366d8f9f58ce16d1f538353ad55747d"
dependencies = [
 "anstyle",
 "once_cell_polyfill",
 "windows-sys 0.61.2",
]

[[package]]
name = "anyhow"
version = "1.0.100"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a23eb6b1614318a8071c9b2521f36b424b2c83db5eb3a0fead4a6c0809af6e61"

[[package]]
name = "apd"
version = "0.1.0"
dependencies = [
 "android-properties",
 "android_logger",
 "anyhow",
 "clap",
 "const_format",
 "csv",
 "derive-new",
 "encoding_rs",
 "env_logger",
 "errno 0.3.14",
 "extattr",
 "getopts",
 "is_executable",
 "java-properties",
 "jwalk",
 "libc",
 "log",
 "loopdev",
 "mlua",
 "nom",
 "notify",
 "procfs",
 "retry",
 "rustix",
 "serde",
 "serde_json",
 "signal-hook",
 "walkdir",
 "which",
 "zip 7.2.0",
 "zip-extensions",
]

[[package]]
name = "arbitrary"
version = "1.4.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "c3d036a3c4ab069c7b410a2ce876bd74808d2d0888a82667669f8e783a898bf1"
dependencies = [
 "derive_arbitrary",
]

[[package]]
name = "autocfg"
version = "1.5.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "c08606f8c3cbf4ce6ec8e28fb0014a2c086708fe954eaa885384a6165172e7e8"

[[package]]
name = "bitflags"
version = "1.3.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "bef38d45163c2f1dde094a7dfd33ccf595c92905c8f8f4fdc18d06fb1037718a"

[[package]]
name = "bitflags"
version = "2.10.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "812e12b5285cc515a9c72a5c1d3b6d46a19dac5acfef5265968c166106e31dd3"

[[package]]
name = "block-buffer"
version = "0.10.4"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "3078c7629b62d3f0439517fa394996acacc5cbc91c5a20d8c658e77abd503a71"
dependencies = [
 "generic-array",
]

[[package]]
name = "bstr"
version = "1.12.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "63044e1ae8e69f3b5a92c736ca6269b8d12fa7efe39bf34ddb06d102cf0e2cab"
dependencies = [
 "memchr",
 "serde",
]

[[package]]
name = "bumpalo"
version = "3.19.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "5dd9dc738b7a8311c7ade152424974d8115f2cdad61e8dab8dac9f2362298510"

[[package]]
name = "cc"
version = "1.2.54"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "6354c81bbfd62d9cfa9cb3c773c2b7b2a3a482d569de977fd0e961f6e7c00583"
dependencies = [
 "find-msvc-tools",
 "jobserver",
 "libc",
 "shlex",
]

[[package]]
name = "cfg-if"
version = "1.0.4"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9330f8b2ff13f34540b44e946ef35111825727b38d33286ef986142615121801"

[[package]]
name = "chrono"
version = "0.4.43"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "fac4744fb15ae8337dc853fee7fb3f4e48c0fbaa23d0afe49c447b4fab126118"
dependencies = [
 "iana-time-zone",
 "num-traits",
 "windows-link",
]

[[package]]
name = "clap"
version = "4.5.54"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "c6e6ff9dcd79cff5cd969a17a545d79e84ab086e444102a591e288a8aa3ce394"
dependencies = [
 "clap_builder",
 "clap_derive",
]

[[package]]
name = "clap_builder"
version = "4.5.54"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "fa42cf4d2b7a41bc8f663a7cab4031ebafa1bf3875705bfaf8466dc60ab52c00"
dependencies = [
 "anstream",
 "anstyle",
 "clap_lex",
 "strsim",
]

[[package]]
name = "clap_derive"
version = "4.5.49"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "2a0b5487afeab2deb2ff4e03a807ad1a03ac532ff5a2cee5d86884440c7f7671"
dependencies = [
 "heck",
 "proc-macro2",
 "quote",
 "syn",
]

[[package]]
name = "clap_lex"
version = "0.7.7"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "c3e64b0cc0439b12df2fa678eae89a1c56a529fd067a9115f7827f1fffd22b32"

[[package]]
name = "colorchoice"
version = "1.0.4"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "b05b61dc5112cbb17e4b6cd61790d9845d13888356391624cbe7e41efeac1e75"

[[package]]
name = "const_format"
version = "0.2.35"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "7faa7469a93a566e9ccc1c73fe783b4a65c274c5ace346038dca9c39fe0030ad"
dependencies = [
 "const_format_proc_macros",
]

[[package]]
name = "const_format_proc_macros"
version = "0.2.34"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "1d57c2eccfb16dbac1f4e61e206105db5820c9d26c3c472bc17c774259ef7744"
dependencies = [
 "proc-macro2",
 "quote",
 "unicode-xid",
]

[[package]]
name = "core-foundation-sys"
version = "0.8.7"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "773648b94d0e5d620f64f280777445740e61fe701025087ec8b57f45c791888b"

[[package]]
name = "cpufeatures"
version = "0.2.17"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "59ed5838eebb26a2bb2e58f6d5b5316989ae9d08bab10e0e6d103e656d1b0280"
dependencies = [
 "libc",
]

[[package]]
name = "crc"
version = "3.3.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9710d3b3739c2e349eb44fe848ad0b7c8cb1e42bd87ee49371df2f7acaf3e675"
dependencies = [
 "crc-catalog",
]

[[package]]
name = "crc-catalog"
version = "2.4.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "19d374276b40fb8bbdee95aef7c7fa6b5316ec764510eb64b8dd0e2ed0d7e7f5"

[[package]]
name = "crc32fast"
version = "1.5.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9481c1c90cbf2ac953f07c8d4a58aa3945c425b7185c9154d67a65e4230da511"
dependencies = [
 "cfg-if",
]

[[package]]
name = "crossbeam"
version = "0.8.4"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "1137cd7e7fc0fb5d3c5a8678be38ec56e819125d8d7907411fe24ccb943faca8"
dependencies = [
 "crossbeam-channel",
 "crossbeam-deque",
 "crossbeam-epoch",
 "crossbeam-queue",
 "crossbeam-utils",
]

[[package]]
name = "crossbeam-channel"
version = "0.5.15"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "82b8f8f868b36967f9606790d1903570de9ceaf870a7bf9fbbd3016d636a2cb2"
dependencies = [
 "crossbeam-utils",
]

[[package]]
name = "crossbeam-deque"
version = "0.8.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9dd111b7b7f7d55b72c0a6ae361660ee5853c9af73f70c3c2ef6858b950e2e51"
dependencies = [
 "crossbeam-epoch",
 "crossbeam-utils",
]

[[package]]
name = "crossbeam-epoch"
version = "0.9.18"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "5b82ac4a3c2ca9c3460964f020e1402edd5753411d7737aa39c3714ad1b5420e"
dependencies = [
 "crossbeam-utils",
]

[[package]]
name = "crossbeam-queue"
version = "0.3.12"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "0f58bbc28f91df819d0aa2a2c00cd19754769c2fad90579b3592b1c9ba7a3115"
dependencies = [
 "crossbeam-utils",
]

[[package]]
name = "crossbeam-utils"
version = "0.8.21"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "d0a5c400df2834b80a4c3327b3aad3a4c4cd4de0629063962b03235697506a28"

[[package]]
name = "crypto-common"
version = "0.1.7"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "78c8292055d1c1df0cce5d180393dc8cce0abec0a7102adb6c7b1eef6016d60a"
dependencies = [
 "generic-array",
 "typenum",
]

[[package]]
name = "csv"
version = "1.4.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "52cd9d68cf7efc6ddfaaee42e7288d3a99d613d4b50f76ce9827ae0c6e14f938"
dependencies = [
 "csv-core",
 "itoa",
 "ryu",
 "serde_core",
]

[[package]]
name = "csv-core"
version = "0.1.13"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "704a3c26996a80471189265814dbc2c257598b96b8a7feae2d31ace646bb9782"
dependencies = [
 "memchr",
]

[[package]]
name = "deflate64"
version = "0.1.10"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "26bf8fc351c5ed29b5c2f0cbbac1b209b74f60ecd62e675a998df72c49af5204"

[[package]]
name = "deranged"
version = "0.5.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "ececcb659e7ba858fb4f10388c250a7252eb0a27373f1a72b8748afdd248e587"
dependencies = [
 "powerfmt",
]

[[package]]
name = "derive-new"
version = "0.7.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "2cdc8d50f426189eef89dac62fabfa0abb27d5cc008f25bf4156a0203325becc"
dependencies = [
 "proc-macro2",
 "quote",
 "syn",
]

[[package]]
name = "derive_arbitrary"
version = "1.4.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "1e567bd82dcff979e4b03460c307b3cdc9e96fde3d73bed1496d2bc75d9dd62a"
dependencies = [
 "proc-macro2",
 "quote",
 "syn",
]

[[package]]
name = "digest"
version = "0.10.7"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9ed9a281f7bc9b7576e61468ba615a66a5c8cfdff42420a70aa82701a3b1e292"
dependencies = [
 "block-buffer",
 "crypto-common",
]

[[package]]
name = "either"
version = "1.15.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "48c757948c5ede0e46177b7add2e67155f70e33c07fea8284df6576da70b3719"

[[package]]
name = "encoding_rs"
version = "0.8.35"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "75030f3c4f45dafd7586dd6780965a8c7e8e285a5ecb86713e63a79c5b2766f3"
dependencies = [
 "cfg-if",
]

[[package]]
name = "env_filter"
version = "0.1.4"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "1bf3c259d255ca70051b30e2e95b5446cdb8949ac4cd22c0d7fd634d89f568e2"
dependencies = [
 "log",
 "regex",
]

[[package]]
name = "env_home"
version = "0.1.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "c7f84e12ccf0a7ddc17a6c41c93326024c42920d7ee630d04950e6926645c0fe"

[[package]]
name = "env_logger"
version = "0.11.8"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "13c863f0904021b108aa8b2f55046443e6b1ebde8fd4a15c399893aae4fa069f"
dependencies = [
 "anstream",
 "anstyle",
 "env_filter",
 "jiff",
 "log",
]

[[package]]
name = "equivalent"
version = "1.0.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "877a4ace8713b0bcf2a4e7eec82529c029f1d0619886d18145fea96c3ffe5c0f"

[[package]]
name = "errno"
version = "0.2.8"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "f639046355ee4f37944e44f60642c6f3a7efa3cf6b78c78a0d989a8ce6c396a1"
dependencies = [
 "errno-dragonfly",
 "libc",
 "winapi",
]

[[package]]
name = "errno"
version = "0.3.14"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "39cab71617ae0d63f51a36d69f866391735b51691dbda63cf6f96d042b63efeb"
dependencies = [
 "libc",
 "windows-sys 0.61.2",
]

[[package]]
name = "errno-dragonfly"
version = "0.1.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "aa68f1b12764fab894d2755d2518754e71b4fd80ecfb822714a1206c2aab39bf"
dependencies = [
 "cc",
 "libc",
]

[[package]]
name = "extattr"
version = "1.0.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "1b59f8a77817ff1b795adafc535941bdf664184f5f95e0b6d1d77dd6d12815dc"
dependencies = [
 "bitflags 1.3.2",
 "errno 0.2.8",
 "libc",
]

[[package]]
name = "find-msvc-tools"
version = "0.1.8"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "8591b0bcc8a98a64310a2fae1bb3e9b8564dd10e381e6e28010fde8e8e8568db"

[[package]]
name = "flate2"
version = "1.1.8"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "b375d6465b98090a5f25b1c7703f3859783755aa9a80433b36e0379a3ec2f369"
dependencies = [
 "crc32fast",
 "miniz_oxide",
 "zlib-rs",
]

[[package]]
name = "fsevent-sys"
version = "4.1.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "76ee7a02da4d231650c7cea31349b889be2f45ddb3ef3032d2ec8185f6313fd2"
dependencies = [
 "libc",
]

[[package]]
name = "generic-array"
version = "0.14.7"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "85649ca51fd72272d7821adaf274ad91c288277713d9c18820d8499a7ff69e9a"
dependencies = [
 "typenum",
 "version_check",
]

[[package]]
name = "getopts"
version = "0.2.24"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "cfe4fbac503b8d1f88e6676011885f34b7174f46e59956bba534ba83abded4df"
dependencies = [
 "unicode-width",
]

[[package]]
name = "getrandom"
version = "0.3.4"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "899def5c37c4fd7b2664648c28120ecec138e4d395b459e5ca34f9cce2dd77fd"
dependencies = [
 "cfg-if",
 "libc",
 "r-efi",
 "wasip2",
]

[[package]]
name = "hashbrown"
version = "0.16.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "841d1cc9bed7f9236f321df977030373f4a4163ae1a7dbfe1a51a2c1a51d9100"

[[package]]
name = "heck"
version = "0.5.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "2304e00983f87ffb38b55b444b5e3b60a884b5d30c0fca7d82fe33449bbe55ea"

[[package]]
name = "hex"
version = "0.4.3"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "7f24254aa9a54b5c858eaee2f5bccdb46aaf0e486a595ed5fd8f86ba55232a70"

[[package]]
name = "iana-time-zone"
version = "0.1.64"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "33e57f83510bb73707521ebaffa789ec8caf86f9657cad665b092b581d40e9fb"
dependencies = [
 "android_system_properties",
 "core-foundation-sys",
 "iana-time-zone-haiku",
 "js-sys",
 "log",
 "wasm-bindgen",
 "windows-core",
]

[[package]]
name = "iana-time-zone-haiku"
version = "0.1.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "f31827a206f56af32e590ba56d5d2d085f558508192593743f16b2306495269f"
dependencies = [
 "cc",
]

[[package]]
name = "indexmap"
version = "2.13.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "7714e70437a7dc3ac8eb7e6f8df75fd8eb422675fc7678aff7364301092b1017"
dependencies = [
 "equivalent",
 "hashbrown",
]

[[package]]
name = "inotify"
version = "0.11.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "f37dccff2791ab604f9babef0ba14fbe0be30bd368dc541e2b08d07c8aa908f3"
dependencies = [
 "bitflags 2.10.0",
 "inotify-sys",
 "libc",
]

[[package]]
name = "inotify-sys"
version = "0.1.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "e05c02b5e89bff3b946cedeca278abc628fe811e604f027c45a8aa3cf793d0eb"
dependencies = [
 "libc",
]

[[package]]
name = "is_executable"
version = "1.0.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "baabb8b4867b26294d818bf3f651a454b6901431711abb96e296245888d6e8c4"
dependencies = [
 "windows-sys 0.60.2",
]

[[package]]
name = "is_terminal_polyfill"
version = "1.70.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a6cb138bb79a146c1bd460005623e142ef0181e3d0219cb493e02f7d08a35695"

[[package]]
name = "itoa"
version = "1.0.17"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "92ecc6618181def0457392ccd0ee51198e065e016d1d527a7ac1b6dc7c1f09d2"

[[package]]
name = "java-properties"
version = "2.0.0"
source = "git+https://github.com/AndroidPatch/java-properties.git?branch=master#42a4aa941b70ded2dd3be9e9f892471023e70229"
dependencies = [
 "encoding_rs",
 "lazy_static",
 "regex-lite",
]

[[package]]
name = "jiff"
version = "0.2.18"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "e67e8da4c49d6d9909fe03361f9b620f58898859f5c7aded68351e85e71ecf50"
dependencies = [
 "jiff-static",
 "log",
 "portable-atomic",
 "portable-atomic-util",
 "serde_core",
]

[[package]]
name = "jiff-static"
version = "0.2.18"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "e0c84ee7f197eca9a86c6fd6cb771e55eb991632f15f2bc3ca6ec838929e6e78"
dependencies = [
 "proc-macro2",
 "quote",
 "syn",
]

[[package]]
name = "jobserver"
version = "0.1.34"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9afb3de4395d6b3e67a780b6de64b51c978ecf11cb9a462c66be7d4ca9039d33"
dependencies = [
 "getrandom",
 "libc",
]

[[package]]
name = "js-sys"
version = "0.3.85"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "8c942ebf8e95485ca0d52d97da7c5a2c387d0e7f0ba4c35e93bfcaee045955b3"
dependencies = [
 "once_cell",
 "wasm-bindgen",
]

[[package]]
name = "jwalk"
version = "0.8.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "2735847566356cd2179a2a38264839308f7079fa96e6bd5a42d740460e003c56"
dependencies = [
 "crossbeam",
 "rayon",
]

[[package]]
name = "kqueue"
version = "1.1.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "eac30106d7dce88daf4a3fcb4879ea939476d5074a9b7ddd0fb97fa4bed5596a"
dependencies = [
 "kqueue-sys",
 "libc",
]

[[package]]
name = "kqueue-sys"
version = "1.0.4"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "ed9625ffda8729b85e45cf04090035ac368927b8cebc34898e7c120f52e4838b"
dependencies = [
 "bitflags 1.3.2",
 "libc",
]

[[package]]
name = "lazy_static"
version = "1.5.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "bbd2bcb4c963f2ddae06a2efc7e9f3591312473c50c6685e1f298068316e66fe"

[[package]]
name = "libc"
version = "0.2.180"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "bcc35a38544a891a5f7c865aca548a982ccb3b8650a5b06d0fd33a10283c56fc"

[[package]]
name = "liblzma"
version = "0.4.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "73c36d08cad03a3fbe2c4e7bb3a9e84c57e4ee4135ed0b065cade3d98480c648"
dependencies = [
 "liblzma-sys",
]

[[package]]
name = "liblzma-sys"
version = "0.4.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9f2db66f3268487b5033077f266da6777d057949b8f93c8ad82e441df25e6186"
dependencies = [
 "cc",
 "libc",
 "pkg-config",
]

[[package]]
name = "linux-raw-sys"
version = "0.11.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "df1d3c3b53da64cf5760482273a98e575c651a67eec7f77df96b5b642de8f039"

[[package]]
name = "lock_api"
version = "0.4.14"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "224399e74b87b5f3557511d98dff8b14089b3dadafcab6bb93eab67d3aace965"
dependencies = [
 "scopeguard",
]

[[package]]
name = "log"
version = "0.4.29"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "5e5032e24019045c762d3c0f28f5b6b8bbf38563a65908389bf7978758920897"

[[package]]
name = "loopdev"
version = "0.5.0"
source = "git+https://github.com/AndroidPatch/loopdev#7a921f8d966477a645b1188732fac486c71a68ef"
dependencies = [
 "errno 0.2.8",
 "libc",
]

[[package]]
name = "lua-src"
version = "548.1.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "bdc4e1aff422ad5f08cffb4719603dcdbc2be2307f4c1510d7aab74b7fa88ca8"
dependencies = [
 "cc",
]

[[package]]
name = "luajit-src"
version = "210.6.6+707c12b"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a86cc925d4053d0526ae7f5bc765dbd0d7a5d1a63d43974f4966cb349ca63295"
dependencies = [
 "cc",
 "which",
]

[[package]]
name = "lzma-rust2"
version = "0.15.7"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "1670343e58806300d87950e3401e820b519b9384281bbabfb15e3636689ffd69"
dependencies = [
 "crc",
 "sha2",
]

[[package]]
name = "memchr"
version = "2.7.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "f52b00d39961fc5b2736ea853c9cc86238e165017a493d1d5c8eac6bdc4cc273"

[[package]]
name = "miniz_oxide"
version = "0.8.9"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "1fa76a2c86f704bdb222d66965fb3d63269ce38518b83cb0575fca855ebb6316"
dependencies = [
 "adler2",
 "simd-adler32",
]

[[package]]
name = "mio"
version = "1.1.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a69bcab0ad47271a0234d9422b131806bf3968021e5dc9328caf2d4cd58557fc"
dependencies = [
 "libc",
 "log",
 "wasi",
 "windows-sys 0.61.2",
]

[[package]]
name = "mlua"
version = "0.11.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "935ac67539907efcd7198137eb7358e052555f77fe1b2916600a2249351f2b33"
dependencies = [
 "bstr",
 "either",
 "libc",
 "mlua-sys",
 "num-traits",
 "parking_lot",
 "rustc-hash",
 "rustversion",
]

[[package]]
name = "mlua-sys"
version = "0.9.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "8c968af21bf6b19fc9ca8e7b85ee16f86e4c9e3d0591de101a5608086bda0ad8"
dependencies = [
 "cc",
 "cfg-if",
 "lua-src",
 "luajit-src",
 "pkg-config",
]

[[package]]
name = "nom"
version = "8.0.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "df9761775871bdef83bee530e60050f7e54b1105350d6884eb0fb4f46c2f9405"
dependencies = [
 "memchr",
]

[[package]]
name = "notify"
version = "8.2.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "4d3d07927151ff8575b7087f245456e549fea62edf0ec4e565a5ee50c8402bc3"
dependencies = [
 "bitflags 2.10.0",
 "fsevent-sys",
 "inotify",
 "kqueue",
 "libc",
 "log",
 "mio",
 "notify-types",
 "walkdir",
 "windows-sys 0.60.2",
]

[[package]]
name = "notify-types"
version = "2.0.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "5e0826a989adedc2a244799e823aece04662b66609d96af8dff7ac6df9a8925d"

[[package]]
name = "num-conv"
version = "0.2.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "cf97ec579c3c42f953ef76dbf8d55ac91fb219dde70e49aa4a6b7d74e9919050"

[[package]]
name = "num-traits"
version = "0.2.19"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "071dfc062690e90b734c0b2273ce72ad0ffa95f0c74596bc250dcfd960262841"
dependencies = [
 "autocfg",
]

[[package]]
name = "once_cell"
version = "1.21.3"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "42f5e15c9953c5e4ccceeb2e7382a716482c34515315f7b03532b8b4e8393d2d"

[[package]]
name = "once_cell_polyfill"
version = "1.70.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "384b8ab6d37215f3c5301a95a4accb5d64aa607f1fcb26a11b5303878451b4fe"

[[package]]
name = "parking_lot"
version = "0.12.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "93857453250e3077bd71ff98b6a65ea6621a19bb0f559a85248955ac12c45a1a"
dependencies = [
 "lock_api",
 "parking_lot_core",
]

[[package]]
name = "parking_lot_core"
version = "0.9.12"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "2621685985a2ebf1c516881c026032ac7deafcda1a2c9b7850dc81e3dfcb64c1"
dependencies = [
 "cfg-if",
 "libc",
 "redox_syscall",
 "smallvec",
 "windows-link",
]

[[package]]
name = "pkg-config"
version = "0.3.32"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "7edddbd0b52d732b21ad9a5fab5c704c14cd949e5e9a1ec5929a24fded1b904c"

[[package]]
name = "portable-atomic"
version = "1.13.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "f89776e4d69bb58bc6993e99ffa1d11f228b839984854c7daeb5d37f87cbe950"

[[package]]
name = "portable-atomic-util"
version = "0.2.4"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "d8a2f0d8d040d7848a709caf78912debcc3f33ee4b3cac47d73d1e1069e83507"
dependencies = [
 "portable-atomic",
]

[[package]]
name = "powerfmt"
version = "0.2.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "439ee305def115ba05938db6eb1644ff94165c5ab5e9420d1c1bcedbba909391"

[[package]]
name = "ppv-lite86"
version = "0.2.21"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "85eae3c4ed2f50dcfe72643da4befc30deadb458a9b590d720cde2f2b1e97da9"
dependencies = [
 "zerocopy",
]

[[package]]
name = "proc-macro2"
version = "1.0.106"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "8fd00f0bb2e90d81d1044c2b32617f68fcb9fa3bb7640c23e9c748e53fb30934"
dependencies = [
 "unicode-ident",
]

[[package]]
name = "procfs"
version = "0.18.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "25485360a54d6861439d60facef26de713b1e126bf015ec8f98239467a2b82f7"
dependencies = [
 "bitflags 2.10.0",
 "chrono",
 "flate2",
 "procfs-core",
 "rustix",
]

[[package]]
name = "procfs-core"
version = "0.18.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "e6401bf7b6af22f78b563665d15a22e9aef27775b79b149a66ca022468a4e405"
dependencies = [
 "bitflags 2.10.0",
 "chrono",
 "hex",
]

[[package]]
name = "quote"
version = "1.0.44"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "21b2ebcf727b7760c461f091f9f0f539b77b8e87f2fd88131e7f1b433b3cece4"
dependencies = [
 "proc-macro2",
]

[[package]]
name = "r-efi"
version = "5.3.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "69cdb34c158ceb288df11e18b4bd39de994f6657d83847bdffdbd7f346754b0f"

[[package]]
name = "rand"
version = "0.9.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "6db2770f06117d490610c7488547d543617b21bfa07796d7a12f6f1bd53850d1"
dependencies = [
 "rand_chacha",
 "rand_core",
]

[[package]]
name = "rand_chacha"
version = "0.9.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "d3022b5f1df60f26e1ffddd6c66e8aa15de382ae63b3a0c1bfc0e4d3e3f325cb"
dependencies = [
 "ppv-lite86",
 "rand_core",
]

[[package]]
name = "rand_core"
version = "0.9.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "76afc826de14238e6e8c374ddcc1fa19e374fd8dd986b0d2af0d02377261d83c"
dependencies = [
 "getrandom",
]

[[package]]
name = "rayon"
version = "1.11.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "368f01d005bf8fd9b1206fb6fa653e6c4a81ceb1466406b81792d87c5677a58f"
dependencies = [
 "either",
 "rayon-core",
]

[[package]]
name = "rayon-core"
version = "1.13.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "22e18b0f0062d30d4230b2e85ff77fdfe4326feb054b9783a3460d8435c8ab91"
dependencies = [
 "crossbeam-deque",
 "crossbeam-utils",
]

[[package]]
name = "redox_syscall"
version = "0.5.18"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "ed2bf2547551a7053d6fdfafda3f938979645c44812fbfcda098faae3f1a362d"
dependencies = [
 "bitflags 2.10.0",
]

[[package]]
name = "regex"
version = "1.12.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "843bc0191f75f3e22651ae5f1e72939ab2f72a4bc30fa80a066bd66edefc24d4"
dependencies = [
 "aho-corasick",
 "memchr",
 "regex-automata",
 "regex-syntax",
]

[[package]]
name = "regex-automata"
version = "0.4.13"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "5276caf25ac86c8d810222b3dbb938e512c55c6831a10f3e6ed1c93b84041f1c"
dependencies = [
 "aho-corasick",
 "memchr",
 "regex-syntax",
]

[[package]]
name = "regex-lite"
version = "0.1.8"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "8d942b98df5e658f56f20d592c7f868833fe38115e65c33003d8cd224b0155da"

[[package]]
name = "regex-syntax"
version = "0.8.8"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "7a2d987857b319362043e95f5353c0535c1f58eec5336fdfcf626430af7def58"

[[package]]
name = "retry"
version = "2.1.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a1e211f878258887b3e65dd3c8ff9f530fe109f441a117ee0cdc27f341355032"
dependencies = [
 "rand",
]

[[package]]
name = "rustc-hash"
version = "2.1.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "357703d41365b4b27c590e3ed91eabb1b663f07c4c084095e60cbed4362dff0d"

[[package]]
name = "rustix"
version = "1.1.3"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "146c9e247ccc180c1f61615433868c99f3de3ae256a30a43b49f67c2d9171f34"
dependencies = [
 "bitflags 2.10.0",
 "errno 0.3.14",
 "libc",
 "linux-raw-sys",
 "windows-sys 0.61.2",
]

[[package]]
name = "rustversion"
version = "1.0.22"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "b39cdef0fa800fc44525c84ccb54a029961a8215f9619753635a9c0d2538d46d"

[[package]]
name = "ryu"
version = "1.0.22"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a50f4cf475b65d88e057964e0e9bb1f0aa9bbb2036dc65c64596b42932536984"

[[package]]
name = "same-file"
version = "1.0.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "93fc1dc3aaa9bfed95e02e6eadabb4baf7e3078b0bd1b4d7b6b0b68378900502"
dependencies = [
 "winapi-util",
]

[[package]]
name = "scopeguard"
version = "1.2.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "94143f37725109f92c262ed2cf5e59bce7498c01bcc1502d7b9afe439a4e9f49"

[[package]]
name = "serde"
version = "1.0.228"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9a8e94ea7f378bd32cbbd37198a4a91436180c5bb472411e48b5ec2e2124ae9e"
dependencies = [
 "serde_core",
 "serde_derive",
]

[[package]]
name = "serde_core"
version = "1.0.228"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "41d385c7d4ca58e59fc732af25c3983b67ac852c1a25000afe1175de458b67ad"
dependencies = [
 "serde_derive",
]

[[package]]
name = "serde_derive"
version = "1.0.228"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "d540f220d3187173da220f885ab66608367b6574e925011a9353e4badda91d79"
dependencies = [
 "proc-macro2",
 "quote",
 "syn",
]

[[package]]
name = "serde_json"
version = "1.0.149"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "83fc039473c5595ace860d8c4fafa220ff474b3fc6bfdb4293327f1a37e94d86"
dependencies = [
 "itoa",
 "memchr",
 "serde",
 "serde_core",
 "zmij",
]

[[package]]
name = "sha2"
version = "0.10.9"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a7507d819769d01a365ab707794a4084392c824f54a7a6a7862f8c3d0892b283"
dependencies = [
 "cfg-if",
 "cpufeatures",
 "digest",
]

[[package]]
name = "shlex"
version = "1.3.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "0fda2ff0d084019ba4d7c6f371c95d8fd75ce3524c3cb8fb653a3023f6323e64"

[[package]]
name = "signal-hook"
version = "0.4.3"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "3b57709da74f9ff9f4a27dce9526eec25ca8407c45a7887243b031a58935fb8e"
dependencies = [
 "libc",
 "signal-hook-registry",
]

[[package]]
name = "signal-hook-registry"
version = "1.4.8"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "c4db69cba1110affc0e9f7bcd48bbf87b3f4fc7c61fc9155afd4c469eb3d6c1b"
dependencies = [
 "errno 0.3.14",
 "libc",
]

[[package]]
name = "simd-adler32"
version = "0.3.8"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "e320a6c5ad31d271ad523dcf3ad13e2767ad8b1cb8f047f75a8aeaf8da139da2"

[[package]]
name = "smallvec"
version = "1.15.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "67b1b7a3b5fe4f1376887184045fcf45c69e92af734b7aaddc05fb777b6fbd03"

[[package]]
name = "strsim"
version = "0.11.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "7da8b5736845d9f2fcb837ea5d9e2628564b3b043a70948a3f0b778838c5fb4f"

[[package]]
name = "syn"
version = "2.0.114"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "d4d107df263a3013ef9b1879b0df87d706ff80f65a86ea879bd9c31f9b307c2a"
dependencies = [
 "proc-macro2",
 "quote",
 "unicode-ident",
]

[[package]]
name = "time"
version = "0.3.46"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9da98b7d9b7dad93488a84b8248efc35352b0b2657397d4167e7ad67e5d535e5"
dependencies = [
 "deranged",
 "js-sys",
 "num-conv",
 "powerfmt",
 "serde_core",
 "time-core",
]

[[package]]
name = "time-core"
version = "0.1.8"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "7694e1cfe791f8d31026952abf09c69ca6f6fa4e1a1229e18988f06a04a12dca"

[[package]]
name = "typed-path"
version = "0.12.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "e43ffa54726cdc9ea78392023ffe9fe9cf9ac779e1c6fcb0d23f9862e3879d20"

[[package]]
name = "typenum"
version = "1.19.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "562d481066bde0658276a35467c4af00bdc6ee726305698a55b86e61d7ad82bb"

[[package]]
name = "unicode-ident"
version = "1.0.22"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9312f7c4f6ff9069b165498234ce8be658059c6728633667c526e27dc2cf1df5"

[[package]]
name = "unicode-width"
version = "0.2.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "b4ac048d71ede7ee76d585517add45da530660ef4390e49b098733c6e897f254"

[[package]]
name = "unicode-xid"
version = "0.2.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "ebc1c04c71510c7f702b52b7c350734c9ff1295c464a03335b00bb84fc54f853"

[[package]]
name = "utf8parse"
version = "0.2.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "06abde3611657adf66d383f00b093d7faecc7fa57071cce2578660c9f1010821"

[[package]]
name = "version_check"
version = "0.9.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "0b928f33d975fc6ad9f86c8f283853ad26bdd5b10b7f1542aa2fa15e2289105a"

[[package]]
name = "walkdir"
version = "2.5.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "29790946404f91d9c5d06f9874efddea1dc06c5efe94541a7d6863108e3a5e4b"
dependencies = [
 "same-file",
 "winapi-util",
]

[[package]]
name = "wasi"
version = "0.11.1+wasi-snapshot-preview1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "ccf3ec651a847eb01de73ccad15eb7d99f80485de043efb2f370cd654f4ea44b"

[[package]]
name = "wasip2"
version = "1.0.2+wasi-0.2.9"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9517f9239f02c069db75e65f174b3da828fe5f5b945c4dd26bd25d89c03ebcf5"
dependencies = [
 "wit-bindgen",
]

[[package]]
name = "wasm-bindgen"
version = "0.2.108"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "64024a30ec1e37399cf85a7ffefebdb72205ca1c972291c51512360d90bd8566"
dependencies = [
 "cfg-if",
 "once_cell",
 "rustversion",
 "wasm-bindgen-macro",
 "wasm-bindgen-shared",
]

[[package]]
name = "wasm-bindgen-macro"
version = "0.2.108"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "008b239d9c740232e71bd39e8ef6429d27097518b6b30bdf9086833bd5b6d608"
dependencies = [
 "quote",
 "wasm-bindgen-macro-support",
]

[[package]]
name = "wasm-bindgen-macro-support"
version = "0.2.108"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "5256bae2d58f54820e6490f9839c49780dff84c65aeab9e772f15d5f0e913a55"
dependencies = [
 "bumpalo",
 "proc-macro2",
 "quote",
 "syn",
 "wasm-bindgen-shared",
]

[[package]]
name = "wasm-bindgen-shared"
version = "0.2.108"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "1f01b580c9ac74c8d8f0c0e4afb04eeef2acf145458e52c03845ee9cd23e3d12"
dependencies = [
 "unicode-ident",
]

[[package]]
name = "which"
version = "8.0.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "d3fabb953106c3c8eea8306e4393700d7657561cb43122571b172bbfb7c7ba1d"
dependencies = [
 "env_home",
 "rustix",
 "winsafe",
]

[[package]]
name = "winapi"
version = "0.3.9"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "5c839a674fcd7a98952e593242ea400abe93992746761e38641405d28b00f419"
dependencies = [
 "winapi-i686-pc-windows-gnu",
 "winapi-x86_64-pc-windows-gnu",
]

[[package]]
name = "winapi-i686-pc-windows-gnu"
version = "0.4.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "ac3b87c63620426dd9b991e5ce0329eff545bccbbb34f3be09ff6fb6ab51b7b6"

[[package]]
name = "winapi-util"
version = "0.1.11"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "c2a7b1c03c876122aa43f3020e6c3c3ee5c05081c9a00739faf7503aeba10d22"
dependencies = [
 "windows-sys 0.61.2",
]

[[package]]
name = "winapi-x86_64-pc-windows-gnu"
version = "0.4.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "712e227841d057c1ee1cd2fb22fa7e5a5461ae8e48fa2ca79ec42cfc1931183f"

[[package]]
name = "windows-core"
version = "0.62.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "b8e83a14d34d0623b51dce9581199302a221863196a1dde71a7663a4c2be9deb"
dependencies = [
 "windows-implement",
 "windows-interface",
 "windows-link",
 "windows-result",
 "windows-strings",
]

[[package]]
name = "windows-implement"
version = "0.60.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "053e2e040ab57b9dc951b72c264860db7eb3b0200ba345b4e4c3b14f67855ddf"
dependencies = [
 "proc-macro2",
 "quote",
 "syn",
]

[[package]]
name = "windows-interface"
version = "0.59.3"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "3f316c4a2570ba26bbec722032c4099d8c8bc095efccdc15688708623367e358"
dependencies = [
 "proc-macro2",
 "quote",
 "syn",
]

[[package]]
name = "windows-link"
version = "0.2.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "f0805222e57f7521d6a62e36fa9163bc891acd422f971defe97d64e70d0a4fe5"

[[package]]
name = "windows-result"
version = "0.4.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "7781fa89eaf60850ac3d2da7af8e5242a5ea78d1a11c49bf2910bb5a73853eb5"
dependencies = [
 "windows-link",
]

[[package]]
name = "windows-strings"
version = "0.5.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "7837d08f69c77cf6b07689544538e017c1bfcf57e34b4c0ff58e6c2cd3b37091"
dependencies = [
 "windows-link",
]

[[package]]
name = "windows-sys"
version = "0.60.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "f2f500e4d28234f72040990ec9d39e3a6b950f9f22d3dba18416c35882612bcb"
dependencies = [
 "windows-targets",
]

[[package]]
name = "windows-sys"
version = "0.61.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "ae137229bcbd6cdf0f7b80a31df61766145077ddf49416a728b02cb3921ff3fc"
dependencies = [
 "windows-link",
]

[[package]]
name = "windows-targets"
version = "0.53.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "4945f9f551b88e0d65f3db0bc25c33b8acea4d9e41163edf90dcd0b19f9069f3"
dependencies = [
 "windows-link",
 "windows_aarch64_gnullvm",
 "windows_aarch64_msvc",
 "windows_i686_gnu",
 "windows_i686_gnullvm",
 "windows_i686_msvc",
 "windows_x86_64_gnu",
 "windows_x86_64_gnullvm",
 "windows_x86_64_msvc",
]

[[package]]
name = "windows_aarch64_gnullvm"
version = "0.53.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a9d8416fa8b42f5c947f8482c43e7d89e73a173cead56d044f6a56104a6d1b53"

[[package]]
name = "windows_aarch64_msvc"
version = "0.53.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "b9d782e804c2f632e395708e99a94275910eb9100b2114651e04744e9b125006"

[[package]]
name = "windows_i686_gnu"
version = "0.53.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "960e6da069d81e09becb0ca57a65220ddff016ff2d6af6a223cf372a506593a3"

[[package]]
name = "windows_i686_gnullvm"
version = "0.53.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "fa7359d10048f68ab8b09fa71c3daccfb0e9b559aed648a8f95469c27057180c"

[[package]]
name = "windows_i686_msvc"
version = "0.53.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "1e7ac75179f18232fe9c285163565a57ef8d3c89254a30685b57d83a38d326c2"

[[package]]
name = "windows_x86_64_gnu"
version = "0.53.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9c3842cdd74a865a8066ab39c8a7a473c0778a3f29370b5fd6b4b9aa7df4a499"

[[package]]
name = "windows_x86_64_gnullvm"
version = "0.53.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "0ffa179e2d07eee8ad8f57493436566c7cc30ac536a3379fdf008f47f6bb7ae1"

[[package]]
name = "windows_x86_64_msvc"
version = "0.53.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "d6bbff5f0aada427a1e5a6da5f1f98158182f26556f345ac9e04d36d0ebed650"

[[package]]
name = "winsafe"
version = "0.0.19"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "d135d17ab770252ad95e9a872d365cf3090e3be864a34ab46f48555993efc904"

[[package]]
name = "wit-bindgen"
version = "0.51.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "d7249219f66ced02969388cf2bb044a09756a083d0fab1e566056b04d9fbcaa5"

[[package]]
name = "zerocopy"
version = "0.8.33"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "668f5168d10b9ee831de31933dc111a459c97ec93225beb307aed970d1372dfd"
dependencies = [
 "zerocopy-derive",
]

[[package]]
name = "zerocopy-derive"
version = "0.8.33"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "2c7962b26b0a8685668b671ee4b54d007a67d4eaf05fda79ac0ecf41e32270f1"
dependencies = [
 "proc-macro2",
 "quote",
 "syn",
]

[[package]]
name = "zip"
version = "4.6.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "caa8cd6af31c3b31c6631b8f483848b91589021b28fffe50adada48d4f4d2ed1"
dependencies = [
 "arbitrary",
 "crc32fast",
 "flate2",
 "indexmap",
 "liblzma",
 "memchr",
 "zopfli",
]

[[package]]
name = "zip"
version = "7.2.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "c42e33efc22a0650c311c2ef19115ce232583abbe80850bc8b66509ebef02de0"
dependencies = [
 "crc32fast",
 "deflate64",
 "flate2",
 "indexmap",
 "lzma-rust2",
 "memchr",
 "time",
 "typed-path",
 "zopfli",
]

[[package]]
name = "zip-extensions"
version = "0.8.3"
source = "git+https://github.com/AndroidPatch/zip-extensions-rs.git?branch=master#6ab02d515fee354d8f7922b6f087f62a0a0caf44"
dependencies = [
 "zip 4.6.1",
]

[[package]]
name = "zlib-rs"
version = "0.5.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "40990edd51aae2c2b6907af74ffb635029d5788228222c4bb811e9351c0caad3"

[[package]]
name = "zmij"
version = "1.0.16"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "dfcd145825aace48cff44a8844de64bf75feec3080e0aa5cdbde72961ae51a65"

[[package]]
name = "zopfli"
version = "0.8.3"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "f05cd8797d63865425ff89b5c4a48804f35ba0ce8d125800027ad6017d2b5249"
dependencies = [
 "bumpalo",
 "crc32fast",
 "log",
 "simd-adler32",
]

```

`apd/Cargo.toml`:

```toml
[package]
name = "apd"
version = "0.1.0"
edition = "2024"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]
mlua = { version = "0.11.5", features = ["lua54","vendored"] }
anyhow = "1"
csv = "1.3.1"
clap = { version = "4", features = ["derive"] }
const_format = "0.2"
zip = { version = "7.2.0",features = [
    "deflate",
    "deflate64",
    "time",
    "lzma",
    "xz",
], default-features = false }
zip-extensions = { git = "https://github.com/AndroidPatch/zip-extensions-rs.git", branch = "master", features = [
    "deflate",
    "lzma",
    "xz",
], default-features = false }
java-properties = { git = "https://github.com/AndroidPatch/java-properties.git", branch = "master", default-features = false }
log = "0.4"
env_logger = "0.11"
serde = { version = "1", features = ["derive"] }
serde_json = "1"
encoding_rs = "0.8"
walkdir="2.4"
retry = "2"
libc = "0.2"
extattr = "1"
jwalk = "0.8"
is_executable = "1"
nom = "8"
derive-new = "0.7.0"
which = "8"
getopts = "0.2"
errno = "0.3.14"
notify = "8.2"
signal-hook = "0.4"

[target.'cfg(any(target_os = "android", target_os = "linux"))'.dependencies]
rustix = { version = "1", features = ["all-apis"] }
# some android specific dependencies which compiles under unix are also listed here for convenience of coding
android-properties = { version = "0.2.2", features = ["bionic-deprecated"] }
procfs = "0.18"
loopdev = { git = "https://github.com/AndroidPatch/loopdev" }

[target.'cfg(target_os = "android")'.dependencies]
android_logger = { version = "0.15", default-features = false }

[profile.release]
strip = true
overflow-checks = false
rpath = false
opt-level = 3
codegen-units = 1
panic = "abort"
lto = "fat"

```

`apd/build.rs`:

```rs
use std::env;
use std::fs::File;
use std::io::Write;
use std::path::Path;
use std::process::Command;

fn get_git_version() -> Result<(u32, String), std::io::Error> {
    let output = Command::new("git")
        .args(["rev-list", "--count", "HEAD"])
        .output()?;

    let output = output.stdout;
    let version_code = String::from_utf8(output).expect("Failed to read git count stdout");
    let version_code: u32 = version_code
        .trim()
        .parse()
        .map_err(|_| std::io::Error::new(std::io::ErrorKind::Other, "Failed to parse git count"))?;
    let version_code = 10000 + 200 + version_code; // For historical reasons

    let version_name = String::from_utf8(
        Command::new("git")
            .args(["describe", "--tags", "--always"])
            .output()?
            .stdout,
    )
    .map_err(|_| {
        std::io::Error::new(
            std::io::ErrorKind::Other,
            "Failed to read git describe stdout",
        )
    })?;
    let version_name = version_name.trim_start_matches('v').to_string();
    Ok((version_code, version_name))
}

fn main() {
    // update VersionCode when git repository change
    println!("cargo:rerun-if-changed=../.git/HEAD");
    println!("cargo:rerun-if-changed=../.git/refs/");

    let (code, name) = match get_git_version() {
        Ok((code, name)) => (code, name),
        Err(_) => {
            // show warning if git is not installed
            println!("cargo:warning=Failed to get git version, using 0.0.0");
            (0, "0.0.0".to_string())
        }
    };
    let out_dir = env::var("OUT_DIR").expect("Failed to get $OUT_DIR");
    println!("out_dir: ${out_dir}");
    println!("code: ${code}");
    let out_dir = Path::new(&out_dir);
    File::create(Path::new(out_dir).join("VERSION_CODE"))
        .expect("Failed to create VERSION_CODE")
        .write_all(code.to_string().as_bytes())
        .expect("Failed to write VERSION_CODE");

    File::create(Path::new(out_dir).join("VERSION_NAME"))
        .expect("Failed to create VERSION_NAME")
        .write_all(name.trim().as_bytes())
        .expect("Failed to write VERSION_NAME");
}

```

`apd/src/apd.rs`:

```rs
#[cfg(unix)]
use std::os::unix::process::CommandExt;
use std::{env, ffi::CStr, path::PathBuf, process::Command};

use anyhow::{Ok, Result};
#[cfg(unix)]
use getopts::Options;
use rustix::thread::{Gid, Uid, set_thread_res_gid, set_thread_res_uid};

#[cfg(any(target_os = "linux", target_os = "android"))]
use crate::pty::prepare_pty;
use crate::{
    defs,
    utils::{self, umask},
};

fn print_usage(opts: Options) {
    let brief = "APatch\n\nUsage: <command> [options] [-] [user [argument...]]".to_string();
    print!("{}", opts.usage(&brief));
}

fn set_identity(uid: u32, gid: u32) {
    #[cfg(any(target_os = "linux", target_os = "android"))]
    let gid = Gid::from_raw(gid);
    let uid = Uid::from_raw(uid);
    set_thread_res_gid(gid, gid, gid).ok();
    set_thread_res_uid(uid, uid, uid).ok();
}

#[cfg(not(unix))]
pub fn root_shell() -> Result<()> {
    unimplemented!()
}

#[cfg(unix)]
pub fn root_shell() -> Result<()> {
    // we are root now, this was set in kernel!
    let env_args: Vec<String> = env::args().collect();
    let args = env_args
        .iter()
        .position(|arg| arg == "-c")
        .map(|i| {
            let rest = env_args[i + 1..].to_vec();
            let mut new_args = env_args[..i].to_vec();
            new_args.push("-c".to_string());
            if !rest.is_empty() {
                new_args.push(rest.join(" "));
            }
            new_args
        })
        .unwrap_or_else(|| env_args.clone());

    let mut opts = Options::new();
    opts.optopt(
        "c",
        "command",
        "pass COMMAND to the invoked shell",
        "COMMAND",
    );
    opts.optflag("h", "help", "display this help message and exit");
    opts.optflag("l", "login", "pretend the shell to be a login shell");
    opts.optflag(
        "p",
        "preserve-environment",
        "preserve the entire environment",
    );
    opts.optopt(
        "s",
        "shell",
        "use SHELL instead of the default /system/bin/sh",
        "SHELL",
    );
    opts.optflag("v", "version", "display version number and exit");
    opts.optflag("V", "", "display version code and exit");
    opts.optflag(
        "M",
        "mount-master",
        "force run in the global mount namespace",
    );
    opts.optflag("", "no-pty", "Do not allocate a new pseudo terminal.");

    // Replace -cn with -z, -mm with -M for supporting getopt_long
    let args = args
        .into_iter()
        .map(|e| {
            if e == "-mm" {
                "-M".to_string()
            } else if e == "-cn" {
                "-z".to_string()
            } else {
                e
            }
        })
        .collect::<Vec<String>>();

    let matches = match opts.parse(&args[1..]) {
        Result::Ok(m) => m,
        Err(f) => {
            println!("{f}");
            print_usage(opts);
            std::process::exit(-1);
        }
    };

    if matches.opt_present("h") {
        print_usage(opts);
        return Ok(());
    }

    if matches.opt_present("v") {
        println!("{}:APatch", defs::VERSION_NAME);
        return Ok(());
    }

    if matches.opt_present("V") {
        println!("{}", defs::VERSION_CODE);
        return Ok(());
    }

    let shell = matches.opt_str("s").unwrap_or("/system/bin/sh".to_string());
    let mut is_login = matches.opt_present("l");
    let preserve_env = matches.opt_present("p");
    let mount_master = matches.opt_present("M");

    // we've made sure that -c is the last option and it already contains the whole command, no need to construct it again
    let args = matches
        .opt_str("c")
        .map(|cmd| vec!["-c".to_string(), cmd])
        .unwrap_or_default();

    let mut free_idx = 0;
    if !matches.free.is_empty() && matches.free[free_idx] == "-" {
        is_login = true;
        free_idx += 1;
    }

    // use current uid if no user specified, these has been done in kernel!
    let mut uid = unsafe { libc::getuid() };
    let gid = unsafe { libc::getgid() };
    if free_idx < matches.free.len() {
        let name = &matches.free[free_idx];
        uid = unsafe {
            #[cfg(target_arch = "aarch64")]
            let pw = libc::getpwnam(name.as_ptr()).as_ref();
            #[cfg(target_arch = "x86_64")]
            let pw = libc::getpwnam(name.as_ptr() as *const i8).as_ref();

            match pw {
                Some(pw) => pw.pw_uid,
                None => name.parse::<u32>().unwrap_or(0),
            }
        }
    }

    // https://github.com/topjohnwu/Magisk/blob/master/native/src/core/su/su_daemon.cpp#L408
    let arg0 = if is_login { "-" } else { &shell };

    let mut command = &mut Command::new(&shell);

    if !preserve_env {
        // This is actually incorrect, I don't know why.
        // command = command.env_clear();

        let pw = unsafe { libc::getpwuid(uid).as_ref() };

        if let Some(pw) = pw {
            let home = unsafe { CStr::from_ptr(pw.pw_dir) };
            let pw_name = unsafe { CStr::from_ptr(pw.pw_name) };

            let home = home.to_string_lossy();
            let pw_name = pw_name.to_string_lossy();

            command = command
                .env("HOME", home.as_ref() as &str)
                .env("USER", pw_name.as_ref() as &str)
                .env("LOGNAME", pw_name.as_ref() as &str)
                .env("SHELL", &shell);
        }
    }

    // add /data/adb/ap/bin to PATH
    #[cfg(any(target_os = "linux", target_os = "android"))]
    add_path_to_env(defs::BINARY_DIR)?;

    // when AP_RC_PATH exists and ENV is not set, set ENV to AP_RC_PATH
    if PathBuf::from(defs::AP_RC_PATH).exists() && env::var("ENV").is_err() {
        command = command.env("ENV", defs::AP_RC_PATH);
    }
    #[cfg(target_os = "android")]
    if !matches.opt_present("no-pty") {
        if let Err(e) = prepare_pty() {
            log::error!("failed to prepare pty: {:?}", e);
        }
    }
    // escape from the current cgroup and become session leader
    // WARNING!!! This cause some root shell hang forever!
    // command = command.process_group(0);
    command = unsafe {
        command.pre_exec(move || {
            umask(0o22);
            utils::switch_cgroups();

            // switch to global mount namespace
            #[cfg(any(target_os = "linux", target_os = "android"))]
            let global_namespace_enable =
                std::fs::read_to_string(defs::GLOBAL_NAMESPACE_FILE).unwrap_or("0".to_string());
            if global_namespace_enable.trim() == "1" || mount_master {
                let _ = utils::switch_mnt_ns(1);
            }

            set_identity(uid, gid);

            Result::Ok(())
        })
    };

    command = command.args(args).arg0(arg0);
    Err(command.exec().into())
}

fn add_path_to_env(path: &str) -> Result<()> {
    let mut paths =
        env::var_os("PATH").map_or(Vec::new(), |val| env::split_paths(&val).collect::<Vec<_>>());
    let new_path = PathBuf::from(path.trim_end_matches('/'));
    paths.push(new_path);
    let new_path_env = env::join_paths(paths)?;
    unsafe { env::set_var("PATH", new_path_env) };
    Ok(())
}

```

`apd/src/assets.rs`:

```rs
use anyhow::Result;
use const_format::concatcp;

use crate::{defs::BINARY_DIR, utils};

pub const RESETPROP_PATH: &str = concatcp!(BINARY_DIR, "resetprop");
pub const BUSYBOX_PATH: &str = concatcp!(BINARY_DIR, "busybox");
pub const MAGISKPOLICY_PATH: &str = concatcp!(BINARY_DIR, "magiskpolicy");

pub fn ensure_binaries() -> Result<()> {
    utils::ensure_binary(RESETPROP_PATH)?;
    utils::ensure_binary(BUSYBOX_PATH)?;
    utils::ensure_binary(MAGISKPOLICY_PATH)?;
    Ok(())
}

```

`apd/src/banner`:

```
    _    ____       _       _     
   / \  |  _ \ __ _| |_ ___| |__  
  / _ \ | |_) / _` | __/ __| '_ \ 
 / ___ \|  __/ (_| | || (__| | | |
/_/   \_\_|   \__,_|\__\___|_| |_|

```

`apd/src/cli.rs`:

```rs
use crate::{defs, event, lua, module, supercall, utils};
#[cfg(target_os = "android")]
use android_logger::Config;
use anyhow::Result;
use clap::Parser;
#[cfg(target_os = "android")]
use log::LevelFilter;

/// APatch cli
#[derive(Parser, Debug)]
#[command(author, version = defs::VERSION_CODE, about, long_about = None)]
struct Args {
    #[arg(
        short,
        long,
        value_name = "KEY",
        help = "Super key for authentication root"
    )]
    superkey: Option<String>,
    #[command(subcommand)]
    command: Commands,
}

#[derive(clap::Subcommand, Debug)]
enum Commands {
    /// Manage APatch modules
    Module {
        #[command(subcommand)]
        command: Module,
    },

    /// Trigger `post-fs-data` event
    PostFsData,

    /// Trigger `service` event
    Services,

    /// Trigger `boot-complete` event
    BootCompleted,

    /// Start uid listener for synchronizing root list
    UidListener,

    /// SELinux policy Patch tool
    Sepolicy {
        #[command(subcommand)]
        command: Sepolicy,
    },
}

#[derive(clap::Subcommand, Debug)]
enum Module {
    /// Install module <ZIP>
    Install {
        /// module zip file path
        zip: String,
    },

    /// Uninstall module <id>
    Uninstall {
        /// module id
        id: String,
    },

    /// enable module <id>
    Enable {
        /// module id
        id: String,
    },

    /// disable module <id>
    Disable {
        // module id
        id: String,
    },

    /// run action for module <id>
    Action {
        // module id
        id: String,
    },
    /// module lua runner
    Lua {
        // module id
        id: String,
        // lua function
        function: String,
    },
    /// list all modules
    List,
}

#[derive(clap::Subcommand, Debug)]
enum Sepolicy {
    /// Check if sepolicy statement is supported/valid
    Check {
        /// sepolicy statements
        sepolicy: String,
    },
}

pub fn run() -> Result<()> {
    #[cfg(target_os = "android")]
    android_logger::init_once(
        Config::default()
            .with_max_level(LevelFilter::Trace) // limit log level
            .with_tag("APatchD")
            .with_filter(
                android_logger::FilterBuilder::new()
                    .filter_level(LevelFilter::Trace)
                    .filter_module("notify", LevelFilter::Warn)
                    .build(),
            ),
    );

    #[cfg(not(target_os = "android"))]
    env_logger::init();

    // the kernel executes su with argv[0] = "/system/bin/kp" or "/system/bin/su" or "su" or "kp" and replace it with us
    let arg0 = std::env::args().next().unwrap_or_default();
    if arg0.ends_with("kp") || arg0.ends_with("su") {
        return crate::apd::root_shell();
    }

    let cli = Args::parse();

    log::info!("command: {:?}", cli.command);

    if let Some(ref _superkey) = cli.superkey {
        supercall::privilege_apd_profile(&cli.superkey);
    }

    let result = match cli.command {
        Commands::PostFsData => event::on_post_data_fs(cli.superkey),

        Commands::BootCompleted => event::on_boot_completed(cli.superkey),

        Commands::UidListener => event::start_uid_listener(),

        Commands::Module { command } => {
            #[cfg(any(target_os = "linux", target_os = "android"))]
            {
                utils::switch_mnt_ns(1)?;
            }
            match command {
                Module::Install { zip } => module::install_module(&zip),
                Module::Uninstall { id } => module::uninstall_module(&id),
                Module::Action { id } => module::run_action(&id),
                Module::Lua { id, function } => {
                    lua::run_lua(&id, &function, false, true).map_err(|e| anyhow::anyhow!("{}", e))
                }
                Module::Enable { id } => module::enable_module(&id),
                Module::Disable { id } => module::disable_module(&id),
                Module::List => module::list_modules(),
            }
        }

        Commands::Sepolicy { command } => match command {
            Sepolicy::Check { sepolicy } => crate::sepolicy::check_rule(&sepolicy),
        },

        Commands::Services => event::on_services(cli.superkey),
    };

    if let Err(e) = &result {
        log::error!("Error: {:?}", e);
    }
    result
}

```

`apd/src/defs.rs`:

```rs
use const_format::concatcp;

pub const ADB_DIR: &str = "/data/adb/";
pub const WORKING_DIR: &str = concatcp!(ADB_DIR, "ap/");
pub const BINARY_DIR: &str = concatcp!(WORKING_DIR, "bin/");
pub const APATCH_LOG_FOLDER: &str = concatcp!(WORKING_DIR, "log/");

pub const AP_RC_PATH: &str = concatcp!(WORKING_DIR, ".aprc");
pub const GLOBAL_NAMESPACE_FILE: &str = concatcp!(ADB_DIR, ".global_namespace_enable");
pub const DAEMON_PATH: &str = concatcp!(ADB_DIR, "apd");

pub const MODULE_DIR: &str = concatcp!(ADB_DIR, "modules/");

// warning: this directory should not change, or you need to change the code in module_installer.sh!!!
pub const MODULE_UPDATE_DIR: &str = concatcp!(ADB_DIR, "modules_update/");

pub const TEMP_DIR: &str = "/debug_ramdisk";
pub const TEMP_DIR_LEGACY: &str = "/sbin";

pub const MODULE_WEB_DIR: &str = "webroot";
pub const MODULE_ACTION_SH: &str = "action.sh";
pub const DISABLE_FILE_NAME: &str = "disable";
pub const UPDATE_FILE_NAME: &str = "update";
pub const REMOVE_FILE_NAME: &str = "remove";

// Metamodule support
pub const METAMODULE_MOUNT_SCRIPT: &str = "metamount.sh";
pub const METAMODULE_METAINSTALL_SCRIPT: &str = "metainstall.sh";
pub const METAMODULE_METAUNINSTALL_SCRIPT: &str = "metauninstall.sh";
pub const METAMODULE_DIR: &str = concatcp!(ADB_DIR, "metamodule/");

pub const PTS_NAME: &str = "pts";

pub const VERSION_CODE: &str = include_str!(concat!(env!("OUT_DIR"), "/VERSION_CODE"));
pub const VERSION_NAME: &str = include_str!(concat!(env!("OUT_DIR"), "/VERSION_NAME"));

```

`apd/src/event.rs`:

```rs
use std::{
    env,
    ffi::CStr,
    fs,
    os::unix::{fs::PermissionsExt, process::CommandExt},
    path::{Path, PathBuf},
    process::Command,
    sync::{Arc, Mutex},
    thread,
    time::Duration,
};

use anyhow::{Context, Result};
use libc::SIGPWR;
use log::{info, warn};
use notify::{
    Config, Event, EventKind, INotifyWatcher, RecursiveMode, Watcher,
    event::{ModifyKind, RenameMode},
};
use signal_hook::{consts::signal::*, iterator::Signals};

use crate::{
    assets, defs, lua, metamodule, module, restorecon, supercall,
    supercall::{
        fork_for_result, init_load_package_uid_config, init_load_su_path, refresh_ap_package_list,
    },
    utils::{self, switch_cgroups},
};

pub fn on_post_data_fs(superkey: Option<String>) -> Result<()> {
    utils::umask(0);
    use std::process::Stdio;
    #[cfg(unix)]
    init_load_package_uid_config(&superkey);

    init_load_su_path(&superkey);

    let args = ["/data/adb/ap/bin/magiskpolicy", "--magisk", "--live"];
    fork_for_result("/data/adb/ap/bin/magiskpolicy", &args, &superkey);

    info!("Re-privilege apd profile after injecting sepolicy");
    supercall::privilege_apd_profile(&superkey);

    if utils::has_magisk() {
        warn!("Magisk detected, skip post-fs-data!");
        return Ok(());
    }

    // Create log environment
    if !Path::new(defs::APATCH_LOG_FOLDER).exists() {
        fs::create_dir(defs::APATCH_LOG_FOLDER).expect("Failed to create log folder");
        let permissions = fs::Permissions::from_mode(0o700);
        fs::set_permissions(defs::APATCH_LOG_FOLDER, permissions)
            .expect("Failed to set permissions");
    }
    let command_string = format!(
        "rm -rf {}*.old.log; for file in {}*; do mv \"$file\" \"$file.old.log\"; done",
        defs::APATCH_LOG_FOLDER,
        defs::APATCH_LOG_FOLDER
    );
    let mut args = vec!["-c", &command_string];
    // for all file to .old
    let result = utils::run_command("sh", &args, None)?.wait()?;
    if result.success() {
        info!("Successfully deleted .old files.");
    } else {
        info!("Failed to delete .old files.");
    }
    let logcat_path = format!("{}locat.log", defs::APATCH_LOG_FOLDER);
    let dmesg_path = format!("{}dmesg.log", defs::APATCH_LOG_FOLDER);
    let bootlog = fs::File::create(dmesg_path)?;
    args = vec![
        "-s",
        "9",
        "120s",
        "logcat",
        "-b",
        "main,system,crash",
        "-f",
        &logcat_path,
        "logcatcher-bootlog:S",
        "&",
    ];
    let _ = unsafe {
        Command::new("timeout")
            .process_group(0)
            .pre_exec(|| {
                switch_cgroups();
                Ok(())
            })
            .args(args)
            .spawn()
    };
    args = vec!["-s", "9", "120s", "dmesg", "-w"];
    let _result = unsafe {
        Command::new("timeout")
            .process_group(0)
            .pre_exec(|| {
                switch_cgroups();
                Ok(())
            })
            .args(args)
            .stdout(Stdio::from(bootlog))
            .spawn()
    };

    let key = "KERNELPATCH_VERSION";
    match env::var(key) {
        Ok(value) => println!("{}: {}", key, value),
        Err(_) => println!("{} not found", key),
    }

    let key = "KERNEL_VERSION";
    match env::var(key) {
        Ok(value) => println!("{}: {}", key, value),
        Err(_) => println!("{} not found", key),
    }

    let safe_mode = utils::is_safe_mode(superkey.clone());

    if safe_mode {
        // we should still mount modules.img to `/data/adb/modules` in safe mode
        // becuase we may need to operate the module dir in safe mode
        warn!("safe mode, skip common post-fs-data.d scripts");
        if let Err(e) = module::disable_all_modules() {
            warn!("disable all modules failed: {}", e);
        }
    } else {
        // Then exec common post-fs-data scripts
        if let Err(e) = module::exec_common_scripts("post-fs-data.d", true) {
            warn!("exec common post-fs-data scripts failed: {}", e);
        }
    }
    let module_update_dir = defs::MODULE_UPDATE_DIR; //save module place
    let module_dir = defs::MODULE_DIR; // run modules place
    let module_update_flag = Path::new(defs::WORKING_DIR).join(defs::UPDATE_FILE_NAME); // if update ,there will be renewed modules file
    assets::ensure_binaries().with_context(|| "binary missing")?;

    if Path::new(defs::MODULE_UPDATE_DIR).exists() {
        module::handle_updated_modules()?;
        fs::remove_dir_all(module_update_dir)?;
    }

    if safe_mode {
        warn!("safe mode, skip post-fs-data scripts and disable all modules!");
        if let Err(e) = module::disable_all_modules() {
            warn!("disable all modules failed: {}", e);
        }
        return Ok(());
    }

    if let Err(e) = module::prune_modules() {
        warn!("prune modules failed: {}", e);
    }

    if let Err(e) = restorecon::restorecon() {
        warn!("restorecon failed: {}", e);
    }

    // load sepolicy.rule
    if module::load_sepolicy_rule().is_err() {
        warn!("load sepolicy.rule failed");
    }

    if let Err(e) = metamodule::exec_mount_script(module_dir) {
        warn!("execute metamodule mount failed: {e}");
    }

    // exec modules post-fs-data scripts
    // TODO: Add timeout
    if let Err(e) = module::exec_stage_script("post-fs-data", true) {
        warn!("exec post-fs-data scripts failed: {}", e);
    }
    if let Err(e) = lua::exec_stage_lua("post-fs-data", true, superkey.as_deref().unwrap_or("")) {
        warn!("Failed to exec post-fs-data lua: {}", e);
    }
    // load system.prop
    if let Err(e) = module::load_system_prop() {
        warn!("load system.prop failed: {}", e);
    }

    info!("remove update flag");
    let _ = fs::remove_file(module_update_flag);

    run_stage("post-mount", superkey, true);

    env::set_current_dir("/").with_context(|| "failed to chdir to /")?;

    Ok(())
}

fn run_stage(stage: &str, superkey: Option<String>, block: bool) {
    utils::umask(0);

    if utils::has_magisk() {
        warn!("Magisk detected, skip {stage}");
        return;
    }

    if utils::is_safe_mode(superkey.clone()) {
        warn!("safe mode, skip {stage} scripts");
        if let Err(e) = module::disable_all_modules() {
            warn!("disable all modules failed: {}", e);
        }
        return;
    }

    // execute metamodule stage script first (priority)
    if let Err(e) = metamodule::exec_stage_script(stage, block) {
        warn!("Failed to exec metamodule {stage} script: {e}");
    }

    if let Err(e) = module::exec_common_scripts(&format!("{stage}.d"), block) {
        warn!("Failed to exec common {stage} scripts: {e}");
    }
    if let Err(e) = module::exec_stage_script(stage, block) {
        warn!("Failed to exec {stage} scripts: {e}");
    }
    if let Err(e) = lua::exec_stage_lua(stage, block, superkey.as_deref().unwrap_or("")) {
        warn!("Failed to exec {stage} lua: {e}");
    }
}

pub fn on_services(superkey: Option<String>) -> Result<()> {
    info!("on_services triggered!");
    run_stage("service", superkey, false);

    Ok(())
}

fn run_uid_monitor() {
    info!("Trigger run_uid_monitor!");

    let mut command = &mut Command::new("/data/adb/apd");
    {
        command = command.process_group(0);
        command = unsafe {
            command.pre_exec(|| {
                // ignore the error?
                switch_cgroups();
                Ok(())
            })
        };
    }
    command = command.arg("uid-listener");

    command
        .spawn()
        .map(|_| ())
        .expect("[run_uid_monitor] Failed to run uid monitor");
}

pub fn on_boot_completed(superkey: Option<String>) -> Result<()> {
    info!("on_boot_completed triggered!");

    run_stage("boot-completed", superkey, false);

    run_uid_monitor();
    Ok(())
}

pub fn start_uid_listener() -> Result<()> {
    info!("start_uid_listener triggered!");
    println!("[start_uid_listener] Registering...");

    // create inotify instance
    const SYS_PACKAGES_LIST_TMP: &str = "/data/system/packages.list.tmp";
    let sys_packages_list_tmp = PathBuf::from(&SYS_PACKAGES_LIST_TMP);
    let dir: PathBuf = sys_packages_list_tmp.parent().unwrap().into();

    let (tx, rx) = std::sync::mpsc::channel();
    let tx_clone = tx.clone();
    let mutex = Arc::new(Mutex::new(()));

    {
        let mutex_clone = mutex.clone();
        thread::spawn(move || {
            let mut signals = Signals::new(&[SIGTERM, SIGINT, SIGPWR]).unwrap();
            for sig in signals.forever() {
                log::warn!("[shutdown] Caught signal {sig}, refreshing package list...");
                let skey = CStr::from_bytes_with_nul(b"su\0")
                    .expect("[shutdown_listener] CStr::from_bytes_with_nul failed");
                refresh_ap_package_list(&skey, &mutex_clone);
                break; // 执行一次后退出线程
            }
        });
    }

    let mut watcher = INotifyWatcher::new(
        move |ev: notify::Result<Event>| match ev {
            Ok(Event {
                kind: EventKind::Modify(ModifyKind::Name(RenameMode::Both)),
                paths,
                ..
            }) => {
                if paths.contains(&sys_packages_list_tmp) {
                    info!("[uid_monitor] System packages list changed, sending to tx...");
                    tx_clone.send(false).unwrap()
                }
            }
            Err(err) => warn!("inotify error: {err}"),
            _ => (),
        },
        Config::default(),
    )?;

    watcher.watch(dir.as_ref(), RecursiveMode::NonRecursive)?;

    let mut debounce = false;
    while let Ok(delayed) = rx.recv() {
        if delayed {
            debounce = false;
            let skey = CStr::from_bytes_with_nul(b"su\0")
                .expect("[start_uid_listener] CStr::from_bytes_with_nul failed");
            refresh_ap_package_list(&skey, &mutex);
        } else if !debounce {
            thread::sleep(Duration::from_secs(1));
            debounce = true;
            tx.send(true)?;
        }
    }

    Ok(())
}

```

`apd/src/installer.sh`:

```sh
#!/system/bin/sh
############################################
# APatch Module installer script
# mostly from module_installer.sh
# and util_functions.sh in Magisk
############################################

umask 022

ui_print() {
  if $BOOTMODE; then
    echo "$1"
  else
    echo -e "ui_print $1\nui_print" >> /proc/self/fd/$OUTFD
  fi
}

toupper() {
  echo "$@" | tr '[:lower:]' '[:upper:]'
}

grep_cmdline() {
  local REGEX="s/^$1=//p"
  { echo $(cat /proc/cmdline)$(sed -e 's/[^"]//g' -e 's/""//g' /proc/cmdline) | xargs -n 1; \
    sed -e 's/ = /=/g' -e 's/, /,/g' -e 's/"//g' /proc/bootconfig; \
  } 2>/dev/null | sed -n "$REGEX"
}

grep_prop() {
  local REGEX="s/^$1=//p"
  shift
  local FILES=$@
  [ -z "$FILES" ] && FILES='/system/build.prop'
  cat $FILES 2>/dev/null | dos2unix | sed -n "$REGEX" | head -n 1
}

grep_get_prop() {
  local result=$(grep_prop $@)
  if [ -z "$result" ]; then
    # Fallback to getprop
    getprop "$1"
  else
    echo $result
  fi
}

is_mounted() {
  grep -q " $(readlink -f $1) " /proc/mounts 2>/dev/null
  return $?
}

abort() {
  ui_print "$1"
  $BOOTMODE || recovery_cleanup
  [ ! -z $MODPATH ] && rm -rf $MODPATH
  rm -rf $TMPDIR
  exit 1
}

print_title() {
  local len line1len line2len bar
  line1len=$(echo -n $1 | wc -c)
  line2len=$(echo -n $2 | wc -c)
  len=$line2len
  [ $line1len -gt $line2len ] && len=$line1len
  len=$((len + 2))
  bar=$(printf "%${len}s" | tr ' ' '*')
  ui_print "$bar"
  ui_print " $1 "
  [ "$2" ] && ui_print " $2 "
  ui_print "$bar"
}

######################
# Environment Related
######################

setup_flashable() {
  ensure_bb
  $BOOTMODE && return
  if [ -z $OUTFD ] || readlink /proc/$$/fd/$OUTFD | grep -q /tmp; then
    # We will have to manually find out OUTFD
    for FD in `ls /proc/$$/fd`; do
      if readlink /proc/$$/fd/$FD | grep -q pipe; then
        if ps | grep -v grep | grep -qE " 3 $FD |status_fd=$FD"; then
          OUTFD=$FD
          break
        fi
      fi
    done
  fi
  recovery_actions
}

ensure_bb() {
  :
}

recovery_actions() {
  :
}

recovery_cleanup() {
  :
}

#######################
# Installation Related
#######################

# find_block [partname...]
find_block() {
  local BLOCK DEV DEVICE DEVNAME PARTNAME UEVENT
  for BLOCK in "$@"; do
    DEVICE=`find /dev/block \( -type b -o -type c -o -type l \) -iname $BLOCK | head -n 1` 2>/dev/null
    if [ ! -z $DEVICE ]; then
      readlink -f $DEVICE
      return 0
    fi
  done
  # Fallback by parsing sysfs uevents
  for UEVENT in /sys/dev/block/*/uevent; do
    DEVNAME=`grep_prop DEVNAME $UEVENT`
    PARTNAME=`grep_prop PARTNAME $UEVENT`
    for BLOCK in "$@"; do
      if [ "$(toupper $BLOCK)" = "$(toupper $PARTNAME)" ]; then
        echo /dev/block/$DEVNAME
        return 0
      fi
    done
  done
  # Look just in /dev in case we're dealing with MTD/NAND without /dev/block devices/links
  for DEV in "$@"; do
    DEVICE=`find /dev \( -type b -o -type c -o -type l \) -maxdepth 1 -iname $DEV | head -n 1` 2>/dev/null
    if [ ! -z $DEVICE ]; then
      readlink -f $DEVICE
      return 0
    fi
  done
  return 1
}

# setup_mntpoint <mountpoint>
setup_mntpoint() {
  local POINT=$1
  [ -L $POINT ] && mv -f $POINT ${POINT}_link
  if [ ! -d $POINT ]; then
    rm -f $POINT
    mkdir -p $POINT
  fi
}

# mount_name <partname(s)> <mountpoint> <flag>
mount_name() {
  local PART=$1
  local POINT=$2
  local FLAG=$3
  setup_mntpoint $POINT
  is_mounted $POINT && return
  # First try mounting with fstab
  mount $FLAG $POINT 2>/dev/null
  if ! is_mounted $POINT; then
    local BLOCK=$(find_block $PART)
    mount $FLAG $BLOCK $POINT || return
  fi
  ui_print "- Mounting $POINT"
}

# mount_ro_ensure <partname(s)> <mountpoint>
mount_ro_ensure() {
  # We handle ro partitions only in recovery
  $BOOTMODE && return
  local PART=$1
  local POINT=$2
  mount_name "$PART" $POINT '-o ro'
  is_mounted $POINT || abort "! Cannot mount $POINT"
}

mount_partitions() {
  # Check A/B slot
  SLOT=`grep_cmdline androidboot.slot_suffix`
  if [ -z $SLOT ]; then
    SLOT=`grep_cmdline androidboot.slot`
    [ -z $SLOT ] || SLOT=_${SLOT}
  fi
  [ -z $SLOT ] || ui_print "- Current boot slot: $SLOT"

  # Mount ro partitions
  if is_mounted /system_root; then
    umount /system 2&>/dev/null
    umount /system_root 2&>/dev/null
  fi
  mount_ro_ensure "system$SLOT app$SLOT" /system
  if [ -f /system/init -o -L /system/init ]; then
    SYSTEM_ROOT=true
    setup_mntpoint /system_root
    if ! mount --move /system /system_root; then
      umount /system
      umount -l /system 2>/dev/null
      mount_ro_ensure "system$SLOT app$SLOT" /system_root
    fi
    mount -o bind /system_root/system /system
  else
    SYSTEM_ROOT=false
    grep ' / ' /proc/mounts | grep -qv 'rootfs' || grep -q ' /system_root ' /proc/mounts && SYSTEM_ROOT=true
  fi
  # /vendor is used only on some older devices for recovery AVBv1 signing so is not critical if fails
  [ -L /system/vendor ] && mount_name vendor$SLOT /vendor '-o ro'
  $SYSTEM_ROOT && ui_print "- Device is system-as-root"

  # Mount sepolicy rules dir locations in recovery (best effort)
  if ! $BOOTMODE; then
    mount_name "cache cac" /cache
    mount_name metadata /metadata
    mount_name persist /persist
  fi
}

api_level_arch_detect() {
  API=$(grep_get_prop ro.build.version.sdk)
  ABI=$(grep_get_prop ro.product.cpu.abi)
  if [ "$ABI" = "x86" ]; then
    ARCH=x86
    ABI32=x86
    IS64BIT=false
  elif [ "$ABI" = "arm64-v8a" ]; then
    ARCH=arm64
    ABI32=armeabi-v7a
    IS64BIT=true
  elif [ "$ABI" = "x86_64" ]; then
    ARCH=x64
    ABI32=x86
    IS64BIT=true
  else
    ARCH=arm
    ABI=armeabi-v7a
    ABI32=armeabi-v7a
    IS64BIT=false
  fi
}

#################
# Module Related
#################

set_perm() {
  chown $2:$3 $1 || return 1
  chmod $4 $1 || return 1
  local CON=$5
  [ -z $CON ] && CON=u:object_r:system_file:s0
  chcon $CON $1 || return 1
}

set_perm_recursive() {
  find $1 -type d 2>/dev/null | while read dir; do
    set_perm $dir $2 $3 $4 $6
  done
  find $1 -type f -o -type l 2>/dev/null | while read file; do
    set_perm $file $2 $3 $5 $6
  done
}

mktouch() {
  mkdir -p ${1%/*} 2>/dev/null
  [ -z $2 ] && touch $1 || echo $2 > $1
  chmod 644 $1
}

mark_remove() {
  mkdir -p ${1%/*} 2>/dev/null
  mknod $1 c 0 0
  chmod 644 $1
}

mark_replace() {
  # REPLACE must be directory!!!
  # https://docs.kernel.org/filesystems/overlayfs.html#whiteouts-and-opaque-directories
  mkdir -p $1 2>/dev/null
  setfattr -n trusted.overlay.opaque -v y $1
  chmod 644 $1
}

request_size_check() {
  reqSizeM=`du -ms "$1" | cut -f1`
}

request_zip_size_check() {
  reqSizeM=`unzip -l "$1" | tail -n 1 | awk '{ print int(($1 - 1) / 1048576 + 1) }'`
}

boot_actions() { return; }

# Require ZIPFILE to be set
is_legacy_script() {
  unzip -l "$ZIPFILE" install.sh | grep -q install.sh
  return $?
}

handle_partition() {
    # if /system/vendor is a symlink, we need to move it out of $MODPATH/system, otherwise it will be overlayed
    # if /system/vendor is a normal directory, it is ok to overlay it and we don't need to overlay it separately.
    if [ ! -e $MODPATH/system/$1 ]; then
        # no partition found
        return;
    fi

    if [ -L "/system/$1" ] && [ "$(readlink -f /system/$1)" = "/$1" ]; then
        ui_print "- Handle partition /$1"
        # we create a symlink if module want to access $MODPATH/system/$1
        # but it doesn't always work(ie. write it in post-fs-data.sh would fail because it is readonly)
        mv -f $MODPATH/system/$1 $MODPATH/$1 && ln -sf ../$1 $MODPATH/system/$1
    fi
}

# Require OUTFD, ZIPFILE to be set
install_module() {
  rm -rf $TMPDIR
  mkdir -p $TMPDIR
  chcon u:object_r:system_file:s0 $TMPDIR
  cd $TMPDIR

  mount_partitions
  api_level_arch_detect

  # Setup busybox and binaries
  if $BOOTMODE; then
    boot_actions
  else
    recovery_actions
  fi

  # Extract prop file
  unzip -o "$ZIPFILE" module.prop -d $TMPDIR >&2
  [ ! -f $TMPDIR/module.prop ] && abort "! Unable to extract zip file!"

  local MODDIRNAME=modules
  $BOOTMODE && MODDIRNAME=modules_update
  local MODULEROOT=$NVBASE/$MODDIRNAME
  MODID=`grep_prop id $TMPDIR/module.prop`
  MODNAME=`grep_prop name $TMPDIR/module.prop`
  MODAUTH=`grep_prop author $TMPDIR/module.prop`
  MODPATH=$MODULEROOT/$MODID

  # Create mod paths
  rm -rf $MODPATH
  mkdir -p $MODPATH

  if is_legacy_script; then
    unzip -oj "$ZIPFILE" module.prop install.sh uninstall.sh 'common/*' -d $TMPDIR >&2

    # Load install script
    . $TMPDIR/install.sh

    # Callbacks
    print_modname
    on_install

    [ -f $TMPDIR/uninstall.sh ] && cp -af $TMPDIR/uninstall.sh $MODPATH/uninstall.sh
    $SKIPMOUNT && touch $MODPATH/skip_mount
    $PROPFILE && cp -af $TMPDIR/system.prop $MODPATH/system.prop
    cp -af $TMPDIR/module.prop $MODPATH/module.prop
    $POSTFSDATA && cp -af $TMPDIR/post-fs-data.sh $MODPATH/post-fs-data.sh
    $LATESTARTSERVICE && cp -af $TMPDIR/service.sh $MODPATH/service.sh

    ui_print "- Setting permissions"
    set_permissions
  else
    print_title "$MODNAME" "by $MODAUTH"
    print_title "Powered by APatch"

    unzip -o "$ZIPFILE" customize.sh -d $MODPATH >&2

    if ! grep -q '^SKIPUNZIP=1$' $MODPATH/customize.sh 2>/dev/null; then
      ui_print "- Extracting module files"
      unzip -o "$ZIPFILE" -x 'META-INF/*' -d $MODPATH >&2

      # Default permissions
      set_perm_recursive $MODPATH 0 0 0755 0644
      set_perm_recursive $MODPATH/system/bin 0 2000 0755 0755
      set_perm_recursive $MODPATH/system/xbin 0 2000 0755 0755
      set_perm_recursive $MODPATH/system/system_ext/bin 0 2000 0755 0755
      set_perm_recursive $MODPATH/system/vendor 0 2000 0755 0755 u:object_r:vendor_file:s0
    fi

    # Load customization script
    [ -f $MODPATH/customize.sh ] && . $MODPATH/customize.sh
  fi

  # Handle replace folders
  for TARGET in $REPLACE; do
    ui_print "- Replace target: $TARGET"
    mark_replace $MODPATH$TARGET
  done

  # Handle remove files
  for TARGET in $REMOVE; do
    ui_print "- Remove target: $TARGET"
    mark_remove $MODPATH$TARGET
  done

  handle_partition vendor
  handle_partition system_ext
  handle_partition product

  if $BOOTMODE; then
    mktouch $NVBASE/modules/$MODID/update
    rm -rf $NVBASE/modules/$MODID/remove 2>/dev/null
    rm -rf $NVBASE/modules/$MODID/disable 2>/dev/null
    cp -af $MODPATH/module.prop $NVBASE/modules/$MODID/module.prop
  fi

  # Remove stuff that doesn't belong to modules and clean up any empty directories
  rm -rf \
  $MODPATH/system/placeholder $MODPATH/customize.sh \
  $MODPATH/README.md $MODPATH/.git*
  rmdir -p $MODPATH 2>/dev/null

  cd /
  $BOOTMODE || recovery_cleanup
  rm -rf $TMPDIR

  ui_print "- Done"
}

##########
# Presets
##########

# Detect whether in boot mode
[ -z $BOOTMODE ] && ps | grep zygote | grep -qv grep && BOOTMODE=true
[ -z $BOOTMODE ] && ps -A 2>/dev/null | grep zygote | grep -qv grep && BOOTMODE=true
[ -z $BOOTMODE ] && BOOTMODE=false

NVBASE=/data/adb
TMPDIR=/dev/tmp
POSTFSDATAD=$NVBASE/post-fs-data.d
SERVICED=$NVBASE/service.d

# Some modules dependents on this
export MAGISK_VER=27.0
export MAGISK_VER_CODE=27000

```

`apd/src/installer_bind.sh`:

```sh
#!/system/bin/sh
############################################
# APatch Module installer script
# mostly from module_installer.sh
# and util_functions.sh in Magisk
############################################

umask 022

ui_print() {
  if $BOOTMODE; then
    echo "$1"
  else
    echo -e "ui_print $1\nui_print" >> /proc/self/fd/$OUTFD
  fi
}

toupper() {
  echo "$@" | tr '[:lower:]' '[:upper:]'
}

grep_cmdline() {
  local REGEX="s/^$1=//p"
  { echo $(cat /proc/cmdline)$(sed -e 's/[^"]//g' -e 's/""//g' /proc/cmdline) | xargs -n 1; \
    sed -e 's/ = /=/g' -e 's/, /,/g' -e 's/"//g' /proc/bootconfig; \
  } 2>/dev/null | sed -n "$REGEX"
}

grep_prop() {
  local REGEX="s/$1=//p"
  shift
  local FILES=$@
  [ -z "$FILES" ] && FILES='/system/build.prop'
  cat $FILES 2>/dev/null | dos2unix | sed -n "$REGEX" | head -n 1 | xargs
}

grep_get_prop() {
  local result=$(grep_prop $@)
  if [ -z "$result" ]; then
    # Fallback to getprop
    getprop "$1"
  else
    echo $result
  fi
}

is_mounted() {
  grep -q " $(readlink -f $1) " /proc/mounts 2>/dev/null
  return $?
}

abort() {
  ui_print "$1"
  $BOOTMODE || recovery_cleanup
  [ ! -z $MODPATH ] && rm -rf $MODPATH
  rm -rf $TMPDIR
  exit 1
}

print_title() {
  local len line1len line2len bar
  line1len=$(echo -n $1 | wc -c)
  line2len=$(echo -n $2 | wc -c)
  len=$line2len
  [ $line1len -gt $line2len ] && len=$line1len
  len=$((len + 2))
  bar=$(printf "%${len}s" | tr ' ' '*')
  ui_print "$bar"
  ui_print " $1 "
  [ "$2" ] && ui_print " $2 "
  ui_print "$bar"
}

check_sepolicy() {
    /data/adb/apd sepolicy check "$1"
    return $?
}

######################
# Environment Related
######################

setup_flashable() {
  ensure_bb
  $BOOTMODE && return
  if [ -z $OUTFD ] || readlink /proc/$$/fd/$OUTFD | grep -q /tmp; then
    # We will have to manually find out OUTFD
    for FD in /proc/$$/fd/*; do
      if readlink /proc/$$/fd/$FD | grep -q pipe; then
        if ps | grep -v grep | grep -qE " 3 $FD |status_fd=$FD"; then
          OUTFD=$FD
          break
        fi
      fi
    done
  fi
  recovery_actions
}

ensure_bb() {
  :
}

recovery_actions() {
  :
}

recovery_cleanup() {
  :
}

#######################
# Installation Related
#######################

# find_block [partname...]
find_block() {
  local BLOCK DEV DEVICE DEVNAME PARTNAME UEVENT
  for BLOCK in "$@"; do
    DEVICE=`find /dev/block \( -type b -o -type c -o -type l \) -iname $BLOCK | head -n 1` 2>/dev/null
    if [ ! -z $DEVICE ]; then
      readlink -f $DEVICE
      return 0
    fi
  done
  # Fallback by parsing sysfs uevents
  for UEVENT in /sys/dev/block/*/uevent; do
    DEVNAME=`grep_prop DEVNAME $UEVENT`
    PARTNAME=`grep_prop PARTNAME $UEVENT`
    for BLOCK in "$@"; do
      if [ "$(toupper $BLOCK)" = "$(toupper $PARTNAME)" ]; then
        echo /dev/block/$DEVNAME
        return 0
      fi
    done
  done
  # Look just in /dev in case we're dealing with MTD/NAND without /dev/block devices/links
  for DEV in "$@"; do
    DEVICE=`find /dev \( -type b -o -type c -o -type l \) -maxdepth 1 -iname $DEV | head -n 1` 2>/dev/null
    if [ ! -z $DEVICE ]; then
      readlink -f $DEVICE
      return 0
    fi
  done
  return 1
}

# setup_mntpoint <mountpoint>
setup_mntpoint() {
  local POINT=$1
  [ -L $POINT ] && mv -f $POINT ${POINT}_link
  if [ ! -d $POINT ]; then
    rm -f $POINT
    mkdir -p $POINT
  fi
}

# mount_name <partname(s)> <mountpoint> <flag>
mount_name() {
  local PART=$1
  local POINT=$2
  local FLAG=$3
  setup_mntpoint $POINT
  is_mounted $POINT && return
  # First try mounting with fstab
  mount $FLAG $POINT 2>/dev/null
  if ! is_mounted $POINT; then
    local BLOCK=$(find_block $PART)
    mount $FLAG $BLOCK $POINT || return
  fi
  ui_print "- Mounting $POINT"
}

# mount_ro_ensure <partname(s)> <mountpoint>
mount_ro_ensure() {
  # We handle ro partitions only in recovery
  $BOOTMODE && return
  local PART=$1
  local POINT=$2
  mount_name "$PART" $POINT '-o ro'
  is_mounted $POINT || abort "! Cannot mount $POINT"
}

mount_partitions() {
  # Check A/B slot
  SLOT=`grep_cmdline androidboot.slot_suffix`
  if [ -z $SLOT ]; then
    SLOT=`grep_cmdline androidboot.slot`
    [ -z $SLOT ] || SLOT=_${SLOT}
  fi
  [ -z $SLOT ] || ui_print "- Current boot slot: $SLOT"

  # Mount ro partitions
  if is_mounted /system_root; then
    umount /system 2&>/dev/null
    umount /system_root 2&>/dev/null
  fi
  mount_ro_ensure "system$SLOT app$SLOT" /system
  if [ -f /system/init -o -L /system/init ]; then
    SYSTEM_ROOT=true
    setup_mntpoint /system_root
    if ! mount --move /system /system_root; then
      umount /system
      umount -l /system 2>/dev/null
      mount_ro_ensure "system$SLOT app$SLOT" /system_root
    fi
    mount -o bind /system_root/system /system
  else
    SYSTEM_ROOT=false
    grep ' / ' /proc/mounts | grep -qv 'rootfs' || grep -q ' /system_root ' /proc/mounts && SYSTEM_ROOT=true
  fi
  # /vendor is used only on some older devices for recovery AVBv1 signing so is not critical if fails
  [ -L /system/vendor ] && mount_name vendor$SLOT /vendor '-o ro'
  $SYSTEM_ROOT && ui_print "- Device is system-as-root"

  # Mount sepolicy rules dir locations in recovery (best effort)
  if ! $BOOTMODE; then
    mount_name "cache cac" /cache
    mount_name metadata /metadata
    mount_name persist /persist
  fi
}

api_level_arch_detect() {
  API=$(grep_get_prop ro.build.version.sdk)
  ABI=$(grep_get_prop ro.product.cpu.abi)
  if [ "$ABI" = "x86" ]; then
    ARCH=x86
    ABI32=x86
    IS64BIT=false
  elif [ "$ABI" = "arm64-v8a" ]; then
    ARCH=arm64
    ABI32=armeabi-v7a
    IS64BIT=true
  elif [ "$ABI" = "x86_64" ]; then
    ARCH=x64
    ABI32=x86
    IS64BIT=true
  else
    ARCH=arm
    ABI=armeabi-v7a
    ABI32=armeabi-v7a
    IS64BIT=false
  fi
}

#################
# Module Related
#################

set_perm() {
  chown $2:$3 $1 || return 1
  chmod $4 $1 || return 1
  local CON=$5
  [ -z $CON ] && CON=u:object_r:system_file:s0
  chcon $CON $1 || return 1
}

set_perm_recursive() {
  find $1 -type d 2>/dev/null | while read dir; do
    set_perm $dir $2 $3 $4 $6
  done
  find $1 -type f -o -type l 2>/dev/null | while read file; do
    set_perm $file $2 $3 $5 $6
  done
}

mktouch() {
  mkdir -p ${1%/*} 2>/dev/null
  [ -z $2 ] && touch $1 || echo $2 > $1
  chmod 644 $1
}

mark_remove() {
  mkdir -p ${1%/*} 2>/dev/null
  mknod $1 c 0 0
  chmod 644 $1
}

mark_replace() {
  # REPLACE must be directory!!!
  # https://docs.kernel.org/filesystems/overlayfs.html#whiteouts-and-opaque-directories
  mkdir -p $1 2>/dev/null
  setfattr -n trusted.overlay.opaque -v y $1
  chmod 644 $1
}

request_size_check() {
  reqSizeM=`du -ms "$1" | cut -f1`
}

request_zip_size_check() {
  reqSizeM=`unzip -l "$1" | tail -n 1 | awk '{ print int(($1 - 1) / 1048576 + 1) }'`
}

boot_actions() { return; }

# Require ZIPFILE to be set
is_legacy_script() {
  unzip -l "$ZIPFILE" install.sh | grep -q install.sh
  return $?
}

handle_partition() {
    PARTITION="$1"
    REQUIRE_SYMLINK="$2"
    if [ ! -e "$MODPATH/system/$PARTITION" ]; then
        # no partition found
        return;
    fi

    if [ "$REQUIRE_SYMLINK" = "false" ] || [ -L "/system/$PARTITION" ] && [ "$(readlink -f "/system/$PARTITION")" = "/$PARTITION" ]; then
        ui_print "- Handle partition /$PARTITION"
        ln -sf "./system/$PARTITION" "$MODPATH/$PARTITION"
    fi
}

# Require OUTFD, ZIPFILE to be set
install_module() {
  rm -rf $TMPDIR
  mkdir -p $TMPDIR
  chcon u:object_r:system_file:s0 $TMPDIR
  cd $TMPDIR

  mount_partitions
  api_level_arch_detect

  # Setup busybox and binaries
  if $BOOTMODE; then
    boot_actions
  else
    recovery_actions
  fi

  # Extract prop file
  unzip -o "$ZIPFILE" module.prop -d $TMPDIR >&2
  [ ! -f $TMPDIR/module.prop ] && abort "! Unable to extract zip file!"

  local MODDIRNAME=modules
  $BOOTMODE && MODDIRNAME=modules_update
  local MODULEROOT=$NVBASE/$MODDIRNAME
  MODID=`grep_prop id $TMPDIR/module.prop`
  MODNAME=`grep_prop name $TMPDIR/module.prop`
  MODAUTH=`grep_prop author $TMPDIR/module.prop`
  MODPATH=$MODULEROOT/$MODID

  # Create mod paths
  rm -rf $MODPATH
  mkdir -p $MODPATH

  if is_legacy_script; then
    unzip -oj "$ZIPFILE" module.prop install.sh uninstall.sh 'common/*' -d $TMPDIR >&2

    # Load install script
    . $TMPDIR/install.sh

    # Callbacks
    print_modname
    on_install

    [ -f $TMPDIR/uninstall.sh ] && cp -af $TMPDIR/uninstall.sh $MODPATH/uninstall.sh
    $SKIPMOUNT && touch $MODPATH/skip_mount
    $PROPFILE && cp -af $TMPDIR/system.prop $MODPATH/system.prop
    cp -af $TMPDIR/module.prop $MODPATH/module.prop
    $POSTFSDATA && cp -af $TMPDIR/post-fs-data.sh $MODPATH/post-fs-data.sh
    $LATESTARTSERVICE && cp -af $TMPDIR/service.sh $MODPATH/service.sh

    ui_print "- Setting permissions"
    set_permissions
  else
    print_title "$MODNAME" "by $MODAUTH"
    print_title "Powered by APatch"

    unzip -o "$ZIPFILE" customize.sh -d $MODPATH >&2

    if ! grep -q '^SKIPUNZIP=1$' $MODPATH/customize.sh 2>/dev/null; then
      ui_print "- Extracting module files"
      unzip -o "$ZIPFILE" -x 'META-INF/*' -d $MODPATH >&2

      # Default permissions
      set_perm_recursive $MODPATH 0 0 0755 0644
      set_perm_recursive $MODPATH/system/bin 0 2000 0755 0755
      set_perm_recursive $MODPATH/system/xbin 0 2000 0755 0755
      set_perm_recursive $MODPATH/system/system_ext/bin 0 2000 0755 0755
      set_perm_recursive $MODPATH/system/vendor 0 2000 0755 0755 u:object_r:vendor_file:s0
    fi

    # Load customization script
    [ -f $MODPATH/customize.sh ] && . $MODPATH/customize.sh
  fi

  handle_partition vendor true
  handle_partition system_ext true
  handle_partition product true
  handle_partition odm false

  # Handle replace folders
  for TARGET in $REPLACE; do
    ui_print "- Replace target: $TARGET"
    mark_replace "$MODPATH$TARGET"
  done

  # Handle remove files
  for TARGET in $REMOVE; do
    ui_print "- Remove target: $TARGET"
    mark_remove "$MODPATH$TARGET"
  done

  if $BOOTMODE; then
    mktouch $NVBASE/modules/$MODID/update
    rm -rf $NVBASE/modules/$MODID/remove 2>/dev/null
    rm -rf $NVBASE/modules/$MODID/disable 2>/dev/null
    cp -af $MODPATH/module.prop $NVBASE/modules/$MODID/module.prop
  fi

  # Remove stuff that doesn't belong to modules and clean up any empty directories
  rm -rf \
  $MODPATH/system/placeholder $MODPATH/customize.sh \
  $MODPATH/README.md $MODPATH/.git*
  rmdir -p $MODPATH 2>/dev/null

  cd /
  $BOOTMODE || recovery_cleanup
  rm -rf $TMPDIR

  ui_print "- Done"
}

##########
# Presets
##########

# Detect whether in boot mode
[ -z $BOOTMODE ] && ps | grep zygote | grep -qv grep && BOOTMODE=true
[ -z $BOOTMODE ] && ps -A 2>/dev/null | grep zygote | grep -qv grep && BOOTMODE=true
[ -z $BOOTMODE ] && BOOTMODE=false

NVBASE=/data/adb
TMPDIR=/dev/tmp
POSTFSDATAD=$NVBASE/post-fs-data.d
SERVICED=$NVBASE/service.d

# Some modules dependents on this
export MAGISK_VER=27.0
export MAGISK_VER_CODE=27000
```

`apd/src/lua.rs`:

```rs
use crate::module::*;
use crate::utils::*;
use anyhow::Result;
use log::{info, warn};
use mlua::{Function, Lua, Result as LuaResult, Table};
use std::{fs, path::Path};

pub fn save_text<P: AsRef<Path>>(filename: P, content: &str) -> std::io::Result<()> {
    let _ = ensure_dir_exists("/data/adb/config");
    let path = format!("/data/adb/config/{}", filename.as_ref().display());
    fs::write(&path, content)?;
    Ok(())
}

pub fn load_text<P: AsRef<Path>>(filename: P) -> std::io::Result<String> {
    let _ = ensure_dir_exists("/data/adb/config");
    let path = format!("/data/adb/config/{}", filename.as_ref().display());
    fs::read_to_string(path)
}

pub fn load_all_lua_modules(lua: &Lua) -> LuaResult<()> {
    let modules_dir = Path::new("/data/adb/modules");

    let modules: Table = match lua.globals().get("modules") {
        Ok(t) => t,
        Err(_) => {
            let t = lua.create_table()?;
            lua.globals().set("modules", t.clone())?;
            t
        }
    };

    if modules_dir.exists() {
        for entry in
            fs::read_dir(modules_dir).unwrap_or_else(|_| fs::read_dir("/dev/null").unwrap())
        {
            if let Ok(entry) = entry {
                let path = entry.path();
                if path.is_dir() {
                    let id = path.file_name().unwrap().to_string_lossy().to_string();
                    let package: Table = lua.globals().get("package")?;
                    let old_cpath: String = package.get("cpath")?;
                    let new_cpath = format!("{}/?.so;{}", path.to_string_lossy(), old_cpath);
                    package.set("cpath", new_cpath)?;

                    let lua_file = path.join(format!("{}.lua", id));

                    if lua_file.exists() {
                        match fs::read_to_string(&lua_file) {
                            Ok(code) => {
                                match lua
                                    .load(&code)
                                    .set_name(&*lua_file.to_string_lossy())
                                    .eval::<Table>()
                                {
                                    Ok(module) => {
                                        modules.set(id.clone(), module.clone())?;
                                    }
                                    Err(e) => {
                                        eprintln!(
                                            "Failed to eval Lua {}: {}",
                                            lua_file.display(),
                                            e
                                        );
                                    }
                                }
                            }
                            Err(e) => {
                                eprintln!("Failed to read Lua {}: {}", lua_file.display(), e);
                            }
                        }
                    }
                }
            }
        }
    }

    Ok(())
}

pub fn info_lua(lua: &Lua) -> LuaResult<Function> {
    lua.create_function(|_, msg: String| {
        info!("[Lua] {}", msg);
        Ok(())
    })
}

pub fn warn_lua(lua: &Lua) -> LuaResult<Function> {
    lua.create_function(|_, msg: String| {
        warn!("[Lua] {}", msg);
        Ok(())
    })
}

pub fn install_module_lua(lua: &Lua) -> LuaResult<Function> {
    lua.create_function(|_, zip: String| {
        install_module(&zip)
            .map_err(|e| mlua::Error::external(format!("install_module failed: {}", e)))
    })
}
pub fn save_text_lua(lua: &Lua) -> LuaResult<Function> {
    lua.create_function(|_, (filename, content): (String, String)| {
        save_text(&filename, &content)
            .map_err(|e| mlua::Error::external(format!("save filed: {}", e)))?;
        Ok(())
    })
}
pub fn read_text_lua(lua: &Lua) -> LuaResult<Function> {
    lua.create_function(|_, filename: String| {
        let content = match load_text(&filename) {
            Ok(s) => s,
            Err(ref e) if e.kind() == std::io::ErrorKind::NotFound => String::new(),
            Err(e) => return Err(mlua::Error::external(format!("read failed: {}", e))),
        };
        Ok(content)
    })
}

pub fn exec_stage_lua(stage: &str, wait: bool, superkey: &str) -> Result<()> {
    let stage_safe = stage.replace('-', "_");
    run_lua(&superkey, &stage_safe, true, wait).map_err(|e| anyhow::anyhow!("{}", e))?;
    Ok(())
}

pub fn run_lua(id: &str, function: &str, on_each_module: bool, _wait: bool) -> mlua::Result<()> {
    let lua = unsafe { Lua::unsafe_new() };

    let func = install_module_lua(&lua)?;
    lua.globals().set("install_module", func)?;
    lua.globals().set("info", info_lua(&lua)?)?;
    lua.globals().set("warn", warn_lua(&lua)?)?;
    lua.globals().set("setConfig", save_text_lua(&lua)?)?;
    lua.globals().set("getConfig", read_text_lua(&lua)?)?;

    load_all_lua_modules(&lua)?;

    let modules: mlua::Table = lua.globals().get("modules")?;
    if on_each_module {
        for pair in modules.pairs::<String, mlua::Table>() {
            let (_, module_table) = pair?;
            if let Ok(func_obj) = module_table.get::<mlua::Function>(function) {
                func_obj.call::<()>(id)?;
            }
        }
    } else {
        let module_table: mlua::Table = modules.get(id)?;
        let func_obj: mlua::Function = module_table.get(function)?;
        func_obj.call::<()>(())?;
    }

    Ok(())
}

```

`apd/src/main.rs`:

```rs
mod apd;
mod assets;
mod cli;
mod defs;
mod event;
mod lua;
mod metamodule;
mod module;
mod package;
#[cfg(any(target_os = "linux", target_os = "android"))]
mod pty;
mod restorecon;
mod sepolicy;
mod supercall;
mod utils;
fn main() -> anyhow::Result<()> {
    cli::run()
}

```

`apd/src/metamodule.rs`:

```rs
//! Metamodule management
//!
//! This module handles all metamodule-related functionality.
//! Metamodules are special modules that manage how regular modules are mounted
//! and provide hooks for module installation/uninstallation.

use std::{
    collections::HashMap,
    path::{Path, PathBuf},
    process::Command,
};

use anyhow::{Context, Result, ensure};
use log::{info, warn};

use crate::{assets, defs, module::ModuleType::All};

/// Determine whether the provided module properties mark it as a metamodule
pub fn is_metamodule(props: &HashMap<String, String>) -> bool {
    props.get("metamodule").is_some_and(|s| {
        let trimmed = s.trim();
        trimmed == "1" || trimmed.eq_ignore_ascii_case("true")
    })
}

/// Get metamodule path if it exists
/// The metamodule is stored in /data/adb/modules/{id} with a symlink at /data/adb/metamodule
pub fn get_metamodule_path() -> Option<PathBuf> {
    let path = Path::new(defs::METAMODULE_DIR);

    // Check if symlink exists and resolve it
    if path.is_symlink()
        && let Ok(target) = std::fs::read_link(path)
    {
        // If target is relative, resolve it
        let resolved = if target.is_absolute() {
            target
        } else {
            path.parent()?.join(target)
        };

        if resolved.exists() && resolved.is_dir() {
            return Some(resolved);
        }
        warn!(
            "Metamodule symlink points to non-existent path: {}",
            resolved.display()
        );
    }

    // Fallback: search for metamodule=1 in modules directory
    let mut result = None;
    let _ = crate::module::foreach_module(All, |module_path| {
        if let Ok(props) = crate::module::read_module_prop(module_path)
            && is_metamodule(&props)
        {
            info!(
                "Found metamodule in modules directory: {}",
                module_path.display()
            );
            result = Some(module_path.to_path_buf());
        }
        Ok(())
    });

    result
}

/// Check if metamodule exists
pub fn has_metamodule() -> bool {
    get_metamodule_path().is_some()
}

/// Check if it's safe to install a regular module
/// Returns Ok(()) if safe, Err(is_disabled) if blocked
/// - Err(true) means metamodule is disabled
/// - Err(false) means metamodule is in other unstable state
pub fn check_install_safety() -> Result<(), bool> {
    // No metamodule → safe
    let Some(metamodule_path) = get_metamodule_path() else {
        return Ok(());
    };

    // No metainstall.sh → safe (uses default installer)
    // The staged update directory may contain the latest scripts, so check both locations
    let has_metainstall = metamodule_path
        .join(defs::METAMODULE_METAINSTALL_SCRIPT)
        .exists()
        || metamodule_path.file_name().is_some_and(|module_id| {
            Path::new(defs::MODULE_UPDATE_DIR)
                .join(module_id)
                .join(defs::METAMODULE_METAINSTALL_SCRIPT)
                .exists()
        });
    if !has_metainstall {
        return Ok(());
    }

    // Check for marker files
    let has_update = metamodule_path.join(defs::UPDATE_FILE_NAME).exists();
    let has_remove = metamodule_path.join(defs::REMOVE_FILE_NAME).exists();
    let has_disable = metamodule_path.join(defs::DISABLE_FILE_NAME).exists();

    // Stable state (no markers) → safe
    if !has_update && !has_remove && !has_disable {
        return Ok(());
    }

    // Return true if disabled, false for other unstable states
    Err(has_disable && !has_update && !has_remove)
}

/// Create or update the metamodule symlink
/// Points /data/adb/metamodule -> /data/adb/modules/{module_id}
pub fn ensure_symlink<P>(module_path: P) -> Result<()>
where
    P: AsRef<Path>,
{
    // METAMODULE_DIR might have trailing slash, so we need to trim it
    let symlink_path = Path::new(defs::METAMODULE_DIR.trim_end_matches('/'));
    let module_path = module_path.as_ref();

    info!(
        "Creating metamodule symlink: {} -> {}",
        symlink_path.display(),
        module_path.display()
    );

    // Remove existing symlink if it exists
    if symlink_path.exists() || symlink_path.is_symlink() {
        info!("Removing old metamodule symlink/path");
        if symlink_path.is_symlink() {
            std::fs::remove_file(symlink_path).with_context(|| "Failed to remove old symlink")?;
        } else {
            // Could be a directory, remove it
            std::fs::remove_dir_all(symlink_path)
                .with_context(|| "Failed to remove old directory")?;
        }
    }

    // Create symlink
    #[cfg(unix)]
    std::os::unix::fs::symlink(module_path, symlink_path)
        .with_context(|| format!("Failed to create symlink to {}", module_path.display()))?;

    info!("Metamodule symlink created successfully");
    Ok(())
}

/// Remove the metamodule symlink
pub fn remove_symlink() -> Result<()> {
    let symlink_path = Path::new(defs::METAMODULE_DIR.trim_end_matches('/'));

    if symlink_path.is_symlink() {
        std::fs::remove_file(symlink_path)
            .with_context(|| "Failed to remove metamodule symlink")?;
        info!("Metamodule symlink removed");
    }

    Ok(())
}

/// Get the install script content, using metainstall.sh from metamodule if available
/// Returns the script content to be executed
pub fn get_install_script(
    is_metamodule: bool,
    installer_content: &str,
    install_module_script: &str,
) -> Result<String> {
    // Check if there's a metamodule with metainstall.sh
    // Only apply this logic for regular modules (not when installing metamodule itself)
    let install_script = if is_metamodule {
        info!("Installing metamodule, using default installer");
        install_module_script.to_string()
    } else if let Some(metamodule_path) = get_metamodule_path() {
        if metamodule_path.join(defs::DISABLE_FILE_NAME).exists() {
            info!("Metamodule is disabled, using default installer");
            install_module_script.to_string()
        } else {
            let metainstall_path = metamodule_path.join(defs::METAMODULE_METAINSTALL_SCRIPT);

            if metainstall_path.exists() {
                info!("Using metainstall.sh from metamodule");
                let metamodule_content = std::fs::read_to_string(&metainstall_path)
                    .with_context(|| "Failed to read metamodule metainstall.sh")?;
                format!("{installer_content}\n{metamodule_content}\nexit 0\n")
            } else {
                info!("Metamodule exists but has no metainstall.sh, using default installer");
                install_module_script.to_string()
            }
        }
    } else {
        info!("No metamodule found, using default installer");
        install_module_script.to_string()
    };

    Ok(install_script)
}

/// Check if metamodule script exists and is ready to execute
/// Returns None if metamodule doesn't exist, is disabled, or script is missing
/// Returns Some(script_path) if script is ready to execute
fn check_metamodule_script(script_name: &str) -> Option<PathBuf> {
    // Check if metamodule exists
    let metamodule_path = get_metamodule_path()?;

    // Check if metamodule is disabled
    if metamodule_path.join(defs::DISABLE_FILE_NAME).exists() {
        info!("Metamodule is disabled, skipping {script_name}");
        return None;
    }

    // Check if script exists
    let script_path = metamodule_path.join(script_name);
    if !script_path.exists() {
        return None;
    }

    Some(script_path)
}

/// Execute metamodule's metauninstall.sh for a specific module
pub fn exec_metauninstall_script(module_id: &str) -> Result<()> {
    let Some(metauninstall_path) = check_metamodule_script(defs::METAMODULE_METAUNINSTALL_SCRIPT)
    else {
        return Ok(());
    };

    info!("Executing metamodule metauninstall.sh for module: {module_id}",);

    let result = Command::new(assets::BUSYBOX_PATH)
        .args(["sh", metauninstall_path.to_str().unwrap()])
        .current_dir(metauninstall_path.parent().unwrap())
        .envs(crate::module::get_common_script_envs())
        .env("MODULE_ID", module_id)
        .status()?;

    ensure!(
        result.success(),
        "Metamodule metauninstall.sh failed for module {module_id}: {:?}",
        result
    );

    info!("Metamodule metauninstall.sh executed successfully for {module_id}",);
    Ok(())
}

/// Execute metamodule mount script
pub fn exec_mount_script(module_dir: &str) -> Result<()> {
    let Some(mount_script) = check_metamodule_script(defs::METAMODULE_MOUNT_SCRIPT) else {
        return Ok(());
    };

    info!("Executing mount script for metamodule");

    let result = Command::new(assets::BUSYBOX_PATH)
        .args(["sh", mount_script.to_str().unwrap()])
        .envs(crate::module::get_common_script_envs())
        .env("MODULE_DIR", module_dir)
        .status()?;

    ensure!(
        result.success(),
        "Metamodule mount script failed with status: {:?}",
        result
    );

    info!("Metamodule mount script executed successfully");
    Ok(())
}

/// Execute metamodule script for a specific stage
pub fn exec_stage_script(stage: &str, block: bool) -> Result<()> {
    let Some(script_path) = check_metamodule_script(&format!("{stage}.sh")) else {
        return Ok(());
    };

    info!("Executing metamodule {stage}.sh");
    crate::module::exec_script(&script_path, block)?;
    info!("Metamodule {stage}.sh executed successfully");
    Ok(())
}

```

`apd/src/module.rs`:

```rs
#[cfg(unix)]
use std::os::unix::{prelude::PermissionsExt, process::CommandExt};
use std::{
    collections::HashMap,
    env::var as env_var,
    fs::{self, remove_dir_all},
    io::Cursor,
    path::{Path, PathBuf},
    process::Command,
    str::FromStr,
};

use crate::lua;
use anyhow::{Context, Result, anyhow, bail, ensure};
use const_format::concatcp;
use is_executable::is_executable;
use java_properties::PropertiesIter;
use log::{info, warn};
use zip_extensions::zip_extract_file_to_memory;

#[allow(clippy::wildcard_imports)]
use crate::utils::*;
use crate::{
    assets,
    defs::{self, MODULE_DIR, MODULE_UPDATE_DIR},
    metamodule, restorecon,
};

const INSTALLER_CONTENT: &str = include_str!("./installer.sh");
const INSTALL_MODULE_SCRIPT: &str = concatcp!(
    INSTALLER_CONTENT,
    "\n",
    "install_module",
    "\n",
    "exit 0",
    "\n"
);

#[derive(PartialEq, Eq)]
pub enum ModuleType {
    All,
    Active,
    Updated,
}

fn exec_install_script(module_file: &str, is_metamodule: bool) -> Result<()> {
    let realpath = std::fs::canonicalize(module_file)
        .with_context(|| format!("realpath: {module_file} failed"))?;

    // Get install script from metamodule module
    let install_script =
        metamodule::get_install_script(is_metamodule, INSTALLER_CONTENT, INSTALL_MODULE_SCRIPT)?;

    let result = Command::new(assets::BUSYBOX_PATH)
        .args(["sh", "-c", &install_script])
        .envs(get_common_script_envs())
        .env("OUTFD", "1")
        .env("ZIPFILE", realpath)
        .status()?;
    ensure!(result.success(), "Failed to install module script");
    Ok(())
}

pub fn handle_updated_modules() -> Result<()> {
    let modules_root = Path::new(MODULE_DIR);
    foreach_module(ModuleType::Updated, |updated_module| {
        if !updated_module.is_dir() {
            return Ok(());
        }

        if let Some(name) = updated_module.file_name() {
            let module_dir = modules_root.join(name);
            let mut disabled = false;
            let mut removed = false;
            if module_dir.exists() {
                // If the old module is disabled, we need to also disable the new one
                disabled = module_dir.join(defs::DISABLE_FILE_NAME).exists();
                removed = module_dir.join(defs::REMOVE_FILE_NAME).exists();
                remove_dir_all(&module_dir)?;
            }
            std::fs::rename(updated_module, &module_dir)?;
            if removed {
                let path = module_dir.join(defs::REMOVE_FILE_NAME);
                if let Err(e) = ensure_file_exists(&path) {
                    warn!("Failed to create {}: {e}", path.display());
                }
            } else if disabled {
                let path = module_dir.join(defs::DISABLE_FILE_NAME);
                if let Err(e) = ensure_file_exists(&path) {
                    warn!("Failed to create {}: {e}", path.display());
                }
            }
        }
        Ok(())
    })?;
    Ok(())
}

/// Get common environment variables for script execution
pub fn get_common_script_envs() -> Vec<(&'static str, String)> {
    vec![
        ("ASH_STANDALONE", "1".to_string()),
        ("APATCH", "true".to_string()),
        ("APATCH_VER", defs::VERSION_NAME.to_string()),
        ("APATCH_VER_CODE", defs::VERSION_CODE.to_string()),
        (
            "PATH",
            format!(
                "{}:{}",
                env_var("PATH").unwrap_or_default(),
                defs::BINARY_DIR.trim_end_matches('/')
            ),
        ),
    ]
}

// because we use something like A-B update
// we need to update the module state after the boot_completed
// if someone(such as the module) install a module before the boot_completed
// then it may cause some problems, just forbid it
fn ensure_boot_completed() -> Result<()> {
    // ensure getprop sys.boot_completed == 1
    if getprop("sys.boot_completed").as_deref() != Some("1") {
        bail!("Android is Booting!");
    }
    Ok(())
}

fn mark_update() -> Result<()> {
    ensure_file_exists(concatcp!(defs::WORKING_DIR, defs::UPDATE_FILE_NAME))
}

fn mark_module_state(module: &str, flag_file: &str, create_or_delete: bool) -> Result<()> {
    let module_state_file = Path::new(defs::MODULE_DIR).join(module).join(flag_file);
    if create_or_delete {
        ensure_file_exists(module_state_file)
    } else {
        if module_state_file.exists() {
            fs::remove_file(module_state_file)?;
        }
        Ok(())
    }
}
pub fn foreach_module(
    module_type: ModuleType,
    mut f: impl FnMut(&Path) -> Result<()>,
) -> Result<()> {
    let modules_dir = Path::new(match module_type {
        ModuleType::Updated => MODULE_UPDATE_DIR,
        _ => defs::MODULE_DIR,
    });
    let dir = std::fs::read_dir(modules_dir)?;
    for entry in dir.flatten() {
        let path = entry.path();
        if !path.is_dir() {
            warn!("{} is not a directory, skip", path.display());
            continue;
        }

        if module_type == ModuleType::Active && path.join(defs::DISABLE_FILE_NAME).exists() {
            info!("{} is disabled, skip", path.display());
            continue;
        }
        if module_type == ModuleType::Active && path.join(defs::REMOVE_FILE_NAME).exists() {
            warn!("{} is removed, skip", path.display());
            continue;
        }

        f(&path)?;
    }

    Ok(())
}

fn foreach_active_module(f: impl FnMut(&Path) -> Result<()>) -> Result<()> {
    foreach_module(ModuleType::Active, f)
}

pub fn load_sepolicy_rule() -> Result<()> {
    foreach_active_module(|path| {
        let rule_file = path.join("sepolicy.rule");
        if !rule_file.exists() {
            return Ok(());
        }

        info!("load policy: {}", &rule_file.display());
        Command::new(assets::MAGISKPOLICY_PATH)
            .arg("--live")
            .arg("--apply")
            .arg(&rule_file)
            .status()
            .with_context(|| format!("Failed to exec {}", rule_file.display()))?;
        Ok(())
    })?;

    Ok(())
}

pub fn exec_script<T: AsRef<Path>>(path: T, wait: bool) -> Result<()> {
    info!("exec {}", path.as_ref().display());

    let mut command = &mut Command::new(assets::BUSYBOX_PATH);
    #[cfg(unix)]
    {
        command = command.process_group(0);
        command = unsafe {
            command.pre_exec(|| {
                // ignore the error?
                switch_cgroups();
                Ok(())
            })
        };
    }
    command = command
        .current_dir(path.as_ref().parent().unwrap())
        .arg("sh")
        .arg(path.as_ref())
        .env("ASH_STANDALONE", "1")
        .env("APATCH", "true")
        .env("APATCH_VER", defs::VERSION_NAME)
        .env("APATCH_VER_CODE", defs::VERSION_CODE)
        .env(
            "PATH",
            format!(
                "{}:{}",
                env_var("PATH")?,
                defs::BINARY_DIR.trim_end_matches('/')
            ),
        );

    let result = if wait {
        command.status().map(|_| ())
    } else {
        command.spawn().map(|_| ())
    };
    result.map_err(|err| anyhow!("Failed to exec {}: {}", path.as_ref().display(), err))
}

pub fn exec_stage_script(stage: &str, block: bool) -> Result<()> {
    foreach_active_module(|module| {
        let script_path = module.join(format!("{stage}.sh"));
        if !script_path.exists() {
            return Ok(());
        }

        exec_script(&script_path, block)
    })?;
    Ok(())
}

pub fn exec_common_scripts(dir: &str, wait: bool) -> Result<()> {
    let script_dir = Path::new(defs::ADB_DIR).join(dir);
    if !script_dir.exists() {
        info!("{} not exists, skip", script_dir.display());
        return Ok(());
    }

    let dir = fs::read_dir(&script_dir)?;
    for entry in dir.flatten() {
        let path = entry.path();

        if !is_executable(&path) {
            warn!("{} is not executable, skip", path.display());
            continue;
        }

        exec_script(path, wait)?;
    }

    Ok(())
}

pub fn load_system_prop() -> Result<()> {
    foreach_active_module(|module| {
        let system_prop = module.join("system.prop");
        if !system_prop.exists() {
            return Ok(());
        }
        info!("load {} system.prop", module.display());

        // resetprop -n --file system.prop
        Command::new(assets::RESETPROP_PATH)
            .arg("-n")
            .arg("--file")
            .arg(&system_prop)
            .status()
            .with_context(|| format!("Failed to exec {}", system_prop.display()))?;

        Ok(())
    })?;

    Ok(())
}

pub fn prune_modules() -> Result<()> {
    foreach_module(ModuleType::All, |module| {
        fs::remove_file(module.join(defs::UPDATE_FILE_NAME)).ok();
        if !module.join(defs::REMOVE_FILE_NAME).exists() {
            return Ok(());
        }

        info!("remove module: {}", module.display());

        // Execute metamodule's metauninstall.sh first
        let module_id = module.file_name().and_then(|n| n.to_str()).unwrap_or("");

        // Check if this is a metamodule
        let is_metamodule = read_module_prop(module)
            .map(|props| metamodule::is_metamodule(&props))
            .unwrap_or(false);

        if is_metamodule {
            info!("Removing metamodule symlink");
            if let Err(e) = metamodule::remove_symlink() {
                warn!("Failed to remove metamodule symlink: {e}");
            }
        } else if let Err(e) = metamodule::exec_metauninstall_script(module_id) {
            warn!("Failed to exec metamodule uninstall for {module_id}: {e}",);
        }

        // Then execute module's own uninstall.sh
        let uninstaller = module.join("uninstall.sh");
        if uninstaller.exists()
            && let Err(e) = exec_script(uninstaller, true)
        {
            warn!("Failed to exec uninstaller: {e}");
        }

        // Finally remove the module directory
        if let Err(e) = remove_dir_all(module) {
            warn!("Failed to remove {}: {e}", module.display());
        }

        Ok(())
    })?;

    // collect remaining modules, if none, clean up metamodule record
    let remaining_modules: Vec<_> = std::fs::read_dir(defs::MODULE_DIR)?
        .filter_map(std::result::Result::ok)
        .filter(|entry| entry.path().join("module.prop").exists())
        .collect();

    if remaining_modules.is_empty() {
        info!("no remaining modules.");
    }

    Ok(())
}

fn _install_module(zip: &str) -> Result<()> {
    ensure_boot_completed()?;

    // print banner
    println!(include_str!("banner"));

    assets::ensure_binaries().with_context(|| "binary missing")?;

    // first check if workding dir is usable
    ensure_dir_exists(defs::WORKING_DIR).with_context(|| "Failed to create working dir")?;
    ensure_dir_exists(defs::BINARY_DIR).with_context(|| "Failed to create bin dir")?;

    // read the module_id from zip
    let mut buffer: Vec<u8> = Vec::new();
    let entry_path = PathBuf::from_str("module.prop")?;
    let zip_path = PathBuf::from_str(zip)?;
    let zip_path = zip_path.canonicalize()?;
    zip_extract_file_to_memory(&zip_path, &entry_path, &mut buffer)?;
    let mut module_prop = HashMap::new();
    PropertiesIter::new_with_encoding(Cursor::new(buffer), encoding_rs::UTF_8).read_into(
        |k, v| {
            module_prop.insert(k, v);
        },
    )?;
    info!("module prop: {:?}", module_prop);

    let Some(module_id) = module_prop.get("id") else {
        bail!("module id not found in module.prop!");
    };
    let module_id = module_id.trim();

    // Check if this module is a metamodule
    let is_metamodule = metamodule::is_metamodule(&module_prop);

    // Check if it's safe to install regular module
    if !is_metamodule && let Err(is_disabled) = metamodule::check_install_safety() {
        println!("\n❌ Installation Blocked");
        println!("┌────────────────────────────────");
        println!("│ A metamodule with custom installer is active");
        println!("│");
        if is_disabled {
            println!("│ Current state: Disabled");
            println!("│ Action required: Re-enable or uninstall it, then reboot");
        } else {
            println!("│ Current state: Pending changes");
            println!("│ Action required: Reboot to apply changes first");
        }
        println!("└─────────────────────────────────\n");
        bail!("Metamodule installation blocked");
    }

    let modules_dir = Path::new(defs::MODULE_DIR);
    let modules_update_dir = Path::new(defs::MODULE_UPDATE_DIR);
    if !Path::new(modules_dir).exists() {
        fs::create_dir(modules_dir).expect("Failed to create modules folder");
        let permissions = fs::Permissions::from_mode(0o700);
        fs::set_permissions(modules_dir, permissions).expect("Failed to set permissions");
    }

    if is_metamodule {
        info!("Installing metamodule: {module_id}");

        // Check if there's already a metamodule installed
        if metamodule::has_metamodule()
            && let Some(existing_path) = metamodule::get_metamodule_path()
        {
            let existing_id = read_module_prop(&existing_path)
                .ok()
                .and_then(|m| m.get("id").cloned())
                .unwrap_or_else(|| "unknown".to_string());

            if existing_id != module_id {
                println!("\n❌ Installation Failed");
                println!("┌────────────────────────────────");
                println!("│ A metamodule is already installed");
                println!("│   Current metamodule: {existing_id}");
                println!("│");
                println!("│ Only one metamodule can be active at a time.");
                println!("│");
                println!("│ To install this metamodule:");
                println!("│   1. Uninstall the current metamodule");
                println!("│   2. Reboot your device");
                println!("│   3. Install the new metamodule");
                println!("└─────────────────────────────────\n");
                bail!("Cannot install multiple metamodules");
            }
        }
    }

    let module_dir = format!("{}{}", modules_dir.display(), module_id);
    let _module_update_dir = format!("{}{}", modules_update_dir.display(), module_id);
    info!("module dir: {}", module_dir);
    if !Path::new(&module_dir.clone()).exists() {
        fs::create_dir(&module_dir.clone()).expect("Failed to create module folder");
        let permissions = fs::Permissions::from_mode(0o700);
        fs::set_permissions(module_dir.clone(), permissions).expect("Failed to set permissions");
    }
    // unzip the image and move it to modules_update/<id> dir
    let file = fs::File::open(zip)?;
    let mut archive = zip::ZipArchive::new(file)?;
    archive.extract(&_module_update_dir)?;

    println!("- Running module installer");
    exec_install_script(zip, is_metamodule)?;

    // set permission and selinux context for $MOD/system
    let module_system_dir = PathBuf::from(module_dir.clone()).join("system");
    if module_system_dir.exists() {
        #[cfg(unix)]
        fs::set_permissions(&module_system_dir, fs::Permissions::from_mode(0o755))?;
        restorecon::restore_syscon(&module_system_dir)?;
    }

    // Create symlink for metamodule
    if is_metamodule {
        println!("- Creating metamodule symlink");
        metamodule::ensure_symlink(&module_dir)?;
    }

    mark_update()?;
    Ok(())
}

pub fn install_module(zip: &str) -> Result<()> {
    let result = _install_module(zip);
    result
}

pub fn _uninstall_module(id: &str, update_dir: &str) -> Result<()> {
    let dir = Path::new(update_dir);
    ensure!(dir.exists(), "No module installed");

    // iterate the modules_update dir, find the module to be removed
    let dir = fs::read_dir(dir)?;
    for entry in dir.flatten() {
        let path = entry.path();
        let module_prop = path.join("module.prop");
        if !module_prop.exists() {
            continue;
        }
        let content = fs::read(module_prop)?;
        let mut module_id: String = String::new();
        PropertiesIter::new_with_encoding(Cursor::new(content), encoding_rs::UTF_8).read_into(
            |k, v| {
                if k.eq("id") {
                    module_id = v;
                }
            },
        )?;
        if module_id.eq(id) {
            let remove_file = path.join(defs::REMOVE_FILE_NAME);
            fs::File::create(remove_file).with_context(|| "Failed to create remove file.")?;
            break;
        }
    }

    // santity check
    let target_module_path = format!("{update_dir}/{id}");
    let target_module = Path::new(&target_module_path);
    if target_module.exists() {
        let remove_file = target_module.join(defs::REMOVE_FILE_NAME);
        if !remove_file.exists() {
            fs::File::create(remove_file).with_context(|| "Failed to create remove file.")?;
        }
    }

    let _ = mark_module_state(id, defs::REMOVE_FILE_NAME, true);
    Ok(())
}
pub fn uninstall_module(id: &str) -> Result<()> {
    _uninstall_module(id, defs::MODULE_DIR)?;
    mark_update()?;
    Ok(())
}

/// Read module.prop from the given module path and return as a HashMap
pub fn read_module_prop(module_path: &Path) -> Result<HashMap<String, String>> {
    let module_prop = module_path.join("module.prop");
    ensure!(
        module_prop.exists(),
        "module.prop not found in {}",
        module_path.display()
    );

    let content = std::fs::read(&module_prop)
        .with_context(|| format!("Failed to read module.prop: {}", module_prop.display()))?;

    let mut prop_map: HashMap<String, String> = HashMap::new();
    PropertiesIter::new_with_encoding(Cursor::new(content), encoding_rs::UTF_8)
        .read_into(|k, v| {
            prop_map.insert(k, v);
        })
        .with_context(|| format!("Failed to parse module.prop: {}", module_prop.display()))?;

    Ok(prop_map)
}

pub fn run_action(id: &str) -> Result<()> {
    let action_script_path = format!("/data/adb/modules/{}/action.sh", id);
    if Path::new(&action_script_path).exists() {
        let _ = exec_script(&action_script_path, true);
    } else {
        //if no action.sh, try to run lua action
        lua::run_lua(&id, "action", false, true).map_err(|e| anyhow::anyhow!("{}", e))?;
    }
    Ok(())
}

fn _change_module_state(module_dir: &str, mid: &str, enable: bool) -> Result<()> {
    let src_module_path = format!("{module_dir}/{mid}");
    let src_module = Path::new(&src_module_path);
    ensure!(src_module.exists(), "module: {} not found!", mid);

    let disable_path = src_module.join(defs::DISABLE_FILE_NAME);
    if enable {
        if disable_path.exists() {
            fs::remove_file(&disable_path).with_context(|| {
                format!("Failed to remove disable file: {}", &disable_path.display())
            })?;
        }
    } else {
        ensure_file_exists(disable_path)?;
    }

    let _ = mark_module_state(mid, defs::DISABLE_FILE_NAME, !enable);

    Ok(())
}

pub fn _enable_module(id: &str, update_dir: &Path) -> Result<()> {
    if let Some(module_dir_str) = update_dir.to_str() {
        _change_module_state(module_dir_str, id, true)
    } else {
        info!("Enable module failed: Invalid path");
        Err(anyhow::anyhow!("Invalid module directory"))
    }
}

pub fn enable_module(id: &str) -> Result<()> {
    let update_dir = Path::new(defs::MODULE_DIR);
    _enable_module(id, update_dir)?;
    Ok(())
}

pub fn _disable_module(id: &str, update_dir: &Path) -> Result<()> {
    if let Some(module_dir_str) = update_dir.to_str() {
        _change_module_state(module_dir_str, id, false)
    } else {
        info!("Disable module failed: Invalid path");
        Err(anyhow::anyhow!("Invalid module directory"))
    }
}

pub fn disable_module(id: &str) -> Result<()> {
    let module_dir = Path::new(defs::MODULE_DIR);
    _disable_module(id, module_dir)?;

    Ok(())
}

pub fn _disable_all_modules(dir: &str) -> Result<()> {
    let dir = fs::read_dir(dir)?;
    for entry in dir.flatten() {
        let path = entry.path();
        let disable_flag = path.join(defs::DISABLE_FILE_NAME);
        if let Err(e) = ensure_file_exists(disable_flag) {
            warn!("Failed to disable module: {}: {}", path.display(), e);
        }
    }
    Ok(())
}

pub fn disable_all_modules() -> Result<()> {
    // Skip disabling modules since boot completed
    if getprop("sys.boot_completed").as_deref() == Some("1") {
        info!("System boot completed, no need to disable all modules");
        return Ok(());
    }
    mark_update()?;
    _disable_all_modules(defs::MODULE_DIR)?;
    Ok(())
}

fn _list_modules(path: &str) -> Vec<HashMap<String, String>> {
    // first check enabled modules
    let dir = fs::read_dir(path);
    let Ok(dir) = dir else {
        return Vec::new();
    };

    let mut modules: Vec<HashMap<String, String>> = Vec::new();

    for entry in dir.flatten() {
        let path = entry.path();
        info!("path: {}", path.display());
        let module_prop = path.join("module.prop");
        if !module_prop.exists() {
            continue;
        }
        let content = fs::read(&module_prop);
        let Ok(content) = content else {
            warn!("Failed to read file: {}", module_prop.display());
            continue;
        };
        let mut module_prop_map: HashMap<String, String> = HashMap::new();
        let encoding = encoding_rs::UTF_8;
        let result =
            PropertiesIter::new_with_encoding(Cursor::new(content), encoding).read_into(|k, v| {
                module_prop_map.insert(k, v);
            });

        if !module_prop_map.contains_key("id") || module_prop_map["id"].is_empty() {
            match entry.file_name().to_str() {
                Some(id) => {
                    info!("Use dir name as module id: {}", id);
                    module_prop_map.insert("id".to_owned(), id.to_owned());
                }
                _ => {
                    info!("Failed to get module id: {:?}", module_prop);
                    continue;
                }
            }
        }

        // Add enabled, update, remove flags
        let enabled = !path.join(defs::DISABLE_FILE_NAME).exists();
        let update = path.join(defs::UPDATE_FILE_NAME).exists();
        let remove = path.join(defs::REMOVE_FILE_NAME).exists();
        let web = path.join(defs::MODULE_WEB_DIR).exists();
        let id = module_prop_map.get("id").map(|s| s.as_str()).unwrap_or("");
        let id_lua_file = format!("{}.lua", id);
        let action = path.join(defs::MODULE_ACTION_SH).exists() || path.join(&id_lua_file).exists();

        module_prop_map.insert("enabled".to_owned(), enabled.to_string());
        module_prop_map.insert("update".to_owned(), update.to_string());
        module_prop_map.insert("remove".to_owned(), remove.to_string());
        module_prop_map.insert("web".to_owned(), web.to_string());
        module_prop_map.insert("action".to_owned(), action.to_string());

        if result.is_err() {
            warn!("Failed to parse module.prop: {}", module_prop.display());
            continue;
        }
        modules.push(module_prop_map);
    }

    modules
}

pub fn list_modules() -> Result<()> {
    let modules = _list_modules(defs::MODULE_DIR);
    println!("{}", serde_json::to_string_pretty(&modules)?);
    Ok(())
}

```

`apd/src/package.rs`:

```rs
use std::{
    fs::File,
    io::{self, BufRead},
    path::Path,
    thread,
    time::Duration,
};

use log::{info, warn};
use serde::{Deserialize, Serialize};

#[derive(Deserialize, Serialize, Clone)]
pub struct PackageConfig {
    pub pkg: String,
    pub exclude: i32,
    pub allow: i32,
    pub uid: i32,
    pub to_uid: i32,
    pub sctx: String,
}

pub fn read_ap_package_config() -> Vec<PackageConfig> {
    let max_retry = 5;
    for _ in 0..max_retry {
        let file = match File::open("/data/adb/ap/package_config") {
            Ok(file) => file,
            Err(e) => {
                warn!("Error opening file: {}", e);
                thread::sleep(Duration::from_secs(1));
                continue;
            }
        };

        let mut reader = csv::Reader::from_reader(file);
        let mut package_configs = Vec::new();
        let mut success = true;

        for record in reader.deserialize() {
            match record {
                Ok(config) => package_configs.push(config),
                Err(e) => {
                    warn!("Error deserializing record: {}", e);
                    success = false;
                    break;
                }
            }
        }

        if success {
            return package_configs;
        }
        thread::sleep(Duration::from_secs(1));
    }
    Vec::new()
}

pub fn write_ap_package_config(package_configs: &[PackageConfig]) -> io::Result<()> {
    let max_retry = 5;
    for _ in 0..max_retry {
        let temp_path = "/data/adb/ap/package_config.tmp";
        let file = match File::create(temp_path) {
            Ok(file) => file,
            Err(e) => {
                warn!("Error creating temp file: {}", e);
                thread::sleep(Duration::from_secs(1));
                continue;
            }
        };

        let mut writer = csv::Writer::from_writer(file);
        let mut success = true;

        for config in package_configs {
            if let Err(e) = writer.serialize(config) {
                warn!("Error serializing record: {}", e);
                success = false;
                break;
            }
        }

        if !success {
            thread::sleep(Duration::from_secs(1));
            continue;
        }

        if let Err(e) = writer.flush() {
            warn!("Error flushing writer: {}", e);
            thread::sleep(Duration::from_secs(1));
            continue;
        }

        if let Err(e) = std::fs::rename(temp_path, "/data/adb/ap/package_config") {
            warn!("Error renaming temp file: {}", e);
            thread::sleep(Duration::from_secs(1));
            continue;
        }
        return Ok(());
    }
    Err(io::Error::new(
        io::ErrorKind::Other,
        "Failed after max retries",
    ))
}

fn read_lines<P>(filename: P) -> io::Result<io::Lines<io::BufReader<File>>>
where
    P: AsRef<Path>,
{
    File::open(filename).map(|file| io::BufReader::new(file).lines())
}

pub fn synchronize_package_uid() -> io::Result<()> {
    info!("[synchronize_package_uid] Start synchronizing root list with system packages...");

    let max_retry = 5;
    for _ in 0..max_retry {
        match read_lines("/data/system/packages.list") {
            Ok(lines) => {
                let lines: Vec<_> = lines.filter_map(|line| line.ok()).collect();

                let mut package_configs = read_ap_package_config();

                let system_packages: Vec<String> = lines
                    .iter()
                    .filter_map(|line| line.split_whitespace().next())
                    .map(|pkg| pkg.to_string())
                    .collect();

                let original_len = package_configs.len();
                package_configs.retain(|config| system_packages.contains(&config.pkg));
                let removed_count = original_len - package_configs.len();

                if removed_count > 0 {
                    info!(
                        "Removed {} uninstalled package configurations",
                        removed_count
                    );
                }

                let mut updated = false;

                for line in &lines {
                    let words: Vec<&str> = line.split_whitespace().collect();
                    if words.len() >= 2 {
                        let pkg_name = words[0];
                        if let Ok(uid) = words[1].parse::<i32>() {
                            for config in package_configs
                                .iter_mut()
                                .filter(|config| config.pkg == pkg_name)
                            {
                                if config.uid % 100000 != uid % 100000 {
                                    let new_uid = config.uid / 100000 * 100000 + uid % 100000;
                                    info!(
                                        "Updating uid for package {}: {} -> {}",
                                        pkg_name, config.uid, new_uid
                                    );
                                    config.uid = new_uid;
                                    updated = true;
                                }
                            }
                        } else {
                            warn!("Error parsing uid: {}", words[1]);
                        }
                    }
                }

                if updated || removed_count > 0 {
                    write_ap_package_config(&package_configs)?;
                }
                return Ok(());
            }
            Err(e) => {
                warn!("Error reading packages.list: {}", e);
                thread::sleep(Duration::from_secs(1));
            }
        }
    }
    Err(io::Error::new(
        io::ErrorKind::Other,
        "Failed after max retries",
    ))
}

```

`apd/src/pty.rs`:

```rs
use std::{
    ffi::c_int,
    fs::File,
    io::{Read, Write, stderr, stdin, stdout},
    mem::MaybeUninit,
    os::fd::{AsFd, AsRawFd, OwnedFd, RawFd},
    process::exit,
    ptr::null_mut,
    sync::Mutex,
    thread,
};

use anyhow::{Ok, Result, bail};
use libc::{
    __errno, EINTR, SIG_BLOCK, SIG_UNBLOCK, SIGWINCH, TIOCGWINSZ, TIOCSWINSZ, fork,
    pthread_sigmask, sigaddset, sigemptyset, sigset_t, sigwait, waitpid, winsize,
};
use rustix::{
    fs::{Mode, OFlags, open},
    io::dup,
    ioctl::{Getter, Opcode, ioctl, opcode},
    process::setsid,
    pty::{grantpt, unlockpt},
    stdio::{dup2_stderr, dup2_stdin, dup2_stdout},
    termios::{OptionalActions, Termios, isatty, tcgetattr, tcsetattr},
};

use crate::{defs::PTS_NAME, utils::get_tmp_path};

// https://github.com/topjohnwu/Magisk/blob/5627053b7481618adfdf8fa3569b48275589915b/native/src/core/su/pts.cpp

fn get_pty_num<F: AsFd>(fd: F) -> Result<u32> {
    // TIOCGPTN: Get the PTY number
    const TIOCGPTN: Opcode = opcode::read::<u32>(b'T', 0x30);
    Ok(unsafe {
        let tiocgptn = Getter::<TIOCGPTN, u32>::new();
        ioctl(fd, tiocgptn)?
    })
}

static OLD_STDIN: Mutex<Option<Termios>> = Mutex::new(None);

fn watch_sigwinch_async(slave: RawFd) {
    let mut winch = MaybeUninit::<sigset_t>::uninit();
    unsafe {
        sigemptyset(winch.as_mut_ptr());
        sigaddset(winch.as_mut_ptr(), SIGWINCH);
        pthread_sigmask(SIG_BLOCK, winch.as_mut_ptr(), null_mut());
    }

    thread::spawn(move || unsafe {
        let mut winch = MaybeUninit::<sigset_t>::uninit();
        sigemptyset(winch.as_mut_ptr());
        sigaddset(winch.as_mut_ptr(), SIGWINCH);
        pthread_sigmask(SIG_UNBLOCK, winch.as_mut_ptr(), null_mut());
        let mut sig: c_int = 0;
        loop {
            let mut w = MaybeUninit::<winsize>::uninit();
            if libc::ioctl(1, TIOCGWINSZ, w.as_mut_ptr()) < 0 {
                continue;
            }
            libc::ioctl(slave, TIOCSWINSZ, w.as_mut_ptr());
            if sigwait(winch.as_mut_ptr(), &mut sig) != 0 {
                break;
            }
        }
    });
}

fn set_stdin_raw() -> rustix::io::Result<()> {
    let mut termios = tcgetattr(stdin())?;

    let mut guard = OLD_STDIN.lock().unwrap();
    *guard = Some(termios.clone());
    drop(guard);

    termios.make_raw();
    tcsetattr(stdin(), OptionalActions::Flush, &termios)
}

fn restore_stdin() -> Result<()> {
    let mut guard = OLD_STDIN.lock().unwrap();

    if let Some(original_termios) = guard.take() {
        tcsetattr(stdin(), OptionalActions::Flush, &original_termios)?;
    }

    Ok(())
}

fn pump<R: Read, W: Write>(mut from: R, mut to: W) {
    let mut buf = [0u8; 4096];
    loop {
        match from.read(&mut buf) {
            Result::Ok(len) => {
                if len == 0 {
                    return;
                }
                if to.write_all(&buf[0..len]).is_err() {
                    return;
                }
                if to.flush().is_err() {
                    return;
                }
            }
            Err(_) => {
                return;
            }
        }
    }
}

fn pump_stdin_async(mut ptmx: File) {
    let _ = set_stdin_raw();

    thread::spawn(move || {
        let mut stdin = stdin();
        pump(&mut stdin, &mut ptmx);
    });
}

fn pump_stdout_blocking(mut ptmx: File) {
    let mut stdout = stdout();
    pump(&mut ptmx, &mut stdout);

    let _ = restore_stdin();
}

fn create_transfer(ptmx: OwnedFd) -> Result<()> {
    let pid = unsafe { fork() };
    match pid {
        d if d < 0 => bail!("fork"),
        0 => return Ok(()),
        _ => {}
    }

    let ptmx_r = ptmx;
    let ptmx_w = dup(&ptmx_r)?;

    let ptmx_r = File::from(ptmx_r);
    let ptmx_w = File::from(ptmx_w);

    watch_sigwinch_async(ptmx_w.as_raw_fd());
    pump_stdin_async(ptmx_r);
    pump_stdout_blocking(ptmx_w);

    let mut status: c_int = -1;

    unsafe {
        loop {
            if waitpid(pid, &mut status, 0) == -1 && *__errno() != EINTR {
                continue;
            }
            break;
        }
    }

    exit(status)
}

pub fn prepare_pty() -> Result<()> {
    let tty_in = isatty(stdin());
    let tty_out = isatty(stdout());
    let tty_err = isatty(stderr());
    if !tty_in && !tty_out && !tty_err {
        return Ok(());
    }

    let mut pts_path = format!("{}/{}", get_tmp_path(), PTS_NAME);
    if !std::path::Path::new(&pts_path).exists() {
        pts_path = "/dev/pts".to_string();
    }
    let ptmx_path = format!("{}/ptmx", pts_path);
    let ptmx_fd = open(ptmx_path, OFlags::RDWR, Mode::empty())?;
    grantpt(&ptmx_fd)?;
    unlockpt(&ptmx_fd)?;
    let pty_num = get_pty_num(&ptmx_fd)?;
    create_transfer(ptmx_fd)?;
    setsid()?;
    let pty_fd = open(format!("{pts_path}/{pty_num}"), OFlags::RDWR, Mode::empty())?;
    if tty_in {
        dup2_stdin(&pty_fd)?;
    }
    if tty_out {
        dup2_stdout(&pty_fd)?;
    }
    if tty_err {
        dup2_stderr(&pty_fd)?;
    }
    Ok(())
}

```

`apd/src/restorecon.rs`:

```rs
use std::path::Path;

use anyhow::Result;
#[cfg(any(target_os = "linux", target_os = "android"))]
use anyhow::{Context, Ok};
#[cfg(any(target_os = "linux", target_os = "android"))]
use extattr::{Flags as XattrFlags, lsetxattr};
use jwalk::{Parallelism::Serial, WalkDir};

use crate::defs;

pub const SYSTEM_CON: &str = "u:object_r:system_file:s0";
pub const ADB_CON: &str = "u:object_r:adb_data_file:s0";
pub const UNLABEL_CON: &str = "u:object_r:unlabeled:s0";

const SELINUX_XATTR: &str = "security.selinux";

pub fn lsetfilecon<P: AsRef<Path>>(path: P, con: &str) -> Result<()> {
    #[cfg(any(target_os = "linux", target_os = "android"))]
    lsetxattr(&path, SELINUX_XATTR, con, XattrFlags::empty()).with_context(|| {
        format!(
            "Failed to change SELinux context for {}",
            path.as_ref().display()
        )
    })?;
    Ok(())
}

#[cfg(any(target_os = "linux", target_os = "android"))]
pub fn lgetfilecon<P: AsRef<Path>>(path: P) -> Result<String> {
    let con = extattr::lgetxattr(&path, SELINUX_XATTR).with_context(|| {
        format!(
            "Failed to get SELinux context for {}",
            path.as_ref().display()
        )
    })?;
    let con = String::from_utf8_lossy(&con);
    Ok(con.to_string())
}

#[cfg(any(target_os = "linux", target_os = "android"))]
pub fn setsyscon<P: AsRef<Path>>(path: P) -> Result<()> {
    lsetfilecon(path, SYSTEM_CON)
}

#[cfg(not(any(target_os = "linux", target_os = "android")))]
pub fn setsyscon<P: AsRef<Path>>(path: P) -> Result<()> {
    unimplemented!()
}

#[cfg(not(any(target_os = "linux", target_os = "android")))]
pub fn lgetfilecon<P: AsRef<Path>>(path: P) -> Result<String> {
    unimplemented!()
}

pub fn restore_syscon<P: AsRef<Path>>(dir: P) -> Result<()> {
    for dir_entry in WalkDir::new(dir).parallelism(Serial) {
        if let Some(path) = dir_entry.ok().map(|dir_entry| dir_entry.path()) {
            setsyscon(&path)?;
        }
    }
    Ok(())
}

fn restore_syscon_if_unlabeled<P: AsRef<Path>>(dir: P) -> Result<()> {
    for dir_entry in WalkDir::new(dir).parallelism(Serial) {
        if let Some(path) = dir_entry.ok().map(|dir_entry| dir_entry.path()) {
            if let Result::Ok(con) = lgetfilecon(&path) {
                if con == UNLABEL_CON || con.is_empty() {
                    lsetfilecon(&path, SYSTEM_CON)?;
                }
            }
        }
    }
    Ok(())
}

pub fn restorecon() -> Result<()> {
    lsetfilecon(defs::DAEMON_PATH, ADB_CON)?;
    restore_syscon_if_unlabeled(defs::MODULE_DIR)?;
    Ok(())
}

```

`apd/src/sepolicy.rs`:

```rs
use std::{ffi, path::Path, vec};

use anyhow::{Result, bail};
use derive_new::new;
use nom::{
    AsChar, IResult, Parser,
    branch::alt,
    bytes::complete::{tag, take_while, take_while_m_n, take_while1},
    character::complete::{space0, space1},
    combinator::map,
};

type SeObject<'a> = Vec<&'a str>;

fn is_sepolicy_char(c: char) -> bool {
    c.is_alphanum() || c == '_' || c == '-'
}

fn parse_single_word(input: &str) -> IResult<&str, &str> {
    take_while1(is_sepolicy_char).parse(input)
}

fn parse_bracket_objs(input: &str) -> IResult<&str, SeObject<'_>> {
    let (input, (_, words, _)) = (
        tag("{"),
        take_while_m_n(1, 100, |c: char| is_sepolicy_char(c) || c.is_whitespace()),
        tag("}"),
    )
        .parse(input)?;
    Ok((input, words.split_whitespace().collect()))
}

fn parse_single_obj(input: &str) -> IResult<&str, SeObject<'_>> {
    let (input, word) = take_while1(is_sepolicy_char).parse(input)?;
    Ok((input, vec![word]))
}

fn parse_star(input: &str) -> IResult<&str, SeObject<'_>> {
    let (input, _) = tag("*").parse(input)?;
    Ok((input, vec!["*"]))
}

// 1. a single sepolicy word
// 2. { obj1 obj2 obj3 ...}
// 3. *
fn parse_seobj(input: &str) -> IResult<&str, SeObject<'_>> {
    let (input, strs) = alt((parse_single_obj, parse_bracket_objs, parse_star)).parse(input)?;
    Ok((input, strs))
}

fn parse_seobj_no_star(input: &str) -> IResult<&str, SeObject<'_>> {
    let (input, strs) = alt((parse_single_obj, parse_bracket_objs)).parse(input)?;
    Ok((input, strs))
}

trait SeObjectParser<'a> {
    fn parse(input: &'a str) -> IResult<&'a str, Self>
    where
        Self: Sized;
}

#[derive(Debug, PartialEq, Eq, new)]
struct NormalPerm<'a> {
    op: &'a str,
    source: SeObject<'a>,
    target: SeObject<'a>,
    class: SeObject<'a>,
    perm: SeObject<'a>,
}

#[derive(Debug, PartialEq, Eq, new)]
struct XPerm<'a> {
    op: &'a str,
    source: SeObject<'a>,
    target: SeObject<'a>,
    class: SeObject<'a>,
    operation: &'a str,
    perm_set: &'a str,
}

#[derive(Debug, PartialEq, Eq, new)]
struct TypeState<'a> {
    op: &'a str,
    stype: SeObject<'a>,
}

#[derive(Debug, PartialEq, Eq, new)]
struct TypeAttr<'a> {
    stype: SeObject<'a>,
    sattr: SeObject<'a>,
}

#[derive(Debug, PartialEq, Eq, new)]
struct Type<'a> {
    name: &'a str,
    attrs: SeObject<'a>,
}

#[derive(Debug, PartialEq, Eq, new)]
struct Attr<'a> {
    name: &'a str,
}

#[derive(Debug, PartialEq, Eq, new)]
struct TypeTransition<'a> {
    source: &'a str,
    target: &'a str,
    class: &'a str,
    default_type: &'a str,
    object_name: Option<&'a str>,
}

#[derive(Debug, PartialEq, Eq, new)]
struct TypeChange<'a> {
    op: &'a str,
    source: &'a str,
    target: &'a str,
    class: &'a str,
    default_type: &'a str,
}

#[derive(Debug, PartialEq, Eq, new)]
struct GenFsCon<'a> {
    fs_name: &'a str,
    partial_path: &'a str,
    fs_context: &'a str,
}

#[derive(Debug)]
enum PolicyStatement<'a> {
    // "allow *source_type *target_type *class *perm_set"
    // "deny *source_type *target_type *class *perm_set"
    // "auditallow *source_type *target_type *class *perm_set"
    // "dontaudit *source_type *target_type *class *perm_set"
    NormalPerm(NormalPerm<'a>),

    // "allowxperm *source_type *target_type *class operation xperm_set"
    // "auditallowxperm *source_type *target_type *class operation xperm_set"
    // "dontauditxperm *source_type *target_type *class operation xperm_set"
    XPerm(XPerm<'a>),

    // "permissive ^type"
    // "enforce ^type"
    TypeState(TypeState<'a>),

    // "type type_name ^(attribute)"
    Type(Type<'a>),

    // "typeattribute ^type ^attribute"
    TypeAttr(TypeAttr<'a>),

    // "attribute ^attribute"
    Attr(Attr<'a>),

    // "type_transition source_type target_type class default_type (object_name)"
    TypeTransition(TypeTransition<'a>),

    // "type_change source_type target_type class default_type"
    // "type_member source_type target_type class default_type"
    TypeChange(TypeChange<'a>),

    // "genfscon fs_name partial_path fs_context"
    GenFsCon(GenFsCon<'a>),
}

impl<'a> SeObjectParser<'a> for NormalPerm<'a> {
    fn parse(input: &'a str) -> IResult<&'a str, Self> {
        let (input, op) = alt((
            tag("allow"),
            tag("deny"),
            tag("auditallow"),
            tag("dontaudit"),
        ))
        .parse(input)?;

        let (input, _) = space0(input)?;
        let (input, source) = parse_seobj(input)?;
        let (input, _) = space0(input)?;
        let (input, target) = parse_seobj(input)?;
        let (input, _) = space0(input)?;
        let (input, class) = parse_seobj(input)?;
        let (input, _) = space0(input)?;
        let (input, perm) = parse_seobj(input)?;
        Ok((input, NormalPerm::new(op, source, target, class, perm)))
    }
}

impl<'a> SeObjectParser<'a> for XPerm<'a> {
    fn parse(input: &'a str) -> IResult<&'a str, Self> {
        let (input, op) = alt((
            tag("allowxperm"),
            tag("auditallowxperm"),
            tag("dontauditxperm"),
        ))
        .parse(input)?;

        let (input, _) = space0(input)?;
        let (input, source) = parse_seobj(input)?;
        let (input, _) = space0(input)?;
        let (input, target) = parse_seobj(input)?;
        let (input, _) = space0(input)?;
        let (input, class) = parse_seobj(input)?;
        let (input, _) = space0(input)?;
        let (input, operation) = parse_single_word(input)?;
        let (input, _) = space0(input)?;
        let (input, perm_set) = parse_single_word(input)?;

        Ok((
            input,
            XPerm::new(op, source, target, class, operation, perm_set),
        ))
    }
}

impl<'a> SeObjectParser<'a> for TypeState<'a> {
    fn parse(input: &'a str) -> IResult<&'a str, Self> {
        let (input, op) = alt((tag("permissive"), tag("enforce"))).parse(input)?;

        let (input, _) = space1(input)?;
        let (input, stype) = parse_seobj_no_star(input)?;

        Ok((input, TypeState::new(op, stype)))
    }
}

impl<'a> SeObjectParser<'a> for Type<'a> {
    fn parse(input: &'a str) -> IResult<&'a str, Self> {
        let (input, _) = tag("type")(input)?;
        let (input, _) = space1(input)?;
        let (input, name) = parse_single_word(input)?;

        if input.is_empty() {
            return Ok((input, Type::new(name, vec!["domain"]))); // default to domain
        }

        let (input, _) = space1(input)?;
        let (input, attrs) = parse_seobj_no_star(input)?;

        Ok((input, Type::new(name, attrs)))
    }
}

impl<'a> SeObjectParser<'a> for TypeAttr<'a> {
    fn parse(input: &'a str) -> IResult<&'a str, Self> {
        let (input, _) = alt((tag("typeattribute"), tag("attradd"))).parse(input)?;
        let (input, _) = space1(input)?;
        let (input, stype) = parse_seobj_no_star(input)?;
        let (input, _) = space1(input)?;
        let (input, attr) = parse_seobj_no_star(input)?;

        Ok((input, TypeAttr::new(stype, attr)))
    }
}

impl<'a> SeObjectParser<'a> for Attr<'a> {
    fn parse(input: &'a str) -> IResult<&'a str, Self> {
        let (input, _) = tag("attribute")(input)?;
        let (input, _) = space1(input)?;
        let (input, attr) = parse_single_word(input)?;

        Ok((input, Attr::new(attr)))
    }
}

impl<'a> SeObjectParser<'a> for TypeTransition<'a> {
    fn parse(input: &'a str) -> IResult<&'a str, Self> {
        let (input, _) = alt((tag("type_transition"), tag("name_transition"))).parse(input)?;
        let (input, _) = space1(input)?;
        let (input, source) = parse_single_word(input)?;
        let (input, _) = space1(input)?;
        let (input, target) = parse_single_word(input)?;
        let (input, _) = space1(input)?;
        let (input, class) = parse_single_word(input)?;
        let (input, _) = space1(input)?;
        let (input, default) = parse_single_word(input)?;

        if input.is_empty() {
            return Ok((
                input,
                TypeTransition::new(source, target, class, default, None),
            ));
        }

        let (input, _) = space1(input)?;
        let (input, object) = parse_single_word(input)?;

        Ok((
            input,
            TypeTransition::new(source, target, class, default, Some(object)),
        ))
    }
}

impl<'a> SeObjectParser<'a> for TypeChange<'a> {
    fn parse(input: &'a str) -> IResult<&'a str, Self> {
        let (input, op) = alt((tag("type_change"), tag("type_member"))).parse(input)?;
        let (input, _) = space1(input)?;
        let (input, source) = parse_single_word(input)?;
        let (input, _) = space1(input)?;
        let (input, target) = parse_single_word(input)?;
        let (input, _) = space1(input)?;
        let (input, class) = parse_single_word(input)?;
        let (input, _) = space1(input)?;
        let (input, default) = parse_single_word(input)?;

        Ok((input, TypeChange::new(op, source, target, class, default)))
    }
}

impl<'a> SeObjectParser<'a> for GenFsCon<'a> {
    fn parse(input: &'a str) -> IResult<&'a str, Self>
    where
        Self: Sized,
    {
        let (input, _) = tag("genfscon")(input)?;
        let (input, _) = space1(input)?;
        let (input, fs) = parse_single_word(input)?;
        let (input, _) = space1(input)?;
        let (input, path) = parse_single_word(input)?;
        let (input, _) = space1(input)?;
        let (input, context) = parse_single_word(input)?;
        Ok((input, GenFsCon::new(fs, path, context)))
    }
}

impl<'a> PolicyStatement<'a> {
    fn parse(input: &'a str) -> IResult<&'a str, Self> {
        let (input, _) = space0(input)?;
        let (input, statement) = alt((
            map(NormalPerm::parse, PolicyStatement::NormalPerm),
            map(XPerm::parse, PolicyStatement::XPerm),
            map(TypeState::parse, PolicyStatement::TypeState),
            map(Type::parse, PolicyStatement::Type),
            map(TypeAttr::parse, PolicyStatement::TypeAttr),
            map(Attr::parse, PolicyStatement::Attr),
            map(TypeTransition::parse, PolicyStatement::TypeTransition),
            map(TypeChange::parse, PolicyStatement::TypeChange),
            map(GenFsCon::parse, PolicyStatement::GenFsCon),
        ))
        .parse(input)?;
        let (input, _) = space0(input)?;
        let (input, _) = take_while(|c| c == ';')(input)?;
        let (input, _) = space0(input)?;
        Ok((input, statement))
    }
}

fn parse_sepolicy<'a, 'b>(input: &'b str, strict: bool) -> Result<Vec<PolicyStatement<'a>>>
where
    'b: 'a,
{
    let mut statements = vec![];

    for line in input.split(['\n', ';']) {
        let trimmed_line = line.trim();
        if trimmed_line.is_empty() || trimmed_line.starts_with('#') {
            continue;
        }
        if let Ok((_, statement)) = PolicyStatement::parse(trimmed_line) {
            statements.push(statement);
        } else if strict {
            bail!("Failed to parse policy statement: {}", line)
        }
    }
    Ok(statements)
}

const SEPOLICY_MAX_LEN: usize = 128;

const CMD_NORMAL_PERM: u32 = 1;
const CMD_XPERM: u32 = 2;
const CMD_TYPE_STATE: u32 = 3;
const CMD_TYPE: u32 = 4;
const CMD_TYPE_ATTR: u32 = 5;
const CMD_ATTR: u32 = 6;
const CMD_TYPE_TRANSITION: u32 = 7;
const CMD_TYPE_CHANGE: u32 = 8;
const CMD_GENFSCON: u32 = 9;

#[derive(Debug, Default)]
enum PolicyObject {
    All, // for "*", stand for all objects, and is NULL in ffi
    One([u8; SEPOLICY_MAX_LEN]),
    #[default]
    None,
}

impl TryFrom<&str> for PolicyObject {
    type Error = anyhow::Error;
    fn try_from(s: &str) -> Result<Self> {
        anyhow::ensure!(s.len() <= SEPOLICY_MAX_LEN, "policy object too long");
        if s == "*" {
            return Ok(PolicyObject::All);
        }
        let mut buf = [0u8; SEPOLICY_MAX_LEN];
        buf[..s.len()].copy_from_slice(s.as_bytes());
        Ok(PolicyObject::One(buf))
    }
}

/// atomic statement, such as: allow domain1 domain2:file1 read;
/// normal statement would be expanded to atomic statement, for example:
/// allow domain1 domain2:file1 { read write }; would be expanded to two atomic statement
/// allow domain1 domain2:file1 read;allow domain1 domain2:file1 write;
#[allow(clippy::too_many_arguments)]
#[derive(Debug, new)]
struct AtomicStatement {
    cmd: u32,
    subcmd: u32,
    sepol1: PolicyObject,
    sepol2: PolicyObject,
    sepol3: PolicyObject,
    sepol4: PolicyObject,
    sepol5: PolicyObject,
    sepol6: PolicyObject,
    sepol7: PolicyObject,
}

impl<'a> TryFrom<&'a NormalPerm<'a>> for Vec<AtomicStatement> {
    type Error = anyhow::Error;
    fn try_from(perm: &'a NormalPerm<'a>) -> Result<Self> {
        let mut result = vec![];
        let subcmd = match perm.op {
            "allow" => 1,
            "deny" => 2,
            "auditallow" => 3,
            "dontaudit" => 4,
            _ => 0,
        };
        for &s in &perm.source {
            for &t in &perm.target {
                for &c in &perm.class {
                    for &p in &perm.perm {
                        result.push(AtomicStatement {
                            cmd: CMD_NORMAL_PERM,
                            subcmd,
                            sepol1: s.try_into()?,
                            sepol2: t.try_into()?,
                            sepol3: c.try_into()?,
                            sepol4: p.try_into()?,
                            sepol5: PolicyObject::None,
                            sepol6: PolicyObject::None,
                            sepol7: PolicyObject::None,
                        });
                    }
                }
            }
        }
        Ok(result)
    }
}

impl<'a> TryFrom<&'a XPerm<'a>> for Vec<AtomicStatement> {
    type Error = anyhow::Error;
    fn try_from(perm: &'a XPerm<'a>) -> Result<Self> {
        let mut result = vec![];
        let subcmd = match perm.op {
            "allowxperm" => 1,
            "auditallowxperm" => 2,
            "dontauditxperm" => 3,
            _ => 0,
        };
        for &s in &perm.source {
            for &t in &perm.target {
                for &c in &perm.class {
                    result.push(AtomicStatement {
                        cmd: CMD_XPERM,
                        subcmd,
                        sepol1: s.try_into()?,
                        sepol2: t.try_into()?,
                        sepol3: c.try_into()?,
                        sepol4: perm.operation.try_into()?,
                        sepol5: perm.perm_set.try_into()?,
                        sepol6: PolicyObject::None,
                        sepol7: PolicyObject::None,
                    });
                }
            }
        }
        Ok(result)
    }
}

impl<'a> TryFrom<&'a TypeState<'a>> for Vec<AtomicStatement> {
    type Error = anyhow::Error;
    fn try_from(perm: &'a TypeState<'a>) -> Result<Self> {
        let mut result = vec![];
        let subcmd = match perm.op {
            "permissive" => 1,
            "enforcing" => 2,
            _ => 0,
        };
        for &t in &perm.stype {
            result.push(AtomicStatement {
                cmd: CMD_TYPE_STATE,
                subcmd,
                sepol1: t.try_into()?,
                sepol2: PolicyObject::None,
                sepol3: PolicyObject::None,
                sepol4: PolicyObject::None,
                sepol5: PolicyObject::None,
                sepol6: PolicyObject::None,
                sepol7: PolicyObject::None,
            });
        }
        Ok(result)
    }
}

impl<'a> TryFrom<&'a Type<'a>> for Vec<AtomicStatement> {
    type Error = anyhow::Error;
    fn try_from(perm: &'a Type<'a>) -> Result<Self> {
        let mut result = vec![];
        for &attr in &perm.attrs {
            result.push(AtomicStatement {
                cmd: CMD_TYPE,
                subcmd: 0,
                sepol1: perm.name.try_into()?,
                sepol2: attr.try_into()?,
                sepol3: PolicyObject::None,
                sepol4: PolicyObject::None,
                sepol5: PolicyObject::None,
                sepol6: PolicyObject::None,
                sepol7: PolicyObject::None,
            });
        }
        Ok(result)
    }
}

impl<'a> TryFrom<&'a TypeAttr<'a>> for Vec<AtomicStatement> {
    type Error = anyhow::Error;
    fn try_from(perm: &'a TypeAttr<'a>) -> Result<Self> {
        let mut result = vec![];
        for &t in &perm.stype {
            for &attr in &perm.sattr {
                result.push(AtomicStatement {
                    cmd: CMD_TYPE_ATTR,
                    subcmd: 0,
                    sepol1: t.try_into()?,
                    sepol2: attr.try_into()?,
                    sepol3: PolicyObject::None,
                    sepol4: PolicyObject::None,
                    sepol5: PolicyObject::None,
                    sepol6: PolicyObject::None,
                    sepol7: PolicyObject::None,
                });
            }
        }
        Ok(result)
    }
}

impl<'a> TryFrom<&'a Attr<'a>> for Vec<AtomicStatement> {
    type Error = anyhow::Error;
    fn try_from(perm: &'a Attr<'a>) -> Result<Self> {
        let result = vec![AtomicStatement {
            cmd: CMD_ATTR,
            subcmd: 0,
            sepol1: perm.name.try_into()?,
            sepol2: PolicyObject::None,
            sepol3: PolicyObject::None,
            sepol4: PolicyObject::None,
            sepol5: PolicyObject::None,
            sepol6: PolicyObject::None,
            sepol7: PolicyObject::None,
        }];
        Ok(result)
    }
}

impl<'a> TryFrom<&'a TypeTransition<'a>> for Vec<AtomicStatement> {
    type Error = anyhow::Error;
    fn try_from(perm: &'a TypeTransition<'a>) -> Result<Self> {
        let mut result = vec![];
        let obj = match perm.object_name {
            Some(obj) => obj.try_into()?,
            None => PolicyObject::None,
        };
        result.push(AtomicStatement {
            cmd: CMD_TYPE_TRANSITION,
            subcmd: 0,
            sepol1: perm.source.try_into()?,
            sepol2: perm.target.try_into()?,
            sepol3: perm.class.try_into()?,
            sepol4: perm.default_type.try_into()?,
            sepol5: obj,
            sepol6: PolicyObject::None,
            sepol7: PolicyObject::None,
        });
        Ok(result)
    }
}

impl<'a> TryFrom<&'a TypeChange<'a>> for Vec<AtomicStatement> {
    type Error = anyhow::Error;
    fn try_from(perm: &'a TypeChange<'a>) -> Result<Self> {
        let mut result = vec![];
        let subcmd = match perm.op {
            "type_change" => 1,
            "type_member" => 2,
            _ => 0,
        };
        result.push(AtomicStatement {
            cmd: CMD_TYPE_CHANGE,
            subcmd,
            sepol1: perm.source.try_into()?,
            sepol2: perm.target.try_into()?,
            sepol3: perm.class.try_into()?,
            sepol4: perm.default_type.try_into()?,
            sepol5: PolicyObject::None,
            sepol6: PolicyObject::None,
            sepol7: PolicyObject::None,
        });
        Ok(result)
    }
}

impl<'a> TryFrom<&'a GenFsCon<'a>> for Vec<AtomicStatement> {
    type Error = anyhow::Error;
    fn try_from(perm: &'a GenFsCon<'a>) -> Result<Self> {
        let result = vec![AtomicStatement {
            cmd: CMD_GENFSCON,
            subcmd: 0,
            sepol1: perm.fs_name.try_into()?,
            sepol2: perm.partial_path.try_into()?,
            sepol3: perm.fs_context.try_into()?,
            sepol4: PolicyObject::None,
            sepol5: PolicyObject::None,
            sepol6: PolicyObject::None,
            sepol7: PolicyObject::None,
        }];
        Ok(result)
    }
}

impl<'a> TryFrom<&'a PolicyStatement<'a>> for Vec<AtomicStatement> {
    type Error = anyhow::Error;
    fn try_from(value: &'a PolicyStatement) -> Result<Self> {
        match value {
            PolicyStatement::NormalPerm(perm) => perm.try_into(),
            PolicyStatement::XPerm(perm) => perm.try_into(),
            PolicyStatement::TypeState(perm) => perm.try_into(),
            PolicyStatement::Type(perm) => perm.try_into(),
            PolicyStatement::TypeAttr(perm) => perm.try_into(),
            PolicyStatement::Attr(perm) => perm.try_into(),
            PolicyStatement::TypeTransition(perm) => perm.try_into(),
            PolicyStatement::TypeChange(perm) => perm.try_into(),
            PolicyStatement::GenFsCon(perm) => perm.try_into(),
        }
    }
}

////////////////////////////////////////////////////////////////
///  for C FFI to call kernel interface
///////////////////////////////////////////////////////////////

#[derive(Debug)]
#[repr(C)]
struct FfiPolicy {
    cmd: u32,
    subcmd: u32,
    sepol1: *const ffi::c_char,
    sepol2: *const ffi::c_char,
    sepol3: *const ffi::c_char,
    sepol4: *const ffi::c_char,
    sepol5: *const ffi::c_char,
    sepol6: *const ffi::c_char,
    sepol7: *const ffi::c_char,
}

fn to_c_ptr(pol: &PolicyObject) -> *const ffi::c_char {
    match pol {
        PolicyObject::None | PolicyObject::All => std::ptr::null(),
        PolicyObject::One(s) => s.as_ptr().cast::<ffi::c_char>(),
    }
}

impl From<AtomicStatement> for FfiPolicy {
    fn from(policy: AtomicStatement) -> FfiPolicy {
        FfiPolicy {
            cmd: policy.cmd,
            subcmd: policy.subcmd,
            sepol1: to_c_ptr(&policy.sepol1),
            sepol2: to_c_ptr(&policy.sepol2),
            sepol3: to_c_ptr(&policy.sepol3),
            sepol4: to_c_ptr(&policy.sepol4),
            sepol5: to_c_ptr(&policy.sepol5),
            sepol6: to_c_ptr(&policy.sepol6),
            sepol7: to_c_ptr(&policy.sepol7),
        }
    }
}

pub fn check_rule(policy: &str) -> Result<()> {
    let path = Path::new(policy);
    let policy = if path.exists() {
        std::fs::read_to_string(path)?
    } else {
        policy.to_string()
    };
    parse_sepolicy(policy.trim(), true)?;
    Ok(())
}

```

`apd/src/supercall.rs`:

```rs
use std::{
    ffi::{CStr, CString},
    fmt::Write,
    fs::File,
    io::{self, Read},
    process,
    process::exit,
    ptr,
    sync::{Arc, Mutex},
};

use errno::errno;
use libc::{EINVAL, c_int, c_long, c_void, execv, fork, pid_t, setenv, syscall, uid_t, wait};
use log::{error, info, warn};

use crate::package::{read_ap_package_config, synchronize_package_uid};

const MAJOR: c_long = 0;
const MINOR: c_long = 11;
const PATCH: c_long = 1;

const KSTORAGE_EXCLUDE_LIST_GROUP: i32 = 1;

const __NR_SUPERCALL: c_long = 45;
const SUPERCALL_KLOG: c_long = 0x1004;
const SUPERCALL_KERNELPATCH_VER: c_long = 0x1008;
const SUPERCALL_KERNEL_VER: c_long = 0x1009;
const SUPERCALL_SU: c_long = 0x1010;
const SUPERCALL_KSTORAGE_WRITE: c_long = 0x1041;
const SUPERCALL_SU_GRANT_UID: c_long = 0x1100;
const SUPERCALL_SU_REVOKE_UID: c_long = 0x1101;
const SUPERCALL_SU_NUMS: c_long = 0x1102;
const SUPERCALL_SU_LIST: c_long = 0x1103;
const SUPERCALL_SU_RESET_PATH: c_long = 0x1111;
const SUPERCALL_SU_GET_SAFEMODE: c_long = 0x1112;

const SUPERCALL_SCONTEXT_LEN: usize = 0x60;

#[repr(C)]
struct SuProfile {
    uid: i32,
    to_uid: i32,
    scontext: [u8; SUPERCALL_SCONTEXT_LEN],
}

fn ver_and_cmd(cmd: c_long) -> c_long {
    let version_code: u32 = ((MAJOR << 16) + (MINOR << 8) + PATCH).try_into().unwrap();
    ((version_code as c_long) << 32) | (0x1158 << 16) | (cmd & 0xFFFF)
}

fn sc_su_revoke_uid(key: &CStr, uid: uid_t) -> c_long {
    if key.to_bytes().is_empty() {
        return (-EINVAL).into();
    }
    unsafe {
        syscall(
            __NR_SUPERCALL,
            key.as_ptr(),
            ver_and_cmd(SUPERCALL_SU_REVOKE_UID),
            uid,
        ) as c_long
    }
}

fn sc_su_grant_uid(key: &CStr, profile: &SuProfile) -> c_long {
    if key.to_bytes().is_empty() {
        return (-EINVAL).into();
    }
    unsafe {
        syscall(
            __NR_SUPERCALL,
            key.as_ptr(),
            ver_and_cmd(SUPERCALL_SU_GRANT_UID),
            profile,
        ) as c_long
    }
}

fn sc_kstorage_write(
    key: &CStr,
    gid: i32,
    did: i64,
    data: *mut c_void,
    offset: i32,
    dlen: i32,
) -> c_long {
    if key.to_bytes().is_empty() {
        return (-EINVAL).into();
    }
    unsafe {
        syscall(
            __NR_SUPERCALL,
            key.as_ptr(),
            ver_and_cmd(SUPERCALL_KSTORAGE_WRITE),
            gid as c_long,
            did as c_long,
            data,
            (((offset as i64) << 32) | (dlen as i64)) as c_long,
        ) as c_long
    }
}

fn sc_set_ap_mod_exclude(key: &CStr, uid: i64, exclude: i32) -> c_long {
    sc_kstorage_write(
        key,
        KSTORAGE_EXCLUDE_LIST_GROUP,
        uid,
        &exclude as *const i32 as *mut c_void,
        0,
        size_of::<i32>() as i32,
    )
}

pub fn sc_su_get_safemode(key: &CStr) -> c_long {
    if key.to_bytes().is_empty() {
        warn!("[sc_su_get_safemode] null superkey, tell apd we are not in safemode!");
        return 0;
    }

    let key_ptr = key.as_ptr();
    if key_ptr.is_null() {
        warn!("[sc_su_get_safemode] superkey pointer is null!");
        return 0;
    }

    unsafe {
        syscall(
            __NR_SUPERCALL,
            key_ptr,
            ver_and_cmd(SUPERCALL_SU_GET_SAFEMODE),
        ) as c_long
    }
}

fn sc_su(key: &CStr, profile: &SuProfile) -> c_long {
    if key.to_bytes().is_empty() {
        return (-EINVAL).into();
    }
    unsafe {
        syscall(
            __NR_SUPERCALL,
            key.as_ptr(),
            ver_and_cmd(SUPERCALL_SU),
            profile,
        ) as c_long
    }
}

fn sc_su_reset_path(key: &CStr, path: &CStr) -> c_long {
    if key.to_bytes().is_empty() || path.to_bytes().is_empty() {
        return (-EINVAL).into();
    }
    unsafe {
        syscall(
            __NR_SUPERCALL,
            key.as_ptr(),
            ver_and_cmd(SUPERCALL_SU_RESET_PATH),
            path.as_ptr(),
        ) as c_long
    }
}

fn sc_kp_ver(key: &CStr) -> Result<u32, i32> {
    if key.to_bytes().is_empty() {
        return Err(-EINVAL);
    }
    let ret = unsafe {
        syscall(
            __NR_SUPERCALL,
            key.as_ptr(),
            ver_and_cmd(SUPERCALL_KERNELPATCH_VER),
        )
    };
    Ok(ret as u32)
}

fn sc_k_ver(key: &CStr) -> Result<u32, i32> {
    if key.to_bytes().is_empty() {
        return Err(-EINVAL);
    }
    let ret = unsafe {
        syscall(
            __NR_SUPERCALL,
            key.as_ptr(),
            ver_and_cmd(SUPERCALL_KERNEL_VER),
        )
    };
    Ok(ret as u32)
}

fn sc_klog(key: &CStr, msg: &CStr) -> c_long {
    if key.to_bytes().is_empty() || msg.to_bytes().is_empty() {
        return (-EINVAL).into();
    }
    unsafe {
        syscall(
            __NR_SUPERCALL,
            key.as_ptr(),
            ver_and_cmd(SUPERCALL_KLOG),
            msg.as_ptr(),
        ) as c_long
    }
}

fn sc_su_uid_nums(key: &CStr) -> c_long {
    if key.to_bytes().is_empty() {
        return (-EINVAL).into();
    }
    unsafe { syscall(__NR_SUPERCALL, key.as_ptr(), ver_and_cmd(SUPERCALL_SU_NUMS)) as c_long }
}

fn sc_su_allow_uids(key: &CStr, buf: &mut [uid_t]) -> c_long {
    if key.to_bytes().is_empty() {
        return (-EINVAL).into();
    }
    if buf.is_empty() {
        return (-EINVAL).into();
    }
    unsafe {
        syscall(
            __NR_SUPERCALL,
            key.as_ptr(),
            ver_and_cmd(SUPERCALL_SU_LIST),
            buf.as_mut_ptr(),
            buf.len() as i32,
        ) as c_long
    }
}

fn read_file_to_string(path: &str) -> io::Result<String> {
    let mut file = File::open(path)?;
    let mut content = String::new();
    file.read_to_string(&mut content)?;
    Ok(content)
}

fn convert_string_to_u8_array(s: &str) -> [u8; SUPERCALL_SCONTEXT_LEN] {
    let mut u8_array = [0u8; SUPERCALL_SCONTEXT_LEN];
    let bytes = s.as_bytes();
    let len = usize::min(SUPERCALL_SCONTEXT_LEN, bytes.len());
    u8_array[..len].copy_from_slice(&bytes[..len]);
    u8_array
}

fn convert_superkey(s: &Option<String>) -> Option<CString> {
    s.as_ref().and_then(|s| CString::new(s.clone()).ok())
}

pub fn refresh_ap_package_list(skey: &CStr, mutex: &Arc<Mutex<()>>) {
    let _lock = mutex.lock().unwrap();

    let num = sc_su_uid_nums(skey);
    if num < 0 {
        error!("[refresh_su_list] Error getting number of UIDs: {}", num);
        return;
    }
    let num = num as usize;
    let mut uids = vec![0 as uid_t; num];
    let n = sc_su_allow_uids(skey, &mut uids);
    if n < 0 {
        error!("[refresh_su_list] Error getting su list");
        return;
    }
    for uid in &uids {
        if *uid == 0 || *uid == 2000 {
            warn!(
                "[refresh_ap_package_list] Skip revoking critical uid: {}",
                uid
            );
            continue;
        }
        info!(
            "[refresh_ap_package_list] Revoking {} root permission...",
            uid
        );
        let rc = sc_su_revoke_uid(skey, *uid);
        if rc != 0 {
            error!("[refresh_ap_package_list] Error revoking UID: {}", rc);
        }
    }

    if let Err(e) = synchronize_package_uid() {
        error!("Failed to synchronize package UIDs: {}", e);
    }

    let package_configs = read_ap_package_config();
    for config in package_configs {
        if config.allow == 1 && config.exclude == 0 {
            let profile = SuProfile {
                uid: config.uid,
                to_uid: config.to_uid,
                scontext: convert_string_to_u8_array(&config.sctx),
            };
            let result = sc_su_grant_uid(skey, &profile);
            info!(
                "[refresh_ap_package_list] Loading {}: result = {}",
                config.pkg, result
            );
        }
        if config.allow == 0 && config.exclude == 1 {
            let result = sc_set_ap_mod_exclude(skey, config.uid as i64, 1);
            info!(
                "[refresh_ap_package_list] Loading exclude {}: result = {}",
                config.pkg, result
            );
        }
    }
}

pub fn privilege_apd_profile(superkey: &Option<String>) {
    let key = convert_superkey(superkey);

    let all_allow_ctx = "u:r:magisk:s0";
    let profile = SuProfile {
        uid: process::id().try_into().expect("PID conversion failed"),
        to_uid: 0,
        scontext: convert_string_to_u8_array(all_allow_ctx),
    };
    if let Some(ref key) = key {
        let result = sc_su(key, &profile);
        info!("[privilege_apd_profile] result = {}", result);
    }
}

pub fn init_load_package_uid_config(superkey: &Option<String>) {
    let package_configs = read_ap_package_config();
    let key = convert_superkey(superkey);

    for config in package_configs {
        if config.allow == 1 && config.exclude == 0 {
            match key {
                Some(ref key) => {
                    let profile = SuProfile {
                        uid: config.uid,
                        to_uid: config.to_uid,
                        scontext: convert_string_to_u8_array(&config.sctx),
                    };
                    let result = sc_su_grant_uid(key, &profile);
                    info!("Processed {}: result = {}", config.pkg, result);
                }
                _ => {
                    warn!("Superkey is None, skipping config: {}", config.pkg);
                }
            }
        }
        if config.allow == 0 && config.exclude == 1 {
            match key {
                Some(ref key) => {
                    let result = sc_set_ap_mod_exclude(key, config.uid as i64, 1);
                    info!("Processed exclude {}: result = {}", config.pkg, result);
                }
                _ => {
                    warn!("Superkey is None, skipping config: {}", config.pkg);
                }
            }
        }
    }
}

pub fn init_load_su_path(superkey: &Option<String>) {
    let su_path_file = "/data/adb/ap/su_path";

    match read_file_to_string(su_path_file) {
        Ok(su_path) => {
            let superkey_cstr = convert_superkey(superkey);

            match superkey_cstr {
                Some(superkey_cstr) => match CString::new(su_path.trim()) {
                    Ok(su_path_cstr) => {
                        let result = sc_su_reset_path(&superkey_cstr, &su_path_cstr);
                        if result == 0 {
                            info!("suPath load successfully");
                        } else {
                            warn!("Failed to load su path, error code: {}", result);
                        }
                    }
                    Err(e) => {
                        warn!("Failed to convert su_path: {}", e);
                    }
                },
                _ => {
                    warn!("Superkey is None, skipping...");
                }
            }
        }
        Err(e) => {
            warn!("Failed to read su_path file: {}", e);
        }
    }
}

fn set_env_var(key: &str, value: &str) {
    let key_c = CString::new(key).expect("CString::new failed");
    let value_c = CString::new(value).expect("CString::new failed");
    unsafe {
        setenv(key_c.as_ptr(), value_c.as_ptr(), 1);
    }
}

fn log_kernel(key: &CStr, _fmt: &str, args: std::fmt::Arguments) -> c_long {
    let mut buf = String::with_capacity(1024);
    write!(&mut buf, "{}", args).expect("Error formatting string");

    let c_buf = CString::new(buf).expect("CString::new failed");
    sc_klog(key, &c_buf)
}

#[macro_export]
macro_rules! log_kernel {
    ($key:expr_2021, $fmt:expr_2021, $($arg:tt)*) => (
        log_kernel($key, $fmt, std::format_args!($fmt, $($arg)*))
    )
}

pub fn fork_for_result(exec: &str, argv: &[&str], key: &Option<String>) {
    let mut cmd = String::new();
    for arg in argv {
        cmd.push_str(arg);
        cmd.push(' ');
    }

    let superkey_cstr = convert_superkey(key);

    match superkey_cstr {
        Some(superkey_cstr) => {
            unsafe {
                let pid: pid_t = fork();
                if pid < 0 {
                    log_kernel!(
                        &superkey_cstr,
                        "{} fork {} error: {}\n",
                        libc::getpid(),
                        exec,
                        -1
                    );
                } else if pid == 0 {
                    set_env_var("KERNELPATCH", "true");
                    let kpver = format!("{:x}", sc_kp_ver(&superkey_cstr).unwrap_or(0));
                    set_env_var("KERNELPATCH_VERSION", kpver.as_str());
                    let kver = format!("{:x}", sc_k_ver(&superkey_cstr).unwrap_or(0));
                    set_env_var("KERNEL_VERSION", kver.as_str());

                    let c_exec = CString::new(exec).expect("CString::new failed");
                    let c_argv: Vec<CString> =
                        argv.iter().map(|&arg| CString::new(arg).unwrap()).collect();
                    let mut c_argv_ptrs: Vec<*const libc::c_char> =
                        c_argv.iter().map(|arg| arg.as_ptr()).collect();
                    c_argv_ptrs.push(ptr::null());

                    execv(c_exec.as_ptr(), c_argv_ptrs.as_ptr());

                    log_kernel!(
                        &superkey_cstr,
                        "{} exec {} error: {}\n",
                        libc::getpid(),
                        cmd,
                        CStr::from_ptr(libc::strerror(errno().0))
                            .to_string_lossy()
                            .into_owned()
                    );
                    exit(1); // execv only returns on error
                } else {
                    let mut status: c_int = 0;
                    wait(&mut status);
                    log_kernel!(
                        &superkey_cstr,
                        "{} wait {} status: 0x{}\n",
                        libc::getpid(),
                        cmd,
                        status
                    );
                }
            }
        }
        _ => {
            warn!("[fork_for_result] SuperKey convert failed!");
        }
    }
}

```

`apd/src/utils.rs`:

```rs
#[allow(unused_imports)]
use std::fs::{Permissions, set_permissions};
#[cfg(unix)]
use std::os::unix::prelude::PermissionsExt;
use std::{
    ffi::CString,
    fs::{File, OpenOptions, create_dir_all, metadata},
    io::{ErrorKind::AlreadyExists, Write},
    path::Path,
    process::{Command, Stdio},
};

use anyhow::{Context, Error, Ok, Result, bail};
use log::{info, warn};

use crate::{defs, supercall::sc_su_get_safemode};

pub fn ensure_file_exists<T: AsRef<Path>>(file: T) -> Result<()> {
    match File::options().write(true).create_new(true).open(&file) {
        Result::Ok(_) => Ok(()),
        Err(err) => {
            if err.kind() == AlreadyExists && file.as_ref().is_file() {
                Ok(())
            } else {
                Err(Error::from(err))
                    .with_context(|| format!("{} is not a regular file", file.as_ref().display()))
            }
        }
    }
}

pub fn ensure_dir_exists<T: AsRef<Path>>(dir: T) -> Result<()> {
    let result = create_dir_all(&dir).map_err(Error::from);
    if dir.as_ref().is_dir() {
        result
    } else if result.is_ok() {
        bail!("{} is not a regular directory", dir.as_ref().display())
    } else {
        result
    }
}

// todo: ensure
pub fn ensure_binary<T: AsRef<Path>>(path: T) -> Result<()> {
    set_permissions(&path, Permissions::from_mode(0o755))?;
    Ok(())
}

#[cfg(any(target_os = "linux", target_os = "android"))]
pub fn getprop(prop: &str) -> Option<String> {
    android_properties::getprop(prop).value()
}

#[cfg(not(any(target_os = "linux", target_os = "android")))]
pub fn getprop(_prop: &str) -> Option<String> {
    unimplemented!()
}
pub fn run_command(
    command: &str,
    args: &[&str],
    stdout: Option<Stdio>,
) -> Result<std::process::Child> {
    let mut command_builder = Command::new(command);
    command_builder.args(args);
    if let Some(out) = stdout {
        command_builder.stdout(out);
    }
    let child = command_builder.spawn()?;
    Ok(child)
}
pub fn is_safe_mode(superkey: Option<String>) -> bool {
    let safemode = getprop("persist.sys.safemode")
        .filter(|prop| prop == "1")
        .is_some()
        || getprop("ro.sys.safemode")
            .filter(|prop| prop == "1")
            .is_some();
    info!("safemode: {}", safemode);
    if safemode {
        return true;
    }
    let safemode = superkey
        .as_ref()
        .and_then(|key_str| CString::new(key_str.as_str()).ok())
        .map_or_else(
            || {
                warn!("[is_safe_mode] No valid superkey provided, assuming safemode as false.");
                false
            },
            |cstr| sc_su_get_safemode(&cstr) == 1,
        );
    info!("kernel_safemode: {}", safemode);
    safemode
}

#[cfg(any(target_os = "linux", target_os = "android"))]
pub fn switch_mnt_ns(pid: i32) -> Result<()> {
    use std::os::fd::AsRawFd;

    use anyhow::ensure;
    let path = format!("/proc/{pid}/ns/mnt");
    let fd = File::open(path)?;
    let current_dir = std::env::current_dir();
    let ret = unsafe { libc::setns(fd.as_raw_fd(), libc::CLONE_NEWNS) };
    if let Result::Ok(current_dir) = current_dir {
        let _ = std::env::set_current_dir(current_dir);
    }
    ensure!(ret == 0, "switch mnt ns failed");
    Ok(())
}

fn switch_cgroup(grp: &str, pid: u32) {
    let path = Path::new(grp).join("cgroup.procs");
    if !path.exists() {
        return;
    }

    let fp = OpenOptions::new().append(true).open(path);
    if let Result::Ok(mut fp) = fp {
        let _ = write!(fp, "{pid}");
    }
}

pub fn switch_cgroups() {
    let pid = std::process::id();
    switch_cgroup("/acct", pid);
    switch_cgroup("/dev/cg2_bpf", pid);
    switch_cgroup("/sys/fs/cgroup", pid);

    if getprop("ro.config.per_app_memcg")
        .filter(|prop| prop == "false")
        .is_none()
    {
        switch_cgroup("/dev/memcg/apps", pid);
    }
}

#[cfg(any(target_os = "linux", target_os = "android"))]
pub fn umask(mask: u32) {
    unsafe { libc::umask(mask) };
}

#[cfg(not(any(target_os = "linux", target_os = "android")))]
pub fn umask(_mask: u32) {
    unimplemented!("umask is not supported on this platform")
}

pub fn has_magisk() -> bool {
    which::which("magisk").is_ok()
}
pub fn get_tmp_path() -> &'static str {
    if metadata(defs::TEMP_DIR_LEGACY).is_ok() {
        return defs::TEMP_DIR_LEGACY;
    }
    if metadata(defs::TEMP_DIR).is_ok() {
        return defs::TEMP_DIR;
    }
    ""
}

```

`app/build.gradle.kts`:

```kts
@file:Suppress("UnstableApiUsage")

import com.android.build.gradle.tasks.PackageAndroidArtifact
import org.jetbrains.kotlin.gradle.dsl.JvmTarget
import java.net.URI

plugins {
    alias(libs.plugins.agp.app)
    alias(libs.plugins.kotlin.compose.compiler)
    alias(libs.plugins.ksp)
    alias(libs.plugins.lsplugin.apksign)
    alias(libs.plugins.lsplugin.resopt)
    id("kotlin-parcelize")
}

val androidCompileSdkVersion: Int by rootProject.extra
val androidCompileNdkVersion: String by rootProject.extra
val androidBuildToolsVersion: String by rootProject.extra
val androidMinSdkVersion: Int by rootProject.extra
val androidTargetSdkVersion: Int by rootProject.extra
val androidSourceCompatibility: JavaVersion by rootProject.extra
val androidTargetCompatibility: JavaVersion by rootProject.extra
val managerVersionCode: Int by rootProject.extra
val managerVersionName: String by rootProject.extra
val branchName: String by rootProject.extra
val kernelPatchVersion: String by rootProject.extra

apksign {
    storeFileProperty = "KEYSTORE_FILE"
    storePasswordProperty = "KEYSTORE_PASSWORD"
    keyAliasProperty = "KEY_ALIAS"
    keyPasswordProperty = "KEY_PASSWORD"
}

val ccache = System.getenv("PATH")?.split(File.pathSeparator)
    ?.map { File(it, "ccache") }?.firstOrNull { it.exists() }?.absolutePath

val baseFlags = listOf(
    "-Wall", "-Qunused-arguments", "-fno-rtti", "-fvisibility=hidden",
    "-fvisibility-inlines-hidden", "-fno-exceptions", "-fno-stack-protector",
    "-fomit-frame-pointer", "-Wno-builtin-macro-redefined", "-Wno-unused-value",
    "-D__FILE__=__FILE_NAME__",
    "-DANDROID_SUPPORT_FLEXIBLE_PAGE_SIZES=ON", "-Wno-unused", "-Wno-unused-parameter",
    "-Wno-unused-command-line-argument", "-Wno-incompatible-function-pointer-types",
    "-U_FORTIFY_SOURCE", "-D_FORTIFY_SOURCE=0"
)

val baseArgs = mutableListOf(
    "-DANDROID_STL=none", "-DANDROID_SUPPORT_FLEXIBLE_PAGE_SIZES=ON",
    "-DCMAKE_CXX_STANDARD=23", "-DCMAKE_C_STANDARD=23",
    "-DCMAKE_INTERPROCEDURAL_OPTIMIZATION=ON", "-DCMAKE_VISIBILITY_INLINES_HIDDEN=ON",
    "-DCMAKE_CXX_VISIBILITY_PRESET=hidden", "-DCMAKE_C_VISIBILITY_PRESET=hidden"
).apply { if (ccache != null) add("-DANDROID_CCACHE=$ccache") }

android {
    namespace = "me.bmax.apatch"

    buildTypes {
        debug {
            isDebuggable = true
            isMinifyEnabled = false
            isShrinkResources = false
            proguardFiles(
                getDefaultProguardFile("proguard-android-optimize.txt"),
                "proguard-rules.pro"
            )
            externalNativeBuild {
                cmake {
                    arguments += listOf("-DCMAKE_CXX_FLAGS_DEBUG=-Og", "-DCMAKE_C_FLAGS_DEBUG=-Og")
                }
            }
        }
        release {
            isMinifyEnabled = true
            isShrinkResources = true
            isDebuggable = false
            multiDexEnabled = true
            vcsInfo.include = false
            proguardFiles(
                getDefaultProguardFile("proguard-android-optimize.txt"),
                "proguard-rules.pro"
            )
            externalNativeBuild {
                cmake {
                    val relFlags = listOf(
                        "-flto", "-ffunction-sections", "-fdata-sections", "-Wl,--gc-sections",
                        "-fno-unwind-tables", "-fno-asynchronous-unwind-tables", "-Wl,--exclude-libs,ALL",
                        "-Ofast", "-fmerge-all-constants", "-flto=full", "-ffat-lto-objects",
                        "-fno-semantic-interposition", "-fno-threadsafe-statics"
                    )
                    cppFlags += relFlags
                    cFlags += relFlags
                    arguments += listOf("-DCMAKE_BUILD_TYPE=Release", "-DCMAKE_CXX_FLAGS_RELEASE=-O3 -DNDEBUG", "-DCMAKE_C_FLAGS_RELEASE=-O3 -DNDEBUG")
                }
            }
        }
    }

    dependenciesInfo.includeInApk = false

    buildFeatures {
        aidl = true
        buildConfig = true
        compose = true
        prefab = true
    }

    defaultConfig {
        minSdk = androidMinSdkVersion
        targetSdk = androidTargetSdkVersion
        versionCode = managerVersionCode
        versionName = managerVersionName
        ndk.abiFilters.addAll(arrayOf("arm64-v8a"))
        externalNativeBuild {
            cmake {
                cppFlags += baseFlags + "-std=c++2b"
                cFlags += baseFlags + "-std=c2x"
                arguments += baseArgs
                abiFilters("arm64-v8a")
            }
        }
        buildConfigField("String", "buildKPV", "\"$kernelPatchVersion\"")
        base.archivesName = "APatch_${managerVersionCode}_${managerVersionName}_${branchName}"
    }

    compileOptions {
        sourceCompatibility = JavaVersion.VERSION_21
        targetCompatibility = JavaVersion.VERSION_21
    }

    packaging {
        jniLibs {
            useLegacyPackaging = true
        }
        resources {
            excludes += "**"
            merges += "META-INF/com/google/android/**"
        }
    }

    externalNativeBuild {
        cmake {
            version = "3.28.0+"
            path("src/main/cpp/CMakeLists.txt")
        }
    }

    androidResources {
        generateLocaleConfig = true
    }

    compileSdk = androidCompileSdkVersion
    ndkVersion = androidCompileNdkVersion
    buildToolsVersion = androidBuildToolsVersion

    lint {
        abortOnError = false
        checkReleaseBuilds = false
    }

    android.sourceSets.named("main") {
        kotlin.directories += "build/generated/ksp/$name/kotlin"
        jniLibs.directories += "libs"
    }
}

// https://stackoverflow.com/a/77745844
tasks.withType<PackageAndroidArtifact> {
    doFirst { appMetadata.asFile.orNull?.writeText("") }
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(21)
    }
}

kotlin {
    jvmToolchain(21)
    compilerOptions {
        jvmTarget = JvmTarget.JVM_21
    }
}

fun registerDownloadTask(
    taskName: String, srcUrl: String, destPath: String, project: Project
) {
    project.tasks.register(taskName) {
        val destFile = File(destPath)

        doLast {
            if (!destFile.exists() || isFileUpdated(srcUrl, destFile)) {
                println(" - Downloading $srcUrl to ${destFile.absolutePath}")
                downloadFile(srcUrl, destFile)
                println(" - Download completed.")
            } else {
                println(" - File is up-to-date, skipping download.")
            }
        }
    }
}

fun isFileUpdated(url: String, localFile: File): Boolean {
    val connection = URI.create(url).toURL().openConnection()
    val remoteLastModified = connection.getHeaderFieldDate("Last-Modified", 0L)
    return remoteLastModified > localFile.lastModified()
}

fun downloadFile(url: String, destFile: File) {
    URI.create(url).toURL().openStream().use { input ->
        destFile.outputStream().use { output ->
            input.copyTo(output)
        }
    }
}

registerDownloadTask(
    taskName = "downloadKpimg",
    srcUrl = "https://github.com/bmax121/KernelPatch/releases/download/$kernelPatchVersion/kpimg-android",
    destPath = "${project.projectDir}/src/main/assets/kpimg",
    project = project
)

registerDownloadTask(
    taskName = "downloadKptools",
    srcUrl = "https://github.com/bmax121/KernelPatch/releases/download/$kernelPatchVersion/kptools-android",
    destPath = "${project.projectDir}/libs/arm64-v8a/libkptools.so",
    project = project
)

// Compat kp version less than 0.10.7
// TODO: Remove in future
registerDownloadTask(
    taskName = "downloadCompatKpatch",
    srcUrl = "https://github.com/bmax121/KernelPatch/releases/download/0.10.7/kpatch-android",
    destPath = "${project.projectDir}/libs/arm64-v8a/libkpatch.so",
    project = project
)

tasks.register<Copy>("mergeScripts") {
    into("${project.projectDir}/src/main/resources/META-INF/com/google/android")
    from(rootProject.file("${project.rootDir}/scripts/update_binary.sh")) {
        rename { "update-binary" }
    }
    from(rootProject.file("${project.rootDir}/scripts/update_script.sh")) {
        rename { "updater-script" }
    }
}

tasks.getByName("preBuild").dependsOn(
    "downloadKpimg",
    "downloadKptools",
    "downloadCompatKpatch",
    "mergeScripts",
)

// https://github.com/bbqsrc/cargo-ndk
// cargo ndk -t arm64-v8a build --release
tasks.register<Exec>("cargoBuild") {
    executable("cargo")
    args("ndk", "-t", "arm64-v8a", "build", "--release")
    workingDir("${project.rootDir}/apd")
}

tasks.register<Copy>("buildApd") {
    dependsOn("cargoBuild")
    from("${project.rootDir}/apd/target/aarch64-linux-android/release/apd")
    into("${project.projectDir}/libs/arm64-v8a")
    rename("apd", "libapd.so")
}

tasks.configureEach {
    if (name == "mergeDebugJniLibFolders" || name == "mergeReleaseJniLibFolders") {
        dependsOn("buildApd")
    }
}

tasks.register<Exec>("cargoClean") {
    executable("cargo")
    args("clean")
    workingDir("${project.rootDir}/apd")
}

tasks.register<Delete>("apdClean") {
    dependsOn("cargoClean")
    delete(file("${project.projectDir}/libs/arm64-v8a/libapd.so"))
}

tasks.clean {
    dependsOn("apdClean")
}

ksp {
    arg("compose-destinations.defaultTransitions", "none")
}

dependencies {
    implementation(libs.androidx.appcompat)
    implementation(libs.androidx.activity.compose)
    implementation(libs.androidx.core.splashscreen)
    implementation(libs.androidx.webkit)

    implementation(platform(libs.androidx.compose.bom))
    implementation(libs.androidx.compose.material.icons.extended)
    implementation(libs.androidx.compose.material3)
    implementation(libs.androidx.compose.ui)
    implementation(libs.androidx.compose.ui.tooling.preview)
    implementation(libs.androidx.compose.runtime.livedata)

    debugImplementation(libs.androidx.compose.ui.test.manifest)
    debugImplementation(libs.androidx.compose.ui.tooling)

    implementation(libs.androidx.lifecycle.runtime.compose)
    implementation(libs.androidx.lifecycle.runtime.ktx)
    implementation(libs.androidx.lifecycle.viewmodel.compose)

    implementation(libs.compose.destinations.core)
    ksp(libs.compose.destinations.ksp)

    implementation(libs.com.github.topjohnwu.libsu.core)
    implementation(libs.com.github.topjohnwu.libsu.service)
    implementation(libs.com.github.topjohnwu.libsu.nio)
    implementation(libs.com.github.topjohnwu.libsu.io)

    implementation(libs.dev.rikka.rikkax.parcelablelist)

    implementation(libs.io.coil.kt.coil.compose)

    implementation(libs.kotlinx.coroutines.core)

    implementation(libs.me.zhanghai.android.appiconloader.coil)

    implementation(libs.sheet.compose.dialogs.core)
    implementation(libs.sheet.compose.dialogs.list)
    implementation(libs.sheet.compose.dialogs.input)

    implementation(libs.markdown)

    implementation(libs.ini4j)

    compileOnly(libs.cxx)
}

```

`app/proguard-rules.pro`:

```pro
-dontwarn org.bouncycastle.jsse.BCSSLParameters
-dontwarn org.bouncycastle.jsse.BCSSLSocket
-dontwarn org.bouncycastle.jsse.provider.BouncyCastleJsseProvider
-dontwarn org.conscrypt.Conscrypt$Version
-dontwarn org.conscrypt.Conscrypt
-dontwarn org.conscrypt.ConscryptHostnameVerifier
-dontwarn org.openjsse.javax.net.ssl.SSLParameters
-dontwarn org.openjsse.javax.net.ssl.SSLSocket
-dontwarn org.openjsse.net.ssl.OpenJSSE
-dontwarn java.beans.Introspector
-dontwarn java.beans.VetoableChangeListener
-dontwarn java.beans.VetoableChangeSupport
-dontwarn java.beans.BeanInfo
-dontwarn java.beans.IntrospectionException
-dontwarn java.beans.PropertyDescriptor

# Keep ini4j Service Provider Interface
-keep,allowobfuscation,allowoptimization class org.ini4j.spi.** { *; }

# Kotlin
-assumenosideeffects class kotlin.jvm.internal.Intrinsics {
    public static void check*(...);
    public static void throw*(...);
}

-repackageclasses
-allowaccessmodification
-overloadaggressively
-renamesourcefileattribute SourceFile

```

`app/src/main/AndroidManifest.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools">

    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission
        android:name="android.permission.WRITE_EXTERNAL_STORAGE"
        android:maxSdkVersion="29" />
    <uses-permission
        android:name="android.permission.READ_EXTERNAL_STORAGE"
        android:maxSdkVersion="32" />
    <uses-permission
        android:name="android.permission.QUERY_ALL_PACKAGES"
        tools:ignore="QueryAllPackagesPermission" />

    <application
        android:name=".APApplication"
        android:allowBackup="true"
        android:dataExtractionRules="@xml/data_extraction_rules"
        android:enableOnBackInvokedCallback="true"
        android:fullBackupContent="@xml/backup_rules"
        android:icon="@mipmap/ic_launcher"
        android:label="APatch"
        android:networkSecurityConfig="@xml/network_security_config"
        android:requestLegacyExternalStorage="true"
        android:supportsRtl="true"
        android:theme="@style/Theme.APatch"
        android:usesCleartextTraffic="true"
        tools:targetApi="34">

        <activity
            android:name=".ui.MainActivity"
            android:exported="true"
            android:theme="@style/Theme.Splash">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity
            android:name=".ui.WebUIActivity"
            android:autoRemoveFromRecents="true"
            android:documentLaunchMode="intoExisting"
            android:exported="false"
            android:theme="@style/Theme.APatch.WebUI" />

        <activity
            android:name=".ui.CrashHandleActivity"
            android:exported="false" />

        <provider
            android:name="androidx.core.content.FileProvider"
            android:authorities="${applicationId}.fileprovider"
            android:exported="false"
            android:grantUriPermissions="true">
            <meta-data
                android:name="android.support.FILE_PROVIDER_PATHS"
                android:resource="@xml/file_paths" />
        </provider>

        <service
            android:name="androidx.appcompat.app.AppLocalesMetadataHolderService"
            android:enabled="false"
            android:exported="false">
            <meta-data
                android:name="autoStoreLocales"
                android:value="true" />
        </service>

    </application>

</manifest>

```

`app/src/main/aidl/me/bmax/apatch/IAPRootService.aidl`:

```aidl
// IAPRootService.aidl
package me.bmax.apatch;

import android.content.pm.PackageInfo;
import rikka.parcelablelist.ParcelableListSlice;

interface IAPRootService {
    ParcelableListSlice<PackageInfo> getPackages(int flags);
}
```

`app/src/main/assets/InstallAP.sh`:

```sh
#!/bin/sh
# By SakuraKyuo

OUTFD=/proc/self/fd/$2

function ui_print() {
  echo -e "ui_print $1\nui_print" >> $OUTFD
}

function ui_printfile() {
  while IFS='' read -r line || $BB [[ -n "$line" ]]; do
    ui_print "$line";
  done < $1;
}

function kernelFlagsErr(){
	ui_print "- Installation has Aborted!"
	ui_print "- APatch requires CONFIG_KALLSYMS to be Enabled."
	ui_print "- But your kernel seems NOT enabled it."
	exit
}

function apatchNote(){
	ui_print "- APatch Patch Done"
	ui_print "- APatch Key is: Ap$skey"
	ui_print "- We do have saved Origin Boot image to /data"
	ui_print "- If you encounter bootloop, reboot into Recovery and flash it"
	exit
}

function failed(){
	ui_printfile /dev/tmp/install/log
	ui_print "- APatch Patch Failed."
	ui_print "- Please feedback to the developer with the screenshots."
	exit
}

function boot_execute_ab(){
	./lib/arm64-v8a/libkptools.so unpack boot.img
	if [[ ! $(./lib/arm64-v8a/libkptools.so -i ./kernel -f | grep CONFIG_KALLSYMS=y) ]]; then
		kernelFlagsErr
	fi
	mv kernel kernel-origin
	./lib/arm64-v8a/libkptools.so -p --image kernel-origin --skey "Ap$skey" --kpimg ./assets/kpimg --out ./kernel 2>&1 | tee /dev/tmp/install/log
	if [[ ! $(cat /dev/tmp/install/log | grep "patch done") ]]; then
		failed
	fi
	ui_printfile /dev/tmp/install/log
	./lib/arm64-v8a/libkptools.so repack boot.img
	dd if=/dev/tmp/install/new-boot.img of=/dev/block/by-name/boot$slot
	mv boot.img /data/boot.img
	apatchNote
}

function boot_execute(){
	./lib/arm64-v8a/libkptools.so unpack boot.img
	if [[ ! $(./lib/arm64-v8a/libkptools.so -i ./kernel -f | grep CONFIG_KALLSYMS=y) ]]; then
		kernelFlagsErr
	fi
	mv kernel kernel-origin
	./lib/arm64-v8a/libkptools.so -p --image kernel-origin --skey "Ap$skey" --kpimg ./assets/kpimg --out ./kernel 2>&1 | tee /dev/tmp/install/log
	if [[ ! $(cat /dev/tmp/install/log | grep "patch done") ]]; then
		failed
	fi
	ui_printfile /dev/tmp/install/log
	./lib/arm64-v8a/libkptools.so repack boot.img
	dd if=/dev/tmp/install/new-boot.img of=/dev/block/by-name/boot$slot
	mv boot.img /data/boot.img
	apatchNote
}

function main(){

cd /dev/tmp/install

chmod a+x ./assets/kpimg
chmod a+x ./lib/arm64-v8a/libkptools.so

slot=$(getprop ro.boot.slot_suffix)

skey=$(cat /proc/sys/kernel/random/uuid | cut -d \- -f1)

if [[ ! "$slot" == "" ]]; then

	ui_print ""
	ui_print "- You are using A/B device."

	# Script author
	ui_print "- Install Script by SakuraKyuo"

	# Get kernel
	ui_print ""
	dd if=/dev/block/by-name/boot$slot of=/dev/tmp/install/boot.img
	if [[ "$?" == 0 ]]; then
		ui_print "- Detected boot partition."
		boot_execute_ab
	fi

else

	ui_print "You are using A Only device."

	# Get kernel
	ui_print ""
	dd if=/dev/block/by-name/boot of=/dev/tmp/install/boot.img
	if [[ "$?" == 0 ]]; then
		ui_print "- Detected boot partition."
		boot_execute
	fi

fi

}

main

```

`app/src/main/assets/UninstallAP.sh`:

```sh
#!/bin/sh
# By SakuraKyuo

OUTFD=/proc/self/fd/$2

function ui_print() {
  echo -e "ui_print $1\nui_print" >> $OUTFD
}

function ui_printfile() {
  while IFS='' read -r line || $BB [[ -n "$line" ]]; do
    ui_print "$line";
  done < $1;
}

function apatchNote(){
	ui_print "- APatch Unpatch Done"
	exit
}

function failed(){
	ui_print "- APatch Unpatch Failed."
	ui_print "- Please feedback to the developer with the screenshots."
	exit
}

function boot_execute_ab(){
	./lib/arm64-v8a/libkptools.so unpack boot.img
	mv kernel kernel-origin
	./lib/arm64-v8a/libkptools.so -u --image kernel-origin  --out ./kernel
	if [[ ! "$?" == 0 ]]; then
		failed
	fi
	./lib/arm64-v8a/libkptools.so repack boot.img
	dd if=/dev/tmp/install/new-boot.img of=/dev/block/by-name/boot$slot
	apatchNote
}

function boot_execute(){
	./lib/arm64-v8a/libkptools.so unpack boot.img
	mv kernel kernel-origin
	./lib/arm64-v8a/libkptools.so -u --image kernel-origin  --out ./kernel
	if [[ ! "$?" == 0 ]]; then
		failed
	fi
	./lib/arm64-v8a/libkptools.so repack boot.img
	dd if=/dev/tmp/install/new-boot.img of=/dev/block/by-name/boot
	apatchNote
}

function main(){

cd /dev/tmp/install

chmod a+x ./lib/arm64-v8a/libkptools.so


slot=$(getprop ro.boot.slot_suffix)

if [[ ! "$slot" == "" ]]; then

	ui_print ""
	ui_print "- You are using A/B device."

	# Get kernel
	ui_print ""
	dd if=/dev/block/by-name/boot$slot of=/dev/tmp/install/boot.img
	if [[ "$?" == 0 ]]; then
		ui_print "- Detected boot partition."
		boot_execute_ab
	fi

else

	ui_print "You are using A Only device."

	# Get kernel
	ui_print ""
	dd if=/dev/block/by-name/boot of=/dev/tmp/install/boot.img
	if [[ "$?" == 0 ]]; then
		ui_print "- Detected boot partition."
		boot_execute
	fi

fi

}

main
```

`app/src/main/assets/boot_extract.sh`:

```sh
#!/system/bin/sh

ARCH=$(getprop ro.product.cpu.abi)

IS_INSTALL_NEXT_SLOT=$1

# Load utility functions
. ./util_functions.sh

if [ "$IS_INSTALL_NEXT_SLOT" = "true" ]; then
  get_next_slot
else
  get_current_slot
fi

find_boot_image

[ -e "$BOOTIMAGE" ] || { >&2 echo "- can't find boot.img!"; exit 1; }

true

```

`app/src/main/assets/boot_patch.sh`:

```sh
#!/system/bin/sh
#######################################################################################
# APatch Boot Image Patcher
#######################################################################################
#
# Usage: boot_patch.sh <superkey> <bootimage> [ARGS_PASS_TO_KPTOOLS]
#
# This script should be placed in a directory with the following files:
#
# File name          Type          Description
#
# boot_patch.sh      script        A script to patch boot image for APatch.
#                  (this file)      The script will use files in its same
#                                  directory to complete the patching process.
# bootimg            binary        The target boot image
# kpimg              binary        KernelPatch core Image
# kptools            executable    The KernelPatch tools binary to inject kpimg to kernel Image
#
#######################################################################################

ARCH=$(getprop ro.product.cpu.abi)

# Load utility functions
. ./util_functions.sh

echo "****************************"
echo " APatch Boot Image Patcher"
echo "****************************"

SUPERKEY="$1"
BOOTIMAGE=$2
FLASH_TO_DEVICE=$3
shift 2

[ -z "$SUPERKEY" ] && { >&2 echo "- SuperKey empty!"; exit 1; }
[ -e "$BOOTIMAGE" ] || { >&2 echo "- $BOOTIMAGE does not exist!"; exit 1; }

# Check for dependencies

command -v ./kptools >/dev/null 2>&1 || { >&2 echo "- Command kptools not found!"; exit 1; }

if [ ! -f kernel ]; then
echo "- Unpacking boot image"

set -x
./kptools unpack "$BOOTIMAGE" "$@"
patch_rc=$?
set +x
  if [ $patch_rc -ne 0 ]; then
    >&2 echo "- Unpack error: $patch_rc"
    exit $?
  fi
fi

if [ ! $(./kptools -i kernel -f | grep CONFIG_KALLSYMS=y) ]; then
	echo "- Patcher has Aborted!"
	echo "- APatch requires CONFIG_KALLSYMS to be Enabled."
	echo "- But your kernel seems NOT enabled it."
	exit 0
fi

if [  $(./kptools -i kernel -l | grep patched=false) ]; then
	echo "- Backing boot.img "
  cp "$BOOTIMAGE" "ori.img" >/dev/null 2>&1
fi

mv kernel kernel.ori

echo "- Patching kernel"

set -x
./kptools -p -i kernel.ori -S "$SUPERKEY" -k kpimg -o kernel "$@"
patch_rc=$?
set +x

if [ $patch_rc -ne 0 ]; then
  >&2 echo "- Patch kernel error: $patch_rc"
  exit $?
fi

echo "- Repacking boot image"
./kptools repack "$BOOTIMAGE"

if [ ! $(./kptools -i kernel.ori -f | grep CONFIG_KALLSYMS_ALL=y) ]; then
	echo "- Detected CONFIG_KALLSYMS_ALL is not set!"
	echo "- APatch has patched but maybe your device won't boot."
	echo "- Make sure you have original boot image backup."
fi

if [ $? -ne 0 ]; then
  >&2 echo "- Repack error: $?"
  exit $?
fi

if [ "$FLASH_TO_DEVICE" = "true" ]; then
  # flash
  if [ -b "$BOOTIMAGE" ] || [ -c "$BOOTIMAGE" ] && [ -f "new-boot.img" ]; then
    echo "- Flashing new boot image"
    flash_image new-boot.img "$BOOTIMAGE"
    if [ $? -ne 0 ]; then
      >&2 echo "- Flash error: $?"
      exit $?
    fi
  fi

  echo "- Successfully Flashed!"
else
  echo "- Successfully Patched!"
fi


```

`app/src/main/assets/boot_unpatch.sh`:

```sh
#!/system/bin/sh
#######################################################################################
# APatch Boot Image Unpatcher
#######################################################################################

ARCH=$(getprop ro.product.cpu.abi)

# Load utility functions
. ./util_functions.sh

echo "****************************"
echo " APatch Boot Image Unpatcher"
echo "****************************"

BOOTIMAGE=$1

[ -e "$BOOTIMAGE" ] || { echo "- $BOOTIMAGE does not exist!"; exit 1; }

echo "- Target image: $BOOTIMAGE"

  # Check for dependencies

command -v ./kptools >/dev/null 2>&1 || { echo "- Command kptools not found!"; exit 1; }

if [ ! -f kernel ]; then
echo "- Unpacking boot image"

set -x
./kptools unpack "$BOOTIMAGE" "$@"
patch_rc=$?
if [ $patch_rc -ne 0 ]; then
    >&2 echo "- Unpack error: $patch_rc"
    exit $patch_rc
  fi
fi

if [ ! $(./kptools -i kernel -l | grep patched=false) ]; then
	echo "- kernel has been patched "
  if [ -f "new-boot.img" ]; then
    echo "- found backup boot.img ,use it for recovery"
  else
    mv kernel kernel.ori
    echo "- Unpatching kernel"
    ./kptools -u --image kernel.ori --out kernel "$@"
    if [ $? -ne 0 ]; then
      >&2 echo "- Unpatch error: $?"
      exit $?
    fi
    echo "- Repacking boot image"
    ./kptools repack "$BOOTIMAGE"
    if [ $? -ne 0 ]; then
      >&2 echo "- Repack error: $?"
      exit $?
    fi
  fi

else
  echo "- no need unpatch"
  exit 0
fi



if [ -f "new-boot.img" ]; then
  echo "- Flashing boot image"
  flash_image new-boot.img "$BOOTIMAGE"

  if [ $? -ne 0 ]; then
    >&2 echo "- Flash error: $?"
    exit $?
  fi
fi

echo "- Flash successful"

# Reset any error code
true

```

`app/src/main/assets/util_functions.sh`:

```sh
#!/system/bin/sh
#######################################################################################
# Helper Functions (credits to topjohnwu)
#######################################################################################
APATCH_VER='0.10.4'
APATCH_VER_CODE=164

ui_print() {
  if $BOOTMODE; then
    echo "$1"
  else
    echo -e "ui_print $1\nui_print" >> /proc/self/fd/$OUTFD
  fi
}

toupper() {
  echo "$@" | tr '[:lower:]' '[:upper:]'
}

grep_cmdline() {
  local REGEX="s/^$1=//p"
  { echo $(cat /proc/cmdline)$(sed -e 's/[^"]//g' -e 's/""//g' /proc/cmdline) | xargs -n 1; \
    sed -e 's/ = /=/g' -e 's/, /,/g' -e 's/"//g' /proc/bootconfig; \
  } 2>/dev/null | sed -n "$REGEX"
}

grep_prop() {
  local REGEX="s/^$1=//p"
  shift
  local FILES=$@
  [ -z "$FILES" ] && FILES='/system/build.prop'
  cat $FILES 2>/dev/null | dos2unix | sed -n "$REGEX" | head -n 1
}

getvar() {
  local VARNAME=$1
  local VALUE
  local PROPPATH='/data/.magisk /cache/.magisk'
  [ ! -z $MAGISKTMP ] && PROPPATH="$MAGISKTMP/.magisk/config $PROPPATH"
  VALUE=$(grep_prop $VARNAME $PROPPATH)
  [ ! -z $VALUE ] && eval $VARNAME=\$VALUE
}

is_mounted() {
  grep -q " $(readlink -f $1) " /proc/mounts 2>/dev/null
  return $?
}
abort() {
  ui_print "$1"
  $BOOTMODE || recovery_cleanup
  [ ! -z $MODPATH ] && rm -rf $MODPATH
  rm -rf $TMPDIR
  exit 1
}
set_nvbase() {
  NVBASE="$1"
  MAGISKBIN="$1/magisk"
}

print_title() {
  local len line1len line2len bar
  line1len=$(echo -n $1 | wc -c)
  line2len=$(echo -n $2 | wc -c)
  len=$line2len
  [ $line1len -gt $line2len ] && len=$line1len
  len=$((len + 2))
  bar=$(printf "%${len}s" | tr ' ' '*')
  ui_print "$bar"
  ui_print " $1 "
  [ "$2" ] && ui_print " $2 "
  ui_print "$bar"
}
setup_flashable() {
  ensure_bb
  $BOOTMODE && return
  if [ -z $OUTFD ] || readlink /proc/$$/fd/$OUTFD | grep -q /tmp; then
    # We will have to manually find out OUTFD
    for FD in $(ls /proc/$$/fd); do
      if readlink /proc/$$/fd/$FD | grep -q pipe; then
        if ps | grep -v grep | grep -qE " 3 $FD |status_fd=$FD"; then
          OUTFD=$FD
          break
        fi
      fi
    done
  fi
  recovery_actions
}

ensure_bb() {
  if set -o | grep -q standalone; then
    # We are definitely in busybox ash
    set -o standalone
    return
  fi

  # Find our busybox binary
  local bb
  if [ -f $TMPDIR/busybox ]; then
    bb=$TMPDIR/busybox
  elif [ -f $MAGISKBIN/busybox ]; then
    bb=$MAGISKBIN/busybox
  else
    abort "! Cannot find BusyBox"
  fi
  chmod 755 $bb

  # Busybox could be a script, make sure /system/bin/sh exists
  if [ ! -f /system/bin/sh ]; then
    umount -l /system 2>/dev/null
    mkdir -p /system/bin
    ln -s $(command -v sh) /system/bin/sh
  fi

  export ASH_STANDALONE=1

  # Find our current arguments
  # Run in busybox environment to ensure consistent results
  # /proc/<pid>/cmdline shall be <interpreter> <script> <arguments...>
  local cmds="$($bb sh -c "
  for arg in \$(tr '\0' '\n' < /proc/$$/cmdline); do
    if [ -z \"\$cmds\" ]; then
      # Skip the first argument as we want to change the interpreter
      cmds=\"sh\"
    else
      cmds=\"\$cmds '\$arg'\"
    fi
  done
  echo \$cmds")"

  # Re-exec our script
  echo $cmds | $bb xargs $bb
  exit
}
recovery_actions() {
  # Make sure random won't get blocked
  mount -o bind /dev/urandom /dev/random
  # Unset library paths
  OLD_LD_LIB=$LD_LIBRARY_PATH
  OLD_LD_PRE=$LD_PRELOAD
  OLD_LD_CFG=$LD_CONFIG_FILE
  unset LD_LIBRARY_PATH
  unset LD_PRELOAD
  unset LD_CONFIG_FILE
}
recovery_cleanup() {
  local DIR
  ui_print "- Unmounting partitions"
  (
  if [ ! -d /postinstall/tmp ]; then
    umount -l /system
    umount -l /system_root
  fi
  umount -l /vendor
  umount -l /persist
  umount -l /metadata
  for DIR in /apex /system /system_root; do
    if [ -L "${DIR}_link" ]; then
      rmdir $DIR
      mv -f ${DIR}_link $DIR
    fi
  done
  umount -l /dev/random
  ) 2>/dev/null
  [ -z $OLD_LD_LIB ] || export LD_LIBRARY_PATH=$OLD_LD_LIB
  [ -z $OLD_LD_PRE ] || export LD_PRELOAD=$OLD_LD_PRE
  [ -z $OLD_LD_CFG ] || export LD_CONFIG_FILE=$OLD_LD_CFG
}

find_block() {
  local BLOCK DEV DEVICE DEVNAME PARTNAME UEVENT
  for BLOCK in "$@"; do
    DEVICE=$(find /dev/block \( -type b -o -type c -o -type l \) -iname $BLOCK | head -n 1) 2>/dev/null
    if [ ! -z $DEVICE ]; then
      readlink -f $DEVICE
      return 0
    fi
  done
  # Fallback by parsing sysfs uevents
  for UEVENT in /sys/dev/block/*/uevent; do
    DEVNAME=$(grep_prop DEVNAME $UEVENT)
    PARTNAME=$(grep_prop PARTNAME $UEVENT)
    for BLOCK in "$@"; do
      if [ "$(toupper $BLOCK)" = "$(toupper $PARTNAME)" ]; then
        echo /dev/block/$DEVNAME
        return 0
      fi
    done
  done
  # Look just in /dev in case we're dealing with MTD/NAND without /dev/block devices/links
  for DEV in "$@"; do
    DEVICE=$(find /dev \( -type b -o -type c -o -type l \) -maxdepth 1 -iname $DEV | head -n 1) 2>/dev/null
    if [ ! -z $DEVICE ]; then
      readlink -f $DEVICE
      return 0
    fi
  done
  return 1
}

# After calling this method, the following variables will be set:
# SLOT
get_current_slot() {
  # Check A/B slot
  SLOT=$(grep_cmdline androidboot.slot_suffix)
  if [ -z $SLOT ]; then
    SLOT=$(grep_cmdline androidboot.slot)
    [ -z $SLOT ] || SLOT=_${SLOT}
  fi
  if [ -z $SLOT ]; then
    SLOT=$(getprop ro.boot.slot_suffix)
  fi
  [ "$SLOT" = "normal" ] && unset SLOT
  [ -z $SLOT ] || echo "SLOT=$SLOT"
}

# After calling this method, the following variables will be set:
# SLOT
# This is used after OTA
get_next_slot() {
  # Check A/B slot
  SLOT=$(grep_cmdline androidboot.slot_suffix)
  if [ -z $SLOT ]; then
    SLOT=$(grep_cmdline androidboot.slot)
    [ -z $SLOT ] || SLOT=_${SLOT}
  fi
  if [ -z $SLOT ]; then
    SLOT=$(getprop ro.boot.slot_suffix)
  fi
   [ -z $SLOT ] && { >&2 echo "can't determined next boot slot! check your devices is A/B"; exit 1; }
   [ "$SLOT" = "normal" ] &&  { >&2 echo "can't determined next boot slot! check your devices is A/B"; exit 1; }
  if [[ $SLOT == *_a ]]; then
    SLOT='_b'
  else
    SLOT='_a'
  fi
  echo "SLOT=$SLOT"
}

find_boot_image() {
  if [ ! -z $SLOT ]; then
    BOOTIMAGE=$(find_block "boot$SLOT")
  fi
  if [ -z $BOOTIMAGE ]; then
    BOOTIMAGE=$(find_block kern-a android_boot kernel bootimg boot lnx boot_a)
  fi
  if [ -z $BOOTIMAGE ]; then
    # Lets see what fstabs tells me
    BOOTIMAGE=$(grep -v '#' /etc/*fstab* | grep -E '/boot(img)?[^a-zA-Z]' | grep -oE '/dev/[a-zA-Z0-9_./-]*' | head -n 1)
  fi
  [ -z $BOOTIMAGE ] || echo "BOOTIMAGE=$BOOTIMAGE"
}

flash_image() {
  local CMD1
  case "$1" in
    *.gz) CMD1="gzip -d < '$1' 2>/dev/null";;
    *)    CMD1="cat '$1'";;
  esac
  if [ -b "$2" ]; then {
      local img_sz=$(stat -c '%s' "$1")
      local blk_sz=$(blockdev --getsize64 "$2")
      local blk_bs=$(blockdev --getbsz "$2")
      [ "$img_sz" -gt "$blk_sz" ] && return 1
      blockdev --setrw "$2"
      local blk_ro=$(blockdev --getro "$2")
      [ "$blk_ro" -eq 1 ] && return 2
      eval "$CMD1" | dd of="$2" bs="$blk_bs" iflag=fullblock conv=notrunc,fsync 2>/dev/null
      sync
  } elif [ -c "$2" ]; then {
      flash_eraseall "$2" >&2
      eval "$CMD1" | nandwrite -p "$2" - >&2
  } else {
      echo "- Not block or char device, storing image"
      eval "$CMD1" > "$2" 2>/dev/null
  } fi
  return 0
}

setup_mntpoint() {
  local POINT=$1
  [ -L $POINT ] && mv -f $POINT ${POINT}_link
  if [ ! -d $POINT ]; then
    rm -f $POINT
    mkdir -p $POINT
  fi
}

mount_name() {
  local PART=$1
  local POINT=$2
  local FLAG=$3
  setup_mntpoint $POINT
  is_mounted $POINT && return
  # First try mounting with fstab
  mount $FLAG $POINT 2>/dev/null
  if ! is_mounted $POINT; then
    local BLOCK=$(find_block $PART)
    mount $FLAG $BLOCK $POINT || return
  fi
  ui_print "- Mounting $POINT"
}

mount_ro_ensure() {
  # We handle ro partitions only in recovery
  $BOOTMODE && return
  local PART=$1
  local POINT=$2
  mount_name "$PART" $POINT '-o ro'
  is_mounted $POINT || abort "! Cannot mount $POINT"
}

# After calling this method, the following variables will be set:
# SLOT, SYSTEM_AS_ROOT, LEGACYSAR
mount_partitions() {
  # Check A/B slot
  SLOT=$(grep_cmdline androidboot.slot_suffix)
  if [ -z $SLOT ]; then
    SLOT=$(grep_cmdline androidboot.slot)
    [ -z $SLOT ] || SLOT=_${SLOT}
  fi
  [ "$SLOT" = "normal" ] && unset SLOT
  [ -z $SLOT ] || ui_print "- Current boot slot: $SLOT"

  # Mount ro partitions
  if is_mounted /system_root; then
    umount /system 2>/dev/null
    umount /system_root 2>/dev/null
  fi
  mount_ro_ensure "system$SLOT app$SLOT" /system
  if [ -f /system/init -o -L /system/init ]; then
    SYSTEM_AS_ROOT=true
    setup_mntpoint /system_root
    if ! mount --move /system /system_root; then
      umount /system
      umount -l /system 2>/dev/null
      mount_ro_ensure "system$SLOT app$SLOT" /system_root
    fi
    mount -o bind /system_root/system /system
  else
    if grep ' / ' /proc/mounts | grep -qv 'rootfs' || grep -q ' /system_root ' /proc/mounts; then
      SYSTEM_AS_ROOT=true
    else
      SYSTEM_AS_ROOT=false
    fi
  fi
  $SYSTEM_AS_ROOT && ui_print "- Device is system-as-root"

  LEGACYSAR=false
  if $BOOTMODE; then
    grep ' / ' /proc/mounts | grep -q '/dev/root' && LEGACYSAR=true
  else
    # Recovery mode, assume devices that don't use dynamic partitions are legacy SAR
    local IS_DYNAMIC=false
    if grep -q 'androidboot.super_partition' /proc/cmdline; then
      IS_DYNAMIC=true
    elif [ -n "$(find_block super)" ]; then
      IS_DYNAMIC=true
    fi
    if $SYSTEM_AS_ROOT && ! $IS_DYNAMIC; then
      LEGACYSAR=true
      ui_print "- Legacy SAR, force kernel to load rootfs"
    fi
  fi
}

get_flags() {
  if grep ' /data ' /proc/mounts | grep -q 'dm-'; then
    ISENCRYPTED=true
  elif [ "$(getprop ro.crypto.state)" = "encrypted" ]; then
    ISENCRYPTED=true
  elif [ "$DATA" = "false" ]; then
    # No data access means unable to decrypt in recovery
    ISENCRYPTED=true
  else
    ISENCRYPTED=false
  fi
  if [ -n "$(find_block vbmeta vbmeta_a)" ]; then
    PATCHVBMETAFLAG=false
  else
    PATCHVBMETAFLAG=true
    ui_print "- No vbmeta partition, patch vbmeta in boot image"
  fi

  # Overridable config flags with safe defaults
  getvar KEEPVERITY
  getvar KEEPFORCEENCRYPT
  getvar RECOVERYMODE
  if [ -z $KEEPVERITY ]; then
    if $SYSTEM_AS_ROOT; then
      KEEPVERITY=true
      ui_print "- System-as-root, keep dm-verity"
    else
      KEEPVERITY=false
    fi
  fi
  if [ -z $KEEPFORCEENCRYPT ]; then
    if $ISENCRYPTED; then
      KEEPFORCEENCRYPT=true
      ui_print "- Encrypted data, keep forceencrypt"
    else
      KEEPFORCEENCRYPT=false
    fi
  fi
  [ -z $RECOVERYMODE ] && RECOVERYMODE=false
}

install_apatch() {
  cd $MAGISKBIN

  # Source the boot patcher
  SOURCEDMODE=true
  . ./boot_patch.sh "$BOOTIMAGE"
  ui_print "- Flashing new boot image"
  flash_image new-boot.img "$BOOTIMAGE"
  case $? in
    1)
      abort "! Insufficient partition size"
      ;;
    2)
      abort "! $BOOTIMAGE is read only"
      ;;
  esac
  
  rm -f new-boot.img

  run_migrations
}

check_data() {
  DATA=false
  DATA_DE=false
  if grep ' /data ' /proc/mounts | grep -vq 'tmpfs'; then
    # Test if data is writable
    touch /data/.rw && rm /data/.rw && DATA=true
    # Test if data is decrypted
    $DATA && [ -d /data/adb ] && touch /data/adb/.rw && rm /data/adb/.rw && DATA_DE=true
    $DATA_DE && [ -d /data/adb/magisk ] || mkdir /data/adb/magisk || DATA_DE=false
  fi
  set_nvbase "/data"
  $DATA || set_nvbase "/cache/data_adb"
  $DATA_DE && set_nvbase "/data/adb"
}

api_level_arch_detect() {
  API=$(grep_get_prop ro.build.version.sdk)
  ABI=$(grep_get_prop ro.product.cpu.abi)
  if [ "$ABI" = "x86" ]; then
    ARCH=x86
    ABI32=x86
    IS64BIT=false
  elif [ "$ABI" = "arm64-v8a" ]; then
    ARCH=arm64
    ABI32=armeabi-v7a
    IS64BIT=true
  elif [ "$ABI" = "x86_64" ]; then
    ARCH=x64
    ABI32=x86
    IS64BIT=true
  else
    ARCH=arm
    ABI=armeabi-v7a
    ABI32=armeabi-v7a
    IS64BIT=false
  fi
}

remove_system_su() {
  [ -d /postinstall/tmp ] && POSTINST=/postinstall
  cd $POSTINST/system
  if [ -f bin/su -o -f xbin/su ] && [ ! -f /su/bin/su ]; then
    ui_print "- Removing system installed root"
    blockdev --setrw /dev/block/mapper/system$SLOT 2>/dev/null
    mount -o rw,remount $POSTINST/system
    # SuperSU
    cd bin
    if [ -e .ext/.su ]; then
      mv -f app_process32_original app_process32 2>/dev/null
      mv -f app_process64_original app_process64 2>/dev/null
      mv -f install-recovery_original.sh install-recovery.sh 2>/dev/null
      if [ -e app_process64 ]; then
        ln -sf app_process64 app_process
      elif [ -e app_process32 ]; then
        ln -sf app_process32 app_process
      fi
    fi
    # More SuperSU, SuperUser & ROM su
    cd ..
    rm -rf .pin bin/.ext etc/.installed_su_daemon etc/.has_su_daemon \
    xbin/daemonsu xbin/su xbin/sugote xbin/sugote-mksh xbin/supolicy \
    bin/app_process_init bin/su /cache/su lib/libsupol.so lib64/libsupol.so \
    su.d etc/init.d/99SuperSUDaemon etc/install-recovery.sh /cache/install-recovery.sh \
    .supersu /cache/.supersu /data/.supersu \
    app/Superuser.apk app/SuperSU /cache/Superuser.apk
  elif [ -f /cache/su.img -o -f /data/su.img -o -d /data/su -o -d /data/adb/su ]; then
    ui_print "- Removing systemless installed root"
    umount -l /su 2>/dev/null
    rm -rf /cache/su.img /data/su.img /data/su /data/adb/su /data/adb/suhide \
    /cache/.supersu /data/.supersu /cache/supersu_install /data/supersu_install
  fi
  cd $TMPDIR
}

run_migrations() {
  local LOCSHA1
  local TARGET
  # Legacy app installation
  local BACKUP=$MAGISKBIN/stock_boot*.gz
  if [ -f $BACKUP ]; then
    cp $BACKUP /data
    rm -f $BACKUP
  fi

  # Legacy backup
  for gz in /data/stock_boot*.gz; do
    [ -f $gz ] || break
    LOCSHA1=$(basename $gz | sed -e 's/stock_boot_//' -e 's/.img.gz//')
    [ -z $LOCSHA1 ] && break
    mkdir /data/magisk_backup_${LOCSHA1} 2>/dev/null
    mv $gz /data/magisk_backup_${LOCSHA1}/boot.img.gz
  done

  # Stock backups
  LOCSHA1=$SHA1
  for name in boot dtb dtbo dtbs; do
    BACKUP=$MAGISKBIN/stock_${name}.img
    [ -f $BACKUP ] || continue
    if [ $name = 'boot' ]; then
      LOCSHA1=$($MAGISKBIN/kptools sha1 $BACKUP)
      mkdir /data/magisk_backup_${LOCSHA1} 2>/dev/null
    fi
    TARGET=/data/magisk_backup_${LOCSHA1}/${name}.img
    cp $BACKUP $TARGET
    rm -f $BACKUP
    gzip -9f $TARGET
  done
}
```

`app/src/main/cpp/CMakeLists.txt`:

```txt
cmake_minimum_required(VERSION 3.28.0)
project("apjni")

find_program(CCACHE ccache)

if (CCACHE)
        set(CMAKE_CXX_COMPILER_LAUNCHER ${CCACHE})
        set(CMAKE_C_COMPILER_LAUNCHER ${CCACHE})
endif ()

find_package(cxx REQUIRED CONFIG)
link_libraries(cxx::cxx)

macro(SET_OPTION option value)
        set(${option} ${value} CACHE INTERNAL "" FORCE)
endmacro()

set(CHERISH_POLLY_FLAGS "-mllvm -polly -mllvm -polly-run-dce -mllvm -polly-run-inliner -mllvm -polly-reschedule=1 -mllvm -polly-loopfusion-greedy=1 -mllvm -polly-postopts=1 -mllvm -polly-num-threads=0 -mllvm -polly-omp-backend=LLVM -mllvm -polly-scheduling=dynamic -mllvm -polly-scheduling-chunksize=1 -mllvm -polly-isl-arg=--no-schedule-serialize-sccs -mllvm -polly-ast-use-context -mllvm -polly-detect-keep-going -mllvm -polly-position=before-vectorizer -mllvm -polly-vectorizer=stripmine -mllvm -polly-detect-profitability-min-per-loop-insts=40 -mllvm -polly-invariant-load-hoisting")
set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} ${CHERISH_POLLY_FLAGS} -ffunction-sections -fdata-sections -fvisibility=hidden -fvisibility-inlines-hidden -O3 -flto -Wno-vla-cxx-extension")
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${CHERISH_POLLY_FLAGS} -ffunction-sections -fdata-sections -fvisibility=hidden -fvisibility-inlines-hidden -fno-rtti -fno-exceptions -O3 -flto -Wno-vla-cxx-extension")
set(CMAKE_CXX_STANDARD 23)

add_library(${PROJECT_NAME} SHARED apjni.cpp)
add_custom_command(TARGET ${PROJECT_NAME} POST_BUILD
        COMMAND ${CMAKE_STRIP} --strip-all --remove-section=.note.gnu.build-id --remove-section=.note.android.ident $<TARGET_FILE:${PROJECT_NAME}>)

target_link_libraries(${PROJECT_NAME} PRIVATE log)
target_compile_options(${PROJECT_NAME} PRIVATE -flto)
target_link_options(${PROJECT_NAME} PRIVATE "-Wl,--build-id=none" "-Wl,-icf=all,--lto-O3" "-Wl,-s,-x,--gc-sections" "-Wl,--no-undefined")

```

`app/src/main/cpp/apjni.cpp`:

```cpp
/* SPDX-License-Identifier: GPL-2.0-or-later */
/* 
 * Copyright (C) 2023 bmax121. All Rights Reserved.
 * Copyright (C) 2024 GarfieldHan. All Rights Reserved.
 * Copyright (C) 2024 1f2003d5. All Rights Reserved.
 */

#include <cstring>
#include <vector>

#include "apjni.hpp"
#include "supercall.h"

jboolean nativeReady(JNIEnv *env, jobject /* this */, jstring super_key_jstr) {
    ensureSuperKeyNonNull(super_key_jstr);

    const auto super_key = JUTFString(env, super_key_jstr);
    return sc_ready(super_key.get());
}

jlong nativeKernelPatchVersion(JNIEnv *env, jobject /* this */, jstring super_key_jstr) {
    ensureSuperKeyNonNull(super_key_jstr);

    const auto super_key = JUTFString(env, super_key_jstr);

    return sc_kp_ver(super_key.get());
}

jstring nativeKernelPatchBuildTime(JNIEnv *env, jobject /* this */, jstring super_key_jstr) {
    ensureSuperKeyNonNull(super_key_jstr);

    const auto super_key = JUTFString(env, super_key_jstr);
    char buf[4096] = { '\0' };

    sc_get_build_time(super_key.get(), buf, sizeof(buf));
    return env->NewStringUTF(buf);
}

jlong nativeSu(JNIEnv *env, jobject /* this */, jstring super_key_jstr, jint to_uid, jstring selinux_context_jstr) {
    ensureSuperKeyNonNull(super_key_jstr);

    const auto super_key = JUTFString(env, super_key_jstr);
    const char *selinux_context = nullptr;
    if (selinux_context_jstr) selinux_context = JUTFString(env, selinux_context_jstr);
    struct su_profile profile{};
    profile.uid = getuid();
    profile.to_uid = (uid_t)to_uid;
    if (selinux_context) strncpy(profile.scontext, selinux_context, sizeof(profile.scontext) - 1);
    long rc = sc_su(super_key.get(), &profile);
    if (rc < 0) [[unlikely]] {
        LOGE("nativeSu error: %ld", rc);
    }

    return rc;
}

jint nativeSetUidExclude(JNIEnv *env, jobject /* this */, jstring super_key_jstr, jint uid, jint exclude) {
    ensureSuperKeyNonNull(super_key_jstr);

    const auto super_key = JUTFString(env, super_key_jstr);
    return static_cast<int>(sc_set_ap_mod_exclude(super_key.get(), (uid_t) uid, exclude));
}

jint nativeGetUidExclude(JNIEnv *env, jobject /* this */, jstring super_key_jstr, uid_t uid) {
    ensureSuperKeyNonNull(super_key_jstr);

    const auto super_key = JUTFString(env, super_key_jstr);
    return static_cast<int>(sc_get_ap_mod_exclude(super_key.get(), uid));
}

jintArray nativeSuUids(JNIEnv *env, jobject /* this */, jstring super_key_jstr) {
    ensureSuperKeyNonNull(super_key_jstr);

    const auto super_key = JUTFString(env, super_key_jstr);
    int num = static_cast<int>(sc_su_uid_nums(super_key.get()));

    if (num <= 0) [[unlikely]] {
        LOGW("SuperUser Count less than 1, skip allocating vector...");
        return env->NewIntArray(0);
    }

    std::vector<int> uids(num);

    long n = sc_su_allow_uids(super_key.get(), (uid_t *) uids.data(), num);
    if (n > 0) [[unlikely]] {
        auto array = env->NewIntArray(n);
        env->SetIntArrayRegion(array, 0, n, uids.data());
        return array;
    }

    return env->NewIntArray(0);
}

jobject nativeSuProfile(JNIEnv *env, jobject /* this */, jstring super_key_jstr, jint uid) {
    ensureSuperKeyNonNull(super_key_jstr);

    const auto super_key = JUTFString(env, super_key_jstr);
    struct su_profile profile{};
    long rc = sc_su_uid_profile(super_key.get(), (uid_t) uid, &profile);
    if (rc < 0) [[unlikely]] {
        LOGE("nativeSuProfile error: %ld\n", rc);
        return nullptr;
    }
    jclass cls = env->FindClass("me/bmax/apatch/Natives$Profile");
    jmethodID constructor = env->GetMethodID(cls, "<init>", "()V");
    jfieldID uidField = env->GetFieldID(cls, "uid", "I");
    jfieldID toUidField = env->GetFieldID(cls, "toUid", "I");
    jfieldID scontextFild = env->GetFieldID(cls, "scontext", "Ljava/lang/String;");

    jobject obj = env->NewObject(cls, constructor);
    env->SetIntField(obj, uidField, (int) profile.uid);
    env->SetIntField(obj, toUidField, (int) profile.to_uid);
    env->SetObjectField(obj, scontextFild, env->NewStringUTF(profile.scontext));

    return obj;
}

jlong nativeLoadKernelPatchModule(JNIEnv *env, jobject /* this */, jstring super_key_jstr, jstring module_path_jstr, jstring args_jstr) {
    ensureSuperKeyNonNull(super_key_jstr);

    const auto super_key = JUTFString(env, super_key_jstr);
    const auto module_path = JUTFString(env, module_path_jstr);
    const auto args = JUTFString(env, args_jstr);
    long rc = sc_kpm_load(super_key.get(), module_path.get(), args.get(), nullptr);
    if (rc < 0) [[unlikely]] {
        LOGE("nativeLoadKernelPatchModule error: %ld", rc);
    }

    return rc;
}

jobject nativeControlKernelPatchModule(JNIEnv *env, jobject /* this */, jstring super_key_jstr, jstring module_name_jstr, jstring control_args_jstr) {
    ensureSuperKeyNonNull(super_key_jstr);

    const auto super_key = JUTFString(env, super_key_jstr);
    const auto module_name = JUTFString(env, module_name_jstr);
    const auto control_args = JUTFString(env, control_args_jstr);

    char buf[4096] = { '\0' };
    long rc = sc_kpm_control(super_key.get(), module_name.get(), control_args.get(), buf, sizeof(buf));
    if (rc < 0) [[unlikely]] {
        LOGE("nativeControlKernelPatchModule error: %ld", rc);
    }

    jclass cls = env->FindClass("me/bmax/apatch/Natives$KPMCtlRes");
    jmethodID constructor = env->GetMethodID(cls, "<init>", "()V");
    jfieldID rcField = env->GetFieldID(cls, "rc", "J");
    jfieldID outMsg = env->GetFieldID(cls, "outMsg", "Ljava/lang/String;");

    jobject obj = env->NewObject(cls, constructor);
    env->SetLongField(obj, rcField, rc);
    env->SetObjectField(obj, outMsg, env->NewStringUTF(buf));

    return obj;
}

jlong nativeUnloadKernelPatchModule(JNIEnv *env, jobject /* this */, jstring super_key_jstr, jstring module_name_jstr) {
    ensureSuperKeyNonNull(super_key_jstr);

    const auto super_key = JUTFString(env, super_key_jstr);
    const auto module_name = JUTFString(env, module_name_jstr);
    long rc = sc_kpm_unload(super_key.get(), module_name.get(), nullptr);
    if (rc < 0) [[unlikely]] {
        LOGE("nativeUnloadKernelPatchModule error: %ld", rc);
    }

    return rc;
}

jlong nativeKernelPatchModuleNum(JNIEnv *env, jobject /* this */, jstring super_key_jstr) {
    ensureSuperKeyNonNull(super_key_jstr);

    const auto super_key = JUTFString(env, super_key_jstr);
    long rc = sc_kpm_nums(super_key.get());
    if (rc < 0) [[unlikely]] {
        LOGE("nativeKernelPatchModuleNum error: %ld", rc);
    }

    return rc;
}

jstring nativeKernelPatchModuleList(JNIEnv *env, jobject /* this */, jstring super_key_jstr) {
    ensureSuperKeyNonNull(super_key_jstr);

    const auto super_key = JUTFString(env, super_key_jstr);

    char buf[4096] = { '\0' };
    long rc = sc_kpm_list(super_key.get(), buf, sizeof(buf));
    if (rc < 0) [[unlikely]] {
        LOGE("nativeKernelPatchModuleList error: %ld", rc);
    }

    return env->NewStringUTF(buf);
}

jstring nativeKernelPatchModuleInfo(JNIEnv *env, jobject /* this */, jstring super_key_jstr, jstring module_name_jstr) {
    ensureSuperKeyNonNull(super_key_jstr);

    const auto super_key = JUTFString(env, super_key_jstr);
    const auto module_name = JUTFString(env, module_name_jstr);
    char buf[1024] = { '\0' };
    long rc = sc_kpm_info(super_key.get(), module_name.get(), buf, sizeof(buf));
    if (rc < 0) [[unlikely]] {
        LOGE("nativeKernelPatchModuleInfo error: %ld", rc);
    }

    return env->NewStringUTF(buf);
}

jlong nativeGrantSu(JNIEnv *env, jobject /* this */, jstring super_key_jstr, jint uid, jint to_uid, jstring selinux_context_jstr) {
    ensureSuperKeyNonNull(super_key_jstr);

    const auto super_key = JUTFString(env, super_key_jstr);
    const auto selinux_context = JUTFString(env, selinux_context_jstr);
    struct su_profile profile{};
    profile.uid = uid;
    profile.to_uid = to_uid;
    if (selinux_context) strncpy(profile.scontext, selinux_context, sizeof(profile.scontext) - 1);
    return sc_su_grant_uid(super_key.get(), &profile);
}

jlong nativeRevokeSu(JNIEnv *env, jobject /* this */, jstring super_key_jstr, jint uid) {
    ensureSuperKeyNonNull(super_key_jstr);

    const auto super_key = JUTFString(env, super_key_jstr);
    return sc_su_revoke_uid(super_key.get(), (uid_t) uid);
}

jstring nativeSuPath(JNIEnv *env, jobject /* this */, jstring super_key_jstr) {
    ensureSuperKeyNonNull(super_key_jstr);

    const auto super_key = JUTFString(env, super_key_jstr);
    char buf[SU_PATH_MAX_LEN] = { '\0' };
    long rc = sc_su_get_path(super_key.get(), buf, sizeof(buf));
    if (rc < 0) [[unlikely]] {
        LOGE("nativeSuPath error: %ld", rc);
    }

    return env->NewStringUTF(buf);
}

jboolean nativeResetSuPath(JNIEnv *env, jobject /* this */, jstring super_key_jstr, jstring su_path_jstr) {
    ensureSuperKeyNonNull(super_key_jstr);

    const auto super_key = JUTFString(env, super_key_jstr);
    const auto su_path = JUTFString(env, su_path_jstr);

    return sc_su_reset_path(super_key.get(), su_path.get()) == 0;
}

JNIEXPORT jint JNI_OnLoad(JavaVM* vm, void * /*reserved*/) {
    LOGI("Enter OnLoad");

    JNIEnv* env{};
    if (vm->GetEnv(reinterpret_cast<void**>(&env), JNI_VERSION_1_6) != JNI_OK) [[unlikely]] {
        LOGE("Get JNIEnv error!");
        return JNI_FALSE;
    }

    auto clazz = JNI_FindClass(env, "me/bmax/apatch/Natives");
    if (clazz.get() == nullptr) [[unlikely]] {
        LOGE("Failed to find Natives class");
        return JNI_FALSE;
    }

    const static JNINativeMethod gMethods[] = {
        {"nativeReady", "(Ljava/lang/String;)Z", reinterpret_cast<void *>(&nativeReady)},
        {"nativeKernelPatchVersion", "(Ljava/lang/String;)J", reinterpret_cast<void *>(&nativeKernelPatchVersion)},
        {"nativeKernelPatchBuildTime", "(Ljava/lang/String;)Ljava/lang/String;", reinterpret_cast<void *>(&nativeKernelPatchBuildTime)},
        {"nativeSu", "(Ljava/lang/String;ILjava/lang/String;)J", reinterpret_cast<void *>(&nativeSu)},
        {"nativeSetUidExclude", "(Ljava/lang/String;II)I", reinterpret_cast<void *>(&nativeSetUidExclude)},
        {"nativeGetUidExclude", "(Ljava/lang/String;I)I", reinterpret_cast<void *>(&nativeGetUidExclude)},
        {"nativeSuUids", "(Ljava/lang/String;)[I", reinterpret_cast<void *>(&nativeSuUids)},
        {"nativeSuProfile", "(Ljava/lang/String;I)Lme/bmax/apatch/Natives$Profile;", reinterpret_cast<void *>(&nativeSuProfile)},
        {"nativeLoadKernelPatchModule", "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)J", reinterpret_cast<void *>(&nativeLoadKernelPatchModule)},
        {"nativeControlKernelPatchModule", "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Lme/bmax/apatch/Natives$KPMCtlRes;", reinterpret_cast<void *>(&nativeControlKernelPatchModule)},
        {"nativeUnloadKernelPatchModule", "(Ljava/lang/String;Ljava/lang/String;)J", reinterpret_cast<void *>(&nativeUnloadKernelPatchModule)},
        {"nativeKernelPatchModuleNum", "(Ljava/lang/String;)J", reinterpret_cast<void *>(&nativeKernelPatchModuleNum)},
        {"nativeKernelPatchModuleList", "(Ljava/lang/String;)Ljava/lang/String;", reinterpret_cast<void *>(&nativeKernelPatchModuleList)},
        {"nativeKernelPatchModuleInfo", "(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;", reinterpret_cast<void *>(&nativeKernelPatchModuleInfo)},
        {"nativeGrantSu", "(Ljava/lang/String;IILjava/lang/String;)J", reinterpret_cast<void *>(&nativeGrantSu)},
        {"nativeRevokeSu", "(Ljava/lang/String;I)J", reinterpret_cast<void *>(&nativeRevokeSu)},
        {"nativeSuPath", "(Ljava/lang/String;)Ljava/lang/String;", reinterpret_cast<void *>(&nativeSuPath)},
        {"nativeResetSuPath", "(Ljava/lang/String;Ljava/lang/String;)Z", reinterpret_cast<void *>(&nativeResetSuPath)},
    };

    if (JNI_RegisterNatives(env, clazz, gMethods, sizeof(gMethods) / sizeof(gMethods[0])) < 0) [[unlikely]] {
        LOGE("Failed to register native methods");
        return JNI_FALSE;
    }
    
    LOGI("JNI_OnLoad Done!");
    return JNI_VERSION_1_6;
}

```

`app/src/main/cpp/apjni.hpp`:

```hpp
//
// Created by GarfieldHan on 2024/6/11.
//

#ifndef APATCH_APJNI_HPP
#define APATCH_APJNI_HPP

#include <jni.h>
#include <android/log.h>
#include "jni_helper.hpp"

using namespace lsplant;

#define LOG_TAG "APatchNative"
#define LOGI(...) __android_log_print(ANDROID_LOG_INFO, LOG_TAG, __VA_ARGS__)
#define LOGW(...) __android_log_print(ANDROID_LOG_WARN, LOG_TAG, __VA_ARGS__)
#define LOGD(...) __android_log_print(ANDROID_LOG_DEBUG, LOG_TAG, __VA_ARGS__)
#define LOGE(...) __android_log_print(ANDROID_LOG_ERROR, LOG_TAG, __VA_ARGS__)
#define LOGV(...) __android_log_print(ANDROID_LOG_VERBOSE, LOG_TAG, __VA_ARGS__)

void ensureSuperKeyNonNull(jstring super_key_jstr) {
    if (!super_key_jstr) [[unlikely]] {
        LOGE("[%s] Super Key is null!", __PRETTY_FUNCTION__);
        abort();
    }
}

#endif //APATCH_APJNI_HPP

```

`app/src/main/cpp/jni_helper.hpp`:

```hpp
#pragma once

#include <android/log.h>
#include <jni.h>

#include <string>
#include <string_view>

#include "type_traits.hpp"

#pragma clang diagnostic push
#pragma clang diagnostic ignored "-Winvalid-partial-specialization"
#pragma clang diagnostic ignored "-Wunknown-pragmas"
#pragma ide diagnostic ignored "OCUnusedGlobalDeclarationInspection"

#define DISALLOW_COPY_AND_ASSIGN(TypeName)                                                         \
    TypeName(const TypeName &) = delete;                                                           \
    void operator=(const TypeName &) = delete

namespace lsplant {
template <typename T>
concept JObject = std::is_base_of_v<std::remove_pointer_t<_jobject>, std::remove_pointer_t<T>>;

template <JObject T>
class ScopedLocalRef {
public:
    using BaseType [[maybe_unused]] = T;

    ScopedLocalRef(JNIEnv *env, T local_ref) : env_(env), local_ref_(nullptr) { reset(local_ref); }

    ScopedLocalRef(ScopedLocalRef &&s) noexcept : ScopedLocalRef(s.env_, s.release()) {}

    template <JObject U>
    ScopedLocalRef(ScopedLocalRef<U> &&s) noexcept : ScopedLocalRef(s.env_, (T)s.release()) {}

    explicit ScopedLocalRef(JNIEnv *env) noexcept : ScopedLocalRef(env, T{nullptr}) {}

    ~ScopedLocalRef() { reset(); }

    void reset(T ptr = nullptr) {
        if (ptr != local_ref_) {
            if (local_ref_ != nullptr) {
                env_->DeleteLocalRef(local_ref_);
            }
            local_ref_ = ptr;
        }
    }

    [[nodiscard]] T release() {
        T localRef = local_ref_;
        local_ref_ = nullptr;
        return localRef;
    }

    T get() const { return local_ref_; }

    ScopedLocalRef<T> clone() const {
        return ScopedLocalRef<T>(env_, (T)env_->NewLocalRef(local_ref_));
    }

    ScopedLocalRef &operator=(ScopedLocalRef &&s) noexcept {
        reset(s.release());
        env_ = s.env_;
        return *this;
    }

    operator bool() const { return local_ref_; }

    template <JObject U>
    friend class ScopedLocalRef;

    friend class JUTFString;

private:
    JNIEnv *env_;
    T local_ref_;
    DISALLOW_COPY_AND_ASSIGN(ScopedLocalRef);
};

class JObjectArrayElement;

template <typename T>
concept JArray = std::is_base_of_v<std::remove_pointer_t<_jarray>, std::remove_pointer_t<T>>;

template <JArray T>
class ScopedLocalRef<T>;

class JNIScopeFrame {
    JNIEnv *env_;

    DISALLOW_COPY_AND_ASSIGN(JNIScopeFrame);

public:
    JNIScopeFrame(JNIEnv *env, jint size) : env_(env) { env_->PushLocalFrame(size); }

    ~JNIScopeFrame() { env_->PopLocalFrame(nullptr); }
};

class JNIMonitor {
    JNIEnv *env_;
    jobject obj_;

    DISALLOW_COPY_AND_ASSIGN(JNIMonitor);

public:
    JNIMonitor(JNIEnv *env, jobject obj) : env_(env), obj_(obj) { env_->MonitorEnter(obj_); }

    ~JNIMonitor() { env_->MonitorExit(obj_); }
};

template <typename T, typename U>
concept ScopeOrRaw =
    std::is_convertible_v<T, U> ||
    (is_instance_v<std::decay_t<T>, ScopedLocalRef> &&
     std::is_convertible_v<typename std::decay_t<T>::BaseType, U>) ||
    (std::is_same_v<std::decay_t<T>, JObjectArrayElement> && std::is_convertible_v<jobject, U>);

template <typename T>
concept ScopeOrClass = ScopeOrRaw<T, jclass>;

template <typename T>
concept ScopeOrObject = ScopeOrRaw<T, jobject>;

inline ScopedLocalRef<jstring> ClearException(JNIEnv *env) {
    if (auto exception = env->ExceptionOccurred()) {
        env->ExceptionClear();
        jclass log = (jclass)env->FindClass("android/util/Log");
        static jmethodID toString = env->GetStaticMethodID(
            log, "getStackTraceString", "(Ljava/lang/Throwable;)Ljava/lang/String;");
        auto str = (jstring)env->CallStaticObjectMethod(log, toString, exception);
        env->DeleteLocalRef(log);
        env->DeleteLocalRef(exception);
        return {env, str};
    }
    return {env, nullptr};
}

template <typename T>
[[maybe_unused]] inline auto UnwrapScope(T &&x) {
    if constexpr (std::is_same_v<std::decay_t<T>, std::string_view>)
        return x.data();
    else if constexpr (is_instance_v<std::decay_t<T>, ScopedLocalRef>)
        return x.get();
    else if constexpr (std::is_same_v<std::decay_t<T>, JObjectArrayElement>)
        return x.get();
    else
        return std::forward<T>(x);
}

template <typename T>
[[maybe_unused]] inline auto WrapScope(JNIEnv *env, T &&x) {
    if constexpr (std::is_convertible_v<T, _jobject *>) {
        return ScopedLocalRef(env, std::forward<T>(x));
    } else
        return x;
}

template <typename... T, size_t... I>
[[maybe_unused]] inline auto WrapScope(JNIEnv *env, std::tuple<T...> &&x,
                                       std::index_sequence<I...>) {
    return std::make_tuple(WrapScope(env, std::forward<T>(std::get<I>(x)))...);
}

template <typename... T>
[[maybe_unused]] inline auto WrapScope(JNIEnv *env, std::tuple<T...> &&x) {
    return WrapScope(env, std::forward<std::tuple<T...>>(x),
                     std::make_index_sequence<sizeof...(T)>());
}

inline auto JNI_NewStringUTF(JNIEnv *env, std::string_view sv) {
    return ScopedLocalRef(env, env->NewStringUTF(sv.data()));
}

class JUTFString {
public:
    JUTFString(JNIEnv *env, jstring jstr) : JUTFString(env, jstr, nullptr) {}

    JUTFString(const ScopedLocalRef<jstring> &jstr)
        : JUTFString(jstr.env_, jstr.local_ref_, nullptr) {}

    JUTFString(JNIEnv *env, jstring jstr, const char *default_cstr) : env_(env), jstr_(jstr) {
        if (env_ && jstr_)
            cstr_ = env_->GetStringUTFChars(jstr, nullptr);
        else
            cstr_ = default_cstr;
    }

    operator const char *() const { return cstr_; }

    operator const std::string() const { return cstr_; }

    operator const bool() const { return cstr_ != nullptr; }

    auto get() const { return cstr_; }

    ~JUTFString() {
        if (env_ && jstr_) env_->ReleaseStringUTFChars(jstr_, cstr_);
    }

    JUTFString(JUTFString &&other)
        : env_(std::move(other.env_)),
          jstr_(std::move(other.jstr_)),
          cstr_(std::move(other.cstr_)) {
        other.cstr_ = nullptr;
    }

    JUTFString &operator=(JUTFString &&other) {
        if (&other != this) {
            env_ = std::move(other.env_);
            jstr_ = std::move(other.jstr_);
            cstr_ = std::move(other.cstr_);
            other.cstr_ = nullptr;
        }
        return *this;
    }

private:
    JNIEnv *env_;
    jstring jstr_;
    const char *cstr_;

    JUTFString(const JUTFString &) = delete;

    JUTFString &operator=(const JUTFString &) = delete;
};

template <typename Func, typename... Args>
    requires(std::is_function_v<Func>)
[[maybe_unused]] inline auto JNI_SafeInvoke(JNIEnv *env, Func JNIEnv::*f, Args &&...args) {
    struct finally {
        finally(JNIEnv *env) : env_(env) {}

        ~finally() {
            if (auto exception = ClearException(env_)) {
                __android_log_print(ANDROID_LOG_ERROR,
#ifdef LOG_TAG
                                    LOG_TAG,
#else
                                    "JNIHelper",
#endif
                                    "%s", JUTFString(env_, exception.get()).get());
            }
        }

        JNIEnv *env_;
    } _(env);

    if constexpr (!std::is_same_v<void,
                                  std::invoke_result_t<Func, decltype(UnwrapScope(
                                                                 std::forward<Args>(args)))...>>)
        return WrapScope(env, (env->*f)(UnwrapScope(std::forward<Args>(args))...));
    else
        (env->*f)(UnwrapScope(std::forward<Args>(args))...);
}

// functions to class

[[maybe_unused]] inline auto JNI_FindClass(JNIEnv *env, std::string_view name) {
    return JNI_SafeInvoke(env, &JNIEnv::FindClass, name);
}

template <ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_GetObjectClass(JNIEnv *env, const Object &obj) {
    return JNI_SafeInvoke(env, &JNIEnv::GetObjectClass, obj);
}

// functions to field

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_GetFieldID(JNIEnv *env, Class &&clazz, std::string_view name,
                                            std::string_view sig) {
    return JNI_SafeInvoke(env, &JNIEnv::GetFieldID, std::forward<Class>(clazz), name, sig);
}

// getters

template <ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_GetObjectField(JNIEnv *env, Object &&obj, jfieldID fieldId) {
    return JNI_SafeInvoke(env, &JNIEnv::GetObjectField, std::forward<Object>(obj), fieldId);
}

template <ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_GetBooleanField(JNIEnv *env, Object &&obj, jfieldID fieldId) {
    return JNI_SafeInvoke(env, &JNIEnv::GetBooleanField, std::forward<Object>(obj), fieldId);
}

template <ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_GetByteField(JNIEnv *env, Object &&obj, jfieldID fieldId) {
    return JNI_SafeInvoke(env, &JNIEnv::GetByteField, std::forward<Object>(obj), fieldId);
}

template <ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_GetCharField(JNIEnv *env, Object &&obj, jfieldID fieldId) {
    return JNI_SafeInvoke(env, &JNIEnv::GetCharField, std::forward<Object>(obj), fieldId);
}

template <ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_GetShortField(JNIEnv *env, Object &&obj, jfieldID fieldId) {
    return JNI_SafeInvoke(env, &JNIEnv::GetShortField, std::forward<Object>(obj), fieldId);
}

template <ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_GetIntField(JNIEnv *env, Object &&obj, jfieldID fieldId) {
    return JNI_SafeInvoke(env, &JNIEnv::GetIntField, std::forward<Object>(obj), fieldId);
}

template <ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_GetLongField(JNIEnv *env, Object &&obj, jfieldID fieldId) {
    return JNI_SafeInvoke(env, &JNIEnv::GetLongField, std::forward<Object>(obj), fieldId);
}

template <ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_GetFloatField(JNIEnv *env, Object &&obj, jfieldID fieldId) {
    return JNI_SafeInvoke(env, &JNIEnv::GetFloatField, std::forward<Object>(obj), fieldId);
}

template <ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_GetDoubleField(JNIEnv *env, Object &&obj, jfieldID fieldId) {
    return JNI_SafeInvoke(env, &JNIEnv::GetDoubleField, std::forward<Object>(obj), fieldId);
}

// setters

template <ScopeOrObject Object, ScopeOrObject Value>
[[maybe_unused]] inline auto JNI_SetObjectField(JNIEnv *env, Object &&obj, jfieldID fieldId,
                                                const Value &value) {
    return JNI_SafeInvoke(env, &JNIEnv::SetObjectField, std::forward<Object>(obj), fieldId, value);
}

template <ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_SetBooleanField(JNIEnv *env, Object &&obj, jfieldID fieldId,
                                                 jboolean value) {
    return JNI_SafeInvoke(env, &JNIEnv::SetBooleanField, std::forward<Object>(obj), fieldId, value);
}

template <ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_SetByteField(JNIEnv *env, Object &&obj, jfieldID fieldId,
                                              jbyte value) {
    return JNI_SafeInvoke(env, &JNIEnv::SetByteField, std::forward<Object>(obj), fieldId, value);
}

template <ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_SetCharField(JNIEnv *env, Object &&obj, jfieldID fieldId,
                                              jchar value) {
    return JNI_SafeInvoke(env, &JNIEnv::SetCharField, std::forward<Object>(obj), fieldId, value);
}

template <ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_SetShortField(JNIEnv *env, Object &&obj, jfieldID fieldId,
                                               jshort value) {
    return JNI_SafeInvoke(env, &JNIEnv::SetShortField, std::forward<Object>(obj), fieldId, value);
}

template <ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_SetIntField(JNIEnv *env, Object &&obj, jfieldID fieldId,
                                             jint value) {
    return JNI_SafeInvoke(env, &JNIEnv::SetIntField, std::forward<Object>(obj), fieldId, value);
}

template <ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_SetLongField(JNIEnv *env, Object &&obj, jfieldID fieldId,
                                              jlong value) {
    return JNI_SafeInvoke(env, &JNIEnv::SetLongField, std::forward<Object>(obj), fieldId, value);
}

template <ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_SetFloatField(JNIEnv *env, Object &&obj, jfieldID fieldId,
                                               jfloat value) {
    return JNI_SafeInvoke(env, &JNIEnv::SetFloatField, std::forward<Object>(obj), fieldId, value);
}

template <ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_SetDoubleField(JNIEnv *env, Object &&obj, jfieldID fieldId,
                                                jdouble value) {
    return JNI_SafeInvoke(env, &JNIEnv::SetDoubleField, std::forward<Object>(obj), fieldId, value);
}

// functions to static field

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_GetStaticFieldID(JNIEnv *env, Class &&clazz, std::string_view name,
                                                  std::string_view sig) {
    return JNI_SafeInvoke(env, &JNIEnv::GetStaticFieldID, std::forward<Class>(clazz), name, sig);
}

// getters

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_GetStaticObjectField(JNIEnv *env, Class &&clazz,
                                                      jfieldID fieldId) {
    return JNI_SafeInvoke(env, &JNIEnv::GetStaticObjectField, std::forward<Class>(clazz), fieldId);
}

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_GetStaticBooleanField(JNIEnv *env, Class &&clazz,
                                                       jfieldID fieldId) {
    return JNI_SafeInvoke(env, &JNIEnv::GetStaticBooleanField, std::forward<Class>(clazz), fieldId);
}

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_GetStaticByteField(JNIEnv *env, Class &&clazz, jfieldID fieldId) {
    return JNI_SafeInvoke(env, &JNIEnv::GetStaticByteField, std::forward<Class>(clazz), fieldId);
}

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_GetStaticCharField(JNIEnv *env, Class &&clazz, jfieldID fieldId) {
    return JNI_SafeInvoke(env, &JNIEnv::GetStaticCharField, std::forward<Class>(clazz), fieldId);
}

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_GetStaticShortField(JNIEnv *env, Class &&clazz, jfieldID fieldId) {
    return JNI_SafeInvoke(env, &JNIEnv::GetStaticShortField, std::forward<Class>(clazz), fieldId);
}

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_GetStaticIntField(JNIEnv *env, Class &&clazz, jfieldID fieldId) {
    return JNI_SafeInvoke(env, &JNIEnv::GetStaticIntField, std::forward<Class>(clazz), fieldId);
}

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_GetStaticLongField(JNIEnv *env, Class &&clazz, jfieldID fieldId) {
    return JNI_SafeInvoke(env, &JNIEnv::GetStaticLongField, std::forward<Class>(clazz), fieldId);
}

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_GetStaticFloatField(JNIEnv *env, Class &&clazz, jfieldID fieldId) {
    return JNI_SafeInvoke(env, &JNIEnv::GetStaticFloatField, std::forward<Class>(clazz), fieldId);
}

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_GetStaticDoubleField(JNIEnv *env, Class &&clazz,
                                                      jfieldID fieldId) {
    return JNI_SafeInvoke(env, &JNIEnv::GetStaticDoubleField, std::forward<Class>(clazz), fieldId);
}

// setters

template <ScopeOrClass Class, ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_SetStaticObjectField(JNIEnv *env, Class &&clazz, jfieldID fieldId,
                                                      const Object &value) {
    return JNI_SafeInvoke(env, &JNIEnv::SetStaticObjectField, std::forward<Class>(clazz), fieldId,
                          value);
}

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_SetStaticBooleanField(JNIEnv *env, Class &&clazz, jfieldID fieldId,
                                                       jboolean value) {
    return JNI_SafeInvoke(env, &JNIEnv::SetStaticBooleanField, std::forward<Class>(clazz), fieldId,
                          value);
}

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_SetStaticByteField(JNIEnv *env, Class &&clazz, jfieldID fieldId,
                                                    jbyte value) {
    return JNI_SafeInvoke(env, &JNIEnv::SetStaticByteField, std::forward<Class>(clazz), fieldId,
                          value);
}

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_SetStaticCharField(JNIEnv *env, Class &&clazz, jfieldID fieldId,
                                                    jchar value) {
    return JNI_SafeInvoke(env, &JNIEnv::SetStaticCharField, std::forward<Class>(clazz), fieldId,
                          value);
}

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_SetStaticShortField(JNIEnv *env, Class &&clazz, jfieldID fieldId,
                                                     jshort value) {
    return JNI_SafeInvoke(env, &JNIEnv::SetStaticShortField, std::forward<Class>(clazz), fieldId,
                          value);
}

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_SetStaticIntField(JNIEnv *env, Class &&clazz, jfieldID fieldId,
                                                   jint value) {
    return JNI_SafeInvoke(env, &JNIEnv::SetStaticIntField, std::forward<Class>(clazz), fieldId,
                          value);
}

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_SetStaticLongField(JNIEnv *env, Class &&clazz, jfieldID fieldId,
                                                    jlong value) {
    return JNI_SafeInvoke(env, &JNIEnv::SetStaticLongField, std::forward<Class>(clazz), fieldId,
                          value);
}

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_SetStaticFloatField(JNIEnv *env, Class &&clazz, jfieldID fieldId,
                                                     jfloat value) {
    return JNI_SafeInvoke(env, &JNIEnv::SetStaticFloatField, std::forward<Class>(clazz), fieldId,
                          value);
}

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_SetStaticDoubleField(JNIEnv *env, Class &&clazz, jfieldID fieldId,
                                                      jdouble value) {
    return JNI_SafeInvoke(env, &JNIEnv::SetStaticDoubleField, std::forward<Class>(clazz), fieldId,
                          value);
}

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_ToReflectedMethod(JNIEnv *env, Class &&clazz, jmethodID method,
                                                   jboolean isStatic = JNI_FALSE) {
    return JNI_SafeInvoke(env, &JNIEnv::ToReflectedMethod, std::forward<Class>(clazz), method,
                          isStatic);
}

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_ToReflectedField(JNIEnv *env, Class &&clazz, jfieldID field,
                                                   jboolean isStatic = JNI_FALSE) {
    return JNI_SafeInvoke(env, &JNIEnv::ToReflectedField, std::forward<Class>(clazz), field,
                          isStatic);
}

// functions to method

// virtual methods

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_GetMethodID(JNIEnv *env, Class &&clazz, std::string_view name,
                                             std::string_view sig) {
    return JNI_SafeInvoke(env, &JNIEnv::GetMethodID, std::forward<Class>(clazz), name, sig);
}

template <ScopeOrObject Object, typename... Args>
[[maybe_unused]] inline auto JNI_CallVoidMethod(JNIEnv *env, Object &&obj, jmethodID method,
                                                Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallVoidMethod, std::forward<Object>(obj), method,
                          std::forward<Args>(args)...);
}

template <ScopeOrObject Object, typename... Args>
[[maybe_unused]] inline auto JNI_CallObjectMethod(JNIEnv *env, Object &&obj, jmethodID method,
                                                  Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallObjectMethod, std::forward<Object>(obj), method,
                          std::forward<Args>(args)...);
}

template <ScopeOrObject Object, typename... Args>
[[maybe_unused]] inline auto JNI_CallBooleanMethod(JNIEnv *env, Object &&obj, jmethodID method,
                                                   Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallBooleanMethod, std::forward<Object>(obj), method,
                          std::forward<Args>(args)...);
}

template <ScopeOrObject Object, typename... Args>
[[maybe_unused]] inline auto JNI_CallByteMethod(JNIEnv *env, Object &&obj, jmethodID method,
                                                Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallByteMethod, std::forward<Object>(obj), method,
                          std::forward<Args>(args)...);
}

template <ScopeOrObject Object, typename... Args>
[[maybe_unused]] inline auto JNI_CallCharMethod(JNIEnv *env, Object &&obj, jmethodID method,
                                                Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallCharMethod, std::forward<Object>(obj), method,
                          std::forward<Args>(args)...);
}

template <ScopeOrObject Object, typename... Args>
[[maybe_unused]] inline auto JNI_CallShortMethod(JNIEnv *env, Object &&obj, jmethodID method,
                                                 Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallShortMethod, std::forward<Object>(obj), method,
                          std::forward<Args>(args)...);
}

template <ScopeOrObject Object, typename... Args>
[[maybe_unused]] inline auto JNI_CallIntMethod(JNIEnv *env, Object &&obj, jmethodID method,
                                               Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallIntMethod, std::forward<Object>(obj), method,
                          std::forward<Args>(args)...);
}

template <ScopeOrObject Object, typename... Args>
[[maybe_unused]] inline auto JNI_CallLongMethod(JNIEnv *env, Object &&obj, jmethodID method,
                                                Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallLongMethod, std::forward<Object>(obj), method,
                          std::forward<Args>(args)...);
}

template <ScopeOrObject Object, typename... Args>
[[maybe_unused]] inline auto JNI_CallFloatMethod(JNIEnv *env, Object &&obj, jmethodID method,
                                                 Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallFloatMethod, std::forward<Object>(obj), method,
                          std::forward<Args>(args)...);
}

template <ScopeOrObject Object, typename... Args>
[[maybe_unused]] inline auto JNI_CallDoubleMethod(JNIEnv *env, Object &&obj, jmethodID method,
                                                  Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallDoubleMethod, std::forward<Object>(obj), method,
                          std::forward<Args>(args)...);
}

// static methods

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_GetStaticMethodID(JNIEnv *env, Class &&clazz,
                                                   std::string_view name, std::string_view sig) {
    return JNI_SafeInvoke(env, &JNIEnv::GetStaticMethodID, std::forward<Class>(clazz), name, sig);
}

template <ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_CallStaticVoidMethod(JNIEnv *env, Class &&clazz, jmethodID method,
                                                      Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallStaticVoidMethod, std::forward<Class>(clazz), method,
                          std::forward<Args>(args)...);
}

template <ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_CallStaticObjectMethod(JNIEnv *env, Class &&clazz,
                                                        jmethodID method, Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallStaticObjectMethod, std::forward<Class>(clazz), method,
                          std::forward<Args>(args)...);
}

template <ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_CallStaticBooleanMethod(JNIEnv *env, Class &&clazz,
                                                         jmethodID method, Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallStaticBooleanMethod, std::forward<Class>(clazz), method,
                          std::forward<Args>(args)...);
}

template <ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_CallStaticByteMethod(JNIEnv *env, Class &&clazz, jmethodID method,
                                                      Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallStaticByteMethod, std::forward<Class>(clazz), method,
                          std::forward<Args>(args)...);
}

template <ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_CallStaticCharMethod(JNIEnv *env, Class &&clazz, jmethodID method,
                                                      Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallStaticCharMethod, std::forward<Class>(clazz), method,
                          std::forward<Args>(args)...);
}

template <ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_CallStaticShortMethod(JNIEnv *env, Class &&clazz, jmethodID method,
                                                       Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallStaticShortMethod, std::forward<Class>(clazz), method,
                          std::forward<Args>(args)...);
}

template <ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_CallStaticIntMethod(JNIEnv *env, Class &&clazz, jmethodID method,
                                                     Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallStaticIntMethod, std::forward<Class>(clazz), method,
                          std::forward<Args>(args)...);
}

template <ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_CallStaticLongMethod(JNIEnv *env, Class &&clazz, jmethodID method,
                                                      Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallStaticLongMethod, std::forward<Class>(clazz), method,
                          std::forward<Args>(args)...);
}

template <ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_CallStaticFloatMethod(JNIEnv *env, Class &&clazz, jmethodID method,
                                                       Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallStaticFloatMethod, std::forward<Class>(clazz), method,
                          std::forward<Args>(args)...);
}

template <ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_CallStaticDoubleMethod(JNIEnv *env, Class &&clazz,
                                                        jmethodID method, Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallStaticDoubleMethod, std::forward<Class>(clazz), method,
                          std::forward<Args>(args)...);
}

// non-virtual methods

template <ScopeOrObject Object, ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_CallNonvirtualVoidMethod(JNIEnv *env, Object &&obj, Class &&clazz,
                                                          jmethodID method, Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallNonvirtualVoidMethod, std::forward<Object>(obj),
                          std::forward<Class>(clazz), method, std::forward<Args>(args)...);
}

template <ScopeOrObject Object, ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_CallNonvirtualObjectMethod(JNIEnv *env, Object &&obj,
                                                            Class &&clazz, jmethodID method,
                                                            Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallNonvirtualObjectMethod, std::forward<Object>(obj),
                          std::forward<Class>(clazz), method, std::forward<Args>(args)...);
}

template <ScopeOrObject Object, ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_CallNonvirtualBooleanMethod(JNIEnv *env, Object &&obj,
                                                             Class &&clazz, jmethodID method,
                                                             Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallNonvirtualBooleanMethod, std::forward<Object>(obj),
                          std::forward<Class>(clazz), method, std::forward<Args>(args)...);
}

template <ScopeOrObject Object, ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_CallNonvirtualByteMethod(JNIEnv *env, Object &&obj, Class &&clazz,
                                                          jmethodID method, Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallNonvirtualByteMethod, std::forward<Object>(obj),
                          std::forward<Class>(clazz), method, std::forward<Args>(args)...);
}

template <ScopeOrObject Object, ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_CallNonvirtualCharMethod(JNIEnv *env, Object &&obj, Class &&clazz,
                                                          jmethodID method, Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallNonvirtualCharMethod, std::forward<Object>(obj),
                          std::forward<Class>(clazz), method, std::forward<Args>(args)...);
}

template <ScopeOrObject Object, ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_CallNonvirtualShortMethod(JNIEnv *env, Object &&obj, Class &&clazz,
                                                           jmethodID method, Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallNonvirtualShortMethod, std::forward<Object>(obj),
                          std::forward<Class>(clazz), method, std::forward<Args>(args)...);
}

template <ScopeOrObject Object, ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_CallNonvirtualIntMethod(JNIEnv *env, Object &&obj, Class &&clazz,
                                                         jmethodID method, Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallNonvirtualIntMethod, std::forward<Object>(obj),
                          std::forward<Class>(clazz), method, std::forward<Args>(args)...);
}

template <ScopeOrObject Object, ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_CallNonvirtualLongMethod(JNIEnv *env, Object &&obj, Class &&clazz,
                                                          jmethodID method, Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallNonvirtualLongMethod, std::forward<Object>(obj),
                          std::forward<Class>(clazz), method, std::forward<Args>(args)...);
}

template <ScopeOrObject Object, ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_CallNonvirtualFloatMethod(JNIEnv *env, Object &&obj, Class &&clazz,
                                                           jmethodID method, Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallNonvirtualFloatMethod, std::forward<Object>(obj),
                          std::forward<Class>(clazz), method, std::forward<Args>(args)...);
}

template <ScopeOrObject Object, ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_CallNonvirtualDoubleMethod(JNIEnv *env, Object &&obj,
                                                            Class &&clazz, jmethodID method,
                                                            Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::CallNonvirtualDoubleMethod, std::forward<Object>(obj),
                          std::forward<Class>(clazz), method, std::forward<Args>(args)...);
}

template <ScopeOrClass Class, typename... Args>
[[maybe_unused]] inline auto JNI_NewObject(JNIEnv *env, Class &&clazz, jmethodID method,
                                           Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::NewObject, std::forward<Class>(clazz), method,
                          std::forward<Args>(args)...);
}

template <typename... Args>
[[maybe_unused]] inline auto JNI_NewDirectByteBuffer(JNIEnv *env, Args &&...args) {
    return JNI_SafeInvoke(env, &JNIEnv::NewDirectByteBuffer, std::forward<Args>(args)...);
}

template <ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_RegisterNatives(JNIEnv *env, Class &&clazz,
                                                 const JNINativeMethod *methods, jint size) {
    return JNI_SafeInvoke(env, &JNIEnv::RegisterNatives, std::forward<Class>(clazz), methods, size);
}

template <ScopeOrObject Object, ScopeOrClass Class>
[[maybe_unused]] inline auto JNI_IsInstanceOf(JNIEnv *env, Object &&obj, Class &&clazz) {
    return JNI_SafeInvoke(env, &JNIEnv::IsInstanceOf, std::forward<Object>(obj),
                          std::forward<Class>(clazz));
}

template <ScopeOrObject Object1, ScopeOrObject Object2>
[[maybe_unused]] inline auto JNI_IsSameObject(JNIEnv *env, Object1 &&a, Object2 &&b) {
    return JNI_SafeInvoke(env, &JNIEnv::IsSameObject, std::forward<Object1>(a),
                          std::forward<Object2>(b));
}

template <ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_NewGlobalRef(JNIEnv *env, Object &&x) {
    return (decltype(UnwrapScope(std::forward<Object>(x))))env->NewGlobalRef(
        UnwrapScope(std::forward<Object>(x)));
}

template <typename U, typename T>
[[maybe_unused]] inline auto JNI_Cast(ScopedLocalRef<T> &&x)
    requires(std::is_convertible_v<T, _jobject *>)
{
    return ScopedLocalRef<U>(std::move(x));
}

template <typename U>
[[maybe_unused]] inline auto JNI_Cast(JObjectArrayElement &&x) {
    return JNI_Cast<U, jobject>(std::move(x));
}

[[maybe_unused]] inline auto JNI_NewDirectByteBuffer(JNIEnv *env, void *address, jlong capacity) {
    return JNI_SafeInvoke(env, &JNIEnv::NewDirectByteBuffer, address, capacity);
}

template <JArray T>
struct JArrayUnderlyingTypeHelper;

template <>
struct JArrayUnderlyingTypeHelper<jbooleanArray> {
    using Type = jboolean;
};

template <>
struct JArrayUnderlyingTypeHelper<jbyteArray> {
    using Type = jbyte;
};

template <>
struct JArrayUnderlyingTypeHelper<jcharArray> {
    using Type = jchar;
};

template <>
struct JArrayUnderlyingTypeHelper<jshortArray> {
    using Type = jshort;
};

template <>
struct JArrayUnderlyingTypeHelper<jintArray> {
    using Type = jint;
};

template <>
struct JArrayUnderlyingTypeHelper<jlongArray> {
    using Type = jlong;
};

template <>
struct JArrayUnderlyingTypeHelper<jfloatArray> {
    using Type = jfloat;
};

template <>
struct JArrayUnderlyingTypeHelper<jdoubleArray> {
    using Type = jdouble;
};

template <JArray T>
using JArrayUnderlyingType = typename JArrayUnderlyingTypeHelper<T>::Type;

template <JArray T>
class ScopedLocalRef<T> {
public:
    class Iterator {
        friend class ScopedLocalRef<T>;
        Iterator(JArrayUnderlyingType<T> *e) : e_(e) {}
        JArrayUnderlyingType<T> *e_;

    public:
        auto &operator*() { return *e_; }
        auto *operator->() { return e_; }
        Iterator &operator++() { return ++e_, *this; }
        Iterator &operator--() { return --e_, *this; }
        Iterator operator++(int) { return Iterator(e_++); }
        Iterator operator--(int) { return Iterator(e_--); }
        bool operator==(const Iterator &other) const { return other.e_ == e_; }
        bool operator!=(const Iterator &other) const { return other.e_ != e_; }
    };

    class ConstIterator {
        friend class ScopedLocalRef<T>;
        ConstIterator(const JArrayUnderlyingType<T> *e) : e_(e) {}
        const JArrayUnderlyingType<T> *e_;

    public:
        const auto &operator*() { return *e_; }
        const auto *operator->() { return e_; }
        ConstIterator &operator++() { return ++e_, *this; }
        ConstIterator &operator--() { return --e_, *this; }
        ConstIterator operator++(int) { return ConstIterator(e_++); }
        ConstIterator operator--(int) { return ConstIterator(e_--); }
        bool operator==(const ConstIterator &other) const { return other.e_ == e_; }
        bool operator!=(const ConstIterator &other) const { return other.e_ != e_; }
    };

    auto begin() {
        modified_ = true;
        return Iterator(elements_);
    }

    auto end() {
        modified_ = true;
        return Iterator(elements_ + size_);
    }

    const auto begin() const { return ConstIterator(elements_); }

    auto end() const { return ConstIterator(elements_ + size_); }

    const auto cbegin() const { return ConstIterator(elements_); }

    auto cend() const { return ConstIterator(elements_ + size_); }

    using BaseType [[maybe_unused]] = T;

    ScopedLocalRef(JNIEnv *env, T local_ref) noexcept : env_(env), local_ref_(nullptr) {
        reset(local_ref);
    }

    ScopedLocalRef(ScopedLocalRef &&s) noexcept { *this = std::move(s); }

    template <JObject U>
    ScopedLocalRef(ScopedLocalRef<U> &&s) noexcept : ScopedLocalRef(s.env_, (T)s.release()) {}

    explicit ScopedLocalRef(JNIEnv *env) noexcept : ScopedLocalRef(env, T{nullptr}) {}

    ~ScopedLocalRef() { env_->DeleteLocalRef(release()); }

    void reset(T ptr = nullptr) {
        if (ptr != local_ref_) {
            if (local_ref_ != nullptr) {
                ReleaseElements(modified_ ? 0 : JNI_ABORT);
                env_->DeleteLocalRef(local_ref_);
                elements_ = nullptr;
            }
            local_ref_ = ptr;
            size_ = local_ref_ ? env_->GetArrayLength(local_ref_) : 0;
            if (!local_ref_) return;
            static_assert(!std::is_same_v<T, jobjectArray>);
            if constexpr (std::is_same_v<T, jbooleanArray>) {
                elements_ = env_->GetBooleanArrayElements(local_ref_, nullptr);
            } else if constexpr (std::is_same_v<T, jbyteArray>) {
                elements_ = env_->GetByteArrayElements(local_ref_, nullptr);
            } else if constexpr (std::is_same_v<T, jcharArray>) {
                elements_ = env_->GetCharArrayElements(local_ref_, nullptr);
            } else if constexpr (std::is_same_v<T, jshortArray>) {
                elements_ = env_->GetShortArrayElements(local_ref_, nullptr);
            } else if constexpr (std::is_same_v<T, jintArray>) {
                elements_ = env_->GetIntArrayElements(local_ref_, nullptr);
            } else if constexpr (std::is_same_v<T, jlongArray>) {
                elements_ = env_->GetLongArrayElements(local_ref_, nullptr);
            } else if constexpr (std::is_same_v<T, jfloatArray>) {
                elements_ = env_->GetFloatArrayElements(local_ref_, nullptr);
            } else if constexpr (std::is_same_v<T, jdoubleArray>) {
                elements_ = env_->GetDoubleArrayElements(local_ref_, nullptr);
            }
        }
    }

    [[nodiscard]] T release() {
        T localRef = local_ref_;
        size_ = 0;
        local_ref_ = nullptr;
        ReleaseElements(modified_ ? 0 : JNI_ABORT);
        elements_ = nullptr;
        return localRef;
    }

    T get() const { return local_ref_; }

    JArrayUnderlyingType<T> &operator[](size_t index) {
        modified_ = true;
        return elements_[index];
    }

    const JArrayUnderlyingType<T> &operator[](size_t index) const { return elements_[index]; }

    void commit() {
        ReleaseElements(JNI_COMMIT);
        modified_ = false;
    }

    // We do not expose an empty constructor as it can easily lead to errors
    // using common idioms, e.g.:
    //   ScopedLocalRef<...> ref;
    //   ref.reset(...);
    // Move assignment operator.
    ScopedLocalRef &operator=(ScopedLocalRef &&s) noexcept {
        env_ = s.env_;
        local_ref_ = s.local_ref_;
        size_ = s.size_;
        elements_ = s.elements_;
        modified_ = s.modified_;
        s.elements_ = nullptr;
        s.size_ = 0;
        s.modified_ = false;
        s.local_ref_ = nullptr;
        return *this;
    }

    size_t size() const { return size_; }

    operator bool() const { return local_ref_; }

    template <JObject U>
    friend class ScopedLocalRef;

    friend class JUTFString;

private:
    void ReleaseElements(jint mode) {
        if (!local_ref_ || !elements_) return;
        if constexpr (std::is_same_v<T, jbooleanArray>) {
            env_->ReleaseBooleanArrayElements(local_ref_, elements_, mode);
        } else if constexpr (std::is_same_v<T, jbyteArray>) {
            env_->ReleaseByteArrayElements(local_ref_, elements_, mode);
        } else if constexpr (std::is_same_v<T, jcharArray>) {
            env_->ReleaseCharArrayElements(local_ref_, elements_, mode);
        } else if constexpr (std::is_same_v<T, jshortArray>) {
            env_->ReleaseShortArrayElements(local_ref_, elements_, mode);
        } else if constexpr (std::is_same_v<T, jintArray>) {
            env_->ReleaseIntArrayElements(local_ref_, elements_, mode);
        } else if constexpr (std::is_same_v<T, jlongArray>) {
            env_->ReleaseLongArrayElements(local_ref_, elements_, mode);
        } else if constexpr (std::is_same_v<T, jfloatArray>) {
            env_->ReleaseFloatArrayElements(local_ref_, elements_, mode);
        } else if constexpr (std::is_same_v<T, jdoubleArray>) {
            env_->ReleaseDoubleArrayElements(local_ref_, elements_, mode);
        }
    }

    JNIEnv *env_;
    T local_ref_;
    size_t size_;
    JArrayUnderlyingType<T> *elements_{nullptr};
    bool modified_ = false;
    DISALLOW_COPY_AND_ASSIGN(ScopedLocalRef);
};

class JObjectArrayElement {
    friend class ScopedLocalRef<jobjectArray>;

    auto obtain() {
        if (i_ < 0 || i_ >= size_) return ScopedLocalRef<jobject>{nullptr};
        return JNI_SafeInvoke(env_, &JNIEnv::GetObjectArrayElement, array_, i_);
    }

    explicit JObjectArrayElement(JNIEnv *env, jobjectArray array, int i, size_t size)
        : env_(env), array_(array), i_(i), size_(size), item_(obtain()) {}

    JObjectArrayElement &operator++() {
        ++i_;
        item_ = obtain();
        return *this;
    }

    JObjectArrayElement &operator--() {
        --i_;
        item_ = obtain();
        return *this;
    }

    JObjectArrayElement operator++(int) { return JObjectArrayElement(env_, array_, i_ + 1, size_); }

    JObjectArrayElement operator--(int) { return JObjectArrayElement(env_, array_, i_ - 1, size_); }

public:
    JObjectArrayElement(JObjectArrayElement &&s)
        : env_(s.env_), array_(s.array_), i_(s.i_), size_(s.size_), item_(std::move(s.item_)) {}

    operator ScopedLocalRef<jobject> &() & { return item_; }

    operator ScopedLocalRef<jobject> &&() && { return std::move(item_); }

    JObjectArrayElement &operator=(JObjectArrayElement &&s) {
        reset(s.item_.release());
        return *this;
    }

    JObjectArrayElement &operator=(const JObjectArrayElement &s) {
        reset(env_->NewLocalRef(s.item_.get()));
        return *this;
    }

    template<JObject T>
    JObjectArrayElement &operator=(ScopedLocalRef<T> &&s) {
        reset(s.release());
        return *this;
    }

    template<JObject T>
    JObjectArrayElement &operator=(const ScopedLocalRef<T> &s) {
        reset(s.clone());
        return *this;
    }

    JObjectArrayElement &operator=(jobject s) {
        reset(env_->NewLocalRef(s));
        return *this;
    }

    void reset(jobject item) {
        item_.reset(item);
        JNI_SafeInvoke(env_, &JNIEnv::SetObjectArrayElement, array_, i_, item_);
    }

    ScopedLocalRef<jobject> clone() const { return item_.clone(); }

    jobject get() const { return item_.get(); }

    jobject release() { return item_.release(); }

    jobject operator->() const { return item_.get(); }

    jobject operator*() const { return item_.get(); }

private:
    JNIEnv *env_;
    jobjectArray array_;
    int i_;
    int size_;
    ScopedLocalRef<jobject> item_;
    JObjectArrayElement(const JObjectArrayElement &) = delete;
};

template <>
class ScopedLocalRef<jobjectArray> {
public:
    class Iterator {
        friend class ScopedLocalRef<jobjectArray>;

        Iterator(JObjectArrayElement &&e) : e_(std::move(e)) {}
        Iterator(JNIEnv *env, jobjectArray array, int i, size_t size) : e_(env, array, i, size) {}

    public:
        auto &operator*() { return e_; }

        auto *operator->() { return e_.get(); }

        Iterator &operator++() {
            ++e_;
            return *this;
        }

        Iterator &operator--() {
            --e_;
            return *this;
        }

        Iterator operator++(int) { return Iterator(e_++); }

        Iterator operator--(int) { return Iterator(e_--); }

        bool operator==(const Iterator &other) const { return other.e_.i_ == e_.i_; }

        bool operator!=(const Iterator &other) const { return other.e_.i_ != e_.i_; }

    private:
        JObjectArrayElement e_;
    };

    class ConstIterator {
        friend class ScopedLocalRef<jobjectArray>;

        auto obtain() {
            if (i_ < 0 || i_ >= size_) return ScopedLocalRef<jobject>{nullptr};
            return JNI_SafeInvoke(env_, &JNIEnv::GetObjectArrayElement, array_, i_);
        }

        ConstIterator(JNIEnv *env, jobjectArray array, int i, int size)
            : env_(env), array_(array), i_(i), size_(size), item_(obtain()) {}

    public:
        auto &operator*() { return item_; }

        auto *operator->() { return &item_; }

        ConstIterator &operator++() {
            ++i_;
            item_ = obtain();
            return *this;
        }

        ConstIterator &operator--() {
            --i_;
            item_ = obtain();
            return *this;
        }

        ConstIterator operator++(int) { return ConstIterator(env_, array_, i_ + 1, size_); }

        ConstIterator operator--(int) { return ConstIterator(env_, array_, i_ - 1, size_); }

        bool operator==(const ConstIterator &other) const { return other.i_ == i_; }

        bool operator!=(const ConstIterator &other) const { return other.i_ != i_; }

    private:
        JNIEnv *env_;
        jobjectArray array_;
        int i_;
        int size_;
        ScopedLocalRef<jobject> item_;
    };

    auto begin() { return Iterator(env_, local_ref_, 0, size_); }

    auto end() { return Iterator(env_, local_ref_, size_, size_); }

    const auto begin() const { return ConstIterator(env_, local_ref_, 0, size_); }

    auto end() const { return ConstIterator(env_, local_ref_, size_, size_); }

    const auto cbegin() const { return ConstIterator(env_, local_ref_, 0, size_); }

    auto cend() const { return ConstIterator(env_, local_ref_, size_, size_); }

    ScopedLocalRef(JNIEnv *env, jobjectArray local_ref) noexcept : env_(env), local_ref_(nullptr) {
        reset(local_ref);
    }

    ScopedLocalRef(ScopedLocalRef &&s) noexcept { *this = std::move(s); }

    template <JObject U>
    ScopedLocalRef(ScopedLocalRef<U> &&s) noexcept
        : ScopedLocalRef(s.env_, (jobjectArray)s.release()) {}

    explicit ScopedLocalRef(JNIEnv *env) noexcept : ScopedLocalRef(env, jobjectArray{nullptr}) {}

    ~ScopedLocalRef() { env_->DeleteLocalRef(release()); }

    void reset(jobjectArray ptr = nullptr) {
        if (ptr != local_ref_) {
            if (local_ref_ != nullptr) {
                env_->DeleteLocalRef(local_ref_);
            }
            local_ref_ = ptr;
            size_ = local_ref_ ? env_->GetArrayLength(local_ref_) : 0;
            if (!local_ref_) return;
        }
    }

    [[nodiscard]] jobjectArray release() {
        jobjectArray localRef = local_ref_;
        size_ = 0;
        local_ref_ = nullptr;
        return localRef;
    }

    jobjectArray get() const { return local_ref_; }

    JObjectArrayElement operator[](size_t index) {
        return JObjectArrayElement(env_, local_ref_, index, size_);
    }

    const ScopedLocalRef<jobject> operator[](size_t index) const {
        return JNI_SafeInvoke(env_, &JNIEnv::GetObjectArrayElement, local_ref_, index);
    }

    // We do not expose an empty constructor as it can easily lead to errors
    // using common idioms, e.g.:
    //   ScopedLocalRef<...> ref;
    //   ref.reset(...);
    // Move assignment operator.
    ScopedLocalRef &operator=(ScopedLocalRef &&s) noexcept {
        env_ = s.env_;
        local_ref_ = s.local_ref_;
        size_ = s.size_;
        s.size_ = 0;
        s.local_ref_ = nullptr;
        return *this;
    }

    size_t size() const { return size_; }

    operator bool() const { return local_ref_; }

    template <JObject U>
    friend class ScopedLocalRef;

    friend class JUTFString;

private:
    JNIEnv *env_;
    jobjectArray local_ref_;
    size_t size_;
    DISALLOW_COPY_AND_ASSIGN(ScopedLocalRef);
};
// functions to array

template <ScopeOrRaw<jarray> Array>
[[maybe_unused]] inline auto JNI_GetArrayLength(JNIEnv *env, const Array &array) {
    return JNI_SafeInvoke(env, &JNIEnv::GetArrayLength, array);
}

// newers

template <ScopeOrClass Class, ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_NewObjectArray(JNIEnv *env, jsize len, Class &&clazz,
                                                const Object &init) {
    return JNI_SafeInvoke(env, &JNIEnv::NewObjectArray, len, std::forward<Class>(clazz), init);
}

[[maybe_unused]] inline auto JNI_NewBooleanArray(JNIEnv *env, jsize len) {
    return JNI_SafeInvoke(env, &JNIEnv::NewBooleanArray, len);
}

[[maybe_unused]] inline auto JNI_NewByteArray(JNIEnv *env, jsize len) {
    return JNI_SafeInvoke(env, &JNIEnv::NewByteArray, len);
}

[[maybe_unused]] inline auto JNI_NewCharArray(JNIEnv *env, jsize len) {
    return JNI_SafeInvoke(env, &JNIEnv::NewCharArray, len);
}

[[maybe_unused]] inline auto JNI_NewShortArray(JNIEnv *env, jsize len) {
    return JNI_SafeInvoke(env, &JNIEnv::NewShortArray, len);
}

[[maybe_unused]] inline auto JNI_NewIntArray(JNIEnv *env, jsize len) {
    return JNI_SafeInvoke(env, &JNIEnv::NewIntArray, len);
}

[[maybe_unused]] inline auto JNI_NewLongArray(JNIEnv *env, jsize len) {
    return JNI_SafeInvoke(env, &JNIEnv::NewLongArray, len);
}

[[maybe_unused]] inline auto JNI_NewFloatArray(JNIEnv *env, jsize len) {
    return JNI_SafeInvoke(env, &JNIEnv::NewFloatArray, len);
}

[[maybe_unused]] inline auto JNI_NewDoubleArray(JNIEnv *env, jsize len) {
    return JNI_SafeInvoke(env, &JNIEnv::NewDoubleArray, len);
}

template <ScopeOrObject Object>
[[maybe_unused]] inline auto JNI_GetObjectFieldOf(JNIEnv *env, Object &&object,
                                                  std::string_view field_name,
                                                  std::string_view field_class) {
    auto &&o = std::forward<Object>(object);
    return JNI_GetObjectField(
        env, o, JNI_GetFieldID(env, JNI_GetObjectClass(env, o), field_name, field_class));
}

}  // namespace lsplant

#undef DISALLOW_COPY_AND_ASSIGN

#pragma clang diagnostic pop

```

`app/src/main/cpp/supercall.h`:

```h
/* SPDX-License-Identifier: GPL-2.0-or-later */
/* 
 * Copyright (C) 2023 bmax121. All Rights Reserved.
 */

#ifndef _KPU_SUPERCALL_H_
#define _KPU_SUPERCALL_H_

#include <unistd.h>
#include <sys/syscall.h>
#include <stdbool.h>
#include <stddef.h>
#include <string.h>
#include <errno.h>

#include "uapi/scdefs.h"
#include "version"

/// KernelPatch version is greater than or equal to 0x0a05
static inline long ver_and_cmd(const char *key, long cmd)
{
    uint32_t version_code = (MAJOR << 16) + (MINOR << 8) + PATCH;
    return ((long)version_code << 32) | (0x1158 << 16) | (cmd & 0xFFFF);
}

/**
 * @brief If KernelPatch installed, @see SUPERCALL_HELLO_ECHO will echoed.
 * 
 * @param key : superkey or 'su' string if caller uid is su allowed 
 * @return long 
 */
static inline long sc_hello(const char *key)
{
    if (!key || !key[0]) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_HELLO));
    return ret;
}

/**
 * @brief Is KernelPatch installed?
 * 
 * @param key : superkey or 'su' string if caller uid is su allowed 
 * @return true 
 * @return false 
 */
static inline bool sc_ready(const char *key)
{
    return sc_hello(key) == SUPERCALL_HELLO_MAGIC;
}

/**
 * @brief Print messages by printk in the kernel
 * 
 * @param key : superkey or 'su' string if caller uid is su allowed 
 * @param msg 
 * @return long 
 */
static inline long sc_klog(const char *key, const char *msg)
{
    if (!key || !key[0]) return -EINVAL;
    if (!msg || strlen(msg) <= 0) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_KLOG), msg);
    return ret;
}

/**
 * @brief Print build kernel time
 * 
 * @param key : superkey or 'su' string if caller uid is su allowed 
 * @param buildtime 
 * @param timestamp
 * @return long 
 */
 static inline long sc_get_build_time(const char *key, const char *buildtime, size_t len)
 {
     if (!key || !key[0]) return -EINVAL;
     if (!buildtime) return -EINVAL;
     long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_BUILD_TIME), buildtime,len);
     return ret;
 }

/**
 * @brief KernelPatch version number
 * 
 * @param key 
 * @return uint32_t 
 */
static inline uint32_t sc_kp_ver(const char *key)
{
    if (!key || !key[0]) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_KERNELPATCH_VER));
    return (uint32_t)ret;
}

/**
 * @brief Kernel version number
 * 
 * @param key : superkey or 'su' string if caller uid is su allowed 
 * @return uint32_t 
 */
static inline uint32_t sc_k_ver(const char *key)
{
    if (!key || !key[0]) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_KERNEL_VER));
    return (uint32_t)ret;
}

/**
 * @brief Substitute user of current thread
 * 
 * @param key : superkey or 'su' string if caller uid is su allowed 
 * @param profile : if scontext is invalid or illegal, all selinux permission checks will bypass via hook
 * @see struct su_profile
 * @return long : 0 if succeed
 */
static inline long sc_su(const char *key, struct su_profile *profile)
{
    if (!key || !key[0]) return -EINVAL;
    if (strlen(profile->scontext) >= SUPERCALL_SCONTEXT_LEN) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_SU), profile);
    return ret;
}

/**
 * @brief Substitute user of tid specfied thread
 * 
 * @param key : superkey or 'su' string if caller uid is su allowed 
 * @param tid : target thread id
 * @param profile : if scontext is invalid or illegal, all selinux permission checks will bypass via hook
 * @see struct su_profile
 * @return long : 0 if succeed 
 */
static inline long sc_su_task(const char *key, pid_t tid, struct su_profile *profile)
{
    if (!key || !key[0]) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_SU_TASK), tid, profile);
    return ret;
}

/**
 * @brief 
 * 
 * @param key 
 * @param gid group id
 * @param did data id
 * @param data 
 * @param dlen 
 * @return long 
 */
static inline long sc_kstorage_write(const char *key, int gid, long did, void *data, int offset, int dlen)
{
    if (!key || !key[0]) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_KSTORAGE_WRITE), gid, did, data, (((long)offset << 32) | dlen));
    return ret;
}

/**
 * @brief 
 * 
 * @param key 
 * @param gid 
 * @param did 
 * @param out_data 
 * @param dlen 
 * @return long 
 */
static inline long sc_kstorage_read(const char *key, int gid, long did, void *out_data, int offset, int dlen)
{
    if (!key || !key[0]) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_KSTORAGE_READ), gid, did, out_data, (((long)offset << 32) | dlen));
    return ret;
}


/**
 * @brief 
 * 
 * @param key 
 * @param gid 
 * @param ids 
 * @param ids_len 
 * @return long numbers of listed ids
 */
static inline long sc_kstorage_list_ids(const char *key, int gid, long *ids, int ids_len)
{
    if (!key || !key[0]) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_KSTORAGE_LIST_IDS), gid, ids, ids_len);
    return ret;
}


/**
 * @brief 
 * 
 * @param key 
 * @param gid 
 * @param did 
 * @return long 
 */
static inline long sc_kstorage_remove(const char *key, int gid, long did)
{
    if (!key || !key[0]) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_KSTORAGE_REMOVE), gid, did);
    return ret;
}

#ifdef ANDROID
/**
 * @brief 
 * 
 * @param key 
 * @param uid 
 * @param exclude 
 * @return long 
 */
static inline long sc_set_ap_mod_exclude(const char *key, uid_t uid, int exclude)
{
    if(exclude) {
        return sc_kstorage_write(key, KSTORAGE_EXCLUDE_LIST_GROUP, uid, &exclude, 0, sizeof(exclude));
    } else {
        return sc_kstorage_remove(key, KSTORAGE_EXCLUDE_LIST_GROUP, uid);
    }
}


/**
 * @brief 
 * 
 * @param key 
 * @param uid 
 * @param exclude 
 * @return long 
 */
static inline int sc_get_ap_mod_exclude(const char *key, uid_t uid)
{
    int exclude = 0;
    int rc = sc_kstorage_read(key, KSTORAGE_EXCLUDE_LIST_GROUP, uid, &exclude, 0, sizeof(exclude));
    if (rc < 0) return 0;
    return exclude;
}

/**
 *
 */
static inline int sc_list_ap_mod_exclude(const char *key, uid_t *uids, int uids_len)
{
    if(uids_len < 0 || uids_len > 512) return -E2BIG;
    long ids[uids_len];
    int rc = sc_kstorage_list_ids(key, KSTORAGE_EXCLUDE_LIST_GROUP, ids, uids_len);
    if (rc < 0) return 0;
    for(int i = 0; i < rc; i ++) {
        uids[i] = (uid_t)ids[i];
    }
    return rc;
}

#endif

/**
 * @brief Grant su permission
 * 
 * @param key 
 * @param profile : if scontext is invalid or illegal, all selinux permission checks will bypass via hook
 * @return long : 0 if succeed
 */
static inline long sc_su_grant_uid(const char *key, struct su_profile *profile)
{
    if (!key || !key[0]) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_SU_GRANT_UID), profile);
    return ret;
}

/**
 * @brief Revoke su permission
 * 
 * @param key 
 * @param uid 
 * @return long 0 if succeed
 */
static inline long sc_su_revoke_uid(const char *key, uid_t uid)
{
    if (!key || !key[0]) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_SU_REVOKE_UID), uid);
    return ret;
}

/**
 * @brief Get numbers of su allowed uids
 * 
 * @param key 
 * @return long 
 */
static inline long sc_su_uid_nums(const char *key)
{
    if (!key || !key[0]) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_SU_NUMS));
    return ret;
}

/**
 * @brief 
 * 
 * @param key : superkey or 'su' string if caller uid is su allowed 
 * @param buf 
 * @param num 
 * @return long : The numbers of uids if succeed, nagative value if failed
 */
static inline long sc_su_allow_uids(const char *key, uid_t *buf, int num)
{
    if (!key || !key[0]) return -EINVAL;
    if (!buf || num <= 0) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_SU_LIST), buf, num);
    return ret;
}

/**
 * @brief Get su profile of specified uid
 * 
 * @param key 
 * @param uid 
 * @param out_profile 
 * @return long : 0 if succeed
 */
static inline long sc_su_uid_profile(const char *key, uid_t uid, struct su_profile *out_profile)
{
    if (!key || !key[0]) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_SU_PROFILE), uid, out_profile);
    return ret;
}

/**
 * @brief Get full path of current 'su' command 
 * 
 * @param key : superkey or 'su' string if caller uid is su allowed 
 * @param out_path 
 * @param path_len 
 * @return long : The length of result string if succeed, negative if failed
 */
static inline long sc_su_get_path(const char *key, char *out_path, int path_len)
{
    if (!key || !key[0]) return -EINVAL;
    if (!out_path || path_len <= 0) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_SU_GET_PATH), out_path, path_len);
    return ret;
}

/**
 * @brief Reset full path of 'su' command 
 * 
 * @param key 
 * @param path 
 * @return long : 0 if succeed
 */
static inline long sc_su_reset_path(const char *key, const char *path)
{
    if (!key || !key[0]) return -EINVAL;
    if (!path || !path[0]) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_SU_RESET_PATH), path);
    return ret;
}

/**
 * @brief Get current all-allowed selinux context
 * 
 * @param key : superkey or 'su' string if caller uid is su allowed  
 * @param out_sctx 
 * @param sctx_len
 * @return long 0 if there is a all-allowed selinux context now
 */
static inline long sc_su_get_all_allow_sctx(const char *key, char *out_sctx, int sctx_len)
{
    if (!key || !key[0]) return -EINVAL;
    if (!out_sctx) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_SU_GET_ALLOW_SCTX), out_sctx);
    return ret;
}

/**
 * @brief Reset current all-allowed selinux context
 * 
 * @param key : superkey or 'su' string if caller uid is su allowed  
 * @param sctx If sctx is empty string, clear all-allowed selinux, 
 * otherwise, try to reset a new all-allowed selinux context
 * @return long 0 if succeed
 */
static inline long sc_su_reset_all_allow_sctx(const char *key, const char *sctx)
{
    if (!key || !key[0]) return -EINVAL;
    if (!sctx) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_SU_SET_ALLOW_SCTX), sctx);
    return ret;
}

/**
 * @brief Load module
 * 
 * @param key : superkey
 * @param path 
 * @param args 
 * @param reserved 
 * @return long : 0 if succeed
 */
static inline long sc_kpm_load(const char *key, const char *path, const char *args, void *reserved)
{
    if (!key || !key[0]) return -EINVAL;
    if (!path || strlen(path) <= 0) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_KPM_LOAD), path, args, reserved);
    return ret;
}

/**
 * @brief Control module with arguments 
 * 
 * @param key : superkey
 * @param name : module name
 * @param ctl_args : control argument
 * @param out_msg : output message buffer
 * @param outlen : buffer length of out_msg
 * @return long : 0 if succeed
 */
static inline long sc_kpm_control(const char *key, const char *name, const char *ctl_args, char *out_msg, long outlen)
{
    if (!key || !key[0]) return -EINVAL;
    if (!name || strlen(name) <= 0) return -EINVAL;
    if (!ctl_args || strlen(ctl_args) <= 0) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_KPM_CONTROL), name, ctl_args, out_msg, outlen);
    return ret;
}

/**
 * @brief Unload module
 * 
 * @param key : superkey
 * @param name : module name
 * @param reserved 
 * @return long : 0 if succeed
 */
static inline long sc_kpm_unload(const char *key, const char *name, void *reserved)
{
    if (!key || !key[0]) return -EINVAL;
    if (!name || strlen(name) <= 0) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_KPM_UNLOAD), name, reserved);
    return ret;
}

/**
 * @brief Current loaded module numbers
 * 
 * @param key : superkey
 * @return long
 */
static inline long sc_kpm_nums(const char *key)
{
    if (!key || !key[0]) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_KPM_NUMS));
    return ret;
}

/**
 * @brief List names of current loaded modules, splited with '\n'
 * 
 * @param key : superkey
 * @param names_buf : output buffer
 * @param buf_len : the length of names_buf
 * @return long : the length of result string if succeed, negative if failed
 */
static inline long sc_kpm_list(const char *key, char *names_buf, int buf_len)
{
    if (!key || !key[0]) return -EINVAL;
    if (!names_buf || buf_len <= 0) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_KPM_LIST), names_buf, buf_len);
    return ret;
}

/**
 * @brief Get module information. 
 * 
 * @param key : superkey
 * @param name : module name
 * @param buf : 
 * @param buf_len : 
 * @return long : The length of result string if succeed, negative if failed
 */
static inline long sc_kpm_info(const char *key, const char *name, char *buf, int buf_len)
{
    if (!key || !key[0]) return -EINVAL;
    if (!buf || buf_len <= 0) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_KPM_INFO), name, buf, buf_len);
    return ret;
}

/**
 * @brief Get current superkey
 * 
 * @param key : superkey
 * @param out_key 
 * @param outlen 
 * @return long : 0 if succeed
 */
static inline long sc_skey_get(const char *key, char *out_key, int outlen)
{
    if (!key || !key[0]) return -EINVAL;
    if (outlen < SUPERCALL_KEY_MAX_LEN) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_SKEY_GET), out_key, outlen);
    return ret;
}

/**
 * @brief Reset current superkey
 * 
 * @param key : superkey
 * @param new_key 
 * @return long : 0 if succeed
 */
static inline long sc_skey_set(const char *key, const char *new_key)
{
    if (!key || !key[0]) return -EINVAL;
    if (!new_key || !new_key[0]) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_SKEY_SET), new_key);
    return ret;
}

/**
 * @brief Whether to enable hash verification for root superkey.
 * 
 * @param key : superkey
 * @param enable 
 * @return long 
 */
static inline long sc_skey_root_enable(const char *key, bool enable)
{
    if (!key || !key[0]) return -EINVAL;
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_SKEY_ROOT_ENABLE), (long)enable);
    return ret;
}

/**
 * @brief Get whether in safe mode
 *
 * @param key
 * @return long
 */
static inline long sc_su_get_safemode(const char *key)
{
    if (!key || !key[0]) return -EINVAL;
    return syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_SU_GET_SAFEMODE));
}


static inline long sc_bootlog(const char *key)
{
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_BOOTLOG));
    return ret;
}

static inline long sc_panic(const char *key)
{
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_PANIC));
    return ret;
}

static inline long __sc_test(const char *key, long a1, long a2, long a3)
{
    long ret = syscall(__NR_supercall, key, ver_and_cmd(key, SUPERCALL_TEST), a1, a2, a3);
    return ret;
}

#endif
```

`app/src/main/cpp/type_traits.hpp`:

```hpp
#pragma once

#include <type_traits>

namespace lsplant {
template <class, template <class, class...> class>
struct is_instance : public std::false_type {};

template <class... Ts, template <class, class...> class U>
struct is_instance<U<Ts...>, U> : public std::true_type {};

template <class T, template <class, class...> class U>
inline constexpr bool is_instance_v = is_instance<T, U>::value;
}  // namespace lsplant

```

`app/src/main/cpp/uapi/scdefs.h`:

```h
/* SPDX-License-Identifier: GPL-2.0-or-later */
/* 
 * Copyright (C) 2023 bmax121. All Rights Reserved.
 */

#ifndef _KP_UAPI_SCDEF_H_
#define _KP_UAPI_SCDEF_H_

static inline long hash_key(const char *key)
{
    long hash = 1000000007;
    for (int i = 0; key[i]; i++) {
        hash = hash * 31 + key[i];
    }
    return hash;
}

#define SUPERCALL_HELLO_ECHO "hello1158"

// #define __NR_supercall __NR3264_truncate // 45
#define __NR_supercall 45

#define SUPERCALL_HELLO 0x1000
#define SUPERCALL_KLOG 0x1004

#define SUPERCALL_BUILD_TIME 0x1007
#define SUPERCALL_KERNELPATCH_VER 0x1008
#define SUPERCALL_KERNEL_VER 0x1009

#define SUPERCALL_SKEY_GET 0x100a
#define SUPERCALL_SKEY_SET 0x100b
#define SUPERCALL_SKEY_ROOT_ENABLE 0x100c

#define SUPERCALL_SU 0x1010
#define SUPERCALL_SU_TASK 0x1011 // syscall(__NR_gettid)

#define SUPERCALL_KPM_LOAD 0x1020
#define SUPERCALL_KPM_UNLOAD 0x1021
#define SUPERCALL_KPM_CONTROL 0x1022

#define SUPERCALL_KPM_NUMS 0x1030
#define SUPERCALL_KPM_LIST 0x1031
#define SUPERCALL_KPM_INFO 0x1032

struct kernel_storage
{
    void *data;
    int len;
};

#define SUPERCALL_KSTORAGE_ALLOC_GROUP 0x1040
#define SUPERCALL_KSTORAGE_WRITE 0x1041
#define SUPERCALL_KSTORAGE_READ 0x1042
#define SUPERCALL_KSTORAGE_LIST_IDS 0x1043
#define SUPERCALL_KSTORAGE_REMOVE 0x1044
#define SUPERCALL_KSTORAGE_REMOVE_GROUP 0x1045

#define KSTORAGE_SU_LIST_GROUP 0
#define KSTORAGE_EXCLUDE_LIST_GROUP 1
#define KSTORAGE_UNUSED_GROUP_2 2
#define KSTORAGE_UNUSED_GROUP_3 3

#define SUPERCALL_BOOTLOG 0x10fd
#define SUPERCALL_PANIC 0x10fe
#define SUPERCALL_TEST 0x10ff

#define SUPERCALL_KEY_MAX_LEN 0x40
#define SUPERCALL_SCONTEXT_LEN 0x60

struct su_profile
{
    uid_t uid;
    uid_t to_uid;
    char scontext[SUPERCALL_SCONTEXT_LEN];
};

#ifdef ANDROID
#define SH_PATH "/system/bin/sh"
#define SU_PATH "/system/bin/kp"
#define LEGACY_SU_PATH "/system/bin/su"
#define ECHO_PATH "/system/bin/echo"
#define KERNELPATCH_DATA_DIR "/data/adb/kp"
#define KERNELPATCH_MODULE_DATA_DIR KERNELPATCH_DATA_DIR "/modules"
#define APD_PATH "/data/adb/apd"
#define ALL_ALLOW_SCONTEXT "u:r:kp:s0"
#define ALL_ALLOW_SCONTEXT_MAGISK "u:r:magisk:s0"
#define ALL_ALLOW_SCONTEXT_KERNEL "u:r:kernel:s0"
#else
#define SH_PATH "/usr/bin/sh"
#define ECHO_PATH "/usr/bin/echo"
#define SU_PATH "/usr/bin/kp"
#define ALL_ALLOW_SCONTEXT "u:r:kernel:s0"
#endif

#define SU_PATH_MAX_LEN 128

#define SUPERCMD "/system/bin/truncate"

#define SAFE_MODE_FLAG_FILE "/dev/.safemode"

#define SUPERCALL_SU_GRANT_UID 0x1100
#define SUPERCALL_SU_REVOKE_UID 0x1101
#define SUPERCALL_SU_NUMS 0x1102
#define SUPERCALL_SU_LIST 0x1103
#define SUPERCALL_SU_PROFILE 0x1104
#define SUPERCALL_SU_GET_ALLOW_SCTX 0x1105
#define SUPERCALL_SU_SET_ALLOW_SCTX 0x1106
#define SUPERCALL_SU_GET_PATH 0x1110
#define SUPERCALL_SU_RESET_PATH 0x1111
#define SUPERCALL_SU_GET_SAFEMODE 0x1112

#define SUPERCALL_MAX 0x1200

#define SUPERCALL_RES_SUCCEED 0

#define SUPERCALL_HELLO_MAGIC 0x11581158

#endif

```

`app/src/main/cpp/version`:

```
#define MAJOR 0
#define MINOR 13
#define PATCH 0

```

`app/src/main/java/me/bmax/apatch/APatchApp.kt`:

```kt
package me.bmax.apatch

import android.app.Application
import android.content.Context
import android.content.Intent
import android.content.SharedPreferences
import android.os.Build
import android.util.Log
import android.widget.Toast
import androidx.core.content.edit
import androidx.core.net.toUri
import androidx.lifecycle.LiveData
import androidx.lifecycle.MutableLiveData
import com.topjohnwu.superuser.CallbackList
import me.bmax.apatch.ui.CrashHandleActivity
import me.bmax.apatch.util.APatchCli
import me.bmax.apatch.util.APatchKeyHelper
import me.bmax.apatch.util.Version
import me.bmax.apatch.util.getRootShell
import me.bmax.apatch.util.rootShellForResult
import me.bmax.apatch.util.verifyAppSignature
import okhttp3.Cache
import okhttp3.OkHttpClient
import java.io.File
import java.util.Locale
import kotlin.concurrent.thread
import kotlin.system.exitProcess

lateinit var apApp: APApplication

const val TAG = "APatch"

class APApplication : Application(), Thread.UncaughtExceptionHandler {
    lateinit var okhttpClient: OkHttpClient

    init {
        Thread.setDefaultUncaughtExceptionHandler(this)
    }

    enum class State {
        UNKNOWN_STATE,

        KERNELPATCH_INSTALLED, KERNELPATCH_NEED_UPDATE, KERNELPATCH_NEED_REBOOT, KERNELPATCH_UNINSTALLING,

        ANDROIDPATCH_NOT_INSTALLED, ANDROIDPATCH_INSTALLED, ANDROIDPATCH_INSTALLING, ANDROIDPATCH_NEED_UPDATE, ANDROIDPATCH_UNINSTALLING,
    }


    companion object {
        const val APD_PATH = "/data/adb/apd"

        @Deprecated("No more KPatch ELF from 0.11.0-dev")
        const val KPATCH_PATH = "/data/adb/kpatch"
        const val SUPERCMD = "/system/bin/truncate"
        const val APATCH_FOLDER = "/data/adb/ap/"
        private const val APATCH_BIN_FOLDER = APATCH_FOLDER + "bin/"
        private const val APATCH_LOG_FOLDER = APATCH_FOLDER + "log/"
        private const val APD_LINK_PATH = APATCH_BIN_FOLDER + "apd"
        const val PACKAGE_CONFIG_FILE = APATCH_FOLDER + "package_config"
        const val SU_PATH_FILE = APATCH_FOLDER + "su_path"
        const val SAFEMODE_FILE = "/dev/.safemode"
        private const val NEED_REBOOT_FILE = "/dev/.need_reboot"
        const val GLOBAL_NAMESPACE_FILE = "/data/adb/.global_namespace_enable"
        const val KPMS_DIR = APATCH_FOLDER + "kpms/"

        @Deprecated("Use 'apd -V'")
        const val APATCH_VERSION_PATH = APATCH_FOLDER + "version"
        private const val MAGISKPOLICY_BIN_PATH = APATCH_BIN_FOLDER + "magiskpolicy"
        private const val BUSYBOX_BIN_PATH = APATCH_BIN_FOLDER + "busybox"
        private const val RESETPROP_BIN_PATH = APATCH_BIN_FOLDER + "resetprop"
        private const val KPTOOLS_BIN_PATH = APATCH_BIN_FOLDER + "kptools"
        const val DEFAULT_SCONTEXT = "u:r:untrusted_app:s0"
        const val MAGISK_SCONTEXT = "u:r:magisk:s0"

        private const val DEFAULT_SU_PATH = "/system/bin/kp"
        private const val LEGACY_SU_PATH = "/system/bin/su"

        const val SP_NAME = "config"
        private const val SHOW_BACKUP_WARN = "show_backup_warning"
        lateinit var sharedPreferences: SharedPreferences

        private val logCallback: CallbackList<String?> = object : CallbackList<String?>() {
            override fun onAddElement(s: String?) {
                Log.d(TAG, s.toString())
            }
        }

        private val _kpStateLiveData = MutableLiveData(State.UNKNOWN_STATE)
        val kpStateLiveData: LiveData<State> = _kpStateLiveData

        private val _apStateLiveData = MutableLiveData(State.UNKNOWN_STATE)
        val apStateLiveData: LiveData<State> = _apStateLiveData

        @Suppress("DEPRECATION")
        fun uninstallApatch() {
            if (_apStateLiveData.value != State.ANDROIDPATCH_INSTALLED) return
            _apStateLiveData.value = State.ANDROIDPATCH_UNINSTALLING

            Natives.resetSuPath(DEFAULT_SU_PATH)

            val cmds = arrayOf(
                "rm -f $APD_PATH",
                "rm -f $KPATCH_PATH",
                "rm -rf $APATCH_BIN_FOLDER",
                "rm -rf $APATCH_LOG_FOLDER",
                "rm -rf $APATCH_VERSION_PATH",
            )

            val shell = getRootShell()
            shell.newJob().add(*cmds).to(logCallback, logCallback).exec()

            Log.d(TAG, "APatch uninstalled...")
            if (_kpStateLiveData.value == State.UNKNOWN_STATE) {
                _apStateLiveData.postValue(State.UNKNOWN_STATE)
            } else {
                _apStateLiveData.postValue(State.ANDROIDPATCH_NOT_INSTALLED)
            }
        }

        @Suppress("DEPRECATION")
        fun installApatch() {
            val state = _apStateLiveData.value
            if (state != State.ANDROIDPATCH_NOT_INSTALLED && state != State.ANDROIDPATCH_NEED_UPDATE) {
                return
            }
            _apStateLiveData.value = State.ANDROIDPATCH_INSTALLING
            val nativeDir = apApp.applicationInfo.nativeLibraryDir

            Natives.resetSuPath(LEGACY_SU_PATH)

            val cmds = arrayOf(
                "mkdir -p $APATCH_BIN_FOLDER",
                "mkdir -p $APATCH_LOG_FOLDER",

                "cp -f ${nativeDir}/libapd.so $APD_PATH",
                "chmod +x $APD_PATH",
                "ln -s $APD_PATH $APD_LINK_PATH",
                "restorecon $APD_PATH",

                "cp -f ${nativeDir}/libmagiskpolicy.so $MAGISKPOLICY_BIN_PATH",
                "chmod +x $MAGISKPOLICY_BIN_PATH",
                "cp -f ${nativeDir}/libresetprop.so $RESETPROP_BIN_PATH",
                "chmod +x $RESETPROP_BIN_PATH",
                "cp -f ${nativeDir}/libbusybox.so $BUSYBOX_BIN_PATH",
                "chmod +x $BUSYBOX_BIN_PATH",
                "cp -f ${nativeDir}/libkptools.so $KPTOOLS_BIN_PATH",
                "chmod +x $KPTOOLS_BIN_PATH",



                "touch $PACKAGE_CONFIG_FILE",
                "touch $SU_PATH_FILE",
                "[ -s $SU_PATH_FILE ] || echo $LEGACY_SU_PATH > $SU_PATH_FILE",
                "echo ${Version.getManagerVersion().second} > $APATCH_VERSION_PATH",
                "restorecon -R $APATCH_FOLDER",

                "${nativeDir}/libmagiskpolicy.so --magisk --live",
            )

            val shell = getRootShell()
            shell.newJob().add(*cmds).to(logCallback, logCallback).exec()

            // clear shell cache
            APatchCli.refresh()

            Log.d(TAG, "APatch installed...")
            _apStateLiveData.postValue(State.ANDROIDPATCH_INSTALLED)
        }

        fun markNeedReboot() {
            val result = rootShellForResult("touch $NEED_REBOOT_FILE")
            _kpStateLiveData.postValue(State.KERNELPATCH_NEED_REBOOT)
            Log.d(TAG, "mark reboot ${result.code}")
        }


        var superKey: String = ""
            set(value) {
                field = value
                val ready = Natives.nativeReady(value)
                _kpStateLiveData.value =
                    if (ready) State.KERNELPATCH_INSTALLED else State.UNKNOWN_STATE
                _apStateLiveData.value =
                    if (ready) State.ANDROIDPATCH_NOT_INSTALLED else State.UNKNOWN_STATE
                Log.d(TAG, "state: " + _kpStateLiveData.value)
                if (!ready) return

                APatchKeyHelper.writeSPSuperKey(value)

                thread {
                    val rc = Natives.su(0, null)
                    if (!rc) {
                        Log.e(TAG, "Native.su failed")
                        return@thread
                    }

                    // KernelPatch version
                    //val buildV = Version.buildKPVUInt()
                    //val installedV = Version.installedKPVUInt()
                    //use build time to check update
                    val buildV = Version.getKpImg()
                    val installedV = Version.installedKPTime()


                    Log.d(TAG, "kp installed version: ${installedV}, build version: $buildV")

                    // use != instead of > to enable downgrade,
                    if (buildV != installedV) {
                        _kpStateLiveData.postValue(State.KERNELPATCH_NEED_UPDATE)
                    }
                    Log.d(TAG, "kp state: " + _kpStateLiveData.value)

                    if (File(NEED_REBOOT_FILE).exists()) {
                        _kpStateLiveData.postValue(State.KERNELPATCH_NEED_REBOOT)
                    }
                    Log.d(TAG, "kp state: " + _kpStateLiveData.value)

                    // AndroidPatch version
                    val mgv = Version.getManagerVersion().second
                    val installedApdVInt = Version.installedApdVUInt()
                    Log.d(TAG, "manager version: $mgv, installed apd version: $installedApdVInt")

                    if (Version.installedApdVInt > 0) {
                        _apStateLiveData.postValue(State.ANDROIDPATCH_INSTALLED)
                    }

                    if (Version.installedApdVInt > 0 && mgv.toInt() != Version.installedApdVInt) {
                        _apStateLiveData.postValue(State.ANDROIDPATCH_NEED_UPDATE)
                        // su path
                        val suPathFile = File(SU_PATH_FILE)
                        if (suPathFile.exists()) {
                            val suPath = suPathFile.readLines()[0].trim()
                            if (Natives.suPath() != suPath) {
                                Log.d(TAG, "su path: $suPath")
                                Natives.resetSuPath(suPath)
                            }
                        }
                    }
                    Log.d(TAG, "ap state: " + _apStateLiveData.value)

                    return@thread
                }
            }
    }

    override fun onCreate() {
        super.onCreate()
        apApp = this

        val isArm64 = Build.SUPPORTED_ABIS.any { it == "arm64-v8a" }
        if (!isArm64) {
            Toast.makeText(applicationContext, "Unsupported architecture!", Toast.LENGTH_LONG)
                .show()
            Thread.sleep(5000)
            exitProcess(0)
        }

        if (!BuildConfig.DEBUG && !verifyAppSignature("1x2twMoHvfWUODv7KkRRNKBzOfEqJwRKGzJpgaz18xk=")) {
            while (true) {
                val intent = Intent(Intent.ACTION_DELETE)
                intent.data = "package:$packageName".toUri()
                intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK)
                intent.addFlags(Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS)
                startActivity(intent)
                exitProcess(0)
            }
        }

        // TODO: We can't totally protect superkey from be stolen by root or LSPosed-like injection tools in user space, the only way is don't use superkey,
        // TODO: 1. make me root by kernel
        // TODO: 2. remove all usage of superkey
        sharedPreferences = getSharedPreferences(SP_NAME, Context.MODE_PRIVATE)
        APatchKeyHelper.setSharedPreferences(sharedPreferences)
        superKey = APatchKeyHelper.readSPSuperKey()

        okhttpClient =
            OkHttpClient.Builder().cache(Cache(File(cacheDir, "okhttp"), 10 * 1024 * 1024))
                .addInterceptor { block ->
                    block.proceed(
                        block.request().newBuilder()
                            .header("User-Agent", "APatch/${BuildConfig.VERSION_CODE}")
                            .header("Accept-Language", Locale.getDefault().toLanguageTag()).build()
                    )
                }.build()
    }

    fun getBackupWarningState(): Boolean {
        return sharedPreferences.getBoolean(SHOW_BACKUP_WARN, true)
    }

    fun updateBackupWarningState(state: Boolean) {
        sharedPreferences.edit { putBoolean(SHOW_BACKUP_WARN, state) }
    }

    override fun uncaughtException(t: Thread, e: Throwable) {
        val exceptionMessage = Log.getStackTraceString(e)
        val threadName = t.name
        Log.e(TAG, "Error on thread $threadName:\n $exceptionMessage")
        val intent = Intent(this, CrashHandleActivity::class.java).apply {
            putExtra("exception_message", exceptionMessage)
            putExtra("thread", threadName)
            flags = Intent.FLAG_ACTIVITY_NEW_TASK
        }
        startActivity(intent)
        exitProcess(10)
    }
}

```

`app/src/main/java/me/bmax/apatch/Natives.kt`:

```kt
package me.bmax.apatch

import android.os.Parcelable
import androidx.annotation.Keep
import androidx.compose.runtime.Immutable
import dalvik.annotation.optimization.FastNative
import kotlinx.parcelize.Parcelize

object Natives {
    init {
        System.loadLibrary("apjni")
    }

    @Immutable
    @Parcelize
    @Keep
    data class Profile(
        var uid: Int = 0,
        var toUid: Int = 0,
        var scontext: String = APApplication.DEFAULT_SCONTEXT,
    ) : Parcelable

    @Keep
    class KPMCtlRes {
        var rc: Long = 0
        var outMsg: String? = null

        constructor()

        constructor(rc: Long, outMsg: String?) {
            this.rc = rc
            this.outMsg = outMsg
        }
    }


    @FastNative
    private external fun nativeSu(superKey: String, toUid: Int, scontext: String?): Long

    fun su(toUid: Int, scontext: String?): Boolean {
        return nativeSu(APApplication.superKey, toUid, scontext) == 0L
    }

    fun su(): Boolean {
        return su(0, "")
    }

    @FastNative
    external fun nativeReady(superKey: String): Boolean

    @FastNative
    private external fun nativeSuPath(superKey: String): String

    fun suPath(): String {
        return nativeSuPath(APApplication.superKey)
    }

    @FastNative
    private external fun nativeSuUids(superKey: String): IntArray

    fun suUids(): IntArray {
        return nativeSuUids(APApplication.superKey)
    }

    @FastNative
    private external fun nativeKernelPatchVersion(superKey: String): Long
    fun kernelPatchVersion(): Long {
        return nativeKernelPatchVersion(APApplication.superKey)
    }

    @FastNative
    private external fun nativeKernelPatchBuildTime(superKey: String): String
    fun kernelPatchBuildTime(): String {
        return nativeKernelPatchBuildTime(APApplication.superKey)
    }

    private external fun nativeLoadKernelPatchModule(
        superKey: String, modulePath: String, args: String
    ): Long

    fun loadKernelPatchModule(modulePath: String, args: String): Long {
        return nativeLoadKernelPatchModule(APApplication.superKey, modulePath, args)
    }

    private external fun nativeUnloadKernelPatchModule(superKey: String, moduleName: String): Long
    fun unloadKernelPatchModule(moduleName: String): Long {
        return nativeUnloadKernelPatchModule(APApplication.superKey, moduleName)
    }

    @FastNative
    private external fun nativeKernelPatchModuleNum(superKey: String): Long

    fun kernelPatchModuleNum(): Long {
        return nativeKernelPatchModuleNum(APApplication.superKey)
    }

    @FastNative
    private external fun nativeKernelPatchModuleList(superKey: String): String
    fun kernelPatchModuleList(): String {
        return nativeKernelPatchModuleList(APApplication.superKey)
    }

    @FastNative
    private external fun nativeKernelPatchModuleInfo(superKey: String, moduleName: String): String
    fun kernelPatchModuleInfo(moduleName: String): String {
        return nativeKernelPatchModuleInfo(APApplication.superKey, moduleName)
    }

    private external fun nativeControlKernelPatchModule(
        superKey: String, modName: String, jctlargs: String
    ): KPMCtlRes

    fun kernelPatchModuleControl(moduleName: String, controlArg: String): KPMCtlRes {
        return nativeControlKernelPatchModule(APApplication.superKey, moduleName, controlArg)
    }

    @FastNative
    private external fun nativeGrantSu(
        superKey: String, uid: Int, toUid: Int, scontext: String?
    ): Long

    fun grantSu(uid: Int, toUid: Int, scontext: String?): Long {
        return nativeGrantSu(APApplication.superKey, uid, toUid, scontext)
    }

    @FastNative
    private external fun nativeRevokeSu(superKey: String, uid: Int): Long
    fun revokeSu(uid: Int): Long {
        return nativeRevokeSu(APApplication.superKey, uid)
    }

    @FastNative
    private external fun nativeSetUidExclude(superKey: String, uid: Int, exclude: Int): Int
    fun setUidExclude(uid: Int, exclude: Int): Int {
        return nativeSetUidExclude(APApplication.superKey, uid, exclude)
    }

    @FastNative
    private external fun nativeGetUidExclude(superKey: String, uid: Int): Int
    fun isUidExcluded(uid: Int): Int {
        return nativeGetUidExclude(APApplication.superKey, uid)
    }

    @FastNative
    private external fun nativeSuProfile(superKey: String, uid: Int): Profile
    fun suProfile(uid: Int): Profile {
        return nativeSuProfile(APApplication.superKey, uid)
    }

    @FastNative
    private external fun nativeResetSuPath(superKey: String, path: String): Boolean
    fun resetSuPath(path: String): Boolean {
        return nativeResetSuPath(APApplication.superKey, path)
    }
}

```

`app/src/main/java/me/bmax/apatch/services/RootServices.java`:

```java
package me.bmax.apatch.services;

import android.content.Context;
import android.content.Intent;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import android.os.IBinder;
import android.os.UserHandle;
import android.os.UserManager;
import android.util.Log;

import androidx.annotation.NonNull;

import com.topjohnwu.superuser.ipc.RootService;

import java.lang.reflect.Method;
import java.util.ArrayList;
import java.util.List;

import me.bmax.apatch.IAPRootService;
import rikka.parcelablelist.ParcelableListSlice;

public class RootServices extends RootService {
    private static final String TAG = "RootServices";

    @Override
    public IBinder onBind(@NonNull Intent intent) {
        return new Stub();
    }

    List<Integer> getUserIds() {
        List<Integer> result = new ArrayList<>();
        UserManager um = (UserManager) getSystemService(Context.USER_SERVICE);
        List<UserHandle> userProfiles = um.getUserProfiles();
        for (UserHandle userProfile : userProfiles) {
            int userId = userProfile.hashCode();
            result.add(userProfile.hashCode());
        }
        return result;
    }

    ArrayList<PackageInfo> getInstalledPackagesAll(int flags) {
        ArrayList<PackageInfo> packages = new ArrayList<>();
        for (Integer userId : getUserIds()) {
            Log.i(TAG, "getInstalledPackagesAll: " + userId);
            packages.addAll(getInstalledPackagesAsUser(flags, userId));
        }
        return packages;
    }

    List<PackageInfo> getInstalledPackagesAsUser(int flags, int userId) {
        try {
            PackageManager pm = getPackageManager();
            Method getInstalledPackagesAsUser = pm.getClass().getDeclaredMethod("getInstalledPackagesAsUser", int.class, int.class);
            return (List<PackageInfo>) getInstalledPackagesAsUser.invoke(pm, flags, userId);
        } catch (Throwable e) {
            Log.e(TAG, "err", e);
        }

        return new ArrayList<>();
    }

    class Stub extends IAPRootService.Stub {
        @Override
        public ParcelableListSlice<PackageInfo> getPackages(int flags) {
            List<PackageInfo> list = getInstalledPackagesAll(flags);
            Log.i(TAG, "getPackages: " + list.size());
            return new ParcelableListSlice<>(list);
        }

    }
}
```

`app/src/main/java/me/bmax/apatch/ui/CrashHandleActivity.kt`:

```kt
package me.bmax.apatch.ui

import android.content.ClipData
import android.os.Build
import android.os.Bundle
import androidx.activity.ComponentActivity
import androidx.activity.compose.setContent
import androidx.activity.enableEdgeToEdge
import androidx.compose.foundation.layout.WindowInsets
import androidx.compose.foundation.layout.WindowInsetsSides
import androidx.compose.foundation.layout.fillMaxSize
import androidx.compose.foundation.layout.only
import androidx.compose.foundation.layout.padding
import androidx.compose.foundation.layout.safeDrawing
import androidx.compose.foundation.layout.windowInsetsPadding
import androidx.compose.foundation.rememberScrollState
import androidx.compose.foundation.text.selection.SelectionContainer
import androidx.compose.foundation.verticalScroll
import androidx.compose.material.icons.Icons
import androidx.compose.material.icons.outlined.ContentCopy
import androidx.compose.material3.ExperimentalMaterial3Api
import androidx.compose.material3.ExtendedFloatingActionButton
import androidx.compose.material3.Icon
import androidx.compose.material3.LargeTopAppBar
import androidx.compose.material3.Scaffold
import androidx.compose.material3.Text
import androidx.compose.material3.TopAppBarDefaults
import androidx.compose.material3.rememberTopAppBarState
import androidx.compose.runtime.Composable
import androidx.compose.runtime.rememberCoroutineScope
import androidx.compose.ui.Modifier
import androidx.compose.ui.input.nestedscroll.nestedScroll
import androidx.compose.ui.platform.ClipEntry
import androidx.compose.ui.platform.LocalClipboard
import androidx.compose.ui.res.stringResource
import androidx.compose.ui.text.TextStyle
import androidx.compose.ui.text.font.FontFamily
import androidx.compose.ui.tooling.preview.Preview
import androidx.compose.ui.unit.dp
import androidx.compose.ui.unit.sp
import kotlinx.coroutines.launch
import me.bmax.apatch.BuildConfig
import me.bmax.apatch.R
import me.bmax.apatch.ui.theme.APatchTheme
import java.text.SimpleDateFormat
import java.util.Calendar
import java.util.Locale

class CrashHandleActivity : ComponentActivity() {

    override fun onCreate(savedInstanceState: Bundle?) {

        enableEdgeToEdge()
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.Q) {
            window.isNavigationBarContrastEnforced = false
        }

        super.onCreate(savedInstanceState)

        val appName = getString(R.string.app_name)
        val versionName = BuildConfig.VERSION_NAME
        val versionCode = BuildConfig.VERSION_CODE

        val deviceBrand = Build.BRAND
        val deviceModel = Build.MODEL
        val sdkLevel = Build.VERSION.SDK_INT
        val currentDateTime = Calendar.getInstance().time
        val formatter = SimpleDateFormat("yyyy-MM-dd HH:mm:ss", Locale.getDefault())
        val formattedDateTime = formatter.format(currentDateTime)

        val exceptionMessage = intent.getStringExtra("exception_message")
        val threadName = intent.getStringExtra("thread")

        val message = buildString {
            append(appName).append(" version: ").append(versionName).append(" ($versionCode)")
                .append("\n\n")
            append("Brand: ").append(deviceBrand).append("\n")
            append("Model: ").append(deviceModel).append("\n")
            append("SDK Level: ").append(sdkLevel).append("\n")
            append("Time: ").append(formattedDateTime).append("\n\n")
            append("Thread: ").append(threadName).append("\n")
            append("Crash Info: \n").append(exceptionMessage)
        }

        setContent {
            APatchTheme {
                CrashHandleScreen(message)
            }
        }
    }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
private fun CrashHandleScreen(
    message: String
) {
    val scrollBehavior =
        TopAppBarDefaults.exitUntilCollapsedScrollBehavior(rememberTopAppBarState())
    val clipboard = LocalClipboard.current
    val scope = rememberCoroutineScope()

    Scaffold(contentWindowInsets = WindowInsets.safeDrawing, topBar = {
        LargeTopAppBar(
            title = { Text(text = stringResource(R.string.crash_handle_title)) },
            scrollBehavior = scrollBehavior,
            windowInsets = WindowInsets.safeDrawing.only(WindowInsetsSides.Top + WindowInsetsSides.Horizontal)
        )
    }, floatingActionButton = {
        ExtendedFloatingActionButton(
            onClick = {
            scope.launch {
                clipboard.setClipEntry(
                    ClipEntry(ClipData.newPlainText("CrashLog", message)),
                )
            }
        }, text = { Text(text = stringResource(R.string.crash_handle_copy)) }, icon = {
            Icon(
                imageVector = Icons.Outlined.ContentCopy, contentDescription = null
            )
        }, modifier = Modifier.windowInsetsPadding(
            WindowInsets.safeDrawing.only(WindowInsetsSides.End)
        )
        )
    }) {
        SelectionContainer(
            modifier = Modifier
                .fillMaxSize()
                .nestedScroll(scrollBehavior.nestedScrollConnection)
                .verticalScroll(rememberScrollState())
                .padding(it)
                .padding(
                    start = 16.dp, top = 16.dp, end = 16.dp, bottom = 16.dp + 56.dp + 16.dp
                )
        ) {
            Text(
                text = message, style = TextStyle(
                    fontFamily = FontFamily.Monospace, fontSize = 11.sp
                )
            )
        }
    }
}

@Preview
@Composable
fun CrashHandleScreenPreview() {
    APatchTheme {
        CrashHandleScreen("Crash log here")
    }
}
```

`app/src/main/java/me/bmax/apatch/ui/MainActivity.kt`:

```kt
package me.bmax.apatch.ui

import android.annotation.SuppressLint
import android.content.res.Configuration
import android.os.Build
import android.os.Bundle
import androidx.activity.compose.setContent
import androidx.activity.enableEdgeToEdge
import androidx.appcompat.app.AppCompatActivity
import androidx.compose.animation.AnimatedContentTransitionScope
import androidx.compose.animation.Crossfade
import androidx.compose.animation.EnterTransition
import androidx.compose.animation.ExitTransition
import androidx.compose.animation.core.tween
import androidx.compose.animation.fadeIn
import androidx.compose.animation.fadeOut
import androidx.compose.animation.scaleOut
import androidx.compose.animation.slideInHorizontally
import androidx.compose.animation.slideOutHorizontally
import androidx.compose.foundation.layout.Arrangement
import androidx.compose.foundation.layout.Column
import androidx.compose.foundation.layout.Row
import androidx.compose.foundation.layout.WindowInsets
import androidx.compose.foundation.layout.WindowInsetsSides
import androidx.compose.foundation.layout.consumeWindowInsets
import androidx.compose.foundation.layout.fillMaxHeight
import androidx.compose.foundation.layout.fillMaxSize
import androidx.compose.foundation.layout.only
import androidx.compose.foundation.layout.padding
import androidx.compose.foundation.layout.safeDrawing
import androidx.compose.foundation.layout.systemBars
import androidx.compose.foundation.layout.windowInsetsPadding
import androidx.compose.material3.Icon
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.NavigationBar
import androidx.compose.material3.NavigationBarItem
import androidx.compose.material3.NavigationRail
import androidx.compose.material3.NavigationRailItem
import androidx.compose.material3.Scaffold
import androidx.compose.material3.SnackbarHostState
import androidx.compose.material3.Text
import androidx.compose.runtime.Composable
import androidx.compose.runtime.CompositionLocalProvider
import androidx.compose.runtime.LaunchedEffect
import androidx.compose.runtime.getValue
import androidx.compose.runtime.livedata.observeAsState
import androidx.compose.runtime.remember
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.platform.LocalConfiguration
import androidx.compose.ui.res.stringResource
import androidx.compose.ui.text.style.TextOverflow
import androidx.compose.ui.unit.dp
import androidx.core.splashscreen.SplashScreen.Companion.installSplashScreen
import androidx.navigation.NavBackStackEntry
import androidx.navigation.NavHostController
import androidx.navigation.compose.rememberNavController
import coil.Coil
import coil.ImageLoader
import com.ramcosta.composedestinations.DestinationsNavHost
import com.ramcosta.composedestinations.animations.NavHostAnimatedDestinationStyle
import com.ramcosta.composedestinations.generated.NavGraphs
import com.ramcosta.composedestinations.rememberNavHostEngine
import com.ramcosta.composedestinations.utils.isRouteOnBackStackAsState
import com.ramcosta.composedestinations.utils.rememberDestinationsNavigator
import me.bmax.apatch.APApplication
import me.bmax.apatch.ui.screen.BottomBarDestination
import me.bmax.apatch.ui.theme.APatchTheme
import me.bmax.apatch.ui.viewmodel.SuperUserViewModel
import me.bmax.apatch.util.ui.LocalSnackbarHost
import me.zhanghai.android.appiconloader.coil.AppIconFetcher
import me.zhanghai.android.appiconloader.coil.AppIconKeyer

class MainActivity : AppCompatActivity() {

    private var isLoading = true

    @SuppressLint("UnusedMaterial3ScaffoldPaddingParameter")
    override fun onCreate(savedInstanceState: Bundle?) {

        installSplashScreen().setKeepOnScreenCondition { isLoading }

        enableEdgeToEdge()
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.Q) {
            window.isNavigationBarContrastEnforced = false
        }

        super.onCreate(savedInstanceState)

        setContent {
            APatchTheme {
                val navController = rememberNavController()
                val snackBarHostState = remember { SnackbarHostState() }
                val configuration = LocalConfiguration.current
                val bottomBarRoutes = remember {
                    BottomBarDestination.entries.map { it.direction.route }.toSet()
                }
                val state by APApplication.apStateLiveData.observeAsState(APApplication.State.UNKNOWN_STATE)
                val kPatchReady = state != APApplication.State.UNKNOWN_STATE
                val aPatchReady = state == APApplication.State.ANDROIDPATCH_INSTALLED
                val visibleDestinations = remember(state) {
                    BottomBarDestination.entries.filter { destination ->
                        !(destination.kPatchRequired && !kPatchReady) && !(destination.aPatchRequired && !aPatchReady)
                    }.toSet()
                }

                val defaultTransitions = object : NavHostAnimatedDestinationStyle() {
                    override val enterTransition: AnimatedContentTransitionScope<NavBackStackEntry>.() -> EnterTransition =
                        {
                            // If the target is a detail page (not a bottom navigation page), slide in from the right
                            if (targetState.destination.route !in bottomBarRoutes) {
                                slideInHorizontally(initialOffsetX = { it })
                            } else {
                                // Otherwise (switching between bottom navigation pages), use fade in
                                fadeIn(animationSpec = tween(340))
                            }
                        }

                    override val exitTransition: AnimatedContentTransitionScope<NavBackStackEntry>.() -> ExitTransition =
                        {
                            // If navigating from the home page (bottom navigation page) to a detail page, slide out to the left
                            if (initialState.destination.route in bottomBarRoutes && targetState.destination.route !in bottomBarRoutes) {
                                slideOutHorizontally(targetOffsetX = { -it / 4 }) + fadeOut()
                            } else {
                                // Otherwise (switching between bottom navigation pages), use fade out
                                fadeOut(animationSpec = tween(340))
                            }
                        }

                    override val popEnterTransition: AnimatedContentTransitionScope<NavBackStackEntry>.() -> EnterTransition =
                        {
                            // If returning to the home page (bottom navigation page), slide in from the left
                            if (targetState.destination.route in bottomBarRoutes) {
                                slideInHorizontally(initialOffsetX = { -it / 4 }) + fadeIn()
                            } else {
                                // Otherwise (e.g., returning between multiple detail pages), use default fade in
                                fadeIn(animationSpec = tween(340))
                            }
                        }

                    override val popExitTransition: AnimatedContentTransitionScope<NavBackStackEntry>.() -> ExitTransition =
                        {
                            // If returning from a detail page (not a bottom navigation page), scale down and fade out
                            if (initialState.destination.route !in bottomBarRoutes) {
                                scaleOut(targetScale = 0.9f) + fadeOut()
                            } else {
                                // Otherwise, use default fade out
                                fadeOut(animationSpec = tween(340))
                            }
                        }
                }

                LaunchedEffect(Unit) {
                    if (SuperUserViewModel.apps.isEmpty()) {
                        SuperUserViewModel().fetchAppList()
                    }
                }

                Scaffold(
                    bottomBar = {
                        if (configuration.orientation == Configuration.ORIENTATION_PORTRAIT) {
                            BottomBar(navController, visibleDestinations)
                        }
                    },
                    contentWindowInsets = WindowInsets(0, 0, 0, 0)
                ) { innerPadding ->
                    CompositionLocalProvider(
                        LocalSnackbarHost provides snackBarHostState,
                    ) {
                        if (configuration.orientation == Configuration.ORIENTATION_LANDSCAPE) {
                            Row(modifier = Modifier.fillMaxSize().windowInsetsPadding(WindowInsets.systemBars.only(WindowInsetsSides.Horizontal))) {
                                SideBar(
                                    navController = navController,
                                    modifier = Modifier.windowInsetsPadding(WindowInsets.systemBars.only(WindowInsetsSides.Top)),
                                    visibleDestinations = visibleDestinations
                                )
                                DestinationsNavHost(
                                    modifier = Modifier
                                        .weight(1f)
                                        .consumeWindowInsets(WindowInsets.safeDrawing.only(WindowInsetsSides.Start)),
                                    navGraph = NavGraphs.root,
                                    navController = navController,
                                    engine = rememberNavHostEngine(navHostContentAlignment = Alignment.TopCenter),
                                    defaultTransitions = defaultTransitions
                                )
                            }
                        } else {
                            DestinationsNavHost(
                                modifier = Modifier.padding(innerPadding).consumeWindowInsets(innerPadding),
                                navGraph = NavGraphs.root,
                                navController = navController,
                                engine = rememberNavHostEngine(navHostContentAlignment = Alignment.TopCenter),
                                defaultTransitions = defaultTransitions
                            )
                        }
                    }
                }
            }
        }

        // Initialize Coil
        val iconSize = resources.getDimensionPixelSize(android.R.dimen.app_icon_size)
        Coil.setImageLoader(
            ImageLoader.Builder(this)
                .components {
                    add(AppIconKeyer())
                    add(AppIconFetcher.Factory(iconSize, false, this@MainActivity))
                }
                .build()
        )

        isLoading = false
    }
}

@Composable
private fun BottomBar(navController: NavHostController, visibleDestinations: Set<BottomBarDestination>) {
    val navigator = navController.rememberDestinationsNavigator()

    Crossfade(
        targetState = visibleDestinations,
        label = "BottomBarStateCrossfade"
    ) { visibleDestinations ->
        NavigationBar(tonalElevation = 8.dp) {
            visibleDestinations.forEach { destination ->
                val isCurrentDestOnBackStack by navController.isRouteOnBackStackAsState(destination.direction)

                NavigationBarItem(
                    selected = isCurrentDestOnBackStack,
                    onClick = {
                        if (isCurrentDestOnBackStack) {
                            navigator.popBackStack(destination.direction, false)
                        }
                        navigator.navigate(destination.direction) {
                            popUpTo(NavGraphs.root) {
                                saveState = true
                            }
                            launchSingleTop = true
                            restoreState = true
                        }
                    },
                    icon = {
                        if (isCurrentDestOnBackStack) {
                            Icon(destination.iconSelected, stringResource(destination.label))
                        } else {
                            Icon(destination.iconNotSelected, stringResource(destination.label))
                        }
                    },
                    label = {
                        Text(
                            text = stringResource(destination.label),
                            overflow = TextOverflow.Visible,
                            maxLines = 1,
                            softWrap = false
                        )
                    },
                    alwaysShowLabel = false
                )
            }
        }
    }
}

@Composable
private fun SideBar(navController: NavHostController, modifier: Modifier = Modifier, visibleDestinations: Set<BottomBarDestination>) {
    val navigator = navController.rememberDestinationsNavigator()

    Crossfade(
        targetState = visibleDestinations,
        label = "SideBarStateCrossfade"
    ) { visibleDestinations ->
        NavigationRail(
            modifier = modifier,
            containerColor = MaterialTheme.colorScheme.background,
        ) {
            Column(
                modifier = Modifier.fillMaxHeight(),
                verticalArrangement = Arrangement.spacedBy(8.dp, Alignment.CenterVertically)
            ) {
                visibleDestinations.forEach { destination ->
                    val isCurrentDestOnBackStack by navController.isRouteOnBackStackAsState(destination.direction)
                    NavigationRailItem(
                        selected = isCurrentDestOnBackStack,
                        onClick = {
                            if (isCurrentDestOnBackStack) {
                                navigator.popBackStack(destination.direction, false)
                            }
                            navigator.navigate(destination.direction) {
                                popUpTo(NavGraphs.root) {
                                    saveState = true
                                }
                                launchSingleTop = true
                                restoreState = true
                            }
                        },
                        icon = {
                            if (isCurrentDestOnBackStack) {
                                Icon(destination.iconSelected, stringResource(destination.label))
                            } else {
                                Icon(destination.iconNotSelected, stringResource(destination.label))
                            }
                        },
                        label = { Text(stringResource(destination.label)) },
                        alwaysShowLabel = false,
                        modifier = Modifier.padding(start = 8.dp)
                    )
                }
            }
        }
    }
}

```

`app/src/main/java/me/bmax/apatch/ui/WebUIActivity.kt`:

```kt
package me.bmax.apatch.ui

import android.annotation.SuppressLint
import android.app.ActivityManager
import android.content.ActivityNotFoundException
import android.content.Intent
import android.graphics.Color
import android.net.Uri
import android.os.Build
import android.os.Bundle
import android.view.ViewGroup
import android.webkit.ValueCallback
import android.webkit.WebChromeClient
import android.webkit.WebResourceRequest
import android.webkit.WebResourceResponse
import android.webkit.WebView
import android.webkit.WebViewClient
import android.widget.FrameLayout
import androidx.activity.ComponentActivity
import androidx.activity.compose.setContent
import androidx.activity.enableEdgeToEdge
import androidx.activity.result.ActivityResultLauncher
import androidx.activity.result.contract.ActivityResultContracts
import androidx.compose.foundation.background
import androidx.compose.foundation.layout.Box
import androidx.compose.foundation.layout.fillMaxSize
import androidx.compose.material3.CircularProgressIndicator
import androidx.compose.material3.MaterialTheme
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.core.view.ViewCompat
import androidx.core.view.WindowInsetsCompat
import androidx.lifecycle.lifecycleScope
import androidx.webkit.WebViewAssetLoader
import kotlinx.coroutines.CancellableContinuation
import kotlinx.coroutines.launch
import kotlinx.coroutines.suspendCancellableCoroutine
import me.bmax.apatch.APApplication
import me.bmax.apatch.ui.theme.APatchTheme
import me.bmax.apatch.ui.viewmodel.SuperUserViewModel
import me.bmax.apatch.ui.webui.AppIconUtil
import me.bmax.apatch.ui.webui.Insets
import me.bmax.apatch.ui.webui.SuFilePathHandler
import me.bmax.apatch.ui.webui.WebViewInterface
import java.io.File

@SuppressLint("SetJavaScriptEnabled")
class WebUIActivity : ComponentActivity() {
    private lateinit var webViewInterface: WebViewInterface
    private var webView: WebView? = null
    private lateinit var container: FrameLayout
    private lateinit var insets: Insets
    private var insetsContinuation: CancellableContinuation<Unit>? = null
    private var isInsetsEnabled = false
    private lateinit var fileChooserLauncher: ActivityResultLauncher<Intent>
    private var filePathCallback: ValueCallback<Array<Uri>>? = null

    override fun onCreate(savedInstanceState: Bundle?) {

        enableEdgeToEdge()
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.Q) {
            window.isNavigationBarContrastEnforced = false
        }

        super.onCreate(savedInstanceState)

        setContent {
            APatchTheme {
                Box(
                    modifier = Modifier.fillMaxSize().background(MaterialTheme.colorScheme.background),
                    contentAlignment = Alignment.Center
                ) {
                    CircularProgressIndicator()
                }
            }
        }

        lifecycleScope.launch {
            if (SuperUserViewModel.apps.isEmpty()) {
                SuperUserViewModel().fetchAppList()
            }
            setupWebView()
        }

        fileChooserLauncher = registerForActivityResult(
            ActivityResultContracts.StartActivityForResult()
        ) { result ->
            val uris: Array<Uri>? = when (result.resultCode) {
                RESULT_OK -> result.data?.let { data ->
                    when {
                        data.clipData != null -> {
                            Array(data.clipData!!.itemCount) { i ->
                                data.clipData!!.getItemAt(i).uri // Multiple files
                            }
                        }
                        data.data != null -> { arrayOf(data.data!!) } // Single file
                        else -> null
                    }
                }
                else -> null
            }
            filePathCallback?.onReceiveValue(uris)
            filePathCallback = null
        }
    }

    private suspend fun setupWebView() {
        val moduleId = intent.getStringExtra("id")!!
        val name = intent.getStringExtra("name")!!
        if (Build.VERSION.SDK_INT < Build.VERSION_CODES.TIRAMISU) {
            @Suppress("DEPRECATION")
            setTaskDescription(ActivityManager.TaskDescription("APatch - $name"))
        } else {
            val taskDescription = ActivityManager.TaskDescription.Builder().setLabel("APatch - $name").build()
            setTaskDescription(taskDescription)
        }

        val prefs = APApplication.sharedPreferences
        WebView.setWebContentsDebuggingEnabled(prefs.getBoolean("enable_web_debugging", false))

        val webRoot = File("/data/adb/modules/${moduleId}/webroot")
        insets = Insets(0, 0, 0, 0)

        container = FrameLayout(this).apply {
            layoutParams = ViewGroup.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.MATCH_PARENT)
        }

        this.webView = WebView(this).apply {
            setBackgroundColor(Color.TRANSPARENT)
        }

        val density = resources.displayMetrics.density
        ViewCompat.setOnApplyWindowInsetsListener(container) { view, windowInsets ->
            val inset = windowInsets.getInsets(WindowInsetsCompat.Type.systemBars() or WindowInsetsCompat.Type.displayCutout())
            insets = Insets(
                top = (inset.top / density).toInt(),
                bottom = (inset.bottom / density).toInt(),
                left = (inset.left / density).toInt(),
                right = (inset.right / density).toInt()
            )
            if (isInsetsEnabled) {
                view.setPadding(0, 0, 0, 0)
            } else {
                view.setPadding(inset.left, inset.top, inset.right, inset.bottom)
            }
            insetsContinuation?.resumeWith(Result.success(Unit))
            insetsContinuation = null
            WindowInsetsCompat.CONSUMED
        }
        container.addView(this.webView)

        suspendCancellableCoroutine { cont ->
            insetsContinuation = cont
            cont.invokeOnCancellation {
                insetsContinuation = null
            }
            setContentView(container)

            if (insets != Insets(0, 0, 0, 0)) {
                cont.resumeWith(Result.success(Unit))
                insetsContinuation = null
            }
        }

        val webViewAssetLoader = WebViewAssetLoader.Builder()
            .setDomain("mui.kernelsu.org")
            .addPathHandler(
                "/",
                SuFilePathHandler(this, webRoot, { insets }, { enable -> enableInsets(enable) })
            )
            .build()

        val webViewClient = object : WebViewClient() {
            override fun shouldInterceptRequest(
                view: WebView,
                request: WebResourceRequest
            ): WebResourceResponse? {
                val url = request.url

                // Handle ksu://icon/[packageName] to serve app icon via WebView
                if (url.scheme.equals("ksu", ignoreCase = true) && url.host.equals("icon", ignoreCase = true)) {
                    val packageName = url.path?.substring(1)
                    if (!packageName.isNullOrEmpty()) {
                        val icon = AppIconUtil.loadAppIconSync(this@WebUIActivity, packageName, 512)
                        if (icon != null) {
                            val stream = java.io.ByteArrayOutputStream()
                            icon.compress(android.graphics.Bitmap.CompressFormat.PNG, 100, stream)
                            val inputStream = java.io.ByteArrayInputStream(stream.toByteArray())
                            return WebResourceResponse("image/png", null, inputStream)
                        }
                    }
                }

                return webViewAssetLoader.shouldInterceptRequest(url)
            }
        }

        webView?.apply {
            settings.javaScriptEnabled = true
            settings.domStorageEnabled = true
            settings.allowFileAccess = false
            webViewInterface = WebViewInterface(this@WebUIActivity, this)
            addJavascriptInterface(webViewInterface, "ksu")
            setWebViewClient(webViewClient)
            webChromeClient = object : WebChromeClient() {
                override fun onShowFileChooser(
                    webView: WebView?,
                    filePathCallback: ValueCallback<Array<Uri>>?,
                    fileChooserParams: FileChooserParams?
                ): Boolean {
                    this@WebUIActivity.filePathCallback?.onReceiveValue(null)
                    this@WebUIActivity.filePathCallback = filePathCallback
                    val intent = fileChooserParams?.createIntent() ?: Intent(Intent.ACTION_GET_CONTENT).apply { type = "*/*" }
                    if (fileChooserParams?.mode == FileChooserParams.MODE_OPEN_MULTIPLE) {
                        intent.putExtra(Intent.EXTRA_ALLOW_MULTIPLE, true)
                    }
                    try {
                        fileChooserLauncher.launch(intent)
                    } catch (_: ActivityNotFoundException) {
                        filePathCallback?.onReceiveValue(null)
                        this@WebUIActivity.filePathCallback = null
                        return false
                    }
                    return true
                }
            }
            loadUrl("https://mui.kernelsu.org/index.html")
        }
    }

    fun enableInsets(enable: Boolean = true) {
        runOnUiThread {
            if (isInsetsEnabled != enable) {
                isInsetsEnabled = enable
                ViewCompat.requestApplyInsets(container)
            }
        }
    }
}
```

`app/src/main/java/me/bmax/apatch/ui/component/Dialog.kt`:

```kt
package me.bmax.apatch.ui.component

import android.graphics.text.LineBreaker
import android.os.Build
import android.os.Parcelable
import android.text.Layout
import android.text.method.LinkMovementMethod
import android.util.Log
import android.view.ViewGroup
import android.widget.TextView
import androidx.compose.foundation.layout.Arrangement
import androidx.compose.foundation.layout.Box
import androidx.compose.foundation.layout.Column
import androidx.compose.foundation.layout.PaddingValues
import androidx.compose.foundation.layout.Row
import androidx.compose.foundation.layout.fillMaxWidth
import androidx.compose.foundation.layout.padding
import androidx.compose.foundation.layout.size
import androidx.compose.foundation.layout.width
import androidx.compose.foundation.layout.wrapContentHeight
import androidx.compose.foundation.shape.RoundedCornerShape
import androidx.compose.material3.AlertDialogDefaults
import androidx.compose.material3.BasicAlertDialog
import androidx.compose.material3.CircularProgressIndicator
import androidx.compose.material3.ExperimentalMaterial3Api
import androidx.compose.material3.LocalContentColor
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.Surface
import androidx.compose.material3.Text
import androidx.compose.material3.TextButton
import androidx.compose.runtime.Composable
import androidx.compose.runtime.MutableState
import androidx.compose.runtime.getValue
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.remember
import androidx.compose.runtime.rememberCoroutineScope
import androidx.compose.runtime.rememberUpdatedState
import androidx.compose.runtime.saveable.Saver
import androidx.compose.runtime.saveable.rememberSaveable
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.graphics.toArgb
import androidx.compose.ui.platform.LocalView
import androidx.compose.ui.res.stringResource
import androidx.compose.ui.unit.dp
import androidx.compose.ui.viewinterop.AndroidView
import androidx.compose.ui.window.Dialog
import androidx.compose.ui.window.DialogProperties
import androidx.compose.ui.window.DialogWindowProvider
import androidx.compose.ui.window.SecureFlagPolicy
import io.noties.markwon.Markwon
import io.noties.markwon.utils.NoCopySpannableFactory
import kotlinx.coroutines.CancellableContinuation
import kotlinx.coroutines.CoroutineScope
import kotlinx.coroutines.async
import kotlinx.coroutines.channels.Channel
import kotlinx.coroutines.channels.ReceiveChannel
import kotlinx.coroutines.flow.FlowCollector
import kotlinx.coroutines.flow.consumeAsFlow
import kotlinx.coroutines.flow.onEach
import kotlinx.coroutines.launch
import kotlinx.coroutines.suspendCancellableCoroutine
import kotlinx.parcelize.Parcelize
import me.bmax.apatch.util.ui.APDialogBlurBehindUtils.Companion.setupWindowBlurListener
import kotlin.coroutines.resume

private const val TAG = "DialogComponent"

interface ConfirmDialogVisuals : Parcelable {
    val title: String
    val content: String
    val isMarkdown: Boolean
    val confirm: String?
    val dismiss: String?
}

@Parcelize
private data class ConfirmDialogVisualsImpl(
    override val title: String,
    override val content: String,
    override val isMarkdown: Boolean,
    override val confirm: String?,
    override val dismiss: String?,
) : ConfirmDialogVisuals {
    companion object {
        val Empty: ConfirmDialogVisuals = ConfirmDialogVisualsImpl("", "", false, null, null)
    }
}

interface DialogHandle {
    val isShown: Boolean
    val dialogType: String
    fun show()
    fun hide()
}

interface LoadingDialogHandle : DialogHandle {
    suspend fun <R> withLoading(block: suspend () -> R): R
    fun showLoading()
}

sealed interface ConfirmResult {
    data object Confirmed : ConfirmResult
    data object Canceled : ConfirmResult
}

interface ConfirmDialogHandle : DialogHandle {
    val visuals: ConfirmDialogVisuals

    fun showConfirm(
        title: String,
        content: String,
        markdown: Boolean = false,
        confirm: String? = null,
        dismiss: String? = null
    )

    suspend fun awaitConfirm(
        title: String,
        content: String,
        markdown: Boolean = false,
        confirm: String? = null,
        dismiss: String? = null
    ): ConfirmResult
}

private abstract class DialogHandleBase(
    protected val visible: MutableState<Boolean>,
    protected val coroutineScope: CoroutineScope
) : DialogHandle {
    override val isShown: Boolean
        get() = visible.value

    override fun show() {
        coroutineScope.launch {
            visible.value = true
        }
    }

    final override fun hide() {
        coroutineScope.launch {
            visible.value = false
        }
    }

    override fun toString(): String {
        return dialogType
    }
}

private class LoadingDialogHandleImpl(
    visible: MutableState<Boolean>,
    coroutineScope: CoroutineScope
) : LoadingDialogHandle, DialogHandleBase(visible, coroutineScope) {
    override suspend fun <R> withLoading(block: suspend () -> R): R {
        return coroutineScope.async {
            try {
                visible.value = true
                block()
            } finally {
                visible.value = false
            }
        }.await()
    }

    override fun showLoading() {
        show()
    }

    override val dialogType: String get() = "LoadingDialog"
}

typealias NullableCallback = (() -> Unit)?

interface ConfirmCallback {

    val onConfirm: NullableCallback

    val onDismiss: NullableCallback

    val isEmpty: Boolean get() = onConfirm == null && onDismiss == null

    companion object {
        operator fun invoke(
            onConfirmProvider: () -> NullableCallback,
            onDismissProvider: () -> NullableCallback
        ): ConfirmCallback {
            return object : ConfirmCallback {
                override val onConfirm: NullableCallback
                    get() = onConfirmProvider()
                override val onDismiss: NullableCallback
                    get() = onDismissProvider()
            }
        }
    }
}

private class ConfirmDialogHandleImpl(
    visible: MutableState<Boolean>,
    coroutineScope: CoroutineScope,
    callback: ConfirmCallback,
    override var visuals: ConfirmDialogVisuals = ConfirmDialogVisualsImpl.Empty,
    private val resultFlow: ReceiveChannel<ConfirmResult>
) : ConfirmDialogHandle, DialogHandleBase(visible, coroutineScope) {
    private class ResultCollector(
        private val callback: ConfirmCallback
    ) : FlowCollector<ConfirmResult> {
        fun handleResult(result: ConfirmResult) {
            Log.d(TAG, "handleResult: ${result.javaClass.simpleName}")
            when (result) {
                ConfirmResult.Confirmed -> onConfirm()
                ConfirmResult.Canceled -> onDismiss()
            }
        }

        fun onConfirm() {
            callback.onConfirm?.invoke()
        }

        fun onDismiss() {
            callback.onDismiss?.invoke()
        }

        override suspend fun emit(value: ConfirmResult) {
            handleResult(value)
        }
    }

    private val resultCollector = ResultCollector(callback)

    private var awaitContinuation: CancellableContinuation<ConfirmResult>? = null

    private val isCallbackEmpty = callback.isEmpty

    init {
        coroutineScope.launch {
            resultFlow
                .consumeAsFlow()
                .onEach { result ->
                    awaitContinuation?.let {
                        awaitContinuation = null
                        if (it.isActive) {
                            it.resume(result)
                        }
                    }
                }
                .onEach { hide() }
                .collect(resultCollector)
        }
    }

    private suspend fun awaitResult(): ConfirmResult {
        return suspendCancellableCoroutine {
            awaitContinuation = it.apply {
                if (isCallbackEmpty) {
                    invokeOnCancellation {
                        visible.value = false
                    }
                }
            }
        }
    }

    fun updateVisuals(visuals: ConfirmDialogVisuals) {
        this.visuals = visuals
    }

    override fun show() {
        if (visuals !== ConfirmDialogVisualsImpl.Empty) {
            super.show()
        } else {
            throw UnsupportedOperationException("can't show confirm dialog with the Empty visuals")
        }
    }

    override fun showConfirm(
        title: String,
        content: String,
        markdown: Boolean,
        confirm: String?,
        dismiss: String?
    ) {
        coroutineScope.launch {
            updateVisuals(ConfirmDialogVisualsImpl(title, content, markdown, confirm, dismiss))
            show()
        }
    }

    override suspend fun awaitConfirm(
        title: String,
        content: String,
        markdown: Boolean,
        confirm: String?,
        dismiss: String?
    ): ConfirmResult {
        coroutineScope.launch {
            updateVisuals(ConfirmDialogVisualsImpl(title, content, markdown, confirm, dismiss))
            show()
        }
        return awaitResult()
    }

    override val dialogType: String get() = "ConfirmDialog"

    override fun toString(): String {
        return "${super.toString()}(visuals: $visuals)"
    }

    companion object {
        fun Saver(
            visible: MutableState<Boolean>,
            coroutineScope: CoroutineScope,
            callback: ConfirmCallback,
            resultChannel: ReceiveChannel<ConfirmResult>
        ) = Saver<ConfirmDialogHandle, ConfirmDialogVisuals>(
            save = {
                it.visuals
            },
            restore = {
                Log.d(TAG, "ConfirmDialog restore, visuals: $it")
                ConfirmDialogHandleImpl(visible, coroutineScope, callback, it, resultChannel)
            }
        )
    }
}

private class CustomDialogHandleImpl(
    visible: MutableState<Boolean>,
    coroutineScope: CoroutineScope
) : DialogHandleBase(visible, coroutineScope) {
    override val dialogType: String get() = "CustomDialog"
}

@Composable
fun rememberLoadingDialog(): LoadingDialogHandle {
    val visible = remember {
        mutableStateOf(false)
    }
    val coroutineScope = rememberCoroutineScope()

    if (visible.value) {
        LoadingDialog()
    }

    return remember {
        LoadingDialogHandleImpl(visible, coroutineScope)
    }
}

@Composable
private fun rememberConfirmDialog(
    visuals: ConfirmDialogVisuals,
    callback: ConfirmCallback
): ConfirmDialogHandle {
    val visible = rememberSaveable {
        mutableStateOf(false)
    }
    val coroutineScope = rememberCoroutineScope()
    val resultChannel = remember {
        Channel<ConfirmResult>()
    }

    val handle = rememberSaveable(
        saver = ConfirmDialogHandleImpl.Saver(visible, coroutineScope, callback, resultChannel),
        init = {
            ConfirmDialogHandleImpl(visible, coroutineScope, callback, visuals, resultChannel)
        }
    )

    if (visible.value) {
        ConfirmDialog(
            handle.visuals,
            confirm = { coroutineScope.launch { resultChannel.send(ConfirmResult.Confirmed) } },
            dismiss = { coroutineScope.launch { resultChannel.send(ConfirmResult.Canceled) } }
        )
    }

    return handle
}

@Composable
fun rememberConfirmCallback(
    onConfirm: NullableCallback,
    onDismiss: NullableCallback
): ConfirmCallback {
    val currentOnConfirm by rememberUpdatedState(newValue = onConfirm)
    val currentOnDismiss by rememberUpdatedState(newValue = onDismiss)
    return remember {
        ConfirmCallback({ currentOnConfirm }, { currentOnDismiss })
    }
}

@Composable
fun rememberConfirmDialog(
    onConfirm: NullableCallback = null,
    onDismiss: NullableCallback = null
): ConfirmDialogHandle {
    return rememberConfirmDialog(rememberConfirmCallback(onConfirm, onDismiss))
}

@Composable
fun rememberConfirmDialog(callback: ConfirmCallback): ConfirmDialogHandle {
    return rememberConfirmDialog(ConfirmDialogVisualsImpl.Empty, callback)
}

@Composable
fun rememberCustomDialog(composable: @Composable (dismiss: () -> Unit) -> Unit): DialogHandle {
    val visible = rememberSaveable {
        mutableStateOf(false)
    }
    val coroutineScope = rememberCoroutineScope()
    if (visible.value) {
        composable { visible.value = false }
    }
    return remember {
        CustomDialogHandleImpl(visible, coroutineScope)
    }
}

@Composable
private fun LoadingDialog() {
    Dialog(
        onDismissRequest = {},
        properties = DialogProperties(
            dismissOnClickOutside = false,
            dismissOnBackPress = false,
            usePlatformDefaultWidth = false
        )
    ) {
        Surface(
            modifier = Modifier.size(100.dp), shape = RoundedCornerShape(8.dp)
        ) {
            Box(
                contentAlignment = Alignment.Center,
            ) {
                CircularProgressIndicator()
            }
        }
        val dialogWindowProvider = LocalView.current.parent as DialogWindowProvider
        setupWindowBlurListener(dialogWindowProvider.window)
    }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
private fun ConfirmDialog(visuals: ConfirmDialogVisuals, confirm: () -> Unit, dismiss: () -> Unit) {
    BasicAlertDialog(
        onDismissRequest = {
            dismiss()
        },
        properties = DialogProperties(
            decorFitsSystemWindows = true,
            usePlatformDefaultWidth = false,
            securePolicy = SecureFlagPolicy.SecureOff
        )
    ) {
        Surface(
            modifier = Modifier
                .width(320.dp)
                .wrapContentHeight(),
            shape = RoundedCornerShape(20.dp),
            tonalElevation = AlertDialogDefaults.TonalElevation,
            color = AlertDialogDefaults.containerColor,
        ) {
            Column(modifier = Modifier.padding(PaddingValues(all = 24.dp))) {
                Box(
                    Modifier
                        .padding(PaddingValues(bottom = 16.dp))
                        .align(Alignment.Start)
                ) {
                    Text(text = visuals.title, style = MaterialTheme.typography.headlineSmall)
                }
                Box(
                    Modifier
                        .weight(weight = 1f, fill = false)
                        .padding(PaddingValues(bottom = 24.dp))
                        .align(Alignment.Start)
                ) {

                    if (visuals.isMarkdown) {
                        MarkdownContent(content = visuals.content)
                    } else {
                        Text(text = visuals.content, style = MaterialTheme.typography.bodyMedium)
                    }
                }
                Row(
                    modifier = Modifier.fillMaxWidth(),
                    horizontalArrangement = Arrangement.End
                ) {
                    TextButton(onClick = dismiss) {
                        Text(text = visuals.dismiss ?: stringResource(id = android.R.string.cancel))
                    }

                    TextButton(onClick = confirm) {
                        Text(text = visuals.confirm ?: stringResource(id = android.R.string.ok))
                    }
                }
            }
            val dialogWindowProvider = LocalView.current.parent as DialogWindowProvider
            setupWindowBlurListener(dialogWindowProvider.window)
        }
    }

}

@Composable
private fun MarkdownContent(content: String) {
    val contentColor = LocalContentColor.current

    AndroidView(
        factory = { context ->
            TextView(context).apply {
                movementMethod = LinkMovementMethod.getInstance()
                setSpannableFactory(NoCopySpannableFactory.getInstance())
                if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.Q) {
                    breakStrategy = LineBreaker.BREAK_STRATEGY_SIMPLE
                    hyphenationFrequency = Layout.HYPHENATION_FREQUENCY_NONE
                }

                layoutParams = ViewGroup.LayoutParams(
                    ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.WRAP_CONTENT
                )
            }
        },
        modifier = Modifier
            .fillMaxWidth()
            .wrapContentHeight(),
        update = {
            Markwon.create(it.context).setMarkdown(it, content)
            it.setTextColor(contentColor.toArgb())
        }
    )
}
```

`app/src/main/java/me/bmax/apatch/ui/component/DropdownMenu.kt`:

```kt
package me.bmax.apatch.ui.component

import androidx.compose.foundation.shape.CornerBasedShape
import androidx.compose.foundation.shape.RoundedCornerShape
import androidx.compose.material3.MaterialTheme
import androidx.compose.runtime.Composable
import androidx.compose.ui.unit.dp

@Composable
fun ProvideMenuShape(
    value: CornerBasedShape = RoundedCornerShape(8.dp), content: @Composable () -> Unit
) = MaterialTheme(
    shapes = MaterialTheme.shapes.copy(extraSmall = value), content = content
)
```

`app/src/main/java/me/bmax/apatch/ui/component/KeyEventBlocker.kt`:

```kt
package me.bmax.apatch.ui.component

import androidx.compose.foundation.focusable
import androidx.compose.foundation.layout.Box
import androidx.compose.runtime.Composable
import androidx.compose.runtime.LaunchedEffect
import androidx.compose.runtime.remember
import androidx.compose.ui.Modifier
import androidx.compose.ui.focus.FocusRequester
import androidx.compose.ui.focus.focusRequester
import androidx.compose.ui.input.key.KeyEvent
import androidx.compose.ui.input.key.onKeyEvent

@Composable
fun KeyEventBlocker(predicate: (KeyEvent) -> Boolean) {
    val requester = remember { FocusRequester() }
    Box(
        Modifier
            .onKeyEvent {
                predicate(it)
            }
            .focusRequester(requester)
            .focusable()
    )
    LaunchedEffect(Unit) {
        requester.requestFocus()
    }
}
```

`app/src/main/java/me/bmax/apatch/ui/component/ModuleCardComponents.kt`:

```kt
package me.bmax.apatch.ui.component

import androidx.annotation.DrawableRes
import androidx.compose.foundation.Image
import androidx.compose.foundation.layout.PaddingValues
import androidx.compose.foundation.layout.Spacer
import androidx.compose.foundation.layout.requiredSize
import androidx.compose.foundation.layout.size
import androidx.compose.foundation.layout.width
import androidx.compose.material3.FilledTonalButton
import androidx.compose.material3.Icon
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.Text
import androidx.compose.runtime.Composable
import androidx.compose.ui.Modifier
import androidx.compose.ui.graphics.Color
import androidx.compose.ui.graphics.ColorFilter
import androidx.compose.ui.res.painterResource
import androidx.compose.ui.res.stringResource
import androidx.compose.ui.text.style.TextOverflow
import androidx.compose.ui.unit.dp
import me.bmax.apatch.R

@Composable
fun ModuleUpdateButton(
    onClick: () -> Unit
) = FilledTonalButton(
    onClick = onClick, enabled = true, contentPadding = PaddingValues(12.dp)
) {
    Icon(
        modifier = Modifier.size(20.dp),
        painter = painterResource(id = R.drawable.device_mobile_down),
        contentDescription = stringResource(id = R.string.apm_update)
    )
}

@Composable
fun ModuleRemoveButton(
    enabled: Boolean, onClick: () -> Unit
) = FilledTonalButton(
    onClick = onClick, enabled = enabled, contentPadding = PaddingValues(12.dp)
) {
    Icon(
        modifier = Modifier.size(20.dp),
        painter = painterResource(id = R.drawable.trash),
        contentDescription = stringResource(id = R.string.apm_remove)
    )
}

@Composable
fun KPModuleRemoveButton(
    enabled: Boolean, onClick: () -> Unit
) = FilledTonalButton(
    onClick = onClick, enabled = enabled, contentPadding = PaddingValues(12.dp)
) {
    Icon(
        modifier = Modifier.size(20.dp),
        painter = painterResource(id = R.drawable.trash),
        contentDescription = stringResource(id = R.string.kpm_unload)
    )
}

@Composable
fun ModuleStateIndicator(
    @DrawableRes icon: Int, color: Color = MaterialTheme.colorScheme.outline
) {
    Image(
        modifier = Modifier.requiredSize(150.dp),
        painter = painterResource(id = icon),
        contentDescription = null,
        alpha = 0.1f,
        colorFilter = ColorFilter.tint(color)
    )
}
```

`app/src/main/java/me/bmax/apatch/ui/component/SearchBar.kt`:

```kt
package me.bmax.apatch.ui.component

import androidx.activity.compose.BackHandler
import androidx.compose.animation.core.AnimationSpec
import androidx.compose.animation.core.DecayAnimationSpec
import androidx.compose.animation.rememberSplineBasedDecay
import androidx.compose.foundation.clickable
import androidx.compose.foundation.layout.ExperimentalLayoutApi
import androidx.compose.foundation.layout.Row
import androidx.compose.foundation.layout.Spacer
import androidx.compose.foundation.layout.WindowInsets
import androidx.compose.foundation.layout.WindowInsetsSides
import androidx.compose.foundation.layout.fillMaxWidth
import androidx.compose.foundation.layout.height
import androidx.compose.foundation.layout.isImeVisible
import androidx.compose.foundation.layout.only
import androidx.compose.foundation.layout.padding
import androidx.compose.foundation.layout.safeDrawing
import androidx.compose.foundation.layout.size
import androidx.compose.foundation.layout.statusBarsPadding
import androidx.compose.foundation.layout.width
import androidx.compose.foundation.shape.CircleShape
import androidx.compose.foundation.text.input.rememberTextFieldState
import androidx.compose.material.icons.Icons
import androidx.compose.material.icons.automirrored.outlined.ArrowBack
import androidx.compose.material.icons.automirrored.twotone.ArrowBack
import androidx.compose.material.icons.twotone.Search
import androidx.compose.material3.AppBarWithSearch
import androidx.compose.material3.ExperimentalMaterial3Api
import androidx.compose.material3.ExperimentalMaterial3ExpressiveApi
import androidx.compose.material3.Icon
import androidx.compose.material3.IconButton
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.MotionScheme
import androidx.compose.material3.SearchBarDefaults
import androidx.compose.material3.SearchBarScrollBehavior
import androidx.compose.material3.SearchBarValue
import androidx.compose.material3.Text
import androidx.compose.material3.rememberSearchBarState
import androidx.compose.runtime.Composable
import androidx.compose.runtime.DisposableEffect
import androidx.compose.runtime.LaunchedEffect
import androidx.compose.runtime.getValue
import androidx.compose.runtime.mutableFloatStateOf
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.remember
import androidx.compose.runtime.rememberCoroutineScope
import androidx.compose.runtime.saveable.Saver
import androidx.compose.runtime.saveable.listSaver
import androidx.compose.runtime.saveable.rememberSaveable
import androidx.compose.runtime.setValue
import androidx.compose.ui.Modifier
import androidx.compose.ui.draw.clip
import androidx.compose.ui.focus.FocusRequester
import androidx.compose.ui.focus.focusRequester
import androidx.compose.ui.geometry.Offset
import androidx.compose.ui.input.nestedscroll.NestedScrollConnection
import androidx.compose.ui.input.nestedscroll.NestedScrollSource
import androidx.compose.ui.layout.onSizeChanged
import androidx.compose.ui.platform.LocalFocusManager
import androidx.compose.ui.platform.LocalSoftwareKeyboardController
import androidx.compose.ui.res.stringResource
import androidx.compose.ui.semantics.clearAndSetSemantics
import androidx.compose.ui.tooling.preview.Preview
import androidx.compose.ui.unit.dp
import kotlinx.coroutines.launch
import me.bmax.apatch.R

@OptIn(ExperimentalMaterial3ExpressiveApi::class)
@ExperimentalMaterial3Api
@Composable
fun pinnedScrollBehavior(
    canScroll: () -> Boolean = { true },
    snapAnimationSpec: AnimationSpec<Float> = MotionScheme.expressive().defaultEffectsSpec(),
    flingAnimationSpec: DecayAnimationSpec<Float> = rememberSplineBasedDecay(),
    reverseLayout: Boolean = false,
): SearchBarScrollBehavior =
    rememberSaveable(
        snapAnimationSpec,
        flingAnimationSpec,
        canScroll,
        reverseLayout,
        saver =
            PinnedScrollBehavior.Saver(
                canScroll = canScroll,
            ),
    ) {
        PinnedScrollBehavior(
            canScroll = canScroll,
        )
    }

@OptIn(ExperimentalMaterial3Api::class)
private class PinnedScrollBehavior(
    val canScroll: () -> Boolean,
) : SearchBarScrollBehavior {
    // Offset remains 0 so the bar never moves vertically
    override var scrollOffset by mutableFloatStateOf(0f)
    override var scrollOffsetLimit by mutableFloatStateOf(0f)

    // Track contentOffset to allow for tonal elevation/color changes on scroll
    override var contentOffset by mutableFloatStateOf(0f)

    override fun Modifier.searchBarScrollBehavior(): Modifier {
        // We remove the .layout { ... } and .draggable blocks
        // that were responsible for hiding/moving the bar.
        return this.onSizeChanged { size ->
            scrollOffsetLimit = -size.height.toFloat()
        }
    }

    override val nestedScrollConnection: NestedScrollConnection =
        object : NestedScrollConnection {
            override fun onPreScroll(available: Offset, source: NestedScrollSource): Offset {
                if (!canScroll()) return Offset.Zero

                // We don't modify scrollOffset here because we want it pinned.
                // We only return Offset.Zero to show we aren't consuming any scroll.
                return Offset.Zero
            }

            override fun onPostScroll(
                consumed: Offset,
                available: Offset,
                source: NestedScrollSource,
            ): Offset {
                if (!canScroll()) return Offset.Zero

                // Update contentOffset so the UI knows how far the user has scrolled
                // This is used for "overlapped" state (changing colors/elevation)
                contentOffset += consumed.y
                return Offset.Zero
            }
        }
    companion object {
        fun Saver(
            canScroll: () -> Boolean
        ): Saver<PinnedScrollBehavior, *> =
            listSaver(
                save = {
                    listOf(
                        it.scrollOffset,
                        it.scrollOffsetLimit,
                        it.contentOffset,
                    )
                },
                restore = {
                    PinnedScrollBehavior(
                        canScroll = canScroll,
                    )
                },
            )
    }
}

@OptIn(ExperimentalMaterial3Api::class, ExperimentalLayoutApi::class)
@Composable
fun SearchAppBar(
    searchText: String,
    onSearchTextChange: (String) -> Unit,
    onBackClick: (() -> Unit)? = null,
    dropdownContent: @Composable (() -> Unit)? = null,
    navigationContent: @Composable (() -> Unit)? = null,
    scrollBehavior: SearchBarScrollBehavior? = null,
    searchBarPlaceHolderText: String
) {
    val textFieldState = rememberTextFieldState(initialText = searchText)
    val searchBarState = rememberSearchBarState()

    val scope = rememberCoroutineScope()
    val keyboardController = LocalSoftwareKeyboardController.current
    val focusManager = LocalFocusManager.current
    val focusRequester = remember { FocusRequester() }

    var isExpanded = searchBarState.currentValue == SearchBarValue.Expanded
    val isKeyboardVisible = WindowInsets.isImeVisible

    LaunchedEffect(isKeyboardVisible) {
        if (!isKeyboardVisible) {
            searchBarState.animateToCollapsed()
        }
    }

    BackHandler(isExpanded) {
        scope.launch { searchBarState.animateToCollapsed() }
        keyboardController?.hide()
        focusManager.clearFocus()
        isExpanded = false
    }

    LaunchedEffect(textFieldState.text) {
        onSearchTextChange(textFieldState.text.toString())
    }

    DisposableEffect(Unit) {
        onDispose { keyboardController?.hide() }
    }

    val colorScheme = MaterialTheme.colorScheme
    val cardColor = colorScheme.background

    AppBarWithSearch(
        state = searchBarState,
        inputField = {
            SearchBarDefaults.InputField(
                modifier = Modifier
                    .focusRequester(focusRequester)
                    .padding(bottom = 5.dp)
                    .clip(SearchBarDefaults.inputFieldShape)
                    .height(53.dp), // box padding + icon padding + icon size
                searchBarState = searchBarState,
                textFieldState = textFieldState,
                onSearch = { text ->
                    scope.launch { searchBarState.animateToCollapsed() }
                    keyboardController?.hide()
                    focusManager.clearFocus()
                    onSearchTextChange(text)
                },
                colors = SearchBarDefaults.inputFieldColors(
                    unfocusedContainerColor = MaterialTheme.colorScheme.surfaceContainerHigh,
                    focusedContainerColor = MaterialTheme.colorScheme.surfaceContainerHigh,
                ),
                placeholder = {
                    Text(
                        modifier = Modifier
                            .fillMaxWidth()
                            .clearAndSetSemantics {},
                        text = searchBarPlaceHolderText,
                        style = MaterialTheme.typography.bodyLarge,
                        color = MaterialTheme.colorScheme.onSurfaceVariant
                    )
                },
                leadingIcon = {
                    Row {
                        if (onBackClick == null && isExpanded) {
                            Icon(
                                imageVector = Icons.AutoMirrored.TwoTone.ArrowBack,
                                contentDescription = stringResource(R.string.back),
                                tint = MaterialTheme.colorScheme.onSurfaceVariant,
                                modifier = Modifier
                                    .padding(start = 8.dp)
                                    .size(40.dp)
                                    .clip(CircleShape)
                                    .clickable {
                                        if (textFieldState.text.isNotEmpty()) {
                                            textFieldState.edit {
                                                replace(0, length, "")
                                            }
                                            return@clickable
                                        }
                                        scope.launch {
                                            searchBarState.animateToCollapsed()
                                            keyboardController?.hide()
                                            focusManager.clearFocus()
                                        }
                                    }
                                    .padding(8.dp)
                            )
                        }
                        else {
                            Icon(
                                imageVector = Icons.TwoTone.Search,
                                contentDescription = stringResource(R.string.search),

                                tint = MaterialTheme.colorScheme.onSurfaceVariant,
                                modifier = Modifier
                                    .padding(start = 8.dp)
                                    .size(40.dp)
                                    .clip(CircleShape)
                                    .clickable {
                                        scope.launch {
                                            searchBarState.animateToExpanded()
                                            focusRequester.requestFocus()
                                            keyboardController?.show()
                                        }
                                    }
                                    .padding(8.dp)
                            )
                        }
                        Spacer(modifier = Modifier.width(3.dp))
                    }
                }
            )
        },
        navigationIcon = {
            if (onBackClick != null) {
                IconButton(onClick = {
                    if (isExpanded) {
                        if (textFieldState.text.isNotEmpty()) {
                            textFieldState.edit {
                                replace(0, length, "")
                            }
                        } else {
                            scope.launch {
                                searchBarState.animateToCollapsed()
                                keyboardController?.hide()
                                focusManager.clearFocus()
                            }
                        }
                        return@IconButton
                    }
                    onBackClick.invoke()
                }) {
                    Icon(
                        Icons.AutoMirrored.Outlined.ArrowBack,
                        contentDescription = stringResource(R.string.back)
                    )
                }
            } else {
                navigationContent?.invoke()
            }
        },
        actions = {
            dropdownContent?.invoke()
        },
        scrollBehavior = scrollBehavior,
        colors = SearchBarDefaults.appBarWithSearchColors(
            searchBarColors = SearchBarDefaults.colors(
                containerColor = cardColor.copy(alpha = 0f)
            ),
            scrolledSearchBarContainerColor = cardColor.copy(alpha = 0f),
            appBarContainerColor = cardColor.copy(alpha = 0f),
            scrolledAppBarContainerColor = cardColor.copy(alpha = 0f)
        )
    )
}

@OptIn(ExperimentalMaterial3Api::class)
@Preview
@Composable
private fun SearchAppBarPreview() {
    SearchAppBar(
        searchText = "",
        onSearchTextChange = {},
        searchBarPlaceHolderText = ""
    )
}
```

`app/src/main/java/me/bmax/apatch/ui/component/SettingsItem.kt`:

```kt
package me.bmax.apatch.ui.component

import androidx.compose.foundation.LocalIndication
import androidx.compose.foundation.interaction.MutableInteractionSource
import androidx.compose.foundation.selection.toggleable
import androidx.compose.material3.Icon
import androidx.compose.material3.ListItem
import androidx.compose.material3.LocalContentColor
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.RadioButton
import androidx.compose.material3.Switch
import androidx.compose.material3.Text
import androidx.compose.runtime.Composable
import androidx.compose.runtime.remember
import androidx.compose.ui.Modifier
import androidx.compose.ui.graphics.vector.ImageVector
import androidx.compose.ui.semantics.Role

@Composable
fun SwitchItem(
    icon: ImageVector? = null,
    title: String,
    summary: String? = null,
    checked: Boolean,
    enabled: Boolean = true,
    onCheckedChange: (Boolean) -> Unit
) {
    val interactionSource = remember { MutableInteractionSource() }

    ListItem(
        modifier = Modifier.toggleable(
            value = checked,
            interactionSource = interactionSource,
            role = Role.Switch,
            enabled = enabled,
            indication = LocalIndication.current,
            onValueChange = onCheckedChange
        ),
        headlineContent = {
            Text(
                title,
                style = MaterialTheme.typography.bodyLarge,
                color = LocalContentColor.current
            )
        },
        leadingContent = icon?.let {
            { Icon(icon, title) }
        },
        trailingContent = {
            Switch(
                checked = checked,
                enabled = enabled,
                onCheckedChange = onCheckedChange,
                interactionSource = interactionSource
            )
        },
        supportingContent = {
            if (summary != null) {
                Text(
                    summary,
                    style = MaterialTheme.typography.bodyMedium,
                    color = MaterialTheme.colorScheme.outline
                )
            }
        }
    )
}

@Composable
fun RadioItem(
    title: String,
    selected: Boolean,
    onClick: () -> Unit,
) {
    ListItem(
        headlineContent = {
            Text(title)
        },
        leadingContent = {
            RadioButton(selected = selected, onClick = onClick)
        },
    )
}

```

`app/src/main/java/me/bmax/apatch/ui/component/WarningCard.kt`:

```kt
package me.bmax.apatch.ui.component

import androidx.compose.foundation.clickable
import androidx.compose.foundation.layout.Arrangement
import androidx.compose.foundation.layout.Box
import androidx.compose.foundation.layout.Column
import androidx.compose.foundation.layout.Row
import androidx.compose.foundation.layout.Spacer
import androidx.compose.foundation.layout.fillMaxWidth
import androidx.compose.foundation.layout.padding
import androidx.compose.foundation.layout.size
import androidx.compose.foundation.layout.width
import androidx.compose.foundation.layout.wrapContentHeight
import androidx.compose.material.icons.Icons
import androidx.compose.material.icons.filled.Close
import androidx.compose.material.icons.filled.Error
import androidx.compose.material3.CardDefaults
import androidx.compose.material3.ElevatedCard
import androidx.compose.material3.Icon
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.Text
import androidx.compose.runtime.Composable
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.graphics.Color
import androidx.compose.ui.res.stringResource
import androidx.compose.ui.tooling.preview.Preview
import androidx.compose.ui.unit.dp

@Composable
fun WarningCard(
    message: String,
    color: Color? = null,
    onClick: (() -> Unit)? = null,
    onClose: (() -> Unit)? = null,
    icon: (@Composable () -> Unit)? = null
) {
    val cardColors = CardDefaults.cardColors(
        containerColor = color ?: MaterialTheme.colorScheme.errorContainer,
        contentColor = MaterialTheme.colorScheme.onErrorContainer,
        disabledContainerColor = MaterialTheme.colorScheme.errorContainer,
        disabledContentColor = MaterialTheme.colorScheme.onErrorContainer
    )

    ElevatedCard(
        colors = cardColors,
    ) {
        Box(
            modifier = Modifier
                .fillMaxWidth()
                .then(onClick?.let { Modifier.clickable { it() } } ?: Modifier)
                .padding(20.dp)
        ) {
            Row(
                verticalAlignment = Alignment.CenterVertically,
                modifier = Modifier.fillMaxWidth().align(Alignment.CenterStart).padding(end = 40.dp)
            ) {
                if (icon != null) {
                    icon()
                } else {
                    Icon(
                        imageVector = Icons.Default.Error,
                        contentDescription = null,
                        tint = MaterialTheme.colorScheme.onErrorContainer,
                        modifier = Modifier.size(18.dp)
                    )
                }

                Spacer(modifier = Modifier.width(12.dp))

                Text(
                    text = message,
                    style = MaterialTheme.typography.bodyMedium,
                    modifier = Modifier
                        .wrapContentHeight(Alignment.CenterVertically)
                )
            }


            if (onClose != null) {
                Icon(
                    imageVector = Icons.Default.Close,
                    contentDescription = stringResource(android.R.string.cancel),
                    tint = MaterialTheme.colorScheme.onErrorContainer,
                    modifier = Modifier.clickable {
                        onClose()
                    }.size(18.dp).align(Alignment.TopEnd)
                )
            }
        }
    }
}

@Preview
@Composable
private fun WarningCardPreview() {
    Column(verticalArrangement = Arrangement.spacedBy(8.dp)) {
        WarningCard(message = "Warning message")
        WarningCard(message = "Warning message", onClose = {})
        WarningCard(
            message = "Warning message ",
            MaterialTheme.colorScheme.outlineVariant,
        ) {}
    }
}
```

`app/src/main/java/me/bmax/apatch/ui/screen/APM.kt`:

```kt
package me.bmax.apatch.ui.screen

import android.app.Activity.RESULT_OK
import android.content.Context
import android.content.Intent
import android.net.Uri
import android.util.Log
import android.util.Patterns
import android.widget.Toast
import androidx.activity.compose.rememberLauncherForActivityResult
import androidx.activity.result.contract.ActivityResultContracts
import androidx.compose.animation.AnimatedVisibility
import androidx.compose.animation.expandVertically
import androidx.compose.animation.fadeIn
import androidx.compose.animation.fadeOut
import androidx.compose.animation.shrinkVertically
import androidx.compose.foundation.clickable
import androidx.compose.foundation.layout.Arrangement
import androidx.compose.foundation.layout.Box
import androidx.compose.foundation.layout.Column
import androidx.compose.foundation.layout.PaddingValues
import androidx.compose.foundation.layout.Row
import androidx.compose.foundation.layout.Spacer
import androidx.compose.foundation.layout.fillMaxSize
import androidx.compose.foundation.layout.fillMaxWidth
import androidx.compose.foundation.layout.height
import androidx.compose.foundation.layout.padding
import androidx.compose.foundation.layout.size
import androidx.compose.foundation.layout.width
import androidx.compose.foundation.lazy.LazyColumn
import androidx.compose.foundation.lazy.LazyListState
import androidx.compose.foundation.lazy.items
import androidx.compose.foundation.lazy.rememberLazyListState
import androidx.compose.foundation.shape.RoundedCornerShape
import androidx.compose.material3.ExperimentalMaterial3Api
import androidx.compose.material3.FilledTonalButton
import androidx.compose.material3.FloatingActionButton
import androidx.compose.material3.HorizontalDivider
import androidx.compose.material3.Icon
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.Scaffold
import androidx.compose.material3.SearchBarScrollBehavior
import androidx.compose.material3.SnackbarDuration
import androidx.compose.material3.SnackbarHost
import androidx.compose.material3.SnackbarHostState
import androidx.compose.material3.SnackbarResult
import androidx.compose.material3.Surface
import androidx.compose.material3.Switch
import androidx.compose.material3.Text
import androidx.compose.material3.pulltorefresh.PullToRefreshBox
import androidx.compose.runtime.Composable
import androidx.compose.runtime.LaunchedEffect
import androidx.compose.runtime.getValue
import androidx.compose.runtime.livedata.observeAsState
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.produceState
import androidx.compose.runtime.remember
import androidx.compose.runtime.rememberCoroutineScope
import androidx.compose.runtime.saveable.rememberSaveable
import androidx.compose.runtime.setValue
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.draw.alpha
import androidx.compose.ui.input.nestedscroll.nestedScroll
import androidx.compose.ui.layout.SubcomposeLayout
import androidx.compose.ui.platform.LocalContext
import androidx.compose.ui.res.painterResource
import androidx.compose.ui.res.stringResource
import androidx.compose.ui.text.TextLayoutResult
import androidx.compose.ui.text.font.FontWeight
import androidx.compose.ui.text.style.TextAlign
import androidx.compose.ui.text.style.TextDecoration
import androidx.compose.ui.text.style.TextOverflow
import androidx.compose.ui.unit.Constraints
import androidx.compose.ui.unit.dp
import androidx.compose.ui.unit.sp
import androidx.core.net.toUri
import androidx.lifecycle.viewmodel.compose.viewModel
import com.ramcosta.composedestinations.annotation.Destination
import com.ramcosta.composedestinations.annotation.RootGraph
import com.ramcosta.composedestinations.generated.destinations.ExecuteAPMActionScreenDestination
import com.ramcosta.composedestinations.generated.destinations.InstallScreenDestination
import com.ramcosta.composedestinations.navigation.DestinationsNavigator
import com.topjohnwu.superuser.io.SuFile
import kotlinx.coroutines.Dispatchers
import kotlinx.coroutines.launch
import kotlinx.coroutines.withContext
import me.bmax.apatch.APApplication
import me.bmax.apatch.R
import me.bmax.apatch.apApp
import me.bmax.apatch.ui.WebUIActivity
import me.bmax.apatch.ui.component.ConfirmResult
import me.bmax.apatch.ui.component.ModuleRemoveButton
import me.bmax.apatch.ui.component.ModuleStateIndicator
import me.bmax.apatch.ui.component.ModuleUpdateButton
import me.bmax.apatch.ui.component.SearchAppBar
import me.bmax.apatch.ui.component.WarningCard
import me.bmax.apatch.ui.component.pinnedScrollBehavior
import me.bmax.apatch.ui.component.rememberConfirmDialog
import me.bmax.apatch.ui.component.rememberLoadingDialog
import me.bmax.apatch.ui.viewmodel.APModuleViewModel
import me.bmax.apatch.util.DownloadListener
import me.bmax.apatch.util.download
import me.bmax.apatch.util.hasMagisk
import me.bmax.apatch.util.reboot
import me.bmax.apatch.util.toggleModule
import me.bmax.apatch.util.ui.LocalSnackbarHost
import me.bmax.apatch.util.uninstallModule
import okhttp3.Request

@OptIn(ExperimentalMaterial3Api::class)
@Destination<RootGraph>
@Composable
fun APModuleScreen(navigator: DestinationsNavigator) {
    val snackBarHost = LocalSnackbarHost.current
    val context = LocalContext.current

    val state by APApplication.apStateLiveData.observeAsState(APApplication.State.UNKNOWN_STATE)
    if (state != APApplication.State.ANDROIDPATCH_INSTALLED && state != APApplication.State.ANDROIDPATCH_NEED_UPDATE) {
        Column(
            modifier = Modifier
                .fillMaxSize()
                .padding(12.dp),
            verticalArrangement = Arrangement.Center,
            horizontalAlignment = Alignment.CenterHorizontally
        ) {
            Row {
                Text(
                    text = stringResource(id = R.string.apm_not_installed),
                    style = MaterialTheme.typography.titleMedium
                )
            }
        }
        return
    }

    val viewModel = viewModel<APModuleViewModel>()

    LaunchedEffect(Unit) {
        if (viewModel.moduleList.isEmpty() || viewModel.isNeedRefresh) {
            viewModel.fetchModuleList()
        }
    }
    val webUILauncher = rememberLauncherForActivityResult(
        contract = ActivityResultContracts.StartActivityForResult()
    ) { viewModel.fetchModuleList() }
    val scrollBehavior = pinnedScrollBehavior()

    //TODO: FIXME -> val isSafeMode = Natives.getSafeMode()
    val isSafeMode = false
    val hasMagisk = hasMagisk()
    val hideInstallButton = isSafeMode || hasMagisk

    val moduleListState = rememberLazyListState()

    Scaffold(
        topBar = {
            SearchAppBar(
                searchText = viewModel.search,
                onSearchTextChange = { viewModel.search = it },
                scrollBehavior = scrollBehavior,
                searchBarPlaceHolderText = stringResource(R.string.search_modules)
            )
        },
        floatingActionButton = {
            if (hideInstallButton) return@Scaffold
            val selectZipLauncher = rememberLauncherForActivityResult(
                contract = ActivityResultContracts.StartActivityForResult()
            ) {
                if (it.resultCode != RESULT_OK) {
                    return@rememberLauncherForActivityResult
                }
                val data = it.data ?: return@rememberLauncherForActivityResult
                val uri = data.data ?: return@rememberLauncherForActivityResult

                Log.i("ModuleScreen", "select zip result: $uri")

                navigator.navigate(InstallScreenDestination(uri, MODULE_TYPE.APM))

                viewModel.markNeedRefresh()
            }

            FloatingActionButton(
                contentColor = MaterialTheme.colorScheme.onPrimary,
                containerColor = MaterialTheme.colorScheme.primary,
                onClick = {
                    // select the zip file to install
                    val intent = Intent(Intent.ACTION_GET_CONTENT)
                    intent.type = "application/zip"
                    selectZipLauncher.launch(intent)
                }) {
                Icon(
                    painter = painterResource(id = R.drawable.package_import),
                    contentDescription = null
                )
            }
        },
        snackbarHost = { SnackbarHost(snackBarHost) }
    ) { innerPadding ->
        when {
            hasMagisk -> {
                Box(
                    modifier = Modifier
                        .fillMaxSize()
                        .padding(24.dp),
                    contentAlignment = Alignment.Center
                ) {
                    Text(
                        stringResource(R.string.apm_magisk_conflict),
                        textAlign = TextAlign.Center,
                    )
                }
            }

            else -> {
                ModuleList(
                    navigator = navigator,
                    viewModel = viewModel,
                    modules = viewModel.moduleList,
                    modifier = Modifier
                        .padding(innerPadding)
                        .fillMaxSize(),
                    state = moduleListState,
                    onInstallModule = {
                        navigator.navigate(InstallScreenDestination(it, MODULE_TYPE.APM))
                    },
                    onClickModule = { id, name, hasWebUi ->
                        if (hasWebUi) {
                            webUILauncher.launch(
                                Intent(
                                    context, WebUIActivity::class.java
                                ).setData("apatch://webui/$id".toUri()).putExtra("id", id)
                                    .putExtra("name", name)
                            )
                        }
                    },
                    snackBarHost = snackBarHost,
                    scrollBehavior = scrollBehavior
                )
            }
        }
    }
}

private fun getMetaModuleWarningText(
    viewModel: APModuleViewModel,
    context: Context
) : String? {
    val hasSystemModule = viewModel.moduleList.any { module ->
        SuFile.open("/data/adb/modules/${module.id}/system").exists()
    }

    if (!hasSystemModule) return null

    val metaProp = SuFile.open("/data/adb/metamodule/module.prop").exists()
    val metaRemoved = SuFile.open("/data/adb/metamodule/remove").exists()
    val metaDisabled = SuFile.open("/data/adb/metamodule/disable").exists()

    return when {
        !metaProp ->
            context.getString(R.string.no_meta_module_installed)

        metaProp && metaRemoved ->
            context.getString(R.string.meta_module_removed)

        metaProp && metaDisabled ->
            context.getString(R.string.meta_module_disabled)

        else -> null
    }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
private fun MetaModuleWarningCard(
    text: String
) {
    var show by remember { mutableStateOf(true) }

    AnimatedVisibility(
        visible = show,
        enter = fadeIn() + expandVertically(),
        exit = fadeOut() + shrinkVertically()
    ) {
        WarningCard(
            message = text,
            onClose = {
                show = false
            }
        )
    }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
private fun ModuleList(
    navigator: DestinationsNavigator,
    viewModel: APModuleViewModel,
    modules: List<APModuleViewModel.ModuleInfo>,
    modifier: Modifier = Modifier,
    state: LazyListState,
    onInstallModule: (Uri) -> Unit,
    onClickModule: (id: String, name: String, hasWebUi: Boolean) -> Unit,
    snackBarHost: SnackbarHostState,
    scrollBehavior: SearchBarScrollBehavior
) {
    val failedEnable = stringResource(R.string.apm_failed_to_enable)
    val failedDisable = stringResource(R.string.apm_failed_to_disable)
    val failedUninstall = stringResource(R.string.apm_uninstall_failed)
    val successUninstall = stringResource(R.string.apm_uninstall_success)
    val reboot = stringResource(id = R.string.reboot)
    val rebootToApply = stringResource(id = R.string.apm_reboot_to_apply)
    val moduleStr = stringResource(id = R.string.apm)
    val uninstall = stringResource(id = R.string.apm_remove)
    val cancel = stringResource(id = android.R.string.cancel)
    val moduleUninstallConfirm = stringResource(id = R.string.apm_uninstall_confirm)
    val metaModuleUninstallConfirm = stringResource(R.string.metamodule_uninstall_confirm)
    val updateText = stringResource(R.string.apm_update)
    val changelogText = stringResource(R.string.apm_changelog)
    val downloadingText = stringResource(R.string.apm_downloading)
    val startDownloadingText = stringResource(R.string.apm_start_downloading)

    val context = LocalContext.current
    val loadingDialog = rememberLoadingDialog()
    val confirmDialog = rememberConfirmDialog()

    suspend fun onModuleUpdate(
        module: APModuleViewModel.ModuleInfo,
        changelogUrl: String,
        downloadUrl: String,
        fileName: String
    ) {
        val changelog = loadingDialog.withLoading {
            withContext(Dispatchers.IO) {
                runCatching {
                    if (Patterns.WEB_URL.matcher(changelogUrl).matches()) {
                        apApp.okhttpClient.newCall(
                                Request.Builder().url(changelogUrl).build()
                            ).execute().use { it.body?.string().orEmpty() }
                    } else {
                        changelogUrl
                    }
                }.getOrDefault("")
            }
        }


        if (changelog.isNotEmpty()) {
            // changelog is not empty, show it and wait for confirm
            val confirmResult = confirmDialog.awaitConfirm(
                changelogText,
                content = changelog,
                markdown = true,
                confirm = updateText,
            )

            if (confirmResult != ConfirmResult.Confirmed) {
                return
            }
        }

        withContext(Dispatchers.Main) {
            Toast.makeText(
                context, startDownloadingText.format(module.name), Toast.LENGTH_SHORT
            ).show()
        }

        val downloading = downloadingText.format(module.name)
        withContext(Dispatchers.IO) {
            download(
                context,
                downloadUrl,
                fileName,
                downloading,
                onDownloaded = onInstallModule,
                onDownloading = {
                    launch(Dispatchers.Main) {
                        Toast.makeText(context, downloading, Toast.LENGTH_SHORT).show()
                    }
                })
        }
    }

    suspend fun onModuleUninstall(module: APModuleViewModel.ModuleInfo) {
        val formatter = if (module.metamodule) metaModuleUninstallConfirm else moduleUninstallConfirm
        val confirmResult = confirmDialog.awaitConfirm(
            moduleStr,
            content = formatter.format(module.name),
            confirm = uninstall,
            dismiss = cancel
        )
        if (confirmResult != ConfirmResult.Confirmed) {
            return
        }

        val success = loadingDialog.withLoading {
            withContext(Dispatchers.IO) {
                uninstallModule(module.id)
            }
        }

        if (success) {
            viewModel.fetchModuleList()
        }
        val message = if (success) {
            successUninstall.format(module.name)
        } else {
            failedUninstall.format(module.name)
        }
        val actionLabel = if (success) {
            reboot
        } else {
            null
        }
        val result = snackBarHost.showSnackbar(
            message = message, actionLabel = actionLabel, duration = SnackbarDuration.Long
        )
        if (result == SnackbarResult.ActionPerformed) {
            reboot()
        }
    }

    PullToRefreshBox(
        modifier = modifier,
        onRefresh = { viewModel.fetchModuleList() },
        isRefreshing = viewModel.isRefreshing
    ) {
        val metaModuleWarningText by produceState<String?>(initialValue = null, viewModel.moduleList) {
            value = withContext(Dispatchers.IO) {
                getMetaModuleWarningText(viewModel, context)
            }
        }

        LazyColumn(
            modifier = Modifier.fillMaxSize().nestedScroll(scrollBehavior.nestedScrollConnection),
            state = state,
            verticalArrangement = Arrangement.spacedBy(16.dp),
            contentPadding = remember {
                PaddingValues(
                    start = 16.dp,
                    top = 11.dp, // spacedBy - TopBar padding
                    end = 16.dp,
                    bottom = 16.dp + 16.dp + 56.dp /*  Scaffold Fab Spacing + Fab container height */
                )
            },
        ) {
            if (metaModuleWarningText != null) {
                item {
                    MetaModuleWarningCard(metaModuleWarningText!!)
                }
            }

            when {
                modules.isEmpty() -> {
                    item {
                        Box(
                            modifier = Modifier.fillParentMaxSize(),
                            contentAlignment = Alignment.Center
                        ) {
                            Text(
                                stringResource(R.string.apm_empty), textAlign = TextAlign.Center
                            )
                        }
                    }
                }

                else -> {
                    items(modules) { module ->
                        var isChecked by rememberSaveable(module) { mutableStateOf(module.enabled) }
                        val scope = rememberCoroutineScope()
                        val updateInfo = module.updateInfo

                        ModuleItem(
                            navigator,
                            module,
                            isChecked,
                            updateInfo?.zipUrl ?: "",
                            onUninstall = {
                                scope.launch { onModuleUninstall(module) }
                            },
                            onCheckChanged = {
                                scope.launch {
                                    val success = loadingDialog.withLoading {
                                        withContext(Dispatchers.IO) {
                                            toggleModule(module.id, !isChecked)
                                        }
                                    }
                                    if (success) {
                                        isChecked = it
                                        viewModel.fetchModuleList()

                                        val result = snackBarHost.showSnackbar(
                                            message = rebootToApply,
                                            actionLabel = reboot,
                                            duration = SnackbarDuration.Long
                                        )
                                        if (result == SnackbarResult.ActionPerformed) {
                                            reboot()
                                        }
                                    } else {
                                        val message = if (isChecked) failedDisable else failedEnable
                                        snackBarHost.showSnackbar(message.format(module.name))
                                    }
                                }
                            },
                            onUpdate = {
                                scope.launch {
                                    updateInfo?.let { info ->
                                        onModuleUpdate(
                                            module,
                                            info.changelog,
                                            info.zipUrl,
                                            "${module.name}-${info.version}.zip"
                                        )
                                    }
                                }
                            },
                            onClick = {
                                onClickModule(it.id, it.name, it.hasWebUi)
                            })
                        // fix last item shadow incomplete in LazyColumn
                        Spacer(Modifier.height(1.dp))
                    }
                }
            }
        }

        DownloadListener(context, onInstallModule)
    }
}

@Composable
private fun ModuleItem(
    navigator: DestinationsNavigator,
    module: APModuleViewModel.ModuleInfo,
    isChecked: Boolean,
    updateUrl: String,
    onUninstall: (APModuleViewModel.ModuleInfo) -> Unit,
    onCheckChanged: (Boolean) -> Unit,
    onUpdate: (APModuleViewModel.ModuleInfo) -> Unit,
    onClick: (APModuleViewModel.ModuleInfo) -> Unit,
    modifier: Modifier = Modifier,
    alpha: Float = 1f,
) {
    val decoration = if (!module.remove) TextDecoration.None else TextDecoration.LineThrough
    val moduleAuthor = stringResource(id = R.string.apm_author)
    val viewModel = viewModel<APModuleViewModel>()
    Surface(
        modifier = modifier,
        color = MaterialTheme.colorScheme.surface,
        tonalElevation = 1.dp,
        shape = RoundedCornerShape(20.dp)
    ) {

        Box(
            modifier = Modifier
                .fillMaxWidth()
                .clickable { onClick(module) },
            contentAlignment = Alignment.Center
        ) {
            Column(
                modifier = Modifier.fillMaxWidth()
            ) {
                Row(
                    modifier = Modifier.padding(all = 16.dp),
                    verticalAlignment = Alignment.CenterVertically
                ) {
                    Column(
                        modifier = Modifier
                            .alpha(alpha = alpha)
                            .weight(1f),
                        verticalArrangement = Arrangement.spacedBy(2.dp)
                    ) {
                        SubcomposeLayout { constraints ->
                            val spacingPx = 6.dp.roundToPx()
                            var nameTextLayout: TextLayoutResult? = null
                            val metaPlaceable = if (module.metamodule) {
                                subcompose("meta") {
                                    Surface(
                                        shape = RoundedCornerShape(4.dp),
                                        color = MaterialTheme.colorScheme.tertiary
                                    ) {
                                        Text(
                                            text = "META",
                                            style = MaterialTheme.typography.labelSmall.copy(
                                                fontSize = 10.sp
                                            ),
                                            modifier = Modifier.padding(horizontal = 4.dp, vertical = 1.dp),
                                            color = MaterialTheme.colorScheme.onTertiary,
                                            maxLines = 1,
                                            overflow = TextOverflow.Ellipsis
                                        )
                                    }
                                }.first().measure(Constraints(0, constraints.maxWidth, 0, constraints.maxHeight))
                            } else null

                            val reserved = (metaPlaceable?.width ?: 0) + if (metaPlaceable != null) spacingPx else 0
                            val nameMax = (constraints.maxWidth - reserved).coerceAtLeast(0)
                            val namePlaceable = subcompose("name") {
                                Text(
                                    text = module.name,
                                    style = MaterialTheme.typography.titleSmall.copy(fontWeight = FontWeight.Bold),
                                    maxLines = 2,
                                    textDecoration = decoration,
                                    overflow = TextOverflow.Ellipsis,
                                    onTextLayout = { nameTextLayout = it }
                                )
                            }.first().measure(Constraints(constraints.minWidth, nameMax, constraints.minHeight, constraints.maxHeight))

                            val width = (namePlaceable.width + reserved).coerceIn(constraints.minWidth, constraints.maxWidth)
                            val height = maxOf(namePlaceable.height, metaPlaceable?.height ?: 0)

                            layout(width, height) {
                                namePlaceable.placeRelative(0, 0)
                                val endX = nameTextLayout?.let { layoutRes ->
                                    val last = (layoutRes.lineCount - 1).coerceAtLeast(0)
                                    layoutRes.getLineRight(last).toInt()
                                } ?: namePlaceable.width
                                metaPlaceable?.placeRelative(endX + spacingPx, (height - (metaPlaceable.height)) / 2)
                            }
                        }

                        Text(
                            text = "${module.version}, $moduleAuthor ${module.author}",
                            style = MaterialTheme.typography.bodySmall,
                            textDecoration = decoration,
                            color = MaterialTheme.colorScheme.onSurfaceVariant
                        )
                    }

                    Switch(
                        enabled = !module.update,
                        checked = isChecked,
                        onCheckedChange = onCheckChanged
                    )
                }

                Text(
                    modifier = Modifier
                        .alpha(alpha = alpha)
                        .padding(horizontal = 16.dp),
                    text = module.description,
                    style = MaterialTheme.typography.bodySmall,
                    textDecoration = decoration,
                    color = MaterialTheme.colorScheme.outline
                )

                HorizontalDivider(
                    thickness = 1.5.dp,
                    color = MaterialTheme.colorScheme.surface,
                    modifier = Modifier.padding(top = 8.dp)
                )

                Row(
                    modifier = Modifier
                        .padding(horizontal = 16.dp, vertical = 8.dp)
                        .fillMaxWidth(),
                    verticalAlignment = Alignment.CenterVertically
                ) {
                    if (updateUrl.isNotEmpty()) {
                        ModuleUpdateButton(onClick = { onUpdate(module) })

                        Spacer(modifier = Modifier.width(12.dp))
                    }

                    if (module.hasWebUi) {
                        FilledTonalButton(
                            onClick = { onClick(module) },
                            enabled = true,
                            contentPadding = PaddingValues(12.dp)
                        ) {
                            Icon(
                                modifier = Modifier.size(20.dp),
                                painter = painterResource(id = R.drawable.webui),
                                contentDescription = stringResource(id = R.string.apm_webui_open)
                            )
                        }

                        Spacer(modifier = Modifier.width(12.dp))
                    }

                    Spacer(modifier = Modifier.weight(1f))

                    if (module.hasActionScript) {
                        FilledTonalButton(
                            onClick = {
                                navigator.navigate(ExecuteAPMActionScreenDestination(module.id))
                                viewModel.markNeedRefresh()
                            }, enabled = true, contentPadding = PaddingValues(12.dp)
                        ) {
                            Icon(
                                modifier = Modifier.size(20.dp),
                                painter = painterResource(id = R.drawable.play_circle),
                                contentDescription = stringResource(id = R.string.apm_action)
                            )
                        }

                        Spacer(modifier = Modifier.width(12.dp))
                    }
                    ModuleRemoveButton(enabled = !module.remove, onClick = { onUninstall(module) })
                }
            }

            if (module.remove) {
                ModuleStateIndicator(R.drawable.trash)
            }
            if (module.update) {
                ModuleStateIndicator(R.drawable.device_mobile_down)
            }
        }
    }
}

```

`app/src/main/java/me/bmax/apatch/ui/screen/AboutScreen.kt`:

```kt
package me.bmax.apatch.ui.screen

import androidx.compose.foundation.Image
import androidx.compose.foundation.layout.Arrangement
import androidx.compose.foundation.layout.Column
import androidx.compose.foundation.layout.Row
import androidx.compose.foundation.layout.Spacer
import androidx.compose.foundation.layout.fillMaxWidth
import androidx.compose.foundation.layout.height
import androidx.compose.foundation.layout.padding
import androidx.compose.foundation.layout.size
import androidx.compose.foundation.layout.width
import androidx.compose.foundation.rememberScrollState
import androidx.compose.foundation.shape.CircleShape
import androidx.compose.foundation.shape.RoundedCornerShape
import androidx.compose.foundation.verticalScroll
import androidx.compose.material.icons.Icons
import androidx.compose.material.icons.automirrored.filled.ArrowBack
import androidx.compose.material3.ButtonDefaults
import androidx.compose.material3.ExperimentalMaterial3Api
import androidx.compose.material3.FilledTonalButton
import androidx.compose.material3.Icon
import androidx.compose.material3.IconButton
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.OutlinedCard
import androidx.compose.material3.Scaffold
import androidx.compose.material3.Surface
import androidx.compose.material3.Text
import androidx.compose.material3.TopAppBar
import androidx.compose.runtime.Composable
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.draw.scale
import androidx.compose.ui.platform.LocalUriHandler
import androidx.compose.ui.res.colorResource
import androidx.compose.ui.res.painterResource
import androidx.compose.ui.res.stringResource
import androidx.compose.ui.unit.dp
import androidx.lifecycle.compose.dropUnlessResumed
import com.ramcosta.composedestinations.annotation.Destination
import com.ramcosta.composedestinations.annotation.RootGraph
import com.ramcosta.composedestinations.navigation.DestinationsNavigator
import me.bmax.apatch.BuildConfig
import me.bmax.apatch.R
import me.bmax.apatch.util.Version

@Destination<RootGraph>
@Composable
fun AboutScreen(navigator: DestinationsNavigator) {
    val uriHandler = LocalUriHandler.current

    Scaffold(
        topBar = {
            TopBar(onBack = dropUnlessResumed { navigator.popBackStack() })
        }
    ) { innerPadding ->
        Column(
            modifier = Modifier
                .padding(innerPadding)
                .fillMaxWidth()
                .verticalScroll(rememberScrollState()),
            horizontalAlignment = Alignment.CenterHorizontally
        ) {
            Spacer(modifier = Modifier.height(20.dp))
            Surface(
                modifier = Modifier.size(95.dp),
                color = colorResource(id = R.color.ic_launcher_background),
                shape = CircleShape
            ) {
                Image(
                    painter = painterResource(id = R.drawable.ic_launcher_foreground),
                    contentDescription = "icon",
                    modifier = Modifier.scale(1.4f)
                )
            }

            Spacer(modifier = Modifier.height(20.dp))
            Text(
                text = stringResource(id = R.string.app_name),
                style = MaterialTheme.typography.titleLarge
            )
            Text(
                text = stringResource(
                    id = R.string.about_app_version,
                    if (BuildConfig.VERSION_NAME.contains(BuildConfig.VERSION_CODE.toString())) "${BuildConfig.VERSION_CODE}" else "${BuildConfig.VERSION_CODE} (${BuildConfig.VERSION_NAME})"
                ),
                style = MaterialTheme.typography.bodyMedium,
                color = MaterialTheme.colorScheme.onSurfaceVariant,
                modifier = Modifier.padding(top = 5.dp)
            )
            Text(

                text = stringResource(
                    id = R.string.about_powered_by,
                    "KernelPatch (${Version.buildKPVString()})"
                ),
                style = MaterialTheme.typography.bodyMedium,
                color = MaterialTheme.colorScheme.onSurfaceVariant,
                modifier = Modifier.padding(top = 5.dp)
            )

            Spacer(modifier = Modifier.height(20.dp))

            Row(
                modifier = Modifier.padding(top = 8.dp),
                verticalAlignment = Alignment.CenterVertically,
                horizontalArrangement = Arrangement.spacedBy(8.dp)
            ) {
                FilledTonalButton(
                    onClick = { uriHandler.openUri("https://github.com/bmax121/APatch") }
                ) {
                    Icon(
                        painter = painterResource(id = R.drawable.github),
                        contentDescription = null
                    )
                    Spacer(modifier = Modifier.width(ButtonDefaults.IconSpacing))
                    Text(text = stringResource(id = R.string.about_github))
                }

                FilledTonalButton(
                    onClick = { uriHandler.openUri("https://t.me/APatchChannel") }
                ) {
                    Icon(
                        painter = painterResource(id = R.drawable.telegram),
                        contentDescription = null
                    )
                    Spacer(modifier = Modifier.width(ButtonDefaults.IconSpacing))
                    Text(text = stringResource(id = R.string.about_telegram_channel))
                }
            }

            Row(
                modifier = Modifier.padding(top = 8.dp),
                verticalAlignment = Alignment.CenterVertically,
                horizontalArrangement = Arrangement.spacedBy(8.dp)
            ) {
                FilledTonalButton(
                    onClick = { uriHandler.openUri("https://hosted.weblate.org/engage/APatch") }
                ) {
                    Icon(
                        painter = painterResource(id = R.drawable.weblate),
                        contentDescription = null,
                        modifier = Modifier.size(ButtonDefaults.IconSize)
                    )
                    Spacer(modifier = Modifier.width(ButtonDefaults.IconSpacing))
                    Text(text = stringResource(id = R.string.about_weblate))
                }

                FilledTonalButton(
                    onClick = { uriHandler.openUri("https://t.me/apatch_discuss") }
                ) {
                    Icon(
                        painter = painterResource(id = R.drawable.telegram),
                        contentDescription = null
                    )
                    Spacer(modifier = Modifier.width(ButtonDefaults.IconSpacing))
                    Text(text = stringResource(id = R.string.about_telegram_group))
                }
            }

            OutlinedCard(
                modifier = Modifier.padding(vertical = 30.dp, horizontal = 20.dp),
                shape = RoundedCornerShape(15.dp)
            ) {
                Column(
                    modifier = Modifier
                        .fillMaxWidth()
                        .padding(all = 12.dp)
                ) {
                    Text(
                        text = stringResource(id = R.string.about_app_desc),
                        style = MaterialTheme.typography.bodyMedium,
                        color = MaterialTheme.colorScheme.onSurfaceVariant
                    )
                }
            }

        }
    }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
private fun TopBar(onBack: () -> Unit = {}) {
    TopAppBar(
        title = { Text(stringResource(R.string.about)) },
        navigationIcon = {
            IconButton(
                onClick = onBack
            ) { Icon(Icons.AutoMirrored.Filled.ArrowBack, contentDescription = null) }
        },
    )
}
```

`app/src/main/java/me/bmax/apatch/ui/screen/BottomBarDestination.kt`:

```kt
package me.bmax.apatch.ui.screen

import androidx.annotation.StringRes
import androidx.compose.material.icons.Icons
import androidx.compose.material.icons.filled.Apps
import androidx.compose.material.icons.filled.Build
import androidx.compose.material.icons.filled.Home
import androidx.compose.material.icons.filled.Security
import androidx.compose.material.icons.filled.Settings
import androidx.compose.material.icons.outlined.Apps
import androidx.compose.material.icons.outlined.Build
import androidx.compose.material.icons.outlined.Home
import androidx.compose.material.icons.outlined.Security
import androidx.compose.material.icons.outlined.Settings
import androidx.compose.ui.graphics.vector.ImageVector
import com.ramcosta.composedestinations.generated.destinations.APModuleScreenDestination
import com.ramcosta.composedestinations.generated.destinations.HomeScreenDestination
import com.ramcosta.composedestinations.generated.destinations.KPModuleScreenDestination
import com.ramcosta.composedestinations.generated.destinations.SettingScreenDestination
import com.ramcosta.composedestinations.generated.destinations.SuperUserScreenDestination
import com.ramcosta.composedestinations.spec.DirectionDestinationSpec
import me.bmax.apatch.R

enum class BottomBarDestination(
    val direction: DirectionDestinationSpec,
    @param:StringRes val label: Int,
    val iconSelected: ImageVector,
    val iconNotSelected: ImageVector,
    val kPatchRequired: Boolean,
    val aPatchRequired: Boolean,
) {
    Home(
        HomeScreenDestination,
        R.string.home,
        Icons.Filled.Home,
        Icons.Outlined.Home,
        false,
        false
    ),
    KModule(
        KPModuleScreenDestination,
        R.string.kpm,
        Icons.Filled.Build,
        Icons.Outlined.Build,
        true,
        false
    ),
    SuperUser(
        SuperUserScreenDestination,
        R.string.su_title,
        Icons.Filled.Security,
        Icons.Outlined.Security,
        true,
        false
    ),
    AModule(
        APModuleScreenDestination,
        R.string.apm,
        Icons.Filled.Apps,
        Icons.Outlined.Apps,
        false,
        true
    ),
    Settings(
        SettingScreenDestination,
        R.string.settings,
        Icons.Filled.Settings,
        Icons.Outlined.Settings,
        false,
        false
    )
}

```

`app/src/main/java/me/bmax/apatch/ui/screen/ExecuteAPMAction.kt`:

```kt
package me.bmax.apatch.ui.screen

import android.os.Environment
import androidx.compose.foundation.layout.Column
import androidx.compose.foundation.layout.fillMaxSize
import androidx.compose.foundation.layout.padding
import androidx.compose.foundation.rememberScrollState
import androidx.compose.foundation.verticalScroll
import androidx.compose.material.icons.Icons
import androidx.compose.material.icons.automirrored.filled.ArrowBack
import androidx.compose.material.icons.filled.Save
import androidx.compose.material3.ExperimentalMaterial3Api
import androidx.compose.material3.Icon
import androidx.compose.material3.IconButton
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.Scaffold
import androidx.compose.material3.SnackbarHost
import androidx.compose.material3.Text
import androidx.compose.material3.TopAppBar
import androidx.compose.runtime.Composable
import androidx.compose.runtime.LaunchedEffect
import androidx.compose.runtime.getValue
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.rememberCoroutineScope
import androidx.compose.runtime.saveable.rememberSaveable
import androidx.compose.runtime.setValue
import androidx.compose.ui.Modifier
import androidx.compose.ui.input.key.Key
import androidx.compose.ui.input.key.key
import androidx.compose.ui.res.stringResource
import androidx.compose.ui.text.font.FontFamily
import androidx.compose.ui.unit.dp
import androidx.lifecycle.compose.dropUnlessResumed
import com.ramcosta.composedestinations.annotation.Destination
import com.ramcosta.composedestinations.annotation.RootGraph
import com.ramcosta.composedestinations.navigation.DestinationsNavigator
import kotlinx.coroutines.Dispatchers
import kotlinx.coroutines.launch
import kotlinx.coroutines.withContext
import me.bmax.apatch.R
import me.bmax.apatch.ui.component.KeyEventBlocker
import me.bmax.apatch.util.runAPModuleAction
import me.bmax.apatch.util.ui.LocalSnackbarHost
import java.io.File
import java.text.SimpleDateFormat
import java.util.Date
import java.util.Locale

@Composable
@Destination<RootGraph>
fun ExecuteAPMActionScreen(navigator: DestinationsNavigator, moduleId: String) {
    var text by rememberSaveable { mutableStateOf("") }
    var tempText: String
    val logContent = rememberSaveable { StringBuilder() }
    val snackBarHost = LocalSnackbarHost.current
    val scope = rememberCoroutineScope()
    val scrollState = rememberScrollState()
    var actionResult: Boolean

    LaunchedEffect(Unit) {
        if (text.isNotEmpty()) {
            return@LaunchedEffect
        }
        withContext(Dispatchers.IO) {
            runAPModuleAction(
                moduleId,
                onStdout = {
                    tempText = "$it\n"
                    if (tempText.startsWith("[H[J")) { // clear command
                        text = tempText.substring(6)
                    } else {
                        text += tempText
                    }
                    logContent.append(it).append("\n")
                },
                onStderr = {
                    logContent.append(it).append("\n")
                }
            ).let {
                actionResult = it
            }
        }
        if (actionResult) {
            navigator.popBackStack()
        }
    }

    Scaffold(
        topBar = {
            TopBar(
                onBack = dropUnlessResumed {
                    navigator.popBackStack()
                },
                onSave = {
                    scope.launch {
                        val format = SimpleDateFormat("yyyy-MM-dd-HH-mm-ss", Locale.getDefault())
                        val date = format.format(Date())
                        val file = File(
                            Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS),
                            "APatch_apm_action_log_${date}.log"
                        )
                        file.writeText(logContent.toString())
                        snackBarHost.showSnackbar("Log saved to ${file.absolutePath}")
                    }
                }
            )
        },
        snackbarHost = { SnackbarHost(snackBarHost) }
    ) { innerPadding ->
        KeyEventBlocker {
            it.key == Key.VolumeDown || it.key == Key.VolumeUp
        }
        Column(
            modifier = Modifier
                .fillMaxSize(1f)
                .padding(innerPadding)
                .verticalScroll(scrollState),
        ) {
            LaunchedEffect(text) {
                scrollState.animateScrollTo(scrollState.maxValue)
            }
            Text(
                modifier = Modifier.padding(8.dp),
                text = text,
                fontSize = MaterialTheme.typography.bodySmall.fontSize,
                fontFamily = FontFamily.Monospace,
                lineHeight = MaterialTheme.typography.bodySmall.lineHeight,
            )
        }
    }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
private fun TopBar(onBack: () -> Unit = {}, onSave: () -> Unit = {}) {
    TopAppBar(
        title = { Text(stringResource(R.string.apm_action)) },
        navigationIcon = {
            IconButton(
                onClick = onBack
            ) { Icon(Icons.AutoMirrored.Filled.ArrowBack, contentDescription = null) }
        },
        actions = {
            IconButton(onClick = onSave) {
                Icon(
                    imageVector = Icons.Filled.Save,
                    contentDescription = "Save log"
                )
            }
        }
    )
}

```

`app/src/main/java/me/bmax/apatch/ui/screen/Home.kt`:

```kt
package me.bmax.apatch.ui.screen

import android.os.Build
import android.system.Os
import androidx.annotation.StringRes
import androidx.compose.animation.AnimatedVisibility
import androidx.compose.animation.expandVertically
import androidx.compose.animation.fadeIn
import androidx.compose.animation.fadeOut
import androidx.compose.animation.shrinkVertically
import androidx.compose.foundation.clickable
import androidx.compose.foundation.layout.Arrangement
import androidx.compose.foundation.layout.Box
import androidx.compose.foundation.layout.Column
import androidx.compose.foundation.layout.PaddingValues
import androidx.compose.foundation.layout.Row
import androidx.compose.foundation.layout.Spacer
import androidx.compose.foundation.layout.fillMaxWidth
import androidx.compose.foundation.layout.height
import androidx.compose.foundation.layout.padding
import androidx.compose.foundation.layout.size
import androidx.compose.foundation.layout.width
import androidx.compose.foundation.layout.wrapContentHeight
import androidx.compose.foundation.rememberScrollState
import androidx.compose.foundation.shape.RoundedCornerShape
import androidx.compose.foundation.text.KeyboardOptions
import androidx.compose.foundation.verticalScroll
import androidx.compose.material.icons.Icons
import androidx.compose.material.icons.automirrored.outlined.HelpOutline
import androidx.compose.material.icons.filled.CheckCircle
import androidx.compose.material.icons.filled.InstallMobile
import androidx.compose.material.icons.filled.MoreVert
import androidx.compose.material.icons.filled.Refresh
import androidx.compose.material.icons.filled.Visibility
import androidx.compose.material.icons.filled.VisibilityOff
import androidx.compose.material.icons.filled.Warning
import androidx.compose.material.icons.outlined.Block
import androidx.compose.material.icons.outlined.Cached
import androidx.compose.material.icons.outlined.CheckCircle
import androidx.compose.material.icons.outlined.Clear
import androidx.compose.material.icons.outlined.InstallMobile
import androidx.compose.material.icons.outlined.SystemUpdate
import androidx.compose.material3.AlertDialogDefaults
import androidx.compose.material3.BasicAlertDialog
import androidx.compose.material3.Button
import androidx.compose.material3.CardDefaults
import androidx.compose.material3.DropdownMenu
import androidx.compose.material3.DropdownMenuItem
import androidx.compose.material3.ElevatedCard
import androidx.compose.material3.ExperimentalMaterial3Api
import androidx.compose.material3.Icon
import androidx.compose.material3.IconButton
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.OutlinedTextField
import androidx.compose.material3.Scaffold
import androidx.compose.material3.Surface
import androidx.compose.material3.Text
import androidx.compose.material3.TextButton
import androidx.compose.material3.TopAppBar
import androidx.compose.runtime.Composable
import androidx.compose.runtime.MutableState
import androidx.compose.runtime.getValue
import androidx.compose.runtime.livedata.observeAsState
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.produceState
import androidx.compose.runtime.remember
import androidx.compose.runtime.saveable.rememberSaveable
import androidx.compose.runtime.setValue
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.graphics.Color
import androidx.compose.ui.platform.LocalUriHandler
import androidx.compose.ui.platform.LocalView
import androidx.compose.ui.res.stringResource
import androidx.compose.ui.text.input.KeyboardType
import androidx.compose.ui.text.input.PasswordVisualTransformation
import androidx.compose.ui.text.input.VisualTransformation
import androidx.compose.ui.unit.dp
import androidx.compose.ui.window.DialogProperties
import androidx.compose.ui.window.DialogWindowProvider
import androidx.compose.ui.window.SecureFlagPolicy
import androidx.lifecycle.compose.dropUnlessResumed
import com.ramcosta.composedestinations.annotation.Destination
import com.ramcosta.composedestinations.annotation.RootGraph
import com.ramcosta.composedestinations.generated.destinations.AboutScreenDestination
import com.ramcosta.composedestinations.generated.destinations.InstallModeSelectScreenDestination
import com.ramcosta.composedestinations.generated.destinations.PatchesDestination
import com.ramcosta.composedestinations.navigation.DestinationsNavigator
import kotlinx.coroutines.Dispatchers
import kotlinx.coroutines.withContext
import me.bmax.apatch.APApplication
import me.bmax.apatch.Natives
import me.bmax.apatch.R
import me.bmax.apatch.apApp
import me.bmax.apatch.ui.component.ProvideMenuShape
import me.bmax.apatch.ui.component.WarningCard
import me.bmax.apatch.ui.component.rememberConfirmDialog
import me.bmax.apatch.ui.viewmodel.PatchesViewModel
import me.bmax.apatch.util.LatestVersionInfo
import me.bmax.apatch.util.Version
import me.bmax.apatch.util.Version.getManagerVersion
import me.bmax.apatch.util.checkNewVersion
import me.bmax.apatch.util.getSELinuxStatus
import me.bmax.apatch.util.reboot
import me.bmax.apatch.util.ui.APDialogBlurBehindUtils

private val managerVersion = getManagerVersion()

@Destination<RootGraph>(start = true)
@Composable
fun HomeScreen(navigator: DestinationsNavigator) {
    var showPatchFloatAction by remember { mutableStateOf(true) }

    val kpState by APApplication.kpStateLiveData.observeAsState(APApplication.State.UNKNOWN_STATE)
    val apState by APApplication.apStateLiveData.observeAsState(APApplication.State.UNKNOWN_STATE)

    if (kpState != APApplication.State.UNKNOWN_STATE) {
        showPatchFloatAction = false
    }

    Scaffold(topBar = {
        TopBar(onInstallClick = dropUnlessResumed {
            navigator.navigate(InstallModeSelectScreenDestination)
        }, navigator, kpState)
    }) { innerPadding ->
        Column(
            modifier = Modifier
                .padding(innerPadding)
                .padding(horizontal = 16.dp)
                .verticalScroll(rememberScrollState()),
            verticalArrangement = Arrangement.spacedBy(16.dp)
        ) {
            Spacer(Modifier.height(0.dp))
            WarningCard()
            KStatusCard(kpState, apState, navigator)
            if (kpState != APApplication.State.UNKNOWN_STATE && apState != APApplication.State.ANDROIDPATCH_INSTALLED) {
                AStatusCard(apState)
            }
            val checkUpdate = APApplication.sharedPreferences.getBoolean("check_update", true)
            if (checkUpdate) {
                UpdateCard()
            }
            InfoCard(kpState, apState)
            LearnMoreCard()
            Spacer(Modifier)
        }
    }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun UninstallDialog(showDialog: MutableState<Boolean>, navigator: DestinationsNavigator) {
    BasicAlertDialog(
        onDismissRequest = { showDialog.value = false }, properties = DialogProperties(
            decorFitsSystemWindows = true,
            usePlatformDefaultWidth = false,
        )
    ) {
        Surface(
            modifier = Modifier
                .width(320.dp)
                .wrapContentHeight(),
            shape = RoundedCornerShape(20.dp),
            tonalElevation = AlertDialogDefaults.TonalElevation,
            color = AlertDialogDefaults.containerColor,
        ) {
            Column(modifier = Modifier.padding(PaddingValues(all = 24.dp))) {
                Box(
                    Modifier
                        .padding(PaddingValues(bottom = 16.dp))
                        .align(Alignment.CenterHorizontally)
                ) {
                    Text(
                        text = stringResource(id = R.string.home_dialog_uninstall_title),
                        style = MaterialTheme.typography.headlineSmall
                    )
                }
                Row(
                    modifier = Modifier.fillMaxWidth(), horizontalArrangement = Arrangement.Center
                ) {
                    TextButton(onClick = {
                        showDialog.value = false
                        APApplication.uninstallApatch()
                    }) {
                        Text(text = stringResource(id = R.string.home_dialog_uninstall_ap_only))
                    }

                    TextButton(onClick = {
                        showDialog.value = false
                        APApplication.uninstallApatch()
                        navigator.navigate(PatchesDestination(PatchesViewModel.PatchMode.UNPATCH))
                    }) {
                        Text(text = stringResource(id = R.string.home_dialog_uninstall_all))
                    }
                }
            }
            val dialogWindowProvider = LocalView.current.parent as DialogWindowProvider
            APDialogBlurBehindUtils.setupWindowBlurListener(dialogWindowProvider.window)
        }
    }

}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun AuthFailedTipDialog(showDialog: MutableState<Boolean>) {
    BasicAlertDialog(
        onDismissRequest = { showDialog.value = false }, properties = DialogProperties(
            decorFitsSystemWindows = true,
            usePlatformDefaultWidth = false,
            securePolicy = SecureFlagPolicy.SecureOff
        )
    ) {
        Surface(
            modifier = Modifier
                .width(320.dp)
                .wrapContentHeight(),
            shape = RoundedCornerShape(20.dp),
            tonalElevation = AlertDialogDefaults.TonalElevation,
            color = AlertDialogDefaults.containerColor,
        ) {
            Column(modifier = Modifier.padding(PaddingValues(all = 24.dp))) {
                // Title
                Box(
                    Modifier
                        .padding(PaddingValues(bottom = 16.dp))
                        .align(Alignment.Start)
                ) {
                    Text(
                        text = stringResource(id = R.string.home_dialog_auth_fail_title),
                        style = MaterialTheme.typography.headlineSmall
                    )
                }

                // Content
                Box(
                    Modifier
                        .weight(weight = 1f, fill = false)
                        .padding(PaddingValues(bottom = 24.dp))
                        .align(Alignment.Start)
                ) {
                    Text(
                        text = stringResource(id = R.string.home_dialog_auth_fail_content),
                        style = MaterialTheme.typography.bodyMedium
                    )
                }

                // Buttons
                Row(
                    modifier = Modifier.fillMaxWidth(), horizontalArrangement = Arrangement.End
                ) {
                    TextButton(onClick = { showDialog.value = false }) {
                        Text(text = stringResource(id = android.R.string.ok))
                    }
                }
            }
            val dialogWindowProvider = LocalView.current.parent as DialogWindowProvider
            APDialogBlurBehindUtils.setupWindowBlurListener(dialogWindowProvider.window)
        }
    }

}

val checkSuperKeyValidation: (superKey: String) -> Boolean = { superKey ->
    superKey.length in 8..63 && superKey.any { it.isDigit() } && superKey.any { it.isLetter() }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun AuthSuperKey(showDialog: MutableState<Boolean>, showFailedDialog: MutableState<Boolean>) {
    var key by remember { mutableStateOf("") }
    var keyVisible by remember { mutableStateOf(false) }
    var enable by remember { mutableStateOf(false) }

    BasicAlertDialog(
        onDismissRequest = { showDialog.value = false }, properties = DialogProperties(
            decorFitsSystemWindows = true,
            usePlatformDefaultWidth = false,
            securePolicy = SecureFlagPolicy.SecureOff
        )
    ) {
        Surface(
            modifier = Modifier
                .width(310.dp)
                .wrapContentHeight(),
            shape = RoundedCornerShape(30.dp),
            tonalElevation = AlertDialogDefaults.TonalElevation,
            color = AlertDialogDefaults.containerColor,
        ) {
            Column(modifier = Modifier.padding(PaddingValues(all = 24.dp))) {
                // Title
                Box(
                    Modifier
                        .padding(PaddingValues(bottom = 16.dp))
                        .align(Alignment.Start)
                ) {
                    Text(
                        text = stringResource(id = R.string.home_auth_key_title),
                        style = MaterialTheme.typography.headlineSmall
                    )
                }

                // Content
                Box(
                    Modifier
                        .weight(weight = 1f, fill = false)
                        .align(Alignment.Start)
                ) {
                    Text(
                        text = stringResource(id = R.string.home_auth_key_desc),
                        style = MaterialTheme.typography.bodyMedium
                    )
                }

                // Content2
                Box(
                    contentAlignment = Alignment.CenterEnd,
                ) {
                    OutlinedTextField(
                        value = key,
                        modifier = Modifier
                            .fillMaxWidth()
                            .padding(top = 6.dp),
                        onValueChange = {
                            key = it
                            enable = checkSuperKeyValidation(key)
                        },
                        shape = RoundedCornerShape(50.0f),
                        label = { Text(stringResource(id = R.string.super_key)) },
                        visualTransformation = if (keyVisible) VisualTransformation.None else PasswordVisualTransformation(),
                        keyboardOptions = KeyboardOptions(keyboardType = KeyboardType.Password)
                    )
                    IconButton(
                        modifier = Modifier
                            .size(40.dp)
                            .padding(top = 15.dp, end = 5.dp),
                        onClick = { keyVisible = !keyVisible }) {
                        Icon(
                            imageVector = if (keyVisible) Icons.Default.Visibility else Icons.Default.VisibilityOff,
                            contentDescription = null,
                            tint = Color.Gray
                        )
                    }
                }

                Spacer(modifier = Modifier.height(12.dp))
                // Buttons
                Row(
                    modifier = Modifier.fillMaxWidth(), horizontalArrangement = Arrangement.End
                ) {
                    TextButton(onClick = { showDialog.value = false }) {
                        Text(stringResource(id = android.R.string.cancel))
                    }

                    Button(onClick = {
                        showDialog.value = false

                        val preVerifyKey = Natives.nativeReady(key)
                        if (preVerifyKey) {
                            APApplication.superKey = key
                        } else {
                            showFailedDialog.value = true
                        }

                    }, enabled = enable) {
                        Text(stringResource(id = android.R.string.ok))
                    }
                }
            }
        }
        val dialogWindowProvider = LocalView.current.parent as DialogWindowProvider
        APDialogBlurBehindUtils.setupWindowBlurListener(dialogWindowProvider.window)
    }
}

@Composable
fun RebootDropdownItem(@StringRes id: Int, reason: String = "") {
    DropdownMenuItem(text = {
        Text(stringResource(id))
    }, onClick = {
        reboot(reason)
    })
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
private fun TopBar(
    onInstallClick: () -> Unit, navigator: DestinationsNavigator, kpState: APApplication.State
) {
    val uriHandler = LocalUriHandler.current
    var showDropdownMoreOptions by remember { mutableStateOf(false) }
    var showDropdownReboot by remember { mutableStateOf(false) }

    TopAppBar(title = {
        Text(stringResource(R.string.app_name))
    }, actions = {
        IconButton(onClick = onInstallClick) {
            Icon(
                imageVector = Icons.Filled.InstallMobile,
                contentDescription = stringResource(id = R.string.mode_select_page_title)
            )
        }

        if (kpState != APApplication.State.UNKNOWN_STATE) {
            IconButton(onClick = {
                showDropdownReboot = true
            }) {
                Icon(
                    imageVector = Icons.Filled.Refresh,
                    contentDescription = stringResource(id = R.string.reboot)
                )

                ProvideMenuShape(RoundedCornerShape(10.dp)) {
                    DropdownMenu(expanded = showDropdownReboot, onDismissRequest = {
                        showDropdownReboot = false
                    }) {
                        RebootDropdownItem(id = R.string.reboot)
                        RebootDropdownItem(id = R.string.reboot_recovery, reason = "recovery")
                        RebootDropdownItem(id = R.string.reboot_bootloader, reason = "bootloader")
                        RebootDropdownItem(id = R.string.reboot_download, reason = "download")
                        RebootDropdownItem(id = R.string.reboot_edl, reason = "edl")
                    }
                }
            }
        }

        Box {
            IconButton(onClick = { showDropdownMoreOptions = true }) {
                Icon(
                    imageVector = Icons.Filled.MoreVert,
                    contentDescription = stringResource(id = R.string.settings)
                )
                ProvideMenuShape(RoundedCornerShape(10.dp)) {
                    DropdownMenu(expanded = showDropdownMoreOptions, onDismissRequest = {
                        showDropdownMoreOptions = false
                    }) {
                        DropdownMenuItem(text = {
                            Text(stringResource(R.string.home_more_menu_feedback_or_suggestion))
                        }, onClick = {
                            showDropdownMoreOptions = false
                            uriHandler.openUri("https://github.com/bmax121/APatch/issues/new/choose")
                        })
                        DropdownMenuItem(text = {
                            Text(stringResource(R.string.home_more_menu_about))
                        }, onClick = {
                            navigator.navigate(AboutScreenDestination)
                            showDropdownMoreOptions = false
                        })
                    }
                }
            }
        }
    })
}

@Composable
private fun KStatusCard(
    kpState: APApplication.State, apState: APApplication.State, navigator: DestinationsNavigator
) {

    val showAuthFailedTipDialog = remember { mutableStateOf(false) }
    if (showAuthFailedTipDialog.value) {
        AuthFailedTipDialog(showDialog = showAuthFailedTipDialog)
    }

    val showAuthKeyDialog = remember { mutableStateOf(false) }
    if (showAuthKeyDialog.value) {
        AuthSuperKey(showDialog = showAuthKeyDialog, showFailedDialog = showAuthFailedTipDialog)
    }

    val showUninstallDialog = remember { mutableStateOf(false) }
    if (showUninstallDialog.value) {
        UninstallDialog(showDialog = showUninstallDialog, navigator)
    }

    val cardBackgroundColor = when (kpState) {
        APApplication.State.KERNELPATCH_INSTALLED -> {
            MaterialTheme.colorScheme.primary
        }

        APApplication.State.KERNELPATCH_NEED_UPDATE, APApplication.State.KERNELPATCH_NEED_REBOOT -> {
            MaterialTheme.colorScheme.secondary
        }

        else -> {
            MaterialTheme.colorScheme.secondaryContainer
        }
    }

    ElevatedCard(
        onClick = {
            if (kpState != APApplication.State.KERNELPATCH_INSTALLED) {
                navigator.navigate(InstallModeSelectScreenDestination)
            }
        },
        colors = CardDefaults.elevatedCardColors(containerColor = cardBackgroundColor),
        elevation = CardDefaults.cardElevation(
            defaultElevation = if (kpState == APApplication.State.UNKNOWN_STATE) 0.dp else 6.dp
        )
    ) {
        Column(
            modifier = Modifier
                .fillMaxWidth()
                .padding(12.dp),
            horizontalAlignment = Alignment.CenterHorizontally
        ) {
            if (kpState == APApplication.State.KERNELPATCH_NEED_UPDATE) {
                Row {
                    Text(
                        text = stringResource(R.string.kernel_patch),
                        style = MaterialTheme.typography.titleMedium
                    )
                }
            }
            Row(
                modifier = Modifier
                    .fillMaxWidth()
                    .padding(10.dp),
                verticalAlignment = Alignment.CenterVertically
            ) {
                when (kpState) {
                    APApplication.State.KERNELPATCH_INSTALLED -> {
                        Icon(Icons.Filled.CheckCircle, stringResource(R.string.home_working))
                    }

                    APApplication.State.KERNELPATCH_NEED_UPDATE, APApplication.State.KERNELPATCH_NEED_REBOOT -> {
                        Icon(Icons.Outlined.SystemUpdate, stringResource(R.string.home_need_update))
                    }

                    else -> {
                        Icon(Icons.AutoMirrored.Outlined.HelpOutline, "Unknown")
                    }
                }
                Column(
                    Modifier
                        .weight(2f)
                        .padding(start = 16.dp)
                ) {
                    when (kpState) {
                        APApplication.State.KERNELPATCH_INSTALLED -> {
                            Text(
                                text = stringResource(R.string.home_working),
                                style = MaterialTheme.typography.titleMedium
                            )
                        }

                        APApplication.State.KERNELPATCH_NEED_UPDATE, APApplication.State.KERNELPATCH_NEED_REBOOT -> {
                            Text(
                                text = stringResource(R.string.home_need_update),
                                style = MaterialTheme.typography.titleMedium
                            )
                            Spacer(Modifier.height(6.dp))
                            Text(
                                text = stringResource(
                                    R.string.kpatch_version_update,
                                    Version.installedKPVString(),
                                    Version.buildKPVString()
                                ), style = MaterialTheme.typography.bodyMedium
                            )
                        }

                        else -> {
                            Text(
                                text = stringResource(R.string.home_install_unknown),
                                style = MaterialTheme.typography.titleMedium
                            )
                            Text(
                                text = stringResource(R.string.home_install_unknown_summary),
                                style = MaterialTheme.typography.bodyMedium
                            )
                        }
                    }
                    if (kpState != APApplication.State.UNKNOWN_STATE && kpState != APApplication.State.KERNELPATCH_NEED_UPDATE && kpState != APApplication.State.KERNELPATCH_NEED_REBOOT) {
                        Spacer(Modifier.height(4.dp))
                        Text(
                            text = "${Version.installedKPVString()} (${managerVersion.second}) - " + if (apState != APApplication.State.ANDROIDPATCH_NOT_INSTALLED) "Full" else "KernelPatch",
                            style = MaterialTheme.typography.bodyMedium
                        )
                    }
                }

                Column(
                    modifier = Modifier.align(Alignment.CenterVertically)
                ) {
                    Button(onClick = {
                        when (kpState) {
                            APApplication.State.UNKNOWN_STATE -> {
                                showAuthKeyDialog.value = true
                            }

                            APApplication.State.KERNELPATCH_NEED_UPDATE -> {
                                // todo: remove legacy compact for kp < 0.9.0
                                if (Version.installedKPVUInt() < 0x900u) {
                                    navigator.navigate(PatchesDestination(PatchesViewModel.PatchMode.PATCH_ONLY))
                                } else {
                                    navigator.navigate(InstallModeSelectScreenDestination)
                                }
                            }

                            APApplication.State.KERNELPATCH_NEED_REBOOT -> {
                                reboot()
                            }

                            APApplication.State.KERNELPATCH_UNINSTALLING -> {
                                // Do nothing
                            }

                            else -> {
                                if (apState == APApplication.State.ANDROIDPATCH_INSTALLED || apState == APApplication.State.ANDROIDPATCH_NEED_UPDATE) {
                                    showUninstallDialog.value = true
                                } else {
                                    navigator.navigate(PatchesDestination(PatchesViewModel.PatchMode.UNPATCH))
                                }
                            }
                        }
                    }, content = {
                        when (kpState) {
                            APApplication.State.UNKNOWN_STATE -> {
                                Text(text = stringResource(id = R.string.super_key))
                            }

                            APApplication.State.KERNELPATCH_NEED_UPDATE -> {
                                Text(text = stringResource(id = R.string.home_ap_cando_update))
                            }

                            APApplication.State.KERNELPATCH_NEED_REBOOT -> {
                                Text(text = stringResource(id = R.string.home_ap_cando_reboot))
                            }

                            APApplication.State.KERNELPATCH_UNINSTALLING -> {
                                Icon(Icons.Outlined.Cached, contentDescription = "busy")
                            }

                            else -> {
                                Text(text = stringResource(id = R.string.home_ap_cando_uninstall))
                            }
                        }
                    })
                }
            }
        }
    }
}

@Composable
private fun AStatusCard(apState: APApplication.State) {
    ElevatedCard(
        colors = CardDefaults.elevatedCardColors(containerColor = run {
            MaterialTheme.colorScheme.secondaryContainer
        })
    ) {
        Column(
            modifier = Modifier
                .fillMaxWidth()
                .padding(12.dp),
            horizontalAlignment = Alignment.CenterHorizontally
        ) {
            Row {
                Text(
                    text = stringResource(R.string.android_patch),
                    style = MaterialTheme.typography.titleMedium
                )
            }
            Row(
                modifier = Modifier
                    .fillMaxWidth()
                    .padding(10.dp),
                verticalAlignment = Alignment.CenterVertically
            ) {
                when (apState) {
                    APApplication.State.ANDROIDPATCH_NOT_INSTALLED -> {
                        Icon(Icons.Outlined.Block, stringResource(R.string.home_not_installed))
                    }

                    APApplication.State.ANDROIDPATCH_INSTALLING -> {
                        Icon(Icons.Outlined.InstallMobile, stringResource(R.string.home_installing))
                    }

                    APApplication.State.ANDROIDPATCH_INSTALLED -> {
                        Icon(Icons.Outlined.CheckCircle, stringResource(R.string.home_working))
                    }

                    APApplication.State.ANDROIDPATCH_NEED_UPDATE -> {
                        Icon(Icons.Outlined.SystemUpdate, stringResource(R.string.home_need_update))
                    }

                    else -> {
                        Icon(
                            Icons.AutoMirrored.Outlined.HelpOutline,
                            stringResource(R.string.home_install_unknown)
                        )
                    }
                }
                Column(
                    Modifier
                        .weight(2f)
                        .padding(start = 16.dp)
                ) {

                    when (apState) {
                        APApplication.State.ANDROIDPATCH_NOT_INSTALLED -> {
                            Text(
                                text = stringResource(R.string.home_not_installed),
                                style = MaterialTheme.typography.titleMedium
                            )
                        }

                        APApplication.State.ANDROIDPATCH_INSTALLING -> {
                            Text(
                                text = stringResource(R.string.home_installing),
                                style = MaterialTheme.typography.titleMedium
                            )
                        }

                        APApplication.State.ANDROIDPATCH_INSTALLED -> {
                            Text(
                                text = stringResource(R.string.home_working),
                                style = MaterialTheme.typography.titleMedium
                            )
                        }

                        APApplication.State.ANDROIDPATCH_NEED_UPDATE -> {
                            Text(
                                text = stringResource(R.string.home_need_update),
                                style = MaterialTheme.typography.titleMedium
                            )
                            Spacer(Modifier.height(6.dp))
                            Text(
                                text = stringResource(
                                    R.string.apatch_version_update,
                                    Version.installedApdVString,
                                    managerVersion.second
                                ), style = MaterialTheme.typography.bodyMedium
                            )
                        }

                        else -> {
                            Text(
                                text = stringResource(R.string.home_install_unknown),
                                style = MaterialTheme.typography.titleMedium
                            )
                        }
                    }
                }
                if (apState != APApplication.State.UNKNOWN_STATE) {
                    Column(
                        modifier = Modifier.align(Alignment.CenterVertically)
                    ) {
                        Button(onClick = {
                            when (apState) {
                                APApplication.State.ANDROIDPATCH_NOT_INSTALLED, APApplication.State.ANDROIDPATCH_NEED_UPDATE -> {
                                    APApplication.installApatch()
                                }

                                APApplication.State.ANDROIDPATCH_UNINSTALLING -> {
                                    // Do nothing
                                }

                                else -> {
                                    APApplication.uninstallApatch()
                                }
                            }
                        }, content = {
                            when (apState) {
                                APApplication.State.ANDROIDPATCH_NOT_INSTALLED -> {
                                    Text(text = stringResource(id = R.string.home_ap_cando_install))
                                }

                                APApplication.State.ANDROIDPATCH_NEED_UPDATE -> {
                                    Text(text = stringResource(id = R.string.home_ap_cando_update))
                                }

                                APApplication.State.ANDROIDPATCH_UNINSTALLING -> {
                                    Icon(Icons.Outlined.Cached, contentDescription = "busy")
                                }

                                else -> {
                                    Text(text = stringResource(id = R.string.home_ap_cando_uninstall))
                                }
                            }
                        })
                    }
                }
            }
        }
    }
}


@Composable
fun WarningCard() {
    var show by rememberSaveable { mutableStateOf(apApp.getBackupWarningState()) }
    if (show) {
        ElevatedCard(
            elevation = CardDefaults.cardElevation(
                defaultElevation = 6.dp
            ), colors = CardDefaults.elevatedCardColors(containerColor = run {
                MaterialTheme.colorScheme.error
            })
        ) {
            Row(
                modifier = Modifier
                    .fillMaxWidth()
                    .padding(12.dp)
            ) {
                Column(
                    modifier = Modifier.padding(12.dp),
                    verticalArrangement = Arrangement.Center,
                    horizontalAlignment = Alignment.CenterHorizontally
                ) {
                    Icon(Icons.Filled.Warning, contentDescription = "warning")
                }
                Column(
                    modifier = Modifier.padding(12.dp),
                    horizontalAlignment = Alignment.CenterHorizontally
                ) {
                    Row(
                        modifier = Modifier
                            .fillMaxWidth()
                            .align(Alignment.CenterHorizontally),
                        horizontalArrangement = Arrangement.SpaceBetween
                    ) {
                        Text(
                            modifier = Modifier.weight(1f),
                            text = stringResource(id = R.string.patch_warnning),
                        )

                        Spacer(Modifier.width(12.dp))

                        Icon(
                            Icons.Outlined.Clear,
                            contentDescription = "",
                            modifier = Modifier.clickable {
                                show = false
                                apApp.updateBackupWarningState(false)
                            },
                        )
                    }
                }
            }
        }
    }
}

private fun getSystemVersion(): String {
    return "${Build.VERSION.RELEASE} ${if (Build.VERSION.PREVIEW_SDK_INT != 0) "Preview" else ""} (API ${Build.VERSION.SDK_INT})"
}

private fun getDeviceInfo(): String {
    var manufacturer =
        Build.MANUFACTURER[0].uppercaseChar().toString() + Build.MANUFACTURER.substring(1)
    if (!Build.BRAND.equals(Build.MANUFACTURER, ignoreCase = true)) {
        manufacturer += " " + Build.BRAND[0].uppercaseChar() + Build.BRAND.substring(1)
    }
    manufacturer += " " + Build.MODEL + " "
    return manufacturer
}

@Composable
private fun InfoCard(kpState: APApplication.State, apState: APApplication.State) {
    ElevatedCard {
        Column(
            modifier = Modifier
                .fillMaxWidth()
                .padding(start = 24.dp, top = 24.dp, end = 24.dp, bottom = 16.dp)
        ) {
            val contents = StringBuilder()
            val uname = Os.uname()

            @Composable
            fun InfoCardItem(label: String, content: String) {
                contents.appendLine(label).appendLine(content).appendLine()
                Text(text = label, style = MaterialTheme.typography.bodyLarge)
                Text(text = content, style = MaterialTheme.typography.bodyMedium)
            }

            if (kpState != APApplication.State.UNKNOWN_STATE) {
                InfoCardItem(
                    stringResource(R.string.home_kpatch_version), Version.installedKPVString()
                )

                Spacer(Modifier.height(16.dp))
                InfoCardItem(stringResource(R.string.home_su_path), Natives.suPath())

                Spacer(Modifier.height(16.dp))
            }

            if (apState != APApplication.State.UNKNOWN_STATE && apState != APApplication.State.ANDROIDPATCH_NOT_INSTALLED) {
                InfoCardItem(
                    stringResource(R.string.home_apatch_version), managerVersion.second.toString()
                )
                Spacer(Modifier.height(16.dp))
            }

            InfoCardItem(stringResource(R.string.home_device_info), getDeviceInfo())

            Spacer(Modifier.height(16.dp))
            InfoCardItem(stringResource(R.string.home_kernel), uname.release)

            Spacer(Modifier.height(16.dp))
            InfoCardItem(stringResource(R.string.home_system_version), getSystemVersion())

            Spacer(Modifier.height(16.dp))
            InfoCardItem(stringResource(R.string.home_fingerprint), Build.FINGERPRINT)

            Spacer(Modifier.height(16.dp))
            InfoCardItem(stringResource(R.string.home_selinux_status), getSELinuxStatus())

        }
    }
}

@Composable
fun UpdateCard() {
    val latestVersionInfo = LatestVersionInfo()
    val newVersion by produceState(initialValue = latestVersionInfo) {
        value = withContext(Dispatchers.IO) {
            checkNewVersion()
        }
    }
    val currentVersionCode = managerVersion.second
    val newVersionCode = newVersion.versionCode
    val newVersionUrl = newVersion.downloadUrl
    val changelog = newVersion.changelog

    val uriHandler = LocalUriHandler.current
    val title = stringResource(id = R.string.apm_changelog)
    val updateText = stringResource(id = R.string.apm_update)

    AnimatedVisibility(
        visible = newVersionCode > currentVersionCode,
        enter = fadeIn() + expandVertically(),
        exit = shrinkVertically() + fadeOut()
    ) {
        val updateDialog = rememberConfirmDialog(onConfirm = { uriHandler.openUri(newVersionUrl) })
        WarningCard(
            message = stringResource(id = R.string.home_new_apatch_found).format(newVersionCode),
            MaterialTheme.colorScheme.outlineVariant
        ) {
            if (changelog.isEmpty()) {
                uriHandler.openUri(newVersionUrl)
            } else {
                updateDialog.showConfirm(
                    title = title, content = changelog, markdown = true, confirm = updateText
                )
            }
        }
    }
}

@Composable
fun LearnMoreCard() {
    val uriHandler = LocalUriHandler.current

    ElevatedCard {
        Row(
            modifier = Modifier
                .fillMaxWidth()
                .clickable {
                    uriHandler.openUri("https://apatch.dev")
                }
                .padding(24.dp), verticalAlignment = Alignment.CenterVertically) {
            Column {
                Text(
                    text = stringResource(R.string.home_learn_apatch),
                    style = MaterialTheme.typography.titleSmall
                )
                Spacer(Modifier.height(4.dp))
                Text(
                    text = stringResource(R.string.home_click_to_learn_apatch),
                    style = MaterialTheme.typography.bodyMedium
                )
            }
        }
    }
}
```

`app/src/main/java/me/bmax/apatch/ui/screen/Install.kt`:

```kt
package me.bmax.apatch.ui.screen

import android.content.Context
import android.net.Uri
import android.os.Environment
import android.util.Log
import androidx.compose.foundation.layout.Arrangement
import androidx.compose.foundation.layout.Column
import androidx.compose.foundation.layout.Row
import androidx.compose.foundation.layout.fillMaxSize
import androidx.compose.foundation.layout.fillMaxWidth
import androidx.compose.foundation.layout.padding
import androidx.compose.foundation.rememberScrollState
import androidx.compose.foundation.verticalScroll
import androidx.compose.material.icons.Icons
import androidx.compose.material.icons.automirrored.filled.ArrowBack
import androidx.compose.material.icons.filled.Refresh
import androidx.compose.material.icons.filled.Save
import androidx.compose.material.icons.outlined.Info
import androidx.compose.material3.AlertDialog
import androidx.compose.material3.ExperimentalMaterial3Api
import androidx.compose.material3.ExtendedFloatingActionButton
import androidx.compose.material3.FilledTonalButton
import androidx.compose.material3.Icon
import androidx.compose.material3.IconButton
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.OutlinedButton
import androidx.compose.material3.Scaffold
import androidx.compose.material3.SnackbarHost
import androidx.compose.material3.Text
import androidx.compose.material3.TopAppBar
import androidx.compose.runtime.Composable
import androidx.compose.runtime.LaunchedEffect
import androidx.compose.runtime.getValue
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.remember
import androidx.compose.runtime.rememberCoroutineScope
import androidx.compose.runtime.saveable.rememberSaveable
import androidx.compose.runtime.setValue
import androidx.compose.ui.Modifier
import androidx.compose.ui.input.key.Key
import androidx.compose.ui.input.key.key
import androidx.compose.ui.platform.LocalContext
import androidx.compose.ui.platform.LocalUriHandler
import androidx.compose.ui.res.stringResource
import androidx.compose.ui.text.font.FontFamily
import androidx.compose.ui.tooling.preview.Preview
import androidx.compose.ui.unit.dp
import androidx.lifecycle.compose.dropUnlessResumed
import com.ramcosta.composedestinations.annotation.Destination
import com.ramcosta.composedestinations.annotation.RootGraph
import com.ramcosta.composedestinations.navigation.DestinationsNavigator
import com.topjohnwu.superuser.io.SuFile
import kotlinx.coroutines.Dispatchers
import kotlinx.coroutines.launch
import kotlinx.coroutines.withContext
import me.bmax.apatch.R
import me.bmax.apatch.ui.component.KeyEventBlocker
import me.bmax.apatch.ui.component.rememberCustomDialog
import me.bmax.apatch.util.hasMetaModule
import me.bmax.apatch.util.installModule
import me.bmax.apatch.util.reboot
import me.bmax.apatch.util.ui.LocalSnackbarHost
import java.io.File
import java.text.SimpleDateFormat
import java.util.Date
import java.util.Locale
import java.util.Properties
import java.util.zip.ZipEntry
import java.util.zip.ZipInputStream

enum class MODULE_TYPE {
    KPM, APM
}

@Composable
@Destination<RootGraph>
fun InstallScreen(navigator: DestinationsNavigator, uri: Uri, type: MODULE_TYPE) {
    var text by remember { mutableStateOf("") }
    var tempText: String
    val logContent = remember { StringBuilder() }
    var showFloatAction by rememberSaveable { mutableStateOf(false) }
    val metaModuleAlertDialog = rememberCustomDialog { dismiss: () -> Unit ->
        val uriHandler = LocalUriHandler.current
        AlertDialog(
            onDismissRequest = { dismiss() },
            icon = {
                Icon(Icons.Outlined.Info, contentDescription = null)
            },
            title = {
                Row(modifier = Modifier
                    .fillMaxWidth(),
                    horizontalArrangement = Arrangement.Center
                ) {
                    Text(text = stringResource(R.string.warning_of_meta_module_title))
                }
            },
            text = {
                Text(text = stringResource(R.string.warning_of_meta_module_summary))
            },
            confirmButton = {
                FilledTonalButton(onClick = { dismiss() }) {
                    Text(text = stringResource(id = android.R.string.ok))
                }
            },
            dismissButton = {
                OutlinedButton(onClick = {
                    uriHandler.openUri("https://apatch.dev/meta-module.html")
                }) {
                    Text(text = stringResource(id = R.string.learn_more))
                }
            },
        )
    }

    val context = LocalContext.current
    val snackBarHost = LocalSnackbarHost.current
    val scope = rememberCoroutineScope()
    val scrollState = rememberScrollState()

    LaunchedEffect(Unit) {
        if (text.isNotEmpty()) {
            return@LaunchedEffect
        }
        withContext(Dispatchers.IO) {
            installModule(uri, type, onFinish = { success ->
                if (!success) return@installModule

                scope.launch {
                    showFloatAction = true

                    // check metamodule
                    if (hasMetaModule()) return@launch
                    val mountOldDirectory =
                        SuFile.open("/data/adb/modules/${getModuleIdFromUri(context, uri)}/system")
                    val mountNewDirectory =
                        SuFile.open("/data/adb/modules_update/${getModuleIdFromUri(context, uri)}/system")
                    if (!mountNewDirectory.isDirectory && !mountOldDirectory.isDirectory) return@launch

                    metaModuleAlertDialog.show()
                }

            }, onStdout = {
                tempText = "$it\n"
                if (tempText.startsWith("[H[J")) { // clear command
                    text = tempText.substring(6)
                } else {
                    text += tempText
                }
                logContent.append(it).append("\n")
            }, onStderr = {
                tempText = "$it\n"
                if (tempText.startsWith("[H[J")) { // clear command
                    text = tempText.substring(6)
                } else {
                    text += tempText
                }
                logContent.append(it).append("\n")
            })
        }
    }

    Scaffold(topBar = {
        TopBar(onBack = dropUnlessResumed {
            navigator.popBackStack()
        }, onSave = {
            scope.launch {
                val format = SimpleDateFormat("yyyy-MM-dd-HH-mm-ss", Locale.getDefault())
                val date = format.format(Date())
                val file = File(
                    Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS),
                    "APatch_install_${type}_log_${date}.log"
                )
                file.writeText(logContent.toString())
                snackBarHost.showSnackbar("Log saved to ${file.absolutePath}")
            }
        })
    }, floatingActionButton = {
        if (showFloatAction) {
            val reboot = stringResource(id = R.string.reboot)
            ExtendedFloatingActionButton(
                onClick = {
                    scope.launch {
                        withContext(Dispatchers.IO) {
                            reboot()
                        }
                    }
                },
                icon = { Icon(Icons.Filled.Refresh, reboot) },
                text = { Text(text = reboot) },
            )
        }

    }, snackbarHost = { SnackbarHost(snackBarHost) }) { innerPadding ->
        KeyEventBlocker {
            it.key == Key.VolumeDown || it.key == Key.VolumeUp
        }
        Column(
            modifier = Modifier
                .fillMaxSize(1f)
                .padding(innerPadding)
                .verticalScroll(scrollState),
        ) {
            LaunchedEffect(text) {
                scrollState.animateScrollTo(scrollState.maxValue)
            }
            Text(
                modifier = Modifier.padding(8.dp),
                text = text,
                fontSize = MaterialTheme.typography.bodySmall.fontSize,
                fontFamily = FontFamily.Monospace,
                lineHeight = MaterialTheme.typography.bodySmall.lineHeight,
            )
        }
    }
}

fun isUriAccessible(context: Context, uri: Uri): Boolean {
    if (uri == Uri.EMPTY) return false

    return try {
        context.contentResolver.openInputStream(uri)?.use {} != null
    } catch (e: Exception) {
        Log.e("ModuleInstall", "URI is inaccessible: $uri", e)
        false
    }
}


fun extractModuleId(context: Context, uri: Uri): String? {
    if (uri == Uri.EMPTY) return null

    context.contentResolver.openInputStream(uri)?.use { inputStream ->
        ZipInputStream(inputStream).use { zip ->
            var entry: ZipEntry?

            while (zip.nextEntry.also { entry = it } != null) {
                if (entry?.name == "module.prop") {
                    val prop = Properties()
                    prop.load(zip)
                    return prop.getProperty("id")
                }
            }
        }
    }

    return null
}

suspend fun getModuleIdFromUri(context: Context, uri: Uri): String? {
    return withContext(Dispatchers.IO) {
        try {
            if (uri == Uri.EMPTY) {
                return@withContext null
            }
            if (!isUriAccessible(context, uri)) {
                return@withContext null
            }
            extractModuleId(context, uri)
        } catch (_: Exception) {
            null
        }
    }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
private fun TopBar(onBack: () -> Unit = {}, onSave: () -> Unit = {}) {
    TopAppBar(title = { Text(stringResource(R.string.apm_install)) }, navigationIcon = {
        IconButton(
            onClick = onBack
        ) { Icon(Icons.AutoMirrored.Filled.ArrowBack, contentDescription = null) }
    }, actions = {
        IconButton(onClick = onSave) {
            Icon(
                imageVector = Icons.Filled.Save, contentDescription = "Localized description"
            )
        }
    })
}

@Preview
@Composable
fun InstallPreview() {
//    InstallScreen(DestinationsNavigator(), uri = Uri.EMPTY)
}
```

`app/src/main/java/me/bmax/apatch/ui/screen/InstallModeSelect.kt`:

```kt
package me.bmax.apatch.ui.screen

import android.app.Activity
import android.content.Intent
import android.net.Uri
import androidx.activity.compose.rememberLauncherForActivityResult
import androidx.activity.result.contract.ActivityResultContracts
import androidx.annotation.StringRes
import androidx.compose.foundation.clickable
import androidx.compose.foundation.layout.Column
import androidx.compose.foundation.layout.Row
import androidx.compose.foundation.layout.fillMaxWidth
import androidx.compose.foundation.layout.padding
import androidx.compose.material.icons.Icons
import androidx.compose.material.icons.automirrored.filled.ArrowBack
import androidx.compose.material3.ExperimentalMaterial3Api
import androidx.compose.material3.Icon
import androidx.compose.material3.IconButton
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.RadioButton
import androidx.compose.material3.Scaffold
import androidx.compose.material3.Text
import androidx.compose.material3.TopAppBar
import androidx.compose.runtime.Composable
import androidx.compose.runtime.getValue
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.remember
import androidx.compose.runtime.setValue
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.res.stringResource
import androidx.lifecycle.compose.dropUnlessResumed
import com.ramcosta.composedestinations.annotation.Destination
import com.ramcosta.composedestinations.annotation.RootGraph
import com.ramcosta.composedestinations.generated.destinations.PatchesDestination
import com.ramcosta.composedestinations.navigation.DestinationsNavigator
import me.bmax.apatch.R
import me.bmax.apatch.ui.component.rememberConfirmDialog
import me.bmax.apatch.ui.viewmodel.PatchesViewModel
import me.bmax.apatch.util.isABDevice
import me.bmax.apatch.util.rootAvailable

var selectedBootImage: Uri? = null

@Destination<RootGraph>
@Composable
fun InstallModeSelectScreen(navigator: DestinationsNavigator) {
    var installMethod by remember {
        mutableStateOf<InstallMethod?>(null)
    }

    Scaffold(topBar = {
        TopBar(
            onBack = dropUnlessResumed { navigator.popBackStack() },
        )
    }) {
        Column(modifier = Modifier.padding(it)) {
            SelectInstallMethod(
                onSelected = { method ->
                    installMethod = method
                },
                navigator = navigator
            )

        }
    }
}

sealed class InstallMethod {
    data class SelectFile(
        val uri: Uri? = null,
        @param:StringRes override val label: Int = R.string.mode_select_page_select_file,
    ) : InstallMethod()

    data object DirectInstall : InstallMethod() {
        override val label: Int
            get() = R.string.mode_select_page_patch_and_install
    }

    data object DirectInstallToInactiveSlot : InstallMethod() {
        override val label: Int
            get() = R.string.mode_select_page_install_inactive_slot
    }

    abstract val label: Int
    open val summary: String? = null
}

@Composable
private fun SelectInstallMethod(
    onSelected: (InstallMethod) -> Unit = {},
    navigator: DestinationsNavigator
) {
    val rootAvailable = rootAvailable()
    val isAbDevice = isABDevice()

    val radioOptions =
        mutableListOf<InstallMethod>(InstallMethod.SelectFile())
    if (rootAvailable) {
        radioOptions.add(InstallMethod.DirectInstall)
        if (isAbDevice) {
            radioOptions.add(InstallMethod.DirectInstallToInactiveSlot)
        }
    }

    var selectedOption by remember { mutableStateOf<InstallMethod?>(null) }
    val selectImageLauncher = rememberLauncherForActivityResult(
        contract = ActivityResultContracts.StartActivityForResult()
    ) {
        if (it.resultCode == Activity.RESULT_OK) {
            it.data?.data?.let { uri ->
                val option = InstallMethod.SelectFile(uri)
                selectedOption = option
                onSelected(option)
                selectedBootImage = option.uri
                navigator.navigate(PatchesDestination(PatchesViewModel.PatchMode.PATCH_ONLY))
            }
        }
    }

    val confirmDialog = rememberConfirmDialog(onConfirm = {
        selectedOption = InstallMethod.DirectInstallToInactiveSlot
        onSelected(InstallMethod.DirectInstallToInactiveSlot)
        navigator.navigate(PatchesDestination(PatchesViewModel.PatchMode.INSTALL_TO_NEXT_SLOT))
    }, onDismiss = null)
    val dialogTitle = stringResource(id = android.R.string.dialog_alert_title)
    val dialogContent = stringResource(id = R.string.mode_select_page_install_inactive_slot_warning)

    val onClick = { option: InstallMethod ->
        when (option) {
            is InstallMethod.SelectFile -> {
                // Reset before selecting
                selectedBootImage = null
                selectImageLauncher.launch(
                    Intent(Intent.ACTION_GET_CONTENT).apply {
                        type = "application/octet-stream"
                    }
                )
            }

            is InstallMethod.DirectInstall -> {
                selectedOption = option
                onSelected(option)
                navigator.navigate(PatchesDestination(PatchesViewModel.PatchMode.PATCH_AND_INSTALL))
            }

            is InstallMethod.DirectInstallToInactiveSlot -> {
                confirmDialog.showConfirm(dialogTitle, dialogContent)
            }
        }
    }

    Column {
        radioOptions.forEach { option ->
            Row(
                verticalAlignment = Alignment.CenterVertically,
                modifier = Modifier
                    .fillMaxWidth()
                    .clickable {
                        onClick(option)
                    }) {
                RadioButton(selected = option.javaClass == selectedOption?.javaClass, onClick = {
                    onClick(option)
                })
                Column {
                    Text(
                        text = stringResource(id = option.label),
                        fontSize = MaterialTheme.typography.titleMedium.fontSize,
                        fontFamily = MaterialTheme.typography.titleMedium.fontFamily,
                        fontStyle = MaterialTheme.typography.titleMedium.fontStyle
                    )
                    option.summary?.let {
                        Text(
                            text = it,
                            fontSize = MaterialTheme.typography.bodySmall.fontSize,
                            fontFamily = MaterialTheme.typography.bodySmall.fontFamily,
                            fontStyle = MaterialTheme.typography.bodySmall.fontStyle
                        )
                    }
                }
            }
        }
    }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
private fun TopBar(onBack: () -> Unit = {}) {
    TopAppBar(
        title = { Text(stringResource(R.string.mode_select_page_title)) },
        navigationIcon = {
            IconButton(
                onClick = onBack
            ) { Icon(Icons.AutoMirrored.Filled.ArrowBack, contentDescription = null) }
        },
    )
}
```

`app/src/main/java/me/bmax/apatch/ui/screen/KPM.kt`:

```kt
package me.bmax.apatch.ui.screen

import android.app.Activity.RESULT_OK
import android.content.Intent
import android.net.Uri
import android.util.Log
import android.widget.Toast
import androidx.activity.compose.rememberLauncherForActivityResult
import androidx.activity.result.contract.ActivityResultContracts
import androidx.compose.foundation.layout.Arrangement
import androidx.compose.foundation.layout.Box
import androidx.compose.foundation.layout.Column
import androidx.compose.foundation.layout.PaddingValues
import androidx.compose.foundation.layout.Row
import androidx.compose.foundation.layout.Spacer
import androidx.compose.foundation.layout.fillMaxSize
import androidx.compose.foundation.layout.fillMaxWidth
import androidx.compose.foundation.layout.height
import androidx.compose.foundation.layout.padding
import androidx.compose.foundation.layout.size
import androidx.compose.foundation.layout.width
import androidx.compose.foundation.layout.wrapContentHeight
import androidx.compose.foundation.lazy.LazyColumn
import androidx.compose.foundation.lazy.LazyListState
import androidx.compose.foundation.lazy.items
import androidx.compose.foundation.lazy.rememberLazyListState
import androidx.compose.foundation.shape.RoundedCornerShape
import androidx.compose.material3.AlertDialogDefaults
import androidx.compose.material3.BasicAlertDialog
import androidx.compose.material3.Button
import androidx.compose.material3.DropdownMenu
import androidx.compose.material3.DropdownMenuItem
import androidx.compose.material3.ExperimentalMaterial3Api
import androidx.compose.material3.FilledTonalButton
import androidx.compose.material3.FloatingActionButton
import androidx.compose.material3.HorizontalDivider
import androidx.compose.material3.Icon
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.OutlinedTextField
import androidx.compose.material3.Scaffold
import androidx.compose.material3.SearchBarScrollBehavior
import androidx.compose.material3.Surface
import androidx.compose.material3.Text
import androidx.compose.material3.TextButton
import androidx.compose.material3.pulltorefresh.PullToRefreshBox
import androidx.compose.runtime.Composable
import androidx.compose.runtime.LaunchedEffect
import androidx.compose.runtime.MutableState
import androidx.compose.runtime.getValue
import androidx.compose.runtime.livedata.observeAsState
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.remember
import androidx.compose.runtime.rememberCoroutineScope
import androidx.compose.runtime.setValue
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.draw.alpha
import androidx.compose.ui.input.nestedscroll.nestedScroll
import androidx.compose.ui.platform.LocalContext
import androidx.compose.ui.platform.LocalView
import androidx.compose.ui.res.painterResource
import androidx.compose.ui.res.stringResource
import androidx.compose.ui.text.font.FontWeight
import androidx.compose.ui.text.input.VisualTransformation
import androidx.compose.ui.text.style.TextAlign
import androidx.compose.ui.text.style.TextDecoration
import androidx.compose.ui.text.style.TextOverflow
import androidx.compose.ui.unit.dp
import androidx.compose.ui.window.DialogProperties
import androidx.compose.ui.window.DialogWindowProvider
import androidx.compose.ui.window.PopupProperties
import androidx.lifecycle.viewmodel.compose.viewModel
import com.ramcosta.composedestinations.annotation.Destination
import com.ramcosta.composedestinations.annotation.RootGraph
import com.ramcosta.composedestinations.generated.destinations.InstallScreenDestination
import com.ramcosta.composedestinations.generated.destinations.PatchesDestination
import com.ramcosta.composedestinations.navigation.DestinationsNavigator
import com.topjohnwu.superuser.nio.ExtendedFile
import com.topjohnwu.superuser.nio.FileSystemManager
import kotlinx.coroutines.Dispatchers
import kotlinx.coroutines.launch
import kotlinx.coroutines.withContext
import me.bmax.apatch.APApplication
import me.bmax.apatch.Natives
import me.bmax.apatch.R
import me.bmax.apatch.apApp
import me.bmax.apatch.ui.component.ConfirmResult
import me.bmax.apatch.ui.component.KPModuleRemoveButton
import me.bmax.apatch.ui.component.LoadingDialogHandle
import me.bmax.apatch.ui.component.ProvideMenuShape
import me.bmax.apatch.ui.component.SearchAppBar
import me.bmax.apatch.ui.component.pinnedScrollBehavior
import me.bmax.apatch.ui.component.rememberConfirmDialog
import me.bmax.apatch.ui.component.rememberLoadingDialog
import me.bmax.apatch.ui.viewmodel.KPModel
import me.bmax.apatch.ui.viewmodel.KPModuleViewModel
import me.bmax.apatch.ui.viewmodel.PatchesViewModel
import me.bmax.apatch.util.inputStream
import me.bmax.apatch.util.ui.APDialogBlurBehindUtils
import me.bmax.apatch.util.writeTo
import java.io.IOException

private const val TAG = "KernelPatchModule"
private lateinit var targetKPMToControl: KPModel.KPMInfo

@OptIn(ExperimentalMaterial3Api::class)
@Destination<RootGraph>
@Composable
fun KPModuleScreen(navigator: DestinationsNavigator) {
    val state by APApplication.apStateLiveData.observeAsState(APApplication.State.UNKNOWN_STATE)
    if (state == APApplication.State.UNKNOWN_STATE) {
        Column(
            modifier = Modifier
                .fillMaxSize()
                .padding(12.dp),
            verticalArrangement = Arrangement.Center,
            horizontalAlignment = Alignment.CenterHorizontally
        ) {
            Row {
                Text(
                    text = stringResource(id = R.string.kpm_kp_not_installed),
                    style = MaterialTheme.typography.titleMedium
                )
            }
        }
        return
    }

    val viewModel = viewModel<KPModuleViewModel>()
    val scrollBehavior = pinnedScrollBehavior()
    val kpModuleListState = rememberLazyListState()

    LaunchedEffect(Unit) {
        if (viewModel.moduleList.isEmpty() || viewModel.isNeedRefresh) {
            viewModel.fetchModuleList()
        }
    }

    Scaffold(topBar = {
        SearchAppBar(
            searchText = viewModel.search,
            onSearchTextChange = { viewModel.search = it },
            scrollBehavior = scrollBehavior,
            searchBarPlaceHolderText = stringResource(R.string.search_modules)
        )
    }, floatingActionButton = run {
        {
            val scope = rememberCoroutineScope()
            val context = LocalContext.current

            val moduleLoad = stringResource(id = R.string.kpm_load)
            val moduleInstall = stringResource(id = R.string.kpm_install)
            val moduleEmbed = stringResource(id = R.string.kpm_embed)
            val successToastText = stringResource(id = R.string.kpm_load_toast_succ)
            val failToastText = stringResource(id = R.string.kpm_load_toast_failed)
            val loadingDialog = rememberLoadingDialog()

            val selectZipLauncher = rememberLauncherForActivityResult(
                contract = ActivityResultContracts.StartActivityForResult()
            ) {
                if (it.resultCode != RESULT_OK) {
                    return@rememberLauncherForActivityResult
                }
                val data = it.data ?: return@rememberLauncherForActivityResult
                val uri = data.data ?: return@rememberLauncherForActivityResult

                Log.i(TAG, "select zip result: $uri")

                navigator.navigate(InstallScreenDestination(uri, MODULE_TYPE.KPM))
            }

            val selectKpmLauncher = rememberLauncherForActivityResult(
                contract = ActivityResultContracts.StartActivityForResult()
            ) {
                if (it.resultCode != RESULT_OK) {
                    return@rememberLauncherForActivityResult
                }
                val data = it.data ?: return@rememberLauncherForActivityResult
                val uri = data.data ?: return@rememberLauncherForActivityResult

                // todo: args
                scope.launch {
                    val rc = loadModule(loadingDialog, uri, "")
                    val toastText = if (rc == 0) successToastText else "$failToastText: $rc"
                    withContext(Dispatchers.Main) {
                        Toast.makeText(
                            context, toastText, Toast.LENGTH_SHORT
                        ).show()
                    }
                    viewModel.markNeedRefresh()
                    viewModel.fetchModuleList()
                }
            }

            var expanded by remember { mutableStateOf(false) }
            val options = listOf(moduleEmbed, moduleInstall, moduleLoad)

            Column {
                FloatingActionButton(
                    onClick = {
                        expanded = !expanded
                    },
                    contentColor = MaterialTheme.colorScheme.onPrimary,
                    containerColor = MaterialTheme.colorScheme.primary,
                ) {
                    Icon(
                        painter = painterResource(id = R.drawable.package_import),
                        contentDescription = null
                    )
                }

                ProvideMenuShape(RoundedCornerShape(10.dp)) {
                    DropdownMenu(
                        expanded = expanded,
                        onDismissRequest = { expanded = false },
                        properties = PopupProperties(focusable = true)
                    ) {
                        options.forEach { label ->
                            DropdownMenuItem(text = { Text(label) }, onClick = {
                                expanded = false
                                when (label) {
                                    moduleEmbed -> {
                                        navigator.navigate(PatchesDestination(PatchesViewModel.PatchMode.PATCH_AND_INSTALL))
                                    }

                                    moduleInstall -> {
//                                        val intent = Intent(Intent.ACTION_GET_CONTENT)
//                                        intent.type = "application/zip"
//                                        selectZipLauncher.launch(intent)
                                        Toast.makeText(
                                            context,
                                            "Under development",
                                            Toast.LENGTH_SHORT
                                        ).show()
                                    }

                                    moduleLoad -> {
                                        val intent = Intent(Intent.ACTION_GET_CONTENT)
                                        intent.type = "*/*"
                                        selectKpmLauncher.launch(intent)
                                    }
                                }
                            })
                        }
                    }
                }
            }
        }
    }) { innerPadding ->
        KPModuleList(
            viewModel = viewModel,
            modules = viewModel.moduleList,
            modifier = Modifier
                .padding(innerPadding)
                .fillMaxSize(),
            state = kpModuleListState,
            scrollBehavior = scrollBehavior
        )
    }
}

suspend fun loadModule(loadingDialog: LoadingDialogHandle, uri: Uri, args: String): Int {
    val rc = loadingDialog.withLoading {
        withContext(Dispatchers.IO) {
            run {
                val kpmDir: ExtendedFile =
                    FileSystemManager.getLocal().getFile(apApp.filesDir.parent, "kpm")
                kpmDir.deleteRecursively()
                kpmDir.mkdirs()
                val rand = (1..4).map { ('a'..'z').random() }.joinToString("")
                val kpm = kpmDir.getChildFile("${rand}.kpm")
                Log.d(TAG, "save tmp kpm: ${kpm.path}")
                var rc = -1
                try {
                    uri.inputStream().buffered().writeTo(kpm)
                    rc = Natives.loadKernelPatchModule(kpm.path, args).toInt()
                } catch (e: IOException) {
                    Log.e(TAG, "Copy kpm error: $e")
                }
                Log.d(TAG, "load ${kpm.path} rc: $rc")
                rc
            }
        }
    }
    return rc
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun KPMControlDialog(showDialog: MutableState<Boolean>) {
    var controlParam by remember { mutableStateOf("") }
    var enable by remember { mutableStateOf(false) }
    val scope = rememberCoroutineScope()
    val loadingDialog = rememberLoadingDialog()
    val context = LocalContext.current
    val outMsgStringRes = stringResource(id = R.string.kpm_control_outMsg)
    val okStringRes = stringResource(id = R.string.kpm_control_ok)
    val failedStringRes = stringResource(id = R.string.kpm_control_failed)

    lateinit var controlResult: Natives.KPMCtlRes

    suspend fun onModuleControl(module: KPModel.KPMInfo) {
        loadingDialog.withLoading {
            withContext(Dispatchers.IO) {
                controlResult = Natives.kernelPatchModuleControl(module.name, controlParam)
            }
        }

        if (controlResult.rc >= 0) {
            Toast.makeText(
                context,
                "$okStringRes\n${outMsgStringRes}: ${controlResult.outMsg}",
                Toast.LENGTH_SHORT
            ).show()
        } else {
            Toast.makeText(
                context,
                "$failedStringRes\n${outMsgStringRes}: ${controlResult.outMsg}",
                Toast.LENGTH_SHORT
            ).show()
        }
    }

    BasicAlertDialog(
        onDismissRequest = { showDialog.value = false }, properties = DialogProperties(
            decorFitsSystemWindows = true,
            usePlatformDefaultWidth = false,
        )
    ) {
        Surface(
            modifier = Modifier
                .width(310.dp)
                .wrapContentHeight(),
            shape = RoundedCornerShape(30.dp),
            tonalElevation = AlertDialogDefaults.TonalElevation,
            color = AlertDialogDefaults.containerColor,
        ) {
            Column(modifier = Modifier.padding(PaddingValues(all = 24.dp))) {
                Box(
                    Modifier
                        .padding(PaddingValues(bottom = 16.dp))
                        .align(Alignment.Start)
                ) {
                    Text(
                        text = stringResource(id = R.string.kpm_control_dialog_title),
                        style = MaterialTheme.typography.headlineSmall
                    )
                }

                Box(
                    Modifier
                        .weight(weight = 1f, fill = false)
                        .align(Alignment.Start)
                ) {
                    Text(
                        text = stringResource(id = R.string.kpm_control_dialog_content),
                        style = MaterialTheme.typography.bodyMedium
                    )
                }

                Box(
                    contentAlignment = Alignment.CenterEnd,
                ) {
                    OutlinedTextField(
                        value = controlParam,
                        modifier = Modifier
                            .fillMaxWidth()
                            .padding(top = 6.dp),
                        onValueChange = {
                            controlParam = it
                            enable = controlParam.isNotBlank()
                        },
                        shape = RoundedCornerShape(50.0f),
                        label = { Text(stringResource(id = R.string.kpm_control_paramters)) },
                        visualTransformation = VisualTransformation.None,
                    )
                }

                Spacer(modifier = Modifier.height(12.dp))
                Row(
                    modifier = Modifier.fillMaxWidth(), horizontalArrangement = Arrangement.End
                ) {
                    TextButton(onClick = { showDialog.value = false }) {
                        Text(stringResource(id = android.R.string.cancel))
                    }

                    Button(onClick = {
                        showDialog.value = false

                        scope.launch { onModuleControl(targetKPMToControl) }

                    }, enabled = enable) {
                        Text(stringResource(id = android.R.string.ok))
                    }
                }
            }
        }
        val dialogWindowProvider = LocalView.current.parent as DialogWindowProvider
        APDialogBlurBehindUtils.setupWindowBlurListener(dialogWindowProvider.window)
    }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
private fun KPModuleList(
    viewModel: KPModuleViewModel,
    modules: List<KPModel.KPMInfo>,
    modifier: Modifier = Modifier,
    state: LazyListState,
    scrollBehavior: SearchBarScrollBehavior
) {
    val moduleStr = stringResource(id = R.string.kpm)
    val moduleUninstallConfirm = stringResource(id = R.string.kpm_unload_confirm)
    val uninstall = stringResource(id = R.string.kpm_unload)
    val cancel = stringResource(id = android.R.string.cancel)

    val confirmDialog = rememberConfirmDialog()
    val loadingDialog = rememberLoadingDialog()

    val showKPMControlDialog = remember { mutableStateOf(false) }
    if (showKPMControlDialog.value) {
        KPMControlDialog(showDialog = showKPMControlDialog)
    }

    suspend fun onModuleUninstall(module: KPModel.KPMInfo) {
        val confirmResult = confirmDialog.awaitConfirm(
            moduleStr,
            content = moduleUninstallConfirm.format(module.name),
            confirm = uninstall,
            dismiss = cancel
        )
        if (confirmResult != ConfirmResult.Confirmed) {
            return
        }

        val success = loadingDialog.withLoading {
            withContext(Dispatchers.IO) {
                Natives.unloadKernelPatchModule(module.name) == 0L
            }
        }

        if (success) {
            viewModel.fetchModuleList()
        }
    }

    PullToRefreshBox(
        modifier = modifier,
        onRefresh = { viewModel.fetchModuleList() },
        isRefreshing = viewModel.isRefreshing
    ) {
        LazyColumn(
            modifier = Modifier.fillMaxSize().nestedScroll(scrollBehavior.nestedScrollConnection),
            state = state,
            verticalArrangement = Arrangement.spacedBy(16.dp),
            contentPadding = remember {
                PaddingValues(
                    start = 16.dp,
                    top = 11.dp, // spacedBy - TopBar padding
                    end = 16.dp,
                    bottom = 16.dp + 16.dp + 56.dp /*  Scaffold Fab Spacing + Fab container height */
                )
            },
        ) {
            when {
                modules.isEmpty() -> {
                    item {
                        Box(
                            modifier = Modifier.fillParentMaxSize(),
                            contentAlignment = Alignment.Center
                        ) {
                            Text(
                                stringResource(R.string.kpm_apm_empty), textAlign = TextAlign.Center
                            )
                        }
                    }
                }

                else -> {
                    items(modules) { module ->
                        val scope = rememberCoroutineScope()
                        KPModuleItem(
                            module,
                            onUninstall = {
                                scope.launch { onModuleUninstall(module) }
                            },
                            onControl = {
                                targetKPMToControl = module
                                showKPMControlDialog.value = true
                            },
                        )

                        // fix last item shadow incomplete in LazyColumn
                        Spacer(Modifier.height(1.dp))
                    }
                }
            }
        }
    }
}

@Composable
private fun KPModuleItem(
    module: KPModel.KPMInfo,
    onUninstall: (KPModel.KPMInfo) -> Unit,
    onControl: (KPModel.KPMInfo) -> Unit,
    modifier: Modifier = Modifier,
    alpha: Float = 1f,
) {
    val moduleAuthor = stringResource(id = R.string.kpm_author)
    val moduleArgs = stringResource(id = R.string.kpm_args)
    val decoration = TextDecoration.None

    Surface(
        modifier = modifier,
        color = MaterialTheme.colorScheme.surface,
        tonalElevation = 1.dp,
        shape = RoundedCornerShape(20.dp)
    ) {

        Box(
            modifier = Modifier.fillMaxWidth(), contentAlignment = Alignment.Center
        ) {
            Column(
                modifier = Modifier.fillMaxWidth()
            ) {
                Row(
                    modifier = Modifier.padding(all = 16.dp),
                    verticalAlignment = Alignment.CenterVertically
                ) {
                    Column(
                        modifier = Modifier
                            .alpha(alpha = alpha)
                            .weight(1f),
                        verticalArrangement = Arrangement.spacedBy(2.dp)
                    ) {
                        Text(
                            text = module.name,
                            style = MaterialTheme.typography.titleSmall.copy(fontWeight = FontWeight.Bold),
                            maxLines = 2,
                            textDecoration = decoration,
                            overflow = TextOverflow.Ellipsis
                        )

                        Text(
                            text = "${module.version}, $moduleAuthor ${module.author}",
                            style = MaterialTheme.typography.bodySmall,
                            textDecoration = decoration,
                            color = MaterialTheme.colorScheme.onSurfaceVariant
                        )

                        Text(
                            text = "$moduleArgs: ${module.args}",
                            style = MaterialTheme.typography.bodySmall,
                            textDecoration = decoration,
                            color = MaterialTheme.colorScheme.onSurfaceVariant
                        )
                    }

                }

                Text(
                    modifier = Modifier
                        .alpha(alpha = alpha)
                        .padding(horizontal = 16.dp),
                    text = module.description,
                    style = MaterialTheme.typography.bodySmall,
                    textDecoration = decoration,
                    color = MaterialTheme.colorScheme.outline
                )

                HorizontalDivider(
                    thickness = 1.5.dp,
                    color = MaterialTheme.colorScheme.surface,
                    modifier = Modifier.padding(top = 8.dp)
                )

                Row(
                    modifier = Modifier
                        .padding(horizontal = 16.dp, vertical = 8.dp)
                        .fillMaxWidth(),
                    verticalAlignment = Alignment.CenterVertically
                ) {
                    Spacer(modifier = Modifier.weight(1f))

                    FilledTonalButton(
                        onClick = { onControl(module) },
                        enabled = true,
                        contentPadding = PaddingValues(12.dp)
                    ) {
                        Icon(
                            modifier = Modifier.size(20.dp),
                            painter = painterResource(id = R.drawable.settings),
                            contentDescription = stringResource(id = R.string.kpm_control)
                        )
                    }

                    Spacer(modifier = Modifier.width(12.dp))

                    KPModuleRemoveButton(enabled = true, onClick = { onUninstall(module) })
                }
            }

        }
    }
}

```

`app/src/main/java/me/bmax/apatch/ui/screen/Patches.kt`:

```kt
package me.bmax.apatch.ui.screen

import android.Manifest
import android.app.Activity
import android.content.Intent
import android.content.pm.PackageManager
import android.net.Uri
import android.util.Log
import androidx.activity.compose.rememberLauncherForActivityResult
import androidx.activity.result.contract.ActivityResultContracts
import androidx.compose.foundation.background
import androidx.compose.foundation.clickable
import androidx.compose.foundation.layout.Arrangement
import androidx.compose.foundation.layout.Box
import androidx.compose.foundation.layout.Column
import androidx.compose.foundation.layout.Row
import androidx.compose.foundation.layout.Spacer
import androidx.compose.foundation.layout.fillMaxWidth
import androidx.compose.foundation.layout.height
import androidx.compose.foundation.layout.padding
import androidx.compose.foundation.layout.size
import androidx.compose.foundation.layout.wrapContentWidth
import androidx.compose.foundation.rememberScrollState
import androidx.compose.foundation.shape.RoundedCornerShape
import androidx.compose.foundation.text.BasicTextField
import androidx.compose.foundation.text.KeyboardOptions
import androidx.compose.foundation.text.selection.SelectionContainer
import androidx.compose.foundation.verticalScroll
import androidx.compose.material.icons.Icons
import androidx.compose.material.icons.filled.Delete
import androidx.compose.material.icons.filled.Refresh
import androidx.compose.material.icons.filled.Visibility
import androidx.compose.material.icons.filled.VisibilityOff
import androidx.compose.material.icons.filled.Settings
import androidx.compose.foundation.layout.PaddingValues
import androidx.compose.foundation.layout.width
import androidx.compose.foundation.layout.wrapContentHeight
import androidx.compose.material3.AlertDialogDefaults
import androidx.compose.material3.BasicAlertDialog
import androidx.compose.material3.Surface
import androidx.compose.material3.TextButton
import androidx.compose.ui.platform.LocalView
import androidx.compose.ui.window.DialogProperties
import androidx.compose.ui.window.DialogWindowProvider
import me.bmax.apatch.util.ui.APDialogBlurBehindUtils
import androidx.compose.material3.Button
import androidx.compose.material3.CardDefaults
import androidx.compose.material3.CircularProgressIndicator
import androidx.compose.material3.ElevatedCard
import androidx.compose.material3.ExperimentalMaterial3Api
import androidx.compose.material3.ExtendedFloatingActionButton
import androidx.compose.material3.Icon
import androidx.compose.material3.IconButton
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.OutlinedTextField
import androidx.compose.material3.Scaffold
import androidx.compose.material3.Text
import androidx.compose.material3.TopAppBar
import androidx.compose.runtime.Composable
import androidx.compose.runtime.LaunchedEffect
import androidx.compose.runtime.SideEffect
import androidx.compose.runtime.getValue
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.remember
import androidx.compose.runtime.rememberCoroutineScope
import androidx.compose.runtime.setValue
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.graphics.Color
import androidx.compose.ui.platform.LocalContext
import androidx.compose.ui.res.stringResource
import androidx.compose.ui.text.input.KeyboardType
import androidx.compose.ui.text.input.PasswordVisualTransformation
import androidx.compose.ui.text.input.VisualTransformation
import androidx.compose.ui.unit.dp
import androidx.core.app.ActivityCompat
import androidx.core.content.ContextCompat
import androidx.lifecycle.viewmodel.compose.viewModel
import com.ramcosta.composedestinations.annotation.Destination
import com.ramcosta.composedestinations.annotation.RootGraph
import kotlinx.coroutines.Dispatchers
import kotlinx.coroutines.launch
import kotlinx.coroutines.withContext
import me.bmax.apatch.R
import me.bmax.apatch.ui.viewmodel.KPModel
import me.bmax.apatch.ui.viewmodel.PatchesViewModel
import me.bmax.apatch.util.Version
import me.bmax.apatch.util.reboot

private const val TAG = "Patches"

@Destination<RootGraph>
@Composable
fun Patches(mode: PatchesViewModel.PatchMode) {
    val scrollState = rememberScrollState()
    val scope = rememberCoroutineScope()

    val viewModel = viewModel<PatchesViewModel>()
    SideEffect {
        viewModel.prepare(mode)
    }

    Scaffold(topBar = {
        TopBar()
    }, floatingActionButton = {
        if (viewModel.needReboot) {
            val reboot = stringResource(id = R.string.reboot)
            ExtendedFloatingActionButton(
                onClick = {
                    scope.launch {
                        withContext(Dispatchers.IO) {
                            reboot()
                        }
                    }
                },
                icon = { Icon(Icons.Filled.Refresh, reboot) },
                text = { Text(text = reboot) },
            )
        }
    }) { innerPadding ->
        Column(
            modifier = Modifier
                .padding(innerPadding)
                .padding(horizontal = 16.dp)
                .verticalScroll(scrollState),
            verticalArrangement = Arrangement.spacedBy(16.dp)
        ) {
            val context = LocalContext.current

            // request permissions
            val permissions = arrayOf(
                Manifest.permission.WRITE_EXTERNAL_STORAGE,
                Manifest.permission.READ_EXTERNAL_STORAGE
            )
            val permissionsToRequest = permissions.filter {
                ContextCompat.checkSelfPermission(context, it) != PackageManager.PERMISSION_GRANTED
            }
            if (permissionsToRequest.isNotEmpty()) {
                ActivityCompat.requestPermissions(
                    context as Activity,
                    permissionsToRequest.toTypedArray(),
                    1001
                )
            }

            PatchMode(mode)
            ErrorView(viewModel.error)
            KernelPatchImageView(viewModel.kpimgInfo)

            if (mode == PatchesViewModel.PatchMode.PATCH_ONLY && selectedBootImage != null && viewModel.kimgInfo.banner.isEmpty()) {
                viewModel.copyAndParseBootimg(selectedBootImage!!)
                // Fix endless loop. It's not normal if (parse done && working thread is not working) but banner still null
                // Leave user re-choose
                if (!viewModel.running && viewModel.kimgInfo.banner.isEmpty()) {
                    selectedBootImage = null
                }
            }

            // select boot.img
            if (mode == PatchesViewModel.PatchMode.PATCH_ONLY && viewModel.kimgInfo.banner.isEmpty()) {
                SelectFileButton(
                    text = stringResource(id = R.string.patch_select_bootimg_btn),
                    onSelected = { data, uri ->
                        Log.d(TAG, "select boot.img, data: $data, uri: $uri")
                        viewModel.copyAndParseBootimg(uri)
                    }
                )
            }

            if (viewModel.bootSlot.isNotEmpty() || viewModel.bootDev.isNotEmpty()) {
                BootimgView(slot = viewModel.bootSlot, boot = viewModel.bootDev)
            }

            if (viewModel.kimgInfo.banner.isNotEmpty()) {
                KernelImageView(viewModel.kimgInfo)
            }

            if (mode != PatchesViewModel.PatchMode.UNPATCH && viewModel.kimgInfo.banner.isNotEmpty()) {
                SetSuperKeyView(viewModel)
            }

            // existed extras
            if (mode == PatchesViewModel.PatchMode.PATCH_AND_INSTALL || mode == PatchesViewModel.PatchMode.INSTALL_TO_NEXT_SLOT) {
                viewModel.existedExtras.forEach(action = {
                    ExtraItem(extra = it, true, onDelete = {
                        viewModel.existedExtras.remove(it)
                    })
                })
            }

            // add new extras
            if (mode != PatchesViewModel.PatchMode.UNPATCH) {
                viewModel.newExtras.forEach(action = {
                    ExtraItem(extra = it, false, onDelete = {
                        val idx = viewModel.newExtras.indexOf(it)
                        viewModel.newExtras.remove(it)
                        viewModel.newExtrasFileName.removeAt(idx)
                    })
                })
            }

            // add new KPM
            if (viewModel.superkey.isNotEmpty() && !viewModel.patching && !viewModel.patchdone && mode != PatchesViewModel.PatchMode.UNPATCH) {
                SelectFileButton(
                    text = stringResource(id = R.string.patch_embed_kpm_btn),
                    onSelected = { data, uri ->
                        Log.d(TAG, "select kpm, data: $data, uri: $uri")
                        viewModel.embedKPM(uri)
                    }
                )
            }

            // do patch, update, unpatch
            if (!viewModel.patching && !viewModel.patchdone) {
                // patch start
                if (mode != PatchesViewModel.PatchMode.UNPATCH && viewModel.superkey.isNotEmpty()) {
                    StartButton(stringResource(id = R.string.patch_start_patch_btn)) {
                        viewModel.doPatch(
                            mode
                        )
                    }
                }
                // unpatch
                if (mode == PatchesViewModel.PatchMode.UNPATCH && viewModel.kimgInfo.banner.isNotEmpty()) {
                    StartButton(stringResource(id = R.string.patch_start_unpatch_btn)) { viewModel.doUnpatch() }
                }
            }

            // patch log
            if (viewModel.patching || viewModel.patchdone) {
                SelectionContainer {
                    Text(
                        modifier = Modifier.padding(8.dp),
                        text = viewModel.patchLog,
                        fontSize = MaterialTheme.typography.bodySmall.fontSize,
                        fontFamily = MaterialTheme.typography.bodySmall.fontFamily,
                        lineHeight = MaterialTheme.typography.bodySmall.lineHeight,
                    )
                }
                LaunchedEffect(viewModel.patchLog) {
                    scrollState.animateScrollTo(scrollState.maxValue)
                }
            }

            Spacer(modifier = Modifier.height(12.dp))

            // loading progress
            if (viewModel.running) {
                Box(
                    modifier = Modifier
                        .padding(innerPadding)
                        .align(Alignment.CenterHorizontally)
                ) {
                    CircularProgressIndicator(
                        modifier = Modifier
                            .size(50.dp)
                            .padding(16.dp)
                            .align(Alignment.BottomCenter)
                    )
                }
            }
        }
    }
}


@Composable
private fun StartButton(text: String, onClick: () -> Unit) {
    Column(
        modifier = Modifier
            .fillMaxWidth(),
        horizontalAlignment = Alignment.End
    ) {
        Button(
            onClick = onClick,
            content = {
                Text(text = text)
            }
        )
    }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
private fun ExtraConfigDialog(kpmInfo: KPModel.KPMInfo, onDismiss: () -> Unit) {
    var event by remember { mutableStateOf(kpmInfo.event) }
    var args by remember { mutableStateOf(kpmInfo.args) }

    BasicAlertDialog(
        onDismissRequest = onDismiss,
        properties = DialogProperties(
            decorFitsSystemWindows = true,
            usePlatformDefaultWidth = false,
        )
    ) {
        Surface(
            modifier = Modifier
                .width(310.dp)
                .wrapContentHeight(),
            shape = RoundedCornerShape(30.dp),
            tonalElevation = AlertDialogDefaults.TonalElevation,
            color = AlertDialogDefaults.containerColor,
        ) {
            Column(modifier = Modifier.padding(PaddingValues(all = 24.dp))) {
                Text(
                    text = stringResource(id = R.string.kpm_control_dialog_title),
                    style = MaterialTheme.typography.headlineSmall,
                    modifier = Modifier.padding(bottom = 16.dp)
                )

                OutlinedTextField(
                    value = event,
                    onValueChange = {
                        event = it
                        kpmInfo.event = it
                    },
                    label = { Text(stringResource(id = R.string.patch_item_extra_event)) },
                    modifier = Modifier.fillMaxWidth()
                )

                Spacer(modifier = Modifier.height(16.dp))

                OutlinedTextField(
                    value = args,
                    onValueChange = {
                        args = it
                        kpmInfo.args = it
                    },
                    label = { Text(stringResource(id = R.string.patch_item_extra_args)) },
                    modifier = Modifier.fillMaxWidth()
                )

                Spacer(modifier = Modifier.height(24.dp))

                Row(
                    modifier = Modifier.fillMaxWidth(),
                    horizontalArrangement = Arrangement.End
                ) {
                    TextButton(onClick = onDismiss) {
                        Text(stringResource(id = android.R.string.ok))
                    }
                }
            }
        }
        val dialogWindowProvider = LocalView.current.parent as DialogWindowProvider
        APDialogBlurBehindUtils.setupWindowBlurListener(dialogWindowProvider.window)
    }
}

@Composable
private fun ExtraItem(extra: KPModel.IExtraInfo, existed: Boolean, onDelete: () -> Unit) {
    var showConfigDialog by remember { mutableStateOf(false) }

    if (showConfigDialog && extra is KPModel.KPMInfo) {
        ExtraConfigDialog(extra, onDismiss = { showConfigDialog = false })
    }

    ElevatedCard(
        colors = CardDefaults.elevatedCardColors(containerColor = run {
            MaterialTheme.colorScheme.secondaryContainer.copy(alpha = 1f)
        }),
    ) {
        Column(
            modifier = Modifier
                .fillMaxWidth()
                .padding(12.dp),
        ) {
            Row(modifier = Modifier.align(Alignment.CenterHorizontally)) {
                Text(
                    text = stringResource(
                        id =
                            if (existed) R.string.patch_item_existed_extra_kpm else R.string.patch_item_new_extra_kpm
                    ) +
                            " " + extra.type.toString().uppercase(),
                    style = MaterialTheme.typography.bodyLarge,
                    modifier = Modifier
                        .weight(1f)
                        .wrapContentWidth(Alignment.CenterHorizontally)
                )
                if (extra.type == KPModel.ExtraType.KPM) {
                    Icon(
                        imageVector = Icons.Default.Settings,
                        contentDescription = "Config",
                        modifier = Modifier
                            .padding(end = 8.dp)
                            .clickable { showConfigDialog = true }
                    )
                }
                Icon(
                    imageVector = Icons.Default.Delete,
                    contentDescription = "Delete",
                    modifier = Modifier
                        .padding(end = 8.dp)
                        .clickable { onDelete() })
            }
            if (extra.type == KPModel.ExtraType.KPM) {
                val kpmInfo: KPModel.KPMInfo = extra as KPModel.KPMInfo
                Text(
                    text = "${stringResource(id = R.string.patch_item_extra_name) + " "} ${kpmInfo.name}",
                    style = MaterialTheme.typography.bodyMedium
                )
                Text(
                    text = "${stringResource(id = R.string.patch_item_extra_version) + " "} ${kpmInfo.version}",
                    style = MaterialTheme.typography.bodyMedium
                )
                Text(
                    text = "${stringResource(id = R.string.patch_item_extra_kpm_license) + " "} ${kpmInfo.license}",
                    style = MaterialTheme.typography.bodyMedium
                )
                Text(
                    text = "${stringResource(id = R.string.patch_item_extra_author) + " "} ${kpmInfo.author}",
                    style = MaterialTheme.typography.bodyMedium
                )
                Text(
                    text = "${stringResource(id = R.string.patch_item_extra_kpm_desciption) + " "} ${kpmInfo.description}",
                    style = MaterialTheme.typography.bodyMedium
                )
            }
        }
    }
}


@Composable
private fun SetSuperKeyView(viewModel: PatchesViewModel) {
    var skey by remember { mutableStateOf(viewModel.superkey) }
    var showWarn by remember { mutableStateOf(!viewModel.checkSuperKeyValidation(skey)) }
    var keyVisible by remember { mutableStateOf(false) }
    ElevatedCard(
        colors = CardDefaults.elevatedCardColors(containerColor = run {
            MaterialTheme.colorScheme.secondaryContainer
        })
    ) {
        Column(
            modifier = Modifier
                .fillMaxWidth()
                .padding(12.dp),
        ) {
            Column(
                modifier = Modifier
                    .fillMaxWidth(),
                horizontalAlignment = Alignment.CenterHorizontally
            ) {
                Text(
                    text = stringResource(id = R.string.patch_item_skey),
                    style = MaterialTheme.typography.bodyLarge
                )
            }
            if (showWarn) {
                Spacer(modifier = Modifier.height(3.dp))
                Text(
                    color = Color.Red,
                    text = stringResource(id = R.string.patch_item_set_skey_label),
                    style = MaterialTheme.typography.bodyMedium
                )
            }
            Column {
                //Spacer(modifier = Modifier.height(8.dp))
                Box(
                    contentAlignment = Alignment.CenterEnd,
                ) {
                    OutlinedTextField(
                        modifier = Modifier
                            .fillMaxWidth()
                            .padding(top = 6.dp),
                        value = skey,
                        label = { Text(stringResource(id = R.string.patch_set_superkey)) },
                        visualTransformation = if (keyVisible) VisualTransformation.None else PasswordVisualTransformation(),
                        keyboardOptions = KeyboardOptions(keyboardType = KeyboardType.Password),
                        shape = RoundedCornerShape(50.0f),
                        onValueChange = {
                            skey = it
                            if (viewModel.checkSuperKeyValidation(it)) {
                                viewModel.superkey = it
                                showWarn = false
                            } else {
                                viewModel.superkey = ""
                                showWarn = true
                            }
                        },
                    )
                    IconButton(
                        modifier = Modifier
                            .size(40.dp)
                            .padding(top = 15.dp, end = 5.dp),
                        onClick = { keyVisible = !keyVisible }
                    ) {
                        Icon(
                            imageVector = if (keyVisible) Icons.Default.Visibility else Icons.Default.VisibilityOff,
                            contentDescription = null,
                            tint = Color.Gray
                        )
                    }
                }
            }
        }
    }
}

@Composable
private fun KernelPatchImageView(kpImgInfo: KPModel.KPImgInfo) {
    if (kpImgInfo.version.isEmpty()) return
    ElevatedCard(
        colors = CardDefaults.elevatedCardColors(containerColor = run {
            MaterialTheme.colorScheme.secondaryContainer
        })
    ) {
        Column(
            modifier = Modifier
                .fillMaxWidth()
                .padding(start = 12.dp, top = 12.dp, end = 12.dp, bottom = 12.dp),
        ) {
            Column(
                modifier = Modifier
                    .fillMaxWidth(),
                horizontalAlignment = Alignment.CenterHorizontally
            ) {
                Text(
                    text = stringResource(id = R.string.patch_item_kpimg),
                    style = MaterialTheme.typography.bodyLarge
                )
            }
            Text(
                text = stringResource(id = R.string.patch_item_kpimg_version) + " " + Version.uInt2String(
                    kpImgInfo.version.substring(2).toUInt(16)
                ), style = MaterialTheme.typography.bodyMedium
            )
            Text(
                text = stringResource(id = R.string.patch_item_kpimg_comile_time) + " " + kpImgInfo.compileTime,
                style = MaterialTheme.typography.bodyMedium
            )
            Text(
                text = stringResource(id = R.string.patch_item_kpimg_config) + " " + kpImgInfo.config,
                style = MaterialTheme.typography.bodyMedium
            )
        }
    }
}

@Composable
private fun BootimgView(slot: String, boot: String) {
    ElevatedCard(
        colors = CardDefaults.elevatedCardColors(containerColor = run {
            MaterialTheme.colorScheme.secondaryContainer
        })
    ) {
        Column(
            modifier = Modifier
                .fillMaxWidth()
                .padding(12.dp),
        ) {
            Column(
                modifier = Modifier
                    .fillMaxWidth(),
                horizontalAlignment = Alignment.CenterHorizontally
            ) {
                Text(
                    text = stringResource(id = R.string.patch_item_bootimg),
                    style = MaterialTheme.typography.bodyLarge
                )
            }
            if (slot.isNotEmpty()) {
                Text(
                    text = stringResource(id = R.string.patch_item_bootimg_slot) + " " + slot,
                    style = MaterialTheme.typography.bodyMedium
                )
            }
            Text(
                text = stringResource(id = R.string.patch_item_bootimg_dev) + " " + boot,
                style = MaterialTheme.typography.bodyMedium
            )
        }
    }
}

@Composable
private fun KernelImageView(kImgInfo: KPModel.KImgInfo) {
    ElevatedCard(
        colors = CardDefaults.elevatedCardColors(containerColor = run {
            MaterialTheme.colorScheme.secondaryContainer
        })
    ) {
        Column(
            modifier = Modifier
                .fillMaxWidth()
                .padding(12.dp),
        ) {
            Column(
                modifier = Modifier
                    .fillMaxWidth(),
                horizontalAlignment = Alignment.CenterHorizontally
            ) {
                Text(
                    text = stringResource(id = R.string.patch_item_kernel),
                    style = MaterialTheme.typography.bodyLarge
                )
            }
            Text(text = kImgInfo.banner, style = MaterialTheme.typography.bodyMedium)
        }
    }
}


@Composable
private fun SelectFileButton(text: String, onSelected: (data: Intent, uri: Uri) -> Unit) {
    val selectFileLauncher = rememberLauncherForActivityResult(
        contract = ActivityResultContracts.StartActivityForResult()
    ) {
        if (it.resultCode != Activity.RESULT_OK) {
            return@rememberLauncherForActivityResult
        }
        val data = it.data ?: return@rememberLauncherForActivityResult
        val uri = data.data ?: return@rememberLauncherForActivityResult
        onSelected(data, uri)
    }

    Column(
        modifier = Modifier
            .fillMaxWidth(),
        horizontalAlignment = Alignment.End
    ) {
        Button(
            onClick = {
                val intent = Intent(Intent.ACTION_GET_CONTENT)
                intent.type = "*/*"
                selectFileLauncher.launch(intent)
            },
            content = { Text(text = text) }
        )
    }
}

@Composable
private fun ErrorView(error: String) {
    if (error.isEmpty()) return
    ElevatedCard(
        colors = CardDefaults.elevatedCardColors(containerColor = run {
            MaterialTheme.colorScheme.error
        })
    ) {
        Column(
            modifier = Modifier
                .fillMaxWidth()
                .padding(start = 12.dp, top = 12.dp, end = 12.dp, bottom = 12.dp),
            horizontalAlignment = Alignment.CenterHorizontally
        ) {
            Text(
                text = stringResource(id = R.string.patch_item_error),
                style = MaterialTheme.typography.bodyLarge
            )
            Text(text = error, style = MaterialTheme.typography.bodyMedium)
        }
    }
}

@Composable
private fun PatchMode(mode: PatchesViewModel.PatchMode) {
    ElevatedCard(
        colors = CardDefaults.elevatedCardColors(containerColor = run {
            MaterialTheme.colorScheme.secondaryContainer
        })
    ) {
        Column(
            modifier = Modifier
                .fillMaxWidth()
                .padding(12.dp),
            horizontalAlignment = Alignment.CenterHorizontally
        ) {
            Text(text = stringResource(id = mode.sId), style = MaterialTheme.typography.bodyLarge)
        }
    }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
private fun TopBar() {
    TopAppBar(title = { Text(stringResource(R.string.patch_config_title)) })
}
```

`app/src/main/java/me/bmax/apatch/ui/screen/Settings.kt`:

```kt
package me.bmax.apatch.ui.screen

import android.content.Intent
import android.net.Uri
import android.os.Build
import android.widget.Toast
import androidx.activity.compose.rememberLauncherForActivityResult
import androidx.activity.result.contract.ActivityResultContracts
import androidx.annotation.StringRes
import androidx.appcompat.app.AppCompatDelegate
import androidx.compose.foundation.clickable
import androidx.compose.foundation.layout.Arrangement
import androidx.compose.foundation.layout.Box
import androidx.compose.foundation.layout.Column
import androidx.compose.foundation.layout.PaddingValues
import androidx.compose.foundation.layout.Row
import androidx.compose.foundation.layout.WindowInsets
import androidx.compose.foundation.layout.fillMaxWidth
import androidx.compose.foundation.layout.padding
import androidx.compose.foundation.layout.width
import androidx.compose.foundation.layout.wrapContentHeight
import androidx.compose.foundation.lazy.LazyColumn
import androidx.compose.foundation.lazy.items
import androidx.compose.foundation.lazy.itemsIndexed
import androidx.compose.foundation.rememberScrollState
import androidx.compose.foundation.shape.RoundedCornerShape
import androidx.compose.foundation.verticalScroll
import androidx.compose.material.icons.Icons
import androidx.compose.material.icons.filled.BugReport
import androidx.compose.material.icons.filled.ColorLens
import androidx.compose.material.icons.filled.Commit
import androidx.compose.material.icons.filled.DarkMode
import androidx.compose.material.icons.filled.DeveloperMode
import androidx.compose.material.icons.filled.Engineering
import androidx.compose.material.icons.filled.FormatColorFill
import androidx.compose.material.icons.filled.InvertColors
import androidx.compose.material.icons.filled.Key
import androidx.compose.material.icons.filled.Save
import androidx.compose.material.icons.filled.Share
import androidx.compose.material.icons.filled.Translate
import androidx.compose.material.icons.filled.Update
import androidx.compose.material3.AlertDialogDefaults
import androidx.compose.material3.BasicAlertDialog
import androidx.compose.material3.Button
import androidx.compose.material3.ExperimentalMaterial3Api
import androidx.compose.material3.Icon
import androidx.compose.material3.ListItem
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.ModalBottomSheet
import androidx.compose.material3.OutlinedTextField
import androidx.compose.material3.Scaffold
import androidx.compose.material3.SnackbarHost
import androidx.compose.material3.Surface
import androidx.compose.material3.Text
import androidx.compose.material3.TextButton
import androidx.compose.material3.TopAppBar
import androidx.compose.runtime.Composable
import androidx.compose.runtime.MutableState
import androidx.compose.runtime.getValue
import androidx.compose.runtime.livedata.observeAsState
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.remember
import androidx.compose.runtime.rememberCoroutineScope
import androidx.compose.runtime.saveable.rememberSaveable
import androidx.compose.runtime.setValue
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.platform.LocalContext
import androidx.compose.ui.platform.LocalView
import androidx.compose.ui.res.stringArrayResource
import androidx.compose.ui.res.stringResource
import androidx.compose.ui.text.input.VisualTransformation
import androidx.compose.ui.text.style.LineHeightStyle
import androidx.compose.ui.text.style.TextAlign
import androidx.compose.ui.unit.dp
import androidx.compose.ui.window.DialogProperties
import androidx.compose.ui.window.DialogWindowProvider
import androidx.core.content.FileProvider
import androidx.core.content.edit
import androidx.core.os.LocaleListCompat
import com.ramcosta.composedestinations.annotation.Destination
import com.ramcosta.composedestinations.annotation.RootGraph
import kotlinx.coroutines.Dispatchers
import kotlinx.coroutines.launch
import kotlinx.coroutines.withContext
import me.bmax.apatch.APApplication
import me.bmax.apatch.BuildConfig
import me.bmax.apatch.Natives
import me.bmax.apatch.R
import me.bmax.apatch.ui.component.SwitchItem
import me.bmax.apatch.ui.component.rememberConfirmDialog
import me.bmax.apatch.ui.component.rememberLoadingDialog
import me.bmax.apatch.ui.theme.refreshTheme
import me.bmax.apatch.util.APatchKeyHelper
import me.bmax.apatch.util.getBugreportFile
import me.bmax.apatch.util.isGlobalNamespaceEnabled
import me.bmax.apatch.util.outputStream
import me.bmax.apatch.util.rootShellForResult
import me.bmax.apatch.util.setGlobalNamespaceEnabled
import me.bmax.apatch.util.ui.APDialogBlurBehindUtils
import me.bmax.apatch.util.ui.LocalSnackbarHost
import me.bmax.apatch.util.ui.NavigationBarsSpacer
import java.time.LocalDateTime
import java.time.format.DateTimeFormatter
import java.util.Locale

@Destination<RootGraph>
@Composable
@OptIn(ExperimentalMaterial3Api::class)
fun SettingScreen() {
    val state by APApplication.apStateLiveData.observeAsState(APApplication.State.UNKNOWN_STATE)
    val kPatchReady = state != APApplication.State.UNKNOWN_STATE
    val aPatchReady =
        (state == APApplication.State.ANDROIDPATCH_INSTALLING || state == APApplication.State.ANDROIDPATCH_INSTALLED || state == APApplication.State.ANDROIDPATCH_NEED_UPDATE)
    var isGlobalNamespaceEnabled by rememberSaveable {
        mutableStateOf(false)
    }
    var bSkipStoreSuperKey by rememberSaveable {
        mutableStateOf(APatchKeyHelper.shouldSkipStoreSuperKey())
    }
    if (kPatchReady && aPatchReady) {
        isGlobalNamespaceEnabled = isGlobalNamespaceEnabled()
    }

    val snackBarHost = LocalSnackbarHost.current

    Scaffold(
        topBar = {
            TopAppBar(
                title = { Text(stringResource(R.string.settings)) },
            )
        },
        snackbarHost = { SnackbarHost(snackBarHost) }
    ) { paddingValues ->

        val loadingDialog = rememberLoadingDialog()
        val clearKeyDialog = rememberConfirmDialog(
            onConfirm = {
                APatchKeyHelper.clearConfigKey()
                APApplication.superKey = ""
            }
        )

        val showLanguageDialog = rememberSaveable { mutableStateOf(false) }
        LanguageDialog(showLanguageDialog)

        val showResetSuPathDialog = remember { mutableStateOf(false) }
        if (showResetSuPathDialog.value) {
            ResetSUPathDialog(showResetSuPathDialog)
        }

        val showThemeChooseDialog = remember { mutableStateOf(false) }
        if (showThemeChooseDialog.value) {
            ThemeChooseDialog(showThemeChooseDialog)
        }

        var showLogBottomSheet by remember { mutableStateOf(false) }

        val scope = rememberCoroutineScope()
        val context = LocalContext.current
        val logSavedMessage = stringResource(R.string.log_saved)
        val exportBugreportLauncher = rememberLauncherForActivityResult(
            ActivityResultContracts.CreateDocument("application/gzip")
        ) { uri: Uri? ->
            if (uri != null) {
                scope.launch(Dispatchers.IO) {
                    loadingDialog.show()
                    uri.outputStream().use { output ->
                        getBugreportFile(context).inputStream().use {
                            it.copyTo(output)
                        }
                    }
                    loadingDialog.hide()
                    snackBarHost.showSnackbar(message = logSavedMessage)
                }
            }
        }

        Column(
            modifier = Modifier
                .padding(paddingValues)
                .fillMaxWidth()
                .verticalScroll(rememberScrollState()),
        ) {

            val context = LocalContext.current
            val scope = rememberCoroutineScope()
            val prefs = APApplication.sharedPreferences

            // clear key
            if (kPatchReady) {
                val clearKeyDialogTitle = stringResource(id = R.string.clear_super_key)
                val clearKeyDialogContent =
                    stringResource(id = R.string.settings_clear_super_key_dialog)
                ListItem(
                    leadingContent = {
                        Icon(
                            Icons.Filled.Key, stringResource(id = R.string.super_key)
                        )
                    },
                    headlineContent = { Text(stringResource(id = R.string.clear_super_key)) },
                    modifier = Modifier.clickable {
                        clearKeyDialog.showConfirm(
                            title = clearKeyDialogTitle,
                            content = clearKeyDialogContent,
                            markdown = false,
                        )

                    })
            }

            // store key local?
            SwitchItem(
                icon = Icons.Filled.Key,
                title = stringResource(id = R.string.settings_donot_store_superkey),
                summary = stringResource(id = R.string.settings_donot_store_superkey_summary),
                checked = bSkipStoreSuperKey,
                onCheckedChange = {
                    bSkipStoreSuperKey = it
                    APatchKeyHelper.setShouldSkipStoreSuperKey(bSkipStoreSuperKey)
                })

            // Global mount
            if (kPatchReady && aPatchReady) {
                SwitchItem(
                    icon = Icons.Filled.Engineering,
                    title = stringResource(id = R.string.settings_global_namespace_mode),
                    summary = stringResource(id = R.string.settings_global_namespace_mode_summary),
                    checked = isGlobalNamespaceEnabled,
                    onCheckedChange = {
                        setGlobalNamespaceEnabled(
                            if (isGlobalNamespaceEnabled) {
                                "0"
                            } else {
                                "1"
                            }
                        )
                        isGlobalNamespaceEnabled = it
                    })
            }

            // WebView Debug
            if (aPatchReady) {
                var enableWebDebugging by rememberSaveable {
                    mutableStateOf(
                        prefs.getBoolean("enable_web_debugging", false)
                    )
                }
                SwitchItem(
                    icon = Icons.Filled.DeveloperMode,
                    title = stringResource(id = R.string.enable_web_debugging),
                    summary = stringResource(id = R.string.enable_web_debugging_summary),
                    checked = enableWebDebugging
                ) {
                    APApplication.sharedPreferences.edit {
                        putBoolean("enable_web_debugging", it)
                    }
                    enableWebDebugging = it
                }
            }

            // Check Update
            var checkUpdate by rememberSaveable {
                mutableStateOf(
                    prefs.getBoolean("check_update", true)
                )
            }

            SwitchItem(
                icon = Icons.Filled.Update,
                title = stringResource(id = R.string.settings_check_update),
                summary = stringResource(id = R.string.settings_check_update_summary),
                checked = checkUpdate
            ) {
                prefs.edit { putBoolean("check_update", it) }
                checkUpdate = it
            }

            // Night Mode Follow System
            var nightFollowSystem by rememberSaveable {
                mutableStateOf(
                    prefs.getBoolean("night_mode_follow_sys", true)
                )
            }
            SwitchItem(
                icon = Icons.Filled.InvertColors,
                title = stringResource(id = R.string.settings_night_mode_follow_sys),
                summary = stringResource(id = R.string.settings_night_mode_follow_sys_summary),
                checked = nightFollowSystem
            ) {
                prefs.edit { putBoolean("night_mode_follow_sys", it) }
                nightFollowSystem = it
                refreshTheme.value = true
            }

            // Custom Night Theme Switch
            if (!nightFollowSystem) {
                var nightThemeEnabled by rememberSaveable {
                    mutableStateOf(
                        prefs.getBoolean("night_mode_enabled", false)
                    )
                }
                SwitchItem(
                    icon = Icons.Filled.DarkMode,
                    title = stringResource(id = R.string.settings_night_theme_enabled),
                    checked = nightThemeEnabled
                ) {
                    prefs.edit { putBoolean("night_mode_enabled", it) }
                    nightThemeEnabled = it
                    refreshTheme.value = true
                }
            }

            // System dynamic color theme
            val isDynamicColorSupport = Build.VERSION.SDK_INT >= Build.VERSION_CODES.S
            if (isDynamicColorSupport) {
                var useSystemDynamicColor by rememberSaveable {
                    mutableStateOf(
                        prefs.getBoolean("use_system_color_theme", true)
                    )
                }
                SwitchItem(
                    icon = Icons.Filled.ColorLens,
                    title = stringResource(id = R.string.settings_use_system_color_theme),
                    summary = stringResource(id = R.string.settings_use_system_color_theme_summary),
                    checked = useSystemDynamicColor
                ) {
                    prefs.edit { putBoolean("use_system_color_theme", it) }
                    useSystemDynamicColor = it
                    refreshTheme.value = true
                }

                if (!useSystemDynamicColor) {
                    ListItem(headlineContent = {
                        Text(text = stringResource(id = R.string.settings_custom_color_theme))
                    }, modifier = Modifier.clickable {
                        showThemeChooseDialog.value = true
                    }, supportingContent = {
                        val colorMode = prefs.getString("custom_color", "blue")
                        Text(
                            text = stringResource(colorNameToString(colorMode.toString())),
                            style = MaterialTheme.typography.bodyMedium,
                            color = MaterialTheme.colorScheme.outline
                        )
                    }, leadingContent = { Icon(Icons.Filled.FormatColorFill, null) })

                }
            } else {
                ListItem(headlineContent = {
                    Text(text = stringResource(id = R.string.settings_custom_color_theme))
                }, modifier = Modifier.clickable {
                    showThemeChooseDialog.value = true
                }, supportingContent = {
                    val colorMode = prefs.getString("custom_color", "blue")
                    Text(
                        text = stringResource(colorNameToString(colorMode.toString())),
                        style = MaterialTheme.typography.bodyMedium,
                        color = MaterialTheme.colorScheme.outline
                    )
                }, leadingContent = { Icon(Icons.Filled.FormatColorFill, null) })
            }

            // su path
            if (kPatchReady) {
                ListItem(
                    leadingContent = {
                        Icon(
                            Icons.Filled.Commit, stringResource(id = R.string.setting_reset_su_path)
                        )
                    },
                    supportingContent = {},
                    headlineContent = { Text(stringResource(id = R.string.setting_reset_su_path)) },
                    modifier = Modifier.clickable {
                        showResetSuPathDialog.value = true
                    })
            }

            // language
            ListItem(headlineContent = {
                Text(text = stringResource(id = R.string.settings_app_language))
            }, modifier = Modifier.clickable {
                showLanguageDialog.value = true
            }, supportingContent = {
                Text(text = AppCompatDelegate.getApplicationLocales()[0]?.displayLanguage?.replaceFirstChar {
                    if (it.isLowerCase()) it.titlecase(
                        Locale.getDefault()
                    ) else it.toString()
                } ?: stringResource(id = R.string.system_default),
                    style = MaterialTheme.typography.bodyMedium,
                    color = MaterialTheme.colorScheme.outline)
            }, leadingContent = { Icon(Icons.Filled.Translate, null) })

            // log
            ListItem(
                leadingContent = {
                    Icon(
                        Icons.Filled.BugReport, stringResource(id = R.string.send_log)
                    )
                },
                headlineContent = { Text(stringResource(id = R.string.send_log)) },
                modifier = Modifier.clickable {
                    showLogBottomSheet = true
                })
            if (showLogBottomSheet) {
                ModalBottomSheet(
                    onDismissRequest = { showLogBottomSheet = false },
                    contentWindowInsets = { WindowInsets(0, 0, 0, 0) },
                    content = {
                        Row(
                            modifier = Modifier
                                .padding(10.dp)
                                .align(Alignment.CenterHorizontally)

                        ) {
                            Box {
                                Column(
                                    modifier = Modifier
                                        .padding(16.dp)
                                        .clickable {
                                            scope.launch {
                                                val formatter =
                                                    DateTimeFormatter.ofPattern("yyyy-MM-dd_HH_mm")
                                                val current = LocalDateTime.now().format(formatter)
                                                exportBugreportLauncher.launch("APatch_bugreport_${current}.tar.gz")
                                                showLogBottomSheet = false
                                            }
                                        }
                                ) {
                                    Icon(
                                        Icons.Filled.Save,
                                        contentDescription = null,
                                        modifier = Modifier.align(Alignment.CenterHorizontally)
                                    )
                                    Text(
                                        text = stringResource(id = R.string.save_log),
                                        modifier = Modifier.padding(top = 16.dp),
                                        textAlign = TextAlign.Center.also {
                                            LineHeightStyle(
                                                alignment = LineHeightStyle.Alignment.Center,
                                                trim = LineHeightStyle.Trim.None
                                            )
                                        }

                                    )
                                }

                            }
                            Box {
                                Column(
                                    modifier = Modifier
                                        .padding(16.dp)
                                        .clickable {
                                            scope.launch {
                                                val bugreport = loadingDialog.withLoading {
                                                    withContext(Dispatchers.IO) {
                                                        getBugreportFile(context)
                                                    }
                                                }

                                                val uri: Uri = FileProvider.getUriForFile(
                                                    context,
                                                    "${BuildConfig.APPLICATION_ID}.fileprovider",
                                                    bugreport
                                                )

                                                val shareIntent = Intent(Intent.ACTION_SEND).apply {
                                                    putExtra(Intent.EXTRA_STREAM, uri)
                                                    setDataAndType(uri, "application/gzip")
                                                    addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION)
                                                }

                                                context.startActivity(
                                                    Intent.createChooser(
                                                        shareIntent,
                                                        context.getString(R.string.send_log)
                                                    )
                                                )
                                                showLogBottomSheet = false
                                            }
                                        }) {
                                    Icon(
                                        Icons.Filled.Share,
                                        contentDescription = null,
                                        modifier = Modifier.align(Alignment.CenterHorizontally)
                                    )
                                    Text(
                                        text = stringResource(id = R.string.send_log),
                                        modifier = Modifier.padding(top = 16.dp),
                                        textAlign = TextAlign.Center.also {
                                            LineHeightStyle(
                                                alignment = LineHeightStyle.Alignment.Center,
                                                trim = LineHeightStyle.Trim.None
                                            )
                                        }

                                    )
                                }

                            }
                        }
                        NavigationBarsSpacer()
                    })
            }


        }

    }
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun ThemeChooseDialog(showDialog: MutableState<Boolean>) {
    val prefs = APApplication.sharedPreferences

    BasicAlertDialog(
        onDismissRequest = { showDialog.value = false }, properties = DialogProperties(
            decorFitsSystemWindows = true,
            usePlatformDefaultWidth = false,
        )
    ) {
        Surface(
            modifier = Modifier
                .width(310.dp)
                .wrapContentHeight(),
            shape = RoundedCornerShape(30.dp),
            tonalElevation = AlertDialogDefaults.TonalElevation,
            color = AlertDialogDefaults.containerColor,
        ) {
            LazyColumn {
                items(colorsList()) {
                    ListItem(
                        headlineContent = { Text(text = stringResource(it.nameId)) },
                        modifier = Modifier.clickable {
                            showDialog.value = false
                            prefs.edit { putString("custom_color", it.name) }
                            refreshTheme.value = true
                        })
                }

            }

            val dialogWindowProvider = LocalView.current.parent as DialogWindowProvider
            APDialogBlurBehindUtils.setupWindowBlurListener(dialogWindowProvider.window)
        }
    }

}

private data class APColor(
    val name: String, @param:StringRes val nameId: Int
)

private fun colorsList(): List<APColor> {
    return listOf(
        APColor("amber", R.string.amber_theme),
        APColor("blue_grey", R.string.blue_grey_theme),
        APColor("blue", R.string.blue_theme),
        APColor("brown", R.string.brown_theme),
        APColor("cyan", R.string.cyan_theme),
        APColor("deep_orange", R.string.deep_orange_theme),
        APColor("deep_purple", R.string.deep_purple_theme),
        APColor("green", R.string.green_theme),
        APColor("indigo", R.string.indigo_theme),
        APColor("light_blue", R.string.light_blue_theme),
        APColor("light_green", R.string.light_green_theme),
        APColor("lime", R.string.lime_theme),
        APColor("orange", R.string.orange_theme),
        APColor("pink", R.string.pink_theme),
        APColor("purple", R.string.purple_theme),
        APColor("red", R.string.red_theme),
        APColor("sakura", R.string.sakura_theme),
        APColor("teal", R.string.teal_theme),
        APColor("yellow", R.string.yellow_theme),
    )
}

@Composable
private fun colorNameToString(colorName: String): Int {
    return colorsList().find { it.name == colorName }?.nameId ?: R.string.blue_theme
}

val suPathChecked: (path: String) -> Boolean = {
    it.startsWith("/") && it.trim().length > 1
}

@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun ResetSUPathDialog(showDialog: MutableState<Boolean>) {
    val context = LocalContext.current
    var suPath by remember { mutableStateOf(Natives.suPath()) }
    BasicAlertDialog(
        onDismissRequest = { showDialog.value = false }, properties = DialogProperties(
            decorFitsSystemWindows = true,
            usePlatformDefaultWidth = false,
        )
    ) {
        Surface(
            modifier = Modifier
                .width(310.dp)
                .wrapContentHeight(),
            shape = RoundedCornerShape(30.dp),
            tonalElevation = AlertDialogDefaults.TonalElevation,
            color = AlertDialogDefaults.containerColor,
        ) {
            Column(modifier = Modifier.padding(PaddingValues(all = 24.dp))) {
                Box(
                    Modifier
                        .padding(PaddingValues(bottom = 16.dp))
                        .align(Alignment.Start)
                ) {
                    Text(
                        text = stringResource(id = R.string.setting_reset_su_path),
                        style = MaterialTheme.typography.headlineSmall
                    )
                }
                Box(
                    Modifier
                        .weight(weight = 1f, fill = false)
                        .padding(PaddingValues(bottom = 12.dp))
                        .align(Alignment.Start)
                ) {
                    OutlinedTextField(
                        value = suPath,
                        onValueChange = {
                            suPath = it
                        },
                        label = { Text(stringResource(id = R.string.setting_reset_su_new_path)) },
                        visualTransformation = VisualTransformation.None,
                    )
                }

                Row(
                    modifier = Modifier.fillMaxWidth(), horizontalArrangement = Arrangement.End
                ) {
                    TextButton(onClick = { showDialog.value = false }) {

                        Text(stringResource(id = android.R.string.cancel))
                    }

                    Button(enabled = suPathChecked(suPath), onClick = {
                        showDialog.value = false
                        val success = Natives.resetSuPath(suPath)
                        Toast.makeText(
                            context,
                            if (success) R.string.success else R.string.failure,
                            Toast.LENGTH_SHORT
                        ).show()
                        rootShellForResult("echo $suPath > ${APApplication.SU_PATH_FILE}")
                    }) {
                        Text(stringResource(id = android.R.string.ok))
                    }
                }
            }
            val dialogWindowProvider = LocalView.current.parent as DialogWindowProvider
            APDialogBlurBehindUtils.setupWindowBlurListener(dialogWindowProvider.window)
        }
    }
}


@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun LanguageDialog(showLanguageDialog: MutableState<Boolean>) {

    val languages = stringArrayResource(id = R.array.languages)
    val languagesValues = stringArrayResource(id = R.array.languages_values)

    if (showLanguageDialog.value) {
        BasicAlertDialog(
            onDismissRequest = { showLanguageDialog.value = false }
        ) {
            Surface(
                modifier = Modifier
                    .width(150.dp)
                    .wrapContentHeight(),
                shape = RoundedCornerShape(28.dp),
                tonalElevation = AlertDialogDefaults.TonalElevation,
                color = AlertDialogDefaults.containerColor,
            ) {
                LazyColumn {
                    itemsIndexed(languages) { index, item ->
                        ListItem(
                            headlineContent = { Text(item) },
                            modifier = Modifier.clickable {
                                showLanguageDialog.value = false
                                if (index == 0) {
                                    AppCompatDelegate.setApplicationLocales(
                                        LocaleListCompat.getEmptyLocaleList()
                                    )
                                } else {
                                    AppCompatDelegate.setApplicationLocales(
                                        LocaleListCompat.forLanguageTags(
                                            languagesValues[index]
                                        )
                                    )
                                }
                            }
                        )
                    }
                }
            }
            val dialogWindowProvider = LocalView.current.parent as DialogWindowProvider
            APDialogBlurBehindUtils.setupWindowBlurListener(dialogWindowProvider.window)
        }
    }
}

```

`app/src/main/java/me/bmax/apatch/ui/screen/SuperUser.kt`:

```kt
package me.bmax.apatch.ui.screen

import androidx.compose.animation.AnimatedVisibility
import androidx.compose.foundation.background
import androidx.compose.foundation.clickable
import androidx.compose.foundation.layout.Box
import androidx.compose.foundation.layout.Column
import androidx.compose.foundation.layout.ExperimentalLayoutApi
import androidx.compose.foundation.layout.FlowRow
import androidx.compose.foundation.layout.fillMaxSize
import androidx.compose.foundation.layout.fillMaxWidth
import androidx.compose.foundation.layout.height
import androidx.compose.foundation.layout.padding
import androidx.compose.foundation.layout.width
import androidx.compose.foundation.lazy.LazyColumn
import androidx.compose.foundation.lazy.items
import androidx.compose.foundation.shape.RoundedCornerShape
import androidx.compose.material.icons.Icons
import androidx.compose.material.icons.filled.MoreVert
import androidx.compose.material.icons.filled.Security
import androidx.compose.material3.DropdownMenu
import androidx.compose.material3.DropdownMenuItem
import androidx.compose.material3.ExperimentalMaterial3Api
import androidx.compose.material3.Icon
import androidx.compose.material3.IconButton
import androidx.compose.material3.ListItem
import androidx.compose.material3.Scaffold
import androidx.compose.material3.Switch
import androidx.compose.material3.Text
import androidx.compose.material3.pulltorefresh.PullToRefreshBox
import androidx.compose.runtime.Composable
import androidx.compose.runtime.LaunchedEffect
import androidx.compose.runtime.getValue
import androidx.compose.runtime.mutableIntStateOf
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.remember
import androidx.compose.runtime.rememberCoroutineScope
import androidx.compose.runtime.setValue
import androidx.compose.ui.Modifier
import androidx.compose.ui.graphics.Color
import androidx.compose.ui.platform.LocalContext
import androidx.compose.ui.res.stringResource
import androidx.compose.ui.text.TextStyle
import androidx.compose.ui.unit.dp
import androidx.compose.ui.unit.sp
import androidx.lifecycle.viewmodel.compose.viewModel
import coil.compose.AsyncImage
import coil.request.ImageRequest
import com.ramcosta.composedestinations.annotation.Destination
import com.ramcosta.composedestinations.annotation.RootGraph
import kotlinx.coroutines.launch
import me.bmax.apatch.APApplication
import me.bmax.apatch.Natives
import me.bmax.apatch.R
import me.bmax.apatch.apApp
import me.bmax.apatch.ui.component.ProvideMenuShape
import me.bmax.apatch.ui.component.SearchAppBar
import me.bmax.apatch.ui.component.SwitchItem
import me.bmax.apatch.ui.component.pinnedScrollBehavior
import me.bmax.apatch.ui.viewmodel.SuperUserViewModel
import me.bmax.apatch.util.PkgConfig


@OptIn(ExperimentalMaterial3Api::class)
@Destination<RootGraph>
@Composable
fun SuperUserScreen() {
    val viewModel = viewModel<SuperUserViewModel>()
    val scrollBehavior = pinnedScrollBehavior()
    val scope = rememberCoroutineScope()

    LaunchedEffect(Unit) {
        if (viewModel.appList.isEmpty()) {
            viewModel.fetchAppList()
        }
    }

    Scaffold(
        topBar = {
            SearchAppBar(
                searchText = viewModel.search,
                onSearchTextChange = { viewModel.search = it },
                scrollBehavior = scrollBehavior,
                searchBarPlaceHolderText = stringResource(R.string.search_apps),
                dropdownContent = {
                    var showDropdown by remember { mutableStateOf(false) }

                    IconButton(
                        onClick = { showDropdown = true },
                    ) {
                        Icon(
                            imageVector = Icons.Filled.MoreVert,
                            contentDescription = stringResource(id = R.string.settings)
                        )

                        ProvideMenuShape(RoundedCornerShape(10.dp)) {
                            DropdownMenu(expanded = showDropdown, onDismissRequest = {
                                showDropdown = false
                            }) {
                                DropdownMenuItem(text = {
                                    Text(stringResource(R.string.su_refresh))
                                }, onClick = {
                                    scope.launch {
                                        viewModel.fetchAppList()
                                    }
                                    showDropdown = false
                                })

                                DropdownMenuItem(text = {
                                    Text(
                                        if (viewModel.showSystemApps) {
                                            stringResource(R.string.su_hide_system_apps)
                                        } else {
                                            stringResource(R.string.su_show_system_apps)
                                        }
                                    )
                                }, onClick = {
                                    viewModel.showSystemApps = !viewModel.showSystemApps
                                    showDropdown = false
                                })
                            }
                        }
                    }
                }
            )
        },
    ) { innerPadding ->

        PullToRefreshBox(
            modifier = Modifier.padding(innerPadding),
            onRefresh = { scope.launch { viewModel.fetchAppList() } },
            isRefreshing = viewModel.isRefreshing
        ) {
            LazyColumn(Modifier.fillMaxSize()) {
                items(viewModel.appList.filter { it.packageName != apApp.packageName }, key = { it.packageName + it.uid }) { app ->
                    AppItem(app)
                }
            }
        }
    }
}

@OptIn(ExperimentalLayoutApi::class)
@Composable
private fun AppItem(
    app: SuperUserViewModel.AppInfo,
) {
    val config = app.config
    var showEditProfile by remember { mutableStateOf(false) }
    var rootGranted by remember { mutableStateOf(config.allow != 0) }
    var excludeApp by remember { mutableIntStateOf(config.exclude) }

    ListItem(
        modifier = Modifier.clickable(onClick = {
            if (!rootGranted) {
                showEditProfile = !showEditProfile
            } else {
                rootGranted = false
                config.allow = 0
                Natives.revokeSu(app.uid)
                PkgConfig.changeConfig(config)
            }
        }),
        headlineContent = { Text(app.label) },
        leadingContent = {
            AsyncImage(
                model = ImageRequest.Builder(LocalContext.current).data(app.packageInfo)
                    .crossfade(true).build(),
                contentDescription = app.label,
                modifier = Modifier
                    .padding(4.dp)
                    .width(48.dp)
                    .height(48.dp)
            )
        },
        supportingContent = {

            Column {
                Text(app.packageName)
                FlowRow {

                    if (excludeApp == 1) {
                        LabelText(label = stringResource(id = R.string.su_pkg_excluded_label))
                    }
                    if (rootGranted) {
                        LabelText(label = config.profile.uid.toString())
                        LabelText(label = config.profile.toUid.toString())
                        LabelText(
                            label = when {
                                // todo: valid scontext ?
                                config.profile.scontext.isNotEmpty() -> config.profile.scontext
                                else -> stringResource(id = R.string.su_selinux_via_hook)
                            }
                        )
                    }
                }
            }
        },
        trailingContent = {
            Switch(checked = rootGranted, onCheckedChange = {
                rootGranted = !rootGranted
                if (rootGranted) {
                    excludeApp = 0
                    config.allow = 1
                    config.exclude = 0
                    config.profile.scontext = APApplication.MAGISK_SCONTEXT
                } else {
                    config.allow = 0
                }
                config.profile.uid = app.uid
                PkgConfig.changeConfig(config)
                if (config.allow == 1) {
                    Natives.grantSu(app.uid, 0, config.profile.scontext)
                    Natives.setUidExclude(app.uid, 0)
                } else {
                    Natives.revokeSu(app.uid)
                }
            })
        },
    )

    AnimatedVisibility(
        visible = showEditProfile && !rootGranted,
        modifier = Modifier
            .fillMaxWidth()
            .padding(horizontal = 24.dp)
    ) {
        SwitchItem(
            icon = Icons.Filled.Security,
            title = stringResource(id = R.string.su_pkg_excluded_setting_title),
            summary = stringResource(id = R.string.su_pkg_excluded_setting_summary),
            checked = excludeApp == 1,
            onCheckedChange = {
                if (it) {
                    excludeApp = 1
                    config.allow = 0
                    config.profile.scontext = APApplication.DEFAULT_SCONTEXT
                    Natives.revokeSu(app.uid)
                } else {
                    excludeApp = 0
                }
                config.exclude = excludeApp
                config.profile.uid = app.uid
                PkgConfig.changeConfig(config)
                Natives.setUidExclude(app.uid, excludeApp)
            },
        )
    }
}

@Composable
fun LabelText(label: String) {
    Box(
        modifier = Modifier
            .padding(top = 4.dp, end = 4.dp)
            .background(
                Color.Black, shape = RoundedCornerShape(4.dp)
            )
    ) {
        Text(
            text = label,
            modifier = Modifier.padding(vertical = 2.dp, horizontal = 5.dp),
            style = TextStyle(
                fontSize = 8.sp,
                color = Color.White,
            )
        )
    }
}
```

`app/src/main/java/me/bmax/apatch/ui/theme/AmberTheme.kt`:

```kt
package me.bmax.apatch.ui.theme

import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.ui.graphics.Color

private val md_theme_light_primary = Color(0xFF785900)
private val md_theme_light_onPrimary = Color(0xFFFFFFFF)
private val md_theme_light_primaryContainer = Color(0xFFFFDF9E)
private val md_theme_light_onPrimaryContainer = Color(0xFF261A00)
private val md_theme_light_secondary = Color(0xFF6B5D3F)
private val md_theme_light_onSecondary = Color(0xFFFFFFFF)
private val md_theme_light_secondaryContainer = Color(0xFFF5E0BB)
private val md_theme_light_onSecondaryContainer = Color(0xFF241A04)
private val md_theme_light_tertiary = Color(0xFF4A6547)
private val md_theme_light_onTertiary = Color(0xFFFFFFFF)
private val md_theme_light_tertiaryContainer = Color(0xFFCCEBC4)
private val md_theme_light_onTertiaryContainer = Color(0xFF072109)
private val md_theme_light_error = Color(0xFFBA1A1A)
private val md_theme_light_errorContainer = Color(0xFFFFDAD6)
private val md_theme_light_onError = Color(0xFFFFFFFF)
private val md_theme_light_onErrorContainer = Color(0xFF410002)
private val md_theme_light_background = Color(0xFFFFFBFF)
private val md_theme_light_onBackground = Color(0xFF1E1B16)
private val md_theme_light_surface = Color(0xFFFFFBFF)
private val md_theme_light_onSurface = Color(0xFF1E1B16)
private val md_theme_light_surfaceVariant = Color(0xFFEDE1CF)
private val md_theme_light_onSurfaceVariant = Color(0xFF4D4639)
private val md_theme_light_outline = Color(0xFF7F7667)
private val md_theme_light_inverseOnSurface = Color(0xFFF7EFE7)
private val md_theme_light_inverseSurface = Color(0xFF33302A)
private val md_theme_light_inversePrimary = Color(0xFFFABD00)
private val md_theme_light_shadow = Color(0xFF000000)
private val md_theme_light_surfaceTint = Color(0xFF785900)
private val md_theme_light_outlineVariant = Color(0xFFD0C5B4)
private val md_theme_light_scrim = Color(0xFF000000)

private val md_theme_dark_primary = Color(0xFFFABD00)
private val md_theme_dark_onPrimary = Color(0xFF3F2E00)
private val md_theme_dark_primaryContainer = Color(0xFF5B4300)
private val md_theme_dark_onPrimaryContainer = Color(0xFFFFDF9E)
private val md_theme_dark_secondary = Color(0xFFD8C4A0)
private val md_theme_dark_onSecondary = Color(0xFF3A2F15)
private val md_theme_dark_secondaryContainer = Color(0xFF52452A)
private val md_theme_dark_onSecondaryContainer = Color(0xFFF5E0BB)
private val md_theme_dark_tertiary = Color(0xFFB0CFAA)
private val md_theme_dark_onTertiary = Color(0xFF1D361C)
private val md_theme_dark_tertiaryContainer = Color(0xFF334D31)
private val md_theme_dark_onTertiaryContainer = Color(0xFFCCEBC4)
private val md_theme_dark_error = Color(0xFFFFB4AB)
private val md_theme_dark_errorContainer = Color(0xFF93000A)
private val md_theme_dark_onError = Color(0xFF690005)
private val md_theme_dark_onErrorContainer = Color(0xFFFFDAD6)
private val md_theme_dark_background = Color(0xFF1E1B16)
private val md_theme_dark_onBackground = Color(0xFFE9E1D8)
private val md_theme_dark_surface = Color(0xFF1E1B16)
private val md_theme_dark_onSurface = Color(0xFFE9E1D8)
private val md_theme_dark_surfaceVariant = Color(0xFF4D4639)
private val md_theme_dark_onSurfaceVariant = Color(0xFFD0C5B4)
private val md_theme_dark_outline = Color(0xFF998F80)
private val md_theme_dark_inverseOnSurface = Color(0xFF1E1B16)
private val md_theme_dark_inverseSurface = Color(0xFFE9E1D8)
private val md_theme_dark_inversePrimary = Color(0xFF785900)
private val md_theme_dark_shadow = Color(0xFF000000)
private val md_theme_dark_surfaceTint = Color(0xFFFABD00)
private val md_theme_dark_outlineVariant = Color(0xFF4D4639)
private val md_theme_dark_scrim = Color(0xFF000000)

val LightAmberTheme = lightColorScheme(
    primary = md_theme_light_primary,
    onPrimary = md_theme_light_onPrimary,
    primaryContainer = md_theme_light_primaryContainer,
    onPrimaryContainer = md_theme_light_onPrimaryContainer,
    secondary = md_theme_light_secondary,
    onSecondary = md_theme_light_onSecondary,
    secondaryContainer = md_theme_light_secondaryContainer,
    onSecondaryContainer = md_theme_light_onSecondaryContainer,
    tertiary = md_theme_light_tertiary,
    onTertiary = md_theme_light_onTertiary,
    tertiaryContainer = md_theme_light_tertiaryContainer,
    onTertiaryContainer = md_theme_light_onTertiaryContainer,
    error = md_theme_light_error,
    errorContainer = md_theme_light_errorContainer,
    onError = md_theme_light_onError,
    onErrorContainer = md_theme_light_onErrorContainer,
    background = md_theme_light_background,
    onBackground = md_theme_light_onBackground,
    surface = md_theme_light_surface,
    onSurface = md_theme_light_onSurface,
    surfaceVariant = md_theme_light_surfaceVariant,
    onSurfaceVariant = md_theme_light_onSurfaceVariant,
    outline = md_theme_light_outline,
    inverseOnSurface = md_theme_light_inverseOnSurface,
    inverseSurface = md_theme_light_inverseSurface,
    inversePrimary = md_theme_light_inversePrimary,
    surfaceTint = md_theme_light_surfaceTint,
    outlineVariant = md_theme_light_outlineVariant,
    scrim = md_theme_light_scrim,
)

val DarkAmberTheme = darkColorScheme(
    primary = md_theme_dark_primary,
    onPrimary = md_theme_dark_onPrimary,
    primaryContainer = md_theme_dark_primaryContainer,
    onPrimaryContainer = md_theme_dark_onPrimaryContainer,
    secondary = md_theme_dark_secondary,
    onSecondary = md_theme_dark_onSecondary,
    secondaryContainer = md_theme_dark_secondaryContainer,
    onSecondaryContainer = md_theme_dark_onSecondaryContainer,
    tertiary = md_theme_dark_tertiary,
    onTertiary = md_theme_dark_onTertiary,
    tertiaryContainer = md_theme_dark_tertiaryContainer,
    onTertiaryContainer = md_theme_dark_onTertiaryContainer,
    error = md_theme_dark_error,
    errorContainer = md_theme_dark_errorContainer,
    onError = md_theme_dark_onError,
    onErrorContainer = md_theme_dark_onErrorContainer,
    background = md_theme_dark_background,
    onBackground = md_theme_dark_onBackground,
    surface = md_theme_dark_surface,
    onSurface = md_theme_dark_onSurface,
    surfaceVariant = md_theme_dark_surfaceVariant,
    onSurfaceVariant = md_theme_dark_onSurfaceVariant,
    outline = md_theme_dark_outline,
    inverseOnSurface = md_theme_dark_inverseOnSurface,
    inverseSurface = md_theme_dark_inverseSurface,
    inversePrimary = md_theme_dark_inversePrimary,
    surfaceTint = md_theme_dark_surfaceTint,
    outlineVariant = md_theme_dark_outlineVariant,
    scrim = md_theme_dark_scrim,
)
```

`app/src/main/java/me/bmax/apatch/ui/theme/BlueGreyTheme.kt`:

```kt
package me.bmax.apatch.ui.theme

import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.ui.graphics.Color

private val md_theme_light_primary = Color(0xFF00668A)
private val md_theme_light_onPrimary = Color(0xFFFFFFFF)
private val md_theme_light_primaryContainer = Color(0xFFC4E7FF)
private val md_theme_light_onPrimaryContainer = Color(0xFF001E2C)
private val md_theme_light_secondary = Color(0xFF4E616D)
private val md_theme_light_onSecondary = Color(0xFFFFFFFF)
private val md_theme_light_secondaryContainer = Color(0xFFD1E5F4)
private val md_theme_light_onSecondaryContainer = Color(0xFF0A1E28)
private val md_theme_light_tertiary = Color(0xFF605A7D)
private val md_theme_light_onTertiary = Color(0xFFFFFFFF)
private val md_theme_light_tertiaryContainer = Color(0xFFE6DEFF)
private val md_theme_light_onTertiaryContainer = Color(0xFF1D1736)
private val md_theme_light_error = Color(0xFFBA1A1A)
private val md_theme_light_errorContainer = Color(0xFFFFDAD6)
private val md_theme_light_onError = Color(0xFFFFFFFF)
private val md_theme_light_onErrorContainer = Color(0xFF410002)
private val md_theme_light_background = Color(0xFFFBFCFF)
private val md_theme_light_onBackground = Color(0xFF191C1E)
private val md_theme_light_surface = Color(0xFFFBFCFF)
private val md_theme_light_onSurface = Color(0xFF191C1E)
private val md_theme_light_surfaceVariant = Color(0xFFDCE3E9)
private val md_theme_light_onSurfaceVariant = Color(0xFF41484D)
private val md_theme_light_outline = Color(0xFF71787D)
private val md_theme_light_inverseOnSurface = Color(0xFFF0F1F3)
private val md_theme_light_inverseSurface = Color(0xFF2E3133)
private val md_theme_light_inversePrimary = Color(0xFF7BD0FF)
private val md_theme_light_shadow = Color(0xFF000000)
private val md_theme_light_surfaceTint = Color(0xFF00668A)
private val md_theme_light_outlineVariant = Color(0xFFC0C7CD)
private val md_theme_light_scrim = Color(0xFF000000)

private val md_theme_dark_primary = Color(0xFF7BD0FF)
private val md_theme_dark_onPrimary = Color(0xFF003549)
private val md_theme_dark_primaryContainer = Color(0xFF004C69)
private val md_theme_dark_onPrimaryContainer = Color(0xFFC4E7FF)
private val md_theme_dark_secondary = Color(0xFFB5C9D7)
private val md_theme_dark_onSecondary = Color(0xFF20333E)
private val md_theme_dark_secondaryContainer = Color(0xFF374955)
private val md_theme_dark_onSecondaryContainer = Color(0xFFD1E5F4)
private val md_theme_dark_tertiary = Color(0xFFCAC1E9)
private val md_theme_dark_onTertiary = Color(0xFF322C4C)
private val md_theme_dark_tertiaryContainer = Color(0xFF484264)
private val md_theme_dark_onTertiaryContainer = Color(0xFFE6DEFF)
private val md_theme_dark_error = Color(0xFFFFB4AB)
private val md_theme_dark_errorContainer = Color(0xFF93000A)
private val md_theme_dark_onError = Color(0xFF690005)
private val md_theme_dark_onErrorContainer = Color(0xFFFFDAD6)
private val md_theme_dark_background = Color(0xFF191C1E)
private val md_theme_dark_onBackground = Color(0xFFE1E2E5)
private val md_theme_dark_surface = Color(0xFF191C1E)
private val md_theme_dark_onSurface = Color(0xFFE1E2E5)
private val md_theme_dark_surfaceVariant = Color(0xFF41484D)
private val md_theme_dark_onSurfaceVariant = Color(0xFFC0C7CD)
private val md_theme_dark_outline = Color(0xFF8B9297)
private val md_theme_dark_inverseOnSurface = Color(0xFF191C1E)
private val md_theme_dark_inverseSurface = Color(0xFFE1E2E5)
private val md_theme_dark_inversePrimary = Color(0xFF00668A)
private val md_theme_dark_shadow = Color(0xFF000000)
private val md_theme_dark_surfaceTint = Color(0xFF7BD0FF)
private val md_theme_dark_outlineVariant = Color(0xFF41484D)
private val md_theme_dark_scrim = Color(0xFF000000)

val LightBlueGreyTheme = lightColorScheme(
    primary = md_theme_light_primary,
    onPrimary = md_theme_light_onPrimary,
    primaryContainer = md_theme_light_primaryContainer,
    onPrimaryContainer = md_theme_light_onPrimaryContainer,
    secondary = md_theme_light_secondary,
    onSecondary = md_theme_light_onSecondary,
    secondaryContainer = md_theme_light_secondaryContainer,
    onSecondaryContainer = md_theme_light_onSecondaryContainer,
    tertiary = md_theme_light_tertiary,
    onTertiary = md_theme_light_onTertiary,
    tertiaryContainer = md_theme_light_tertiaryContainer,
    onTertiaryContainer = md_theme_light_onTertiaryContainer,
    error = md_theme_light_error,
    errorContainer = md_theme_light_errorContainer,
    onError = md_theme_light_onError,
    onErrorContainer = md_theme_light_onErrorContainer,
    background = md_theme_light_background,
    onBackground = md_theme_light_onBackground,
    surface = md_theme_light_surface,
    onSurface = md_theme_light_onSurface,
    surfaceVariant = md_theme_light_surfaceVariant,
    onSurfaceVariant = md_theme_light_onSurfaceVariant,
    outline = md_theme_light_outline,
    inverseOnSurface = md_theme_light_inverseOnSurface,
    inverseSurface = md_theme_light_inverseSurface,
    inversePrimary = md_theme_light_inversePrimary,
    surfaceTint = md_theme_light_surfaceTint,
    outlineVariant = md_theme_light_outlineVariant,
    scrim = md_theme_light_scrim,
)

val DarkBlueGreyTheme = darkColorScheme(
    primary = md_theme_dark_primary,
    onPrimary = md_theme_dark_onPrimary,
    primaryContainer = md_theme_dark_primaryContainer,
    onPrimaryContainer = md_theme_dark_onPrimaryContainer,
    secondary = md_theme_dark_secondary,
    onSecondary = md_theme_dark_onSecondary,
    secondaryContainer = md_theme_dark_secondaryContainer,
    onSecondaryContainer = md_theme_dark_onSecondaryContainer,
    tertiary = md_theme_dark_tertiary,
    onTertiary = md_theme_dark_onTertiary,
    tertiaryContainer = md_theme_dark_tertiaryContainer,
    onTertiaryContainer = md_theme_dark_onTertiaryContainer,
    error = md_theme_dark_error,
    errorContainer = md_theme_dark_errorContainer,
    onError = md_theme_dark_onError,
    onErrorContainer = md_theme_dark_onErrorContainer,
    background = md_theme_dark_background,
    onBackground = md_theme_dark_onBackground,
    surface = md_theme_dark_surface,
    onSurface = md_theme_dark_onSurface,
    surfaceVariant = md_theme_dark_surfaceVariant,
    onSurfaceVariant = md_theme_dark_onSurfaceVariant,
    outline = md_theme_dark_outline,
    inverseOnSurface = md_theme_dark_inverseOnSurface,
    inverseSurface = md_theme_dark_inverseSurface,
    inversePrimary = md_theme_dark_inversePrimary,
    surfaceTint = md_theme_dark_surfaceTint,
    outlineVariant = md_theme_dark_outlineVariant,
    scrim = md_theme_dark_scrim,
)
```

`app/src/main/java/me/bmax/apatch/ui/theme/BlueTheme.kt`:

```kt
package me.bmax.apatch.ui.theme

import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.ui.graphics.Color

private val md_theme_light_primary = Color(0xFF0061A4)
private val md_theme_light_onPrimary = Color(0xFFFFFFFF)
private val md_theme_light_primaryContainer = Color(0xFFD1E4FF)
private val md_theme_light_onPrimaryContainer = Color(0xFF001D36)
private val md_theme_light_secondary = Color(0xFF535F70)
private val md_theme_light_onSecondary = Color(0xFFFFFFFF)
private val md_theme_light_secondaryContainer = Color(0xFFD7E3F7)
private val md_theme_light_onSecondaryContainer = Color(0xFF101C2B)
private val md_theme_light_tertiary = Color(0xFF6B5778)
private val md_theme_light_onTertiary = Color(0xFFFFFFFF)
private val md_theme_light_tertiaryContainer = Color(0xFFF2DAFF)
private val md_theme_light_onTertiaryContainer = Color(0xFF251431)
private val md_theme_light_error = Color(0xFFBA1A1A)
private val md_theme_light_errorContainer = Color(0xFFFFDAD6)
private val md_theme_light_onError = Color(0xFFFFFFFF)
private val md_theme_light_onErrorContainer = Color(0xFF410002)
private val md_theme_light_background = Color(0xFFFDFCFF)
private val md_theme_light_onBackground = Color(0xFF1A1C1E)
private val md_theme_light_surface = Color(0xFFFDFCFF)
private val md_theme_light_onSurface = Color(0xFF1A1C1E)
private val md_theme_light_surfaceVariant = Color(0xFFDFE2EB)
private val md_theme_light_onSurfaceVariant = Color(0xFF43474E)
private val md_theme_light_outline = Color(0xFF73777F)
private val md_theme_light_inverseOnSurface = Color(0xFFF1F0F4)
private val md_theme_light_inverseSurface = Color(0xFF2F3033)
private val md_theme_light_inversePrimary = Color(0xFF9ECAFF)
private val md_theme_light_shadow = Color(0xFF000000)
private val md_theme_light_surfaceTint = Color(0xFF0061A4)
private val md_theme_light_outlineVariant = Color(0xFFC3C7CF)
private val md_theme_light_scrim = Color(0xFF000000)

private val md_theme_dark_primary = Color(0xFF9ECAFF)
private val md_theme_dark_onPrimary = Color(0xFF003258)
private val md_theme_dark_primaryContainer = Color(0xFF00497D)
private val md_theme_dark_onPrimaryContainer = Color(0xFFD1E4FF)
private val md_theme_dark_secondary = Color(0xFFBBC7DB)
private val md_theme_dark_onSecondary = Color(0xFF253140)
private val md_theme_dark_secondaryContainer = Color(0xFF3B4858)
private val md_theme_dark_onSecondaryContainer = Color(0xFFD7E3F7)
private val md_theme_dark_tertiary = Color(0xFFD6BEE4)
private val md_theme_dark_onTertiary = Color(0xFF3B2948)
private val md_theme_dark_tertiaryContainer = Color(0xFF523F5F)
private val md_theme_dark_onTertiaryContainer = Color(0xFFF2DAFF)
private val md_theme_dark_error = Color(0xFFFFB4AB)
private val md_theme_dark_errorContainer = Color(0xFF93000A)
private val md_theme_dark_onError = Color(0xFF690005)
private val md_theme_dark_onErrorContainer = Color(0xFFFFDAD6)
private val md_theme_dark_background = Color(0xFF1A1C1E)
private val md_theme_dark_onBackground = Color(0xFFE2E2E6)
private val md_theme_dark_surface = Color(0xFF1A1C1E)
private val md_theme_dark_onSurface = Color(0xFFE2E2E6)
private val md_theme_dark_surfaceVariant = Color(0xFF43474E)
private val md_theme_dark_onSurfaceVariant = Color(0xFFC3C7CF)
private val md_theme_dark_outline = Color(0xFF8D9199)
private val md_theme_dark_inverseOnSurface = Color(0xFF1A1C1E)
private val md_theme_dark_inverseSurface = Color(0xFFE2E2E6)
private val md_theme_dark_inversePrimary = Color(0xFF0061A4)
private val md_theme_dark_shadow = Color(0xFF000000)
private val md_theme_dark_surfaceTint = Color(0xFF9ECAFF)
private val md_theme_dark_outlineVariant = Color(0xFF43474E)
private val md_theme_dark_scrim = Color(0xFF000000)


val LightBlueTheme = lightColorScheme(
    primary = md_theme_light_primary,
    onPrimary = md_theme_light_onPrimary,
    primaryContainer = md_theme_light_primaryContainer,
    onPrimaryContainer = md_theme_light_onPrimaryContainer,
    secondary = md_theme_light_secondary,
    onSecondary = md_theme_light_onSecondary,
    secondaryContainer = md_theme_light_secondaryContainer,
    onSecondaryContainer = md_theme_light_onSecondaryContainer,
    tertiary = md_theme_light_tertiary,
    onTertiary = md_theme_light_onTertiary,
    tertiaryContainer = md_theme_light_tertiaryContainer,
    onTertiaryContainer = md_theme_light_onTertiaryContainer,
    error = md_theme_light_error,
    errorContainer = md_theme_light_errorContainer,
    onError = md_theme_light_onError,
    onErrorContainer = md_theme_light_onErrorContainer,
    background = md_theme_light_background,
    onBackground = md_theme_light_onBackground,
    surface = md_theme_light_surface,
    onSurface = md_theme_light_onSurface,
    surfaceVariant = md_theme_light_surfaceVariant,
    onSurfaceVariant = md_theme_light_onSurfaceVariant,
    outline = md_theme_light_outline,
    inverseOnSurface = md_theme_light_inverseOnSurface,
    inverseSurface = md_theme_light_inverseSurface,
    inversePrimary = md_theme_light_inversePrimary,
    surfaceTint = md_theme_light_surfaceTint,
    outlineVariant = md_theme_light_outlineVariant,
    scrim = md_theme_light_scrim,
)

val DarkBlueTheme = darkColorScheme(
    primary = md_theme_dark_primary,
    onPrimary = md_theme_dark_onPrimary,
    primaryContainer = md_theme_dark_primaryContainer,
    onPrimaryContainer = md_theme_dark_onPrimaryContainer,
    secondary = md_theme_dark_secondary,
    onSecondary = md_theme_dark_onSecondary,
    secondaryContainer = md_theme_dark_secondaryContainer,
    onSecondaryContainer = md_theme_dark_onSecondaryContainer,
    tertiary = md_theme_dark_tertiary,
    onTertiary = md_theme_dark_onTertiary,
    tertiaryContainer = md_theme_dark_tertiaryContainer,
    onTertiaryContainer = md_theme_dark_onTertiaryContainer,
    error = md_theme_dark_error,
    errorContainer = md_theme_dark_errorContainer,
    onError = md_theme_dark_onError,
    onErrorContainer = md_theme_dark_onErrorContainer,
    background = md_theme_dark_background,
    onBackground = md_theme_dark_onBackground,
    surface = md_theme_dark_surface,
    onSurface = md_theme_dark_onSurface,
    surfaceVariant = md_theme_dark_surfaceVariant,
    onSurfaceVariant = md_theme_dark_onSurfaceVariant,
    outline = md_theme_dark_outline,
    inverseOnSurface = md_theme_dark_inverseOnSurface,
    inverseSurface = md_theme_dark_inverseSurface,
    inversePrimary = md_theme_dark_inversePrimary,
    surfaceTint = md_theme_dark_surfaceTint,
    outlineVariant = md_theme_dark_outlineVariant,
    scrim = md_theme_dark_scrim,
)
```

`app/src/main/java/me/bmax/apatch/ui/theme/BrownTheme.kt`:

```kt
package me.bmax.apatch.ui.theme

import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.ui.graphics.Color

private val md_theme_light_primary = Color(0xFF9A4522)
private val md_theme_light_onPrimary = Color(0xFFFFFFFF)
private val md_theme_light_primaryContainer = Color(0xFFFFDBCF)
private val md_theme_light_onPrimaryContainer = Color(0xFF380D00)
private val md_theme_light_secondary = Color(0xFF77574C)
private val md_theme_light_onSecondary = Color(0xFFFFFFFF)
private val md_theme_light_secondaryContainer = Color(0xFFFFDBCF)
private val md_theme_light_onSecondaryContainer = Color(0xFF2C160D)
private val md_theme_light_tertiary = Color(0xFF695E2F)
private val md_theme_light_onTertiary = Color(0xFFFFFFFF)
private val md_theme_light_tertiaryContainer = Color(0xFFF2E2A8)
private val md_theme_light_onTertiaryContainer = Color(0xFF211B00)
private val md_theme_light_error = Color(0xFFBA1A1A)
private val md_theme_light_errorContainer = Color(0xFFFFDAD6)
private val md_theme_light_onError = Color(0xFFFFFFFF)
private val md_theme_light_onErrorContainer = Color(0xFF410002)
private val md_theme_light_background = Color(0xFFFFFBFF)
private val md_theme_light_onBackground = Color(0xFF201A18)
private val md_theme_light_surface = Color(0xFFFFFBFF)
private val md_theme_light_onSurface = Color(0xFF201A18)
private val md_theme_light_surfaceVariant = Color(0xFFF5DED6)
private val md_theme_light_onSurfaceVariant = Color(0xFF53433E)
private val md_theme_light_outline = Color(0xFF85736D)
private val md_theme_light_inverseOnSurface = Color(0xFFFBEEEA)
private val md_theme_light_inverseSurface = Color(0xFF362F2C)
private val md_theme_light_inversePrimary = Color(0xFFFFB59A)
private val md_theme_light_shadow = Color(0xFF000000)
private val md_theme_light_surfaceTint = Color(0xFF9A4522)
private val md_theme_light_outlineVariant = Color(0xFFD8C2BB)
private val md_theme_light_scrim = Color(0xFF000000)

private val md_theme_dark_primary = Color(0xFFFFB59A)
private val md_theme_dark_onPrimary = Color(0xFF5B1B00)
private val md_theme_dark_primaryContainer = Color(0xFF7B2E0D)
private val md_theme_dark_onPrimaryContainer = Color(0xFFFFDBCF)
private val md_theme_dark_secondary = Color(0xFFE7BEAF)
private val md_theme_dark_onSecondary = Color(0xFF442A20)
private val md_theme_dark_secondaryContainer = Color(0xFF5D4035)
private val md_theme_dark_onSecondaryContainer = Color(0xFFFFDBCF)
private val md_theme_dark_tertiary = Color(0xFFD5C68E)
private val md_theme_dark_onTertiary = Color(0xFF393005)
private val md_theme_dark_tertiaryContainer = Color(0xFF50471A)
private val md_theme_dark_onTertiaryContainer = Color(0xFFF2E2A8)
private val md_theme_dark_error = Color(0xFFFFB4AB)
private val md_theme_dark_errorContainer = Color(0xFF93000A)
private val md_theme_dark_onError = Color(0xFF690005)
private val md_theme_dark_onErrorContainer = Color(0xFFFFDAD6)
private val md_theme_dark_background = Color(0xFF201A18)
private val md_theme_dark_onBackground = Color(0xFFEDE0DC)
private val md_theme_dark_surface = Color(0xFF201A18)
private val md_theme_dark_onSurface = Color(0xFFEDE0DC)
private val md_theme_dark_surfaceVariant = Color(0xFF53433E)
private val md_theme_dark_onSurfaceVariant = Color(0xFFD8C2BB)
private val md_theme_dark_outline = Color(0xFFA08D86)
private val md_theme_dark_inverseOnSurface = Color(0xFF201A18)
private val md_theme_dark_inverseSurface = Color(0xFFEDE0DC)
private val md_theme_dark_inversePrimary = Color(0xFF9A4522)
private val md_theme_dark_shadow = Color(0xFF000000)
private val md_theme_dark_surfaceTint = Color(0xFFFFB59A)
private val md_theme_dark_outlineVariant = Color(0xFF53433E)
private val md_theme_dark_scrim = Color(0xFF000000)

val LightBrownTheme = lightColorScheme(
    primary = md_theme_light_primary,
    onPrimary = md_theme_light_onPrimary,
    primaryContainer = md_theme_light_primaryContainer,
    onPrimaryContainer = md_theme_light_onPrimaryContainer,
    secondary = md_theme_light_secondary,
    onSecondary = md_theme_light_onSecondary,
    secondaryContainer = md_theme_light_secondaryContainer,
    onSecondaryContainer = md_theme_light_onSecondaryContainer,
    tertiary = md_theme_light_tertiary,
    onTertiary = md_theme_light_onTertiary,
    tertiaryContainer = md_theme_light_tertiaryContainer,
    onTertiaryContainer = md_theme_light_onTertiaryContainer,
    error = md_theme_light_error,
    errorContainer = md_theme_light_errorContainer,
    onError = md_theme_light_onError,
    onErrorContainer = md_theme_light_onErrorContainer,
    background = md_theme_light_background,
    onBackground = md_theme_light_onBackground,
    surface = md_theme_light_surface,
    onSurface = md_theme_light_onSurface,
    surfaceVariant = md_theme_light_surfaceVariant,
    onSurfaceVariant = md_theme_light_onSurfaceVariant,
    outline = md_theme_light_outline,
    inverseOnSurface = md_theme_light_inverseOnSurface,
    inverseSurface = md_theme_light_inverseSurface,
    inversePrimary = md_theme_light_inversePrimary,
    surfaceTint = md_theme_light_surfaceTint,
    outlineVariant = md_theme_light_outlineVariant,
    scrim = md_theme_light_scrim,
)

val DarkBrownTheme = darkColorScheme(
    primary = md_theme_dark_primary,
    onPrimary = md_theme_dark_onPrimary,
    primaryContainer = md_theme_dark_primaryContainer,
    onPrimaryContainer = md_theme_dark_onPrimaryContainer,
    secondary = md_theme_dark_secondary,
    onSecondary = md_theme_dark_onSecondary,
    secondaryContainer = md_theme_dark_secondaryContainer,
    onSecondaryContainer = md_theme_dark_onSecondaryContainer,
    tertiary = md_theme_dark_tertiary,
    onTertiary = md_theme_dark_onTertiary,
    tertiaryContainer = md_theme_dark_tertiaryContainer,
    onTertiaryContainer = md_theme_dark_onTertiaryContainer,
    error = md_theme_dark_error,
    errorContainer = md_theme_dark_errorContainer,
    onError = md_theme_dark_onError,
    onErrorContainer = md_theme_dark_onErrorContainer,
    background = md_theme_dark_background,
    onBackground = md_theme_dark_onBackground,
    surface = md_theme_dark_surface,
    onSurface = md_theme_dark_onSurface,
    surfaceVariant = md_theme_dark_surfaceVariant,
    onSurfaceVariant = md_theme_dark_onSurfaceVariant,
    outline = md_theme_dark_outline,
    inverseOnSurface = md_theme_dark_inverseOnSurface,
    inverseSurface = md_theme_dark_inverseSurface,
    inversePrimary = md_theme_dark_inversePrimary,
    surfaceTint = md_theme_dark_surfaceTint,
    outlineVariant = md_theme_dark_outlineVariant,
    scrim = md_theme_dark_scrim,
)
```

`app/src/main/java/me/bmax/apatch/ui/theme/CyanTheme.kt`:

```kt
package me.bmax.apatch.ui.theme

import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.ui.graphics.Color

private val md_theme_light_primary = Color(0xFF006876)
private val md_theme_light_onPrimary = Color(0xFFFFFFFF)
private val md_theme_light_primaryContainer = Color(0xFFA1EFFF)
private val md_theme_light_onPrimaryContainer = Color(0xFF001F25)
private val md_theme_light_secondary = Color(0xFF4A6268)
private val md_theme_light_onSecondary = Color(0xFFFFFFFF)
private val md_theme_light_secondaryContainer = Color(0xFFCDE7ED)
private val md_theme_light_onSecondaryContainer = Color(0xFF051F23)
private val md_theme_light_tertiary = Color(0xFF545D7E)
private val md_theme_light_onTertiary = Color(0xFFFFFFFF)
private val md_theme_light_tertiaryContainer = Color(0xFFDBE1FF)
private val md_theme_light_onTertiaryContainer = Color(0xFF101A37)
private val md_theme_light_error = Color(0xFFBA1A1A)
private val md_theme_light_errorContainer = Color(0xFFFFDAD6)
private val md_theme_light_onError = Color(0xFFFFFFFF)
private val md_theme_light_onErrorContainer = Color(0xFF410002)
private val md_theme_light_background = Color(0xFFFBFCFD)
private val md_theme_light_onBackground = Color(0xFF191C1D)
private val md_theme_light_surface = Color(0xFFFBFCFD)
private val md_theme_light_onSurface = Color(0xFF191C1D)
private val md_theme_light_surfaceVariant = Color(0xFFDBE4E6)
private val md_theme_light_onSurfaceVariant = Color(0xFF3F484A)
private val md_theme_light_outline = Color(0xFF6F797B)
private val md_theme_light_inverseOnSurface = Color(0xFFEFF1F2)
private val md_theme_light_inverseSurface = Color(0xFF2E3132)
private val md_theme_light_inversePrimary = Color(0xFF44D8F1)
private val md_theme_light_shadow = Color(0xFF000000)
private val md_theme_light_surfaceTint = Color(0xFF006876)
private val md_theme_light_outlineVariant = Color(0xFFBFC8CA)
private val md_theme_light_scrim = Color(0xFF000000)

private val md_theme_dark_primary = Color(0xFF44D8F1)
private val md_theme_dark_onPrimary = Color(0xFF00363E)
private val md_theme_dark_primaryContainer = Color(0xFF004E59)
private val md_theme_dark_onPrimaryContainer = Color(0xFFA1EFFF)
private val md_theme_dark_secondary = Color(0xFFB1CBD1)
private val md_theme_dark_onSecondary = Color(0xFF1C3439)
private val md_theme_dark_secondaryContainer = Color(0xFF334A50)
private val md_theme_dark_onSecondaryContainer = Color(0xFFCDE7ED)
private val md_theme_dark_tertiary = Color(0xFFBCC5EB)
private val md_theme_dark_onTertiary = Color(0xFF262F4D)
private val md_theme_dark_tertiaryContainer = Color(0xFF3C4665)
private val md_theme_dark_onTertiaryContainer = Color(0xFFDBE1FF)
private val md_theme_dark_error = Color(0xFFFFB4AB)
private val md_theme_dark_errorContainer = Color(0xFF93000A)
private val md_theme_dark_onError = Color(0xFF690005)
private val md_theme_dark_onErrorContainer = Color(0xFFFFDAD6)
private val md_theme_dark_background = Color(0xFF191C1D)
private val md_theme_dark_onBackground = Color(0xFFE1E3E3)
private val md_theme_dark_surface = Color(0xFF191C1D)
private val md_theme_dark_onSurface = Color(0xFFE1E3E3)
private val md_theme_dark_surfaceVariant = Color(0xFF3F484A)
private val md_theme_dark_onSurfaceVariant = Color(0xFFBFC8CA)
private val md_theme_dark_outline = Color(0xFF899295)
private val md_theme_dark_inverseOnSurface = Color(0xFF191C1D)
private val md_theme_dark_inverseSurface = Color(0xFFE1E3E3)
private val md_theme_dark_inversePrimary = Color(0xFF006876)
private val md_theme_dark_shadow = Color(0xFF000000)
private val md_theme_dark_surfaceTint = Color(0xFF44D8F1)
private val md_theme_dark_outlineVariant = Color(0xFF3F484A)
private val md_theme_dark_scrim = Color(0xFF000000)

val LightCyanTheme = lightColorScheme(
    primary = md_theme_light_primary,
    onPrimary = md_theme_light_onPrimary,
    primaryContainer = md_theme_light_primaryContainer,
    onPrimaryContainer = md_theme_light_onPrimaryContainer,
    secondary = md_theme_light_secondary,
    onSecondary = md_theme_light_onSecondary,
    secondaryContainer = md_theme_light_secondaryContainer,
    onSecondaryContainer = md_theme_light_onSecondaryContainer,
    tertiary = md_theme_light_tertiary,
    onTertiary = md_theme_light_onTertiary,
    tertiaryContainer = md_theme_light_tertiaryContainer,
    onTertiaryContainer = md_theme_light_onTertiaryContainer,
    error = md_theme_light_error,
    errorContainer = md_theme_light_errorContainer,
    onError = md_theme_light_onError,
    onErrorContainer = md_theme_light_onErrorContainer,
    background = md_theme_light_background,
    onBackground = md_theme_light_onBackground,
    surface = md_theme_light_surface,
    onSurface = md_theme_light_onSurface,
    surfaceVariant = md_theme_light_surfaceVariant,
    onSurfaceVariant = md_theme_light_onSurfaceVariant,
    outline = md_theme_light_outline,
    inverseOnSurface = md_theme_light_inverseOnSurface,
    inverseSurface = md_theme_light_inverseSurface,
    inversePrimary = md_theme_light_inversePrimary,
    surfaceTint = md_theme_light_surfaceTint,
    outlineVariant = md_theme_light_outlineVariant,
    scrim = md_theme_light_scrim,
)

val DarkCyanTheme = darkColorScheme(
    primary = md_theme_dark_primary,
    onPrimary = md_theme_dark_onPrimary,
    primaryContainer = md_theme_dark_primaryContainer,
    onPrimaryContainer = md_theme_dark_onPrimaryContainer,
    secondary = md_theme_dark_secondary,
    onSecondary = md_theme_dark_onSecondary,
    secondaryContainer = md_theme_dark_secondaryContainer,
    onSecondaryContainer = md_theme_dark_onSecondaryContainer,
    tertiary = md_theme_dark_tertiary,
    onTertiary = md_theme_dark_onTertiary,
    tertiaryContainer = md_theme_dark_tertiaryContainer,
    onTertiaryContainer = md_theme_dark_onTertiaryContainer,
    error = md_theme_dark_error,
    errorContainer = md_theme_dark_errorContainer,
    onError = md_theme_dark_onError,
    onErrorContainer = md_theme_dark_onErrorContainer,
    background = md_theme_dark_background,
    onBackground = md_theme_dark_onBackground,
    surface = md_theme_dark_surface,
    onSurface = md_theme_dark_onSurface,
    surfaceVariant = md_theme_dark_surfaceVariant,
    onSurfaceVariant = md_theme_dark_onSurfaceVariant,
    outline = md_theme_dark_outline,
    inverseOnSurface = md_theme_dark_inverseOnSurface,
    inverseSurface = md_theme_dark_inverseSurface,
    inversePrimary = md_theme_dark_inversePrimary,
    surfaceTint = md_theme_dark_surfaceTint,
    outlineVariant = md_theme_dark_outlineVariant,
    scrim = md_theme_dark_scrim,
)
```

`app/src/main/java/me/bmax/apatch/ui/theme/DeepOrangeTheme.kt`:

```kt
package me.bmax.apatch.ui.theme

import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.ui.graphics.Color

private val md_theme_light_primary = Color(0xFFB02F00)
private val md_theme_light_onPrimary = Color(0xFFFFFFFF)
private val md_theme_light_primaryContainer = Color(0xFFFFDBD1)
private val md_theme_light_onPrimaryContainer = Color(0xFF3B0900)
private val md_theme_light_secondary = Color(0xFF77574E)
private val md_theme_light_onSecondary = Color(0xFFFFFFFF)
private val md_theme_light_secondaryContainer = Color(0xFFFFDBD1)
private val md_theme_light_onSecondaryContainer = Color(0xFF2C150F)
private val md_theme_light_tertiary = Color(0xFF6C5D2F)
private val md_theme_light_onTertiary = Color(0xFFFFFFFF)
private val md_theme_light_tertiaryContainer = Color(0xFFF5E1A7)
private val md_theme_light_onTertiaryContainer = Color(0xFF231B00)
private val md_theme_light_error = Color(0xFFBA1A1A)
private val md_theme_light_errorContainer = Color(0xFFFFDAD6)
private val md_theme_light_onError = Color(0xFFFFFFFF)
private val md_theme_light_onErrorContainer = Color(0xFF410002)
private val md_theme_light_background = Color(0xFFFFFBFF)
private val md_theme_light_onBackground = Color(0xFF201A18)
private val md_theme_light_surface = Color(0xFFFFFBFF)
private val md_theme_light_onSurface = Color(0xFF201A18)
private val md_theme_light_surfaceVariant = Color(0xFFF5DED8)
private val md_theme_light_onSurfaceVariant = Color(0xFF53433F)
private val md_theme_light_outline = Color(0xFF85736E)
private val md_theme_light_inverseOnSurface = Color(0xFFFBEEEB)
private val md_theme_light_inverseSurface = Color(0xFF362F2D)
private val md_theme_light_inversePrimary = Color(0xFFFFB5A0)
private val md_theme_light_shadow = Color(0xFF000000)
private val md_theme_light_surfaceTint = Color(0xFFB02F00)
private val md_theme_light_outlineVariant = Color(0xFFD8C2BC)
private val md_theme_light_scrim = Color(0xFF000000)

private val md_theme_dark_primary = Color(0xFFFFB5A0)
private val md_theme_dark_onPrimary = Color(0xFF5F1500)
private val md_theme_dark_primaryContainer = Color(0xFF862200)
private val md_theme_dark_onPrimaryContainer = Color(0xFFFFDBD1)
private val md_theme_dark_secondary = Color(0xFFE7BDB2)
private val md_theme_dark_onSecondary = Color(0xFF442A22)
private val md_theme_dark_secondaryContainer = Color(0xFF5D4037)
private val md_theme_dark_onSecondaryContainer = Color(0xFFFFDBD1)
private val md_theme_dark_tertiary = Color(0xFFD8C58D)
private val md_theme_dark_onTertiary = Color(0xFF3B2F05)
private val md_theme_dark_tertiaryContainer = Color(0xFF534619)
private val md_theme_dark_onTertiaryContainer = Color(0xFFF5E1A7)
private val md_theme_dark_error = Color(0xFFFFB4AB)
private val md_theme_dark_errorContainer = Color(0xFF93000A)
private val md_theme_dark_onError = Color(0xFF690005)
private val md_theme_dark_onErrorContainer = Color(0xFFFFDAD6)
private val md_theme_dark_background = Color(0xFF201A18)
private val md_theme_dark_onBackground = Color(0xFFEDE0DC)
private val md_theme_dark_surface = Color(0xFF201A18)
private val md_theme_dark_onSurface = Color(0xFFEDE0DC)
private val md_theme_dark_surfaceVariant = Color(0xFF53433F)
private val md_theme_dark_onSurfaceVariant = Color(0xFFD8C2BC)
private val md_theme_dark_outline = Color(0xFFA08C87)
private val md_theme_dark_inverseOnSurface = Color(0xFF201A18)
private val md_theme_dark_inverseSurface = Color(0xFFEDE0DC)
private val md_theme_dark_inversePrimary = Color(0xFFB02F00)
private val md_theme_dark_shadow = Color(0xFF000000)
private val md_theme_dark_surfaceTint = Color(0xFFFFB5A0)
private val md_theme_dark_outlineVariant = Color(0xFF53433F)
private val md_theme_dark_scrim = Color(0xFF000000)


val LightDeepOrangeTheme = lightColorScheme(
    primary = md_theme_light_primary,
    onPrimary = md_theme_light_onPrimary,
    primaryContainer = md_theme_light_primaryContainer,
    onPrimaryContainer = md_theme_light_onPrimaryContainer,
    secondary = md_theme_light_secondary,
    onSecondary = md_theme_light_onSecondary,
    secondaryContainer = md_theme_light_secondaryContainer,
    onSecondaryContainer = md_theme_light_onSecondaryContainer,
    tertiary = md_theme_light_tertiary,
    onTertiary = md_theme_light_onTertiary,
    tertiaryContainer = md_theme_light_tertiaryContainer,
    onTertiaryContainer = md_theme_light_onTertiaryContainer,
    error = md_theme_light_error,
    errorContainer = md_theme_light_errorContainer,
    onError = md_theme_light_onError,
    onErrorContainer = md_theme_light_onErrorContainer,
    background = md_theme_light_background,
    onBackground = md_theme_light_onBackground,
    surface = md_theme_light_surface,
    onSurface = md_theme_light_onSurface,
    surfaceVariant = md_theme_light_surfaceVariant,
    onSurfaceVariant = md_theme_light_onSurfaceVariant,
    outline = md_theme_light_outline,
    inverseOnSurface = md_theme_light_inverseOnSurface,
    inverseSurface = md_theme_light_inverseSurface,
    inversePrimary = md_theme_light_inversePrimary,
    surfaceTint = md_theme_light_surfaceTint,
    outlineVariant = md_theme_light_outlineVariant,
    scrim = md_theme_light_scrim,
)

val DarkDeepOrangeTheme = darkColorScheme(
    primary = md_theme_dark_primary,
    onPrimary = md_theme_dark_onPrimary,
    primaryContainer = md_theme_dark_primaryContainer,
    onPrimaryContainer = md_theme_dark_onPrimaryContainer,
    secondary = md_theme_dark_secondary,
    onSecondary = md_theme_dark_onSecondary,
    secondaryContainer = md_theme_dark_secondaryContainer,
    onSecondaryContainer = md_theme_dark_onSecondaryContainer,
    tertiary = md_theme_dark_tertiary,
    onTertiary = md_theme_dark_onTertiary,
    tertiaryContainer = md_theme_dark_tertiaryContainer,
    onTertiaryContainer = md_theme_dark_onTertiaryContainer,
    error = md_theme_dark_error,
    errorContainer = md_theme_dark_errorContainer,
    onError = md_theme_dark_onError,
    onErrorContainer = md_theme_dark_onErrorContainer,
    background = md_theme_dark_background,
    onBackground = md_theme_dark_onBackground,
    surface = md_theme_dark_surface,
    onSurface = md_theme_dark_onSurface,
    surfaceVariant = md_theme_dark_surfaceVariant,
    onSurfaceVariant = md_theme_dark_onSurfaceVariant,
    outline = md_theme_dark_outline,
    inverseOnSurface = md_theme_dark_inverseOnSurface,
    inverseSurface = md_theme_dark_inverseSurface,
    inversePrimary = md_theme_dark_inversePrimary,
    surfaceTint = md_theme_dark_surfaceTint,
    outlineVariant = md_theme_dark_outlineVariant,
    scrim = md_theme_dark_scrim,
)
```

`app/src/main/java/me/bmax/apatch/ui/theme/DeepPurpleTheme.kt`:

```kt
package me.bmax.apatch.ui.theme

import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.ui.graphics.Color

private val md_theme_light_primary = Color(0xFF6F43C0)
private val md_theme_light_onPrimary = Color(0xFFFFFFFF)
private val md_theme_light_primaryContainer = Color(0xFFEBDDFF)
private val md_theme_light_onPrimaryContainer = Color(0xFF250059)
private val md_theme_light_secondary = Color(0xFF635B70)
private val md_theme_light_onSecondary = Color(0xFFFFFFFF)
private val md_theme_light_secondaryContainer = Color(0xFFE9DEF8)
private val md_theme_light_onSecondaryContainer = Color(0xFF1F182B)
private val md_theme_light_tertiary = Color(0xFF7E525D)
private val md_theme_light_onTertiary = Color(0xFFFFFFFF)
private val md_theme_light_tertiaryContainer = Color(0xFFFFD9E1)
private val md_theme_light_onTertiaryContainer = Color(0xFF31101B)
private val md_theme_light_error = Color(0xFFBA1A1A)
private val md_theme_light_errorContainer = Color(0xFFFFDAD6)
private val md_theme_light_onError = Color(0xFFFFFFFF)
private val md_theme_light_onErrorContainer = Color(0xFF410002)
private val md_theme_light_background = Color(0xFFFFFBFF)
private val md_theme_light_onBackground = Color(0xFF1D1B1E)
private val md_theme_light_surface = Color(0xFFFFFBFF)
private val md_theme_light_onSurface = Color(0xFF1D1B1E)
private val md_theme_light_surfaceVariant = Color(0xFFE7E0EB)
private val md_theme_light_onSurfaceVariant = Color(0xFF49454E)
private val md_theme_light_outline = Color(0xFF7A757F)
private val md_theme_light_inverseOnSurface = Color(0xFFF5EFF4)
private val md_theme_light_inverseSurface = Color(0xFF323033)
private val md_theme_light_inversePrimary = Color(0xFFD3BBFF)
private val md_theme_light_shadow = Color(0xFF000000)
private val md_theme_light_surfaceTint = Color(0xFF6F43C0)
private val md_theme_light_outlineVariant = Color(0xFFCBC4CF)
private val md_theme_light_scrim = Color(0xFF000000)

private val md_theme_dark_primary = Color(0xFFD3BBFF)
private val md_theme_dark_onPrimary = Color(0xFF3F008D)
private val md_theme_dark_primaryContainer = Color(0xFF5727A6)
private val md_theme_dark_onPrimaryContainer = Color(0xFFEBDDFF)
private val md_theme_dark_secondary = Color(0xFFCDC2DB)
private val md_theme_dark_onSecondary = Color(0xFF342D40)
private val md_theme_dark_secondaryContainer = Color(0xFF4B4358)
private val md_theme_dark_onSecondaryContainer = Color(0xFFE9DEF8)
private val md_theme_dark_tertiary = Color(0xFFF0B7C5)
private val md_theme_dark_onTertiary = Color(0xFF4A2530)
private val md_theme_dark_tertiaryContainer = Color(0xFF643B46)
private val md_theme_dark_onTertiaryContainer = Color(0xFFFFD9E1)
private val md_theme_dark_error = Color(0xFFFFB4AB)
private val md_theme_dark_errorContainer = Color(0xFF93000A)
private val md_theme_dark_onError = Color(0xFF690005)
private val md_theme_dark_onErrorContainer = Color(0xFFFFDAD6)
private val md_theme_dark_background = Color(0xFF1D1B1E)
private val md_theme_dark_onBackground = Color(0xFFE6E1E6)
private val md_theme_dark_surface = Color(0xFF1D1B1E)
private val md_theme_dark_onSurface = Color(0xFFE6E1E6)
private val md_theme_dark_surfaceVariant = Color(0xFF49454E)
private val md_theme_dark_onSurfaceVariant = Color(0xFFCBC4CF)
private val md_theme_dark_outline = Color(0xFF948F99)
private val md_theme_dark_inverseOnSurface = Color(0xFF1D1B1E)
private val md_theme_dark_inverseSurface = Color(0xFFE6E1E6)
private val md_theme_dark_inversePrimary = Color(0xFF6F43C0)
private val md_theme_dark_shadow = Color(0xFF000000)
private val md_theme_dark_surfaceTint = Color(0xFFD3BBFF)
private val md_theme_dark_outlineVariant = Color(0xFF49454E)
private val md_theme_dark_scrim = Color(0xFF000000)

val LightDeepPurpleTheme = lightColorScheme(
    primary = md_theme_light_primary,
    onPrimary = md_theme_light_onPrimary,
    primaryContainer = md_theme_light_primaryContainer,
    onPrimaryContainer = md_theme_light_onPrimaryContainer,
    secondary = md_theme_light_secondary,
    onSecondary = md_theme_light_onSecondary,
    secondaryContainer = md_theme_light_secondaryContainer,
    onSecondaryContainer = md_theme_light_onSecondaryContainer,
    tertiary = md_theme_light_tertiary,
    onTertiary = md_theme_light_onTertiary,
    tertiaryContainer = md_theme_light_tertiaryContainer,
    onTertiaryContainer = md_theme_light_onTertiaryContainer,
    error = md_theme_light_error,
    errorContainer = md_theme_light_errorContainer,
    onError = md_theme_light_onError,
    onErrorContainer = md_theme_light_onErrorContainer,
    background = md_theme_light_background,
    onBackground = md_theme_light_onBackground,
    surface = md_theme_light_surface,
    onSurface = md_theme_light_onSurface,
    surfaceVariant = md_theme_light_surfaceVariant,
    onSurfaceVariant = md_theme_light_onSurfaceVariant,
    outline = md_theme_light_outline,
    inverseOnSurface = md_theme_light_inverseOnSurface,
    inverseSurface = md_theme_light_inverseSurface,
    inversePrimary = md_theme_light_inversePrimary,
    surfaceTint = md_theme_light_surfaceTint,
    outlineVariant = md_theme_light_outlineVariant,
    scrim = md_theme_light_scrim,
)

val DarkDeepPurpleTheme = darkColorScheme(
    primary = md_theme_dark_primary,
    onPrimary = md_theme_dark_onPrimary,
    primaryContainer = md_theme_dark_primaryContainer,
    onPrimaryContainer = md_theme_dark_onPrimaryContainer,
    secondary = md_theme_dark_secondary,
    onSecondary = md_theme_dark_onSecondary,
    secondaryContainer = md_theme_dark_secondaryContainer,
    onSecondaryContainer = md_theme_dark_onSecondaryContainer,
    tertiary = md_theme_dark_tertiary,
    onTertiary = md_theme_dark_onTertiary,
    tertiaryContainer = md_theme_dark_tertiaryContainer,
    onTertiaryContainer = md_theme_dark_onTertiaryContainer,
    error = md_theme_dark_error,
    errorContainer = md_theme_dark_errorContainer,
    onError = md_theme_dark_onError,
    onErrorContainer = md_theme_dark_onErrorContainer,
    background = md_theme_dark_background,
    onBackground = md_theme_dark_onBackground,
    surface = md_theme_dark_surface,
    onSurface = md_theme_dark_onSurface,
    surfaceVariant = md_theme_dark_surfaceVariant,
    onSurfaceVariant = md_theme_dark_onSurfaceVariant,
    outline = md_theme_dark_outline,
    inverseOnSurface = md_theme_dark_inverseOnSurface,
    inverseSurface = md_theme_dark_inverseSurface,
    inversePrimary = md_theme_dark_inversePrimary,
    surfaceTint = md_theme_dark_surfaceTint,
    outlineVariant = md_theme_dark_outlineVariant,
    scrim = md_theme_dark_scrim,
)
```

`app/src/main/java/me/bmax/apatch/ui/theme/GreenTheme.kt`:

```kt
package me.bmax.apatch.ui.theme

import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.ui.graphics.Color

private val md_theme_light_primary = Color(0xFF006E1A)
private val md_theme_light_onPrimary = Color(0xFFFFFFFF)
private val md_theme_light_primaryContainer = Color(0xFF96F990)
private val md_theme_light_onPrimaryContainer = Color(0xFF002203)
private val md_theme_light_secondary = Color(0xFF53634F)
private val md_theme_light_onSecondary = Color(0xFFFFFFFF)
private val md_theme_light_secondaryContainer = Color(0xFFD6E8CE)
private val md_theme_light_onSecondaryContainer = Color(0xFF111F0F)
private val md_theme_light_tertiary = Color(0xFF38656A)
private val md_theme_light_onTertiary = Color(0xFFFFFFFF)
private val md_theme_light_tertiaryContainer = Color(0xFFBCEBF0)
private val md_theme_light_onTertiaryContainer = Color(0xFF002023)
private val md_theme_light_error = Color(0xFFBA1A1A)
private val md_theme_light_errorContainer = Color(0xFFFFDAD6)
private val md_theme_light_onError = Color(0xFFFFFFFF)
private val md_theme_light_onErrorContainer = Color(0xFF410002)
private val md_theme_light_background = Color(0xFFFCFDF6)
private val md_theme_light_onBackground = Color(0xFF1A1C19)
private val md_theme_light_surface = Color(0xFFFCFDF6)
private val md_theme_light_onSurface = Color(0xFF1A1C19)
private val md_theme_light_surfaceVariant = Color(0xFFDEE5D8)
private val md_theme_light_onSurfaceVariant = Color(0xFF424940)
private val md_theme_light_outline = Color(0xFF72796F)
private val md_theme_light_inverseOnSurface = Color(0xFFF1F1EB)
private val md_theme_light_inverseSurface = Color(0xFF2F312D)
private val md_theme_light_inversePrimary = Color(0xFF7ADC77)
private val md_theme_light_shadow = Color(0xFF000000)
private val md_theme_light_surfaceTint = Color(0xFF006E1A)
private val md_theme_light_outlineVariant = Color(0xFFC2C8BD)
private val md_theme_light_scrim = Color(0xFF000000)

private val md_theme_dark_primary = Color(0xFF7ADC77)
private val md_theme_dark_onPrimary = Color(0xFF003909)
private val md_theme_dark_primaryContainer = Color(0xFF005311)
private val md_theme_dark_onPrimaryContainer = Color(0xFF96F990)
private val md_theme_dark_secondary = Color(0xFFBACCB3)
private val md_theme_dark_onSecondary = Color(0xFF253423)
private val md_theme_dark_secondaryContainer = Color(0xFF3B4B38)
private val md_theme_dark_onSecondaryContainer = Color(0xFFD6E8CE)
private val md_theme_dark_tertiary = Color(0xFFA0CFD4)
private val md_theme_dark_onTertiary = Color(0xFF00363B)
private val md_theme_dark_tertiaryContainer = Color(0xFF1E4D52)
private val md_theme_dark_onTertiaryContainer = Color(0xFFBCEBF0)
private val md_theme_dark_error = Color(0xFFFFB4AB)
private val md_theme_dark_errorContainer = Color(0xFF93000A)
private val md_theme_dark_onError = Color(0xFF690005)
private val md_theme_dark_onErrorContainer = Color(0xFFFFDAD6)
private val md_theme_dark_background = Color(0xFF1A1C19)
private val md_theme_dark_onBackground = Color(0xFFE2E3DD)
private val md_theme_dark_surface = Color(0xFF1A1C19)
private val md_theme_dark_onSurface = Color(0xFFE2E3DD)
private val md_theme_dark_surfaceVariant = Color(0xFF424940)
private val md_theme_dark_onSurfaceVariant = Color(0xFFC2C8BD)
private val md_theme_dark_outline = Color(0xFF8C9388)
private val md_theme_dark_inverseOnSurface = Color(0xFF1A1C19)
private val md_theme_dark_inverseSurface = Color(0xFFE2E3DD)
private val md_theme_dark_inversePrimary = Color(0xFF006E1A)
private val md_theme_dark_shadow = Color(0xFF000000)
private val md_theme_dark_surfaceTint = Color(0xFF7ADC77)
private val md_theme_dark_outlineVariant = Color(0xFF424940)
private val md_theme_dark_scrim = Color(0xFF000000)

val LightGreenTheme = lightColorScheme(
    primary = md_theme_light_primary,
    onPrimary = md_theme_light_onPrimary,
    primaryContainer = md_theme_light_primaryContainer,
    onPrimaryContainer = md_theme_light_onPrimaryContainer,
    secondary = md_theme_light_secondary,
    onSecondary = md_theme_light_onSecondary,
    secondaryContainer = md_theme_light_secondaryContainer,
    onSecondaryContainer = md_theme_light_onSecondaryContainer,
    tertiary = md_theme_light_tertiary,
    onTertiary = md_theme_light_onTertiary,
    tertiaryContainer = md_theme_light_tertiaryContainer,
    onTertiaryContainer = md_theme_light_onTertiaryContainer,
    error = md_theme_light_error,
    errorContainer = md_theme_light_errorContainer,
    onError = md_theme_light_onError,
    onErrorContainer = md_theme_light_onErrorContainer,
    background = md_theme_light_background,
    onBackground = md_theme_light_onBackground,
    surface = md_theme_light_surface,
    onSurface = md_theme_light_onSurface,
    surfaceVariant = md_theme_light_surfaceVariant,
    onSurfaceVariant = md_theme_light_onSurfaceVariant,
    outline = md_theme_light_outline,
    inverseOnSurface = md_theme_light_inverseOnSurface,
    inverseSurface = md_theme_light_inverseSurface,
    inversePrimary = md_theme_light_inversePrimary,
    surfaceTint = md_theme_light_surfaceTint,
    outlineVariant = md_theme_light_outlineVariant,
    scrim = md_theme_light_scrim,
)

val DarkGreenTheme = darkColorScheme(
    primary = md_theme_dark_primary,
    onPrimary = md_theme_dark_onPrimary,
    primaryContainer = md_theme_dark_primaryContainer,
    onPrimaryContainer = md_theme_dark_onPrimaryContainer,
    secondary = md_theme_dark_secondary,
    onSecondary = md_theme_dark_onSecondary,
    secondaryContainer = md_theme_dark_secondaryContainer,
    onSecondaryContainer = md_theme_dark_onSecondaryContainer,
    tertiary = md_theme_dark_tertiary,
    onTertiary = md_theme_dark_onTertiary,
    tertiaryContainer = md_theme_dark_tertiaryContainer,
    onTertiaryContainer = md_theme_dark_onTertiaryContainer,
    error = md_theme_dark_error,
    errorContainer = md_theme_dark_errorContainer,
    onError = md_theme_dark_onError,
    onErrorContainer = md_theme_dark_onErrorContainer,
    background = md_theme_dark_background,
    onBackground = md_theme_dark_onBackground,
    surface = md_theme_dark_surface,
    onSurface = md_theme_dark_onSurface,
    surfaceVariant = md_theme_dark_surfaceVariant,
    onSurfaceVariant = md_theme_dark_onSurfaceVariant,
    outline = md_theme_dark_outline,
    inverseOnSurface = md_theme_dark_inverseOnSurface,
    inverseSurface = md_theme_dark_inverseSurface,
    inversePrimary = md_theme_dark_inversePrimary,
    surfaceTint = md_theme_dark_surfaceTint,
    outlineVariant = md_theme_dark_outlineVariant,
    scrim = md_theme_dark_scrim,
)
```

`app/src/main/java/me/bmax/apatch/ui/theme/IndigoTheme.kt`:

```kt
package me.bmax.apatch.ui.theme

import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.ui.graphics.Color

private val md_theme_light_primary = Color(0xFF4355B9)
private val md_theme_light_onPrimary = Color(0xFFFFFFFF)
private val md_theme_light_primaryContainer = Color(0xFFDEE0FF)
private val md_theme_light_onPrimaryContainer = Color(0xFF00105C)
private val md_theme_light_secondary = Color(0xFF5B5D72)
private val md_theme_light_onSecondary = Color(0xFFFFFFFF)
private val md_theme_light_secondaryContainer = Color(0xFFE0E1F9)
private val md_theme_light_onSecondaryContainer = Color(0xFF181A2C)
private val md_theme_light_tertiary = Color(0xFF77536D)
private val md_theme_light_onTertiary = Color(0xFFFFFFFF)
private val md_theme_light_tertiaryContainer = Color(0xFFFFD7F1)
private val md_theme_light_onTertiaryContainer = Color(0xFF2D1228)
private val md_theme_light_error = Color(0xFFBA1A1A)
private val md_theme_light_errorContainer = Color(0xFFFFDAD6)
private val md_theme_light_onError = Color(0xFFFFFFFF)
private val md_theme_light_onErrorContainer = Color(0xFF410002)
private val md_theme_light_background = Color(0xFFFEFBFF)
private val md_theme_light_onBackground = Color(0xFF1B1B1F)
private val md_theme_light_surface = Color(0xFFFEFBFF)
private val md_theme_light_onSurface = Color(0xFF1B1B1F)
private val md_theme_light_surfaceVariant = Color(0xFFE3E1EC)
private val md_theme_light_onSurfaceVariant = Color(0xFF46464F)
private val md_theme_light_outline = Color(0xFF767680)
private val md_theme_light_inverseOnSurface = Color(0xFFF3F0F4)
private val md_theme_light_inverseSurface = Color(0xFF303034)
private val md_theme_light_inversePrimary = Color(0xFFBAC3FF)
private val md_theme_light_shadow = Color(0xFF000000)
private val md_theme_light_surfaceTint = Color(0xFF4355B9)
private val md_theme_light_outlineVariant = Color(0xFFC7C5D0)
private val md_theme_light_scrim = Color(0xFF000000)

private val md_theme_dark_primary = Color(0xFFBAC3FF)
private val md_theme_dark_onPrimary = Color(0xFF08218A)
private val md_theme_dark_primaryContainer = Color(0xFF293CA0)
private val md_theme_dark_onPrimaryContainer = Color(0xFFDEE0FF)
private val md_theme_dark_secondary = Color(0xFFC3C5DD)
private val md_theme_dark_onSecondary = Color(0xFF2D2F42)
private val md_theme_dark_secondaryContainer = Color(0xFF434659)
private val md_theme_dark_onSecondaryContainer = Color(0xFFE0E1F9)
private val md_theme_dark_tertiary = Color(0xFFE6BAD7)
private val md_theme_dark_onTertiary = Color(0xFF44263D)
private val md_theme_dark_tertiaryContainer = Color(0xFF5D3C55)
private val md_theme_dark_onTertiaryContainer = Color(0xFFFFD7F1)
private val md_theme_dark_error = Color(0xFFFFB4AB)
private val md_theme_dark_errorContainer = Color(0xFF93000A)
private val md_theme_dark_onError = Color(0xFF690005)
private val md_theme_dark_onErrorContainer = Color(0xFFFFDAD6)
private val md_theme_dark_background = Color(0xFF1B1B1F)
private val md_theme_dark_onBackground = Color(0xFFE4E1E6)
private val md_theme_dark_surface = Color(0xFF1B1B1F)
private val md_theme_dark_onSurface = Color(0xFFE4E1E6)
private val md_theme_dark_surfaceVariant = Color(0xFF46464F)
private val md_theme_dark_onSurfaceVariant = Color(0xFFC7C5D0)
private val md_theme_dark_outline = Color(0xFF90909A)
private val md_theme_dark_inverseOnSurface = Color(0xFF1B1B1F)
private val md_theme_dark_inverseSurface = Color(0xFFE4E1E6)
private val md_theme_dark_inversePrimary = Color(0xFF4355B9)
private val md_theme_dark_shadow = Color(0xFF000000)
private val md_theme_dark_surfaceTint = Color(0xFFBAC3FF)
private val md_theme_dark_outlineVariant = Color(0xFF46464F)
private val md_theme_dark_scrim = Color(0xFF000000)

val LightIndigoTheme = lightColorScheme(
    primary = md_theme_light_primary,
    onPrimary = md_theme_light_onPrimary,
    primaryContainer = md_theme_light_primaryContainer,
    onPrimaryContainer = md_theme_light_onPrimaryContainer,
    secondary = md_theme_light_secondary,
    onSecondary = md_theme_light_onSecondary,
    secondaryContainer = md_theme_light_secondaryContainer,
    onSecondaryContainer = md_theme_light_onSecondaryContainer,
    tertiary = md_theme_light_tertiary,
    onTertiary = md_theme_light_onTertiary,
    tertiaryContainer = md_theme_light_tertiaryContainer,
    onTertiaryContainer = md_theme_light_onTertiaryContainer,
    error = md_theme_light_error,
    errorContainer = md_theme_light_errorContainer,
    onError = md_theme_light_onError,
    onErrorContainer = md_theme_light_onErrorContainer,
    background = md_theme_light_background,
    onBackground = md_theme_light_onBackground,
    surface = md_theme_light_surface,
    onSurface = md_theme_light_onSurface,
    surfaceVariant = md_theme_light_surfaceVariant,
    onSurfaceVariant = md_theme_light_onSurfaceVariant,
    outline = md_theme_light_outline,
    inverseOnSurface = md_theme_light_inverseOnSurface,
    inverseSurface = md_theme_light_inverseSurface,
    inversePrimary = md_theme_light_inversePrimary,
    surfaceTint = md_theme_light_surfaceTint,
    outlineVariant = md_theme_light_outlineVariant,
    scrim = md_theme_light_scrim,
)

val DarkIndigoTheme = darkColorScheme(
    primary = md_theme_dark_primary,
    onPrimary = md_theme_dark_onPrimary,
    primaryContainer = md_theme_dark_primaryContainer,
    onPrimaryContainer = md_theme_dark_onPrimaryContainer,
    secondary = md_theme_dark_secondary,
    onSecondary = md_theme_dark_onSecondary,
    secondaryContainer = md_theme_dark_secondaryContainer,
    onSecondaryContainer = md_theme_dark_onSecondaryContainer,
    tertiary = md_theme_dark_tertiary,
    onTertiary = md_theme_dark_onTertiary,
    tertiaryContainer = md_theme_dark_tertiaryContainer,
    onTertiaryContainer = md_theme_dark_onTertiaryContainer,
    error = md_theme_dark_error,
    errorContainer = md_theme_dark_errorContainer,
    onError = md_theme_dark_onError,
    onErrorContainer = md_theme_dark_onErrorContainer,
    background = md_theme_dark_background,
    onBackground = md_theme_dark_onBackground,
    surface = md_theme_dark_surface,
    onSurface = md_theme_dark_onSurface,
    surfaceVariant = md_theme_dark_surfaceVariant,
    onSurfaceVariant = md_theme_dark_onSurfaceVariant,
    outline = md_theme_dark_outline,
    inverseOnSurface = md_theme_dark_inverseOnSurface,
    inverseSurface = md_theme_dark_inverseSurface,
    inversePrimary = md_theme_dark_inversePrimary,
    surfaceTint = md_theme_dark_surfaceTint,
    outlineVariant = md_theme_dark_outlineVariant,
    scrim = md_theme_dark_scrim,
)
```

`app/src/main/java/me/bmax/apatch/ui/theme/LightBlueTheme.kt`:

```kt
package me.bmax.apatch.ui.theme

import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.ui.graphics.Color

private val md_theme_light_primary = Color(0xFF006493)
private val md_theme_light_onPrimary = Color(0xFFFFFFFF)
private val md_theme_light_primaryContainer = Color(0xFFCAE6FF)
private val md_theme_light_onPrimaryContainer = Color(0xFF001E30)
private val md_theme_light_secondary = Color(0xFF50606E)
private val md_theme_light_onSecondary = Color(0xFFFFFFFF)
private val md_theme_light_secondaryContainer = Color(0xFFD3E5F5)
private val md_theme_light_onSecondaryContainer = Color(0xFF0C1D29)
private val md_theme_light_tertiary = Color(0xFF65587B)
private val md_theme_light_onTertiary = Color(0xFFFFFFFF)
private val md_theme_light_tertiaryContainer = Color(0xFFEBDDFF)
private val md_theme_light_onTertiaryContainer = Color(0xFF201634)
private val md_theme_light_error = Color(0xFFBA1A1A)
private val md_theme_light_errorContainer = Color(0xFFFFDAD6)
private val md_theme_light_onError = Color(0xFFFFFFFF)
private val md_theme_light_onErrorContainer = Color(0xFF410002)
private val md_theme_light_background = Color(0xFFFCFCFF)
private val md_theme_light_onBackground = Color(0xFF1A1C1E)
private val md_theme_light_surface = Color(0xFFFCFCFF)
private val md_theme_light_onSurface = Color(0xFF1A1C1E)
private val md_theme_light_surfaceVariant = Color(0xFFDDE3EA)
private val md_theme_light_onSurfaceVariant = Color(0xFF41474D)
private val md_theme_light_outline = Color(0xFF72787E)
private val md_theme_light_inverseOnSurface = Color(0xFFF0F0F3)
private val md_theme_light_inverseSurface = Color(0xFF2E3133)
private val md_theme_light_inversePrimary = Color(0xFF8DCDFF)
private val md_theme_light_shadow = Color(0xFF000000)
private val md_theme_light_surfaceTint = Color(0xFF006493)
private val md_theme_light_outlineVariant = Color(0xFFC1C7CE)
private val md_theme_light_scrim = Color(0xFF000000)

private val md_theme_dark_primary = Color(0xFF8DCDFF)
private val md_theme_dark_onPrimary = Color(0xFF00344F)
private val md_theme_dark_primaryContainer = Color(0xFF004B70)
private val md_theme_dark_onPrimaryContainer = Color(0xFFCAE6FF)
private val md_theme_dark_secondary = Color(0xFFB7C9D9)
private val md_theme_dark_onSecondary = Color(0xFF22323F)
private val md_theme_dark_secondaryContainer = Color(0xFF384956)
private val md_theme_dark_onSecondaryContainer = Color(0xFFD3E5F5)
private val md_theme_dark_tertiary = Color(0xFFCFC0E8)
private val md_theme_dark_onTertiary = Color(0xFF362B4B)
private val md_theme_dark_tertiaryContainer = Color(0xFF4D4162)
private val md_theme_dark_onTertiaryContainer = Color(0xFFEBDDFF)
private val md_theme_dark_error = Color(0xFFFFB4AB)
private val md_theme_dark_errorContainer = Color(0xFF93000A)
private val md_theme_dark_onError = Color(0xFF690005)
private val md_theme_dark_onErrorContainer = Color(0xFFFFDAD6)
private val md_theme_dark_background = Color(0xFF1A1C1E)
private val md_theme_dark_onBackground = Color(0xFFE2E2E5)
private val md_theme_dark_surface = Color(0xFF1A1C1E)
private val md_theme_dark_onSurface = Color(0xFFE2E2E5)
private val md_theme_dark_surfaceVariant = Color(0xFF41474D)
private val md_theme_dark_onSurfaceVariant = Color(0xFFC1C7CE)
private val md_theme_dark_outline = Color(0xFF8B9198)
private val md_theme_dark_inverseOnSurface = Color(0xFF1A1C1E)
private val md_theme_dark_inverseSurface = Color(0xFFE2E2E5)
private val md_theme_dark_inversePrimary = Color(0xFF006493)
private val md_theme_dark_shadow = Color(0xFF000000)
private val md_theme_dark_surfaceTint = Color(0xFF8DCDFF)
private val md_theme_dark_outlineVariant = Color(0xFF41474D)
private val md_theme_dark_scrim = Color(0xFF000000)


val LightLightBlueTheme = lightColorScheme(
    primary = md_theme_light_primary,
    onPrimary = md_theme_light_onPrimary,
    primaryContainer = md_theme_light_primaryContainer,
    onPrimaryContainer = md_theme_light_onPrimaryContainer,
    secondary = md_theme_light_secondary,
    onSecondary = md_theme_light_onSecondary,
    secondaryContainer = md_theme_light_secondaryContainer,
    onSecondaryContainer = md_theme_light_onSecondaryContainer,
    tertiary = md_theme_light_tertiary,
    onTertiary = md_theme_light_onTertiary,
    tertiaryContainer = md_theme_light_tertiaryContainer,
    onTertiaryContainer = md_theme_light_onTertiaryContainer,
    error = md_theme_light_error,
    errorContainer = md_theme_light_errorContainer,
    onError = md_theme_light_onError,
    onErrorContainer = md_theme_light_onErrorContainer,
    background = md_theme_light_background,
    onBackground = md_theme_light_onBackground,
    surface = md_theme_light_surface,
    onSurface = md_theme_light_onSurface,
    surfaceVariant = md_theme_light_surfaceVariant,
    onSurfaceVariant = md_theme_light_onSurfaceVariant,
    outline = md_theme_light_outline,
    inverseOnSurface = md_theme_light_inverseOnSurface,
    inverseSurface = md_theme_light_inverseSurface,
    inversePrimary = md_theme_light_inversePrimary,
    surfaceTint = md_theme_light_surfaceTint,
    outlineVariant = md_theme_light_outlineVariant,
    scrim = md_theme_light_scrim,
)

val DarkLightBlueTheme = darkColorScheme(
    primary = md_theme_dark_primary,
    onPrimary = md_theme_dark_onPrimary,
    primaryContainer = md_theme_dark_primaryContainer,
    onPrimaryContainer = md_theme_dark_onPrimaryContainer,
    secondary = md_theme_dark_secondary,
    onSecondary = md_theme_dark_onSecondary,
    secondaryContainer = md_theme_dark_secondaryContainer,
    onSecondaryContainer = md_theme_dark_onSecondaryContainer,
    tertiary = md_theme_dark_tertiary,
    onTertiary = md_theme_dark_onTertiary,
    tertiaryContainer = md_theme_dark_tertiaryContainer,
    onTertiaryContainer = md_theme_dark_onTertiaryContainer,
    error = md_theme_dark_error,
    errorContainer = md_theme_dark_errorContainer,
    onError = md_theme_dark_onError,
    onErrorContainer = md_theme_dark_onErrorContainer,
    background = md_theme_dark_background,
    onBackground = md_theme_dark_onBackground,
    surface = md_theme_dark_surface,
    onSurface = md_theme_dark_onSurface,
    surfaceVariant = md_theme_dark_surfaceVariant,
    onSurfaceVariant = md_theme_dark_onSurfaceVariant,
    outline = md_theme_dark_outline,
    inverseOnSurface = md_theme_dark_inverseOnSurface,
    inverseSurface = md_theme_dark_inverseSurface,
    inversePrimary = md_theme_dark_inversePrimary,
    surfaceTint = md_theme_dark_surfaceTint,
    outlineVariant = md_theme_dark_outlineVariant,
    scrim = md_theme_dark_scrim,
)
```

`app/src/main/java/me/bmax/apatch/ui/theme/LightGreenTheme.kt`:

```kt
package me.bmax.apatch.ui.theme

import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.ui.graphics.Color

private val md_theme_light_primary = Color(0xFF006C48)
private val md_theme_light_onPrimary = Color(0xFFFFFFFF)
private val md_theme_light_primaryContainer = Color(0xFF8DF7C2)
private val md_theme_light_onPrimaryContainer = Color(0xFF002113)
private val md_theme_light_secondary = Color(0xFF4D6356)
private val md_theme_light_onSecondary = Color(0xFFFFFFFF)
private val md_theme_light_secondaryContainer = Color(0xFFD0E8D8)
private val md_theme_light_onSecondaryContainer = Color(0xFF0A1F15)
private val md_theme_light_tertiary = Color(0xFF3C6472)
private val md_theme_light_onTertiary = Color(0xFFFFFFFF)
private val md_theme_light_tertiaryContainer = Color(0xFFC0E9FA)
private val md_theme_light_onTertiaryContainer = Color(0xFF001F28)
private val md_theme_light_error = Color(0xFFBA1A1A)
private val md_theme_light_errorContainer = Color(0xFFFFDAD6)
private val md_theme_light_onError = Color(0xFFFFFFFF)
private val md_theme_light_onErrorContainer = Color(0xFF410002)
private val md_theme_light_background = Color(0xFFFBFDF8)
private val md_theme_light_onBackground = Color(0xFF191C1A)
private val md_theme_light_surface = Color(0xFFFBFDF8)
private val md_theme_light_onSurface = Color(0xFF191C1A)
private val md_theme_light_surfaceVariant = Color(0xFFDCE5DD)
private val md_theme_light_onSurfaceVariant = Color(0xFF404943)
private val md_theme_light_outline = Color(0xFF707973)
private val md_theme_light_inverseOnSurface = Color(0xFFEFF1ED)
private val md_theme_light_inverseSurface = Color(0xFF2E312F)
private val md_theme_light_inversePrimary = Color(0xFF70DBA7)
private val md_theme_light_shadow = Color(0xFF000000)
private val md_theme_light_surfaceTint = Color(0xFF006C48)
private val md_theme_light_outlineVariant = Color(0xFFC0C9C1)
private val md_theme_light_scrim = Color(0xFF000000)

private val md_theme_dark_primary = Color(0xFF70DBA7)
private val md_theme_dark_onPrimary = Color(0xFF003824)
private val md_theme_dark_primaryContainer = Color(0xFF005235)
private val md_theme_dark_onPrimaryContainer = Color(0xFF8DF7C2)
private val md_theme_dark_secondary = Color(0xFFB4CCBC)
private val md_theme_dark_onSecondary = Color(0xFF20352A)
private val md_theme_dark_secondaryContainer = Color(0xFF364B3F)
private val md_theme_dark_onSecondaryContainer = Color(0xFFD0E8D8)
private val md_theme_dark_tertiary = Color(0xFFA4CDDE)
private val md_theme_dark_onTertiary = Color(0xFF063543)
private val md_theme_dark_tertiaryContainer = Color(0xFF234C5A)
private val md_theme_dark_onTertiaryContainer = Color(0xFFC0E9FA)
private val md_theme_dark_error = Color(0xFFFFB4AB)
private val md_theme_dark_errorContainer = Color(0xFF93000A)
private val md_theme_dark_onError = Color(0xFF690005)
private val md_theme_dark_onErrorContainer = Color(0xFFFFDAD6)
private val md_theme_dark_background = Color(0xFF191C1A)
private val md_theme_dark_onBackground = Color(0xFFE1E3DF)
private val md_theme_dark_surface = Color(0xFF191C1A)
private val md_theme_dark_onSurface = Color(0xFFE1E3DF)
private val md_theme_dark_surfaceVariant = Color(0xFF404943)
private val md_theme_dark_onSurfaceVariant = Color(0xFFC0C9C1)
private val md_theme_dark_outline = Color(0xFF8A938C)
private val md_theme_dark_inverseOnSurface = Color(0xFF191C1A)
private val md_theme_dark_inverseSurface = Color(0xFFE1E3DF)
private val md_theme_dark_inversePrimary = Color(0xFF006C48)
private val md_theme_dark_shadow = Color(0xFF000000)
private val md_theme_dark_surfaceTint = Color(0xFF70DBA7)
private val md_theme_dark_outlineVariant = Color(0xFF404943)
private val md_theme_dark_scrim = Color(0xFF000000)

val LightLightGreenTheme = lightColorScheme(
    primary = md_theme_light_primary,
    onPrimary = md_theme_light_onPrimary,
    primaryContainer = md_theme_light_primaryContainer,
    onPrimaryContainer = md_theme_light_onPrimaryContainer,
    secondary = md_theme_light_secondary,
    onSecondary = md_theme_light_onSecondary,
    secondaryContainer = md_theme_light_secondaryContainer,
    onSecondaryContainer = md_theme_light_onSecondaryContainer,
    tertiary = md_theme_light_tertiary,
    onTertiary = md_theme_light_onTertiary,
    tertiaryContainer = md_theme_light_tertiaryContainer,
    onTertiaryContainer = md_theme_light_onTertiaryContainer,
    error = md_theme_light_error,
    errorContainer = md_theme_light_errorContainer,
    onError = md_theme_light_onError,
    onErrorContainer = md_theme_light_onErrorContainer,
    background = md_theme_light_background,
    onBackground = md_theme_light_onBackground,
    surface = md_theme_light_surface,
    onSurface = md_theme_light_onSurface,
    surfaceVariant = md_theme_light_surfaceVariant,
    onSurfaceVariant = md_theme_light_onSurfaceVariant,
    outline = md_theme_light_outline,
    inverseOnSurface = md_theme_light_inverseOnSurface,
    inverseSurface = md_theme_light_inverseSurface,
    inversePrimary = md_theme_light_inversePrimary,
    surfaceTint = md_theme_light_surfaceTint,
    outlineVariant = md_theme_light_outlineVariant,
    scrim = md_theme_light_scrim,
)

val DarkLightGreenTheme = darkColorScheme(
    primary = md_theme_dark_primary,
    onPrimary = md_theme_dark_onPrimary,
    primaryContainer = md_theme_dark_primaryContainer,
    onPrimaryContainer = md_theme_dark_onPrimaryContainer,
    secondary = md_theme_dark_secondary,
    onSecondary = md_theme_dark_onSecondary,
    secondaryContainer = md_theme_dark_secondaryContainer,
    onSecondaryContainer = md_theme_dark_onSecondaryContainer,
    tertiary = md_theme_dark_tertiary,
    onTertiary = md_theme_dark_onTertiary,
    tertiaryContainer = md_theme_dark_tertiaryContainer,
    onTertiaryContainer = md_theme_dark_onTertiaryContainer,
    error = md_theme_dark_error,
    errorContainer = md_theme_dark_errorContainer,
    onError = md_theme_dark_onError,
    onErrorContainer = md_theme_dark_onErrorContainer,
    background = md_theme_dark_background,
    onBackground = md_theme_dark_onBackground,
    surface = md_theme_dark_surface,
    onSurface = md_theme_dark_onSurface,
    surfaceVariant = md_theme_dark_surfaceVariant,
    onSurfaceVariant = md_theme_dark_onSurfaceVariant,
    outline = md_theme_dark_outline,
    inverseOnSurface = md_theme_dark_inverseOnSurface,
    inverseSurface = md_theme_dark_inverseSurface,
    inversePrimary = md_theme_dark_inversePrimary,
    surfaceTint = md_theme_dark_surfaceTint,
    outlineVariant = md_theme_dark_outlineVariant,
    scrim = md_theme_dark_scrim,
)
```

`app/src/main/java/me/bmax/apatch/ui/theme/LimeTheme.kt`:

```kt
package me.bmax.apatch.ui.theme

import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.ui.graphics.Color

private val md_theme_light_primary = Color(0xFF5B6300)
private val md_theme_light_onPrimary = Color(0xFFFFFFFF)
private val md_theme_light_primaryContainer = Color(0xFFDDED49)
private val md_theme_light_onPrimaryContainer = Color(0xFF1A1D00)
private val md_theme_light_secondary = Color(0xFF5E6044)
private val md_theme_light_onSecondary = Color(0xFFFFFFFF)
private val md_theme_light_secondaryContainer = Color(0xFFE4E5C1)
private val md_theme_light_onSecondaryContainer = Color(0xFF1B1D07)
private val md_theme_light_tertiary = Color(0xFF3C665A)
private val md_theme_light_onTertiary = Color(0xFFFFFFFF)
private val md_theme_light_tertiaryContainer = Color(0xFFBEECDC)
private val md_theme_light_onTertiaryContainer = Color(0xFF002019)
private val md_theme_light_error = Color(0xFFBA1A1A)
private val md_theme_light_errorContainer = Color(0xFFFFDAD6)
private val md_theme_light_onError = Color(0xFFFFFFFF)
private val md_theme_light_onErrorContainer = Color(0xFF410002)
private val md_theme_light_background = Color(0xFFFEFFD8)
private val md_theme_light_onBackground = Color(0xFF1C1C17)
private val md_theme_light_surface = Color(0xFFFEFFD8)
private val md_theme_light_onSurface = Color(0xFF1C1C17)
private val md_theme_light_surfaceVariant = Color(0xFFE5E3D2)
private val md_theme_light_onSurfaceVariant = Color(0xFF47483B)
private val md_theme_light_outline = Color(0xFF787869)
private val md_theme_light_inverseOnSurface = Color(0xFFF3F1E8)
private val md_theme_light_inverseSurface = Color(0xFF31312B)
private val md_theme_light_inversePrimary = Color(0xFFC1D02C)
private val md_theme_light_shadow = Color(0xFF000000)
private val md_theme_light_surfaceTint = Color(0xFF5B6300)
private val md_theme_light_outlineVariant = Color(0xFFC8C7B7)
private val md_theme_light_scrim = Color(0xFF000000)

private val md_theme_dark_primary = Color(0xFFC1D02C)
private val md_theme_dark_onPrimary = Color(0xFF2F3300)
private val md_theme_dark_primaryContainer = Color(0xFF444B00)
private val md_theme_dark_onPrimaryContainer = Color(0xFFDDED49)
private val md_theme_dark_secondary = Color(0xFFC7C9A6)
private val md_theme_dark_onSecondary = Color(0xFF30321A)
private val md_theme_dark_secondaryContainer = Color(0xFF46492E)
private val md_theme_dark_onSecondaryContainer = Color(0xFFE4E5C1)
private val md_theme_dark_tertiary = Color(0xFFA2D0C1)
private val md_theme_dark_onTertiary = Color(0xFF07372D)
private val md_theme_dark_tertiaryContainer = Color(0xFF234E43)
private val md_theme_dark_onTertiaryContainer = Color(0xFFBEECDC)
private val md_theme_dark_error = Color(0xFFFFB4AB)
private val md_theme_dark_errorContainer = Color(0xFF93000A)
private val md_theme_dark_onError = Color(0xFF690005)
private val md_theme_dark_onErrorContainer = Color(0xFFFFDAD6)
private val md_theme_dark_background = Color(0xFF1C1C17)
private val md_theme_dark_onBackground = Color(0xFFE5E2DA)
private val md_theme_dark_surface = Color(0xFF1C1C17)
private val md_theme_dark_onSurface = Color(0xFFE5E2DA)
private val md_theme_dark_surfaceVariant = Color(0xFF47483B)
private val md_theme_dark_onSurfaceVariant = Color(0xFFC8C7B7)
private val md_theme_dark_outline = Color(0xFF929282)
private val md_theme_dark_inverseOnSurface = Color(0xFF1C1C17)
private val md_theme_dark_inverseSurface = Color(0xFFE5E2DA)
private val md_theme_dark_inversePrimary = Color(0xFF5B6300)
private val md_theme_dark_shadow = Color(0xFF000000)
private val md_theme_dark_surfaceTint = Color(0xFFC1D02C)
private val md_theme_dark_outlineVariant = Color(0xFF47483B)
private val md_theme_dark_scrim = Color(0xFF000000)

val LightLimeTheme = lightColorScheme(
    primary = md_theme_light_primary,
    onPrimary = md_theme_light_onPrimary,
    primaryContainer = md_theme_light_primaryContainer,
    onPrimaryContainer = md_theme_light_onPrimaryContainer,
    secondary = md_theme_light_secondary,
    onSecondary = md_theme_light_onSecondary,
    secondaryContainer = md_theme_light_secondaryContainer,
    onSecondaryContainer = md_theme_light_onSecondaryContainer,
    tertiary = md_theme_light_tertiary,
    onTertiary = md_theme_light_onTertiary,
    tertiaryContainer = md_theme_light_tertiaryContainer,
    onTertiaryContainer = md_theme_light_onTertiaryContainer,
    error = md_theme_light_error,
    errorContainer = md_theme_light_errorContainer,
    onError = md_theme_light_onError,
    onErrorContainer = md_theme_light_onErrorContainer,
    background = md_theme_light_background,
    onBackground = md_theme_light_onBackground,
    surface = md_theme_light_surface,
    onSurface = md_theme_light_onSurface,
    surfaceVariant = md_theme_light_surfaceVariant,
    onSurfaceVariant = md_theme_light_onSurfaceVariant,
    outline = md_theme_light_outline,
    inverseOnSurface = md_theme_light_inverseOnSurface,
    inverseSurface = md_theme_light_inverseSurface,
    inversePrimary = md_theme_light_inversePrimary,
    surfaceTint = md_theme_light_surfaceTint,
    outlineVariant = md_theme_light_outlineVariant,
    scrim = md_theme_light_scrim,
)

val DarkLimeTheme = darkColorScheme(
    primary = md_theme_dark_primary,
    onPrimary = md_theme_dark_onPrimary,
    primaryContainer = md_theme_dark_primaryContainer,
    onPrimaryContainer = md_theme_dark_onPrimaryContainer,
    secondary = md_theme_dark_secondary,
    onSecondary = md_theme_dark_onSecondary,
    secondaryContainer = md_theme_dark_secondaryContainer,
    onSecondaryContainer = md_theme_dark_onSecondaryContainer,
    tertiary = md_theme_dark_tertiary,
    onTertiary = md_theme_dark_onTertiary,
    tertiaryContainer = md_theme_dark_tertiaryContainer,
    onTertiaryContainer = md_theme_dark_onTertiaryContainer,
    error = md_theme_dark_error,
    errorContainer = md_theme_dark_errorContainer,
    onError = md_theme_dark_onError,
    onErrorContainer = md_theme_dark_onErrorContainer,
    background = md_theme_dark_background,
    onBackground = md_theme_dark_onBackground,
    surface = md_theme_dark_surface,
    onSurface = md_theme_dark_onSurface,
    surfaceVariant = md_theme_dark_surfaceVariant,
    onSurfaceVariant = md_theme_dark_onSurfaceVariant,
    outline = md_theme_dark_outline,
    inverseOnSurface = md_theme_dark_inverseOnSurface,
    inverseSurface = md_theme_dark_inverseSurface,
    inversePrimary = md_theme_dark_inversePrimary,
    surfaceTint = md_theme_dark_surfaceTint,
    outlineVariant = md_theme_dark_outlineVariant,
    scrim = md_theme_dark_scrim,
)
```

`app/src/main/java/me/bmax/apatch/ui/theme/OrangeTheme.kt`:

```kt
package me.bmax.apatch.ui.theme

import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.ui.graphics.Color

private val md_theme_light_primary = Color(0xFF8B5000)
private val md_theme_light_onPrimary = Color(0xFFFFFFFF)
private val md_theme_light_primaryContainer = Color(0xFFFFDCBE)
private val md_theme_light_onPrimaryContainer = Color(0xFF2C1600)
private val md_theme_light_secondary = Color(0xFF725A42)
private val md_theme_light_onSecondary = Color(0xFFFFFFFF)
private val md_theme_light_secondaryContainer = Color(0xFFFFDCBE)
private val md_theme_light_onSecondaryContainer = Color(0xFF291806)
private val md_theme_light_tertiary = Color(0xFF58633A)
private val md_theme_light_onTertiary = Color(0xFFFFFFFF)
private val md_theme_light_tertiaryContainer = Color(0xFFDCE8B4)
private val md_theme_light_onTertiaryContainer = Color(0xFF161E01)
private val md_theme_light_error = Color(0xFFBA1A1A)
private val md_theme_light_errorContainer = Color(0xFFFFDAD6)
private val md_theme_light_onError = Color(0xFFFFFFFF)
private val md_theme_light_onErrorContainer = Color(0xFF410002)
private val md_theme_light_background = Color(0xFFFFFBFF)
private val md_theme_light_onBackground = Color(0xFF201B16)
private val md_theme_light_surface = Color(0xFFFFFBFF)
private val md_theme_light_onSurface = Color(0xFF201B16)
private val md_theme_light_surfaceVariant = Color(0xFFF2DFD1)
private val md_theme_light_onSurfaceVariant = Color(0xFF51453A)
private val md_theme_light_outline = Color(0xFF837468)
private val md_theme_light_inverseOnSurface = Color(0xFFFAEFE7)
private val md_theme_light_inverseSurface = Color(0xFF352F2B)
private val md_theme_light_inversePrimary = Color(0xFFFFB870)
private val md_theme_light_shadow = Color(0xFF000000)
private val md_theme_light_surfaceTint = Color(0xFF8B5000)
private val md_theme_light_outlineVariant = Color(0xFFD5C3B5)
private val md_theme_light_scrim = Color(0xFF000000)

private val md_theme_dark_primary = Color(0xFFFFB870)
private val md_theme_dark_onPrimary = Color(0xFF4A2800)
private val md_theme_dark_primaryContainer = Color(0xFF693C00)
private val md_theme_dark_onPrimaryContainer = Color(0xFFFFDCBE)
private val md_theme_dark_secondary = Color(0xFFE1C1A4)
private val md_theme_dark_onSecondary = Color(0xFF402C18)
private val md_theme_dark_secondaryContainer = Color(0xFF59422C)
private val md_theme_dark_onSecondaryContainer = Color(0xFFFFDCBE)
private val md_theme_dark_tertiary = Color(0xFFC0CC9A)
private val md_theme_dark_onTertiary = Color(0xFF2B3410)
private val md_theme_dark_tertiaryContainer = Color(0xFF414B24)
private val md_theme_dark_onTertiaryContainer = Color(0xFFDCE8B4)
private val md_theme_dark_error = Color(0xFFFFB4AB)
private val md_theme_dark_errorContainer = Color(0xFF93000A)
private val md_theme_dark_onError = Color(0xFF690005)
private val md_theme_dark_onErrorContainer = Color(0xFFFFDAD6)
private val md_theme_dark_background = Color(0xFF201B16)
private val md_theme_dark_onBackground = Color(0xFFEBE0D9)
private val md_theme_dark_surface = Color(0xFF201B16)
private val md_theme_dark_onSurface = Color(0xFFEBE0D9)
private val md_theme_dark_surfaceVariant = Color(0xFF51453A)
private val md_theme_dark_onSurfaceVariant = Color(0xFFD5C3B5)
private val md_theme_dark_outline = Color(0xFF9D8E81)
private val md_theme_dark_inverseOnSurface = Color(0xFF201B16)
private val md_theme_dark_inverseSurface = Color(0xFFEBE0D9)
private val md_theme_dark_inversePrimary = Color(0xFF8B5000)
private val md_theme_dark_shadow = Color(0xFF000000)
private val md_theme_dark_surfaceTint = Color(0xFFFFB870)
private val md_theme_dark_outlineVariant = Color(0xFF51453A)
private val md_theme_dark_scrim = Color(0xFF000000)

val LightOrangeTheme = lightColorScheme(
    primary = md_theme_light_primary,
    onPrimary = md_theme_light_onPrimary,
    primaryContainer = md_theme_light_primaryContainer,
    onPrimaryContainer = md_theme_light_onPrimaryContainer,
    secondary = md_theme_light_secondary,
    onSecondary = md_theme_light_onSecondary,
    secondaryContainer = md_theme_light_secondaryContainer,
    onSecondaryContainer = md_theme_light_onSecondaryContainer,
    tertiary = md_theme_light_tertiary,
    onTertiary = md_theme_light_onTertiary,
    tertiaryContainer = md_theme_light_tertiaryContainer,
    onTertiaryContainer = md_theme_light_onTertiaryContainer,
    error = md_theme_light_error,
    errorContainer = md_theme_light_errorContainer,
    onError = md_theme_light_onError,
    onErrorContainer = md_theme_light_onErrorContainer,
    background = md_theme_light_background,
    onBackground = md_theme_light_onBackground,
    surface = md_theme_light_surface,
    onSurface = md_theme_light_onSurface,
    surfaceVariant = md_theme_light_surfaceVariant,
    onSurfaceVariant = md_theme_light_onSurfaceVariant,
    outline = md_theme_light_outline,
    inverseOnSurface = md_theme_light_inverseOnSurface,
    inverseSurface = md_theme_light_inverseSurface,
    inversePrimary = md_theme_light_inversePrimary,
    surfaceTint = md_theme_light_surfaceTint,
    outlineVariant = md_theme_light_outlineVariant,
    scrim = md_theme_light_scrim,
)

val DarkOrangeTheme = darkColorScheme(
    primary = md_theme_dark_primary,
    onPrimary = md_theme_dark_onPrimary,
    primaryContainer = md_theme_dark_primaryContainer,
    onPrimaryContainer = md_theme_dark_onPrimaryContainer,
    secondary = md_theme_dark_secondary,
    onSecondary = md_theme_dark_onSecondary,
    secondaryContainer = md_theme_dark_secondaryContainer,
    onSecondaryContainer = md_theme_dark_onSecondaryContainer,
    tertiary = md_theme_dark_tertiary,
    onTertiary = md_theme_dark_onTertiary,
    tertiaryContainer = md_theme_dark_tertiaryContainer,
    onTertiaryContainer = md_theme_dark_onTertiaryContainer,
    error = md_theme_dark_error,
    errorContainer = md_theme_dark_errorContainer,
    onError = md_theme_dark_onError,
    onErrorContainer = md_theme_dark_onErrorContainer,
    background = md_theme_dark_background,
    onBackground = md_theme_dark_onBackground,
    surface = md_theme_dark_surface,
    onSurface = md_theme_dark_onSurface,
    surfaceVariant = md_theme_dark_surfaceVariant,
    onSurfaceVariant = md_theme_dark_onSurfaceVariant,
    outline = md_theme_dark_outline,
    inverseOnSurface = md_theme_dark_inverseOnSurface,
    inverseSurface = md_theme_dark_inverseSurface,
    inversePrimary = md_theme_dark_inversePrimary,
    surfaceTint = md_theme_dark_surfaceTint,
    outlineVariant = md_theme_dark_outlineVariant,
    scrim = md_theme_dark_scrim,
)
```

`app/src/main/java/me/bmax/apatch/ui/theme/PinkTheme.kt`:

```kt
package me.bmax.apatch.ui.theme

import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.ui.graphics.Color

private val md_theme_light_primary = Color(0xFFBC004B)
private val md_theme_light_onPrimary = Color(0xFFFFFFFF)
private val md_theme_light_primaryContainer = Color(0xFFFFD9DE)
private val md_theme_light_onPrimaryContainer = Color(0xFF400014)
private val md_theme_light_secondary = Color(0xFF75565B)
private val md_theme_light_onSecondary = Color(0xFFFFFFFF)
private val md_theme_light_secondaryContainer = Color(0xFFFFD9DE)
private val md_theme_light_onSecondaryContainer = Color(0xFF2C1519)
private val md_theme_light_tertiary = Color(0xFF795831)
private val md_theme_light_onTertiary = Color(0xFFFFFFFF)
private val md_theme_light_tertiaryContainer = Color(0xFFFFDDBA)
private val md_theme_light_onTertiaryContainer = Color(0xFF2B1700)
private val md_theme_light_error = Color(0xFFBA1A1A)
private val md_theme_light_errorContainer = Color(0xFFFFDAD6)
private val md_theme_light_onError = Color(0xFFFFFFFF)
private val md_theme_light_onErrorContainer = Color(0xFF410002)
private val md_theme_light_background = Color(0xFFFFFBFF)
private val md_theme_light_onBackground = Color(0xFF201A1B)
private val md_theme_light_surface = Color(0xFFFFFBFF)
private val md_theme_light_onSurface = Color(0xFF201A1B)
private val md_theme_light_surfaceVariant = Color(0xFFF3DDDF)
private val md_theme_light_onSurfaceVariant = Color(0xFF524345)
private val md_theme_light_outline = Color(0xFF847375)
private val md_theme_light_inverseOnSurface = Color(0xFFFBEEEE)
private val md_theme_light_inverseSurface = Color(0xFF362F2F)
private val md_theme_light_inversePrimary = Color(0xFFFFB2BE)
private val md_theme_light_shadow = Color(0xFF000000)
private val md_theme_light_surfaceTint = Color(0xFFBC004B)
private val md_theme_light_outlineVariant = Color(0xFFD6C2C3)
private val md_theme_light_scrim = Color(0xFF000000)

private val md_theme_dark_primary = Color(0xFFFFB2BE)
private val md_theme_dark_onPrimary = Color(0xFF660025)
private val md_theme_dark_primaryContainer = Color(0xFF900038)
private val md_theme_dark_onPrimaryContainer = Color(0xFFFFD9DE)
private val md_theme_dark_secondary = Color(0xFFE5BDC2)
private val md_theme_dark_onSecondary = Color(0xFF43292D)
private val md_theme_dark_secondaryContainer = Color(0xFF5C3F43)
private val md_theme_dark_onSecondaryContainer = Color(0xFFFFD9DE)
private val md_theme_dark_tertiary = Color(0xFFEBBF90)
private val md_theme_dark_onTertiary = Color(0xFF452B08)
private val md_theme_dark_tertiaryContainer = Color(0xFF5F411C)
private val md_theme_dark_onTertiaryContainer = Color(0xFFFFDDBA)
private val md_theme_dark_error = Color(0xFFFFB4AB)
private val md_theme_dark_errorContainer = Color(0xFF93000A)
private val md_theme_dark_onError = Color(0xFF690005)
private val md_theme_dark_onErrorContainer = Color(0xFFFFDAD6)
private val md_theme_dark_background = Color(0xFF201A1B)
private val md_theme_dark_onBackground = Color(0xFFECE0E0)
private val md_theme_dark_surface = Color(0xFF201A1B)
private val md_theme_dark_onSurface = Color(0xFFECE0E0)
private val md_theme_dark_surfaceVariant = Color(0xFF524345)
private val md_theme_dark_onSurfaceVariant = Color(0xFFD6C2C3)
private val md_theme_dark_outline = Color(0xFF9F8C8E)
private val md_theme_dark_inverseOnSurface = Color(0xFF201A1B)
private val md_theme_dark_inverseSurface = Color(0xFFECE0E0)
private val md_theme_dark_inversePrimary = Color(0xFFBC004B)
private val md_theme_dark_shadow = Color(0xFF000000)
private val md_theme_dark_surfaceTint = Color(0xFFFFB2BE)
private val md_theme_dark_outlineVariant = Color(0xFF524345)
private val md_theme_dark_scrim = Color(0xFF000000)

val LightPinkTheme = lightColorScheme(
    primary = md_theme_light_primary,
    onPrimary = md_theme_light_onPrimary,
    primaryContainer = md_theme_light_primaryContainer,
    onPrimaryContainer = md_theme_light_onPrimaryContainer,
    secondary = md_theme_light_secondary,
    onSecondary = md_theme_light_onSecondary,
    secondaryContainer = md_theme_light_secondaryContainer,
    onSecondaryContainer = md_theme_light_onSecondaryContainer,
    tertiary = md_theme_light_tertiary,
    onTertiary = md_theme_light_onTertiary,
    tertiaryContainer = md_theme_light_tertiaryContainer,
    onTertiaryContainer = md_theme_light_onTertiaryContainer,
    error = md_theme_light_error,
    errorContainer = md_theme_light_errorContainer,
    onError = md_theme_light_onError,
    onErrorContainer = md_theme_light_onErrorContainer,
    background = md_theme_light_background,
    onBackground = md_theme_light_onBackground,
    surface = md_theme_light_surface,
    onSurface = md_theme_light_onSurface,
    surfaceVariant = md_theme_light_surfaceVariant,
    onSurfaceVariant = md_theme_light_onSurfaceVariant,
    outline = md_theme_light_outline,
    inverseOnSurface = md_theme_light_inverseOnSurface,
    inverseSurface = md_theme_light_inverseSurface,
    inversePrimary = md_theme_light_inversePrimary,
    surfaceTint = md_theme_light_surfaceTint,
    outlineVariant = md_theme_light_outlineVariant,
    scrim = md_theme_light_scrim,
)

val DarkPinkTheme = darkColorScheme(
    primary = md_theme_dark_primary,
    onPrimary = md_theme_dark_onPrimary,
    primaryContainer = md_theme_dark_primaryContainer,
    onPrimaryContainer = md_theme_dark_onPrimaryContainer,
    secondary = md_theme_dark_secondary,
    onSecondary = md_theme_dark_onSecondary,
    secondaryContainer = md_theme_dark_secondaryContainer,
    onSecondaryContainer = md_theme_dark_onSecondaryContainer,
    tertiary = md_theme_dark_tertiary,
    onTertiary = md_theme_dark_onTertiary,
    tertiaryContainer = md_theme_dark_tertiaryContainer,
    onTertiaryContainer = md_theme_dark_onTertiaryContainer,
    error = md_theme_dark_error,
    errorContainer = md_theme_dark_errorContainer,
    onError = md_theme_dark_onError,
    onErrorContainer = md_theme_dark_onErrorContainer,
    background = md_theme_dark_background,
    onBackground = md_theme_dark_onBackground,
    surface = md_theme_dark_surface,
    onSurface = md_theme_dark_onSurface,
    surfaceVariant = md_theme_dark_surfaceVariant,
    onSurfaceVariant = md_theme_dark_onSurfaceVariant,
    outline = md_theme_dark_outline,
    inverseOnSurface = md_theme_dark_inverseOnSurface,
    inverseSurface = md_theme_dark_inverseSurface,
    inversePrimary = md_theme_dark_inversePrimary,
    surfaceTint = md_theme_dark_surfaceTint,
    outlineVariant = md_theme_dark_outlineVariant,
    scrim = md_theme_dark_scrim,
)
```

`app/src/main/java/me/bmax/apatch/ui/theme/PurpleTheme.kt`:

```kt
package me.bmax.apatch.ui.theme

import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.ui.graphics.Color

private val md_theme_light_primary = Color(0xFF9A25AE)
private val md_theme_light_onPrimary = Color(0xFFFFFFFF)
private val md_theme_light_primaryContainer = Color(0xFFFFD6FE)
private val md_theme_light_onPrimaryContainer = Color(0xFF35003F)
private val md_theme_light_secondary = Color(0xFF6B586B)
private val md_theme_light_onSecondary = Color(0xFFFFFFFF)
private val md_theme_light_secondaryContainer = Color(0xFFF4DBF1)
private val md_theme_light_onSecondaryContainer = Color(0xFF251626)
private val md_theme_light_tertiary = Color(0xFF82524A)
private val md_theme_light_onTertiary = Color(0xFFFFFFFF)
private val md_theme_light_tertiaryContainer = Color(0xFFFFDAD4)
private val md_theme_light_onTertiaryContainer = Color(0xFF33110C)
private val md_theme_light_error = Color(0xFFBA1A1A)
private val md_theme_light_errorContainer = Color(0xFFFFDAD6)
private val md_theme_light_onError = Color(0xFFFFFFFF)
private val md_theme_light_onErrorContainer = Color(0xFF410002)
private val md_theme_light_background = Color(0xFFFFFBFF)
private val md_theme_light_onBackground = Color(0xFF1E1A1D)
private val md_theme_light_surface = Color(0xFFFFFBFF)
private val md_theme_light_onSurface = Color(0xFF1E1A1D)
private val md_theme_light_surfaceVariant = Color(0xFFECDFE8)
private val md_theme_light_onSurfaceVariant = Color(0xFF4D444C)
private val md_theme_light_outline = Color(0xFF7F747D)
private val md_theme_light_inverseOnSurface = Color(0xFFF7EEF3)
private val md_theme_light_inverseSurface = Color(0xFF332F32)
private val md_theme_light_inversePrimary = Color(0xFFF9ABFF)
private val md_theme_light_shadow = Color(0xFF000000)
private val md_theme_light_surfaceTint = Color(0xFF9A25AE)
private val md_theme_light_outlineVariant = Color(0xFFD0C3CC)
private val md_theme_light_scrim = Color(0xFF000000)

private val md_theme_dark_primary = Color(0xFFF9ABFF)
private val md_theme_dark_onPrimary = Color(0xFF570066)
private val md_theme_dark_primaryContainer = Color(0xFF7B008F)
private val md_theme_dark_onPrimaryContainer = Color(0xFFFFD6FE)
private val md_theme_dark_secondary = Color(0xFFD7BFD5)
private val md_theme_dark_onSecondary = Color(0xFF3B2B3C)
private val md_theme_dark_secondaryContainer = Color(0xFF534153)
private val md_theme_dark_onSecondaryContainer = Color(0xFFF4DBF1)
private val md_theme_dark_tertiary = Color(0xFFF6B8AD)
private val md_theme_dark_onTertiary = Color(0xFF4C251F)
private val md_theme_dark_tertiaryContainer = Color(0xFF673B34)
private val md_theme_dark_onTertiaryContainer = Color(0xFFFFDAD4)
private val md_theme_dark_error = Color(0xFFFFB4AB)
private val md_theme_dark_errorContainer = Color(0xFF93000A)
private val md_theme_dark_onError = Color(0xFF690005)
private val md_theme_dark_onErrorContainer = Color(0xFFFFDAD6)
private val md_theme_dark_background = Color(0xFF1E1A1D)
private val md_theme_dark_onBackground = Color(0xFFE9E0E4)
private val md_theme_dark_surface = Color(0xFF1E1A1D)
private val md_theme_dark_onSurface = Color(0xFFE9E0E4)
private val md_theme_dark_surfaceVariant = Color(0xFF4D444C)
private val md_theme_dark_onSurfaceVariant = Color(0xFFD0C3CC)
private val md_theme_dark_outline = Color(0xFF998D96)
private val md_theme_dark_inverseOnSurface = Color(0xFF1E1A1D)
private val md_theme_dark_inverseSurface = Color(0xFFE9E0E4)
private val md_theme_dark_inversePrimary = Color(0xFF9A25AE)
private val md_theme_dark_shadow = Color(0xFF000000)
private val md_theme_dark_surfaceTint = Color(0xFFF9ABFF)
private val md_theme_dark_outlineVariant = Color(0xFF4D444C)
private val md_theme_dark_scrim = Color(0xFF000000)

val LightPurpleTheme = lightColorScheme(
    primary = md_theme_light_primary,
    onPrimary = md_theme_light_onPrimary,
    primaryContainer = md_theme_light_primaryContainer,
    onPrimaryContainer = md_theme_light_onPrimaryContainer,
    secondary = md_theme_light_secondary,
    onSecondary = md_theme_light_onSecondary,
    secondaryContainer = md_theme_light_secondaryContainer,
    onSecondaryContainer = md_theme_light_onSecondaryContainer,
    tertiary = md_theme_light_tertiary,
    onTertiary = md_theme_light_onTertiary,
    tertiaryContainer = md_theme_light_tertiaryContainer,
    onTertiaryContainer = md_theme_light_onTertiaryContainer,
    error = md_theme_light_error,
    errorContainer = md_theme_light_errorContainer,
    onError = md_theme_light_onError,
    onErrorContainer = md_theme_light_onErrorContainer,
    background = md_theme_light_background,
    onBackground = md_theme_light_onBackground,
    surface = md_theme_light_surface,
    onSurface = md_theme_light_onSurface,
    surfaceVariant = md_theme_light_surfaceVariant,
    onSurfaceVariant = md_theme_light_onSurfaceVariant,
    outline = md_theme_light_outline,
    inverseOnSurface = md_theme_light_inverseOnSurface,
    inverseSurface = md_theme_light_inverseSurface,
    inversePrimary = md_theme_light_inversePrimary,
    surfaceTint = md_theme_light_surfaceTint,
    outlineVariant = md_theme_light_outlineVariant,
    scrim = md_theme_light_scrim,
)

val DarkPurpleTheme = darkColorScheme(
    primary = md_theme_dark_primary,
    onPrimary = md_theme_dark_onPrimary,
    primaryContainer = md_theme_dark_primaryContainer,
    onPrimaryContainer = md_theme_dark_onPrimaryContainer,
    secondary = md_theme_dark_secondary,
    onSecondary = md_theme_dark_onSecondary,
    secondaryContainer = md_theme_dark_secondaryContainer,
    onSecondaryContainer = md_theme_dark_onSecondaryContainer,
    tertiary = md_theme_dark_tertiary,
    onTertiary = md_theme_dark_onTertiary,
    tertiaryContainer = md_theme_dark_tertiaryContainer,
    onTertiaryContainer = md_theme_dark_onTertiaryContainer,
    error = md_theme_dark_error,
    errorContainer = md_theme_dark_errorContainer,
    onError = md_theme_dark_onError,
    onErrorContainer = md_theme_dark_onErrorContainer,
    background = md_theme_dark_background,
    onBackground = md_theme_dark_onBackground,
    surface = md_theme_dark_surface,
    onSurface = md_theme_dark_onSurface,
    surfaceVariant = md_theme_dark_surfaceVariant,
    onSurfaceVariant = md_theme_dark_onSurfaceVariant,
    outline = md_theme_dark_outline,
    inverseOnSurface = md_theme_dark_inverseOnSurface,
    inverseSurface = md_theme_dark_inverseSurface,
    inversePrimary = md_theme_dark_inversePrimary,
    surfaceTint = md_theme_dark_surfaceTint,
    outlineVariant = md_theme_dark_outlineVariant,
    scrim = md_theme_dark_scrim,
)
```

`app/src/main/java/me/bmax/apatch/ui/theme/RedTheme.kt`:

```kt
package me.bmax.apatch.ui.theme

import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.ui.graphics.Color

private val md_theme_light_primary = Color(0xFFBB1614)
private val md_theme_light_onPrimary = Color(0xFFFFFFFF)
private val md_theme_light_primaryContainer = Color(0xFFFFDAD5)
private val md_theme_light_onPrimaryContainer = Color(0xFF410001)
private val md_theme_light_secondary = Color(0xFF775652)
private val md_theme_light_onSecondary = Color(0xFFFFFFFF)
private val md_theme_light_secondaryContainer = Color(0xFFFFDAD5)
private val md_theme_light_onSecondaryContainer = Color(0xFF2C1512)
private val md_theme_light_tertiary = Color(0xFF705C2E)
private val md_theme_light_onTertiary = Color(0xFFFFFFFF)
private val md_theme_light_tertiaryContainer = Color(0xFFFCDFA6)
private val md_theme_light_onTertiaryContainer = Color(0xFF261A00)
private val md_theme_light_error = Color(0xFFBA1A1A)
private val md_theme_light_errorContainer = Color(0xFFFFDAD6)
private val md_theme_light_onError = Color(0xFFFFFFFF)
private val md_theme_light_onErrorContainer = Color(0xFF410002)
private val md_theme_light_background = Color(0xFFFFFBFF)
private val md_theme_light_onBackground = Color(0xFF201A19)
private val md_theme_light_surface = Color(0xFFFFFBFF)
private val md_theme_light_onSurface = Color(0xFF201A19)
private val md_theme_light_surfaceVariant = Color(0xFFF5DDDA)
private val md_theme_light_onSurfaceVariant = Color(0xFF534341)
private val md_theme_light_outline = Color(0xFF857370)
private val md_theme_light_inverseOnSurface = Color(0xFFFBEEEC)
private val md_theme_light_inverseSurface = Color(0xFF362F2E)
private val md_theme_light_inversePrimary = Color(0xFFFFB4A9)
private val md_theme_light_shadow = Color(0xFF000000)
private val md_theme_light_surfaceTint = Color(0xFFBB1614)
private val md_theme_light_outlineVariant = Color(0xFFD8C2BE)
private val md_theme_light_scrim = Color(0xFF000000)

private val md_theme_dark_primary = Color(0xFFFFB4A9)
private val md_theme_dark_onPrimary = Color(0xFF690002)
private val md_theme_dark_primaryContainer = Color(0xFF930005)
private val md_theme_dark_onPrimaryContainer = Color(0xFFFFDAD5)
private val md_theme_dark_secondary = Color(0xFFE7BDB7)
private val md_theme_dark_onSecondary = Color(0xFF442926)
private val md_theme_dark_secondaryContainer = Color(0xFF5D3F3B)
private val md_theme_dark_onSecondaryContainer = Color(0xFFFFDAD5)
private val md_theme_dark_tertiary = Color(0xFFDFC38C)
private val md_theme_dark_onTertiary = Color(0xFF3E2E04)
private val md_theme_dark_tertiaryContainer = Color(0xFF574419)
private val md_theme_dark_onTertiaryContainer = Color(0xFFFCDFA6)
private val md_theme_dark_error = Color(0xFFFFB4AB)
private val md_theme_dark_errorContainer = Color(0xFF93000A)
private val md_theme_dark_onError = Color(0xFF690005)
private val md_theme_dark_onErrorContainer = Color(0xFFFFDAD6)
private val md_theme_dark_background = Color(0xFF201A19)
private val md_theme_dark_onBackground = Color(0xFFEDE0DE)
private val md_theme_dark_surface = Color(0xFF201A19)
private val md_theme_dark_onSurface = Color(0xFFEDE0DE)
private val md_theme_dark_surfaceVariant = Color(0xFF534341)
private val md_theme_dark_onSurfaceVariant = Color(0xFFD8C2BE)
private val md_theme_dark_outline = Color(0xFFA08C89)
private val md_theme_dark_inverseOnSurface = Color(0xFF201A19)
private val md_theme_dark_inverseSurface = Color(0xFFEDE0DE)
private val md_theme_dark_inversePrimary = Color(0xFFBB1614)
private val md_theme_dark_shadow = Color(0xFF000000)
private val md_theme_dark_surfaceTint = Color(0xFFFFB4A9)
private val md_theme_dark_outlineVariant = Color(0xFF534341)
private val md_theme_dark_scrim = Color(0xFF000000)

val LightRedTheme = lightColorScheme(
    primary = md_theme_light_primary,
    onPrimary = md_theme_light_onPrimary,
    primaryContainer = md_theme_light_primaryContainer,
    onPrimaryContainer = md_theme_light_onPrimaryContainer,
    secondary = md_theme_light_secondary,
    onSecondary = md_theme_light_onSecondary,
    secondaryContainer = md_theme_light_secondaryContainer,
    onSecondaryContainer = md_theme_light_onSecondaryContainer,
    tertiary = md_theme_light_tertiary,
    onTertiary = md_theme_light_onTertiary,
    tertiaryContainer = md_theme_light_tertiaryContainer,
    onTertiaryContainer = md_theme_light_onTertiaryContainer,
    error = md_theme_light_error,
    errorContainer = md_theme_light_errorContainer,
    onError = md_theme_light_onError,
    onErrorContainer = md_theme_light_onErrorContainer,
    background = md_theme_light_background,
    onBackground = md_theme_light_onBackground,
    surface = md_theme_light_surface,
    onSurface = md_theme_light_onSurface,
    surfaceVariant = md_theme_light_surfaceVariant,
    onSurfaceVariant = md_theme_light_onSurfaceVariant,
    outline = md_theme_light_outline,
    inverseOnSurface = md_theme_light_inverseOnSurface,
    inverseSurface = md_theme_light_inverseSurface,
    inversePrimary = md_theme_light_inversePrimary,
    surfaceTint = md_theme_light_surfaceTint,
    outlineVariant = md_theme_light_outlineVariant,
    scrim = md_theme_light_scrim,
)

val DarkRedTheme = darkColorScheme(
    primary = md_theme_dark_primary,
    onPrimary = md_theme_dark_onPrimary,
    primaryContainer = md_theme_dark_primaryContainer,
    onPrimaryContainer = md_theme_dark_onPrimaryContainer,
    secondary = md_theme_dark_secondary,
    onSecondary = md_theme_dark_onSecondary,
    secondaryContainer = md_theme_dark_secondaryContainer,
    onSecondaryContainer = md_theme_dark_onSecondaryContainer,
    tertiary = md_theme_dark_tertiary,
    onTertiary = md_theme_dark_onTertiary,
    tertiaryContainer = md_theme_dark_tertiaryContainer,
    onTertiaryContainer = md_theme_dark_onTertiaryContainer,
    error = md_theme_dark_error,
    errorContainer = md_theme_dark_errorContainer,
    onError = md_theme_dark_onError,
    onErrorContainer = md_theme_dark_onErrorContainer,
    background = md_theme_dark_background,
    onBackground = md_theme_dark_onBackground,
    surface = md_theme_dark_surface,
    onSurface = md_theme_dark_onSurface,
    surfaceVariant = md_theme_dark_surfaceVariant,
    onSurfaceVariant = md_theme_dark_onSurfaceVariant,
    outline = md_theme_dark_outline,
    inverseOnSurface = md_theme_dark_inverseOnSurface,
    inverseSurface = md_theme_dark_inverseSurface,
    inversePrimary = md_theme_dark_inversePrimary,
    surfaceTint = md_theme_dark_surfaceTint,
    outlineVariant = md_theme_dark_outlineVariant,
    scrim = md_theme_dark_scrim,
)
```

`app/src/main/java/me/bmax/apatch/ui/theme/SakuraTheme.kt`:

```kt
package me.bmax.apatch.ui.theme

import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.ui.graphics.Color

private val md_theme_light_primary = Color(0xFF9B404F)
private val md_theme_light_onPrimary = Color(0xFFFFFFFF)
private val md_theme_light_primaryContainer = Color(0xFFFFD9DC)
private val md_theme_light_onPrimaryContainer = Color(0xFF400011)
private val md_theme_light_secondary = Color(0xFF765659)
private val md_theme_light_onSecondary = Color(0xFFFFFFFF)
private val md_theme_light_secondaryContainer = Color(0xFFFFD9DC)
private val md_theme_light_onSecondaryContainer = Color(0xFF2C1518)
private val md_theme_light_tertiary = Color(0xFF785830)
private val md_theme_light_onTertiary = Color(0xFFFFFFFF)
private val md_theme_light_tertiaryContainer = Color(0xFFFFDDB7)
private val md_theme_light_onTertiaryContainer = Color(0xFF2A1700)
private val md_theme_light_error = Color(0xFFBA1A1A)
private val md_theme_light_errorContainer = Color(0xFFFFDAD6)
private val md_theme_light_onError = Color(0xFFFFFFFF)
private val md_theme_light_onErrorContainer = Color(0xFF410002)
private val md_theme_light_background = Color(0xFFFFFBFF)
private val md_theme_light_onBackground = Color(0xFF201A1A)
private val md_theme_light_surface = Color(0xFFFFFBFF)
private val md_theme_light_onSurface = Color(0xFF201A1A)
private val md_theme_light_surfaceVariant = Color(0xFFF4DDDE)
private val md_theme_light_onSurfaceVariant = Color(0xFF524344)
private val md_theme_light_outline = Color(0xFF847374)
private val md_theme_light_inverseOnSurface = Color(0xFFFBEEEE)
private val md_theme_light_inverseSurface = Color(0xFF362F2F)
private val md_theme_light_inversePrimary = Color(0xFFFFB2BA)
private val md_theme_light_shadow = Color(0xFF000000)
private val md_theme_light_surfaceTint = Color(0xFF9B404F)
private val md_theme_light_outlineVariant = Color(0xFFD7C1C3)
private val md_theme_light_scrim = Color(0xFF000000)

private val md_theme_dark_primary = Color(0xFFFFB2BA)
private val md_theme_dark_onPrimary = Color(0xFF5F1223)
private val md_theme_dark_primaryContainer = Color(0xFF7D2939)
private val md_theme_dark_onPrimaryContainer = Color(0xFFFFD9DC)
private val md_theme_dark_secondary = Color(0xFFE5BDC0)
private val md_theme_dark_onSecondary = Color(0xFF43292C)
private val md_theme_dark_secondaryContainer = Color(0xFF5C3F42)
private val md_theme_dark_onSecondaryContainer = Color(0xFFFFD9DC)
private val md_theme_dark_tertiary = Color(0xFFE9BF8F)
private val md_theme_dark_onTertiary = Color(0xFF442B07)
private val md_theme_dark_tertiaryContainer = Color(0xFF5E411B)
private val md_theme_dark_onTertiaryContainer = Color(0xFFFFDDB7)
private val md_theme_dark_error = Color(0xFFFFB4AB)
private val md_theme_dark_errorContainer = Color(0xFF93000A)
private val md_theme_dark_onError = Color(0xFF690005)
private val md_theme_dark_onErrorContainer = Color(0xFFFFDAD6)
private val md_theme_dark_background = Color(0xFF201A1A)
private val md_theme_dark_onBackground = Color(0xFFECE0E0)
private val md_theme_dark_surface = Color(0xFF201A1A)
private val md_theme_dark_onSurface = Color(0xFFECE0E0)
private val md_theme_dark_surfaceVariant = Color(0xFF524344)
private val md_theme_dark_onSurfaceVariant = Color(0xFFD7C1C3)
private val md_theme_dark_outline = Color(0xFF9F8C8D)
private val md_theme_dark_inverseOnSurface = Color(0xFF201A1A)
private val md_theme_dark_inverseSurface = Color(0xFFECE0E0)
private val md_theme_dark_inversePrimary = Color(0xFF9B404F)
private val md_theme_dark_shadow = Color(0xFF000000)
private val md_theme_dark_surfaceTint = Color(0xFFFFB2BA)
private val md_theme_dark_outlineVariant = Color(0xFF524344)
private val md_theme_dark_scrim = Color(0xFF000000)

val LightSakuraTheme = lightColorScheme(
    primary = md_theme_light_primary,
    onPrimary = md_theme_light_onPrimary,
    primaryContainer = md_theme_light_primaryContainer,
    onPrimaryContainer = md_theme_light_onPrimaryContainer,
    secondary = md_theme_light_secondary,
    onSecondary = md_theme_light_onSecondary,
    secondaryContainer = md_theme_light_secondaryContainer,
    onSecondaryContainer = md_theme_light_onSecondaryContainer,
    tertiary = md_theme_light_tertiary,
    onTertiary = md_theme_light_onTertiary,
    tertiaryContainer = md_theme_light_tertiaryContainer,
    onTertiaryContainer = md_theme_light_onTertiaryContainer,
    error = md_theme_light_error,
    errorContainer = md_theme_light_errorContainer,
    onError = md_theme_light_onError,
    onErrorContainer = md_theme_light_onErrorContainer,
    background = md_theme_light_background,
    onBackground = md_theme_light_onBackground,
    surface = md_theme_light_surface,
    onSurface = md_theme_light_onSurface,
    surfaceVariant = md_theme_light_surfaceVariant,
    onSurfaceVariant = md_theme_light_onSurfaceVariant,
    outline = md_theme_light_outline,
    inverseOnSurface = md_theme_light_inverseOnSurface,
    inverseSurface = md_theme_light_inverseSurface,
    inversePrimary = md_theme_light_inversePrimary,
    surfaceTint = md_theme_light_surfaceTint,
    outlineVariant = md_theme_light_outlineVariant,
    scrim = md_theme_light_scrim,
)

val DarkSakuraTheme = darkColorScheme(
    primary = md_theme_dark_primary,
    onPrimary = md_theme_dark_onPrimary,
    primaryContainer = md_theme_dark_primaryContainer,
    onPrimaryContainer = md_theme_dark_onPrimaryContainer,
    secondary = md_theme_dark_secondary,
    onSecondary = md_theme_dark_onSecondary,
    secondaryContainer = md_theme_dark_secondaryContainer,
    onSecondaryContainer = md_theme_dark_onSecondaryContainer,
    tertiary = md_theme_dark_tertiary,
    onTertiary = md_theme_dark_onTertiary,
    tertiaryContainer = md_theme_dark_tertiaryContainer,
    onTertiaryContainer = md_theme_dark_onTertiaryContainer,
    error = md_theme_dark_error,
    errorContainer = md_theme_dark_errorContainer,
    onError = md_theme_dark_onError,
    onErrorContainer = md_theme_dark_onErrorContainer,
    background = md_theme_dark_background,
    onBackground = md_theme_dark_onBackground,
    surface = md_theme_dark_surface,
    onSurface = md_theme_dark_onSurface,
    surfaceVariant = md_theme_dark_surfaceVariant,
    onSurfaceVariant = md_theme_dark_onSurfaceVariant,
    outline = md_theme_dark_outline,
    inverseOnSurface = md_theme_dark_inverseOnSurface,
    inverseSurface = md_theme_dark_inverseSurface,
    inversePrimary = md_theme_dark_inversePrimary,
    surfaceTint = md_theme_dark_surfaceTint,
    outlineVariant = md_theme_dark_outlineVariant,
    scrim = md_theme_dark_scrim,
)
```

`app/src/main/java/me/bmax/apatch/ui/theme/TealTheme.kt`:

```kt
package me.bmax.apatch.ui.theme

import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.ui.graphics.Color

private val md_theme_light_primary = Color(0xFF006A60)
private val md_theme_light_onPrimary = Color(0xFFFFFFFF)
private val md_theme_light_primaryContainer = Color(0xFF74F8E5)
private val md_theme_light_onPrimaryContainer = Color(0xFF00201C)
private val md_theme_light_secondary = Color(0xFF4A635F)
private val md_theme_light_onSecondary = Color(0xFFFFFFFF)
private val md_theme_light_secondaryContainer = Color(0xFFCCE8E2)
private val md_theme_light_onSecondaryContainer = Color(0xFF05201C)
private val md_theme_light_tertiary = Color(0xFF456179)
private val md_theme_light_onTertiary = Color(0xFFFFFFFF)
private val md_theme_light_tertiaryContainer = Color(0xFFCCE5FF)
private val md_theme_light_onTertiaryContainer = Color(0xFF001E31)
private val md_theme_light_error = Color(0xFFBA1A1A)
private val md_theme_light_errorContainer = Color(0xFFFFDAD6)
private val md_theme_light_onError = Color(0xFFFFFFFF)
private val md_theme_light_onErrorContainer = Color(0xFF410002)
private val md_theme_light_background = Color(0xFFFAFDFB)
private val md_theme_light_onBackground = Color(0xFF191C1B)
private val md_theme_light_surface = Color(0xFFFAFDFB)
private val md_theme_light_onSurface = Color(0xFF191C1B)
private val md_theme_light_surfaceVariant = Color(0xFFDAE5E1)
private val md_theme_light_onSurfaceVariant = Color(0xFF3F4947)
private val md_theme_light_outline = Color(0xFF6F7977)
private val md_theme_light_inverseOnSurface = Color(0xFFEFF1EF)
private val md_theme_light_inverseSurface = Color(0xFF2D3130)
private val md_theme_light_inversePrimary = Color(0xFF53DBC9)
private val md_theme_light_shadow = Color(0xFF000000)
private val md_theme_light_surfaceTint = Color(0xFF006A60)
private val md_theme_light_outlineVariant = Color(0xFFBEC9C6)
private val md_theme_light_scrim = Color(0xFF000000)

private val md_theme_dark_primary = Color(0xFF53DBC9)
private val md_theme_dark_onPrimary = Color(0xFF003731)
private val md_theme_dark_primaryContainer = Color(0xFF005048)
private val md_theme_dark_onPrimaryContainer = Color(0xFF74F8E5)
private val md_theme_dark_secondary = Color(0xFFB1CCC6)
private val md_theme_dark_onSecondary = Color(0xFF1C3531)
private val md_theme_dark_secondaryContainer = Color(0xFF334B47)
private val md_theme_dark_onSecondaryContainer = Color(0xFFCCE8E2)
private val md_theme_dark_tertiary = Color(0xFFADCAE6)
private val md_theme_dark_onTertiary = Color(0xFF153349)
private val md_theme_dark_tertiaryContainer = Color(0xFF2D4961)
private val md_theme_dark_onTertiaryContainer = Color(0xFFCCE5FF)
private val md_theme_dark_error = Color(0xFFFFB4AB)
private val md_theme_dark_errorContainer = Color(0xFF93000A)
private val md_theme_dark_onError = Color(0xFF690005)
private val md_theme_dark_onErrorContainer = Color(0xFFFFDAD6)
private val md_theme_dark_background = Color(0xFF191C1B)
private val md_theme_dark_onBackground = Color(0xFFE0E3E1)
private val md_theme_dark_surface = Color(0xFF191C1B)
private val md_theme_dark_onSurface = Color(0xFFE0E3E1)
private val md_theme_dark_surfaceVariant = Color(0xFF3F4947)
private val md_theme_dark_onSurfaceVariant = Color(0xFFBEC9C6)
private val md_theme_dark_outline = Color(0xFF899390)
private val md_theme_dark_inverseOnSurface = Color(0xFF191C1B)
private val md_theme_dark_inverseSurface = Color(0xFFE0E3E1)
private val md_theme_dark_inversePrimary = Color(0xFF006A60)
private val md_theme_dark_shadow = Color(0xFF000000)
private val md_theme_dark_surfaceTint = Color(0xFF53DBC9)
private val md_theme_dark_outlineVariant = Color(0xFF3F4947)
private val md_theme_dark_scrim = Color(0xFF000000)


val LightTealTheme = lightColorScheme(
    primary = md_theme_light_primary,
    onPrimary = md_theme_light_onPrimary,
    primaryContainer = md_theme_light_primaryContainer,
    onPrimaryContainer = md_theme_light_onPrimaryContainer,
    secondary = md_theme_light_secondary,
    onSecondary = md_theme_light_onSecondary,
    secondaryContainer = md_theme_light_secondaryContainer,
    onSecondaryContainer = md_theme_light_onSecondaryContainer,
    tertiary = md_theme_light_tertiary,
    onTertiary = md_theme_light_onTertiary,
    tertiaryContainer = md_theme_light_tertiaryContainer,
    onTertiaryContainer = md_theme_light_onTertiaryContainer,
    error = md_theme_light_error,
    errorContainer = md_theme_light_errorContainer,
    onError = md_theme_light_onError,
    onErrorContainer = md_theme_light_onErrorContainer,
    background = md_theme_light_background,
    onBackground = md_theme_light_onBackground,
    surface = md_theme_light_surface,
    onSurface = md_theme_light_onSurface,
    surfaceVariant = md_theme_light_surfaceVariant,
    onSurfaceVariant = md_theme_light_onSurfaceVariant,
    outline = md_theme_light_outline,
    inverseOnSurface = md_theme_light_inverseOnSurface,
    inverseSurface = md_theme_light_inverseSurface,
    inversePrimary = md_theme_light_inversePrimary,
    surfaceTint = md_theme_light_surfaceTint,
    outlineVariant = md_theme_light_outlineVariant,
    scrim = md_theme_light_scrim,
)

val DarkTealTheme = darkColorScheme(
    primary = md_theme_dark_primary,
    onPrimary = md_theme_dark_onPrimary,
    primaryContainer = md_theme_dark_primaryContainer,
    onPrimaryContainer = md_theme_dark_onPrimaryContainer,
    secondary = md_theme_dark_secondary,
    onSecondary = md_theme_dark_onSecondary,
    secondaryContainer = md_theme_dark_secondaryContainer,
    onSecondaryContainer = md_theme_dark_onSecondaryContainer,
    tertiary = md_theme_dark_tertiary,
    onTertiary = md_theme_dark_onTertiary,
    tertiaryContainer = md_theme_dark_tertiaryContainer,
    onTertiaryContainer = md_theme_dark_onTertiaryContainer,
    error = md_theme_dark_error,
    errorContainer = md_theme_dark_errorContainer,
    onError = md_theme_dark_onError,
    onErrorContainer = md_theme_dark_onErrorContainer,
    background = md_theme_dark_background,
    onBackground = md_theme_dark_onBackground,
    surface = md_theme_dark_surface,
    onSurface = md_theme_dark_onSurface,
    surfaceVariant = md_theme_dark_surfaceVariant,
    onSurfaceVariant = md_theme_dark_onSurfaceVariant,
    outline = md_theme_dark_outline,
    inverseOnSurface = md_theme_dark_inverseOnSurface,
    inverseSurface = md_theme_dark_inverseSurface,
    inversePrimary = md_theme_dark_inversePrimary,
    surfaceTint = md_theme_dark_surfaceTint,
    outlineVariant = md_theme_dark_outlineVariant,
    scrim = md_theme_dark_scrim,
)
```

`app/src/main/java/me/bmax/apatch/ui/theme/Theme.kt`:

```kt
package me.bmax.apatch.ui.theme

import android.os.Build
import androidx.activity.ComponentActivity
import androidx.activity.SystemBarStyle
import androidx.activity.enableEdgeToEdge
import androidx.compose.foundation.isSystemInDarkTheme
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.dynamicDarkColorScheme
import androidx.compose.material3.dynamicLightColorScheme
import androidx.compose.runtime.Composable
import androidx.compose.runtime.SideEffect
import androidx.compose.runtime.getValue
import androidx.compose.runtime.livedata.observeAsState
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.remember
import androidx.compose.runtime.setValue
import androidx.compose.ui.graphics.Color
import androidx.compose.ui.graphics.toArgb
import androidx.compose.ui.platform.LocalContext
import androidx.lifecycle.MutableLiveData
import me.bmax.apatch.APApplication
import me.bmax.apatch.ui.webui.MonetColorsProvider

@Composable
private fun SystemBarStyle(
    darkMode: Boolean,
    statusBarScrim: Color = Color.Transparent,
    navigationBarScrim: Color = Color.Transparent
) {
    val context = LocalContext.current
    val activity = context as ComponentActivity

    SideEffect {
        activity.enableEdgeToEdge(
            statusBarStyle = SystemBarStyle.auto(
                statusBarScrim.toArgb(),
                statusBarScrim.toArgb(),
            ) { darkMode }, navigationBarStyle = when {
                darkMode -> SystemBarStyle.dark(
                    navigationBarScrim.toArgb()
                )

                else -> SystemBarStyle.light(
                    navigationBarScrim.toArgb(),
                    navigationBarScrim.toArgb(),
                )
            }
        )
    }
}

val refreshTheme = MutableLiveData(false)

@Composable
fun APatchTheme(
    content: @Composable () -> Unit
) {
    val context = LocalContext.current
    val prefs = APApplication.sharedPreferences

    var darkThemeFollowSys by remember {
        mutableStateOf(
            prefs.getBoolean(
                "night_mode_follow_sys",
                true
            )
        )
    }
    var nightModeEnabled by remember {
        mutableStateOf(
            prefs.getBoolean(
                "night_mode_enabled",
                false
            )
        )
    }
    // Dynamic color is available on Android 12+, and custom 1t!
    var dynamicColor by remember {
        mutableStateOf(
            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.S) prefs.getBoolean(
                "use_system_color_theme",
                true
            ) else false
        )
    }
    var customColorScheme by remember { mutableStateOf(prefs.getString("custom_color", "blue")) }

    val refreshThemeObserver by refreshTheme.observeAsState(false)
    if (refreshThemeObserver == true) {
        darkThemeFollowSys = prefs.getBoolean("night_mode_follow_sys", true)
        nightModeEnabled = prefs.getBoolean("night_mode_enabled", false)
        dynamicColor = if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.S) prefs.getBoolean(
            "use_system_color_theme",
            true
        ) else false
        customColorScheme = prefs.getString("custom_color", "blue")
        refreshTheme.postValue(false)
    }

    val darkTheme = if (darkThemeFollowSys) {
        isSystemInDarkTheme()
    } else {
        nightModeEnabled
    }

    val colorScheme = if (!dynamicColor) {
        if (darkTheme) {
            when (customColorScheme) {
                "amber" -> DarkAmberTheme
                "blue_grey" -> DarkBlueGreyTheme
                "blue" -> DarkBlueTheme
                "brown" -> DarkBrownTheme
                "cyan" -> DarkCyanTheme
                "deep_orange" -> DarkDeepOrangeTheme
                "deep_purple" -> DarkDeepPurpleTheme
                "green" -> DarkGreenTheme
                "indigo" -> DarkIndigoTheme
                "light_blue" -> DarkLightBlueTheme
                "light_green" -> DarkLightGreenTheme
                "lime" -> DarkLimeTheme
                "orange" -> DarkOrangeTheme
                "pink" -> DarkPinkTheme
                "purple" -> DarkPurpleTheme
                "red" -> DarkRedTheme
                "sakura" -> DarkSakuraTheme
                "teal" -> DarkTealTheme
                "yellow" -> DarkYellowTheme
                else -> DarkBlueTheme
            }
        } else {
            when (customColorScheme) {
                "amber" -> LightAmberTheme
                "blue_grey" -> LightBlueGreyTheme
                "blue" -> LightBlueTheme
                "brown" -> LightBrownTheme
                "cyan" -> LightCyanTheme
                "deep_orange" -> LightDeepOrangeTheme
                "deep_purple" -> LightDeepPurpleTheme
                "green" -> LightGreenTheme
                "indigo" -> LightIndigoTheme
                "light_blue" -> LightLightBlueTheme
                "light_green" -> LightLightGreenTheme
                "lime" -> LightLimeTheme
                "orange" -> LightOrangeTheme
                "pink" -> LightPinkTheme
                "purple" -> LightPurpleTheme
                "red" -> LightRedTheme
                "sakura" -> LightSakuraTheme
                "teal" -> LightTealTheme
                "yellow" -> LightYellowTheme
                else -> LightBlueTheme
            }
        }
    } else {
        when {
            Build.VERSION.SDK_INT >= Build.VERSION_CODES.S -> {
                if (darkTheme) dynamicDarkColorScheme(context) else dynamicLightColorScheme(context)
            }

            darkTheme -> DarkBlueTheme
            else -> LightBlueTheme
        }
    }

    SystemBarStyle(
        darkMode = darkTheme
    )

    MaterialTheme(
        colorScheme = colorScheme,
        typography = Typography,
        content = {
            MonetColorsProvider.UpdateCss()
            content()
        }
    )
}

```

`app/src/main/java/me/bmax/apatch/ui/theme/Type.kt`:

```kt
package me.bmax.apatch.ui.theme

import androidx.compose.ui.text.TextStyle
import androidx.compose.ui.text.font.FontFamily
import androidx.compose.ui.text.font.FontWeight
import androidx.compose.ui.unit.sp

// Set of Material typography styles to start with
val Typography = androidx.compose.material3.Typography(
    bodyLarge = TextStyle(
        fontFamily = FontFamily.Default,
        fontWeight = FontWeight.Normal,
        fontSize = 16.sp,
        lineHeight = 24.sp,
        letterSpacing = 0.5.sp
    )
    /* Other default text styles to override
    titleLarge = TextStyle(
        fontFamily = FontFamily.Default,
        fontWeight = FontWeight.Normal,
        fontSize = 22.sp,
        lineHeight = 28.sp,
        letterSpacing = 0.sp
    ),
    labelSmall = TextStyle(
        fontFamily = FontFamily.Default,
        fontWeight = FontWeight.Medium,
        fontSize = 11.sp,
        lineHeight = 16.sp,
        letterSpacing = 0.5.sp
    )
    */
)
```

`app/src/main/java/me/bmax/apatch/ui/theme/YellowTheme.kt`:

```kt
package me.bmax.apatch.ui.theme

import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.ui.graphics.Color

private val md_theme_light_primary = Color(0xFF695F00)
private val md_theme_light_onPrimary = Color(0xFFFFFFFF)
private val md_theme_light_primaryContainer = Color(0xFFF9E534)
private val md_theme_light_onPrimaryContainer = Color(0xFF201C00)
private val md_theme_light_secondary = Color(0xFF645F41)
private val md_theme_light_onSecondary = Color(0xFFFFFFFF)
private val md_theme_light_secondaryContainer = Color(0xFFEBE3BD)
private val md_theme_light_onSecondaryContainer = Color(0xFF1F1C05)
private val md_theme_light_tertiary = Color(0xFF406652)
private val md_theme_light_onTertiary = Color(0xFFFFFFFF)
private val md_theme_light_tertiaryContainer = Color(0xFFC2ECD3)
private val md_theme_light_onTertiaryContainer = Color(0xFF002113)
private val md_theme_light_error = Color(0xFFBA1A1A)
private val md_theme_light_errorContainer = Color(0xFFFFDAD6)
private val md_theme_light_onError = Color(0xFFFFFFFF)
private val md_theme_light_onErrorContainer = Color(0xFF410002)
private val md_theme_light_background = Color(0xFFFFFBFF)
private val md_theme_light_onBackground = Color(0xFF1D1C16)
private val md_theme_light_surface = Color(0xFFFFFBFF)
private val md_theme_light_onSurface = Color(0xFF1D1C16)
private val md_theme_light_surfaceVariant = Color(0xFFE8E2D0)
private val md_theme_light_onSurfaceVariant = Color(0xFF4A473A)
private val md_theme_light_outline = Color(0xFF7B7768)
private val md_theme_light_inverseOnSurface = Color(0xFFF5F0E7)
private val md_theme_light_inverseSurface = Color(0xFF32302A)
private val md_theme_light_inversePrimary = Color(0xFFDBC90A)
private val md_theme_light_shadow = Color(0xFF000000)
private val md_theme_light_surfaceTint = Color(0xFF695F00)
private val md_theme_light_outlineVariant = Color(0xFFCBC6B5)
private val md_theme_light_scrim = Color(0xFF000000)

private val md_theme_dark_primary = Color(0xFFDBC90A)
private val md_theme_dark_onPrimary = Color(0xFF363100)
private val md_theme_dark_primaryContainer = Color(0xFF4F4800)
private val md_theme_dark_onPrimaryContainer = Color(0xFFF9E534)
private val md_theme_dark_secondary = Color(0xFFCEC7A3)
private val md_theme_dark_onSecondary = Color(0xFF343117)
private val md_theme_dark_secondaryContainer = Color(0xFF4B472B)
private val md_theme_dark_onSecondaryContainer = Color(0xFFEBE3BD)
private val md_theme_dark_tertiary = Color(0xFFA7D0B7)
private val md_theme_dark_onTertiary = Color(0xFF103726)
private val md_theme_dark_tertiaryContainer = Color(0xFF294E3B)
private val md_theme_dark_onTertiaryContainer = Color(0xFFC2ECD3)
private val md_theme_dark_error = Color(0xFFFFB4AB)
private val md_theme_dark_errorContainer = Color(0xFF93000A)
private val md_theme_dark_onError = Color(0xFF690005)
private val md_theme_dark_onErrorContainer = Color(0xFFFFDAD6)
private val md_theme_dark_background = Color(0xFF1D1C16)
private val md_theme_dark_onBackground = Color(0xFFE7E2D9)
private val md_theme_dark_surface = Color(0xFF1D1C16)
private val md_theme_dark_onSurface = Color(0xFFE7E2D9)
private val md_theme_dark_surfaceVariant = Color(0xFF4A473A)
private val md_theme_dark_onSurfaceVariant = Color(0xFFCBC6B5)
private val md_theme_dark_outline = Color(0xFF959181)
private val md_theme_dark_inverseOnSurface = Color(0xFF1D1C16)
private val md_theme_dark_inverseSurface = Color(0xFFE7E2D9)
private val md_theme_dark_inversePrimary = Color(0xFF695F00)
private val md_theme_dark_shadow = Color(0xFF000000)
private val md_theme_dark_surfaceTint = Color(0xFFDBC90A)
private val md_theme_dark_outlineVariant = Color(0xFF4A473A)
private val md_theme_dark_scrim = Color(0xFF000000)

val LightYellowTheme = lightColorScheme(
    primary = md_theme_light_primary,
    onPrimary = md_theme_light_onPrimary,
    primaryContainer = md_theme_light_primaryContainer,
    onPrimaryContainer = md_theme_light_onPrimaryContainer,
    secondary = md_theme_light_secondary,
    onSecondary = md_theme_light_onSecondary,
    secondaryContainer = md_theme_light_secondaryContainer,
    onSecondaryContainer = md_theme_light_onSecondaryContainer,
    tertiary = md_theme_light_tertiary,
    onTertiary = md_theme_light_onTertiary,
    tertiaryContainer = md_theme_light_tertiaryContainer,
    onTertiaryContainer = md_theme_light_onTertiaryContainer,
    error = md_theme_light_error,
    errorContainer = md_theme_light_errorContainer,
    onError = md_theme_light_onError,
    onErrorContainer = md_theme_light_onErrorContainer,
    background = md_theme_light_background,
    onBackground = md_theme_light_onBackground,
    surface = md_theme_light_surface,
    onSurface = md_theme_light_onSurface,
    surfaceVariant = md_theme_light_surfaceVariant,
    onSurfaceVariant = md_theme_light_onSurfaceVariant,
    outline = md_theme_light_outline,
    inverseOnSurface = md_theme_light_inverseOnSurface,
    inverseSurface = md_theme_light_inverseSurface,
    inversePrimary = md_theme_light_inversePrimary,
    surfaceTint = md_theme_light_surfaceTint,
    outlineVariant = md_theme_light_outlineVariant,
    scrim = md_theme_light_scrim,
)

val DarkYellowTheme = darkColorScheme(
    primary = md_theme_dark_primary,
    onPrimary = md_theme_dark_onPrimary,
    primaryContainer = md_theme_dark_primaryContainer,
    onPrimaryContainer = md_theme_dark_onPrimaryContainer,
    secondary = md_theme_dark_secondary,
    onSecondary = md_theme_dark_onSecondary,
    secondaryContainer = md_theme_dark_secondaryContainer,
    onSecondaryContainer = md_theme_dark_onSecondaryContainer,
    tertiary = md_theme_dark_tertiary,
    onTertiary = md_theme_dark_onTertiary,
    tertiaryContainer = md_theme_dark_tertiaryContainer,
    onTertiaryContainer = md_theme_dark_onTertiaryContainer,
    error = md_theme_dark_error,
    errorContainer = md_theme_dark_errorContainer,
    onError = md_theme_dark_onError,
    onErrorContainer = md_theme_dark_onErrorContainer,
    background = md_theme_dark_background,
    onBackground = md_theme_dark_onBackground,
    surface = md_theme_dark_surface,
    onSurface = md_theme_dark_onSurface,
    surfaceVariant = md_theme_dark_surfaceVariant,
    onSurfaceVariant = md_theme_dark_onSurfaceVariant,
    outline = md_theme_dark_outline,
    inverseOnSurface = md_theme_dark_inverseOnSurface,
    inverseSurface = md_theme_dark_inverseSurface,
    inversePrimary = md_theme_dark_inversePrimary,
    surfaceTint = md_theme_dark_surfaceTint,
    outlineVariant = md_theme_dark_outlineVariant,
    scrim = md_theme_dark_scrim,
)
```

`app/src/main/java/me/bmax/apatch/ui/viewmodel/APModuleViewModel.kt`:

```kt
package me.bmax.apatch.ui.viewmodel

import android.os.SystemClock
import android.util.Log
import androidx.compose.runtime.derivedStateOf
import androidx.compose.runtime.getValue
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.setValue
import androidx.lifecycle.ViewModel
import androidx.lifecycle.viewModelScope
import kotlinx.coroutines.Dispatchers
import kotlinx.coroutines.launch
import me.bmax.apatch.apApp
import me.bmax.apatch.util.HanziToPinyin
import me.bmax.apatch.util.listModules
import org.json.JSONArray
import org.json.JSONObject
import java.text.Collator
import java.util.Locale

class APModuleViewModel : ViewModel() {
    companion object {
        private const val TAG = "ModuleViewModel"
        private var modules by mutableStateOf<List<ModuleInfo>>(emptyList())
    }

    data class ModuleInfo(
        val id: String,
        val name: String,
        val author: String,
        val version: String,
        val versionCode: Int,
        val description: String,
        val enabled: Boolean,
        val update: Boolean,
        val remove: Boolean,
        val updateJson: String,
        val hasWebUi: Boolean,
        val hasActionScript: Boolean,
        val metamodule: Boolean,
        val updateInfo: ModuleUpdateInfo? = null,
    )

    data class ModuleUpdateInfo(
        val version: String,
        val versionCode: Int,
        val zipUrl: String,
        val changelog: String,
    )

    var search by mutableStateOf("")
    var isRefreshing by mutableStateOf(false)
        private set

    val moduleList by derivedStateOf {
        val collator = Collator.getInstance(Locale.getDefault())

        val comparator = compareByDescending<ModuleInfo> { it.metamodule && it.enabled }
            .thenBy(collator) { it.id }

        modules.filter {
            it.id.contains(search, true) || it.name.contains(search, true) || HanziToPinyin.getInstance()
                .toPinyinString(it.name)?.contains(search, true) == true
        }.sortedWith(comparator).also {
            isRefreshing = false
        }
    }

    var isNeedRefresh by mutableStateOf(false)
        private set

    fun markNeedRefresh() {
        isNeedRefresh = true
    }

    fun fetchModuleList() {
        viewModelScope.launch(Dispatchers.IO) {
            isRefreshing = true

            val oldModuleList = modules

            val start = SystemClock.elapsedRealtime()

            kotlin.runCatching {

                val result = listModules()

                Log.i(TAG, "result: $result")

                val array = JSONArray(result)
                modules = (0 until array.length())
                    .asSequence()
                    .map { array.getJSONObject(it) }
                    .map { obj ->
                        ModuleInfo(
                            obj.getString("id"),

                            obj.optString("name"),
                            obj.optString("author", "Unknown"),
                            obj.optString("version", "Unknown"),
                            obj.optInt("versionCode", 0),
                            obj.optString("description"),
                            obj.getBoolean("enabled"),
                            obj.getBoolean("update"),
                            obj.getBoolean("remove"),
                            obj.optString("updateJson"),
                            obj.getBooleanCompat("web"),
                            obj.getBooleanCompat("action"),
                            obj.getBooleanCompat("metamodule")
                        )
                    }.toList()
                viewModelScope.launch(Dispatchers.IO) {
                    val updatedModules = modules.map { module ->
                        if (module.enabled && module.updateJson.isNotEmpty() && !module.update && !module.remove) {
                            module.copy(updateInfo = runCatching { checkUpdate(module) }.getOrNull())
                        } else module
                    }
                    modules = updatedModules
                }
                isNeedRefresh = false
            }.onFailure { e ->
                Log.e(TAG, "fetchModuleList: ", e)
                isRefreshing = false
            }

            // when both old and new is kotlin.collections.EmptyList
            // moduleList update will don't trigger
            if (oldModuleList === modules) {
                isRefreshing = false
            }

            Log.i(TAG, "load cost: ${SystemClock.elapsedRealtime() - start}, modules: $modules")
        }
    }

    private fun sanitizeVersionString(version: String): String {
        return version.replace(Regex("[^a-zA-Z0-9.\\-_]"), "_")
    }

    fun checkUpdate(m: ModuleInfo): ModuleUpdateInfo? {
        if (m.updateJson.isEmpty() || m.remove || m.update || !m.enabled) {
            return null
        }
        // download updateJson
        val result = kotlin.runCatching {
            val url = m.updateJson
            Log.i(TAG, "checkUpdate url: $url")
            val response = apApp.okhttpClient
                .newCall(
                    okhttp3.Request.Builder()
                        .url(url)
                        .build()
                ).execute()
            Log.d(TAG, "checkUpdate code: ${response.code}")
            if (response.isSuccessful) {
                response.body?.string() ?: ""
            } else {
                ""
            }
        }.getOrDefault("")
        Log.i(TAG, "checkUpdate result: $result")

        if (result.isEmpty()) {
            return null
        }

        val updateJson = kotlin.runCatching {
            JSONObject(result)
        }.getOrNull() ?: return null

        val version = sanitizeVersionString(updateJson.optString("version", ""))
        val versionCode = updateJson.optInt("versionCode", 0)
        val zipUrl = updateJson.optString("zipUrl", "")
        val changelog = updateJson.optString("changelog", "")
        if (versionCode <= m.versionCode || zipUrl.isEmpty()) {
            return null
        }

        return ModuleUpdateInfo(version, versionCode, zipUrl, changelog)
    }
}

private fun JSONObject.getBooleanCompat(key: String, default: Boolean = false): Boolean {
    if (!has(key)) return default
    return when (val value = opt(key)) {
        is Boolean -> value
        is String -> value.equals("true", ignoreCase = true) || value == "1"
        is Number -> value.toInt() != 0
        else -> default
    }
}
```

`app/src/main/java/me/bmax/apatch/ui/viewmodel/KPModel.kt`:

```kt
package me.bmax.apatch.ui.viewmodel

import android.os.Parcelable
import androidx.annotation.Keep
import androidx.compose.runtime.Immutable
import kotlinx.parcelize.Parcelize

object KPModel {

    enum class TriggerEvent(val event: String) {
        PAGING_INIT("paging-init"),
        PRE_KERNEL_INIT("pre-kernel-init"),
        POST_KERNEL_INIT("post-kernel-init"),
    }


    enum class ExtraType(val desc: String) {
        NONE("none"),
        KPM("kpm"),
        SHELL("shell"),
        EXEC("exec"),
        RAW("raw"),
        ANDROID_RC("android_rc");
    }

    interface IExtraInfo : Parcelable {
        var type: ExtraType
        var name: String
        var event: String
        var args: String
    }

    @Immutable
    @Parcelize
    @Keep
    data class KPMInfo(
        override var type: ExtraType,
        override var name: String,
        override var event: String,
        override var args: String,
        var version: String,
        var license: String,
        var author: String,
        var description: String,
    ) : IExtraInfo

    @Immutable
    @Parcelize
    @Keep
    data class KPImgInfo(
        var version: String,
        var compileTime: String,
        var config: String,
        var superKey: String,
        var rootSuperkey: String
    ) : Parcelable

    @Immutable
    @Parcelize
    @Keep
    data class KImgInfo(
        var banner: String,
        var patched: Boolean,
    ) : Parcelable

}
```

`app/src/main/java/me/bmax/apatch/ui/viewmodel/KPModuleViewModel.kt`:

```kt
package me.bmax.apatch.ui.viewmodel

import android.os.SystemClock
import android.util.Log
import androidx.compose.runtime.derivedStateOf
import androidx.compose.runtime.getValue
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.setValue
import androidx.lifecycle.ViewModel
import androidx.lifecycle.viewModelScope
import kotlinx.coroutines.Dispatchers
import kotlinx.coroutines.launch
import me.bmax.apatch.Natives
import me.bmax.apatch.util.HanziToPinyin
import java.text.Collator
import java.util.Locale

class KPModuleViewModel : ViewModel() {
    companion object {
        private const val TAG = "KPModuleViewModel"
        private var modules by mutableStateOf<List<KPModel.KPMInfo>>(emptyList())
    }

    var search by mutableStateOf("")
    var isRefreshing by mutableStateOf(false)
        private set


    val moduleList by derivedStateOf {
        val comparator = compareBy(
            comparator = Collator.getInstance(Locale.getDefault()),
            selector = KPModel.KPMInfo::name
        )

        modules.filter {
            it.name.contains(search, true) || it.name.contains(search, true) || HanziToPinyin.getInstance()
                .toPinyinString(it.name)?.contains(search, true) == true
        }.sortedWith(comparator).also {
            isRefreshing = false
        }
    }

    var isNeedRefresh by mutableStateOf(false)
        private set

    fun markNeedRefresh() {
        isNeedRefresh = true
    }

    fun fetchModuleList() {
        viewModelScope.launch(Dispatchers.IO) {
            isRefreshing = true
            val oldModuleList = modules
            val start = SystemClock.elapsedRealtime()

            kotlin.runCatching {
                var names = Natives.kernelPatchModuleList()
                if (Natives.kernelPatchModuleNum() <= 0)
                    names = ""
                val nameList = names.split('\n').toList()
                Log.d(TAG, "kpm list: $nameList")
                modules = nameList.filter { it.isNotEmpty() }.map {
                    val infoline = Natives.kernelPatchModuleInfo(it)
                    val spi = infoline.split('\n')
                    val name = spi.find { it.startsWith("name=") }?.removePrefix("name=")
                    val version = spi.find { it.startsWith("version=") }?.removePrefix("version=")
                    val license = spi.find { it.startsWith("license=") }?.removePrefix("license=")
                    val author = spi.find { it.startsWith("author=") }?.removePrefix("author=")
                    val description =
                        spi.find { it.startsWith("description=") }?.removePrefix("description=")
                    val args = spi.find { it.startsWith("args=") }?.removePrefix("args=")
                    val info = KPModel.KPMInfo(
                        KPModel.ExtraType.KPM,
                        name ?: "",
                        "",
                        args ?: "",
                        version ?: "",
                        license ?: "",
                        author ?: "",
                        description ?: ""
                    )
                    info
                }
                isNeedRefresh = false
            }.onFailure { e ->
                Log.e(TAG, "fetchModuleList: ", e)
                isRefreshing = false
            }

            // when both old and new is kotlin.collections.EmptyList
            // moduleList update will don't trigger
            if (oldModuleList === modules) {
                isRefreshing = false
            }

            Log.i(TAG, "load cost: ${SystemClock.elapsedRealtime() - start}, modules: $modules")
        }
    }


}

```

`app/src/main/java/me/bmax/apatch/ui/viewmodel/PatchesViewModel.kt`:

```kt
package me.bmax.apatch.ui.viewmodel

import android.content.ContentValues
import android.content.Context
import android.net.Uri
import android.os.Build
import android.os.Environment
import android.provider.MediaStore
import android.system.Os
import android.util.Log
import androidx.annotation.RequiresApi
import androidx.compose.runtime.getValue
import androidx.compose.runtime.mutableStateListOf
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.setValue
import androidx.core.content.FileProvider
import androidx.lifecycle.ViewModel
import androidx.lifecycle.viewModelScope
import com.topjohnwu.superuser.CallbackList
import com.topjohnwu.superuser.Shell
import com.topjohnwu.superuser.nio.ExtendedFile
import com.topjohnwu.superuser.nio.FileSystemManager
import kotlinx.coroutines.Dispatchers
import kotlinx.coroutines.launch
import me.bmax.apatch.APApplication
import me.bmax.apatch.BuildConfig
import me.bmax.apatch.R
import me.bmax.apatch.apApp
import me.bmax.apatch.util.Version
import me.bmax.apatch.util.copyAndClose
import me.bmax.apatch.util.copyAndCloseOut
import me.bmax.apatch.util.createRootShell
import me.bmax.apatch.util.inputStream
import me.bmax.apatch.util.shellForResult
import me.bmax.apatch.util.writeTo
import org.ini4j.Ini
import java.io.BufferedReader
import java.io.File
import java.io.FileNotFoundException
import java.io.IOException
import java.io.InputStreamReader
import java.io.StringReader

private const val TAG = "PatchViewModel"

class PatchesViewModel : ViewModel() {

    enum class PatchMode(val sId: Int) {
        PATCH_ONLY(R.string.patch_mode_bootimg_patch),
        PATCH_AND_INSTALL(R.string.patch_mode_patch_and_install),
        INSTALL_TO_NEXT_SLOT(R.string.patch_mode_install_to_next_slot),
        UNPATCH(R.string.patch_mode_uninstall_patch)
    }

    var bootSlot by mutableStateOf("")
    var bootDev by mutableStateOf("")
    var kimgInfo by mutableStateOf(KPModel.KImgInfo("", false))
    var kpimgInfo by mutableStateOf(KPModel.KPImgInfo("", "", "", "", ""))
    var superkey by mutableStateOf(APApplication.superKey)
    var existedExtras = mutableStateListOf<KPModel.IExtraInfo>()
    var newExtras = mutableStateListOf<KPModel.IExtraInfo>()
    var newExtrasFileName = mutableListOf<String>()

    var running by mutableStateOf(false)
    var patching by mutableStateOf(false)
    var patchdone by mutableStateOf(false)
    var needReboot by mutableStateOf(false)

    var error by mutableStateOf("")
    var patchLog by mutableStateOf("")

    private val patchDir: ExtendedFile = FileSystemManager.getLocal().getFile(apApp.filesDir.parent, "patch")
    private var srcBoot: ExtendedFile = patchDir.getChildFile("boot.img")
    private var shell: Shell = createRootShell()
    private var prepared: Boolean = false

    private fun prepare() {
        patchDir.deleteRecursively()
        patchDir.mkdirs()
        val execs = listOf(
            "libkptools.so", "libbusybox.so", "libkpatch.so", "libbootctl.so"
        )
        error = ""

        val info = apApp.applicationInfo
        val libs = File(info.nativeLibraryDir).listFiles { _, name ->
            execs.contains(name)
        } ?: emptyArray()

        for (lib in libs) {
            val name = lib.name.substring(3, lib.name.length - 3)
            Os.symlink(lib.path, "$patchDir/$name")
        }

        // Extract scripts
        for (script in listOf(
            "boot_patch.sh", "boot_unpatch.sh", "boot_extract.sh", "util_functions.sh", "kpimg"
        )) {
            val dest = File(patchDir, script)
            apApp.assets.open(script).writeTo(dest)
        }

    }

    private fun parseKpimg() {
        val result = shellForResult(
            shell, "cd $patchDir", "./kptools -l -k kpimg"
        )

        if (result.isSuccess) {
            val ini = Ini(StringReader(result.out.joinToString("\n")))
            val kpimg = ini["kpimg"]
            if (kpimg != null) {
                kpimgInfo = KPModel.KPImgInfo(
                    kpimg["version"].toString(),
                    kpimg["compile_time"].toString(),
                    kpimg["config"].toString(),
                    APApplication.superKey,     // current key
                    kpimg["root_superkey"].toString(),   // empty
                )
            } else {
                error += "parse kpimg error\n"
            }
        } else {
            error = result.err.joinToString("\n")
        }
    }

    private fun parseBootimg(bootimg: String) {
        val result = shellForResult(
            shell,
            "cd $patchDir",
            "./kptools unpacknolog $bootimg",
            "./kptools -l -i kernel",
        )
        if (result.isSuccess) {
            val ini = Ini(StringReader(result.out.joinToString("\n")))
            Log.d(TAG, "kernel image info: $ini")

            val kernel = ini["kernel"]
            if (kernel == null) {
                error += "empty kernel section"
                Log.d(TAG, error)
                return
            }
            kimgInfo = KPModel.KImgInfo(kernel["banner"].toString(), kernel["patched"].toBoolean())
            if (kimgInfo.patched) {
                val superkey = ini["kpimg"]?.getOrDefault("superkey", "") ?: ""
                kpimgInfo.superKey = superkey
                if (checkSuperKeyValidation(superkey)) {
                    this.superkey = superkey
                }
                var kpmNum = kernel["extra_num"]?.toInt()
                if (kpmNum == null) {
                    val extras = ini["extras"]
                    kpmNum = extras?.get("num")?.toInt()
                }
                if (kpmNum != null && kpmNum > 0) {
                    for (i in 0..<kpmNum) {
                        val extra = ini["extra $i"]
                        if (extra == null) {
                            error += "empty extra section"
                            break
                        }
                        val type = KPModel.ExtraType.valueOf(extra["type"]!!.uppercase())
                        val name = extra["name"].toString()
                        val args = extra["args"].toString()
                        var event = extra["event"].toString()
                        if (event.isEmpty()) {
                            event = KPModel.TriggerEvent.PRE_KERNEL_INIT.event
                        }
                        if (type == KPModel.ExtraType.KPM) {
                            val kpmInfo = KPModel.KPMInfo(
                                type, name, event, args,
                                extra["version"].toString(),
                                extra["license"].toString(),
                                extra["author"].toString(),
                                extra["description"].toString(),
                            )
                            existedExtras.add(kpmInfo)
                        }
                    }

                }
            }
        } else {
            error += result.err.joinToString("\n")
        }
    }

    val checkSuperKeyValidation: (superKey: String) -> Boolean = { superKey ->
        superKey.length in 8..63 && superKey.any { it.isDigit() } && superKey.any { it.isLetter() }
    }

    fun copyAndParseBootimg(uri: Uri) {
        viewModelScope.launch(Dispatchers.IO) {
            if (running) return@launch
            running = true
            try {
                uri.inputStream().buffered().use { src ->
                    srcBoot.also {
                        src.copyAndCloseOut(it.newOutputStream())
                    }
                }
            } catch (e: IOException) {
                Log.e(TAG, "copy boot image error: $e")
            }
            parseBootimg(srcBoot.path)
            running = false
        }
    }

    private fun extractAndParseBootimg(mode: PatchMode) {
        var cmdBuilder = "./boot_extract.sh"

        if (mode == PatchMode.INSTALL_TO_NEXT_SLOT) {
            cmdBuilder += " true"
        }

        val result = shellForResult(
            shell,
            "export ASH_STANDALONE=1",
            "cd $patchDir",
            "./busybox sh $cmdBuilder",
        )

        if (result.isSuccess) {
            bootSlot = if (!result.out.toString().contains("SLOT=")) {
                ""
            } else {
                result.out.filter { it.startsWith("SLOT=") }[0].removePrefix("SLOT=")
            }
            bootDev =
                result.out.filter { it.startsWith("BOOTIMAGE=") }[0].removePrefix("BOOTIMAGE=")
            Log.i(TAG, "current slot: $bootSlot")
            Log.i(TAG, "current bootimg: $bootDev")
            srcBoot = FileSystemManager.getLocal().getFile(bootDev)
            parseBootimg(bootDev)
        } else {
            error = result.err.joinToString("\n")
        }
        running = false
    }

    fun prepare(mode: PatchMode) {
        viewModelScope.launch(Dispatchers.IO) {
            if (prepared) return@launch
            prepared = true

            running = true
            prepare()
            if (mode != PatchMode.UNPATCH) {
                parseKpimg()
            }
            if (mode == PatchMode.PATCH_AND_INSTALL || mode == PatchMode.UNPATCH || mode == PatchMode.INSTALL_TO_NEXT_SLOT) {
                extractAndParseBootimg(mode)
            }
            running = false
        }
    }

    fun embedKPM(uri: Uri) {
        viewModelScope.launch(Dispatchers.IO) {
            if (running) return@launch
            running = true
            error = ""

            val rand = (1..4).map { ('a'..'z').random() }.joinToString("")
            val kpmFileName = "${rand}.kpm"
            val kpmFile: ExtendedFile = patchDir.getChildFile(kpmFileName)

            Log.i(TAG, "copy kpm to: " + kpmFile.path)
            try {
                uri.inputStream().buffered().use { src ->
                    kpmFile.also {
                        src.copyAndCloseOut(it.newOutputStream())
                    }
                }
            } catch (e: IOException) {
                Log.e(TAG, "Copy kpm error: $e")
            }

            val result = shellForResult(
                shell, "cd $patchDir", "./kptools -l -M ${kpmFile.path}"
            )

            if (result.isSuccess) {
                val ini = Ini(StringReader(result.out.joinToString("\n")))
                val kpm = ini["kpm"]
                if (kpm != null) {
                    val kpmInfo = KPModel.KPMInfo(
                        KPModel.ExtraType.KPM,
                        kpm["name"].toString(),
                        KPModel.TriggerEvent.PRE_KERNEL_INIT.event,
                        "",
                        kpm["version"].toString(),
                        kpm["license"].toString(),
                        kpm["author"].toString(),
                        kpm["description"].toString(),
                    )
                    newExtras.add(kpmInfo)
                    newExtrasFileName.add(kpmFileName)
                }
            } else {
                error = "Invalid KPM\n"
            }
            running = false
        }
    }

    fun doUnpatch() {
        viewModelScope.launch(Dispatchers.IO) {
            patching = true
            patchLog = ""
            Log.i(TAG, "starting unpatching...")

            val logs = object : CallbackList<String>() {
                override fun onAddElement(e: String?) {
                    patchLog += e
                    Log.i(TAG, "" + e)
                    patchLog += "\n"
                }
            }

            val result = shell.newJob().add(
                "export ASH_STANDALONE=1",
                "cd $patchDir",
                "cp /data/adb/ap/ori.img new-boot.img",
                "./busybox sh ./boot_unpatch.sh $bootDev",
                "rm -f ${APApplication.APD_PATH}",
                "rm -rf ${APApplication.APATCH_FOLDER}",
            ).to(logs, logs).exec()

            if (result.isSuccess) {
                logs.add(" Unpatch successful")
                needReboot = true
                APApplication.markNeedReboot()
            } else {
                logs.add(" Unpatched failed")
                error = result.err.joinToString("\n")
            }
            logs.add("****************************")

            patchdone = true
            patching = false
        }
    }
    fun isSuExecutable(): Boolean {
        val suFile = File("/system/bin/su")
        return suFile.exists() && suFile.canExecute()
    }
    fun doPatch(mode: PatchMode) {
        viewModelScope.launch(Dispatchers.IO) {
            patching = true
            Log.d(TAG, "starting patching...")

            val apVer = Version.getManagerVersion().second
            val rand = (1..4).map { ('a'..'z').random() }.joinToString("")
            val outFilename = "apatch_patched_${apVer}_${BuildConfig.buildKPV}_${rand}.img"

            val logs = object : CallbackList<String>() {
                override fun onAddElement(e: String?) {
                    patchLog += e
                    Log.d(TAG, "" + e)
                    patchLog += "\n"
                }
            }
            logs.add("****************************")

            var patchCommand = mutableListOf("./busybox sh boot_patch.sh \"$0\" \"$@\"")

            // adapt for 0.10.7 and lower KP
            var isKpOld = false

            if (mode == PatchMode.PATCH_AND_INSTALL || mode == PatchMode.INSTALL_TO_NEXT_SLOT) {

                val KPCheck = shell.newJob().add("truncate $superkey -Z u:r:magisk:s0 -c whoami").exec()

                if (KPCheck.isSuccess && !isSuExecutable()) {
                    patchCommand.addAll(0, listOf("truncate", APApplication.superKey, "-Z", APApplication.MAGISK_SCONTEXT, "-c"))
                    patchCommand.addAll(listOf(superkey, srcBoot.path, "true"))
                } else {
                    patchCommand = mutableListOf("./busybox", "sh", "boot_patch.sh")
                    patchCommand.addAll(listOf(superkey, srcBoot.path, "true"))
                    isKpOld = true
                }

            } else {
                patchCommand.addAll(0, listOf("sh", "-c"))
                patchCommand.addAll(listOf(superkey, srcBoot.path))
            }

            for (i in 0..<newExtrasFileName.size) {
                patchCommand.addAll(listOf("-M", newExtrasFileName[i]))
                val extra = newExtras[i]
                if (extra.args.isNotEmpty()) {
                    patchCommand.addAll(listOf("-A", extra.args))
                }
                if (extra.event.isNotEmpty()) {
                    patchCommand.addAll(listOf("-V", extra.event))
                }
                patchCommand.addAll(listOf("-T", extra.type.desc))
            }
            for (i in 0..<existedExtras.size) {
                val extra = existedExtras[i]
                patchCommand.addAll(listOf("-E", extra.name))
                if (extra.args.isNotEmpty()) {
                    patchCommand.addAll(listOf("-A", extra.args))
                }
                if (extra.event.isNotEmpty()) {
                    patchCommand.addAll(listOf("-V", extra.event))
                }
                patchCommand.addAll(listOf("-T", extra.type.desc))
            }

            val builder = ProcessBuilder(patchCommand)

            Log.i(TAG, "patchCommand: $patchCommand")

            var succ = false

            if (isKpOld) {
                val resultString = "\"" + patchCommand.joinToString(separator = "\" \"") + "\""
                val result = shell.newJob().add(
                    "export ASH_STANDALONE=1",
                    "cd $patchDir",
                    resultString,
                ).to(logs, logs).exec()
                succ = result.isSuccess
            } else {
                builder.environment().put("ASH_STANDALONE", "1")
                builder.directory(patchDir)
                builder.redirectErrorStream(true)

                val process = builder.start()

                Thread {
                    BufferedReader(InputStreamReader(process.inputStream)).use { reader ->
                        var line: String?
                        while (reader.readLine().also { line = it } != null) {
                            patchLog += line
                            Log.i(TAG, "" + line)
                            patchLog += "\n"
                        }
                    }
                }.start()
                succ = process.waitFor() == 0
            }

            if (!succ) {
                val msg = " Patch failed."
                error = msg
//                error += result.err.joinToString("\n")
                logs.add(error)
                logs.add("****************************")
                patching = false
                return@launch
            }

            if (mode == PatchMode.PATCH_AND_INSTALL) {
                logs.add("- Reboot to finish the installation...")
                needReboot = true
                APApplication.markNeedReboot()
            } else if (mode == PatchMode.INSTALL_TO_NEXT_SLOT) {
                logs.add("- Connecting boot hal...")
                val bootctlStatus = shell.newJob().add(
                    "cd $patchDir", "chmod 0777 $patchDir/bootctl", "./bootctl hal-info"
                ).to(logs, logs).exec()
                if (!bootctlStatus.isSuccess) {
                    logs.add("[X] Failed to connect to boot hal, you may need switch slot manually")
                } else {
                    val currSlot = shellForResult(
                        shell, "cd $patchDir", "./bootctl get-current-slot"
                    ).out.toString()
                    val targetSlot = if (currSlot.contains("0")) {
                        1
                    } else {
                        0
                    }
                    logs.add("- Switching to next slot: $targetSlot...")
                    val setNextActiveSlot = shell.newJob().add(
                        "cd $patchDir", "./bootctl set-active-boot-slot $targetSlot"
                    ).exec()
                    if (setNextActiveSlot.isSuccess) {
                        logs.add("- Switch done")
                        logs.add("- Writing boot marker script...")
                        val markBootableScript = shell.newJob().add(
                            "mkdir -p /data/adb/post-fs-data.d && rm -rf /data/adb/post-fs-data.d/post_ota.sh && touch /data/adb/post-fs-data.d/post_ota.sh",
                            "echo \"chmod 0777 $patchDir/bootctl\" > /data/adb/post-fs-data.d/post_ota.sh",
                            "echo \"chown root:root 0777 $patchDir/bootctl\" > /data/adb/post-fs-data.d/post_ota.sh",
                            "echo \"$patchDir/bootctl mark-boot-successful\" > /data/adb/post-fs-data.d/post_ota.sh",
                            "echo >> /data/adb/post-fs-data.d/post_ota.sh",
                            "echo \"rm -rf $patchDir\" >> /data/adb/post-fs-data.d/post_ota.sh",
                            "echo >> /data/adb/post-fs-data.d/post_ota.sh",
                            "echo \"rm -f /data/adb/post-fs-data.d/post_ota.sh\" >> /data/adb/post-fs-data.d/post_ota.sh",
                            "chmod 0777 /data/adb/post-fs-data.d/post_ota.sh",
                            "chown root:root /data/adb/post-fs-data.d/post_ota.sh",
                        ).to(logs, logs).exec()
                        if (markBootableScript.isSuccess) {
                            logs.add("- Boot marker script write done")
                        } else {
                            logs.add("[X] Boot marker scripts write failed")
                        }
                    }
                }
                logs.add("- Reboot to finish the installation...")
                needReboot = true
                APApplication.markNeedReboot()
            } else if (mode == PatchMode.PATCH_ONLY) {
                val newBootFile = patchDir.getChildFile("new-boot.img")
                val outDir = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS)
                if (!outDir.exists()) outDir.mkdirs()
                val outPath = File(outDir, outFilename)
                val inputUri = newBootFile.getUri(apApp)

                if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.Q) {
                    val outUri = createDownloadUri(apApp, outFilename)
                    succ = insertDownload(apApp, outUri, inputUri)
                } else {
                    newBootFile.inputStream().copyAndClose(outPath.outputStream())
                }
                if (succ) {
                    logs.add(" Output file is written to ")
                    logs.add(" ${outPath.path}")
                } else {
                    logs.add(" Write patched boot.img failed")
                }
            }
            logs.add("****************************")
            patchdone = true
            patching = false
        }
    }

    @RequiresApi(Build.VERSION_CODES.Q)
    fun createDownloadUri(context: Context, outFilename: String): Uri? {
        val contentValues = ContentValues().apply {
            put(MediaStore.Downloads.DISPLAY_NAME, outFilename)
            put(MediaStore.Downloads.MIME_TYPE, "application/octet-stream")
            put(MediaStore.Downloads.IS_PENDING, 1)
        }

        val resolver = context.contentResolver
        return resolver.insert(MediaStore.Downloads.EXTERNAL_CONTENT_URI, contentValues)
    }

    @RequiresApi(Build.VERSION_CODES.Q)
    fun insertDownload(context: Context, outUri: Uri?, inputUri: Uri): Boolean {
        if (outUri == null) return false

        try {
            val resolver = context.contentResolver
            resolver.openInputStream(inputUri)?.use { inputStream ->
                resolver.openOutputStream(outUri)?.use { outputStream ->
                    inputStream.copyTo(outputStream)
                }
            }
            val contentValues = ContentValues().apply {
                put(MediaStore.Downloads.IS_PENDING, 0)
            }
            resolver.update(outUri, contentValues, null, null)

            return true
        } catch (_: FileNotFoundException) {
            return false
        }
    }

    fun File.getUri(context: Context): Uri {
        val authority = "${context.packageName}.fileprovider"
        return FileProvider.getUriForFile(context, authority, this)
    }

}

```

`app/src/main/java/me/bmax/apatch/ui/viewmodel/SuperUserViewModel.kt`:

```kt
package me.bmax.apatch.ui.viewmodel

import android.content.ComponentName
import android.content.Context
import android.content.Intent
import android.content.ServiceConnection
import android.content.pm.ApplicationInfo
import android.content.pm.PackageInfo
import android.graphics.drawable.Drawable
import android.os.IBinder
import android.os.Parcelable
import android.util.Log
import androidx.compose.runtime.derivedStateOf
import androidx.compose.runtime.getValue
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.setValue
import androidx.lifecycle.ViewModel
import com.topjohnwu.superuser.Shell
import kotlinx.coroutines.Dispatchers
import kotlinx.coroutines.withContext
import kotlinx.parcelize.Parcelize
import me.bmax.apatch.IAPRootService
import me.bmax.apatch.Natives
import me.bmax.apatch.apApp
import me.bmax.apatch.services.RootServices
import me.bmax.apatch.util.APatchCli
import me.bmax.apatch.util.HanziToPinyin
import me.bmax.apatch.util.PkgConfig
import java.text.Collator
import java.util.Locale
import kotlin.concurrent.thread
import kotlin.coroutines.resume
import kotlin.coroutines.suspendCoroutine


class SuperUserViewModel : ViewModel() {
    companion object {
        private const val TAG = "SuperUserViewModel"
        private val appsLock = Any()
        var apps by mutableStateOf<List<AppInfo>>(emptyList())

        fun getAppIconDrawable(context: Context, packageName: String): Drawable? {
            val appList = synchronized(appsLock) { apps }
            val appDetail = appList.find { it.packageName == packageName }
            return appDetail?.packageInfo?.applicationInfo?.loadIcon(context.packageManager)
        }
    }

    @Parcelize
    data class AppInfo(
        val label: String, val packageInfo: PackageInfo, val config: PkgConfig.Config
    ) : Parcelable {
        val packageName: String
            get() = packageInfo.packageName
        val uid: Int
            get() = packageInfo.applicationInfo!!.uid
    }

    var search by mutableStateOf("")
    var showSystemApps by mutableStateOf(false)
    var isRefreshing by mutableStateOf(false)
        private set

    private val sortedList by derivedStateOf {
        val comparator = compareBy<AppInfo> {
            when {
                it.config.allow != 0 -> 0
                it.config.exclude == 1 -> 1
                else -> 2
            }
        }.then(compareBy(Collator.getInstance(Locale.getDefault()), AppInfo::label))
        apps.sortedWith(comparator)
    }

    val appList by derivedStateOf {
        sortedList.filter {
            it.label.lowercase().contains(search.lowercase()) || it.packageName.lowercase()
                .contains(search.lowercase()) || HanziToPinyin.getInstance()
                .toPinyinString(it.label).contains(search.lowercase())
        }.filter {
            it.uid == 2000 // Always show shell
                    || showSystemApps || it.packageInfo.applicationInfo!!.flags.and(ApplicationInfo.FLAG_SYSTEM) == 0
        }
    }

    private suspend inline fun connectRootService(
        crossinline onDisconnect: () -> Unit = {}
    ): Pair<IBinder, ServiceConnection> = suspendCoroutine {
        val connection = object : ServiceConnection {
            override fun onServiceDisconnected(name: ComponentName?) {
                onDisconnect()
            }

            override fun onServiceConnected(name: ComponentName?, binder: IBinder?) {
                it.resume(binder as IBinder to this)
            }
        }
        val intent = Intent(apApp, RootServices::class.java)
        val task = RootServices.bindOrTask(
            intent,
            Shell.EXECUTOR,
            connection,
        )
        val shell = APatchCli.SHELL
        task?.let { it1 -> shell.execTask(it1) }
    }

    private fun stopRootService() {
        val intent = Intent(apApp, RootServices::class.java)
        RootServices.stop(intent)
    }

    suspend fun fetchAppList() {
        isRefreshing = true

        try {
            val result = connectRootService {
                Log.w(TAG, "RootService disconnected")
            }

            withContext(Dispatchers.IO) {
                val binder = result.first
                val allPackages = IAPRootService.Stub.asInterface(binder).getPackages(0)

                withContext(Dispatchers.Main) {
                    stopRootService()
                }
                val uids = Natives.suUids().toList()
                Log.d(TAG, "all allows: $uids")

                var configs: HashMap<Int, PkgConfig.Config> = HashMap()
                thread {
                    Natives.su()
                    configs = PkgConfig.readConfigs()
                }.join()

                Log.d(TAG, "all configs: $configs")

                val newApps = allPackages.list.map {
                    val appInfo = it.applicationInfo
                    val uid = appInfo!!.uid
                    val actProfile = if (uids.contains(uid)) Natives.suProfile(uid) else null
                    val config = configs.getOrDefault(
                        uid, PkgConfig.Config(appInfo.packageName, Natives.isUidExcluded(uid), 0, Natives.Profile(uid = uid))
                    )
                    config.allow = 0

                    // from kernel
                    if (actProfile != null) {
                        config.allow = 1
                        config.profile = actProfile
                    }
                    AppInfo(
                        label = appInfo.loadLabel(apApp.packageManager).toString(),
                        packageInfo = it,
                        config = config
                    )
                }

                withContext(Dispatchers.Main) {
                    synchronized(appsLock) {
                        apps = newApps
                    }
                }
            }
        } catch (e: Exception) {
            Log.e(TAG, "Failed to fetch app list", e)
        } finally {
            isRefreshing = false
        }
    }
}

```

`app/src/main/java/me/bmax/apatch/ui/webui/AppIconUtil.kt`:

```kt
package me.bmax.apatch.ui.webui

import android.content.Context
import android.graphics.Bitmap
import android.graphics.Canvas
import android.graphics.drawable.BitmapDrawable
import android.graphics.drawable.Drawable
import android.util.LruCache
import androidx.core.graphics.createBitmap
import androidx.core.graphics.scale
import me.bmax.apatch.ui.viewmodel.SuperUserViewModel.Companion.getAppIconDrawable

object AppIconUtil {
    // Limit cache size to 200 icons
    private const val CACHE_SIZE = 200
    private val iconCache = LruCache<String?, Bitmap?>(CACHE_SIZE)

    @Synchronized
    fun loadAppIconSync(context: Context, packageName: String, sizePx: Int): Bitmap? {
        val cached = iconCache.get(packageName)
        if (cached != null) return cached

        try {
            val drawable = getAppIconDrawable(context, packageName) ?: return null
            val raw = drawableToBitmap(drawable, sizePx)
            val icon = raw.scale(sizePx, sizePx)
            iconCache.put(packageName, icon)
            return icon
        } catch (_: Exception) {
            return null
        }
    }

    private fun drawableToBitmap(drawable: Drawable, size: Int): Bitmap {
        if (drawable is BitmapDrawable) return drawable.bitmap

        val width = if (drawable.intrinsicWidth > 0) drawable.intrinsicWidth else size
        val height = if (drawable.intrinsicHeight > 0) drawable.intrinsicHeight else size

        val bmp = createBitmap(width, height)
        val canvas = Canvas(bmp)
        drawable.setBounds(0, 0, canvas.width, canvas.height)
        drawable.draw(canvas)
        return bmp
    }
}

```

`app/src/main/java/me/bmax/apatch/ui/webui/Insets.kt`:

```kt
package me.bmax.apatch.ui.webui

/**
 * Insets data class from GitHub@MMRLApp/WebUI-X-Portable
 *
 * Data class representing insets (top, bottom, left, right) for a view.
 *
 * This class provides methods to generate CSS code that can be injected into a WebView
 * to apply these insets as CSS variables. This is useful for adapting web content
 * to the safe areas of a device screen, considering notches, status bars, and navigation bars.
 *
 * @property top The top inset value in pixels.
 * @property bottom The bottom inset value in pixels.
 * @property left The left inset value in pixels.
 * @property right The right inset value in pixels.
 */
data class Insets(
    val top: Int,
    val bottom: Int,
    val left: Int,
    val right: Int,
) {
    val css
        get() = buildString {
            appendLine(":root {")
            appendLine("\t--safe-area-inset-top: ${top}px;")
            appendLine("\t--safe-area-inset-right: ${right}px;")
            appendLine("\t--safe-area-inset-bottom: ${bottom}px;")
            appendLine("\t--safe-area-inset-left: ${left}px;")
            appendLine("\t--window-inset-top: var(--safe-area-inset-top, 0px);")
            appendLine("\t--window-inset-bottom: var(--safe-area-inset-bottom, 0px);")
            appendLine("\t--window-inset-left: var(--safe-area-inset-left, 0px);")
            appendLine("\t--window-inset-right: var(--safe-area-inset-right, 0px);")
            appendLine("\t--f7-safe-area-top: var(--window-inset-top, 0px) !important;")
            appendLine("\t--f7-safe-area-bottom: var(--window-inset-bottom, 0px) !important;")
            appendLine("\t--f7-safe-area-left: var(--window-inset-left, 0px) !important;")
            appendLine("\t--f7-safe-area-right: var(--window-inset-right, 0px) !important;")
            append("}")
        }
}

```

`app/src/main/java/me/bmax/apatch/ui/webui/MimeUtil.java`:

```java
/*
 * Copyright 2023 The Android Open Source Project
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package me.bmax.apatch.ui.webui;

import java.net.URLConnection;

class MimeUtil {

    public static String getMimeFromFileName(String fileName) {
        if (fileName == null) {
            return null;
        }

        // Copying the logic and mapping that Chromium follows.
        // First we check against the OS (this is a limited list by default)
        // but app developers can extend this.
        // We then check against a list of hardcoded mime types above if the
        // OS didn't provide a result.
        String mimeType = URLConnection.guessContentTypeFromName(fileName);

        if (mimeType != null) {
            return mimeType;
        }

        return guessHardcodedMime(fileName);
    }

    // We should keep this map in sync with the lists under
    // //net/base/mime_util.cc in Chromium.
    // A bunch of the mime types don't really apply to Android land
    // like word docs so feel free to filter out where necessary.
    private static String guessHardcodedMime(String fileName) {
        int finalFullStop = fileName.lastIndexOf('.');
        if (finalFullStop == -1) {
            return null;
        }

        final String extension = fileName.substring(finalFullStop + 1).toLowerCase();

        switch (extension) {
            case "webm":
                return "video/webm";
            case "mpeg":
            case "mpg":
                return "video/mpeg";
            case "mp3":
                return "audio/mpeg";
            case "wasm":
                return "application/wasm";
            case "xhtml":
            case "xht":
            case "xhtm":
                return "application/xhtml+xml";
            case "flac":
                return "audio/flac";
            case "ogg":
            case "oga":
            case "opus":
                return "audio/ogg";
            case "wav":
                return "audio/wav";
            case "m4a":
                return "audio/x-m4a";
            case "gif":
                return "image/gif";
            case "jpeg":
            case "jpg":
            case "jfif":
            case "pjpeg":
            case "pjp":
                return "image/jpeg";
            case "png":
                return "image/png";
            case "apng":
                return "image/apng";
            case "svg":
            case "svgz":
                return "image/svg+xml";
            case "webp":
                return "image/webp";
            case "mht":
            case "mhtml":
                return "multipart/related";
            case "css":
                return "text/css";
            case "html":
            case "htm":
            case "shtml":
            case "shtm":
            case "ehtml":
                return "text/html";
            case "js":
            case "mjs":
                return "application/javascript";
            case "xml":
                return "text/xml";
            case "mp4":
            case "m4v":
                return "video/mp4";
            case "ogv":
            case "ogm":
                return "video/ogg";
            case "ico":
                return "image/x-icon";
            case "woff":
                return "application/font-woff";
            case "gz":
            case "tgz":
                return "application/gzip";
            case "json":
                return "application/json";
            case "pdf":
                return "application/pdf";
            case "zip":
                return "application/zip";
            case "bmp":
                return "image/bmp";
            case "tiff":
            case "tif":
                return "image/tiff";
            default:
                return null;
        }
    }
}
```

`app/src/main/java/me/bmax/apatch/ui/webui/MonetColorsProvider.kt`:

```kt
package me.bmax.apatch.ui.webui

import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.surfaceColorAtElevation
import androidx.compose.runtime.Composable
import androidx.compose.runtime.LaunchedEffect
import androidx.compose.ui.graphics.Color
import androidx.compose.ui.unit.dp
import java.util.concurrent.atomic.AtomicReference

/**
 * @author rifsxd
 * @date 2025/6/2.
 */
object MonetColorsProvider {

    private val colorsCss: AtomicReference<String?> = AtomicReference(null)

    fun getColorsCss(): String {
        return colorsCss.get() ?: ""
    }

    @Composable
    fun UpdateCss() {
        val colorScheme = MaterialTheme.colorScheme

        LaunchedEffect(colorScheme) {
            // Generate CSS only when colorScheme changes
            val monetColors = mapOf(
                // App Base Colors
                "primary" to colorScheme.primary.toCssValue(),
                "onPrimary" to colorScheme.onPrimary.toCssValue(),
                "primaryContainer" to colorScheme.primaryContainer.toCssValue(),
                "onPrimaryContainer" to colorScheme.onPrimaryContainer.toCssValue(),
                "inversePrimary" to colorScheme.inversePrimary.toCssValue(),
                "secondary" to colorScheme.secondary.toCssValue(),
                "onSecondary" to colorScheme.onSecondary.toCssValue(),
                "secondaryContainer" to colorScheme.secondaryContainer.toCssValue(),
                "onSecondaryContainer" to colorScheme.onSecondaryContainer.toCssValue(),
                "tertiary" to colorScheme.tertiary.toCssValue(),
                "onTertiary" to colorScheme.onTertiary.toCssValue(),
                "tertiaryContainer" to colorScheme.tertiaryContainer.toCssValue(),
                "onTertiaryContainer" to colorScheme.onTertiaryContainer.toCssValue(),
                "background" to colorScheme.background.toCssValue(),
                "onBackground" to colorScheme.onBackground.toCssValue(),
                "surface" to colorScheme.surface.toCssValue(),
                "tonalSurface" to colorScheme.surfaceColorAtElevation(1.dp).toCssValue(),
                "onSurface" to colorScheme.onSurface.toCssValue(),
                "surfaceVariant" to colorScheme.surfaceVariant.toCssValue(),
                "onSurfaceVariant" to colorScheme.onSurfaceVariant.toCssValue(),
                "surfaceTint" to colorScheme.surfaceTint.toCssValue(),
                "inverseSurface" to colorScheme.inverseSurface.toCssValue(),
                "inverseOnSurface" to colorScheme.inverseOnSurface.toCssValue(),
                "error" to colorScheme.error.toCssValue(),
                "onError" to colorScheme.onError.toCssValue(),
                "errorContainer" to colorScheme.errorContainer.toCssValue(),
                "onErrorContainer" to colorScheme.onErrorContainer.toCssValue(),
                "outline" to colorScheme.outline.toCssValue(),
                "outlineVariant" to colorScheme.outlineVariant.toCssValue(),
                "scrim" to colorScheme.scrim.toCssValue(),
                "surfaceBright" to colorScheme.surfaceBright.toCssValue(),
                "surfaceDim" to colorScheme.surfaceDim.toCssValue(),
                "surfaceContainer" to colorScheme.surfaceContainer.toCssValue(),
                "surfaceContainerHigh" to colorScheme.surfaceContainerHigh.toCssValue(),
                "surfaceContainerHighest" to colorScheme.surfaceContainerHighest.toCssValue(),
                "surfaceContainerLow" to colorScheme.surfaceContainerLow.toCssValue(),
                "surfaceContainerLowest" to colorScheme.surfaceContainerLowest.toCssValue(),
                "filledTonalButtonContentColor" to colorScheme.onPrimaryContainer.toCssValue(),
                "filledTonalButtonContainerColor" to colorScheme.secondaryContainer.toCssValue(),
                "filledTonalButtonDisabledContentColor" to colorScheme.onSurfaceVariant.toCssValue(),
                "filledTonalButtonDisabledContainerColor" to colorScheme.surfaceVariant.toCssValue(),
                "filledCardContentColor" to colorScheme.onPrimaryContainer.toCssValue(),
                "filledCardContainerColor" to colorScheme.primaryContainer.toCssValue(),
                "filledCardDisabledContentColor" to colorScheme.onSurfaceVariant.toCssValue(),
                "filledCardDisabledContainerColor" to colorScheme.surfaceVariant.toCssValue()
            )

            colorsCss.set(monetColors.toCssVars())
        }
    }

    private fun Map<String, String>.toCssVars(): String {
        return buildString {
            append(":root {\n")
            for ((k, v) in this@toCssVars) {
                append("  --$k: $v;\n")
            }
            append("}\n")
        }
    }

    private fun Color.toCssValue(): String {
        fun Float.toHex(): String {
            return (this * 255).toInt().coerceIn(0, 255).toString(16).padStart(2, '0')
        }
        return if (alpha == 1f) {
            "#${red.toHex()}${green.toHex()}${blue.toHex()}"
        } else {
            "#${red.toHex()}${green.toHex()}${blue.toHex()}${alpha.toHex()}"
        }
    }
}

```

`app/src/main/java/me/bmax/apatch/ui/webui/SuFilePathHandler.java`:

```java
package me.bmax.apatch.ui.webui;

import android.content.Context;
import android.util.Log;
import android.webkit.WebResourceResponse;

import androidx.annotation.NonNull;
import androidx.annotation.WorkerThread;
import androidx.webkit.WebViewAssetLoader;

import com.topjohnwu.superuser.Shell;
import com.topjohnwu.superuser.io.SuFile;
import com.topjohnwu.superuser.io.SuFileInputStream;

import java.io.ByteArrayInputStream;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStream;
import java.nio.charset.StandardCharsets;
import java.util.zip.GZIPInputStream;

import me.bmax.apatch.util.APatchCliKt;

/**
 * Handler class to open files from file system by root access
 * For more information about android storage please refer to
 * <a href="https://developer.android.com/guide/topics/data/data-storage">Android Developers
 * Docs: Data and file storage overview</a>.
 * <p class="note">
 * To avoid leaking user or app data to the web, make sure to choose {@code directory}
 * carefully, and assume any file under this directory could be accessed by any web page subject
 * to same-origin rules.
 * <p>
 * A typical usage would be like:
 * <pre class="prettyprint">
 * File publicDir = new File(context.getFilesDir(), "public");
 * // Host "files/public/" in app's data directory under:
 * // http://appassets.androidplatform.net/public/...
 * WebViewAssetLoader assetLoader = new WebViewAssetLoader.Builder()
 *          .addPathHandler("/public/", new InternalStoragePathHandler(context, publicDir))
 *          .build();
 * </pre>
 */
public final class SuFilePathHandler implements WebViewAssetLoader.PathHandler {
    private static final String TAG = "SuFilePathHandler";

    /**
     * Default value to be used as MIME type if guessing MIME type failed.
     */
    public static final String DEFAULT_MIME_TYPE = "text/plain";

    /**
     * Forbidden subdirectories of {@link Context#getDataDir} that cannot be exposed by this
     * handler. They are forbidden as they often contain sensitive information.
     * <p class="note">
     * Note: Any future addition to this list will be considered breaking changes to the API.
     */
    private static final String[] FORBIDDEN_DATA_DIRS =
            new String[] {"/data/data", "/data/system"};

    @NonNull
    private final File mDirectory;

    private final Shell mShell;
    private final InsetsSupplier mInsetsSupplier;
    @NonNull
    private final OnInsetsRequestedListener mOnInsetsRequestedListener;

    public interface InsetsSupplier {
        @NonNull
        Insets get();
    }

    public interface OnInsetsRequestedListener {
        void onInsetsRequested(boolean enable);
    }

    /**
     * Creates PathHandler for app's internal storage.
     * The directory to be exposed must be inside either the application's internal data
     * directory {@link Context#getDataDir} or cache directory {@link Context#getCacheDir}.
     * External storage is not supported for security reasons, as other apps with
     * {@link android.Manifest.permission#WRITE_EXTERNAL_STORAGE} may be able to modify the
     * files.
     * <p>
     * Exposing the entire data or cache directory is not permitted, to avoid accidentally
     * exposing sensitive application files to the web. Certain existing subdirectories of
     * {@link Context#getDataDir} are also not permitted as they are often sensitive.
     * These files are ({@code "app_webview/"}, {@code "databases/"}, {@code "lib/"},
     * {@code "shared_prefs/"} and {@code "code_cache/"}).
     * <p>
     * The application should typically use a dedicated subdirectory for the files it intends to
     * expose and keep them separate from other files.
     *
     * @param context {@link Context} that is used to access app's internal storage.
     * @param directory the absolute path of the exposed app internal storage directory from
     *                  which files can be loaded.
     * @param insetsSupplier {@link InsetsSupplier} to provide window insets for styling web content.
     * @param onInsetsRequestedListener {@link OnInsetsRequestedListener} to notify when insets are requested.
     * @throws IllegalArgumentException if the directory is not allowed.
     */
    public SuFilePathHandler(@NonNull Context context, @NonNull File directory, @NonNull InsetsSupplier insetsSupplier, @NonNull OnInsetsRequestedListener onInsetsRequestedListener) {
        try {
            mInsetsSupplier = insetsSupplier;
            mOnInsetsRequestedListener = onInsetsRequestedListener;
            mDirectory = new File(getCanonicalDirPath(directory));
            if (!isAllowedInternalStorageDir(context)) {
                throw new IllegalArgumentException("The given directory \"" + directory
                        + "\" doesn't exist under an allowed app internal storage directory");
            }
            mShell = APatchCliKt.createRootShell(true);
        } catch (IOException e) {
            throw new IllegalArgumentException(
                    "Failed to resolve the canonical path for the given directory: "
                            + directory.getPath(), e);
        }
    }

    private boolean isAllowedInternalStorageDir(@NonNull Context context) throws IOException {
        String dir = getCanonicalDirPath(mDirectory);

        for (String forbiddenPath : FORBIDDEN_DATA_DIRS) {
            if (dir.startsWith(forbiddenPath)) {
                return false;
            }
        }
        return true;
    }

    /**
     * Opens the requested file from the exposed data directory.
     * <p>
     * The matched prefix path used shouldn't be a prefix of a real web path. Thus, if the
     * requested file cannot be found or is outside the mounted directory a
     * {@link WebResourceResponse} object with a {@code null} {@link InputStream} will be
     * returned instead of {@code null}. This saves the time of falling back to network and
     * trying to resolve a path that doesn't exist. A {@link WebResourceResponse} with
     * {@code null} {@link InputStream} will be received as an HTTP response with status code
     * {@code 404} and no body.
     * <p class="note">
     * The MIME type for the file will be determined from the file's extension using
     * {@link java.net.URLConnection#guessContentTypeFromName}. Developers should ensure that
     * files are named using standard file extensions. If the file does not have a
     * recognised extension, {@code "text/plain"} will be used by default.
     *
     * @param path the suffix path to be handled.
     * @return {@link WebResourceResponse} for the requested file.
     */
    @Override
    @WorkerThread
    @NonNull
    public WebResourceResponse handle(@NonNull String path) {
        if ("internal/insets.css".equals(path)) {
            mOnInsetsRequestedListener.onInsetsRequested(true);
            String css = mInsetsSupplier.get().getCss();
            return new WebResourceResponse(
                    "text/css",
                    "utf-8",
                    new ByteArrayInputStream(css.getBytes(StandardCharsets.UTF_8))
            );
        }
        if ("internal/colors.css".equals(path)) {
            String css = MonetColorsProvider.INSTANCE.getColorsCss();
            return new WebResourceResponse(
                    "text/css",
                    "utf-8",
                    new ByteArrayInputStream(css.getBytes(StandardCharsets.UTF_8))
            );
        }
        try {
            File file = getCanonicalFileIfChild(mDirectory, path);
            if (file != null) {
                InputStream is = openFile(file, mShell);
                String mimeType = guessMimeType(path);
                return new WebResourceResponse(mimeType, null, is);
            } else {
                Log.e(TAG, String.format(
                        "The requested file: %s is outside the mounted directory: %s", path,
                        mDirectory));
            }
        } catch (IOException e) {
            Log.e(TAG, "Error opening the requested path: " + path, e);
        }
        return new WebResourceResponse(null, null, null);
    }

    public static String getCanonicalDirPath(@NonNull File file) throws IOException {
        String canonicalPath = file.getCanonicalPath();
        if (!canonicalPath.endsWith("/")) canonicalPath += "/";
        return canonicalPath;
    }

    public static File getCanonicalFileIfChild(@NonNull File parent, @NonNull String child)
            throws IOException {
        String parentCanonicalPath = getCanonicalDirPath(parent);
        String childCanonicalPath = new File(parent, child).getCanonicalPath();
        if (childCanonicalPath.startsWith(parentCanonicalPath)) {
            return new File(childCanonicalPath);
        }
        return null;
    }

    @NonNull
    private static InputStream handleSvgzStream(@NonNull String path,
                                                @NonNull InputStream stream) throws IOException {
        return path.endsWith(".svgz") ? new GZIPInputStream(stream) : stream;
    }

    public static InputStream openFile(@NonNull File file, @NonNull Shell shell) throws FileNotFoundException,
            IOException {
        SuFile suFile = new SuFile(file.getAbsolutePath());
        suFile.setShell(shell);
        InputStream fis = SuFileInputStream.open(suFile);
        return handleSvgzStream(file.getPath(), fis);
    }

    /**
     * Use {@link MimeUtil#getMimeFromFileName} to guess MIME type or return the
     * {@link #DEFAULT_MIME_TYPE} if it can't guess.
     *
     * @param filePath path of the file to guess its MIME type.
     * @return MIME type guessed from file extension or {@link #DEFAULT_MIME_TYPE}.
     */
    @NonNull
    public static String guessMimeType(@NonNull String filePath) {
        String mimeType = MimeUtil.getMimeFromFileName(filePath);
        return mimeType == null ? DEFAULT_MIME_TYPE : mimeType;
    }
}
```

`app/src/main/java/me/bmax/apatch/ui/webui/WebViewInterface.kt`:

```kt
package me.bmax.apatch.ui.webui

import android.app.Activity
import android.content.Context
import android.content.pm.ApplicationInfo
import android.os.Handler
import android.os.Looper
import android.text.TextUtils
import android.view.Window
import android.webkit.JavascriptInterface
import android.webkit.WebView
import android.widget.Toast
import androidx.core.content.pm.PackageInfoCompat
import androidx.core.view.WindowInsetsCompat
import androidx.core.view.WindowInsetsControllerCompat
import com.topjohnwu.superuser.CallbackList
import com.topjohnwu.superuser.ShellUtils
import com.topjohnwu.superuser.internal.UiThreadHandler
import me.bmax.apatch.ui.WebUIActivity
import me.bmax.apatch.ui.viewmodel.SuperUserViewModel
import me.bmax.apatch.util.createRootShell
import org.json.JSONArray
import org.json.JSONObject
import java.util.concurrent.CompletableFuture

class WebViewInterface(val context: Context, private val webView: WebView) {
    @JavascriptInterface
    fun exec(cmd: String): String {
        val shell = createRootShell()
        return ShellUtils.fastCmd(shell, cmd)
    }

    @JavascriptInterface
    fun exec(cmd: String, callbackFunc: String) {
        exec(cmd, null, callbackFunc)
    }

    private fun processOptions(sb: StringBuilder, options: String?) {
        val opts = if (options == null) JSONObject() else {
            JSONObject(options)
        }

        val cwd = opts.optString("cwd")
        if (!TextUtils.isEmpty(cwd)) {
            sb.append("cd ${cwd};")
        }

        opts.optJSONObject("env")?.let { env ->
            env.keys().forEach { key ->
                sb.append("export ${key}=${env.getString(key)};")
            }
        }
    }

    @JavascriptInterface
    fun exec(
        cmd: String, options: String?, callbackFunc: String
    ) {
        val finalCommand = StringBuilder()
        processOptions(finalCommand, options)
        finalCommand.append(cmd)

        val shell = createRootShell()
        val result = shell.newJob().add(finalCommand.toString()).to(ArrayList(), ArrayList()).exec()
        val stdout = result.out.joinToString(separator = "\n")
        val stderr = result.err.joinToString(separator = "\n")

        val jsCode = "javascript: (function() { try { ${callbackFunc}(${result.code}, ${
            JSONObject.quote(
                stdout
            )
        }, ${JSONObject.quote(stderr)}); } catch(e) { console.error(e); } })();"
        webView.post {
            webView.loadUrl(jsCode)
        }
    }

    @JavascriptInterface
    fun spawn(command: String, args: String, options: String?, callbackFunc: String) {
        val finalCommand = StringBuilder()

        processOptions(finalCommand, options)

        if (!TextUtils.isEmpty(args)) {
            finalCommand.append(command).append(" ")
            JSONArray(args).let { argsArray ->
                for (i in 0 until argsArray.length()) {
                    finalCommand.append(argsArray.getString(i))
                    finalCommand.append(" ")
                }
            }
        } else {
            finalCommand.append(command)
        }

        val shell = createRootShell()

        val emitData = fun(name: String, data: String) {
            val jsCode = "javascript: (function() { try { ${callbackFunc}.${name}.emit('data', ${
                JSONObject.quote(
                    data
                )
            }); } catch(e) { console.error('emitData', e); } })();"
            webView.post {
                webView.loadUrl(jsCode)
            }
        }

        val stdout = object : CallbackList<String>(UiThreadHandler::runAndWait) {
            override fun onAddElement(s: String) {
                emitData("stdout", s)
            }
        }

        val stderr = object : CallbackList<String>(UiThreadHandler::runAndWait) {
            override fun onAddElement(s: String) {
                emitData("stderr", s)
            }
        }

        val future = shell.newJob().add(finalCommand.toString()).to(stdout, stderr).enqueue()
        val completableFuture = CompletableFuture.supplyAsync {
            future.get()
        }

        completableFuture.thenAccept { result ->
            val emitExitCode =
                "javascript: (function() { try { ${callbackFunc}.emit('exit', ${result.code}); } catch(e) { console.error(`emitExit error: \${e}`); } })();"
            webView.post {
                webView.loadUrl(emitExitCode)
            }

            if (result.code != 0) {
                val emitErrCode =
                    "javascript: (function() { try { var err = new Error(); err.exitCode = ${result.code}; err.message = ${
                        JSONObject.quote(
                            result.err.joinToString(
                                "\n"
                            )
                        )
                    };${callbackFunc}.emit('error', err); } catch(e) { console.error('emitErr', e); } })();"
                webView.post {
                    webView.loadUrl(emitErrCode)
                }
            }
        }
    }

    @JavascriptInterface
    fun toast(msg: String) {
        webView.post {
            Toast.makeText(context, msg, Toast.LENGTH_SHORT).show()
        }
    }

    @JavascriptInterface
    fun fullScreen(enable: Boolean) {
        if (context is Activity) {
            Handler(Looper.getMainLooper()).post {
                if (enable) {
                    hideSystemUI(context.window)
                } else {
                    showSystemUI(context.window)
                }
            }
        }
        enableInsets(enable)
    }

    @JavascriptInterface
    fun enableInsets(enable: Boolean = true) {
        if (context is WebUIActivity) {
            context.enableInsets(enable)
        }
    }

    @JavascriptInterface
    fun listPackages(type: String): String {
        val packageNames = SuperUserViewModel.apps
            .filter { appInfo ->
                val flags = appInfo.packageInfo.applicationInfo?.flags ?: 0
                when (type.lowercase()) {
                    "system" -> (flags and ApplicationInfo.FLAG_SYSTEM) != 0
                    "user" -> (flags and ApplicationInfo.FLAG_SYSTEM) == 0
                    else -> true
                }
            }
            .map { it.packageName }
            .sorted()

        val jsonArray = JSONArray()
        for (pkgName in packageNames) {
            jsonArray.put(pkgName)
        }
        return jsonArray.toString()
    }

    @JavascriptInterface
    fun getPackagesInfo(packageNamesJson: String): String {
        val packageNames = JSONArray(packageNamesJson)
        val jsonArray = JSONArray()
        val appMap = SuperUserViewModel.apps.associateBy { it.packageName }
        for (i in 0 until packageNames.length()) {
            val pkgName = packageNames.getString(i)
            val appInfo = appMap[pkgName]
            if (appInfo != null) {
                val pkg = appInfo.packageInfo
                val app = pkg.applicationInfo
                val obj = JSONObject()
                obj.put("packageName", pkg.packageName)
                obj.put("versionName", pkg.versionName ?: "")
                obj.put("versionCode", PackageInfoCompat.getLongVersionCode(pkg))
                obj.put("appLabel", appInfo.label)
                obj.put("isSystem", if (app != null) ((app.flags and ApplicationInfo.FLAG_SYSTEM) != 0) else JSONObject.NULL)
                obj.put("uid", app?.uid ?: JSONObject.NULL)
                jsonArray.put(obj)
            } else {
                val obj = JSONObject()
                obj.put("packageName", pkgName)
                obj.put("error", "Package not found or inaccessible")
                jsonArray.put(obj)
            }
        }
        return jsonArray.toString()
    }
}

fun hideSystemUI(window: Window) {
    WindowInsetsControllerCompat(window, window.decorView).let { controller ->
        controller.hide(WindowInsetsCompat.Type.systemBars())
        controller.systemBarsBehavior = WindowInsetsControllerCompat.BEHAVIOR_SHOW_TRANSIENT_BARS_BY_SWIPE
    }
}

fun showSystemUI(window: Window) =
    WindowInsetsControllerCompat(window, window.decorView).show(WindowInsetsCompat.Type.systemBars())
```

`app/src/main/java/me/bmax/apatch/util/APatchCli.kt`:

```kt
package me.bmax.apatch.util

import android.content.ContentResolver
import android.content.Context
import android.content.pm.PackageManager
import android.content.pm.Signature
import android.database.Cursor
import android.net.Uri
import android.os.Build
import android.provider.OpenableColumns
import android.util.Base64
import android.util.Log
import com.topjohnwu.superuser.CallbackList
import com.topjohnwu.superuser.Shell
import com.topjohnwu.superuser.ShellUtils
import com.topjohnwu.superuser.internal.MainShell
import com.topjohnwu.superuser.io.SuFile
import me.bmax.apatch.APApplication
import me.bmax.apatch.APApplication.Companion.SUPERCMD
import me.bmax.apatch.BuildConfig
import me.bmax.apatch.apApp
import me.bmax.apatch.ui.screen.MODULE_TYPE
import java.io.File
import java.security.MessageDigest
import java.security.cert.CertificateFactory
import java.security.cert.X509Certificate
import java.util.Properties
import java.util.zip.ZipFile

private const val TAG = "APatchCli"

private fun getKPatchPath(): String {
    return apApp.applicationInfo.nativeLibraryDir + File.separator + "libkpatch.so"
}

class RootShellInitializer : Shell.Initializer() {
    override fun onInit(context: Context, shell: Shell): Boolean {
        shell.newJob().add("export PATH=\$PATH:/system_ext/bin:/vendor/bin").exec()
        return true
    }
}

fun createRootShell(globalMnt: Boolean = false): Shell {
    Shell.enableVerboseLogging = BuildConfig.DEBUG
    val builder = Shell.Builder.create().setInitializers(RootShellInitializer::class.java)
    return try {
        builder.build(
            SUPERCMD, APApplication.superKey, "-Z", APApplication.MAGISK_SCONTEXT
        )
    } catch (e: Throwable) {
        Log.e(TAG, "su failed: ", e)
        return try {
            Log.e(TAG, "retry compat kpatch su")
            if (globalMnt) {
                builder.build(
                    getKPatchPath(), APApplication.superKey, "su", "-Z", APApplication.MAGISK_SCONTEXT, "--mount-master"
                )
            }else{
                builder.build(
                    getKPatchPath(), APApplication.superKey, "su", "-Z", APApplication.MAGISK_SCONTEXT
                )
            }
        } catch (e: Throwable) {
            Log.e(TAG, "retry kpatch su failed: ", e)
            return try {
                Log.e(TAG, "retry su: ", e)
                if (globalMnt) {
                    builder.build("su","-mm")
                }else{
                    builder.build("su")
                }
            } catch (e: Throwable) {
                Log.e(TAG, "retry su failed: ", e)
                return builder.build("sh")
            }
        }
    }
}

private fun createMainRootShell() : Shell {
    val builder = Shell.Builder.create()
        .setInitializers(RootShellInitializer::class.java)
        .setCommands(SUPERCMD, APApplication.superKey, "-Z", APApplication.MAGISK_SCONTEXT)
    val shell = try {
        builder.build()
    } catch (e: Throwable) {
        Log.e(TAG, "su failed: ", e)
        builder.setCommands(getKPatchPath(), APApplication.superKey, "su", "-Z", APApplication.MAGISK_SCONTEXT)
        try {
            builder.build()
        } catch (e: Throwable) {
            Log.e(TAG, "retry kpatch su failed: ", e)
            builder.setCommands("su")
            try {
                builder.build()
            } catch (e: Throwable) {
                Log.e(TAG, "retry su failed: ", e)
                builder.setCommands("sh")
                builder.build()
            }
        }
    }

    MainShell.setBuilder(builder)
    return shell
}

object APatchCli {
    var SHELL: Shell = createMainRootShell()
    val GLOBAL_MNT_SHELL: Shell = createRootShell(true)
    fun refresh() {
        val tmp = SHELL

        val clazz = MainShell::class.java // reset MainShell
        clazz.getDeclaredField("isInitMain").apply {
            isAccessible = true
            setBoolean(null, false)
            isAccessible = false
        }

        clazz.getDeclaredField("mainShell").apply {
            isAccessible = true
            @Suppress("UNCHECKED_CAST")
            val arr = get(null) as Array<Any?>
            arr[0] = null
            isAccessible = false
        }

        clazz.getDeclaredField("mainBuilder").apply {
            isAccessible = true
            set(null, null)
            isAccessible = false
        }

        SHELL = createMainRootShell()
        tmp.close()
    }
}

fun getRootShell(globalMnt: Boolean = false): Shell {

    return if (globalMnt) APatchCli.GLOBAL_MNT_SHELL else {
        APatchCli.SHELL
    }
}

inline fun <T> withNewRootShell(
    globalMnt: Boolean = false,
    block: Shell.() -> T
): T {
    return createRootShell(globalMnt).use(block)
}

fun rootAvailable(): Boolean {
    val shell = getRootShell()
    return shell.isRoot
}

fun tryGetRootShell(): Shell {
    Shell.enableVerboseLogging = BuildConfig.DEBUG
    val builder = Shell.Builder.create()
    return try {
        builder.build(
            SUPERCMD, APApplication.superKey, "-Z", APApplication.MAGISK_SCONTEXT
        )
    } catch (e: Throwable) {
        Log.e(TAG, "su failed: ", e)
        return try {
            Log.e(TAG, "retry compat kpatch su")
            builder.build(
                getKPatchPath(), APApplication.superKey, "su", "-Z", APApplication.MAGISK_SCONTEXT
            )
        } catch (e: Throwable) {
            Log.e(TAG, "retry kpatch su failed: ", e)
            return try {
                Log.e(TAG, "retry su: ", e)
                builder.build("su")
            } catch (e: Throwable) {
                Log.e(TAG, "retry su failed: ", e)
                builder.build("sh")
            }
        }
    }
}

fun shellForResult(shell: Shell, vararg cmds: String): Shell.Result {
    val out = ArrayList<String>()
    val err = ArrayList<String>()
    return shell.newJob().add(*cmds).to(out, err).exec()
}

fun rootShellForResult(vararg cmds: String): Shell.Result {
    val out = ArrayList<String>()
    val err = ArrayList<String>()
    return getRootShell().newJob().add(*cmds).to(out, err).exec()
}

fun execApd(args: String, newShell: Boolean = false): Boolean {
    return if (newShell) {
        withNewRootShell {
            ShellUtils.fastCmdResult(this, "${APApplication.APD_PATH} $args")
        }
    } else {
        ShellUtils.fastCmdResult(getRootShell(), "${APApplication.APD_PATH} $args")
    }
}

fun listModules(): String {
    val shell = getRootShell()
    val out =
        shell.newJob().add("${APApplication.APD_PATH} module list").to(ArrayList(), null).exec().out
    withNewRootShell{
       newJob().add("cp /data/user/*/me.bmax.apatch/patch/ori.img /data/adb/ap/ && rm /data/user/*/me.bmax.apatch/patch/ori.img")
       .to(ArrayList(),null).exec()
   }
    return out.joinToString("\n").ifBlank { "[]" }
}

fun hasMetaModule(): Boolean {
    return getMetaModuleImplement() != "None"
}

fun getMetaModuleImplement(): String {
    try {
        val metaModuleProp = SuFile.open("/data/adb/metamodule/module.prop")
        if (!metaModuleProp.isFile) {
            Log.i(TAG, "Meta module implement: None")
            return "None"
        }

        val prop = Properties()
        prop.load(metaModuleProp.newInputStream())

        val name = prop.getProperty("name")
        Log.i(TAG, "Meta module implement: $name")
        return name
    } catch (t : Throwable) {
        Log.i(TAG, "Meta module implement: None")
        return "None"
    }
}

fun toggleModule(id: String, enable: Boolean): Boolean {
    val cmd = if (enable) {
        "module enable $id"
    } else {
        "module disable $id"
    }
    val result = execApd(cmd,true)
    Log.i(TAG, "$cmd result: $result")
    return result
}

fun uninstallModule(id: String): Boolean {
    val cmd = "module uninstall $id"
    val result = execApd(cmd,true)
    Log.i(TAG, "uninstall module $id result: $result")
    return result
}

fun installModule(
    uri: Uri, type: MODULE_TYPE, onFinish: (Boolean) -> Unit, onStdout: (String) -> Unit, onStderr: (String) -> Unit
): Boolean {
    val resolver = apApp.contentResolver
    with(resolver.openInputStream(uri)) {
        val file = File(apApp.cacheDir, "module_$type.zip")
        file.outputStream().use { output ->
            this?.copyTo(output)
        }

        val stdoutCallback: CallbackList<String?> = object : CallbackList<String?>() {
            override fun onAddElement(s: String?) {
                onStdout(s ?: "")
            }
        }

        val stderrCallback: CallbackList<String?> = object : CallbackList<String?>() {
            override fun onAddElement(s: String?) {
                onStderr(s ?: "")
            }
        }

        val shell = getRootShell()

        var result = false
        if(type == MODULE_TYPE.APM) {
            val cmd = "${APApplication.APD_PATH} module install ${file.absolutePath}"
            result = shell.newJob().add(cmd).to(stdoutCallback, stderrCallback)
                    .exec().isSuccess
        } else {
//            ZipUtils.
        }

        Log.i(TAG, "install $type module $uri result: $result")

        file.delete()

        onFinish(result)
        return result
    }
}

fun runAPModuleAction(
    moduleId: String, onStdout: (String) -> Unit, onStderr: (String) -> Unit
): Boolean {
    val stdoutCallback: CallbackList<String?> = object : CallbackList<String?>() {
        override fun onAddElement(s: String?) {
            onStdout(s ?: "")
        }
    }

    val stderrCallback: CallbackList<String?> = object : CallbackList<String?>() {
        override fun onAddElement(s: String?) {
            onStderr(s ?: "")
        }
    }

    val result = withNewRootShell{ 
        newJob().add("${APApplication.APD_PATH} module action $moduleId")
        .to(stdoutCallback, stderrCallback).exec()
    }
    Log.i(TAG, "APModule runAction result: $result")

    return result.isSuccess
}

fun reboot(reason: String = "") {
    if (reason == "recovery") {
        // KEYCODE_POWER = 26, hide incorrect "Factory data reset" message
        getRootShell().newJob().add("/system/bin/input keyevent 26").exec()
    }
    getRootShell().newJob()
        .add("/system/bin/svc power reboot $reason || /system/bin/reboot $reason").exec()
}

fun hasMagisk(): Boolean {
    val shell = getRootShell()
    val result = shell.newJob().add("nsenter --mount=/proc/1/ns/mnt which magisk").exec()
    Log.i(TAG, "has magisk: ${result.isSuccess}")
    return result.isSuccess
}

fun isGlobalNamespaceEnabled(): Boolean {
    val shell = getRootShell()
    val result = ShellUtils.fastCmd(shell, "cat ${APApplication.GLOBAL_NAMESPACE_FILE}")
    Log.i(TAG, "is global namespace enabled: $result")
    return result == "1"
}

fun setGlobalNamespaceEnabled(value: String) {
    getRootShell().newJob().add("echo $value > ${APApplication.GLOBAL_NAMESPACE_FILE}")
        .submit { result ->
            Log.i(TAG, "setGlobalNamespaceEnabled result: ${result.isSuccess} [${result.out}]")
        }
}

fun getFileNameFromUri(context: Context, uri: Uri): String? {
    var fileName: String? = null
    val contentResolver: ContentResolver = context.contentResolver
    val cursor: Cursor? = contentResolver.query(uri, null, null, null, null)
    cursor?.use {
        if (it.moveToFirst()) {
            fileName = it.getString(it.getColumnIndexOrThrow(OpenableColumns.DISPLAY_NAME))
        }
    }
    return fileName
}

@Suppress("DEPRECATION")
private fun signatureFromAPI(context: Context): ByteArray? {
    return try {
        val packageInfo = if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.P) {
            context.packageManager.getPackageInfo(
                context.packageName, PackageManager.GET_SIGNING_CERTIFICATES
            )
        } else {
            context.packageManager.getPackageInfo(
                context.packageName,
                PackageManager.GET_SIGNATURES
            )
        }

        val signatures: Array<out Signature>? =
            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.P) {
                packageInfo.signingInfo?.apkContentsSigners
            } else {
                packageInfo.signatures
            }

        signatures?.firstOrNull()?.toByteArray()
    } catch (e: Exception) {
        e.printStackTrace()
        null
    }
}

private fun signatureFromAPK(context: Context): ByteArray? {
    var signatureBytes: ByteArray? = null
    try {
        ZipFile(context.packageResourcePath).use { zipFile ->
            val entries = zipFile.entries()
            while (entries.hasMoreElements() && signatureBytes == null) {
                val entry = entries.nextElement()
                if (entry.name.matches("(META-INF/.*)\\.(RSA|DSA|EC)".toRegex())) {
                    zipFile.getInputStream(entry).use { inputStream ->
                        val certFactory = CertificateFactory.getInstance("X509")
                        val x509Cert =
                            certFactory.generateCertificate(inputStream) as X509Certificate
                        signatureBytes = x509Cert.encoded
                    }
                }
            }
        }
    } catch (e: Exception) {
        e.printStackTrace()
    }
    return signatureBytes
}

private fun validateSignature(signatureBytes: ByteArray?, validSignature: String): Boolean {
    signatureBytes ?: return false
    val digest = MessageDigest.getInstance("SHA-256")
    val signatureHash = Base64.encodeToString(digest.digest(signatureBytes), Base64.NO_WRAP)
    return signatureHash == validSignature
}

fun verifyAppSignature(validSignature: String): Boolean {
    val context = apApp.applicationContext
    val apkSignature = signatureFromAPK(context)
    val apiSignature = signatureFromAPI(context)

    return validateSignature(apiSignature, validSignature) && validateSignature(
        apkSignature,
        validSignature
    )
}

```

`app/src/main/java/me/bmax/apatch/util/APatchKeyHelper.java`:

```java
package me.bmax.apatch.util;

import android.content.SharedPreferences;
import android.security.keystore.KeyGenParameterSpec;
import android.security.keystore.KeyProperties;
import android.util.Base64;
import android.util.Log;

import java.nio.charset.StandardCharsets;
import java.security.KeyStore;
import java.security.SecureRandom;
import java.security.spec.AlgorithmParameterSpec;

import javax.crypto.Cipher;
import javax.crypto.KeyGenerator;
import javax.crypto.SecretKey;
import javax.crypto.spec.GCMParameterSpec;


public class APatchKeyHelper {
    protected static final String SUPER_KEY = "super_key";
    protected static final String SUPER_KEY_ENC = "super_key_enc";
    private static final String TAG = "APatchSecurityHelper";
    private static final String ANDROID_KEYSTORE = "AndroidKeyStore";
    private static final String SKIP_STORE_SUPER_KEY = "skip_store_super_key";
    private static final String SUPER_KEY_IV = "super_key_iv";
    private static final String KEY_ALIAS = "APatchSecurityKey";
    private static final String ENCRYPT_MODE = "AES/GCM/NoPadding";
    private static SharedPreferences prefs = null;

    static {
        try {
            KeyStore keyStore = KeyStore.getInstance(ANDROID_KEYSTORE);
            keyStore.load(null);
            if (!keyStore.containsAlias(KEY_ALIAS)) {
                generateSecretKey();
            }
        } catch (Exception e) {
            Log.e(TAG, "Failed to checkAndGenerateSecretKey", e);
        }
    }

    public static void setSharedPreferences(SharedPreferences sp) {
        prefs = sp;
    }

    private static void generateSecretKey() {
        try {
            KeyStore keyStore = KeyStore.getInstance(ANDROID_KEYSTORE);
            keyStore.load(null);

            if (!keyStore.containsAlias(KEY_ALIAS)) {
                KeyGenerator keyGenerator = KeyGenerator.getInstance(
                        KeyProperties.KEY_ALGORITHM_AES, ANDROID_KEYSTORE);

                AlgorithmParameterSpec spec = new KeyGenParameterSpec.Builder(
                        KEY_ALIAS,
                        KeyProperties.PURPOSE_ENCRYPT | KeyProperties.PURPOSE_DECRYPT)
                        .setBlockModes(KeyProperties.BLOCK_MODE_GCM)
                        .setEncryptionPaddings(KeyProperties.ENCRYPTION_PADDING_NONE)
                        .setRandomizedEncryptionRequired(false)
                        .build();

                keyGenerator.init(spec);
                keyGenerator.generateKey();
            }
        } catch (Exception e) {
            Log.e(TAG, "Failed to generateSecretKey", e);
        }
    }

    private static String getRandomIV() {
        String randIV = prefs.getString(SUPER_KEY_IV, null);
        if (randIV == null) {
            SecureRandom secureRandom = new SecureRandom();
            byte[] generated = secureRandom.generateSeed(12);
            randIV = Base64.encodeToString(generated, Base64.DEFAULT);
            prefs.edit().putString(SUPER_KEY_IV, randIV).apply();
        }
        return randIV;
    }

    private static String encrypt(String orig) {
        try {
            KeyStore keyStore = KeyStore.getInstance(ANDROID_KEYSTORE);
            keyStore.load(null);
            SecretKey secretKey = (SecretKey) keyStore.getKey(KEY_ALIAS, null);

            Cipher cipher = Cipher.getInstance(ENCRYPT_MODE);
            cipher.init(Cipher.ENCRYPT_MODE, secretKey, new GCMParameterSpec(128, Base64.decode(getRandomIV(), Base64.DEFAULT)));

            return Base64.encodeToString(cipher.doFinal(orig.getBytes(StandardCharsets.UTF_8)), Base64.DEFAULT);
        } catch (Exception e) {
            Log.e(TAG, "Failed to encrypt: ", e);
            return null;
        }
    }

    private static String decrypt(String encryptedData) {
        try {
            KeyStore keyStore = KeyStore.getInstance(ANDROID_KEYSTORE);
            keyStore.load(null);
            SecretKey secretKey = (SecretKey) keyStore.getKey(KEY_ALIAS, null);

            Cipher cipher = Cipher.getInstance(ENCRYPT_MODE);
            cipher.init(Cipher.DECRYPT_MODE, secretKey, new GCMParameterSpec(128, Base64.decode(getRandomIV(), Base64.DEFAULT)));

            return new String(cipher.doFinal(Base64.decode(encryptedData, Base64.DEFAULT)), StandardCharsets.UTF_8);
        } catch (Exception e) {
            Log.e(TAG, "Failed to decrypt", e);
            return null;
        }
    }

    public static boolean shouldSkipStoreSuperKey() {
        return prefs.getInt(SKIP_STORE_SUPER_KEY, 0) != 0;
    }

    public static void clearConfigKey() {
        prefs.edit().remove(SUPER_KEY).apply();
        prefs.edit().remove(SUPER_KEY_ENC).apply();
        prefs.edit().remove(SUPER_KEY_IV).apply();
    }

    public static void setShouldSkipStoreSuperKey(boolean should) {
        clearConfigKey();
        prefs.edit().putInt(SKIP_STORE_SUPER_KEY, should ? 1 : 0).apply();
    }

    public static String readSPSuperKey() {
        String encKey = prefs.getString(SUPER_KEY_ENC, "");
        if (!encKey.isEmpty()) {
            return decrypt(encKey);
        }

        @Deprecated()
        String key = prefs.getString(SUPER_KEY, "");
        writeSPSuperKey(key);
        prefs.edit().remove(SUPER_KEY).apply();
        return key;
    }

    public static void writeSPSuperKey(String key) {
        if (shouldSkipStoreSuperKey()) return;
        key = APatchKeyHelper.encrypt(key);
        prefs.edit().putString(SUPER_KEY_ENC, key).apply();
    }

}

```

`app/src/main/java/me/bmax/apatch/util/DeviceInfoUtils.kt`:

```kt
package me.bmax.apatch.util

import android.util.Log
import androidx.compose.runtime.Composable
import androidx.compose.ui.res.stringResource
import com.topjohnwu.superuser.Shell
import me.bmax.apatch.R

@Composable
fun getSELinuxStatus(): String {
    val shell = Shell.Builder.create()
        .build("sh")

    val list = ArrayList<String>()
    val result = shell.newJob().add("getenforce").to(list, list).exec()
    val output = result.out.joinToString("\n").trim()

    if (result.isSuccess) {
        return when (output) {
            "Enforcing" -> stringResource(R.string.home_selinux_status_enforcing)
            "Permissive" -> stringResource(R.string.home_selinux_status_permissive)
            "Disabled" -> stringResource(R.string.home_selinux_status_disabled)
            else -> stringResource(R.string.home_selinux_status_unknown)
        }
    }

    return if (output.endsWith("Permission denied")) {
        stringResource(R.string.home_selinux_status_enforcing)
    } else {
        stringResource(R.string.home_selinux_status_unknown)
    }
}

private fun getSystemProperty(key: String): Boolean {
    try {
        val c = Class.forName("android.os.SystemProperties")
        val get = c.getMethod(
            "getBoolean",
            String::class.java,
            Boolean::class.javaPrimitiveType
        )
        return get.invoke(c, key, false) as Boolean
    } catch (e: Exception) {
        Log.e("APatch", "[DeviceUtils] Failed to get system property: ", e)
    }
    return false
}

// Check to see if device supports A/B (seamless) system updates
fun isABDevice(): Boolean {
    return getSystemProperty("ro.build.ab_update")
}
```

`app/src/main/java/me/bmax/apatch/util/Downloader.kt`:

```kt
package me.bmax.apatch.util

import android.annotation.SuppressLint
import android.app.DownloadManager
import android.content.BroadcastReceiver
import android.content.Context
import android.content.Intent
import android.content.IntentFilter
import android.net.Uri
import android.os.Build
import android.os.Environment
import androidx.compose.runtime.Composable
import androidx.compose.runtime.DisposableEffect
import me.bmax.apatch.apApp
import androidx.core.content.ContextCompat

@SuppressLint("Range")
fun download(
    context: Context,
    url: String,
    fileName: String,
    description: String,
    onDownloaded: (Uri) -> Unit = {},
    onDownloading: () -> Unit = {}
) {
    val downloadManager = context.getSystemService(Context.DOWNLOAD_SERVICE) as DownloadManager

    val query = DownloadManager.Query()
    query.setFilterByStatus(DownloadManager.STATUS_RUNNING or DownloadManager.STATUS_PAUSED or DownloadManager.STATUS_PENDING)
    downloadManager.query(query).use { cursor ->
        while (cursor.moveToNext()) {
            val uri = cursor.getString(cursor.getColumnIndex(DownloadManager.COLUMN_URI))
            val localUri = cursor.getString(cursor.getColumnIndex(DownloadManager.COLUMN_LOCAL_URI))
            val status = cursor.getInt(cursor.getColumnIndex(DownloadManager.COLUMN_STATUS))
            val columnTitle = cursor.getString(cursor.getColumnIndex(DownloadManager.COLUMN_TITLE))
            if (url == uri || fileName == columnTitle) {
                if (status == DownloadManager.STATUS_RUNNING || status == DownloadManager.STATUS_PENDING) {
                    onDownloading()
                    return
                } else if (status == DownloadManager.STATUS_SUCCESSFUL) {
                    onDownloaded(Uri.parse(localUri))
                    return
                }
            }
        }
    }

    val request = DownloadManager.Request(Uri.parse(url)).setDestinationInExternalPublicDir(
        Environment.DIRECTORY_DOWNLOADS, fileName
    ).setNotificationVisibility(DownloadManager.Request.VISIBILITY_VISIBLE_NOTIFY_COMPLETED)
        .setMimeType("application/zip").setTitle(fileName).setDescription(description)

    downloadManager.enqueue(request)
}

fun checkNewVersion(): LatestVersionInfo {
    val url = "https://api.github.com/repos/bmax121/APatch/releases/latest"
    val defaultValue = LatestVersionInfo()
    runCatching {
        apApp.okhttpClient.newCall(okhttp3.Request.Builder().url(url).build()).execute()
            .use { response ->
                if (!response.isSuccessful) {
                    return defaultValue
                }
                val body = response.body?.string() ?: return defaultValue

                val json = org.json.JSONObject(body)
                val changelog = json.optString("body")
                val versionCode = json.getInt("name")

                val assets = json.getJSONArray("assets")
                for (i in 0 until assets.length()) {
                    val asset = assets.getJSONObject(i)
                    val name = asset.getString("name")
                    if (!name.endsWith(".apk")) {
                        continue
                    }
                    val downloadUrl = asset.getString("browser_download_url")

                    return LatestVersionInfo(
                        versionCode, downloadUrl, changelog
                    )
                }
            }
    }
    return defaultValue
}

@Composable
fun DownloadListener(context: Context, onDownloaded: (Uri) -> Unit) {
    DisposableEffect(context) {
        val receiver = object : BroadcastReceiver() {
            @SuppressLint("Range")
            override fun onReceive(context: Context?, intent: Intent?) {
                if (intent?.action == DownloadManager.ACTION_DOWNLOAD_COMPLETE) {
                    val id = intent.getLongExtra(
                        DownloadManager.EXTRA_DOWNLOAD_ID, -1
                    )
                    val query = DownloadManager.Query().setFilterById(id)
                    val downloadManager =
                        context?.getSystemService(Context.DOWNLOAD_SERVICE) as DownloadManager
                    val cursor = downloadManager.query(query)
                    if (cursor.moveToFirst()) {
                        val status = cursor.getInt(
                            cursor.getColumnIndex(DownloadManager.COLUMN_STATUS)
                        )
                        if (status == DownloadManager.STATUS_SUCCESSFUL) {
                            val uri = cursor.getString(
                                cursor.getColumnIndex(DownloadManager.COLUMN_LOCAL_URI)
                            )
                            onDownloaded(Uri.parse(uri))
                        }
                    }
                }
            }
        }
        val intentFilter = IntentFilter(DownloadManager.ACTION_DOWNLOAD_COMPLETE)
        ContextCompat.registerReceiver(
            context,
            receiver,
            intentFilter,
            ContextCompat.RECEIVER_EXPORTED
        )
        onDispose {
            context.unregisterReceiver(receiver)
        }
    }
}

```

`app/src/main/java/me/bmax/apatch/util/HanziToPinyin.java`:

```java
package me.bmax.apatch.util;
/*
 * Copyright (C) 2009 The Android Open Source Project
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import android.text.TextUtils;
import android.util.Log;

import java.text.Collator;
import java.util.ArrayList;
import java.util.Locale;

/**
 * An object to convert Chinese character to its corresponding pinyin string. For characters with
 * multiple possible pinyin string, only one is selected according to collator. Polyphone is not
 * supported in this implementation. This class is implemented to achieve the best runtime
 * performance and minimum runtime resources with tolerable sacrifice of accuracy. This
 * implementation highly depends on zh_CN ICU collation data and must be always synchronized with
 * ICU.
 * <p>
 * Currently this file is aligned to zh.txt in ICU 4.6
 */
public class HanziToPinyin {
    /**
     * Unihans array.
     * <p>
     * Each unihans is the first one within same pinyin when collator is zh_CN.
     */
    public static final char[] UNIHANS = {
            '\u963f', '\u54ce', '\u5b89', '\u80ae', '\u51f9', '\u516b',
            '\u6300', '\u6273', '\u90a6', '\u52f9', '\u9642', '\u5954',
            '\u4f3b', '\u5c44', '\u8fb9', '\u706c', '\u618b', '\u6c43',
            '\u51ab', '\u7676', '\u5cec', '\u5693', '\u5072', '\u53c2',
            '\u4ed3', '\u64a1', '\u518a', '\u5d7e', '\u66fd', '\u66fe',
            '\u5c64', '\u53c9', '\u8286', '\u8fbf', '\u4f25', '\u6284',
            '\u8f66', '\u62bb', '\u6c88', '\u6c89', '\u9637', '\u5403',
            '\u5145', '\u62bd', '\u51fa', '\u6b3b', '\u63e3', '\u5ddb',
            '\u5205', '\u5439', '\u65fe', '\u9034', '\u5472', '\u5306',
            '\u51d1', '\u7c97', '\u6c46', '\u5d14', '\u90a8', '\u6413',
            '\u5491', '\u5446', '\u4e39', '\u5f53', '\u5200', '\u561a',
            '\u6265', '\u706f', '\u6c10', '\u55f2', '\u7538', '\u5201',
            '\u7239', '\u4e01', '\u4e1f', '\u4e1c', '\u543a', '\u53be',
            '\u8011', '\u8968', '\u5428', '\u591a', '\u59b8', '\u8bf6',
            '\u5940', '\u97a5', '\u513f', '\u53d1', '\u5e06', '\u531a',
            '\u98de', '\u5206', '\u4e30', '\u8985', '\u4ecf', '\u7d11',
            '\u4f15', '\u65ee', '\u4f85', '\u7518', '\u5188', '\u768b',
            '\u6208', '\u7ed9', '\u6839', '\u522f', '\u5de5', '\u52fe',
            '\u4f30', '\u74dc', '\u4e56', '\u5173', '\u5149', '\u5f52',
            '\u4e28', '\u5459', '\u54c8', '\u548d', '\u4f44', '\u592f',
            '\u8320', '\u8bc3', '\u9ed2', '\u62eb', '\u4ea8', '\u5677',
            '\u53ff', '\u9f41', '\u4e6f', '\u82b1', '\u6000', '\u72bf',
            '\u5ddf', '\u7070', '\u660f', '\u5419', '\u4e0c', '\u52a0',
            '\u620b', '\u6c5f', '\u827d', '\u9636', '\u5dfe', '\u5755',
            '\u5182', '\u4e29', '\u51e5', '\u59e2', '\u5658', '\u519b',
            '\u5494', '\u5f00', '\u520a', '\u5ffc', '\u5c3b', '\u533c',
            '\u808e', '\u52a5', '\u7a7a', '\u62a0', '\u625d', '\u5938',
            '\u84af', '\u5bbd', '\u5321', '\u4e8f', '\u5764', '\u6269',
            '\u5783', '\u6765', '\u5170', '\u5577', '\u635e', '\u808b',
            '\u52d2', '\u5d1a', '\u5215', '\u4fe9', '\u5941', '\u826f',
            '\u64a9', '\u5217', '\u62ce', '\u5222', '\u6e9c', '\u56d6',
            '\u9f99', '\u779c', '\u565c', '\u5a08', '\u7567', '\u62a1',
            '\u7f57', '\u5463', '\u5988', '\u57cb', '\u5ada', '\u7264',
            '\u732b', '\u4e48', '\u5445', '\u95e8', '\u753f', '\u54aa',
            '\u5b80', '\u55b5', '\u4e5c', '\u6c11', '\u540d', '\u8c2c',
            '\u6478', '\u54de', '\u6bea', '\u55ef', '\u62cf', '\u8149',
            '\u56e1', '\u56d4', '\u5b6c', '\u7592', '\u5a1e', '\u6041',
            '\u80fd', '\u59ae', '\u62c8', '\u5b22', '\u9e1f', '\u634f',
            '\u56dc', '\u5b81', '\u599e', '\u519c', '\u7fba', '\u5974',
            '\u597b', '\u759f', '\u9ec1', '\u90cd', '\u5594', '\u8bb4',
            '\u5991', '\u62cd', '\u7705', '\u4e53', '\u629b', '\u5478',
            '\u55b7', '\u5309', '\u4e15', '\u56e8', '\u527d', '\u6c15',
            '\u59d8', '\u4e52', '\u948b', '\u5256', '\u4ec6', '\u4e03',
            '\u6390', '\u5343', '\u545b', '\u6084', '\u767f', '\u4eb2',
            '\u72c5', '\u828e', '\u4e18', '\u533a', '\u5cd1', '\u7f3a',
            '\u590b', '\u5465', '\u7a63', '\u5a06', '\u60f9', '\u4eba',
            '\u6254', '\u65e5', '\u8338', '\u53b9', '\u909a', '\u633c',
            '\u5827', '\u5a51', '\u77a4', '\u637c', '\u4ee8', '\u6be2',
            '\u4e09', '\u6852', '\u63bb', '\u95aa', '\u68ee', '\u50e7',
            '\u6740', '\u7b5b', '\u5c71', '\u4f24', '\u5f30', '\u5962',
            '\u7533', '\u8398', '\u6552', '\u5347', '\u5c38', '\u53ce',
            '\u4e66', '\u5237', '\u8870', '\u95e9', '\u53cc', '\u8c01',
            '\u542e', '\u8bf4', '\u53b6', '\u5fea', '\u635c', '\u82cf',
            '\u72fb', '\u590a', '\u5b59', '\u5506', '\u4ed6', '\u56fc',
            '\u574d', '\u6c64', '\u5932', '\u5fd1', '\u71a5', '\u5254',
            '\u5929', '\u65eb', '\u5e16', '\u5385', '\u56f2', '\u5077',
            '\u51f8', '\u6e4d', '\u63a8', '\u541e', '\u4e47', '\u7a75',
            '\u6b6a', '\u5f2f', '\u5c23', '\u5371', '\u6637', '\u7fc1',
            '\u631d', '\u4e4c', '\u5915', '\u8672', '\u4eda', '\u4e61',
            '\u7071', '\u4e9b', '\u5fc3', '\u661f', '\u51f6', '\u4f11',
            '\u5401', '\u5405', '\u524a', '\u5743', '\u4e2b', '\u6079',
            '\u592e', '\u5e7a', '\u503b', '\u4e00', '\u56d9', '\u5e94',
            '\u54df', '\u4f63', '\u4f18', '\u625c', '\u56e6', '\u66f0',
            '\u6655', '\u7b60', '\u7b7c', '\u5e00', '\u707d', '\u5142',
            '\u5328', '\u50ae', '\u5219', '\u8d3c', '\u600e', '\u5897',
            '\u624e', '\u635a', '\u6cbe', '\u5f20', '\u957f', '\u9577',
            '\u4f4b', '\u8707', '\u8d1e', '\u4e89', '\u4e4b', '\u5cd9',
            '\u5ea2', '\u4e2d', '\u5dde', '\u6731', '\u6293', '\u62fd',
            '\u4e13', '\u5986', '\u96b9', '\u5b92', '\u5353', '\u4e72',
            '\u5b97', '\u90b9', '\u79df', '\u94bb', '\u539c', '\u5c0a',
            '\u6628', '\u5159', '\u9fc3', '\u9fc4',};
    /**
     * Pinyin array.
     * <p>
     * Each pinyin is corresponding to unihans of same
     * offset in the unihans array.
     */
    public static final byte[][] PINYINS = {
            {65, 0, 0, 0, 0, 0}, {65, 73, 0, 0, 0, 0},
            {65, 78, 0, 0, 0, 0}, {65, 78, 71, 0, 0, 0},
            {65, 79, 0, 0, 0, 0}, {66, 65, 0, 0, 0, 0},
            {66, 65, 73, 0, 0, 0}, {66, 65, 78, 0, 0, 0},
            {66, 65, 78, 71, 0, 0}, {66, 65, 79, 0, 0, 0},
            {66, 69, 73, 0, 0, 0}, {66, 69, 78, 0, 0, 0},
            {66, 69, 78, 71, 0, 0}, {66, 73, 0, 0, 0, 0},
            {66, 73, 65, 78, 0, 0}, {66, 73, 65, 79, 0, 0},
            {66, 73, 69, 0, 0, 0}, {66, 73, 78, 0, 0, 0},
            {66, 73, 78, 71, 0, 0}, {66, 79, 0, 0, 0, 0},
            {66, 85, 0, 0, 0, 0}, {67, 65, 0, 0, 0, 0},
            {67, 65, 73, 0, 0, 0}, {67, 65, 78, 0, 0, 0},
            {67, 65, 78, 71, 0, 0}, {67, 65, 79, 0, 0, 0},
            {67, 69, 0, 0, 0, 0}, {67, 69, 78, 0, 0, 0},
            {67, 69, 78, 71, 0, 0}, {90, 69, 78, 71, 0, 0},
            {67, 69, 78, 71, 0, 0}, {67, 72, 65, 0, 0, 0},
            {67, 72, 65, 73, 0, 0}, {67, 72, 65, 78, 0, 0},
            {67, 72, 65, 78, 71, 0}, {67, 72, 65, 79, 0, 0},
            {67, 72, 69, 0, 0, 0}, {67, 72, 69, 78, 0, 0},
            {83, 72, 69, 78, 0, 0}, {67, 72, 69, 78, 0, 0},
            {67, 72, 69, 78, 71, 0}, {67, 72, 73, 0, 0, 0},
            {67, 72, 79, 78, 71, 0}, {67, 72, 79, 85, 0, 0},
            {67, 72, 85, 0, 0, 0}, {67, 72, 85, 65, 0, 0},
            {67, 72, 85, 65, 73, 0}, {67, 72, 85, 65, 78, 0},
            {67, 72, 85, 65, 78, 71}, {67, 72, 85, 73, 0, 0},
            {67, 72, 85, 78, 0, 0}, {67, 72, 85, 79, 0, 0},
            {67, 73, 0, 0, 0, 0}, {67, 79, 78, 71, 0, 0},
            {67, 79, 85, 0, 0, 0}, {67, 85, 0, 0, 0, 0},
            {67, 85, 65, 78, 0, 0}, {67, 85, 73, 0, 0, 0},
            {67, 85, 78, 0, 0, 0}, {67, 85, 79, 0, 0, 0},
            {68, 65, 0, 0, 0, 0}, {68, 65, 73, 0, 0, 0},
            {68, 65, 78, 0, 0, 0}, {68, 65, 78, 71, 0, 0},
            {68, 65, 79, 0, 0, 0}, {68, 69, 0, 0, 0, 0},
            {68, 69, 78, 0, 0, 0}, {68, 69, 78, 71, 0, 0},
            {68, 73, 0, 0, 0, 0}, {68, 73, 65, 0, 0, 0},
            {68, 73, 65, 78, 0, 0}, {68, 73, 65, 79, 0, 0},
            {68, 73, 69, 0, 0, 0}, {68, 73, 78, 71, 0, 0},
            {68, 73, 85, 0, 0, 0}, {68, 79, 78, 71, 0, 0},
            {68, 79, 85, 0, 0, 0}, {68, 85, 0, 0, 0, 0},
            {68, 85, 65, 78, 0, 0}, {68, 85, 73, 0, 0, 0},
            {68, 85, 78, 0, 0, 0}, {68, 85, 79, 0, 0, 0},
            {69, 0, 0, 0, 0, 0}, {69, 73, 0, 0, 0, 0},
            {69, 78, 0, 0, 0, 0}, {69, 78, 71, 0, 0, 0},
            {69, 82, 0, 0, 0, 0}, {70, 65, 0, 0, 0, 0},
            {70, 65, 78, 0, 0, 0}, {70, 65, 78, 71, 0, 0},
            {70, 69, 73, 0, 0, 0}, {70, 69, 78, 0, 0, 0},
            {70, 69, 78, 71, 0, 0}, {70, 73, 65, 79, 0, 0},
            {70, 79, 0, 0, 0, 0}, {70, 79, 85, 0, 0, 0},
            {70, 85, 0, 0, 0, 0}, {71, 65, 0, 0, 0, 0},
            {71, 65, 73, 0, 0, 0}, {71, 65, 78, 0, 0, 0},
            {71, 65, 78, 71, 0, 0}, {71, 65, 79, 0, 0, 0},
            {71, 69, 0, 0, 0, 0}, {71, 69, 73, 0, 0, 0},
            {71, 69, 78, 0, 0, 0}, {71, 69, 78, 71, 0, 0},
            {71, 79, 78, 71, 0, 0}, {71, 79, 85, 0, 0, 0},
            {71, 85, 0, 0, 0, 0}, {71, 85, 65, 0, 0, 0},
            {71, 85, 65, 73, 0, 0}, {71, 85, 65, 78, 0, 0},
            {71, 85, 65, 78, 71, 0}, {71, 85, 73, 0, 0, 0},
            {71, 85, 78, 0, 0, 0}, {71, 85, 79, 0, 0, 0},
            {72, 65, 0, 0, 0, 0}, {72, 65, 73, 0, 0, 0},
            {72, 65, 78, 0, 0, 0}, {72, 65, 78, 71, 0, 0},
            {72, 65, 79, 0, 0, 0}, {72, 69, 0, 0, 0, 0},
            {72, 69, 73, 0, 0, 0}, {72, 69, 78, 0, 0, 0},
            {72, 69, 78, 71, 0, 0}, {72, 77, 0, 0, 0, 0},
            {72, 79, 78, 71, 0, 0}, {72, 79, 85, 0, 0, 0},
            {72, 85, 0, 0, 0, 0}, {72, 85, 65, 0, 0, 0},
            {72, 85, 65, 73, 0, 0}, {72, 85, 65, 78, 0, 0},
            {72, 85, 65, 78, 71, 0}, {72, 85, 73, 0, 0, 0},
            {72, 85, 78, 0, 0, 0}, {72, 85, 79, 0, 0, 0},
            {74, 73, 0, 0, 0, 0}, {74, 73, 65, 0, 0, 0},
            {74, 73, 65, 78, 0, 0}, {74, 73, 65, 78, 71, 0},
            {74, 73, 65, 79, 0, 0}, {74, 73, 69, 0, 0, 0},
            {74, 73, 78, 0, 0, 0}, {74, 73, 78, 71, 0, 0},
            {74, 73, 79, 78, 71, 0}, {74, 73, 85, 0, 0, 0},
            {74, 85, 0, 0, 0, 0}, {74, 85, 65, 78, 0, 0},
            {74, 85, 69, 0, 0, 0}, {74, 85, 78, 0, 0, 0},
            {75, 65, 0, 0, 0, 0}, {75, 65, 73, 0, 0, 0},
            {75, 65, 78, 0, 0, 0}, {75, 65, 78, 71, 0, 0},
            {75, 65, 79, 0, 0, 0}, {75, 69, 0, 0, 0, 0},
            {75, 69, 78, 0, 0, 0}, {75, 69, 78, 71, 0, 0},
            {75, 79, 78, 71, 0, 0}, {75, 79, 85, 0, 0, 0},
            {75, 85, 0, 0, 0, 0}, {75, 85, 65, 0, 0, 0},
            {75, 85, 65, 73, 0, 0}, {75, 85, 65, 78, 0, 0},
            {75, 85, 65, 78, 71, 0}, {75, 85, 73, 0, 0, 0},
            {75, 85, 78, 0, 0, 0}, {75, 85, 79, 0, 0, 0},
            {76, 65, 0, 0, 0, 0}, {76, 65, 73, 0, 0, 0},
            {76, 65, 78, 0, 0, 0}, {76, 65, 78, 71, 0, 0},
            {76, 65, 79, 0, 0, 0}, {76, 69, 0, 0, 0, 0},
            {76, 69, 73, 0, 0, 0}, {76, 69, 78, 71, 0, 0},
            {76, 73, 0, 0, 0, 0}, {76, 73, 65, 0, 0, 0},
            {76, 73, 65, 78, 0, 0}, {76, 73, 65, 78, 71, 0},
            {76, 73, 65, 79, 0, 0}, {76, 73, 69, 0, 0, 0},
            {76, 73, 78, 0, 0, 0}, {76, 73, 78, 71, 0, 0},
            {76, 73, 85, 0, 0, 0}, {76, 79, 0, 0, 0, 0},
            {76, 79, 78, 71, 0, 0}, {76, 79, 85, 0, 0, 0},
            {76, 85, 0, 0, 0, 0}, {76, 85, 65, 78, 0, 0},
            {76, 85, 69, 0, 0, 0}, {76, 85, 78, 0, 0, 0},
            {76, 85, 79, 0, 0, 0}, {77, 0, 0, 0, 0, 0},
            {77, 65, 0, 0, 0, 0}, {77, 65, 73, 0, 0, 0},
            {77, 65, 78, 0, 0, 0}, {77, 65, 78, 71, 0, 0},
            {77, 65, 79, 0, 0, 0}, {77, 69, 0, 0, 0, 0},
            {77, 69, 73, 0, 0, 0}, {77, 69, 78, 0, 0, 0},
            {77, 69, 78, 71, 0, 0}, {77, 73, 0, 0, 0, 0},
            {77, 73, 65, 78, 0, 0}, {77, 73, 65, 79, 0, 0},
            {77, 73, 69, 0, 0, 0}, {77, 73, 78, 0, 0, 0},
            {77, 73, 78, 71, 0, 0}, {77, 73, 85, 0, 0, 0},
            {77, 79, 0, 0, 0, 0}, {77, 79, 85, 0, 0, 0},
            {77, 85, 0, 0, 0, 0}, {78, 0, 0, 0, 0, 0},
            {78, 65, 0, 0, 0, 0}, {78, 65, 73, 0, 0, 0},
            {78, 65, 78, 0, 0, 0}, {78, 65, 78, 71, 0, 0},
            {78, 65, 79, 0, 0, 0}, {78, 69, 0, 0, 0, 0},
            {78, 69, 73, 0, 0, 0}, {78, 69, 78, 0, 0, 0},
            {78, 69, 78, 71, 0, 0}, {78, 73, 0, 0, 0, 0},
            {78, 73, 65, 78, 0, 0}, {78, 73, 65, 78, 71, 0},
            {78, 73, 65, 79, 0, 0}, {78, 73, 69, 0, 0, 0},
            {78, 73, 78, 0, 0, 0}, {78, 73, 78, 71, 0, 0},
            {78, 73, 85, 0, 0, 0}, {78, 79, 78, 71, 0, 0},
            {78, 79, 85, 0, 0, 0}, {78, 85, 0, 0, 0, 0},
            {78, 85, 65, 78, 0, 0}, {78, 85, 69, 0, 0, 0},
            {78, 85, 78, 0, 0, 0}, {78, 85, 79, 0, 0, 0},
            {79, 0, 0, 0, 0, 0}, {79, 85, 0, 0, 0, 0},
            {80, 65, 0, 0, 0, 0}, {80, 65, 73, 0, 0, 0},
            {80, 65, 78, 0, 0, 0}, {80, 65, 78, 71, 0, 0},
            {80, 65, 79, 0, 0, 0}, {80, 69, 73, 0, 0, 0},
            {80, 69, 78, 0, 0, 0}, {80, 69, 78, 71, 0, 0},
            {80, 73, 0, 0, 0, 0}, {80, 73, 65, 78, 0, 0},
            {80, 73, 65, 79, 0, 0}, {80, 73, 69, 0, 0, 0},
            {80, 73, 78, 0, 0, 0}, {80, 73, 78, 71, 0, 0},
            {80, 79, 0, 0, 0, 0}, {80, 79, 85, 0, 0, 0},
            {80, 85, 0, 0, 0, 0}, {81, 73, 0, 0, 0, 0},
            {81, 73, 65, 0, 0, 0}, {81, 73, 65, 78, 0, 0},
            {81, 73, 65, 78, 71, 0}, {81, 73, 65, 79, 0, 0},
            {81, 73, 69, 0, 0, 0}, {81, 73, 78, 0, 0, 0},
            {81, 73, 78, 71, 0, 0}, {81, 73, 79, 78, 71, 0},
            {81, 73, 85, 0, 0, 0}, {81, 85, 0, 0, 0, 0},
            {81, 85, 65, 78, 0, 0}, {81, 85, 69, 0, 0, 0},
            {81, 85, 78, 0, 0, 0}, {82, 65, 78, 0, 0, 0},
            {82, 65, 78, 71, 0, 0}, {82, 65, 79, 0, 0, 0},
            {82, 69, 0, 0, 0, 0}, {82, 69, 78, 0, 0, 0},
            {82, 69, 78, 71, 0, 0}, {82, 73, 0, 0, 0, 0},
            {82, 79, 78, 71, 0, 0}, {82, 79, 85, 0, 0, 0},
            {82, 85, 0, 0, 0, 0}, {82, 85, 65, 0, 0, 0},
            {82, 85, 65, 78, 0, 0}, {82, 85, 73, 0, 0, 0},
            {82, 85, 78, 0, 0, 0}, {82, 85, 79, 0, 0, 0},
            {83, 65, 0, 0, 0, 0}, {83, 65, 73, 0, 0, 0},
            {83, 65, 78, 0, 0, 0}, {83, 65, 78, 71, 0, 0},
            {83, 65, 79, 0, 0, 0}, {83, 69, 0, 0, 0, 0},
            {83, 69, 78, 0, 0, 0}, {83, 69, 78, 71, 0, 0},
            {83, 72, 65, 0, 0, 0}, {83, 72, 65, 73, 0, 0},
            {83, 72, 65, 78, 0, 0}, {83, 72, 65, 78, 71, 0},
            {83, 72, 65, 79, 0, 0}, {83, 72, 69, 0, 0, 0},
            {83, 72, 69, 78, 0, 0}, {88, 73, 78, 0, 0, 0},
            {83, 72, 69, 78, 0, 0}, {83, 72, 69, 78, 71, 0},
            {83, 72, 73, 0, 0, 0}, {83, 72, 79, 85, 0, 0},
            {83, 72, 85, 0, 0, 0}, {83, 72, 85, 65, 0, 0},
            {83, 72, 85, 65, 73, 0}, {83, 72, 85, 65, 78, 0},
            {83, 72, 85, 65, 78, 71}, {83, 72, 85, 73, 0, 0},
            {83, 72, 85, 78, 0, 0}, {83, 72, 85, 79, 0, 0},
            {83, 73, 0, 0, 0, 0}, {83, 79, 78, 71, 0, 0},
            {83, 79, 85, 0, 0, 0}, {83, 85, 0, 0, 0, 0},
            {83, 85, 65, 78, 0, 0}, {83, 85, 73, 0, 0, 0},
            {83, 85, 78, 0, 0, 0}, {83, 85, 79, 0, 0, 0},
            {84, 65, 0, 0, 0, 0}, {84, 65, 73, 0, 0, 0},
            {84, 65, 78, 0, 0, 0}, {84, 65, 78, 71, 0, 0},
            {84, 65, 79, 0, 0, 0}, {84, 69, 0, 0, 0, 0},
            {84, 69, 78, 71, 0, 0}, {84, 73, 0, 0, 0, 0},
            {84, 73, 65, 78, 0, 0}, {84, 73, 65, 79, 0, 0},
            {84, 73, 69, 0, 0, 0}, {84, 73, 78, 71, 0, 0},
            {84, 79, 78, 71, 0, 0}, {84, 79, 85, 0, 0, 0},
            {84, 85, 0, 0, 0, 0}, {84, 85, 65, 78, 0, 0},
            {84, 85, 73, 0, 0, 0}, {84, 85, 78, 0, 0, 0},
            {84, 85, 79, 0, 0, 0}, {87, 65, 0, 0, 0, 0},
            {87, 65, 73, 0, 0, 0}, {87, 65, 78, 0, 0, 0},
            {87, 65, 78, 71, 0, 0}, {87, 69, 73, 0, 0, 0},
            {87, 69, 78, 0, 0, 0}, {87, 69, 78, 71, 0, 0},
            {87, 79, 0, 0, 0, 0}, {87, 85, 0, 0, 0, 0},
            {88, 73, 0, 0, 0, 0}, {88, 73, 65, 0, 0, 0},
            {88, 73, 65, 78, 0, 0}, {88, 73, 65, 78, 71, 0},
            {88, 73, 65, 79, 0, 0}, {88, 73, 69, 0, 0, 0},
            {88, 73, 78, 0, 0, 0}, {88, 73, 78, 71, 0, 0},
            {88, 73, 79, 78, 71, 0}, {88, 73, 85, 0, 0, 0},
            {88, 85, 0, 0, 0, 0}, {88, 85, 65, 78, 0, 0},
            {88, 85, 69, 0, 0, 0}, {88, 85, 78, 0, 0, 0},
            {89, 65, 0, 0, 0, 0}, {89, 65, 78, 0, 0, 0},
            {89, 65, 78, 71, 0, 0}, {89, 65, 79, 0, 0, 0},
            {89, 69, 0, 0, 0, 0}, {89, 73, 0, 0, 0, 0},
            {89, 73, 78, 0, 0, 0}, {89, 73, 78, 71, 0, 0},
            {89, 79, 0, 0, 0, 0}, {89, 79, 78, 71, 0, 0},
            {89, 79, 85, 0, 0, 0}, {89, 85, 0, 0, 0, 0},
            {89, 85, 65, 78, 0, 0}, {89, 85, 69, 0, 0, 0},
            {89, 85, 78, 0, 0, 0}, {74, 85, 78, 0, 0, 0},
            {89, 85, 78, 0, 0, 0}, {90, 65, 0, 0, 0, 0},
            {90, 65, 73, 0, 0, 0}, {90, 65, 78, 0, 0, 0},
            {90, 65, 78, 71, 0, 0}, {90, 65, 79, 0, 0, 0},
            {90, 69, 0, 0, 0, 0}, {90, 69, 73, 0, 0, 0},
            {90, 69, 78, 0, 0, 0}, {90, 69, 78, 71, 0, 0},
            {90, 72, 65, 0, 0, 0}, {90, 72, 65, 73, 0, 0},
            {90, 72, 65, 78, 0, 0}, {90, 72, 65, 78, 71, 0},
            {67, 72, 65, 78, 71, 0}, {90, 72, 65, 78, 71, 0},
            {90, 72, 65, 79, 0, 0}, {90, 72, 69, 0, 0, 0},
            {90, 72, 69, 78, 0, 0}, {90, 72, 69, 78, 71, 0},
            {90, 72, 73, 0, 0, 0}, {83, 72, 73, 0, 0, 0},
            {90, 72, 73, 0, 0, 0}, {90, 72, 79, 78, 71, 0},
            {90, 72, 79, 85, 0, 0}, {90, 72, 85, 0, 0, 0},
            {90, 72, 85, 65, 0, 0}, {90, 72, 85, 65, 73, 0},
            {90, 72, 85, 65, 78, 0}, {90, 72, 85, 65, 78, 71},
            {90, 72, 85, 73, 0, 0}, {90, 72, 85, 78, 0, 0},
            {90, 72, 85, 79, 0, 0}, {90, 73, 0, 0, 0, 0},
            {90, 79, 78, 71, 0, 0}, {90, 79, 85, 0, 0, 0},
            {90, 85, 0, 0, 0, 0}, {90, 85, 65, 78, 0, 0},
            {90, 85, 73, 0, 0, 0}, {90, 85, 78, 0, 0, 0},
            {90, 85, 79, 0, 0, 0}, {0, 0, 0, 0, 0, 0},
            {83, 72, 65, 78, 0, 0}, {0, 0, 0, 0, 0, 0},};
    private static final String TAG = "HanziToPinyin";
    // Turn on this flag when we want to check internal data structure.
    private static final boolean DEBUG = false;
    /**
     * First and last Chinese character with known Pinyin according to zh collation
     */
    private static final String FIRST_PINYIN_UNIHAN = "\u963F";
    private static final String LAST_PINYIN_UNIHAN = "\u9FFF";

    private static final Collator COLLATOR = Collator.getInstance(Locale.CHINA);

    private static HanziToPinyin sInstance;
    private final boolean mHasChinaCollator;

    protected HanziToPinyin(boolean hasChinaCollator) {
        mHasChinaCollator = hasChinaCollator;
    }

    public static HanziToPinyin getInstance() {
        synchronized (HanziToPinyin.class) {
            if (sInstance != null) {
                return sInstance;
            }
            // Check if zh_CN collation data is available
            final Locale[] locale = Collator.getAvailableLocales();
            for (int i = 0; i < locale.length; i++) {
                if (locale[i].equals(Locale.CHINA) || locale[i].getLanguage().contains("zh")) {
                    // Do self validation just once.
                    if (DEBUG) {
                        Log.d(TAG, "Self validation. Result: " + doSelfValidation());
                    }
                    sInstance = new HanziToPinyin(true);
                    return sInstance;
                }
            }
            if (sInstance == null) {//这个判断是用于处理国产ROM的兼容性问题
                if (Locale.CHINA.equals(Locale.getDefault())) {
                    sInstance = new HanziToPinyin(true);
                    return sInstance;
                }
            }
            Log.w(TAG, "There is no Chinese collator, HanziToPinyin is disabled");
            sInstance = new HanziToPinyin(false);
            return sInstance;
        }
    }

    /**
     * Validate if our internal table has some wrong value.
     *
     * @return true when the table looks correct.
     */
    private static boolean doSelfValidation() {
        char lastChar = UNIHANS[0];
        String lastString = Character.toString(lastChar);
        for (char c : UNIHANS) {
            if (lastChar == c) {
                continue;
            }
            final String curString = Character.toString(c);
            int cmp = COLLATOR.compare(lastString, curString);
            if (cmp >= 0) {
                Log.e(TAG, "Internal error in Unihan table. " + "The last string \"" + lastString
                        + "\" is greater than current string \"" + curString + "\".");
                return false;
            }
            lastString = curString;
        }
        return true;
    }

    private Token getToken(char character) {
        Token token = new Token();
        final String letter = Character.toString(character);
        token.source = letter;
        int offset = -1;
        int cmp;
        if (character < 256) {
            token.type = Token.LATIN;
            token.target = letter;
            return token;
        } else {
            cmp = COLLATOR.compare(letter, FIRST_PINYIN_UNIHAN);
            if (cmp < 0) {
                token.type = Token.UNKNOWN;
                token.target = letter;
                return token;
            } else if (cmp == 0) {
                token.type = Token.PINYIN;
                offset = 0;
            } else {
                cmp = COLLATOR.compare(letter, LAST_PINYIN_UNIHAN);
                if (cmp > 0) {
                    token.type = Token.UNKNOWN;
                    token.target = letter;
                    return token;
                } else if (cmp == 0) {
                    token.type = Token.PINYIN;
                    offset = UNIHANS.length - 1;
                }
            }
        }

        token.type = Token.PINYIN;
        if (offset < 0) {
            int begin = 0;
            int end = UNIHANS.length - 1;
            while (begin <= end) {
                offset = (begin + end) / 2;
                final String unihan = Character.toString(UNIHANS[offset]);
                cmp = COLLATOR.compare(letter, unihan);
                if (cmp == 0) {
                    break;
                } else if (cmp > 0) {
                    begin = offset + 1;
                } else {
                    end = offset - 1;
                }
            }
        }
        if (cmp < 0) {
            offset--;
        }
        StringBuilder pinyin = new StringBuilder();
        for (int j = 0; j < PINYINS[offset].length && PINYINS[offset][j] != 0; j++) {
            pinyin.append((char) PINYINS[offset][j]);
        }
        token.target = pinyin.toString();
        if (TextUtils.isEmpty(token.target)) {
            token.type = Token.UNKNOWN;
            token.target = token.source;
        }
        return token;
    }

    /**
     * Convert the input to a array of tokens. The sequence of ASCII or Unknown characters without
     * space will be put into a Token, One Hanzi character which has pinyin will be treated as a
     * Token. If these is no China collator, the empty token array is returned.
     */
    public ArrayList<Token> get(final String input) {
        ArrayList<Token> tokens = new ArrayList<Token>();
        if (!mHasChinaCollator || TextUtils.isEmpty(input)) {
            // return empty tokens.
            return tokens;
        }
        final int inputLength = input.length();
        final StringBuilder sb = new StringBuilder();
        int tokenType = Token.LATIN;
        // Go through the input, create a new token when
        // a. Token type changed
        // b. Get the Pinyin of current charater.
        // c. current character is space.
        for (int i = 0; i < inputLength; i++) {
            final char character = input.charAt(i);
            if (character == ' ') {
                if (sb.length() > 0) {
                    addToken(sb, tokens, tokenType);
                }
            } else if (character < 256) {
                if (tokenType != Token.LATIN && sb.length() > 0) {
                    addToken(sb, tokens, tokenType);
                }
                tokenType = Token.LATIN;
                sb.append(character);
            } else {
                Token t = getToken(character);
                if (t.type == Token.PINYIN) {
                    if (sb.length() > 0) {
                        addToken(sb, tokens, tokenType);
                    }
                    tokens.add(t);
                    tokenType = Token.PINYIN;
                } else {
                    if (tokenType != t.type && sb.length() > 0) {
                        addToken(sb, tokens, tokenType);
                    }
                    tokenType = t.type;
                    sb.append(character);
                }
            }
        }
        if (sb.length() > 0) {
            addToken(sb, tokens, tokenType);
        }
        return tokens;
    }

    private void addToken(
            final StringBuilder sb, final ArrayList<Token> tokens, final int tokenType) {
        String str = sb.toString();
        tokens.add(new Token(tokenType, str, str));
        sb.setLength(0);
    }

    public String toPinyinString(String string) {
        if (string == null) {
            return null;
        }
        StringBuilder sb = new StringBuilder();
        ArrayList<Token> tokens = get(string);
        for (Token token : tokens) {
            sb.append(token.target);
        }
        return sb.toString().toLowerCase();
    }

    public static class Token {
        /**
         * Separator between target string for each source char
         */
        public static final String SEPARATOR = " ";

        public static final int LATIN = 1;
        public static final int PINYIN = 2;
        public static final int UNKNOWN = 3;
        /**
         * Type of this token, ASCII, PINYIN or UNKNOWN.
         */
        public int type;
        /**
         * Original string before translation.
         */
        public String source;
        /**
         * Translated string of source. For Han, target is corresponding Pinyin. Otherwise target is
         * original string in source.
         */
        public String target;
        public Token() {
        }
        public Token(int type, String source, String target) {
            this.type = type;
            this.source = source;
            this.target = target;
        }
    }
}
```

`app/src/main/java/me/bmax/apatch/util/IOStreamUtils.kt`:

```kt
package me.bmax.apatch.util

import android.content.ContentResolver
import android.net.Uri
import me.bmax.apatch.apApp
import java.io.File
import java.io.FileNotFoundException
import java.io.InputStream
import java.io.OutputStream


val cr: ContentResolver get() = apApp.contentResolver

fun Uri.inputStream() = cr.openInputStream(this) ?: throw FileNotFoundException()

fun Uri.outputStream() = cr.openOutputStream(this, "rwt") ?: throw FileNotFoundException()

fun Uri.fileDescriptor(mode: String) =
    cr.openFileDescriptor(this, mode) ?: throw FileNotFoundException()

inline fun <In : InputStream, Out : OutputStream> withStreams(
    inStream: In,
    outStream: Out,
    withBoth: (In, Out) -> Unit
) {
    inStream.use { reader ->
        outStream.use { writer ->
            withBoth(reader, writer)
        }
    }
}

fun InputStream.copyAndClose(out: OutputStream) = withStreams(this, out) { i, o -> i.copyTo(o) }
fun InputStream.writeTo(file: File) = copyAndClose(file.outputStream())

fun InputStream.copyAndCloseOut(out: OutputStream) = out.use { copyTo(it) }

```

`app/src/main/java/me/bmax/apatch/util/LatestVersionInfo.kt`:

```kt
package me.bmax.apatch.util

data class LatestVersionInfo(
    val versionCode: Int = 0, val downloadUrl: String = "", val changelog: String = ""
)
```

`app/src/main/java/me/bmax/apatch/util/LogEvent.kt`:

```kt
package me.bmax.apatch.util

import android.content.Context
import android.os.Build
import android.system.Os
import com.topjohnwu.superuser.ShellUtils
import java.io.File
import java.io.FileWriter
import java.io.PrintWriter
import java.time.LocalDateTime
import java.time.format.DateTimeFormatter

fun getBugreportFile(context: Context): File {

    val bugreportDir = File(context.cacheDir, "bugreport")
    bugreportDir.mkdirs()

    val dmesgFile = File(bugreportDir, "dmesg.txt")
    val logcatFile = File(bugreportDir, "logcat.txt")
    val tombstonesFile = File(bugreportDir, "tombstones.tar.gz")
    val dropboxFile = File(bugreportDir, "dropbox.tar.gz")
    val pstoreFile = File(bugreportDir, "pstore.tar.gz")
    val diagFile = File(bugreportDir, "diag.tar.gz")
    val bootlogFile = File(bugreportDir, "bootlog.tar.gz")
    val mountsFile = File(bugreportDir, "mounts.txt")
    val fileSystemsFile = File(bugreportDir, "filesystems.txt")
    val apFileTree = File(bugreportDir, "ap_tree.txt")
    val appListFile = File(bugreportDir, "packages.txt")
    val propFile = File(bugreportDir, "props.txt")
    val packageConfigFile = File(bugreportDir, "package_config")

    val shell = tryGetRootShell()

    shell.newJob().add("dmesg > ${dmesgFile.absolutePath}").exec()
    shell.newJob().add("logcat -d > ${logcatFile.absolutePath}").exec()
    shell.newJob().add("tar -czf ${tombstonesFile.absolutePath} -C /data/tombstones .").exec()
    shell.newJob().add("tar -czf ${dropboxFile.absolutePath} -C /data/system/dropbox .").exec()
    shell.newJob().add("tar -czf ${pstoreFile.absolutePath} -C /sys/fs/pstore .").exec()
    shell.newJob().add("tar -czf ${diagFile.absolutePath} -C /data/vendor/diag .").exec()
    shell.newJob().add("tar -czf ${bootlogFile.absolutePath} -C /data/adb/ap/log .").exec()

    shell.newJob().add("cat /proc/1/mountinfo > ${mountsFile.absolutePath}").exec()
    shell.newJob().add("cat /proc/filesystems > ${fileSystemsFile.absolutePath}").exec()
    shell.newJob().add("ls -alRZ /data/adb > ${apFileTree.absolutePath}").exec()
    shell.newJob().add("cp /data/system/packages.list ${appListFile.absolutePath}").exec()
    shell.newJob().add("getprop > ${propFile.absolutePath}").exec()
    shell.newJob().add("cp /data/adb/ap/package_config ${packageConfigFile.absolutePath}").exec()

    val selinux = ShellUtils.fastCmd(shell, "getenforce")

    // basic information
    val buildInfo = File(bugreportDir, "basic.txt")
    PrintWriter(FileWriter(buildInfo)).use { pw ->
        pw.println("Kernel: ${System.getProperty("os.version")}")
        pw.println("BRAND: " + Build.BRAND)
        pw.println("MODEL: " + Build.MODEL)
        pw.println("PRODUCT: " + Build.PRODUCT)
        pw.println("MANUFACTURER: " + Build.MANUFACTURER)
        pw.println("SDK: " + Build.VERSION.SDK_INT)
        pw.println("PREVIEW_SDK: " + Build.VERSION.PREVIEW_SDK_INT)
        pw.println("FINGERPRINT: " + Build.FINGERPRINT)
        pw.println("DEVICE: " + Build.DEVICE)
        pw.println("Manager: " + Version.getManagerVersion())
        pw.println("SELinux: $selinux")

        val uname = Os.uname()
        pw.println("KernelRelease: ${uname.release}")
        pw.println("KernelVersion: ${uname.version}")
        pw.println("Mahcine: ${uname.machine}")
        pw.println("Nodename: ${uname.nodename}")
        pw.println("Sysname: ${uname.sysname}")

        pw.println("KPatch: ${Version.installedKPVString()}")
        pw.println("APatch: ${Version.installedApdVString}")
        val safeMode = false
        pw.println("SafeMode: $safeMode")
    }

    // modules
    val modulesFile = File(bugreportDir, "modules.json")
    modulesFile.writeText(listModules())

    val formatter = DateTimeFormatter.ofPattern("yyyy-MM-dd_HH_mm")
    val current = LocalDateTime.now().format(formatter)

    val targetFile = File(context.cacheDir, "APatch_bugreport_${current}.tar.gz")

    shell.newJob().add("tar czf ${targetFile.absolutePath} -C ${bugreportDir.absolutePath} .")
        .exec()
    shell.newJob().add("rm -rf ${bugreportDir.absolutePath}").exec()
    shell.newJob().add("chmod 0644 ${targetFile.absolutePath}").exec()

    return targetFile
}

```

`app/src/main/java/me/bmax/apatch/util/PkgConfig.kt`:

```kt
package me.bmax.apatch.util

import android.os.Parcelable
import android.util.Log
import androidx.annotation.Keep
import androidx.compose.runtime.Immutable
import kotlinx.parcelize.Parcelize
import me.bmax.apatch.APApplication
import me.bmax.apatch.Natives
import java.io.File
import java.io.FileWriter
import kotlin.concurrent.thread

object PkgConfig {
    private const val TAG = "PkgConfig"

    private const val CSV_HEADER = "pkg,exclude,allow,uid,to_uid,sctx"

    @Immutable
    @Parcelize
    @Keep
    data class Config(
        var pkg: String = "", var exclude: Int = 0, var allow: Int = 0, var profile: Natives.Profile
    ) : Parcelable {
        companion object {
            fun fromLine(line: String): Config {
                val sp = line.split(",")
                val profile = Natives.Profile(sp[3].toInt(), sp[4].toInt(), sp[5])
                return Config(sp[0], sp[1].toInt(), sp[2].toInt(), profile)
            }
        }

        fun isDefault(): Boolean {
            return allow == 0 && exclude == 0
        }

        fun toLine(): String {
            return "${pkg},${exclude},${allow},${profile.uid},${profile.toUid},${profile.scontext}"
        }
    }

    fun readConfigs(): HashMap<Int, Config> {
        val configs = HashMap<Int, Config>()
        val file = File(APApplication.PACKAGE_CONFIG_FILE)
        if (file.exists()) {
            file.readLines().drop(1).filter { it.isNotEmpty() }.forEach {
                Log.d(TAG, it)
                val p = Config.fromLine(it)
                if (!p.isDefault()) {
                    configs[p.profile.uid] = p
                }
            }
        }
        return configs
    }

    private fun writeConfigs(configs: HashMap<Int, Config>) {
        val file = File(APApplication.PACKAGE_CONFIG_FILE)
        if (!file.parentFile?.exists()!!) file.parentFile?.mkdirs()
        val writer = FileWriter(file, false)
        writer.write(CSV_HEADER + '\n')
        configs.values.forEach {
            if (!it.isDefault()) {
                writer.write(it.toLine() + '\n')
            }
        }
        writer.flush()
        writer.close()
    }

    fun changeConfig(config: Config) {
        thread {
            synchronized(PkgConfig.javaClass) {
                Natives.su()
                val configs = readConfigs()
                val uid = config.profile.uid
                // Root App should not be excluded
                if (config.allow == 1) {
                    config.exclude = 0
                }
                if (config.allow == 0 && configs[uid] != null && config.exclude != 0) {
                    configs.remove(uid)
                } else {
                    Log.d(TAG, "change config: $config")
                    configs[uid] = config
                }
                writeConfigs(configs)
            }
        }
    }
}

```

`app/src/main/java/me/bmax/apatch/util/Version.kt`:

```kt
package me.bmax.apatch.util

import android.util.Log
import androidx.core.content.pm.PackageInfoCompat
import me.bmax.apatch.APApplication
import me.bmax.apatch.BuildConfig
import me.bmax.apatch.Natives
import me.bmax.apatch.apApp
import me.bmax.apatch.util.shellForResult
import org.ini4j.Ini
import java.io.StringReader
import me.bmax.apatch.ui.viewmodel.KPModel
import com.topjohnwu.superuser.nio.ExtendedFile
import com.topjohnwu.superuser.nio.FileSystemManager
import com.topjohnwu.superuser.Shell
import androidx.compose.runtime.mutableStateOf
import java.io.File
import android.system.Os


/**
 * version string is like 0.9.0 or 0.9.0-dev
 * version uint is hex number like: 0x000900
 */
object Version {

    private fun string2UInt(ver: String): UInt {
        val v = ver.trim().split("-")[0]
        val vn = v.split('.')
        val vi = vn[0].toInt().shl(16) + vn[1].toInt().shl(8) + vn[2].toInt()
        return vi.toUInt()
    }

    fun getKpImg(): String {
        var shell: Shell = createRootShell()
        var kimgInfo = mutableStateOf(KPModel.KImgInfo("", false))
        var kpimgInfo = mutableStateOf(KPModel.KPImgInfo("", "", "", "", ""))
        val patchDir: ExtendedFile = FileSystemManager.getLocal().getFile(apApp.filesDir.parent, "check")
        patchDir.deleteRecursively()
        patchDir.mkdirs()
        val execs = listOf(
            "libkptools.so",  "libbusybox.so"
        )

        val info = apApp.applicationInfo
        val libs = File(info.nativeLibraryDir).listFiles { _, name ->
            execs.contains(name)
        } ?: emptyArray()

        for (lib in libs) {
            val name = lib.name.substring(3, lib.name.length - 3)
            Os.symlink(lib.path, "$patchDir/$name")
        }

        for (script in listOf(
            "boot_patch.sh", "boot_unpatch.sh", "boot_extract.sh", "util_functions.sh", "kpimg"
        )) {
            val dest = File(patchDir, script)
            apApp.assets.open(script).writeTo(dest)
        }
        val result = shellForResult(
            shell, "cd $patchDir", "./kptools -l -k kpimg"
        )

        if (result.isSuccess) {
            val ini = Ini(StringReader(result.out.joinToString("\n")))
            val kpimg = ini["kpimg"]
            if (kpimg != null) {
                kpimgInfo.value = KPModel.KPImgInfo(
                    kpimg["version"].toString(),
                    kpimg["compile_time"].toString(),
                    kpimg["config"].toString(),
                    APApplication.superKey,     // current key
                    kpimg["root_superkey"].toString()      // possibly empty
                )
                return kpimg["compile_time"].toString()
            } 
        } 

        return "unknown"
    }

    fun uInt2String(ver: UInt): String {
        return "%d.%d.%d".format(
            ver.and(0xff0000u).shr(16).toInt(),
            ver.and(0xff00u).shr(8).toInt(),
            ver.and(0xffu).toInt()
        )
    }
    
    fun installedKPTime(): String {
        val time = Natives.kernelPatchBuildTime()
        return if (time.startsWith("ERROR_")) "读取失败" else time
    }

    fun buildKPVUInt(): UInt {
        val buildVS = BuildConfig.buildKPV
        return string2UInt(buildVS)
    }

    fun buildKPVString(): String {
        return BuildConfig.buildKPV
    }

    /**
     * installed KernelPatch version (installed kpimg)
     */
    fun installedKPVUInt(): UInt {
        return Natives.kernelPatchVersion().toUInt()
    }

    fun installedKPVString(): String {
        return uInt2String(installedKPVUInt())
    }


    private fun installedKPatchVString(): String {
        val resultShell = rootShellForResult("${APApplication.APD_PATH} -V")
        val result = resultShell.out.toString()
        return result.trim().ifEmpty { "0" }
    }

    fun installedKPatchVUInt(): UInt {
        return installedKPatchVString().trim().toUInt(0x10)
    }

    private fun installedApdVString(): String {
        val resultShell = rootShellForResult("${APApplication.APD_PATH} -V")
        installedApdVString = if (resultShell.isSuccess) {
            val result = resultShell.out.toString()
            Log.i("APatch", "[installedApdVString@Version] resultFromShell: $result")
            Regex("\\d+").find(result)?.value ?: "0"
        } else {
            "0"
        }
        return installedApdVString
    }

    fun installedApdVUInt(): Int {
        installedApdVInt = installedApdVString().toInt()
        return installedApdVInt
    }


    fun getManagerVersion(): Pair<String, Long> {
        val packageInfo = apApp.packageManager.getPackageInfo(apApp.packageName, 0)!!
        val versionCode = PackageInfoCompat.getLongVersionCode(packageInfo)
        return Pair(packageInfo.versionName!!, versionCode)
    }

    var installedApdVInt: Int = 0
    var installedApdVString: String = "0"
}

```

`app/src/main/java/me/bmax/apatch/util/ui/APDialogBlurBehindUtils.kt`:

```kt
package me.bmax.apatch.util.ui

import android.animation.ValueAnimator
import android.annotation.SuppressLint
import android.os.Build
import android.util.Log
import android.view.SurfaceControl
import android.view.View
import android.view.Window
import android.view.WindowManager
import android.view.animation.DecelerateInterpolator
import java.lang.reflect.Method

open class APDialogBlurBehindUtils {
    companion object {
        private val bIsBlurSupport =
            getSystemProperty("ro.surface_flinger.supports_background_blur") && !getSystemProperty("persist.sys.sf.disable_blurs")

        private fun getSystemProperty(key: String?): Boolean {
            var value = false
            try {
                val c = Class.forName("android.os.SystemProperties")
                val get = c.getMethod(
                    "getBoolean", String::class.java, Boolean::class.javaPrimitiveType
                )
                value = get.invoke(c, key, false) as Boolean
            } catch (e: Exception) {
                Log.e("APatchUI", "[APDialogBlurBehindUtils] Failed to getSystemProperty: ", e)
            }
            return value
        }

        private fun updateWindowForBlurs(window: Window, blursEnabled: Boolean) {
            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.S) {
                window.setDimAmount(0.27f)
                window.attributes.blurBehindRadius = 20
            } else if (Build.VERSION.SDK_INT == Build.VERSION_CODES.R) {
                if (blursEnabled) {
                    val view = window.decorView
                    val animator = ValueAnimator.ofInt(1, 53)
                    animator.duration = 667
                    animator.interpolator = DecelerateInterpolator()
                    try {
                        val viewRootImpl =
                            view.javaClass.getMethod("getViewRootImpl").invoke(view) ?: return
                        val surfaceControl = viewRootImpl.javaClass.getMethod("getSurfaceControl")
                            .invoke(viewRootImpl) as SurfaceControl
                        @SuppressLint("BlockedPrivateApi") val setBackgroundBlurRadius: Method =
                            SurfaceControl.Transaction::class.java.getDeclaredMethod(
                                "setBackgroundBlurRadius",
                                SurfaceControl::class.java,
                                Int::class.javaPrimitiveType
                            )
                        animator.addUpdateListener { animation: ValueAnimator ->
                            try {
                                val transaction = SurfaceControl.Transaction()
                                val animatedValue = animation.animatedValue
                                if (animatedValue != null) {
                                    setBackgroundBlurRadius.invoke(
                                        transaction, surfaceControl, animatedValue as Int
                                    )
                                }
                                transaction.apply()
                            } catch (t: Throwable) {
                                Log.e(
                                    "APatchUI",
                                    "[APDialogBlurBehindUtils] Blur behind dialog builder: " + t.toString()
                                )
                            }
                        }
                    } catch (t: Throwable) {
                        Log.e(
                            "APatchUI",
                            "[APDialogBlurBehindUtils] Blur behind dialog builder: " + t.toString()
                        )
                    }
                    view.addOnAttachStateChangeListener(object : View.OnAttachStateChangeListener {
                        override fun onViewAttachedToWindow(v: View) {}
                        override fun onViewDetachedFromWindow(v: View) {
                            animator.cancel()
                        }
                    })
                    animator.start()
                }
            }
        }

        fun setupWindowBlurListener(window: Window) {
            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.S) {
                window.setFlags(
                    WindowManager.LayoutParams.FLAG_BLUR_BEHIND,
                    WindowManager.LayoutParams.FLAG_BLUR_BEHIND
                )
                updateWindowForBlurs(window, true)
            } else if (Build.VERSION.SDK_INT == Build.VERSION_CODES.R) {
                updateWindowForBlurs(
                    window, bIsBlurSupport
                )
            }
        }

    }

}
```

`app/src/main/java/me/bmax/apatch/util/ui/CompositionProvider.kt`:

```kt
package me.bmax.apatch.util.ui

import androidx.compose.material3.SnackbarHostState
import androidx.compose.runtime.compositionLocalOf

val LocalSnackbarHost = compositionLocalOf<SnackbarHostState> {
    error("CompositionLocal LocalSnackbarController not present")
}

```

`app/src/main/java/me/bmax/apatch/util/ui/HyperlinkText.kt`:

```kt
package me.bmax.apatch.util.ui

import androidx.compose.foundation.gestures.detectTapGestures
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.Text
import androidx.compose.runtime.Composable
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.remember
import androidx.compose.ui.Modifier
import androidx.compose.ui.input.pointer.pointerInput
import androidx.compose.ui.platform.LocalUriHandler
import androidx.compose.ui.text.SpanStyle
import androidx.compose.ui.text.TextLayoutResult
import androidx.compose.ui.text.buildAnnotatedString
import androidx.compose.ui.text.style.TextDecoration
import java.util.regex.Pattern

@Composable
fun LinkifyText(
    text: String,
    modifier: Modifier = Modifier
) {
    val uriHandler = LocalUriHandler.current
    val layoutResult = remember {
        mutableStateOf<TextLayoutResult?>(null)
    }
    val linksList = extractUrls(text)
    val annotatedString = buildAnnotatedString {
        append(text)
        linksList.forEach {
            addStyle(
                style = SpanStyle(
                    color = MaterialTheme.colorScheme.primary,
                    textDecoration = TextDecoration.Underline
                ),
                start = it.start,
                end = it.end
            )
            addStringAnnotation(
                tag = "URL",
                annotation = it.url,
                start = it.start,
                end = it.end
            )
        }
    }
    Text(
        text = annotatedString,
        modifier = modifier.pointerInput(Unit) {
            detectTapGestures { offsetPosition ->
                layoutResult.value?.let {
                    val position = it.getOffsetForPosition(offsetPosition)
                    annotatedString.getStringAnnotations(position, position).firstOrNull()
                        ?.let { result ->
                            if (result.tag == "URL") {
                                uriHandler.openUri(result.item)
                            }
                        }
                }
            }
        },
        onTextLayout = { layoutResult.value = it }
    )
}

private val urlPattern: Pattern = Pattern.compile(
    "(?:^|[\\W])((ht|f)tp(s?):\\/\\/|www\\.)"
            + "(([\\w\\-]+\\.){1,}?([\\w\\-.~]+\\/?)*"
            + "[\\p{Alnum}.,%_=?&#\\-+()\\[\\]\\*$~@!:/{};']*)",
    Pattern.CASE_INSENSITIVE or Pattern.MULTILINE or Pattern.DOTALL
)

private data class LinkInfo(
    val url: String,
    val start: Int,
    val end: Int
)

private fun extractUrls(text: String): List<LinkInfo> = buildList {
    val matcher = urlPattern.matcher(text)
    while (matcher.find()) {
        val matchStart = matcher.start(1)
        val matchEnd = matcher.end()
        val url = text.substring(matchStart, matchEnd).replaceFirst("http://", "https://")
        add(LinkInfo(url, matchStart, matchEnd))
    }
}

```

`app/src/main/java/me/bmax/apatch/util/ui/NavigationBarsSpacer.kt`:

```kt
package me.bmax.apatch.util.ui

import androidx.compose.foundation.layout.Box
import androidx.compose.foundation.layout.Spacer
import androidx.compose.foundation.layout.WindowInsets
import androidx.compose.foundation.layout.asPaddingValues
import androidx.compose.foundation.layout.navigationBars
import androidx.compose.foundation.layout.padding
import androidx.compose.runtime.Composable
import androidx.compose.ui.Modifier

@Composable
fun NavigationBarsSpacer(
    modifier: Modifier = Modifier
) {
    val paddingValues = WindowInsets.navigationBars.asPaddingValues()

    Box(
        modifier = Modifier.padding(paddingValues)
    ) {
        Spacer(modifier = modifier)
    }
}
```

`app/src/main/res/drawable/device_mobile_down.xml`:

```xml
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="24dp"
    android:height="24dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:pathData="M12.5,21h-4.5a2,2 0,0 1,-2 -2v-14a2,2 0,0 1,2 -2h8a2,2 0,0 1,2 2v7"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
    <path
        android:pathData="M11,4h2"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
    <path
        android:pathData="M12,17v0.01"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
    <path
        android:pathData="M19,16v6"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
    <path
        android:pathData="M22,19l-3,3l-3,-3"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
</vector>
```

`app/src/main/res/drawable/github.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="24.0dip"
    android:height="24.0dip"
    android:viewportHeight="24.0"
    android:viewportWidth="24.0">
    <path
        android:fillColor="#ffff"
        android:pathData="M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 8.84,21.5C9.34,21.58 9.5,21.27 9.5,21C9.5,20.77 9.5,20.14 9.5,19.31C6.73,19.91 6.14,17.97 6.14,17.97C5.68,16.81 5.03,16.5 5.03,16.5C4.12,15.88 5.1,15.9 5.1,15.9C6.1,15.97 6.63,16.93 6.63,16.93C7.5,18.45 8.97,18 9.54,17.76C9.63,17.11 9.89,16.67 10.17,16.42C7.95,16.17 5.62,15.31 5.62,11.5C5.62,10.39 6,9.5 6.65,8.79C6.55,8.54 6.2,7.5 6.75,6.15C6.75,6.15 7.59,5.88 9.5,7.17C10.29,6.95 11.15,6.84 12,6.84C12.85,6.84 13.71,6.95 14.5,7.17C16.41,5.88 17.25,6.15 17.25,6.15C17.8,7.5 17.45,8.54 17.35,8.79C18,9.5 18.38,10.39 18.38,11.5C18.38,15.32 16.04,16.16 13.81,16.41C14.17,16.72 14.5,17.33 14.5,18.26C14.5,19.6 14.5,20.68 14.5,21C14.5,21.27 14.66,21.59 15.17,21.5C19.14,20.16 22,16.42 22,12A10,10 0 0,0 12,2Z"/>
</vector>
```

`app/src/main/res/drawable/ic_launcher_background.xml`:

```xml
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="108dp"
    android:height="108dp"
    android:viewportWidth="192"
    android:viewportHeight="192">

  <group android:scaleX="0.97"
      android:scaleY="0.97"
      android:translateX="2.88"
      android:translateY="2.88">
      <path
          android:pathData="M0 0L192 0L192 192L0 192L0 0Z"
          android:fillColor="#FFFFFF"
          android:strokeColor="#FFFFFF"
          android:strokeWidth="1" />
  </group>
</vector>
```

`app/src/main/res/drawable/ic_launcher_foreground.xml`:

```xml
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="108dp"
    android:height="108dp"
    android:viewportWidth="512"
    android:viewportHeight="512">
  <group android:scaleX="0.7135135"
      android:scaleY="0.7135135"
      android:translateX="73.34054"
      android:translateY="73.34054">
    <path
        android:pathData="M304.42,123.08Q319,99.08 322,92.18a7.08,7.08 0,0 0,-1.31 -7.8,3.79 3.79,0 0,0 -3.18,-1.44c-3.51,0.12 -5.65,-0.63 -7.93,2.69a60.66,60.66 0,0 0,-5.37 9.64c-3.33,7.48 -7.67,14.36 -11.54,21.59a0.86,0.86 0,0 1,-1.07 0.39c-14.4,-5.52 -30.47,-7.17 -45.76,-6a94.62,94.62 0,0 0,-26 6,1.15 1.15,0 0,1 -1.41,-0.5c-3.84,-6.48 -7.19,-12.44 -10.77,-20 -2.1,-4.42 -4.6,-9.64 -8.21,-13.08a1.81,1.81 0,0 0,-1 -0.49c-4.23,-0.57 -9.27,-0.79 -9.95,4.78a12.35,12.35 0,0 0,1.87 7.43q7.75,14 15.7,27.43a1.21,1.21 0,0 1,-0.43 1.64c-26.65,15.7 -44,42.33 -43.91,73.42a0.67,0.67 0,0 0,0.67 0.67l186.39,-0.1a1.39,1.39 0,0 0,1.39 -1.4v-0.08c-0.76,-11.39 -2.94,-22.68 -8,-33.18q-12,-25.2 -37.52,-40a0.45,0.45 0,0 1,-0.18 -0.69"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#237c4b"/>
    <path
        android:pathData="M136.32,330.27A21.63,21.63 0,0 0,156 309.12q0,-43.94 0,-86c0,-5.5 -1.13,-10.51 -4.75,-14.87a22.21,22.21 0,0 0,-35.45 1.63,9.93 9.93,0 0,0 -1.81,5.86q0,49.15 0,98.85a10.64,10.64 0,0 0,1.8 6q7.55,10.76 20.5,9.7"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#237c4b"/>
    <path
        android:pathData="M398.87,221.61a21.3,21.3 0,0 0,-21.33 -21.26h-1.48a21.3,21.3 0,0 0,-21.27 21.34l0.16,87.22a21.3,21.3 0,0 0,21.33 21.26h1.48A21.3,21.3 0,0 0,399 308.83l-0.16,-87.22"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#237c4b"/>
    <path
        android:pathData="M243.08,363l24.62,-0.05a0.45,0.45 0,0 1,0.52 0.51q0.13,17.21 -0.06,34.75 -0.14,11 1.41,16 2.76,8.84 12.66,13.73c3,1.5 7.25,1.17 10.62,1.18a15,15 0,0 0,9.09 -3q10,-7.66 10.08,-20.67 0.14,-19.67 -0.07,-41.42c0,-0.76 0.36,-1.12 1.13,-1.09a115.4,115.4 0,0 0,11.91 0c16.94,-0.9 25.13,-12.07 25.11,-28.21q-0.06,-64.95 0,-129.87a0.8,0.8 0,0 0,-0.8 -0.81h-187a0.83,0.83 0,0 0,-0.82 0.83h0q0.35,61.24 0.08,128c0,9.74 0.26,15.67 6.6,22.33 8.58,9 19.77,8 31.25,7.75a0.42,0.42 0,0 1,0.42 0.41q0,21.4 -0.08,43.79a22.1,22.1 0,0 0,1.47 8.58c2.18,5.27 8.63,12.65 15.17,13.15 4.89,0.37 10.12,0.7 14.42,-1.79 7.15,-4.16 12,-10.91 11.91,-19.12q-0.18,-22.17 -0.09,-44.46a0.48,0.48 0,0 1,0.54 -0.54"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#237c4b"/>
    <path
        android:pathData="M202.24,142.7a73.29,73.29 0,0 0,-26 41.57,0.6 0.6,0 0,0 0.46,0.71h0.12q78.3,0 156.93,0a3,3 0,0 0,1 -0.16,0.52 0.52,0 0,0 0.39,-0.7c-2.83,-12 -8.39,-23.5 -16.83,-32.58a93.87,93.87 0,0 0,-21.1 -17.25,63.89 63.89,0 0,0 -13.06,-5.64 98.42,98.42 0,0 0,-13.78 -3.44,89.93 89.93,0 0,0 -45.77,4.37 61,61 0,0 0,-13.44 6.6q-4.54,3.09 -8.86,6.55"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#237c4b"/>
    <path
        android:pathData="M143,222.08a8.63,8.63 0,0 0,-8.63 -8.63H134a8.63,8.63 0,0 0,-8.63 8.63h0V308.7a8.63,8.63 0,0 0,8.63 8.63h0.3A8.63,8.63 0,0 0,143 308.7V222.08"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#237c4b"/>
    <path
        android:pathData="M385.51,221.45a7.87,7.87 0,0 0,-7.84 -7.9h-1a7.87,7.87 0,0 0,-7.9 7.84l-0.3,88a7.87,7.87 0,0 0,7.84 7.9h1a7.87,7.87 0,0 0,7.9 -7.84l0.3,-88"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#237c4b"/>
    <path
        android:pathData="M204.46,350.63c5.26,1.85 7.52,8.11 7.51,13.3q0,18.68 0,40.92a18.92,18.92 0,0 0,0.66 5A8.41,8.41 0,0 0,225 415q5,-2.91 5,-10.15 -0.07,-20.33 0,-42.76 0,-7.64 6.29,-11.18a17.67,17.67 0,0 1,7.48 -1.69q12.3,0 23.73,0a5.94,5.94 0,0 1,1.77 0.27c1.44,0.45 3,0.49 4.37,1.13q7.94,3.69 7.85,12.49 -0.25,23.72 0.25,43.09a10.52,10.52 0,0 0,3.45 7.89,8.43 8.43,0 0,0 13.05,-2.88 13.45,13.45 0,0 0,1 -5.33q-0.1,-20.39 0,-39.88c0,-6.48 2.17,-13.84 9,-15.7a24,24 0,0 1,6 -1.08q5.76,0 11.39,0.07a10.06,10.06 0,0 0,8.7 -3.85c2.38,-3.09 2.06,-7.7 2,-11.44q-0.24,-50.9 0,-100.2 0,-8.13 0.52,-16.54a0.48,0.48 0,0 0,-0.45 -0.51h-161a0.48,0.48 0,0 0,-0.49 0.48h0q0,59.14 -0.07,118.94c0,5.08 0.71,9.07 5.52,11.79a12.21,12.21 0,0 0,6.63 1.36c5.86,-0.24 12,-0.69 17.6,1.26"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#237c4b"/>
    <path
        android:pathData="M256.14,241.06c2.47,1.21 4.51,5.41 5.77,7.73a1.87,1.87 0,0 0,2.66 0.93l5.18,-2.23a1.7,1.7 0,0 0,1 -2.45,28.37 28.37,0 0,0 -8.27,-11.56c-9.1,-7.71 -17.26,1.13 -21.57,9.18a14.06,14.06 0,0 0,-1.4 3.83,1 1,0 0,0 0.29,0.94c1.51,1.49 4.46,2.26 6.39,3a2.41,2.41 0,0 0,3.13 -1.35l0.05,-0.14a19.08,19.08 0,0 1,4.66 -7.56,1.83 1.83,0 0,1 2.08,-0.34"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#237c4b"/>
    <path
        android:pathData="M244,262.69a0.45,0.45 0,0 1,0.2 0.6,0.4 0.4,0 0,1 -0.16,0.18c-8.73,5.77 -16.12,12.75 -23.42,20.14a77.72,77.72 0,0 0,-9.36 11.74c-5.51,8.31 -10.38,26.49 5.94,27.34 11,0.56 23.33,-4.52 33.21,-9.79 5.46,-2.91 10.75,-6.8 16,-10.29C279.23,294 293.2,281.16 301.47,267a24.68,24.68 0,0 0,2.5 -16.87c-0.84,-4.13 -6.55,-6.3 -10.17,-6.6a40.62,40.62 0,0 0,-15.52 2.07,98.9 98.9,0 0,0 -22.7,10.19 0.79,0.79 0,0 1,-0.84 0,136.77 136.77,0 0,0 -18.21,-8.14c-8.95,-3.25 -29.8,-8.43 -30.71,7.3 -0.2,3.48 1,6.81 2.12,10.08a8,8 0,0 1,0.25 4.07c-0.89,4.78 0.63,9.48 5.19,11.62q6.41,3 11.39,-1.84c6.58,-6.38 3.13,-16.56 -5.94,-17.65A3.7,3.7 0,0 1,215.6 257a2.54,2.54 0,0 1,2.53 -2.4c8,-0.67 18.37,4.28 25.87,8.09"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#237c4b"/>
    <path
        android:pathData="M295.13,307.57c0,0.63 0,1.25 0,1.88a2.06,2.06 0,0 1,-2.13 2.28c-8.24,0.66 -17.51,-3.69 -24.95,-7.42a2.45,2.45 0,0 0,-2.4 0.11l-6.94,4.3a1.72,1.72 0,0 0,-0.56 2.37,1.7 1.7,0 0,0 0.64,0.61 89.73,89.73 0,0 0,28.29 10.15c4.74,0.81 13.83,0.63 16.4,-4.11 3,-5.59 1.52,-10.36 0,-17 -0.66,-2.82 0.13,-5.78 -0.93,-8.44 -1.8,-4.51 -6.79,-8.14 -11.84,-6.81 -5.57,1.47 -10.46,7.66 -7.77,13.69q3.13,7 10.69,7a1.32,1.32 0,0 1,1.51 1.43"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#237c4b"/>
    <path
        android:pathData="M258.74,323c-4.24,6 -8,-2.7 -9.08,-5.69a1.92,1.92 0,0 0,-2.24 -1.23,21.29 21.29,0 0,0 -6.63,2.68 1.86,1.86 0,0 0,-0.8 2.55c3.17,7.55 12,19.16 21.61,12.47q5.94,-4.15 9.42,-12.37a2.53,2.53 0,0 0,-1.44 -3.69l-4.16,-1.88a2.34,2.34 0,0 0,-3.54 1.39,30.07 30.07,0 0,1 -3.14,5.77"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#237c4b"/>
    <path
        android:pathData="M252.39,295.58a1.36,1.36 0,0 1,-0.44 1.57,65 65,0 0,1 -6.55,4.29 2.69,2.69 0,0 1,-3.07 -0.08,124 124,0 0,1 -12.82,-10.07 0.93,0.93 0,0 0,-1.29 0c-4,4 -12.35,13 -12.18,18.91a2.06,2.06 0,0 0,1.92 2,26.58 26.58,0 0,0 11.29,-1.58 121.66,121.66 0,0 0,24.36 -12.43,212.63 212.63,0 0,0 25.07,-19.73c6,-5.5 14,-13.41 16,-21.4 1.65,-6.65 -13.58,-1.58 -16.06,-0.51q-6,2.61 -12.34,5.71a0.54,0.54 0,0 0,-0.25 0.71,0.64 0.64,0 0,0 0.19,0.21 137.63,137.63 0,0 1,12.46 9.29,2 2,0 0,1 0.3,3.15 21.39,21.39 0,0 1,-6 5.14,2.06 2.06,0 0,1 -2.34,-0.21 134.52,134.52 0,0 0,-14.92 -10.77,0.78 0.78,0 0,0 -0.9,0 157.9,157.9 0,0 0,-17.7 13.43,0.33 0.33,0 0,0 0,0.45l0.06,0.05q7.53,5.38 14.56,10.95a2.16,2.16 0,0 1,0.68 0.9"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#237c4b"/>
    <path
        android:pathData="M261.87,275a8.83,8.83 0,0 0,-12.49 0l-2,2a8.82,8.82 0,0 0,0 12.48h0l2,2a8.83,8.83 0,0 0,12.49 0l2,-2a8.82,8.82 0,0 0,0 -12.48h0l-2,-2"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#237c4b"/>
    <path
        android:pathData="M304.6,123.77q25.48,14.78 37.52,40c5,10.5 7.2,21.79 8,33.18a1.4,1.4 0,0 1,-1.31 1.48h-0.08l-186.39,0.1a0.67,0.67 0,0 1,-0.67 -0.67c-0.09,-31.09 17.26,-57.72 43.91,-73.42a1.21,1.21 0,0 0,0.43 -1.64q-7.93,-13.45 -15.7,-27.43a12.35,12.35 0,0 1,-1.87 -7.43c0.68,-5.57 5.72,-5.35 9.95,-4.78a1.81,1.81 0,0 1,1 0.49c3.61,3.44 6.11,8.66 8.21,13.08 3.58,7.57 6.93,13.53 10.77,20a1.15,1.15 0,0 0,1.41 0.5,94.62 94.62,0 0,1 26,-6c15.29,-1.15 31.36,0.5 45.76,6a0.86,0.86 0,0 0,1.07 -0.39c3.87,-7.23 8.21,-14.11 11.54,-21.59a60.66,60.66 0,0 1,5.37 -9.64c2.28,-3.32 4.42,-2.57 7.93,-2.69a3.79,3.79 0,0 1,3.18 1.44,7.08 7.08,0 0,1 1.31,7.8q-3,6.9 -17.56,30.9A0.45,0.45 0,0 0,304.6 123.77ZM202.24,142.7a73.29,73.29 0,0 0,-26 41.57,0.6 0.6,0 0,0 0.46,0.71h0.12q78.3,0 156.93,0a3,3 0,0 0,1 -0.16,0.52 0.52,0 0,0 0.39,-0.7c-2.83,-12 -8.39,-23.5 -16.83,-32.58a93.87,93.87 0,0 0,-21.1 -17.25,63.89 63.89,0 0,0 -13.06,-5.64 98.42,98.42 0,0 0,-13.78 -3.44,89.93 89.93,0 0,0 -45.77,4.37 61,61 0,0 0,-13.44 6.6Q206.56,139.24 202.24,142.7Z"
        android:fillColor="#3ddc84"/>
    <path
        android:pathData="M156,309.12a21.63,21.63 0,0 1,-19.68 21.15q-13,1.07 -20.5,-9.7a10.64,10.64 0,0 1,-1.8 -6q0,-49.69 0,-98.85a9.93,9.93 0,0 1,1.81 -5.86,22.21 22.21,0 0,1 35.45,-1.63c3.62,4.36 4.75,9.37 4.75,14.87Q156,265.18 156,309.12ZM142.95,222.12a8.63,8.63 0,0 0,-8.63 -8.63L134,213.49a8.63,8.63 0,0 0,-8.63 8.63h0L125.37,308.7a8.63,8.63 0,0 0,8.63 8.63h0.3A8.63,8.63 0,0 0,143 308.7Z"
        android:fillColor="#3ddc84"/>
    <path
        android:pathData="M399,308.83a21.3,21.3 0,0 1,-21.27 21.34h-1.48A21.3,21.3 0,0 1,355 308.91h0l-0.16,-87.22a21.3,21.3 0,0 1,21.27 -21.34h1.48a21.3,21.3 0,0 1,21.33 21.26h0ZM385.48,221.45a7.87,7.87 0,0 0,-7.84 -7.9h-1a7.87,7.87 0,0 0,-7.9 7.84l-0.3,88a7.87,7.87 0,0 0,7.84 7.9h1a7.87,7.87 0,0 0,7.9 -7.84Z"
        android:fillColor="#3ddc84"/>
    <path
        android:pathData="M242.54,363.52q-0.09,22.29 0.09,44.46c0.07,8.21 -4.76,15 -11.91,19.12 -4.3,2.49 -9.53,2.16 -14.42,1.79 -6.54,-0.5 -13,-7.88 -15.17,-13.15a22.1,22.1 0,0 1,-1.47 -8.58q0.12,-22.4 0.08,-43.79a0.42,0.42 0,0 0,-0.42 -0.41c-11.48,0.22 -22.67,1.25 -31.25,-7.75 -6.34,-6.66 -6.64,-12.59 -6.6,-22.33q0.27,-66.81 -0.08,-128a0.83,0.83 0,0 1,0.82 -0.83h187a0.8,0.8 0,0 1,0.8 0.81q0,64.92 0,129.87c0,16.14 -8.17,27.31 -25.11,28.21a115.4,115.4 0,0 1,-11.91 0c-0.77,0 -1.14,0.33 -1.13,1.09q0.19,21.76 0.07,41.42 -0.09,13 -10.08,20.67a15,15 0,0 1,-9.09 3c-3.37,0 -7.6,0.32 -10.62,-1.18q-9.9,-4.9 -12.66,-13.73 -1.54,-4.92 -1.41,-16 0.19,-17.55 0.06,-34.75a0.45,0.45 0,0 0,-0.52 -0.51l-24.62,0.05A0.48,0.48 0,0 0,242.54 363.52ZM204.46,350.63c5.26,1.85 7.52,8.11 7.51,13.3q0,18.68 0,40.92a18.92,18.92 0,0 0,0.66 5A8.41,8.41 0,0 0,225 415q5,-2.91 5,-10.15 -0.07,-20.33 0,-42.76 0,-7.64 6.29,-11.18a17.67,17.67 0,0 1,7.48 -1.69q12.3,0 23.73,0a5.94,5.94 0,0 1,1.77 0.27c1.44,0.45 3,0.49 4.37,1.13q7.94,3.69 7.85,12.49 -0.25,23.72 0.25,43.09a10.52,10.52 0,0 0,3.45 7.89,8.43 8.43,0 0,0 13.05,-2.88 13.45,13.45 0,0 0,1 -5.33q-0.1,-20.39 0,-39.88c0,-6.48 2.17,-13.84 9,-15.7a24,24 0,0 1,6 -1.08q5.76,0 11.39,0.07a10.06,10.06 0,0 0,8.7 -3.85c2.38,-3.09 2.06,-7.7 2,-11.44q-0.24,-50.9 0,-100.2 0,-8.13 0.52,-16.54a0.48,0.48 0,0 0,-0.45 -0.51h-161a0.48,0.48 0,0 0,-0.49 0.48h0q0,59.14 -0.07,118.94c0,5.08 0.71,9.07 5.52,11.79a12.21,12.21 0,0 0,6.63 1.36C192.72,349.13 198.89,348.68 204.46,350.63Z"
        android:fillColor="#3ddc84"/>
    <path
        android:pathData="M256.14,241.06a1.83,1.83 0,0 0,-2.08 0.34A19.08,19.08 0,0 0,249.4 249a2.42,2.42 0,0 1,-3 1.54l-0.14,-0.05c-1.93,-0.76 -4.88,-1.53 -6.39,-3a1,1 0,0 1,-0.29 -0.94,14.06 14.06,0 0,1 1.4,-3.83c4.31,-8 12.47,-16.89 21.57,-9.18A28.37,28.37 0,0 1,270.78 245a1.7,1.7 0,0 1,-1 2.45l-5.18,2.23a1.87,1.87 0,0 1,-2.66 -0.93C260.65,246.47 258.61,242.27 256.14,241.06Z"
        android:fillColor="#3ddc84"/>
    <path
        android:pathData="M244,262.69c-7.5,-3.81 -17.85,-8.76 -25.87,-8.09a2.54,2.54 0,0 0,-2.53 2.4,3.7 3.7,0 0,0 3.23,4.21c9.07,1.09 12.52,11.27 5.94,17.65q-5,4.83 -11.39,1.84c-4.56,-2.14 -6.08,-6.84 -5.19,-11.62a8,8 0,0 0,-0.25 -4.07c-1.1,-3.27 -2.32,-6.6 -2.12,-10.08 0.91,-15.73 21.76,-10.55 30.71,-7.3a136.77,136.77 0,0 1,18.21 8.14,0.79 0.79,0 0,0 0.84,0 98.9,98.9 0,0 1,22.7 -10.19,40.62 40.62,0 0,1 15.52,-2.07c3.62,0.3 9.33,2.47 10.17,6.6a24.68,24.68 0,0 1,-2.5 16.87c-8.27,14.21 -22.24,27.08 -35.09,35.66 -5.22,3.49 -10.51,7.38 -16,10.29 -9.88,5.27 -22.24,10.35 -33.21,9.79 -16.32,-0.85 -11.45,-19 -5.94,-27.34a77.72,77.72 0,0 1,9.36 -11.74c7.3,-7.39 14.69,-14.37 23.42,-20.14a0.45,0.45 0,0 0,0.14 -0.62A0.55,0.55 0,0 0,244 262.69ZM252.39,295.58a1.36,1.36 0,0 1,-0.44 1.57,65 65,0 0,1 -6.55,4.29 2.69,2.69 0,0 1,-3.07 -0.08,124 124,0 0,1 -12.82,-10.07 0.93,0.93 0,0 0,-1.29 0c-4,4 -12.35,13 -12.18,18.91a2.06,2.06 0,0 0,1.92 2,26.58 26.58,0 0,0 11.29,-1.58 121.66,121.66 0,0 0,24.36 -12.43,212.63 212.63,0 0,0 25.07,-19.73c6,-5.5 14,-13.41 16,-21.4 1.65,-6.65 -13.58,-1.58 -16.06,-0.51q-6,2.61 -12.34,5.71a0.54,0.54 0,0 0,-0.25 0.71,0.64 0.64,0 0,0 0.19,0.21 137.63,137.63 0,0 1,12.46 9.29,2 2,0 0,1 0.3,3.15 21.39,21.39 0,0 1,-6 5.14,2.06 2.06,0 0,1 -2.34,-0.21 134.52,134.52 0,0 0,-14.92 -10.77,0.78 0.78,0 0,0 -0.9,0 157.9,157.9 0,0 0,-17.7 13.43,0.33 0.33,0 0,0 0,0.45l0.06,0.05q7.53,5.38 14.56,10.95A2.16,2.16 0,0 1,252.39 295.58Z"
        android:fillColor="#3ddc84"/>
    <path
        android:pathData="M247.42,276.94L249.39,274.98A8.83,8.83 90.2,0 1,261.88 275.02L263.88,277.04A8.83,8.83 90.2,0 1,263.83 289.53L261.86,291.49A8.83,8.83 90.2,0 1,249.37 291.44L247.37,289.43A8.83,8.83 90.2,0 1,247.42 276.94z"
        android:fillColor="#3ddc84"/>
    <path
        android:pathData="M293.62,306.14q-7.56,0 -10.69,-7c-2.69,-6 2.2,-12.22 7.77,-13.69 5.05,-1.33 10,2.3 11.84,6.81 1.06,2.66 0.27,5.62 0.93,8.44 1.56,6.67 3.08,11.44 0,17 -2.57,4.74 -11.66,4.92 -16.4,4.11a89.73,89.73 0,0 1,-28.29 -10.15,1.73 1.73,0 0,1 -0.69,-2.34 1.78,1.78 0,0 1,0.61 -0.64l6.94,-4.3a2.45,2.45 0,0 1,2.4 -0.11c7.44,3.73 16.71,8.08 24.95,7.42a2.06,2.06 0,0 0,2.13 -2.28c0,-0.63 0,-1.25 0,-1.88A1.32,1.32 0,0 0,293.62 306.14Z"
        android:fillColor="#3ddc84"/>
    <path
        android:pathData="M249.66,317.34c1.05,3 4.84,11.72 9.08,5.69a30.07,30.07 0,0 0,3.14 -5.77,2.34 2.34,0 0,1 3.54,-1.39l4.16,1.88a2.53,2.53 0,0 1,1.44 3.69q-3.48,8.22 -9.42,12.37c-9.59,6.69 -18.44,-4.92 -21.61,-12.47a1.86,1.86 0,0 1,0.8 -2.55,21.29 21.29,0 0,1 6.63,-2.68A1.92,1.92 0,0 1,249.66 317.34Z"
        android:fillColor="#3ddc84"/>
  </group>
</vector>

```

`app/src/main/res/drawable/ic_launcher_monochrome.xml`:

```xml
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="108dp"
    android:height="108dp"
    android:viewportWidth="512"
    android:viewportHeight="512">
  <group android:scaleX="0.7135135"
      android:scaleY="0.7135135"
      android:translateX="73.34054"
      android:translateY="73.34054">
    <path
        android:pathData="M304.42,123.08Q319,99.08 322,92.18a7.08,7.08 0,0 0,-1.31 -7.8,3.79 3.79,0 0,0 -3.18,-1.44c-3.51,0.12 -5.65,-0.63 -7.93,2.69a60.66,60.66 0,0 0,-5.37 9.64c-3.33,7.48 -7.67,14.36 -11.54,21.59a0.86,0.86 0,0 1,-1.07 0.39c-14.4,-5.52 -30.47,-7.17 -45.76,-6a94.62,94.62 0,0 0,-26 6,1.15 1.15,0 0,1 -1.41,-0.5c-3.84,-6.48 -7.19,-12.44 -10.77,-20 -2.1,-4.42 -4.6,-9.64 -8.21,-13.08a1.81,1.81 0,0 0,-1 -0.49c-4.23,-0.57 -9.27,-0.79 -9.95,4.78a12.35,12.35 0,0 0,1.87 7.43q7.75,14 15.7,27.43a1.21,1.21 0,0 1,-0.43 1.64c-26.65,15.7 -44,42.33 -43.91,73.42a0.67,0.67 0,0 0,0.67 0.67l186.39,-0.1a1.39,1.39 0,0 0,1.39 -1.4v-0.08c-0.76,-11.39 -2.94,-22.68 -8,-33.18q-12,-25.2 -37.52,-40a0.45,0.45 0,0 1,-0.18 -0.69"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#FF000000"/>
    <path
        android:pathData="M136.32,330.27A21.63,21.63 0,0 0,156 309.12q0,-43.94 0,-86c0,-5.5 -1.13,-10.51 -4.75,-14.87a22.21,22.21 0,0 0,-35.45 1.63,9.93 9.93,0 0,0 -1.81,5.86q0,49.15 0,98.85a10.64,10.64 0,0 0,1.8 6q7.55,10.76 20.5,9.7"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#FF000000"/>
    <path
        android:pathData="M398.87,221.61a21.3,21.3 0,0 0,-21.33 -21.26h-1.48a21.3,21.3 0,0 0,-21.27 21.34l0.16,87.22a21.3,21.3 0,0 0,21.33 21.26h1.48A21.3,21.3 0,0 0,399 308.83l-0.16,-87.22"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#FF000000"/>
    <path
        android:pathData="M243.08,363l24.62,-0.05a0.45,0.45 0,0 1,0.52 0.51q0.13,17.21 -0.06,34.75 -0.14,11 1.41,16 2.76,8.84 12.66,13.73c3,1.5 7.25,1.17 10.62,1.18a15,15 0,0 0,9.09 -3q10,-7.66 10.08,-20.67 0.14,-19.67 -0.07,-41.42c0,-0.76 0.36,-1.12 1.13,-1.09a115.4,115.4 0,0 0,11.91 0c16.94,-0.9 25.13,-12.07 25.11,-28.21q-0.06,-64.95 0,-129.87a0.8,0.8 0,0 0,-0.8 -0.81h-187a0.83,0.83 0,0 0,-0.82 0.83h0q0.35,61.24 0.08,128c0,9.74 0.26,15.67 6.6,22.33 8.58,9 19.77,8 31.25,7.75a0.42,0.42 0,0 1,0.42 0.41q0,21.4 -0.08,43.79a22.1,22.1 0,0 0,1.47 8.58c2.18,5.27 8.63,12.65 15.17,13.15 4.89,0.37 10.12,0.7 14.42,-1.79 7.15,-4.16 12,-10.91 11.91,-19.12q-0.18,-22.17 -0.09,-44.46a0.48,0.48 0,0 1,0.54 -0.54"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#FF000000"/>
    <path
        android:pathData="M202.24,142.7a73.29,73.29 0,0 0,-26 41.57,0.6 0.6,0 0,0 0.46,0.71h0.12q78.3,0 156.93,0a3,3 0,0 0,1 -0.16,0.52 0.52,0 0,0 0.39,-0.7c-2.83,-12 -8.39,-23.5 -16.83,-32.58a93.87,93.87 0,0 0,-21.1 -17.25,63.89 63.89,0 0,0 -13.06,-5.64 98.42,98.42 0,0 0,-13.78 -3.44,89.93 89.93,0 0,0 -45.77,4.37 61,61 0,0 0,-13.44 6.6q-4.54,3.09 -8.86,6.55"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#FF000000"/>
    <path
        android:pathData="M143,222.08a8.63,8.63 0,0 0,-8.63 -8.63H134a8.63,8.63 0,0 0,-8.63 8.63h0V308.7a8.63,8.63 0,0 0,8.63 8.63h0.3A8.63,8.63 0,0 0,143 308.7V222.08"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#FF000000"/>
    <path
        android:pathData="M385.51,221.45a7.87,7.87 0,0 0,-7.84 -7.9h-1a7.87,7.87 0,0 0,-7.9 7.84l-0.3,88a7.87,7.87 0,0 0,7.84 7.9h1a7.87,7.87 0,0 0,7.9 -7.84l0.3,-88"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#FF000000"/>
    <path
        android:pathData="M204.46,350.63c5.26,1.85 7.52,8.11 7.51,13.3q0,18.68 0,40.92a18.92,18.92 0,0 0,0.66 5A8.41,8.41 0,0 0,225 415q5,-2.91 5,-10.15 -0.07,-20.33 0,-42.76 0,-7.64 6.29,-11.18a17.67,17.67 0,0 1,7.48 -1.69q12.3,0 23.73,0a5.94,5.94 0,0 1,1.77 0.27c1.44,0.45 3,0.49 4.37,1.13q7.94,3.69 7.85,12.49 -0.25,23.72 0.25,43.09a10.52,10.52 0,0 0,3.45 7.89,8.43 8.43,0 0,0 13.05,-2.88 13.45,13.45 0,0 0,1 -5.33q-0.1,-20.39 0,-39.88c0,-6.48 2.17,-13.84 9,-15.7a24,24 0,0 1,6 -1.08q5.76,0 11.39,0.07a10.06,10.06 0,0 0,8.7 -3.85c2.38,-3.09 2.06,-7.7 2,-11.44q-0.24,-50.9 0,-100.2 0,-8.13 0.52,-16.54a0.48,0.48 0,0 0,-0.45 -0.51h-161a0.48,0.48 0,0 0,-0.49 0.48h0q0,59.14 -0.07,118.94c0,5.08 0.71,9.07 5.52,11.79a12.21,12.21 0,0 0,6.63 1.36c5.86,-0.24 12,-0.69 17.6,1.26"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#FF000000"/>
    <path
        android:pathData="M256.14,241.06c2.47,1.21 4.51,5.41 5.77,7.73a1.87,1.87 0,0 0,2.66 0.93l5.18,-2.23a1.7,1.7 0,0 0,1 -2.45,28.37 28.37,0 0,0 -8.27,-11.56c-9.1,-7.71 -17.26,1.13 -21.57,9.18a14.06,14.06 0,0 0,-1.4 3.83,1 1,0 0,0 0.29,0.94c1.51,1.49 4.46,2.26 6.39,3a2.41,2.41 0,0 0,3.13 -1.35l0.05,-0.14a19.08,19.08 0,0 1,4.66 -7.56,1.83 1.83,0 0,1 2.08,-0.34"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#FF000000"/>
    <path
        android:pathData="M244,262.69a0.45,0.45 0,0 1,0.2 0.6,0.4 0.4,0 0,1 -0.16,0.18c-8.73,5.77 -16.12,12.75 -23.42,20.14a77.72,77.72 0,0 0,-9.36 11.74c-5.51,8.31 -10.38,26.49 5.94,27.34 11,0.56 23.33,-4.52 33.21,-9.79 5.46,-2.91 10.75,-6.8 16,-10.29C279.23,294 293.2,281.16 301.47,267a24.68,24.68 0,0 0,2.5 -16.87c-0.84,-4.13 -6.55,-6.3 -10.17,-6.6a40.62,40.62 0,0 0,-15.52 2.07,98.9 98.9,0 0,0 -22.7,10.19 0.79,0.79 0,0 1,-0.84 0,136.77 136.77,0 0,0 -18.21,-8.14c-8.95,-3.25 -29.8,-8.43 -30.71,7.3 -0.2,3.48 1,6.81 2.12,10.08a8,8 0,0 1,0.25 4.07c-0.89,4.78 0.63,9.48 5.19,11.62q6.41,3 11.39,-1.84c6.58,-6.38 3.13,-16.56 -5.94,-17.65A3.7,3.7 0,0 1,215.6 257a2.54,2.54 0,0 1,2.53 -2.4c8,-0.67 18.37,4.28 25.87,8.09"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#FF000000"/>
    <path
        android:pathData="M295.13,307.57c0,0.63 0,1.25 0,1.88a2.06,2.06 0,0 1,-2.13 2.28c-8.24,0.66 -17.51,-3.69 -24.95,-7.42a2.45,2.45 0,0 0,-2.4 0.11l-6.94,4.3a1.72,1.72 0,0 0,-0.56 2.37,1.7 1.7,0 0,0 0.64,0.61 89.73,89.73 0,0 0,28.29 10.15c4.74,0.81 13.83,0.63 16.4,-4.11 3,-5.59 1.52,-10.36 0,-17 -0.66,-2.82 0.13,-5.78 -0.93,-8.44 -1.8,-4.51 -6.79,-8.14 -11.84,-6.81 -5.57,1.47 -10.46,7.66 -7.77,13.69q3.13,7 10.69,7a1.32,1.32 0,0 1,1.51 1.43"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#FF000000"/>
    <path
        android:pathData="M258.74,323c-4.24,6 -8,-2.7 -9.08,-5.69a1.92,1.92 0,0 0,-2.24 -1.23,21.29 21.29,0 0,0 -6.63,2.68 1.86,1.86 0,0 0,-0.8 2.55c3.17,7.55 12,19.16 21.61,12.47q5.94,-4.15 9.42,-12.37a2.53,2.53 0,0 0,-1.44 -3.69l-4.16,-1.88a2.34,2.34 0,0 0,-3.54 1.39,30.07 30.07,0 0,1 -3.14,5.77"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#FF000000"/>
    <path
        android:pathData="M252.39,295.58a1.36,1.36 0,0 1,-0.44 1.57,65 65,0 0,1 -6.55,4.29 2.69,2.69 0,0 1,-3.07 -0.08,124 124,0 0,1 -12.82,-10.07 0.93,0.93 0,0 0,-1.29 0c-4,4 -12.35,13 -12.18,18.91a2.06,2.06 0,0 0,1.92 2,26.58 26.58,0 0,0 11.29,-1.58 121.66,121.66 0,0 0,24.36 -12.43,212.63 212.63,0 0,0 25.07,-19.73c6,-5.5 14,-13.41 16,-21.4 1.65,-6.65 -13.58,-1.58 -16.06,-0.51q-6,2.61 -12.34,5.71a0.54,0.54 0,0 0,-0.25 0.71,0.64 0.64,0 0,0 0.19,0.21 137.63,137.63 0,0 1,12.46 9.29,2 2,0 0,1 0.3,3.15 21.39,21.39 0,0 1,-6 5.14,2.06 2.06,0 0,1 -2.34,-0.21 134.52,134.52 0,0 0,-14.92 -10.77,0.78 0.78,0 0,0 -0.9,0 157.9,157.9 0,0 0,-17.7 13.43,0.33 0.33,0 0,0 0,0.45l0.06,0.05q7.53,5.38 14.56,10.95a2.16,2.16 0,0 1,0.68 0.9"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#FF000000"/>
    <path
        android:pathData="M261.87,275a8.83,8.83 0,0 0,-12.49 0l-2,2a8.82,8.82 0,0 0,0 12.48h0l2,2a8.83,8.83 0,0 0,12.49 0l2,-2a8.82,8.82 0,0 0,0 -12.48h0l-2,-2"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#FF000000"/>
    <path
        android:pathData="M304.6,123.77q25.48,14.78 37.52,40c5,10.5 7.2,21.79 8,33.18a1.4,1.4 0,0 1,-1.31 1.48h-0.08l-186.39,0.1a0.67,0.67 0,0 1,-0.67 -0.67c-0.09,-31.09 17.26,-57.72 43.91,-73.42a1.21,1.21 0,0 0,0.43 -1.64q-7.93,-13.45 -15.7,-27.43a12.35,12.35 0,0 1,-1.87 -7.43c0.68,-5.57 5.72,-5.35 9.95,-4.78a1.81,1.81 0,0 1,1 0.49c3.61,3.44 6.11,8.66 8.21,13.08 3.58,7.57 6.93,13.53 10.77,20a1.15,1.15 0,0 0,1.41 0.5,94.62 94.62,0 0,1 26,-6c15.29,-1.15 31.36,0.5 45.76,6a0.86,0.86 0,0 0,1.07 -0.39c3.87,-7.23 8.21,-14.11 11.54,-21.59a60.66,60.66 0,0 1,5.37 -9.64c2.28,-3.32 4.42,-2.57 7.93,-2.69a3.79,3.79 0,0 1,3.18 1.44,7.08 7.08,0 0,1 1.31,7.8q-3,6.9 -17.56,30.9A0.45,0.45 0,0 0,304.6 123.77ZM202.24,142.7a73.29,73.29 0,0 0,-26 41.57,0.6 0.6,0 0,0 0.46,0.71h0.12q78.3,0 156.93,0a3,3 0,0 0,1 -0.16,0.52 0.52,0 0,0 0.39,-0.7c-2.83,-12 -8.39,-23.5 -16.83,-32.58a93.87,93.87 0,0 0,-21.1 -17.25,63.89 63.89,0 0,0 -13.06,-5.64 98.42,98.42 0,0 0,-13.78 -3.44,89.93 89.93,0 0,0 -45.77,4.37 61,61 0,0 0,-13.44 6.6Q206.56,139.24 202.24,142.7Z"
        android:fillColor="#3ddc84"/>
    <path
        android:pathData="M156,309.12a21.63,21.63 0,0 1,-19.68 21.15q-13,1.07 -20.5,-9.7a10.64,10.64 0,0 1,-1.8 -6q0,-49.69 0,-98.85a9.93,9.93 0,0 1,1.81 -5.86,22.21 22.21,0 0,1 35.45,-1.63c3.62,4.36 4.75,9.37 4.75,14.87Q156,265.18 156,309.12ZM142.95,222.12a8.63,8.63 0,0 0,-8.63 -8.63L134,213.49a8.63,8.63 0,0 0,-8.63 8.63h0L125.37,308.7a8.63,8.63 0,0 0,8.63 8.63h0.3A8.63,8.63 0,0 0,143 308.7Z"
        android:fillColor="#3ddc84"/>
    <path
        android:pathData="M399,308.83a21.3,21.3 0,0 1,-21.27 21.34h-1.48A21.3,21.3 0,0 1,355 308.91h0l-0.16,-87.22a21.3,21.3 0,0 1,21.27 -21.34h1.48a21.3,21.3 0,0 1,21.33 21.26h0ZM385.48,221.45a7.87,7.87 0,0 0,-7.84 -7.9h-1a7.87,7.87 0,0 0,-7.9 7.84l-0.3,88a7.87,7.87 0,0 0,7.84 7.9h1a7.87,7.87 0,0 0,7.9 -7.84Z"
        android:fillColor="#3ddc84"/>
    <path
        android:pathData="M242.54,363.52q-0.09,22.29 0.09,44.46c0.07,8.21 -4.76,15 -11.91,19.12 -4.3,2.49 -9.53,2.16 -14.42,1.79 -6.54,-0.5 -13,-7.88 -15.17,-13.15a22.1,22.1 0,0 1,-1.47 -8.58q0.12,-22.4 0.08,-43.79a0.42,0.42 0,0 0,-0.42 -0.41c-11.48,0.22 -22.67,1.25 -31.25,-7.75 -6.34,-6.66 -6.64,-12.59 -6.6,-22.33q0.27,-66.81 -0.08,-128a0.83,0.83 0,0 1,0.82 -0.83h187a0.8,0.8 0,0 1,0.8 0.81q0,64.92 0,129.87c0,16.14 -8.17,27.31 -25.11,28.21a115.4,115.4 0,0 1,-11.91 0c-0.77,0 -1.14,0.33 -1.13,1.09q0.19,21.76 0.07,41.42 -0.09,13 -10.08,20.67a15,15 0,0 1,-9.09 3c-3.37,0 -7.6,0.32 -10.62,-1.18q-9.9,-4.9 -12.66,-13.73 -1.54,-4.92 -1.41,-16 0.19,-17.55 0.06,-34.75a0.45,0.45 0,0 0,-0.52 -0.51l-24.62,0.05A0.48,0.48 0,0 0,242.54 363.52ZM204.46,350.63c5.26,1.85 7.52,8.11 7.51,13.3q0,18.68 0,40.92a18.92,18.92 0,0 0,0.66 5A8.41,8.41 0,0 0,225 415q5,-2.91 5,-10.15 -0.07,-20.33 0,-42.76 0,-7.64 6.29,-11.18a17.67,17.67 0,0 1,7.48 -1.69q12.3,0 23.73,0a5.94,5.94 0,0 1,1.77 0.27c1.44,0.45 3,0.49 4.37,1.13q7.94,3.69 7.85,12.49 -0.25,23.72 0.25,43.09a10.52,10.52 0,0 0,3.45 7.89,8.43 8.43,0 0,0 13.05,-2.88 13.45,13.45 0,0 0,1 -5.33q-0.1,-20.39 0,-39.88c0,-6.48 2.17,-13.84 9,-15.7a24,24 0,0 1,6 -1.08q5.76,0 11.39,0.07a10.06,10.06 0,0 0,8.7 -3.85c2.38,-3.09 2.06,-7.7 2,-11.44q-0.24,-50.9 0,-100.2 0,-8.13 0.52,-16.54a0.48,0.48 0,0 0,-0.45 -0.51h-161a0.48,0.48 0,0 0,-0.49 0.48h0q0,59.14 -0.07,118.94c0,5.08 0.71,9.07 5.52,11.79a12.21,12.21 0,0 0,6.63 1.36C192.72,349.13 198.89,348.68 204.46,350.63Z"
        android:fillColor="#3ddc84"/>
    <path
        android:pathData="M256.14,241.06a1.83,1.83 0,0 0,-2.08 0.34A19.08,19.08 0,0 0,249.4 249a2.42,2.42 0,0 1,-3 1.54l-0.14,-0.05c-1.93,-0.76 -4.88,-1.53 -6.39,-3a1,1 0,0 1,-0.29 -0.94,14.06 14.06,0 0,1 1.4,-3.83c4.31,-8 12.47,-16.89 21.57,-9.18A28.37,28.37 0,0 1,270.78 245a1.7,1.7 0,0 1,-1 2.45l-5.18,2.23a1.87,1.87 0,0 1,-2.66 -0.93C260.65,246.47 258.61,242.27 256.14,241.06Z"
        android:fillColor="#3ddc84"/>
    <path
        android:pathData="M244,262.69c-7.5,-3.81 -17.85,-8.76 -25.87,-8.09a2.54,2.54 0,0 0,-2.53 2.4,3.7 3.7,0 0,0 3.23,4.21c9.07,1.09 12.52,11.27 5.94,17.65q-5,4.83 -11.39,1.84c-4.56,-2.14 -6.08,-6.84 -5.19,-11.62a8,8 0,0 0,-0.25 -4.07c-1.1,-3.27 -2.32,-6.6 -2.12,-10.08 0.91,-15.73 21.76,-10.55 30.71,-7.3a136.77,136.77 0,0 1,18.21 8.14,0.79 0.79,0 0,0 0.84,0 98.9,98.9 0,0 1,22.7 -10.19,40.62 40.62,0 0,1 15.52,-2.07c3.62,0.3 9.33,2.47 10.17,6.6a24.68,24.68 0,0 1,-2.5 16.87c-8.27,14.21 -22.24,27.08 -35.09,35.66 -5.22,3.49 -10.51,7.38 -16,10.29 -9.88,5.27 -22.24,10.35 -33.21,9.79 -16.32,-0.85 -11.45,-19 -5.94,-27.34a77.72,77.72 0,0 1,9.36 -11.74c7.3,-7.39 14.69,-14.37 23.42,-20.14a0.45,0.45 0,0 0,0.14 -0.62A0.55,0.55 0,0 0,244 262.69ZM252.39,295.58a1.36,1.36 0,0 1,-0.44 1.57,65 65,0 0,1 -6.55,4.29 2.69,2.69 0,0 1,-3.07 -0.08,124 124,0 0,1 -12.82,-10.07 0.93,0.93 0,0 0,-1.29 0c-4,4 -12.35,13 -12.18,18.91a2.06,2.06 0,0 0,1.92 2,26.58 26.58,0 0,0 11.29,-1.58 121.66,121.66 0,0 0,24.36 -12.43,212.63 212.63,0 0,0 25.07,-19.73c6,-5.5 14,-13.41 16,-21.4 1.65,-6.65 -13.58,-1.58 -16.06,-0.51q-6,2.61 -12.34,5.71a0.54,0.54 0,0 0,-0.25 0.71,0.64 0.64,0 0,0 0.19,0.21 137.63,137.63 0,0 1,12.46 9.29,2 2,0 0,1 0.3,3.15 21.39,21.39 0,0 1,-6 5.14,2.06 2.06,0 0,1 -2.34,-0.21 134.52,134.52 0,0 0,-14.92 -10.77,0.78 0.78,0 0,0 -0.9,0 157.9,157.9 0,0 0,-17.7 13.43,0.33 0.33,0 0,0 0,0.45l0.06,0.05q7.53,5.38 14.56,10.95A2.16,2.16 0,0 1,252.39 295.58Z"
        android:fillColor="#3ddc84"/>
    <path
        android:pathData="M247.42,276.94L249.39,274.98A8.83,8.83 90.2,0 1,261.88 275.02L263.88,277.04A8.83,8.83 90.2,0 1,263.83 289.53L261.86,291.49A8.83,8.83 90.2,0 1,249.37 291.44L247.37,289.43A8.83,8.83 90.2,0 1,247.42 276.94z"
        android:fillColor="#3ddc84"/>
    <path
        android:pathData="M293.62,306.14q-7.56,0 -10.69,-7c-2.69,-6 2.2,-12.22 7.77,-13.69 5.05,-1.33 10,2.3 11.84,6.81 1.06,2.66 0.27,5.62 0.93,8.44 1.56,6.67 3.08,11.44 0,17 -2.57,4.74 -11.66,4.92 -16.4,4.11a89.73,89.73 0,0 1,-28.29 -10.15,1.73 1.73,0 0,1 -0.69,-2.34 1.78,1.78 0,0 1,0.61 -0.64l6.94,-4.3a2.45,2.45 0,0 1,2.4 -0.11c7.44,3.73 16.71,8.08 24.95,7.42a2.06,2.06 0,0 0,2.13 -2.28c0,-0.63 0,-1.25 0,-1.88A1.32,1.32 0,0 0,293.62 306.14Z"
        android:fillColor="#3ddc84"/>
    <path
        android:pathData="M249.66,317.34c1.05,3 4.84,11.72 9.08,5.69a30.07,30.07 0,0 0,3.14 -5.77,2.34 2.34,0 0,1 3.54,-1.39l4.16,1.88a2.53,2.53 0,0 1,1.44 3.69q-3.48,8.22 -9.42,12.37c-9.59,6.69 -18.44,-4.92 -21.61,-12.47a1.86,1.86 0,0 1,0.8 -2.55,21.29 21.29,0 0,1 6.63,-2.68A1.92,1.92 0,0 1,249.66 317.34Z"
        android:fillColor="#3ddc84"/>
  </group>
</vector>

```

`app/src/main/res/drawable/info_circle_filled.xml`:

```xml
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="24dp"
    android:height="24dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:pathData="M12,2c5.523,0 10,4.477 10,10a10,10 0,0 1,-19.995 0.324l-0.005,-0.324l0.004,-0.28c0.148,-5.393 4.566,-9.72 9.996,-9.72zM12,11h-1l-0.117,0.007a1,1 0,0 0,0 1.986l0.117,0.007v3l0.007,0.117a1,1 0,0 0,0.876 0.876l0.117,0.007h1l0.117,-0.007a1,1 0,0 0,0.876 -0.876l0.007,-0.117l-0.007,-0.117a1,1 0,0 0,-0.764 -0.857l-0.112,-0.02l-0.117,-0.006v-3l-0.007,-0.117a1,1 0,0 0,-0.876 -0.876l-0.117,-0.007zM12.01,8l-0.127,0.007a1,1 0,0 0,0 1.986l0.117,0.007l0.127,-0.007a1,1 0,0 0,0 -1.986l-0.117,-0.007z"
        android:strokeLineJoin="round"
        android:strokeWidth="0"
        android:fillColor="#ffff"
        android:strokeLineCap="round"/>
</vector>
```

`app/src/main/res/drawable/launcher_splash.xml`:

```xml
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:drawable="@color/ic_launcher_background" />
    <item android:drawable="@drawable/ic_launcher_foreground" />
</layer-list>
```

`app/src/main/res/drawable/package_import.xml`:

```xml
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="24dp"
    android:height="24dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:pathData="M12,21l-8,-4.5v-9l8,-4.5l8,4.5v4.5"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
    <path
        android:pathData="M12,12l8,-4.5"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
    <path
        android:pathData="M12,12v9"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
    <path
        android:pathData="M12,12l-8,-4.5"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
    <path
        android:pathData="M22,18h-7"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
    <path
        android:pathData="M18,15l-3,3l3,3"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
</vector>
```

`app/src/main/res/drawable/play_circle.xml`:

```xml
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="24dp"
    android:height="24dp"
    android:viewportWidth="960"
    android:viewportHeight="960">
  <path
      android:pathData="m380,660 l280,-180 -280,-180v360ZM480,880q-83,0 -156,-31.5T197,763q-54,-54 -85.5,-127T80,480q0,-83 31.5,-156T197,197q54,-54 127,-85.5T480,80q83,0 156,31.5T763,197q54,54 85.5,127T880,480q0,83 -31.5,156T763,763q-54,54 -127,85.5T480,880ZM480,800q134,0 227,-93t93,-227q0,-134 -93,-227t-227,-93q-134,0 -227,93t-93,227q0,134 93,227t227,93ZM480,480Z"
      android:fillColor="#1f1f1f"
      android:strokeColor="#ffffffff"/>
</vector>

```

`app/src/main/res/drawable/settings.xml`:

```xml
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="24dp"
    android:height="24dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:pathData="M10.325,4.317c0.426,-1.756 2.924,-1.756 3.35,0a1.724,1.724 0,0 0,2.573 1.066c1.543,-0.94 3.31,0.826 2.37,2.37a1.724,1.724 0,0 0,1.065 2.572c1.756,0.426 1.756,2.924 0,3.35a1.724,1.724 0,0 0,-1.066 2.573c0.94,1.543 -0.826,3.31 -2.37,2.37a1.724,1.724 0,0 0,-2.572 1.065c-0.426,1.756 -2.924,1.756 -3.35,0a1.724,1.724 0,0 0,-2.573 -1.066c-1.543,0.94 -3.31,-0.826 -2.37,-2.37a1.724,1.724 0,0 0,-1.065 -2.572c-1.756,-0.426 -1.756,-2.924 0,-3.35a1.724,1.724 0,0 0,1.066 -2.573c-0.94,-1.543 0.826,-3.31 2.37,-2.37c1,0.608 2.296,0.07 2.572,-1.065z"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
    <path
        android:pathData="M9,12a3,3 0,1 0,6 0a3,3 0,0 0,-6 0"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
</vector>
```

`app/src/main/res/drawable/telegram.xml`:

```xml
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="24dp"
    android:height="24dp"
    android:viewportWidth="1024"
    android:viewportHeight="1024">
    <path
        android:fillColor="#ffff"
        android:pathData="M769.45,245.76c21.08,-7.47 42.28,-15.36 65.19,-15.36 27.05,0.04 39.94,11.73 40.32,38.83 0.68,44.03 -8.66,87.17 -13.99,130.69 -2.99,24.32 -45.27,285.95 -64.77,392.19 -4.05,22.06 -7.04,44.37 -16.38,65.15 -15.15,33.66 -36.1,43.14 -71.21,31.7 -15.96,-5.21 -29.99,-13.99 -43.78,-23.34 -66.99,-45.27 -211.67,-142.98 -216.7,-146.99 -31.15,-24.87 -36.95,-45.4 -5.42,-78.59 34.86,-36.69 132.44,-124.37 143.15,-134.83a956.84,956.84 0,0 0,84.91 -83.03c5.85,-6.4 12.76,-13.4 5.21,-22.27 -7.34,-8.62 -15.79,-3.84 -23.17,0.73a2884.91,2884.91 0,0 0,-135.42 89.3c-53.72,35.71 -108.46,70.02 -160.77,107.65 -42.67,30.68 -86.74,41.26 -137.47,26.07 -37.89,-11.31 -76.12,-21.5 -113.15,-35.41 -13.87,-5.16 -30.29,-10.45 -30.98,-28.5 -0.6,-16.85 14.12,-24.45 26.79,-31.15 44.16,-23.34 310.61,-136.83 383.62,-166.91 94.55,-38.95 187.61,-81.71 284.03,-115.93z" />
</vector>
```

`app/src/main/res/drawable/trash.xml`:

```xml
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="24dp"
    android:height="24dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:pathData="M4,7l16,0"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
    <path
        android:pathData="M10,11l0,6"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
    <path
        android:pathData="M14,11l0,6"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
    <path
        android:pathData="M5,7l1,12a2,2 0,0 0,2 2h8a2,2 0,0 0,2 -2l1,-12"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
    <path
        android:pathData="M9,7v-3a1,1 0,0 1,1 -1h4a1,1 0,0 1,1 1v3"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
</vector>
```

`app/src/main/res/drawable/weblate.xml`:

```xml
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:aapt="http://schemas.android.com/aapt"
    android:width="100dp"
    android:height="74dp"
    android:viewportWidth="100"
    android:viewportHeight="74">
    <path
        android:pathData="M63.62,55.8a10.73,10.73 0,0 1,-4.24 -0.89c-3.06,-1.33 -5.75,-3.85 -7.94,-7.25a36.01,36.01 0,0 0,1.69 -3.43c2.2,-5.12 3.25,-10.73 3.33,-16.3a7.55,7.55 0,0 1,-0.03 -0.33l-0.01,-0.29c-0,-2.18 -0.34,-4.39 -1.09,-6.45 -0.87,-2.37 -2.24,-4.75 -4.43,-5.67a2.97,2.97 0,0 0,-1.23 -0.23c-2.75,-5.14 -2.84,-10.07 0,-14.77l0.15,0c3.35,0.04 6.67,1.07 9.51,2.88 7.74,4.92 11.59,14.5 11.68,23.91 0,0.11 0,0.22 -0,0.33h0.04c-0.01,9.94 -2.4,20.03 -7.44,28.49zM46.47,71.41c-7.22,2.97 -15.61,2.81 -22.77,-0.51 -8.24,-3.82 -14.53,-11.26 -18.41,-19.74 -6.63,-14.51 -6.78,-31.86 -0.49,-46.59 4.72,1.89 8.92,-1.12 8.92,-1.12s-0.01,4.63 4.47,6.95c-4.6,10.78 -4.49,23.58 0.12,34.09 2.22,5.05 5.61,9.76 10.31,12.42 1.68,0.95 3.52,1.56 5.42,1.79l0.02,0.03c3.35,5.22 7.57,9.58 12.41,12.68z"
        android:fillType="nonZero">
        <aapt:attr name="android:fillColor">
            <gradient
                android:startX="-1.49"
                android:startY="28.42"
                android:endX="48.03"
                android:endY="28.42"
                android:type="linear">
                <item android:offset="0" android:color="#FF00D2E6"/>
                <item android:offset="1" android:color="#FF2ECCAA"/>
            </gradient>
        </aapt:attr>
    </path>
    <path
        android:pathData="M63.62,55.81a10.73,10.73 0,0 1,-4.24 -0.89c-3.06,-1.33 -5.75,-3.85 -7.94,-7.25a36,36 0,0 0,1.69 -3.43,38.89 38.89,0 0,0 1.68,-4.75c1.06,-3.75 15.19,1.01 13.04,7.18a50.18,50.18 0,0 1,-4.23 9.14zM46.47,71.41c-7.22,2.97 -15.61,2.81 -22.77,-0.51 -8.24,-3.82 0.22,-16.65 4.92,-13.99a14.57,14.57 0,0 0,5.41 1.79l0.02,0.04c3.35,5.22 7.56,9.58 12.41,12.68z"
        android:strokeAlpha="0.7"
        android:fillType="evenOdd"
        android:fillAlpha="0.7">
        <aapt:attr name="android:fillColor">
            <gradient
                android:startX="24.88"
                android:startY="58.82"
                android:endX="58.55"
                android:endY="47.58"
                android:type="linear">
                <item android:offset="0" android:color="#00000000"/>
                <item android:offset="0.51" android:color="#FF000000"/>
                <item android:offset="1" android:color="#00000000"/>
            </gradient>
        </aapt:attr>
    </path>
    <path
        android:pathData="M28.38,27.31a8.15,8.15 0,0 1,-0 -0.33c0.09,-9.41 3.94,-18.99 11.68,-23.91 2.84,-1.81 6.16,-2.84 9.51,-2.88h0.15v14.77a2.97,2.97 0,0 0,-1.23 0.23c-2.19,0.93 -3.57,3.3 -4.43,5.67 -0.75,2.06 -1.08,4.27 -1.09,6.45l-0.01,0.28a7.55,7.55 0,0 1,-0.03 0.33c0.08,5.57 1.13,11.18 3.33,16.3 2.47,5.74 6.39,11.01 11.93,13.42 4.18,1.82 8.81,1.39 12.59,-0.75 4.7,-2.66 8.09,-7.37 10.31,-12.42 4.61,-10.5 4.72,-23.31 0.12,-34.09C85.69,8.08 85.68,3.45 85.68,3.45s4.2,3.01 8.92,1.12c6.29,14.73 6.14,32.08 -0.49,46.59 -3.88,8.48 -10.17,15.92 -18.41,19.74 -7.33,3.4 -15.95,3.49 -23.3,0.29 -6.59,-2.87 -11.96,-8.05 -15.82,-14.07 -5.59,-8.72 -8.24,-19.34 -8.25,-29.8h0.04z"
        android:fillType="nonZero">
        <aapt:attr name="android:fillColor">
            <gradient
                android:startX="100.89"
                android:startY="29.66"
                android:endX="51.44"
                android:endY="29.66"
                android:type="linear">
                <item android:offset="0" android:color="#FF1FA385"/>
                <item android:offset="1" android:color="#FF2ECCAA"/>
            </gradient>
        </aapt:attr>
    </path>
</vector>
```

`app/src/main/res/drawable/webui.xml`:

```xml
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="24dp"
    android:height="24dp"
    android:viewportWidth="24"
    android:viewportHeight="24">
    <path
        android:pathData="M3,12a9,9 0,1 0,18 0a9,9 0,0 0,-18 0"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
    <path
        android:pathData="M3.6,9h16.8"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
    <path
        android:pathData="M3.6,15h16.8"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
    <path
        android:pathData="M11.5,3a17,17 0,0 0,0 18"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
    <path
        android:pathData="M12.5,3a17,17 0,0 1,0 18"
        android:strokeLineJoin="round"
        android:strokeWidth="2"
        android:fillColor="#00000000"
        android:strokeColor="#ffff"
        android:strokeLineCap="round"/>
</vector>

```

`app/src/main/res/mipmap-anydpi/ic_launcher.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android">
    <background android:drawable="@color/ic_launcher_background"/>
    <foreground android:drawable="@drawable/ic_launcher_foreground"/>
    <monochrome android:drawable="@drawable/ic_launcher_monochrome"/>
</adaptive-icon>
```

`app/src/main/res/resources.properties`:

```properties
unqualifiedResLocale=en
```

`app/src/main/res/values-ab/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="su_pkg_excluded_setting_summary">\t</string>
    <string name="about_app_version">%1$s</string>
    <string name="about_app_desc">…\t\t…“”” </string>
</resources>

```

`app/src/main/res/values-apc/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
</resources>
```

`app/src/main/res/values-ar/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="home">صفحة الرئيسية</string>
    <string name="patch_warnning">التثبيت يأتي أحيانا بمخاطر. يرجى التأكد من عمل نسخ احتياطي لبياناتك.</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="android_patch">Android Patch</string>
    <string name="reboot">إعادة التشغيل</string>
    <string name="settings">الإعدادات</string>
    <string name="reboot_recovery">إعادة تشغيل إلي وضع الاسترداد</string>
    <string name="reboot_bootloader">إعادة تشغيل إلى محمل الإقلاع</string>
    <string name="reboot_download">إعادة تشغيل إلى وضع التنزيل</string>
    <string name="reboot_edl">إعادة تشغيل إلى EDL</string>
    <string name="about">حول التطبيق</string>
    <string name="home_learn_apatch">تعلم APatch</string>
    <string name="home_click_to_learn_apatch">تعرف على ميزات AndroidPatch وكيفية استخدامه</string>
    <string name="about_source_code"><![CDATA[<p> عرض كود المصدر على %1$s<p/> انضم إلى قناتنا %2$s انضم إلى مجموعتنا %3$s]]></string>
    <string name="send_log">أرسل السجلات</string>
    <string name="safe_mode">الوضع الآمن</string>
    <string name="super_key">المفتاح الخارق</string>
    <string name="clear_super_key">محو المفتاح الخارق</string>
    <string name="patch_set_superkey">ضع المفتاح الخارق</string>
    <string name="home_patch_set_key_desc">اعتماد فقط لـKernelPatch</string>
    <string name="home_click_to_install">اضغط للتثبيت</string>
    <string name="home_working">يعمل</string>
    <string name="home_installing">يتم التثبيت</string>
    <string name="home_patch_next_step">الخطوة التالية</string>
    <string name="kpatch_version">الإصدار: %s</string>
    <string name="home_not_installed">لم يتم التثبيت</string>
    <string name="home_install_unknown">غير مثبت أو مصادق عليه</string>
    <string name="home_need_update">اصدار جديد متوفر</string>
    <string name="apatch_version">الإصدار: %s</string>
    <string name="apatch_version_update">الإصدار: %s -&gt; %s</string>
    <string name="home_auth_key_desc">البدء بعد التوثيق</string>
    <string name="home_su_path">مستخدم خارق قابل للتنفيذ</string>
    <string name="home_apatch_version">إصدار APatch</string>
    <string name="home_auth_key_title">ادخل المفتاح الخارق</string>
    <string name="home_ap_cando_install">تثبيت</string>
    <string name="home_ap_cando_update">تحديث</string>
    <string name="home_ap_cando_uninstall">إلغاء التثبيت</string>
    <string name="home_kernel">النواة</string>
    <string name="patch_title">باتش</string>
    <string name="home_manager_version">إصدار البرنامج</string>
    <string name="kpm_unload">إلغاء التحميل</string>
    <string name="kpm_apm_empty">لم يتم تحميل أي إضافة</string>
    <string name="home_selinux_status_unknown">غير معروف</string>
    <string name="su_title">المستخدم الخارق</string>
    <string name="su_pkg_excluded_label">استثني</string>
    <string name="kpm_load">تحميل</string>
    <string name="su_selinux_via_hook">التجاوز عن طريق الخطاف</string>
    <string name="kpm">إضافة KP</string>
    <string name="home_fingerprint">البصمة</string>
    <string name="home_selinux_status">حالة SELinux</string>
    <string name="home_selinux_status_disabled">ملغى</string>
    <string name="home_selinux_status_enforcing">إجبار</string>
    <string name="home_selinux_status_permissive">تساهل</string>
    <string name="kpm_kp_not_installed">KernelPatch غير مثبت</string>
    <string name="kpm_load_toast_succ">تم التحميل بنجاح</string>
    <string name="kpm_load_toast_failed">فشل التحميل</string>
    <string name="kpm_unload_confirm">إلغاء تحميل \"%s\" الإضافة?</string>
    <string name="kpm_version">الاصدار</string>
    <string name="kpm_license">الترخيص</string>
    <string name="kpm_author">المؤلِّف</string>
    <string name="kpm_desc">Desc</string>
    <string name="kpm_args">الحجج</string>
    <string name="su_pkg_excluded_setting_title">استثناء التعديلات</string>
    <string name="su_pkg_excluded_setting_summary">هذا الخيار سيسمح لـAPache باستعادة أي ملف معدل بواسطة هذا التطبيق.</string>
    <string name="su_show_system_apps">إظهار تطبيقات النظام</string>
    <string name="su_hide_system_apps">إخفاء تطبيقات النظام</string>
    <string name="su_refresh">انعاش</string>
    <string name="apm_not_installed">AndroidPatch غير مثبت</string>
    <string name="apm_install">تثبيت</string>
    <string name="apm_uninstall_confirm">الغاء تثبيت إضافة \"%s\"؟</string>
    <string name="apm_uninstall_success">تم الغاء التثبيت %s</string>
    <string name="apm_uninstall_failed">لا يمكن الغاء تثبيت %s</string>
    <string name="apm_overlay_fs_not_available">الإضافات غير متاحة نظرًا لتعطيل نظام OverlayFS بواسطة النواة.</string>
    <string name="apm_magisk_conflict">الإضافات غير متاحة بسبب التعارض مع ماجيسك.</string>
    <string name="apm_reboot_to_apply">أعد التشغيل ليصبح ساري المفعول</string>
    <string name="system_default">النظام الافتراضي</string>
    <string name="settings_app_language">الغة</string>
    <string name="apm">إضافة AP</string>
    <string name="apm_failed_to_enable">غير قادر على تشغيل الإضافة \"%s\"</string>
    <string name="apm_author">المؤلف</string>
    <string name="apm_changelog">سجل التغييرات</string>
    <string name="apm_update">تحديث</string>
    <string name="apm_remove">إزالة</string>
    <string name="apm_version">الاصدار</string>
    <string name="apm_start_downloading">بدء التنزيل %s</string>
    <string name="apm_new_version_available">اضغط لتثبيت الإصدار الجديد %s.</string>
    <string name="apm_failed_to_disable">لم يمكن إيقاف إضافة \"%s</string>
    <string name="apm_empty">لم يتم تثبيت أي إضافة</string>
    <string name="apm_desc">Desc</string>
    <string name="apm_downloading">تنزيل إضافة %s…</string>
    <string name="patch">باتش</string>
    <string name="settings_global_namespace_mode_summary">جميع مساحات الروت تستخدم مساحة الاسم العامة للتثبيت</string>
    <string name="settings_global_namespace_mode">وضع APatchمساحة الاسم العام</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_extra_name">الاسم:</string>
    <string name="patch_item_set_skey_label">يجب أن يكون طول المفتاح الخارق ٧~٦٣ علامة ويتضمن كلاً من الأرقام والحروف بلا علامات مميزة</string>
    <string name="settings_clear_super_key_dialog">هل تريد حقًا المتابعة؟</string>
    <string name="kpatch_version_update">الإصدار: %s -&gt; %s</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="home_kpatch_info_title">معلومات</string>
    <string name="home_ap_cando_reboot">إعادة تشغيل</string>
    <string name="patch_config_title">باتشات</string>
    <string name="patch_mode_bootimg_patch">الوضع: باتش</string>
    <string name="patch_mode_uninstall_patch">الوضع: إلغاء تثبيت KPatch</string>
    <string name="patch_select_bootimg_btn">حدد صورة التمهيد</string>
    <string name="patch_embed_kpm_btn">تضمين KPM</string>
    <string name="patch_start_patch_btn">البدء</string>
    <string name="patch_start_unpatch_btn">ألغاء الباتش</string>
    <string name="patch_item_error">!!خطأ!!</string>
    <string name="patch_item_bootimg">صورة الإقلاع</string>
    <string name="patch_item_bootimg_slot">الفتحة:</string>
    <string name="patch_item_bootimg_dev">الجهاز:</string>
    <string name="patch_item_kernel">النواة</string>
    <string name="patch_item_kpimg_version">الإصدار:</string>
    <string name="patch_item_kpimg_comile_time">الوقت:</string>
    <string name="patch_item_kpimg_config">التكوين:</string>
    <string name="patch_item_new_extra_kpm">تضمين جديد</string>
    <string name="patch_item_existed_extra_kpm">موجود</string>
    <string name="patch_item_extra_version">الإصدار:</string>
    <string name="patch_item_extra_author">المؤلف:</string>
    <string name="patch_item_extra_kpm_license">الترخيص:</string>
    <string name="patch_item_extra_kpm_desciption">الوصف:</string>
    <string name="patch_item_extra_args">الحجج:</string>
    <string name="patch_item_extra_event">الحدث:</string>
    <string name="patch_item_skey">المفتاح الخارق</string>
    <string name="hide_apatch_manager">إخفاء مدير APatch</string>
    <string name="kpm_embed">تضمين</string>
    <string name="hide_apatch_dialog_new_manager_name">اسم المدير الجديد</string>
    <string name="kpm_add_kpm">إضافة KPM</string>
    <string name="kpm_install">تثبيت</string>
    <string name="hide_apatch_manager_summary">قم بتثبيت تطبيق مدير جديد بمعرف عشوائي وتصنيف مخصص</string>
    <string name="hide_apatch_dialog_summary">سيتم استخدامه كتسمية التطبيق الجديدة الموضحة في المشغل</string>
    <string name="hide_apatch_manager_failure">فشل الإخفاء، يرجى الإبلاغ عن الخطأ!</string>
    <string name="setting_reset_su_new_path">مسار كامل جديد</string>
    <string name="setting_reset_su_path">إعادة تعيين مسار su</string>
    <string name="success">ناجحة</string>
    <string name="failure">فشل</string>
    <string name="mode_select_page_title">تثبيت</string>
    <string name="settings_check_update">تحقق للحصول على التحديثات</string>
    <string name="settings_check_update_summary">التحقق تلقائيًا من وجود تحديثات عند فتح التطبيق</string>
    <string name="home_install_unknown_summary">اضغط للتثبيت</string>
    <string name="home_device_info">الجهاز</string>
    <string name="home_system_version">إصدار النظام</string>
    <string name="home_kpatch_version">إصدار KernelPatch</string>
    <string name="settings_donot_store_superkey">لا تقم بتخزين المفتاح الخارق محلياً</string>
    <string name="settings_donot_store_superkey_summary">قم بتوثيق المفتاح الخارق في كل مرة يتم تفعيل التطبيق</string>
    <string name="home_new_apatch_found">إصدار جديد متوفر: %s، اضغط هنا للتحديث</string>
    <string name="mode_select_page_patch_and_install">تعديل و تثبيت</string>
    <string name="mode_select_page_select_file">اختر صورة تهميد لـAPatch</string>
    <string name="home_dialog_auth_fail_title">فشلت المصادقة</string>
    <string name="home_more_menu_feedback_or_suggestion">التعليقات أو الاقتراحات</string>
    <string name="home_more_menu_about">حول</string>
    <string name="home_dialog_uninstall_title">إلغاء تثبيت</string>
    <string name="home_dialog_uninstall_ap_only">إزالة AndroidPatch</string>
    <string name="home_dialog_uninstall_all">إلغاء تثبيت الكل</string>
    <string name="mode_select_page_install_inactive_slot">تثبيت على الفتحة غير النشطة (بعد التحديث عبر الهواء OTA)</string>
    <string name="mode_select_page_install_inactive_slot_warning">**سيتم إجبار جهازك** على التمهيد إلى الفتحة غير النشطة الحالية بعد إعادة التشغيل!
\nاستخدم هذا الخيار فقط بعد انتهاء التحديث الهوائي.
\nهل تريد المتابعة؟</string>
    <string name="home_dialog_auth_fail_content">غير قادر على مصادقة المفتاح الخارق، وبالتالي لا يمكن لـ APatch العمل بشكل صحيح. \nفيما يلي بعض الأسباب المحتملة لفشل المصادقة: \n1. لم تقم بتصحيح صورة التمهيد باستخدام KernelPatch. \n2. لم يتم تثبيت صورة التمهيد المصححة. \n3. مفتاح خارق خطأ. \n4. جهازك لا يدعم APatch وKernelPatch. \n \nيرجى التحقق والمحاولة مرة أخرى. إذا كانت لا تزال هناك مشكلات، فيمكنك دائمًا طرح الأسئلة على صفحة المشكلات الخاصة بالمستودع الرسمي.</string>
    <string name="patch_mode_patch_and_install">الوضع: باتش وتثبيت</string>
    <string name="patch_mode_install_to_next_slot">الوضع: تثبيت في الفتحة التالية (بعد OTA)</string>
    <string name="apm_webui_open">فتح</string>
    <string name="enable_web_debugging">تمكين تصحيح أخطاء عارض الويب</string>
    <string name="enable_web_debugging_summary">يمكن استخدامه لتصحيح أخطاء واجهة الويب، يرجى تمكينه فقط عند الحاجة.</string>
    <string name="kpm_control">تحكم</string>
    <string name="kpm_control_dialog_content">أدخل معلمات التحكم:</string>
    <string name="brown_theme">مظهر بني</string>
    <string name="cyan_theme">‌‌‍مظهر سماوي</string>
    <string name="indigo_theme">مظهر نيلي</string>
    <string name="lime_theme">مظهر ليموني</string>
    <string name="pink_theme">مظهر وردي</string>
    <string name="sakura_theme">مظهر وردي</string>
    <string name="teal_theme">مظهر تركوازي</string>
    <string name="yellow_theme">مظهر أصفر</string>
    <string name="about_telegram_channel">قناة تيليجرام</string>
    <string name="about_app_desc">حل روت Kernel مع صورة kernel مجردة فقط، مما يوفر إمكانية تركيب وحدة النظام وربط وظيفة Kernel.</string>
    <string name="about_telegram_group">مجموعة تيليجرام</string>
    <string name="about_powered_by">مدعوم بواسطة %1$s</string>
    <string name="settings_night_mode_follow_sys_summary">التبديل إلى السمة الداكنة تلقائيًا بناءً على إعدادات النظام</string>
    <string name="kpm_control_dialog_title">التحكم بـKPModule</string>
    <string name="kpm_control_outMsg">رسالة</string>
    <string name="kpm_control_ok">نجحت العملية!</string>
    <string name="settings_use_system_color_theme">مظهر لون النظام</string>
    <string name="amber_theme">مظهر Amber</string>
    <string name="light_blue_theme">مظهر أزرق فاتح</string>
    <string name="kpm_control_paramters">معلمات</string>
    <string name="kpm_control_failed">فشلت العملية!</string>
    <string name="settings_night_mode_follow_sys">اتبع المظهر الداكن للنظام</string>
    <string name="settings_night_theme_enabled">تمكين المظهر الداكن</string>
    <string name="settings_use_system_color_theme_summary">استخدام لون الموضوع الذي يولده النظام استنادا إلى ورق الحائط الحالي</string>
    <string name="settings_custom_color_theme">لون الحلة</string>
    <string name="blue_grey_theme">مظهر BlueGrey</string>
    <string name="blue_theme">أزرق</string>
    <string name="deep_orange_theme">مظهر برتقالي غامق</string>
    <string name="deep_purple_theme">مظهر بنفسجي غامق</string>
    <string name="green_theme">مظهر أخضر</string>
    <string name="light_green_theme">مظهر أخضر فاتح</string>
    <string name="orange_theme">مظهر برتقالي</string>
    <string name="purple_theme">مظهر بنفسجي</string>
    <string name="red_theme">مظهر أحمر</string>
    <string name="about_app_version">إصدار %1$s</string>
    <string name="save_log">‮‬حفظ السجلات</string>
    <string name="apm_action">الإجراء</string>
    <string name="log_saved">تم حفظ السجل</string>
    <string name="crash_handle_title">لقد تحطمت.</string>
    <string name="crash_handle_copy">نسخ سجل الأعطال</string>
    <string name="crash_handle_copied">تم نسخ سجل الأعطال إلى الحافظة.</string>
</resources>

```

`app/src/main/res/values-arq/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources></resources>
```

`app/src/main/res/values-az/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="home">Ana səhifə</string>
    <string name="patch_warnning">Quraşdırma risklərlə gəlir. Zəhmət olmasa, məlumatlarınızın yedəkləndiyindən əmin olun.</string>
    <string name="patch">Yamaq</string>
    <string name="reboot">Yenidən başlat</string>
    <string name="reboot_recovery">Bərpa rejiminə yenidən başlat</string>
    <string name="reboot_bootloader">Önyükləyici rejiminə yenidən başlat</string>
    <string name="reboot_download">Yükləmə rejiminə yenidən başlat</string>
    <string name="about">Haqqında</string>
    <string name="settings_app_language">Dil</string>
    <string name="home_learn_apatch">APatch haqqında öyrənin</string>
    <string name="about_source_code">Mənbə koduna %1$s ünvanında baxın<br/>%2$s kanalımıza qoşulun.qrupumuza qoşulun.</string>
    <string name="system_default">Sistem defoltu</string>
    <string name="send_log">Günlükü göndərin</string>
    <string name="safe_mode">Təhlükəsiz rejim</string>
    <string name="clear_super_key">Açarı silin</string>
    <string name="super_key">SuperAçar</string>
    <string name="patch_set_superkey">SuperAçar təyin edin</string>
    <string name="home_patch_set_key_desc">Yalnız NüvəYamağı üçün etimadnamə</string>
    <string name="home_patch_next_step">Sonrakı addım</string>
    <string name="home_not_installed">Quraşdırılmayıb</string>
    <string name="home_install_unknown">Naməlum</string>
    <string name="home_working">İşləyir</string>
    <string name="home_installing">Quraşdırılır</string>
    <string name="home_need_update">Yeni versiya mövcuddur</string>
    <string name="apatch_version">Versiya:
\n%s</string>
    <string name="apatch_version_update">Versiya:
\n%s -&gt; %s</string>
    <string name="home_su_path">su: %s</string>
    <string name="kpatch_version">Versiya: %s</string>
    <string name="kernel_patch">NüvəYamağı</string>
    <string name="android_patch">AndroidYamağı</string>
    <string name="home_apatch_version">APatch: %s</string>
    <string name="home_auth_key_title">SuperAçarı daxil edin</string>
    <string name="home_auth_key_desc">Sertifikasiyadan sonra başlayın</string>
    <string name="home_ap_cando_install">Quraşdır</string>
    <string name="home_ap_cando_uninstall">Sil</string>
    <string name="patch_title">Yamaq</string>
    <string name="home_kernel">Nüvə</string>
    <string name="home_fingerprint">Barmaq izi</string>
    <string name="home_selinux_status">SELinux vəziyyəti</string>
    <string name="home_selinux_status_disabled">Sönülü</string>
    <string name="home_selinux_status_enforcing">Məcburi</string>
    <string name="home_selinux_status_permissive">Sərbəst</string>
    <string name="home_selinux_status_unknown">Naməlum</string>
    <string name="kpm">NYModulu</string>
    <string name="kpm_load">Yüklə</string>
    <string name="kpm_load_toast_succ">Yükləmə uğurlu oldu</string>
    <string name="kpm_load_toast_failed">Yükləmə uğursuz oldu</string>
    <string name="kpm_unload_confirm">\"%s\" modulunun yüklənməsini ləğv etmək istəyirsiniz mi?</string>
    <string name="kpm_unload">Ləğv et</string>
    <string name="kpm_apm_empty">Heç bir modul yüklənməyib</string>
    <string name="kpm_license">Lisans</string>
    <string name="kpm_author">Sahib</string>
    <string name="kpm_desc">Açıqlama</string>
    <string name="kpm_args">Arqumentlər</string>
    <string name="su_title">Superistifadəçi</string>
    <string name="su_selinux_via_hook">Çəngəl ilə yan keçin</string>
    <string name="su_pkg_excluded_label">istisna</string>
    <string name="su_pkg_excluded_setting_title">Dəyişiklikləri istisna edin</string>
    <string name="su_pkg_excluded_setting_summary">Bu seçimin aktivləşdirilməsi APatch-ə bu proqram üçün modullar tərəfindən hər hansı dəyişdirilmiş faylları bərpa etməyə imkan verəcək.</string>
    <string name="su_show_system_apps">Sistem proqramlarını göstərin</string>
    <string name="su_hide_system_apps">Sistem proqramlarını gizlədin</string>
    <string name="su_refresh">Yeniləyin</string>
    <string name="apm">AYModulu</string>
    <string name="apm_failed_to_enable">\"%s\" modulunu yandırmaq mümkün olmadı</string>
    <string name="apm_failed_to_disable">\"%s\" modulunu söndürmək mümkün olmadı</string>
    <string name="apm_empty">Heç bir modul quraşdırılmayıb</string>
    <string name="apm_remove">Sil</string>
    <string name="apm_uninstall_confirm">\"%s\" modulunu silmək istəyirsiniz mi?</string>
    <string name="apm_uninstall_success">%s silindi</string>
    <string name="apm_uninstall_failed">%s modulunu silmək mümkün olmadı</string>
    <string name="apm_version">Versiya</string>
    <string name="apm_author">Sahib</string>
    <string name="apm_desc">Açıqlama</string>
    <string name="apm_magisk_conflict">Magisk ilə ziddiyyətə görə modullar əlçatan deyil!</string>
    <string name="home_ap_cando_update">Güncəllə</string>
    <string name="apm_reboot_to_apply">Effektiv olmağı üçün yenidən başladın</string>
    <string name="apm_changelog">Dəyişikliklər jurnalı</string>
    <string name="apm_update">Güncəllə</string>
    <string name="apm_downloading">\"%s\" modulu endirilir…</string>
    <string name="apm_start_downloading">%s endirilməsi başladıldı</string>
    <string name="apm_new_version_available">Yeni versiyanı quraşdırmaq üçün klikləyin, %s.</string>
    <string name="reboot_edl">Təcili yükləmə rejiminə yenidən başlat</string>
    <string name="home_click_to_install">Quraşdırmaq üçün toxunun</string>
    <string name="settings">Ayarlar</string>
    <string name="home_click_to_learn_apatch">APatch-in xüsusiyyətləri və necə istifadə olunacağını öyrənin</string>
    <string name="home_manager_version">Menecer versiyası</string>
    <string name="kpm_kp_not_installed">KernelPatch quraşdırılmayıb</string>
    <string name="kpm_version">Versiya</string>
    <string name="apm_install">Quraşdır</string>
    <string name="apm_not_installed">AndroidYamağı quraşdırılmayıb</string>
    <string name="apm_overlay_fs_not_available">OverlayFS nüvə tərəfindən deaktiv edildiyi üçün modullar əlçatan deyil.</string>
    <string name="settings_global_namespace_mode">Global namespace mode</string>
    <string name="settings_global_namespace_mode_summary">Bütün kök sessiyaları qlobal bağlama adməkanından istifadə edir</string>
    <string name="settings_clear_super_key_dialog">Həqiqətən davam etmək istəyirsən?</string>
    <string name="settings_check_update">Yeniləməni yoxlayın</string>
    <string name="settings_check_update_summary">Proqramı açarkən avtomatik olaraq yeniləmələri yoxlayın</string>
    <string name="home_install_unknown_summary">Quraşdırmaq üçün kliklə</string>
    <string name="kpatch_version_update">Versiya: %s -&gt; %s</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="home_kpatch_info_title">Məlumat</string>
    <string name="patch_config_title">Yamalar</string>
    <string name="patch_mode_bootimg_patch">Mod: Yamala</string>
    <string name="patch_mode_patch_and_install">Mode: Yamala və quraşdır</string>
    <string name="patch_embed_kpm_btn">KPM-i göm</string>
    <string name="patch_start_patch_btn">Başla</string>
    <string name="patch_start_unpatch_btn">"Yamanı Deaktiv edin "</string>
    <string name="patch_item_bootimg_slot">yuva:</string>
    <string name="patch_item_bootimg_dev">cihaz:</string>
    <string name="patch_item_kernel">Kernel</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_kpimg_version">versiya:</string>
    <string name="patch_item_kpimg_comile_time">zaman:</string>
    <string name="patch_item_kpimg_config">konfiqurasiya:</string>
    <string name="patch_item_new_extra_kpm">Yenisini göm</string>
    <string name="patch_item_extra_event">Hadisə:</string>
    <string name="patch_item_skey">Super Açar</string>
    <string name="kpm_control">Kontrol</string>
    <string name="save_log">Qeydləri yaddaşda saxla</string>
    <string name="home_ap_cando_reboot">Yenidən başlat</string>
    <string name="patch_mode_uninstall_patch">Mod: KPatch-i silin</string>
    <string name="patch_select_bootimg_btn">Boot-u seç</string>
    <string name="patch_item_error">!!XƏTA!!</string>
    <string name="patch_item_bootimg">Önyüklənəbilir görüntü</string>
    <string name="patch_item_existed_extra_kpm">Mövcud</string>
    <string name="patch_item_extra_name">ad:</string>
    <string name="patch_item_extra_version">versiya:</string>
    <string name="patch_item_extra_author">müəllif:</string>
    <string name="patch_item_extra_kpm_license">lisans:</string>
    <string name="patch_item_extra_kpm_desciption">açıqlama:</string>
    <string name="patch_item_extra_args">arqumentlər:</string>
    <string name="patch_item_set_skey_label">Super açarın uzunluğu ən azı 8 vəya 63 uzunluğunda simvol olmalıdır və həm rəqəmlər, həm də hərflərdən ibarət olmalıdır özəl simvollar istifadə edilməməlidir</string>
    <string name="home_device_info">Cihaz</string>
    <string name="home_system_version">Sistem versiyası</string>
    <string name="home_kpatch_version">KernelYama versiyası</string>
    <string name="kpm_add_kpm">KPM əlavə et</string>
    <string name="kpm_install">Quraşdır</string>
    <string name="kpm_embed">Göm</string>
    <string name="success">Uğurlu</string>
    <string name="patch_mode_install_to_next_slot">Mod: Növbəti yuvaya quraşdırın (OTA-dan sonra)</string>
    <string name="failure">Uğursuz oldu</string>
    <string name="hide_apatch_manager_summary">Təsadüfi paket ID-si və fərdi tətbiq etiketi ilə yeni menecer tətbiqini quraşdırın</string>
    <string name="hide_apatch_dialog_new_manager_name">Yeni Menecer Adı</string>
    <string name="hide_apatch_manager_failure">Gizlətmək alınmadı, lütfən, proqram açığını bildirin!</string>
    <string name="enable_web_debugging_summary">WebUI-ni sazlamaq üçün istifadə edilə bilər, zəhmət olmasa, yalnız lazım olduqda aktivləşdirin.</string>
    <string name="setting_reset_su_new_path">yeni tam yol</string>
    <string name="enable_web_debugging">Webgörüntələmə Xəta Çeşidləməyi aktivləşdirin</string>
    <string name="settings_donot_store_superkey">Super açarı local cihazda saxlamayın</string>
    <string name="home_new_apatch_found">Yeni versiya mövcuddur: %s, Güncəlləmək üçün mənə klikləyin</string>
    <string name="settings_donot_store_superkey_summary">Menecer hər dəfə açılanda super açarı təsdiq edin</string>
    <string name="mode_select_page_title">Quraşdır</string>
    <string name="mode_select_page_select_file">Yamaq üçün boot image-i seçin</string>
    <string name="mode_select_page_install_inactive_slot">Qeyri-aktiv Yuvaya quraşdırın (OTA-dan sonra)</string>
    <string name="mode_select_page_patch_and_install">Yamala və quraşdır</string>
    <string name="home_dialog_auth_fail_title">Doğrulama uğursuz oldu</string>
    <string name="mode_select_page_install_inactive_slot_warning">Cihazınız yenidən işə salındıqdan sonra cari qeyri-aktiv yuvaya yükləməyə **MƏCBUR EDİLƏCƏK**!
\nBu seçimi yalnız OTA tamamlandıqdan sonra istifadə edin.
\nDavam edilsinmi?</string>
    <string name="hide_apatch_dialog_summary">Başlatıcıda göstərilən yeni tətbiq etiketi kimi istifadə olunacaq</string>
    <string name="setting_reset_su_path">Su yolunu sıfırla</string>
    <string name="home_more_menu_feedback_or_suggestion">Geri bildirmə və ya təklif</string>
    <string name="home_more_menu_about">Haqqında</string>
    <string name="home_dialog_uninstall_title">Sil</string>
    <string name="home_dialog_uninstall_ap_only">AndroidYamasını silin</string>
    <string name="home_dialog_uninstall_all">Hamısını Silin</string>
    <string name="kpm_control_dialog_title">KPModulu kontrol et</string>
    <string name="kpm_control_failed">Əməliyyat uğursuz oldu!</string>
    <string name="settings_night_mode_follow_sys">Sistemin Qaranlıq Temasını izləyin</string>
    <string name="settings_night_mode_follow_sys_summary">Sistem ayarı ilə avtomatik olaraq qaranlıq temaya keçin</string>
    <string name="settings_night_theme_enabled">Qaranlıq Temanı aktiv et</string>
    <string name="settings_use_system_color_theme">Sistem Rəng Teması</string>
    <string name="settings_use_system_color_theme_summary">Cari divar kağızı ilə sistem tərəfindən yaradılan rəng temasını istifadə edin</string>
    <string name="settings_custom_color_theme">Rəng Teması</string>
    <string name="amber_theme">Amber Teması</string>
    <string name="blue_grey_theme">MaviBoz Teması</string>
    <string name="blue_theme">Mavi Teması</string>
    <string name="brown_theme">Qəhvəyi Tema</string>
    <string name="cyan_theme">Cyan Teması</string>
    <string name="deep_orange_theme">Tünd Narıncı Teması</string>
    <string name="deep_purple_theme">Tünd Bənövşəyi Teması</string>
    <string name="green_theme">Yaşıl Tema</string>
    <string name="light_blue_theme">Açıq Mavi Teması</string>
    <string name="light_green_theme">Açıq Yaşıl Teması</string>
    <string name="lime_theme">Lime Tema</string>
    <string name="orange_theme">Narıncı Teması</string>
    <string name="purple_theme">Bənövşəyi Tema</string>
    <string name="red_theme">Qırmızı Tema</string>
    <string name="sakura_theme">Sakura Teması</string>
    <string name="teal_theme">Teal Tema</string>
    <string name="yellow_theme">Sarı Tema</string>
    <string name="about_app_version">Versiya %1$s</string>
    <string name="apm_webui_open">Aç</string>
    <string name="home_dialog_auth_fail_content">Super açarın doğrulanması mümkün deyil, buna görə də APAtch düzgün işləyə bilməz. \nDoğrulama uğursuzluğunun bəzi mümkün səbəbləri bunlardır: \n1. Siz boot ­görüntüsü KernelPatch ilə yamalamamısınız. \n2. Yamalı boot görüntüsü flashlanmadı. \n3. Super açar səhvdir. \n4. Cihazınız APatch və KernelPatch-i dəstəkləmir. \n \nZəhmət olmasa yoxlayın və yenidən cəhd edin. Hələ də problemlər varsa, siz həmişə rəsmi repozitoriyanın problem səhifəsində sual verə bilərsiniz.</string>
    <string name="kpm_control_outMsg">Mesajlar</string>
    <string name="kpm_control_paramters">Parametrlər</string>
    <string name="kpm_control_dialog_content">Giriş nəzarət parametrləri:</string>
    <string name="kpm_control_ok">Əməliyyat uğurla başa çatdı!</string>
    <string name="indigo_theme">Indigo Teması</string>
    <string name="pink_theme">Çəhrayı Tema</string>
    <string name="about_telegram_channel">Telegram Kanalı</string>
    <string name="about_telegram_group">Telegram Qrupu</string>
    <string name="about_powered_by">%1$s tərəfindən gücləndirildi</string>
    <string name="hide_apatch_manager">Gizli APatch Meneceri</string>
    <string name="log_saved">Qeydlər yaddaşda saxlandı</string>
    <string name="apm_action">Fəaliyyət</string>
    <string name="about_app_desc">Yalnızca sadələşdirilmiş kernel təsviri ilə kernel root həlli – sistem modullarını qoşmaq və kernel funksiyalarını ələ keçirmək imkanını təmin edir.</string>
    <string name="crash_handle_title">Program çöktü…</string>
    <string name="crash_handle_copy">Çöküntü qeydini kopyala</string>
    <string name="crash_handle_copied">Clipboarda çöküntü qeydi kopyalandı.</string>
</resources>

```

`app/src/main/res/values-bn/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="home">হোম</string>
    <string name="kernel_patch">কার্নেলপ্যাচ</string>
    <string name="android_patch">অ্যান্ড্রয়েডপ্যাচ</string>
    <string name="reboot">রিবুট করুন</string>
    <string name="reboot_bootloader">বুটলোডারে যান</string>
    <string name="reboot_download">ডাউনলোড মোডে রিবুট করুন</string>
    <string name="about">বিস্তারিত</string>
    <string name="about_source_code"><![CDATA[<p>সোর্স কোড দেখুন%1$s<p/>আমাদের জয়েন করুন%2$s চ্যানেল<p/>আমাদের জয়েন করুন%3$s গ্রুপ]]></string>
    <string name="safe_mode">সেফ মোড</string>
    <string name="super_key">সুপারকি</string>
    <string name="home_patch_set_key_desc">কারনেলপ্যাচের এর জন্য শুধুমাত্র শংসাপত্র</string>
    <string name="home_install_unknown">ইনস্টল করা বা অনুমদিত করা নেই</string>
    <string name="home_working">কাজ করতেছে 🤭</string>
    <string name="apatch_version">সংস্করণ %s</string>
    <string name="apatch_version_update">সংস্করণ %s → %s</string>
    <string name="home_su_path">এক্সিকিউটেবল su</string>
    <string name="home_apatch_version">APatch সংস্করণ</string>
    <string name="home_auth_key_title">সুপারকি প্রবেশ করুন</string>
    <string name="home_ap_cando_update">হালনাগাদ</string>
    <string name="home_ap_cando_uninstall">আনইনস্টল করুন</string>
    <string name="patch_warnning">ইনস্টলেশন ঝুঁকিপূর্ণ, অনুগ্রহ করে নিশ্চিত করুন যে আপনার ডেটা ব্যাকআপ করা আছে।</string>
    <string name="settings">সেটিংস</string>
    <string name="reboot_recovery">রিকভারিতে রিবুট করুন</string>
    <string name="home_learn_apatch">এপ্যাচ সম্পর্কে জানুন</string>
    <string name="send_log">লগ পাঠান</string>
    <string name="reboot_edl">EDL এ রিবুট করুন</string>
    <string name="home_click_to_learn_apatch">অ্যান্ড্রয়েড প্যাচের বৈশিষ্ট্য এবং কীভাবে ব্যবহার করবেন সে সম্পর্কে জানুন</string>
    <string name="patch_set_superkey">সুপারকি সেট করুন</string>
    <string name="home_patch_next_step">পরবর্তী ধাপ</string>
    <string name="home_click_to_install">ইনস্টল করতে ক্লিক করুন</string>
    <string name="home_auth_key_desc">প্রত্যয়িতকরণের পরে কাজ শুরু করুন</string>
    <string name="home_installing">ইনস্টলরত</string>
    <string name="home_need_update">নতুন সংস্করণ উপলভ্য</string>
    <string name="kpatch_version">সংস্করণ : %s</string>
    <string name="home_not_installed">ইন্সটল করা নেই</string>
    <string name="home_ap_cando_install">ইনস্টল করুন</string>
    <string name="patch_title">প্যাচ</string>
    <string name="home_selinux_status_permissive">অনুমতিপূর্ন</string>
    <string name="home_selinux_status_enforcing">কার্যকর করা</string>
    <string name="kpm_args">আর্গুমেন্টস</string>
    <string name="su_title">সুপারইউজার</string>
    <string name="kpm_desc">বিবরণ</string>
    <string name="su_refresh">রিফ্রেশ</string>
    <string name="apm_failed_to_disable">\"%s\" মডিউল বন্ধ করা যায়নি</string>
    <string name="apm_empty">কোন মডিউল ইনস্টল করা নেই</string>
    <string name="apm_remove">বাদ দিন</string>
    <string name="apm_failed_to_enable">মডিউল \"%s\" চালু করা যায়নি</string>
    <string name="apm_uninstall_confirm">আপনি কি নিশ্চিত মডিউল %s আনইনস্টল করতে চান?</string>
    <string name="apm_uninstall_success">%s আনইনস্টল করা হয়েছে</string>
    <string name="home_manager_version">ম্যানেজার ভার্সন</string>
    <string name="home_fingerprint">আঙুলের ছাপ</string>
    <string name="home_selinux_status">SELinux অবস্থা</string>
    <string name="home_selinux_status_disabled">বন্ধ করুন</string>
    <string name="home_selinux_status_unknown">অজানা</string>
    <string name="kpm">KP মডিউল</string>
    <string name="kpm_load">লোড করুন</string>
    <string name="kpm_unload_confirm">আপনি কি নিশ্চিত আপনি মডিউল %s আনলোড করতে চান?</string>
    <string name="kpm_unload">আনলোড</string>
    <string name="kpm_author">লেখক</string>
    <string name="su_selinux_via_hook">Hook এর মাধ্যমে বাইপাস করুন</string>
    <string name="su_hide_system_apps">সিস্টেম অ্যাপ লুকান</string>
    <string name="apm">AP মডিউল</string>
    <string name="apm_uninstall_failed">%s আনইনস্টল করা যায়নি</string>
    <string name="apm_author">লেখক</string>
    <string name="apm_desc">বিবরণ</string>
    <string name="apm_reboot_to_apply">কার্যকর করতে রিবুট করুন</string>
    <string name="apm_changelog">চেঞ্জলগ</string>
    <string name="apm_update">আপডেট</string>
    <string name="apm_downloading">\"%s\" মডিউল ডাউনলোড হচ্ছে…</string>
    <string name="home_kernel">কার্নেল সংস্ককরণ</string>
    <string name="kpm_kp_not_installed">কার্নেল প্যাচ ইনস্টল করা নেই</string>
    <string name="kpm_load_toast_failed">লোড ব্যর্থ হয়েছে</string>
    <string name="kpm_load_toast_succ">লোড সফল</string>
    <string name="su_pkg_excluded_setting_summary">এই অপশনটি দ্বারা APatch App এর ভিতরে মডিউল দ্বারা পরিবর্তন হওয়া ফাইল পুনরুদ্ধার করতে পারবে।</string>
    <string name="su_show_system_apps">সিস্টেম অ্যাপ দেখাও</string>
    <string name="kpm_apm_empty">কোনো মডিউল লোড করা হয়নি</string>
    <string name="apm_overlay_fs_not_available">কার্নেল দ্বারা OverlayFS বন্ধ হওয়ার কারণে মডিউলগুলি পাওয়া যায়নি!</string>
    <string name="apm_magisk_conflict">মডিউলগুলো পাওয়া যায়নি কারণ Magisk এর ভিতর ও একই মডিউল আছে যা সাংঘর্ষিক!</string>
    <string name="apm_new_version_available">নতুন ভার্সনটি ইনস্টল করতে ক্লিক করুন, %s।</string>
    <string name="su_pkg_excluded_setting_title">পরিবর্তন যা আছে তা বাদ দিন</string>
    <string name="apm_start_downloading">%s ডাউনলোড শুরু করুন</string>
    <string name="kpm_version">সংস্করণ</string>
    <string name="kpm_license">লাইসেন্স</string>
    <string name="apm_version">সংস্করণ</string>
    <string name="su_pkg_excluded_label">বাদ</string>
    <string name="apm_install">ইনস্টল করুন</string>
    <string name="settings_app_language">ভাষা</string>
    <string name="system_default">সিস্টেম ডিফল্ট</string>
    <string name="settings_global_namespace_mode">গ্লোবাল নেমস্পেস মোড</string>
    <string name="settings_global_namespace_mode_summary">সব রুট সেশনগুলো গ্লোবাল নেমস্পেসে ব্যবহার করবে</string>
    <string name="settings_clear_super_key_dialog">আপনি কি সত্যিই চালিয়ে যেতে চান?</string>
    <string name="settings_check_update">হালনাগাদ চেক করুন</string>
    <string name="settings_check_update_summary">অ্যাপ খোলার সময় স্বয়ংক্রিয়ভাবে হালনাগাদ চেক করুন</string>
    <string name="kpatch_shadow_path_title">কেপ্যাচ</string>
    <string name="kpatch_version_update">সংস্করণ %s → %s</string>
    <string name="clear_super_key">সুপার_কি মুছুন</string>
    <string name="home_install_unknown_summary">ইন্সটল করতে ক্লিক করুন</string>
    <string name="home_kpatch_info_title">তথ্য</string>
    <string name="patch_config_title">প্যাচসমূহ</string>
    <string name="save_log">লগ সেভ করুন</string>
    <string name="home_ap_cando_reboot">রিবুট করুন</string>
    <string name="success">সাফল্য</string>
    <string name="failure">ব্যর্থ হয়েছে</string>
    <string name="patch">প্যাচ</string>
    <string name="patch_item_kpimg_comile_time">সময়:</string>
    <string name="patch_item_extra_kpm_license">লাইসেন্স:</string>
    <string name="patch_start_patch_btn">চালু করুন</string>
    <string name="patch_item_extra_kpm_desciption">বর্ণনা:</string>
    <string name="patch_item_extra_name">নাম:</string>
    <string name="patch_item_extra_version">সংস্করণ:</string>
    <string name="patch_item_extra_author">লেখক:</string>
    <string name="patch_item_extra_args">আর্গুমেন্টস:</string>
    <string name="patch_item_kpimg_version">সংস্করন:</string>
    <string name="patch_item_bootimg_dev">ডিভাইস:</string>
    <string name="patch_item_extra_event">ঘটনা:</string>
    <string name="patch_item_skey">সুপার কি</string>
    <string name="patch_item_set_skey_label">সুপার পাসওয়ার্ড কমপক্ষে ৮-৬৪ অক্ষর হবে, অক্ষর এবং সংখ্যা দুটো দিয়েই বানাতে হবে পাসওয়ার্ড। কোন চিহ্ন দিয়ে পাসওয়ার্ড বানানো যাবেনা।</string>
    <string name="home_kpatch_version">কার্নেলপ্যাচ সংস্করণ</string>
    <string name="kpm_add_kpm">KPM যোগ করুন</string>
    <string name="kpm_install">ইন্সটল</string>
    <string name="apm_not_installed">এন্ড্রয়েড প্যাচ ইন্সটল হয়নি</string>
    <string name="home_device_info">ডিভাইস</string>
    <string name="home_system_version">সিস্টেমের সংস্করণ</string>
    <string name="patch_item_kpimg_config">কনফিগ:</string>
    <string name="patch_item_new_extra_kpm">নতুন করে বসান</string>
    <string name="patch_item_existed_extra_kpm">বিদ্যমান</string>
    <string name="patch_item_kernel">কার্নেল</string>
    <string name="kpm_embed">বসান</string>
    <string name="kpm_control">নিয়ন্ত্রন</string>
    <string name="hide_apatch_manager">APatch ম্যানেজারকে লুকান</string>
    <string name="hide_apatch_manager_summary">রেন্ডম প্যাকেজ আইডি এবং কাস্টম অ্যাপ লেবেল সহ নতুন প্রক্সি অ্যাপ ইনস্টল করুন</string>
    <string name="hide_apatch_dialog_new_manager_name">নতুন ম্যানেজারের নাম</string>
    <string name="hide_apatch_dialog_summary">এটি লঞ্চারে দেখানো নতুন অ্যাপ লেবেল হিসেবে ব্যবহার করা হবে</string>
    <string name="hide_apatch_manager_failure">লুকাতে ব্যর্থ হয়েছে, দয়া করে এই সমস্যা অভিযোগ করুন!</string>
    <string name="setting_reset_su_path">su path কে পুনরায় চালু করুন</string>
    <string name="setting_reset_su_new_path">নতুন full path</string>
    <string name="enable_web_debugging">ওয়েবভিউ ডিবাগিং চালু করুন</string>
    <string name="mode_select_page_title">ইন্সটল</string>
    <string name="mode_select_page_patch_and_install">প্যাচ এবং ইন্সটল</string>
    <string name="settings_donot_store_superkey_summary">প্রতিবার ম্যানেজার চালু করার সময় সুপার কি দিন</string>
    <string name="home_new_apatch_found">আপডেট সংস্করণ এসে গেছে %s, আপগ্রেড করতে এখানে ক্লিক করুন।</string>
    <string name="mode_select_page_install_inactive_slot">নিষ্ক্রিয় স্লটে ইনস্টল করুন (OTA এর পরে)</string>
    <string name="home_dialog_auth_fail_title">প্রমান করতে ব্যর্থ হয়েছে</string>
    <string name="enable_web_debugging_summary">WebUI ডিবাগ করতে ব্যবহার করা যেতে পারে, অনুগ্রহ করে শুধুমাত্র প্রয়োজন হলেই চালু করুন।</string>
    <string name="home_more_menu_feedback_or_suggestion">ফিডব্যাক অথবা পরামর্শ</string>
    <string name="settings_donot_store_superkey">ফোন এর সিষ্টেমে সুপার কী সংরক্ষণ করবেন না</string>
    <string name="home_dialog_uninstall_ap_only">এন্ড্রয়েডপ্যাচ দূর করুন</string>
    <string name="settings_custom_color_theme">কালার থিম</string>
    <string name="amber_theme">অ্যাম্বার থিম</string>
    <string name="apm_action">ব্যবস্থা</string>
    <string name="home_dialog_uninstall_all">সকল কিছু আনইন্সটল করুন</string>
    <string name="kpm_control_dialog_title">KPমডিউল নিয়ন্ত্রন</string>
    <string name="kpm_control_dialog_content">ইনপুট নিয়ন্ত্রণ প্যারামিটার:</string>
    <string name="kpm_control_paramters">প্যারামিটার</string>
    <string name="kpm_control_outMsg">বার্তা</string>
    <string name="kpm_control_ok">অপারেশন সফল!</string>
    <string name="kpm_control_failed">অপারেশন ব্যর্থ!</string>
    <string name="settings_night_mode_follow_sys">সিস্টেমের ডার্ক থিম অনুসরণ করুন</string>
    <string name="settings_night_mode_follow_sys_summary">অটোমেটিক ভাবে সিষ্টেম এর সেটিং ফলো করে ডার্ক থিম সেটিং করুন</string>
    <string name="settings_night_theme_enabled">ডার্ক থিম চালু করুন</string>
    <string name="settings_use_system_color_theme">সিস্টেম কালার থিম</string>
    <string name="settings_use_system_color_theme_summary">বর্তমান ওয়ালপেপার এর কালার দ্বারা সিস্টেমে তৈরি হওয়া কালার থিম ব্যবহার করুন</string>
    <string name="blue_grey_theme">নীল ধূসর</string>
    <string name="blue_theme">নীল</string>
    <string name="brown_theme">বাদামী</string>
    <string name="cyan_theme">নীলাভ সবুজ</string>
    <string name="deep_orange_theme">গাড় কমলা</string>
    <string name="apm_webui_open">খুলুন</string>
    <string name="home_more_menu_about">বিস্তারিত</string>
    <string name="home_dialog_uninstall_title">আনইনস্টল করুন</string>
    <string name="patch_item_kpimg">KPইমেজ</string>
    <string name="patch_mode_patch_and_install">মোড: প্যাচ এবং ইনস্টল</string>
    <string name="patch_item_bootimg">বুট ইমেজ</string>
    <string name="patch_select_bootimg_btn">বুট সিলেক্ট করুন</string>
    <string name="patch_mode_install_to_next_slot">মোড: ইনএক্টিভ সল্টে ইন্সটল করুন( OTA এর পরে)</string>
    <string name="patch_mode_bootimg_patch">মুড: প্যাচ</string>
    <string name="patch_mode_uninstall_patch">মোড: আনইন্সটল KPatch</string>
    <string name="patch_embed_kpm_btn">যুক্ত করা KPM</string>
    <string name="patch_start_unpatch_btn">আনপ্যাচ করুন</string>
    <string name="patch_item_error">!!ভুল হচ্ছে!!</string>
    <string name="patch_item_bootimg_slot">স্লট:</string>
    <string name="log_saved">লগ সেভ হয়েছে</string>
    <string name="teal_theme">সবুজ নীল</string>
    <string name="light_green_theme">হালকা সবুজ</string>
    <string name="lime_theme">হলুদ সবুজ</string>
    <string name="orange_theme">কমলা</string>
    <string name="pink_theme">গেলাপি</string>
    <string name="purple_theme">বেগুনি</string>
    <string name="about_telegram_group">টেলিগ্রাম গ্রুপ</string>
    <string name="about_powered_by">দ্বারা চালিত %1$s</string>
    <string name="about_app_desc">Kernel রুট সমাধান যা শুধু একটা খোলা Kernel image, যা সিস্টেম মডিউলকে মাউন্ট এবং Kernel ফাংশনকে হুক করার সক্ষমতা প্রদান করে।</string>
    <string name="home_dialog_auth_fail_content">সুপার কি যাচাই করা যায়নি,তাই Apatch সঠিক ভাবে কাজ করতে পারবেনা\nযেইসব কারনে এই সমস্যা হতে পারে:\n১. আপনি boot.img কে KernelPatch দিয়ে Patch করেননি\n২.Patch করা Boot.img ফ্লাশ করা হয়নি\n৩.ভুল সুপার কি ব্যাবহার করেছেন বা সুপার কি এর মধ্যে অক্ষর ছাড়াও অন্য বিশেষ ক্যারেক্টার ছিলো\n৪.আপনার ডিভাইস Apatch এবং KernelPatch সাপোর্ট করেনা\n\nদয়া করে আবার সব কিছু চেক করুন, যদি এর পরও সমস্যা হয়, আপনি সব সময় অফিশিয়াল রিপোজিটোরি পেইজে প্রশ্ন করতে পারবেন।</string>
    <string name="crash_handle_copied">ক্রাশ লগ ক্লিপ বোর্ডে কপি হয়েছে।</string>
    <string name="crash_handle_title">এপ ক্রাশ করেছে…</string>
    <string name="mode_select_page_install_inactive_slot_warning">আপনার ডিভাইস একটি রিবুট এর পর বর্তমান নিষ্ক্রিয় সল্ট এ খুলে যাবে\nএই অপশনটি শুধু ব্যাবহার করুন OTA আপডেট হয়ে গেলে\nচালিয়ে যান?</string>
    <string name="green_theme">সবুজ</string>
    <string name="indigo_theme">বেগুনি নীল</string>
    <string name="light_blue_theme">হালকা নীল</string>
    <string name="red_theme">লাল</string>
    <string name="yellow_theme">হলুদ</string>
    <string name="about_telegram_channel">টেলিগ্রাম চ্যানেল</string>
    <string name="mode_select_page_select_file">প্যাচ করার জন্য বুট ইমেজ সিলেক্ট করুন</string>
    <string name="about_app_version">সংস্করণ %1$s</string>
    <string name="deep_purple_theme">গাড় বেগুনি</string>
    <string name="crash_handle_copy">ক্রাশ এর লগ কপি করুন</string>
    <string name="sakura_theme">সাকুরা</string>
    <string name="settings_lite_mode">লাইট মোড চালু করুন</string>
    <string name="settings_lite_mode_mode_summary">APModule ফাংশনগুলি সক্রিয় করার পরে ক্ষতির সম্মুখীন হতে পারে, কিন্তু মাঝে মধ্যে এটি কার্যকরভাবে সনাক্তকরণ এড়াতে পারে, রিবুট প্রয়োজন।</string>
    <string name="settings_force_overlayfs_mode">জোর পুর্বক OverlayFS ব্যাবহার করুন</string>
    <string name="settings_force_overlayfs_mode_summary">OverlayFS ব্যাবহার করে APModules মাউন্ট করুন ম্যাজিক মাউন্ট এর পরিবর্তে যদি কার্নেল এটা সাপোর্ট করে, রিবুট আবশ্যক।</string>
</resources>

```

`app/src/main/res/values-ca/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="home">Inici</string>
    <string name="failure">Ha fallat</string>
    <string name="patch_warnning">La instal·lació suposa un risc. Si us plau assegura\'t de tenir una còpia de seguretat de les teves dades.</string>
    <string name="patch">Pegat</string>
    <string name="android_patch">Pegat de l\'Android</string>
    <string name="settings">Configuració</string>
    <string name="reboot_bootloader">Reinicialitza al gestor d\'arrencada (Bootloader)</string>
    <string name="reboot_recovery">Reinicialitza al mode recuperació (Recovery)</string>
    <string name="reboot_edl">Reinicialitza al mode de descàrrega d\'emergència (EDL)</string>
    <string name="settings_app_language">Llengua</string>
    <string name="settings_global_namespace_mode">Mode d\'espai de noms global</string>
    <string name="settings_check_update">Cerca actualitzacions</string>
    <string name="home_learn_apatch">Aprèn APatch</string>
    <string name="home_click_to_learn_apatch">Obteniu informació sobre les funcions d\'APatch i com utilitzar-lo</string>
    <string name="home_install_unknown">No instal·lat ni autenticat</string>
    <string name="home_working">Treballant 😋</string>
    <string name="apatch_version">Versió: %s</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="home_auth_key_title">Insereix SuperClau</string>
    <string name="home_ap_cando_update">Actualitzar</string>
    <string name="home_ap_cando_uninstall">Desinstal·lar</string>
    <string name="home_ap_cando_reboot">Reinicialitza</string>
    <string name="success">Èxit</string>
    <string name="kernel_patch">Actualització del nucli</string>
    <string name="reboot_download">Reinicialitza al mode descàrrega</string>
    <string name="reboot">Reinicia</string>
    <string name="send_log">Envia els registres</string>
    <string name="settings_global_namespace_mode_summary">Totes les sessions arrel utilitzen l\'espai de noms de muntatge global</string>
    <string name="settings_clear_super_key_dialog">Realment voleu continuar?</string>
    <string name="settings_check_update_summary">Comprova automàticament si hi ha actualitzacions en obrir l\'aplicació</string>
    <string name="about">Sobre</string>
    <string name="about_source_code">&lt;p&gt;Veure el codi font a %1$s&lt;p/&gt; Uneix-te al nostre %2$s canal&lt;p/&gt;Uneix-te al nostre %3$s grup</string>
    <string name="save_log">Desa els registres</string>
    <string name="system_default">Opció per defecte del sistema</string>
    <string name="clear_super_key">Elimina SuperClau</string>
    <string name="super_key">SuperClau</string>
    <string name="home_patch_next_step">Següent pas</string>
    <string name="safe_mode">Mode segur</string>
    <string name="patch_set_superkey">Estableix SuperClau</string>
    <string name="home_not_installed">No instal·lada</string>
    <string name="home_click_to_install">Clica per instal·lar</string>
    <string name="home_install_unknown_summary">Clica per instal·lar</string>
    <string name="kpatch_version">Versió: %s</string>
    <string name="kpatch_version_update">Versió: %s -&gt; %s</string>
    <string name="home_kpatch_info_title">Informació</string>
    <string name="home_auth_key_desc">Comença després de la certificació</string>
    <string name="home_ap_cando_install">Instal·lar</string>
    <string name="patch_title">Pegat</string>
    <string name="home_patch_set_key_desc">Només credencial per KernelPatch</string>
    <string name="apatch_version_update">Versió: %s -&gt; %s</string>
    <string name="patch_config_title">Pegat</string>
    <string name="patch_mode_bootimg_patch">Mode: Pegat</string>
    <string name="patch_mode_patch_and_install">Mode: Aplicar pegat i instal·lar</string>
    <string name="home_installing">Instal·lant</string>
    <string name="home_need_update">Hi ha una nova versió disponible</string>
    <string name="log_saved">Registre desat</string>
    <string name="patch_item_error">ERROR!!</string>
    <string name="patch_item_bootimg_slot">slot:</string>
    <string name="patch_item_bootimg_dev">dispositiu:</string>
    <string name="patch_item_kernel">Kernel</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_extra_kpm_license">Llicència:</string>
    <string name="patch_item_extra_kpm_desciption">Descripció:</string>
    <string name="kpm_unload">Deshabilitar</string>
    <string name="kpm_control">Control</string>
    <string name="kpm_apm_empty">No hi ha mòduls carregats</string>
    <string name="su_title">Superusuari</string>
    <string name="su_pkg_excluded_label">excloure</string>
    <string name="su_pkg_excluded_setting_title">Excloure modificacions</string>
    <string name="su_show_system_apps">Mostrar aplicacions del sistema</string>
    <string name="apm_empty">Cap mòdul instal·lat</string>
    <string name="apm_version">Versió</string>
    <string name="patch_item_kpimg_comile_time">Hora:</string>
    <string name="patch_item_kpimg_version">Versió:</string>
    <string name="patch_item_kpimg_config">Config:</string>
    <string name="home_fingerprint">Empremta del dispositiu</string>
    <string name="home_device_info">Dispositiu</string>
    <string name="home_system_version">Versió del sistema</string>
    <string name="home_selinux_status_unknown">Desconegut</string>
    <string name="kpm_load">Carregar</string>
    <string name="kpm_add_kpm">Afegir KPM</string>
    <string name="kpm_install">Instal·lar</string>
    <string name="patch_start_patch_btn">Començar</string>
    <string name="patch_embed_kpm_btn">Integrar KPM</string>
    <string name="patch_item_new_extra_kpm">Insereix nou</string>
    <string name="patch_item_extra_author">Autor:</string>
    <string name="patch_item_extra_version">Versió:</string>
    <string name="patch_item_extra_name">Nom:</string>
    <string name="home_kernel">Kernel</string>
    <string name="home_selinux_status_disabled">Deshabilitat</string>
    <string name="home_apatch_version">Versió de APatch</string>
    <string name="kpm">KPModule</string>
    <string name="kpm_kp_not_installed">KernelPatch no instal·lat</string>
    <string name="kpm_embed">Inserir</string>
    <string name="home_kpatch_version">Versió de KernelPatch</string>
    <string name="kpm_version">Versió</string>
    <string name="kpm_license">Llicència</string>
    <string name="kpm_desc">Descripció</string>
    <string name="kpm_author">Autor</string>
    <string name="su_refresh">Actualitzar</string>
    <string name="apm">APModule</string>
    <string name="apm_not_installed">AndroidPatch no instal·lat</string>
    <string name="su_hide_system_apps">Amagar aplicacions del sistema</string>
    <string name="apm_install">Instal·lar</string>
    <string name="apm_desc">Descripció</string>
    <string name="apm_author">Autor</string>
    <string name="patch_item_skey">Super Key</string>
    <string name="patch_select_bootimg_btn">Selecciona el mode d\'arrencada</string>
    <string name="patch_start_unpatch_btn">Desfer pegat</string>
    <string name="patch_mode_uninstall_patch">Mode: Desinstal·lar KPatch</string>
    <string name="patch_mode_install_to_next_slot">Mode: Instal·lar a la ranura inactiva (després de l\'OTA)</string>
</resources>

```

`app/src/main/res/values-cs/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="patch_warnning">Při instalaci může dojít k problémům. Ujistěte se prosím, že vaše data jsou zálohována.</string>
    <string name="reboot_bootloader">Restartovat do: Zavaděč</string>
    <string name="reboot_recovery">Restartovat do: Obnova</string>
    <string name="reboot_edl">Restartovat do: EDL</string>
    <string name="about">O projektu</string>
    <string name="settings_app_language">Jazyk</string>
    <string name="home_working">Funguje 😋</string>
    <string name="home_ap_cando_install">Instalovat</string>
    <string name="home_ap_cando_uninstall">Odinstalovat</string>
    <string name="home_ap_cando_reboot">Restartovat</string>
    <string name="patch_title">Záplata</string>
    <string name="patch_config_title">Záplaty</string>
    <string name="patch_mode_bootimg_patch">Režim: Záplata</string>
    <string name="patch_mode_install_to_next_slot">Režim: Instalace do dalšího slotu (po OTA)</string>
    <string name="patch_mode_patch_and_install">Režim: Záplata a instalace</string>
    <string name="patch_mode_uninstall_patch">Režim: Odinstalovat KPatch</string>
    <string name="patch_select_bootimg_btn">Vybrat boot</string>
    <string name="patch_embed_kpm_btn">Vložit KPM</string>
    <string name="patch_start_patch_btn">Spustit</string>
    <string name="reboot_download">Restartovat do: Stahování</string>
    <string name="reboot">Restartovat</string>
    <string name="settings">Nastavení</string>
    <string name="home_click_to_learn_apatch">Zjistit více o funkcích APatch a jak je používat</string>
    <string name="home_ap_cando_update">Aktualizovat</string>
    <string name="home">Domů</string>
    <string name="success">Úspěch</string>
    <string name="failure">Selhání</string>
    <string name="patch">Záplata</string>
    <string name="system_default">Systém (výchozí)</string>
    <string name="settings_global_namespace_mode">Režim globálního jmenného prostoru</string>
    <string name="settings_global_namespace_mode_summary">Všechny kořenové relace používají připojený globální jmenný prostor</string>
    <string name="settings_clear_super_key_dialog">Opravdu chcete pokračovat?</string>
    <string name="patch_item_new_extra_kpm">Vložit nový</string>
    <string name="purple_theme">Fialové</string>
    <string name="settings_check_update">Zkontrolovat aktualizace</string>
    <string name="patch_item_kpimg_version">Verze:</string>
    <string name="patch_item_kpimg_comile_time">Čas:</string>
    <string name="patch_item_kpimg_config">Konfigurace:</string>
    <string name="send_log">Odeslat protokoly</string>
    <string name="safe_mode">Nouzový režim</string>
    <string name="clear_super_key">Vymazat SuperKlíč</string>
    <string name="patch_set_superkey">Nastavit SuperKlíč</string>
    <string name="home_not_installed">Nenainstalováno</string>
    <string name="home_install_unknown">Není nainstalováno nebo ověřeno</string>
    <string name="home_need_update">Dostupná nová verze</string>
    <string name="home_installing">Instaluje se</string>
    <string name="home_click_to_install">Kliknutím nainstalovat</string>
    <string name="apatch_version">Verze: %s</string>
    <string name="apatch_version_update">Verze: %s -&gt; %s</string>
    <string name="patch_item_bootimg_dev">zařízení:</string>
    <string name="settings_check_update_summary">Automaticky kontrolovat aktualizace při otevření aplikace</string>
    <string name="save_log">Uložit protokoly</string>
    <string name="log_saved">Protokoly uloženy</string>
    <string name="super_key">SuperKlíč</string>
    <string name="home_patch_next_step">Další krok</string>
    <string name="kpatch_version">Verze: %s</string>
    <string name="kpatch_version_update">Verze: %s -&gt; %s</string>
    <string name="home_install_unknown_summary">Kliknutím nainstalovat</string>
    <string name="about_source_code"><![CDATA[<p>Zobrazit zdrojový kód na %1$s<p/> Připojit se k našemu kanálu %2$s<p/> Připojit se k naší skupině %3$s]]></string>
    <string name="home_learn_apatch">Prozkoumat APatch</string>
    <string name="patch_start_unpatch_btn">Odstranit záplatu</string>
    <string name="apm_uninstall_success">%s odinstalován</string>
    <string name="apm_overlay_fs_not_available">Moduly nejsou k dispozici, protože OverlayFS je zakázáno jádrem!</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="home_kpatch_info_title">Informace</string>
    <string name="home_auth_key_desc">Spustit po ověření</string>
    <string name="patch_item_error">!!CHYBA!!</string>
    <string name="patch_item_bootimg_slot">slot:</string>
    <string name="patch_item_extra_name">Jméno:</string>
    <string name="patch_item_extra_kpm_license">Licence:</string>
    <string name="patch_item_extra_kpm_desciption">Popis:</string>
    <string name="patch_item_extra_args">Parametry:</string>
    <string name="patch_item_extra_event">Událost:</string>
    <string name="patch_item_skey">SuperKlíč</string>
    <string name="home_fingerprint">Otisk zařízení</string>
    <string name="home_selinux_status">Stav SELinuxu</string>
    <string name="home_selinux_status_unknown">Neznámý</string>
    <string name="home_selinux_status_enforcing">Vynucený</string>
    <string name="home_selinux_status_disabled">Vypnutý</string>
    <string name="home_device_info">Zařízení</string>
    <string name="home_system_version">Verze systému</string>
    <string name="home_su_path">Spustitelný su</string>
    <string name="home_apatch_version">Verze APatch</string>
    <string name="kpm">KPModul</string>
    <string name="kpm_kp_not_installed">KernelPatch není nainstalován</string>
    <string name="kpm_load">Načíst</string>
    <string name="kpm_install">Instalovat</string>
    <string name="kpm_embed">Vložit</string>
    <string name="kpm_unload_confirm">Vyjmout modul \"%s\"?</string>
    <string name="kpm_control">Ovládání</string>
    <string name="kpm_version">Verze</string>
    <string name="kpm_license">Licence</string>
    <string name="kpm_author">Autor</string>
    <string name="kpm_desc">Popis</string>
    <string name="su_pkg_excluded_label">vyloučit</string>
    <string name="su_pkg_excluded_setting_title">Vyloučit úpravy</string>
    <string name="su_hide_system_apps">Skrýt systémové aplikace</string>
    <string name="su_refresh">Оbnovit</string>
    <string name="apm">APModul</string>
    <string name="apm_failed_to_enable">Nelze zapnout modul \"%s\"</string>
    <string name="apm_downloading">Stahování modulu \"%s\"…</string>
    <string name="hide_apatch_dialog_summary">Nový název bude zobrazen ve spouštěči</string>
    <string name="setting_reset_su_path">Obnovit cestu su</string>
    <string name="setting_reset_su_new_path">Nová úplná cesta</string>
    <string name="settings_donot_store_superkey_summary">Při každém spuštění manažera bude vyžadován SuperKlíč</string>
    <string name="home_auth_key_title">Zadejte SuperKlíč</string>
    <string name="home_patch_set_key_desc">Pouze pro ověření KernelPatch</string>
    <string name="su_pkg_excluded_setting_summary">Zapnutí způsobí to, že APatch použije pro tuto aplikaci soubory, které nejsou upraveny moduly.</string>
    <string name="su_show_system_apps">Zobrazit systémové aplikace</string>
    <string name="hide_apatch_manager_summary">Instalovat nového manažera s náhodným ID balíčku a vlastním názvem</string>
    <string name="hide_apatch_manager_failure">Skrytí se nezdařilo, prosím nahlaste chybu!</string>
    <string name="apm_not_installed">AndroidPatch není nainstalován</string>
    <string name="apm_desc">Popis</string>
    <string name="apm_reboot_to_apply">Restartujte, aby se projevil účinek</string>
    <string name="apm_start_downloading">Stahování %s</string>
    <string name="apm_new_version_available">Je k dispozici nová verze: %s, kliknutím aktualizovat.</string>
    <string name="home_kernel">Jádro</string>
    <string name="patch_item_kernel">Jádro</string>
    <string name="patch_item_extra_author">Autor:</string>
    <string name="patch_item_existed_extra_kpm">Existuje</string>
    <string name="patch_item_extra_version">Verze:</string>
    <string name="patch_item_set_skey_label">Délka SuperKlíče by měla být alespoň 8 znaků a měla by obsahovat čísla a písmena, ale bez speciálních znaků.</string>
    <string name="home_manager_version">Verze manažera</string>
    <string name="home_selinux_status_permissive">Tolerantní (povolený s protokolováním)</string>
    <string name="home_kpatch_version">Verze KernelPatch</string>
    <string name="kpm_add_kpm">Přidat KPM</string>
    <string name="kpm_load_toast_succ">Načtení dokončeno</string>
    <string name="kpm_load_toast_failed">Načtení selhalo</string>
    <string name="kpm_unload">Vyjmout</string>
    <string name="kpm_apm_empty">Žádný modul není načten</string>
    <string name="kpm_args">Parametry</string>
    <string name="su_title">SuperUživatel</string>
    <string name="su_selinux_via_hook">obejít přes háček</string>
    <string name="enable_web_debugging">Povolit ladění WebView</string>
    <string name="settings_donot_store_superkey">Neukládat SuperKlíč v zařízení</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="apm_uninstall_failed">Nelze odinstalovat %s</string>
    <string name="enable_web_debugging_summary">Může být použito k ladění WebUI. Prosím, tuto možnost povolte pouze v případě potřeby.</string>
    <string name="apm_empty">Není nainstalován žádný modul</string>
    <string name="apm_uninstall_confirm">Odinstalovat modul \"%s?</string>
    <string name="apm_magisk_conflict">Moduly nejsou k dispozici kvůli konfliktu s Magiskem!</string>
    <string name="hide_apatch_dialog_new_manager_name">Nový název manažera</string>
    <string name="apm_failed_to_disable">Nelze vypnout modul \"%s\"</string>
    <string name="hide_apatch_manager">Skrýt manažera APatch</string>
    <string name="apm_version">Verze</string>
    <string name="apm_changelog">Seznam změn</string>
    <string name="apm_update">Aktualizovat</string>
    <string name="apm_webui_open">Otevřít</string>
    <string name="apm_remove">Odstranit</string>
    <string name="apm_install">Instalovat</string>
    <string name="apm_author">Autor</string>
    <string name="apm_action">Akce</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="home_more_menu_about">O projektu</string>
    <string name="patch_item_bootimg">bootimg</string>
    <string name="home_new_apatch_found">Je k dispozici nová verze: %s, kliknutím aktualizovat.</string>
    <string name="mode_select_page_select_file">Vybrat a záplatovat bootovací obraz</string>
    <string name="kpm_control_dialog_title">Ovládání KPModulu</string>
    <string name="home_dialog_auth_fail_content">Nelze ověřit SuperKlíč, proto APatch nemůže správně fungovat.\nZde jsou některé možné důvody selhání:\n1. Bootovací obraz nebyl opraven pomocí KernelPatch.\n2. Opravený bootovací obraz nebyl flashován.\n3. SuperKlíč je špatný.\n4. Vaše zařízení nepodporuje APatch a KernelPatch.\n\nZkontrolujte prosím a zkuste to znovu. Pokud problémy přetrvávají, můžete se zeptat na stránce s problémy oficiálního úložiště.</string>
    <string name="mode_select_page_patch_and_install">Záplatovat a nainstalovat</string>
    <string name="mode_select_page_install_inactive_slot_warning">Vaše zařízení bude po restartu **NUCENĚ** startovat do neaktivního slotu!\nTuto možnost použijte až po dokončení OTA.\nPokračovat?</string>
    <string name="mode_select_page_install_inactive_slot">Instalovat do neaktivního slotu (po OTA)</string>
    <string name="home_dialog_uninstall_ap_only">Odebrat AndroidPatch</string>
    <string name="home_dialog_uninstall_all">Odinstalovat vše</string>
    <string name="home_more_menu_feedback_or_suggestion">Zpětná vazba nebo návrhy</string>
    <string name="home_dialog_auth_fail_title">Ověření selhalo</string>
    <string name="home_dialog_uninstall_title">Odinstalovat</string>
    <string name="mode_select_page_title">Instalovat</string>
    <string name="settings_use_system_color_theme">Systémové barevné téma</string>
    <string name="blue_theme">Modré</string>
    <string name="lime_theme">Limetkové</string>
    <string name="sakura_theme">Sakurové</string>
    <string name="kpm_control_dialog_content">Zadejte ovládací parametry:</string>
    <string name="kpm_control_paramters">Parametry</string>
    <string name="kpm_control_outMsg">Zpráva</string>
    <string name="kpm_control_ok">Operace se zdařila!</string>
    <string name="kpm_control_failed">Operace selhala!</string>
    <string name="settings_night_mode_follow_sys">Následovat tmavé systémové téma</string>
    <string name="settings_night_mode_follow_sys_summary">Automaticky přepnout na tmavé téma se systémem</string>
    <string name="settings_night_theme_enabled">Povolit tmavé téma</string>
    <string name="settings_use_system_color_theme_summary">Použít barevné téma generované systémem z aktuální tapety</string>
    <string name="amber_theme">Jantarové</string>
    <string name="blue_grey_theme">Modrošedé</string>
    <string name="brown_theme">Hnědé</string>
    <string name="cyan_theme">Azurové</string>
    <string name="deep_orange_theme">Tmavě oranžové</string>
    <string name="deep_purple_theme">Tmavě fialové</string>
    <string name="green_theme">Zelené</string>
    <string name="indigo_theme">Indigové</string>
    <string name="light_blue_theme">Světle modré</string>
    <string name="light_green_theme">Světle zelené</string>
    <string name="orange_theme">Oranžové</string>
    <string name="teal_theme">Modrozelené</string>
    <string name="yellow_theme">Žluté</string>
    <string name="settings_custom_color_theme">Barevné téma</string>
    <string name="pink_theme">Růžové</string>
    <string name="red_theme">Červené</string>
    <string name="about_app_version">Verze %1$s</string>
    <string name="about_app_desc">Kernel Root je řešení pouze pro holý obraz jádra, který poskytuje možnost připojení systémového modulu a zaháčkování funkce jádra.</string>
    <string name="about_telegram_channel">Kanál na Telegramu</string>
    <string name="about_telegram_group">Skupina na Telegramu</string>
    <string name="about_powered_by">Běží na %1$s</string>
    <string name="crash_handle_title">Aplikace selhala…</string>
    <string name="crash_handle_copy">Kopírovat protokol o selhání</string>
    <string name="crash_handle_copied">Kopírovat protokol o selhání do schránky.</string>
</resources>

```

`app/src/main/res/values-da/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="home">Hjem</string>
    <string name="failure">Fejl</string>
    <string name="patch">Patch</string>
    <string name="success">Success</string>
    <string name="patch_warnning">Installation kommer med risici. Sørg for, at dine data er sikkerhedskopieret.</string>
    <string name="home_click_to_install">Klik for at installere</string>
    <string name="home_installing">Installerer</string>
    <string name="home_ap_cando_install">Installer</string>
    <string name="save_log">Gem log</string>
    <string name="settings_app_language">Sprog</string>
    <string name="settings_check_update_summary">Check automatisk for opdateringer ved start af appen</string>
    <string name="safe_mode">Sikker modus</string>
    <string name="home_install_unknown_summary">Klik for at installere</string>
    <string name="home_working">Arbejder 😋</string>
    <string name="home_patch_next_step">Næste skridt</string>
    <string name="send_log">Send logs</string>
    <string name="log_saved">Log gemt</string>
    <string name="home_need_update">Ny version tilgængelig</string>
    <string name="settings_clear_super_key_dialog">Vil du virkelig fortsætte?</string>
    <string name="home_not_installed">Ikke installeret</string>
    <string name="home_ap_cando_reboot">Genstart</string>
    <string name="settings">Indstillinger</string>
    <string name="reboot">Genstart</string>
    <string name="about">Om</string>
    <string name="settings_check_update">Check opdatering</string>
</resources>

```

`app/src/main/res/values-de/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="home_click_to_learn_apatch">Erfahre mehr über die Funktionen von APatch und wie man sie verwendet</string>
    <string name="about_source_code"><![CDATA[<p>Quellcode anzeigen unter %1$s<p/>Trete unserem %2$s Kanel bei<p/>Trete unserer %3$s Gruppe bei]]></string>
    <string name="home">Startseite</string>
    <string name="reboot">Neustart</string>
    <string name="settings">Einstellungen</string>
    <string name="home_install_unknown">Unbekannt</string>
    <string name="home_need_update">Eine neue Version ist verfügbar</string>
    <string name="apatch_version">Version: %s</string>
    <string name="home_ap_cando_install">Installieren</string>
    <string name="home_ap_cando_update">Aktualisieren</string>
    <string name="home_ap_cando_uninstall">Deinstallieren</string>
    <string name="home_kernel">Kernelversion</string>
    <string name="home_not_installed">Nicht installiert</string>
    <string name="home_fingerprint">Fingerabdruck</string>
    <string name="patch_warnning">Die Installation ist mit Risiken verbunden. Bitte stellen Sie sicher, dass Ihre Daten gesichert sind.</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="reboot_bootloader">Neustart zum Bootloader</string>
    <string name="home_learn_apatch">Lerne APatch kennen</string>
    <string name="home_patch_set_key_desc">Nur Anmeldedaten für KernelPatch</string>
    <string name="home_patch_next_step">Nächster Schritt</string>
    <string name="kpatch_version">Version: %s</string>
    <string name="apatch_version_update">Version: %s -&gt; %s</string>
    <string name="home_auth_key_desc">Start nach Zertifizierung</string>
    <string name="home_manager_version">Manager Version</string>
    <string name="su_pkg_excluded_setting_summary">Durch Aktivierung dieser Option kann APatch alle von den Modulen dieser App geänderten Dateien wiederherstellen.</string>
    <string name="apm_failed_to_disable">Das Modul \"%s\" konnte nicht deaktiviert werden</string>
    <string name="home_selinux_status_disabled">Deaktiviert</string>
    <string name="apm_magisk_conflict">Module sind aufgrund eines Konfliktes mit Magisk nicht verfügbar.</string>
    <string name="apm_downloading">Modul \"%s\" wird heruntergeladen…</string>
    <string name="apm_start_downloading">Download von %s starten</string>
    <string name="kpm_unload_confirm">Modul \"%s\" entladen?</string>
    <string name="apm_failed_to_enable">Das Modul \"%s\" konnte nicht eingeschaltet werden</string>
    <string name="home_apatch_version">APatch Version</string>
    <string name="home_selinux_status">SELinux-Status</string>
    <string name="reboot_recovery">Neustart zum Wiederherstellen</string>
    <string name="reboot_download">Neustart zum Herunterladen</string>
    <string name="reboot_edl">Neustart zur EDL</string>
    <string name="about">Über</string>
    <string name="send_log">Logs senden</string>
    <string name="safe_mode">Sicherer Modus</string>
    <string name="home_click_to_install">Klicke zum Installieren</string>
    <string name="home_working">Funktioniert</string>
    <string name="home_su_path">su: %s</string>
    <string name="patch_title">Patch</string>
    <string name="su_pkg_excluded_label">Absondern</string>
    <string name="home_selinux_status_enforcing">Erzwingt</string>
    <string name="home_selinux_status_permissive">Zulässig</string>
    <string name="super_key">SuperKey</string>
    <string name="clear_super_key">Superschlüssel löschen</string>
    <string name="patch_set_superkey">Superschlüssel festlegen</string>
    <string name="home_installing">Installiert</string>
    <string name="home_auth_key_title">Superschlüssel eingeben</string>
    <string name="kpm">KPModule</string>
    <string name="home_selinux_status_unknown">Unbekannt</string>
    <string name="kpm_kp_not_installed">KernelPatch nicht installiert</string>
    <string name="kpm_unload">Entladen</string>
    <string name="kpm_apm_empty">Kein Modul geladen</string>
    <string name="apm">APModul</string>
    <string name="apm_not_installed">AndroidPatch nicht installiert</string>
    <string name="apm_empty">Kein Modul installiert</string>
    <string name="apm_uninstall_confirm">Modul \"%s\" deinstallieren?</string>
    <string name="apm_overlay_fs_not_available">Module sind nicht verfügbar, da OverlayFS vom Kernel deaktiviert ist!</string>
    <string name="apm_reboot_to_apply">Neustarten, um Änderungen zu speichern</string>
    <string name="apm_new_version_available">Neue Version %s ist verfügbar, klicken Sie zum Aktualisieren.</string>
    <string name="apm_uninstall_success">%s deinstalliert</string>
    <string name="kpm_load">Laden</string>
    <string name="kpm_version">Version</string>
    <string name="kpm_license">Lizenz</string>
    <string name="kpm_author">Autor</string>
    <string name="su_title">Superuser</string>
    <string name="su_show_system_apps">Systemanwendungen zeigen</string>
    <string name="su_hide_system_apps">System-Apps ausblenden</string>
    <string name="apm_remove">Entfernen</string>
    <string name="apm_install">Installieren</string>
    <string name="apm_uninstall_failed">Konnte %s nicht deinstallieren</string>
    <string name="apm_version">Version</string>
    <string name="apm_update">Aktualisieren</string>
    <string name="apm_author">Autor</string>
    <string name="kpm_load_toast_succ">Laden erfolgreich</string>
    <string name="kpm_load_toast_failed">Laden fehlgeschlagen</string>
    <string name="kpm_desc">Beschreibung</string>
    <string name="kpm_args">Argumente</string>
    <string name="su_selinux_via_hook">Umgehung über einhaken</string>
    <string name="su_pkg_excluded_setting_title">Änderungen ausschließen</string>
    <string name="su_refresh">Aktualisieren</string>
    <string name="apm_desc">Beschreibung</string>
    <string name="apm_changelog">Änderungsprotokoll</string>
    <string name="settings_app_language">Sprache</string>
    <string name="system_default">Systemstandard</string>
    <string name="patch">Patch</string>
    <string name="settings_global_namespace_mode">Globaler Namespace-Modus</string>
    <string name="settings_global_namespace_mode_summary">Alle Root-Sitzungen verwenden den globalen Mount-Namespace</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="home_kpatch_info_title">Info</string>
    <string name="settings_clear_super_key_dialog">Wollen Sie wirklich fortfahren?</string>
    <string name="kpatch_version_update">Version: %s -&gt; %s</string>
    <string name="patch_config_title">Korrekturen</string>
    <string name="patch_mode_bootimg_patch">Modus: Korrektur</string>
    <string name="patch_mode_uninstall_patch">Modus: EntKorrektur</string>
    <string name="home_ap_cando_reboot">Neustart</string>
    <string name="patch_select_bootimg_btn">Wählen Sie Start</string>
    <string name="patch_embed_kpm_btn">Eingebettetes KPM</string>
    <string name="patch_start_unpatch_btn">EntKorrektur</string>
    <string name="patch_item_bootimg">Startbild</string>
    <string name="patch_item_error">!!Fehler!!</string>
    <string name="patch_item_bootimg_slot">Schacht:</string>
    <string name="patch_item_bootimg_dev">Gerät:</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_kpimg_version">Version:</string>
    <string name="patch_item_kpimg_comile_time">Dauer:</string>
    <string name="patch_item_kpimg_config">Konfiguration:</string>
    <string name="patch_item_new_extra_kpm">Neues einbetten</string>
    <string name="patch_item_extra_name">Name:</string>
    <string name="patch_item_extra_version">Version:</string>
    <string name="patch_item_extra_author">Autor:</string>
    <string name="patch_item_extra_kpm_license">Lizenz:</string>
    <string name="patch_item_extra_kpm_desciption">Beschreibung:</string>
    <string name="patch_item_extra_args">Args:</string>
    <string name="patch_item_extra_event">Ereignis:</string>
    <string name="patch_item_skey">SuperKey</string>
    <string name="patch_start_patch_btn">Starten</string>
    <string name="patch_item_kernel">Kernel</string>
    <string name="patch_item_existed_extra_kpm">existiert</string>
    <string name="patch_item_set_skey_label">Der SuperKey sollte 8 bis 63 Zeichen lang sein und Zahlen sowie Buchstaben enthalten, jedoch keine Sonderzeichen.</string>
    <string name="settings_check_update">Auf Updates prüfen</string>
    <string name="home_install_unknown_summary">Klicke zum Installieren</string>
    <string name="patch_mode_patch_and_install">Modus: Patchen und installieren</string>
    <string name="enable_web_debugging">WebView-Debugging aktivieren</string>
    <string name="blue_grey_theme">Blaugrau</string>
    <string name="amber_theme">Bernstein</string>
    <string name="blue_theme">Blau</string>
    <string name="brown_theme">Braun</string>
    <string name="green_theme">Grün</string>
    <string name="about_telegram_group">Telegram-Gruppe</string>
    <string name="about_telegram_channel">Telegram-Kanal</string>
    <string name="settings_check_update_summary">Beim Öffnen der App automatisch nach Updates suchen</string>
    <string name="enable_web_debugging_summary">Kann zum debuggen von WebUI benutzt werden. Bitte nur bei Bedarf aktivieren.</string>
    <string name="apm_webui_open">Öffnen</string>
    <string name="failure">Fehler</string>
    <string name="success">Erfolg</string>
    <string name="home_device_info">Gerät</string>
    <string name="home_kpatch_version">KernelPatch Version</string>
    <string name="home_system_version">Systemversion</string>
    <string name="kpm_embed">Einbetten</string>
    <string name="kpm_control">Steuerung</string>
    <string name="kpm_add_kpm">KPM hinzufügen</string>
    <string name="kpm_install">Installieren</string>
    <string name="hide_apatch_manager">APatch Manager ausblenden</string>
    <string name="setting_reset_su_new_path">Neuer vollständiger Pfad</string>
    <string name="hide_apatch_dialog_new_manager_name">Neuer Name des Managers</string>
    <string name="mode_select_page_patch_and_install">Patchen und installieren</string>
    <string name="mode_select_page_title">Installieren</string>
    <string name="mode_select_page_select_file">Wählen Sie ein Boot-Image zum Patchen aus</string>
    <string name="home_dialog_auth_fail_title">Authentifizierung fehlgeschlagen</string>
    <string name="home_more_menu_feedback_or_suggestion">Rückmeldung oder Anregung</string>
    <string name="home_more_menu_about">Über</string>
    <string name="home_dialog_uninstall_title">Deinstallieren</string>
    <string name="home_dialog_uninstall_ap_only">AndroidPatch entfernen</string>
    <string name="kpm_control_dialog_title">KPModule steuern</string>
    <string name="kpm_control_paramters">Parameter</string>
    <string name="kpm_control_outMsg">Nachricht</string>
    <string name="kpm_control_failed">Operation fehlgeschlagen!</string>
    <string name="home_dialog_uninstall_all">Alle deinstallieren</string>
    <string name="kpm_control_ok">Operation erfolgreich!</string>
    <string name="settings_night_mode_follow_sys">Dunklem Schema des Systems folgen</string>
    <string name="settings_night_mode_follow_sys_summary">Automatischer Wechsel zu einem dunklen Schema basierend auf den Systemeinstellungen</string>
    <string name="settings_night_theme_enabled">Dunkles Schema aktivieren</string>
    <string name="settings_use_system_color_theme">Systemfarbschema</string>
    <string name="patch_mode_install_to_next_slot">Modus: In inaktivem Slot installieren (Nach OTA)</string>
    <string name="setting_reset_su_path">su-Pfad zurücksetzen</string>
    <string name="hide_apatch_manager_failure">Verstecken fehlgeschlagen. Bitte melde den Fehler!</string>
    <string name="settings_donot_store_superkey">Superschlüssel nicht lokal speichern</string>
    <string name="home_new_apatch_found">Eine neue Version %s ist verfügbar, klicken Sie hier, um zu aktualisieren.</string>
    <string name="mode_select_page_install_inactive_slot">Auf inaktiven Slot installieren (Nach OTA)</string>
    <string name="hide_apatch_manager_summary">Installieren Sie eine Proxy-App mit einer zufälligen Paket-ID und einer benutzerdefinierten App-Bezeichnung</string>
    <string name="hide_apatch_dialog_summary">Wird als App-Bezeichnung auf dem Home-Screen genutzt</string>
    <string name="settings_donot_store_superkey_summary">Authentifiziere den SuperKey jedes Mal, wenn der Manager gestartet wird.</string>
    <string name="kpm_control_dialog_content">Eingabekontrollparameter:</string>
    <string name="mode_select_page_install_inactive_slot_warning">Dein Gerät wird **GEZWUNGEN**, nach dem Neustart den inaktiven Slot zu nutzen!
\nNutze diese Funktion ausschließlich, wenn ein OTA-Update durchgeführt wurde.
\nFortfahren?</string>
    <string name="settings_custom_color_theme">Farbschema</string>
    <string name="deep_orange_theme">Tieforange</string>
    <string name="cyan_theme">Cyan</string>
    <string name="deep_purple_theme">Tiefviolett</string>
    <string name="indigo_theme">Indigo</string>
    <string name="light_blue_theme">Hellblau</string>
    <string name="light_green_theme">Hellgrün</string>
    <string name="lime_theme">Limone</string>
    <string name="orange_theme">Orange</string>
    <string name="sakura_theme">Sakura</string>
    <string name="pink_theme">Rosa</string>
    <string name="purple_theme">Lila</string>
    <string name="teal_theme">Türkisblau</string>
    <string name="yellow_theme">Gelb</string>
    <string name="about_app_version">Version %1$s</string>
    <string name="about_powered_by">Unterstützt durch %1$s</string>
    <string name="red_theme">Rot</string>
    <string name="about_app_desc">Kernel-Root-Lösung mit nur einem gestrippten Kernel-Image, das die Möglichkeit bietet, Systemmodule zu mounten und Kernel-Funktionen einzuhängen.</string>
    <string name="settings_use_system_color_theme_summary">Verwende ein Farbthema, das basierend aus dem aktuellen Hintergrund vom System erzeugt wird</string>
    <string name="home_dialog_auth_fail_content">Superschlüssel kann nicht authentifiziert werden, daher kann APatch nicht richtig funktionieren. \nMögliche Gründe für Authentifizierungsfehler können sein: \n1. Das boot.img wurde nicht mit dem KernelPatch gepatcht. \n2. Das gepatchte boot.img wurde nicht geflasht. \n3. Superschlüssel ist falsch, oder enthält Sonderzeichen. \n4. Ihr Gerät unterstützt APatch und KernelPatch nicht. \n \nBitte überprüfen und nochmal versuchen. Wenn weiterhin Probleme auftreten, können Fragen auf der offiziellen Issues-Seite des Repository gestellt werden.</string>
    <string name="save_log">Logs speichern</string>
    <string name="apm_action">Aktion</string>
    <string name="log_saved">Protokoll gespeichert</string>
    <string name="crash_handle_copy">Absturzprotokoll kopieren</string>
    <string name="crash_handle_copied">Absturzprotokoll in die Zwischenablage kopiert.</string>
    <string name="crash_handle_title">App ist abgestürzt…</string>
    <string name="settings_lite_mode">Lite-Modus einschalten</string>
    <string name="settings_lite_mode_mode_summary">APModul-Funktionen können nach ihrer Aktivierung Fehler aufweisen, aber in einigen Fällen können sie immer noch effektiv die Erkennung vermeiden. Neustart erforderlich.</string>
    <string name="settings_force_overlayfs_mode">Verwendung von OverlayFS erzwingen</string>
    <string name="settings_force_overlayfs_mode_summary">Verwende, wenn Kernel-Unterstützung verfügbar ist, OverlayFS zum Einhängen von APModulen anstelle von Magic Mount. Neustart erforderlich.</string>
</resources>

```

`app/src/main/res/values-el/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="patch_warnning">Η εγκατάσταση συνοδεύεται από κινδύνους. Βεβαιωθείτε ότι έχετε δημιουργήσει αντίγραφα ασφαλείας των δεδομένων σας.</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="reboot">Επανεκκίνηση</string>
    <string name="settings">Ρυθμίσεις</string>
    <string name="reboot_bootloader">Επανεκκίνηση στον Bootloader</string>
    <string name="home">Αρχική</string>
    <string name="system_default">Προεπιλογή συστήματος</string>
    <string name="reboot_edl">Επανεκκίνηση σε EDL</string>
    <string name="reboot_recovery">Επανεκκίνηση στο Recovery</string>
    <string name="reboot_download">Επανεκκίνηση για λήψη</string>
    <string name="about">Σχετικά με το</string>
    <string name="home_learn_apatch">Μάθετε το APatch</string>
    <string name="home_click_to_learn_apatch">Μάθετε για τα χαρακτηριστικά του APatch και πώς να το χρησιμοποιείτε</string>
    <string name="settings_app_language">Γλώσσα</string>
    <string name="patch">Επιδιόρθωση</string>
    <string name="home_auth_key_title">Εισαγάγετε το ΥπέρΚλειδί</string>
    <string name="apm">Ενότητα AP</string>
    <string name="apm_install">Εγκατάσταση</string>
    <string name="apm_update">Ενημέρωση</string>
    <string name="home_need_update">Νέα έκδοση διαθέσιμη</string>
    <string name="home_working">Λειτουργεί 😋</string>
    <string name="patch_title">Επιδιόρθωση</string>
    <string name="kpatch_version">Έκδοση: %s</string>
    <string name="kpm_unload_confirm">Ξεφόρτωση ενότητας \"%s\"?</string>
    <string name="apatch_version">Έκδοση: %s</string>
    <string name="home_fingerprint">Δακτυλικό αποτύπωμα</string>
    <string name="su_title">Υπερχρήστης</string>
    <string name="apm_downloading">Λήψη της ενότητας \"%s\"…</string>
    <string name="su_hide_system_apps">Απόκρυψη εφαρμογών συστήματος</string>
    <string name="home_selinux_status_disabled">Απενεργοποιημένο</string>
    <string name="kpm_author">Δημιουργός</string>
    <string name="home_click_to_install">Κλικ για εγκατάσταση</string>
    <string name="home_ap_cando_install">Εγκατάσταση</string>
    <string name="apm_not_installed">Το AndroidPatch δεν έχει εγκατασταθεί</string>
    <string name="su_refresh">Ανανέωση</string>
    <string name="home_selinux_status">Κατάσταση SELinux</string>
    <string name="send_log">Αποστολή αρχείων καταγραφής</string>
    <string name="safe_mode">Ασφαλής λειτουργία</string>
    <string name="about_source_code"><![CDATA[<p>Προβολή πηγαίου κώδικα στο %1$s<p/>Εγγραφείτε στο κανάλι μας %2$s<p/>Εγγραφείτε στην ομάδα μας %3$s]]></string>
    <string name="apm_uninstall_confirm">Απεγκατάσταση ενότητας \"%s\"?</string>
    <string name="apm_failed_to_disable">Δεν ήταν δυνατή η απενεργοποίηση της ενότητας \"%s\"</string>
    <string name="apm_empty">Δεν υπάρχει εγκατεστημένη ενότητα</string>
    <string name="apm_remove">Αφαίρεση</string>
    <string name="apm_desc">Περιγραφή</string>
    <string name="apm_reboot_to_apply">Επανεκκίνηση για να τεθεί σε ισχύ</string>
    <string name="apm_changelog">Καταγραφή αλλαγών</string>
    <string name="apm_overlay_fs_not_available">Οι ενότητες δεν είναι διαθέσιμες καθώς το OverlayFS είναι απενεργοποιημένο από τον πυρήνα!</string>
    <string name="apm_magisk_conflict">Οι ενότητες δεν είναι διαθέσιμες λόγω διένεξης με το Magisk!</string>
    <string name="apm_new_version_available">Η νέα έκδοση %s είναι διαθέσιμη, κάντε κλικ για αναβάθμιση.</string>
    <string name="apm_start_downloading">Έναρξη λήψης %s</string>
    <string name="super_key">ΥπέρΚλειδί</string>
    <string name="clear_super_key">Εκκαθάριση ΥπέρΚλειδιού</string>
    <string name="patch_set_superkey">Ορισμός ΥπέρΚλειδιού</string>
    <string name="home_patch_set_key_desc">Μόνο διαπιστευτήρια για το KernelPatch</string>
    <string name="home_patch_next_step">Επόμενο βήμα</string>
    <string name="home_not_installed">Δεν έχει εγκατασταθεί</string>
    <string name="home_install_unknown">Δεν έχει εγκατασταθεί ή πιστοποιηθεί</string>
    <string name="home_installing">Γίνεται εγκατάσταση</string>
    <string name="apatch_version_update">Έκδοση: %s -&gt; %s</string>
    <string name="home_su_path">Εκτελέσιμο su</string>
    <string name="home_auth_key_desc">Έναρξη μετά την πιστοποίηση</string>
    <string name="home_ap_cando_update">Ενημέρωση</string>
    <string name="home_kernel">Έκδοση Πυρήνα</string>
    <string name="home_manager_version">Έκδοση διαχειριστή</string>
    <string name="home_selinux_status_enforcing">Επιβολή</string>
    <string name="home_selinux_status_permissive">Επιτρεπτικό</string>
    <string name="home_selinux_status_unknown">Άγνωστο</string>
    <string name="kpm">Ενότητα KP</string>
    <string name="kpm_load">Φόρτωση</string>
    <string name="kpm_load_toast_failed">Αποτυχία φόρτωσης</string>
    <string name="kpm_unload">Ξεφόρτωση</string>
    <string name="kpm_version">Έκδοση</string>
    <string name="kpm_desc">Περιγραφή</string>
    <string name="kpm_args">Επιχειρήματα</string>
    <string name="su_pkg_excluded_label">Αποκλεισμένο</string>
    <string name="su_pkg_excluded_setting_title">Εξαίρεση τροποποιήσεων</string>
    <string name="apm_failed_to_enable">Δεν ήταν δυνατή η ενεργοποίηση της ενότητας \"%s\"</string>
    <string name="apm_uninstall_failed">Δεν ήταν δυνατή η απεγκατάσταση του %s</string>
    <string name="apm_version">Έκδοση</string>
    <string name="apm_author">Δημιουργός</string>
    <string name="home_ap_cando_uninstall">Απεγκατάσταση</string>
    <string name="home_apatch_version">Έκδοση APatch</string>
    <string name="kpm_kp_not_installed">Το KernelPatch δεν έχει εγκατασταθεί</string>
    <string name="kpm_load_toast_succ">Επιτυχής φόρτωση</string>
    <string name="kpm_apm_empty">Δεν έχει φορτωθεί καμία ενότητα</string>
    <string name="kpm_license">Άδεια</string>
    <string name="su_selinux_via_hook">παράκαμψη μέσω γάντζου</string>
    <string name="su_show_system_apps">Εμφάνιση εφαρμογών συστήματος</string>
    <string name="apm_uninstall_success">%s απεγκαταστάθηκε</string>
    <string name="success">Επιτυχία</string>
    <string name="failure">Αποτυχία</string>
    <string name="settings_clear_super_key_dialog">Θέλετε πραγματικά να προχωρήσετε?</string>
    <string name="settings_check_update">Έλεγχος για ενημερώσεις</string>
    <string name="settings_check_update_summary">Αυτόματος έλεγχος για ενημερώσεις κατά το άνοιγμα της εφαρμογής</string>
    <string name="save_log">Αποθήκευση αρχείων καταγραφής</string>
    <string name="deep_purple_theme">Βαθύ μώβ</string>
    <string name="green_theme">Πράσινο</string>
    <string name="indigo_theme">Indigo</string>
    <string name="light_blue_theme">Γαλάζιο</string>
    <string name="log_saved">Τα αρχεία καταγραφής αποθηκεύτηκαν</string>
    <string name="home_kpatch_version">Έκδοση KernelPatch</string>
    <string name="amber_theme">Κεχριμπαρένιο</string>
    <string name="blue_theme">Μπλέ</string>
    <string name="setting_reset_su_path">Επαναφορά διαδρομής su</string>
    <string name="pink_theme">Ροζ</string>
    <string name="purple_theme">Μώβ</string>
    <string name="crash_handle_title">Η εφαρμογή κατέρρευσε…</string>
    <string name="crash_handle_copy">Αντιγραφή αρχείου καταγραφής σφαλμάτων</string>
    <string name="su_pkg_excluded_setting_summary">Η ενεργοποίηση αυτής της επιλογής θα επιτρέψει στο APatch να επαναφέρει τυχόν αρχεία που έχουν τροποποιηθεί από τις λειτουργικές μονάδες αυτής της εφαρμογής.</string>
    <string name="settings_custom_color_theme">Χρώμα θέματος</string>
    <string name="blue_grey_theme">Μπλέ γκρί</string>
    <string name="enable_web_debugging_summary">Μπορεί να χρησιμοποιηθεί για εντοπισμό σφαλμάτων WebUI, Παρακαλώ ενεργοποιήσει μόνο όταν χρειάζεται.</string>
    <string name="hide_apatch_manager_summary">Εγκατάσταση μιας εφαρμογής proxy με τυχαίο αναγνωριστικό πακέτου και προσαρμοσμένη ετικέτα εφαρμογής</string>
    <string name="home_dialog_auth_fail_content">Δεν είναι δυνατός ο έλεγχος ταυτότητας του ΥπέρΚλειδιού, επομένως το APatch δεν μπορεί να λειτουργήσει σωστά.\nΑκολουθούν ορισμένοι πιθανοί λόγοι για την αποτυχία του ελέγχου ταυτότητας:\n1. Δεν επιδιορθώσατε το boot.img με το KernelPatch.\n2. Το διορθωμένο boot.img δεν περάστηκε.\n3. Το ΥπέρΚλειδί είναι λάθος ή περιέχει ειδικούς χαρακτήρες.\n4. Η συσκευή σας δεν υποστηρίζει το APatch και KernelPatch.\n\nΕλέγξτε και δοκιμάστε ξανά. Εάν εξακολουθούν να υπάρχουν προβλήματα, μπορείτε πάντα να κάνετε ερωτήσεις στη σελίδα ζητημάτων του επίσημου αποθετηρίου.</string>
    <string name="crash_handle_copied">Το αρχείο καταγραφής σφαλμάτων αντιγράφηκε στο πρόχειρο.</string>
    <string name="settings_global_namespace_mode">Λειτουργία καθολικού χώρου ονομάτων</string>
    <string name="settings_global_namespace_mode_summary">Όλες οι συνεδρίες root χρησιμοποιούν τον χώρο ονομάτων καθολικής προσάρτησης</string>
    <string name="home_install_unknown_summary">Κλικ για εγκατάσταση</string>
    <string name="kpatch_version_update">Έκδοση: %s -&gt; %s</string>
    <string name="patch_select_bootimg_btn">Επιλογή boot</string>
    <string name="patch_start_patch_btn">Έναρξη</string>
    <string name="patch_mode_uninstall_patch">Λειτουργία: Απεγκατάσταση KPatch</string>
    <string name="patch_embed_kpm_btn">Ενσωμάτωση KPM</string>
    <string name="patch_item_kernel">Πυρήνας</string>
    <string name="patch_item_kpimg_version">Έκδοση:</string>
    <string name="patch_item_new_extra_kpm">Ενσωμάτωση νέου</string>
    <string name="patch_item_existed_extra_kpm">Υπήρχε</string>
    <string name="patch_item_extra_name">Όνομα:</string>
    <string name="patch_item_extra_kpm_license">Άδεια:</string>
    <string name="patch_item_extra_kpm_desciption">Περιγραφή:</string>
    <string name="home_device_info">Συσκευή</string>
    <string name="home_system_version">Έκδοση συστήματος</string>
    <string name="kpm_add_kpm">Προσθήκη KPM</string>
    <string name="hide_apatch_manager">Απόκρυψη Διαχειριστή APatch</string>
    <string name="hide_apatch_dialog_new_manager_name">Νέο όνομα διαχειριστή</string>
    <string name="hide_apatch_dialog_summary">Θα χρησιμοποιηθεί ως η νέα ετικέτα εφαρμογής που εμφανίζεται στο πρόγραμμα εκκίνησης</string>
    <string name="hide_apatch_manager_failure">Αποτυχία απόκρυψης, Παρακαλώ αναφέρετε το σφάλμα!</string>
    <string name="settings_donot_store_superkey">Μη αποθήκευση ΥπέρΚλειδιού τοπικά</string>
    <string name="enable_web_debugging">Ενεργοποίηση εντοπισμού σφαλμάτων WebView</string>
    <string name="mode_select_page_patch_and_install">Επιδιόρθωση και Εγκατάσταση</string>
    <string name="mode_select_page_select_file">Επιλογή εικόνας boot για επιδιόρθωση</string>
    <string name="home_new_apatch_found">Νέα έκδοση %s είναι διαθέσιμη, κλικ για αναβάθμιση.</string>
    <string name="mode_select_page_title">Εγκατάσταση</string>
    <string name="home_dialog_auth_fail_title">Ο έλεγχος ταυτότητας απέτυχε</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="patch_item_kpimg_comile_time">Ώρα:</string>
    <string name="patch_item_error">!!ΣΦΑΛΜΑ!!</string>
    <string name="patch_item_kpimg_config">Διαμόρφωση:</string>
    <string name="patch_item_extra_version">Έκδοση:</string>
    <string name="kpm_install">Εγκατάσταση</string>
    <string name="kpm_embed">Ενσωμάτωση</string>
    <string name="apm_webui_open">Άνοιγμα</string>
    <string name="about_app_desc">Λύση Kernel root με μόνο μια απογυμνωμένη εικόνα πυρήνα, παρέχοντας τη δυνατότητα προσάρτησης της μονάδας συστήματος και την λειτουργία αγκίστρωσης πυρήνα.</string>
    <string name="home_kpatch_info_title">Πληροφορίες</string>
    <string name="patch_mode_bootimg_patch">Λειτουργία: Επιδιόρθωση</string>
    <string name="patch_mode_patch_and_install">Λειτουργία: Επιδιόρθωση και εγκατάσταση</string>
    <string name="patch_item_bootimg_dev">συσκευή:</string>
    <string name="patch_item_extra_event">Συμβάν:</string>
    <string name="patch_item_skey">ΥπέρΚλειδί</string>
    <string name="patch_item_set_skey_label">Το ΥπέρΚλειδί πρέπει να έχει μήκος 8-63 χαρακτήρες και να περιλαμβάνει αριθμούς και γράμματα, αλλά όχι ειδικούς χαρακτήρες.</string>
    <string name="patch_mode_install_to_next_slot">Λειτουργία: Εγκατάσταση σε ανενεργή υποδοχή (Μετά από OTA)</string>
    <string name="patch_item_bootimg_slot">υποδοχή:</string>
    <string name="home_ap_cando_reboot">Επανεκκίνηση</string>
    <string name="kpm_control">Έλεγχος</string>
    <string name="settings_donot_store_superkey_summary">Έλεγχος ταυτότητας του ΥπέρΚλειδιού κάθε φορά που ξεκινά ο διαχειριστής</string>
    <string name="setting_reset_su_new_path">Νέα πλήρης διαδρομή</string>
    <string name="home_dialog_uninstall_ap_only">Αφαίρεση AndroidPatch</string>
    <string name="home_dialog_uninstall_all">Απεγκατάσταση όλων</string>
    <string name="kpm_control_dialog_title">Έλεγχος KPModule</string>
    <string name="kpm_control_dialog_content">Παράμετροι ελέγχου εισόδου:</string>
    <string name="kpm_control_paramters">Παράμετροι</string>
    <string name="kpm_control_outMsg">Μήνυμα</string>
    <string name="kpm_control_ok">Η λειτουργία πέτυχε!</string>
    <string name="kpm_control_failed">Η λειτουργία απέτυχε!</string>
    <string name="settings_night_mode_follow_sys">Ακολουθώντας το σκούρο θέμα συστήματος</string>
    <string name="settings_use_system_color_theme">Χρωματικό θέμα συστήματος</string>
    <string name="settings_use_system_color_theme_summary">Χρήση χρωματικού θέματος που δημιουργείται από το σύστημα με βάση την τρέχουσα ταπετσαρία</string>
    <string name="light_green_theme">Ανοιχτό Πράσινο</string>
    <string name="red_theme">Κόκκινο</string>
    <string name="sakura_theme">Σάκουρα</string>
    <string name="teal_theme">Γαλαζοπράσινο</string>
    <string name="yellow_theme">Κίτρινο</string>
    <string name="about_app_version">Έκδοση %1$s</string>
    <string name="home_more_menu_feedback_or_suggestion">Ανατροφοδότηση ή πρόταση</string>
    <string name="about_telegram_channel">Κανάλι Telegram</string>
    <string name="home_more_menu_about">Σχετικά με</string>
    <string name="home_dialog_uninstall_title">Απεγκατάσταση</string>
    <string name="settings_night_mode_follow_sys_summary">Αυτόματη εναλλαγή σε σκούρο θέμα με βάση τις ρυθμίσεις συστήματος</string>
    <string name="settings_night_theme_enabled">Ενεργοποίηση σκούρου θέματος</string>
    <string name="brown_theme">Καφέ</string>
    <string name="cyan_theme">Κυανό</string>
    <string name="deep_orange_theme">Βαθύ πορτοκαλί</string>
    <string name="lime_theme">Lime</string>
    <string name="orange_theme">Πορτοκαλί</string>
    <string name="apm_action">Ενέργεια</string>
    <string name="mode_select_page_install_inactive_slot">Εγκατάσταση σε ανενεργή υποδοχή (Μετά από OTA)</string>
    <string name="mode_select_page_install_inactive_slot_warning">Η συσκευή σας θα **ΑΝΑΓΚΑΣΤΕΙ** να εκκινηθεί στην τρέχουσα ανενεργή υποδοχή μετά από μια επανεκκίνηση!\nΧρήση της επιλογής μόνο αφού ολοκληρωθεί το OTA.\nΣυνέχεια;</string>
    <string name="about_telegram_group">Ομάδα Telegram</string>
    <string name="about_powered_by">Τροφοδοτείται από %1$s</string>
    <string name="patch_start_unpatch_btn">UnPatch</string>
    <string name="patch_config_title">Patches</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_bootimg">bootimg</string>
    <string name="patch_item_extra_author">Δημιουργός</string>
    <string name="patch_item_extra_args">Επιχειρήματα:</string>
    <string name="settings_lite_mode">Ενεργοποίηση λειτουργίας Lite</string>
    <string name="settings_lite_mode_mode_summary">Οι λειτουργίες του APModule ενδέχεται να παρουσιάσουν σφάλματα μετά την ενεργοποίηση τους, αλλά σε ορισμένες περιπτώσεις μπορούν να αποφύγουν αποτελεσματικά τον εντοπισμό. Απαιτείται επανεκκίνηση.</string>
    <string name="settings_force_overlayfs_mode">Επιβολή χρήσης OverlayFS</string>
    <string name="settings_force_overlayfs_mode_summary">Χρήση του OverlayFS για προσάρτηση του APModules αντί για το Magic Mount όταν είναι διαθέσιμη η υποστήριξη από τον πυρήνα. Απαιτείται επανεκκίνηση.</string>
</resources>

```

`app/src/main/res/values-es/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="apm">APModule</string>
    <string name="super_key">Superclave</string>
    <string name="app_name" translatable="false">APatch</string>
    <string name="patch_warnning">La instalación conlleva riesgos. Así que asegúrate de tener una copia de seguridad de tus datos.</string>
    <string name="home">Inicio</string>
    <string name="reboot_download">Reiniciar al modo «download»</string>
    <string name="home_click_to_learn_apatch">Aprende sobre las características de APatch y de cómo sacarles partido</string>
    <string name="reboot_edl">Reiniciar al modo EDL</string>
    <string name="reboot_recovery">Reiniciar al modo recuperación</string>
    <string name="home_learn_apatch">Más información sobre APatch</string>
    <string name="about">Acerca de</string>
    <string name="reboot">Reiniciar</string>
    <string name="settings">Ajustes</string>
    <string name="reboot_bootloader">Reiniciar al gestor de arranque</string>
    <string name="about_source_code"><![CDATA[<p>Ver código fuente en %1$s<p/>Unirse a nuestro canal de %2$s<p/>Unirse a nuestro grupo de %3$s]]></string>
    <string name="send_log">Enviar registro de fallos</string>
    <string name="kpatch_version">Versión: %s</string>
    <string name="home_patch_set_key_desc">Clave única para KernelPatch</string>
    <string name="home_install_unknown">Sin instalar o autenticar</string>
    <string name="home_installing">Instalando</string>
    <string name="apatch_version">Versión: %s</string>
    <string name="safe_mode">Modo seguro</string>
    <string name="home_click_to_install">Haz clic para instalar</string>
    <string name="home_need_update">Hay una nueva versión disponible</string>
    <string name="patch_set_superkey">Definir superclave</string>
    <string name="home_su_path">Ejecutable «su»</string>
    <string name="apatch_version_update">Versión: %s → %s</string>
    <string name="home_working">Funcionando 😋</string>
    <string name="home_patch_next_step">Siguiente paso</string>
    <string name="home_not_installed">Sin instalar</string>
    <string name="home_auth_key_desc">Comenzar tras la certificación</string>
    <string name="home_ap_cando_install">Instalar</string>
    <string name="home_auth_key_title">Escribir superclave</string>
    <string name="home_ap_cando_update">Actualizar</string>
    <string name="kpm_kp_not_installed">KernelPatch no está instalado</string>
    <string name="home_fingerprint">Huella del dispositivo</string>
    <string name="home_selinux_status_unknown">Desconocido</string>
    <string name="home_selinux_status_permissive">Permisivo</string>
    <string name="home_selinux_status">Estado de SELinux</string>
    <string name="home_selinux_status_disabled">Desactivado</string>
    <string name="kpm_load">Cargar</string>
    <string name="home_kernel">Versión del kernel</string>
    <string name="home_selinux_status_enforcing">Obligatorio</string>
    <string name="home_manager_version">Versión de la aplicación</string>
    <string name="patch_title">Parchear</string>
    <string name="kpm_load_toast_succ">Cargado correctamente</string>
    <string name="kpm_unload_confirm">¿Desactivar el módulo «%s»?</string>
    <string name="su_pkg_excluded_setting_title">Excluir y evitar modificaciones</string>
    <string name="su_pkg_excluded_setting_summary">Los archivos cambiados por los módulos serán invisibles para la aplicación al activar esta opción.</string>
    <string name="su_pkg_excluded_label">excluido</string>
    <string name="su_title">Superusuario</string>
    <string name="kpm_desc">Desc</string>
    <string name="su_selinux_via_hook">eludir mediante «hook»</string>
    <string name="kpm_args">Parám</string>
    <string name="kpm_version">Versión</string>
    <string name="su_show_system_apps">Mostrar aplicaciones del sistema</string>
    <string name="kpm_author">Autor</string>
    <string name="kpm_load_toast_failed">La carga ha fallado</string>
    <string name="kpm_unload">Desactivar</string>
    <string name="kpm_license">Licencia</string>
    <string name="kpm_apm_empty">No hay ningún módulo cargado</string>
    <string name="apm_reboot_to_apply">Es necesario reiniciar para que los cambios surtan efecto</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="apm_uninstall_success">Se ha desinstalado %s</string>
    <string name="apm_install">Instalar</string>
    <string name="apm_remove">Quitar</string>
    <string name="apm_uninstall_confirm">¿Desinstalar el módulo «%s»?</string>
    <string name="apm_version">Versión</string>
    <string name="apm_start_downloading">Descargar %s</string>
    <string name="home_ap_cando_uninstall">Desinstalar</string>
    <string name="apm_overlay_fs_not_available">¡Los módulos no están disponibles ya que OverlayFS está desactivado por el kernel!</string>
    <string name="su_refresh">Actualizar</string>
    <string name="apm_failed_to_disable">No se pudo desactivar el módulo «%s»</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="home_apatch_version">Versión de APatch</string>
    <string name="apm_changelog">Notas de cambios</string>
    <string name="apm_uninstall_failed">No se pudo desinstalar %s</string>
    <string name="apm_failed_to_enable">No se pudo activar el módulo «%s»</string>
    <string name="apm_downloading">Descargando el módulo «%s»…</string>
    <string name="su_hide_system_apps">Ocultar aplicaciones del sistema</string>
    <string name="apm_magisk_conflict">¡Los módulos no están disponibles debido a un conflicto con Magisk!</string>
    <string name="apm_desc">Descripción</string>
    <string name="apm_new_version_available">Hay una nueva versión (%s) disponible. Toca para actualizar.</string>
    <string name="apm_empty">No hay ningún módulo instalado</string>
    <string name="apm_update">Actualizar</string>
    <string name="kpm">KPModule</string>
    <string name="apm_author">Autor</string>
    <string name="clear_super_key">Borrar superclave</string>
    <string name="apm_not_installed">AndroidPatch no está instalado</string>
    <string name="settings_app_language">Idioma</string>
    <string name="system_default">Predeterminado del sistema</string>
    <string name="patch">Parchear</string>
    <string name="settings_global_namespace_mode">Modo de espacio de nombres global</string>
    <string name="settings_global_namespace_mode_summary">Todas las sesiones «root» utilizan el espacio de nombres de montaje global</string>
    <string name="settings_clear_super_key_dialog">¿Seguro que quieres continuar?</string>
    <string name="kpatch_version_update">Versión: %s → %s</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="home_kpatch_info_title">Info</string>
    <string name="home_ap_cando_reboot">Reiniciar</string>
    <string name="patch_config_title">Parches</string>
    <string name="patch_mode_bootimg_patch">Modo: Parchear</string>
    <string name="patch_mode_patch_and_install">Modo: Parchear e instalar</string>
    <string name="patch_mode_uninstall_patch">Modo: Desinstalar KPatch</string>
    <string name="patch_select_bootimg_btn">Elige un archivo «boot»</string>
    <string name="patch_embed_kpm_btn">Insertar KPM</string>
    <string name="patch_start_patch_btn">Iniciar</string>
    <string name="patch_start_unpatch_btn">Quitar parches</string>
    <string name="patch_item_bootimg">boot.img</string>
    <string name="patch_item_bootimg_dev">dispositivo:</string>
    <string name="patch_item_kernel">Kernel</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_kpimg_version">Versión:</string>
    <string name="patch_item_kpimg_comile_time">Hora:</string>
    <string name="patch_item_kpimg_config">Config:</string>
    <string name="patch_item_new_extra_kpm">Insertar nuevo</string>
    <string name="patch_item_existed_extra_kpm">Ya incluido:</string>
    <string name="patch_item_extra_version">Versión:</string>
    <string name="patch_item_extra_author">Autor:</string>
    <string name="patch_item_extra_kpm_license">Licencia:</string>
    <string name="patch_item_extra_kpm_desciption">Descripción:</string>
    <string name="patch_item_extra_args">Parám:</string>
    <string name="patch_item_extra_event">Evento:</string>
    <string name="patch_item_skey">Superclave</string>
    <string name="patch_item_set_skey_label">La superclave debe tener entre 8 y 63 caracteres e incluir números y letras, pero no caracteres especiales.</string>
    <string name="patch_item_extra_name">Nombre:</string>
    <string name="patch_item_error">¡ERROR!</string>
    <string name="patch_item_bootimg_slot">slot:</string>
    <string name="hide_apatch_manager">Ocultar APatch Manager</string>
    <string name="kpm_embed">Insertar</string>
    <string name="success">Hecho</string>
    <string name="kpm_install">Instalar</string>
    <string name="hide_apatch_dialog_new_manager_name">Nombre nuevo de APatch Manager</string>
    <string name="hide_apatch_manager_summary">Instala una nueva aplicación de APatch Manager con un ID aleatorio y una etiqueta personalizada</string>
    <string name="hide_apatch_dialog_summary">Será la nueva etiqueta que aparezca en el lanzador de aplicaciones</string>
    <string name="hide_apatch_manager_failure">No se pudo ocultar, informa a los desarrolladores del error.</string>
    <string name="setting_reset_su_path">Restablecer la ruta a «su»</string>
    <string name="setting_reset_su_new_path">Nueva ruta completa</string>
    <string name="failure">Fallido</string>
    <string name="kpm_add_kpm">Añadir KPM</string>
    <string name="settings_check_update_summary">Buscar actualizaciones automáticamente al abrir la aplicación</string>
    <string name="settings_check_update">Buscar actualizaciones</string>
    <string name="home_more_menu_feedback_or_suggestion">Comentarios o sugerencias</string>
    <string name="home_more_menu_about">Acerca de</string>
    <string name="mode_select_page_install_inactive_slot">Instalar en la partición («slot») inactiva (tras una actualización OTA)</string>
    <string name="mode_select_page_select_file">Elige una imagen de arranque «boot» que parchear</string>
    <string name="home_dialog_auth_fail_title">La autenticación ha fallado</string>
    <string name="mode_select_page_title">Instalar</string>
    <string name="mode_select_page_patch_and_install">Parchear e instalar</string>
    <string name="mode_select_page_install_inactive_slot_warning">Tu dispositivo se verá **OBLIGADO** a arrancar desde la partición («slot») que ahora está inactiva. \nUtiliza esta opción solo cuando una actualización del sistema (OTA) haya terminado de instalarse, justo antes de tener que reiniciar. \n¿Quieres continuar?</string>
    <string name="enable_web_debugging">Habilitar depuración de WebView</string>
    <string name="home_install_unknown_summary">Haz clic para instalar</string>
    <string name="home_device_info">Dispositivo</string>
    <string name="home_system_version">Versión del sistema</string>
    <string name="home_kpatch_version">Versión de KernelPatch</string>
    <string name="home_dialog_uninstall_title">Desinstalar</string>
    <string name="home_dialog_uninstall_ap_only">Quitar AndroidPatch</string>
    <string name="home_dialog_uninstall_all">Desinstalarlo todo</string>
    <string name="home_dialog_auth_fail_content">Parece que la superclave no da resultado, por lo que APatch no funcionará correctamente. \nA continuación se muestran algunas posibles causas de este error de autenticación: \n1. No has parcheado el «boot.img» original con KernelPatch. \n2. No has flasheado (vía «fastboot flash») dicho «boot.img» ya parcheado. \n3. La superclave que has elegido no es correcta o contiene caracteres especiales.\n4. Tu dispositivo no es compatible con APatch o KernelPatch. \n \nRepásalo todo e inténtalo de nuevo. Si sigue habiendo problemas siempre puedes hacer preguntas en inglés en la pestaña «issues» del repositorio oficial.</string>
    <string name="apm_webui_open">Abrir</string>
    <string name="enable_web_debugging_summary">Se puede utilizar para depurar WebUI, actívalo solo si se necesita de verdad.</string>
    <string name="settings_donot_store_superkey">No guardar la superclave de forma local</string>
    <string name="patch_mode_install_to_next_slot">Modo: Instalar en el «slot» inactivo (tras OTA)</string>
    <string name="settings_donot_store_superkey_summary">Pedir que se escriba la superclave al abrir APatch Manager</string>
    <string name="home_new_apatch_found">Nueva versión disponible: %s, toca para actualizar.</string>
    <string name="settings_use_system_color_theme">Utilizar colores del sistema</string>
    <string name="kpm_control_dialog_title">Control de KPModule</string>
    <string name="settings_use_system_color_theme_summary">Utiliza un esquema de colores generado por el sistema basado en el fondo de pantalla actual</string>
    <string name="settings_custom_color_theme">Esquema de colores</string>
    <string name="deep_orange_theme">Naranja oscuro</string>
    <string name="deep_purple_theme">Morado oscuro</string>
    <string name="green_theme">Verde</string>
    <string name="indigo_theme">Índigo</string>
    <string name="light_blue_theme">Azul claro</string>
    <string name="light_green_theme">Verde claro</string>
    <string name="lime_theme">Lima</string>
    <string name="orange_theme">Naranja</string>
    <string name="pink_theme">Rosa</string>
    <string name="purple_theme">Púrpura</string>
    <string name="red_theme">Rojo</string>
    <string name="sakura_theme">Flor de cerezo</string>
    <string name="teal_theme">Verde azulado</string>
    <string name="yellow_theme">Amarillo</string>
    <string name="about_app_version">Versión %1$s</string>
    <string name="about_powered_by">Funciona con %1$s</string>
    <string name="kpm_control_ok">¡Operación realizada!</string>
    <string name="settings_night_mode_follow_sys">Seguir el tema oscuro del sistema</string>
    <string name="settings_night_mode_follow_sys_summary">Cambia automáticamente al tema oscuro en función de los ajustes del sistema</string>
    <string name="settings_night_theme_enabled">Utilizar tema oscuro</string>
    <string name="kpm_control_dialog_content">Escribe los parámetros de control:</string>
    <string name="kpm_control_failed">¡La operación ha fallado!</string>
    <string name="amber_theme">Ámbar</string>
    <string name="blue_grey_theme">Gris azulado</string>
    <string name="kpm_control_outMsg">Mensaje</string>
    <string name="blue_theme">Azul</string>
    <string name="brown_theme">Marrón</string>
    <string name="cyan_theme">Cian</string>
    <string name="about_app_desc">Solución «root» dentro del propio «kernel» (o núcleo de Linux) que funciona sin la necesidad de tener el código fuente original del kernel de tu dispositivo, o de tener que recompilarlo. Permite montar módulos del sistema y sustituir funciones del kernel.</string>
    <string name="about_telegram_channel">Canal de Telegram</string>
    <string name="about_telegram_group">Grupo de Telegram</string>
    <string name="kpm_control">Control</string>
    <string name="kpm_control_paramters">Parámetros</string>
    <string name="save_log">Guardar registro de fallos</string>
    <string name="apm_action">Acción</string>
    <string name="log_saved">Registros guardados</string>
    <string name="crash_handle_copy">Copiar registro de fallos</string>
    <string name="crash_handle_title">La aplicación ha fallado…</string>
    <string name="crash_handle_copied">Se copió el registro de fallos al portapapeles.</string>
    <string name="settings_lite_mode">Activar el modo ligero</string>
    <string name="settings_lite_mode_mode_summary">Puede que no todas las funciones de los APModules funcionen en este modo, pero se evitan posibles detecciones. Es necesario reiniciar para que surta efecto.</string>
    <string name="settings_force_overlayfs_mode">Forzar el uso de OverlayFS</string>
    <string name="settings_force_overlayfs_mode_summary">Si el kernel lo admite, se utilizará OverlayFS para montar las carpetas de los APModules en vez de Magic Mount. Es necesario reiniciar para que surta efecto.</string>
</resources>

```

`app/src/main/res/values-fa/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="home">خانه</string>
    <string name="success">موفق</string>
    <string name="failure">ناموفق</string>
    <string name="reboot_recovery">راه اندازی به ریکاوری</string>
    <string name="reboot_download">راه اندازی به دانلود مود</string>
    <string name="reboot_edl">راه اندازی به EDL</string>
    <string name="about">درباره</string>
    <string name="system_default">تنظیمات پیشفرض سیستم</string>
    <string name="settings_global_namespace_mode">حالت نام جهانی</string>
    <string name="settings_clear_super_key_dialog">آیا واقعا میخواهید ادامه دهید؟</string>
    <string name="settings_check_update">برسی نسخه به روز</string>
    <string name="home_click_to_learn_apatch">با ویژگی های APatch و نحو استفاده آن آشنا شوید</string>
    <string name="home_learn_apatch">با APatch آشنا شو</string>
    <string name="send_log">ارسال گزارشات</string>
    <string name="save_log">ذخیره گزارشات</string>
    <string name="safe_mode">حالت امن</string>
    <string name="super_key">ابر کلید</string>
    <string name="patch_warnning">نصب با خطر همراه است! لطفاً مطمئن شوید که از اطلاعات شما نسخه پشتیبان تهیه شده است.</string>
    <string name="settings_app_language">زبان</string>
    <string name="reboot">راه اندازی مجدد</string>
    <string name="settings">تنظیمات</string>
    <string name="patch">پچ</string>
    <string name="kernel_patch">پچ کردن کرنل</string>
    <string name="reboot_bootloader">راه اندازی به بوتلودر</string>
    <string name="android_patch">پچ کردن اندروید</string>
    <string name="settings_check_update_summary">هنگام باز کردن برنامه، به طور خودکار نسخه به روز را برسی کن</string>
    <string name="home_not_installed">نصب نشده</string>
    <string name="home_need_update">نسخه جدید موجود است</string>
    <string name="log_saved">گزارشات ذخیره شد</string>
    <string name="home_ap_cando_reboot">راه اندازی مجدد</string>
    <string name="patch_item_kernel">هسته</string>
    <string name="home_kernel">هسته</string>
    <string name="home_kpatch_info_title">درباره</string>
    <string name="home_ap_cando_install">نصب</string>
    <string name="home_ap_cando_uninstall">لغو نصب</string>
    <string name="patch_title">پچ</string>
    <string name="patch_start_patch_btn">آغاز</string>
    <string name="patch_item_kpimg_version">نسخه:</string>
    <string name="patch_item_kpimg_comile_time">مدت‌زمان:</string>
    <string name="patch_item_extra_kpm_desciption">شرح:</string>
    <string name="home_fingerprint">اثر انگشت</string>
    <string name="home_selinux_status_disabled">غیرفعال</string>
    <string name="home_selinux_status_enforcing">اجرا کردن</string>
    <string name="home_selinux_status_permissive">مجاز</string>
    <string name="home_selinux_status_unknown">ناشناخته</string>
    <string name="home_device_info">دستگاه</string>
    <string name="home_system_version">نسخه سیستم</string>
    <string name="patch_item_extra_name">نام:</string>
    <string name="patch_item_extra_version">نسخه:</string>
    <string name="patch_item_extra_author">نویسنده:</string>
    <string name="home_auth_key_title">واردکردن ابر کلید</string>
    <string name="apatch_version_update">نسخه: %s -&gt; %s</string>
    <string name="home_install_unknown_summary">برای نصب کلیک کنید</string>
    <string name="home_click_to_install">برای نصب کلیک کنید</string>
    <string name="home_working">در‌حال‌کار 😋</string>
    <string name="home_installing">نصب کردن</string>
    <string name="kpatch_version">نسخه: %s</string>
    <string name="apatch_version">نسخه: %s</string>
    <string name="kpatch_version_update">نسخه: %s -&gt; %s</string>
    <string name="kpatch_shadow_path_title">پچk</string>
    <string name="home_ap_cando_update">به روز رسانی</string>
    <string name="patch_config_title">پچ ها</string>
    <string name="patch_mode_bootimg_patch">حالت: پچ</string>
    <string name="patch_start_unpatch_btn">لغو پچ</string>
    <string name="patch_item_bootimg">ایمیج بوت</string>
    <string name="patch_item_kpimg">ایمیج هسته</string>
    <string name="patch_item_kpimg_config">پیکربندی:</string>
    <string name="patch_item_new_extra_kpm">جاسازی جدید</string>
    <string name="patch_item_extra_args">دستورات:</string>
    <string name="patch_item_skey">ابر کلید</string>
    <string name="settings_global_namespace_mode_summary">همه جلسات ریشه از فضای نام نصب جهانی استفاده می کنند</string>
    <string name="about_source_code"><![CDATA[<p>مشاهده کد منبع در %1$s<p/>به کانال %2$s ما بپیوندید<p/>به گروه %3$s ما بپیوندید]]></string>
    <string name="clear_super_key">حذف ابر کلید</string>
    <string name="patch_set_superkey">تنظیم ابر کلید</string>
    <string name="patch_embed_kpm_btn">قراردادن KPM</string>
    <string name="patch_mode_install_to_next_slot">حالت: نصب در اسلات بعدی (بعد از OTA)</string>
    <string name="patch_mode_uninstall_patch">حالت: حذف نصب KPatch</string>
    <string name="patch_select_bootimg_btn">انتخاب بوت</string>
    <string name="patch_item_extra_kpm_license">مجوز:</string>
    <string name="home_manager_version">مدیر نسخه</string>
    <string name="home_install_unknown">نصب نشده یا معتبر</string>
    <string name="home_patch_set_key_desc">فقط اعتبار برای KernelPatch</string>
    <string name="home_auth_key_desc">شروع بعد از صدور گواهینامه</string>
    <string name="home_patch_next_step">گام بعد</string>
    <string name="patch_item_error">!!! اوه!!!</string>
    <string name="patch_item_bootimg_slot">اسلات:</string>
    <string name="patch_item_bootimg_dev">دستگاه:</string>
    <string name="patch_item_existed_extra_kpm">موجود</string>
    <string name="patch_item_extra_event">رویداد:</string>
    <string name="patch_item_set_skey_label">طول ابر کلید باید 8تا36 کاراکتر باشد و شامل عدد و حروف بدون کاراکتر های خاص باشد.</string>
    <string name="home_selinux_status">وضعیت SELinux</string>
    <string name="patch_mode_patch_and_install">حالت: پچ و نصب</string>
    <string name="kpm_args">دستورات</string>
    <string name="su_title">ابر کاربر</string>
    <string name="home_su_path">ابر کلید اجرایی</string>
    <string name="home_kpatch_version">نسخه پچ هسته</string>
    <string name="kpm_load">بارگذاری</string>
    <string name="kpm">ماژول KP</string>
    <string name="kpm_kp_not_installed">وصله هسته نصب نشده است</string>
    <string name="kpm_embed">جاسازی</string>
    <string name="kpm_load_toast_succ">با موفقیت بارگذاری شد</string>
    <string name="kpm_load_toast_failed">بارگذاری نا موفق بود</string>
    <string name="kpm_unload_confirm">بارگذاری ماژول \"%s\" لغو‌شود؟</string>
    <string name="kpm_unload">لغو‌بارگذاری</string>
    <string name="kpm_control">کنترل</string>
    <string name="kpm_desc">شرح</string>
    <string name="su_selinux_via_hook">دور زدن از طریق قلاب</string>
    <string name="su_pkg_excluded_setting_title">تغییرات صرف نظر شده</string>
    <string name="su_pkg_excluded_setting_summary">فعال کردن این گزینه به APatch اجازه خواهد داد تا فایل‌های تغییر یافته توسط ماژول‌های این برنامه را بازیابی کند.</string>
    <string name="su_hide_system_apps">مخفی کردن برنامه‌های سیستمی</string>
    <string name="home_apatch_version">نسخه APatch</string>
    <string name="kpm_add_kpm">اضافه کردن KPM</string>
    <string name="kpm_apm_empty">هیچ ماژول بارگیری نشده</string>
    <string name="kpm_install">نصب</string>
    <string name="kpm_version">نسخه</string>
    <string name="kpm_license">پروانه</string>
    <string name="kpm_author">مالک</string>
    <string name="su_pkg_excluded_label">مستثنی</string>
    <string name="su_show_system_apps">نمایش برنامه‌های سیستمی</string>
    <string name="su_refresh">تازه سازی</string>
    <string name="apm">ماژول AP</string>
    <string name="apm_not_installed">AndroidPatch نصب نشده</string>
    <string name="apm_failed_to_enable">فعالسازی ماژول \"%s\" ناموفق بود</string>
    <string name="enable_web_debugging">فعالسازی اشکال زدایی نمای وب</string>
    <string name="enable_web_debugging_summary">می تواند برای اشکال زدایی رابط کاربری وب استفاده شود. لطفا فقط وقتی لازم است فعال کنید.</string>
    <string name="settings_donot_store_superkey_summary">اعتبار سنجی ابر کلید با هر بار شروع مدیر</string>
    <string name="mode_select_page_patch_and_install">وصله و نصب</string>
    <string name="cyan_theme">فیروزه ای</string>
    <string name="deep_orange_theme">نارنجی تیره</string>
    <string name="deep_purple_theme">بنفش تیره</string>
    <string name="green_theme">سبز</string>
    <string name="indigo_theme">نیلی سیر</string>
    <string name="light_blue_theme">آبی روشن</string>
    <string name="purple_theme">بنفش</string>
    <string name="red_theme">قرمز</string>
    <string name="sakura_theme">شکوفه گیلاس</string>
    <string name="teal_theme">سبز دودی</string>
    <string name="yellow_theme">زرد</string>
    <string name="about_telegram_group">گروه تلگرام</string>
    <string name="crash_handle_title">برنامه کرش کرد…</string>
    <string name="crash_handle_copied">گزارش کرش به کلیپ بورد کپی شد.</string>
    <string name="apm_author">نویسنده</string>
    <string name="apm_desc">توضیحات</string>
    <string name="mode_select_page_install_inactive_slot">نصب در یک اسلات غیرفعال (بعد از OTA)</string>
    <string name="home_dialog_auth_fail_title">اعتبار سنجی نا موفق بود</string>
    <string name="home_dialog_uninstall_title">حذف نصب</string>
    <string name="home_dialog_uninstall_ap_only">حذف AndroidPatch</string>
    <string name="home_dialog_uninstall_all">حذف نصب همه</string>
    <string name="kpm_control_dialog_content">پارامتر های کنترل ورودی:</string>
    <string name="settings_night_mode_follow_sys">پیروی از تم تاریک سیستم</string>
    <string name="about_telegram_channel">کانال تلگرام</string>
    <string name="crash_handle_copy">کپی کردن گزارش کرش</string>
    <string name="apm_failed_to_disable">غیرفعالسازی ماژول \"%s\" ناموفق بود</string>
    <string name="apm_empty">ماژولی نصب نشده است</string>
    <string name="apm_install">نصب</string>
    <string name="apm_uninstall_confirm">ماژول \"%s\" حذف نصب شود؟</string>
    <string name="apm_uninstall_success">\"%s\" حذف نصب شد</string>
    <string name="apm_remove">حذف</string>
    <string name="apm_uninstall_failed">حذف نصب \"%s\" ناموفق بود</string>
    <string name="apm_magisk_conflict">ماژول ها به علت درگیری با Msgisk در دسترس نیستند!</string>
    <string name="apm_changelog">گزارش تغییرات</string>
    <string name="apm_update">بروزرسانی</string>
    <string name="apm_downloading">بارگیری ماژول \"%s\" …</string>
    <string name="apm_new_version_available">نسخه جدید %s در دسترس است، برای بروزرسانی کلیک کنید.</string>
    <string name="hide_apatch_manager">مخفی کردن مدیر APatch</string>
    <string name="apm_reboot_to_apply">برای اعمال مجددا راه اندازی کنید</string>
    <string name="hide_apatch_manager_summary">نصب یک برنامه مدیریت با یک شناسه تصادفی و برچسب سفارشی</string>
    <string name="hide_apatch_manager_failure">پنهان کردن ناموفق بود. لطفا ایراد را گزارش کنید!</string>
    <string name="hide_apatch_dialog_new_manager_name">نام مدیر جدید</string>
    <string name="hide_apatch_dialog_summary">به عنوان برچسب جدید برنامه برای نمایش در لانچر استفاده خواهد شد</string>
    <string name="setting_reset_su_path">تنظیم مجدد مسیر su</string>
    <string name="apm_webui_open">باز کردن</string>
    <string name="apm_action">اجرا</string>
    <string name="mode_select_page_select_file">یک نمونه بوت را برای وصله کردن انتخاب کنید</string>
    <string name="home_new_apatch_found">نسخه جدید %s در دسترس است، برای بروزرسانی کلیک کنید.</string>
    <string name="home_more_menu_about">درباره</string>
    <string name="kpm_control_paramters">پارامتر ها</string>
    <string name="kpm_control_ok">عملیات موفق بود!</string>
    <string name="kpm_control_failed">عملیات ناموفق بود!</string>
    <string name="settings_night_theme_enabled">فعالسازی تم تاریک</string>
    <string name="settings_custom_color_theme">تم رنگی</string>
    <string name="amber_theme">کهربایی</string>
    <string name="blue_grey_theme">آبی-خاکستری</string>
    <string name="brown_theme">قهوه ای</string>
    <string name="light_green_theme">سبز روشن</string>
    <string name="lime_theme">لیمویی</string>
    <string name="orange_theme">نارنجی</string>
    <string name="pink_theme">صورتی</string>
    <string name="about_app_version">نسخه %1$s</string>
    <string name="apm_overlay_fs_not_available">ماژول ها در دسترس نیستند زیرا OverlayFS توسط هسته غیرفعال شده است!</string>
    <string name="mode_select_page_title">نصب</string>
    <string name="home_more_menu_feedback_or_suggestion">بازخورد یا پیشنهاد</string>
    <string name="apm_start_downloading">شروع بارگیری %s</string>
    <string name="mode_select_page_install_inactive_slot_warning">دستگاه شما بعد از راه اندازی مجدد **مجبور خواهد شد** در اسلات غیرفعال فعلی راه اندازی شود!\nاز این گزینه فقط بعد از اتمام OTA استفاده کنید.\nادامه؟</string>
    <string name="apm_version">نسخه</string>
    <string name="blue_theme">آبی</string>
    <string name="settings_donot_store_superkey">ابر کلید را به صورت محلی ذخیره نکنید</string>
    <string name="setting_reset_su_new_path">مسیر کامل جدید</string>
    <string name="kpm_control_outMsg">پیام</string>
    <string name="settings_use_system_color_theme">تم رنگی سیستم</string>
    <string name="kpm_control_dialog_title">کنترل KPModule</string>
    <string name="home_dialog_auth_fail_content">اعتبار سنجی ابر کلید ناموفق بود، بنابراین APatch نمی تواند به درستی کار کند. \nدلایل احتمالی:\n1. شما boot.img را به KernelPatch وصله نکردید.\n2. وصله boot.img فلش نشده است.\n3. ابر کلید اشتباه است یا حاوی کاراکترهای خاص است.\n4. دستگاه شما از APatch و KernelPatch پشتیبانی نمی کند.\n\nلطفا بررسی کنید و دوباره امتحان کنید. اگر هنوز مشکلات وجود دارند، همیشه می توانید در صفحه مسائل مخزن رسمی سؤال بپرسید..</string>
    <string name="settings_night_mode_follow_sys_summary">جابجایی خودکار به تم تاریک بر اساس تنظیمات سیستم</string>
    <string name="settings_use_system_color_theme_summary">استفاده از تم رنگی تولید شده بر اساس تصویر زمینه فعلی سیستم</string>
    <string name="about_app_desc">راه حل روت کرنل فقط با یک ایمیج جدا از کرنل،قابلیت نصب ماژول سیستم و قلاب کردن توابع کرنل را ارئه می دهد.</string>
    <string name="about_powered_by">قدرت گرفته از %1$s</string>
</resources>

```

`app/src/main/res/values-fi/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="settings">Asetukset</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="reboot">"Käynnistä uudelleen "</string>
    <string name="reboot_recovery">Käynnistä uudelleen palautukseen</string>
    <string name="reboot_bootloader">Käynnistä uudelleen käynnistyslataimeen</string>
    <string name="reboot_download">Käynnistä uudelleen ladataksesi</string>
    <string name="reboot_edl">Käynnistä uudelleen EDL:ään</string>
    <string name="settings_global_namespace_mode">Yleisesti pätevä nimiavaruustila</string>
    <string name="about">Tietoja</string>
    <string name="home">Koti</string>
    <string name="patch_warnning">Asennukseen liittyy riskejä. Varmista, että tietosi on varmuuskopioitu.</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="failure">Epäonnistusminen</string>
    <string name="system_default">Järjestelmä oletus</string>
    <string name="settings_app_language">Kieli</string>
    <string name="patch_set_superkey">Aseta SuperKey</string>
    <string name="home_ap_cando_update">Päivitä</string>
    <string name="patch">Korjaus</string>
    <string name="patch_item_set_skey_label">SuperKeyn tulee olla 8–63 merkkiä pitkä ja sisältää numeroita ja kirjaimia, mutta ei erikoismerkkejä.</string>
    <string name="clear_super_key">Tyhjennä SuperKey</string>
    <string name="home_device_info">Laite</string>
    <string name="patch_mode_patch_and_install">Tila: Korjaa ja asenna</string>
    <string name="apm_update">Päivitä</string>
    <string name="patch_item_kernel">Kernel</string>
    <string name="home_su_path">Suoritettava su</string>
    <string name="patch_item_extra_kpm_desciption">Kuvaus:</string>
    <string name="kpm">KPModule</string>
    <string name="success">Menestys</string>
    <string name="settings_global_namespace_mode_summary">Kaikki juuriistunnot käyttävät yleisesti pätevää liitosnimiavaruutta</string>
    <string name="settings_clear_super_key_dialog">Haluatko todella edetä?</string>
    <string name="settings_check_update">Tarkista päivityksen varalta</string>
    <string name="settings_check_update_summary">Tarkista päivitysten varalta automaattisesti sovelluksen avaamisen yhteydessä</string>
    <string name="home_learn_apatch">Opettele APatch</string>
    <string name="home_click_to_learn_apatch">Tutustu APatchin ominaisuuksiin ja sen käyttöön</string>
    <string name="about_source_code"><![CDATA[<p>Tarkastele lähdekoodia %1$s<p/>Liity %2$s-kanavallemme<p/>Liity %3$s-ryhmäämme]]>:ssa</string>
    <string name="send_log">Lähetä lokit</string>
    <string name="save_log">Tallenna lokit</string>
    <string name="log_saved">Lokit tallennettu</string>
    <string name="safe_mode">Vikasietotila</string>
    <string name="super_key">SuperKey</string>
    <string name="home_patch_set_key_desc">Vain valtuustieto KernelPatchille</string>
    <string name="home_patch_next_step">Seuraava vaihe</string>
    <string name="home_not_installed">Ei asennettu</string>
    <string name="home_install_unknown">Ei asennettu tai todennettu</string>
    <string name="home_install_unknown_summary">Napauta asentaaksesi</string>
    <string name="home_click_to_install">Napauta asentaaksesi</string>
    <string name="home_working">Toimii 😋</string>
    <string name="home_installing">Asentaminen</string>
    <string name="home_need_update">Uusi versio saatavilla</string>
    <string name="kpatch_version">Versio: %s</string>
    <string name="apatch_version">Versio: %s</string>
    <string name="apatch_version_update">Versio: %s -&gt; %s</string>
    <string name="kpatch_version_update">Versio: %s -&gt; %s</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="home_auth_key_title">Syötä SuperKey</string>
    <string name="home_auth_key_desc">Käynnistä sertifioinnin jälkeen</string>
    <string name="home_kpatch_info_title">Tiedot</string>
    <string name="home_ap_cando_install">Asenna</string>
    <string name="home_ap_cando_uninstall">Poista asennus</string>
    <string name="home_ap_cando_reboot">Käynnistä uudelleen</string>
    <string name="patch_config_title">Korjaukset</string>
    <string name="patch_title">Korjaus</string>
    <string name="patch_mode_bootimg_patch">Tila: Korjaus</string>
    <string name="patch_mode_install_to_next_slot">Tila: Asenna ei-aktiiviseen kiinnittimeen (OTA:n jälkeen)</string>
    <string name="patch_mode_uninstall_patch">Tila: Poista KPatchin asennus</string>
    <string name="patch_select_bootimg_btn">Valitse käynnistys</string>
    <string name="patch_embed_kpm_btn">Upota KPM</string>
    <string name="patch_start_patch_btn">Käynnistä</string>
    <string name="patch_start_unpatch_btn">Kumoa korjaus</string>
    <string name="patch_item_error">!!VIRHE!!</string>
    <string name="patch_item_bootimg">käynnistys</string>
    <string name="patch_item_bootimg_slot">kiinnitin:</string>
    <string name="patch_item_bootimg_dev">laite:</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_kpimg_version">Versio:</string>
    <string name="patch_item_kpimg_comile_time">Aika:</string>
    <string name="patch_item_kpimg_config">Kokoonpano:</string>
    <string name="patch_item_new_extra_kpm">Upota uusi</string>
    <string name="patch_item_existed_extra_kpm">Olemassa</string>
    <string name="patch_item_extra_name">Nimi:</string>
    <string name="patch_item_extra_version">Versio:</string>
    <string name="patch_item_extra_author">Tekijä:</string>
    <string name="patch_item_extra_kpm_license">Lisenssi:</string>
    <string name="patch_item_extra_args">Args:</string>
    <string name="patch_item_extra_event">Tapahtuma:</string>
    <string name="patch_item_skey">SuperKey</string>
    <string name="home_kernel">Kernel</string>
    <string name="home_manager_version">Hallintaversio</string>
    <string name="home_fingerprint">Sormenjälki</string>
    <string name="home_selinux_status">SELinuxin tila</string>
    <string name="home_selinux_status_disabled">Poistettu käytöstä</string>
    <string name="home_selinux_status_enforcing">Täytäntöönpano</string>
    <string name="home_selinux_status_permissive">Salliva</string>
    <string name="home_selinux_status_unknown">Tuntematon</string>
    <string name="home_system_version">Järjestelmäversio</string>
    <string name="kpm_install">Asenna</string>
    <string name="kpm_embed">Upota</string>
    <string name="home_kpatch_version">KernelPatch-versio</string>
    <string name="home_apatch_version">APatch-versio</string>
    <string name="kpm_load_toast_succ">Lataus onnistuu</string>
    <string name="kpm_kp_not_installed">KernelPatch ei asennettu</string>
    <string name="kpm_add_kpm">Lisää KPM</string>
    <string name="kpm_load">Lataa</string>
    <string name="kpm_load_toast_failed">Lataus epäonnistui</string>
    <string name="kpm_unload_confirm">Kumotaanko \"%s\"-moduulin lataus?</string>
    <string name="kpm_unload">Kumoa lataus</string>
    <string name="kpm_control">Hallinta</string>
    <string name="kpm_apm_empty">Ei ladattu moduulia</string>
    <string name="kpm_version">Versio</string>
    <string name="kpm_license">Lisenssi</string>
    <string name="kpm_author">Tekijä</string>
    <string name="kpm_desc">Kuvaus</string>
    <string name="apm_desc">Kuvaus</string>
    <string name="apm_downloading">Ladataan \"%s\" -moduulia…</string>
    <string name="kpm_args">Args</string>
    <string name="hide_apatch_manager_summary">Asenna uusi hallintasovellus satunnaisen tunnuksen ja mukautetun nimikkeen kanssa</string>
    <string name="enable_web_debugging">Ota WebView-viankorjaus käyttöön</string>
    <string name="settings_donot_store_superkey_summary">Todenna SuperKey aina, kun hallinta käynnistyy</string>
    <string name="mode_select_page_install_inactive_slot_warning">Laitteesi **pakottaa** käynnistymään nykyiseen ei-aktiiviseen kiinnittimeen uudelleenkäynnistyksen jälkeen!\nKäytä tätä vaihtoehtoa vasta OTA:n jälkeen.\nJatketaanko?</string>
    <string name="kpm_control_outMsg">Viesti</string>
    <string name="home_dialog_auth_fail_content">SuperKeyä ei voi todentaa, joten APatch ei voi toimia kunnolla.\nTässä on joitain mahdollisia syitä todennuksen epäonnistumiseen:\n1. Et korjannut boot.img:ia KernelPatchilla.\n2. Korjattuun boot.img:iin flash-toimintaa ei ole sovellettu.\n3. SuperKey on väärä tai sisältää erikoismerkkejä.\n4. Laitteesi ei tue APatchia ja KernelPatchia.\n\nTarkista ja yritä uudelleen. Jos ongelmia ilmenee edelleen, voit aina esittää kysymyksiä virallisen tietovaraston ongelmasivulla.</string>
    <string name="about_app_desc">Kernel-juuriratkaisu, jossa on vain poistettu ytimen kuva, joka tarjoaa mahdollisuuden asentaa järjestelmämoduulia ja kiinnittää kernel-toiminnon.</string>
    <string name="kpm_control_ok">Toiminta onnistui!</string>
    <string name="settings_night_mode_follow_sys_summary">Vaihda automaattisesti tummaan teemaan järjestelmäasetusten mukaan</string>
    <string name="purple_theme">Violetti</string>
    <string name="su_title">Superkäyttäjä</string>
    <string name="su_selinux_via_hook">ohita koukun kautta</string>
    <string name="su_pkg_excluded_label">sulje pois</string>
    <string name="su_pkg_excluded_setting_title">Sulje pois muutokset</string>
    <string name="su_pkg_excluded_setting_summary">Tämän vaihtoehdon ottaminen käyttöön antaa APatchille mahdollisuuden palauttaa kaikki tämän sovelluksen moduulien muokkaamat tiedostot.</string>
    <string name="su_show_system_apps">Näytä järjestelmäsovellukset</string>
    <string name="su_hide_system_apps">Piilota järjestelmäsovellukset</string>
    <string name="su_refresh">Virkistä</string>
    <string name="apm">APModule</string>
    <string name="apm_not_installed">AndroidPatch ei asennettu</string>
    <string name="apm_failed_to_disable">Moduulia \"%s\" ei voitu kytkeä pois päältä</string>
    <string name="apm_failed_to_enable">Moduulia \"%s\" ei voitu kytkeä päälle</string>
    <string name="apm_empty">Ei moduulia asennettu</string>
    <string name="apm_remove">Poista</string>
    <string name="apm_install">Asenna</string>
    <string name="apm_uninstall_confirm">Poistetaanko \"%s\"-moduulin asennus?</string>
    <string name="apm_uninstall_success">%s:n asennus poistettu</string>
    <string name="apm_uninstall_failed">%s:n asennusta ei voitu poistaa</string>
    <string name="apm_version">Versio</string>
    <string name="apm_author">Tekijä</string>
    <string name="apm_overlay_fs_not_available">Moduulit eivät ole saatavilla, koska Kernel on poistanut OverlayFS:n käytöstä!</string>
    <string name="apm_magisk_conflict">Moduuleja ei ole saatavilla ristiriidan vuoksi Magiskin kanssa!</string>
    <string name="apm_reboot_to_apply">Käynnistä uudelleen, jotta se tulee voimaan</string>
    <string name="apm_changelog">Muutosloki</string>
    <string name="apm_start_downloading">Aloita %s:n lataaminen</string>
    <string name="apm_new_version_available">Uusi versio %s on saatavilla, päivitä napsauttamalla.</string>
    <string name="hide_apatch_manager">Piilota APatch-hallinta</string>
    <string name="hide_apatch_dialog_new_manager_name">Uusi hallinnan nimi</string>
    <string name="hide_apatch_dialog_summary">Sitä käytetään käynnistysohjelmassa uutena näkyvänä sovelluksen nimikkeenä</string>
    <string name="hide_apatch_manager_failure">Piilottaminen epäonnistui. Ilmoita viasta!</string>
    <string name="setting_reset_su_path">Nollaa superkäyttäjäpolku</string>
    <string name="setting_reset_su_new_path">Uusi täydellinen polku</string>
    <string name="apm_webui_open">Avaa</string>
    <string name="apm_action">Toiminta</string>
    <string name="enable_web_debugging_summary">Voidaan käyttää WebUI-viankorjaukseen. Ota käyttöön vain tarvittaessa.</string>
    <string name="settings_donot_store_superkey">Älä säilytä SuperKeyä paikallisesti</string>
    <string name="home_new_apatch_found">Uusi versio %s on saatavilla, päivitä napsauttamalla.</string>
    <string name="mode_select_page_title">Asenna</string>
    <string name="mode_select_page_patch_and_install">Korjaa ja asenna</string>
    <string name="mode_select_page_select_file">Valitse korjattava käynnistyskuva</string>
    <string name="mode_select_page_install_inactive_slot">Asenna ei-aktiiviseen kiinnittimeen (OTA:n jälkeen)</string>
    <string name="home_dialog_auth_fail_title">Todennus epäonnistui</string>
    <string name="home_more_menu_feedback_or_suggestion">Palaute tai ehdotus</string>
    <string name="home_more_menu_about">Tietoja</string>
    <string name="home_dialog_uninstall_title">Poista asennus</string>
    <string name="home_dialog_uninstall_ap_only">Poista AndroidPatch</string>
    <string name="home_dialog_uninstall_all">Poista koko asennus</string>
    <string name="kpm_control_dialog_title">Hallinnoi KPModulea</string>
    <string name="kpm_control_dialog_content">Syötön hallintaparametrit:</string>
    <string name="kpm_control_paramters">Parametrit</string>
    <string name="kpm_control_failed">Toiminta epäonnistui!</string>
    <string name="settings_night_mode_follow_sys">Seuraa järjestelmän tummaa teemaa</string>
    <string name="settings_night_theme_enabled">Ota tumma teema käyttöön</string>
    <string name="settings_use_system_color_theme">Järjestelmän väriteema</string>
    <string name="settings_use_system_color_theme_summary">Käytä järjestelmän luomaa väriteemaa nykyisen taustakuvan mukaan</string>
    <string name="settings_custom_color_theme">Väriteema:</string>
    <string name="amber_theme">Meripihka</string>
    <string name="blue_grey_theme">Siniharmaa</string>
    <string name="blue_theme">Sininen</string>
    <string name="brown_theme">Ruskea</string>
    <string name="cyan_theme">Syaani</string>
    <string name="deep_orange_theme">Syvä oranssi</string>
    <string name="deep_purple_theme">Syvä purppura</string>
    <string name="green_theme">Vihreä</string>
    <string name="indigo_theme">Indigo</string>
    <string name="light_blue_theme">Vaaleansininen</string>
    <string name="light_green_theme">Vaaleanvihreä</string>
    <string name="lime_theme">Lime</string>
    <string name="orange_theme">Oranssi</string>
    <string name="pink_theme">Vaaleanpunainen</string>
    <string name="red_theme">Punainen</string>
    <string name="sakura_theme">Sakura</string>
    <string name="teal_theme">Sinivihreä</string>
    <string name="yellow_theme">Keltainen</string>
    <string name="about_app_version">Versio %1$s</string>
    <string name="about_telegram_channel">Telegram-kanava</string>
    <string name="about_telegram_group">Telegram-ryhmä</string>
    <string name="about_powered_by">Voimanlähteenä %1$s</string>
    <string name="crash_handle_title">Sovellus kaatui…</string>
    <string name="crash_handle_copy">Kopioi kaatumisloki</string>
    <string name="crash_handle_copied">Kaatumisloki kopioittu leikepöydälle.</string>
</resources>

```

`app/src/main/res/values-fil/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="patch_warnning">Ang instalasyon na ito ay pwede ikaka-sira ng inyong kagamitan, tiyakin muna kung ang iyong data ay naka-backup.</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="reboot">Reboot</string>
    <string name="settings">Mga settings</string>
    <string name="send_log">Send Log</string>
    <string name="home_patch_set_key_desc">Kredensiyal para sa KernelPatch</string>
    <string name="home_install_unknown">Hindi alam</string>
    <string name="home_click_to_learn_apatch">Alamin ang mga features ng AndroidPatch at kung paano ito gamitin</string>
    <string name="home_installing">Installing</string>
    <string name="home_learn_apatch">Alamin ang AndroidPatch</string>
    <string name="home_click_to_install">I-click para mag install</string>
    <string name="patch_set_superkey">I-set ang SuperKey</string>
    <string name="home_working">Gumagana</string>
    <string name="home_not_installed">Hindi naka-installed</string>
    <string name="home_need_update">May update</string>
    <string name="home_patch_next_step">Susunod na hakbang</string>
    <string name="home_auth_key_desc">Magsimula ng trabaho pagkatapos ng sertipikasyon</string>
    <string name="super_key">SuperKey</string>
    <string name="home_apatch_version">APatch: %s</string>
    <string name="home_su_path">su: %s</string>
    <string name="home_auth_key_title">Ilagay ang superkey</string>
    <string name="home_ap_cando_install">I-install</string>
    <string name="home_ap_cando_update">I-update</string>
    <string name="kpm_unload_confirm">Sigurado ka bang nais mong i-unload ang module %s?</string>
    <string name="kpm_kp_not_installed">Hindi naka install ang Kernel Patch</string>
    <string name="kpm_desc">Desc</string>
    <string name="home_ap_cando_uninstall">I-uninstall</string>
    <string name="kpm_args">Args</string>
    <string name="home_fingerprint">Fingerprint</string>
    <string name="safe_mode">Safe na mode</string>
    <string name="home_selinux_status_unknown">Hindi alam</string>
    <string name="home_selinux_status_permissive">Pamahinang (Permissive)</string>
    <string name="home_selinux_status">SELinux status</string>
    <string name="kpm_load_toast_failed">Nabigo ang pag-load</string>
    <string name="kpm_unload">I-unload</string>
    <string name="home_kernel">Kernel</string>
    <string name="kpm">KPModule</string>
    <string name="home_selinux_status_enforcing">Pinapatupad (Enforcing)</string>
    <string name="kpm_apm_empty">Walang naka-load na module</string>
    <string name="home_manager_version">Bersyon ng Manager</string>
    <string name="kpm_load_toast_succ">Tagumpay ang pag-load</string>
    <string name="patch_title">Patch</string>
    <string name="kpm_author">May-akda</string>
    <string name="home_selinux_status_disabled">Hindi pinagana</string>
    <string name="kpm_license">Lisensiya</string>
    <string name="apm_install">I-install</string>
    <string name="apm_remove">I-uninstall</string>
    <string name="apm_uninstall_confirm">Sigurado ka bang gusto mong i-uninstall ang module %s?</string>
    <string name="su_pkg_excluded_setting_title">I-exclude</string>
    <string name="su_pkg_excluded_setting_summary">para sa mga modules</string>
    <string name="su_pkg_excluded_label">exclude</string>
    <string name="su_title">Superuser</string>
    <string name="apm">APModule</string>
    <string name="su_selinux_via_hook">bypass via hook</string>
    <string name="su_refresh">I-refresh</string>
    <string name="su_show_system_apps">Ipakita ang mga system apps</string>
    <string name="apm_failed_to_disable">Hindi tagumpay ang pagpapatigil ng module: %s</string>
    <string name="apm_failed_to_enable">Hindi tagumpay ang pagpapagana ng module: %s</string>
    <string name="su_hide_system_apps">Itago ang mga system apps</string>
    <string name="apm_empty">Walang naka-install na module</string>
    <string name="kpm_load">Mag Load</string>
    <string name="apm_reboot_to_apply">Mag restart para magkaruon ng epekto</string>
    <string name="apm_overlay_fs_not_available">walang overlayfs, hindi maaaring gumana ang module!</string>
    <string name="apm_uninstall_failed">Hindi tagumpay ang pag-uninstall ng: %s</string>
    <string name="apm_desc">Desc</string>
    <string name="apm_author">May-akda</string>
    <string name="apm_version">Bersyon</string>
    <string name="kpm_version">Bersyon</string>
    <string name="apm_changelog">Mga Pagbabago</string>
    <string name="apm_update">I-update</string>
    <string name="apm_start_downloading">Simulan ang pag-download ng: %s</string>
    <string name="apm_downloading">Ini-download ang module: %s</string>
    <string name="apm_new_version_available">Bagong bersyon: %s ay available, i-click para i-upgrade</string>
    <string name="home">Tahanan</string>
    <string name="patch">Mga patch</string>
    <string name="reboot_recovery">I-reboot sa Recovery</string>
    <string name="reboot_bootloader">I-reboot sa Bootloader</string>
    <string name="reboot_download">I-reboot sa Download</string>
    <string name="reboot_edl">I-reboot sa EDL</string>
    <string name="about">Tungkol nito</string>
    <string name="settings_app_language">Wika</string>
    <string name="system_default">Default ng system</string>
    <string name="settings_global_namespace_mode">Pandaigdigang Namespace Mode</string>
    <string name="settings_global_namespace_mode_summary">Ginagamit ng lahat ng root session ang pandaigdigang mount namespace</string>
    <string name="settings_clear_super_key_dialog">Gusto mo ba talagang magpatuloy?</string>
    <string name="success">Matagumpay</string>
    <string name="failure">Hindi matagumpay</string>
    <string name="log_saved">Na-save ang Log</string>
    <string name="crash_handle_copy">Kopyahin ang log sa pag-crash</string>
    <string name="crash_handle_copied">Nakopya ang log sa pag-crash sa clipboard.</string>
    <string name="clear_super_key">Alisin ang SuperKey</string>
</resources>

```

`app/src/main/res/values-fr/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="reboot_recovery">Redémarrer en mode récupération</string>
    <string name="reboot_download">Redémarrer en mode téléchargement</string>
    <string name="reboot_edl">Redémarrer en mode EDL</string>
    <string name="about">À propos</string>
    <string name="home_learn_apatch">En apprendre plus sur AndroidPatch</string>
    <string name="home">Accueil</string>
    <string name="patch_warnning">L\'installation comporte des risques. Veillez à ce que vos données soient sauvegardées.</string>
    <string name="settings">Paramètres</string>
    <string name="reboot_bootloader">Redémarrage en mode bootloader</string>
    <string name="reboot">Redémarrer</string>
    <string name="home_click_to_learn_apatch">Découvrez les fonctionnalités d\'AndroidPatch et apprenez comment l\'utiliser</string>
    <string name="safe_mode">Mode sécurisé</string>
    <string name="home_not_installed">Non installé</string>
    <string name="home_click_to_install">Appuyer pour installer</string>
    <string name="home_installing">Installation</string>
    <string name="home_need_update">Nouvelle version disponible</string>
    <string name="apatch_version">Version : %s</string>
    <string name="home_patch_next_step">Suivant</string>
    <string name="home_install_unknown">Non installé ou authentifié</string>
    <string name="kpatch_version">Version : %s</string>
    <string name="clear_super_key">Effacer la clé</string>
    <string name="home_su_path">Exécutable su</string>
    <string name="home_apatch_version">Version d\'APatch</string>
    <string name="apatch_version_update">Version : %s -&gt; %s</string>
    <string name="about_source_code"><![CDATA[<p>Voir le code source sur %1$s<p/>Rejoindre notre canal %2$s<p/>Rejoindre notre groupe %3$s]]></string>
    <string name="patch_set_superkey">Initialiser la clé</string>
    <string name="send_log">Envoyer le log</string>
    <string name="home_kernel">Version du noyau</string>
    <string name="kpm">KPModule</string>
    <string name="apm_version">Version</string>
    <string name="home_working">Fonctionnel 😋</string>
    <string name="home_patch_set_key_desc">Authentification unique pour KernelPatch</string>
    <string name="home_auth_key_title">Renseigner la clé</string>
    <string name="home_ap_cando_install">Installer</string>
    <string name="home_ap_cando_update">Mettre à jour</string>
    <string name="home_ap_cando_uninstall">Désinstaller</string>
    <string name="home_manager_version">Version du gestionnaire</string>
    <string name="home_fingerprint">Empreinte</string>
    <string name="kpm_load_toast_failed">Chargement échoué</string>
    <string name="kpm_version">Version</string>
    <string name="kpm_license">Licence</string>
    <string name="kpm_author">Auteur</string>
    <string name="kpm_desc">Description</string>
    <string name="su_title">Super utilisateur</string>
    <string name="su_pkg_excluded_label">exclure</string>
    <string name="su_show_system_apps">Afficher les applications système</string>
    <string name="su_hide_system_apps">Masquer les applications système</string>
    <string name="su_selinux_via_hook">contournement via hook</string>
    <string name="su_refresh">Rafraîchir</string>
    <string name="apm">APModule</string>
    <string name="apm_empty">Aucun module installé</string>
    <string name="apm_install">Installer</string>
    <string name="apm_uninstall_success">%s a été désinstallé</string>
    <string name="apm_author">Auteur</string>
    <string name="apm_desc">Description</string>
    <string name="apm_reboot_to_apply">Redémarrer pour appliquer les changements</string>
    <string name="apm_changelog">Journal des modifications</string>
    <string name="apm_update">Mettre à jour</string>
    <string name="apm_start_downloading">Téléchargement de %s démarré</string>
    <string name="home_selinux_status_disabled">Inactif</string>
    <string name="home_auth_key_desc">Démarrage après certification</string>
    <string name="kpm_unload_confirm">Décharger le module \"%s\" ?</string>
    <string name="apm_not_installed">AndroidPatch n\'est pas installé</string>
    <string name="apm_failed_to_disable">Impossible de désactiver le module \"%s\"</string>
    <string name="apm_uninstall_confirm">Désinstaller le module \"%s\" ?</string>
    <string name="apm_uninstall_failed">Impossible de désinstaller %s</string>
    <string name="apm_magisk_conflict">Les modules sont indisponibles en raison d\'un conflit avec Magisk !</string>
    <string name="apm_downloading">Téléchargement du module \"%s\"…</string>
    <string name="apm_new_version_available">Appuyez pour installer la nouvelle version, %s.</string>
    <string name="home_selinux_status_permissive">Permissif</string>
    <string name="home_selinux_status_unknown">Inconnu</string>
    <string name="super_key">Clé</string>
    <string name="patch_title">Patcher</string>
    <string name="home_selinux_status">État de SELinux</string>
    <string name="home_selinux_status_enforcing">Actif</string>
    <string name="kpm_kp_not_installed">KernelPatch n\'est pas installé</string>
    <string name="kpm_load">Charger</string>
    <string name="kpm_load_toast_succ">Chargement réussi</string>
    <string name="kpm_unload">Décharger</string>
    <string name="kpm_apm_empty">Aucun module chargé</string>
    <string name="apm_failed_to_enable">Impossible d\'activer le module \"%s\"</string>
    <string name="kpm_args">Arguments</string>
    <string name="su_pkg_excluded_setting_summary">L\'activation de cette option permettra à APatch de restaurer tous les fichiers modifiés par les modules de cette application.</string>
    <string name="apm_remove">Désinstaller</string>
    <string name="su_pkg_excluded_setting_title">Exclure les modifications</string>
    <string name="apm_overlay_fs_not_available">Les modules sont indisponibles car OverlayFS est désactivé par le noyau !</string>
    <string name="patch">Patcher</string>
    <string name="settings_app_language">Langue</string>
    <string name="system_default">Système par défaut</string>
    <string name="settings_global_namespace_mode">Mode espace de nommage global</string>
    <string name="settings_global_namespace_mode_summary">Toutes les sessions root utilisent l\'espace de nommage global</string>
    <string name="settings_clear_super_key_dialog">Voulez-vous vraiment continuer ?</string>
    <string name="kpatch_version_update">Version : %s -&gt; %s</string>
    <string name="home_kpatch_info_title">Info</string>
    <string name="home_ap_cando_reboot">Redémarrer</string>
    <string name="patch_config_title">Patchs</string>
    <string name="patch_item_kernel">Noyau</string>
    <string name="patch_item_set_skey_label">La longueur de la clé doit être d\'au moins 8 caractères et inclure à la fois des numéros et des lettres, mais pas de caractères spéciaux.</string>
    <string name="hide_apatch_dialog_new_manager_name">Nouveau nom du gestionnaire</string>
    <string name="hide_apatch_dialog_summary">Il sera utilisé comme label de la nouvelle application affichée dans le lanceur d\'applications</string>
    <string name="hide_apatch_manager_summary">Installer un proxy avec un identifiant de paquet aléatoire et un label d\'application personnalisé</string>
    <string name="hide_apatch_manager_failure">Échec de la dissimulation, merci de signaler le bug !</string>
    <string name="patch_embed_kpm_btn">Intégrer un KPM</string>
    <string name="patch_start_patch_btn">Démarrer</string>
    <string name="success">Succès</string>
    <string name="failure">Échec</string>
    <string name="patch_mode_bootimg_patch">Mode : Patch</string>
    <string name="patch_select_bootimg_btn">Sélectionner l\'image de boot</string>
    <string name="patch_start_unpatch_btn">Dépatcher</string>
    <string name="patch_item_error">!! ERREUR !!</string>
    <string name="patch_item_bootimg">bootimg</string>
    <string name="patch_item_bootimg_slot">slot :</string>
    <string name="patch_item_bootimg_dev">appareil :</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_kpimg_version">Version :</string>
    <string name="patch_item_kpimg_comile_time">Date :</string>
    <string name="patch_item_kpimg_config">Config :</string>
    <string name="patch_item_new_extra_kpm">Intégrer un nouveau</string>
    <string name="patch_item_extra_name">Nom :</string>
    <string name="patch_item_extra_author">Auteur :</string>
    <string name="patch_item_extra_kpm_license">Licence :</string>
    <string name="patch_item_extra_kpm_desciption">Description :</string>
    <string name="patch_item_extra_event">Événement :</string>
    <string name="patch_item_skey">Clé</string>
    <string name="kpm_add_kpm">Ajouter un KPM</string>
    <string name="kpm_install">Installer</string>
    <string name="kpm_embed">Intégrer</string>
    <string name="setting_reset_su_path">Réinitialiser le chemin su</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="patch_mode_uninstall_patch">Mode : Dépatch</string>
    <string name="patch_item_extra_version">Version :</string>
    <string name="patch_item_extra_args">Args :</string>
    <string name="hide_apatch_manager">Masquer le gestionnaire APatch</string>
    <string name="setting_reset_su_new_path">nouveau chemin complet</string>
    <string name="patch_item_existed_extra_kpm">Existait</string>
    <string name="settings_donot_store_superkey_summary">Authentifier la clé à chaque démarrage du gestionnaire</string>
    <string name="mode_select_page_select_file">Sélectionner une image boot à patcher</string>
    <string name="mode_select_page_patch_and_install">Patcher et installer</string>
    <string name="settings_check_update">Vérifier les mises à jour</string>
    <string name="settings_check_update_summary">Vérifier automatiquement les mises à jour à l\'ouverture de l\'application</string>
    <string name="home_more_menu_about">À propos</string>
    <string name="home_install_unknown_summary">Cliquer pour installer</string>
    <string name="home_device_info">Appareil</string>
    <string name="home_system_version">Version du système</string>
    <string name="home_kpatch_version">Version de KernelPatch</string>
    <string name="enable_web_debugging_summary">Peut être utilisé pour déboguer l\'interface web, n\'activer cette option qu\'en cas de besoin.</string>
    <string name="home_new_apatch_found">Nouvelle version disponible : %s, Cliquer pour mettre à jour.</string>
    <string name="home_dialog_auth_fail_title">Echec de l\'authentification</string>
    <string name="home_dialog_uninstall_title">Désinstaller</string>
    <string name="home_dialog_uninstall_ap_only">Supprimer AndroidPatch</string>
    <string name="home_dialog_uninstall_all">Désinstaller complètement</string>
    <string name="patch_mode_install_to_next_slot">Mode : Installer dans le slot suivant (après OTA)</string>
    <string name="mode_select_page_title">Installer</string>
    <string name="mode_select_page_install_inactive_slot">Installer dans le slot inactif (après OTA)</string>
    <string name="home_more_menu_feedback_or_suggestion">Commentaires ou suggestions</string>
    <string name="patch_mode_patch_and_install">Mode : Patcher et installer</string>
    <string name="mode_select_page_install_inactive_slot_warning">Votre appareil sera **FORCÉ** de démarrer sur le slot inactif actuel après un redémarrage !
\nN\'utilisez cette option qu\'une fois l\'OTA terminée.
\nContinuer ?</string>
    <string name="home_dialog_auth_fail_content">Impossible d\'authentifier la clé, par conséquent APatch ne peut pas fonctionner correctement. \nVoici quelques raisons possibles de l\'échec de l\'authentification : \n1. Vous n\'avez pas patché l\'image de démarrage avec KernelPatch. \n2. L\'image de démarrage patchée n\'a pas été flashée. \n3. La clé est erronée. \n4. Votre appareil ne prend pas en charge APatch et KernelPatch. \n \nVeuillez vérifier et réessayer. Si des problèmes persistent, vous pouvez toujours poser vos questions sur le dépôt officiel.</string>
    <string name="settings_donot_store_superkey">Ne pas stocker la clé localement</string>
    <string name="apm_webui_open">Ouvrir l\'interface web</string>
    <string name="enable_web_debugging">Activer le débogage WebView</string>
    <string name="kpm_control">Contrôle</string>
    <string name="settings_night_mode_follow_sys">Suivre le thème sombre du système</string>
    <string name="teal_theme">Thème sarcelle</string>
    <string name="amber_theme">Thème ambre</string>
    <string name="lime_theme">Thème citron vert</string>
    <string name="pink_theme">Thème rose</string>
    <string name="blue_grey_theme">Thème bleu gris</string>
    <string name="purple_theme">Thème violet</string>
    <string name="brown_theme">Thème marron</string>
    <string name="cyan_theme">Thème cyan</string>
    <string name="orange_theme">Thème orange</string>
    <string name="yellow_theme">Thème jaune</string>
    <string name="about_app_desc">Solution Root noyau avec seulement une image de noyau dépouillée, offrant la possibilité de monter un module système et de hook une fonction du noyau.</string>
    <string name="kpm_control_ok">Opération réussie !</string>
    <string name="settings_night_theme_enabled">Activer le thème sombre</string>
    <string name="settings_use_system_color_theme">Thème de couleur du système</string>
    <string name="about_app_version">Version %1$s</string>
    <string name="kpm_control_dialog_content">Paramètres de contrôle d\'entrée :</string>
    <string name="settings_custom_color_theme">Thème de couleur</string>
    <string name="light_blue_theme">Thème bleu clair</string>
    <string name="kpm_control_dialog_title">Contrôler le KPModule</string>
    <string name="kpm_control_outMsg">Message</string>
    <string name="kpm_control_failed">Opération échouée !</string>
    <string name="settings_use_system_color_theme_summary">Utiliser un thème de couleur généré par le système avec le fond d\'écran actuel</string>
    <string name="blue_theme">Thème bleu</string>
    <string name="deep_orange_theme">Thème orange foncé</string>
    <string name="deep_purple_theme">Thème violet foncé</string>
    <string name="indigo_theme">Thème indigo</string>
    <string name="about_telegram_channel">Canal Telegram</string>
    <string name="about_telegram_group">Groupe Telegram</string>
    <string name="about_powered_by">Propulsé par %1$s</string>
    <string name="green_theme">Thème vert</string>
    <string name="light_green_theme">Thème vert clair</string>
    <string name="sakura_theme">Thème sakura</string>
    <string name="red_theme">Thème rouge</string>
    <string name="kpm_control_paramters">Paramètres</string>
    <string name="settings_night_mode_follow_sys_summary">Basculement automatique vers le thème sombre en fonction des paramètres du système</string>
    <string name="save_log">Enregistrer le journal</string>
    <string name="apm_action">Action</string>
    <string name="log_saved">Journal enregistré</string>
    <string name="crash_handle_title">L\'application a planté…</string>
    <string name="crash_handle_copy">Copier le rapport de plantage</string>
    <string name="crash_handle_copied">Rapport de plantage copié dans le presse-papiers.</string>
    <string name="settings_lite_mode">Activer le mode Lite</string>
    <string name="settings_lite_mode_mode_summary">Les fonctions APModule peuvent présenter des défaillances après avoir été activées, mais dans certains cas, elles peuvent toujours éviter la détection. Redémarrage requis.</string>
    <string name="settings_force_overlayfs_mode">Utilisation forcée de OverlayFS</string>
    <string name="settings_force_overlayfs_mode_summary">Utilisez OverlayFS pour monter APModules au lieu de Magic Mount lorsque le support du noyau est disponible. Redémarrage requis.</string>
</resources>

```

`app/src/main/res/values-gl/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="home">Fogar</string>
    <string name="patch_warnning">A instalación conleva uns riscos. Por favor, asegura os teus datos.</string>
    <string name="patch">Parche</string>
    <string name="kernel_patch">Parche do Kernel</string>
    <string name="android_patch">Parche de Android</string>
    <string name="reboot">Reiniciar</string>
    <string name="settings">Configuración</string>
    <string name="reboot_bootloader">Reiniciar no cargador de arranque</string>
    <string name="reboot_download">Reiniciar para descargar</string>
    <string name="reboot_edl">Reiniciar a EDL</string>
    <string name="about">Acerca de</string>
    <string name="system_default">Por defecto do sistema</string>
    <string name="reboot_recovery">Reiniciar para recuperar</string>
    <string name="settings_app_language">Lingua</string>
</resources>
```

`app/src/main/res/values-hr/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="reboot">Ponovno pokreni</string>
    <string name="home">Početna</string>
    <string name="patch">Patch</string>
    <string name="settings">Postavke</string>
    <string name="reboot_recovery">Pokreni u Modu za Oporavak</string>
    <string name="reboot_bootloader">Pokreni u Bootloader</string>
    <string name="reboot_download">Pokreni u Download</string>
    <string name="reboot_edl">Pokreni u EDL</string>
    <string name="settings_app_language">Jezik</string>
    <string name="home_learn_apatch">Nauči o APatch-u</string>
    <string name="home_click_to_learn_apatch">Nauči više o značajkama APatch i kako ih koristiti</string>
    <string name="about_source_code">Pogledaj izvorni kod na %1$s<br/>Pridruži se na našem %2$s kanalu</string>
    <string name="send_log">Pošalji logove</string>
    <string name="safe_mode">Sigurni način</string>
    <string name="super_key">SuperKey</string>
    <string name="clear_super_key">Izbriši SuperKey</string>
    <string name="patch_set_superkey">Postavi SuperKey</string>
    <string name="home_patch_next_step">Sljedeći korak</string>
    <string name="home_not_installed">Nije instalirano</string>
    <string name="home_install_unknown">Nepoznato</string>
    <string name="home_click_to_install">Klikni za instalaciju</string>
    <string name="home_working">Funkcionira</string>
    <string name="home_installing">Instaliranje</string>
    <string name="home_need_update">Nova inačica dostupna</string>
    <string name="kpatch_version">Verzija: %s</string>
    <string name="apatch_version">Inačica:
\n%s</string>
    <string name="apatch_version_update">Inačica:
\n%s -&gt; %s</string>
    <string name="home_su_path">su: %s</string>
    <string name="home_auth_key_desc">Pokreni nakon certificiranja</string>
    <string name="home_ap_cando_install">Instaliraj</string>
    <string name="home_ap_cando_update">Ažuriraj</string>
    <string name="home_ap_cando_uninstall">De-instaliraj</string>
    <string name="patch_title">Patch</string>
    <string name="home_kernel">Kernel</string>
    <string name="about">Informacije</string>
    <string name="system_default">Sistemska postavka</string>
    <string name="settings_global_namespace_mode">Global Namespace Mode</string>
    <string name="home_manager_version">Upravitelj verzija</string>
    <string name="home_fingerprint">Otisak</string>
    <string name="home_selinux_status">SELinux status</string>
    <string name="home_selinux_status_disabled">Isključeno</string>
    <string name="home_selinux_status_permissive">Permissive</string>
    <string name="kpm">KPModule</string>
    <string name="kpm_load_toast_succ">Učitavanje završeno</string>
    <string name="kpm_load_toast_failed">Učitavanje neusješno</string>
    <string name="kpm_unload_confirm">Odčitaj \"%s\" modul?</string>
    <string name="kpm_unload">Odčitaj</string>
    <string name="kpm_apm_empty">Nijedan modul očitan</string>
    <string name="kpm_version">Inačica</string>
    <string name="kpm_license">Licenca</string>
    <string name="kpm_author">Autor</string>
    <string name="kpm_desc">Opis</string>
    <string name="kpm_args">Argumenti</string>
    <string name="su_title">Superuser</string>
    <string name="su_pkg_excluded_setting_summary">Uključivanjem ove opcije dozvoljavate APatch-u da vrati bilo koje datoteke modificirane modulima ove aplikacije.</string>
    <string name="su_show_system_apps">Prikaži sistemske aplikacije</string>
    <string name="su_hide_system_apps">Sakrij sistemske aplikacije</string>
    <string name="su_refresh">Osvježi</string>
    <string name="apm">APModule</string>
    <string name="apm_not_installed">AndroidPatch nije instaliran</string>
    <string name="apm_failed_to_enable">Nije bilo moguće uključit \"%s\" modul</string>
    <string name="apm_empty">Nema modula instalirana</string>
    <string name="apm_remove">Ukloni</string>
    <string name="apm_install">Instaliraj</string>
    <string name="apm_start_downloading">Počni preuzimati %s</string>
    <string name="apm_new_version_available">Nova verzija %s je dostupna, klikni za nadogradnju.</string>
    <string name="su_selinux_via_hook">bypass via hook</string>
    <string name="su_pkg_excluded_label">Isključi</string>
    <string name="su_pkg_excluded_setting_title">Isključi modifikacije</string>
    <string name="patch_warnning">Instalacija može biti riskantna. Sačuvaj osobne podatke.</string>
    <string name="kpm_load">Učitaj</string>
    <string name="home_apatch_version">Apatch: %s</string>
    <string name="home_auth_key_title">Unesi SuperKey</string>
    <string name="home_selinux_status_enforcing">Enforcing</string>
    <string name="home_selinux_status_unknown">Nepoznato</string>
    <string name="kpm_kp_not_installed">KernelPatch nije instaliran</string>
    <string name="apm_failed_to_disable">Nije bilo moguće isključiti \"%s\" modul</string>
    <string name="apm_desc">Opis</string>
    <string name="apm_uninstall_confirm">Deinstaliraj \"%s\" modul?</string>
    <string name="apm_uninstall_success">%s deinstaliran</string>
    <string name="apm_uninstall_failed">Nije bilo moguće deinstalirati %s</string>
    <string name="apm_version">Verzija</string>
    <string name="apm_author">Autor</string>
    <string name="apm_overlay_fs_not_available">Moduli nisu dostupni jer je OverlayFS onemogućeni od strane kernela.</string>
    <string name="apm_magisk_conflict">Moduli su nedostupni radi konflikta s Magiskom!</string>
    <string name="apm_reboot_to_apply">Ponovno pokreni za promjene</string>
    <string name="apm_changelog">Lista promjene</string>
    <string name="apm_update">Ažuriraj</string>
    <string name="apm_downloading">Preuzimanje \"%s\" modula…</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="settings_global_namespace_mode_summary">Sve root sesije koriste globalni mount namespace</string>
    <string name="home_patch_set_key_desc">Samo zaporke za KernelPatch</string>
    <string name="settings_clear_super_key_dialog">Želite li stvarno nastaviti?</string>
    <string name="success">Uspješno</string>
    <string name="failure">Neuspješno</string>
    <string name="settings_check_update">Provjeriti ažuriranja</string>
    <string name="patch_item_kpimg_comile_time">Vrijeme:</string>
    <string name="patch_item_extra_version">Verzija:</string>
    <string name="patch_item_kpimg_config">Konfiguracija:</string>
    <string name="patch_item_extra_author">Autor:</string>
    <string name="patch_item_extra_kpm_license">Licenca:</string>
    <string name="patch_item_extra_args">Argumenti:</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="patch_item_bootimg_dev">uređaj:</string>
    <string name="patch_config_title">Patchovi</string>
    <string name="patch_mode_bootimg_patch">Mod: Patch</string>
    <string name="patch_item_existed_extra_kpm">Postojalo</string>
    <string name="patch_item_extra_name">Ime:</string>
    <string name="save_log">Spremi logove</string>
    <string name="patch_item_extra_kpm_desciption">Opis:</string>
    <string name="patch_item_extra_event">Događaj:</string>
    <string name="home_new_apatch_found">Nova verzija %s je dostupna, klikni za nadogradnju.</string>
    <string name="settings_check_update_summary">Automatski provjeri za nadogradnje prilikom otvaranja aplikacije</string>
    <string name="kpatch_version_update">Verzija: %s -&gt; %s</string>
    <string name="home_ap_cando_reboot">Restartiraj</string>
    <string name="patch_mode_patch_and_install">Mod: Patch i instaliraj</string>
    <string name="patch_mode_install_to_next_slot">Mod: Instaliraj na inaktivni slot (Poslije OTA nadogradnje)</string>
    <string name="patch_mode_uninstall_patch">Mod: Deinstaliraj KPatch</string>
    <string name="patch_start_patch_btn">Pokreni</string>
    <string name="patch_item_error">!!GREŠKA!!</string>
    <string name="patch_item_kpimg_version">Verzija:</string>
    <string name="patch_item_set_skey_label">SuperKey treba biti 8-63 znamenke dugačak, uključujući brojeve i slova ali ne posebne simbole.</string>
    <string name="home_device_info">Uređaj</string>
    <string name="home_system_version">Verzija sustava</string>
    <string name="kpm_install">Instaliraj</string>
    <string name="kpm_control">Kontrola</string>
    <string name="hide_apatch_manager">Sakrij APatch Manager</string>
    <string name="hide_apatch_manager_failure">Nije moguće sakriti. Molimo prijavite grešku!</string>
    <string name="log_saved">Logovi spremljeni</string>
    <string name="mode_select_page_title">Instaliraj</string>
    <string name="apm_webui_open">Otvori</string>
    <string name="apm_action">Radnja</string>
    <string name="home_dialog_uninstall_ap_only">Deinstaliraj AndroidPatch</string>
    <string name="mode_select_page_install_inactive_slot_warning">Vaš uređaj će biti **FORSIRAN* da pokrene trenutni inaktivni slot nakon restarta!\nSamo koristite ovu opcije nakon što je OTA nadogradnje dovršena.\nNastaviti?</string>
    <string name="home_dialog_uninstall_all">Deinstaliraj sve</string>
    <string name="home_dialog_auth_fail_title">Autentikacija nije uspjela</string>
    <string name="home_dialog_uninstall_title">Deinstaliraj</string>
    <string name="kpm_control_paramters">Parametri</string>
    <string name="kpm_control_outMsg">Poruka</string>
    <string name="kpm_control_ok">Operacija uspješna!</string>
    <string name="patch_item_kernel">Jezgra</string>
    <string name="settings_donot_store_superkey_summary">Autentificiraj SuperKey pri svakom pokretanju upravitelja</string>
    <string name="settings_donot_store_superkey">Nemoj spremati SuperKey u local</string>
    <string name="hide_apatch_dialog_new_manager_name">Novo ime upravitelja</string>
    <string name="settings_night_mode_follow_sys_summary">Automatski prebaci na tamni prikaz ovisno o postavkama sistema</string>
    <string name="patch_item_skey">SuperKey</string>
    <string name="home_dialog_auth_fail_content">Nije moguće autentificirati SuperKey, stoga APatch ne može pravilno funkcionirati.\nOvo su neki od mogućih uzroka neuspjeha autentifikacije:\n1.</string>
    <string name="home_more_menu_feedback_or_suggestion">Povratne informacije ili prijedlozi</string>
    <string name="settings_night_theme_enabled">Uključi tamni prikaz</string>
    <string name="settings_custom_color_theme">Boje prikaza</string>
    <string name="blue_grey_theme">Plavo-siva</string>
    <string name="blue_theme">Plava</string>
    <string name="orange_theme">Narančasta</string>
    <string name="pink_theme">Ružičasta</string>
    <string name="red_theme">Crvena</string>
    <string name="green_theme">Zelena</string>
    <string name="indigo_theme">Indigo</string>
    <string name="patch_select_bootimg_btn">Odaberite pokretanje</string>
    <string name="home_more_menu_about">Informacije</string>
    <string name="home_install_unknown_summary">Pritisnite za instalaciju</string>
    <string name="home_kpatch_info_title">Informacije</string>
    <string name="patch_start_unpatch_btn">Makni patch</string>
    <string name="patch_item_bootimg">Slika za pokretanje</string>
    <string name="kpm_add_kpm">Dodaj KPM</string>
    <string name="hide_apatch_manager_summary">Instaliraj novu aplikaciju upravitelja s nasumičnim ID-jem i prilagođenom oznakom</string>
    <string name="hide_apatch_dialog_summary">Biti će korišteno za novu oznaku aplikacije prikazane u pokretaču</string>
    <string name="setting_reset_su_path">Resetiraj su put</string>
    <string name="setting_reset_su_new_path">Novi puni put</string>
    <string name="enable_web_debugging">Uključi WebView debugganje</string>
    <string name="enable_web_debugging_summary">Može se koristiti za debuggiranje WebUI-a. Molimo uključite samo kada potrebno.</string>
    <string name="mode_select_page_patch_and_install">Primjeni i instaliraj</string>
    <string name="mode_select_page_install_inactive_slot">Instaliraj u neaktivni utor (Nakon OTA)</string>
    <string name="kpm_control_dialog_title">Kontroliraj KPModule</string>
    <string name="kpm_control_dialog_content">Parametri kontrola unosa:</string>
    <string name="kpm_control_failed">Operacija neuspješna!</string>
    <string name="settings_night_mode_follow_sys">Prati tamni prikaz sistema</string>
    <string name="settings_use_system_color_theme">Boje prikaza sistema</string>
    <string name="settings_use_system_color_theme_summary">Koristi boje prikaza koje je sistem generirao bazirano na trenutačnoj pozadini.</string>
    <string name="amber_theme">Jantar</string>
    <string name="brown_theme">Smeđa</string>
    <string name="deep_orange_theme">Tamno narančasta</string>
    <string name="deep_purple_theme">Tamno ljubičasta</string>
    <string name="light_blue_theme">Svijetlo plava</string>
    <string name="light_green_theme">Svijetlo zelena</string>
    <string name="lime_theme">Boja limete</string>
    <string name="purple_theme">Ljubičasta</string>
    <string name="sakura_theme">Boja sakure</string>
    <string name="teal_theme">Tirkizna</string>
    <string name="yellow_theme">Žuta</string>
    <string name="about_telegram_channel">Telegram kanal</string>
    <string name="about_telegram_group">Telegram grupa</string>
    <string name="crash_handle_title">Aplikacija se srušila…</string>
    <string name="crash_handle_copy">Kopiraj log rušenja</string>
    <string name="crash_handle_copied">Log rušenja kopiran u međuspremnik.</string>
    <string name="cyan_theme">Cijan</string>
    <string name="about_app_version">Verzija %1$s</string>
</resources>

```

`app/src/main/res/values-hu/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="kpatch_version">Verzió: %s</string>
    <string name="home_apatch_version">APatch: %s</string>
    <string name="reboot">Újraindítás</string>
    <string name="settings">Beállítások</string>
    <string name="home_install_unknown">Ismeretlen</string>
    <string name="home_click_to_install">Kattints a telepítéshez</string>
    <string name="home_installing">Telepítés...</string>
    <string name="home_need_update">Frissítés elérhető</string>
    <string name="apatch_version_update">Verzió: %s -&gt; %s</string>
    <string name="home_su_path">su: %s</string>
    <string name="home_ap_cando_install">Telepítés</string>
    <string name="home_ap_cando_update">Frissítés</string>
    <string name="home_ap_cando_uninstall">Eltávolítás</string>
    <string name="home_kernel">Kernel</string>
    <string name="home_fingerprint">Ujjlenyomat</string>
    <string name="home_selinux_status">SELinux állapot</string>
    <string name="home_selinux_status_disabled">kikapcsolva</string>
    <string name="home_selinux_status_unknown">Ismeretlen</string>
    <string name="kpm_load">Betöltés</string>
    <string name="kpm_load_toast_succ">Betöltés sikeres</string>
    <string name="kpm_load_toast_failed">Betöltés sikertelen</string>
    <string name="kpm_apm_empty">Nincs modul betöltve</string>
    <string name="kpm_version">Verzió</string>
    <string name="kpm_license">Licensz</string>
    <string name="kpm_author">Szerző</string>
    <string name="su_pkg_excluded_label">kizárás</string>
    <string name="su_pkg_excluded_setting_title">Kizárja a módosításokat</string>
    <string name="settings_app_language">Nyelv</string>
    <string name="system_default">Rendszer alapértelmezett</string>
    <string name="apm_desc">Leírás</string>
    <string name="apm_version">Verzió</string>
    <string name="apm_author">Szerző</string>
    <string name="home_patch_next_step">Következő Lépés</string>
    <string name="home_not_installed">Nincs telepítve</string>
    <string name="apatch_version">Verzió: %s</string>
    <string name="su_pkg_excluded_setting_summary">Ennek az opciónak a bekapcsolása engedélyezi az APatch számára, hogy visszaállítson más modulok álltal módosított fájlokat.</string>
    <string name="apm_uninstall_confirm">A(z) \"%s\" modul eltávolítása?</string>
    <string name="apm_uninstall_success">%s eltávolítva</string>
    <string name="apm_uninstall_failed">Nem sikerült eltávolítani a(z) %s-t</string>
    <string name="apm_magisk_conflict">A modulok nem érhetők el a Magiskkal való konfliktus miatt.</string>
    <string name="apm">APModul</string>
    <string name="apm_not_installed">Az AndroidPatch nincs telepítva</string>
    <string name="apm_failed_to_disable">Nem kapcsolható ki a \"%s\" modul</string>
    <string name="apm_empty">Nincs telepített modul</string>
    <string name="su_show_system_apps">Rendszeralkalmazások megjelenítése</string>
    <string name="su_hide_system_apps">Rendszeralkalmazások elrejtése</string>
    <string name="su_refresh">Frissítés</string>
    <string name="apm_remove">Eltávolítás</string>
    <string name="apm_install">Telepítés</string>
    <string name="apm_reboot_to_apply">Újraindítsa a hatás eléréséhez</string>
    <string name="apm_changelog">Változásnapló</string>
    <string name="apm_update">Frissítés</string>
    <string name="apm_downloading">\"%s\" modul letöltés alatt…</string>
    <string name="apm_start_downloading">%s letöltésének elkezdése</string>
    <string name="apm_new_version_available">Új verzió (%s) érhető el. Kattints a telepítéshez!</string>
    <string name="patch_warnning">A telepítés kockázatokkal jár. Kérjük, készíts biztonsági másolatot az adataidról.</string>
    <string name="patch">Javítás</string>
    <string name="reboot_bootloader">Újraindítás a Bootloaderbe</string>
    <string name="settings_global_namespace_mode_summary">Minden gyökérmunka a globális hegyi neveket használja</string>
    <string name="home_learn_apatch">APatch tanulása</string>
    <string name="apm_overlay_fs_not_available">A modulok nem elérhetőek, mert az OverlayFS ki van kapcsolva a kernelben!</string>
    <string name="settings_clear_super_key_dialog">Biztos folytatni akarod?</string>
    <string name="home_click_to_learn_apatch">Ismerd meg az APatch funkcióit és használatát</string>
    <string name="about_source_code"><![CDATA[<p>Forráskód megtekintése %1$s-on<p/>Csatlakozz a %2$s csatornánkhoz<p/>Csatlakozz a %3$s csoportunkhoz]]></string>
    <string name="send_log">Naplók küldése</string>
    <string name="safe_mode">Biztonságos mód</string>
    <string name="super_key">SzuperKulcs</string>
    <string name="clear_super_key">SzuperKulcs tisztítása</string>
    <string name="patch_set_superkey">SzuperKulcs beállítása</string>
    <string name="home_patch_set_key_desc">Kizárólag a KernelPatch hitelesítéséhez</string>
    <string name="kpatch_version_update">Verzió: %s -&gt; %s</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="home_auth_key_title">Írd be a SzuperKulcsot</string>
    <string name="home_auth_key_desc">Kezdés a tanúsítás után</string>
    <string name="home_kpatch_info_title">Infó</string>
    <string name="home_ap_cando_reboot">Újraindítás</string>
    <string name="patch_title">Javítás</string>
    <string name="patch_config_title">Javítások</string>
    <string name="patch_mode_bootimg_patch">Mód: Javítás</string>
    <string name="patch_select_bootimg_btn">Választás indításnal</string>
    <string name="patch_embed_kpm_btn">KPM beágyazása</string>
    <string name="patch_start_patch_btn">Indítás</string>
    <string name="patch_start_unpatch_btn">Javítás visszavonása</string>
    <string name="patch_mode_uninstall_patch">Mód: Javítás visszavonása</string>
    <string name="patch_item_error">!!HIBA!!</string>
    <string name="patch_item_bootimg">bootimg</string>
    <string name="patch_item_bootimg_slot">hely:</string>
    <string name="patch_item_bootimg_dev">eszköz:</string>
    <string name="patch_item_kernel">kernel</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_kpimg_version">verzió:</string>
    <string name="patch_item_kpimg_comile_time">Idő:</string>
    <string name="patch_item_kpimg_config">Konfig:</string>
    <string name="patch_item_new_extra_kpm">új beágyazása</string>
    <string name="patch_item_existed_extra_kpm">létezett</string>
    <string name="patch_item_extra_name">Név:</string>
    <string name="patch_item_extra_version">Verzió:</string>
    <string name="patch_item_extra_kpm_license">licenc:</string>
    <string name="patch_item_extra_kpm_desciption">Leírás:</string>
    <string name="patch_item_extra_args">Argumentumok:</string>
    <string name="patch_item_extra_event">Események:</string>
    <string name="patch_item_skey">Szuper kulcs</string>
    <string name="patch_item_extra_author">Szerző:</string>
    <string name="patch_item_set_skey_label">A szuperkulcs hossza legalább 8 karakter legyen, és tartalmazzon számokat és betűket egyaránt.</string>
    <string name="home_manager_version">Kezelő Verziója</string>
    <string name="home_selinux_status_enforcing">Kényszerített</string>
    <string name="home_selinux_status_permissive">Permisszív</string>
    <string name="kpm">KPModul</string>
    <string name="kpm_kp_not_installed">A KernelPatch nincs telepítve</string>
    <string name="kpm_desc">Leírás</string>
    <string name="kpm_args">Argumentumok</string>
    <string name="su_selinux_via_hook">kikerülés horoggal</string>
    <string name="apm_failed_to_enable">Nem sikerült bekapcsolni a(z) \"%s\" modult</string>
    <string name="home">Kezdőlap</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="reboot_recovery">Újaraindítás a Visszaállítóba</string>
    <string name="reboot_download">Újraindítás a Letöltés-módba</string>
    <string name="reboot_edl">Újraindítás az EDL-be</string>
    <string name="about">Rólunk</string>
    <string name="settings_global_namespace_mode">Globális névtér mód</string>
    <string name="home_working">Működik</string>
    <string name="kpm_unload">Kitöltés</string>
    <string name="kpm_unload_confirm">\"%s\" modul kitöltése?</string>
    <string name="su_title">Superuser</string>
    <string name="success">Sikeres</string>
    <string name="failure">Hiba</string>
    <string name="settings_check_update_summary">Frissítések automatikus keresése minden induláskor</string>
    <string name="settings_check_update">Frissítés ellenőrzése</string>
    <string name="home_device_info">Eszköz</string>
    <string name="home_system_version">Rendszer verziója</string>
    <string name="kpm_control">Control</string>
    <string name="kpm_install">Telepítés</string>
    <string name="kpm_embed">Beágyazás</string>
    <string name="home_kpatch_version">KernelPatch verzió</string>
    <string name="kpm_add_kpm">KPM hozzáadása</string>
    <string name="save_log">ddd</string>
    <string name="hide_apatch_manager_summary">Új menedzser alk. telepítése véletlenszerű ID-vel és saját címkével</string>
    <string name="hide_apatch_dialog_new_manager_name">Új menedzser neve</string>
    <string name="hide_apatch_manager">APatch Menedzser elrejtése</string>
    <string name="setting_reset_su_new_path">Új, teljes elérési út</string>
    <string name="hide_apatch_manager_failure">Nem sikerült elrejteni. Kérlek jelentsd a hibát!</string>
    <string name="setting_reset_su_path">a \'su\' elérési útjának visszaállítása</string>
    <string name="apm_webui_open">Megnyitás</string>
    <string name="enable_web_debugging">A WebView hibakeresés engedélyezése</string>
    <string name="patch_mode_patch_and_install">Mód: Javítás és telepítés</string>
    <string name="home_install_unknown_summary">Kattints a telepítéshez</string>
    <string name="log_saved">Napló elmentve</string>
    <string name="apm_action">Művelet</string>
    <string name="patch_mode_install_to_next_slot">Mód:Telepítés inaktív helyre (OTA után)</string>
    <string name="settings_donot_store_superkey">Ne mentse a Szuper kulcsot helyileg</string>
    <string name="enable_web_debugging_summary">Nem használható a WebUI hibakereséséhez. Csak akkor engedélyezze ha szüksége van rá.</string>
</resources>

```

`app/src/main/res/values-in/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="patch_warnning">Berisiko! Pastikan data anda telah dicadangkan.</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="apm">APModul</string>
    <string name="super_key">SuperKey</string>
    <string name="app_name" translatable="false">APatch</string>
    <string name="kpm">KPModul</string>
    <string name="reboot_recovery">Reboot ke Recovery</string>
    <string name="reboot">Reboot</string>
    <string name="settings">Setelan</string>
    <string name="reboot_bootloader">Reboot ke Bootloader</string>
    <string name="home_click_to_learn_apatch">Pelajari fitur dan penggunaan APatch</string>
    <string name="reboot_edl">Reboot ke EDL</string>
    <string name="home_learn_apatch">Pelajari APatch</string>
    <string name="about">Tentang</string>
    <string name="about_source_code"><![CDATA[<p>Lihat kode sumber di %1$s<p/>Gabung kanal %2$s kami<p/>Gabung grup %3$s kami]]></string>
    <string name="send_log">Kirim log</string>
    <string name="safe_mode">Mode aman</string>
    <string name="home_patch_set_key_desc">Kredensial untuk KernelPatch</string>
    <string name="patch_set_superkey">Pasang SuperKey</string>
    <string name="home_install_unknown">Tidak terinstall atau terautentikasi</string>
    <string name="home_click_to_install">Klik untuk menginstal</string>
    <string name="home_patch_next_step">Langkah selanjutnya</string>
    <string name="home_not_installed">Tidak terinstal</string>
    <string name="home">Beranda</string>
    <string name="home_working">Berfungsi 😋</string>
    <string name="kpatch_version">Versi: %s</string>
    <string name="home_installing">Menginstal</string>
    <string name="apatch_version">Versi: %s</string>
    <string name="home_need_update">Versi terbaru tersedia</string>
    <string name="apatch_version_update">Versi: %s -&gt; %s</string>
    <string name="home_auth_key_title">Masukkan SuperKey</string>
    <string name="reboot_download">Reboot ke Download</string>
    <string name="home_auth_key_desc">Mulai setelah sertifikasi</string>
    <string name="home_ap_cando_update">Perbarui</string>
    <string name="home_ap_cando_uninstall">Hapus</string>
    <string name="home_ap_cando_install">Instal</string>
    <string name="home_apatch_version">Versi APatch</string>
    <string name="home_su_path">Binari SU</string>
    <string name="home_kernel">Kernel</string>
    <string name="home_manager_version">Versi manajer</string>
    <string name="patch_title">Patch</string>
    <string name="apm_uninstall_success">%s berhasil dihapus</string>
    <string name="apm_install">Instal</string>
    <string name="apm_remove">Hapus</string>
    <string name="apm_uninstall_confirm">Hapus modul \"%s\"?</string>
    <string name="apm_version">Versi</string>
    <string name="apm_overlay_fs_not_available">Modul tidak tersedia karena OverlayFS dinonaktifkan oleh kernel!</string>
    <string name="apm_uninstall_failed">Gagal menghapus %s</string>
    <string name="apm_magisk_conflict">Modul tidak tersedia karena ada konflik dengan Magisk!</string>
    <string name="apm_desc">Ket.</string>
    <string name="apm_empty">Tidak ada modul terinstal</string>
    <string name="apm_author">Oleh</string>
    <string name="apm_reboot_to_apply">Reboot untuk menerapkan</string>
    <string name="apm_start_downloading">Mulai mengunduh %s</string>
    <string name="kpm_desc">Ket.</string>
    <string name="su_show_system_apps">Tampilkan aplikasi sistem</string>
    <string name="apm_changelog">Log perubahan</string>
    <string name="kpm_author">Oleh</string>
    <string name="apm_downloading">Modul %s sedang diunduh…</string>
    <string name="apm_new_version_available">Versi baru %s tersedia, klik untuk memperbarui.</string>
    <string name="apm_update">Membarui</string>
    <string name="su_refresh">Muat ulang</string>
    <string name="apm_failed_to_disable">Gagal menonaktifkan modul \"%s\"</string>
    <string name="apm_failed_to_enable">Gagal mengaktifkan modul \"%s\"</string>
    <string name="su_hide_system_apps">Sembunyikan aplikasi sistem</string>
    <string name="kpm_kp_not_installed">KernelPatch tidak terinstal</string>
    <string name="su_pkg_excluded_setting_title">Kecualikan modifikasi</string>
    <string name="su_pkg_excluded_setting_summary">Aktifkan opsi ini agar APatch dapat memulihkan kembali berkas yang termodifikasi oleh modul ini.</string>
    <string name="su_pkg_excluded_label">dikecualikan</string>
    <string name="su_title">SuperUser</string>
    <string name="su_selinux_via_hook">bypass via hook</string>
    <string name="kpm_version">Versi</string>
    <string name="home_selinux_status_unknown">Tidak diketahui</string>
    <string name="home_selinux_status_permissive">Permisif</string>
    <string name="home_selinux_status">Status SELinux</string>
    <string name="kpm_load_toast_failed">Gagal memuat</string>
    <string name="home_selinux_status_disabled">Dinonaktifkan</string>
    <string name="kpm_load">Muat</string>
    <string name="home_selinux_status_enforcing">Enforcing</string>
    <string name="kpm_license">Lisensi</string>
    <string name="kpm_load_toast_succ">Berhasil memuat</string>
    <string name="kpm_apm_empty">Tidak ada modul</string>
    <string name="kpm_unload_confirm">Lepas modul %s?</string>
    <string name="kpm_unload">Lepas</string>
    <string name="kpm_args">Argu</string>
    <string name="home_fingerprint">Identitas</string>
    <string name="clear_super_key">Hapus SuperKey</string>
    <string name="apm_not_installed">AndroidPatch tidak terinstal</string>
    <string name="settings_app_language">Bahasa</string>
    <string name="system_default">Bawaan sistem</string>
    <string name="patch">Patch</string>
    <string name="settings_global_namespace_mode_summary">Gunakan universal namespace ke semua root sesi</string>
    <string name="settings_global_namespace_mode">Mode universal namespace</string>
    <string name="settings_clear_super_key_dialog">Anda yakin untuk melanjutkan?</string>
    <string name="kpatch_version_update">Versi: %s -&gt; %s</string>
    <string name="home_kpatch_info_title">Info</string>
    <string name="home_ap_cando_reboot">Reboot</string>
    <string name="patch_config_title">Patch</string>
    <string name="patch_embed_kpm_btn">Tanam KPM</string>
    <string name="patch_mode_bootimg_patch">Mode: Patch</string>
    <string name="patch_select_bootimg_btn">Pilih boot</string>
    <string name="patch_start_patch_btn">Mulai</string>
    <string name="patch_item_error">!!GALAT!!</string>
    <string name="patch_mode_patch_and_install">Mode: Patch dan instal</string>
    <string name="patch_item_bootimg_dev">perangkat:</string>
    <string name="patch_item_kpimg_version">Versi:</string>
    <string name="patch_item_kpimg_comile_time">Waktu:</string>
    <string name="patch_item_kpimg_config">Konfigurasi:</string>
    <string name="patch_item_kernel">Kernel</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="patch_item_new_extra_kpm">Tanam baru</string>
    <string name="patch_item_existed_extra_kpm">Tertanam</string>
    <string name="patch_item_extra_name">Nama:</string>
    <string name="patch_item_extra_kpm_license">Lisensi:</string>
    <string name="patch_item_extra_kpm_desciption">Deskripsi:</string>
    <string name="patch_item_skey">SuperKey</string>
    <string name="patch_item_set_skey_label">SuperKey terdiri dari 8-63 karakter dan memuat huruf dan angka, tanpa memuat karakter spesial.</string>
    <string name="patch_item_extra_version">Versi:</string>
    <string name="patch_item_extra_author">Oleh:</string>
    <string name="patch_item_extra_args">Argu:</string>
    <string name="patch_item_bootimg">bootimg</string>
    <string name="patch_mode_uninstall_patch">Mode: Hapus KPatch</string>
    <string name="patch_start_unpatch_btn">UnPatch</string>
    <string name="patch_item_extra_event">Event:</string>
    <string name="patch_item_bootimg_slot">slot:</string>
    <string name="kpm_add_kpm">Tambah KPM</string>
    <string name="kpm_install">Pasang</string>
    <string name="kpm_embed">Tanam</string>
    <string name="hide_apatch_manager_failure">Gagal menyembunyikan. Tolong laporkan bug ini!</string>
    <string name="hide_apatch_manager_summary">Instal apl proksi dengan ID acak dan label kustom</string>
    <string name="hide_apatch_dialog_new_manager_name">Nama manajer baru</string>
    <string name="hide_apatch_manager">Sembunyikan manajer APatch</string>
    <string name="hide_apatch_dialog_summary">Digunakan sebagai nama aplikasi di peluncur</string>
    <string name="success">Berhasil</string>
    <string name="failure">Gagal</string>
    <string name="setting_reset_su_new_path">Jalur penuh baru</string>
    <string name="setting_reset_su_path">Reset jalur su</string>
    <string name="patch_mode_install_to_next_slot">Mode: Instal ke slot nonaktif (Setelah OTA)</string>
    <string name="settings_check_update_summary">Otomatis memeriksa pembaruan saat membuka manajer</string>
    <string name="apm_webui_open">Buka</string>
    <string name="home_dialog_auth_fail_title">Gagal mengautentikasi</string>
    <string name="home_more_menu_about">Tentang</string>
    <string name="mode_select_page_patch_and_install">Patch dan pasang</string>
    <string name="mode_select_page_select_file">Pilih Boot Image</string>
    <string name="home_more_menu_feedback_or_suggestion">Saran dan Masukan</string>
    <string name="mode_select_page_title">Pasang</string>
    <string name="mode_select_page_install_inactive_slot">Pasang ke slot tidak aktif (Setelah OTA)</string>
    <string name="home_kpatch_version">Versi KernelPatch</string>
    <string name="enable_web_debugging">Aktifkan debugging WebView</string>
    <string name="mode_select_page_install_inactive_slot_warning">Perangkat akan **DIPAKSA** untuk memulai ulang ke slot nonaktif!\nHanya gunakan opsi ini setelah proses OTA selesai.\nLanjutkan?</string>
    <string name="home_dialog_uninstall_title">Copot</string>
    <string name="home_dialog_uninstall_ap_only">Hapus AndroidPatch</string>
    <string name="home_dialog_uninstall_all">Copot semua</string>
    <string name="settings_check_update">Periksa pembaruan</string>
    <string name="home_install_unknown_summary">Klik untuk menginstal</string>
    <string name="home_device_info">Perangkat</string>
    <string name="home_system_version">Versi Sistem</string>
    <string name="home_dialog_auth_fail_content">Gagal mengautentikasi SuperKey, APatch tidak dapat berfungsi normal.\nHal ini dapat disebabkan oleh:\n1. Boot.img tidak di-patch dengan KernelPatch.\n2. Tidak menginstal/pasang boot.img yang sudah di-patch.\n3. Salah memasukkan atau terdapat karakter spesial pada SuperKey.\n4. Perangkat tidak mendukung APatch dan KernelPatch.\n\nCek dan coba kembali. Jika tetap gagal, dapat menanyakan pada laman permasalahan di repositori resmi kami.</string>
    <string name="enable_web_debugging_summary">Dapat digunakan untuk men-debug WebUI. Harap aktifkan hanya bila diperlukan.</string>
    <string name="settings_donot_store_superkey_summary">Autentikasi SuperKey setiap kali membuka manajer</string>
    <string name="settings_donot_store_superkey">Jangan simpan SuperKey secara lokal</string>
    <string name="home_new_apatch_found">Versi terbaru %s tersedia, klik untuk memperbarui.</string>
    <string name="kpm_control_failed">Operasi gagal!</string>
    <string name="settings_night_mode_follow_sys_summary">Beralih secara otomatis ke tema gelap berdasarkan bawaan sistem</string>
    <string name="settings_night_theme_enabled">Aktifkan tema gelap</string>
    <string name="settings_use_system_color_theme">Tema warna sistem</string>
    <string name="settings_use_system_color_theme_summary">Gunakan tema warna yang dihasilkan sistem berdasarkan wallpaper saat ini</string>
    <string name="settings_custom_color_theme">Warna tema</string>
    <string name="red_theme">Merah</string>
    <string name="sakura_theme">Merah muda sakura</string>
    <string name="teal_theme">Hijau kebiruan</string>
    <string name="kpm_control_dialog_title">KPModul Kontrol</string>
    <string name="amber_theme">Kuning ambar</string>
    <string name="blue_grey_theme">Biru abu-abu</string>
    <string name="cyan_theme">Sian</string>
    <string name="deep_orange_theme">Jingga gelap</string>
    <string name="green_theme">Hijau</string>
    <string name="light_blue_theme">Biru muda</string>
    <string name="light_green_theme">Hijau muda</string>
    <string name="pink_theme">Merah muda</string>
    <string name="kpm_control">Kontrol</string>
    <string name="about_app_version">Versi %1$s</string>
    <string name="about_powered_by">Didukung oleh %1$s</string>
    <string name="blue_theme">Biru</string>
    <string name="brown_theme">Cokelat</string>
    <string name="lime_theme">Limau</string>
    <string name="orange_theme">Jingga</string>
    <string name="indigo_theme">Nila</string>
    <string name="purple_theme">Ungu</string>
    <string name="kpm_control_dialog_content">Parameter kontrol input:</string>
    <string name="kpm_control_ok">Operasi berhasil!</string>
    <string name="deep_purple_theme">Ungu gelap</string>
    <string name="yellow_theme">Kuning</string>
    <string name="about_telegram_channel">Kanal Telegram</string>
    <string name="about_app_desc">Metode root dengan hanya menggunakan kernel image, memberikan kemampuan untuk memasang modul sistem dan mengaitkan fungsi kernel.</string>
    <string name="about_telegram_group">Grup Telegram</string>
    <string name="kpm_control_paramters">Parameter</string>
    <string name="kpm_control_outMsg">Pesan</string>
    <string name="settings_night_mode_follow_sys">Ikuti tema gelap dari sistem</string>
    <string name="save_log">Simpan log</string>
    <string name="apm_action">Tindakan</string>
    <string name="log_saved">Log disimpan</string>
    <string name="crash_handle_copy">Salin log kerusakan</string>
    <string name="crash_handle_title">Aplikasi telah berhenti…</string>
    <string name="crash_handle_copied">Log kerusakan telah disalin.</string>
    <string name="settings_lite_mode">Aktifkan Mode Lite</string>
    <string name="settings_lite_mode_mode_summary">APModule mungkin gagal berfungsi setelah diaktifkan, tapi terkadang masih tetap efektif dalam menghindari deteksi. Reboot diperlukan.</string>
    <string name="settings_force_overlayfs_mode">Penggunaan Paksa OverlayFS</string>
    <string name="settings_force_overlayfs_mode_summary">Jika kernel mendukung, APMount menggunakan OverlayFS dibandingkan MagicMount. Reboot dibutuhkan.</string>
</resources>

```

`app/src/main/res/values-it/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="apm_reboot_to_apply">Riavvia per rendere effettive le modifiche</string>
    <string name="android_patch">Patch di Android</string>
    <string name="kpm_unload_confirm">Rimuovi modulo \"%s\"?</string>
    <string name="apm_uninstall_success">%s disinstallato</string>
    <string name="send_log">Invia registro</string>
    <string name="apm_install">Installa</string>
    <string name="home_auth_key_desc">Avvia dopo la certificazione</string>
    <string name="kpatch_version">Versione: %s</string>
    <string name="apm_remove">Rimuovi</string>
    <string name="patch_warnning">L\'installazione comporta dei rischi. Assicurati che i tuoi dati siano stati salvati.</string>
    <string name="kpm_kp_not_installed">KernelPatch non installato</string>
    <string name="home_patch_set_key_desc">Credenziale solo per KernelPatch</string>
    <string name="home_install_unknown">Non installato o verificato</string>
    <string name="apm_uninstall_confirm">Disinstallare il modulo \"%s\"?</string>
    <string name="su_pkg_excluded_setting_title">Escludi modifiche</string>
    <string name="reboot_download">Riavvia in modalità Download</string>
    <string name="home_click_to_learn_apatch">Scopri le caratteristiche di APatch e come utilizzarlo</string>
    <string name="apm_version">Versione</string>
    <string name="su_pkg_excluded_setting_summary">Abilita questa opzione per permettere ad APatch di ripristinare qualsiasi file modificato dai moduli per questa applicazione.</string>
    <string name="reboot_edl">Riavvia in modalità EDL</string>
    <string name="home_installing">Installazione in corso</string>
    <string name="apm_start_downloading">Download di %s avviato</string>
    <string name="su_selinux_via_hook">Aggira tramite hook</string>
    <string name="home_ap_cando_uninstall">Disinstalla</string>
    <string name="apatch_version">Versione: %s</string>
    <string name="apm_overlay_fs_not_available">I moduli non sono disponibili poiché OverlayFS è disabilitato dal kernel</string>
    <string name="kpm_version">Versione</string>
    <string name="su_refresh">Ricarica</string>
    <string name="safe_mode">Modalità provvisoria</string>
    <string name="su_show_system_apps">Mostra app di sistema</string>
    <string name="home_ap_cando_install">Installa</string>
    <string name="reboot_recovery">Riavvia in Recovery</string>
    <string name="home_learn_apatch">Scopri APatch</string>
    <string name="apm_failed_to_disable">Impossibile disabilitare il modulo \"%s\"</string>
    <string name="kernel_patch">Patch di Kernel</string>
    <string name="home_click_to_install">Clicca per installare</string>
    <string name="home_selinux_status_unknown">Sconosciuto</string>
    <string name="about">Informazioni</string>
    <string name="reboot">Riavvio completo</string>
    <string name="home_need_update">Nuova versione disponibile</string>
    <string name="home_selinux_status">Stato di SELinux</string>
    <string name="apm_uninstall_failed">Impossibile disinstallare %s</string>
    <string name="kpm_author">Autore</string>
    <string name="apm_failed_to_enable">Impossibile abilitare il modulo \"%s\"</string>
    <string name="home">Home</string>
    <string name="patch_set_superkey">Imposta Superchiave</string>
    <string name="apm_downloading">Download del modulo \"%s\" in corso…</string>
    <string name="su_hide_system_apps">Nascondi app di sistema</string>
    <string name="apm_magisk_conflict">I moduli non sono disponibili a causa di un conflitto con Magisk!</string>
    <string name="home_ap_cando_update">Aggiorna</string>
    <string name="kpm_load_toast_failed">Caricamento fallito</string>
    <string name="home_selinux_status_disabled">Spento</string>
    <string name="settings">Impostazioni</string>
    <string name="apm_new_version_available">Clicca per installare la nuova versione %s.</string>
    <string name="apatch_version_update">Versione: %s -&gt; %s</string>
    <string name="home_working">In esecuzione 😋</string>
    <string name="apm_empty">Nessun modulo installato</string>
    <string name="kpm_load">Carica</string>
    <string name="home_patch_next_step">Avanti</string>
    <string name="home_auth_key_title">Inserisci Superchiave</string>
    <string name="apm_update">Aggiorna</string>
    <string name="home_not_installed">Non installato</string>
    <string name="kpm_license">Licenza</string>
    <string name="reboot_bootloader">Riavvia in modalità Bootloader</string>
    <string name="kpm_apm_empty">Nessun modulo caricato</string>
    <string name="about_source_code">&lt;![CDATA[&lt;p&gt;Visualizza codice sorgente %1$s&lt;p/&gt; Unisci il nostro %2$s canale &lt;p/&gt; Unisci il nostro %3$s gruppo]]] &gt;</string>
    <string name="home_manager_version">Versione del gestore</string>
    <string name="kpm_load_toast_succ">Caricamento riuscito</string>
    <string name="apm_author">Autore</string>
    <string name="su_pkg_excluded_label">escludi</string>
    <string name="su_title">Superutente</string>
    <string name="kpm_desc">Descrizione</string>
    <string name="kpm_args">Argomenti</string>
    <string name="home_fingerprint">Impronta digitale</string>
    <string name="apm_desc">Descrizione</string>
    <string name="kpm_unload">Rimuovi</string>
    <string name="home_kernel">Versione Kernel</string>
    <string name="home_selinux_status_enforcing">Rinforzo</string>
    <string name="patch_title">Applica una patch</string>
    <string name="home_apatch_version">Versione di APatch</string>
    <string name="home_selinux_status_permissive">Permissivo</string>
    <string name="apm_changelog">Registro delle modifiche</string>
    <string name="home_su_path">Eseguibile su</string>
    <string name="apm">APModule</string>
    <string name="super_key">Superchiave</string>
    <string name="app_name" translatable="false">APatch</string>
    <string name="kpm">KPModule</string>
    <string name="clear_super_key">Elimina Superchiave</string>
    <string name="apm_not_installed">AndroidPatch non installato</string>
    <string name="system_default">Predefinito di sistema</string>
    <string name="settings_app_language">Lingua</string>
    <string name="patch">Applica una patch</string>
    <string name="settings_global_namespace_mode">Modalità namespace globale</string>
    <string name="settings_global_namespace_mode_summary">Tutte le sessioni di root erediteranno il namespace globale</string>
    <string name="settings_check_update">Controlla aggiornamenti</string>
    <string name="home_ap_cando_reboot">Riavvia</string>
    <string name="patch_config_title">Patch</string>
    <string name="patch_mode_uninstall_patch">Modalità: Disinstalla KPatch</string>
    <string name="patch_item_bootimg_slot">Slot:</string>
    <string name="patch_embed_kpm_btn">Incorpora KPM</string>
    <string name="patch_mode_patch_and_install">Modalità: Applica patch e installa</string>
    <string name="mode_select_page_select_file">Seleziona un’immagine di avvio a cui applicare la patch</string>
    <string name="patch_item_kpimg_comile_time">Tempo:</string>
    <string name="patch_item_extra_kpm_desciption">Descrizione:</string>
    <string name="patch_item_kernel">Kernel</string>
    <string name="patch_item_kpimg">Kpimg</string>
    <string name="patch_item_kpimg_version">Versione:</string>
    <string name="patch_item_new_extra_kpm">Incorpora nuovo</string>
    <string name="patch_item_existed_extra_kpm">Esistito</string>
    <string name="mode_select_page_install_inactive_slot_warning">Il dispositivo sarà **FORZATO** ad avviarsi nello slot inattivo dopo il riavvio!
\nUsa questa opzione solo dopo l\'OTA.
\nContinuare?</string>
    <string name="home_dialog_auth_fail_title">Autenticazione fallita</string>
    <string name="home_system_version">Versione di sistema</string>
    <string name="home_install_unknown_summary">Clicca per installare</string>
    <string name="home_device_info">Dispositivo</string>
    <string name="home_kpatch_version">Versione di KernelPatch</string>
    <string name="kpm_add_kpm">Aggiungi KPM</string>
    <string name="hide_apatch_manager_summary">Installa una nuova app di gestione con un ID pacchetto casuale e nome applicazione personalizzato</string>
    <string name="setting_reset_su_new_path">Nuovo percorso</string>
    <string name="home_new_apatch_found">Clicca per aggiornare alla nuova versione disponibile %s</string>
    <string name="mode_select_page_title">Installa</string>
    <string name="mode_select_page_patch_and_install">Applica patch e installa</string>
    <string name="kpm_embed">Incorpora</string>
    <string name="mode_select_page_install_inactive_slot">Installa nello slot inattivo (dopo OTA)</string>
    <string name="settings_donot_store_superkey">Non memorizzare la SuperKey in locale</string>
    <string name="patch_start_patch_btn">Inizia</string>
    <string name="kpatch_shadow_path_title">Kpatch</string>
    <string name="patch_item_kpimg_config">Configurazione:</string>
    <string name="hide_apatch_dialog_new_manager_name">Nuovo nome del gestore</string>
    <string name="settings_check_update_summary">Cerca aggiornamenti automaticamente all\'avvio dell\'app</string>
    <string name="patch_mode_install_to_next_slot">Modalità: Installa nello slot successivo (Dopo OTA)</string>
    <string name="enable_web_debugging">Attiva debug di WebView</string>
    <string name="settings_donot_store_superkey_summary">Richiedi la SuperKey ogni volta che il gestore viene avviato</string>
    <string name="patch_item_extra_version">Versione:</string>
    <string name="patch_item_extra_author">Autore:</string>
    <string name="patch_item_extra_event">Evento:</string>
    <string name="patch_item_extra_kpm_license">Licenza:</string>
    <string name="patch_item_bootimg_dev">Dispositivo:</string>
    <string name="patch_select_bootimg_btn">Seleziona avvio</string>
    <string name="hide_apatch_manager_failure">Errore nel nascondere l\'app, per favore segnala il bug!</string>
    <string name="kpm_install">Installa</string>
    <string name="patch_item_extra_args">Argomenti:</string>
    <string name="patch_item_skey">Super chiave</string>
    <string name="hide_apatch_dialog_summary">Sarà usato come nome dell\'applicazione mostrato nel launcher</string>
    <string name="failure">Fallimento</string>
    <string name="patch_item_bootimg">Bootimg</string>
    <string name="patch_start_unpatch_btn">Rimuovi patch</string>
    <string name="patch_item_set_skey_label">La super chiave dovrebbe essere di almeno 8 caratteri e includere sia numeri sia lettere, ma non caratteri speciali</string>
    <string name="setting_reset_su_path">Reimposta il percorso su</string>
    <string name="home_kpatch_info_title">Informazioni</string>
    <string name="settings_clear_super_key_dialog">Sei sicuro di voler procedere?</string>
    <string name="kpatch_version_update">Versione: %s -&gt; %s</string>
    <string name="apm_webui_open">Apri</string>
    <string name="enable_web_debugging_summary">Può essere usato per il Debug di WebUI, attiva solo se necessario.</string>
    <string name="patch_mode_bootimg_patch">Modalità: Applica patch</string>
    <string name="patch_item_error">!!ERRORE!!</string>
    <string name="patch_item_extra_name">Nome:</string>
    <string name="hide_apatch_manager">Nascondi il gestore di APatch</string>
    <string name="success">Successo</string>
    <string name="kpm_control_dialog_content">Parametri di controllo dell\'ingresso:</string>
    <string name="kpm_control_ok">Operazione riuscita!</string>
    <string name="settings_night_mode_follow_sys">Segui il Tema scuro di sistema</string>
    <string name="home_dialog_auth_fail_content">Impossibile autenticare la Super chiave, APatch non può funzionare correttamente.\nEcco alcuni possibili motivi per il fallimento dell\'autenticazione:\n1. Non hai applicato la patch all\'immagine di avvio con KernelPatch.\n2. L\'immagine di avvio con patch non è stata installata.\n3. Errata Super chiave.\n4. Il dispositivo non supporta APatch e KernelPatch.\nControlla e riprova. Se ci sono ancora problemi, puoi sempre fare domande sulla pagina dei problemi del repository ufficiale.</string>
    <string name="kpm_control_paramters">Parametri</string>
    <string name="settings_night_mode_follow_sys_summary">Passa automaticamente al Tema scuro usando le impostazioni di sistema</string>
    <string name="home_more_menu_about">Chi siamo</string>
    <string name="home_dialog_uninstall_title">Disinstalla</string>
    <string name="kpm_control">Controllo</string>
    <string name="home_more_menu_feedback_or_suggestion">Riscontro o suggerimento</string>
    <string name="home_dialog_uninstall_ap_only">Rimuovi AndroidPatch</string>
    <string name="home_dialog_uninstall_all">Disinstallare tutti</string>
    <string name="kpm_control_dialog_title">Controlla KPModule</string>
    <string name="kpm_control_outMsg">Messaggio</string>
    <string name="kpm_control_failed">Operazione fallita!</string>
    <string name="settings_night_theme_enabled">Abilita il Tema scuro</string>
    <string name="settings_use_system_color_theme">Colore del Tema di sistema</string>
    <string name="settings_use_system_color_theme_summary">Usa un colore generato dallo sfondo di sistema attuale</string>
    <string name="settings_custom_color_theme">Colore</string>
    <string name="amber_theme">Tema ambra</string>
    <string name="blue_grey_theme">Tema grigio blu</string>
    <string name="blue_theme">Tema blu</string>
    <string name="brown_theme">Tema marrone</string>
    <string name="cyan_theme">Tema ciano</string>
    <string name="deep_orange_theme">Tema arancione scuro</string>
    <string name="deep_purple_theme">Tema viola scuro</string>
    <string name="green_theme">Tema verde</string>
    <string name="indigo_theme">Tema indaco</string>
    <string name="light_blue_theme">Tema azzurro</string>
    <string name="light_green_theme">Tema verde chiaro</string>
    <string name="lime_theme">Tema lime</string>
    <string name="orange_theme">Tema arancione</string>
    <string name="pink_theme">Tema rosa</string>
    <string name="purple_theme">Tema viola</string>
    <string name="red_theme">Tema rosso</string>
    <string name="sakura_theme">Sakura</string>
    <string name="teal_theme">Tema verde acqua</string>
    <string name="yellow_theme">Tema giallo</string>
    <string name="about_app_version">Versione %1$s</string>
    <string name="about_app_desc">Soluzione Kernel Root con solo un\'immagine del kernel ridotta, che offre la possibilità di montare il modulo di sistema e agganciare la funzione kernel.</string>
    <string name="about_telegram_channel">Canale Telegram</string>
    <string name="about_telegram_group">Gruppo Telegram</string>
    <string name="save_log">Salva registro</string>
    <string name="about_powered_by">Gestito da %1$s</string>
    <string name="crash_handle_copied">Copia contenuto del registro di arresto anomalo negli appunti</string>
    <string name="log_saved">Registri salvati</string>
    <string name="crash_handle_title">App chiusa in modo anomalo..</string>
    <string name="crash_handle_copy">Copia registro di arresto anomalo</string>
    <string name="apm_action">Azione</string>
    <string name="settings_lite_mode">Abilita la modalità Lite</string>
    <string name="settings_lite_mode_mode_summary">Le funzioni APModule potrebbero presentare errori dopo essere state abilitate, ma in alcuni casi possono comunque eludere efficacemente il rilevamento. Riavvio richiesto.</string>
    <string name="settings_force_overlayfs_mode">Forza l\'uso di OverlayFS</string>
    <string name="settings_force_overlayfs_mode_summary">Utilizzare OverlayFS per montare gli APModuli invece di Magic Mount quando il supporto del kernel è disponibile. Riavviare il sistema.</string>
</resources>

```

`app/src/main/res/values-ja/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="home">ホーム</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="kpm_unload_confirm">モジュール \"%s\" をアンロードしますか？</string>
    <string name="home_auth_key_desc">認証後に開始</string>
    <string name="patch_warnning">インストールにはリスクが伴います。データがバックアップされていることを確認してください。</string>
    <string name="home_patch_set_key_desc">KernelPatch の資格情報のみ</string>
    <string name="reboot_download">ダウンロードモードへ再起動</string>
    <string name="home_click_to_learn_apatch">APatch の機能と使い方はこちら</string>
    <string name="reboot_edl">EDL モードへ再起動</string>
    <string name="home_learn_apatch">APatch について</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="home_need_update">新しいバージョンが利用可能</string>
    <string name="settings">設定</string>
    <string name="about_source_code"><![CDATA[<p>%1$s でソースコードを表示<p>%2$s チャンネルに参加する<p/>%3$s グループに参加する]]></string>
    <string name="home_manager_version">アプリのバージョン</string>
    <string name="reboot">再起動</string>
    <string name="reboot_recovery">リカバリーへ再起動</string>
    <string name="reboot_bootloader">ブートローダーへ再起動</string>
    <string name="safe_mode">セーフモード</string>
    <string name="about">APatch について</string>
    <string name="home_patch_next_step">次へ</string>
    <string name="home_not_installed">未インストール</string>
    <string name="send_log">ログを送信</string>
    <string name="super_key">SuperKey</string>
    <string name="patch_set_superkey">SuperKey を設定</string>
    <string name="home_installing">インストール中</string>
    <string name="home_auth_key_title">SuperKey を入力</string>
    <string name="kpm_kp_not_installed">KernelPatch はインストールされていません</string>
    <string name="kpm_load">ロード</string>
    <string name="kpm_author">著者</string>
    <string name="kpm_desc">説明</string>
    <string name="su_title">スーパーユーザー</string>
    <string name="kpm_license">ライセンス</string>
    <string name="su_pkg_excluded_label">除外</string>
    <string name="apm_version">バージョン</string>
    <string name="apm_update">アップデート</string>
    <string name="home_install_unknown">不明</string>
    <string name="home_click_to_install">タップしてインストール</string>
    <string name="home_working">動作中 😋</string>
    <string name="home_ap_cando_install">インストール</string>
    <string name="home_ap_cando_update">アップデート</string>
    <string name="home_ap_cando_uninstall">アンインストール</string>
    <string name="home_kernel">カーネル</string>
    <string name="home_fingerprint">Fingerprint</string>
    <string name="home_selinux_status">SELinux の状態</string>
    <string name="home_selinux_status_unknown">Unknown</string>
    <string name="kpm_load_toast_succ">ロード成功</string>
    <string name="kpm_load_toast_failed">ロード失敗</string>
    <string name="kpm_version">バージョン</string>
    <string name="su_pkg_excluded_setting_summary">このオプションを有効にすると、APatch はこのアプリのモジュールによって変更されたすべてのファイルを復元できるようになります。</string>
    <string name="su_show_system_apps">システムアプリを表示</string>
    <string name="su_refresh">更新</string>
    <string name="apm_not_installed">AndroidPatch はインストールされていません</string>
    <string name="apm_remove">アンインストール</string>
    <string name="apm_install">インストール</string>
    <string name="apm_author">制作者</string>
    <string name="apm_desc">説明</string>
    <string name="apm_overlay_fs_not_available">カーネルによって OverlayFS が無効なため、モジュールを使用できません。</string>
    <string name="apm_reboot_to_apply">再起動して適用する</string>
    <string name="apm_changelog">変更履歴</string>
    <string name="kpatch_version">バージョン: %s</string>
    <string name="apatch_version">バージョン: %s</string>
    <string name="apatch_version_update">バージョン: %s → %s</string>
    <string name="home_su_path">su</string>
    <string name="home_selinux_status_disabled">無効</string>
    <string name="clear_super_key">SuperKey を消去</string>
    <string name="patch_title">パッチ</string>
    <string name="home_selinux_status_enforcing">Enforcing</string>
    <string name="su_pkg_excluded_setting_title">変更の除外</string>
    <string name="su_hide_system_apps">システムアプリを非表示</string>
    <string name="home_apatch_version">APatch のバージョン</string>
    <string name="home_selinux_status_permissive">Permissive</string>
    <string name="patch">パッチ</string>
    <string name="settings_app_language">言語</string>
    <string name="system_default">システムのデフォルト</string>
    <string name="settings_global_namespace_mode">グローバル名前空間モード</string>
    <string name="settings_global_namespace_mode_summary">すべての root セッションはグローバルマウント名前空間を使用します</string>
    <string name="kpm_args">パラメータ</string>
    <string name="kpm_apm_empty">ロードされたモジュールはありません</string>
    <string name="kpm_unload">アンロード</string>
    <string name="apm_empty">インストールされたモジュールはありません</string>
    <string name="settings_clear_super_key_dialog">本当に続行しますか？</string>
    <string name="kpatch_version_update">バージョン: %s → %s</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="home_ap_cando_reboot">再起動</string>
    <string name="patch_config_title">パッチ</string>
    <string name="patch_mode_bootimg_patch">モード: パッチ</string>
    <string name="patch_mode_patch_and_install">モード: パッチしてインストール</string>
    <string name="patch_mode_uninstall_patch">モード: KPatch をアンインストール</string>
    <string name="patch_select_bootimg_btn">boot.img を選択</string>
    <string name="patch_start_unpatch_btn">パッチ解除</string>
    <string name="patch_embed_kpm_btn">KPM を組み込む</string>
    <string name="patch_start_patch_btn">開始</string>
    <string name="kpm">KPModule</string>
    <string name="apm">APModule</string>
    <string name="apm_uninstall_confirm">\"%s\" モジュールをアンインストールしますか？</string>
    <string name="apm_uninstall_failed">%s をアンインストールできませんでした</string>
    <string name="apm_failed_to_disable">\"%s\" モジュールをオフにできませんでした</string>
    <string name="apm_new_version_available">新しいバージョン %s が利用可能です。クリックしてアップグレードしてください。</string>
    <string name="su_selinux_via_hook">フックによるバイパス</string>
    <string name="home_kpatch_info_title">情報</string>
    <string name="patch_item_error">!!エラー!!</string>
    <string name="patch_item_bootimg">bootimg</string>
    <string name="patch_item_bootimg_dev">デバイス:</string>
    <string name="patch_item_kernel">カーネル</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_kpimg_version">バージョン:</string>
    <string name="patch_item_bootimg_slot">スロット:</string>
    <string name="patch_item_extra_args">引数:</string>
    <string name="patch_item_extra_name">名前:</string>
    <string name="patch_item_extra_version">バージョン:</string>
    <string name="patch_item_new_extra_kpm">新たに組み込む</string>
    <string name="patch_item_existed_extra_kpm">設定済</string>
    <string name="patch_item_extra_event">イベント:</string>
    <string name="patch_item_skey">SuperKey</string>
    <string name="patch_item_extra_author">制作者:</string>
    <string name="patch_item_extra_kpm_desciption">説明:</string>
    <string name="patch_item_set_skey_label">SuperKey の長さは 8 ～ 63 文字で、数字と文字を含めることができますが、特殊文字は使用できません。</string>
    <string name="apm_failed_to_enable">\"%s\" モジュールをオンにできませんでした</string>
    <string name="apm_uninstall_success">%s をアンインストールしました</string>
    <string name="apm_start_downloading">%s のダウンロードを開始</string>
    <string name="apm_downloading">\"%s\" モジュールをダウンロード中…</string>
    <string name="apm_magisk_conflict">Magisk と競合したためモジュールを使用できません。</string>
    <string name="patch_item_kpimg_comile_time">時間:</string>
    <string name="patch_item_kpimg_config">構成:</string>
    <string name="patch_item_extra_kpm_license">ライセンス:</string>
    <string name="settings_check_update">アップデートを確認</string>
    <string name="hide_apatch_manager_summary">ランダムなパッケージIDとカスタムアプリラベルでプロキシアプリをインストールする</string>
    <string name="hide_apatch_manager">APatchマネージャーを隠す</string>
    <string name="settings_check_update_summary">アプリを開いたときに自動でアップデートを確認する</string>
    <string name="kpm_install">インストール</string>
    <string name="kpm_embed">埋め込む</string>
    <string name="hide_apatch_manager_failure">アプリを隠すことに失敗しました。バグを報告してください</string>
    <string name="home_install_unknown_summary">タップしてインストール</string>
    <string name="setting_reset_su_path">su パスをリセット</string>
    <string name="apm_webui_open">開く</string>
    <string name="patch_mode_install_to_next_slot">モード: 非アクティブ スロットにインストール (OTA 後)</string>
    <string name="home_device_info">デバイス</string>
    <string name="home_system_version">システムのバージョン</string>
    <string name="home_kpatch_version">KernelPatch バージョン</string>
    <string name="success">成功</string>
    <string name="failure">失敗</string>
    <string name="hide_apatch_dialog_summary">これはランチャーに表示される新しいアプリ名として使用されます</string>
    <string name="home_dialog_uninstall_all">全てアンインストール</string>
    <string name="kpm_add_kpm">KPM を追加</string>
    <string name="kpm_control">コントロール</string>
    <string name="hide_apatch_dialog_new_manager_name">新しいマネージャー名</string>
    <string name="setting_reset_su_new_path">新しいフルパス</string>
    <string name="enable_web_debugging">WebView デバッグを有効</string>
    <string name="settings_donot_store_superkey_summary">マネージャーの起動時に SuperKey を認証します</string>
    <string name="home_new_apatch_found">新バージョンが利用可能です: %s タップしてアップデート</string>
    <string name="mode_select_page_title">インストール</string>
    <string name="enable_web_debugging_summary">Web UI のデバッグに使用できます。必要な場合のみ有効にしてください。</string>
    <string name="mode_select_page_patch_and_install">パッチをしてインストール</string>
    <string name="mode_select_page_install_inactive_slot_warning">デバイスは再起動後、**強制的に**アクティブでないスロットにブートされます。
\nこのオプションは、OTA が完了した後のみ使用してください。
\n続行しますか？</string>
    <string name="home_dialog_auth_fail_content">SuperKey の認証に失敗したため、APatchは正しく動作しません。 \n以下の理由が考えられます: \n1. KernelPatch で\"boot.img\"をパッチしていない。 \n2. パッチを適用した\"boot.img\"をフラッシュしていない。 \n3. SuperKey が間違っている。 \n4. デバイスが APatch と KernelPatch に対応していない。 \n \n再度確認して、もう一度お試しください。問題が解決しない場合は、公式リポジトリの Issue ページで質問をして下さい。</string>
    <string name="home_dialog_uninstall_ap_only">APatch をアンインストール</string>
    <string name="mode_select_page_select_file">パッチするブートイメージを選択</string>
    <string name="mode_select_page_install_inactive_slot">非アクティブなスロットにインストール (OTA 後)</string>
    <string name="home_dialog_auth_fail_title">認証失敗</string>
    <string name="home_more_menu_feedback_or_suggestion">フィードバック / 提案</string>
    <string name="home_dialog_uninstall_title">アンインストール</string>
    <string name="kpm_control_dialog_title">KPModule の管理</string>
    <string name="kpm_control_paramters">パラメータ</string>
    <string name="settings_night_theme_enabled">ダークテーマを有効化</string>
    <string name="blue_theme">ブルー</string>
    <string name="brown_theme">ブラウン</string>
    <string name="deep_orange_theme">ディープオレンジ</string>
    <string name="cyan_theme">シアン</string>
    <string name="deep_purple_theme">ディープパープル</string>
    <string name="light_green_theme">ライトグリーン</string>
    <string name="lime_theme">ライム</string>
    <string name="indigo_theme">インディゴ</string>
    <string name="light_blue_theme">ライトブルー</string>
    <string name="purple_theme">パープル</string>
    <string name="save_log">ログを保存</string>
    <string name="settings_donot_store_superkey">ローカルにスーパーキーを保存しない</string>
    <string name="home_more_menu_about">APatch について</string>
    <string name="settings_use_system_color_theme">ダイナミックテーマ</string>
    <string name="settings_night_mode_follow_sys">システムテーマに従う</string>
    <string name="settings_custom_color_theme">カラーテーマ</string>
    <string name="amber_theme">アンバー</string>
    <string name="blue_grey_theme">ブルーグレー</string>
    <string name="green_theme">グリーン</string>
    <string name="orange_theme">オレンジ</string>
    <string name="pink_theme">ピンク</string>
    <string name="red_theme">レッド</string>
    <string name="sakura_theme">サクラ</string>
    <string name="teal_theme">ティール</string>
    <string name="yellow_theme">イエロー</string>
    <string name="about_app_version">バージョン %1$s</string>
    <string name="about_telegram_channel">Telegram チャンネル</string>
    <string name="about_telegram_group">Telegram グループ</string>
    <string name="about_powered_by">Powered by %1$s</string>
    <string name="kpm_control_ok">操作は成功しました！</string>
    <string name="kpm_control_outMsg">メッセージ</string>
    <string name="kpm_control_failed">操作は失敗しました！</string>
    <string name="settings_night_mode_follow_sys_summary">システム設定を元に自動でダークテーマに切り替える</string>
    <string name="settings_use_system_color_theme_summary">現在設定している壁紙からシステムによって生成されたカラーテーマを使用する</string>
    <string name="about_app_desc">削除されたカーネルイメージのみを持つカーネルルートソリューションは、システムモジュールをマウントし、カーネル機能をフックする機能を提供します。</string>
    <string name="kpm_control_dialog_content">入力制御変数:</string>
    <string name="apm_action">アクション</string>
    <string name="log_saved">ログを保存しました</string>
    <string name="crash_handle_copy">クラッシュログをコピー</string>
    <string name="crash_handle_copied">クラッシュ ログをクリップボードにコピーしました。</string>
    <string name="crash_handle_title">アプリがクラッシュしました。</string>
    <string name="settings_lite_mode">Liteモードを有効にする</string>
    <string name="settings_lite_mode_mode_summary">APModuleの機能は、有効化された後に障害を示すことがあるが、場合によっては検出を効果的に回避することができる。再起動が必要です。</string>
    <string name="settings_force_overlayfs_mode">OverlayFSの使用を強制する</string>
    <string name="settings_force_overlayfs_mode_summary">カーネルのサポートが利用可能な場合、Magic Mountの代わりにOverlayFSを使用してAPModuleをマウントする。再起動が必要です。</string>
</resources>

```

`app/src/main/res/values-jv/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="reboot">Reboot</string>
    <string name="settings">Aturan</string>
    <string name="reboot_download">Mbalek nang Donlot</string>
    <string name="about_source_code">Delok kode sumber nang %1$s%1$sGabong saluran %2$s awakdewe</string>
    <string name="send_log">Kirem catatan</string>
    <string name="clear_super_key">Apos Kunci</string>
    <string name="patch_set_superkey">Set SuperKey</string>
    <string name="home">Omah</string>
    <string name="patch_warnning">Tindakan bahaya lur, backup data mu disek.</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="reboot_recovery">Mbalek nang Recovery</string>
    <string name="reboot_bootloader">Mbalek nang Bootloader</string>
    <string name="reboot_edl">Mbalek nang EDL</string>
    <string name="about">Tentang</string>
    <string name="home_learn_apatch">Sinau AndroidPatch</string>
    <string name="home_click_to_learn_apatch">Sinau fitur AndroidPatch lan coro ngunakno</string>
    <string name="safe_mode">Mode aman</string>
    <string name="super_key">SuperKey</string>
</resources>

```

`app/src/main/res/values-ko/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="home">홈</string>
    <string name="patch_warnning">설치에는 위험이 따릅니다. 데이터가 백업되었는지 확인하세요.</string>
    <string name="patch">패치</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="reboot">재시작</string>
    <string name="settings">설정</string>
    <string name="reboot_bootloader">부트로더로 재시작</string>
    <string name="reboot_download">다운로드 모드로 재부팅</string>
    <string name="reboot_edl">EDL로 재시작</string>
    <string name="about">정보</string>
    <string name="settings_app_language">언어</string>
    <string name="home_patch_set_key_desc">KernelPatch용 자격 증명</string>
    <string name="home_patch_next_step">다음 단계</string>
    <string name="home_not_installed">설치되지 않음</string>
    <string name="home_install_unknown">설치되지 않았거나 인증되지 않음</string>
    <string name="home_click_to_install">클릭하여 설치</string>
    <string name="home_working">작동 중 😋</string>
    <string name="home_installing">설치 중</string>
    <string name="home_need_update">새 버전 사용 가능</string>
    <string name="kpatch_version">버전: %s</string>
    <string name="apatch_version">버전: %s</string>
    <string name="apatch_version_update">버전: %s -&gt; %s</string>
    <string name="home_su_path">실행 가능한 su</string>
    <string name="home_apatch_version">APatch 버전</string>
    <string name="home_auth_key_title">SuperKey 입력</string>
    <string name="home_auth_key_desc">인증 후 시작하기</string>
    <string name="home_ap_cando_install">설치</string>
    <string name="home_ap_cando_update">업데이트</string>
    <string name="home_ap_cando_uninstall">제거</string>
    <string name="home_kernel">커널</string>
    <string name="home_manager_version">매니저 앱 버전</string>
    <string name="home_fingerprint">지문</string>
    <string name="home_selinux_status">SELinux 상태</string>
    <string name="home_selinux_status_disabled">끄기</string>
    <string name="home_selinux_status_enforcing">강제</string>
    <string name="home_selinux_status_permissive">허용</string>
    <string name="home_selinux_status_unknown">알 수 없음</string>
    <string name="kpm">KPModule</string>
    <string name="kpm_kp_not_installed">KernelPatch가 설치되지 않았습니다</string>
    <string name="kpm_load">불러오기</string>
    <string name="kpm_load_toast_failed">불러오기 실패</string>
    <string name="kpm_unload">제거</string>
    <string name="kpm_apm_empty">불러온 모듈이 없습니다</string>
    <string name="kpm_version">버전</string>
    <string name="kpm_license">라이선스</string>
    <string name="kpm_author">제작자</string>
    <string name="su_pkg_excluded_setting_summary">이 옵션을 활성화하면 APatch가 이 어플리케이션에 대한 모듈에 의해 수정된 파일을 복원할 수 있습니다.</string>
    <string name="su_show_system_apps">시스템 앱 표시</string>
    <string name="su_hide_system_apps">시스템 앱 숨기기</string>
    <string name="su_refresh">새로 고침</string>
    <string name="apm">APModule</string>
    <string name="apm_failed_to_disable">\"%s\" 모듈을 끌 수 없습니다</string>
    <string name="apm_empty">설치된 모듈이 없습니다</string>
    <string name="apm_remove">제거</string>
    <string name="apm_install">설치</string>
    <string name="apm_uninstall_confirm">\"%s\" 모듈을 제거하시겠습니까?</string>
    <string name="apm_uninstall_success">%s이 제거되었습니다</string>
    <string name="apm_uninstall_failed">%s 을 제거하지 못했습니다</string>
    <string name="apm_version">버전</string>
    <string name="apm_author">제작자</string>
    <string name="apm_overlay_fs_not_available">커널에 의해 OverlayFS가 비활성화되어 모듈을 사용할 수 없습니다.</string>
    <string name="system_default">시스템 기본값</string>
    <string name="home_click_to_learn_apatch">APatch의 기능 및 사용 방법 알아보기</string>
    <string name="about_source_code"><![CDATA[<p>%1$s에서 소스 코드 보기.<p/>%2$s 채널 참여<p/>%3$s 그룹 참여]]></string>
    <string name="safe_mode">안전 모드</string>
    <string name="kpm_load_toast_succ">불러오기 성공</string>
    <string name="home_learn_apatch">APatch 알아보기</string>
    <string name="send_log">로그 보내기</string>
    <string name="super_key">SuperKey</string>
    <string name="clear_super_key">SuperKey 지우기</string>
    <string name="patch_set_superkey">SuperKey 설정</string>
    <string name="patch_title">패치</string>
    <string name="su_title">슈퍼유저</string>
    <string name="reboot_recovery">리커버리로 재시작</string>
    <string name="su_selinux_via_hook">훅으로 우회하기</string>
    <string name="kpm_unload_confirm">\"%s\" 모듈을 제거하시겠습니까?</string>
    <string name="su_pkg_excluded_label">제외</string>
    <string name="su_pkg_excluded_setting_title">변경 제외</string>
    <string name="apm_not_installed">AndroidPatch가 설치되지 않음</string>
    <string name="apm_failed_to_enable">\"%s\" 모듈을 키지 못했습니다</string>
    <string name="apm_magisk_conflict">Magisk와 충돌이 발생해 모듈이 비활성화되었습니다.</string>
    <string name="apm_reboot_to_apply">적용하려면 재시작하세요</string>
    <string name="apm_changelog">변경 기록</string>
    <string name="apm_update">업데이트</string>
    <string name="apm_downloading">\"%s\"모듈 내려받는 중…</string>
    <string name="apm_start_downloading">%s 내려받기를 시작합니다</string>
    <string name="apm_new_version_available">새 버전 %s을 설치하려면 클릭하세요.</string>
    <string name="kpm_desc">설명</string>
    <string name="kpm_args">인수</string>
    <string name="apm_desc">설명</string>
    <string name="settings_global_namespace_mode">글로벌 네임스페이스 모드</string>
    <string name="settings_global_namespace_mode_summary">모든 루트 세션은 글로벌 마운트 세션을 사용합니다</string>
    <string name="settings_check_update">업데이트 확인</string>
    <string name="settings_check_update_summary">앱을 열 때 자동으로 업데이트 확인</string>
    <string name="home_kpatch_info_title">정보</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="patch_item_kpimg_comile_time">시간:</string>
    <string name="patch_mode_uninstall_patch">모드: KPatch 제거</string>
    <string name="patch_select_bootimg_btn">boot 선택</string>
    <string name="patch_item_existed_extra_kpm">이미 있음</string>
    <string name="patch_item_extra_name">이름:</string>
    <string name="patch_item_extra_kpm_license">라이선스:</string>
    <string name="patch_item_extra_author">제작자:</string>
    <string name="patch_item_set_skey_label">Super Key의 길이는 숫자와 문자를 포함하여 8자리 이상이여야 합니다</string>
    <string name="kpm_install">설치</string>
    <string name="kpm_embed">통합</string>
    <string name="hide_apatch_dialog_new_manager_name">새 관리자 이름</string>
    <string name="hide_apatch_manager_summary">무작위 패키지 ID와 맞춤 이름으로 관리자 앱 설치하기</string>
    <string name="patch_item_extra_kpm_desciption">설명:</string>
    <string name="home_new_apatch_found">새 버전 사용 가능: %s, 업그레이드하려면 클릭하세요</string>
    <string name="kpatch_version_update">버전: %s -&gt; %s</string>
    <string name="home_more_menu_about">정보</string>
    <string name="home_more_menu_feedback_or_suggestion">피드백 또는 제안</string>
    <string name="kpm_add_kpm">KPM 추가</string>
    <string name="home_install_unknown_summary">클릭하여 설치</string>
    <string name="mode_select_page_install_inactive_slot">비활성 슬롯에 설치 (OTA 이후)</string>
    <string name="mode_select_page_select_file">패치할 boot 이미지 선택</string>
    <string name="home_dialog_uninstall_title">제거</string>
    <string name="home_dialog_uninstall_all">전부 제거</string>
    <string name="patch_config_title">패치</string>
    <string name="patch_mode_patch_and_install">모드: 패치 및 설치</string>
    <string name="patch_item_extra_args">인자:</string>
    <string name="home_device_info">장치</string>
    <string name="home_kpatch_version">KernelPatch 버전</string>
    <string name="hide_apatch_manager">APatch 관리자 숨기기</string>
    <string name="hide_apatch_dialog_summary">런처에서 보여질 이름으로 사용됩니다</string>
    <string name="hide_apatch_manager_failure">숨길 수 없습니다. 버그를 제보해주세요!</string>
    <string name="settings_donot_store_superkey_summary">관리자가 시작할 때마다 SuperKey를 인증합니다</string>
    <string name="mode_select_page_patch_and_install">패치 및 설치</string>
    <string name="mode_select_page_install_inactive_slot_warning">재시작 후 기기가 비활성 슬롯으로 **강제** 부팅될 것 입니다!
\nOTA 이후에만 이 옵션을 사용하세요.
\n계속하시겠습니까?</string>
    <string name="home_dialog_uninstall_ap_only">AndroidPatch 제거</string>
    <string name="home_ap_cando_reboot">재시작</string>
    <string name="patch_mode_bootimg_patch">모드: 패치</string>
    <string name="patch_mode_install_to_next_slot">모드: 다음 를롯에 설치 (OTA 이후)</string>
    <string name="patch_item_kpimg_config">설정:</string>
    <string name="patch_item_new_extra_kpm">새로 통합</string>
    <string name="patch_item_extra_version">버전:</string>
    <string name="patch_item_extra_event">이벤트:</string>
    <string name="patch_item_skey">관리자 키</string>
    <string name="home_system_version">시스템 버전</string>
    <string name="mode_select_page_title">설치</string>
    <string name="home_dialog_auth_fail_title">인증 실패</string>
    <string name="home_dialog_auth_fail_content">SuperKey를 인증할 수 없어 APatch가 제대로 작동할 수 없습니다. \n다음은 인증 실패의 몇 가지 가능한 이유입니다: \n1. KernelPatch로 boot 이미지를 패치하지 않았습니다. \n2. 패치한 boot 이미지를 플래시하지 않았습니다. \n3. SuperKey가 틀림. \n4. 장치가 Apatch와 KernelPatch를 지원하지 않습니다. \n \n확인 후 다시 시도해주세요. 여전히 문제가 있는 경우 공식 repository의 issues 페이지에서 언제든지 질문할 수 있습니다.</string>
    <string name="patch_item_kernel">커널</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_kpimg_version">버전:</string>
    <string name="patch_embed_kpm_btn">KPM 통합</string>
    <string name="patch_start_patch_btn">시작</string>
    <string name="patch_start_unpatch_btn">패치 해제</string>
    <string name="patch_item_error">!!오류!!</string>
    <string name="patch_item_bootimg">bootimg</string>
    <string name="patch_item_bootimg_slot">슬롯:</string>
    <string name="patch_item_bootimg_dev">장치:</string>
    <string name="setting_reset_su_path">su 경로 초기화</string>
    <string name="apm_webui_open">열기</string>
    <string name="enable_web_debugging">WebView 디버깅 활성화</string>
    <string name="enable_web_debugging_summary">WebUI를 디버그할 때 사용할 수 있습니다. 필요한 경우에만 활성화하세요.</string>
    <string name="settings_donot_store_superkey">기기에 SuperKey 저장하지 않기</string>
    <string name="success">성공</string>
    <string name="failure">실패</string>
    <string name="settings_clear_super_key_dialog">정말로 계속하시겠습니까?</string>
    <string name="kpm_control_dialog_title">KPModule 제어</string>
    <string name="kpm_control_dialog_content">제어 매개 변수 입력:</string>
    <string name="kpm_control">제어</string>
    <string name="kpm_control_paramters">매개변수</string>
    <string name="kpm_control_outMsg">메시지</string>
    <string name="setting_reset_su_new_path">새 전체 경로</string>
    <string name="kpm_control_ok">작업 성공!</string>
    <string name="kpm_control_failed">작업 실패!</string>
    <string name="settings_night_mode_follow_sys">시스템의 어두운 테마 따르기</string>
    <string name="amber_theme">등색 테마</string>
    <string name="settings_use_system_color_theme">시스템 색상 테마</string>
    <string name="settings_use_system_color_theme_summary">시스템이 현재 배경화면으로 생성한 색상 테마 사용</string>
    <string name="settings_custom_color_theme">색상 테마</string>
    <string name="blue_grey_theme">블루그레이 테마</string>
    <string name="blue_theme">블루 테마</string>
    <string name="about_app_desc">제거된 커널 이미지만 있는 커널 루트 솔루션으로, 시스템 모듈을 마운트하고 커널 기능을 후크하는 기능을 제공합니다.</string>
    <string name="about_powered_by">%1$s로 구동됨</string>
    <string name="settings_night_mode_follow_sys_summary">시스템 설정에 따라 자동으로 어두운 테마로 전환</string>
    <string name="settings_night_theme_enabled">어두운 테마 사용</string>
    <string name="brown_theme">브라운 테마</string>
    <string name="cyan_theme">청록색 테마</string>
    <string name="deep_orange_theme">진한 오렌지 테마</string>
    <string name="deep_purple_theme">진한 퍼플 테마</string>
    <string name="green_theme">그린 테마</string>
    <string name="indigo_theme">남색 테마</string>
    <string name="light_blue_theme">라이트 블루 테마</string>
    <string name="light_green_theme">라이트 그린 테마</string>
    <string name="lime_theme">라임 테마</string>
    <string name="orange_theme">오렌지 테마</string>
    <string name="pink_theme">핑크 테마</string>
    <string name="purple_theme">퍼플 테마</string>
    <string name="red_theme">레드 테마</string>
    <string name="sakura_theme">벚꽃 테마</string>
    <string name="teal_theme">청록색 테마</string>
    <string name="yellow_theme">옐로우 테마</string>
    <string name="about_app_version">버전 %1$s</string>
    <string name="about_telegram_channel">Telegram 채널</string>
    <string name="about_telegram_group">Telegram 그룹</string>
    <string name="save_log">로그 저장</string>
    <string name="log_saved">로그 저장됨</string>
    <string name="crash_handle_title">앱 충돌됨...</string>
    <string name="crash_handle_copy">충돌 로그 복사</string>
    <string name="apm_action">동작</string>
    <string name="crash_handle_copied">충돌 로그가 클립보드에 복사됨.</string>
</resources>

```

`app/src/main/res/values-lt/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="patch_warnning">Diegimas rizikingas. Patikrinkite, kad turite atsarginę duomenų kopiją.</string>
    <string name="failure">Klaida</string>
    <string name="reboot">Perkrauti</string>
    <string name="home">Pagrindinis ekranas</string>
    <string name="success">Pavyko</string>
    <string name="settings">Nustatymai</string>
</resources>

```

`app/src/main/res/values-lv/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="success">Veiksmīgi</string>
    <string name="patch">Ielāps</string>
    <string name="reboot">Restartēt</string>
    <string name="settings">Iestatījumi</string>
    <string name="reboot_recovery">Restartēt uz Atkopšanas režīmu</string>
    <string name="reboot_download">Restartēt uz Lejupielādes režīmu</string>
    <string name="about">Par lietotni</string>
    <string name="home">Sākums</string>
    <string name="reboot_bootloader">Restartēt uz Sāknēšanas režīmu</string>
    <string name="reboot_edl">Restartēt uz EDL režīmu</string>
    <string name="settings_app_language">Valoda</string>
    <string name="safe_mode">Drošais režīms</string>
    <string name="home_installing">Uzstāda</string>
    <string name="home_not_installed">Nav uzstādīts</string>
    <string name="home_need_update">Pieejama jauna versija</string>
    <string name="kpatch_version">Versija: %s</string>
    <string name="apatch_version">Versija: %s</string>
    <string name="home_ap_cando_install">Uzstādīt</string>
    <string name="home_ap_cando_update">Atjaunināt</string>
    <string name="home_ap_cando_uninstall">Noņemt</string>
    <string name="home_ap_cando_reboot">Restartēt</string>
    <string name="patch_item_bootimg_dev">ierīce:</string>
    <string name="patch_item_kernel">Kodols</string>
    <string name="patch_item_kpimg_version">Versija:</string>
    <string name="patch_item_extra_name">Nosaukums:</string>
    <string name="patch_item_extra_version">Versija:</string>
    <string name="patch_item_extra_kpm_license">Licence:</string>
    <string name="patch_item_extra_kpm_desciption">Apraksts:</string>
    <string name="apm_remove">Noņemt</string>
    <string name="apm_update">Atjaunināt</string>
    <string name="cyan_theme">Ciāna</string>
    <string name="green_theme">Zaļš</string>
    <string name="light_blue_theme">Gaiši zils</string>
    <string name="pink_theme">Rozā</string>
    <string name="red_theme">Sarkans</string>
    <string name="teal_theme">Tumši ciāna (Zilganzaļa)</string>
    <string name="home_device_info">Ierīce</string>
    <string name="blue_theme">Zils</string>
    <string name="apm_changelog">Izmaiņu žurnāls</string>
    <string name="kpm_version">Versija</string>
    <string name="su_refresh">Atsvaidzināt</string>
    <string name="home_more_menu_about">Par lietotni</string>
    <string name="light_green_theme">Gaiši zaļš</string>
    <string name="kpm_license">Licence</string>
    <string name="apm_version">Versija</string>
    <string name="home_selinux_status_unknown">Nezināms</string>
    <string name="apm_webui_open">Atvērt</string>
    <string name="apm_install">Uzstādīt</string>
    <string name="mode_select_page_title">Uzstādīt</string>
    <string name="home_dialog_uninstall_title">Noņemt</string>
    <string name="brown_theme">Brūns</string>
    <string name="deep_orange_theme">Tumši oranžs</string>
    <string name="deep_purple_theme">Tumši violets</string>
    <string name="orange_theme">Oranžs</string>
    <string name="purple_theme">Violets</string>
    <string name="kpm_control_outMsg">Ziņojums</string>
    <string name="kpm_install">Uzstādīt</string>
    <string name="system_default">Sistēmas noklusējuma</string>
    <string name="patch_item_extra_author">Izstrādātājs:</string>
    <string name="home_selinux_status">SELinux statuss</string>
    <string name="home_selinux_status_disabled">Atspējots</string>
    <string name="home_apatch_version">APatch versija</string>
    <string name="kpm_load">Ielādēt</string>
    <string name="kpm_load_toast_succ">Veiksmīgi ielādēts</string>
    <string name="kpm_load_toast_failed">Neizdevās ielādēt</string>
    <string name="su_pkg_excluded_label">izslēgt, neiekļaut</string>
    <string name="home_manager_version">Pārvaldnieka versija</string>
    <string name="kpm_author">Izstrādātājs</string>
    <string name="apm_author">Izstrādātājs</string>
    <string name="yellow_theme">Dzeltens</string>
    <string name="about_app_version">Versija %1$s</string>
    <string name="lime_theme">Dzeltenzaļa, laima</string>
    <string name="settings_check_update">Pārbaudīt atjauninājumu</string>
    <string name="settings_clear_super_key_dialog">Vai tiešām vēlaties turpināt?</string>
</resources>

```

`app/src/main/res/values-ms/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="home">Halaman Utama</string>
    <string name="patch_warnning">Pemasangan datang dengan risiko. Sila pastikan anda telah membuat sandaran data.</string>
    <string name="reboot">But semula (Reboot)</string>
    <string name="settings">Tetapan</string>
    <string name="about">Perihal</string>
    <string name="home_learn_apatch">Ketahui tentang APatch</string>
    <string name="reboot_recovery">But semula ke Recovery</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="reboot_bootloader">But semula ke Bootloader</string>
    <string name="reboot_download">But semula ke Download</string>
    <string name="reboot_edl">But semula ke EDL</string>
    <string name="about_source_code">Lihat kod sumber di %1$s<br/>Sertai saluran kami di %2$s</string>
    <string name="send_log">Hantar log</string>
    <string name="safe_mode">Safe mode</string>
    <string name="super_key">SuperKey</string>
    <string name="clear_super_key">Clear Key</string>
    <string name="settings_app_language">Bahasa</string>
    <string name="home_click_to_learn_apatch">Ketahui tentang ciri-ciri APatch dan cara menggunakannya</string>
    <string name="system_default">Lalai sistem</string>
    <string name="home_installing">Memasang</string>
    <string name="apatch_version_update">Versi: %s -&gt; %s</string>
    <string name="home_patch_next_step">Langkah Seterusnya</string>
    <string name="home_not_installed">Tidak di pasang</string>
    <string name="home_install_unknown">Tidak diketahui</string>
    <string name="home_click_to_install">Tekan untuk pasang</string>
    <string name="home_need_update">Versi baharu tersedia</string>
    <string name="kpatch_version">Versi: %s</string>
    <string name="apatch_version">Versi: %s</string>
    <string name="home_install_unknown_summary">Tekan untuk pasang</string>
    <string name="success">Berjaya</string>
    <string name="failure">Gagal</string>
    <string name="settings_global_namespace_mode">Mod ruang nama global</string>
    <string name="settings_clear_super_key_dialog">Adakah anda benar-benar mahu meneruskan?</string>
    <string name="settings_check_update">Semak kemas kini</string>
    <string name="settings_check_update_summary">Semak kemas kini secara automatik apabila membuka aplikasi</string>
    <string name="kpm_desc">Penerangan</string>
    <string name="patch_item_error">!!RALAT!!</string>
    <string name="patch_start_unpatch_btn">Menanggalkan tampalan</string>
    <string name="patch_item_bootimg">Memuat semula</string>
    <string name="kpm_license">Lesen</string>
    <string name="kpm_author">Pengarang</string>
    <string name="save_log">Simpan Log</string>
    <string name="patch_set_superkey">Tetapkan SuperKey</string>
    <string name="home_patch_set_key_desc">Hanya kelayakan untuk KernelPatch</string>
    <string name="home_working">Sedang bekerja 😋</string>
    <string name="kpatch_version_update">Versi: %s -&gt; %s</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="home_auth_key_title">Masukkan SuperKey</string>
    <string name="home_auth_key_desc">Mula selepas pengesahan</string>
    <string name="home_kpatch_info_title">Info</string>
    <string name="home_ap_cando_install">Memuat turun</string>
    <string name="home_ap_cando_update">Kemas kini</string>
    <string name="home_ap_cando_uninstall">Nyahpasang</string>
    <string name="home_ap_cando_reboot">Mula semula</string>
    <string name="patch_title">Tampalan</string>
    <string name="patch_config_title">Tampalan</string>
    <string name="patch_mode_bootimg_patch">Mod: Tampalan</string>
    <string name="patch_mode_patch_and_install">Mod: Tampalan dan memuat turun</string>
    <string name="patch_mode_install_to_next_slot">Mod: Memuat turun pada slot seterusnya (selepas OTA)</string>
    <string name="patch_mode_uninstall_patch">Mod: Memadam ktampalan</string>
    <string name="patch_select_bootimg_btn">Pilih mula semula</string>
    <string name="patch_embed_kpm_btn">Benamkan KPM</string>
    <string name="patch_start_patch_btn">Mula</string>
    <string name="patch_item_bootimg_slot">slot:</string>
    <string name="kpm_version">Versi</string>
    <string name="patch">tampalan</string>
    <string name="apm_uninstall_failed">APatch</string>
    <string name="apm_uninstall_success">APatch</string>
    <string name="apm_install">APatch</string>
    <string name="apm_version">Versi</string>
    <string name="apm_update">Kemas kini</string>
</resources>

```

`app/src/main/res/values-nb-rNO/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="apm_desc">Beskrivelse</string>
    <string name="home">Hjem</string>
    <string name="kernel_patch">Kjerneoppdatering</string>
    <string name="settings">Innstillinger</string>
    <string name="about">Om</string>
    <string name="android_patch">Android oppdatering</string>
    <string name="reboot">Omstart</string>
    <string name="reboot_recovery">Omstart til gjenoppretting</string>
    <string name="reboot_bootloader">Omstart til oppstartslaster</string>
    <string name="reboot_edl">Omstart til EDL</string>
    <string name="home_learn_apatch">Lær deg APatch</string>
    <string name="send_log">Send loggen</string>
    <string name="home_click_to_learn_apatch">Lær mer om funksjonene i AndroidPatch og hvordan det brukes</string>
    <string name="safe_mode">Trygt modus</string>
    <string name="home_patch_next_step">Neste steg</string>
    <string name="home_click_to_install">Klikk for å installere</string>
    <string name="home_working">Arbeider</string>
    <string name="home_installing">Installerer</string>
    <string name="home_need_update">Ny versjon tilgjengelig</string>
    <string name="kpatch_version">Versjon: %s</string>
    <string name="apatch_version_update">Versjon: %s → %s</string>
    <string name="home_su_path">su: %s</string>
    <string name="home_auth_key_desc">Start kjøring etter sertifisering</string>
    <string name="home_ap_cando_install">Installer</string>
    <string name="home_kernel">Kjerne</string>
    <string name="home_ap_cando_update">Oppdater</string>
    <string name="patch_title">Feilfiks</string>
    <string name="home_manager_version">Manager-versjon</string>
    <string name="home_selinux_status_unknown">Ukjent</string>
    <string name="kpm_load">Last inn</string>
    <string name="kpm_load_toast_succ">Innlastet</string>
    <string name="kpm_kp_not_installed">KernelPatch ikke installert</string>
    <string name="kpm_author">Utvikler</string>
    <string name="kpm_desc">Beskrivelse</string>
    <string name="kpm_args">Argumenter</string>
    <string name="apm_remove">Avinstaller</string>
    <string name="home_ap_cando_uninstall">Avinstaller</string>
    <string name="home_fingerprint">Fingeravtrykk</string>
    <string name="home_selinux_status_enforcing">Påtvingende</string>
    <string name="home_selinux_status">SELinux-status</string>
    <string name="kpm_version">Versjon</string>
    <string name="home_selinux_status_disabled">Deaktivert</string>
    <string name="kpm_license">Lisens</string>
    <string name="su_title">Superbruker</string>
    <string name="su_show_system_apps">Vis systemprogrammer</string>
    <string name="apm_install">Installer</string>
    <string name="apm_author">Utvikler</string>
    <string name="su_refresh">Gjenoppfrisk</string>
    <string name="apm_uninstall_success">%s avinstallert</string>
    <string name="apm_version">Versjon</string>
    <string name="apm_changelog">Endringslogg</string>
    <string name="home_not_installed">Ikke installert</string>
    <string name="home_install_unknown">Ukjent</string>
    <string name="apm_start_downloading">Start nedlasting: %s</string>
    <string name="apatch_version">Versjon: %s</string>
    <string name="kpm_load_toast_failed">Innlasting mislyktes</string>
    <string name="patch_warnning">Installasjon medfører risiko. Forsikre deg om at dataen din er sikkerhetskopiert.</string>
    <string name="reboot_download">Start på nytt for å laste ned</string>
    <string name="about_source_code"><![CDATA[<p> Vis kildekoden %1$s<p/> Bli med på %2$s kanalen vår <p/> Bli med i%3$s igruppa vår]]></string>
    <string name="kpm_unload_confirm">Vil du laste ut modulen «%s»?</string>
    <string name="home_apatch_version">APatch: %s</string>
    <string name="su_pkg_excluded_setting_summary">Hvis du aktiverer dette alternativet, kan APatch gjenopprette filer som er endret av modulene i denne appen.</string>
    <string name="su_pkg_excluded_setting_title">Ekskluder modifikasjoner</string>
    <string name="home_selinux_status_permissive">Tilforlatelig</string>
    <string name="kpm_apm_empty">Ingen modul innlastet</string>
    <string name="su_hide_system_apps">Skjul systemprogrammer</string>
    <string name="apm_empty">Ingen modul installert</string>
    <string name="apm_uninstall_failed">Kunne ikke avinstallere: %s</string>
    <string name="apm_overlay_fs_not_available">OverlayFS er ikke tilgjengelig. Modulen kan ikke fungere.</string>
    <string name="clear_super_key">Fjern tast</string>
    <string name="home_kpatch_info_title">Info</string>
    <string name="kpatch_version_update">Versjon: %s → %s</string>
    <string name="success">Vellykket</string>
    <string name="home_device_info">Enhet</string>
    <string name="home_system_version">Systemversjon</string>
    <string name="mode_select_page_title">Installer</string>
    <string name="settings_app_language">Språk</string>
    <string name="home_ap_cando_reboot">Omstart</string>
    <string name="patch_item_extra_version">versjon:</string>
    <string name="home_kpatch_version">KernelPatch-versjon</string>
    <string name="kpm_install">Installer</string>
    <string name="apm_failed_to_enable">Kunne ikke skru på «%s»-modulen</string>
    <string name="apm_failed_to_disable">Kunne ikke skru av «%s»-modulen</string>
    <string name="apm_uninstall_confirm">Avinstaller «%s»-modulen?</string>
    <string name="home_new_apatch_found">Klikk for å installere ny versjon %s.</string>
    <string name="apm_downloading">Laster ned \"%s\" modul…</string>
    <string name="settings_night_mode_follow_sys">Følg systemets mørke tema</string>
    <string name="apm_update">Oppdater</string>
    <string name="hide_apatch_manager_failure">Kunne ikke skjule, vennligst rapporter feilen!</string>
    <string name="apm_new_version_available">Ny versjon %s er tilgjengelig, trykk for å oppgradere.</string>
    <string name="settings_night_theme_enabled">Aktiver mørkt tema</string>
    <string name="system_default">Systemstandard</string>
    <string name="settings_clear_super_key_dialog">Er du sikker på at du vil fortsette?</string>
    <string name="settings_check_update">Sjekk oppdatering</string>
    <string name="settings_check_update_summary">Sjekk automatisk etter oppdateringer når programmet åpnes</string>
    <string name="patch_start_patch_btn">Start</string>
    <string name="patch_item_extra_kpm_license">Lisens:</string>
    <string name="save_log">Lagre loggen</string>
    <string name="home_install_unknown_summary">Klikk for å installere</string>
    <string name="patch_item_error">!!FEIL!!</string>
    <string name="patch_item_bootimg_dev">enhet:</string>
    <string name="patch_item_existed_extra_kpm">Eksisterte</string>
    <string name="patch_item_kpimg_comile_time">Tid:</string>
    <string name="patch_item_extra_name">Navn:</string>
    <string name="patch_item_extra_author">Forfatter:</string>
    <string name="patch_item_extra_kpm_desciption">Beskrivelse:</string>
    <string name="patch_item_extra_args">Argumenter:</string>
    <string name="patch_item_extra_event">Hendelse:</string>
    <string name="su_pkg_excluded_label">ekskluder</string>
    <string name="apm_reboot_to_apply">Endringene trår i kraft etter omstart</string>
    <string name="home_dialog_auth_fail_title">Autentisering feilet</string>
    <string name="home_dialog_uninstall_all">Avinstaller alle</string>
    <string name="kpm_control_ok">Operasjonen var vellykket!</string>
    <string name="blue_theme">Blått tema</string>
    <string name="brown_theme">Brunt tema</string>
    <string name="green_theme">Grønt tema</string>
    <string name="light_blue_theme">Lyseblått tema</string>
    <string name="light_green_theme">Lysegrønt tema</string>
    <string name="lime_theme">Limefarget tema</string>
    <string name="orange_theme">Oransje tema</string>
    <string name="about_powered_by">Drevet av %1$s</string>
    <string name="home_more_menu_feedback_or_suggestion">Tilbakemelding eller forslag</string>
    <string name="home_more_menu_about">Om</string>
    <string name="home_dialog_uninstall_title">Avinstaller</string>
    <string name="kpm_control_outMsg">Melding</string>
    <string name="kpm_control_failed">Operasjonen mislyktes</string>
    <string name="settings_custom_color_theme">Fargetema</string>
    <string name="about_app_version">Versjon %1$s</string>
    <string name="failure">Mislykket</string>
    <string name="patch">Rettelse</string>
    <string name="log_saved">Loggen lagret</string>
    <string name="super_key">SuperNøkkel</string>
    <string name="patch_mode_bootimg_patch">Patch Modus</string>
    <string name="patch_config_title">Patches</string>
    <string name="patch_mode_uninstall_patch">Modus: Avinstaller KPatch</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="settings_global_namespace_mode_summary">Alle root-sesjoner bruker det globale Mount-Namespace</string>
    <string name="home_patch_set_key_desc">Kun opplysninger for KernelPatch</string>
    <string name="patch_embed_kpm_btn">Integrert KPM</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="home_auth_key_title">Tast inn Supernøkkelen</string>
    <string name="patch_mode_install_to_next_slot">Modus: Installer for å inaktivere sporet (Etter OTA)</string>
    <string name="patch_select_bootimg_btn">Velg oppstart</string>
    <string name="patch_item_kernel">Kjerne</string>
    <string name="patch_item_kpimg_version">Versjon:</string>
    <string name="patch_set_superkey">Angi SuperKey</string>
    <string name="patch_mode_patch_and_install">Modus: Patch og installér</string>
    <string name="patch_start_unpatch_btn">Avinstaller Patch</string>
    <string name="patch_item_bootimg">bootimg</string>
    <string name="patch_item_bootimg_slot">Spor</string>
    <string name="patch_item_set_skey_label">SuperKey skal være 8–63 tegn lang og inneholde tall og bokstaver, men ingen spesialtegn.</string>
    <string name="hide_apatch_manager_summary">Installer en ny administratorapp med en tilfeldig ID og tilpasset navn</string>
    <string name="hide_apatch_manager">Skjul APatch Manager</string>
    <string name="settings_global_namespace_mode">Global navnrom modus</string>
    <string name="patch_item_kpimg_config">Konfig:</string>
    <string name="patch_item_new_extra_kpm">Legg inn på nytt</string>
    <string name="kpm_control">Kontroll</string>
    <string name="patch_item_skey">SuperKey</string>
    <string name="kpm">KPModul</string>
    <string name="kpm_add_kpm">Legg til KPM</string>
    <string name="kpm_embed">Bygg inn</string>
    <string name="su_selinux_via_hook">omgå via krok</string>
    <string name="apm">APModul</string>
    <string name="apm_not_installed">AndroidPatch er ikke innstallert</string>
    <string name="apm_magisk_conflict">Modulene er utilgjengelige på grunn av en konflikt med Magisk!</string>
    <string name="hide_apatch_dialog_summary">Den vil bli brukt som den nye appetiketten som vises i oppstartsprogrammet.</string>
</resources>

```

`app/src/main/res/values-night/themes.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>

    <style name="Theme.APatch.WebUI" parent="Theme.APatch" />

</resources>
```

`app/src/main/res/values-nl/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="patch">Patch</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="settings">Instellingen</string>
    <string name="reboot">Opnieuw Opstarten</string>
    <string name="reboot_edl">Start opnieuw op naar EDL</string>
    <string name="about">Over</string>
    <string name="settings_app_language">Taal</string>
    <string name="system_default">Systeem standaard</string>
    <string name="settings_global_namespace_mode">Globale naamruimtemodus</string>
    <string name="settings_global_namespace_mode_summary">Alle rootsessies gebruiken de globale mount-naamruimte</string>
    <string name="home_learn_apatch">Leer APatch</string>
    <string name="about_source_code"><![CDATA[<p>Bekijk de broncode op %1$s<p/>Word lid van ons%2$s kanaal<p/>Word lid van ons%3$s groep]]></string>
    <string name="send_log">Logbestanden versturen</string>
    <string name="safe_mode">Veilige modus</string>
    <string name="super_key">SuperKey</string>
    <string name="home_patch_set_key_desc">Alleen referentie voor KernelPatch</string>
    <string name="home_patch_next_step">Volgende stap</string>
    <string name="home_not_installed">Niet geïnstalleerd</string>
    <string name="home_install_unknown">Niet geïnstalleerd of geverifieerd</string>
    <string name="home_click_to_install">Klik om te installeren</string>
    <string name="home_working">Werkend 😋</string>
    <string name="home_installing">Aan het installeren</string>
    <string name="home_need_update">Nieuwe versie beschikbaar</string>
    <string name="kpatch_version">Versie: %s</string>
    <string name="home_fingerprint">Vingerafdruk</string>
    <string name="home_selinux_status">SELinux status</string>
    <string name="home_selinux_status_disabled">Uitgeschakeld</string>
    <string name="home_selinux_status_enforcing">Afdwingend</string>
    <string name="home_selinux_status_permissive">Permissief</string>
    <string name="home_selinux_status_unknown">Onbekend</string>
    <string name="kpm">KPModule</string>
    <string name="kpm_unload_confirm">Module \"%s\" ontladen?</string>
    <string name="kpm_unload">Ontladen</string>
    <string name="kpm_apm_empty">Geen module geladen</string>
    <string name="kpm_author">Auteur</string>
    <string name="kpm_desc">Beschr.</string>
    <string name="su_show_system_apps">Systeem-apps tonen</string>
    <string name="su_hide_system_apps">Systeem-apps verbergen</string>
    <string name="apm_empty">Geen module geïnstalleerd</string>
    <string name="apm_uninstall_success">%s verwijderd</string>
    <string name="apm_uninstall_failed">Kan %s niet verwijderen</string>
    <string name="apm_reboot_to_apply">Start opnieuw op om van kracht te gaan</string>
    <string name="apm_changelog">Wijzigingslog</string>
    <string name="home">Thuis</string>
    <string name="patch_warnning">Installatie brengt risico\'s met zich mee. Zorg ervoor dat er een back-up van uw gegevens wordt gemaakt.</string>
    <string name="reboot_bootloader">Start opnieuw op naar Bootloader</string>
    <string name="home_click_to_learn_apatch">Leer meer over de functies van APatch en hoe u deze kunt gebruiken</string>
    <string name="reboot_download">Start opnieuw op naar Download</string>
    <string name="reboot_recovery">Start opnieuw op naar herstel</string>
    <string name="apatch_version">Versie: %s</string>
    <string name="home_su_path">Uitvoerbare su</string>
    <string name="home_auth_key_desc">Start na certificering</string>
    <string name="home_ap_cando_update">Werk bij</string>
    <string name="apatch_version_update">Versie: %s -&gt; %s</string>
    <string name="home_apatch_version">APatch versie</string>
    <string name="home_ap_cando_install">Installeer</string>
    <string name="home_manager_version">Managerversie</string>
    <string name="kpm_kp_not_installed">KernelPatch niet geïnstalleerd</string>
    <string name="home_ap_cando_uninstall">Verwijder</string>
    <string name="patch_title">Patch</string>
    <string name="home_kernel">Kernel versie</string>
    <string name="kpm_load">Laden</string>
    <string name="kpm_load_toast_failed">Laden mislukt</string>
    <string name="kpm_load_toast_succ">Laden gelukt</string>
    <string name="kpm_version">Versie</string>
    <string name="kpm_license">Licensie</string>
    <string name="su_pkg_excluded_label">uitsluiten</string>
    <string name="su_pkg_excluded_setting_title">Modificaties Uitsluiten</string>
    <string name="su_pkg_excluded_setting_summary">Het inschakelen van deze optie zal APatch toelaten om enige gemodificeerde bestanden door de modules van deze applicatie te herstellen.</string>
    <string name="su_refresh">Vernieuwen</string>
    <string name="apm_not_installed">AndroidPatch niet geïnstalleerd</string>
    <string name="apm">APModule</string>
    <string name="apm_failed_to_disable">Kon de module \"%s\" niet uitschakelen</string>
    <string name="apm_failed_to_enable">Kon de module \"%s\" niet inschakelen</string>
    <string name="apm_update">Update</string>
    <string name="apm_remove">Verwijderen</string>
    <string name="apm_install">Installeren</string>
    <string name="apm_uninstall_confirm">De module \"%s\" verwijderen?</string>
    <string name="apm_version">Versie</string>
    <string name="apm_desc">Beschr.</string>
    <string name="apm_author">Auteur</string>
    <string name="apm_downloading">Downloaden \"%s\" module…</string>
    <string name="apm_start_downloading">Begin met downloaden %s</string>
    <string name="apm_new_version_available">Een nieuwe versie %s is beschikbaar, klik om te upgraden.</string>
    <string name="apm_overlay_fs_not_available">Modules zijn onbereikbaar als OverlayFS wordt uitgeschakeld door de kern!</string>
    <string name="apm_magisk_conflict">Modules zijn niet beschikbaar door een conflict met Magisk!</string>
    <string name="settings_clear_super_key_dialog">Wil je zeker verder gaan?</string>
    <string name="success">Succes</string>
    <string name="failure">Mislukking</string>
    <string name="settings_check_update">Naar updates zoeken</string>
    <string name="settings_check_update_summary">Automatisch controleren op updates als je de app opent</string>
    <string name="blue_theme">Blauw Theme</string>
    <string name="brown_theme">Brown Theme</string>
    <string name="cyan_theme">Cyan Theem</string>
    <string name="indigo_theme">Indigo Theme</string>
    <string name="deep_purple_theme">Diep Purple Theem</string>
    <string name="light_blue_theme">Licht Theem</string>
    <string name="green_theme">Groen Theem</string>
    <string name="light_green_theme">Licht Theem</string>
    <string name="purple_theme">Purple Theme</string>
    <string name="red_theme">Red Theem</string>
    <string name="sakura_theme">Sakura Theem</string>
    <string name="deep_orange_theme">Diepe Orange Theem</string>
    <string name="lime_theme">Lime Theme</string>
    <string name="orange_theme">Orange Theme</string>
    <string name="pink_theme">Pink Theem</string>
    <string name="save_log">Logboek opslaan</string>
    <string name="log_saved">Logboek opgeslagen</string>
    <string name="kpatch_version_update">Versie: %s -&gt; %s</string>
    <string name="clear_super_key">SuperKey verwijderen</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="home_kpatch_info_title">Info</string>
    <string name="home_install_unknown_summary">Klik om te installeren</string>
    <string name="home_auth_key_title">SuperKey invoeren</string>
    <string name="home_ap_cando_reboot">Herstarten</string>
    <string name="patch_config_title">Patches</string>
    <string name="patch_mode_uninstall_patch">Modus: KPatch verwijderen</string>
    <string name="patch_mode_install_to_next_slot">Modus: Installeren naar volgende slot (na OTA)</string>
    <string name="patch_select_bootimg_btn">Opstarten selecteren</string>
    <string name="patch_mode_bootimg_patch">Modus: Patch</string>
    <string name="patch_mode_patch_and_install">Modus: Patchen en installeren</string>
    <string name="patch_set_superkey">SuperKey instellen</string>
    <string name="mode_select_page_install_inactive_slot_warning">Uw apparaat zal **GEFORCEERD** worden om op te starten aan de huidige inactieve gleuf na een heropstarting!\nDeze optie enkel gebruiken nadat OTA gedaan is.\nDoorgaan?</string>
    <string name="teal_theme">Blauwgroen Thema</string>
    <string name="crash_handle_title">Applicatie gecrasht…</string>
    <string name="crash_handle_copy">Kopieer crash logboek</string>
    <string name="crash_handle_copied">Crash logboek gekopieerd naar klembord.</string>
    <string name="patch_embed_kpm_btn">KPM insluiten</string>
    <string name="patch_start_patch_btn">Begin</string>
    <string name="patch_item_set_skey_label">De lengte van super sleutel zou minstens 8 tekens lang moeten zijn en zowel getallen als letters bevatten.</string>
    <string name="patch_item_extra_kpm_desciption">Beschrijving:</string>
    <string name="patch_item_extra_args">Argumenten:</string>
    <string name="patch_item_bootimg">Opstartafbeelding</string>
    <string name="patch_item_existed_extra_kpm">Bestond</string>
    <string name="apm_webui_open">Open</string>
    <string name="mode_select_page_install_inactive_slot">Installeer aan inactieve gleuf (Na OTA)</string>
    <string name="about_telegram_channel">Telegram Kanaal</string>
    <string name="home_dialog_auth_fail_title">Verificatie gefaald</string>
    <string name="patch_item_error">!!Fout!!</string>
    <string name="patch_item_bootimg_dev">apparaat:</string>
    <string name="patch_item_kpimg_version">Versie:</string>
    <string name="patch_item_kpimg">Kpafbeelding</string>
    <string name="patch_item_kernel">Kern</string>
    <string name="patch_item_bootimg_slot">Sleuf</string>
    <string name="patch_item_new_extra_kpm">Nieuw insluiten</string>
    <string name="patch_item_kpimg_config">Configuratie:</string>
    <string name="patch_item_kpimg_comile_time">Tijd:</string>
    <string name="patch_item_extra_name">Naam:</string>
    <string name="patch_item_extra_version">Versie:</string>
    <string name="patch_item_extra_author">Auteur:</string>
    <string name="patch_item_skey">Super Sleutel</string>
    <string name="patch_item_extra_event">Evenement:</string>
    <string name="home_system_version">Systeem versie</string>
    <string name="home_kpatch_version">KernLap versie</string>
    <string name="home_device_info">Apparaat</string>
    <string name="kpm_add_kpm">Voeg KPM toe</string>
    <string name="hide_apatch_manager">Verberg APatch Beheerder</string>
    <string name="hide_apatch_manager_summary">Installeer een proxy applicatie met een willekeurige package ID en een custom applicatie label</string>
    <string name="hide_apatch_dialog_new_manager_name">Nieuwe Beheerder Naam</string>
    <string name="hide_apatch_dialog_summary">Het zal gebruikt worden als de nieuwe applicatie label weergegeven in de launcher</string>
    <string name="setting_reset_su_new_path">Nieuwe volle pad</string>
    <string name="hide_apatch_manager_failure">Verbergen gefaald, gelieve deze fout te melden!</string>
    <string name="setting_reset_su_path">su pad opnieuw instellen</string>
    <string name="enable_web_debugging">Webview Debuggen Inschakelen</string>
    <string name="enable_web_debugging_summary">Kan gebruikt worden om WebUI te debuggen, gelieve in te schakelen enkel wanneer nodig.</string>
    <string name="settings_donot_store_superkey">Super sleutel niet opslaan in lokaal</string>
    <string name="home_new_apatch_found">Nieuwe versie beschikbaar:%s, klik mij en upgrade nu.</string>
    <string name="mode_select_page_title">Installeer</string>
    <string name="mode_select_page_patch_and_install">Oplappen en Installeren</string>
    <string name="home_more_menu_feedback_or_suggestion">Feedback of suggestie</string>
    <string name="home_more_menu_about">Over</string>
    <string name="home_dialog_uninstall_title">Verwijder</string>
    <string name="kpm_control_paramters">Parameters</string>
    <string name="kpm_control_dialog_content">Ingave controle parameters:</string>
    <string name="kpm_control_ok">Operatie succesvol!</string>
    <string name="kpm_control_failed">Operatie gefaald!</string>
    <string name="settings_use_system_color_theme_summary">Gebruik een kleur thema gegenereerd door systeen met huidige achtergrondafbeelding</string>
    <string name="settings_use_system_color_theme">Systeem Kleur Thema</string>
    <string name="kpm_args">Argumenten</string>
    <string name="su_title">Supergebruiker</string>
    <string name="su_selinux_via_hook">Omzeilen via haak</string>
    <string name="kpm_install">Installeer</string>
    <string name="kpm_embed">Insluiten</string>
    <string name="apm_action">Actie</string>
    <string name="settings_donot_store_superkey_summary">Verifieer de super sleutel elke keer dat de beheerder begint</string>
    <string name="home_dialog_uninstall_all">Verwijder Alles</string>
    <string name="kpm_control_outMsg">Bericht</string>
    <string name="mode_select_page_select_file">Selecteer een opstartimage om te patchen</string>
    <string name="kpm_control_dialog_title">KPModule Controleren</string>
    <string name="settings_night_mode_follow_sys">Volg Systeems Donkere Thema</string>
    <string name="settings_night_mode_follow_sys_summary">Verander automatisch naar donkere thema met systeems instelling</string>
    <string name="home_dialog_uninstall_ap_only">Verwijder AndroidPatch</string>
    <string name="amber_theme">Amber Thema</string>
    <string name="settings_night_theme_enabled">Donkere Thema Inschakelen</string>
    <string name="blue_grey_theme">BlauwGrijs Thema</string>
    <string name="settings_custom_color_theme">Kleur Thema</string>
    <string name="about_app_desc">Kernel Root-oplossing met alleen een gestripte kernel afbeelding, die de mogelijkheid biedt om een systeemmodule te mounten en een kernelfunctie te koppelen.</string>
    <string name="yellow_theme">Geel Thema</string>
    <string name="about_app_version">Versie %1$s</string>
    <string name="about_telegram_group">Telegram Groep</string>
    <string name="about_powered_by">Aangedreven door %1$s</string>
    <string name="patch_item_extra_kpm_license">Licentie:</string>
    <string name="kpm_control">Controle</string>
    <string name="home_dialog_auth_fail_content">Niet in staat om de super sleutel te verifieren, daarom kan APatch niet correct werken.\nHier zijn een paar mogelijke redenen voor het falen van de verificatie:\n1. U heeft de opstart afbeelding niet opgelapt met KernLap.\n2. De opgelapte opstart afbeelding was niet geflashed.\n3. Super sleutel fout.\n4. Uw apparaat ondersteunt APatch en KernLap niet.\n\nGelieve te checken en opnieuwe te proberen. Indien er nog steeds problemen zijn, kan je steeds vragen stellen op de officiele respository\'s problemen pagina.</string>
    <string name="patch_start_unpatch_btn">Ontsnipperen</string>
    <string name="settings_lite_mode">Lite-modus inschakelen</string>
    <string name="settings_lite_mode_mode_summary">APModule-functies kunnen fouten vertonen nadat ze zijn ingeschakeld, maar in sommige gevallen kunnen ze detectie nog steeds effectief vermijden. Opnieuw opstarten is vereist.</string>
    <string name="settings_force_overlayfs_mode">Forceer het gebruik van OverlayFS</string>
    <string name="settings_force_overlayfs_mode_summary">Gebruik OverlayFS om APModules te mounten in plaats van Magic Mount wanneer kernelondersteuning beschikbaar is. Herstarten is vereist.</string>
</resources>

```

`app/src/main/res/values-pl/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="apm">Moduły AP</string>
    <string name="super_key">SuperKey</string>
    <string name="app_name" translatable="false">APatch</string>
    <string name="kpm">Moduły KP</string>
    <string name="home">Pulpit</string>
    <string name="send_log">Prześlij logi</string>
    <string name="kpatch_version">Wersja: %s</string>
    <string name="home_click_to_learn_apatch">Dowiedz się o funkcjach APatcha i jak go używać</string>
    <string name="home_installing">Instalowanie</string>
    <string name="home_learn_apatch">Poznaj APatch</string>
    <string name="home_click_to_install">Kliknij, aby zainstalować</string>
    <string name="about">Informacje</string>
    <string name="reboot">Uruchom ponownie</string>
    <string name="home_need_update">Dostępna nowa wersja</string>
    <string name="settings">Ustawienia</string>
    <string name="home_patch_next_step">Kolejny krok</string>
    <string name="home_not_installed">Nie zainstalowany</string>
    <string name="about_source_code"><![CDATA[<p>Zobacz kod źródłowy na %1$s<p/>Dołącz do naszego kanału %2$s <p/>Dołącz do naszej grupy %3$s]]></string>
    <string name="home_ap_cando_uninstall">Odinstaluj</string>
    <string name="apatch_version">Wersja: %s</string>
    <string name="home_ap_cando_install">Instaluj</string>
    <string name="home_selinux_status">Status SELinux</string>
    <string name="home_su_path">Plik wykonywalny su</string>
    <string name="apatch_version_update">Wersja: %s -&gt; %s</string>
    <string name="home_kernel">Wersja jądra</string>
    <string name="home_manager_version">Wersja menedżera</string>
    <string name="patch_title">Załataj</string>
    <string name="home_selinux_status_disabled">Wyłączony</string>
    <string name="home_selinux_status_enforcing">Wymuszony</string>
    <string name="su_pkg_excluded_setting_summary">Włączenie tej opcji umożliwi APatch przywrócenie wszystkich plików zmodyfikowanych przez moduły tej aplikacji.</string>
    <string name="su_title">Superuser</string>
    <string name="kpm_version">Wersja</string>
    <string name="su_refresh">Odśwież</string>
    <string name="su_show_system_apps">Pokaż aplikacje systemowe</string>
    <string name="home_selinux_status_permissive">Pobłażliwy</string>
    <string name="kpm_author">Autor</string>
    <string name="su_hide_system_apps">Ukryj aplikacje systemowe</string>
    <string name="kpm_load_toast_failed">Załadowanie nie powiodło się</string>
    <string name="kpm_load">Załaduj</string>
    <string name="kpm_license">Licencja</string>
    <string name="kpm_apm_empty">Brak załadowanych modułów</string>
    <string name="kpm_load_toast_succ">Pomyślnie załadowano</string>
    <string name="apm_uninstall_success">Moduł %s odinstalowany</string>
    <string name="apm_install">Instaluj</string>
    <string name="apm_remove">Usuń</string>
    <string name="apm_uninstall_confirm">Odinstalować moduł \"%s\"?</string>
    <string name="apm_version">Wersja</string>
    <string name="apm_overlay_fs_not_available">Moduły są niedostępne, ponieważ OverlayFS jest wyłączony przez jądro!</string>
    <string name="apm_failed_to_disable">Nie udało się wyłączyć modułu \"%s\"</string>
    <string name="apm_uninstall_failed">Nie udało się odinstalować modułu %s</string>
    <string name="apm_failed_to_enable">Nie udało się włączyć modułu: \"%s\"</string>
    <string name="apm_magisk_conflict">Moduły są niedostępne, ponieważ istnieje konflikt z Magiskiem!</string>
    <string name="apm_author">Autor</string>
    <string name="apm_changelog">Lista zmian</string>
    <string name="apm_downloading">Pobieranie modułu \"%s\"…</string>
    <string name="apm_update">Aktualizacja</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="apm_start_downloading">Rozpocznij pobieranie: %s</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="apm_new_version_available">Dostępna jest nowa wersja %s. Kliknij, aby uaktualnić.</string>
    <string name="reboot_download">Restartuj do Download</string>
    <string name="reboot_edl">Restartuj do EDL</string>
    <string name="reboot_recovery">Restartuj do Recovery</string>
    <string name="patch_set_superkey">Ustaw SuperKey</string>
    <string name="reboot_bootloader">Restartuj do Bootloadera</string>
    <string name="home_apatch_version">Wersja APatch</string>
    <string name="home_auth_key_title">Wpisz SuperKey</string>
    <string name="apm_reboot_to_apply">Uruchom ponownie aby zadziałało</string>
    <string name="apm_empty">Brak zainstalowanych modułów</string>
    <string name="home_working">Włączony</string>
    <string name="home_fingerprint">Odcisk palca</string>
    <string name="home_selinux_status_unknown">Nieznany</string>
    <string name="su_pkg_excluded_setting_title">Wyklucz modyfikacje</string>
    <string name="kpm_kp_not_installed">KernelPatch jest niezainstalowany</string>
    <string name="clear_super_key">Wyczyść SuperKey</string>
    <string name="patch_warnning">Instalacja wiąże się z ryzykiem. Upewnij się, że utworzono kopię zapasową danych.</string>
    <string name="safe_mode">Tryb bezpieczny</string>
    <string name="home_install_unknown">Nie zainstalowano lub nie uwierzytelniono</string>
    <string name="home_ap_cando_update">Aktualizacja</string>
    <string name="kpm_unload_confirm">Rozpakować \"%s\" moduł?</string>
    <string name="kpm_desc">Opis</string>
    <string name="kpm_args">Argumenty</string>
    <string name="su_selinux_via_hook">ominięcie za pomocą haka</string>
    <string name="su_pkg_excluded_label">wyklucz</string>
    <string name="apm_desc">Opis</string>
    <string name="settings_app_language">Język</string>
    <string name="system_default">Domyślne ustawienie systemowe</string>
    <string name="apm_not_installed">AndroidPatch jest niezainstalowany</string>
    <string name="home_patch_set_key_desc">Tylko dane uwierzytelniające dla KernelPatch</string>
    <string name="home_auth_key_desc">Rozpocznij po uzyskaniu certyfikatu</string>
    <string name="kpm_unload">Rozpakuj</string>
    <string name="patch">Załataj</string>
    <string name="settings_global_namespace_mode">Tryb globalnej przestrzeni nazw</string>
    <string name="settings_global_namespace_mode_summary">Wszystkie sesje root korzystają z globalnej przestrzeni montowania nazw</string>
    <string name="settings_clear_super_key_dialog">Czy na pewno chcesz kontynuować?</string>
    <string name="kpatch_version_update">Wersja: %s -&gt; %s</string>
    <string name="home_kpatch_info_title">Informacje</string>
    <string name="patch_select_bootimg_btn">Wybierz rozruch</string>
    <string name="patch_embed_kpm_btn">Osadź KPM</string>
    <string name="patch_start_patch_btn">Start</string>
    <string name="patch_start_unpatch_btn">Odłatkowanie</string>
    <string name="patch_item_error">!!BŁĄD!!</string>
    <string name="patch_item_bootimg">obraz boot</string>
    <string name="patch_item_bootimg_slot">slot:</string>
    <string name="patch_item_bootimg_dev">urządzenie:</string>
    <string name="patch_item_kernel">Jądro</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_kpimg_version">Wersja:</string>
    <string name="patch_item_kpimg_comile_time">Czas:</string>
    <string name="patch_item_kpimg_config">Konfiguracja:</string>
    <string name="patch_item_new_extra_kpm">osadź nowy</string>
    <string name="patch_item_existed_extra_kpm">istniejący</string>
    <string name="patch_item_extra_name">Nazwa:</string>
    <string name="patch_item_extra_version">Wersja:</string>
    <string name="patch_item_extra_author">Autor:</string>
    <string name="patch_item_extra_kpm_license">Licencja:</string>
    <string name="patch_item_extra_kpm_desciption">Opis:</string>
    <string name="patch_item_extra_args">Argumenty:</string>
    <string name="patch_item_extra_event">Wydarzenie:</string>
    <string name="patch_item_skey">SuperKey</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="patch_item_set_skey_label">SuperKey powinien mieć od 8 do 63 znaków i zawierać zarówno cyfry, jak i litery, ale bez znaków specjalnych.</string>
    <string name="home_ap_cando_reboot">Uruchom ponownie</string>
    <string name="patch_config_title">Łatki</string>
    <string name="patch_mode_bootimg_patch">Tryb: Łatka</string>
    <string name="patch_mode_patch_and_install">Tryb: Aktualizacja</string>
    <string name="patch_mode_uninstall_patch">Tryb: Odłatkowanie</string>
    <string name="teal_theme">Morski</string>
    <string name="hide_apatch_dialog_new_manager_name">Nowa nazwa menedżera</string>
    <string name="hide_apatch_dialog_summary">Będzie używana jako nowa nazwa aplikacji pokazana w Launcherze</string>
    <string name="setting_reset_su_path">Zresetuj ścieżkę su</string>
    <string name="enable_web_debugging">Włącz debugowanie WebView</string>
    <string name="mode_select_page_select_file">Wybierz obraz boot do załatania</string>
    <string name="mode_select_page_patch_and_install">Załataj i zainstaluj</string>
    <string name="settings_check_update">Sprawdź dostępność aktualizacji</string>
    <string name="settings_check_update_summary">Automatycznie sprawdzaj dostępność aktualizacji podczas otwierania aplikacji</string>
    <string name="home_install_unknown_summary">Kliknij, aby zainstalować</string>
    <string name="patch_mode_install_to_next_slot">Tryb: Instaluj do nieaktywnego slotu (po aktualizacji OTA)</string>
    <string name="kpm_add_kpm">Dodaj KPM</string>
    <string name="kpm_embed">Osadź</string>
    <string name="kpm_control">Kontrola</string>
    <string name="hide_apatch_manager">Ukryj menedżer APatch</string>
    <string name="hide_apatch_manager_summary">Zainstaluj aplikację proxy z losowym ID pakietu i niestandardową etykietą</string>
    <string name="mode_select_page_install_inactive_slot_warning">Twoje urządzenie będzie **ZMUSZONE** do uruchomienia się w bieżącym nieaktywnym slocie po ponownym uruchomieniu!\nUżywaj tej opcji tylko po zakończeniu aktualizacji OTA.\nKontynuować?</string>
    <string name="about_telegram_channel">Kanał na Telegramie</string>
    <string name="about_app_version">Wersja %1$s</string>
    <string name="about_telegram_group">Grupa na Telegramie</string>
    <string name="about_powered_by">Zasilany przez %1$s</string>
    <string name="red_theme">Czerwony</string>
    <string name="setting_reset_su_new_path">Nowa pełna ścieżka</string>
    <string name="home_more_menu_about">O aplikacji</string>
    <string name="apm_webui_open">Otwórz</string>
    <string name="green_theme">Zielony</string>
    <string name="home_dialog_uninstall_ap_only">Usuń AndroidPatch</string>
    <string name="home_dialog_uninstall_all">Odinstaluj wszystko</string>
    <string name="kpm_control_dialog_title">Kontroluj KPModule</string>
    <string name="kpm_control_dialog_content">Wpisz parametry kontrolne:</string>
    <string name="kpm_control_paramters">Parametry</string>
    <string name="kpm_control_outMsg">Wiadomość zwrotna</string>
    <string name="kpm_control_ok">Operacja przebiegła pomyślnie!</string>
    <string name="kpm_control_failed">Operacja nie powiodła się!</string>
    <string name="settings_night_mode_follow_sys">Podążaj za ciemnym motywem systemu</string>
    <string name="settings_night_mode_follow_sys_summary">Automatyczne przełącz na ciemny motyw na podstawie ustawień systemowych</string>
    <string name="settings_night_theme_enabled">Włącz ciemny motyw</string>
    <string name="settings_use_system_color_theme">Motyw kolorów systemu</string>
    <string name="settings_use_system_color_theme_summary">Używaj motywu kolorystycznego wygenerowanego przez system na podstawie bieżącej tapety</string>
    <string name="settings_custom_color_theme">Motyw kolorystyczny</string>
    <string name="blue_grey_theme">Niebiesko-szary</string>
    <string name="blue_theme">Niebieski</string>
    <string name="brown_theme">Brązowy</string>
    <string name="cyan_theme">Cyjanowy</string>
    <string name="deep_orange_theme">Ciemny pomarańczowy</string>
    <string name="deep_purple_theme">Ciemny fiolet</string>
    <string name="indigo_theme">Indygo</string>
    <string name="light_blue_theme">Jasnoniebieski</string>
    <string name="light_green_theme">Jasnozielony</string>
    <string name="pink_theme">Różowy</string>
    <string name="purple_theme">Fioletowy</string>
    <string name="yellow_theme">Żółty</string>
    <string name="amber_theme">Bursztynowy</string>
    <string name="lime_theme">Limonkowy</string>
    <string name="orange_theme">Pomarańczowy</string>
    <string name="hide_apatch_manager_failure">Nie udało się ukryć. Zgłoś błąd!</string>
    <string name="enable_web_debugging_summary">Może być używane do debugowania WebUI. Włącz tylko w razie potrzeby.</string>
    <string name="settings_donot_store_superkey">Nie przechowuj SuperKey lokalnie</string>
    <string name="settings_donot_store_superkey_summary">Uwierzytelniaj SuperKey przy każdym uruchomieniu menadżera</string>
    <string name="home_new_apatch_found">Dostępna jest nowa wersja %s. Kliknij, aby uaktualnić.</string>
    <string name="mode_select_page_title">Zainstaluj</string>
    <string name="mode_select_page_install_inactive_slot">Zainstaluj do nieaktywnego slotu (po aktualizacji OTA)</string>
    <string name="sakura_theme">Sakura</string>
    <string name="home_dialog_auth_fail_content">Nie można uwierzytelnić SuperKey, dlatego APatch nie może działać poprawnie.\nOto kilka możliwych przyczyn niepowodzenia uwierzytelniania:\n1. Nie zaktualizowano pliku boot.img za pomocą KernelPatch.\n2. Poprawiony plik boot.img nie został sflashowany.\n3. Klucz SuperKey jest nieprawidłowy lub zawiera znaki specjalne.\n4. Urządzenie nie obsługuje APatch i KernelPatch.\n\nSprawdź i spróbuj ponownie. Jeśli nadal występują problemy, zawsze możesz zadawać pytania na oficjalnej stronie repozytorium.</string>
    <string name="home_more_menu_feedback_or_suggestion">Opinie bądź sugestie</string>
    <string name="about_app_desc">Rozwiązanie rootowania jądra z jedynie okrojonym obrazem jądra, zapewniające możliwość montowania modułu systemowego i hakowania funkcji jądra.</string>
    <string name="success">Zakończono sukcesem</string>
    <string name="failure">Niepowodzenie</string>
    <string name="home_device_info">Urządzenie</string>
    <string name="home_system_version">Wersja systemu</string>
    <string name="kpm_install">Instaluj</string>
    <string name="home_dialog_auth_fail_title">Uwierzytelnianie nie powiodło się</string>
    <string name="home_dialog_uninstall_title">Odinstaluj</string>
    <string name="home_kpatch_version">Wersja KernelPatch</string>
    <string name="save_log">Zapisz logi</string>
    <string name="apm_action">Akcja</string>
    <string name="log_saved">Zapisano logi</string>
    <string name="crash_handle_title">Aplikacja się wysypała…</string>
    <string name="crash_handle_copy">Kopiuj logi awarii</string>
    <string name="crash_handle_copied">Logi awarii skopiowano do schowka.</string>
    <string name="settings_lite_mode">Włącz tryb uproszczony</string>
    <string name="settings_lite_mode_mode_summary">Moduły AP mogą wykazywać awarie po włączeniu tej funkcji, ale w niektórych przypadkach mogą nadal skutecznie unikać wykrycia. Wymagane ponowne uruchomienie.</string>
    <string name="settings_force_overlayfs_mode">Wymuś użycie OverlayFS</string>
    <string name="settings_force_overlayfs_mode_summary">Użyj OverlayFS zamiast Magic Mount do montowania modułów AP, gdy jądro to obsługuje. Wymagane jest ponowne uruchomienie.</string>
</resources>

```

`app/src/main/res/values-pt-rBR/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="home">Início</string>
    <string name="patch_warnning">A instalação apresenta riscos. Por favor, certifique-se de fazer backup de seus dados.</string>
    <string name="patch_title">Patch</string>
    <string name="kpm_author">Autor</string>
    <string name="kpm_desc">Descrição</string>
    <string name="kpm_args">Argumentos</string>
    <string name="su_title">SuperUsuário</string>
    <string name="su_pkg_excluded_setting_summary">Ativar esta opção permitirá que o APatch restaure quaisquer arquivos modificados pelos módulos deste app.</string>
    <string name="su_refresh">Atualizar</string>
    <string name="apm_reboot_to_apply">Reinicie para entrar em vigor</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="reboot">Reiniciar</string>
    <string name="settings">Configurações</string>
    <string name="reboot_recovery">Reiniciar em modo Recovery</string>
    <string name="reboot_bootloader">Reiniciar em modo Bootloader</string>
    <string name="reboot_download">Reiniciar em modo Download</string>
    <string name="reboot_edl">Reiniciar em modo EDL</string>
    <string name="about">Sobre</string>
    <string name="home_learn_apatch">Saiba mais sobre o APatch</string>
    <string name="home_click_to_learn_apatch">Conheça os recursos do APatch e como usá-lo</string>
    <string name="about_source_code"><![CDATA[<p>Veja o código-fonte no %1$s<p/>Participe do nosso canal do %2$s<p/>Participe do nosso grupo do %3$s]]></string>
    <string name="send_log">Reportar registros</string>
    <string name="safe_mode">Modo de segurança</string>
    <string name="super_key">SuperKey</string>
    <string name="patch_set_superkey">Definir SuperKey</string>
    <string name="home_patch_set_key_desc">Apenas credencial para KernelPatch</string>
    <string name="home_patch_next_step">Próximo passo</string>
    <string name="home_not_installed">Não instalado</string>
    <string name="home_click_to_install">Clique para instalar</string>
    <string name="home_working">Em execução 😋</string>
    <string name="home_install_unknown">Não instalado ou autenticado</string>
    <string name="home_installing">Instalando</string>
    <string name="home_need_update">Nova versão disponível</string>
    <string name="kpatch_version">Versão: %s</string>
    <string name="apatch_version">Versão: %s</string>
    <string name="home_su_path">Su executável</string>
    <string name="apatch_version_update">Versão: %s -&gt; %s</string>
    <string name="home_apatch_version">Versão do APatch</string>
    <string name="home_auth_key_title">Inserir SuperKey</string>
    <string name="home_auth_key_desc">Iniciar após a certificação</string>
    <string name="home_ap_cando_install">Instalar</string>
    <string name="home_ap_cando_update">Atualizar</string>
    <string name="home_ap_cando_uninstall">Desinstalar</string>
    <string name="home_kernel">Versão do kernel</string>
    <string name="home_manager_version">Versão do gerenciador</string>
    <string name="home_fingerprint">Impressão digital</string>
    <string name="home_selinux_status">Status do SELinux</string>
    <string name="home_selinux_status_disabled">Desativado</string>
    <string name="home_selinux_status_enforcing">Impondo</string>
    <string name="home_selinux_status_permissive">Permissivo</string>
    <string name="home_selinux_status_unknown">Desconhecido</string>
    <string name="kpm">KPMódulo</string>
    <string name="kpm_kp_not_installed">KernelPatch não instalado</string>
    <string name="kpm_unload">Descarregar</string>
    <string name="kpm_load">Carregar</string>
    <string name="kpm_load_toast_succ">Carregado com sucesso</string>
    <string name="kpm_load_toast_failed">Erro ao carregar</string>
    <string name="kpm_unload_confirm">Descarregar o módulo %s?</string>
    <string name="kpm_apm_empty">Nenhum módulo carregado</string>
    <string name="kpm_version">Versão</string>
    <string name="kpm_license">Licença</string>
    <string name="su_selinux_via_hook">ignorar via hook</string>
    <string name="su_pkg_excluded_label">excluir</string>
    <string name="su_pkg_excluded_setting_title">Excluir modificações</string>
    <string name="su_show_system_apps">Mostrar apps do sistema</string>
    <string name="su_hide_system_apps">Ocultar apps do sistema</string>
    <string name="apm">APMódulo</string>
    <string name="apm_failed_to_enable">Não foi possível ativar o módulo %s</string>
    <string name="apm_failed_to_disable">Não foi possível desativar o módulo %s</string>
    <string name="apm_empty">Nenhum módulo instalado</string>
    <string name="apm_remove">Desinstalar</string>
    <string name="apm_install">Instalar</string>
    <string name="apm_uninstall_confirm">Desinstalar o módulo %s?</string>
    <string name="apm_uninstall_success">%s desinstalado</string>
    <string name="apm_uninstall_failed">Não foi possível desinstalar %s</string>
    <string name="apm_version">Versão</string>
    <string name="apm_author">Autor</string>
    <string name="apm_desc">Descrição</string>
    <string name="apm_overlay_fs_not_available">Os módulos estão indisponíveis porque OverlayFS está desabilitado pelo kernel!</string>
    <string name="apm_magisk_conflict">Os módulos estão indisponíveis devido a um conflito com Magisk!</string>
    <string name="apm_changelog">Registro de alterações</string>
    <string name="apm_update">Atualizar</string>
    <string name="apm_downloading">Baixando módulo %s</string>
    <string name="apm_start_downloading">Começando a baixar %s</string>
    <string name="apm_new_version_available">Nova versão %s está disponível, clique para atualizar.</string>
    <string name="clear_super_key">Limpar SuperKey</string>
    <string name="apm_not_installed">AndroidPatch não instalado</string>
    <string name="settings_app_language">Idioma</string>
    <string name="system_default">Padrão do sistema</string>
    <string name="patch">Patch</string>
    <string name="settings_global_namespace_mode">Modo de namespace global</string>
    <string name="settings_global_namespace_mode_summary">Todas as sessões root usam o namespace de montagem global</string>
    <string name="kpatch_version_update">Versão: %s -&gt; %s</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="home_kpatch_info_title">Informações</string>
    <string name="home_ap_cando_reboot">Reiniciar</string>
    <string name="patch_item_error">!!ERRO!!</string>
    <string name="patch_item_bootimg">bootimg</string>
    <string name="patch_item_bootimg_slot">slot:</string>
    <string name="patch_item_bootimg_dev">dispositivo:</string>
    <string name="patch_item_kernel">Kernel</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_kpimg_version">Versão:</string>
    <string name="patch_item_kpimg_comile_time">Hora:</string>
    <string name="patch_item_kpimg_config">Configuração:</string>
    <string name="patch_item_new_extra_kpm">Incorporar novo</string>
    <string name="patch_item_existed_extra_kpm">Existia</string>
    <string name="patch_item_extra_name">Nome:</string>
    <string name="patch_item_extra_version">Versão:</string>
    <string name="patch_item_extra_author">Autor:</string>
    <string name="patch_item_extra_kpm_license">Licença:</string>
    <string name="patch_item_extra_kpm_desciption">Descrição:</string>
    <string name="patch_select_bootimg_btn">Selecionar boot</string>
    <string name="patch_embed_kpm_btn">Incorporar KPM</string>
    <string name="patch_start_patch_btn">Iniciar</string>
    <string name="patch_config_title">Patches</string>
    <string name="patch_mode_bootimg_patch">Modo: Patch</string>
    <string name="patch_mode_patch_and_install">Modo: Patch e instalação</string>
    <string name="patch_mode_uninstall_patch">Modo: Desinstalar KPatch</string>
    <string name="patch_start_unpatch_btn">UnPatch</string>
    <string name="patch_item_extra_args">Argumentos:</string>
    <string name="patch_item_extra_event">Evento:</string>
    <string name="patch_item_skey">SuperKey</string>
    <string name="settings_clear_super_key_dialog">Você realmente deseja continuar?</string>
    <string name="patch_item_set_skey_label">A SuperKey deve ter de 8 a 63 caracteres e incluir números e letras, mas sem caracteres especiais.</string>
    <string name="hide_apatch_dialog_new_manager_name">Nome do novo gerenciador</string>
    <string name="hide_apatch_dialog_summary">Ele será usado como o novo nome do app mostrado na launcher</string>
    <string name="hide_apatch_manager">Ocultar app do APatch</string>
    <string name="hide_apatch_manager_summary">Instala o app oculto com ID aleatório e nome personalizado</string>
    <string name="hide_apatch_manager_failure">Falha ao ocultar. Por favor, reporte o bug!</string>
    <string name="kpm_embed">Incorporar</string>
    <string name="kpm_add_kpm">Adicionar KPM</string>
    <string name="kpm_install">Instalar</string>
    <string name="failure">Falha</string>
    <string name="setting_reset_su_new_path">Novo caminho completo</string>
    <string name="success">Sucesso</string>
    <string name="setting_reset_su_path">Redefinir caminho su</string>
    <string name="settings_check_update_summary">Verifique automaticamente se há atualizações ao abrir o app</string>
    <string name="settings_check_update">Verificar por atualizações</string>
    <string name="mode_select_page_install_inactive_slot">Instalar no slot inativo (Após o OTA)</string>
    <string name="mode_select_page_install_inactive_slot_warning">Seu dispositivo será **FORÇADO** a inicializar no slot inativo atual após uma reinicialização!
\nSó use esta opção após a conclusão do OTA.
\nDeseja continuar?</string>
    <string name="home_dialog_auth_fail_title">Falha na autenticação</string>
    <string name="mode_select_page_select_file">Selecionar imagem boot para patch</string>
    <string name="mode_select_page_title">Instalar</string>
    <string name="mode_select_page_patch_and_install">Patch e instalação</string>
    <string name="home_dialog_auth_fail_content">Não foi possível autenticar a SuperKey, portanto o APatch não pode funcionar corretamente. \nAqui estão alguns possíveis motivos para a falha de autenticação:\n1. Você não fez patch do boot.img com KernelPatch.\n2. O boot.img corrigido não foi flashado.\n3. A SuperKey está incorreta ou contém caracteres especiais.\n4. Seu dispositivo não oferece suporte ao APatch e KernelPatch.\n\nPor favor, verifique e tente novamente. Se ainda houver problemas, você pode fazer perguntas na página de problemas do repositório oficial.</string>
    <string name="home_more_menu_feedback_or_suggestion">Feedback ou sugestão</string>
    <string name="home_more_menu_about">Sobre</string>
    <string name="apm_webui_open">Abrir</string>
    <string name="enable_web_debugging">Ativar depuração do WebView</string>
    <string name="settings_donot_store_superkey_summary">Autentique a SuperKey sempre que o gerenciador iniciar</string>
    <string name="enable_web_debugging_summary">Pode ser usado para depurar o WebUI. Por favor, ative somente quando necessário.</string>
    <string name="settings_donot_store_superkey">Não armazenar a SuperKey no local</string>
    <string name="home_new_apatch_found">Nova versão %s está disponível, clique para atualizar.</string>
    <string name="patch_mode_install_to_next_slot">Modo: Instalar no slot inativo (Após o OTA)</string>
    <string name="home_device_info">Dispositivo</string>
    <string name="home_dialog_uninstall_ap_only">Desinstalar AndroidPatch</string>
    <string name="home_dialog_uninstall_all">Desinstalar tudo</string>
    <string name="home_install_unknown_summary">Clique para instalar</string>
    <string name="home_system_version">Versão do sistema</string>
    <string name="home_kpatch_version">Versão do KernelPatch</string>
    <string name="home_dialog_uninstall_title">Desinstalar</string>
    <string name="settings_night_theme_enabled">Ativar tema escuro</string>
    <string name="settings_use_system_color_theme">Tema de cores do sistema</string>
    <string name="settings_use_system_color_theme_summary">Use um tema de cores gerado pelo sistema com base no plano de fundo atual</string>
    <string name="settings_custom_color_theme">Tema de cores</string>
    <string name="green_theme">Verde</string>
    <string name="deep_orange_theme">Laranja profundo</string>
    <string name="lime_theme">Verde-limão</string>
    <string name="orange_theme">Laranja</string>
    <string name="teal_theme">Verde-azulado</string>
    <string name="kpm_control_failed">Operação falhou!</string>
    <string name="settings_night_mode_follow_sys_summary">Mude automaticamente para o tema escuro com base nas configurações do sistema</string>
    <string name="blue_theme">Azul</string>
    <string name="cyan_theme">Ciano</string>
    <string name="light_blue_theme">Azul claro</string>
    <string name="light_green_theme">Verde claro</string>
    <string name="pink_theme">Rosa</string>
    <string name="purple_theme">Roxo</string>
    <string name="red_theme">Vermelho</string>
    <string name="sakura_theme">Sakura</string>
    <string name="about_app_version">Versão %1$s</string>
    <string name="about_telegram_group">Grupo do Telegram</string>
    <string name="about_powered_by">Fornecido por %1$s</string>
    <string name="yellow_theme">Amarelo</string>
    <string name="about_telegram_channel">Canal do Telegram</string>
    <string name="kpm_control">Controlar</string>
    <string name="kpm_control_dialog_content">Parâmetros de controle de entrada:</string>
    <string name="kpm_control_paramters">Parâmetros</string>
    <string name="kpm_control_outMsg">Mensagem</string>
    <string name="kpm_control_ok">Operação bem-sucedida!</string>
    <string name="settings_night_mode_follow_sys">Seguir tema escuro do sistema</string>
    <string name="amber_theme">Âmbar</string>
    <string name="blue_grey_theme">Cinza-azulado</string>
    <string name="indigo_theme">Azul-anil</string>
    <string name="brown_theme">Marrom</string>
    <string name="deep_purple_theme">Roxo profundo</string>
    <string name="about_app_desc">Solução root do kernel com uma única imagem despojada, oferecendo a capacidade de montar módulos do sistema e interceptar funções do kernel.</string>
    <string name="kpm_control_dialog_title">Controlar KPMódulo</string>
    <string name="save_log">Salvar registros</string>
    <string name="apm_action">Ação</string>
    <string name="crash_handle_copied">Registro de falhas copiado.</string>
    <string name="crash_handle_title">O app travou…</string>
    <string name="crash_handle_copy">Copiar registro de falhas</string>
    <string name="log_saved">Registros salvos</string>
    <string name="settings_lite_mode">Ativar Modo lite</string>
    <string name="settings_lite_mode_mode_summary">As funções do APMódulo podem apresentar falhas após serem ativadas, mas em alguns casos ainda podem evitar a detecção. Reinicialização necessária.</string>
    <string name="settings_force_overlayfs_mode_summary">Use OverlayFS para montar os APMódulos em vez do Magic Mount, quando houver suporte no kernel. Reinicialização necessária.</string>
    <string name="settings_force_overlayfs_mode">Forçar o uso do OverlayFS</string>
</resources>

```

`app/src/main/res/values-pt/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="home">Início</string>
    <string name="patch_warnning">A instalação apresenta riscos. Certifique-se de ter um backup dos seus dados.</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="reboot">Reiniciar</string>
    <string name="settings">Configurações</string>
    <string name="reboot_recovery">Reiniciar em modo de recuperação</string>
    <string name="about">Sobre</string>
    <string name="home_learn_apatch">Aprender APatch</string>
    <string name="home_click_to_learn_apatch">Aprenda sobre as características de APatch e como usar</string>
    <string name="super_key">Chave de Segurança</string>
    <string name="patch_set_superkey">Definir Chave de Segurança</string>
    <string name="home_patch_next_step">Próximo passo</string>
    <string name="home_install_unknown">"Não foi instalado ou autenticado "</string>
    <string name="home_click_to_install">Clique para instalar</string>
    <string name="home_need_update">Nova versão Disponível</string>
    <string name="apatch_version">Versão: %s</string>
    <string name="home_auth_key_title">Digitar SuperKey</string>
    <string name="home_ap_cando_update">Atualizar</string>
    <string name="home_ap_cando_uninstall">Desinstalar</string>
    <string name="patch_title">Patch</string>
    <string name="home_kernel">Versão do Kernel</string>
    <string name="home_manager_version">Versão do gestor</string>
    <string name="home_selinux_status_disabled">Desativado</string>
    <string name="kpm">KPModulo</string>
    <string name="kpm_kp_not_installed">KernelPatch não instalado</string>
    <string name="kpm_load_toast_succ">Carregado com sucesso</string>
    <string name="kpm_load_toast_failed">Falha no carregamento</string>
    <string name="send_log">Enviar logs</string>
    <string name="safe_mode">Modo Seguro</string>
    <string name="home_patch_set_key_desc">Apenas credencial para KernelPatch</string>
    <string name="home_not_installed">Não instalado</string>
    <string name="kpatch_version">Versão: %s</string>
    <string name="home_working">Funcionado</string>
    <string name="home_installing">Instalando</string>
    <string name="apatch_version_update">Versão: %s -&gt; %s</string>
    <string name="home_ap_cando_install">Instalar</string>
    <string name="home_selinux_status_unknown">Desconhecido</string>
    <string name="kpm_load">Carregar</string>
    <string name="reboot_bootloader">Reiniciar em modo Bootloader</string>
    <string name="reboot_download">Reiniciar em modo Download</string>
    <string name="reboot_edl">Reiniciar em modo EDL</string>
    <string name="home_su_path">su executável</string>
    <string name="home_auth_key_desc">Comece trabalho após a certificação</string>
    <string name="home_fingerprint">Impressão digital</string>
    <string name="home_selinux_status">Estado do SELinux</string>
    <string name="home_selinux_status_enforcing">A impor</string>
    <string name="home_selinux_status_permissive">Permissivo</string>
    <string name="kpm_unload_confirm">Descarregar \"%s\" módulo ?</string>
    <string name="kpm_unload">Descarregar</string>
    <string name="kpm_apm_empty">Nenhum módulo carregado</string>
    <string name="su_selinux_via_hook">ignorar via hook</string>
    <string name="kpm_version">Versão</string>
    <string name="apm_downloading">Baixando o módulo \"%s\"…</string>
    <string name="about_source_code"><![CDATA[<p>Veja o código-fonte em %1$s<p/>Participe do nosso canal %2$s<p/>Participe do nosso grupo %3$s]]></string>
    <string name="clear_super_key">Limpar chave</string>
    <string name="home_apatch_version">Versão APatch</string>
    <string name="kpm_license">Licença</string>
    <string name="kpm_author">Autor</string>
    <string name="kpm_desc">Descrição</string>
    <string name="kpm_args">Argumentos</string>
    <string name="su_title">SuperUsuário</string>
    <string name="su_pkg_excluded_label">excluir</string>
    <string name="su_pkg_excluded_setting_title">Excluir modificações</string>
    <string name="su_pkg_excluded_setting_summary">Ativar esta opção permitirá que o APatch restaure quaisquer ficheiros modificados pelos módulos deste app.</string>
    <string name="su_show_system_apps">Mostrar apps do sistema</string>
    <string name="su_hide_system_apps">Ocultar apps do sistema</string>
    <string name="su_refresh">Atualizar</string>
    <string name="apm">APMódulo</string>
    <string name="apm_failed_to_enable">Não foi possível ativar o módulo %s</string>
    <string name="apm_failed_to_disable">Não foi possível desligar o módulo \"%s\"</string>
    <string name="apm_empty">Nenhum módulo instalado</string>
    <string name="apm_remove">Remover</string>
    <string name="apm_install">Instalar</string>
    <string name="apm_uninstall_confirm">Desinstalar o módulo \"%s\"?</string>
    <string name="apm_uninstall_success">%s desinstalado</string>
    <string name="apm_uninstall_failed">Não foi possível desinstalar %s</string>
    <string name="apm_version">Versão</string>
    <string name="apm_author">Autor</string>
    <string name="apm_desc">Descrição</string>
    <string name="apm_overlay_fs_not_available">Os módulos não estão disponíveis porque o OverlayFS está desabilitado pelo kernel!</string>
    <string name="apm_magisk_conflict">Os módulos estão indisponíveis devido a um conflito com Magisk!</string>
    <string name="apm_reboot_to_apply">Reinicie para entrar em vigor</string>
    <string name="apm_changelog">Registro de alterações</string>
    <string name="apm_start_downloading">Iniciando download: %s</string>
    <string name="apm_update">Atualizar</string>
    <string name="apm_new_version_available">Há uma nova versão disponível, %s, clique para atualizar.</string>
    <string name="apm_not_installed">AndroidPatch não instalado</string>
    <string name="system_default">Padrão do sistema</string>
    <string name="settings_app_language">Idioma</string>
    <string name="patch">Patch</string>
    <string name="settings_global_namespace_mode">Modo de namespace global</string>
    <string name="settings_global_namespace_mode_summary">Todas as sessões root usam o Global Mount Namespace</string>
    <string name="settings_check_update">Verificar atualizações</string>
    <string name="success">Sucesso</string>
    <string name="failure">Falha</string>
    <string name="settings_clear_super_key_dialog">Você realmente quer prosseguir?</string>
    <string name="settings_check_update_summary">Verifique automaticamente as atualizações ao abrir o aplicativo</string>
    <string name="home_install_unknown_summary">Clique para instalar</string>
    <string name="kpatch_version_update">Versão: %s -&gt; %s</string>
    <string name="home_kpatch_info_title">Informação</string>
    <string name="patch_select_bootimg_btn">Selecione a inicialização</string>
    <string name="patch_start_patch_btn">Início</string>
    <string name="patch_item_bootimg">inicialização</string>
    <string name="patch_item_extra_name">Nome:</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="home_ap_cando_reboot">Reiniciar</string>
    <string name="patch_config_title">Luz azul Tema</string>
    <string name="patch_mode_bootimg_patch">Modo: Patch</string>
    <string name="patch_item_kpimg_comile_time">Tempo:</string>
    <string name="patch_item_extra_version">Versão:</string>
    <string name="patch_item_extra_author">Autor:</string>
    <string name="patch_item_extra_kpm_license">Licença:</string>
    <string name="patch_item_extra_kpm_desciption">Descrição:</string>
    <string name="settings_custom_color_theme">Tema de cores</string>
    <string name="blue_grey_theme">Cinzento-azul</string>
    <string name="blue_theme">Azul</string>
    <string name="brown_theme">Castanho</string>
    <string name="cyan_theme">Ciano</string>
    <string name="deep_orange_theme">Laranja profundo</string>
    <string name="deep_purple_theme">Roxo profundo</string>
    <string name="green_theme">Verde</string>
    <string name="indigo_theme">Azul-anil</string>
    <string name="light_blue_theme">Azul claro</string>
    <string name="light_green_theme">Verde claro</string>
    <string name="lime_theme">Verde-limão</string>
    <string name="orange_theme">Laranja</string>
    <string name="pink_theme">Rosa</string>
    <string name="purple_theme">Roxo</string>
    <string name="red_theme">Vermelho</string>
    <string name="sakura_theme">Sakura</string>
    <string name="teal_theme">Verde-azulado</string>
    <string name="yellow_theme">Amarelo</string>
    <string name="about_telegram_channel">Canal do Telegram</string>
    <string name="about_telegram_group">Grupo do Telegram</string>
    <string name="about_app_version">Versão %1$s</string>
    <string name="about_powered_by">Alimentado por %1$s</string>
    <string name="about_app_desc">Solução root do kernel com uma única imagem despojada, oferecendo a capacidade de montar módulos do sistema e interceptar funções do kernel.</string>
    <string name="patch_mode_patch_and_install">Modo: Patch e instalar</string>
    <string name="home_dialog_auth_fail_content">Não foi possível autenticar a SuperKey, portanto o APatch não pode funcionar corretamente. \nAqui estão alguns possíveis motivos para a falha de autenticação:\n1. Não fez patch do boot.img com KernelPatch.\n2. O boot.img corrigido não foi flashado.\n3. A SuperKey está incorreta ou contém caracteres especiais.\n4. O seu dispositivo não oferece suporte ao APatch e KernelPatch.\n\nPor favor, verifique e tente novamente. Se ainda houver problemas, pode fazer perguntas na página de problemas do repositório oficial.</string>
    <string name="patch_mode_install_to_next_slot">Modo: Instalar no slot inativo (após OTA)</string>
    <string name="patch_mode_uninstall_patch">Modo: Desinstalar KPatch</string>
    <string name="patch_embed_kpm_btn">Introduzir KPM</string>
    <string name="patch_start_unpatch_btn">Desfazer o Patch</string>
    <string name="patch_item_error">ERRO!</string>
    <string name="patch_item_kpimg_config">Configuração:</string>
    <string name="patch_item_new_extra_kpm">Implementar novo</string>
    <string name="patch_item_existed_extra_kpm">Existia</string>
    <string name="patch_item_extra_args">Argumentos:</string>
    <string name="patch_item_skey">Chave Mestra</string>
    <string name="patch_item_set_skey_label">O comprimento da Chave Mestra deve ter pelo menos 8 caracteres e incluir números e letras.</string>
    <string name="home_kpatch_version">Versão do KernelPatch</string>
    <string name="hide_apatch_manager">Ocultar o gerenciador do Apatch</string>
    <string name="hide_apatch_manager_summary">Instalar um app de proxy com ID aleatório e nome personalizado</string>
    <string name="hide_apatch_dialog_new_manager_name">Nome do novo gestor</string>
    <string name="hide_apatch_dialog_summary">Ele será usado como a nova tag do aplicativo mostrado ao iniciar</string>
    <string name="hide_apatch_manager_failure">Falha ao ocultar. Por favor, reporte o bug!</string>
    <string name="setting_reset_su_path">Desfazer o acesso ao su</string>
    <string name="setting_reset_su_new_path">Novo caminho completo</string>
    <string name="enable_web_debugging">Ativar depuração do WebView</string>
    <string name="settings_donot_store_superkey">Não armazenar a SuperKey no local</string>
    <string name="settings_donot_store_superkey_summary">Autentique a SuperKey sempre que o gestor iniciar</string>
    <string name="mode_select_page_install_inactive_slot">Instalar no slot inativo (após o OTA)</string>
    <string name="mode_select_page_install_inactive_slot_warning">Seu dispositivo será **FORÇADO** a inicializar no slot inativo atual após uma reinicialização!
\nUse esta opção somente após a conclusão do OTA.
\nContinuar?</string>
    <string name="home_dialog_auth_fail_title">Falha na autenticação</string>
    <string name="home_more_menu_about">Acerca</string>
    <string name="kpm_control_dialog_title">Controlar KPModule</string>
    <string name="settings_night_theme_enabled">Ativar tema escuro</string>
    <string name="save_log">Salvar logs</string>
    <string name="mode_select_page_title">instalar</string>
    <string name="kpm_install">Instalar</string>
    <string name="patch_item_extra_event">Evento:</string>
    <string name="patch_item_bootimg_slot">slot:</string>
    <string name="patch_item_bootimg_dev">dispositivo:</string>
    <string name="patch_item_kernel">Kernel</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_kpimg_version">Versão:</string>
    <string name="home_device_info">Dispositivo</string>
    <string name="home_system_version">Versão do sistema</string>
    <string name="kpm_add_kpm">Adicionar KPM</string>
    <string name="kpm_embed">Embutido</string>
    <string name="kpm_control">Control</string>
    <string name="apm_webui_open">Abrir</string>
    <string name="enable_web_debugging_summary">Pode ser usado para depurar o WebUI. Por favor, ative somente quando necessário.</string>
    <string name="home_new_apatch_found">Nova versão %s está disponível, clique para atualizar.</string>
    <string name="mode_select_page_select_file">Selecione uma imagem de inicialização para corrigir</string>
    <string name="mode_select_page_patch_and_install">Patch e instalação</string>
    <string name="home_more_menu_feedback_or_suggestion">Feedback ou sugestão</string>
    <string name="home_dialog_uninstall_ap_only">Remover AndroidPatch</string>
    <string name="home_dialog_uninstall_all">Desinstalar tudo</string>
    <string name="home_dialog_uninstall_title">Desinstalar</string>
    <string name="kpm_control_dialog_content">Parâmetros de controle de entrada:</string>
    <string name="kpm_control_ok">A operação foi bem sucedida!</string>
    <string name="kpm_control_failed">A operação falhou!</string>
    <string name="settings_night_mode_follow_sys">Seguir tema escuro do sistema</string>
    <string name="kpm_control_paramters">Parâmetros</string>
    <string name="kpm_control_outMsg">Mensagem</string>
    <string name="settings_night_mode_follow_sys_summary">Mude automaticamente para o tema escuro com base nas configurações do sistema</string>
    <string name="settings_use_system_color_theme">Tema de cores do sistema</string>
    <string name="settings_use_system_color_theme_summary">Use um tema de cores gerado pelo sistema com base no plano de fundo atual</string>
    <string name="amber_theme">Âmbar</string>
    <string name="apm_action">Ação</string>
    <string name="log_saved">Logs salvos</string>
    <string name="crash_handle_title">A app travou…</string>
    <string name="crash_handle_copy">Copiar registro de falha</string>
    <string name="crash_handle_copied">Registo de falhas copiado.</string>
    <string name="settings_lite_mode">Habilitar modo leve</string>
    <string name="settings_lite_mode_mode_summary">Funções APModule podem exibir falhas após serem habilitadas, mas em alguns casos elas conseguem evitar detecção eficientemente. Necessário reinicialização.</string>
    <string name="settings_force_overlayfs_mode">Forçar o uso de OverlayFS</string>
    <string name="settings_force_overlayfs_mode_summary">Usar OverlayFS para montar APModules ao invés de Magic Mount quando o suporte ao kernel estiver disponível. Necessário reinicialização.</string>
</resources>

```

`app/src/main/res/values-ro/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="home">Acasă</string>
    <string name="patch_warnning">Instalarea implică riscuri. Asigură-te că datele tale sunt salvate.</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="reboot">Repornește</string>
    <string name="settings">Setări</string>
    <string name="reboot_recovery">Repornește la Recovery</string>
    <string name="reboot_bootloader">Repornește la Bootloader</string>
    <string name="reboot_download">Repornește la Download</string>
    <string name="reboot_edl">Repornește la EDL</string>
    <string name="about">Despre</string>
    <string name="home_learn_apatch">Invata APatch</string>
    <string name="about_source_code">Vezi codul sursă la %1$s<br/> Alătură-te canalului nostru %2$s <p/>Devin-o membrul grupului %3$s</string>
    <string name="send_log">Trimite log-uri</string>
    <string name="clear_super_key">Șterge cheia</string>
    <string name="patch_set_superkey">Setează Superkey</string>
    <string name="home_patch_set_key_desc">Doar acreditări pentru KernelPatch</string>
    <string name="home_patch_next_step">Pasul următor</string>
    <string name="home_not_installed">Neinstalat</string>
    <string name="home_install_unknown">Necunoscut</string>
    <string name="home_click_to_install">Apasă pentru a instala</string>
    <string name="home_working">Funcțional</string>
    <string name="home_installing">Instalare</string>
    <string name="home_need_update">Versiune nouă disponibilă</string>
    <string name="kpatch_version">Versiune: %s</string>
    <string name="apatch_version">Versiune:
\n%s</string>
    <string name="apatch_version_update">Versiune:
\n%s -&gt; %s</string>
    <string name="home_su_path">Executable su</string>
    <string name="home_apatch_version">Versiune APatch</string>
    <string name="home_auth_key_title">Introdu Superkey</string>
    <string name="home_auth_key_desc">Pornește după certificare</string>
    <string name="home_ap_cando_install">Instalează</string>
    <string name="home_ap_cando_update">Actualizează</string>
    <string name="home_ap_cando_uninstall">Dezinstalează</string>
    <string name="patch_title">Patch</string>
    <string name="home_kernel">Versiune de kernel</string>
    <string name="home_fingerprint">Amprentă</string>
    <string name="home_selinux_status_enforcing">Obligatoriu</string>
    <string name="home_selinux_status_permissive">Permisiv</string>
    <string name="home_selinux_status_unknown">Necunoscut</string>
    <string name="kpm_kp_not_installed">KernelPatch neinstalat</string>
    <string name="kpm_load">Încarcă</string>
    <string name="kpm_load_toast_succ">Încărcare reușită</string>
    <string name="kpm_load_toast_failed">Încărcare nereușită</string>
    <string name="kpm_unload_confirm">Anulezi încărcarea modulului \"%s\"?</string>
    <string name="kpm_unload">Anulează încărcarea</string>
    <string name="kpm_apm_empty">Niciun modul încărcat</string>
    <string name="kpm_version">Versiune</string>
    <string name="kpm_license">Licență</string>
    <string name="kpm_author">Autor</string>
    <string name="kpm_desc">Descriere</string>
    <string name="kpm_args">Argumente</string>
    <string name="su_title">Super-utilizator</string>
    <string name="su_selinux_via_hook">ocolire prin hook</string>
    <string name="su_pkg_excluded_setting_title">Exclude Modificarile</string>
    <string name="su_pkg_excluded_setting_summary">Activarea acestei opțiuni va permite APatch să restaureze orice fișiere modificate de către modulele pentru această aplicație.</string>
    <string name="su_show_system_apps">Arată aplicațiile de sistem</string>
    <string name="su_hide_system_apps">Ascunde aplicațiile de sistem</string>
    <string name="su_refresh">Reîmprospătează</string>
    <string name="apm">APModule</string>
    <string name="apm_not_installed">AndroidPatch nu este instalat</string>
    <string name="apm_failed_to_enable">Nu se poate porni modulul \"%s\"</string>
    <string name="apm_empty">Niciun modul instalat</string>
    <string name="apm_remove">Elimină</string>
    <string name="apm_install">Instalează</string>
    <string name="apm_uninstall_confirm">Dezinstalezi modulul \"%s\"?</string>
    <string name="apm_uninstall_success">%s dezinstalat</string>
    <string name="apm_uninstall_failed">Nu s-a putut dezinstala %s</string>
    <string name="apm_version">Versiune</string>
    <string name="apm_new_version_available">Versiunea noua disponibila: %s, apasă pentru a actualiza.</string>
    <string name="apm_author">Autor</string>
    <string name="apm_desc">Descriere</string>
    <string name="apm_overlay_fs_not_available">Modulele nu sunt disponibile deoarece OverlayFS este dezactivat de kernel!</string>
    <string name="apm_magisk_conflict">Modulele nu sunt disponibile din cauza unui conflict cu Magisk!</string>
    <string name="apm_reboot_to_apply">Repornește pentru a intra în vigoare</string>
    <string name="apm_changelog">Jurnalul modificărilor</string>
    <string name="apm_update">Actualizează</string>
    <string name="apm_downloading">Descărcarea modulului \"%s\"…</string>
    <string name="apm_start_downloading">Începe descărcarea %s</string>
    <string name="home_click_to_learn_apatch">Afla despre funcționalitațile din APatch și cum să le folosești</string>
    <string name="safe_mode">Mod sigur</string>
    <string name="super_key">SuperKey</string>
    <string name="home_manager_version">Versiunea de manager</string>
    <string name="home_selinux_status">Stare SELinux</string>
    <string name="home_selinux_status_disabled">Dezactivat</string>
    <string name="su_pkg_excluded_label">exclude</string>
    <string name="kpm">KPModule</string>
    <string name="apm_failed_to_disable">Nu se poate opri modulul \"%s\"</string>
    <string name="settings_app_language">Limbă</string>
    <string name="system_default">Implicit de sistem</string>
    <string name="patch">Interval</string>
    <string name="settings_global_namespace_mode">Modul namespace global</string>
    <string name="settings_global_namespace_mode_summary">Toate sesiunile root folosesc spațiul de nume de montare global</string>
    <string name="success">Succes</string>
    <string name="failure">Eșec</string>
    <string name="settings_clear_super_key_dialog">Ești sigur ca vrei să continui?</string>
    <string name="settings_check_update">Verifică pentru actualizări</string>
    <string name="settings_check_update_summary">Verificare automată a actualizarilor la deschiderea aplicației</string>
    <string name="home_install_unknown_summary">Click pentru instalare</string>
    <string name="kpatch_version_update">Versiune: %s -&gt; %s</string>
    <string name="home_kpatch_info_title">Informații</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="home_ap_cando_reboot">Restart</string>
    <string name="save_log">Salvează log-urile</string>
    <string name="patch_config_title">selectia</string>
    <string name="patch_mode_bootimg_patch">Mod: Patch</string>
    <string name="patch_mode_patch_and_install">Mod: Patch și instalează</string>
    <string name="patch_mode_uninstall_patch">Mod: Dezinstalează KPatch</string>
    <string name="patch_select_bootimg_btn">Selectați boot</string>
    <string name="patch_mode_install_to_next_slot">Modalitate: Instalați în slotul inactiv (După OTA)</string>
    <string name="patch_embed_kpm_btn">Încorporați KPM</string>
    <string name="patch_start_patch_btn">Incepe</string>
    <string name="patch_start_unpatch_btn">UnPatch</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_kpimg_version">Versiune:</string>
    <string name="patch_item_kpimg_config">Configurație:</string>
    <string name="patch_item_new_extra_kpm">Incorporeaza nou</string>
    <string name="patch_item_kpimg_comile_time">Timp:</string>
    <string name="patch_item_bootimg">bootimg</string>
    <string name="patch_item_error">!!EROARE!!</string>
    <string name="patch_item_bootimg_slot">slot:</string>
    <string name="patch_item_kernel">Nucleu:</string>
    <string name="patch_item_bootimg_dev">dispozitiv</string>
    <string name="mode_select_page_title">Instaleaza</string>
    <string name="mode_select_page_install_inactive_slot_warning">Dispozitivul dvs. va fi **Forțat** să pornească în slotul inactiv curent după o repornire!
\nFolosiți această opțiune numai după terminarea OTA.
\nContinua?</string>
    <string name="purple_theme">Mov</string>
    <string name="red_theme">Roșu</string>
    <string name="sakura_theme">Sakura</string>
    <string name="hide_apatch_manager">Ascunde APatch Manager</string>
    <string name="hide_apatch_manager_summary">Instalați o nouă aplicație de proxy cu un ID aleatoriu și o etichetă personalizată a aplicației</string>
    <string name="enable_web_debugging_summary">Poate fi folosit pentru a depana WebUI. Vă rugăm să activați numai când aveți nevoie.</string>
    <string name="settings_donot_store_superkey">Nu stocați Cheia Super local</string>
    <string name="settings_donot_store_superkey_summary">Autentificați Cheia Super de fiecare dată când managerul pornește</string>
    <string name="home_new_apatch_found">Versiune noua disponibila: %s, apasă pentru a actualiza.</string>
    <string name="mode_select_page_patch_and_install">Aplică Modificarea și instalează</string>
    <string name="mode_select_page_select_file">Selectați o imagine de pornire pentru modificare</string>
    <string name="mode_select_page_install_inactive_slot">Instalați în slot inactiv (după OTA)</string>
    <string name="home_dialog_auth_fail_title">Autentificare nereusita</string>
    <string name="teal_theme">Verde-țiu</string>
    <string name="yellow_theme">Galben</string>
    <string name="about_app_version">Versiunea %1$s</string>
    <string name="enable_web_debugging">Activați depanarea WebView</string>
    <string name="setting_reset_su_path">Resetați calea</string>
    <string name="setting_reset_su_new_path">Cale noua deplina</string>
    <string name="amber_theme">Tema amber</string>
    <string name="blue_grey_theme">Tema albastru gri</string>
    <string name="cyan_theme">Cian</string>
    <string name="brown_theme">Tema maro</string>
    <string name="deep_orange_theme">Tema portocaliu adânc</string>
    <string name="apm_action">Actiune</string>
    <string name="settings_custom_color_theme">Tema de culoare</string>
    <string name="blue_theme">Tema albastru</string>
    <string name="deep_purple_theme">Tema mov adânc</string>
    <string name="green_theme">Verde</string>
    <string name="indigo_theme">Indigo</string>
    <string name="light_blue_theme">Albastru deschis</string>
    <string name="light_green_theme">Verde deschis</string>
    <string name="lime_theme">Lime</string>
    <string name="orange_theme">Portocaliu</string>
    <string name="pink_theme">Roz</string>
    <string name="apm_webui_open">Deschis</string>
    <string name="home_dialog_auth_fail_content">Nu se poate autentifica Cheia Super, prin urmare APatch nu poate funcționa corect.\nAici sunt câteva motive posibile pentru eșecul autentificării:\n1. Nu ați modificat fișierul boot.img utilizând KernelPatch.\n2. Imaginea de pornire boot.img nu a fost integrată.\n3. Cheia Super este greșită sau conține caractere speciale.\n4. Dispozitivul dvs. nu acceptă APatch și KernelPatch.\n\nVă rugăm să verificați și să încercați din nou. Dacă există încă probleme, puteți oricând să puneți întrebări pe pagina de probleme a repozitorului oficial.</string>
    <string name="settings_use_system_color_theme_summary">Utilizați o temă de culoare generată de sistem bazat pe fundalul actual</string>
    <string name="home_device_info">Dispozitiv</string>
    <string name="kpm_add_kpm">Adaugă KPM</string>
    <string name="kpm_install">Instalează</string>
    <string name="settings_night_mode_follow_sys">Urmați Tema întunecată al sistemului</string>
    <string name="patch_item_extra_version">Versiune:</string>
    <string name="patch_item_extra_author">Autor:</string>
    <string name="patch_item_extra_args">Argumente:</string>
    <string name="kpm_control_paramters">Parametri</string>
    <string name="kpm_control_outMsg">Mesaj</string>
    <string name="kpm_control_ok">Operațiune reusită!</string>
    <string name="kpm_control_failed">Operațiune ieșuată!</string>
    <string name="settings_night_mode_follow_sys_summary">Schimbați automat la tema întunecată bazat pe setările sistemului</string>
    <string name="settings_night_theme_enabled">"Activează tema Întunecată "</string>
    <string name="settings_use_system_color_theme">Tema de culoare a sistemului</string>
    <string name="patch_item_existed_extra_kpm">Existent</string>
    <string name="patch_item_extra_kpm_license">Licență:</string>
    <string name="patch_item_extra_kpm_desciption">Descripție:</string>
    <string name="patch_item_extra_event">Eveniment:</string>
    <string name="patch_item_skey">Cheie Super</string>
    <string name="patch_item_set_skey_label">Lungimea cheii super trebuie să fie între 8-63 caractere și să include numere si litere, dar nu caractere speciale.</string>
    <string name="home_system_version">Versiune de sistem</string>
    <string name="home_kpatch_version">Versiune KernelPatch</string>
    <string name="kpm_control">Verifica</string>
    <string name="hide_apatch_dialog_new_manager_name">Nume nou manager</string>
    <string name="hide_apatch_dialog_summary">Va fi folosit ca noua etichetă a aplicației afișată în launcher</string>
    <string name="hide_apatch_manager_failure">Nu s-a ascuns, vă rugăm să raportați eroarea!</string>
    <string name="home_more_menu_feedback_or_suggestion">Feedback sau sugestie</string>
    <string name="about_telegram_channel">Canalul Telegram</string>
    <string name="home_more_menu_about">Despre</string>
    <string name="home_dialog_uninstall_title">Dezinstaleaza</string>
    <string name="home_dialog_uninstall_ap_only">Elimina AndroidPatch</string>
    <string name="home_dialog_uninstall_all">Dezinstalează tot</string>
    <string name="kpm_control_dialog_title">Controlați KPModule</string>
    <string name="kpm_control_dialog_content">Indicați parametrii de verificare:</string>
    <string name="about_telegram_group">Grupul Telegram</string>
    <string name="about_app_desc">Soluție Kernel Root cu doar o imagine goală a kernel-ului, oferind abilitatea de a monta modulul de sistem și de a lega funcția kernel.</string>
    <string name="about_powered_by">Produs de %1$s</string>
    <string name="kpm_embed">Încorporează</string>
    <string name="patch_item_extra_name">Nume:</string>
    <string name="log_saved">Jurnal salvat</string>
    <string name="crash_handle_title">Aplicația s-a blocat…</string>
    <string name="crash_handle_copy">Copiază jurnalul de eroare</string>
    <string name="crash_handle_copied">Jurnal de eroare copiat în clipboard.</string>
    <string name="settings_lite_mode">Activați mod Lite</string>
    <string name="settings_lite_mode_mode_summary">Funcții APModule pot prezenta eșecuri după ce sunt pornite, dar în câteva cazuri ele pot în continuare sa evadeze detecție. Repornire nevoită.</string>
    <string name="settings_force_overlayfs_mode">Forțează utilizarea de OverlayFS</string>
    <string name="settings_force_overlayfs_mode_summary">Utilizați OverlayFS sa montați APModules în loc de Magic Mount când suport de kernel este disponibil. Repornire nevoită.</string>
</resources>

```

`app/src/main/res/values-ru/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="home">Главная</string>
    <string name="super_key">СуперКлюч</string>
    <string name="patch_warnning">Пожалуйста, убедитесь, что у вас есть резервная копия ваших данных. Установка сопряжена с рисками.</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="home_not_installed">Не установлено</string>
    <string name="home_install_unknown">Не установлено или не авторизовано</string>
    <string name="home_click_to_install">Нажмите чтобы установить</string>
    <string name="home_working">Работает 😋</string>
    <string name="home_installing">Установка</string>
    <string name="home_need_update">Доступна новая версия</string>
    <string name="kpatch_version">Версия: %s</string>
    <string name="apatch_version">Версия: %s</string>
    <string name="apatch_version_update">Версия: %s → %s</string>
    <string name="home_su_path">Исполняемый файл su</string>
    <string name="home_apatch_version">Версия APatch</string>
    <string name="home_kernel">Версия ядра</string>
    <string name="home_manager_version">Версия менеджера</string>
    <string name="home_fingerprint">Отпечаток</string>
    <string name="home_selinux_status">Состояние SELinux</string>
    <string name="home_selinux_status_disabled">Отключено</string>
    <string name="home_selinux_status_enforcing">Принудительный</string>
    <string name="home_selinux_status_permissive">Разрешающий</string>
    <string name="home_selinux_status_unknown">Неизвестно</string>
    <string name="su_title">SuperUser</string>
    <string name="apm_failed_to_enable">Не удалось включить модуль \"%s\"</string>
    <string name="apm_failed_to_disable">Не удалось отключить модуль \"%s\"</string>
    <string name="apm_empty">Модуль не установлен</string>
    <string name="kpm">Модули KP</string>
    <string name="apm">Модули AP</string>
    <string name="apm_remove">Удалить</string>
    <string name="kpm_load">Загрузить</string>
    <string name="apm_install">Установить</string>
    <string name="reboot">Перезагрузить</string>
    <string name="settings">Настройки</string>
    <string name="reboot_recovery">Перезагрузить в режим Recovery</string>
    <string name="reboot_bootloader">Перезагрузить в Bootloader</string>
    <string name="reboot_download">Перезагрузить в Download</string>
    <string name="reboot_edl">Перезагрузить в EDL</string>
    <string name="about">О приложении</string>
    <string name="apm_uninstall_confirm">Удалить модуль \"%s\"?</string>
    <string name="apm_uninstall_success">%s удален</string>
    <string name="apm_uninstall_failed">Не удалось удалить %s</string>
    <string name="apm_version">Версия</string>
    <string name="apm_author">Автор</string>
    <string name="apm_desc">Описание</string>
    <string name="apm_overlay_fs_not_available">Модули недоступны, так как OverlayFS отключен в ядре!</string>
    <string name="su_refresh">Обновить</string>
    <string name="su_show_system_apps">Показать системные приложения</string>
    <string name="su_hide_system_apps">Скрыть системные приложения</string>
    <string name="send_log">Отправить журналы</string>
    <string name="safe_mode">Безопасный режим</string>
    <string name="apm_reboot_to_apply">Перезагрузите, чтобы изменения вступили в силу</string>
    <string name="apm_magisk_conflict">Модули недоступны из-за конфликта с Magisk!</string>
    <string name="home_learn_apatch">Узнать больше про APatch</string>
    <string name="home_click_to_learn_apatch">Узнайте о возможностях APatch и о том, как его использовать</string>
    <string name="about_source_code"><![CDATA[<p>Посмотрите исходный код на %1$s<p/>Присоединяйтесь к нашему каналу %2$s</p>Присоединяйтесь к нашей группе %3$s]]></string>
    <string name="apm_update">Обновить</string>
    <string name="apm_downloading">Скачивание модуля \"%s\"…</string>
    <string name="apm_start_downloading">Начало скачивания %s</string>
    <string name="apm_new_version_available">Доступна новая версия %s, нажмите для обновления.</string>
    <string name="apm_changelog">Список изменений</string>
    <string name="patch_set_superkey">Установить СуперКлюч</string>
    <string name="kpm_load_toast_failed">Загрузка не удалась</string>
    <string name="home_auth_key_desc">Начать после сертификации</string>
    <string name="home_patch_set_key_desc">Ключ только для KernelPatch</string>
    <string name="home_patch_next_step">Далее</string>
    <string name="home_auth_key_title">Введите СуперКлюч</string>
    <string name="patch_title">Патч</string>
    <string name="kpm_kp_not_installed">KernelPatch не установлен</string>
    <string name="kpm_load_toast_succ">Загружено успешно</string>
    <string name="kpm_unload">Выгрузить</string>
    <string name="kpm_apm_empty">Модуль не загружен</string>
    <string name="kpm_version">Версия</string>
    <string name="kpm_license">Лицензия</string>
    <string name="kpm_author">Автор</string>
    <string name="kpm_desc">Описание</string>
    <string name="kpm_args">Аргументы</string>
    <string name="su_selinux_via_hook">обход через хук</string>
    <string name="su_pkg_excluded_label">исключён</string>
    <string name="su_pkg_excluded_setting_title">Запретить изменения</string>
    <string name="su_pkg_excluded_setting_summary">Включение этой опции позволит APatch восстановить любые файлы этого приложения, которые были модифицированы модулями.</string>
    <string name="home_ap_cando_install">Установить</string>
    <string name="home_ap_cando_update">Обновить</string>
    <string name="home_ap_cando_uninstall">Деинсталлировать</string>
    <string name="kpm_unload_confirm">Выгрузить модуль \"%s\"?</string>
    <string name="clear_super_key">Стереть СуперКлюч</string>
    <string name="apm_not_installed">AndroidPatch не установлен</string>
    <string name="settings_app_language">Язык</string>
    <string name="system_default">Как в системе</string>
    <string name="patch">Патч</string>
    <string name="settings_global_namespace_mode">Режим глобального пространства имён</string>
    <string name="settings_global_namespace_mode_summary">Все сеансы суперпользователя root используют монтирование глобального пространства имён</string>
    <string name="kpatch_version_update">Версия: %s → %s</string>
    <string name="home_kpatch_info_title">Подробнее</string>
    <string name="home_ap_cando_reboot">Перезагрузить</string>
    <string name="patch_config_title">Патчи</string>
    <string name="patch_mode_uninstall_patch">Режим: Удаление KPatch</string>
    <string name="patch_select_bootimg_btn">Выберите boot</string>
    <string name="patch_embed_kpm_btn">Встроить KPM</string>
    <string name="patch_start_patch_btn">Начать</string>
    <string name="patch_start_unpatch_btn">Отмена патча</string>
    <string name="patch_item_error">!!ОШИБКА!!</string>
    <string name="patch_item_bootimg">bootimg</string>
    <string name="patch_item_bootimg_slot">слот:</string>
    <string name="patch_item_bootimg_dev">устройство:</string>
    <string name="patch_item_kernel">Ядро</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_kpimg_comile_time">"Время:"</string>
    <string name="patch_item_kpimg_config">"Настройка:"</string>
    <string name="patch_item_new_extra_kpm">Встроить новый</string>
    <string name="patch_item_existed_extra_kpm">Встраиваемый</string>
    <string name="patch_item_extra_kpm_desciption">"Описание:"</string>
    <string name="patch_item_extra_args">"Аргументы:"</string>
    <string name="patch_item_extra_event">"Событие:"</string>
    <string name="patch_item_skey">СуперКлюч</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="patch_mode_bootimg_patch">Режим: Патч</string>
    <string name="patch_mode_patch_and_install">Режим: Патчить и установить</string>
    <string name="patch_item_kpimg_version">"Версия:"</string>
    <string name="patch_item_extra_name">Название:</string>
    <string name="patch_item_extra_version">"Версия:"</string>
    <string name="patch_item_extra_author">"Автор:"</string>
    <string name="patch_item_extra_kpm_license">"Лицензия:"</string>
    <string name="settings_clear_super_key_dialog">Вы действительно хотите продолжить?</string>
    <string name="patch_item_set_skey_label">Длина СуперКлюч должна быть не менее 8 символов и включать только цифры и буквы.</string>
    <string name="failure">Ошибка</string>
    <string name="kpm_install">Установить</string>
    <string name="kpm_embed">Встроить</string>
    <string name="kpm_add_kpm">Добавить KPM</string>
    <string name="success">Успешно</string>
    <string name="hide_apatch_manager">Скрыть менеджер APatch</string>
    <string name="hide_apatch_manager_failure">Не удалось скрыть. Пожалуйста, сообщите об ошибке!</string>
    <string name="hide_apatch_dialog_summary">Оно будет использоваться как новое название приложения</string>
    <string name="hide_apatch_dialog_new_manager_name">Новое название менеджера</string>
    <string name="setting_reset_su_path">Изменить путь к su</string>
    <string name="hide_apatch_manager_summary">Установите прокси-приложение со случайным ID пакета и польз. ярлыком приложения</string>
    <string name="setting_reset_su_new_path">Новый полный путь</string>
    <string name="cyan_theme">Бирюзовая</string>
    <string name="pink_theme">Розовая</string>
    <string name="lime_theme">Лаймовая</string>
    <string name="mode_select_page_select_file">Выберите образ boot, который следует пропатчить</string>
    <string name="settings_donot_store_superkey">Не хранить СуперКлюч в памяти устройства</string>
    <string name="mode_select_page_install_inactive_slot_warning">Ваше устройство будет **ПРИНУДЕТЕЛЬНО** загружено в текущий неактивный слот после перезагрузки!\nИспользуйте эту опцию только после успешной установки OTA.\nПродолжить?</string>
    <string name="kpm_control">Управление</string>
    <string name="mode_select_page_patch_and_install">Пропатчить и установить</string>
    <string name="settings_donot_store_superkey_summary">Вам придётся вводить СуперКлюч каждый раз при открытии менеджера</string>
    <string name="home_dialog_auth_fail_content">Не удалось проверить суперключ, поэтому APatch не может работать.\nВот некоторые возможные причины этой ошибки:\n1. Вы не пропатчили boot.img с помощью KernelPatch.\n2. Вы забыли прошить патченный boot.img\n3. Неверный СуперКлюч.\n4. Ваше устройство не поддерживает APatch и KernelPatch.\n\nПожалуйста, установите APatch повторно и проверьте, правильный ли суперключ вы вводите. Если это не помогло, сообщите нам об ошибке или задайте вопрос в Issues официального репозитория.</string>
    <string name="home_more_menu_about">О приложении</string>
    <string name="home_dialog_uninstall_ap_only">Удалить AndroidPatch</string>
    <string name="kpm_control_dialog_title">Управление KPModule</string>
    <string name="kpm_control_ok">Операция выполнена успешно!</string>
    <string name="orange_theme">Оранжевая</string>
    <string name="settings_night_mode_follow_sys_summary">Автоматически переключаться на тёмную тему, соблюдая системные настройки</string>
    <string name="about_app_desc">Решение для получения прав суперпользователя, работающее на уровне ядра, предоставляющее возможность монтировать модули системы и модифицировать функции ядра.</string>
    <string name="about_telegram_channel">Канал в Telegram</string>
    <string name="about_telegram_group">Группа в Telegram</string>
    <string name="about_powered_by">Основано на %1$s</string>
    <string name="home_install_unknown_summary">Нажмите, чтобы установить</string>
    <string name="home_kpatch_version">Версия KernelPatch</string>
    <string name="home_new_apatch_found">Доступна новая версия: %s, Нажмите здесь для обновления.</string>
    <string name="mode_select_page_title">Установить</string>
    <string name="mode_select_page_install_inactive_slot">Установить в неактивный слот (после OTA)</string>
    <string name="home_dialog_auth_fail_title">Ошибка авторизации</string>
    <string name="home_dialog_uninstall_all">Полное удаление</string>
    <string name="home_more_menu_feedback_or_suggestion">Обратная связь и предложения</string>
    <string name="home_dialog_uninstall_title">Удалить</string>
    <string name="kpm_control_dialog_content">Введите параметры контроля:</string>
    <string name="kpm_control_paramters">Параметры</string>
    <string name="kpm_control_outMsg">Сообщение</string>
    <string name="kpm_control_failed">Операция не удалась!</string>
    <string name="settings_night_mode_follow_sys">Придерживаться тёмной темы системы</string>
    <string name="settings_use_system_color_theme">Системная цветовая тема</string>
    <string name="settings_use_system_color_theme_summary">Использовать цветовую тему, созданную системой на основе текущих обоев</string>
    <string name="settings_custom_color_theme">Цветовая тема</string>
    <string name="deep_orange_theme">Тёмно-оранжевая</string>
    <string name="deep_purple_theme">Тёмно-фиолетовая</string>
    <string name="light_blue_theme">Голубая</string>
    <string name="light_green_theme">Салатовая</string>
    <string name="purple_theme">Фиолетовая</string>
    <string name="red_theme">Красная</string>
    <string name="sakura_theme">Сакура</string>
    <string name="teal_theme">Морская</string>
    <string name="yellow_theme">Жёлтая</string>
    <string name="green_theme">Зелёная</string>
    <string name="indigo_theme">Индиго</string>
    <string name="patch_mode_install_to_next_slot">Режим: Установить в неактивный слот (После OTA)</string>
    <string name="about_app_version">Версия %1$s</string>
    <string name="apm_webui_open">Открыть</string>
    <string name="settings_check_update">Проверьте наличие обновлений</string>
    <string name="settings_check_update_summary">Автоматическая проверка обновлений при открытии приложения</string>
    <string name="home_device_info">Устройство</string>
    <string name="home_system_version">Версия системы</string>
    <string name="settings_night_theme_enabled">Включить темную тему</string>
    <string name="enable_web_debugging">Включить отладку WebView</string>
    <string name="amber_theme">Янтарная</string>
    <string name="brown_theme">Коричневая</string>
    <string name="blue_grey_theme">Сине-серая</string>
    <string name="blue_theme">Синяя</string>
    <string name="enable_web_debugging_summary">Используется для отладки WebUI. Пожалуйста, включайте только при необходимости.</string>
    <string name="save_log">Сохранить журналы</string>
    <string name="apm_action">Действие</string>
    <string name="crash_handle_copy">Скопировать журнал сбоев</string>
    <string name="crash_handle_copied">Журнал сбоев скопирован в буфер обмена.</string>
    <string name="log_saved">Логи сохранены</string>
    <string name="crash_handle_title">Сбой приложения…</string>
    <string name="settings_lite_mode">Включить режим Lite</string>
    <string name="settings_lite_mode_mode_summary">Функции APModule могут проявлять сбои после включения, но в некоторых случаях они все еще могут эффективно избегать обнаружения. Требуется перезагрузка.</string>
    <string name="settings_force_overlayfs_mode">Принудительное использование OverlayFS</string>
    <string name="settings_force_overlayfs_mode_summary">Используйте OverlayFS для монтирования APModules вместо Magic Mount, когда поддержка ядра доступна. Требуется перезагрузка.</string>
</resources>

```

`app/src/main/res/values-si/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="home">මුල් පිටුව</string>
    <string name="reboot">Restart කරන්න</string>
    <string name="about">APatch පිළිබඳ</string>
    <string name="super_key">මුරපදය</string>
    <string name="patch_set_superkey">නව මුර පදයක් සෑදීම</string>
    <string name="home_patch_set_key_desc">ඔබගේ මුරපදය ඇතුළත් කරන්න</string>
    <string name="home_patch_next_step">ඉදිරියට</string>
    <string name="home_not_installed">ස්ථාපනය වී නොමැත</string>
    <string name="home_click_to_install">ස්ථාපනය කරන්න</string>
    <string name="home_need_update">නව අනුවාදයක් තිබේ</string>
    <string name="home_ap_cando_install">ස්ථාපනය කරන්න</string>
    <string name="home_ap_cando_uninstall">ඉවත් කරන්න</string>
    <string name="kpm_kp_not_installed">KernelPatch ස්ථාපනය කර නොමැත</string>
    <string name="kpm_author">කතෲ</string>
    <string name="apm_not_installed">AndroidPatch ස්ථාපනය කර නොමැත</string>
    <string name="apm_empty">කිසිම module එකක් නොමැත</string>
    <string name="apm_install">ස්ථාපනය කරන්න</string>
    <string name="apm_uninstall_confirm">මෙම මොඩියුලය ඉවත් කිරීමට අවශ්‍ය ද %s ?</string>
    <string name="apm_uninstall_success">%s ඉවත් කරන ලදී</string>
    <string name="apm_uninstall_failed">ඉවත් කිරීමට නොහැකි විය: %s</string>
    <string name="apm_failed_to_disable">මෙම මොඩියුලය ක්‍රියාවිරහිත කිරීමට නොහැකි විය: %s</string>
    <string name="apm_reboot_to_apply">Apply කිරීම සඳහා reboot කිරීම අනිවාර්ය වේ</string>
    <string name="apm_new_version_available">නව අනුවාදය ස්ථාපනයට ඔබන්න, %s.</string>
    <string name="home_learn_apatch">AndroidPatch ගැන ඉගෙන ගන්න</string>
    <string name="home_click_to_learn_apatch">මෙතන Click කරන්න</string>
    <string name="patch_warnning">Install කරද්දි මොකක්ම හරි අවුලක් ආවොත් ඔයාගේ Data lost වේවි. ඒක නිසා වැදගත් දේවල් Backup කරගෙනම ඉන්න.</string>
    <string name="send_log">Log යවන්න</string>
    <string name="clear_super_key">මුරපදය මකා දමන්න</string>
    <string name="home_install_unknown">හඳුනා ගැනීමට නොහැක</string>
    <string name="home_auth_key_desc">මුරපදය ඇතුළත් කරන්න</string>
    <string name="home_working">වැඩ කරමින් තිබේ</string>
    <string name="su_hide_system_apps">System Apps පෙන්වීම නතර කරන්න</string>
    <string name="home_installing">ස්ථාපනය කරමින්</string>
    <string name="su_show_system_apps">System Apps ද පෙන්වන්න</string>
    <string name="home_auth_key_title">මුරපදය</string>
    <string name="apm_overlay_fs_not_available">ඔයාගේ Kernel එකේ OverlayFS කියන function එක enable වෙලා නැහැ. මේකට අපිටම කියලා OverlayFS enable කරපු Kernel එකක් compile කරගන්න ඕනි 😕!</string>
    <string name="apm_remove">ඉවත් කරන්න</string>
    <string name="apm_magisk_conflict">Magisk හි මොඩියුල්ස් සමග ගැටෙන නිසා, මෙම විශේෂාංගය තාවකාලිකව ක්‍රියා විරහිත කර ඇත!</string>
    <string name="apm_failed_to_enable">මෙම මොඩියුලය ක්‍රියාත්මක කිරීමට නොහැකි විය: %s</string>
    <string name="safe_mode">ආරක්ෂාකාරී mode එක</string>
    <string name="reboot_edl">EDL Mode එකට</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="kpm_load_toast_succ">සාර්ථකව එකතු කරන ලදී</string>
    <string name="home_selinux_status">SELinux තත්වය</string>
    <string name="apm_update">යාවත්කාලීන කරන්න</string>
    <string name="about_source_code">මූල කේතය බලන්න %1$s<br/> අපේ ටෙලිග්‍රෑම් චැනලයට එකතු වන්න %2$s</string>
    <string name="settings">සැකසුම්</string>
    <string name="reboot_recovery">Recovery එකට</string>
    <string name="reboot_bootloader">Fastboot mode එකට</string>
    <string name="reboot_download">Download mode එකට</string>
    <string name="kpatch_version">අනුවාදය: %s</string>
    <string name="apatch_version_update">අනුවාදය: %s -&gt; %s</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="home_su_path">රූට්:%s</string>
    <string name="home_ap_cando_update">යාවත්කාලීන කරන්න</string>
    <string name="home_selinux_status_disabled">ඕෆ් කරන්න</string>
    <string name="home_selinux_status_unknown">හඳුනාගත නොහැක</string>
    <string name="kpm">KPModule</string>
    <string name="kpm_load">එකතු කරන්න</string>
    <string name="kpm_load_toast_failed">එකතු කිරීමට නොහැකි විය</string>
    <string name="kpm_unload_confirm">මෙම \"%s\" මොඩියුල් එක ඉවත් කිරීමට අවශ්‍ය ද?</string>
    <string name="kpm_unload">ඉවත් කරන්න</string>
    <string name="kpm_apm_empty">දැනට කිසිඳු මොඩියුල් එකක් භාවිතා කර නැත</string>
    <string name="kpm_license">බලපත්‍රය</string>
    <string name="kpm_desc">අවරෝහණ</string>
    <string name="su_title">රූට්</string>
    <string name="su_pkg_excluded_setting_summary">මොඩියුල්ස් සඳහා</string>
    <string name="home_apatch_version">APatch අනුවාදය</string>
    <string name="home_kernel">කර්නල් එක</string>
    <string name="home_manager_version">කළමනාකරණයේ අනුවාදය</string>
    <string name="home_fingerprint">ආරක්ෂක සළකුණ</string>
    <string name="su_refresh">නැවත අලුත් කරන්න</string>
    <string name="apm">මොඩියුල්ස්</string>
    <string name="system_default">Android හි භාෂාවම</string>
    <string name="apm_version">අනුවාදය</string>
    <string name="apm_desc">අවරෝහණ</string>
    <string name="apm_changelog">අලුත් දේවල්</string>
    <string name="apm_downloading">\"%s\" මොඩියුලය බාගත වෙමින්…</string>
    <string name="apm_start_downloading">බාගත කිරීම ආරම්භ කළා %s</string>
    <string name="settings_app_language">භාෂාව</string>
    <string name="kpm_version">අනුවාදය</string>
    <string name="apatch_version">අනුවාදය: %s</string>
    <string name="patch_title">පැච් කරන්න</string>
    <string name="apm_author">කතෲ</string>
    <string name="patch">පැච් කරන්න</string>
    <string name="kpm_args">Args</string>
    <string name="setting_reset_su_new_path">නව සම්පූර්ණ මාර්ගය</string>
    <string name="mode_select_page_install_inactive_slot_warning">දැන් ඔෆ් වෙලා ඔන් උනාම **බලහත්කාරයෙන්ම** අක්‍රීය වෙලා තියන ස්ලොට් එක්කට තමා ඔන් වෙන්නේ!\nOTA එක ඉවර උනාම විතරක් මේක පාවිච්චි කරන්න හොදේ.\nඉස්සරහට කරන් යන්නද?</string>
    <string name="home_install_unknown_summary">Install කිරීමට ක්ලික් කරන්න</string>
    <string name="patch_item_skey">සුපිරි යතුර</string>
    <string name="patch_item_kernel">කර්නලය</string>
    <string name="patch_item_extra_kpm_license">බලපත්‍රය:</string>
    <string name="su_pkg_excluded_setting_title">වෙනස් කිරීම් අතෑරලා දාන්න</string>
    <string name="home_dialog_auth_fail_content">Super Key එක සත්‍යාපනය කරන්න බෑ, ඒ හින්දා APatch හරියට වැඩ කරන්නේ නෑ.\nසත්‍යාපනය අවුල් වෙන්න හේතු ටිකක් මෙන්න:\n1. ඔයා boot image එක KernelPatch එක්ක පැච් කර නැ.\n2. පැච් කරපු boot image එක flash වෙලා නෑ.\n3. Super key එක වැරදි.\n4. ඔබගේ උපාංගය APatch සහ KernelPatch වලට හරියන්නේ නෑ වගේ .\n\nතව පාරක් ට්‍රයි කරලා බලන්න. තවමත් ඒත් හරියන්නේ නැත්තං , ඔයාට හැම වෙලේම නිල ගැටළු ඇසීමේ පිටුවෙන් ප්‍රශ්න ඇසීමට හැකිය.</string>
    <string name="indigo_theme">ඉන්ඩිගෝ Theme</string>
    <string name="light_blue_theme">ලා නිල් Theme</string>
    <string name="patch_item_bootimg_dev">උපාංගය:</string>
    <string name="patch_item_extra_version">අනුවාදය:</string>
    <string name="patch_item_extra_author">කතෘ:</string>
    <string name="patch_item_extra_kpm_desciption">විස්තරය:</string>
    <string name="patch_item_extra_args">Args:</string>
    <string name="kpm_control">පාලනය කරන්න</string>
    <string name="success">සාර්ථකයි</string>
    <string name="failure">අසාර්ථක වීම</string>
    <string name="settings_global_namespace_mode">Global නාම අවකාශයේ Mode</string>
    <string name="settings_clear_super_key_dialog">ඇත්තටම ඉදිරියට යාමට අවශ්‍යද?</string>
    <string name="settings_global_namespace_mode_summary">සියලුම root සැසි ගෝලීය මවුන්ට් නාම අවකාශය භාවිතා කරයි</string>
    <string name="settings_check_update">අප්ඩේට් චෙක් කරන්න</string>
    <string name="settings_check_update_summary">යෙදුම open කිරීමේදී Update සඳහා ස්වයංක්‍රීයව පරීක්ෂා කරන්න</string>
    <string name="patch_select_bootimg_btn">Boot කරන්න තෝරන්න</string>
    <string name="patch_embed_kpm_btn">KPM යොදන්න</string>
    <string name="patch_start_patch_btn">"යං "</string>
    <string name="patch_item_bootimg">බුටිම්</string>
    <string name="patch_start_unpatch_btn">UnPatch</string>
    <string name="patch_item_error">!!අවුලක්!!</string>
    <string name="patch_item_bootimg_slot">ස්ලොට්</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_kpimg_version">අනුවාදය:</string>
    <string name="patch_item_kpimg_comile_time">වේලාව:</string>
    <string name="patch_item_extra_name">නම:</string>
    <string name="home_system_version">පද්ධතියේ අනුවාදය</string>
    <string name="home_kpatch_version">KernelPatch අනුවාදය</string>
    <string name="kpm_embed">Embed</string>
    <string name="su_selinux_via_hook">Hook වලින් බයිපාස්</string>
    <string name="settings_use_system_color_theme">සිස්ටම් පාටපාට Theme</string>
    <string name="settings_custom_color_theme">පාට Theme</string>
    <string name="deep_orange_theme">Deep Orange Theme</string>
    <string name="light_green_theme">ලා කොළ Theme</string>
    <string name="lime_theme">Lime Theme</string>
    <string name="orange_theme">තැඹිලි Theme</string>
    <string name="purple_theme">දම් Theme</string>
    <string name="red_theme">රතු Theme</string>
    <string name="sakura_theme">සකුරා Theme</string>
    <string name="teal_theme">Teal Theme</string>
    <string name="yellow_theme">කහ Theme</string>
    <string name="save_log">Logs සටහන් සුරකින්න</string>
    <string name="kpatch_version_update">අනුවාදය: %s -&gt; %s</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="home_kpatch_info_title">තොරතුරු</string>
    <string name="home_ap_cando_reboot">රී බුට් කරන්න</string>
    <string name="patch_config_title">Patches</string>
    <string name="patch_mode_bootimg_patch">Mode: පැච්</string>
    <string name="patch_mode_patch_and_install">Mode: පැච් සහ ඉන්ස්ට්‍රොල් කරන්න</string>
    <string name="patch_mode_install_to_next_slot">Mode : ඊළඟ slot වෙත ස්ථාපනය කරන්න (OTA න් පසු)</string>
    <string name="patch_mode_uninstall_patch">Mode: KPatch අයින් කරන්න</string>
    <string name="patch_item_kpimg_config">කොන්ෆිග්:</string>
    <string name="patch_item_new_extra_kpm">අලුතින් දාන්න</string>
    <string name="patch_item_existed_extra_kpm">තිබ්බා</string>
    <string name="patch_item_extra_event">සිදුවීම:</string>
    <string name="patch_item_set_skey_label">Supper Key යෙහි අඩුම තරමින් අකුරු 8 ක් දාන්න ඕන, අංකයි අකුරු දෙකම දාන්න ඕන.</string>
    <string name="home_selinux_status_enforcing">බලාත්මක කිරීම</string>
    <string name="home_selinux_status_permissive">අවසරයි</string>
    <string name="home_device_info">උපාංගය</string>
    <string name="kpm_add_kpm">KPM ඒකතුකරන්න</string>
    <string name="kpm_install">දාන්න</string>
    <string name="su_pkg_excluded_label">exclude</string>
    <string name="hide_apatch_manager_summary">අහඹු පැකේජ ID සහ කස්නටම් app ලෙබලයක් සමග අලුත් මැනේජර් app එක්ක දාන්න</string>
    <string name="hide_apatch_dialog_new_manager_name">අලුත් මැනේජර් ගේ නම</string>
    <string name="hide_apatch_dialog_summary">මෙය භාවිතා කරන නව යෙදුම් ලේබලය ලෙස භාවිතා කරනු ඇත</string>
    <string name="hide_apatch_manager_failure">හංගන්න බෑ වගේනේ, කරුණාකර අවුල වාර්තා කරන්න!</string>
    <string name="setting_reset_su_path">Su patch රීසෙට් කරන්න</string>
    <string name="settings_donot_store_superkey">Super Key එක phone එකේ කොහේවත් තියාගන්න එපා</string>
    <string name="home_new_apatch_found">නව අනුවාදයක් තිබේ: %s, උත්ශ්‍රේණියට ඔබන්න</string>
    <string name="home_dialog_auth_fail_title">සත්‍යාපනය වැරදි වගේ</string>
    <string name="kpm_control_dialog_content">ඉන්පුට් control parameters:</string>
    <string name="kpm_control_ok">වැඩේ ගොඩ ලොක්කා!</string>
    <string name="kpm_control_failed">වැඩේ කෙලවුනා!</string>
    <string name="settings_use_system_color_theme_summary">Wallpaper එකත් එක්කම වෙනස් වෙන පද්ධති පාටක් ගන්න</string>
    <string name="amber_theme">ඇම්බර් තේමාව</string>
    <string name="blue_grey_theme">BlueGrey Theme</string>
    <string name="blue_theme">නිල් Theme</string>
    <string name="brown_theme">දුඹුරු Theme</string>
    <string name="cyan_theme">Cyan Theme</string>
    <string name="settings_donot_store_superkey_summary">මැනේජර් ආරම්භ කරන හැම වෙලේම Super Key එක ඉල්ලන්න</string>
    <string name="mode_select_page_title">දාන්න</string>
    <string name="apm_action">අක්ෂන්</string>
    <string name="mode_select_page_patch_and_install">පැච් එකත් එක්ක දාන්න</string>
    <string name="mode_select_page_select_file">Boot image එක තෝරන්න පැච් කරන්න</string>
    <string name="home_more_menu_feedback_or_suggestion">අවුලක් කියන්න හෝ යෝජනා කරන්න</string>
    <string name="home_more_menu_about">මේ ගැන</string>
    <string name="home_dialog_uninstall_title">අයින් කරන්න</string>
    <string name="home_dialog_uninstall_ap_only">AndroidPatch අයින් කරන්න</string>
    <string name="home_dialog_uninstall_all">ඔක්කම අයින් කරන්න</string>
    <string name="kpm_control_dialog_title">Control KPModule</string>
    <string name="kpm_control_paramters">Parameters</string>
    <string name="kpm_control_outMsg">පණිවිඩ</string>
    <string name="settings_night_mode_follow_sys_summary">පද්ධතියේ සැකසුම සමඟ ඔටෝම අඳුරු තේමාවට මාරු වෙන්න</string>
    <string name="pink_theme">රෝස Theme</string>
    <string name="about_app_version">අනුවාදය %1$s</string>
    <string name="settings_night_theme_enabled">Dark theme එකදාමු</string>
    <string name="deep_purple_theme">Deep Purple Theme</string>
    <string name="green_theme">කොළ Theme</string>
    <string name="hide_apatch_manager">APatch මැනේජර් හංගන්න</string>
    <string name="enable_web_debugging">WebView නිදොස්කරණය දාන්න</string>
    <string name="apm_webui_open">බලමු</string>
    <string name="enable_web_debugging_summary">WebUI නිදොස් කිරීමට භාවිතා කළ හැක, කරුණාකර අවශ්‍ය විට විතරක් දාගන්න.</string>
    <string name="mode_select_page_install_inactive_slot">අක්‍රිය ස්ලොට් වලට දාන්න (OTA පස්සේ)</string>
    <string name="settings_night_mode_follow_sys">සිස්ටම් dark theme වගේ වෙන්න</string>
</resources>

```

`app/src/main/res/values-sv/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="kpm_embed">Bygg in</string>
    <string name="home">Hem</string>
    <string name="patch_warnning">Installationen kommer med risker. Vänligen försäkra dig om att din data är säkerhetskopierad.</string>
    <string name="success">Lyckades</string>
    <string name="failure">Misslyckades</string>
    <string name="reboot">Starta om</string>
    <string name="settings">Inställningar</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="reboot_recovery">Starta om till Recovery-läge</string>
    <string name="about">Om</string>
    <string name="settings_app_language">Språk</string>
    <string name="system_default">Systemstandard</string>
    <string name="settings_check_update">Sök efter uppdatering</string>
    <string name="home_learn_apatch">Lär dig APatch</string>
    <string name="reboot_edl">Starta om till EDL</string>
    <string name="settings_clear_super_key_dialog">Vill du verkligen fortsätta?</string>
    <string name="settings_check_update_summary">Sök automatiskt efter uppdateringar när appen öppnas</string>
    <string name="settings_global_namespace_mode_summary">Alla root-sessioner använder det globala namnutrymme</string>
    <string name="safe_mode">Säkert läge</string>
    <string name="send_log">Skicka logg</string>
    <string name="save_log">Spara logg</string>
    <string name="about_source_code">&lt;p&gt; Visa källkod vid %1$s&lt;p/&gt;Gå med i vår kanal %%2$s&lt;p/&gt;Gå med i vår grupp %3$s</string>
    <string name="home_patch_set_key_desc">Endast inloggningsuppgifter för KernelPatch</string>
    <string name="home_installing">Installerar</string>
    <string name="home_patch_next_step">Nästa steg</string>
    <string name="home_working">Jobbar 😋</string>
    <string name="home_install_unknown_summary">Klicka för att installera</string>
    <string name="home_click_to_install">Klicka för att installera</string>
    <string name="home_install_unknown">Inte installerad eller autentiserad</string>
    <string name="kpatch_version">Version: %s</string>
    <string name="apatch_version">Version: %s</string>
    <string name="home_need_update">Ny version tillgänglig</string>
    <string name="apatch_version_update">Version: %s -&gt; %s</string>
    <string name="kpatch_version_update">Version: %s -&gt; %s</string>
    <string name="home_auth_key_title">Ange SuperKey</string>
    <string name="home_kpatch_info_title">Info</string>
    <string name="home_ap_cando_install">Installera</string>
    <string name="home_ap_cando_update">Uppdatera</string>
    <string name="home_ap_cando_uninstall">Avinstallera</string>
    <string name="home_ap_cando_reboot">Starta om</string>
    <string name="home_auth_key_desc">Börja efter certifiering</string>
    <string name="patch_mode_uninstall_patch">Läge: Avinstallera KPatch</string>
    <string name="patch_mode_patch_and_install">Mode: Patch och installera</string>
    <string name="patch_mode_install_to_next_slot">Läge: Installera till nästa plats (Efter OTA)</string>
    <string name="patch_item_error">!!FEL!!</string>
    <string name="patch_item_bootimg">bootimg</string>
    <string name="patch_embed_kpm_btn">Integrera KPM</string>
    <string name="patch_item_bootimg_dev">enhet:</string>
    <string name="patch_item_kernel">Kärna</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_kpimg_version">Version:</string>
    <string name="patch_item_kpimg_comile_time">Tid:</string>
    <string name="patch_item_kpimg_config">Konfig:</string>
    <string name="patch_item_extra_name">Namn:</string>
    <string name="patch_item_extra_version">Version:</string>
    <string name="patch_item_extra_author">Upphovsman:</string>
    <string name="patch_item_extra_kpm_license">Licens:</string>
    <string name="patch_item_extra_kpm_desciption">Beskrivning:</string>
    <string name="patch_item_extra_args">Argument:</string>
    <string name="patch_item_extra_event">Händelse:</string>
    <string name="home_kernel">Kärna</string>
    <string name="patch_item_skey">Super-tangent</string>
    <string name="patch_item_set_skey_label">Super-tangentens längd borde vara minst 8 tecken och ska inkludera både nummer och bokstäver</string>
    <string name="home_fingerprint">Fingeravtryck</string>
    <string name="home_selinux_status_disabled">Av</string>
    <string name="home_selinux_status">Status för SELinux</string>
    <string name="home_selinux_status_permissive">Tillåtande</string>
    <string name="home_selinux_status_unknown">Okänd</string>
    <string name="home_device_info">Enhet</string>
    <string name="kpm">KP-modul</string>
    <string name="kpm_load">Ladda</string>
    <string name="home_system_version">Version på systemet</string>
    <string name="home_apatch_version">Version på APatch</string>
    <string name="kpm_add_kpm">Lägg till KPM</string>
    <string name="kpm_install">Installera</string>
    <string name="kpm_load_toast_failed">Laddningen misslyckades</string>
    <string name="kpm_unload_confirm">Avlägsna modulen \"%s\"?</string>
    <string name="kpm_control">Kontroll</string>
    <string name="kpm_version">Version</string>
    <string name="kpm_license">Licens</string>
    <string name="kpm_author">Upphovsman</string>
    <string name="kpm_apm_empty">Ingen modul har laddats</string>
    <string name="kpm_desc">Beskr.</string>
    <string name="kpm_args">Argument</string>
    <string name="su_title">Superanvändare</string>
    <string name="su_pkg_excluded_label">exkludera</string>
    <string name="su_pkg_excluded_setting_title">Exkludera modifieringar</string>
    <string name="su_show_system_apps">Visa system-appar</string>
    <string name="su_hide_system_apps">Dölj system-appar</string>
    <string name="su_pkg_excluded_setting_summary">Att aktivera det här alternativet kommer att tillåta APatch att återställa alla modifierade filer den här applikationens moduler.</string>
    <string name="su_refresh">Uppdatera</string>
    <string name="apm">AP-modul</string>
    <string name="apm_remove">Ta bort</string>
    <string name="apm_install">Installera</string>
    <string name="apm_not_installed">AndroidPatch är inte installerad</string>
    <string name="apm_empty">Ingen modul är installerad</string>
    <string name="apm_failed_to_disable">Kunde inte slå av modulen \"%s\"</string>
    <string name="apm_version">Version</string>
    <string name="apm_author">Upphovsman</string>
    <string name="apm_desc">Beskr.</string>
    <string name="apm_uninstall_success">%s avinstallerat</string>
    <string name="apm_uninstall_confirm">Avinstallera modulen \"%s\"?</string>
    <string name="apm_uninstall_failed">Kunde inte avinstallera %s</string>
    <string name="apm_changelog">Ändringslogg</string>
    <string name="apm_update">Uppdatering</string>
    <string name="apm_magisk_conflict">Modulerna är otillgängliga på grund av en konflikt med Magisk.</string>
    <string name="apm_overlay_fs_not_available">Modulerna är otillgängliga eftersom att OverlayFS är inaktiverat av kärnan.</string>
    <string name="apm_downloading">Hämtar modulen \"%s\"…</string>
    <string name="apm_start_downloading">Påbörja hämtningen av %s</string>
    <string name="apm_new_version_available">Klicka för att installera den nya versionen, %s.</string>
    <string name="apm_webui_open">Öppna</string>
    <string name="setting_reset_su_path">Återställ genväg för su</string>
    <string name="setting_reset_su_new_path">ny fullständig genväg</string>
    <string name="hide_apatch_manager_failure">Döljningen misslyckades, vänligen rapportera buggen!</string>
    <string name="hide_apatch_dialog_summary">Det kommer att användas som en ny app-etikett som visas i startprogrammet</string>
    <string name="enable_web_debugging">Aktivera felsökning för WebView</string>
    <string name="mode_select_page_patch_and_install">Patcha och installera</string>
    <string name="home_dialog_auth_fail_title">Autentiseringen misslyckades</string>
    <string name="home_more_menu_about">Om</string>
    <string name="home_more_menu_feedback_or_suggestion">Återgivning eller förslag</string>
    <string name="kpm_control_ok">Åtgärden lyckades!</string>
    <string name="kpm_control_failed">Åtgärden misslyckades!</string>
    <string name="settings_night_mode_follow_sys">Följ systemets mörka tema</string>
    <string name="blue_theme">Blått tema</string>
    <string name="blue_grey_theme">Blågrått tema</string>
    <string name="light_blue_theme">Ljusblått tema</string>
    <string name="green_theme">Grönt tema</string>
    <string name="about_app_version">Version %1$s</string>
    <string name="about_telegram_group">Grupp på Telegram</string>
    <string name="about_powered_by">Drivs av %1$s</string>
    <string name="apm_action">Åtgärd</string>
    <string name="mode_select_page_title">Installera</string>
    <string name="home_new_apatch_found">Ny version tillgänglig: %s, Klicka på mig för att uppgradera</string>
    <string name="home_dialog_uninstall_title">Avinstallera</string>
    <string name="kpm_control_paramters">Parametrar</string>
    <string name="kpm_control_outMsg">Meddelande</string>
    <string name="home_dialog_uninstall_ap_only">Ta bort AndroidPatch</string>
    <string name="home_dialog_uninstall_all">Avinstallera allt</string>
    <string name="kpm_control_dialog_title">Kontrollera KP-modulen</string>
    <string name="kpm_control_dialog_content">Mata in kontroll-parametrar:</string>
    <string name="mode_select_page_install_inactive_slot">Installera till en icke aktiv plats (Efter OTA)</string>
    <string name="home_dialog_auth_fail_content">Autentiseringen av super-tangenten kunde inte genomföras, därav kommer inte APatch att fungera korrekt.\nHär är några möjliga orsaker till varför autentiseringen misslyckades:\n1. Du har inte patchat avbilden för boot med KernelPatch.\n2. Den patchade avbilden för boot har inte flashats.\n3. Fel Super-tangent.\n4. Din enhet har inte stöd för APatch och KernelPatch.\n\nVänligen kontrollera och försök igen. Om det fortfarande skulle uppstå problem så kan du alltid ställa frågor på sidan för filförrådets sida för problem-rapportering.</string>
    <string name="settings_custom_color_theme">Färgtema</string>
    <string name="settings_use_system_color_theme_summary">Använd ett färgschema som genereras av systemet med den nuvarande bakgrundsbilden</string>
    <string name="brown_theme">Brunt tema</string>
    <string name="sakura_theme">Sakura-tema</string>
    <string name="yellow_theme">Gult tema</string>
    <string name="light_green_theme">Ljusgrönt tema</string>
    <string name="about_telegram_channel">Kanal på Telegram</string>
    <string name="home_click_to_learn_apatch">Lär dig om funktionerna i APatch och hur du använder</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="patch_start_patch_btn">Starta</string>
    <string name="patch_mode_bootimg_patch">Läge: Patchning</string>
    <string name="patch_select_bootimg_btn">Välj uppstart</string>
    <string name="patch_start_unpatch_btn">Ta bort patch</string>
    <string name="log_saved">Logg sparad</string>
    <string name="patch">Patch</string>
    <string name="reboot_bootloader">Starta om till Bootloader</string>
    <string name="reboot_download">Starta om till Nedladdning</string>
    <string name="super_key">SuperNyckel</string>
    <string name="clear_super_key">Rensa SuperNyckel</string>
    <string name="patch_set_superkey">Sätt SuperNyckel</string>
    <string name="home_not_installed">Inte installerad</string>
    <string name="patch_title">Patch</string>
    <string name="patch_config_title">Patchar</string>
    <string name="patch_item_new_extra_kpm">Bädda in ny</string>
    <string name="patch_item_existed_extra_kpm">Existerade</string>
    <string name="su_selinux_via_hook">bypass genom hook</string>
    <string name="pink_theme">Rosa tema</string>
    <string name="purple_theme">Lila tema</string>
    <string name="settings_donot_store_superkey">Spara inte supernycklen i local</string>
    <string name="settings_use_system_color_theme">System färgtema</string>
    <string name="settings_night_theme_enabled">Aktivera mörkt tema</string>
    <string name="teal_theme">Blågrönt tema</string>
    <string name="red_theme">Rött tema</string>
    <string name="cyan_theme">Cyan tema</string>
    <string name="deep_orange_theme">Djuporanget tema</string>
</resources>

```

`app/src/main/res/values-ta/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="patch_item_extra_kpm_license">உரிமம்:</string>
    <string name="patch_item_extra_kpm_desciption">விளக்கம்:</string>
    <string name="patch_item_extra_args">ஆர்க்ச்:</string>
    <string name="patch_item_extra_event">நிகழ்வு:</string>
    <string name="kpm_unload_confirm">\"%s\" தொகுதியை இறக்கவா?</string>
    <string name="kpm_author">நூலாசிரியர்</string>
    <string name="apm">Apmodule</string>
    <string name="home_dialog_auth_fail_title">ஏற்பு தோல்வியடைந்தது</string>
    <string name="crash_handle_copied">இடைநிலைப்பலகைக்கு நகலெடுக்கப்பட்ட செயலிழப்பு பதிவு.</string>
    <string name="home">வீடு</string>
    <string name="failure">தோல்வி</string>
    <string name="success">செய்</string>
    <string name="patch_warnning">நிறுவல் அபாயங்களுடன் வருகிறது. உங்கள் தரவு காப்புப் பிரதி எடுக்கப்படுவதை உறுதிசெய்க.</string>
    <string name="patch">இணைப்பு</string>
    <string name="settings_app_language">மொழி</string>
    <string name="system_default">கணினி இயல்புநிலை</string>
    <string name="kernel_patch">கர்னல்பாட்ச்</string>
    <string name="reboot">மறுதொடக்கம் செய்யுங்கள்</string>
    <string name="settings">அமைப்புகள்</string>
    <string name="reboot_recovery">மீட்புக்கு மறுதொடக்கம் செய்யுங்கள்</string>
    <string name="reboot_bootloader">துவக்க ஏற்றிக்கு மறுதொடக்கம் செய்யுங்கள்</string>
    <string name="reboot_download">பதிவிறக்கம் செய்ய மறுதொடக்கம் செய்யுங்கள்</string>
    <string name="reboot_edl">EDL க்கு மறுதொடக்கம் செய்யுங்கள்</string>
    <string name="about">பற்றி</string>
    <string name="settings_global_namespace_mode">உலகளாவிய பெயர்வெளி பயன்முறை</string>
    <string name="settings_global_namespace_mode_summary">அனைத்து ரூட் அமர்வுகளும் உலகளாவிய மவுண்ட் பெயர்வெளியைப் பயன்படுத்துகின்றன</string>
    <string name="settings_check_update">புதுப்பிப்பைச் சரிபார்க்கவும்</string>
    <string name="settings_check_update_summary">பயன்பாட்டைத் திறக்கும்போது புதுப்பிப்புகளை தானாகவே சரிபார்க்கவும்</string>
    <string name="home_learn_apatch">அப்பாச்சி கற்றுக்கொள்ளுங்கள்</string>
    <string name="home_click_to_learn_apatch">அப்பாட்சின் நற்பொருத்தங்கள் மற்றும் எவ்வாறு பயன்படுத்துவது என்பது பற்றி அறிக</string>
    <string name="send_log">பதிவுகள் அனுப்பவும்</string>
    <string name="save_log">பதிவுகளை சேமிக்கவும்</string>
    <string name="settings_clear_super_key_dialog">நீங்கள் உண்மையில் தொடர விரும்புகிறீர்களா?</string>
    <string name="log_saved">பதிவுகள் சேமிக்கப்பட்டன</string>
    <string name="safe_mode">பாதுகாப்பான பயன்முறை</string>
    <string name="super_key">சூப்பர்கி</string>
    <string name="clear_super_key">தெளிவான சூப்பர்கி</string>
    <string name="patch_set_superkey">சூப்பர்கி அமைக்கவும்</string>
    <string name="home_not_installed">நிறுவப்படவில்லை</string>
    <string name="home_patch_set_key_desc">கர்னல் பேட்சிற்கான சான்றுகள் மட்டுமே</string>
    <string name="home_patch_next_step">அடுத்த அடி</string>
    <string name="home_install_unknown">நிறுவப்படவில்லை அல்லது அங்கீகரிக்கப்படவில்லை</string>
    <string name="home_install_unknown_summary">நிறுவ சொடுக்கு செய்க</string>
    <string name="home_click_to_install">நிறுவ சொடுக்கு செய்க</string>
    <string name="home_need_update">புதிய பதிப்பு கிடைக்கிறது</string>
    <string name="home_working">வேலை</string>
    <string name="home_installing">நிறுவுகிறது</string>
    <string name="kpatch_version">பதிப்பு: %s</string>
    <string name="apatch_version">பதிப்பு: %s</string>
    <string name="apatch_version_update">பதிப்பு: %s -&gt; %s</string>
    <string name="kpatch_version_update">பதிப்பு: %s -&gt; %s</string>
    <string name="home_auth_key_title">சூப்பர்கி உள்ளிடவும்</string>
    <string name="kpatch_shadow_path_title">கேஒட்டு</string>
    <string name="home_auth_key_desc">சான்றிதழுக்குப் பிறகு தொடங்கவும்</string>
    <string name="home_kpatch_info_title">தகவல்</string>
    <string name="home_ap_cando_install">நிறுவவும்</string>
    <string name="home_ap_cando_update">புதுப்பிப்பு</string>
    <string name="home_ap_cando_uninstall">நிறுவல் நீக்க</string>
    <string name="home_ap_cando_reboot">மறுதொடக்கம் செய்யுங்கள்</string>
    <string name="patch_title">இணைப்பு</string>
    <string name="patch_config_title">திட்டுகள்</string>
    <string name="patch_mode_bootimg_patch">பயன்முறை: இணைப்பு</string>
    <string name="patch_mode_patch_and_install">பயன்முறை: இணைப்பு மற்றும் நிறுவவும்</string>
    <string name="patch_mode_install_to_next_slot">பயன்முறை: செயலற்ற ச்லாட்டுக்கு நிறுவவும் (OTA க்குப் பிறகு)</string>
    <string name="patch_mode_uninstall_patch">பயன்முறை: kpatch ஐ நிறுவல் நீக்குதல்</string>
    <string name="patch_select_bootimg_btn">துவக்கத்தைத் தேர்ந்தெடுக்கவும்</string>
    <string name="patch_embed_kpm_btn">கே.பி.எம்</string>
    <string name="patch_start_patch_btn">தொடங்கு</string>
    <string name="patch_start_unpatch_btn">Unpatch</string>
    <string name="patch_item_error">!! பிழை !!</string>
    <string name="patch_item_bootimg">துவக்க</string>
    <string name="patch_item_bootimg_slot">ச்லாட்:</string>
    <string name="patch_item_bootimg_dev">சாதனம்:</string>
    <string name="patch_item_kernel">கர்னல்</string>
    <string name="patch_item_kpimg_version">பதிப்பு:</string>
    <string name="patch_item_kpimg_comile_time">நேரம்:</string>
    <string name="patch_item_kpimg_config">கட்டமைப்பு:</string>
    <string name="patch_item_new_extra_kpm">புதியது</string>
    <string name="patch_item_existed_extra_kpm">இருந்தது</string>
    <string name="patch_item_extra_name">பெயர்:</string>
    <string name="patch_item_extra_version">பதிப்பு:</string>
    <string name="patch_item_extra_author">ஆசிரியர்:</string>
    <string name="patch_item_skey">சூப்பர்கி</string>
    <string name="patch_item_set_skey_label">சூப்பர்கி 8-63 எழுத்துக்கள் நீளமாக இருக்க வேண்டும் மற்றும் எண்கள் மற்றும் கடிதங்களை உள்ளடக்கியிருக்க வேண்டும், ஆனால் சிறப்பு எழுத்துக்கள் இல்லை.</string>
    <string name="home_kernel">கர்னல்</string>
    <string name="home_manager_version">மேலாளர் பதிப்பு</string>
    <string name="home_fingerprint">கைரேகை</string>
    <string name="home_selinux_status">செலினக்ச் நிலை</string>
    <string name="home_selinux_status_disabled">முடக்கப்பட்டது</string>
    <string name="home_selinux_status_enforcing">செயல்படுத்துதல்</string>
    <string name="home_selinux_status_permissive">இசைவு</string>
    <string name="home_selinux_status_unknown">தெரியவில்லை</string>
    <string name="home_device_info">சாதனம்</string>
    <string name="home_system_version">கணினி பதிப்பு</string>
    <string name="home_kpatch_version">கர்னல்பாட்ச் பதிப்பு</string>
    <string name="home_su_path">இயங்கக்கூடிய சு</string>
    <string name="home_apatch_version">அபட்க் பதிப்பு</string>
    <string name="kpm">Kpmodule</string>
    <string name="kpm_kp_not_installed">கர்னல்பாட்ச் நிறுவப்படவில்லை</string>
    <string name="kpm_add_kpm">கே.பி.எம் சேர்க்கவும்</string>
    <string name="kpm_load">சுமை</string>
    <string name="kpm_install">நிறுவவும்</string>
    <string name="kpm_embed">உட்பொதிக்கப்பட்டது</string>
    <string name="kpm_load_toast_succ">சுமை செய்</string>
    <string name="kpm_load_toast_failed">சுமை தோல்வியடைந்தது</string>
    <string name="kpm_unload">இறக்கவும்</string>
    <string name="kpm_control">கட்டுப்பாடு</string>
    <string name="kpm_apm_empty">எந்த தொகுதி ஏற்றப்படவில்லை</string>
    <string name="kpm_version">பதிப்பு</string>
    <string name="kpm_license">உரிமம்</string>
    <string name="kpm_desc">டெச்க்</string>
    <string name="kpm_args">ஆர்க்ச்</string>
    <string name="su_title">சூப்பர் யூசர்</string>
    <string name="su_selinux_via_hook">கொக்கி வழியாக பைபாச்</string>
    <string name="su_pkg_excluded_label">விலக்கு</string>
    <string name="su_pkg_excluded_setting_title">மாற்றங்களை விலக்கு</string>
    <string name="su_pkg_excluded_setting_summary">இந்த விருப்பத்தின் தொகுதிகள் மூலம் மாற்றியமைக்கப்பட்ட எந்த கோப்புகளையும் மீட்டெடுக்க இந்த விருப்பத்தை இயக்குவது அபேக் அனுமதிக்கும்.</string>
    <string name="su_show_system_apps">கணினி பயன்பாடுகளைக் காட்டு</string>
    <string name="su_hide_system_apps">கணினி பயன்பாடுகளை மறைக்கவும்</string>
    <string name="su_refresh">புதுப்பி</string>
    <string name="apm_not_installed">AndroidPatch நிறுவப்படவில்லை</string>
    <string name="apm_failed_to_enable">\"%s\" தொகுதியை இயக்க முடியவில்லை</string>
    <string name="apm_failed_to_disable">\"%s\" தொகுதியை அணைக்க முடியவில்லை</string>
    <string name="apm_empty">எந்த தொகுதி நிறுவப்படவில்லை</string>
    <string name="apm_remove">அகற்று</string>
    <string name="apm_install">நிறுவவும்</string>
    <string name="apm_uninstall_confirm">\"%s\" தொகுதியை நிறுவல் நீக்கவா?</string>
    <string name="apm_uninstall_success">%s நிறுவல் நீக்கப்பட்டது</string>
    <string name="apm_uninstall_failed">%s நிறுவல் நீக்க முடியவில்லை</string>
    <string name="apm_version">பதிப்பு</string>
    <string name="apm_author">நூலாசிரியர்</string>
    <string name="apm_desc">டெச்க்</string>
    <string name="apm_overlay_fs_not_available">கர்னலால் மேலடுக்குகள் முடக்கப்பட்டிருப்பதால் தொகுதிகள் கிடைக்கவில்லை!</string>
    <string name="apm_magisk_conflict">மேகிசுடனான மோதல் காரணமாக தொகுதிகள் கிடைக்கவில்லை!</string>
    <string name="apm_reboot_to_apply">நடைமுறைக்கு வர மறுதொடக்கம் செய்யுங்கள்</string>
    <string name="apm_changelog">மாற்றபதிவு</string>
    <string name="apm_downloading">\"%s\" தொகுதி பதிவிறக்குகிறது…</string>
    <string name="apm_start_downloading">%s பதிவிறக்கத் தொடங்குங்கள்</string>
    <string name="apm_new_version_available">புதிய பதிப்பு %s கிடைக்கின்றன, மேம்படுத்த சொடுக்கு செய்க.</string>
    <string name="hide_apatch_manager">அபாட்ச் மேலாளரை மறைக்கவும்</string>
    <string name="hide_apatch_manager_summary">சீரற்ற அடையாளம் மற்றும் தனிப்பயன் சிட்டை மூலம் புதிய மேலாளர் பயன்பாட்டை நிறுவவும்</string>
    <string name="hide_apatch_dialog_new_manager_name">புதிய மேலாளர் பெயர்</string>
    <string name="hide_apatch_dialog_summary">இது துவக்கத்தில் காட்டப்பட்டுள்ள புதிய பயன்பாட்டு லேபிளாக பயன்படுத்தப்படும்</string>
    <string name="apm_update">புதுப்பிப்பு</string>
    <string name="hide_apatch_manager_failure">மறைக்கத் தவறிவிட்டது. பிழையைப் புகாரளிக்கவும்!</string>
    <string name="setting_reset_su_path">சு பாதையை மீட்டமைக்கவும்</string>
    <string name="setting_reset_su_new_path">புதிய முழு பாதை</string>
    <string name="apm_webui_open">திற</string>
    <string name="apm_action">செயல்</string>
    <string name="enable_web_debugging">வெப்வியூ பிழைத்திருத்தத்தை இயக்கவும்</string>
    <string name="enable_web_debugging_summary">WebUI ஐ பிழைத்திருத்த பயன்படுத்தலாம். தேவைப்படும்போது மட்டுமே இயக்கவும்.</string>
    <string name="settings_donot_store_superkey">சூப்பர்கீவை உள்ளக சேமிக்க வேண்டாம்</string>
    <string name="settings_donot_store_superkey_summary">மேலாளர் தொடங்கும் ஒவ்வொரு முறையும் சூப்பர்கியை அங்கீகரிக்கவும்</string>
    <string name="home_new_apatch_found">புதிய பதிப்பு %s கிடைக்கின்றன, மேம்படுத்த சொடுக்கு செய்க.</string>
    <string name="mode_select_page_title">நிறுவவும்</string>
    <string name="mode_select_page_patch_and_install">இணைப்பு மற்றும் நிறுவவும்</string>
    <string name="mode_select_page_select_file">இணைப்புக்கு துவக்க படத்தைத் தேர்ந்தெடுக்கவும்</string>
    <string name="mode_select_page_install_inactive_slot">செயலற்ற ச்லாட்டுக்கு நிறுவவும் (OTA க்குப் பிறகு)</string>
    <string name="mode_select_page_install_inactive_slot_warning">மறுதொடக்கத்திற்குப் பிறகு தற்போதைய செயலற்ற ச்லாட்டுக்கு துவக்க உங்கள் சாதனம் ** கட்டாயப்படுத்தப்படும் **! \nOTA முடிந்ததும் மட்டுமே இந்த விருப்பத்தைப் பயன்படுத்தவும். \nதொடரவா?</string>
    <string name="home_dialog_auth_fail_content">சூப்பர்கியை அங்கீகரிக்க முடியவில்லை, எனவே அப்பாட்ச் சரியாக வேலை செய்ய முடியாது. \nஅங்கீகார தோல்விக்கான சில காரணங்கள் இங்கே: \n1. நீங்கள் boot.img ஐ கர்னல்பாட்ச் மூலம் இணைக்கவில்லை. \n2. இணைக்கப்பட்ட துவக்க. ஐ.எம்.சி ஒளிரவில்லை. \n3. சூப்பர்ச்கி தவறானது அல்லது சிறப்பு எழுத்துக்கள் உள்ளன. \n4. உங்கள் சாதனம் அபாட்ச் மற்றும் கர்னல்பாட்சை ஆதரிக்காது. \n\nதயவுசெய்து சரிபார்த்து மீண்டும் முயற்சிக்கவும். இன்னும் சிக்கல்கள் இருந்தால், அதிகாரப்பூர்வ களஞ்சியத்தின் சிக்கல்கள் பக்கத்தில் நீங்கள் எப்போதும் கேள்விகளைக் கேட்கலாம்.</string>
    <string name="home_more_menu_feedback_or_suggestion">கருத்து அல்லது பரிந்துரை</string>
    <string name="home_more_menu_about">பற்றி</string>
    <string name="home_dialog_uninstall_title">நிறுவல் நீக்க</string>
    <string name="home_dialog_uninstall_ap_only">AndroidPatch ஐ அகற்றவும்</string>
    <string name="home_dialog_uninstall_all">அனைத்தையும் நிறுவல் நீக்கவும்</string>
    <string name="kpm_control_dialog_title">Kpmodule ஐக் கட்டுப்படுத்துங்கள்</string>
    <string name="kpm_control_dialog_content">உள்ளீட்டு கட்டுப்பாட்டு அளவுருக்கள்:</string>
    <string name="kpm_control_paramters">அளவுருக்கள்</string>
    <string name="kpm_control_outMsg">செய்தி</string>
    <string name="kpm_control_ok">செயல்பாடு செய் பெற்றது!</string>
    <string name="kpm_control_failed">செயல்பாடு தோல்வியடைந்தது!</string>
    <string name="settings_night_mode_follow_sys">கணினியின் இருண்ட கருப்பொருளைப் பின்பற்றுங்கள்</string>
    <string name="settings_night_mode_follow_sys_summary">கணினி அமைப்புகளின் அடிப்படையில் தானாக இருண்ட கருப்பொருளுக்கு மாறவும்</string>
    <string name="settings_night_theme_enabled">இருண்ட கருப்பொருளை இயக்கவும்</string>
    <string name="settings_use_system_color_theme">கணினி வண்ண கருப்பொருள்</string>
    <string name="settings_use_system_color_theme_summary">தற்போதைய வால்பேப்பரின் அடிப்படையில் கணினியால் உருவாக்கப்பட்ட வண்ண கருப்பொருளைப் பயன்படுத்தவும்</string>
    <string name="settings_custom_color_theme">வண்ண கருப்பொருள்</string>
    <string name="amber_theme">அம்பர்</string>
    <string name="blue_grey_theme">நீல சாம்பல்</string>
    <string name="blue_theme">நீலம்</string>
    <string name="brown_theme">பழுப்பு</string>
    <string name="deep_orange_theme">ஆழமான ஆரஞ்சு</string>
    <string name="cyan_theme">சியான்</string>
    <string name="deep_purple_theme">ஆழமான ஊதா</string>
    <string name="green_theme">பச்சை</string>
    <string name="indigo_theme">இண்டிகோ</string>
    <string name="light_blue_theme">வெளிர் நீலம்</string>
    <string name="light_green_theme">வெளிர் பச்சை</string>
    <string name="lime_theme">சுண்ணாம்பு</string>
    <string name="orange_theme">ஆரஞ்சு</string>
    <string name="pink_theme">இளஞ்சிவப்பு</string>
    <string name="purple_theme">ஊதா</string>
    <string name="red_theme">சிவப்பு</string>
    <string name="sakura_theme">சகுரா</string>
    <string name="teal_theme">டீல்</string>
    <string name="yellow_theme">மஞ்சள்</string>
    <string name="about_app_version">பதிப்பு %1$s</string>
    <string name="about_app_desc">அகற்றப்பட்ட கர்னல் படத்துடன் மட்டுமே கர்னல் ரூட் தீர்வு, பெருகிவரும் கணினி தொகுதி மற்றும் கர்னல் செயல்பாட்டை ஊக்கிங் செய்யும் திறனை வழங்குகிறது.</string>
    <string name="about_telegram_channel">தந்தி சேனல்</string>
    <string name="about_telegram_group">தந்தி குழு</string>
    <string name="about_powered_by">%1$s ஆல் இயக்கப்படுகிறது</string>
    <string name="crash_handle_title">பயன்பாடு செயலிழந்தது…</string>
    <string name="crash_handle_copy">செயலிழப்பு பதிவை நகலெடுக்கவும்</string>
    <string name="android_patch">ஆண்ட்ராய்டுஒட்டு</string>
    <string name="about_source_code"><![CDATA[<p>மூலக் குறியீட்டை %1$s<p/>எங்கள் %2$s சேனலில் சேர்<p/>எங்கள் %3$s குழுவில் சேர்]]></string>
    <string name="patch_item_kpimg">கேபிபட</string>
</resources>

```

`app/src/main/res/values-th/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="patch_warnning">APatch</string>
    <string name="home_learn_apatch">เรียนรู้เกี่ยวกับ APatch</string>
    <string name="reboot">รีบูต</string>
    <string name="settings">ตั้งค่า</string>
    <string name="send_log">Send logs</string>
    <string name="home_auth_key_desc">เริ่มทำงานหลังจากได้รับการรับรอง</string>
    <string name="home_click_to_learn_apatch">เรียนรู้เกี่ยวกับคุณสมบัติ APatch และวิธีการใช้</string>
    <string name="home_installing">กำลังติดตั้ง</string>
    <string name="home_ap_cando_uninstall">ถอนการติดตั้ง</string>
    <string name="home_ap_cando_install">ติดตั้ง</string>
    <string name="home_click_to_install">คลิกเพื่อติดตั้ง</string>
    <string name="home_need_update">มีอัปเดตพร้อมใช้งาน</string>
    <string name="home_selinux_status">สถานะ SELinux</string>
    <string name="patch_set_superkey">ตั้ง SuperKey</string>
    <string name="home_ap_cando_update">อัพเดท</string>
    <string name="home_selinux_status_disabled">ปิด</string>
    <string name="home_working">กำลังทำงาน</string>
    <string name="home_patch_next_step">ขั้นตอนต่อไป</string>
    <string name="home_not_installed">ไม่ได้ติดตั้ง</string>
    <string name="home_manager_version">เวอร์ชัน</string>
    <string name="kpm_load">โหลด</string>
    <string name="kpm_load_toast_succ">โหลดสำเร็จ</string>
    <string name="kpm_unload_confirm">คุณแน่ใจหรือไม่ว่าต้องการยกเลิกการโหลดโมดูล %s?</string>
    <string name="kpm_desc">คำอธิบาย</string>
    <string name="kpm_version">เวอร์ชัน</string>
    <string name="kpm_author">ผู้เขียน</string>
    <string name="kpm_load_toast_failed">โหลดไม่สำเร็จ</string>
    <string name="kpm_unload">ยกเลิกการโหลด</string>
    <string name="kpm_license">ใบอนุญาต</string>
    <string name="kpm_apm_empty">ไม่มีการโหลดโมดูล</string>
    <string name="apm">APModule</string>
    <string name="app_name" translatable="false">APatch</string>
    <string name="kpm">KPModule</string>
    <string name="apm_reboot_to_apply">รีบูตเพื่อให้มีผล</string>
    <string name="apm_uninstall_success">กำลังดาวน์โหลดโมดูล: %s…</string>
    <string name="apm_install">APModule</string>
    <string name="apm_remove">ถอนการติดตั้ง</string>
    <string name="apm_uninstall_confirm">กำลังดาวน์โหลดโมดูล: %s…</string>
    <string name="apm_version">APModule</string>
    <string name="su_pkg_excluded_setting_summary">การเปิดใช้งานตัวเลือกนี้จะช่วยให้ APatch กู้คืนไฟล์ที่ถูกปรับเปลี่ยนโดยโมดูลสำหรับแอปพลิเคชันนี้</string>
    <string name="apm_start_downloading">เริ่มดาวน์โหลด: %s</string>
    <string name="apm_overlay_fs_not_available">0.0019ไม่มี OverlayFS โมดูลไม่สามารถทำงานได้.</string>
    <string name="su_show_system_apps">แสดงแอประบบ</string>
    <string name="apm_failed_to_disable">ไม่สามารถปิดการใช้งานโมดูล: %s</string>
    <string name="apm_uninstall_failed">กำลังดาวน์โหลดโมดูล: %s…</string>
    <string name="apm_failed_to_enable">ไม่สามารถเปิดใช้งานโมดูล: %s</string>
    <string name="su_hide_system_apps">ซ่อนแอประบบ</string>
    <string name="apm_magisk_conflict">โมดูลถูกปิดใช้งานเนื่องจากขัดแย้งกับ Magisk\'s.</string>
    <string name="apm_new_version_available">รุ่นใหม่: %s พร้อมใช้งาน</string>
    <string name="apm_empty">ไม่มีการติดตั้งโมดูล</string>
    <string name="apm_author">ผู้เขียน</string>
    <string name="home">สำเร็จ</string>
    <string name="about">เกี่ยวกับ</string>
    <string name="safe_mode">โหมดปลอดภัย</string>
    <string name="reboot_recovery">รีบูตเข้าสู่โหมดการกู้คืน</string>
    <string name="su_refresh">รีเฟรช</string>
    <string name="apatch_version">เวอร์ชัน: %s</string>
    <string name="apatch_version_update">เวอร์ชัน: %s -&gt; %s</string>
    <string name="kpm_kp_not_installed">ไม่ได้ติดตั้ง KernelPatch</string>
    <string name="kpatch_version">เวอร์ชัน: %s</string>
    <string name="apm_not_installed">ไม่ได้ติดตั้ง Android Patch</string>
    <string name="apm_desc">อธิบาย</string>
    <string name="apm_changelog">บันทึกการเปลี่ยนแปลง</string>
    <string name="apm_update">อัปเดต</string>
    <string name="apm_downloading">กำลังดาวน์โหลดโมดูล: %s…</string>
    <string name="home_install_unknown">ไม่ทราบ</string>
    <string name="home_fingerprint">ลายนิ้วมือ</string>
    <string name="super_key">SuperKey</string>
    <string name="kernel_patch">APatch</string>
    <string name="android_patch">&lt;![CDATA[&lt;p&gt;View source code at %1$s&lt;br/&gt;Join our %2$s channel</string>
    <string name="reboot_bootloader">รีบูตเข้าสู่บูตโหลดเดอร์</string>
    <string name="reboot_download">รีบูตเข้าสู่โหมดดาวน์โหลด</string>
    <string name="reboot_edl">รีบูตเข้าสู่โหมด EDL</string>
    <string name="about_source_code">&lt;![CDATA[&lt;p&gt;View source code at %1$s&lt;br/&gt;Join our %2$s channel</string>
    <string name="home_patch_set_key_desc">ข้อมูลรับรองสำหรับ KernelPatch เท่านั้น</string>
    <string name="home_apatch_version">เวอร์ชั่น APatch</string>
    <string name="patch_title">แพทซ์</string>
    <string name="home_kernel">Kernel</string>
    <string name="kpm_args">Args</string>
    <string name="su_title">Superuser</string>
    <string name="clear_super_key">ล้าง คีย์</string>
    <string name="home_su_path">su: %s</string>
    <string name="home_auth_key_title">ใส่ SuperKey</string>
    <string name="home_selinux_status_enforcing">Enforcing</string>
    <string name="home_selinux_status_permissive">Permissive</string>
    <string name="home_selinux_status_unknown">ไม่ทราบ</string>
    <string name="su_pkg_excluded_setting_title">ยกเว้นการปรับเปลี่ยน</string>
    <string name="su_selinux_via_hook">bypass via hook</string>
    <string name="su_pkg_excluded_label">exclude</string>
    <string name="settings_app_language">ภาษา</string>
    <string name="patch">APatch</string>
    <string name="system_default">ค่าเริ่มต้นของระบบ</string>
    <string name="settings_global_namespace_mode">โหมดเนมสเปซทั่วโลก</string>
    <string name="settings_global_namespace_mode_summary">ทุกเซสชันรูทใช้เนมสเปซการเมานต์แบบทั่วโลก</string>
    <string name="success">APatch</string>
    <string name="failure">APatch</string>
    <string name="home_kpatch_info_title">รายละเอียด</string>
    <string name="home_ap_cando_reboot">รีบูต</string>
    <string name="patch_config_title">แพทช์</string>
    <string name="patch_mode_bootimg_patch">โหมด : แพทช์</string>
    <string name="patch_mode_patch_and_install">โหมด : แพทช์ และติดตั้ง</string>
    <string name="patch_mode_uninstall_patch">โหมด : ถอนการติดตั้ง Kpatch</string>
    <string name="patch_select_bootimg_btn">เลือกการบูต</string>
    <string name="patch_embed_kpm_btn">ฝัง KPM</string>
    <string name="patch_start_patch_btn">เริ่ม</string>
    <string name="patch_start_unpatch_btn">เลิกแพทช์</string>
    <string name="patch_item_error">!!ข้อผิดพลาด!!</string>
    <string name="patch_item_bootimg">บูตอิมเมจ</string>
    <string name="patch_item_bootimg_dev">อุปกรณ์ :</string>
    <string name="patch_item_kernel">เคอเนล</string>
    <string name="patch_mode_install_to_next_slot">โหมด: ติดตั้งในช่องถัดไป (หลังจาก OTA)</string>
    <string name="settings_clear_super_key_dialog">คุณต้องการดำเนินการต่อหรือไม่?</string>
    <string name="settings_check_update_summary">ตรวจสอบการอัปเดตโดยอัตโนมัติเมื่อเปิดแอป</string>
    <string name="settings_check_update">ตรวจสอบการอัพเดท</string>
    <string name="home_install_unknown_summary">คลิกเพื่อติดตั้ง</string>
    <string name="kpatch_version_update">เวอร์ชั่น: %s -&gt; %s</string>
    <string name="kpatch_shadow_path_title">แพทซ์ เคอเนล</string>
    <string name="patch_item_bootimg_slot">ช่อง:</string>
    <string name="patch_item_kpimg_version">เวอร์ชั่น:</string>
    <string name="patch_item_kpimg_config">กำหนดค่า:</string>
    <string name="patch_item_kpimg_comile_time">เวลา:</string>
    <string name="save_log">บันทึกเหตุการณ์</string>
    <string name="patch_item_set_skey_label">ความยาวของคีย์ควรอย่างน้อย 8 ตัวอักษรและรวมถึงตัวเลขและตัวอักษร</string>
    <string name="patch_item_extra_name">ชื่อ:</string>
    <string name="patch_item_extra_version">เวอร์ชั่น:</string>
    <string name="patch_item_extra_kpm_license">ใบอนุญาต:</string>
    <string name="patch_item_extra_kpm_desciption">คำอธิบาย:</string>
    <string name="kpm_add_kpm">เพิ่ม KPM</string>
    <string name="home_device_info">อุปกรณ์</string>
    <string name="kpm_install">ติดตั้ง</string>
    <string name="about_app_version">เวอร์ชั่น %1$s</string>
    <string name="log_saved">บันทึกข้อมูลแล้ว</string>
    <string name="hide_apatch_manager_failure">ไม่สามารถซ่อนได้ กรุณารายงานจุดบกพร่อง!</string>
    <string name="setting_reset_su_path">การรีเซ็ตจำนวนการเข้าสู่ระบบที่ล้มเหลว</string>
    <string name="setting_reset_su_new_path">เริ่มต้นใหม่</string>
    <string name="mode_select_page_select_file">คลิกเครื่่องหมายถูกต้องเพื่อยืนยัน</string>
    <string name="settings_night_mode_follow_sys">ใช้งานธีมมืดของระบบ</string>
    <string name="settings_night_mode_follow_sys_summary">สลับไปใช้ธีมมืดโดยอัตโนมัติด้วยการตั้งค่าของระบบ</string>
    <string name="settings_night_theme_enabled">เปิดใช้งานธีมมืด</string>
    <string name="settings_use_system_color_theme">ธีมสีของระบบ</string>
    <string name="cyan_theme">ธีมสีฟ้า</string>
    <string name="light_blue_theme">ธีมสีฟ้าอ่อน</string>
    <string name="about_telegram_channel">ช่องทางเทเลอกรม</string>
    <string name="about_telegram_group">กลุ่มเทเลแกรม</string>
    <string name="crash_handle_title">แอปขัดข้อง..</string>
    <string name="crash_handle_copied">คัดลอกไฟล์ความผิดพลาดไปยังคลิปบอร์ดแล้ว</string>
    <string name="crash_handle_copy">คัดลอกไฟล์ความผิดพลาด</string>
    <string name="patch_item_extra_author">ผู้เขียน:</string>
    <string name="patch_item_skey">สุดยอดกุญแจ</string>
    <string name="kpm_embed">ฝัง</string>
    <string name="enable_web_debugging_summary">สามารถใช้เพื่อดีบัก WebUI ได้ โปรดเปิดใช้งานเฉพาะเมื่อจำเป็นเท่านั้น</string>
    <string name="patch_item_extra_event">เหตุการณ์:</string>
    <string name="home_system_version">เวอร์ชันระบบ</string>
    <string name="hide_apatch_manager">ซ่อนตัวจัดการ APatch</string>
    <string name="hide_apatch_manager_summary">ติดตั้งแอปผู้จัดการใหม่ด้วยรหัสแพ็กเกจสุ่มและป้ายชื่อแอปที่กำหนดเอง</string>
    <string name="settings_donot_store_superkey_summary">ตรวจสอบสิทธิ์ซุปเปอร์คีย์ทุกครั้งที่ผู้จัดการเริ่มต้น</string>
    <string name="settings_donot_store_superkey">ห้ามเก็บซุปเปอร์คีย์ไว้ในเครื่อง</string>
    <string name="mode_select_page_title">ติดตั้ง</string>
    <string name="mode_select_page_patch_and_install">ยืนยันและติดตั้ง</string>
    <string name="home_new_apatch_found">มีเวอร์ชันใหม่แล้ว: ,คลิกเพื่ออัปเกรด</string>
    <string name="about_powered_by">ปฎิบัติการโดย %1$s</string>
    <string name="patch_item_kpimg">เคพิงค์</string>
    <string name="patch_item_existed_extra_kpm">มีอยู่</string>
    <string name="patch_item_new_extra_kpm">ฝังใหม่</string>
    <string name="home_kpatch_version">เวอร์ชันเคอร์เนลแพตช์</string>
    <string name="home_dialog_uninstall_title">ถอนการติดตั้ง</string>
    <string name="home_dialog_uninstall_ap_only">ลบข้อมูลแอนดรอยด์</string>
    <string name="kpm_control_dialog_title">การควบคุม KPModule</string>
    <string name="kpm_control_outMsg">ข้อความ</string>
    <string name="kpm_control_ok">การดำเนินการสำเร็จ!</string>
    <string name="kpm_control_paramters">ฟังก์ชัน</string>
    <string name="blue_grey_theme">ธีมสีน้ำเงินเทา</string>
    <string name="brown_theme">ธีมสีน้ำตาล</string>
    <string name="deep_purple_theme">ธีมสีม่วงเข้ม</string>
    <string name="green_theme">ธีมสีเขียว</string>
    <string name="indigo_theme">ธีมส้มเหลือง</string>
    <string name="light_green_theme">ธีมสีเขียวอ่อน</string>
    <string name="orange_theme">ธีมสีส้ม</string>
    <string name="lime_theme">ธีมเขียวมะนาว</string>
    <string name="pink_theme">ธีมสีชมพู</string>
    <string name="purple_theme">ธีมสีม่วง</string>
    <string name="sakura_theme">ธีมซากุระ</string>
    <string name="red_theme">ธีมสีแดง</string>
    <string name="teal_theme">ธีมสีน้ำเงินอมเขียว</string>
    <string name="yellow_theme">ธีมสีเหลือง</string>
    <string name="about_app_desc">โซลูชันรูทเคอร์เนลที่มีเพียงอิมเมจเคอร์เนลแบบสตริปเท่านั้น ซึ่งให้ความสามารถในการติดตั้งโมดูลระบบและเชื่อมต่อฟังก์ชันเคอร์เนล</string>
    <string name="home_more_menu_feedback_or_suggestion">สอบถามข้อมูลเพิ่มเติมได้หรือมีปัญญาทางเทคนิค</string>
    <string name="home_more_menu_about">เกี่ยวกับ</string>
    <string name="kpm_control_failed">การดำเนินการล้มเหลว!</string>
    <string name="blue_theme">ธีมสีฟ้า</string>
    <string name="apm_action">การกระทำ</string>
    <string name="home_dialog_auth_fail_title">การตรวจสอบสิทธิ์ล้มเหลว</string>
    <string name="kpm_control_dialog_content">จัดเตรียมไปยังฟังก์ชัน</string>
    <string name="home_dialog_uninstall_all">ถอนการติดตั้งทั้งหมด</string>
    <string name="patch_item_extra_args">อาร์กส์</string>
    <string name="kpm_control">ควบคุม</string>
    <string name="hide_apatch_dialog_new_manager_name">ชื่อผู้จัดการคนใหม่</string>
    <string name="hide_apatch_dialog_summary">จะถูกใช้เป็นป้ายแอปใหม่ที่แสดงในตัวเรียกใช้งาน</string>
    <string name="apm_webui_open">เปิด</string>
    <string name="enable_web_debugging">เปิดใช้งานการดีบักเว็บวิว</string>
    <string name="mode_select_page_install_inactive_slot">ติดตั้งลงในพื้นที่ที่ไม่ได้ใช้งาน (หลัง OTA)</string>
    <string name="mode_select_page_install_inactive_slot_warning">อุปกรณ์ของคุณจะถูก **บังคับ** ให้รีเซ็ตไปยังพื้นที่ไม่ได้ใช้งานปัจจุบันหลังจากรีเซ็ต!\n\nใช้ตัวเลือกนี้เฉพาะหลังจาก OTA เสร็จสิ้นเท่านั้น\n\nดำเนินการต่อหรือไม่</string>
    <string name="settings_use_system_color_theme_summary">ใช้ธีมสีที่สร้างโดยระบบด้วยวอลเปเปอร์ปัจจุบัน</string>
    <string name="settings_custom_color_theme">ธีมสี</string>
    <string name="amber_theme">ธีมสีเหลือง</string>
    <string name="deep_orange_theme">ธีมสีส้มเข้ม</string>
    <string name="home_dialog_auth_fail_content">ไม่สามารถตรวจสอบสิทธิ์ซูเปอร์คีย์ได้ ดังนั้น APatch จึงไม่สามารถทำงานได้อย่างถูกต้อง\n\nต่อไปนี้คือสาเหตุที่เป็นไปได้บางประการที่ทำให้การตรวจสอบสิทธิ์ล้มเหลว:\n\n1. คุณไม่ได้รีเซ็ตการบูตด้วย KernelPatch\n\n2. รีเซ็ตการบูตที่เนิ่มใหม่แล้วไม่ได้ถูกต้อง\n\n3. ซูเปอร์คีย์ไม่ถูกต้อง\n\n4. อุปกรณ์ของคุณไม่รองรับ APatch และ KernelPatch\n\nโปรดตรวจสอบและลองอีกครั้ง หากยังคงมีปัญหาอยู่ คุณสามารถถามคำถามได้เสมอที่หน้าปัญหาของที่เก็บข้อมูลอย่างเป็นทางการ</string>
</resources>

```

`app/src/main/res/values-tr/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="apm_reboot_to_apply">Değişikleri uygulamak için yeniden başlatın</string>
    <string name="android_patch">AndroidPatch</string>
    <string name="kpm_unload_confirm">\"%s\" modülü boşaltılsın mı?</string>
    <string name="apm_uninstall_success">\"%s\" kaldırıldı</string>
    <string name="send_log">Günlükleri gönder</string>
    <string name="apm_install">Kur</string>
    <string name="home_auth_key_desc">Sertifikasyondan sonra başlar</string>
    <string name="kpatch_version">Sürüm: %s</string>
    <string name="apm_remove">Kaldır</string>
    <string name="patch_warnning">Kurulum işlemi risklidir. Lütfen verilerinizi yedeklediğinizden emin olun.</string>
    <string name="kpm_kp_not_installed">KernelPatch kurulu değil</string>
    <string name="home_patch_set_key_desc">KernelPatch için tek gerekli veri</string>
    <string name="home_install_unknown">Kurulmadı veya kimliği doğrulanmadı</string>
    <string name="apm_uninstall_confirm">\"%s\" modülü kaldırılsın mı?</string>
    <string name="su_pkg_excluded_setting_title">Değişiklikleri hariç tut</string>
    <string name="reboot_download">İndirme modunda yeniden başlat</string>
    <string name="home_click_to_learn_apatch">APatch\'in özelliklerini ve nasıl kullanılacağını öğrenin</string>
    <string name="apm_version">Sürüm</string>
    <string name="su_pkg_excluded_setting_summary">Bu seçeneğin etkinleştirilmesi APatch\'in bu uygulamanın modülleri tarafından değiştirilmiş herhangi bir dosyayı geri yüklemesine izin verecektir.</string>
    <string name="reboot_edl">EDL modunda yeniden başlat</string>
    <string name="home_installing">Kuruluyor</string>
    <string name="apm_start_downloading">İndirme başladı: \"%s\"</string>
    <string name="su_pkg_excluded_label">dahil etme</string>
    <string name="su_title">SU</string>
    <string name="apm">AP Modül</string>
    <string name="kpm_desc">Açıklama</string>
    <string name="su_selinux_via_hook">kanca ile bypass et</string>
    <string name="home_ap_cando_uninstall">Kaldır</string>
    <string name="kpm_args">Argümanlar</string>
    <string name="home_fingerprint">Parmak izi</string>
    <string name="apatch_version">Sürüm: %s</string>
    <string name="apm_overlay_fs_not_available">OverlayFS, kernel tarafından devre dışı bırakıldığından modüllere erişilemiyor!</string>
    <string name="kpm_version">Sürüm</string>
    <string name="su_refresh">Yenile</string>
    <string name="safe_mode">Güvenli mod</string>
    <string name="su_show_system_apps">Sistem uygulamalarını göster</string>
    <string name="home_ap_cando_install">Kur</string>
    <string name="super_key">Süper Anahtar</string>
    <string name="reboot_recovery">Kurtarma modunda yeniden başlat</string>
    <string name="home_learn_apatch">APatch\'i öğrenin</string>
    <string name="apm_failed_to_disable">\"%s \"modülü devre dışı bırakılamadı</string>
    <string name="kernel_patch">KernelPatch</string>
    <string name="home_click_to_install">Kurmak için tıklayın</string>
    <string name="home_selinux_status_unknown">Bilinmiyor</string>
    <string name="home_apatch_version">APatch sürümü</string>
    <string name="about">Hakkında</string>
    <string name="home_selinux_status_permissive">Serbest</string>
    <string name="reboot">Yeniden başlat</string>
    <string name="home_need_update">Yeni sürüm mevcut</string>
    <string name="home_selinux_status">SELinux durumu</string>
    <string name="apm_changelog">Değişiklik listesi</string>
    <string name="apm_uninstall_failed">%s kaldırılamadı</string>
    <string name="kpm_author">Geliştirici</string>
    <string name="apm_failed_to_enable">\"%s\" modülü etkinleştirilemedi</string>
    <string name="home">Ana sayfa</string>
    <string name="patch_set_superkey">Süper Anahtar\'ı ayarla</string>
    <string name="apm_downloading">\"%s\"modülü indiriliyor…</string>
    <string name="su_hide_system_apps">Sistem uygulamalarını gizle</string>
    <string name="home_su_path">su programı</string>
    <string name="apm_magisk_conflict">Magisk ile çakıştığı için modüllere erişilemiyor!</string>
    <string name="apm_desc">Açıklama</string>
    <string name="home_ap_cando_update">Güncelle</string>
    <string name="kpm_load_toast_failed">Yüklenemedi</string>
    <string name="kpm_unload">Yüklemeyi kaldır</string>
    <string name="home_selinux_status_disabled">Devredışı</string>
    <string name="settings">Ayarlar</string>
    <string name="apm_new_version_available">Yeni %s sürümü mevcut, yükseltmek için tıklayın.</string>
    <string name="apatch_version_update">Sürüm: %s -&gt; %s</string>
    <string name="home_working">Çalışıyor 😋</string>
    <string name="apm_empty">Hiç modül kurulmadı</string>
    <string name="kpm_load">Yükle</string>
    <string name="home_patch_next_step">Sonraki adım</string>
    <string name="home_auth_key_title">Süper Anahtarı girin</string>
    <string name="apm_update">Güncelle</string>
    <string name="home_kernel">Kernel versiyon</string>
    <string name="home_not_installed">Kurulu değil</string>
    <string name="kpm">KP Modül</string>
    <string name="home_selinux_status_enforcing">Enforcing</string>
    <string name="kpm_license">Lisans</string>
    <string name="reboot_bootloader">Önyükleyici modunda yeniden başlat</string>
    <string name="kpm_apm_empty">Yüklü modül yok</string>
    <string name="about_source_code"><![CDATA[<p>%1$s üzerinden kaynak koduna göz atın<p/>%2$s kanalımıza katılın<p/>%2$s grubumuza katılın]]></string>
    <string name="home_manager_version">Yönetici sürümü</string>
    <string name="kpm_load_toast_succ">Başarıyla yüklendi</string>
    <string name="apm_author">Geliştirici</string>
    <string name="patch_title">Yamala</string>
    <string name="clear_super_key">Süper Anahtarı Sil</string>
    <string name="apm_not_installed">AndroidPatch kurulu değil</string>
    <string name="settings_app_language">Dil</string>
    <string name="system_default">Sistem varsayılanı</string>
    <string name="patch">Yamala</string>
    <string name="settings_global_namespace_mode">Küresel ad alanı modu</string>
    <string name="settings_global_namespace_mode_summary">Tüm root oturumları global bağlama ad alanını kullanır</string>
    <string name="settings_clear_super_key_dialog">Gerçekten devam etmek istiyor musunuz?</string>
    <string name="kpatch_version_update">Sürüm: %s -&gt; %s</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="home_ap_cando_reboot">Yeniden başlat</string>
    <string name="patch_config_title">Yamalar</string>
    <string name="patch_mode_bootimg_patch">Mod: Yama</string>
    <string name="patch_mode_patch_and_install">Mod: Güncelle</string>
    <string name="patch_select_bootimg_btn">Önyüklemeyi seç</string>
    <string name="home_kpatch_info_title">Bilgi</string>
    <string name="patch_item_bootimg">önyükleme kalıbı</string>
    <string name="patch_item_existed_extra_kpm">Var olan</string>
    <string name="patch_mode_uninstall_patch">Mod: Yama kaldır</string>
    <string name="patch_item_bootimg_slot">yuva:</string>
    <string name="patch_item_extra_name">Ad:</string>
    <string name="patch_item_bootimg_dev">aygıt:</string>
    <string name="patch_start_patch_btn">Başlat</string>
    <string name="patch_item_kernel">Çekirdek</string>
    <string name="patch_item_extra_version">Sürüm:</string>
    <string name="patch_embed_kpm_btn">KPM göm</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_extra_author">Yazar:</string>
    <string name="patch_item_extra_kpm_license">Lisans:</string>
    <string name="patch_item_extra_args">Argümanlar:</string>
    <string name="patch_start_unpatch_btn">Yamayı kaldır</string>
    <string name="patch_item_kpimg_version">Sürüm:</string>
    <string name="patch_item_error">!!HATA!!</string>
    <string name="patch_item_kpimg_comile_time">Zaman:</string>
    <string name="patch_item_extra_kpm_desciption">Açıklama:</string>
    <string name="patch_item_kpimg_config">Yapılandırma:</string>
    <string name="patch_item_new_extra_kpm">Yeni göm</string>
    <string name="patch_item_extra_event">Olay:</string>
    <string name="patch_item_skey">SüperAnahtar</string>
    <string name="patch_item_set_skey_label">SüperAnahtarın uzunluğu 8-63 karakter uzunluğunda olmalı ve rakam ve harf içermeli, fakat özel karakter içermemelidir.</string>
    <string name="hide_apatch_manager">APatch Yöneticisini Gizle</string>
    <string name="hide_apatch_dialog_summary">Başlatıcıda gösterilen yeni uygulama etiketi olarak kullanılacaktır</string>
    <string name="kpm_add_kpm">KPM ekle</string>
    <string name="kpm_embed">Göm</string>
    <string name="hide_apatch_dialog_new_manager_name">Yeni yönetici adı</string>
    <string name="hide_apatch_manager_failure">Gizlenemedi. Lütfen hatayı bildirin!</string>
    <string name="kpm_install">Kur</string>
    <string name="hide_apatch_manager_summary">Rastgele bir paket kimliği ve özel bir uygulama etiketiyle bir proxy uygulaması yükle.</string>
    <string name="setting_reset_su_path">\"su\" programı yolunu sıfırla</string>
    <string name="setting_reset_su_new_path">Yeni tam yol</string>
    <string name="success">Başarılı</string>
    <string name="failure">Başarısız</string>
    <string name="home_new_apatch_found">Yeni sürüm var: %s, Yükseltmek için tıklayın</string>
    <string name="settings_check_update">Güncellemeleri denetle</string>
    <string name="patch_mode_install_to_next_slot">Mod: Aktif olmayan yuvaya kur (OTA\'dan sonra)</string>
    <string name="mode_select_page_patch_and_install">Yama ve Kur</string>
    <string name="mode_select_page_select_file">Yama yapılacak bir boot (önyükleme) imajı seçin.</string>
    <string name="home_dialog_auth_fail_title">Kimlik doğrulama başarısız</string>
    <string name="home_more_menu_feedback_or_suggestion">Geri bildirim veya öneri</string>
    <string name="home_more_menu_about">Hakkında</string>
    <string name="mode_select_page_title">Kur</string>
    <string name="mode_select_page_install_inactive_slot">Etkin olmayan yuvaya kur (OTA\'dan sonra)</string>
    <string name="mode_select_page_install_inactive_slot_warning">Aygıtınız yeniden başlatıldıktan sonra geçerli etkin olmayan yuvaya önyükleme yapmaya **ZORLANACAK**!
\nBu seçeneği yalnızca OTA tamamlandıktan sonra kullanın.
\nDevam edilsin mi?</string>
    <string name="home_dialog_auth_fail_content">SuperKey doğrulanamadığından APatch düzgün çalışamıyor.\nDoğrulama başarısızlığının bazı olası nedenleri şunlardır:\n1. boot.img dosyasını KernelPatch ile yamalamadınız.\n2. Yamalı boot.img dosyası yazılmadı.\n3. SuperKey hatalı ya da özel karakterler içeriyor.\n4. Cihazınız APatch ve KernelPatch desteklemiyor.\n\nLütfen bu maddeleri gözden geçirin ve tekrar deneyin. Hala sorun varsa, resmi deponun sorunlar sayfasından her zaman soru sorabilirsiniz.</string>
    <string name="settings_check_update_summary">Uygulama açıldığında güncellemeleri otomatik olarak denetle</string>
    <string name="apm_webui_open">Aç</string>
    <string name="enable_web_debugging">Web Görünümü Hata Ayıklamayı Etkinleştir</string>
    <string name="settings_donot_store_superkey_summary">SuperKey her zaman yönetici başlar</string>
    <string name="enable_web_debugging_summary">Web arayüzünde hata ayıklamak için kullanılabilir, lütfen yalnızca gerektiğinde etkinleştirin.</string>
    <string name="settings_donot_store_superkey">Süper anahtarı yerel olarak saklama</string>
    <string name="home_system_version">Sistem sürümü</string>
    <string name="home_dialog_uninstall_all">Hepsini kaldır</string>
    <string name="home_install_unknown_summary">Kurmak için tıklayın</string>
    <string name="home_device_info">Aygıt</string>
    <string name="home_kpatch_version">KernelPatch sürümü</string>
    <string name="home_dialog_uninstall_title">Kaldır</string>
    <string name="home_dialog_uninstall_ap_only">AndroidPatch\'i kaldır</string>
    <string name="kpm_control">Denetim</string>
    <string name="kpm_control_outMsg">Mesaj</string>
    <string name="kpm_control_failed">İşlem başarısız!</string>
    <string name="settings_night_theme_enabled">Koyu temayı etkinleştir</string>
    <string name="settings_custom_color_theme">Renk teması</string>
    <string name="light_blue_theme">Açık mavi</string>
    <string name="kpm_control_paramters">Parametreler</string>
    <string name="kpm_control_ok">İşlem başarılı!</string>
    <string name="settings_use_system_color_theme">Sistem Renk Teması</string>
    <string name="blue_theme">Mavi</string>
    <string name="brown_theme">Kahverengi</string>
    <string name="cyan_theme">Camgöbeği</string>
    <string name="deep_orange_theme">Koyu Turuncu</string>
    <string name="deep_purple_theme">Koyu mor</string>
    <string name="indigo_theme">Çivit Mavisi</string>
    <string name="light_green_theme">Açık yeşil</string>
    <string name="lime_theme">Açık yeşil</string>
    <string name="orange_theme">Turuncu</string>
    <string name="pink_theme">"Pembe "</string>
    <string name="purple_theme">Mor</string>
    <string name="red_theme">Kırmızı</string>
    <string name="sakura_theme">Kiraz Çiçeği</string>
    <string name="teal_theme">Cam göbeği</string>
    <string name="yellow_theme">Sarı</string>
    <string name="about_app_version">Sürüm %1$s</string>
    <string name="about_app_desc">Yalnızca sadeleştirilmiş bir çekirdek kalıbına sahip çekirdek root çözümü, sistem modülünü bağlama ve çekirdek işlevini kancalama olanağı sağlar.</string>
    <string name="about_telegram_channel">Telegram kanalı</string>
    <string name="about_telegram_group">Telegram grubu</string>
    <string name="about_powered_by">%1$s desteğiyle</string>
    <string name="kpm_control_dialog_title">KPModule Denetimi</string>
    <string name="kpm_control_dialog_content">Giriş denetim parametreleri:</string>
    <string name="settings_night_mode_follow_sys">Sistemin koyu temasını kullan</string>
    <string name="settings_night_mode_follow_sys_summary">Sistem ayarına göre otomatik olarak koyu temaya geç</string>
    <string name="settings_use_system_color_theme_summary">Geçerli duvar kağıdı ile sistem tarafından oluşturulan bir renk teması kullanın</string>
    <string name="amber_theme">Kehribar</string>
    <string name="blue_grey_theme">Mavi gri</string>
    <string name="green_theme">"Yeşil "</string>
    <string name="save_log">Günlükleri kaydet</string>
    <string name="apm_action">Eylem</string>
    <string name="log_saved">Günlükler kaydedildi</string>
    <string name="crash_handle_title">Uygulama çöktü…</string>
    <string name="crash_handle_copy">Çökme raporunu kopyala</string>
    <string name="crash_handle_copied">Çökme raporu panoya kopyalandı.</string>
    <string name="settings_lite_mode">Lite modunu etkinleştir.</string>
    <string name="settings_lite_mode_mode_summary">APModule işlevleri etkinleştirildikten sonra hatalar gösterebilir, ancak bazı durumlarda tespiti etkili bir şekilde engelleyebilir. Yeniden başlatma gereklidir.</string>
    <string name="settings_force_overlayfs_mode">OverlayFS kullanımını zorla</string>
    <string name="settings_force_overlayfs_mode_summary">Kernel desteği mevcut olduğunda, Magic Mount yerine APModule’leri bağlamak için OverlayFS kullan. Yeniden başlatma gereklidir.</string>
</resources>

```

`app/src/main/res/values-uk/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="home">Головна</string>
    <string name="kernel_patch">Заплатка ядра</string>
    <string name="android_patch">Заплатка для Android</string>
    <string name="reboot">Перезавантаження</string>
    <string name="settings">Налаштування</string>
    <string name="reboot_recovery">Перезавантаження в режим відновлення</string>
    <string name="reboot_bootloader">Перезавантаження в завантажувач</string>
    <string name="reboot_download">Перезавантаження в режим завантаження</string>
    <string name="about">Про</string>
    <string name="home_learn_apatch">Дізнайтеся більше про APatch</string>
    <string name="safe_mode">Безпечний режим</string>
    <string name="super_key">СуперКлюч</string>
    <string name="clear_super_key">Очистити SuperKey</string>
    <string name="patch_set_superkey">Встановити SuperKey</string>
    <string name="home_patch_set_key_desc">Пароль для KernelPatch</string>
    <string name="home_patch_next_step">Наступний крок</string>
    <string name="home_not_installed">Не встановлено</string>
    <string name="home_install_unknown">Не встановлено або автентифіковано</string>
    <string name="home_click_to_install">Натисніть щоб встановити</string>
    <string name="home_working">Працює😋</string>
    <string name="home_installing">Встановлення</string>
    <string name="kpatch_version">Версія: %s</string>
    <string name="apatch_version">Версія: %s</string>
    <string name="home_su_path">Виконуваний файл su</string>
    <string name="home_auth_key_title">Введіть SuperKey</string>
    <string name="home_ap_cando_update">Оновити</string>
    <string name="patch_title">Залатати</string>
    <string name="home_manager_version">Версія менеджера</string>
    <string name="home_fingerprint">Відбиток</string>
    <string name="home_selinux_status">Статус SELinux</string>
    <string name="home_selinux_status_disabled">Вимкнено</string>
    <string name="home_selinux_status_enforcing">Примусовий</string>
    <string name="home_selinux_status_permissive">Дозвільний</string>
    <string name="kpm">KPМодуль</string>
    <string name="kpm_kp_not_installed">KernelPatch не встановлено</string>
    <string name="kpm_load">Завантажити</string>
    <string name="kpm_load_toast_failed">Не вдалося встановити</string>
    <string name="kpm_author">Автор</string>
    <string name="kpm_args">Аргументи</string>
    <string name="su_selinux_via_hook">Обхід через хук</string>
    <string name="su_pkg_excluded_setting_title">Виключити зміни</string>
    <string name="su_show_system_apps">Показати системні додатки</string>
    <string name="su_refresh">Оновити</string>
    <string name="apm">Модулі</string>
    <string name="apm_not_installed">AndroidPatch не встановлено</string>
    <string name="apm_failed_to_enable">Не вдалося ввімкнути модуль \"%s\"</string>
    <string name="apm_remove">Видалити</string>
    <string name="apm_author">Автор</string>
    <string name="apm_desc">Опис</string>
    <string name="apm_reboot_to_apply">Перезавантажте, щоб зміни вступити в силу</string>
    <string name="apm_changelog">Список змін</string>
    <string name="apm_update">Оновлення</string>
    <string name="apm_start_downloading">Початок завантаження %s</string>
    <string name="patch_warnning">Інсталяція має ризики. Будь ласка, створіть резервну копію ваших даних.</string>
    <string name="reboot_edl">Перезавантаження в EDL</string>
    <string name="home_click_to_learn_apatch">Дізнайтеся більше про можливості APatch і про його використання</string>
    <string name="about_source_code"><![CDATA[<p> Перегляньте вихідний код на %1$s<p/> Приєднуйтеся до нашого каналу %2$s<p/> Приєднуйтеся до нашої групи %3$s]]></string>
    <string name="send_log">Надіслати журнали</string>
    <string name="apatch_version_update">Версія: %s → %s</string>
    <string name="home_apatch_version">Версія APatch</string>
    <string name="home_need_update">Доступне оновлення</string>
    <string name="home_auth_key_desc">Почати після сертифікації</string>
    <string name="home_ap_cando_uninstall">Видалити</string>
    <string name="home_ap_cando_install">Встановити</string>
    <string name="home_kernel">Версія ядра</string>
    <string name="kpm_load_toast_succ">Встановленно успішно</string>
    <string name="home_selinux_status_unknown">Невідомо</string>
    <string name="kpm_unload">Видалити</string>
    <string name="kpm_license">Ліцензія</string>
    <string name="kpm_desc">Опис</string>
    <string name="kpm_apm_empty">Немає модулів</string>
    <string name="kpm_version">Версія</string>
    <string name="su_title">Суперкористувач</string>
    <string name="su_pkg_excluded_label">Виключити</string>
    <string name="su_pkg_excluded_setting_summary">Увімкнення цієї опції дозволить APatch відновлювати будь-які файли, змінені модулями цієї програми.</string>
    <string name="su_hide_system_apps">Приховати системні додатки</string>
    <string name="apm_empty">Немає встановлених модулів</string>
    <string name="apm_install">Встановити</string>
    <string name="apm_uninstall_confirm">Видалити \"%s\" модуль?</string>
    <string name="apm_uninstall_success">%s видалено</string>
    <string name="apm_uninstall_failed">Не вдалося видалити %s</string>
    <string name="apm_version">Версія</string>
    <string name="apm_overlay_fs_not_available">Модулі недоступні, оскільки OverlayFS вимкнено ядром!</string>
    <string name="apm_magisk_conflict">Модулі недоступні через конфлікт з Magisk!</string>
    <string name="apm_downloading">Завантаження модуля \"%s\"…</string>
    <string name="kpm_unload_confirm">Видалити модуль \"%s\"?</string>
    <string name="apm_new_version_available">Доступна нова версія %s, натисніть, щоб оновити.</string>
    <string name="apm_failed_to_disable">Не вдалося вимкнути модуль \"%s\"</string>
    <string name="settings_app_language">Мова</string>
    <string name="system_default">За замовчуванням у системі</string>
    <string name="patch">Залатати</string>
    <string name="settings_global_namespace_mode">Режим глобального простору імен</string>
    <string name="settings_global_namespace_mode_summary">Усі сеанси root використовують монтування глобального простору імен</string>
    <string name="kpatch_shadow_path_title">Kpatch</string>
    <string name="home_ap_cando_reboot">Перезавантаження</string>
    <string name="patch_config_title">Латки</string>
    <string name="patch_mode_bootimg_patch">Режим: Латка</string>
    <string name="patch_mode_patch_and_install">Режим: Залатати та встановити</string>
    <string name="patch_mode_uninstall_patch">Режим: Скасування латки</string>
    <string name="patch_select_bootimg_btn">Виберіть boot</string>
    <string name="patch_embed_kpm_btn">Вбудований KPM</string>
    <string name="patch_start_patch_btn">Старт</string>
    <string name="patch_start_unpatch_btn">Скасування латки</string>
    <string name="patch_item_error">!!ПОМИЛКА!!</string>
    <string name="patch_item_bootimg">bootimg</string>
    <string name="patch_item_bootimg_slot">слот:</string>
    <string name="patch_item_bootimg_dev">пристрій:</string>
    <string name="patch_item_kernel">Ядро</string>
    <string name="patch_item_kpimg">Kpimg</string>
    <string name="patch_item_kpimg_version">Версія:</string>
    <string name="patch_item_kpimg_comile_time">Час:</string>
    <string name="patch_item_kpimg_config">Налаштування:</string>
    <string name="patch_item_new_extra_kpm">Вбудувати новий</string>
    <string name="patch_item_existed_extra_kpm">Існуючий</string>
    <string name="patch_item_extra_name">Ім\'я:</string>
    <string name="patch_item_extra_version">Версія:</string>
    <string name="patch_item_extra_author">Автор:</string>
    <string name="patch_item_extra_kpm_license">Ліцензія:</string>
    <string name="patch_item_extra_kpm_desciption">Опис:</string>
    <string name="patch_item_extra_args">Аргументи:</string>
    <string name="patch_item_extra_event">Подія:</string>
    <string name="patch_item_set_skey_label">SuperKey має містити 8-63 символи та містити цифри та літери, але без спеціальних символів.</string>
    <string name="patch_item_skey">СуперКлюч</string>
    <string name="settings_clear_super_key_dialog">Ви дійсно хочете продовжити?</string>
    <string name="kpatch_version_update">Версія: %s -&gt; %s</string>
    <string name="home_kpatch_info_title">Інфо</string>
    <string name="settings_check_update_summary">Автоматично перевіряти оновлення при відкритті застосунку</string>
    <string name="success">Успішно</string>
    <string name="failure">Помилка</string>
    <string name="settings_check_update">Перевірити наявність оновлень</string>
    <string name="settings_donot_store_superkey">Не зберігайте SuperKey локально</string>
    <string name="patch_mode_install_to_next_slot">Режим: встановлення в неактивний слот (після OTA)</string>
    <string name="hide_apatch_manager_summary">Встановіть проксі-додаток із випадковим ідентифікатором пакета та власною міткою додатка</string>
    <string name="enable_web_debugging_summary">Можна використовувати для налагодження WebUI. Увімкніть лише за потреби.</string>
    <string name="home_new_apatch_found">Доступна нова версія %s, натисніть, щоб оновити.</string>
    <string name="home_install_unknown_summary">Натисніть щоб встановити</string>
    <string name="mode_select_page_patch_and_install">Виправте та встановіть</string>
    <string name="home_device_info">Пристрій</string>
    <string name="home_system_version">Версія системи</string>
    <string name="home_kpatch_version">Версія KernelPatch</string>
    <string name="hide_apatch_dialog_new_manager_name">Нове ім\'я менеджера</string>
    <string name="hide_apatch_dialog_summary">Воно буде використовуватися як нове ім\'я застосунку, яке відображатиметься на робочому столі</string>
    <string name="hide_apatch_manager_failure">Не вдалося сховатися. Будь ласка, повідомте про помилку!</string>
    <string name="enable_web_debugging">Увімкнути налагодження WebView</string>
    <string name="settings_donot_store_superkey_summary">Під час кожного запуску диспетчера перевіряйте автентичність SuperKey</string>
    <string name="setting_reset_su_path">Скинути шлях до файлу su</string>
    <string name="setting_reset_su_new_path">Новий повний шлях</string>
    <string name="apm_webui_open">Відкрити</string>
    <string name="hide_apatch_manager">Приховати APatch Manager</string>
    <string name="kpm_embed">Вставити</string>
    <string name="kpm_add_kpm">Додати KPM</string>
    <string name="kpm_install">Встановити</string>
    <string name="mode_select_page_title">Встановити</string>
    <string name="home_more_menu_about">Про</string>
    <string name="mode_select_page_install_inactive_slot">Встановити в неактивний слот (після OTA)</string>
    <string name="home_dialog_uninstall_title">Видалити</string>
    <string name="home_dialog_uninstall_ap_only">Видалити AndroidPatch</string>
    <string name="home_dialog_uninstall_all">Видалити все</string>
    <string name="mode_select_page_select_file">Виберіть образ завантаження для патчу</string>
    <string name="mode_select_page_install_inactive_slot_warning">Ваш пристрій буде **ПРИМУШЕНО** завантажитися в поточний неактивний слот після перезавантаження!
\nВикористовуйте цей параметр лише після завершення OTA.
\nПродовжити?</string>
    <string name="home_dialog_auth_fail_content">Неможливо автентифікувати SuperKey, тому APatch не може працювати належним чином. \nНижче наведено кілька можливих причин помилки автентифікації. \n1. Ви не виправили boot.img за допомогою KernelPatch. \n2. Виправлений boot.img не був прошитий. \n3. SuperKey неправильний або містить спеціальні символи. \n4. Ваш пристрій не підтримує APatch і KernelPatch. \n\nПеревірте та повторіть спробу. Якщо проблеми все ще є, ви завжди можете поставити запитання на сторінці проблем офіційного репозиторію.</string>
    <string name="home_more_menu_feedback_or_suggestion">Зворотній зв\'язок</string>
    <string name="home_dialog_auth_fail_title">Помилка авторизації</string>
    <string name="kpm_control_dialog_content">Введіть параметри контролю:</string>
    <string name="kpm_control_outMsg">Повідомлення</string>
    <string name="kpm_control_ok">Операцію виконано успішно!</string>
    <string name="kpm_control_failed">Операцію не виконано!</string>
    <string name="settings_night_mode_follow_sys_summary">Автоматично переключатися на темну тему залежно від налаштувань системи</string>
    <string name="settings_use_system_color_theme_summary">Використовуйте колірну тему, згенеровану системою на основі поточних шпалер</string>
    <string name="settings_custom_color_theme">Кольорова тема</string>
    <string name="blue_grey_theme">Синій сірий</string>
    <string name="green_theme">Зелена</string>
    <string name="brown_theme">Коричневий</string>
    <string name="indigo_theme">Синьо-фіолетова</string>
    <string name="light_blue_theme">Світло-синя</string>
    <string name="purple_theme">Фіолетова</string>
    <string name="red_theme">Червона</string>
    <string name="sakura_theme">Сакура</string>
    <string name="teal_theme">Чирок</string>
    <string name="yellow_theme">Жовта</string>
    <string name="orange_theme">Оранжева</string>
    <string name="about_telegram_channel">Телеграм канал</string>
    <string name="settings_use_system_color_theme">Системна кольорова тема</string>
    <string name="amber_theme">Бурштин</string>
    <string name="blue_theme">Синій</string>
    <string name="cyan_theme">Блакитна</string>
    <string name="deep_orange_theme">Темно-оранджева</string>
    <string name="deep_purple_theme">Темньо-фіолетова</string>
    <string name="light_green_theme">Світло-зелена</string>
    <string name="lime_theme">Лаймова</string>
    <string name="pink_theme">Рожева</string>
    <string name="kpm_control">Керування</string>
    <string name="about_app_version">Версія %1$s</string>
    <string name="about_app_desc">Кореневе рішення ядра лише з очищеним образом ядра, що забезпечує можливість монтування системного модуля та підключення функції ядра.</string>
    <string name="about_telegram_group">Телеграм група</string>
    <string name="about_powered_by">На основі %1$s</string>
    <string name="kpm_control_dialog_title">Управління KPModule</string>
    <string name="kpm_control_paramters">Параметри</string>
    <string name="settings_night_mode_follow_sys">Дотримуйтеся темної теми системи</string>
    <string name="settings_night_theme_enabled">Увімкнути темну тему</string>
    <string name="save_log">Зберегти журнали</string>
    <string name="apm_action">Дія</string>
    <string name="log_saved">Журнали збережено</string>
    <string name="crash_handle_title">Збій програми…</string>
    <string name="crash_handle_copied">Журнал збоїв скопійовано в буфер обміну.</string>
    <string name="crash_handle_copy">Копіювати журнал збоїв</string>
    <string name="settings_lite_mode">Увімкнути спрощений режим</string>
    <string name="settings_lite_mode_mode_summary">Функції APModule можуть демонструвати збої після ввімкнення, але в деяких випадках вони все ще можуть ефективно уникати виявлення. Потрібне перезавантаження.</string>
    <string name="settings_force_overlayfs_mode">Примусове використання OverlayFS</string>
    <string name="settings_force_overlayfs_mode_summary">Використовуйте OverlayFS для монтування APModules замість Magic Mount, коли доступна підтримка ядра. Потрібне перезавантаження.</string>
</resources>

```

`app/src/main/res/values-vi/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="home">Trang chủ</string>
    <string name="kernel_patch">Bản vá Kernel</string>
    <string name="android_patch">Bản vá Android</string>
    <string name="reboot">Khởi động lại</string>
    <string name="settings">Cài đặt</string>
    <string name="reboot_recovery">Khởi động vào Recovery</string>
    <string name="reboot_bootloader">Khởi động vào Bootloader</string>
    <string name="reboot_download">Khởi động vào Download</string>
    <string name="reboot_edl">Khởi động vào EDL</string>
    <string name="about">Giới thiệu</string>
    <string name="home_click_to_learn_apatch">Tìm hiểu về các tính năng của AndroidPatch và cách sử dụng</string>
    <string name="send_log">Gửi nhật ký</string>
    <string name="safe_mode">Chế độ an toàn</string>
    <string name="home_patch_next_step">Bước tiếp theo</string>
    <string name="home_not_installed">Chưa cài đặt</string>
    <string name="home_install_unknown">Không xác định</string>
    <string name="home_click_to_install">Bấm để cài đặt</string>
    <string name="home_working">Đang hoạt động 😋</string>
    <string name="home_installing">Đang cài đặt</string>
    <string name="home_need_update">Có bản cập nhật mới</string>
    <string name="kpatch_version">Phiên bản: %s</string>
    <string name="apatch_version_update">Phiên bản: %s -&gt; %s</string>
    <string name="home_auth_key_title">Nhập SuperKey</string>
    <string name="home_auth_key_desc">Bắt đầu sau khi được chứng nhận</string>
    <string name="home_ap_cando_install">Tải Xuống</string>
    <string name="home_ap_cando_update">Cập nhật</string>
    <string name="home_ap_cando_uninstall">Gỡ cài đặt</string>
    <string name="patch_title">Bản vá</string>
    <string name="home_manager_version">Phiên bản trình quản lý</string>
    <string name="home_fingerprint">Vân tay</string>
    <string name="home_selinux_status">Trạng thái SELinux</string>
    <string name="home_selinux_status_disabled">Tắt</string>
    <string name="home_selinux_status_enforcing">Đang thực thi (Enforcing)</string>
    <string name="home_selinux_status_permissive">Cho phép (Permissive)</string>
    <string name="home_selinux_status_unknown">Không xác định</string>
    <string name="kpm_kp_not_installed">KernelPatch chưa được cài đặt</string>
    <string name="kpm_load_toast_succ">Tải thành công</string>
    <string name="kpm_load_toast_failed">Tải không thành công</string>
    <string name="kpm_unload_confirm">Gỡ bỏ mô-đun %s?</string>
    <string name="kpm_apm_empty">Không có mô-đun nào được tải</string>
    <string name="kpm_version">Phiên bản</string>
    <string name="kpm_license">Giấy phép</string>
    <string name="kpm_load">Tải</string>
    <string name="kpm_unload">Dỡ bỏ</string>
    <string name="kpm_desc">Mô tả</string>
    <string name="su_selinux_via_hook">Bỏ qua bằng Hook</string>
    <string name="su_pkg_excluded_label">loại trừ</string>
    <string name="kpm_args">Tham số</string>
    <string name="apm_failed_to_disable">Không thể tắt mô-đun %s</string>
    <string name="apm_empty">Không có module nào được cài đặt</string>
    <string name="apm_remove">Gỡ cài đặt</string>
    <string name="apm_install">Cài đặt</string>
    <string name="apm_uninstall_confirm">Gỡ cài đặt mô-đun %s?</string>
    <string name="apm_uninstall_success">%s đã được gỡ cài đặt</string>
    <string name="apm_uninstall_failed">Không thể gỡ cài đặt %s</string>
    <string name="apm_version">Phiên bản</string>
    <string name="apm_author">Tác giả</string>
    <string name="apm_desc">Mô tả</string>
    <string name="apm_overlay_fs_not_available">Module không khả dụng do OverlayFS bị vô hiệu hoá bởi kernel!</string>
    <string name="apm_reboot_to_apply">Khởi động lại để có hiệu lực</string>
    <string name="apm_changelog">Nhật ký thay đổi</string>
    <string name="apm_update">Cập nhật</string>
    <string name="apm_downloading">Đang tải xuống module %s…</string>
    <string name="apm_start_downloading">Bắt đầu tải xuống %s</string>
    <string name="apm_new_version_available">Đã có phiên %s bản mới, nhấn để nâng cấp phiên bản mới.</string>
    <string name="patch_warnning">Việc cài đặt đi kèm với rủi ro. Hãy đảm bảo dữ liệu của bạn đã được sao lưu.</string>
    <string name="super_key">SuperKey</string>
    <string name="patch_set_superkey">Đặt SuperKey</string>
    <string name="apatch_version">Phiên bản: %s</string>
    <string name="home_learn_apatch">Tìm hiểu AndroidPatch</string>
    <string name="home_patch_set_key_desc">Chỉ có thông tin xác thực cho KernelPatch</string>
    <string name="kpm_author">Tác giả</string>
    <string name="apm_not_installed">AndroidPatch chưa được cài đặt</string>
    <string name="su_pkg_excluded_setting_title">Loại trừ các sửa đổi</string>
    <string name="su_pkg_excluded_setting_summary">Bật tùy chọn này sẽ cho phép APatch khôi phục mọi tệp đã được các mô-đun của ứng dụng này sửa đổi.</string>
    <string name="su_show_system_apps">Hiển thị ứng dụng hệ thống</string>
    <string name="su_hide_system_apps">Ẩn ứng dụng hệ thống</string>
    <string name="su_refresh">Làm mới</string>
    <string name="apm_failed_to_enable">Không thể bật mô-đun \"%s\"</string>
    <string name="clear_super_key">Xóa SuperKey</string>
    <string name="apm_magisk_conflict">Modules không khả dụng do xung đột với Magisk!</string>
    <string name="about_source_code"><![CDATA[<p>Xem mã nguồn tại %1$s<p/>Tham gia kênh %2$s của chúng tôi<p/>Tham gia nhóm %3$s của chúng tôi]]></string>
    <string name="home_su_path">Thực thi Su</string>
    <string name="home_kernel">Phiên bản Kernel</string>
    <string name="kpm">KPModule</string>
    <string name="su_title">Superuser</string>
    <string name="apm">APModule</string>
    <string name="settings_app_language">Ngôn ngữ</string>
    <string name="system_default">Mặc định hệ thống</string>
    <string name="home_apatch_version">Phiên bản APatch</string>
    <string name="patch">Bản vá</string>
    <string name="settings_global_namespace_mode">Chế độ Global Namespace</string>
    <string name="settings_global_namespace_mode_summary">Tất cả các phiên Root sử dụng Namespace Mount Global</string>
    <string name="patch_embed_kpm_btn">Nhúng KPM</string>
    <string name="patch_item_extra_event">Sự kiện:</string>
    <string name="mode_select_page_select_file">Chọn một boot image để vá</string>
    <string name="home_dialog_auth_fail_title">Xác thực thất bại</string>
    <string name="mode_select_page_install_inactive_slot">Cài đặt vào khe không hoạt động (Sau OTA)</string>
    <string name="home_dialog_auth_fail_content">Không thể xác thực SuperKey, do đó APatch không thể hoạt động bình thường.\n \nDưới đây là một số lý do có thể dẫn đến lỗi xác thực: \n1. Bạn chưa vá boot image bằng KernelPatch. \n2. Hình ảnh khởi động được vá không được flash. \n3. Super key sai. \n4. Thiết bị của bạn không hỗ trợ APatch và KernelPatch. \n \nVui lòng kiểm tra và thử lại. Nếu vẫn còn vấn đề, bạn luôn có thể đặt câu hỏi trên trang vấn đề của kho lưu trữ chính thức.</string>
    <string name="home_dialog_uninstall_all">Gỡ cài đặt tất cả</string>
    <string name="kpm_control_dialog_title">Kiểm soát KP Mô-đun</string>
    <string name="kpm_control_dialog_content">Các thông số điều khiển đầu vào:</string>
    <string name="kpm_control_paramters">Thông số</string>
    <string name="kpm_control_failed">Lỗi hệ thống!</string>
    <string name="settings_night_mode_follow_sys_summary">Tự động chuyển sang chủ đề tối theo thiết đặt của hệ thống</string>
    <string name="settings_use_system_color_theme_summary">Sử dụng chủ đề màu do hệ thống tạo với hình nền hiện tại</string>
    <string name="settings_custom_color_theme">Chủ đề màu sắc</string>
    <string name="blue_grey_theme">Chủ đề BlueGrey</string>
    <string name="brown_theme">Chủ đề màu nâu</string>
    <string name="deep_purple_theme">Chủ đề màu tím đậm</string>
    <string name="green_theme">Chủ đề xanh</string>
    <string name="indigo_theme">Chủ đề chàm</string>
    <string name="red_theme">Chủ đề màu đỏ</string>
    <string name="sakura_theme">Chủ đề hoa anh đào</string>
    <string name="orange_theme">Chủ đề màu cam</string>
    <string name="teal_theme">Chủ đề xanh mòng két</string>
    <string name="about_app_desc">Giải pháp Kernel Root chỉ với một image kernel đã được tước bỏ, cung cấp khả năng mount module hệ thống và hooking chức năng Kernel.</string>
    <string name="success">Thành công</string>
    <string name="settings_clear_super_key_dialog">Bạn có thực sự muốn tiếp tục không?</string>
    <string name="settings_check_update">Kiểm tra cập nhật</string>
    <string name="settings_check_update_summary">Tự động kiểm tra cập nhật khi mở ứng dụng</string>
    <string name="home_install_unknown_summary">Bấm để cài đặt</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="home_kpatch_info_title">Thông tin</string>
    <string name="home_ap_cando_reboot">Khởi động lại</string>
    <string name="patch_mode_bootimg_patch">Chế độ: Bản vá</string>
    <string name="patch_mode_patch_and_install">Chế độ: Patch và cài đặt</string>
    <string name="patch_mode_install_to_next_slot">Chế độ: Cài đặt vào khe không hoạt động (Sau OTA)</string>
    <string name="patch_mode_uninstall_patch">Chế độ: Gỡ cài đặt KPatch</string>
    <string name="patch_start_patch_btn">Bắt đầu</string>
    <string name="patch_start_unpatch_btn">Bỏ bản vá</string>
    <string name="patch_item_error">!!LỖI!!</string>
    <string name="patch_item_bootimg_slot">chỗ:</string>
    <string name="patch_item_bootimg">bootimg</string>
    <string name="patch_item_kpimg_version">Phiên bản:</string>
    <string name="patch_item_kpimg_config">Cấu hình:</string>
    <string name="patch_item_new_extra_kpm">Nhúng mới</string>
    <string name="patch_item_kernel">Kernel</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_extra_author">Tác giả:</string>
    <string name="patch_item_extra_kpm_license">Giấy phép:</string>
    <string name="patch_item_skey">SuperKey</string>
    <string name="home_system_version">Phiên bản hệ thống</string>
    <string name="kpm_control">Điều khiển</string>
    <string name="hide_apatch_dialog_summary">Nó sẽ được sử dụng làm nhãn ứng dụng mới hiển thị trong trình khởi chạy</string>
    <string name="hide_apatch_manager_failure">Không ẩn được. Vui lòng báo cáo lỗi!</string>
    <string name="setting_reset_su_new_path">Đường dẫn đầy đủ mới</string>
    <string name="settings_donot_store_superkey_summary">Xác thực Super Key mỗi khi mở ứng dụng quản lý</string>
    <string name="about_app_version">Phiên bản %1$s</string>
    <string name="about_telegram_channel">Kênh Telegram</string>
    <string name="about_telegram_group">Nhóm Telegram</string>
    <string name="failure">Thất bại</string>
    <string name="patch_config_title">Bản vá lỗi</string>
    <string name="patch_item_bootimg_dev">thiết bị:</string>
    <string name="patch_item_kpimg_comile_time">Thời gian:</string>
    <string name="patch_item_extra_name">Tên:</string>
    <string name="patch_item_extra_version">Phiên bản:</string>
    <string name="kpm_install">Cài đặt</string>
    <string name="kpm_embed">Nhúng</string>
    <string name="hide_apatch_manager">Ẩn Trình quản lý APatch</string>
    <string name="hide_apatch_dialog_new_manager_name">Tên người quản lý mới</string>
    <string name="setting_reset_su_path">Đặt lại đường dẫn su</string>
    <string name="mode_select_page_title">Cài đặt</string>
    <string name="mode_select_page_install_inactive_slot_warning">Thiết bị của bạn sẽ **BẮT BUỘC** khởi động vào khe không hoạt động hiện tại sau khi khởi động lại!
\nChỉ sử dụng tùy chọn này sau khi OTA hoàn tất.
\nTiếp tục?</string>
    <string name="deep_orange_theme">Chủ đề màu cam đậm</string>
    <string name="home_more_menu_feedback_or_suggestion">Góp ý hoặc báo lỗi</string>
    <string name="patch_item_set_skey_label">Độ dài của SuperKey phải có ít nhất 8 ký tự và bao gồm cả số và chữ cái.</string>
    <string name="home_device_info">Thiết bị</string>
    <string name="home_kpatch_version">Phiên bản KernelPatch</string>
    <string name="kpm_add_kpm">Thêm KPM</string>
    <string name="hide_apatch_manager_summary">Cài đặt proxy mới với ID gói ngẫu nhiên và nhãn ứng dụng tùy chỉnh</string>
    <string name="enable_web_debugging">Bật gỡ lỗi WebView</string>
    <string name="enable_web_debugging_summary">Có thể được sử dụng để gỡ lỗi WebUI, Vui lòng chỉ bật khi cần.</string>
    <string name="settings_donot_store_superkey">Đừng lưu trữ Super Key</string>
    <string name="home_new_apatch_found">Phiên bản mới %s đã có sẵn, hãy nhấp để nâng cấp.</string>
    <string name="settings_night_mode_follow_sys">Theo chủ đề tối của hệ thống</string>
    <string name="settings_night_theme_enabled">Bật chủ đề tối</string>
    <string name="blue_theme">Chủ đề màu xanh</string>
    <string name="cyan_theme">Chủ đề màu lục lam</string>
    <string name="pink_theme">Chủ đề màu hồng</string>
    <string name="yellow_theme">Chủ đề màu vàng</string>
    <string name="apm_webui_open">Mở</string>
    <string name="patch_select_bootimg_btn">Chọn boot</string>
    <string name="patch_item_existed_extra_kpm">Tồn tại</string>
    <string name="patch_item_extra_kpm_desciption">Mô tả:</string>
    <string name="patch_item_extra_args">Tham số:</string>
    <string name="mode_select_page_patch_and_install">Bản vá và cài đặt</string>
    <string name="home_dialog_uninstall_ap_only">Gỡ cài đặt AndroidPatch</string>
    <string name="kpm_control_outMsg">Tin nhắn</string>
    <string name="kpm_control_ok">Hoạt động đã thành công!</string>
    <string name="settings_use_system_color_theme">Chủ đề màu hệ thống</string>
    <string name="amber_theme">Chủ đề hổ phách</string>
    <string name="light_blue_theme">Chủ đề màu xanh nhạt</string>
    <string name="light_green_theme">Chủ đề màu xanh nhạt</string>
    <string name="lime_theme">Chủ đề vôi</string>
    <string name="purple_theme">Chủ đề màu tím</string>
    <string name="about_powered_by">Được cung cấp bởi %1$s</string>
    <string name="kpatch_version_update">Phiên bản: %s -&gt; %s</string>
    <string name="home_more_menu_about">Giới thiệu</string>
    <string name="home_dialog_uninstall_title">Gỡ cài đặt</string>
    <string name="save_log">Lưu nhật ký</string>
    <string name="log_saved">Đã lưu nhật ký</string>
    <string name="crash_handle_title">Ứng dụng bị sập…</string>
    <string name="crash_handle_copy">Sao chép nhật ký sự cố</string>
    <string name="crash_handle_copied">Nhật ký sự cố đã được sao chép vào bảng tạm.</string>
    <string name="apm_action">Hoạt động</string>
    <string name="settings_lite_mode">"Bật chế độ Lite "</string>
    <string name="settings_lite_mode_mode_summary">Các hàm APModule có thể gặp lỗi sau khi được bật, nhưng trong một số trường hợp, chúng vẫn có thể tránh bị phát hiện. Cần khởi động lại.</string>
    <string name="settings_force_overlayfs_mode">Buộc sử dụng OverlayFS</string>
    <string name="settings_force_overlayfs_mode_summary">Sử dụng OverlayFS để gắn APModules thay vì Magic Mount khi có hỗ trợ kernel. Cần khởi động lại.</string>
</resources>

```

`app/src/main/res/values-zh-rCN/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="apm">系统模块</string>
    <string name="super_key">超级密钥</string>
    <string name="app_name" translatable="false">APatch</string>
    <string name="kpm">内核模块</string>
    <string name="android_patch">系统补丁</string>
    <string name="save_log">保存日志</string>
    <string name="log_saved">日志已保存</string>
    <string name="send_log">发送日志</string>
    <string name="patch_warnning">安装过程存在风险，请确保您的数据已备份。</string>
    <string name="home_patch_set_key_desc">内核补丁的唯一授权凭证</string>
    <string name="home_install_unknown">未安装或未鉴权</string>
    <string name="home_install_unknown_summary">点此安装</string>
    <string name="reboot_download">重启至 Download</string>
    <string name="home_click_to_learn_apatch">查看 APatch 的特性和用法</string>
    <string name="reboot_edl">重启至 EDL</string>
    <string name="home_installing">安装中</string>
    <string name="safe_mode">安全模式</string>
    <string name="reboot_recovery">重启至 Recovery</string>
    <string name="home_learn_apatch">了解 APatch</string>
    <string name="kernel_patch">内核补丁</string>
    <string name="home_click_to_install">点此安装</string>
    <string name="about">关于</string>
    <string name="reboot">重启</string>
    <string name="home_need_update">新版本可升级</string>
    <string name="home">主页</string>
    <string name="back">返回</string>
    <string name="search">搜索</string>
    <string name="search_apps">搜索应用</string>
    <string name="search_modules">搜索模块</string>
    <string name="learn_more">了解更多</string>
    <string name="patch_set_superkey">设置超级密钥</string>
    <string name="settings">设置</string>
    <string name="home_working">工作中 😋</string>
    <string name="home_patch_next_step">下一步</string>
    <string name="home_not_installed">未安装</string>
    <string name="reboot_bootloader">重启至 Bootloader</string>
    <string name="about_source_code"><![CDATA[<p>在%1$s查看源码<p/>加入我们的%2$s频道<p/>加入我们的%3$s讨论组]]></string>
    <string name="home_auth_key_desc">通过验证后开始使用</string>
    <string name="kpatch_version">版本：%s</string>
    <string name="home_ap_cando_uninstall">卸载</string>
    <string name="apatch_version">版本：%s</string>
    <string name="home_ap_cando_install">安装</string>
    <string name="home_apatch_version">APatch 版本</string>
    <string name="home_su_path">可执行su路径</string>
    <string name="home_ap_cando_update">更新</string>
    <string name="apatch_version_update">版本：%s → %s</string>
    <string name="home_auth_key_title">输入超级密钥</string>
    <string name="home_kernel">内核版本</string>
    <string name="patch_title">修补</string>
    <string name="home_fingerprint">指纹</string>
    <string name="home_selinux_status">SELinux 状态</string>
    <string name="home_manager_version">管理器版本</string>
    <string name="kpm_unload_confirm">卸载“%s”模块？</string>
    <string name="kpm_kp_not_installed">未安装内核补丁</string>
    <string name="kpm_version">版本</string>
    <string name="home_selinux_status_unknown">未知</string>
    <string name="home_selinux_status_permissive">宽容模式</string>
    <string name="kpm_author">作者</string>
    <string name="kpm_load_toast_failed">加载失败</string>
    <string name="kpm_unload">卸载</string>
    <string name="kpm_control">参数</string>
    <string name="home_selinux_status_disabled">禁用</string>
    <string name="kpm_load">加载</string>
    <string name="home_selinux_status_enforcing">强制模式</string>
    <string name="kpm_license">许可</string>
    <string name="kpm_apm_empty">尚未加载模块</string>
    <string name="kpm_load_toast_succ">加载成功</string>
    <string name="su_pkg_excluded_setting_title">排除修改</string>
    <string name="su_pkg_excluded_setting_summary">针对此应用还原被模块改动的文件。</string>
    <string name="su_pkg_excluded_label">排除模块</string>
    <string name="su_title">超级用户</string>
    <string name="kpm_desc">描述</string>
    <string name="su_selinux_via_hook">劫持绕过</string>
    <string name="kpm_args">参数</string>
    <string name="su_refresh">刷新</string>
    <string name="su_show_system_apps">显示系统应用</string>
    <string name="apm_failed_to_enable">无法启用“%s”模块</string>
    <string name="su_hide_system_apps">隐藏系统应用</string>
    <string name="apm_failed_to_disable">无法禁用“%s”模块</string>
    <string name="apm_empty">尚未安装模块</string>
    <string name="apm_reboot_to_apply">重启生效</string>
    <string name="apm_uninstall_success">%s 已卸载</string>
    <string name="apm_install">安装</string>
    <string name="apm_remove">卸载</string>
    <string name="apm_uninstall_confirm">确认要卸载“%s”模块吗？</string>
    <string name="metamodule_uninstall_confirm">"您确定要卸载模块 %s 吗？此操作将影响所有模块，并且元模块提供的某些功能（如挂载）将不再工作。  "</string>
    <string name="warning_of_meta_module_title">需要元模块</string>
    <string name="warning_of_meta_module_summary">这个模块需要挂载一些文件。需要安装元模块，使它正常工作</string>
    <string name="meta_module_disabled">模块未挂载，因为元模块已禁用</string>
    <string name="meta_module_removed">模块未挂载，因为元模块即将删除</string>
    <string name="no_meta_module_installed">模块未挂载，因为未安装元模块</string>
    <string name="apm_version">版本</string>
    <string name="apm_start_downloading">开始下载 %s</string>
    <string name="apm_overlay_fs_not_available">模块功能不可用，因为内核禁用了 OverlayFS！</string>
    <string name="apm_changelog">更新日志</string>
    <string name="apm_uninstall_failed">无法卸载 %s</string>
    <string name="apm_downloading">正在下载“%s”模块……</string>
    <string name="apm_magisk_conflict">模块功能不可用，因与 Magisk 存在冲突！</string>
    <string name="apm_desc">描述</string>
    <string name="apm_new_version_available">有新版本 %s 可用，单击升级。</string>
    <string name="apm_update">更新</string>
    <string name="apm_author">作者</string>
    <string name="clear_super_key">清除超级密钥</string>
    <string name="apm_not_installed">尚未注入系统补丁</string>
    <string name="system_default">系统默认</string>
    <string name="settings_app_language">语言</string>
    <string name="patch">修补内核镜像</string>
    <string name="settings_global_namespace_mode_summary">所有 Root 会话均使用全局挂载命名空间</string>
    <string name="settings_global_namespace_mode">全局命名空间模式</string>
    <string name="settings_clear_super_key_dialog">你真的确定要继续吗？</string>
    <string name="kpatch_version_update">版本：%s → %s</string>
    <string name="kpatch_shadow_path_title">内核补丁</string>
    <string name="home_kpatch_info_title">信息</string>
    <string name="home_ap_cando_reboot">重启</string>
    <string name="patch_config_title">修补内核</string>
    <string name="patch_mode_bootimg_patch">修补指定内核镜像</string>
    <string name="patch_mode_patch_and_install">修补当前槽位内核</string>
    <string name="patch_select_bootimg_btn">选择 Boot 镜像</string>
    <string name="patch_start_patch_btn">开始修补</string>
    <string name="patch_item_error">‼错误‼</string>
    <string name="patch_item_bootimg">启动镜像</string>
    <string name="patch_item_bootimg_slot">槽位：</string>
    <string name="patch_item_bootimg_dev">设备：</string>
    <string name="patch_item_kernel">内核版本</string>
    <string name="patch_item_kpimg">内核补丁</string>
    <string name="patch_item_kpimg_version">版本：</string>
    <string name="patch_item_kpimg_comile_time">时间：</string>
    <string name="patch_item_kpimg_config">配置：</string>
    <string name="patch_item_new_extra_kpm">嵌入新的</string>
    <string name="patch_embed_kpm_btn">嵌入模块</string>
    <string name="patch_item_extra_name">名称:</string>
    <string name="patch_item_extra_version">版本：</string>
    <string name="patch_item_extra_author">作者：</string>
    <string name="patch_item_extra_kpm_license">许可：</string>
    <string name="patch_item_extra_kpm_desciption">描述：</string>
    <string name="patch_item_extra_args">参数：</string>
    <string name="patch_item_extra_event">事件:</string>
    <string name="patch_item_skey">超级密钥</string>
    <string name="patch_item_existed_extra_kpm">已嵌入的</string>
    <string name="patch_item_set_skey_label">超级密钥长度应在 8-63 个字符，包含数字和字母，但不包含特殊字符。</string>
    <string name="patch_mode_uninstall_patch">还原初始内核镜像</string>
    <string name="patch_start_unpatch_btn">取消修补</string>
    <string name="hide_apatch_dialog_new_manager_name">新管理器名称</string>
    <string name="hide_apatch_dialog_summary">将使用新的名称安装管理器</string>
    <string name="hide_apatch_manager_failure">隐藏失败，请提交反馈！</string>
    <string name="hide_apatch_manager_summary">安装代理应用，安装包 ID 随机且自定义应用标签</string>
    <string name="hide_apatch_manager">隐藏 APatch 管理器</string>
    <string name="kpm_embed">嵌入</string>
    <string name="kpm_add_kpm">添加内核模块</string>
    <string name="kpm_install">安装</string>
    <string name="setting_reset_su_path">重设 SU 路径</string>
    <string name="setting_reset_su_new_path">新的完整路径</string>
    <string name="success">成功</string>
    <string name="failure">失败</string>
    <string name="mode_select_page_title">安装</string>
    <string name="mode_select_page_patch_and_install">直接安装（通常选择此项）</string>
    <string name="mode_select_page_select_file">选取要修补的启动映像文件</string>
    <string name="mode_select_page_install_inactive_slot">修补另一槽位内核（用于 OTA 之后）</string>
    <string name="mode_select_page_install_inactive_slot_warning">将在重启后强制切换到另一个槽位！
\n注意只能在 OTA 更新完成后的重启之前使用。
\n确定要继续吗？</string>
    <string name="home_dialog_auth_fail_title">超级密钥鉴权失败</string>
    <string name="home_dialog_auth_fail_content">超级密钥验证失败，因此 APatch 不能正常工作。\n下面是一些可能的原因： \n⒈ 未使用 KernelPatch 修补内核镜像 \n⒉ KernelPatch 修补后的内核镜像未刷入 \n⒊超级密钥输入错误或包含特殊字符\n⒋设备不支持 APatch 以及 KernelPatch \n\n请检查后重试，如果问题仍然存在，可随时前往 GitHub 仓库的 issues 页面提问。</string>
    <string name="home_more_menu_feedback_or_suggestion">反馈或建议</string>
    <string name="home_more_menu_about">关于</string>
    <string name="settings_check_update">检查更新</string>
    <string name="patch_mode_install_to_next_slot">修补另一槽位内核</string>
    <string name="apm_webui_open">打开</string>
    <string name="enable_web_debugging">启用 WebView 调试</string>
    <string name="home_new_apatch_found">发现新版本：%s，单击升级。</string>
    <string name="settings_check_update_summary">应用启动时自动检测更新</string>
    <string name="enable_web_debugging_summary">可用于调试 WebUI，请仅在需要时启用。</string>
    <string name="settings_donot_store_superkey">不存储超级密钥</string>
    <string name="settings_donot_store_superkey_summary">每次打开管理器时验证超级密钥</string>
    <string name="home_device_info">设备</string>
    <string name="home_system_version">系统版本</string>
    <string name="home_kpatch_version">KernelPatch 版本</string>
    <string name="home_dialog_uninstall_title">卸载</string>
    <string name="home_dialog_uninstall_ap_only">仅卸载系统补丁</string>
    <string name="home_dialog_uninstall_all">完全卸载</string>
    <string name="kpm_control_dialog_title">调节内核模块</string>
    <string name="kpm_control_dialog_content">请输入调控参数：</string>
    <string name="kpm_control_paramters">控制参数</string>
    <string name="kpm_control_outMsg">输出信息</string>
    <string name="kpm_control_ok">操作成功！</string>
    <string name="kpm_control_failed">操作失败！</string>
    <string name="settings_night_mode_follow_sys">深色模式跟随系统</string>
    <string name="settings_night_mode_follow_sys_summary">根据系统的深色模式自动切换</string>
    <string name="settings_night_theme_enabled">深色主题</string>
    <string name="settings_use_system_color_theme">系统颜色主题</string>
    <string name="settings_use_system_color_theme_summary">使用由系统由壁纸取色生成的主题</string>
    <string name="settings_custom_color_theme">颜色主题</string>
    <string name="amber_theme">琥珀色主题</string>
    <string name="blue_theme">蓝色主题</string>
    <string name="blue_grey_theme">蓝灰色主题</string>
    <string name="brown_theme">棕色主题</string>
    <string name="cyan_theme">青蓝色主题</string>
    <string name="deep_orange_theme">深橙色主题</string>
    <string name="deep_purple_theme">深紫色主题</string>
    <string name="green_theme">绿色主题</string>
    <string name="indigo_theme">靛蓝色主题</string>
    <string name="light_blue_theme">浅蓝色主题</string>
    <string name="light_green_theme">浅绿色主题</string>
    <string name="lime_theme">柠檬色主题</string>
    <string name="orange_theme">橙色主题</string>
    <string name="pink_theme">粉红色主题</string>
    <string name="purple_theme">紫色主题</string>
    <string name="red_theme">红色主题</string>
    <string name="sakura_theme">樱花色主题</string>
    <string name="teal_theme">青绿色主题</string>
    <string name="yellow_theme">黄色主题</string>
    <string name="about_app_version">版本 %1$s</string>
    <string name="about_app_desc">内核级 ROOT 解决方案且无需重新编译内核，同时提供挂载系统模块和 Hook 内核函数的能力。</string>
    <string name="about_github" translatable="false">GitHub</string>
    <string name="about_weblate" translatable="false">Weblate</string>
    <string name="about_telegram_channel">Telegram 频道</string>
    <string name="about_telegram_group">Telegram 群组</string>
    <string name="about_powered_by">由 %1$s 强力驱动</string>
    <string name="apm_action">执行</string>
    <string name="crash_handle_title">应用崩溃了…</string>
    <string name="crash_handle_copy">复制崩溃日志</string>
    <string name="crash_handle_copied">崩溃日志已复制到剪贴板。</string>
</resources>

```

`app/src/main/res/values-zh-rTW/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>
    <string name="android_patch">Android 修補</string>
    <string name="patch_warnning">安裝過程存在風險。請確保你的資料已備份。</string>
    <string name="reboot_download">重新啟動至 Download</string>
    <string name="reboot_edl">重新啟動至 EDL</string>
    <string name="reboot_recovery">重新啟動至 Recovery</string>
    <string name="kernel_patch">核心修補</string>
    <string name="about">關於</string>
    <string name="reboot">重新啟動</string>
    <string name="home">首頁</string>
    <string name="settings">設定</string>
    <string name="reboot_bootloader">重新啟動至 Bootloader</string>
    <string name="apm_reboot_to_apply">重新啟動以應用變更</string>
    <string name="kpm_unload_confirm">確定要刪除「%s」模組嗎？</string>
    <string name="apm_uninstall_success">已解除安裝 %s</string>
    <string name="apm_install">安裝</string>
    <string name="kpatch_version">版本：%s</string>
    <string name="apm_remove">解除安裝</string>
    <string name="kpm_kp_not_installed">KernelPatch 尚未安裝</string>
    <string name="home_install_unknown">未安裝或未鑒權</string>
    <string name="apm_uninstall_confirm">確定要解除安裝「%s」模組？</string>
    <string name="su_pkg_excluded_setting_title">排除修改</string>
    <string name="home_click_to_learn_apatch">學習有關 APatch 的功能及使用方式</string>
    <string name="apm_version">版本</string>
    <string name="su_pkg_excluded_setting_summary">啟用此選項將允許 APatch 還原此應用程式被模組修改的任何檔案。</string>
    <string name="home_installing">安裝中</string>
    <string name="apm_start_downloading">開始下載 %s</string>
    <string name="su_pkg_excluded_label">忽略</string>
    <string name="su_title">超級使用者</string>
    <string name="kpm_desc">說明</string>
    <string name="su_selinux_via_hook">透過 Hook 忽略請求的方式</string>
    <string name="home_ap_cando_uninstall">解除安裝</string>
    <string name="kpm_args">引數</string>
    <string name="home_fingerprint">指紋</string>
    <string name="apatch_version">版本：%s</string>
    <string name="apm_overlay_fs_not_available">裝置核心停用了 OverlayFS，你無法使用模組功能!</string>
    <string name="kpm_version">版本</string>
    <string name="su_refresh">重新整理</string>
    <string name="su_show_system_apps">顯示系統應用程式</string>
    <string name="home_ap_cando_install">安裝</string>
    <string name="home_learn_apatch">深入瞭解 APatch</string>
    <string name="apm_failed_to_disable">無法停用「%s」模組</string>
    <string name="home_click_to_install">點擊以開始安裝</string>
    <string name="home_selinux_status_unknown">未知</string>
    <string name="home_selinux_status_permissive">允許執行</string>
    <string name="home_need_update">已有新版本可供使用</string>
    <string name="home_selinux_status">SELinux 狀態</string>
    <string name="apm_changelog">《更新紀錄》</string>
    <string name="apm_uninstall_failed">無法解除安裝 %s</string>
    <string name="kpm_author">作者</string>
    <string name="apm_failed_to_enable">無法啟用「%s」模組</string>
    <string name="apm_downloading">正在下載「%s」模組……</string>
    <string name="su_hide_system_apps">隱藏系統應用程式</string>
    <string name="apm_magisk_conflict">與 Magisk 發生衝突，你無法使用模組功能!</string>
    <string name="apm_desc">說明</string>
    <string name="home_ap_cando_update">更新</string>
    <string name="kpm_load_toast_failed">匯入失敗</string>
    <string name="kpm_unload">刪除</string>
    <string name="home_selinux_status_disabled">關閉</string>
    <string name="apm_new_version_available">點擊以安裝新版本的 %s。</string>
    <string name="apatch_version_update">版本：%s → %s</string>
    <string name="home_working">運作中 😋</string>
    <string name="apm_empty">尚未安裝模組</string>
    <string name="kpm_load">匯入</string>
    <string name="apm_update">更新</string>
    <string name="home_kernel">核心版本</string>
    <string name="home_selinux_status_enforcing">強制執行</string>
    <string name="kpm_license">授權</string>
    <string name="kpm_apm_empty">尚無已匯入的模組</string>
    <string name="home_manager_version">管理器版本</string>
    <string name="kpm_load_toast_succ">匯入成功</string>
    <string name="apm_author">作者</string>
    <string name="patch_title">修補</string>
    <string name="send_log">發送日誌</string>
    <string name="home_auth_key_desc">認證通過後開始執行</string>
    <string name="home_patch_set_key_desc">執行 KernelPatch 時所需的唯一憑證</string>
    <string name="apm">AP模組</string>
    <string name="safe_mode">安全模式</string>
    <string name="super_key">超級密鑰</string>
    <string name="home_apatch_version">APatch 版本</string>
    <string name="patch_set_superkey">設定超級密鑰</string>
    <string name="home_su_path">可執行 SU 路徑</string>
    <string name="home_patch_next_step">下一步</string>
    <string name="home_auth_key_title">輸入超級密鑰</string>
    <string name="home_not_installed">尚未安裝</string>
    <string name="kpm">KP模組</string>
    <string name="about_source_code"><![CDATA[<p>在%1$s<p/> 查看原始碼加入我們的 %2$s 頻道<p/>加入我們的 %3$s 群組]]></string>
    <string name="clear_super_key">清除超級密鑰</string>
    <string name="apm_not_installed">AndroidPatch 尚未安裝</string>
    <string name="system_default">系統預設</string>
    <string name="settings_app_language">語言</string>
    <string name="patch">修補</string>
    <string name="settings_global_namespace_mode_summary">所有 Root 工作階段將會全域掛載命名空間</string>
    <string name="settings_global_namespace_mode">全域命名空間模式</string>
    <string name="settings_clear_super_key_dialog">你確定要繼續嗎？</string>
    <string name="kpatch_version_update">版本：%s -&gt; %s</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="home_kpatch_info_title">資訊</string>
    <string name="home_ap_cando_reboot">重新啟動</string>
    <string name="patch_config_title">補丁</string>
    <string name="patch_mode_patch_and_install">模式：更新</string>
    <string name="patch_select_bootimg_btn">選擇 Boot 镜像</string>
    <string name="patch_embed_kpm_btn">嵌入核心模組</string>
    <string name="patch_start_patch_btn">開始</string>
    <string name="patch_item_error">！！錯誤！！</string>
    <string name="patch_item_bootimg">Boot 鏡像</string>
    <string name="patch_item_bootimg_slot">插槽：</string>
    <string name="patch_item_bootimg_dev">裝置:</string>
    <string name="patch_item_kernel">核心</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_new_extra_kpm">嵌入新的</string>
    <string name="patch_item_existed_extra_kpm">已嵌入</string>
    <string name="patch_item_extra_name">名稱：</string>
    <string name="patch_item_extra_version">版本：</string>
    <string name="patch_item_extra_author">作者：</string>
    <string name="patch_item_extra_kpm_license">授權：</string>
    <string name="patch_item_extra_kpm_desciption">描述：</string>
    <string name="patch_item_extra_event">事件：</string>
    <string name="patch_item_skey">超級密鑰</string>
    <string name="patch_item_set_skey_label">超級密鑰至少需要８個字符，並且同時包含數字和字母。</string>
    <string name="patch_item_extra_args">參數：</string>
    <string name="patch_mode_uninstall_patch">模式：撤銷補丁</string>
    <string name="patch_mode_bootimg_patch">模式：修補</string>
    <string name="patch_start_unpatch_btn">取消修補</string>
    <string name="patch_item_kpimg_version">版本：</string>
    <string name="patch_item_kpimg_comile_time">時間：</string>
    <string name="patch_item_kpimg_config">設定：</string>
    <string name="hide_apatch_manager">隱藏 APatch 管理器</string>
    <string name="hide_apatch_dialog_new_manager_name">新管理器名稱</string>
    <string name="hide_apatch_dialog_summary">它將用作啟動器中顯示的新應用程式標籤</string>
    <string name="hide_apatch_manager_summary">使用隨機套件 ID 和自訂應用程式標籤安裝新的代理應用程式</string>
    <string name="hide_apatch_manager_failure">隱藏失敗，請回報bug！</string>
    <string name="kpm_embed">嵌入</string>
    <string name="kpm_add_kpm">新增 KPM</string>
    <string name="kpm_install">安裝</string>
    <string name="setting_reset_su_path">重置 su 路徑</string>
    <string name="setting_reset_su_new_path">新的完整路徑</string>
    <string name="success">成功</string>
    <string name="failure">失敗</string>
    <string name="settings_check_update">檢查更新</string>
    <string name="mode_select_page_patch_and_install">修補並安裝</string>
    <string name="mode_select_page_install_inactive_slot">安裝到非活動插槽（OTA 之後）</string>
    <string name="mode_select_page_select_file">選擇要修補的「boot image」</string>
    <string name="home_dialog_auth_fail_title">鑒權失敗</string>
    <string name="enable_web_debugging">啟用 WebView 偵錯</string>
    <string name="home_more_menu_feedback_or_suggestion">回饋或建議</string>
    <string name="home_more_menu_about">關於</string>
    <string name="mode_select_page_install_inactive_slot_warning">重新啟動後，您的裝置將**強制**啟動到目前非活動插槽！
\n僅在 OTA 完成之後使用此選項。
\n繼續？</string>
    <string name="settings_check_update_summary">開啟應用程式時自動檢查更新</string>
    <string name="apm_webui_open">打開網頁介面</string>
    <string name="enable_web_debugging_summary">可用於偵錯WebUI，請僅在需要時啟用。</string>
    <string name="settings_donot_store_superkey">停用本機儲存密鑰</string>
    <string name="home_dialog_auth_fail_content">無法驗證超級密鑰，因此 APatch 無法正常運作。 \n以下是驗證失敗的一些可能原因： \n1. 您尚未使用 KernelPatch 程式修補啟動映像檔。 \n2. 修補後的啟動映像檔未刷入裝置。 \n3. 超級密鑰錯誤。 \n4. 您的裝置不支援 APatch 和 KernelPatch。 \n \n請檢查並再次嘗試。如果仍存在問題，您隨時可以在官方存放庫的議題頁面上提問。</string>
    <string name="home_install_unknown_summary">點擊以安裝</string>
    <string name="home_device_info">裝置</string>
    <string name="home_new_apatch_found">新版本可用：%s，點選升級。</string>
    <string name="mode_select_page_title">安裝</string>
    <string name="home_dialog_uninstall_title">解除安裝</string>
    <string name="home_dialog_uninstall_ap_only">僅刪除 AndroidPatch</string>
    <string name="home_dialog_uninstall_all">完全卸載</string>
    <string name="home_system_version">系統版本</string>
    <string name="home_kpatch_version">KernelPatch 版本</string>
    <string name="settings_donot_store_superkey_summary">每次管理器啟動時驗證超級密鑰</string>
    <string name="patch_mode_install_to_next_slot">模式：安裝到另一個插槽（OTA之後）</string>
    <string name="kpm_control">控制</string>
    <string name="about_telegram_group">Telegram 群組</string>
    <string name="about_powered_by">由 %1$s 提供支援</string>
    <string name="kpm_control_dialog_content">輸入控制參數：</string>
    <string name="settings_night_theme_enabled">啟用深色主題</string>
    <string name="settings_use_system_color_theme_summary">使用由系統根據月前桌布生成的顏色主題</string>
    <string name="deep_purple_theme">深紫色主題</string>
    <string name="light_blue_theme">淺藍色主題</string>
    <string name="indigo_theme">靛藍色主題</string>
    <string name="about_app_desc">核心級 ROOT 解決方案，無需重新編譯核心映像，同時提供掛載系統模組和掛鉤核心功能的能力。</string>
    <string name="kpm_control_failed">操作失敗！</string>
    <string name="cyan_theme">青色主題</string>
    <string name="kpm_control_paramters">參數</string>
    <string name="kpm_control_outMsg">訊息</string>
    <string name="kpm_control_ok">操作成功！</string>
    <string name="settings_night_mode_follow_sys">遵循系統的深色主題</string>
    <string name="settings_night_mode_follow_sys_summary">根據系統設定自動切換為深色主題</string>
    <string name="settings_use_system_color_theme">系統顏色主題</string>
    <string name="settings_custom_color_theme">顏色主題</string>
    <string name="amber_theme">琥珀色主題</string>
    <string name="blue_grey_theme">藍灰色主題</string>
    <string name="brown_theme">棕色主題</string>
    <string name="deep_orange_theme">深橙色主題</string>
    <string name="green_theme">綠色主題</string>
    <string name="light_green_theme">淺綠色主題</string>
    <string name="lime_theme">檸檬色主題</string>
    <string name="orange_theme">橙色主題</string>
    <string name="pink_theme">粉紅色主題</string>
    <string name="purple_theme">紫色主題</string>
    <string name="red_theme">紅色主題</string>
    <string name="sakura_theme">櫻花色主題</string>
    <string name="teal_theme">青綠色主題</string>
    <string name="about_app_version">版本 %1$s</string>
    <string name="about_telegram_channel">Telegram 頻道</string>
    <string name="blue_theme">藍色主題</string>
    <string name="yellow_theme">黃色主題</string>
    <string name="kpm_control_dialog_title">控制 KPModule</string>
    <string name="save_log">儲存日誌</string>
    <string name="log_saved">日誌已儲存</string>
    <string name="crash_handle_title">應用程式崩潰..</string>
    <string name="crash_handle_copy">複製崩潰日誌</string>
    <string name="apm_action">執行</string>
    <string name="crash_handle_copied">已將崩潰日誌複製到剪貼簿。</string>
    <string name="settings_force_overlayfs_mode">強制使用 OverlayFS</string>
</resources>

```

`app/src/main/res/values/arrays.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string-array name="languages">
        <item>@string/system_default</item>
        <item>Deutsch</item>
        <item>English</item>
        <item>Español</item>
        <item>Filipino</item>
        <item>Français</item>
        <item>Indonesia</item>
        <item>Italiano</item>
        <item>Jawa</item>
        <item>Norsk bokmål</item>
        <item>Polski</item>
        <item>Português</item>
        <item>Português (Brasil)</item>
        <item>Română</item>
        <item>Tiếng Việt</item>
        <item>Türkçe</item>
        <item>Ελληνικά</item>
        <item>Русский</item>
        <item>Українська</item>
        <item>الْعَرَبيّة</item>
        <item>বাংলা</item>
        <item>සිංහල</item>
        <item>ไทย</item>
        <item>日本語</item>
        <item>简体中文</item>
        <item>繁體中文</item>
    </string-array>

    <string-array name="languages_values">
        <item>default</item>
        <item>de</item>
        <item>en</item>
        <item>es</item>
        <item>fil</item>
        <item>fr</item>
        <item>in</item>
        <item>it</item>
        <item>jv</item>
        <item>nb-NO</item>
        <item>pl</item>
        <item>pt</item>
        <item>pt-BR</item>
        <item>ro</item>
        <item>vi</item>
        <item>tr</item>
        <item>el</item>
        <item>ru</item>
        <item>uk</item>
        <item>ar</item>
        <item>bn</item>
        <item>si</item>
        <item>th</item>
        <item>ja</item>
        <item>zh-CN</item>
        <item>zh-TW</item>
    </string-array>
</resources>

```

`app/src/main/res/values/ic_launcher_background.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <color name="ic_launcher_background">#081B11</color>
</resources>
```

`app/src/main/res/values/strings.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="app_name" translatable="false">APatch</string>

    <string name="home">Home</string>

    <string name="search">Search</string>
    <string name="search_apps">Search Apps</string>
    <string name="search_modules">Search modules</string>
    <string name="back">Back</string>
    <string name="learn_more">Learn more</string>

    <string name="success">Success</string>
    <string name="failure">Failure</string>

    <string name="patch_warnning">Installation comes with risks. Please ensure your data is backed up.</string>
    <string name="patch">Patch</string>

    <string name="kernel_patch">KernelPatch</string>
    <string name="android_patch">AndroidPatch</string>

    <string name="reboot">Reboot</string>
    <string name="settings">Settings</string>
    <string name="reboot_recovery">Reboot to Recovery</string>
    <string name="reboot_bootloader">Reboot to Bootloader</string>
    <string name="reboot_download">Reboot to Download</string>
    <string name="reboot_edl">Reboot to EDL</string>
    <string name="about">About</string>
    <string name="settings_app_language">Language</string>
    <string name="system_default">System default</string>
    <string name="settings_global_namespace_mode">Global namespace mode</string>
    <string name="settings_global_namespace_mode_summary">All root sessions use the global mount namespace</string>
    <string name="settings_clear_super_key_dialog">Do you really want to proceed?</string>

    <string name="settings_check_update">Check for updates</string>
    <string name="settings_check_update_summary">Automatically check for updates when opening the app</string>

    <string name="home_learn_apatch">Learn APatch</string>
    <string name="home_click_to_learn_apatch">Learn about the features of APatch and how to use</string>

    <string name="about_source_code"><![CDATA[<p>View source code at %1$s<p/>Join our %2$s channel<p/>Join our %3$s group]]></string>
    <string name="send_log">Send logs</string>
    <string name="save_log">Save logs</string>
    <string name="log_saved">Logs saved</string>
    <string name="safe_mode">Safe mode</string>

    <string name="super_key">SuperKey</string>
    <string name="clear_super_key">Clear SuperKey</string>
    <string name="patch_set_superkey">Set SuperKey</string>
    <string name="home_patch_set_key_desc">Only credential for KernelPatch</string>
    <string name="home_patch_next_step">Next step</string>

    <string name="home_not_installed">Not installed</string>
    <string name="home_install_unknown">Not installed or authenticated</string>
    <string name="home_install_unknown_summary">Click to install</string>
    <string name="home_click_to_install">Click to install</string>
    <string name="home_working">Working 😋</string>

    <string name="home_installing">Installing</string>
    <string name="home_need_update">New version available</string>
    <string name="kpatch_version">Version: %s</string>
    <string name="apatch_version">Version: %s</string>
    <string name="apatch_version_update">Version: %s -&gt; %s</string>
    <string name="kpatch_version_update">Version: %s -&gt; %s</string>
    <string name="kpatch_shadow_path_title">kpatch</string>
    <string name="home_auth_key_title">Enter SuperKey</string>
    <string name="home_auth_key_desc">Start after certification</string>
    <string name="home_kpatch_info_title">Info</string>

    <string name="home_ap_cando_install">Install</string>
    <string name="home_ap_cando_update">Update</string>
    <string name="home_ap_cando_uninstall">Uninstall</string>
    <string name="home_ap_cando_reboot">Reboot</string>

    <string name="patch_title">Patch</string>

    <string name="patch_config_title">Patches</string>
    <string name="patch_mode_bootimg_patch">Mode: Patch</string>
    <string name="patch_mode_patch_and_install">Mode: Patch and install</string>
    <string name="patch_mode_install_to_next_slot">Mode: Install to inactive slot (After OTA)</string>
    <string name="patch_mode_uninstall_patch">Mode: Uninstall KPatch</string>
    <string name="patch_select_bootimg_btn">Select boot</string>
    <string name="patch_embed_kpm_btn">Embed KPM</string>
    <string name="patch_start_patch_btn">Start</string>
    <string name="patch_start_unpatch_btn">UnPatch</string>
    <string name="patch_item_error">!!ERROR!!</string>
    <string name="patch_item_bootimg">bootimg</string>
    <string name="patch_item_bootimg_slot">Slot:</string>
    <string name="patch_item_bootimg_dev">Device:</string>
    <string name="patch_item_kernel">Kernel</string>
    <string name="patch_item_kpimg">kpimg</string>
    <string name="patch_item_kpimg_version">Version:</string>
    <string name="patch_item_kpimg_comile_time">Time:</string>
    <string name="patch_item_kpimg_config">Config:</string>
    <string name="patch_item_new_extra_kpm">Embed new</string>
    <string name="patch_item_existed_extra_kpm">Existed</string>
    <string name="patch_item_extra_name">Name:</string>
    <string name="patch_item_extra_version">Version:</string>
    <string name="patch_item_extra_author">Author:</string>
    <string name="patch_item_extra_kpm_license">License:</string>
    <string name="patch_item_extra_kpm_desciption">Description:</string>
    <string name="patch_item_extra_args">Args:</string>
    <string name="patch_item_extra_event">Event:</string>
    <string name="patch_item_skey">SuperKey</string>
    <string name="patch_item_set_skey_label">The SuperKey should be 8-63 characters long and include numbers and letters, but no special characters.</string>

    <string name="home_kernel">Kernel version</string>
    <string name="home_manager_version">Manager version</string>
    <string name="home_fingerprint">Fingerprint</string>

    <string name="home_selinux_status">SELinux status</string>
    <string name="home_selinux_status_disabled">Disabled</string>
    <string name="home_selinux_status_enforcing">Enforcing</string>
    <string name="home_selinux_status_permissive">Permissive</string>
    <string name="home_selinux_status_unknown">Unknown</string>

    <string name="home_device_info">Device</string>
    <string name="home_system_version">System version</string>
    <string name="home_kpatch_version">KernelPatch version</string>
    <string name="home_su_path">Executable su</string>
    <string name="home_apatch_version">APatch version</string>

    <string name="kpm">KPModule</string>
    <string name="kpm_kp_not_installed">KernelPatch not installed</string>
    <string name="kpm_add_kpm">Add KPM</string>
    <string name="kpm_load">Load</string>
    <string name="kpm_install">Install</string>
    <string name="kpm_embed">Embed</string>
    <string name="kpm_load_toast_succ">Load succeed</string>
    <string name="kpm_load_toast_failed">Load failed</string>
    <string name="kpm_unload_confirm">Unload %s module?</string>
    <string name="kpm_unload">Unload</string>
    <string name="kpm_control">Control</string>
    <string name="kpm_apm_empty">No module loaded</string>
    <string name="kpm_version">Version</string>
    <string name="kpm_license">License</string>
    <string name="kpm_author">Author</string>
    <string name="kpm_desc">Desc</string>
    <string name="kpm_args">Args</string>

    <string name="su_title">Superuser</string>
    <string name="su_selinux_via_hook">Bypass via hook</string>
    <string name="su_pkg_excluded_label">Exclude</string>
    <string name="su_pkg_excluded_setting_title">Exclude modifications</string>
    <string name="su_pkg_excluded_setting_summary">Enabling this option will allow APatch to restore any files modified by the modules of this app.</string>
    <string name="su_show_system_apps">Show system apps</string>
    <string name="su_hide_system_apps">Hide system apps</string>
    <string name="su_refresh">Refresh</string>

    <string name="apm">APModule</string>
    <string name="apm_not_installed">AndroidPatch not installed</string>
    <string name="apm_failed_to_enable">Failed to enable module: %s</string>
    <string name="apm_failed_to_disable">Failed to disable module: %s</string>
    <string name="apm_empty">No module installed</string>
    <string name="apm_remove">Remove</string>
    <string name="apm_install">Install</string>
    <string name="apm_uninstall_confirm">Uninstall the %s module?</string>
    <string name="metamodule_uninstall_confirm">"Are you sure you want to uninstall module %s? This action will affect all modules, and certain features provided by the metamodule (such as mounting) will no longer work.  "</string>
    <string name="apm_uninstall_success">%s uninstalled</string>
    <string name="apm_uninstall_failed">Failed to uninstall: %s</string>
    <string name="apm_version">Version</string>
    <string name="apm_author">Author</string>
    <string name="apm_desc">Desc</string>
    <string name="apm_overlay_fs_not_available">Modules are unavailable as OverlayFS is disabled by the kernel!</string>
    <string name="apm_magisk_conflict">Modules are unavailable due to a conflict with Magisk!</string>
    <string name="apm_reboot_to_apply">Reboot to take effect</string>
    <string name="apm_changelog">Changelog</string>
    <string name="apm_update">Update</string>
    <string name="apm_downloading">Downloading module: %s</string>
    <string name="apm_start_downloading">Start downloading: %s</string>
    <string name="apm_new_version_available">New version %s is available, click to upgrade.</string>

    <string name="warning_of_meta_module_title">Require Meta module</string>
    <string name="warning_of_meta_module_summary">This module want to mount /system, meta module will handle that. Otherwise, it might not work.</string>
    <string name="meta_module_disabled">module not mounted, because metamodule disabled</string>
    <string name="meta_module_removed">module not mounted, because metamodule being delete</string>
    <string name="no_meta_module_installed">module not mounted, because metamodule not installed</string>

    <string name="hide_apatch_manager">Hide APatch Manager</string>
    <string name="hide_apatch_manager_summary">Install a proxy app with a random package ID and custom app label</string>
    <string name="hide_apatch_dialog_new_manager_name">New manager name</string>
    <string name="hide_apatch_dialog_summary">It will be used as the new app label shown in launcher</string>
    <string name="hide_apatch_manager_failure">Failed to hide. Please report the bug!</string>

    <string name="setting_reset_su_path">Reset su path</string>
    <string name="setting_reset_su_new_path">New full path</string>

    <string name="apm_webui_open">Open</string>
    <string name="apm_action">Action</string>
    <string name="enable_web_debugging">Enable WebView debugging</string>
    <string name="enable_web_debugging_summary">Can be used to debug WebUI. Please enable only when needed.</string>

    <string name="settings_donot_store_superkey">Don\'t store SuperKey in local</string>
    <string name="settings_donot_store_superkey_summary">Authenticate the SuperKey every time the manager starts</string>

    <string name="home_new_apatch_found">New version %s is available, click to upgrade.</string>

    <string name="mode_select_page_title">Install</string>
    <string name="mode_select_page_patch_and_install">Patch and install</string>
    <string name="mode_select_page_select_file">Select a boot image to patch</string>
    <string name="mode_select_page_install_inactive_slot">Install to inactive slot (After OTA)</string>
    <string name="mode_select_page_install_inactive_slot_warning">Your device will be **FORCED** to boot to the current inactive slot after a reboot!\nOnly use this option after OTA is done.\nContinue?</string>

    <string name="home_dialog_auth_fail_title">Authentication failed</string>
    <string name="home_dialog_auth_fail_content">Unable to authenticate the SuperKey, therefore APatch cannot work properly.\nHere are some possible reasons for authentication failure:\n1. You didn\'t patch the boot.img with KernelPatch.\n2. The patched boot.img wasn\'t flashed.\n3. The SuperKey is wrong or contains special characters.\n4. Your device doesn\'t support APatch and KernelPatch.\n\nPlease check and try again. If there are still issues, you can always ask questions on the official repository\'s issues page.</string>

    <string name="home_more_menu_feedback_or_suggestion">Feedback or suggestion</string>
    <string name="home_more_menu_about">About</string>

    <string name="home_dialog_uninstall_title">Uninstall</string>

    <string name="home_dialog_uninstall_ap_only">Remove AndroidPatch</string>
    <string name="home_dialog_uninstall_all">Uninstall all</string>

    <string name="kpm_control_dialog_title">Control KPModule</string>
    <string name="kpm_control_dialog_content">Input control parameters:</string>
    <string name="kpm_control_paramters">Parameters</string>
    <string name="kpm_control_outMsg">Message</string>
    <string name="kpm_control_ok">Operation succeeded!</string>
    <string name="kpm_control_failed">Operation failed!</string>

    <string name="settings_night_mode_follow_sys">Follow system\'s dark theme</string>
    <string name="settings_night_mode_follow_sys_summary">Automatically switch to dark theme based on system settings</string>

    <string name="settings_night_theme_enabled">Enable dark theme</string>

    <string name="settings_use_system_color_theme">System color theme</string>
    <string name="settings_use_system_color_theme_summary">Use a color theme generated by the system based on the current wallpaper</string>

    <string name="settings_custom_color_theme">Color theme</string>
    <string name="amber_theme">Amber</string>
    <string name="blue_grey_theme">Blue grey</string>
    <string name="blue_theme">Blue</string>
    <string name="brown_theme">Brown</string>
    <string name="cyan_theme">Cyan</string>
    <string name="deep_orange_theme">Deep orange</string>
    <string name="deep_purple_theme">Deep purple</string>
    <string name="green_theme">Green</string>
    <string name="indigo_theme">Indigo</string>
    <string name="light_blue_theme">Light blue</string>
    <string name="light_green_theme">Light green</string>
    <string name="lime_theme">Lime</string>
    <string name="orange_theme">Orange</string>
    <string name="pink_theme">Pink</string>
    <string name="purple_theme">Purple</string>
    <string name="red_theme">Red</string>
    <string name="sakura_theme">Sakura</string>
    <string name="teal_theme">Teal</string>
    <string name="yellow_theme">Yellow</string>
    <string name="about_app_version">Version %1$s</string>
    <string name="about_app_desc">Kernel root solution with only a stripped kernel image, providing the ability of mounting system module and hooking kernel function.</string>
    <string name="about_github" translatable="false">GitHub</string>
    <string name="about_weblate" translatable="false">Weblate</string>
    <string name="about_telegram_channel">Telegram channel</string>
    <string name="about_telegram_group">Telegram group</string>
    <string name="about_powered_by">Powered by %1$s</string>
    <string name="crash_handle_title">App crashed…</string>
    <string name="crash_handle_copy">Copy crash log</string>
    <string name="crash_handle_copied">Crash log copied to clipboard.</string>
</resources>

```

`app/src/main/res/values/themes.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources xmlns:tools="http://schemas.android.com/tools">

    <style name="Theme.APatch" parent="Theme.AppCompat.DayNight.NoActionBar">
        <item name="android:windowLayoutInDisplayCutoutMode" tools:targetApi="o_mr1">shortEdges</item>
    </style>

    <style name="Theme.Splash" parent="Theme.SplashScreen">
        <item name="windowSplashScreenAnimatedIcon">@mipmap/ic_launcher</item>
        <item name="postSplashScreenTheme">@style/Theme.APatch</item>
    </style>

    <style name="Theme.APatch.WebUI" parent="Theme.APatch">
        <item name="android:windowLightStatusBar">true</item>
        <item name="android:windowLightNavigationBar" tools:targetApi="o_mr1">true</item>
    </style>

</resources>
```

`app/src/main/res/xml/backup_rules.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?><!--
   Sample backup rules file; uncomment and customize as necessary.
   See https://developer.android.com/guide/topics/data/autobackup
   for details.
   Note: This file is ignored for devices older that API 31
   See https://developer.android.com/about/versions/12/backup-restore
-->
<full-backup-content>
    <!--
   <include domain="sharedpref" path="."/>
   <exclude domain="sharedpref" path="device.xml"/>
-->
</full-backup-content>
```

`app/src/main/res/xml/data_extraction_rules.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?><!--
   Sample data extraction rules file; uncomment and customize as necessary.
   See https://developer.android.com/about/versions/12/backup-restore#xml-changes
   for details.
-->
<data-extraction-rules>
    <cloud-backup>
        <!-- TODO: Use <include> and <exclude> to control what is backed up.
        <include .../>
        <exclude .../>
        -->
    </cloud-backup>
    <!--
    <device-transfer>
        <include .../>
        <exclude .../>
    </device-transfer>
    -->
</data-extraction-rules>
```

`app/src/main/res/xml/file_paths.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>

<paths>
    <cache-path name="cache" path="."/>
    <root-path name="root" path="." />
</paths>
```

`app/src/main/res/xml/network_security_config.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<network-security-config>
    <domain-config cleartextTrafficPermitted="true">
        <domain includeSubdomains="true">127.0.0.1</domain>
        <domain includeSubdomains="true">0.0.0.0</domain>
        <domain includeSubdomains="true">::1</domain>
    </domain-config>
</network-security-config>
```

`build.gradle.kts`:

```kts
plugins {
    alias(libs.plugins.agp.app) apply false
    alias(libs.plugins.kotlin) apply false
    alias(libs.plugins.kotlin.compose.compiler) apply false
}

project.ext.set("kernelPatchVersion", "0.13.0")

val androidMinSdkVersion by extra(26)
val androidTargetSdkVersion by extra(36)
val androidCompileSdkVersion by extra(36)
val androidBuildToolsVersion by extra("36.1.0")
val androidCompileNdkVersion by extra("29.0.14206865")
val managerVersionCode by extra(getVersionCode())
val managerVersionName by extra(getVersionName())
val branchName by extra(getBranch())
fun Project.exec(command: String) = providers.exec {
    commandLine(command.split(" "))
}.standardOutput.asText.get().trim()

fun getGitCommitCount(): Int {
    return exec("git rev-list --count HEAD").trim().toInt()
}

fun getGitDescribe(): String {
    return exec("git rev-parse --verify --short HEAD").trim()
}

fun getVersionCode(): Int {
    val commitCount = getGitCommitCount()
    val major = 1
    return major * 10000 + commitCount + 200
}

fun getBranch(): String {
    return exec("git rev-parse --abbrev-ref HEAD").trim()
}

fun getVersionName(): String {
    return getGitDescribe()
}

tasks.register("printVersion") {
    doLast {
        println("Version code: $managerVersionCode")
        println("Version name: $managerVersionName")
    }
}

```

`docs/BG/faq_bg.md`:

```md
# ЧЗВ


## Какво е APatch?

APatch е root решение, подобно на Magisk или KernelSU, което обединява най-доброто от двете.
Комбинира удобния и лесен метод за инсталиране на Magisk чрез boot.img с мощните възможности за пачване на ядрото на KernelSU.

## Каква е разликата между APatch и Magisk?

Magisk модифицира init системата с пач в ramdisk-а на boot image-а, докато APatch пачва директно ядрото.


## APatch срещу KernelSU

KernelSU изисква изходния код на ядрото на устройството, който не винаги се предоставя от производителя. APatch работи само със стандартния boot.img.


## APatch срещу Magisk, KernelSU

APatch позволява по избор да не се модифицира SELinux, което означава, че нишката на приложението може да бъде root-ната, без да е необходимо libsu и IPC.

Kernel Patch Module е включен.


## Какво е Kernel Patch Module?

Някой код се изпълнява в Kernel Space, подобно на Loadable Kernel Modules (LKM).

Освен това, KPM позволява inline-hook и syscall-table-hook в kernel space.

За повече информация виж Как да напишем KPM

## Връзка между APatch и KernelPatch

APatch зависи от KernelPatch, наследява всичките му възможности и е разширен.

Можеш да инсталираш само KernelPatch, но това няма да ти позволи да използваш Magisk модули.

Научи повече за KernelPatch

## Какво е SuperKey?

KernelPatch добавя нов системен повик (syscall), който предоставя всички възможности на приложенията и програмите в потребителското пространство. Този syscall се нарича SuperCall.
Когато приложение/програма се опита да извика SuperCall, трябва да предостави идентификационен ключ, наречен SuperKey.
SuperCall може да бъде извикан успешно само ако SuperKey е правилен. Ако не е, извикващият остава незасегнат.

## А какво става със SELinux?

KernelPatch не модифицира SELinux контекста и го заобикаля чрез hook.
Това позволява root достъп до нишка на Android в контекста на самото приложение, без да е необходимо да се използва libsu за стартиране на нов процес и IPC.
Това е много удобно.

Освен това, APatch използва директно magiskpolicy за допълнителна поддръжка на SELinux.



```

`docs/ar/faq_ar.md`:

```md
# الأسئلة الشائعة (FAQ)

## ما هو أباتش؟
أباتش هو حل روت شبيه بـ ماجيسك أو كيرنل إس يو، يجمع بين أفضل ما في كليهما.  
يستخدم طريقة التثبيت السهلة الخاصة بـ ماجيسك من خلال `boot.img`، مع قدرات تعديل النواة القوية التي يوفرها كيرنل إس يو.

## ما الفرق بين أباتش وماجيسك؟
- ماجيسك يقوم بتعديل نظام init عبر تعديل في ramdisk الخاص بملف boot image، بينما أباتش يقوم بتعديل النواة مباشرة.

## أباتش مقابل كيرنل إس يو
- كيرنل إس يو يحتاج إلى الكود المصدري للنواة الخاصة بجهازك، والذي لا توفره الشركات دائمًا.  
  أما أباتش فيعمل فقط باستخدام ملف `boot.img` الأصلي.

## أباتش مقابل ماجيسك وكيرنل إس يو
- يسمح لك أباتش بعدم تعديل SELinux اختياريًا، مما يعني أن خيوط التطبيق (APP thread) يمكن أن تحصل على صلاحيات الروت، دون الحاجة إلى libsu أو IPC.
- **وحدة تعديل النواة (Kernel Patch Module)** متوفرة.

## ما هي وحدة تعديل النواة (Kernel Patch Module)؟
بعض الشيفرات تعمل ضمن مساحة النواة، مشابهة لـ LKM (وحدات نواة قابلة للتحميل).  
بالإضافة إلى ذلك، توفر KPM القدرة على تنفيذ inline-hook و syscall-table-hook ضمن مساحة النواة.

لمزيد من المعلومات، راجع [كيفية كتابة KPM](https://github.com/bmax121/KernelPatch/blob/main/doc/module.md)

## العلاقة بين أباتش وKernelPatch
يعتمد أباتش على KernelPatch، ويرث جميع قدراته، وتم توسيعه ليشمل ميزات إضافية.  
يمكنك تثبيت KernelPatch فقط، لكنك لن تستطيع استخدام وحدات ماجيسك معه.

[تعرف أكثر على KernelPatch](https://github.com/bmax121/KernelPatch)

## ما هو SuperKey؟
يضيف KernelPatch نداء نظامي (syscall) جديد يمنح كافة الصلاحيات للتطبيقات والبرامج في مساحة المستخدم (userspace)، وهذا النداء يسمى **SuperCall**.  
عندما يحاول تطبيق أو برنامج استدعاء **SuperCall**، يجب أن يقدم بيانات اعتماد وصول تُعرف باسم **SuperKey**.  
يتم تنفيذ **SuperCall** بنجاح فقط إذا كانت **SuperKey** صحيحة، وإن لم تكن كذلك فلن يتأثر المستدعي.

## ماذا عن SELinux؟
- لا يقوم KernelPatch بتعديل سياق SELinux، بل يتجاوزه من خلال hook.  
  هذا يسمح بعمل روت لخيط (thread) داخل التطبيق دون الحاجة لاستخدام libsu لبدء عملية جديدة ثم إجراء IPC، مما يجعله مريحًا جدًا.
- بالإضافة إلى ذلك، يستخدم أباتش أداة magiskpolicy مباشرة لتوفير دعم إضافي لـ SELinux.

```

`docs/az/faq_az.md`:

```md
# TSS


## APatch nədir?
APatch, hər ikisinin ən yaxşısını birləşdirən Magisk və ya KernelSU-ya bənzər kök həllidir.
O, Magisk-in `boot.img` vasitəsilə rahat və asan quraşdırma metodunu KernelSU-nun güclü nüvə yamaqlamaq qabiliyyətləri ilə birləşdirir.


## APatch və Magisk arasındakı fərq nədir?
- Magisk başlanğıc sistemini nüvə imajınızın ramdiskindəki yamaq ilə dəyişdirir, APatch isə nüvəni birbaşa yamaqlayır.


## APatch vs KernelSU
- KernelSU cihazınızın nüvəsi üçün həmişə OEM tərəfindən təmin edilməyən mənbə kodunu tələb edir. APAtch yalnız sizin stok `boot.img` ilə işləyir.


## APatch vs Magisk, KernelSU
- APatch istəyə bağlı olaraq SELinux-u dəyişdirməməyə imkan verir, bu o deməkdir ki, Android proqramı köklənə bilər, libsu və IPC zəruri deyil.
- **Nüvə Yamaq Modulu** təmin edilmişdir.


## Nüvə Yamaq Modulu nədir?
Bəzi kodlar Yüklənəbilən Nüvə Modulları (LKM) kimi Nüvə Məkanında işləyir.

Əlavə olaraq, KPM nüvə məkanında daxili-çəngəl, sistem-zəngi-cədvəli-çəngəlləri etmək imkanı verir.

Ətraflı məlumat üçün [KPM necə yazılır](https://github.com/bmax121/KernelPatch/blob/main/doc/module.md) bölməsinə baxın.


## APatch və NüvəYamağı arasındakı əlaqə

APatch NüvəYamağından asılıdır, onun bütün imkanlarını miras alır və genişləndirilib.

Siz yalnızca NüvəYamağı quraşdıra bilərsiniz, lakin bu, Magisk modullarından istifadə etməyə imkan verməyəcək və superistifadəçi idarəçiliyindən istifadə etmək üçün AndroidYamağını quraşdırmalı və sonra onu silməlisiniz.

[NüvəYamağı haqqında ətraflı öyrənin](https://github.com/bmax121/KernelPatch)


## SuperAçar nədir?
NüvəYamağı istifadəçi məkanındakı tətbiq və proqramlara bütün imkanları təmin etmək üçün yeni sistem zəngi (syscall) əlavə edir, bu sistem zəngi **SuperZəng** adlanır.
Tətbiq/proqram **SuperZəngi** işə salmağa çalışdıqda, o, **SuperAçar** kimi tanınan giriş etimadnaməsini təmin etməlidir.
**SuperZəng** yalnız **SuperAçar** düzgün olduqda uğurla işə salına bilər və bu deyilsə, zəng edən şəxs təsirsiz qalacaq.


## SELinux bəs?
- NüvəYamağı SELinux kontekstini dəyişdirmir və çəngəl vasitəsilə SELinux-dan yan keçir.
  Bu, yeni prosesə başlamaq və sonra IPC yerinə yetirmək üçün libsu-dan istifadə etmədən proqram kontekstində Android mövzusunu kökləməyə imkan verir.
  Bu çox rahatdır.
- Bundan əlavə, APatch əlavə SELinux dəstəyi təmin etmək üçün birbaşa magiskpolicy-dən istifadə edir.

```

`docs/cn/ap_module.md`:

```md
# 模块(APM)开发指南 {#introduction}

APatch 提供了一个模块机制（ AndroidPatch Module），它可以在保持系统分区完整性的同时达到修改系统分区的效果；这种机制通常被称之为 systemless。

APatch 的模块实现是从 [KernelSU](https://github.com/tiann/KernelSU) 模块复制并修改而来，感谢 KernelSU。  
具体修改的代码对应位置：  
KernelSU: [https://github.com/tiann/KernelSU/tree/main/userspace/ksud](https://github.com/tiann/KernelSU/tree/main/userspace/ksud)  
APatch: [https://github.com/bmax121/APatch/tree/main/apd](https://github.com/bmax121/APatch/tree/main/apd)

以下的文档内容也是从 KernelSU 的文档复制并修改而来，其中大部分的内容是一致。需要注意的主要有以下几个地方

1. 文件位置
2. 环境变量
3. SELinux 支持，APatch 直接使用了 magiskpolicy

APatch 的模块运作机制与 Magisk 几乎是一样的，如果你熟悉 Magisk 模块的开发，那么开发 APatch 的模块大同小异，你可以跳过下面有关模块的介绍，只需要了解 [APatch 模块与 Magisk 模块的异同](difference-with-magisk.md)。

<!-- ## 模块界面

APatch 的模块支持显示界面并与用户交互，请参阅 [WebUI 文档](module-webui.md)。 -->

## Busybox

APatch 提供了一个功能完备的 BusyBox 二进制文件（包括完整的SELinux支持）。可执行文件位于 `/data/adb/ap/bin/busybox`。
APatch 的 BusyBox 支持运行时可切换的 "ASH Standalone Shell Mode"。
这种独立模式意味着在运行 BusyBox 的 ash shell 时，每个命令都会直接使用 BusyBox 中内置的应用程序，而不管 PATH 设置为什么。
例如，`ls`、`rm`、`chmod` 等命令将不会使用 PATH 中设置的命令（在Android的情况下，默认情况下分别为 `/system/bin/ls`、`/system/bin/rm` 和 `/system/bin/chmod`），而是直接调用 BusyBox 内置的应用程序。
这确保了脚本始终在可预测的环境中运行，并始终具有完整的命令套件，无论它运行在哪个Android版本上。
要强制一个命令不使用BusyBox，你必须使用完整路径调用可执行文件。

在 APatch 上下文中运行的每个 shell 脚本都将在 BusyBox 的 ash shell 中以独立模式运行。对于第三方开发者相关的内容，包括所有启动脚本和模块安装脚本。

对于想要在 APatch 之外使用这个“独立模式”功能的用户，有两种启用方法:

1. 设置环境变量 `ASH_STANDALONE` 为 `1`。例如：`ASH_STANDALONE=1 /data/adb/ap/bin/busybox sh <script>`
2. 使用命令行选项切换：`/data/adb/ap/bin/busybox sh -o standalone <script>`

为了确保所有后续的 `sh` shell 都在独立模式下执行，第一种是首选方法（这也是 APatch 和 APatch 管理器内部使用的方法），因为环境变量会被继承到子进程中。

::: tip 与 KernelSU 的差异

busybox 的位置由 /data/adb/ksu/bin/busybox 改到了 /data/adb/ap/bin/busybox
:::

::: tip 与 Magisk 的差异

APatch 的 BusyBox 现在是直接使用 Magisk 项目编译的二进制文件，**感谢 Magisk！**
因此，你完全不用担心 BusyBox 脚本与在 Magisk 和 APatch 之间的兼容问题，因为他们是完全一样的！
:::

## APatch 模块 {#APatch-modules}

APatch 模块就是一个放置在 `/data/adb/modules` 内且满足如下结构的文件夹：

```txt
/data/adb/modules
├── .
├── .
|
├── $MODID                  <--- 模块的文件夹名称与模块 ID 相同
│   │
│   │      *** 模块配置文件 ***
│   │
│   ├── module.prop         <--- 此文件保存模块相关的一些配置，如模块 ID、版本等
│   │
│   │      *** 模块内容 ***
│   │
│   ├── system              <--- 这个文件夹通常会被挂载到系统
│   │   ├── ...
│   │   ├── ...
│   │   └── ...
│   │
│   │      *** 标记文件 ***
│   │
│   ├── skip_mount          <--- 如果这个文件存在，那么模块的 `/system` 将不会被挂载
│   ├── disable             <--- 如果这个文件存在，那么模块会被禁用
│   ├── remove              <--- 如果这个文件存在，下次重启的时候模块会被移除
│   │
│   │      *** 可选文件 ***
│   │
│   ├── post-fs-data.sh     <--- 这个脚本将会在 post-fs-data 模式下运行
│   ├── post-mount.sh       <--- 这个脚本将会在 post-mount 模式下运行
│   ├── service.sh          <--- 这个脚本将会在 late_start 服务模式下运行
│   ├── boot-completed.sh   <--- 这个脚本将会在 Android 系统启动完毕后以服务模式运行
|   ├── uninstall.sh        <--- 这个脚本将会在模块被卸载时运行
|   ├── action.sh           <--- 这个脚本将会在管理器模块中点击 Action 时运行
│   ├── system.prop         <--- 这个文件中指定的属性将会在系统启动时通过 resetprop 更改
│   ├── sepolicy.rule       <--- 这个文件中的 SELinux 策略将会在系统启动时加载
│   │
│   │      *** 自动生成的目录，不要手动创建或者修改！ ***
│   │
│   ├── vendor              <--- A symlink to $MODID/system/vendor
│   ├── product             <--- A symlink to $MODID/system/product
│   ├── system_ext          <--- A symlink to $MODID/system/system_ext
│   │
│   │      *** Any additional files / folders are allowed ***
│   │
│   ├── ...
│   └── ...
|
├── another_module
│   ├── .
│   └── .
├── .
├── .
```

::: tip 与 Magisk 的差异
APatch 没有内置的针对 Zygisk 的支持，因此模块中没有 Zygisk 相关的内容
<!-- ，但你可以通过 [ZygiskNext](https://github.com/Dr-TSNG/ZygiskNext) 来支持 Zygisk 模块，此时 Zygisk 模块的内容与 Magisk 所支持的 Zygisk 是完全相同的。 -->
:::

### module.prop

module.prop 是一个模块的配置文件，在 APatch 中如果模块中不包含此文件，那么它将不被认为是一个模块；此文件的格式如下：

```txt
id=<string>
name=<string>
version=<string>
versionCode=<int>
author=<string>
description=<string>
```

- id 必须与这个正则表达式匹配：`^[a-zA-Z][a-zA-Z0-9._-]+$` 例如：✓ `a_module`，✓ `a.module`，✓ `module-101`，✗ `a  module`，✗ `1_module`，✗ `-a-module`。这是您的模块的唯一标识符，发布后不应更改。
- versionCode 必须是一个整数，用于比较版本。
- 其他未在上面提到的内容可以是任何单行字符串。
- 请确保使用 UNIX（LF）换行类型，而不是Windows（CR + LF）或 Macintosh（CR）。

### Shell 脚本 {#shell-scripts}

请阅读 [启动脚本](#boot-scripts) 一节，以了解 `post-fs-data.sh`, `post-mount.sh`, `service.sh` 和 `boot-completed.sh` 之间的区别。对于大多数模块开发者来说，如果您只需要运行一个启动脚本，`service.sh` 应该已经足够了。

在您的模块的所有脚本中，请使用 `MODDIR=${0%/*}`来获取您的模块的基本目录路径；请勿在脚本中硬编码您的模块路径。

:::tip 与 Magisk, KernelSU 的差异
你可以通过环境变量 `APATCH` 来判断脚本是否运行在 APatch 中，如果运行在 APatch，这个值会被设置为 `true`。
:::

### `system` 目录 {#system-directories}

这个目录的内容会在系统启动后，以 `overlayfs` 的方式叠加在系统的 `/system` 分区之上，这意味着：

1. 系统中对应目录的同名文件会被此目录的文件覆盖。
2. 系统中对应目录的同名文件夹会与此目录的文件夹合并。

如果你想删掉系统原来目录某个文件或者文件夹，你需要在模块目录通过 `mknod filename c 0 0` 来创建一个 `filename` 的同名文件；这样 overlayfs 系统会自动 whiteout 等效删除此文件（`/system` 分区并没有被更改）。

你也可以在 `customize.sh` 中声明一个名为 `REMOVE` 并且包含一系列目录的变量来执行删除操作，APatch 会自动为你在模块对应目录执行 `mknod <TARGET> c 0 0`。例如：

```sh
REMOVE="
/system/app/YouTube
/system/app/Bloatware
"
```

上面的这个列表将会执行： `mknod $MODPATH/system/app/YouTuBe c 0 0` 和 `mknod $MODPATH/system/app/Bloatware c 0 0`；并且 `/system/app/YouTube` 和 `/system/app/Bloatware` 将会在模块生效后被删除。

如果你想替换掉系统的某个目录，你需要在模块目录创建一个相同路径的目录，然后为此目录设置此属性：`setfattr -n trusted.overlay.opaque -v y <TARGET>`；这样 overlayfs 系统会自动将系统内相应目录替换（`/system` 分区并没有被更改）。

你可以在 `customize.sh` 中声明一个名为 `REPLACE` 并且包含一系列目录的变量来执行替换操作，APatch 会自动为你在模块对应目录执行相关操作。例如：

```sh
REPLACE="
/system/app/YouTube
/system/app/Bloatware
"
```

上面这个列表将会：自动创建目录 `$MODPATH/system/app/YouTube` 和 `$MODPATH//system/app/Bloatware`，然后执行 `setfattr -n trusted.overlay.opaque -v y $$MODPATH/system/app/YouTube` 和 `setfattr -n trusted.overlay.opaque -v y $$MODPATH/system/app/Bloatware`；并且 `/system/app/YouTube` 和 `/system/app/Bloatware` 将会在模块生效后替换为空目录。

:::tip 与 Magisk 的差异

APatch 的 systemless 机制是通过内核的 overlayfs 实现的，而 Magisk 当前则是通过 magic mount (bind mount)，二者实现方式有着巨大的差异，但最终的目标实际上是一致的：不修改物理的 `/system` 分区但实现修改 `/system` 文件。
:::

如果你对 overlayfs 感兴趣，建议阅读 Linux Kernel 关于 [overlayfs 的文档](https://docs.kernel.org/filesystems/overlayfs.html)

### system.prop

这个文件的格式与 `build.prop` 完全相同：每一行都是 `[key]=[value]` 的形式。

### sepolicy.rule

如果您的模块需要一些额外的 SELinux 策略补丁，请将这些规则添加到此文件中。这个文件中的每一行都将被视为一个策略语句。

## 模块安装包 {#module-installer}

APatch 的模块安装包就是一个可以通过 APatch 管理器 APP 刷入的 zip 文件，此 zip 文件的格式如下：

```txt
module.zip
│
├── customize.sh                       <--- (Optional, more details later)
│                                           This script will be sourced by update-binary
├── ...
├── ...  /* 其他模块文件 */
│
```

:::warning
APatch 模块不支持在 Recovery 中安装！！
:::

### 定制安装过程 {#customizing-installation}

如果你想控制模块的安装过程，可以在模块的目录下创建一个名为 `customize.sh` 的文件，这个脚本将会在模块被解压后**导入**到当前 shell 中，如果你的模块需要根据设备的 API 版本或者设备构架做一些额外的操作，那这个脚本将非常有用。

如果你想完全控制脚本的安装过程，你可以在 `customize.sh` 中声明 `SKIPUNZIP=1` 来跳过所有的默认安装步骤；此时，你需要自行处理所有安装过程（如解压模块，设置权限等）

`customize.sh` 脚本以“独立模式”运行在 APatch 的 BusyBox `ash` shell 中。你可以使用如下变量和函数：

#### 变量 {#variables}

- `KERNELPATCH` (bool): 标记此脚本运行在 APatch 环境下，此变量的值将永远为 `true`
- `KERNEL_VERSION` (hex): 从 KernelPatch 继承，内核版本号 (如： `50a01` 是指 5.10.1)
- `KERNELPATCH_VERSION` (hex): 从 KernelPatch 继承，KernelPatch 版本号 (如： `a05` 是指 0.10.5)
- `SUPERKEY` (string): 从 KernelPatch 继承，用于调用 kpatch 或者 supercall

- `APATCH` (bool): 标记此脚本运行在 APatch 环境下，此变量的值将永远为 `true`
- `APATCH_VER_CODE` (int): APatch 当前的版本号 (如. `10672`)
- `APATCH_VER` (string): APatch 当前的版本名 (如. `10672`)

- `BOOTMODE` (bool): 此变量在 APatch 中永远为 `true`
- `MODPATH` (path): 当前模块的安装目录
- `TMPDIR` (path): 可以存放临时文件的目录
- `ZIPFILE` (path): 当前模块的安装包文件
- `ARCH` (string): 设备的 CPU 构架，只有 `arm64`
- `IS64BIT` (bool): 是否是 64 位设备
- `API` (int): 当前设备的 Android API 版本 (如：Android 6.0 上为 `23`)

::: warning
`MAGISK_VER_CODE` 在 APatch 为 `27000`，`MAGISK_VER` 则为 `27.0`
:::

#### 函数 {#functions}

```txt
ui_print <msg>
    print <msg> to console
    Avoid using 'echo' as it will not display in custom recovery's console

abort <msg>
    print error message <msg> to console and terminate the installation
    Avoid using 'exit' as it will skip the termination cleanup steps

set_perm <target> <owner> <group> <permission> [context]
    if [context] is not set, the default is "u:object_r:system_file:s0"
    this function is a shorthand for the following commands:
       chown owner.group target
       chmod permission target
       chcon context target

set_perm_recursive <directory> <owner> <group> <dirpermission> <filepermission> [context]
    if [context] is not set, the default is "u:object_r:system_file:s0"
    for all files in <directory>, it will call:
       set_perm file owner group filepermission context
    for all directories in <directory> (including itself), it will call:
       set_perm dir owner group dirpermission context
```

## 启动脚本 {#boot-scripts}

在 APatch 中，根据脚本运行模式的不同分为两种：post-fs-data 模式和 late_start 服务模式。

- post-fs-data 模式
    - 这个阶段是阻塞的。在执行完成之前或者 10 秒钟之后，启动过程会暂停。
    - 脚本在任何模块被挂载之前运行。这使得模块开发者可以在模块被挂载之前动态地调整它们的模块。
    - 这个阶段发生在 Zygote 启动之前。
    - 使用 setprop 会导致启动过程死锁！请使用 `resetprop -n <prop_name> <prop_value>` 代替。
    - **只有在必要时才在此模式下运行脚本**。

- late_start 服务模式
    - 这个阶段是非阻塞的。你的脚本会与其余的启动过程**并行**运行。
    - **大多数脚本都建议在这种模式下运行**。

在 APatch 中，启动脚本根据存放位置的不同还分为两种：通用脚本和模块脚本。

- 通用脚本
    - 放置在 `/data/adb/post-fs-data.d`, `/data/adb/post-mount.d`, `/data/adb/service.d` 或 `/data/adb/boot-completed.d` 中。
    - 只有在脚本被设置为可执行（`chmod +x script.sh`）时才会被执行。
    - 在 `post-fs-data.d` 中的脚本以 post-fs-data 模式运行，在 `service.d` 中的脚本以 late_start 服务模式运行。
    - 模块**不应**在安装过程中添加通用脚本。

- 模块脚本
    - 放置在模块自己的文件夹中。
    - 只有当模块被启用时才会执行。
    - `post-fs-data.sh` 以 post-fs-data 模式运行，`post-mount.sh` 以 post-mount 模式运行，而 `service.sh` 则以 late_start 服务模式运行，`boot-completed` 在 Android 系统启动完毕后以服务模式运行。

所有启动脚本都将在 APatch 的 BusyBox ash shell 中运行，并启用“独立模式”。  


### 启动脚本的流程解疑 {#Boot-scripts-process-explanation}
以下是 Android 的相关启动流程（部分省略），其中包括了 Apatch 的操作（带前导星号），应该能帮助你更好地理解这些启动脚本的用途：

```txt
0. BootLoader (nothing on sceen)
load patched boot.img
...

1. kernel init (oem logo on screen)
mount /dev, /dev/pts, /proc, /sys, etc.
property-init -> read default props
read init.rc
...
early-init -> init -> late_init
early-fs
   start vold
fs
  mount /vendor, /system, /persist, etc.
post-fs-data
  *safe mode check
  *execute general scripts in post-fs-data.d/
  *load sepolicy.rule -> magiskpolicy
  *mount tmpfs, devpts
  *execute module scripts post-fs-data.sh
    **(Zygisk)./bin/zygisk-ptrace64 monitor
  *(pre)load system.prop (same as `resetprop -n`)
  *remount modules /system
  *execute general scripts in post-mount.d/
  *execute module scripts post-mount.sh
zygote-start
load_all_props_action
  *execute resetprop (actual set props for resetprop with -n option)
... -> boot
  class_start core
    start-service logd, console, vold, etc.
  class_start main
    start-service adb, netd, zygote, etc.

2. kernel2user init (rom animation on screen, start by service bootanim)
*execute general scripts in service.d/
*execute module scripts service.sh
*set props for resetprop without -p option
  **(Zygisk) hook zygote (start zygiskd)
  **(Zygisk) mount zygisksu/module.prop
start system apps (autostart)
...
boot complete (broadcast ACTION_LOCKED_BOOT_COMPLETED event)
*execute general scripts in boot-completed.d/
*execute module scripts boot-completed.sh

3. User operable (lock screen)
input password to decrypt /data/data
*actual set props for resetprop with -p option
start user apps (autostart)
```

如果你对 Android 的 init 语言感兴趣，推荐阅读[文档](https://android.googlesource.com/platform/system/core/+/master/init/README.md)

```

`docs/cn/faq_cn.md`:

```md
# 常见问题解答

## 什么是APatch？

APatch是一种类似于Magisk或KernelSU的root解决方案，但APatch提供更多功能。
APatch分别结合了Magisk方便易用的通过`boot.img`安装的方法，和KernelSU强大的内核修补能力。

## APatch与Magisk的区别？

- Magisk对启动映像中的ramdisk进行补丁，以修改init系统。而APatch则直接修补Linux内核。

## APatch与KernelSU的区别？

- KernelSU需要您设备的内核的源代码，而OEM并不总是提供该源码。而APatch仅需要您的设备原本的`boot.img`。

## APatch与Magisk、KernelSU的区别？

- APatch可选择不修改SELinux，这意味着Android应用程序线程可以被root，无需libsu和IPC。
- APatch提供**Kernel Patch Module（KP模块）**。

## 什么是Kernel Patch Module（KP模块）？

一些代码在内核空间运行，类似于Loadable Kernel Modules（LKM）。

此外，KPM提供在内核空间进行内联hook、系统调用表hook的能力。

更多相关信息，请参阅[如何编写KPM](https://github.com/bmax121/KernelPatch/blob/main/doc/module.md)

## APatch与KernelPatch的关系

APatch依赖于KernelPatch，继承了其所有功能并进行了扩展。

您可以仅安装KernelPatch，但如此将不允许您使用Magisk模块。  
要使用超级用户管理，您需要安装AndroidPatch，然后卸载KernelPatch。

[了解更多关于KernelPatch的信息](https://github.com/bmax121/KernelPatch)

## 什么是SuperKey（超级密钥）？

KernelPatch 添加了一个新的系统调用（syscall），为应用程序和用户空间中的程序提供所有功能，此系统调用称为SuperCall。 
当应用程序/程序尝试调用SuperCall时，它需要提供访问凭据，称为SuperKey。
只有当SuperKey正确时，才能成功调用 SuperCall。否则，调用方将不受影响。

## 关于SELinux如何处理？

- KernelPatch不修改SELinux上下文，而是通过hook绕过SELinux。 这允许您在应用程序上下文中root Android线程，无需使用libsu启动新进程，然后执行IPC。这非常方便。
- 此外，APatch直接利用magiskpolicy提供额外的SELinux支持。  

```

`docs/cn_tw/faq_cn_tw.md`:

```md
# 〈常見問題集〉


## 什麼是 APatch？
APatch 為一套汲取 Magisk、KernelSU 優勢於一身的 Root 解決方案。
不僅保留 Magisk 自身便捷、修補 `boot.img` 即用的特性，也有 KernelSU 強大的核心修補功能。


## APatch 與 Magisk 的差別為何？
- Magisk 會先調用 boot 修補鏡像的 ramdisk，再修改 init 系統；APatch 則經由修補鏡像，直接修改核心本身。


## APatch vs KernelSU
- KernelSU 依託 OEM 廠商提供的裝置核心原始碼，但並非每間廠商都會提供；而 APatch 只需修補原廠 `boot.img`。


## APatch vs Magisk、KernelSU
- APatch 可選擇不修改 SELinux，但仍讓應用程式執行緒調用 Root 權限。過程不需要 libsu 以及 IPC。
- 支援**核心修補模組**。


## 什麼是核心修補模組？
**核心修補模組**為一套執行在核心空間的程式片段——類似於裝載式核心模組（LKM）——。

包括 inline-hook、syscall-table-hook，核心修補模組也能做到。

更多詳情，請參閱[〈如何編寫核心修補模組？〉](https://github.com/bmax121/KernelPatch/blob/main/doc/module.md)（英語）。


## APatch 和 KernelPatch 的關係

APatch 基於 KernelPatch。繼承 KernelPatch 特性的基礎之上，新增更多功能。

你也能選擇只安裝 KernelPatch，但這樣就沒辦法使用 Magisk 模組，且包括管理超級使用者權限在內的功能，你都必須解除安裝 KernelPatch 後再安裝 AndroidPatch。

[深入了解 KernelPatch](https://github.com/bmax121/KernelPatch)


## 什麼是超級密鑰？
**超級密鑰**為 KernelPatch 上的系統呼叫（syscall）服務，旨在讓使用者空間內的程式也能套用修補變更；也稱作**超級呼叫**。當程式請求**超級呼叫**，需提供一份稱作**超級密鑰**的存取憑證。
**超級呼叫**僅在**超級密鑰**正確無虞之下生效，反之則失效。


## 那 SELinux 怎麼辦？
- KernelPatch 不修改 SELinux 內容，而是使用 Hook 忽略 SELinux 層；
  換句話說，應用程式內的 Android 執行緒可直接調用 Root 權限，而不用經過讓 libsu 新增運算排程、安排 IPC 等步驟。
  可謂事半功倍。
- 此外，由於 APatch 使用了 magiskpolicy，使你能有額外的 SELinux 支援。

```

`docs/de/faq_de.md`:

```md
# Häufig gestellte Fragen


## Was ist APatch?
APatch ist eine Root-Lösung, ähnlich wie Magisk oder KernelSU, welche das Beste beider vereint.
Es kombiniert Magisks bequeme und leichte Installationsmethode über `boot.img` mit KernelSUs starken Kernel-Korrektur-Fähigkeiten.


## Was ist der Unterschied zwischen APatch und Magisk?
- Magisk modifiziert das Init-System mit einer Korrektur in Ihrem boot image ramdisk, während APatch den Kernel direkt korrigiert.


## APatch gegen KernelSU
- KernelSU benötigt den Quellcode für dein Geräte-Kernel, welcher nicht immer von der OEM gegeben wird. APatch funktioniert allein mit Ihrem Standard-`boot.img`.


## APatch gegen Magisk, KernelSU
- APatch erlaubt Ihnen, optional, nicht SELinux zu modifizieren, was bedeutet, dass ein App-Kontext gerootet werden kann, sodass libsu und IPC nicht benötigt werden.
- **Kernel Korrektur Modul** gegeben.


## Was ist ein Kernel Korrigtur Modul?
Etwas Code läuft im Kernelbereich, ähnlich zu Ladbaren Kernel-Modulen (LKM).

Dazu stellt KPM die Fähigkeit bereit, "inline-hook", "syscall-table-hook" im Kernelbereich zu machen.

Für mehr Informationen, siehe [Wie schreibt man ein KPM](https://github.com/bmax121/KernelPatch/blob/main/doc/module.md)


## Beziehung zwischen APatch und KernelPatch

APatch benötigt KernelPatch, übernimmt all seine Fähigkeiten und wurde erweitert.

Sie können nur KernelPatch installieren, aber dies wird Ihnen nicht erlauben, Magisk-Module zu nutzen.

[Lerne mehr über KernelPatch](https://github.com/bmax121/KernelPatch)


## Was ist SuperKey?
KernelPatch fügt einen neuen System-Abruf (syscall) hinzu, um alle Möglichkeiten, Apps und anderen Programmen im Benutzerbereich, bereitzustellen, dieser System-Abruf ist bekannt als **SuperCall**.
Wenn eine App / ein Programm versucht, **SuperCall** abzurufen, muss es ein Berechtigungsnachweis vorlegen, bekannt als **SuperKey**.
**SuperCall** kann nur erfolgreich abgerufen werden, wenn der **SuperKey** korrekt ist und wenn nicht, dann bleibt der Rufer unbetroffen.


## Was ist mit SELinux?
- KernelPatch bearbeitet den SELinux-Kontext nicht und umgeht den SELinux über einen Haken.
  Dies erlaubt Ihnen, einen Android-Kontext in dem App-Kontext, ohne dem Gebrauch, libsu zu nutzen, um einen neuen Prozess zu starten und darauf IPC auszuführen, zu rooten.
  Dies ist bequem.
- Dazu verwendet APatch direkt das Magiskkonzept, um weitere SELinux-Unterstützung bereitzustellen.

```

`docs/en/faq.md`:

```md
# FAQ


## What is APatch?
APatch is a root solution similar to Magisk or KernelSU that unites the best of both.
It combines Magisk's convenient and easy install method through `boot.img` with KernelSU's powerful kernel patching abilities.


## What's the difference between APatch and Magisk?
- Magisk modifies the init system with a patch in your boot image's ramdisk, while APatch patches the kernel directly.


## APatch vs KernelSU
- KernelSU requires the source code for your device's kernel which is not always provided by the OEM. APatch works with just your stock `boot.img`.


## APatch vs Magisk, KernelSU
- APatch allows you to optionally not modify SELinux, this means that the APP thread can be rooted, libsu and IPC are not necessary.
- **Kernel Patch Module** provided.


## What is Kernel Patch Module?
Some code runs in Kernel Space, similar to Loadable Kernel Modules (LKM).

Additionally, KPM provides the ability to do inline-hook, syscall-table-hook in kernel space.

For more information, see [How to write a KPM](https://github.com/bmax121/KernelPatch/blob/main/doc/module.md)


## Relationship between APatch and KernelPatch

APatch depends on KernelPatch, inherits all its capabilities, and has been expanded.

You can install KernelPatch only, but this will not allow you to use Magisk modules

[Learn more about KernelPatch](https://github.com/bmax121/KernelPatch)


## What is SuperKey?
KernelPatch adds a new system call (syscall) to provide all capabilities to apps and programs in userspace, this syscall is referred to as **SuperCall**.
When an app/program tries to invoke **SuperCall**, it needs to provide an access credential, known as the **SuperKey**.
**SuperCall** can only be successfully invoked if the **SuperKey** is correct and if it's not the caller will remain unaffected.


## How about SELinux?
- KernelPatch doesn't modify the SELinux context and bypasses SELinux via a hook.
  This allows you to root an Android thread within the app context without the need to use libsu to start a new process and then perform IPC.
  This is very convenient.
- In addition, APatch directly utilizes magiskpolicy to provide additional SELinux support.

```

`docs/es/faq_es.md`:

```md
# Preguntas frecuentes

## ¿Qué es APatch?
APatch es una solución de root similar a Magisk o KernelSU que une lo mejor de ambos.
Combina el método de instalación conveniente y fácil de Magisk a través de un patche en `boot.img` y las potentes capacidades de KernelSU para parchear el kernel.


## Diferencias entre APatch y Magisk
- Magisk modifica el sistema de init (el sistema que inicializa todos los subsistemas del dispositivo) con un parche en la ramdisk de tu imagen `boot.img`, mientras que APatch parchea el kernel directamente.


## Diferencias entre APatch y KernelSU
- KernelSU requiere el código fuente del kernel del dispositivo, que no siempre es brindado por el fabricante del mismo. APatch solo requiere la imagen `boot.img`


## Diferencias entre APatch y ambas soluciones de root
- APatch permite opcionalmente no modificar el contexto de SELinux. También da acceso root a las apps en su propio contexto, lo cual significa que no hay necesidad de usar libsu ni IPC.
- Se añaden los **KPM** (Kernel Patch Modules), explicados abajo


## ¿Qué es un Kernel Patch Module (KPM, Módulo de Parche del Kernel)?
Permite implementar código personalizado que corra en kernelspace, es decir, en el mismo entorno que el kernel. Funciona similar a los módulos de kernel (los LKM, Loadable Kernel Modules) que se cargan con insmod/rmmod/modprobe/etc.

Además, KPM permite hacer inline-hooks ("engancharse" a una función en el mismo lugar de memoria, he de ahí el "inline") y syscall-table-hook (modificar la tabla de syscalls)

Para más información, lee [Como escribir un KPM](https://github.com/bmax121/KernelPatch/blob/main/doc/module.md) (en Inglés)


## Relación entre APatch y KernelPatch
APatch depende de KernelPatch, hereda todas sus capacidades y las expande.

Puedes instalar solo KernelPatch, pero esto no va a permitir que uses módulos de Magisk, y para poder administrar el acceso root vas a tener que instalar AndroidPatch y desinstalarlo.

[Aprende más de KernelPatch](https://github.com/bmax121/KernelPatch) (en Inglés)


## ¿Qué es SuperKey?
KernelPatch agrega una nueva syscall (llamada al sistema) para dar todas las capacidades a apps y programas en userspace (el espacio del usuario fuera del kernel), y esta syscall se llama **SuperCall**.
Cuando una app o programa intenta llamar **SuperCall**, necesita proveer una credencial de acceso llamada **SuperKey**.
**SuperCall** solo se puede llamar si se provee una **SuperKey** correcta, caso contrario la app/programa que lo llame quedará intacta.


## ¿Y qué pasa con SELinux?
- KernelPatch no modifica el contexto de SELinux y simplemente se lo salta a través de un hook, lo cual permite que des acceso root a un hilo de Android dentro del contexto de la aplicación sin necesidad de usar libsu para iniciar un nuevo proceso y luego comunicarte con él a través de IPC (Inter-Process Communication)
- Además, APatch usa magiskpolicy directamente para obtener mayor soporte de SELinux. Solo esto va a ser detectado como Magisk, y cualquiera que lo desee puede intentar evitar esto ya que el problema ya está bastante claro.

```

`docs/fr/faq_fr.md`:

```md
## Foire aux questions (FAQ)

## Qu'est-ce qu'APatch ?

APatch est une méthode de root, similaire à Magisk ou KernelSU, offrant encore plus de fonctionnalités.

## Quelle est la différence entre APatch et Magisk ?

- Magisk modifie init, tandis qu'APatch patche le noyau Linux.

## Quelle est la différence entre APatch et KernelSU ?

- KernelSU nécessite le code source. APatch n'a besoin que du fichier boot.img.

## Quelle est la différence entre APatch, Magisk et KernelSU ?

- Optionnellement, ne modifie pas SELinux. Root dans le contexte d'application Android, libsu et d'IPC non nécessaires
- Fournit **Kernel Patch Module**

## Qu'est-ce que Kernel Patch Module ?

Certains codes s'exécutent dans l'espace du noyau, à l'instar des modules noyau chargeables (LKM, Loadable Kernel Modules).

De plus, KPM offre la possibilité d'effectuer des inline-hook, syscall-table-hook dans l'espace noyau.

[Comment écrire un module KPM](https://github.com/bmax121/KernelPatch/blob/main/doc/fr/module.md)

## Relation entre APatch et KernelPatch

APatch dépend de KernelPatch, héritant de toutes ses fonctionnalités, et l'étendant.

Vous pouvez installer KernelPatch seul, mais cela ne vous permettra pas d'utiliser de module Magisk.
Pour utiliser la gestion super utilisateur, vous devez installer AndroidPatch puis le désinstaller.

[En savoir plus sur KernelPatch](https://github.com/bmax121/KernelPatch)

## Qu'est-ce que la clé (SuperKey) ?

KernelPatch fournit toutes les fonctionnalités à l'espace utilisateur en effectuant un appel système appelé **SuperCall**.  
L'appel du SuperCall nécessite le passage d'un type d'informations d'identification appelé **SuperKey**.  
Un SuperCall ne peut être effectué avec succès que si la clé est correcte. Si la clé est incorrecte, l'appelant ne sera pas affecté.

## Qu'en est-il de SELinux ?

- KernelPatch ne modifie pas le contexte SELinux et contourne SELinux via des hooks.  
  Cela vous permet de rooter un processus Android dans le contexte de applicatif, sans avoir à démarrer un nouveau processus avec libsu et ensuite exécuter l'IPC.
- De plus, APatch fournit un support SELinux supplémentaire directement via magiskpolicy.  
  Cependant, seul ce dernier sera détecté en tant que Magisk. Toute personne intéressée peut essayer de le contourner, le problème est déjà très clair.

```

`docs/id/faq.md`:

```md
# FAQ

## Apa itu APatch?
APatch adalah solusi root yang mirip dengan Magisk atau KernelSU yang menyatukan yang terbaik dari keduanya.
Ia menggabungkan metode instalasi Magisk yang mudah dan praktis melalui `boot.img` dengan kemampuan patching kernel KernelSU yang hebat.

## Apa perbedaan antara APatch dan Magisk?

- Magisk memodifikasi sistem init dengan patch di ramdisk boot image Anda, sementara APatch menambal kernel secara langsung.

## APatch vs KernelSU
- KernelSU memerlukan kode sumber untuk kernel perangkat Anda yang tidak selalu disediakan oleh OEM. APatch hanya berfungsi dengan `boot.img` bawaan Anda.

## APatch vs Magisk, KernelSU
- APatch memungkinkan Anda untuk secara opsional tidak memodifikasi SELinux, ini berarti bahwa utas APP dapat di-root, libsu dan IPC tidak diperlukan.

- **Modul Patch Kernel** disediakan.

## Apa itu Modul Patch Kernel? Beberapa kode berjalan di Kernel Space, mirip dengan Loadable Kernel Modules (LKM).

Selain itu, KPM menyediakan kemampuan untuk melakukan inline-hook, syscall-table-hook di kernel space.

Untuk informasi selengkapnya, lihat [Cara menulis KPM](https://github.com/bmax121/KernelPatch/blob/main/doc/module.md)

## Hubungan antara APatch dan KernelPatch

APatch bergantung pada KernelPatch, mewarisi semua kemampuannya, dan telah diperluas.

Anda hanya dapat menginstal KernelPatch, tetapi ini tidak akan memungkinkan Anda untuk menggunakan modul Magisk

[Pelajari selengkapnya tentang KernelPatch](https://github.com/bmax121/KernelPatch)

## Apa itu SuperKey?
KernelPatch menambahkan panggilan sistem baru (syscall) untuk menyediakan semua kemampuan bagi aplikasi dan program di userspace, syscall ini disebut sebagai **SuperCall**. Saat aplikasi/program mencoba memanggil **SuperCall**, aplikasi/program tersebut perlu menyediakan kredensial akses, yang dikenal sebagai **SuperKey**.
**SuperCall** hanya dapat dipanggil dengan sukses jika **SuperKey** benar dan jika tidak, pemanggil tidak akan terpengaruh.

## Bagaimana dengan SELinux?
- KernelPatch tidak mengubah konteks SELinux dan melewati SELinux melalui hook.

Ini memungkinkan Anda untuk melakukan root pada thread Android dalam konteks aplikasi tanpa perlu menggunakan libsu untuk memulai proses baru dan kemudian melakukan IPC.

Ini sangat praktis.

- Selain itu, APatch secara langsung menggunakan magiskpolicy untuk menyediakan dukungan SELinux tambahan.
```

`docs/it/faq_it.md`:

```md
# Domande frequenti

## Cos'è APatch

APatch è una soluzione per il root simile a Magisk o KernelSU, ma offre funzionalità aggiuntive.

## APatch vs Magisk

- Magisk modifica l'init, mentre APatch patcha il kernel Linux.

## APatch vs KernelSU

- KernelSU richiede il codice sorgente del kernel, mentre per APatch è sufficiente solo il file boot.img.

## APatch vs Magisk, KerenlSU

- Opzionalmente, non modifica SELinux.
- Consente di ottenere i permessi di root nel contesto dell'app Android, senza la necessità di libsu e IPC.
- Possibilità di utilizzare **Kernel Patch Module**

## Cos'è un Kernel Patch Module

È del codice eseguito nello spazio del Kernel, simile ai Loadable Kernel Modules (LKM).

Inoltre, KPM fornisce la possibilità di effettuare inline-hook e syscall-table-hook nello spazio del kernel.

[Come scrivere un KPM](https://github.com/bmax121/KernelPatch/blob/main/doc/module.md)

## Relazione tra APatch e KernelPatch

APatch dipende da KernelPatch, eredita tutte le sue capacità ed è stato ampliato.

Puoi installare solo KernelPatch, ma ciò non consentirà l'uso dei moduli Magisk.
Per gestire i permessi di root, è necessario installare AndroidPatch e successivamente disinstallarlo.

[Scopri di più su KernelPatch](https://github.com/bmax121/KernelPatch)

## Cos'è la SuperKey

KernelPatch aggancia le chiamate di sistema per fornire tutte le capacità allo spazio utente, e questa chiamata di sistema è chiamata **SuperCall**.
Invocare SuperCall richiede il passaggio di una credenziale, nota come **SuperKey**.
SuperCall può essere invocato con successo solo quando la SuperKey è corretta; se la SuperKey è errata, chi effettua la chiamata rimane inalterato.

## Riguardo a SELinux

- KernelPatch non modifica il contesto SELinux e bypassa SELinux tramite hook,  
  consentendo di ottenere i privilegi di root in un thread Android all'interno del contesto dell'app senza la necessità di utilizzare libsu per avviare un nuovo processo e quindi eseguire IPC.
  Questo è molto conveniente.
- Inoltre, APatch utilizza direttamente magiskpolicy per fornire ulteriore supporto SELinux.  
  Tuttavia, solo questo sarà rilevato come Magisk. Chiunque sia interessato può cercare di bypassarlo; il problema è già abbastanza chiaro.
```

`docs/kr/faq_kr.md`:

```md
# FAQ


## APatch가 뭔가요?
APatch는 Magisk와 KernelSU와 유사한 루팅툴로, 두 가지의 장점을 결합하였습니다.
`boot.img`을 통해 설치하는 Magisk의 편리하고 간편한 방법과 강력한 커널 패치 기능을 제공하는 KernelSU를 결합하였습니다.


## APatch와 Magisk의 차이점은 무엇인가요?
- Magisk는 부트 이미지의 램디스크에 패치를 적용하여 초기 시스템을 수정하는 반면, APatch는 커널을 직접 패치합니다.


## APatch vs KernelSU
- KernelSU는 기기의 커널 소스 코드가 필요하지만 OEM에서 항상 제공하지는 않습니다. 반면, APatch는 단지 여러분의 기본 `boot.img`만으로 작동합니다.


## APatch vs Magisk, KernelSU
- APatch는 선택적으로 SELinux를 수정하지 않을 수 있어, APP 스레드를 루팅할 수 있으며, libsu와 IPC가 필요하지 않습니다.
- **커널 패치 모듈**을 제공합니다..


## 커널 패치 모듈이 뭔가요?
커널 패치 모듈은 Loadable Kernel Modules (LKM)과 유사하게 커널 공간에서 실행되는 코드입니다.

또한, KPM은 커널에서 인라인 훅과 시스템 콜 테이블 훅을 수행할 수 있습니다.

자세한 정보는 [KPM 작성 방법](https://github.com/bmax121/KernelPatch/blob/main/doc/module.md)에서 확인하세요.


## APatch와 KernelPatch의 관계

APatch는 KernelPatch에 의존하며, 모든 기능을 상속받고 확장되었습니다.

KernelPatch만 설치할 수도 있지만, 이 경우 Magisk 모듈을 사용할 수 없습니다.

[KernelPatch에 대해 더 알아보기](https://github.com/bmax121/KernelPatch)


## SuperKey가 뭔가요?
KernelPatch는 사용자 공간의 앱 및 프로그램에 모든 기능을 제공하는 새로운 시스템 콜 (syscall)을 추가하며, 이것을 **SuperCall**이라고 합니다.
앱이나 프로그램이 **SuperCall**를 호출하려고 할 때, 접근 자격증명인 **SuperKey**를 제공해야 합니다.
**SuperCall**은 **SuperKey**가 정확하고 호출자에게 영향을 미치지 않을 경우에만 성공적으로 수행됩니다.


## SELinux는 어떻게 다루나요?
- KernelPatch는 SELinux 컨텍스트를 수정하지 않고 SELinux를 우회하는 훅을 사용합니다.
  이를 통해 앱 컨텍스트 내에서 안드로이드 스레드를 루팅할 수 있으며, 새 프로세스를 시작하고 IPC를 수행하기 위해 libsu를 사용할 필요가 없습니다.
  이 방법은 매우 편리합니다.
- 또한, APatch는 추가적인 SELinux 지원을 제공하기 위해 직접 magiskpolicy를 활용합니다.

```

`docs/pt_br/faq_pt_br.md`:

```md
# Perguntas frequentes

## O que é APatch?

APatch é uma solução root semelhante ao Magisk ou KernelSU que une o melhor de ambos. Ele combina o método de instalação fácil e conveniente do Magisk por meio do `boot.img` com as poderosas habilidades de patch de kernel do KernelSU.

## Qual é a diferença entre APatch e Magisk?

- Magisk modifica o sistema init com um patch no ramdisk da sua imagem de inicialização, enquanto o APatch corrige o kernel diretamente.

## APatch vs KernelSU

- KernelSU requer o código-fonte do kernel de seu dispositivo, que nem sempre é fornecido pelo OEM. APatch funciona apenas com seu `boot.img` stock.

## APatch vs Magisk e KernelSU

- APatch permite opcionalmente não modificar o SELinux, isso significa que o thread do app pode ser rooteado, libsu e IPC não são necessários.
- **Módulo KernelPatch** fornecido.

## O que é Módulo KernelPatch?

Alguns códigos são executados no Kernel Space, semelhante ao Loadable Kernel Modules (LKM).

Além disso, o KPM fornece a capacidade de executar inline-hook e syscall-table-hook no Kernel Space.

Para mais informações, veja [como escrever um KPM](https://github.com/bmax121/KernelPatch/blob/main/doc/module.md).

## Relacionamento entre APatch e KernelPatch

APatch depende do KernelPatch. Ele herda todas as suas capacidades e foi expandido.

Você pode instalar apenas o KernelPatch, mas isso não permitirá o uso de módulos Magisk.

[Saiba mais sobre o KernelPatch](https://github.com/bmax121/KernelPatch).

## O que é SuperKey?

KernelPatch conecta chamadas do sistema para fornecer todos os recursos ao espaço do usuário, e essa chamada do sistema é chamada de **SuperCall**. Invocar o SuperCall requer a passagem de uma credencial, conhecida como **SuperKey**. SuperCall só pode ser invocado com sucesso quando a SuperKey estiver correta. Se a SuperKey estiver incorreta, o chamador não será afetado.

## E o SELinux?

- KernelPatch não modifica o contexto do SELinux e ignora o SELinux via hook. Isso permite que você faça root em um thread do Android dentro do contexto do app sem a necessidade de usar libsu para iniciar um novo processo e então executar o IPC.
- Além disso, o APatch utiliza diretamente o magiskpolicy para fornecer suporte adicional ao SELinux.

```

`docs/ru/faq_ru.md`:

```md
# Часто задаваемые вопросы


## Что такое APatch?
APatch - это root решение, похожее на Magisk или KernelSU, которое объединяет лучшее из обоих.
Оно сочетает удобный и простой метод установки Magisk через `boot.img` с мощными возможностями исправления ядра KernelSU.

## В чем разница между APatch и Magisk?
- Magisk изменяет систему инициализации с помощью патча на RAM-диске вашего загрузочного образа, в то время как APatch вносит изменения непосредственно в ядро.


## APatch против KernelSU
- Для KernelSU требуется исходный код ядра вашего устройства, который не всегда предоставляется OEM-производителем. APatch работает напрямую с вашим исходным `boot.img`.


## APatch против Magisk, KernelSU
- APatch позволяет вам при желании не изменять SELinux. Это означает, что поток приложения может быть рутирован, в libsu и IPC нет необходимости.
- **Kernel Patch Module** предоставляется.


## Что такое Kernel Patch Module?
Некоторый код выполняется в пространстве ядра, аналогично загружаемым модулям ядра (Loadable Kernel Modules, LKM).

Кроме того, KPM предоставляет возможность выполнять inline-hook, syscall-table-hook в пространстве ядра.

Для получения дополнительной информации смотрите [Как написать KPM](https://github.com/bmax121/KernelPatch/blob/main/doc/module.md)


## Связь между APatch и KernelPatch

APatch основан на KernelPatch, унаследовал все его возможности и был расширен.

Вы можете установить только KernelPatch, но это не позволит вам использовать модули Magisk, а чтобы использовать управление суперпользователем, вам необходимо установить AndroidPatch, а затем удалить его.

[Узнать больше о KernelPatch](https://github.com/bmax121/KernelPatch)


## Что такое SuperKey?
KernelPatch добавляет новый системный вызов (syscall) для предоставления всех возможностей приложениям и программам в пользовательском пространстве. Этот системный вызов называется **SuperCall**.
Когда приложение/программа пытается вызвать **SuperCall**, ему необходимо предоставить учетные данные для доступа, называемые **SuperKey**.
**SuperCall** может быть успешно вызван только в том случае, если **SuperKey** правильный, а в противном случае вызывающий объект останется незатронутым.


## Что насчет SELinux?
- KernelPatch не изменяет контекст SELinux и обходит SELinux с помощью перехвата.
  Это позволяет вам рутировать поток Android в контексте приложения без необходимости использовать libsu для запуска нового процесса и последующего выполнения IPC.
  Это очень удобно.
- Кроме того, APatch напрямую использует magiskpolicy для обеспечения дополнительной поддержки SELinux.

```

`docs/tr/faq_tr.md`:

```md
# SSS

## APatch nedir?

APatch, Magisk veya KernelSU benzeri ve her ikisinin de en iyi yönlerini birleştiren bir root çözümdür. Magisk'in `boot.img` aracılığıyla kullanışlı ve kolay kurulum yöntemini ve KernelSU'nun güçlü kernel yamalama yeteneklerini birleştirir.

## APatch ve Magisk arasındaki fark nedir?

- Magisk başlangıç sistemini kernel'in ramdisk'indeki bir yama ile değiştirirken; APatch kernel'i doğrudan yamalar.

## APatch vs KernelSU

- KernelSU, cihazınızın kernel'i için her zaman OEM tarafından sağlanmayan kaynak kodunu gerektirir. APatch yalnızca stok `boot.img` dosyanızla çalışır.

## APatch vs Magisk, KernelSU

- İsteğe bağlı olarak SELinux'u değiştirmez. Bu şu anlama gelir; android uygulama parçacığının root'lanması için libsu ve IPC'ye gerek yoktur.
- **Kernel Patch (Yama) Modülü** sağlanır.

## Kernel Patch (Yama) Modülü nedir?

Bazı kodlar, Yüklenebilir Kernel Modüllerinde (LKM) olduğu gibi Kernel Seviyesinde çalışır.

Ek olarak KPM, kernel sviyesinde satır içi kanca, sistem çağrısı-tablo kancası yapma yeteneği sağlar.

Daha fazla bilgi için bkz [KPM nasıl yazılır?](https://github.com/bmax121/KernelPatch/blob/main/doc/module.md)

## APatch and KernelPatch arasındaki ilişki

APatch, KernelPatch'e dayalıdır; onun tüm yeteneklerini devralır ve onu daha da geliştirmiştir.

Yalnızca KernelPatch'i kurabilirsiniz ancak bu magisk modüllerini kullanmanıza izin vermez,
Superuser yönetimini kullanmak için de AndroidPatch'i yüklemeniz ve ardından kaldırmanız gerekir.

[KernelPatch hakkında daha fazlasını öğrenin](https://github.com/bmax121/KernelPatch)

## Süper Anahtar nedir?

KernelPatch, tüm yetenekleri kullanıcı alanına (userspace) sağlamak için sistem çağrılarını (syscall) kancalar ve bu sistem çağrısına **SuperCall** denir.  
Bir uygulama/program SuperCall'ı çağırmayı denediğinde, **Süper Anahtar** olarak bilinen bir kimlik bilgisinin iletilmesini gerektirir.
SuperCall yalnızca Süper Anahtar doğru olduğunda başarılı bir şekilde çağrılabilir; Süper Anahtar hatalıysa çağıran bundan etkilenmez.

## Peki ya SELinux?

- KernelPatch, SELinux içeriğini değiştirmez ve SELinux'u kanca yoluyla atlamaz. Bu, yeni bir işlem başlatmak ve ardından IPC gerçekleştirmek için libsu kullanmanıza gerek kalmadan, uygulama bağlamında bir Android iş parçacığını rootlamanıza olanak tanır. Bu çok kullanışlıdır.
- Ayrıca APatch, ek SELinux desteği sağlamak için doğrudan magiskpolicy'yi kullanır.

```

`docs/uk/faq_uk.md`:

```md
# Поширені запитання


## Що таке APatch?
APatch - це root рішення, схоже на Magisk або KernelSU, яке поєднує найкраще з обох.
Воно поєднує зручний і простий метод установки Magisk через boot.img з потужними можливостями виправлення ядра KernelSU.

## У чому різниця між APatch та Magisk?
- Magisk змінює систему ініціалізації за допомогою патча на RAM диску вашого завантажувального образу, в той час як APatch вносить зміни безпосередньо в ядро.


## APatch проти KernelSU
- Для KernelSU потрібен вихідний код ядра вашого пристрою, який не завжди надається OEM-виробником. APatch працює безпосередньо з вашим вихідним `boot.img`.


## APatch проти Magisk, KernelSU
- APatch дозволяє вам за бажання не змінювати SELinux. Це означає, що потік програми може бути рутований, в libsu і IPC немає необхідності.
- **Kernel Patch Module** надається.


## Що таке Kernel Patch Module?
Деякий код виконується у просторі ядра, аналогічно модулям ядра (Loadable Kernel Modules, LKM).

Крім того, KPM надає можливість виконувати inline-hook, syscall-table-hook у просторі ядра.

Для отримання додаткової інформації дивіться [Як написати KPM](https://github.com/bmax121/KernelPatch/blob/main/doc/module.md)


## Зв'язок між APatch та KernelPatch

APatch заснований на KernelPatch, успадкував усі його можливості та був розширений.

Ви можете встановити тільки KernelPatch, але це не дозволить вам використовувати модулі Magisk, а щоб використовувати керування суперкористувачем, вам необхідно встановити AndroidPatch, а потім видалити його.

[Дізнатись більше про KernelPatch](https://github.com/bmax121/KernelPatch)


## Що таке SuperKey?
KernelPatch додає новий системний дзвінок (syscall) для надання всіх можливостей додаткам і програмам в просторі користувача. Цей системний виклик називається **SuperCall**.
Коли програма намагається викликати **SuperCall**, їй необхідно надати облікові дані для доступу, які називають **SuperKey**.
**SuperCall** може бути успішно викликаний тільки в тому випадку, якщо **SuperKey** правильний, а в іншому випадку об'єкт, що викликає, не змінюється.


## Як щодо SELinux?
- KernelPatch не змінює контекст SELinux та обходить SELinux за допомогою перехоплення.
  Це дозволяє вам рутувати потік Android у контексті програми без необхідності використовувати libsu для запуску нового процесу та подальшого виконання IPC.
  Це дуже зручно.
- Крім того, APatch безпосередньо використовує magiskpolicy для забезпечення додаткової підтримки SELinux.

```

`fastlane/metadata/android/en-US/full_description.txt`:

```txt
The patching of Android kernel and Android system.
<ul>
<li>A new kernel-based root solution for Android devices.</li>
<li>APM: Support for modules similar to Magisk.</li>
<li>KPM: Support for modules that allow you to inject any code into the kernel (Requires kernel function <code>inline-hook</code> and <code>syscall-table-hook</code> enabled).</li>
<li>APatch relies on KernelPatch.</li>
<li>The APatch UI and the APModule source code have been derived and modified from KernelSU.</li>
</ul>
<ul>
<li>Only supports the ARM64 architecture.</li>
<li>Only supports Android kernel versions 3.18 - 6.1</li>
</ul>
Support for Samsung devices with security protection: Planned
Kernel configs:
<ul>
<li>
<code>CONFIG_KALLSYMS=y</code> and <code>CONFIG_KALLSYMS_ALL=y</code>
</li>
<li>
<code>CONFIG_KALLSYMS=y</code> and <code>CONFIG_KALLSYMS_ALL=n</code>: Initial support
</li>
</ul>
The <strong>SuperKey</strong> has higher privileges than root access.
Weak or compromised keys can lead to unauthorized control of your device.
It is critical to use robust keys and safeguard them from exposure to maintain the security of your device.

```

`fastlane/metadata/android/en-US/short_description.txt`:

```txt
The patching of Android kernel and Android system

```

`gradle.properties`:

```properties
# Project-wide Gradle settings.
# IDE (e.g. Android Studio) users:
# Gradle settings configured through the IDE *will override*
# any settings specified in this file.
# For more details on how to configure your build environment visit
# http://www.gradle.org/docs/current/userguide/build_environment.html
# Specifies the JVM arguments used for the daemon process.
# The setting is particularly useful for tweaking memory settings.
org.gradle.jvmargs=-Xmx2048m -Dfile.encoding=UTF-8
# When configured, Gradle will run in incubating parallel mode.
# This option should only be used with decoupled projects. For more details, visit
# https://developer.android.com/r/tools/gradle-multi-project-decoupled-projects
# org.gradle.parallel=true
# AndroidX package structure to make it clearer which packages are bundled with the
# Android operating system, and which are packaged with your app's APK
# https://developer.android.com/topic/libraries/support-library/androidx-rn
android.useAndroidX=true
# Kotlin code style for this project: "official" or "obsolete":
kotlin.code.style=official
# Enables namespacing of each library's R class so that its R class includes only the
# resources declared in the library itself and none from the library's dependencies,
# thereby reducing the size of the R class for that library
android.nonTransitiveRClass=true
android.experimental.enableNewResourceShrinker.preciseShrinking=true
android.enableAppCompileTimeRClass=true
ksp.useKSP2=true

```

`gradle/libs.versions.toml`:

```toml
[versions]
agp = "9.0.0"
kotlin = "2.3.10"
ksp = "2.3.5"
compose-bom = "2026.01.01"
lifecycle = "2.10.0"
compose-destination = "2.3.0"
libsu = "6.0.0"
compose-material3 = "1.5.0-alpha13"
sheets-compose-dialogs = "1.3.0"

[plugins]
agp-app = { id = "com.android.application", version.ref = "agp" }
ksp = { id = "com.google.devtools.ksp", version.ref = "ksp" }
lsplugin-apksign = { id = "org.lsposed.lsplugin.apksign", version = "1.4" }
lsplugin-resopt = { id = "org.lsposed.lsplugin.resopt", version = "1.6" }
kotlin = { id = "org.jetbrains.kotlin.android", version.ref = "kotlin" }
kotlin-compose-compiler = { id = "org.jetbrains.kotlin.plugin.compose", version.ref = "kotlin" }

[libraries]
androidx-appcompat = { group = "androidx.appcompat", name = "appcompat", version = "1.7.1" }
androidx-activity-compose = { group = "androidx.activity", name = "activity-compose", version = "1.12.3" }
androidx-core-splashscreen = { group = "androidx.core", name = "core-splashscreen", version = "1.2.0" }
androidx-webkit = { group = "androidx.webkit", name = "webkit", version = "1.15.0" }

androidx-compose-bom = { group = "androidx.compose", name = "compose-bom", version.ref = "compose-bom" }
androidx-compose-material-icons-extended = { group = "androidx.compose.material", name = "material-icons-extended" }
androidx-compose-material3 = { group = "androidx.compose.material3", name = "material3", version.ref = "compose-material3" }
androidx-compose-ui = { group = "androidx.compose.ui", name = "ui" }
androidx-compose-ui-test-manifest = { group = "androidx.compose.ui", name = "ui-test-manifest" }
androidx-compose-ui-tooling = { group = "androidx.compose.ui", name = "ui-tooling" }
androidx-compose-ui-tooling-preview = { group = "androidx.compose.ui", name = "ui-tooling-preview" }
androidx-compose-runtime-livedata = { group = "androidx.compose.runtime", name = "runtime-livedata" }

androidx-lifecycle-runtime-ktx = { group = "androidx.lifecycle", name = "lifecycle-runtime-ktx", version.ref = "lifecycle" }
androidx-lifecycle-runtime-compose = { group = "androidx.lifecycle", name = "lifecycle-runtime-compose", version.ref = "lifecycle" }
androidx-lifecycle-viewmodel-compose = { group = "androidx.lifecycle", name = "lifecycle-viewmodel-compose", version.ref = "lifecycle" }

com-github-topjohnwu-libsu-core = { group = "com.github.topjohnwu.libsu", name = "core", version.ref = "libsu" }
com-github-topjohnwu-libsu-service = { group = "com.github.topjohnwu.libsu", name = "service", version.ref = "libsu" }
com-github-topjohnwu-libsu-nio = { group = "com.github.topjohnwu.libsu", name = "nio", version.ref = "libsu" }
com-github-topjohnwu-libsu-io = { group = "com.github.topjohnwu.libsu", name = "io", version.ref = "libsu" }

dev-rikka-rikkax-parcelablelist = { module = "dev.rikka.rikkax.parcelablelist:parcelablelist", version = "2.0.1" }

io-coil-kt-coil-compose = { group = "io.coil-kt", name = "coil-compose", version = "2.7.0" }

kotlinx-coroutines-core = { module = "org.jetbrains.kotlinx:kotlinx-coroutines-core", version = "1.10.2" }

me-zhanghai-android-appiconloader-coil = { group = "me.zhanghai.android.appiconloader", name = "appiconloader-coil", version = "1.5.0" }

compose-destinations-core = { group = "io.github.raamcosta.compose-destinations", name = "core", version.ref = "compose-destination" }
compose-destinations-ksp = { group = "io.github.raamcosta.compose-destinations", name = "ksp", version.ref = "compose-destination" }

sheet-compose-dialogs-core = { group = "com.maxkeppeler.sheets-compose-dialogs", name = "core", version.ref = "sheets-compose-dialogs" }
sheet-compose-dialogs-list = { group = "com.maxkeppeler.sheets-compose-dialogs", name = "list", version.ref = "sheets-compose-dialogs" }
sheet-compose-dialogs-input = { group = "com.maxkeppeler.sheets-compose-dialogs", name = "input", version.ref = "sheets-compose-dialogs" }

markdown = { group = "io.noties.markwon", name = "core", version = "4.6.2" }

ini4j = { group = "org.ini4j", name = "ini4j", version = "0.5.4" }

cxx = { module = "org.lsposed.libcxx:libcxx", version = "29.0.14206865" }

```

`gradle/wrapper/gradle-wrapper.properties`:

```properties
distributionBase=GRADLE_USER_HOME
distributionPath=wrapper/dists
distributionUrl=https\://services.gradle.org/distributions/gradle-9.3.1-bin.zip
networkTimeout=10000
validateDistributionUrl=true
zipStoreBase=GRADLE_USER_HOME
zipStorePath=wrapper/dists

```

`gradlew`:

```
#!/bin/sh

#
# Copyright © 2015 the original authors.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# SPDX-License-Identifier: Apache-2.0
#

##############################################################################
#
#   Gradle start up script for POSIX generated by Gradle.
#
#   Important for running:
#
#   (1) You need a POSIX-compliant shell to run this script. If your /bin/sh is
#       noncompliant, but you have some other compliant shell such as ksh or
#       bash, then to run this script, type that shell name before the whole
#       command line, like:
#
#           ksh Gradle
#
#       Busybox and similar reduced shells will NOT work, because this script
#       requires all of these POSIX shell features:
#         * functions;
#         * expansions «$var», «${var}», «${var:-default}», «${var+SET}»,
#           «${var#prefix}», «${var%suffix}», and «$( cmd )»;
#         * compound commands having a testable exit status, especially «case»;
#         * various built-in commands including «command», «set», and «ulimit».
#
#   Important for patching:
#
#   (2) This script targets any POSIX shell, so it avoids extensions provided
#       by Bash, Ksh, etc; in particular arrays are avoided.
#
#       The "traditional" practice of packing multiple parameters into a
#       space-separated string is a well documented source of bugs and security
#       problems, so this is (mostly) avoided, by progressively accumulating
#       options in "$@", and eventually passing that to Java.
#
#       Where the inherited environment variables (DEFAULT_JVM_OPTS, JAVA_OPTS,
#       and GRADLE_OPTS) rely on word-splitting, this is performed explicitly;
#       see the in-line comments for details.
#
#       There are tweaks for specific operating systems such as AIX, CygWin,
#       Darwin, MinGW, and NonStop.
#
#   (3) This script is generated from the Groovy template
#       https://github.com/gradle/gradle/blob/HEAD/platforms/jvm/plugins-application/src/main/resources/org/gradle/api/internal/plugins/unixStartScript.txt
#       within the Gradle project.
#
#       You can find Gradle at https://github.com/gradle/gradle/.
#
##############################################################################

# Attempt to set APP_HOME

# Resolve links: $0 may be a link
app_path=$0

# Need this for daisy-chained symlinks.
while
    APP_HOME=${app_path%"${app_path##*/}"}  # leaves a trailing /; empty if no leading path
    [ -h "$app_path" ]
do
    ls=$( ls -ld "$app_path" )
    link=${ls#*' -> '}
    case $link in             #(
      /*)   app_path=$link ;; #(
      *)    app_path=$APP_HOME$link ;;
    esac
done

# This is normally unused
# shellcheck disable=SC2034
APP_BASE_NAME=${0##*/}
# Discard cd standard output in case $CDPATH is set (https://github.com/gradle/gradle/issues/25036)
APP_HOME=$( cd -P "${APP_HOME:-./}" > /dev/null && printf '%s\n' "$PWD" ) || exit

# Use the maximum available, or set MAX_FD != -1 to use that value.
MAX_FD=maximum

warn () {
    echo "$*"
} >&2

die () {
    echo
    echo "$*"
    echo
    exit 1
} >&2

# OS specific support (must be 'true' or 'false').
cygwin=false
msys=false
darwin=false
nonstop=false
case "$( uname )" in                #(
  CYGWIN* )         cygwin=true  ;; #(
  Darwin* )         darwin=true  ;; #(
  MSYS* | MINGW* )  msys=true    ;; #(
  NONSTOP* )        nonstop=true ;;
esac



# Determine the Java command to use to start the JVM.
if [ -n "$JAVA_HOME" ] ; then
    if [ -x "$JAVA_HOME/jre/sh/java" ] ; then
        # IBM's JDK on AIX uses strange locations for the executables
        JAVACMD=$JAVA_HOME/jre/sh/java
    else
        JAVACMD=$JAVA_HOME/bin/java
    fi
    if [ ! -x "$JAVACMD" ] ; then
        die "ERROR: JAVA_HOME is set to an invalid directory: $JAVA_HOME

Please set the JAVA_HOME variable in your environment to match the
location of your Java installation."
    fi
else
    JAVACMD=java
    if ! command -v java >/dev/null 2>&1
    then
        die "ERROR: JAVA_HOME is not set and no 'java' command could be found in your PATH.

Please set the JAVA_HOME variable in your environment to match the
location of your Java installation."
    fi
fi

# Increase the maximum file descriptors if we can.
if ! "$cygwin" && ! "$darwin" && ! "$nonstop" ; then
    case $MAX_FD in #(
      max*)
        # In POSIX sh, ulimit -H is undefined. That's why the result is checked to see if it worked.
        # shellcheck disable=SC2039,SC3045
        MAX_FD=$( ulimit -H -n ) ||
            warn "Could not query maximum file descriptor limit"
    esac
    case $MAX_FD in  #(
      '' | soft) :;; #(
      *)
        # In POSIX sh, ulimit -n is undefined. That's why the result is checked to see if it worked.
        # shellcheck disable=SC2039,SC3045
        ulimit -n "$MAX_FD" ||
            warn "Could not set maximum file descriptor limit to $MAX_FD"
    esac
fi

# Collect all arguments for the java command, stacking in reverse order:
#   * args from the command line
#   * the main class name
#   * -classpath
#   * -D...appname settings
#   * --module-path (only if needed)
#   * DEFAULT_JVM_OPTS, JAVA_OPTS, and GRADLE_OPTS environment variables.

# For Cygwin or MSYS, switch paths to Windows format before running java
if "$cygwin" || "$msys" ; then
    APP_HOME=$( cygpath --path --mixed "$APP_HOME" )

    JAVACMD=$( cygpath --unix "$JAVACMD" )

    # Now convert the arguments - kludge to limit ourselves to /bin/sh
    for arg do
        if
            case $arg in                                #(
              -*)   false ;;                            # don't mess with options #(
              /?*)  t=${arg#/} t=/${t%%/*}              # looks like a POSIX filepath
                    [ -e "$t" ] ;;                      #(
              *)    false ;;
            esac
        then
            arg=$( cygpath --path --ignore --mixed "$arg" )
        fi
        # Roll the args list around exactly as many times as the number of
        # args, so each arg winds up back in the position where it started, but
        # possibly modified.
        #
        # NB: a `for` loop captures its iteration list before it begins, so
        # changing the positional parameters here affects neither the number of
        # iterations, nor the values presented in `arg`.
        shift                   # remove old arg
        set -- "$@" "$arg"      # push replacement arg
    done
fi


# Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script.
DEFAULT_JVM_OPTS='"-Xmx64m" "-Xms64m"'

# Collect all arguments for the java command:
#   * DEFAULT_JVM_OPTS, JAVA_OPTS, and optsEnvironmentVar are not allowed to contain shell fragments,
#     and any embedded shellness will be escaped.
#   * For example: A user cannot expect ${Hostname} to be expanded, as it is an environment variable and will be
#     treated as '${Hostname}' itself on the command line.

set -- \
        "-Dorg.gradle.appname=$APP_BASE_NAME" \
        -jar "$APP_HOME/gradle/wrapper/gradle-wrapper.jar" \
        "$@"

# Stop when "xargs" is not available.
if ! command -v xargs >/dev/null 2>&1
then
    die "xargs is not available"
fi

# Use "xargs" to parse quoted args.
#
# With -n1 it outputs one arg per line, with the quotes and backslashes removed.
#
# In Bash we could simply go:
#
#   readarray ARGS < <( xargs -n1 <<<"$var" ) &&
#   set -- "${ARGS[@]}" "$@"
#
# but POSIX shell has neither arrays nor command substitution, so instead we
# post-process each arg (as a line of input to sed) to backslash-escape any
# character that might be a shell metacharacter, then use eval to reverse
# that process (while maintaining the separation between arguments), and wrap
# the whole thing up as a single "set" statement.
#
# This will of course break if any of these variables contains a newline or
# an unmatched quote.
#

eval "set -- $(
        printf '%s\n' "$DEFAULT_JVM_OPTS $JAVA_OPTS $GRADLE_OPTS" |
        xargs -n1 |
        sed ' s~[^-[:alnum:]+,./:=@_]~\\&~g; ' |
        tr '\n' ' '
    )" '"$@"'

exec "$JAVACMD" "$@"

```

`gradlew.bat`:

```bat
@rem
@rem Copyright 2015 the original author or authors.
@rem
@rem Licensed under the Apache License, Version 2.0 (the "License");
@rem you may not use this file except in compliance with the License.
@rem You may obtain a copy of the License at
@rem
@rem      https://www.apache.org/licenses/LICENSE-2.0
@rem
@rem Unless required by applicable law or agreed to in writing, software
@rem distributed under the License is distributed on an "AS IS" BASIS,
@rem WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
@rem See the License for the specific language governing permissions and
@rem limitations under the License.
@rem
@rem SPDX-License-Identifier: Apache-2.0
@rem

@if "%DEBUG%"=="" @echo off
@rem ##########################################################################
@rem
@rem  Gradle startup script for Windows
@rem
@rem ##########################################################################

@rem Set local scope for the variables with windows NT shell
if "%OS%"=="Windows_NT" setlocal

set DIRNAME=%~dp0
if "%DIRNAME%"=="" set DIRNAME=.
@rem This is normally unused
set APP_BASE_NAME=%~n0
set APP_HOME=%DIRNAME%

@rem Resolve any "." and ".." in APP_HOME to make it shorter.
for %%i in ("%APP_HOME%") do set APP_HOME=%%~fi

@rem Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script.
set DEFAULT_JVM_OPTS="-Xmx64m" "-Xms64m"

@rem Find java.exe
if defined JAVA_HOME goto findJavaFromJavaHome

set JAVA_EXE=java.exe
%JAVA_EXE% -version >NUL 2>&1
if %ERRORLEVEL% equ 0 goto execute

echo. 1>&2
echo ERROR: JAVA_HOME is not set and no 'java' command could be found in your PATH. 1>&2
echo. 1>&2
echo Please set the JAVA_HOME variable in your environment to match the 1>&2
echo location of your Java installation. 1>&2

goto fail

:findJavaFromJavaHome
set JAVA_HOME=%JAVA_HOME:"=%
set JAVA_EXE=%JAVA_HOME%/bin/java.exe

if exist "%JAVA_EXE%" goto execute

echo. 1>&2
echo ERROR: JAVA_HOME is set to an invalid directory: %JAVA_HOME% 1>&2
echo. 1>&2
echo Please set the JAVA_HOME variable in your environment to match the 1>&2
echo location of your Java installation. 1>&2

goto fail

:execute
@rem Setup the command line



@rem Execute Gradle
"%JAVA_EXE%" %DEFAULT_JVM_OPTS% %JAVA_OPTS% %GRADLE_OPTS% "-Dorg.gradle.appname=%APP_BASE_NAME%" -jar "%APP_HOME%\gradle\wrapper\gradle-wrapper.jar" %*

:end
@rem End local scope for the variables with windows NT shell
if %ERRORLEVEL% equ 0 goto mainEnd

:fail
rem Set variable GRADLE_EXIT_CONSOLE if you need the _script_ return code instead of
rem the _cmd.exe /c_ return code!
set EXIT_CODE=%ERRORLEVEL%
if %EXIT_CODE% equ 0 set EXIT_CODE=1
if not ""=="%GRADLE_EXIT_CONSOLE%" exit %EXIT_CODE%
exit /b %EXIT_CODE%

:mainEnd
if "%OS%"=="Windows_NT" endlocal

:omega

```

`scripts/update_binary.sh`:

```sh
#!/bin/sh

TMPDIR=/dev/tmp
rm -rf $TMPDIR
mkdir -p $TMPDIR 2>/dev/null

export BBBIN=$TMPDIR/busybox
unzip -o "$3" "busybox" -d $TMPDIR >&2

for arch in  "arm64-v8a" ; do
  unzip -o "$3" "lib/$arch/libbusybox.so" -d $TMPDIR >&2
  libpath="$TMPDIR/lib/$arch/libbusybox.so"
  chmod 755 $libpath
  if [ -x $libpath ] && $libpath >/dev/null 2>&1; then
    mv -f $libpath $BBBIN
    break
  fi
done
$BBBIN rm -rf $TMPDIR/lib

export INSTALLER=$TMPDIR/install
$BBBIN mkdir -p $INSTALLER
$BBBIN unzip -o "$3" "assets/*" "META-INF/com/google/*" "lib/*" "META-INF/com/google/*" -x "lib/*/libbusybox.so" -d $INSTALLER >&2
export ASH_STANDALONE=1
if echo "$3" | $BBBIN grep -q "uninstall"; then
  exec $BBBIN sh "$INSTALLER/assets/UninstallAP.sh" "$@"
elif echo "$3" | $BBBIN grep -q "uninstaller"; then
  exec $BBBIN sh "$INSTALLER/assets/UninstallAP.sh" "$@"
else
  exec $BBBIN sh "$INSTALLER/assets/InstallAP.sh" "$@"
fi
```

`scripts/update_script.sh`:

```sh
######################
# APatch Empty script
# Check update-binary
######################


```

`settings.gradle.kts`:

```kts
@file:Suppress("UnstableApiUsage")

pluginManagement {
    repositories {
        gradlePluginPortal()
        google()
        mavenCentral()
    }
}

plugins {
    id("org.gradle.toolchains.foojay-resolver-convention") version "1.0.0"
}

dependencyResolutionManagement {
    repositoriesMode = RepositoriesMode.FAIL_ON_PROJECT_REPOS
    repositories {
        google()
        mavenCentral()
        maven("https://jitpack.io")
    }
}

rootProject.name = "APatch"
include(":app")

```