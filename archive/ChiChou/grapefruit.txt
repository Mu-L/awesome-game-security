Project Path: arc_ChiChou_grapefruit_ehxns0zr

Source Tree:

```txt
arc_ChiChou_grapefruit_ehxns0zr
├── CLAUDE.md
├── LICENSE
├── README.md
├── agent
│   ├── CLAUDE.md
│   ├── bun.lock
│   ├── eslint.config.js
│   ├── package-lock.json
│   ├── package.json
│   ├── patches
│   │   └── frida-compile@19.0.4.patch
│   ├── scripts
│   │   ├── build.ts
│   │   └── monaco.ts
│   ├── src
│   │   ├── common
│   │   │   ├── encode-arraybuffer.ts
│   │   │   ├── exception.ts
│   │   │   ├── fs.ts
│   │   │   ├── hermes.ts
│   │   │   ├── hooks
│   │   │   │   ├── context.ts
│   │   │   │   ├── group.ts
│   │   │   │   ├── java.ts
│   │   │   │   └── native.ts
│   │   │   ├── memory.ts
│   │   │   ├── registry.ts
│   │   │   ├── script.ts
│   │   │   ├── sqlite.ts
│   │   │   ├── symbol.ts
│   │   │   ├── syslog.ts
│   │   │   ├── taps.ts
│   │   │   └── test-runner.ts
│   │   ├── droid
│   │   │   ├── bridge
│   │   │   │   └── object.ts
│   │   │   ├── crypto
│   │   │   │   ├── crypto.ts
│   │   │   │   └── index.ts
│   │   │   ├── hooks
│   │   │   │   ├── broadcast.ts
│   │   │   │   ├── clipboard.ts
│   │   │   │   ├── flutter.ts
│   │   │   │   ├── index.ts
│   │   │   │   ├── intent.ts
│   │   │   │   ├── jni.ts
│   │   │   │   └── sharedpref.ts
│   │   │   ├── index.ts
│   │   │   ├── lib
│   │   │   │   ├── context.ts
│   │   │   │   └── intent.ts
│   │   │   ├── modules
│   │   │   │   ├── activities.ts
│   │   │   │   ├── app.ts
│   │   │   │   ├── classes.ts
│   │   │   │   ├── device.ts
│   │   │   │   ├── fs.ts
│   │   │   │   ├── keystore.ts
│   │   │   │   ├── lsof.ts
│   │   │   │   ├── manifest.ts
│   │   │   │   ├── provider.ts
│   │   │   │   ├── receivers.ts
│   │   │   │   ├── rn.ts
│   │   │   │   └── services.ts
│   │   │   ├── registry.ts
│   │   │   ├── router.ts
│   │   │   ├── taps.ts
│   │   │   └── tests.ts
│   │   ├── fruity
│   │   │   ├── bridge
│   │   │   │   ├── nsarray.ts
│   │   │   │   └── object.ts
│   │   │   ├── crypto
│   │   │   │   ├── crypto.ts
│   │   │   │   └── index.ts
│   │   │   ├── hooks
│   │   │   │   ├── biometric.ts
│   │   │   │   ├── deviceid.ts
│   │   │   │   ├── fileops.ts
│   │   │   │   ├── firebase.ts
│   │   │   │   ├── flutter.ts
│   │   │   │   ├── index.ts
│   │   │   │   ├── objc.ts
│   │   │   │   ├── pasteboard.ts
│   │   │   │   ├── sqlite.ts
│   │   │   │   ├── url
│   │   │   │   │   ├── common.ts
│   │   │   │   │   ├── connection.ts
│   │   │   │   │   ├── index.ts
│   │   │   │   │   ├── lazy.ts
│   │   │   │   │   ├── session.ts
│   │   │   │   │   └── websocket.ts
│   │   │   │   └── xpc
│   │   │   │       ├── index.ts
│   │   │   │       ├── libxpc.ts
│   │   │   │       └── nsxpc.ts
│   │   │   ├── index.ts
│   │   │   ├── lib
│   │   │   │   ├── alive.ts
│   │   │   │   ├── dispatch.ts
│   │   │   │   ├── macho.ts
│   │   │   │   ├── plist.ts
│   │   │   │   └── swift.ts
│   │   │   ├── modules
│   │   │   │   ├── checksec.ts
│   │   │   │   ├── classdump.ts
│   │   │   │   ├── cookies.ts
│   │   │   │   ├── entitlements.ts
│   │   │   │   ├── fs.ts
│   │   │   │   ├── geolocation.ts
│   │   │   │   ├── info.ts
│   │   │   │   ├── jsc.ts
│   │   │   │   ├── keychain.ts
│   │   │   │   ├── lsof.ts
│   │   │   │   ├── plugins.ts
│   │   │   │   ├── rn.ts
│   │   │   │   ├── ui.ts
│   │   │   │   ├── uidevice.ts
│   │   │   │   ├── url.ts
│   │   │   │   ├── userdefaults.ts
│   │   │   │   └── webview.ts
│   │   │   ├── native
│   │   │   │   ├── corefoundation.ts
│   │   │   │   ├── libdyld.ts
│   │   │   │   ├── libsystem.ts
│   │   │   │   ├── libxpc.ts
│   │   │   │   └── security.ts
│   │   │   ├── observers
│   │   │   │   └── lifecycle.ts
│   │   │   ├── registry.ts
│   │   │   ├── router.ts
│   │   │   ├── taps.ts
│   │   │   ├── tests.ts
│   │   │   └── typings.ts
│   │   ├── lib
│   │   │   ├── polyfill.ts
│   │   │   └── posix.ts
│   │   └── transport.ts
│   ├── tsconfig.json
│   ├── tsconfig.type-droid.json
│   └── tsconfig.type-fruity.json
├── bun.lock
├── docs
│   ├── arch.md
│   ├── dev.md
│   └── rpc.md
├── drizzle
│   ├── 0000_opposite_sentry.sql
│   ├── 0001_cheerful_zaran.sql
│   ├── 0002_conscious_tyrannus.sql
│   └── meta
│       ├── 0000_snapshot.json
│       ├── 0001_snapshot.json
│       ├── 0002_snapshot.json
│       └── _journal.json
├── drizzle.config.ts
├── gui
│   ├── README.md
│   ├── bun.lock
│   ├── components.json
│   ├── eslint.config.js
│   ├── index.html
│   ├── package.json
│   ├── src
│   │   ├── App.css
│   │   ├── App.tsx
│   │   ├── assets
│   │   │   ├── grapefruit.svg
│   │   │   └── logo.svg
│   │   ├── components
│   │   │   ├── layout
│   │   │   │   ├── BottomPanelView.tsx
│   │   │   │   ├── LeftPanelView.tsx
│   │   │   │   ├── StatusBar.tsx
│   │   │   │   ├── Workspace.tsx
│   │   │   │   └── WorkspaceIndex.tsx
│   │   │   ├── pages
│   │   │   │   ├── AppsView.tsx
│   │   │   │   ├── DefaultMessage.tsx
│   │   │   │   ├── Devices.tsx
│   │   │   │   ├── ProcessesView.tsx
│   │   │   │   └── WelcomePage.tsx
│   │   │   ├── panels
│   │   │   │   ├── DroidClassesPanel.tsx
│   │   │   │   ├── DroidComponentsPanel.tsx
│   │   │   │   ├── DroidDevicePanel.tsx
│   │   │   │   ├── DroidGeneralPanel.tsx
│   │   │   │   ├── DroidHookControlPanel.tsx
│   │   │   │   ├── DroidHooksPanel.tsx
│   │   │   │   ├── DroidURLSchemesPanel.tsx
│   │   │   │   ├── FruityClassesPanel.tsx
│   │   │   │   ├── FruityDevicePanel.tsx
│   │   │   │   ├── FruityGeneralPanel.tsx
│   │   │   │   ├── FruityGeolocationPanel.tsx
│   │   │   │   ├── FruityHookControlPanel.tsx
│   │   │   │   ├── FruityHooksPanel.tsx
│   │   │   │   ├── FruityPluginsPanel.tsx
│   │   │   │   ├── FruityURLSchemesPanel.tsx
│   │   │   │   ├── FruityURLSendView.tsx
│   │   │   │   ├── FruityUserHooksList.tsx
│   │   │   │   ├── ModulesPanel.tsx
│   │   │   │   └── PlaceholderPanel.tsx
│   │   │   ├── providers
│   │   │   │   ├── R2Provider.tsx
│   │   │   │   ├── SessionProvider.tsx
│   │   │   │   └── ThemeProvider.tsx
│   │   │   ├── shared
│   │   │   │   ├── ConsoleRepl.tsx
│   │   │   │   ├── CrashDialog.tsx
│   │   │   │   ├── CryptoResultsView.tsx
│   │   │   │   ├── DarkmodeToggle.tsx
│   │   │   │   ├── DeniedDialog.tsx
│   │   │   │   ├── HexView.tsx
│   │   │   │   ├── HookResultsView.tsx
│   │   │   │   ├── HttpResponseBodyView.tsx
│   │   │   │   ├── JsonTreeView.tsx
│   │   │   │   ├── LanguageSelector.tsx
│   │   │   │   ├── LogPanel.tsx
│   │   │   │   ├── LogTable.tsx
│   │   │   │   ├── LogViewer.tsx
│   │   │   │   ├── NativeHookDialog.tsx
│   │   │   │   ├── PlistTreeView.tsx
│   │   │   │   ├── SymbolsTableView.tsx
│   │   │   │   ├── Terminal.tsx
│   │   │   │   ├── UnifiedPlistViewer.tsx
│   │   │   │   └── XPCTreeView.tsx
│   │   │   ├── tabs
│   │   │   │   ├── CodeScratchPadTab.tsx
│   │   │   │   ├── DirectoryTree.tsx
│   │   │   │   ├── DisassemblyTab.css
│   │   │   │   ├── DroidClassDetailTab.tsx
│   │   │   │   ├── DroidHandlesTab.tsx
│   │   │   │   ├── DroidJNITab.tsx
│   │   │   │   ├── DroidKeystoreTab.tsx
│   │   │   │   ├── DroidManifestTab.tsx
│   │   │   │   ├── DroidProvidersTab.tsx
│   │   │   │   ├── FileTable.tsx
│   │   │   │   ├── FinderTab.tsx
│   │   │   │   ├── FlutterMethodChannelsTab.tsx
│   │   │   │   ├── FontPreviewTab.tsx
│   │   │   │   ├── FruityBinaryCookieTab.tsx
│   │   │   │   ├── FruityClassDetailTab.tsx
│   │   │   │   ├── FruityClassDumpTab.tsx
│   │   │   │   ├── FruityDisassemblyTab.tsx
│   │   │   │   ├── FruityEntitlementsTab.tsx
│   │   │   │   ├── FruityHandlesTab.tsx
│   │   │   │   ├── FruityInfoPlistInsightsTab.tsx
│   │   │   │   ├── FruityInfoPlistTab.tsx
│   │   │   │   ├── FruityJSCTab.tsx
│   │   │   │   ├── FruityKeychainTab.tsx
│   │   │   │   ├── FruityNSURLTab.tsx
│   │   │   │   ├── FruityPlistPreviewTab.tsx
│   │   │   │   ├── FruityUIDumpTab.tsx
│   │   │   │   ├── FruityUserDefaultsTab.tsx
│   │   │   │   ├── FruityWebViewTab.tsx
│   │   │   │   ├── FruityXPCTab.tsx
│   │   │   │   ├── HermesTab.tsx
│   │   │   │   ├── HexPreviewTab.tsx
│   │   │   │   ├── HomeTab.tsx
│   │   │   │   ├── ImagePreviewTab.tsx
│   │   │   │   ├── InfoPlistInsights.tsx
│   │   │   │   ├── ManifestInsights.tsx
│   │   │   │   ├── MemoryPreviewTab.tsx
│   │   │   │   ├── MemoryScanTab.tsx
│   │   │   │   ├── ModuleViewTabs.tsx
│   │   │   │   ├── NoCloseTabHeader.tsx
│   │   │   │   ├── ReactNativeTab.tsx
│   │   │   │   ├── SQLiteEditorTab.tsx
│   │   │   │   └── TextEditorTab.tsx
│   │   │   ├── ui
│   │   │   │   ├── alert-dialog.tsx
│   │   │   │   ├── alert.tsx
│   │   │   │   ├── badge.tsx
│   │   │   │   ├── button-group.tsx
│   │   │   │   ├── button.tsx
│   │   │   │   ├── calendar.tsx
│   │   │   │   ├── card.tsx
│   │   │   │   ├── checkbox.tsx
│   │   │   │   ├── command.tsx
│   │   │   │   ├── dialog.tsx
│   │   │   │   ├── dropdown-menu.tsx
│   │   │   │   ├── input-group.tsx
│   │   │   │   ├── input.tsx
│   │   │   │   ├── label.tsx
│   │   │   │   ├── popover.tsx
│   │   │   │   ├── progress.tsx
│   │   │   │   ├── radio-group.tsx
│   │   │   │   ├── resizable.tsx
│   │   │   │   ├── scroll-area.tsx
│   │   │   │   ├── select.tsx
│   │   │   │   ├── separator.tsx
│   │   │   │   ├── skeleton.tsx
│   │   │   │   ├── slider.tsx
│   │   │   │   ├── spinner.tsx
│   │   │   │   ├── switch.tsx
│   │   │   │   ├── table.tsx
│   │   │   │   ├── tabs.tsx
│   │   │   │   ├── textarea.tsx
│   │   │   │   ├── toggle-group.tsx
│   │   │   │   ├── toggle.tsx
│   │   │   │   └── tooltip.tsx
│   │   │   └── views
│   │   │       ├── ClassesListView.tsx
│   │   │       ├── ExportedListView.tsx
│   │   │       ├── ImportsListView.tsx
│   │   │       ├── SectionsListView.tsx
│   │   │       └── SymbolsListView.tsx
│   │   ├── context
│   │   │   ├── DockContext.ts
│   │   │   ├── ReplContext.tsx
│   │   │   ├── SessionContext.ts
│   │   │   └── useRepl.ts
│   │   ├── hooks
│   │   │   └── useLogStream.ts
│   │   ├── i18n.ts
│   │   ├── index.css
│   │   ├── lib
│   │   │   ├── classdump-header.ts
│   │   │   ├── codegen.ts
│   │   │   ├── file-explorer.ts
│   │   │   ├── format.ts
│   │   │   ├── hash.ts
│   │   │   ├── hook-template.ts
│   │   │   ├── queries.ts
│   │   │   ├── rpc.ts
│   │   │   └── utils.ts
│   │   ├── locales
│   │   │   ├── cn
│   │   │   │   └── translation.json
│   │   │   └── en
│   │   │       └── translation.json
│   │   ├── main.tsx
│   │   └── types
│   │       └── device.d.ts
│   ├── tsconfig.app.json
│   ├── tsconfig.json
│   ├── tsconfig.node.json
│   └── vite.config.ts
├── package-lock.json
├── package.json
├── patches
│   ├── frida@16.7.19.patch
│   └── frida@17.6.2.patch
├── scripts
│   ├── build-bun.ts
│   ├── build-npm.ts
│   ├── dev.ts
│   ├── prepare.ts
│   └── skills.ts
├── skills
├── src
│   ├── app.ts
│   ├── bin.ts
│   ├── index.ts
│   ├── lib
│   │   ├── assets.ts
│   │   ├── cli.ts
│   │   ├── env.ts
│   │   ├── har.ts
│   │   ├── hash.ts
│   │   ├── log-writer.ts
│   │   ├── middleware.ts
│   │   ├── paths.ts
│   │   ├── regulation.ts
│   │   ├── reset.ts
│   │   ├── schema.ts
│   │   ├── serializer.ts
│   │   ├── store
│   │   │   ├── base.ts
│   │   │   ├── crypto.ts
│   │   │   ├── db.ts
│   │   │   ├── flutter.ts
│   │   │   ├── hermes.ts
│   │   │   ├── hooks.ts
│   │   │   ├── jni.ts
│   │   │   ├── nsurl.ts
│   │   │   ├── preferences.ts
│   │   │   ├── taps.ts
│   │   │   └── xpc.ts
│   │   ├── transport.ts
│   │   ├── version.ts
│   │   └── xvii.ts
│   ├── relay.ts
│   ├── routes
│   │   ├── data.ts
│   │   ├── devices.ts
│   │   ├── llm.ts
│   │   └── transfer.ts
│   ├── session.ts
│   ├── tests
│   │   ├── agent.test.ts
│   │   ├── app.test.ts
│   │   └── ws.test.ts
│   ├── types.ts
│   └── ws.ts
├── tsconfig.json
└── tsdown.config.ts

```

`CLAUDE.md`:

```md
Monorepo with three workspaces:

- root (server), 
- `agent/` (Frida agent), 
- `gui/` (frontend).

## Static checks

All code changes must pass the relevant checks before committing.

### agent/ (Frida agent)

```sh
cd agent && bun run build    # full build (agents + types)
cd agent && bun run type     # type-check only (droid + fruity)
```

### gui/ (frontend)

```sh
cd gui && bun run lint       # ESLint
cd gui && bunx tsgo --noEmit # type-check
cd gui && bun run build      # full build
```

### root (server)

```sh
bunx tsgo --noEmit  # type-check
bun test            # run tests
```

`bun run prepare` build everything at once, slow
```

`LICENSE`:

```
MIT License

Copyright (c) 2026 CodeColorist

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

`README.md`:

```md
<img src="gui/src/assets/logo.svg" alt="logo" width="320">

# Grapefruit: Runtime Application Exploration

[![John Discord](https://discord.com/api/guilds/591601634266578944/embed.png)](https://discord.com/invite/pwutZNx)
[![npm version](https://img.shields.io/npm/v/igf?color=blue)](https://www.npmjs.com/package/igf)
[![Commits](https://img.shields.io/github/commit-activity/w/chichou/grapefruit?label=Commits)](https://github.com/ChiChou/Grapefruit/commits/master)
[![contributers](https://img.shields.io/github/contributors/chichou/grapefruit)](https://github.com/ChiChou/Grapefruit/graphs/contributors)
[![License](https://img.shields.io/github/license/chichou/grapefruit)](https://github.com/ChiChou/Grapefruit/blob/master/LICENSE)

> **Warning**: This project is under active development and is not ready for production use.

Runtime mobile application instrumentation toolkit powered by [Frida](https://frida.re).
Inspect, hook, and modify mobile apps through a web-based interface.

Now it supports both iOS and Android!

## Features

- **Runtime Method Hooking** - Intercept native and managed functions with structured logging
- **Cryptographic API Interception** - Monitor encryption/decryption operations with data capture
- **Filesystem Browser** - Navigate, upload, download, and inspect files with hex/text preview
- **SQLite Database Inspection** - Browse tables, run queries, and view results
- **Syslog Streaming** - Real-time system and agent log monitoring
- **Process Crash Reporting** - Exception handler with register dump and backtrace
- **Flutter Support** - Monitor platform method channel communication on both platforms

### iOS

- Keychain access and modification
- NSURL session traffic capture (HTTP/HTTPS/WebSocket)
- WebView and JSContext inspection with JavaScript execution
- UI hierarchy dump and element highlighting
- Info.plist, entitlements, and binary cookie viewers
- Biometric (Touch ID / Face ID) bypass
- UserDefaults browser
- Pasteboard and file operation monitoring
- Geolocation spoofing
- Objective-C class and method inspection
- Open file handles and network connections (lsof)
- Security analysis (PIE, ARC, stack canaries, encryption)

### Android

- AndroidManifest.xml decoder and component browser (activities, services, receivers, providers)
- Android Keystore inspection with key attributes
- Content provider query, insert, update, and delete
- JNI call tracing with arguments, return values, and backtraces
- Java class inspection (methods, fields, interfaces)
- Intent building and launching
- Open file handles and network connections (lsof)

## Documentation

- [Development](docs/dev.md)
- [Architecture](docs/arch.md)
- [RPC](docs/rpc.md)

## License

[MIT](LICENSE)

```

`agent/CLAUDE.md`:

```md
This folder is the frida agent source code.

## Test a single RPC:

`frida -U -F -l src/droid/index.ts -e 'rpc.exports.invoke("info", "processInfo", [])' -q`

If the RPC returns a Promise, use

`frida -U -F -l src/droid/index.ts -e 'rpc.exports.invoke("manifest", "xml", []).then(result => console.log(result)).catch(err => console.error(err))' -q`

## Build

`bun run build` can build all agents, types at once. But sometimes you just need
to build a paricular agent, for example `bun run build:droid` or `bun run build:fruity`

```

`agent/bun.lock`:

```lock
{
  "lockfileVersion": 1,
  "configVersion": 0,
  "workspaces": {
    "": {
      "name": "igf-agent",
      "dependencies": {
        "frida-java-bridge": "^7.0.10",
        "frida-objc-bridge": "^8.0.5",
        "frida-remote-stream": "^6.0.3",
        "frida-swift-bridge": "^3.0.2",
      },
      "devDependencies": {
        "@types/frida-gum": "^19.0.1",
        "@types/node": "^18.14.0",
        "@typescript-eslint/eslint-plugin": "^8.48.0",
        "@typescript-eslint/parser": "^8.48.0",
        "@typescript/native-preview": "7.0.0-dev.20251108.1",
        "eslint": "^9.39.1",
        "frida-compile": "^19.0.4",
      },
    },
  },
  "trustedDependencies": [
    "frida",
  ],
  "patchedDependencies": {
    "frida-compile@19.0.4": "patches/frida-compile@19.0.4.patch",
  },
  "packages": {
    "@eslint-community/eslint-utils": ["@eslint-community/eslint-utils@4.9.0", "", { "dependencies": { "eslint-visitor-keys": "^3.4.3" }, "peerDependencies": { "eslint": "^6.0.0 || ^7.0.0 || >=8.0.0" } }, "sha512-ayVFHdtZ+hsq1t2Dy24wCmGXGe4q9Gu3smhLYALJrr473ZH27MsnSL+LKUlimp4BWJqMDMLmPpx/Q9R3OAlL4g=="],

    "@eslint-community/regexpp": ["@eslint-community/regexpp@4.12.2", "", {}, "sha512-EriSTlt5OC9/7SXkRSCAhfSxxoSUgBm33OH+IkwbdpgoqsSsUg7y3uh+IICI/Qg4BBWr3U2i39RpmycbxMq4ew=="],

    "@eslint/config-array": ["@eslint/config-array@0.21.1", "", { "dependencies": { "@eslint/object-schema": "^2.1.7", "debug": "^4.3.1", "minimatch": "^3.1.2" } }, "sha512-aw1gNayWpdI/jSYVgzN5pL0cfzU02GT3NBpeT/DXbx1/1x7ZKxFPd9bwrzygx/qiwIQiJ1sw/zD8qY/kRvlGHA=="],

    "@eslint/config-helpers": ["@eslint/config-helpers@0.4.2", "", { "dependencies": { "@eslint/core": "^0.17.0" } }, "sha512-gBrxN88gOIf3R7ja5K9slwNayVcZgK6SOUORm2uBzTeIEfeVaIhOpCtTox3P6R7o2jLFwLFTLnC7kU/RGcYEgw=="],

    "@eslint/core": ["@eslint/core@0.17.0", "", { "dependencies": { "@types/json-schema": "^7.0.15" } }, "sha512-yL/sLrpmtDaFEiUj1osRP4TI2MDz1AddJL+jZ7KSqvBuliN4xqYY54IfdN8qD8Toa6g1iloph1fxQNkjOxrrpQ=="],

    "@eslint/eslintrc": ["@eslint/eslintrc@3.3.1", "", { "dependencies": { "ajv": "^6.12.4", "debug": "^4.3.2", "espree": "^10.0.1", "globals": "^14.0.0", "ignore": "^5.2.0", "import-fresh": "^3.2.1", "js-yaml": "^4.1.0", "minimatch": "^3.1.2", "strip-json-comments": "^3.1.1" } }, "sha512-gtF186CXhIl1p4pJNGZw8Yc6RlshoePRvE0X91oPGb3vZ8pM3qOS9W9NGPat9LziaBV7XrJWGylNQXkGcnM3IQ=="],

    "@eslint/js": ["@eslint/js@9.39.1", "", {}, "sha512-S26Stp4zCy88tH94QbBv3XCuzRQiZ9yXofEILmglYTh/Ug/a9/umqvgFtYBAo3Lp0nsI/5/qH1CCrbdK3AP1Tw=="],

    "@eslint/object-schema": ["@eslint/object-schema@2.1.7", "", {}, "sha512-VtAOaymWVfZcmZbp6E2mympDIHvyjXs/12LqWYjVw6qjrfF+VK+fyG33kChz3nnK+SU5/NeHOqrTEHS8sXO3OA=="],

    "@eslint/plugin-kit": ["@eslint/plugin-kit@0.4.1", "", { "dependencies": { "@eslint/core": "^0.17.0", "levn": "^0.4.1" } }, "sha512-43/qtrDUokr7LJqoF2c3+RInu/t4zfrpYdoSDfYyhg52rwLV6TnOvdG4fXm7IkSB3wErkcmJS9iEhjVtOSEjjA=="],

    "@humanfs/core": ["@humanfs/core@0.19.1", "", {}, "sha512-5DyQ4+1JEUzejeK1JGICcideyfUbGixgS9jNgex5nqkW+cY7WZhxBigmieN5Qnw9ZosSNVC9KQKyb+GUaGyKUA=="],

    "@humanfs/node": ["@humanfs/node@0.16.7", "", { "dependencies": { "@humanfs/core": "^0.19.1", "@humanwhocodes/retry": "^0.4.0" } }, "sha512-/zUx+yOsIrG4Y43Eh2peDeKCxlRt/gET6aHfaKpuq267qXdYDFViVHfMaLyygZOnl0kGWxFIgsBy8QFuTLUXEQ=="],

    "@humanwhocodes/module-importer": ["@humanwhocodes/module-importer@1.0.1", "", {}, "sha512-bxveV4V8v5Yb4ncFTT3rPSgZBOpCkjfK0y4oVVVJwIuDVBRMDXrPyXRL988i5ap9m9bnyEEjWfm5WkBmtffLfA=="],

    "@humanwhocodes/retry": ["@humanwhocodes/retry@0.4.3", "", {}, "sha512-bV0Tgo9K4hfPCek+aMAn81RppFKv2ySDQeMoSZuvTASywNTnVJCArCZE2FWqpvIatKu7VMRLWlR1EazvVhDyhQ=="],

    "@isaacs/balanced-match": ["@isaacs/balanced-match@4.0.1", "", {}, "sha512-yzMTt9lEb8Gv7zRioUilSglI0c0smZ9k5D65677DLWLtWJaXIS3CqcGyUFByYKlnUj6TkjLVs54fBl6+TiGQDQ=="],

    "@isaacs/brace-expansion": ["@isaacs/brace-expansion@5.0.0", "", { "dependencies": { "@isaacs/balanced-match": "^4.0.1" } }, "sha512-ZT55BDLV0yv0RBm2czMiZ+SqCGO7AvmOM3G/w2xhVPH+te0aKgFjmBvGlL1dH+ql2tgGO3MVrbb3jCKyvpgnxA=="],

    "@types/estree": ["@types/estree@1.0.8", "", {}, "sha512-dWHzHa2WqEXI/O1E9OjrocMTKJl2mSrEolh1Iomrv6U+JuNwaHXsXx9bLu5gG7BUWFIN0skIQJQ/L1rIex4X6w=="],

    "@types/frida-gum": ["@types/frida-gum@19.0.1", "", {}, "sha512-mp8BpWWkQFJH86ZN5uXZuDiA7KY/+jDknrw0a06x0/+F5ucPwctHrCuV6iT+LLCp/GyICc36ssedF33B1WoLsw=="],

    "@types/json-schema": ["@types/json-schema@7.0.15", "", {}, "sha512-5+fP8P8MFNC+AyZCDxrB2pkZFPGzqQWUzpSeuuVLvm8VMcorNYavBqoFcxK8bQz4Qsbn4oUEEem4wDLfcysGHA=="],

    "@types/node": ["@types/node@18.19.130", "", { "dependencies": { "undici-types": "~5.26.4" } }, "sha512-GRaXQx6jGfL8sKfaIDD6OupbIHBr9jv7Jnaml9tB7l4v068PAOXqfcujMMo5PhbIs6ggR1XODELqahT2R8v0fg=="],

    "@typescript-eslint/eslint-plugin": ["@typescript-eslint/eslint-plugin@8.48.0", "", { "dependencies": { "@eslint-community/regexpp": "^4.10.0", "@typescript-eslint/scope-manager": "8.48.0", "@typescript-eslint/type-utils": "8.48.0", "@typescript-eslint/utils": "8.48.0", "@typescript-eslint/visitor-keys": "8.48.0", "graphemer": "^1.4.0", "ignore": "^7.0.0", "natural-compare": "^1.4.0", "ts-api-utils": "^2.1.0" }, "peerDependencies": { "@typescript-eslint/parser": "^8.48.0", "eslint": "^8.57.0 || ^9.0.0", "typescript": ">=4.8.4 <6.0.0" } }, "sha512-XxXP5tL1txl13YFtrECECQYeZjBZad4fyd3cFV4a19LkAY/bIp9fev3US4S5fDVV2JaYFiKAZ/GRTOLer+mbyQ=="],

    "@typescript-eslint/parser": ["@typescript-eslint/parser@8.48.0", "", { "dependencies": { "@typescript-eslint/scope-manager": "8.48.0", "@typescript-eslint/types": "8.48.0", "@typescript-eslint/typescript-estree": "8.48.0", "@typescript-eslint/visitor-keys": "8.48.0", "debug": "^4.3.4" }, "peerDependencies": { "eslint": "^8.57.0 || ^9.0.0", "typescript": ">=4.8.4 <6.0.0" } }, "sha512-jCzKdm/QK0Kg4V4IK/oMlRZlY+QOcdjv89U2NgKHZk1CYTj82/RVSx1mV/0gqCVMJ/DA+Zf/S4NBWNF8GQ+eqQ=="],

    "@typescript-eslint/project-service": ["@typescript-eslint/project-service@8.48.0", "", { "dependencies": { "@typescript-eslint/tsconfig-utils": "^8.48.0", "@typescript-eslint/types": "^8.48.0", "debug": "^4.3.4" }, "peerDependencies": { "typescript": ">=4.8.4 <6.0.0" } }, "sha512-Ne4CTZyRh1BecBf84siv42wv5vQvVmgtk8AuiEffKTUo3DrBaGYZueJSxxBZ8fjk/N3DrgChH4TOdIOwOwiqqw=="],

    "@typescript-eslint/scope-manager": ["@typescript-eslint/scope-manager@8.48.0", "", { "dependencies": { "@typescript-eslint/types": "8.48.0", "@typescript-eslint/visitor-keys": "8.48.0" } }, "sha512-uGSSsbrtJrLduti0Q1Q9+BF1/iFKaxGoQwjWOIVNJv0o6omrdyR8ct37m4xIl5Zzpkp69Kkmvom7QFTtue89YQ=="],

    "@typescript-eslint/tsconfig-utils": ["@typescript-eslint/tsconfig-utils@8.48.0", "", { "peerDependencies": { "typescript": ">=4.8.4 <6.0.0" } }, "sha512-WNebjBdFdyu10sR1M4OXTt2OkMd5KWIL+LLfeH9KhgP+jzfDV/LI3eXzwJ1s9+Yc0Kzo2fQCdY/OpdusCMmh6w=="],

    "@typescript-eslint/type-utils": ["@typescript-eslint/type-utils@8.48.0", "", { "dependencies": { "@typescript-eslint/types": "8.48.0", "@typescript-eslint/typescript-estree": "8.48.0", "@typescript-eslint/utils": "8.48.0", "debug": "^4.3.4", "ts-api-utils": "^2.1.0" }, "peerDependencies": { "eslint": "^8.57.0 || ^9.0.0", "typescript": ">=4.8.4 <6.0.0" } }, "sha512-zbeVaVqeXhhab6QNEKfK96Xyc7UQuoFWERhEnj3mLVnUWrQnv15cJNseUni7f3g557gm0e46LZ6IJ4NJVOgOpw=="],

    "@typescript-eslint/types": ["@typescript-eslint/types@8.48.0", "", {}, "sha512-cQMcGQQH7kwKoVswD1xdOytxQR60MWKM1di26xSUtxehaDs/32Zpqsu5WJlXTtTTqyAVK8R7hvsUnIXRS+bjvA=="],

    "@typescript-eslint/typescript-estree": ["@typescript-eslint/typescript-estree@8.48.0", "", { "dependencies": { "@typescript-eslint/project-service": "8.48.0", "@typescript-eslint/tsconfig-utils": "8.48.0", "@typescript-eslint/types": "8.48.0", "@typescript-eslint/visitor-keys": "8.48.0", "debug": "^4.3.4", "minimatch": "^9.0.4", "semver": "^7.6.0", "tinyglobby": "^0.2.15", "ts-api-utils": "^2.1.0" }, "peerDependencies": { "typescript": ">=4.8.4 <6.0.0" } }, "sha512-ljHab1CSO4rGrQIAyizUS6UGHHCiAYhbfcIZ1zVJr5nMryxlXMVWS3duFPSKvSUbFPwkXMFk1k0EMIjub4sRRQ=="],

    "@typescript-eslint/utils": ["@typescript-eslint/utils@8.48.0", "", { "dependencies": { "@eslint-community/eslint-utils": "^4.7.0", "@typescript-eslint/scope-manager": "8.48.0", "@typescript-eslint/types": "8.48.0", "@typescript-eslint/typescript-estree": "8.48.0" }, "peerDependencies": { "eslint": "^8.57.0 || ^9.0.0", "typescript": ">=4.8.4 <6.0.0" } }, "sha512-yTJO1XuGxCsSfIVt1+1UrLHtue8xz16V8apzPYI06W0HbEbEWHxHXgZaAgavIkoh+GeV6hKKd5jm0sS6OYxWXQ=="],

    "@typescript-eslint/visitor-keys": ["@typescript-eslint/visitor-keys@8.48.0", "", { "dependencies": { "@typescript-eslint/types": "8.48.0", "eslint-visitor-keys": "^4.2.1" } }, "sha512-T0XJMaRPOH3+LBbAfzR2jalckP1MSG/L9eUtY0DEzUyVaXJ/t6zN0nR7co5kz0Jko/nkSYCBRkz1djvjajVTTg=="],

    "@typescript/native-preview": ["@typescript/native-preview@7.0.0-dev.20251108.1", "", { "optionalDependencies": { "@typescript/native-preview-darwin-arm64": "7.0.0-dev.20251108.1", "@typescript/native-preview-darwin-x64": "7.0.0-dev.20251108.1", "@typescript/native-preview-linux-arm": "7.0.0-dev.20251108.1", "@typescript/native-preview-linux-arm64": "7.0.0-dev.20251108.1", "@typescript/native-preview-linux-x64": "7.0.0-dev.20251108.1", "@typescript/native-preview-win32-arm64": "7.0.0-dev.20251108.1", "@typescript/native-preview-win32-x64": "7.0.0-dev.20251108.1" }, "bin": { "tsgo": "bin/tsgo.js" } }, "sha512-v1SNmHbuTYMEIAAJZ5OgKY5kMIgDnS/aVTsP9FdR9FgqyZqgUbA2eHOjjMQHVw/XBLS5ZA32kkGt7cH8RzMlOA=="],

    "@typescript/native-preview-darwin-arm64": ["@typescript/native-preview-darwin-arm64@7.0.0-dev.20251108.1", "", { "os": "darwin", "cpu": "arm64" }, "sha512-zdD59CWlvJum9hu7Rrb7xntGfkeTlki7Pql/s+Ls0sNSEGimjuJmU88ookUt2UMPLZ9S+RyGfjNbS7duhKuCIw=="],

    "@typescript/native-preview-darwin-x64": ["@typescript/native-preview-darwin-x64@7.0.0-dev.20251108.1", "", { "os": "darwin", "cpu": "x64" }, "sha512-nxs1vOm6jkwZoA56d6E2pllhYbxK2xNtspG2Yx9kswdp0aqh2jcja1EjMilHv4tnvNixRQvRWhoOz/BgWrxTig=="],

    "@typescript/native-preview-linux-arm": ["@typescript/native-preview-linux-arm@7.0.0-dev.20251108.1", "", { "os": "linux", "cpu": "arm" }, "sha512-+1UuKod2SJZODnArwHViJEhZxgM1aHK5KCGlHJU61htq3jgNtRfouw4UEJRPTALCnGLun8ZpYuMsJUMeDFFIUQ=="],

    "@typescript/native-preview-linux-arm64": ["@typescript/native-preview-linux-arm64@7.0.0-dev.20251108.1", "", { "os": "linux", "cpu": "arm64" }, "sha512-Er0P4Dt6fBM6MZidGBKGZs5PS2QHunRPNeIKCATJRcBMn8ymSBdi/IJK/wYVU62HW8CLb1Dt3FbueW5UptSAKA=="],

    "@typescript/native-preview-linux-x64": ["@typescript/native-preview-linux-x64@7.0.0-dev.20251108.1", "", { "os": "linux", "cpu": "x64" }, "sha512-3ijz+Uo8unENgq22nlyThf1JqhLVOwN881gomoAykALmspXX13aQwnDtbscnQRr1iQqMIrEyyRMwxfVevQkl9w=="],

    "@typescript/native-preview-win32-arm64": ["@typescript/native-preview-win32-arm64@7.0.0-dev.20251108.1", "", { "os": "win32", "cpu": "arm64" }, "sha512-Aeyrj7sdc6GBnLIw9o5dQPzEqrfsJodDYsi7RePm0QLvGVyxOeZVd9CcfdXqPKnD2goEJNOzFoTRyvvi7DjNUg=="],

    "@typescript/native-preview-win32-x64": ["@typescript/native-preview-win32-x64@7.0.0-dev.20251108.1", "", { "os": "win32", "cpu": "x64" }, "sha512-rgfq7AZ7IFfE5EyDuHdpDEPUH3LEesyOVuIHE6YWOSqGOFnlzYbOf37VUYxQTIxFrR7IopgvM4pSDR3KeDcMjQ=="],

    "acorn": ["acorn@8.15.0", "", { "bin": "bin/acorn" }, "sha512-NZyJarBfL7nWwIq+FDL6Zp/yHEhePMNnnJ0y3qfieCrmNvYct8uvtiV41UvlSe6apAfk0fY1FbWx+NwfmpvtTg=="],

    "acorn-jsx": ["acorn-jsx@5.3.2", "", { "peerDependencies": { "acorn": "^6.0.0 || ^7.0.0 || ^8.0.0" } }, "sha512-rq9s+JNhf0IChjtDXxllJ7g41oZk5SlXtp0LHwyA5cejwn7vKmKp4pPri6YEePv2PU65sAsegbXtIinmDFDXgQ=="],

    "ajv": ["ajv@6.12.6", "", { "dependencies": { "fast-deep-equal": "^3.1.1", "fast-json-stable-stringify": "^2.0.0", "json-schema-traverse": "^0.4.1", "uri-js": "^4.2.2" } }, "sha512-j3fVLgvTo527anyYyJOGTYJbG+vnnQYvE0m5mmkc1TK+nxAppkCLMIL0aZ4dblVCNoGShhm+kzE4ZUykBoMg4g=="],

    "ansi-styles": ["ansi-styles@4.3.0", "", { "dependencies": { "color-convert": "^2.0.1" } }, "sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg=="],

    "argparse": ["argparse@2.0.1", "", {}, "sha512-8+9WqebbFzpX9OR+Wa6O29asIogeRMzcGtAINdpMHHyAg10f05aSFVBbcEqGf/PXw1EjAZ+q2/bEBg3DvurK3Q=="],

    "balanced-match": ["balanced-match@1.0.2", "", {}, "sha512-3oSeUO0TMV67hN1AmbXsK4yaqU7tjiHlbxRDZOpH0KW9+CeX4bRAaX0Anxt0tx2MrpRpWwQaPwIlISEJhYU5Pw=="],

    "base64-js": ["base64-js@1.5.1", "", {}, "sha512-AKpaYlHn8t4SVbOHCy+b5+KKgvR4vrsD8vbvrbiQJps7fKDTkjkDry6ji0rUJjC0kzbNePLwzxq8iypo41qeWA=="],

    "bindings": ["bindings@1.5.0", "", { "dependencies": { "file-uri-to-path": "1.0.0" } }, "sha512-p2q/t/mhvuOj/UeLlV6566GD/guowlr0hHxClI0W9m7MWYkL1F0hLo+0Aexs9HSPCtR1SXQ0TD3MMKrXZajbiQ=="],

    "bl": ["bl@4.1.0", "", { "dependencies": { "buffer": "^5.5.0", "inherits": "^2.0.4", "readable-stream": "^3.4.0" } }, "sha512-1W07cM9gS6DcLperZfFSj+bWLtaPGSOHWhPiGzXmvVJbRLdG82sH/Kn8EtW1VqWVA54AKf2h5k5BbnIbwF3h6w=="],

    "brace-expansion": ["brace-expansion@1.1.12", "", { "dependencies": { "balanced-match": "^1.0.0", "concat-map": "0.0.1" } }, "sha512-9T9UjW3r0UW5c1Q7GTwllptXwhvYmEzFhzMfZ9H7FQWt+uZePjZPjBP/W1ZEyZ1twGWom5/56TF4lPcqjnDHcg=="],

    "buffer": ["buffer@5.7.1", "", { "dependencies": { "base64-js": "^1.3.1", "ieee754": "^1.1.13" } }, "sha512-EHcyIPBQ4BSGlvjB16k5KgAJ27CIsHY/2JBmCRReo48y9rQ3MaUzWX3KVlBa4U7MyX02HdVj0K7C3WaB3ju7FQ=="],

    "callsites": ["callsites@3.1.0", "", {}, "sha512-P8BjAsXvZS+VIDUI11hHCQEv74YT67YUi5JJFNWIqL235sBmjX4+qx9Muvls5ivyNENctx46xQLQ3aTuE7ssaQ=="],

    "chalk": ["chalk@4.1.2", "", { "dependencies": { "ansi-styles": "^4.1.0", "supports-color": "^7.1.0" } }, "sha512-oKnbhFyRIXpUuez8iBMmyEa4nbj4IOQyuhc/wy9kY7/WVPcwIO9VA668Pu8RkO7+0G76SLROeyw9CpQ061i4mA=="],

    "chownr": ["chownr@1.1.4", "", {}, "sha512-jJ0bqzaylmJtVnNgzTeSOs8DPavpbYgEr/b0YL8/2GO3xJEhInFmhKMUnEJQjZumK7KXGFhUy89PrsJWlakBVg=="],

    "color-convert": ["color-convert@2.0.1", "", { "dependencies": { "color-name": "~1.1.4" } }, "sha512-RRECPsj7iu/xb5oKYcsFHSppFNnsj/52OVTRKb4zP5onXwVF3zVmmToNcOfGC+CRDpfK/U584fMg38ZHCaElKQ=="],

    "color-name": ["color-name@1.1.4", "", {}, "sha512-dOy+3AuW3a2wNbZHIuMZpTcgjGuLU/uBL/ubcZF9OXbDo8ff4O8yVp5Bf0efS8uEoYo5q4Fx7dY9OgQGXgAsQA=="],

    "commander": ["commander@14.0.2", "", {}, "sha512-TywoWNNRbhoD0BXs1P3ZEScW8W5iKrnbithIl0YH+uCmBd0QpPOA8yc82DS3BIE5Ma6FnBVUsJ7wVUDz4dvOWQ=="],

    "concat-map": ["concat-map@0.0.1", "", {}, "sha512-/Srv4dswyQNBfohGpz9o6Yb3Gz3SrUDqBH5rTuhGR7ahtlbYKnVxw2bCFMRljaA7EXHaXZ8wsHdodFvbkhKmqg=="],

    "cross-spawn": ["cross-spawn@7.0.6", "", { "dependencies": { "path-key": "^3.1.0", "shebang-command": "^2.0.0", "which": "^2.0.1" } }, "sha512-uV2QOWP2nWzsy2aMp8aRibhi9dlzF5Hgh5SHaB9OiTGEyDTiJJyx0uy51QXdyWbtAHNua4XJzUKca3OzKUd3vA=="],

    "debug": ["debug@4.4.3", "", { "dependencies": { "ms": "^2.1.3" } }, "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA=="],

    "decompress-response": ["decompress-response@6.0.0", "", { "dependencies": { "mimic-response": "^3.1.0" } }, "sha512-aW35yZM6Bb/4oJlZncMH2LCoZtJXTRxES17vE3hoRiowU2kWHaJKFkSBDnDR+cm9J+9QhXmREyIfv0pji9ejCQ=="],

    "deep-extend": ["deep-extend@0.6.0", "", {}, "sha512-LOHxIOaPYdHlJRtCQfDIVZtfw/ufM8+rVj649RIHzcm/vGwQRXFt6OPqIFWsm2XEMrNIEtWR64sY1LEKD2vAOA=="],

    "deep-is": ["deep-is@0.1.4", "", {}, "sha512-oIPzksmTg4/MriiaYGO+okXDT7ztn/w3Eptv/+gSIdMdKsJo0u4CfYNFJPy+4SKMuCqGw2wxnA+URMg3t8a/bQ=="],

    "detect-libc": ["detect-libc@2.1.2", "", {}, "sha512-Btj2BOOO83o3WyH59e8MgXsxEQVcarkUOpEYrubB0urwnN10yQ364rsiByU11nZlqWYZm05i/of7io4mzihBtQ=="],

    "end-of-stream": ["end-of-stream@1.4.5", "", { "dependencies": { "once": "^1.4.0" } }, "sha512-ooEGc6HP26xXq/N+GCGOT0JKCLDGrq2bQUZrQ7gyrJiZANJ/8YDTxTpQBXGMn+WbIQXNVpyWymm7KYVICQnyOg=="],

    "escape-string-regexp": ["escape-string-regexp@4.0.0", "", {}, "sha512-TtpcNJ3XAzx3Gq8sWRzJaVajRs0uVxA2YAkdb1jm2YkPz4G6egUFAyA3n5vtEIZefPk5Wa4UXbKuS5fKkJWdgA=="],

    "eslint": ["eslint@9.39.1", "", { "dependencies": { "@eslint-community/eslint-utils": "^4.8.0", "@eslint-community/regexpp": "^4.12.1", "@eslint/config-array": "^0.21.1", "@eslint/config-helpers": "^0.4.2", "@eslint/core": "^0.17.0", "@eslint/eslintrc": "^3.3.1", "@eslint/js": "9.39.1", "@eslint/plugin-kit": "^0.4.1", "@humanfs/node": "^0.16.6", "@humanwhocodes/module-importer": "^1.0.1", "@humanwhocodes/retry": "^0.4.2", "@types/estree": "^1.0.6", "ajv": "^6.12.4", "chalk": "^4.0.0", "cross-spawn": "^7.0.6", "debug": "^4.3.2", "escape-string-regexp": "^4.0.0", "eslint-scope": "^8.4.0", "eslint-visitor-keys": "^4.2.1", "espree": "^10.4.0", "esquery": "^1.5.0", "esutils": "^2.0.2", "fast-deep-equal": "^3.1.3", "file-entry-cache": "^8.0.0", "find-up": "^5.0.0", "glob-parent": "^6.0.2", "ignore": "^5.2.0", "imurmurhash": "^0.1.4", "is-glob": "^4.0.0", "json-stable-stringify-without-jsonify": "^1.0.1", "lodash.merge": "^4.6.2", "minimatch": "^3.1.2", "natural-compare": "^1.4.0", "optionator": "^0.9.3" }, "peerDependencies": { "jiti": "*" }, "optionalPeers": ["jiti"], "bin": "bin/eslint.js" }, "sha512-BhHmn2yNOFA9H9JmmIVKJmd288g9hrVRDkdoIgRCRuSySRUHH7r/DI6aAXW9T1WwUuY3DFgrcaqB+deURBLR5g=="],

    "eslint-scope": ["eslint-scope@8.4.0", "", { "dependencies": { "esrecurse": "^4.3.0", "estraverse": "^5.2.0" } }, "sha512-sNXOfKCn74rt8RICKMvJS7XKV/Xk9kA7DyJr8mJik3S7Cwgy3qlkkmyS2uQB3jiJg6VNdZd/pDBJu0nvG2NlTg=="],

    "eslint-visitor-keys": ["eslint-visitor-keys@4.2.1", "", {}, "sha512-Uhdk5sfqcee/9H/rCOJikYz67o0a2Tw2hGRPOG2Y1R2dg7brRe1uG0yaNQDHu+TO/uQPF/5eCapvYSmHUjt7JQ=="],

    "espree": ["espree@10.4.0", "", { "dependencies": { "acorn": "^8.15.0", "acorn-jsx": "^5.3.2", "eslint-visitor-keys": "^4.2.1" } }, "sha512-j6PAQ2uUr79PZhBjP5C5fhl8e39FmRnOjsD5lGnWrFU8i2G776tBK7+nP8KuQUTTyAZUwfQqXAgrVH5MbH9CYQ=="],

    "esquery": ["esquery@1.6.0", "", { "dependencies": { "estraverse": "^5.1.0" } }, "sha512-ca9pw9fomFcKPvFLXhBKUK90ZvGibiGOvRJNbjljY7s7uq/5YO4BOzcYtJqExdx99rF6aAcnRxHmcUHcz6sQsg=="],

    "esrecurse": ["esrecurse@4.3.0", "", { "dependencies": { "estraverse": "^5.2.0" } }, "sha512-KmfKL3b6G+RXvP8N1vr3Tq1kL/oCFgn2NYXEtqP8/L3pKapUA4G8cFVaoF3SU323CD4XypR/ffioHmkti6/Tag=="],

    "estraverse": ["estraverse@5.3.0", "", {}, "sha512-MMdARuVEQziNTeJD8DgMqmhwR11BRQ/cBP+pLtYdSTnf3MIO8fFeiINEbX36ZdNlfU/7A9f3gUw49B3oQsvwBA=="],

    "esutils": ["esutils@2.0.3", "", {}, "sha512-kVscqXk4OCp68SZ0dkgEKVi6/8ij300KBWTJq32P/dYeWTSwK41WyTxalN1eRmA5Z9UU/LX9D7FWSmV9SAYx6g=="],

    "expand-template": ["expand-template@2.0.3", "", {}, "sha512-XYfuKMvj4O35f/pOXLObndIRvyQ+/+6AhODh+OKWj9S9498pHHn/IMszH+gt0fBCRWMNfk1ZSp5x3AifmnI2vg=="],

    "fast-deep-equal": ["fast-deep-equal@3.1.3", "", {}, "sha512-f3qQ9oQy9j2AhBe/H9VC91wLmKBCCU/gDOnKNAYG5hswO7BLKj09Hc5HYNz9cGI++xlpDCIgDaitVs03ATR84Q=="],

    "fast-json-stable-stringify": ["fast-json-stable-stringify@2.1.0", "", {}, "sha512-lhd/wF+Lk98HZoTCtlVraHtfh5XYijIjalXck7saUtuanSDyLMxnHhSXEDJqHxD7msR8D0uCmqlkwjCV8xvwHw=="],

    "fast-levenshtein": ["fast-levenshtein@2.0.6", "", {}, "sha512-DCXu6Ifhqcks7TZKY3Hxp3y6qphY5SJZmrWMDrKcERSOXWQdMhU9Ig/PYrzyw/ul9jOIyh0N4M0tbC5hodg8dw=="],

    "fdir": ["fdir@6.5.0", "", { "peerDependencies": { "picomatch": "^3 || ^4" } }, "sha512-tIbYtZbucOs0BRGqPJkshJUYdL+SDH7dVM8gjy+ERp3WAUjLEFJE+02kanyHtwjWOnwrKYBiwAmM0p4kLJAnXg=="],

    "file-entry-cache": ["file-entry-cache@8.0.0", "", { "dependencies": { "flat-cache": "^4.0.0" } }, "sha512-XXTUwCvisa5oacNGRP9SfNtYBNAMi+RPwBFmblZEF7N7swHYQS6/Zfk7SRwx4D5j3CH211YNRco1DEMNVfZCnQ=="],

    "file-uri-to-path": ["file-uri-to-path@1.0.0", "", {}, "sha512-0Zt+s3L7Vf1biwWZ29aARiVYLx7iMGnEUl9x33fbB/j3jR81u/O2LbqK+Bm1CDSNDKVtJ/YjwY7TUd5SkeLQLw=="],

    "find-up": ["find-up@5.0.0", "", { "dependencies": { "locate-path": "^6.0.0", "path-exists": "^4.0.0" } }, "sha512-78/PXT1wlLLDgTzDs7sjq9hzz0vXD+zn+7wypEe4fXQxCmdmqfGsEPQxmiCSQI3ajFV91bVSsvNtrJRiW6nGng=="],

    "flat-cache": ["flat-cache@4.0.1", "", { "dependencies": { "flatted": "^3.2.9", "keyv": "^4.5.4" } }, "sha512-f7ccFPK3SXFHpx15UIGyRJ/FJQctuKZ0zVuN3frBo4HnK3cay9VEW0R6yPYFHC0AgqhukPzKjq22t5DmAyqGyw=="],

    "flatted": ["flatted@3.3.3", "", {}, "sha512-GX+ysw4PBCz0PzosHDepZGANEuFCMLrnRTiEy9McGjmkCQYwRq4A/X786G/fjM/+OjsWSU1ZrY5qyARZmO/uwg=="],

    "frida": ["frida@17.5.2", "", { "dependencies": { "bindings": "^1.5.0", "minimatch": "^10.0.1", "prebuild-install": "^7.1.3" } }, "sha512-cNnHcf1DeO8UK4ebYHKwpSornE1cwajYS76Uu5aYkz4DiEkDpFtZw5sL6ABU5kK5ujAuxczcyV52ThbfWjs2WQ=="],

    "frida-compile": ["frida-compile@19.0.4", "", { "dependencies": { "chalk": "^5.4.1", "commander": "^14.0.0", "frida": "^17.1.2" }, "bin": { "frida-compile": "dist/cli.js" } }, "sha512-QGTHsV65HDI+z9etpzJLammqMBDN1TItZxiVTxU6HDPgfIshbIkzpbF8khHuxn1cIxtWYsd+DgtW7UlMTaB76A=="],

    "frida-java-bridge": ["frida-java-bridge@7.0.10", "", {}, "sha512-AtjgAHE7a2wV6M/8tZvjVqda0T8YGmSoXqkbD0r1Eq6XTFDKYbClKbZqMYHpI9OjxtkIx+xPqkHWWE3+0fDH7w=="],

    "frida-objc-bridge": ["frida-objc-bridge@8.0.5", "", {}, "sha512-0xnL0VgxSQXgLj3S33S0kdAvLrCHSCIZb9HVraEgEyKnf9wOcu0KZ9fI5xzx0e0y+ry/g2Vl3yw9j3dsn92Ffg=="],

    "frida-remote-stream": ["frida-remote-stream@6.0.3", "", { "dependencies": { "tiny-typed-emitter": "^2.1.0" } }, "sha512-RDWCKdKJOj/nqPMJ8r6YEd4dbLyTQBqwCR1OLy0mwFi1R/rTWS0EIs3UeG0cKIEW3OaDpgGL4IQ7ecDxpgIQ3w=="],

    "frida-swift-bridge": ["frida-swift-bridge@3.0.2", "", {}, "sha512-7rfr10t/F3JMBtmfc92462lWhxEmKFP8Wz4z5v2rR0Ni/05+q1TaNoSnrVlwm9hWe0BxVQFr9LfWo3MnG8YGnA=="],

    "fs-constants": ["fs-constants@1.0.0", "", {}, "sha512-y6OAwoSIf7FyjMIv94u+b5rdheZEjzR63GTyZJm5qh4Bi+2YgwLCcI/fPFZkL5PSixOt6ZNKm+w+Hfp/Bciwow=="],

    "github-from-package": ["github-from-package@0.0.0", "", {}, "sha512-SyHy3T1v2NUXn29OsWdxmK6RwHD+vkj3v8en8AOBZ1wBQ/hCAQ5bAQTD02kW4W9tUp/3Qh6J8r9EvntiyCmOOw=="],

    "glob-parent": ["glob-parent@6.0.2", "", { "dependencies": { "is-glob": "^4.0.3" } }, "sha512-XxwI8EOhVQgWp6iDL+3b0r86f4d6AX6zSU55HfB4ydCEuXLXc5FcYeOu+nnGftS4TEju/11rt4KJPTMgbfmv4A=="],

    "globals": ["globals@14.0.0", "", {}, "sha512-oahGvuMGQlPw/ivIYBjVSrWAfWLBeku5tpPE2fOPLi+WHffIWbuh2tCjhyQhTBPMf5E9jDEH4FOmTYgYwbKwtQ=="],

    "graphemer": ["graphemer@1.4.0", "", {}, "sha512-EtKwoO6kxCL9WO5xipiHTZlSzBm7WLT627TqC/uVRd0HKmq8NXyebnNYxDoBi7wt8eTWrUrKXCOVaFq9x1kgag=="],

    "has-flag": ["has-flag@4.0.0", "", {}, "sha512-EykJT/Q1KjTWctppgIAgfSO0tKVuZUjhgMr17kqTumMl6Afv3EISleU7qZUzoXDFTAHTDC4NOoG/ZxU3EvlMPQ=="],

    "ieee754": ["ieee754@1.2.1", "", {}, "sha512-dcyqhDvX1C46lXZcVqCpK+FtMRQVdIMN6/Df5js2zouUsqG7I6sFxitIC+7KYK29KdXOLHdu9zL4sFnoVQnqaA=="],

    "ignore": ["ignore@7.0.5", "", {}, "sha512-Hs59xBNfUIunMFgWAbGX5cq6893IbWg4KnrjbYwX3tx0ztorVgTDA6B2sxf8ejHJ4wz8BqGUMYlnzNBer5NvGg=="],

    "import-fresh": ["import-fresh@3.3.1", "", { "dependencies": { "parent-module": "^1.0.0", "resolve-from": "^4.0.0" } }, "sha512-TR3KfrTZTYLPB6jUjfx6MF9WcWrHL9su5TObK4ZkYgBdWKPOFoSoQIdEuTuR82pmtxH2spWG9h6etwfr1pLBqQ=="],

    "imurmurhash": ["imurmurhash@0.1.4", "", {}, "sha512-JmXMZ6wuvDmLiHEml9ykzqO6lwFbof0GG4IkcGaENdCRDDmMVnny7s5HsIgHCbaq0w2MyPhDqkhTUgS2LU2PHA=="],

    "inherits": ["inherits@2.0.4", "", {}, "sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ=="],

    "ini": ["ini@1.3.8", "", {}, "sha512-JV/yugV2uzW5iMRSiZAyDtQd+nxtUnjeLt0acNdw98kKLrvuRVyB80tsREOE7yvGVgalhZ6RNXCmEHkUKBKxew=="],

    "is-extglob": ["is-extglob@2.1.1", "", {}, "sha512-SbKbANkN603Vi4jEZv49LeVJMn4yGwsbzZworEoyEiutsN3nJYdbO36zfhGJ6QEDpOZIFkDtnq5JRxmvl3jsoQ=="],

    "is-glob": ["is-glob@4.0.3", "", { "dependencies": { "is-extglob": "^2.1.1" } }, "sha512-xelSayHH36ZgE7ZWhli7pW34hNbNl8Ojv5KVmkJD4hBdD3th8Tfk9vYasLM+mXWOZhFkgZfxhLSnrwRr4elSSg=="],

    "isexe": ["isexe@2.0.0", "", {}, "sha512-RHxMLp9lnKHGHRng9QFhRCMbYAcVpn69smSGcq3f36xjgVVWThj4qqLbTLlq7Ssj8B+fIQ1EuCEGI2lKsyQeIw=="],

    "js-yaml": ["js-yaml@4.1.1", "", { "dependencies": { "argparse": "^2.0.1" }, "bin": "bin/js-yaml.js" }, "sha512-qQKT4zQxXl8lLwBtHMWwaTcGfFOZviOJet3Oy/xmGk2gZH677CJM9EvtfdSkgWcATZhj/55JZ0rmy3myCT5lsA=="],

    "json-buffer": ["json-buffer@3.0.1", "", {}, "sha512-4bV5BfR2mqfQTJm+V5tPPdf+ZpuhiIvTuAB5g8kcrXOZpTT/QwwVRWBywX1ozr6lEuPdbHxwaJlm9G6mI2sfSQ=="],

    "json-schema-traverse": ["json-schema-traverse@0.4.1", "", {}, "sha512-xbbCH5dCYU5T8LcEhhuh7HJ88HXuW3qsI3Y0zOZFKfZEHcpWiHU/Jxzk629Brsab/mMiHQti9wMP+845RPe3Vg=="],

    "json-stable-stringify-without-jsonify": ["json-stable-stringify-without-jsonify@1.0.1", "", {}, "sha512-Bdboy+l7tA3OGW6FjyFHWkP5LuByj1Tk33Ljyq0axyzdk9//JSi2u3fP1QSmd1KNwq6VOKYGlAu87CisVir6Pw=="],

    "keyv": ["keyv@4.5.4", "", { "dependencies": { "json-buffer": "3.0.1" } }, "sha512-oxVHkHR/EJf2CNXnWxRLW6mg7JyCCUcG0DtEGmL2ctUo1PNTin1PUil+r/+4r5MpVgC/fn1kjsx7mjSujKqIpw=="],

    "levn": ["levn@0.4.1", "", { "dependencies": { "prelude-ls": "^1.2.1", "type-check": "~0.4.0" } }, "sha512-+bT2uH4E5LGE7h/n3evcS/sQlJXCpIp6ym8OWJ5eV6+67Dsql/LaaT7qJBAt2rzfoa/5QBGBhxDix1dMt2kQKQ=="],

    "locate-path": ["locate-path@6.0.0", "", { "dependencies": { "p-locate": "^5.0.0" } }, "sha512-iPZK6eYjbxRu3uB4/WZ3EsEIMJFMqAoopl3R+zuq0UjcAm/MO6KCweDgPfP3elTztoKP3KtnVHxTn2NHBSDVUw=="],

    "lodash.merge": ["lodash.merge@4.6.2", "", {}, "sha512-0KpjqXRVvrYyCsX1swR/XTK0va6VQkQM6MNo7PqW77ByjAhoARA8EfrP1N4+KlKj8YS0ZUCtRT/YUuhyYDujIQ=="],

    "mimic-response": ["mimic-response@3.1.0", "", {}, "sha512-z0yWI+4FDrrweS8Zmt4Ej5HdJmky15+L2e6Wgn3+iK5fWzb6T3fhNFq2+MeTRb064c6Wr4N/wv0DzQTjNzHNGQ=="],

    "minimatch": ["minimatch@3.1.2", "", { "dependencies": { "brace-expansion": "^1.1.7" } }, "sha512-J7p63hRiAjw1NDEww1W7i37+ByIrOWO5XQQAzZ3VOcL0PNybwpfmV/N05zFAzwQ9USyEcX6t3UO+K5aqBQOIHw=="],

    "minimist": ["minimist@1.2.8", "", {}, "sha512-2yyAR8qBkN3YuheJanUpWC5U3bb5osDywNB8RzDVlDwDHbocAJveqqj1u8+SVD7jkWT4yvsHCpWqqWqAxb0zCA=="],

    "mkdirp-classic": ["mkdirp-classic@0.5.3", "", {}, "sha512-gKLcREMhtuZRwRAfqP3RFW+TK4JqApVBtOIftVgjuABpAtpxhPGaDcfvbhNvD0B8iD1oUr/txX35NjcaY6Ns/A=="],

    "ms": ["ms@2.1.3", "", {}, "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA=="],

    "napi-build-utils": ["napi-build-utils@2.0.0", "", {}, "sha512-GEbrYkbfF7MoNaoh2iGG84Mnf/WZfB0GdGEsM8wz7Expx/LlWf5U8t9nvJKXSp3qr5IsEbK04cBGhol/KwOsWA=="],

    "natural-compare": ["natural-compare@1.4.0", "", {}, "sha512-OWND8ei3VtNC9h7V60qff3SVobHr996CTwgxubgyQYEpg290h9J0buyECNNJexkFm5sOajh5G116RYA1c8ZMSw=="],

    "node-abi": ["node-abi@3.86.0", "", { "dependencies": { "semver": "^7.3.5" } }, "sha512-sn9Et4N3ynsetj3spsZR729DVlGH6iBG4RiDMV7HEp3guyOW6W3S0unGpLDxT50mXortGUMax/ykUNQXdqc/Xg=="],

    "once": ["once@1.4.0", "", { "dependencies": { "wrappy": "1" } }, "sha512-lNaJgI+2Q5URQBkccEKHTQOPaXdUxnZZElQTZY0MFUAuaEqe1E+Nyvgdz/aIyNi6Z9MzO5dv1H8n58/GELp3+w=="],

    "optionator": ["optionator@0.9.4", "", { "dependencies": { "deep-is": "^0.1.3", "fast-levenshtein": "^2.0.6", "levn": "^0.4.1", "prelude-ls": "^1.2.1", "type-check": "^0.4.0", "word-wrap": "^1.2.5" } }, "sha512-6IpQ7mKUxRcZNLIObR0hz7lxsapSSIYNZJwXPGeF0mTVqGKFIXj1DQcMoT22S3ROcLyY/rz0PWaWZ9ayWmad9g=="],

    "p-limit": ["p-limit@3.1.0", "", { "dependencies": { "yocto-queue": "^0.1.0" } }, "sha512-TYOanM3wGwNGsZN2cVTYPArw454xnXj5qmWF1bEoAc4+cU/ol7GVh7odevjp1FNHduHc3KZMcFduxU5Xc6uJRQ=="],

    "p-locate": ["p-locate@5.0.0", "", { "dependencies": { "p-limit": "^3.0.2" } }, "sha512-LaNjtRWUBY++zB5nE/NwcaoMylSPk+S+ZHNB1TzdbMJMny6dynpAGt7X/tl/QYq3TIeE6nxHppbo2LGymrG5Pw=="],

    "parent-module": ["parent-module@1.0.1", "", { "dependencies": { "callsites": "^3.0.0" } }, "sha512-GQ2EWRpQV8/o+Aw8YqtfZZPfNRWZYkbidE9k5rpl/hC3vtHHBfGm2Ifi6qWV+coDGkrUKZAxE3Lot5kcsRlh+g=="],

    "path-exists": ["path-exists@4.0.0", "", {}, "sha512-ak9Qy5Q7jYb2Wwcey5Fpvg2KoAc/ZIhLSLOSBmRmygPsGwkVVt0fZa0qrtMz+m6tJTAHfZQ8FnmB4MG4LWy7/w=="],

    "path-key": ["path-key@3.1.1", "", {}, "sha512-ojmeN0qd+y0jszEtoY48r0Peq5dwMEkIlCOu6Q5f41lfkswXuKtYrhgoTpLnyIcHm24Uhqx+5Tqm2InSwLhE6Q=="],

    "picomatch": ["picomatch@4.0.3", "", {}, "sha512-5gTmgEY/sqK6gFXLIsQNH19lWb4ebPDLA4SdLP7dsWkIXHWlG66oPuVvXSGFPppYZz8ZDZq0dYYrbHfBCVUb1Q=="],

    "prebuild-install": ["prebuild-install@7.1.3", "", { "dependencies": { "detect-libc": "^2.0.0", "expand-template": "^2.0.3", "github-from-package": "0.0.0", "minimist": "^1.2.3", "mkdirp-classic": "^0.5.3", "napi-build-utils": "^2.0.0", "node-abi": "^3.3.0", "pump": "^3.0.0", "rc": "^1.2.7", "simple-get": "^4.0.0", "tar-fs": "^2.0.0", "tunnel-agent": "^0.6.0" }, "bin": { "prebuild-install": "bin.js" } }, "sha512-8Mf2cbV7x1cXPUILADGI3wuhfqWvtiLA1iclTDbFRZkgRQS0NqsPZphna9V+HyTEadheuPmjaJMsbzKQFOzLug=="],

    "prelude-ls": ["prelude-ls@1.2.1", "", {}, "sha512-vkcDPrRZo1QZLbn5RLGPpg/WmIQ65qoWWhcGKf/b5eplkkarX0m9z8ppCat4mlOqUsWpyNuYgO3VRyrYHSzX5g=="],

    "pump": ["pump@3.0.3", "", { "dependencies": { "end-of-stream": "^1.1.0", "once": "^1.3.1" } }, "sha512-todwxLMY7/heScKmntwQG8CXVkWUOdYxIvY2s0VWAAMh/nd8SoYiRaKjlr7+iCs984f2P8zvrfWcDDYVb73NfA=="],

    "punycode": ["punycode@2.3.1", "", {}, "sha512-vYt7UD1U9Wg6138shLtLOvdAu+8DsC/ilFtEVHcH+wydcSpNE20AfSOduf6MkRFahL5FY7X1oU7nKVZFtfq8Fg=="],

    "rc": ["rc@1.2.8", "", { "dependencies": { "deep-extend": "^0.6.0", "ini": "~1.3.0", "minimist": "^1.2.0", "strip-json-comments": "~2.0.1" }, "bin": { "rc": "./cli.js" } }, "sha512-y3bGgqKj3QBdxLbLkomlohkvsA8gdAiUQlSBJnBhfn+BPxg4bc62d8TcBW15wavDfgexCgccckhcZvywyQYPOw=="],

    "readable-stream": ["readable-stream@3.6.2", "", { "dependencies": { "inherits": "^2.0.3", "string_decoder": "^1.1.1", "util-deprecate": "^1.0.1" } }, "sha512-9u/sniCrY3D5WdsERHzHE4G2YCXqoG5FTHUiCC4SIbr6XcLZBY05ya9EKjYek9O5xOAwjGq+1JdGBAS7Q9ScoA=="],

    "resolve-from": ["resolve-from@4.0.0", "", {}, "sha512-pb/MYmXstAkysRFx8piNI1tGFNQIFA3vkE3Gq4EuA1dF6gHp/+vgZqsCGJapvy8N3Q+4o7FwvquPJcnZ7RYy4g=="],

    "safe-buffer": ["safe-buffer@5.2.1", "", {}, "sha512-rp3So07KcdmmKbGvgaNxQSJr7bGVSVk5S9Eq1F+ppbRo70+YeaDxkw5Dd8NPN+GD6bjnYm2VuPuCXmpuYvmCXQ=="],

    "semver": ["semver@7.7.3", "", { "bin": "bin/semver.js" }, "sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q=="],

    "shebang-command": ["shebang-command@2.0.0", "", { "dependencies": { "shebang-regex": "^3.0.0" } }, "sha512-kHxr2zZpYtdmrN1qDjrrX/Z1rR1kG8Dx+gkpK1G4eXmvXswmcE1hTWBWYUzlraYw1/yZp6YuDY77YtvbN0dmDA=="],

    "shebang-regex": ["shebang-regex@3.0.0", "", {}, "sha512-7++dFhtcx3353uBaq8DDR4NuxBetBzC7ZQOhmTQInHEd6bSrXdiEyzCvG07Z44UYdLShWUyXt5M/yhz8ekcb1A=="],

    "simple-concat": ["simple-concat@1.0.1", "", {}, "sha512-cSFtAPtRhljv69IK0hTVZQ+OfE9nePi/rtJmw5UjHeVyVroEqJXP1sFztKUy1qU+xvz3u/sfYJLa947b7nAN2Q=="],

    "simple-get": ["simple-get@4.0.1", "", { "dependencies": { "decompress-response": "^6.0.0", "once": "^1.3.1", "simple-concat": "^1.0.0" } }, "sha512-brv7p5WgH0jmQJr1ZDDfKDOSeWWg+OVypG99A/5vYGPqJ6pxiaHLy8nxtFjBA7oMa01ebA9gfh1uMCFqOuXxvA=="],

    "string_decoder": ["string_decoder@1.3.0", "", { "dependencies": { "safe-buffer": "~5.2.0" } }, "sha512-hkRX8U1WjJFd8LsDJ2yQ/wWWxaopEsABU1XfkM8A+j0+85JAGppt16cr1Whg6KIbb4okU6Mql6BOj+uup/wKeA=="],

    "strip-json-comments": ["strip-json-comments@3.1.1", "", {}, "sha512-6fPc+R4ihwqP6N/aIv2f1gMH8lOVtWQHoqC4yK6oSDVVocumAsfCqjkXnqiYMhmMwS/mEHLp7Vehlt3ql6lEig=="],

    "supports-color": ["supports-color@7.2.0", "", { "dependencies": { "has-flag": "^4.0.0" } }, "sha512-qpCAvRl9stuOHveKsn7HncJRvv501qIacKzQlO/+Lwxc9+0q2wLyv4Dfvt80/DPn2pqOBsJdDiogXGR9+OvwRw=="],

    "tar-fs": ["tar-fs@2.1.4", "", { "dependencies": { "chownr": "^1.1.1", "mkdirp-classic": "^0.5.2", "pump": "^3.0.0", "tar-stream": "^2.1.4" } }, "sha512-mDAjwmZdh7LTT6pNleZ05Yt65HC3E+NiQzl672vQG38jIrehtJk/J3mNwIg+vShQPcLF/LV7CMnDW6vjj6sfYQ=="],

    "tar-stream": ["tar-stream@2.2.0", "", { "dependencies": { "bl": "^4.0.3", "end-of-stream": "^1.4.1", "fs-constants": "^1.0.0", "inherits": "^2.0.3", "readable-stream": "^3.1.1" } }, "sha512-ujeqbceABgwMZxEJnk2HDY2DlnUZ+9oEcb1KzTVfYHio0UE6dG71n60d8D2I4qNvleWrrXpmjpt7vZeF1LnMZQ=="],

    "tiny-typed-emitter": ["tiny-typed-emitter@2.1.0", "", {}, "sha512-qVtvMxeXbVej0cQWKqVSSAHmKZEHAvxdF8HEUBFWts8h+xEo5m/lEiPakuyZ3BnCBjOD8i24kzNOiOLLgsSxhA=="],

    "tinyglobby": ["tinyglobby@0.2.15", "", { "dependencies": { "fdir": "^6.5.0", "picomatch": "^4.0.3" } }, "sha512-j2Zq4NyQYG5XMST4cbs02Ak8iJUdxRM0XI5QyxXuZOzKOINmWurp3smXu3y5wDcJrptwpSjgXHzIQxR0omXljQ=="],

    "ts-api-utils": ["ts-api-utils@2.1.0", "", { "peerDependencies": { "typescript": ">=4.8.4" } }, "sha512-CUgTZL1irw8u29bzrOD/nH85jqyc74D6SshFgujOIA7osm2Rz7dYH77agkx7H4FBNxDq7Cjf+IjaX/8zwFW+ZQ=="],

    "tunnel-agent": ["tunnel-agent@0.6.0", "", { "dependencies": { "safe-buffer": "^5.0.1" } }, "sha512-McnNiV1l8RYeY8tBgEpuodCC1mLUdbSN+CYBL7kJsJNInOP8UjDDEwdk6Mw60vdLLrr5NHKZhMAOSrR2NZuQ+w=="],

    "type-check": ["type-check@0.4.0", "", { "dependencies": { "prelude-ls": "^1.2.1" } }, "sha512-XleUoc9uwGXqjWwXaUTZAmzMcFZ5858QA2vvx1Ur5xIcixXIP+8LnFDgRplU30us6teqdlskFfu+ae4K79Ooew=="],

    "typescript": ["typescript@5.9.3", "", { "bin": { "tsc": "bin/tsc", "tsserver": "bin/tsserver" } }, "sha512-jl1vZzPDinLr9eUt3J/t7V6FgNEw9QjvBPdysz9KfQDD41fQrC2Y4vKQdiaUpFT4bXlb1RHhLpp8wtm6M5TgSw=="],

    "undici-types": ["undici-types@5.26.5", "", {}, "sha512-JlCMO+ehdEIKqlFxk6IfVoAUVmgz7cU7zD/h9XZ0qzeosSHmUJVOzSQvvYSYWXkFXC+IfLKSIffhv0sVZup6pA=="],

    "uri-js": ["uri-js@4.4.1", "", { "dependencies": { "punycode": "^2.1.0" } }, "sha512-7rKUyy33Q1yc98pQ1DAmLtwX109F7TIfWlW1Ydo8Wl1ii1SeHieeh0HHfPeL2fMXK6z0s8ecKs9frCuLJvndBg=="],

    "util-deprecate": ["util-deprecate@1.0.2", "", {}, "sha512-EPD5q1uXyFxJpCrLnCc1nHnq3gOa6DZBocAIiI2TaSCA7VCJ1UJDMagCzIkXNsUYfD1daK//LTEQ8xiIbrHtcw=="],

    "which": ["which@2.0.2", "", { "dependencies": { "isexe": "^2.0.0" }, "bin": { "node-which": "bin/node-which" } }, "sha512-BLI3Tl1TW3Pvl70l3yq3Y64i+awpwXqsGBYWkkqMtnbXgrMD+yj7rhW0kuEDxzJaYXGjEW5ogapKNMEKNMjibA=="],

    "word-wrap": ["word-wrap@1.2.5", "", {}, "sha512-BN22B5eaMMI9UMtjrGd5g5eCYPpCPDUy0FJXbYsaT5zYxjFOckS53SQDE3pWkVoWpHXVb3BrYcEN4Twa55B5cA=="],

    "wrappy": ["wrappy@1.0.2", "", {}, "sha512-l4Sp/DRseor9wL6EvV2+TuQn63dMkPjZ/sp9XkghTEbV9KlPS1xUsZ3u7/IQO4wxtcFB4bgpQPRcR3QCvezPcQ=="],

    "yocto-queue": ["yocto-queue@0.1.0", "", {}, "sha512-rVksvsnNCdJ/ohGc6xgPwyN8eheCxsiLM8mxuE/t/mOVqJewPuO1miLpTHQiRgTKCLexL4MeAFVagts7HmNZ2Q=="],

    "@eslint-community/eslint-utils/eslint-visitor-keys": ["eslint-visitor-keys@3.4.3", "", {}, "sha512-wpc+LXeiyiisxPlEkUzU6svyS1frIO3Mgxj1fdy7Pm8Ygzguax2N3Fa/D/ag1WqbOprdI+uY6wMUl8/a2G+iag=="],

    "@eslint/eslintrc/ignore": ["ignore@5.3.2", "", {}, "sha512-hsBTNUqQTDwkWtcdYI2i06Y/nUBEsNEDJKjWdigLvegy8kDuJAS8uRlpkkcQpyEXL0Z/pjDy5HBmMjRCJ2gq+g=="],

    "@typescript-eslint/typescript-estree/minimatch": ["minimatch@9.0.5", "", { "dependencies": { "brace-expansion": "^2.0.1" } }, "sha512-G6T0ZX48xgozx7587koeX9Ys2NYy6Gmv//P89sEte9V9whIapMNF4idKxnW2QtCcLiTWlb/wfCabAtAFWhhBow=="],

    "eslint/ignore": ["ignore@5.3.2", "", {}, "sha512-hsBTNUqQTDwkWtcdYI2i06Y/nUBEsNEDJKjWdigLvegy8kDuJAS8uRlpkkcQpyEXL0Z/pjDy5HBmMjRCJ2gq+g=="],

    "frida/minimatch": ["minimatch@10.1.1", "", { "dependencies": { "@isaacs/brace-expansion": "^5.0.0" } }, "sha512-enIvLvRAFZYXJzkCYG5RKmPfrFArdLv+R+lbQ53BmIMLIry74bjKzX6iHAm8WYamJkhSSEabrWN5D97XnKObjQ=="],

    "frida-compile/chalk": ["chalk@5.6.2", "", {}, "sha512-7NzBL0rN6fMUW+f7A6Io4h40qQlG+xGmtMxfbnH/K7TAtt8JQWVQK+6g0UXKMeVJoyV5EkkNsErQ8pVD3bLHbA=="],

    "rc/strip-json-comments": ["strip-json-comments@2.0.1", "", {}, "sha512-4gB8na07fecVVkOI6Rs4e7T6NOTki5EmL7TUduTs6bu3EdnSycntVJ4re8kgZA+wx9IueI2Y11bfbgwtzuE0KQ=="],

    "@typescript-eslint/typescript-estree/minimatch/brace-expansion": ["brace-expansion@2.0.2", "", { "dependencies": { "balanced-match": "^1.0.0" } }, "sha512-Jt0vHyM+jmUBqojB7E1NIYadt0vI0Qxjxd2TErW94wDz+E2LAm5vKMXXwg6ZZBTHPuUlDgQHKXvjGBdfcF1ZDQ=="],
  }
}

```

`agent/eslint.config.js`:

```js
/**
 * ESLint Configuration for Banning Specific Nested Methods
 *
 * This file uses the 'no-restricted-syntax' rule to ban specific property
 * accesses and function calls, which is necessary for blocking nested
 * names like 'Memory.read' or 'Module.getBaseAddress()'.
 */
import tseslint from "@typescript-eslint/eslint-plugin";
import tsparser from "@typescript-eslint/parser";

export default [
  {
    files: ["src/**/*.ts"],

    languageOptions: {
      ecmaVersion: 2020,
      sourceType: "module",
      parser: tsparser,
    },

    plugins: {
      "@typescript-eslint": tseslint,
    },

    rules: {
      // TypeScript recommended rules
      ...tseslint.configs.recommended.rules,

      // --- Core Ban Logic ---
      "no-restricted-syntax": [
        "error",

        // 1. Ban 'Memory.read' access
        {
          // Selects any MemberExpression where the object is 'Memory' and the property is 'read'.
          // This catches both 'Memory.read' as a variable/property and 'Memory.read()' as a call.
          selector:
            "MemberExpression[object.name='Memory'][property.name='read']",
          message:
            "The use of 'Memory.read' is strictly forbidden for security or architectural reasons.",
        },

        // 2. Ban specific function calls on the 'Module' object
        {
          // Selects CallExpression nodes where the function being called (callee) is a MemberExpression,
          // the object of that expression is 'Module', and the property is one of the banned names.
          selector: `CallExpression[callee.object.name='Module'][callee.property.name=/^(ensureInitialized|findBaseAddress|getBaseAddress|findExportByName|getExportByName|findSymbolByName|getSymbolByName)$/]`,
          message:
            "Direct calls to Module's memory/symbol resolution functions are forbidden.",
        },

        // 3. Ban specific property access on the 'Module' object (in case they are not called)
        {
          // This catches references to the functions without the parentheses, e.g., 'const fn = Module.getBaseAddress;'
          selector: `MemberExpression[object.name='Module'][property.name=/^(ensureInitialized|findBaseAddress|getBaseAddress|findExportByName|getExportByName|findSymbolByName|getSymbolByName)$/]`,
          message:
            "Referencing Module's memory/symbol resolution functions is forbidden.",
        },
      ],
      // Disable rules that might conflict with the banned functions if they are part of a large library
      "@typescript-eslint/no-unused-vars": "off",
      "no-undef": "off",
    },
  },
];

```

`agent/package-lock.json`:

```json
{
  "name": "igf-agent",
  "version": "1.0.0",
  "lockfileVersion": 3,
  "requires": true,
  "packages": {
    "": {
      "name": "igf-agent",
      "version": "1.0.0",
      "dependencies": {
        "frida-java-bridge": "^7.0.10",
        "frida-objc-bridge": "^8.0.5",
        "frida-remote-stream": "^6.0.3",
        "frida-swift-bridge": "^3.0.2"
      },
      "devDependencies": {
        "@types/frida-gum": "^19.0.1",
        "@types/node": "^18.14.0",
        "@typescript-eslint/eslint-plugin": "^8.48.0",
        "@typescript-eslint/parser": "^8.48.0",
        "@typescript/native-preview": "7.0.0-dev.20251108.1",
        "eslint": "^9.39.1",
        "frida-compile": "^19.0.4"
      },
      "engines": {
        "node": ">=22.18.0"
      }
    },
    "node_modules/@eslint-community/eslint-utils": {
      "version": "4.9.0",
      "resolved": "https://registry.npmjs.org/@eslint-community/eslint-utils/-/eslint-utils-4.9.0.tgz",
      "integrity": "sha512-ayVFHdtZ+hsq1t2Dy24wCmGXGe4q9Gu3smhLYALJrr473ZH27MsnSL+LKUlimp4BWJqMDMLmPpx/Q9R3OAlL4g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "eslint-visitor-keys": "^3.4.3"
      },
      "engines": {
        "node": "^12.22.0 || ^14.17.0 || >=16.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint"
      },
      "peerDependencies": {
        "eslint": "^6.0.0 || ^7.0.0 || >=8.0.0"
      }
    },
    "node_modules/@eslint-community/regexpp": {
      "version": "4.12.2",
      "resolved": "https://registry.npmjs.org/@eslint-community/regexpp/-/regexpp-4.12.2.tgz",
      "integrity": "sha512-EriSTlt5OC9/7SXkRSCAhfSxxoSUgBm33OH+IkwbdpgoqsSsUg7y3uh+IICI/Qg4BBWr3U2i39RpmycbxMq4ew==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": "^12.0.0 || ^14.0.0 || >=16.0.0"
      }
    },
    "node_modules/@eslint/config-array": {
      "version": "0.21.1",
      "resolved": "https://registry.npmjs.org/@eslint/config-array/-/config-array-0.21.1.tgz",
      "integrity": "sha512-aw1gNayWpdI/jSYVgzN5pL0cfzU02GT3NBpeT/DXbx1/1x7ZKxFPd9bwrzygx/qiwIQiJ1sw/zD8qY/kRvlGHA==",
      "dev": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@eslint/object-schema": "^2.1.7",
        "debug": "^4.3.1",
        "minimatch": "^3.1.2"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      }
    },
    "node_modules/@eslint/config-array/node_modules/brace-expansion": {
      "version": "1.1.12",
      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-1.1.12.tgz",
      "integrity": "sha512-9T9UjW3r0UW5c1Q7GTwllptXwhvYmEzFhzMfZ9H7FQWt+uZePjZPjBP/W1ZEyZ1twGWom5/56TF4lPcqjnDHcg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "balanced-match": "^1.0.0",
        "concat-map": "0.0.1"
      }
    },
    "node_modules/@eslint/config-array/node_modules/minimatch": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-3.1.2.tgz",
      "integrity": "sha512-J7p63hRiAjw1NDEww1W7i37+ByIrOWO5XQQAzZ3VOcL0PNybwpfmV/N05zFAzwQ9USyEcX6t3UO+K5aqBQOIHw==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "brace-expansion": "^1.1.7"
      },
      "engines": {
        "node": "*"
      }
    },
    "node_modules/@eslint/config-helpers": {
      "version": "0.4.2",
      "resolved": "https://registry.npmjs.org/@eslint/config-helpers/-/config-helpers-0.4.2.tgz",
      "integrity": "sha512-gBrxN88gOIf3R7ja5K9slwNayVcZgK6SOUORm2uBzTeIEfeVaIhOpCtTox3P6R7o2jLFwLFTLnC7kU/RGcYEgw==",
      "dev": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@eslint/core": "^0.17.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      }
    },
    "node_modules/@eslint/core": {
      "version": "0.17.0",
      "resolved": "https://registry.npmjs.org/@eslint/core/-/core-0.17.0.tgz",
      "integrity": "sha512-yL/sLrpmtDaFEiUj1osRP4TI2MDz1AddJL+jZ7KSqvBuliN4xqYY54IfdN8qD8Toa6g1iloph1fxQNkjOxrrpQ==",
      "dev": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@types/json-schema": "^7.0.15"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      }
    },
    "node_modules/@eslint/eslintrc": {
      "version": "3.3.1",
      "resolved": "https://registry.npmjs.org/@eslint/eslintrc/-/eslintrc-3.3.1.tgz",
      "integrity": "sha512-gtF186CXhIl1p4pJNGZw8Yc6RlshoePRvE0X91oPGb3vZ8pM3qOS9W9NGPat9LziaBV7XrJWGylNQXkGcnM3IQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "ajv": "^6.12.4",
        "debug": "^4.3.2",
        "espree": "^10.0.1",
        "globals": "^14.0.0",
        "ignore": "^5.2.0",
        "import-fresh": "^3.2.1",
        "js-yaml": "^4.1.0",
        "minimatch": "^3.1.2",
        "strip-json-comments": "^3.1.1"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint"
      }
    },
    "node_modules/@eslint/eslintrc/node_modules/brace-expansion": {
      "version": "1.1.12",
      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-1.1.12.tgz",
      "integrity": "sha512-9T9UjW3r0UW5c1Q7GTwllptXwhvYmEzFhzMfZ9H7FQWt+uZePjZPjBP/W1ZEyZ1twGWom5/56TF4lPcqjnDHcg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "balanced-match": "^1.0.0",
        "concat-map": "0.0.1"
      }
    },
    "node_modules/@eslint/eslintrc/node_modules/ignore": {
      "version": "5.3.2",
      "resolved": "https://registry.npmjs.org/ignore/-/ignore-5.3.2.tgz",
      "integrity": "sha512-hsBTNUqQTDwkWtcdYI2i06Y/nUBEsNEDJKjWdigLvegy8kDuJAS8uRlpkkcQpyEXL0Z/pjDy5HBmMjRCJ2gq+g==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 4"
      }
    },
    "node_modules/@eslint/eslintrc/node_modules/minimatch": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-3.1.2.tgz",
      "integrity": "sha512-J7p63hRiAjw1NDEww1W7i37+ByIrOWO5XQQAzZ3VOcL0PNybwpfmV/N05zFAzwQ9USyEcX6t3UO+K5aqBQOIHw==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "brace-expansion": "^1.1.7"
      },
      "engines": {
        "node": "*"
      }
    },
    "node_modules/@eslint/js": {
      "version": "9.39.1",
      "resolved": "https://registry.npmjs.org/@eslint/js/-/js-9.39.1.tgz",
      "integrity": "sha512-S26Stp4zCy88tH94QbBv3XCuzRQiZ9yXofEILmglYTh/Ug/a9/umqvgFtYBAo3Lp0nsI/5/qH1CCrbdK3AP1Tw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "url": "https://eslint.org/donate"
      }
    },
    "node_modules/@eslint/object-schema": {
      "version": "2.1.7",
      "resolved": "https://registry.npmjs.org/@eslint/object-schema/-/object-schema-2.1.7.tgz",
      "integrity": "sha512-VtAOaymWVfZcmZbp6E2mympDIHvyjXs/12LqWYjVw6qjrfF+VK+fyG33kChz3nnK+SU5/NeHOqrTEHS8sXO3OA==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      }
    },
    "node_modules/@eslint/plugin-kit": {
      "version": "0.4.1",
      "resolved": "https://registry.npmjs.org/@eslint/plugin-kit/-/plugin-kit-0.4.1.tgz",
      "integrity": "sha512-43/qtrDUokr7LJqoF2c3+RInu/t4zfrpYdoSDfYyhg52rwLV6TnOvdG4fXm7IkSB3wErkcmJS9iEhjVtOSEjjA==",
      "dev": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@eslint/core": "^0.17.0",
        "levn": "^0.4.1"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      }
    },
    "node_modules/@humanfs/core": {
      "version": "0.19.1",
      "resolved": "https://registry.npmjs.org/@humanfs/core/-/core-0.19.1.tgz",
      "integrity": "sha512-5DyQ4+1JEUzejeK1JGICcideyfUbGixgS9jNgex5nqkW+cY7WZhxBigmieN5Qnw9ZosSNVC9KQKyb+GUaGyKUA==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": ">=18.18.0"
      }
    },
    "node_modules/@humanfs/node": {
      "version": "0.16.7",
      "resolved": "https://registry.npmjs.org/@humanfs/node/-/node-0.16.7.tgz",
      "integrity": "sha512-/zUx+yOsIrG4Y43Eh2peDeKCxlRt/gET6aHfaKpuq267qXdYDFViVHfMaLyygZOnl0kGWxFIgsBy8QFuTLUXEQ==",
      "dev": true,
      "license": "Apache-2.0",
      "dependencies": {
        "@humanfs/core": "^0.19.1",
        "@humanwhocodes/retry": "^0.4.0"
      },
      "engines": {
        "node": ">=18.18.0"
      }
    },
    "node_modules/@humanwhocodes/module-importer": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/@humanwhocodes/module-importer/-/module-importer-1.0.1.tgz",
      "integrity": "sha512-bxveV4V8v5Yb4ncFTT3rPSgZBOpCkjfK0y4oVVVJwIuDVBRMDXrPyXRL988i5ap9m9bnyEEjWfm5WkBmtffLfA==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": ">=12.22"
      },
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/nzakas"
      }
    },
    "node_modules/@humanwhocodes/retry": {
      "version": "0.4.3",
      "resolved": "https://registry.npmjs.org/@humanwhocodes/retry/-/retry-0.4.3.tgz",
      "integrity": "sha512-bV0Tgo9K4hfPCek+aMAn81RppFKv2ySDQeMoSZuvTASywNTnVJCArCZE2FWqpvIatKu7VMRLWlR1EazvVhDyhQ==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": ">=18.18"
      },
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/nzakas"
      }
    },
    "node_modules/@isaacs/balanced-match": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/@isaacs/balanced-match/-/balanced-match-4.0.1.tgz",
      "integrity": "sha512-yzMTt9lEb8Gv7zRioUilSglI0c0smZ9k5D65677DLWLtWJaXIS3CqcGyUFByYKlnUj6TkjLVs54fBl6+TiGQDQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": "20 || >=22"
      }
    },
    "node_modules/@isaacs/brace-expansion": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/@isaacs/brace-expansion/-/brace-expansion-5.0.0.tgz",
      "integrity": "sha512-ZT55BDLV0yv0RBm2czMiZ+SqCGO7AvmOM3G/w2xhVPH+te0aKgFjmBvGlL1dH+ql2tgGO3MVrbb3jCKyvpgnxA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@isaacs/balanced-match": "^4.0.1"
      },
      "engines": {
        "node": "20 || >=22"
      }
    },
    "node_modules/@types/estree": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/@types/estree/-/estree-1.0.8.tgz",
      "integrity": "sha512-dWHzHa2WqEXI/O1E9OjrocMTKJl2mSrEolh1Iomrv6U+JuNwaHXsXx9bLu5gG7BUWFIN0skIQJQ/L1rIex4X6w==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@types/frida-gum": {
      "version": "19.0.1",
      "resolved": "https://registry.npmjs.org/@types/frida-gum/-/frida-gum-19.0.1.tgz",
      "integrity": "sha512-mp8BpWWkQFJH86ZN5uXZuDiA7KY/+jDknrw0a06x0/+F5ucPwctHrCuV6iT+LLCp/GyICc36ssedF33B1WoLsw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@types/json-schema": {
      "version": "7.0.15",
      "resolved": "https://registry.npmjs.org/@types/json-schema/-/json-schema-7.0.15.tgz",
      "integrity": "sha512-5+fP8P8MFNC+AyZCDxrB2pkZFPGzqQWUzpSeuuVLvm8VMcorNYavBqoFcxK8bQz4Qsbn4oUEEem4wDLfcysGHA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@types/node": {
      "version": "18.19.130",
      "resolved": "https://registry.npmjs.org/@types/node/-/node-18.19.130.tgz",
      "integrity": "sha512-GRaXQx6jGfL8sKfaIDD6OupbIHBr9jv7Jnaml9tB7l4v068PAOXqfcujMMo5PhbIs6ggR1XODELqahT2R8v0fg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "undici-types": "~5.26.4"
      }
    },
    "node_modules/@typescript-eslint/eslint-plugin": {
      "version": "8.48.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/eslint-plugin/-/eslint-plugin-8.48.0.tgz",
      "integrity": "sha512-XxXP5tL1txl13YFtrECECQYeZjBZad4fyd3cFV4a19LkAY/bIp9fev3US4S5fDVV2JaYFiKAZ/GRTOLer+mbyQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@eslint-community/regexpp": "^4.10.0",
        "@typescript-eslint/scope-manager": "8.48.0",
        "@typescript-eslint/type-utils": "8.48.0",
        "@typescript-eslint/utils": "8.48.0",
        "@typescript-eslint/visitor-keys": "8.48.0",
        "graphemer": "^1.4.0",
        "ignore": "^7.0.0",
        "natural-compare": "^1.4.0",
        "ts-api-utils": "^2.1.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "@typescript-eslint/parser": "^8.48.0",
        "eslint": "^8.57.0 || ^9.0.0",
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/parser": {
      "version": "8.48.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/parser/-/parser-8.48.0.tgz",
      "integrity": "sha512-jCzKdm/QK0Kg4V4IK/oMlRZlY+QOcdjv89U2NgKHZk1CYTj82/RVSx1mV/0gqCVMJ/DA+Zf/S4NBWNF8GQ+eqQ==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@typescript-eslint/scope-manager": "8.48.0",
        "@typescript-eslint/types": "8.48.0",
        "@typescript-eslint/typescript-estree": "8.48.0",
        "@typescript-eslint/visitor-keys": "8.48.0",
        "debug": "^4.3.4"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "eslint": "^8.57.0 || ^9.0.0",
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/project-service": {
      "version": "8.48.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/project-service/-/project-service-8.48.0.tgz",
      "integrity": "sha512-Ne4CTZyRh1BecBf84siv42wv5vQvVmgtk8AuiEffKTUo3DrBaGYZueJSxxBZ8fjk/N3DrgChH4TOdIOwOwiqqw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@typescript-eslint/tsconfig-utils": "^8.48.0",
        "@typescript-eslint/types": "^8.48.0",
        "debug": "^4.3.4"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/scope-manager": {
      "version": "8.48.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/scope-manager/-/scope-manager-8.48.0.tgz",
      "integrity": "sha512-uGSSsbrtJrLduti0Q1Q9+BF1/iFKaxGoQwjWOIVNJv0o6omrdyR8ct37m4xIl5Zzpkp69Kkmvom7QFTtue89YQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@typescript-eslint/types": "8.48.0",
        "@typescript-eslint/visitor-keys": "8.48.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      }
    },
    "node_modules/@typescript-eslint/tsconfig-utils": {
      "version": "8.48.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/tsconfig-utils/-/tsconfig-utils-8.48.0.tgz",
      "integrity": "sha512-WNebjBdFdyu10sR1M4OXTt2OkMd5KWIL+LLfeH9KhgP+jzfDV/LI3eXzwJ1s9+Yc0Kzo2fQCdY/OpdusCMmh6w==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/type-utils": {
      "version": "8.48.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/type-utils/-/type-utils-8.48.0.tgz",
      "integrity": "sha512-zbeVaVqeXhhab6QNEKfK96Xyc7UQuoFWERhEnj3mLVnUWrQnv15cJNseUni7f3g557gm0e46LZ6IJ4NJVOgOpw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@typescript-eslint/types": "8.48.0",
        "@typescript-eslint/typescript-estree": "8.48.0",
        "@typescript-eslint/utils": "8.48.0",
        "debug": "^4.3.4",
        "ts-api-utils": "^2.1.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "eslint": "^8.57.0 || ^9.0.0",
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/types": {
      "version": "8.48.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/types/-/types-8.48.0.tgz",
      "integrity": "sha512-cQMcGQQH7kwKoVswD1xdOytxQR60MWKM1di26xSUtxehaDs/32Zpqsu5WJlXTtTTqyAVK8R7hvsUnIXRS+bjvA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      }
    },
    "node_modules/@typescript-eslint/typescript-estree": {
      "version": "8.48.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/typescript-estree/-/typescript-estree-8.48.0.tgz",
      "integrity": "sha512-ljHab1CSO4rGrQIAyizUS6UGHHCiAYhbfcIZ1zVJr5nMryxlXMVWS3duFPSKvSUbFPwkXMFk1k0EMIjub4sRRQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@typescript-eslint/project-service": "8.48.0",
        "@typescript-eslint/tsconfig-utils": "8.48.0",
        "@typescript-eslint/types": "8.48.0",
        "@typescript-eslint/visitor-keys": "8.48.0",
        "debug": "^4.3.4",
        "minimatch": "^9.0.4",
        "semver": "^7.6.0",
        "tinyglobby": "^0.2.15",
        "ts-api-utils": "^2.1.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/utils": {
      "version": "8.48.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/utils/-/utils-8.48.0.tgz",
      "integrity": "sha512-yTJO1XuGxCsSfIVt1+1UrLHtue8xz16V8apzPYI06W0HbEbEWHxHXgZaAgavIkoh+GeV6hKKd5jm0sS6OYxWXQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@eslint-community/eslint-utils": "^4.7.0",
        "@typescript-eslint/scope-manager": "8.48.0",
        "@typescript-eslint/types": "8.48.0",
        "@typescript-eslint/typescript-estree": "8.48.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      },
      "peerDependencies": {
        "eslint": "^8.57.0 || ^9.0.0",
        "typescript": ">=4.8.4 <6.0.0"
      }
    },
    "node_modules/@typescript-eslint/visitor-keys": {
      "version": "8.48.0",
      "resolved": "https://registry.npmjs.org/@typescript-eslint/visitor-keys/-/visitor-keys-8.48.0.tgz",
      "integrity": "sha512-T0XJMaRPOH3+LBbAfzR2jalckP1MSG/L9eUtY0DEzUyVaXJ/t6zN0nR7co5kz0Jko/nkSYCBRkz1djvjajVTTg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@typescript-eslint/types": "8.48.0",
        "eslint-visitor-keys": "^4.2.1"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/typescript-eslint"
      }
    },
    "node_modules/@typescript-eslint/visitor-keys/node_modules/eslint-visitor-keys": {
      "version": "4.2.1",
      "resolved": "https://registry.npmjs.org/eslint-visitor-keys/-/eslint-visitor-keys-4.2.1.tgz",
      "integrity": "sha512-Uhdk5sfqcee/9H/rCOJikYz67o0a2Tw2hGRPOG2Y1R2dg7brRe1uG0yaNQDHu+TO/uQPF/5eCapvYSmHUjt7JQ==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint"
      }
    },
    "node_modules/@typescript/native-preview": {
      "version": "7.0.0-dev.20251108.1",
      "resolved": "https://registry.npmjs.org/@typescript/native-preview/-/native-preview-7.0.0-dev.20251108.1.tgz",
      "integrity": "sha512-v1SNmHbuTYMEIAAJZ5OgKY5kMIgDnS/aVTsP9FdR9FgqyZqgUbA2eHOjjMQHVw/XBLS5ZA32kkGt7cH8RzMlOA==",
      "dev": true,
      "license": "Apache-2.0",
      "bin": {
        "tsgo": "bin/tsgo.js"
      },
      "optionalDependencies": {
        "@typescript/native-preview-darwin-arm64": "7.0.0-dev.20251108.1",
        "@typescript/native-preview-darwin-x64": "7.0.0-dev.20251108.1",
        "@typescript/native-preview-linux-arm": "7.0.0-dev.20251108.1",
        "@typescript/native-preview-linux-arm64": "7.0.0-dev.20251108.1",
        "@typescript/native-preview-linux-x64": "7.0.0-dev.20251108.1",
        "@typescript/native-preview-win32-arm64": "7.0.0-dev.20251108.1",
        "@typescript/native-preview-win32-x64": "7.0.0-dev.20251108.1"
      }
    },
    "node_modules/@typescript/native-preview-darwin-arm64": {
      "version": "7.0.0-dev.20251108.1",
      "resolved": "https://registry.npmjs.org/@typescript/native-preview-darwin-arm64/-/native-preview-darwin-arm64-7.0.0-dev.20251108.1.tgz",
      "integrity": "sha512-zdD59CWlvJum9hu7Rrb7xntGfkeTlki7Pql/s+Ls0sNSEGimjuJmU88ookUt2UMPLZ9S+RyGfjNbS7duhKuCIw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "darwin"
      ]
    },
    "node_modules/@typescript/native-preview-darwin-x64": {
      "version": "7.0.0-dev.20251108.1",
      "resolved": "https://registry.npmjs.org/@typescript/native-preview-darwin-x64/-/native-preview-darwin-x64-7.0.0-dev.20251108.1.tgz",
      "integrity": "sha512-nxs1vOm6jkwZoA56d6E2pllhYbxK2xNtspG2Yx9kswdp0aqh2jcja1EjMilHv4tnvNixRQvRWhoOz/BgWrxTig==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "darwin"
      ]
    },
    "node_modules/@typescript/native-preview-linux-arm": {
      "version": "7.0.0-dev.20251108.1",
      "resolved": "https://registry.npmjs.org/@typescript/native-preview-linux-arm/-/native-preview-linux-arm-7.0.0-dev.20251108.1.tgz",
      "integrity": "sha512-+1UuKod2SJZODnArwHViJEhZxgM1aHK5KCGlHJU61htq3jgNtRfouw4UEJRPTALCnGLun8ZpYuMsJUMeDFFIUQ==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@typescript/native-preview-linux-arm64": {
      "version": "7.0.0-dev.20251108.1",
      "resolved": "https://registry.npmjs.org/@typescript/native-preview-linux-arm64/-/native-preview-linux-arm64-7.0.0-dev.20251108.1.tgz",
      "integrity": "sha512-Er0P4Dt6fBM6MZidGBKGZs5PS2QHunRPNeIKCATJRcBMn8ymSBdi/IJK/wYVU62HW8CLb1Dt3FbueW5UptSAKA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@typescript/native-preview-linux-x64": {
      "version": "7.0.0-dev.20251108.1",
      "resolved": "https://registry.npmjs.org/@typescript/native-preview-linux-x64/-/native-preview-linux-x64-7.0.0-dev.20251108.1.tgz",
      "integrity": "sha512-3ijz+Uo8unENgq22nlyThf1JqhLVOwN881gomoAykALmspXX13aQwnDtbscnQRr1iQqMIrEyyRMwxfVevQkl9w==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@typescript/native-preview-win32-arm64": {
      "version": "7.0.0-dev.20251108.1",
      "resolved": "https://registry.npmjs.org/@typescript/native-preview-win32-arm64/-/native-preview-win32-arm64-7.0.0-dev.20251108.1.tgz",
      "integrity": "sha512-Aeyrj7sdc6GBnLIw9o5dQPzEqrfsJodDYsi7RePm0QLvGVyxOeZVd9CcfdXqPKnD2goEJNOzFoTRyvvi7DjNUg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@typescript/native-preview-win32-x64": {
      "version": "7.0.0-dev.20251108.1",
      "resolved": "https://registry.npmjs.org/@typescript/native-preview-win32-x64/-/native-preview-win32-x64-7.0.0-dev.20251108.1.tgz",
      "integrity": "sha512-rgfq7AZ7IFfE5EyDuHdpDEPUH3LEesyOVuIHE6YWOSqGOFnlzYbOf37VUYxQTIxFrR7IopgvM4pSDR3KeDcMjQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "Apache-2.0",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/acorn": {
      "version": "8.15.0",
      "resolved": "https://registry.npmjs.org/acorn/-/acorn-8.15.0.tgz",
      "integrity": "sha512-NZyJarBfL7nWwIq+FDL6Zp/yHEhePMNnnJ0y3qfieCrmNvYct8uvtiV41UvlSe6apAfk0fY1FbWx+NwfmpvtTg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "bin": {
        "acorn": "bin/acorn"
      },
      "engines": {
        "node": ">=0.4.0"
      }
    },
    "node_modules/acorn-jsx": {
      "version": "5.3.2",
      "resolved": "https://registry.npmjs.org/acorn-jsx/-/acorn-jsx-5.3.2.tgz",
      "integrity": "sha512-rq9s+JNhf0IChjtDXxllJ7g41oZk5SlXtp0LHwyA5cejwn7vKmKp4pPri6YEePv2PU65sAsegbXtIinmDFDXgQ==",
      "dev": true,
      "license": "MIT",
      "peerDependencies": {
        "acorn": "^6.0.0 || ^7.0.0 || ^8.0.0"
      }
    },
    "node_modules/ajv": {
      "version": "6.12.6",
      "resolved": "https://registry.npmjs.org/ajv/-/ajv-6.12.6.tgz",
      "integrity": "sha512-j3fVLgvTo527anyYyJOGTYJbG+vnnQYvE0m5mmkc1TK+nxAppkCLMIL0aZ4dblVCNoGShhm+kzE4ZUykBoMg4g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "fast-deep-equal": "^3.1.1",
        "fast-json-stable-stringify": "^2.0.0",
        "json-schema-traverse": "^0.4.1",
        "uri-js": "^4.2.2"
      },
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/epoberezkin"
      }
    },
    "node_modules/ansi-styles": {
      "version": "4.3.0",
      "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-4.3.0.tgz",
      "integrity": "sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "color-convert": "^2.0.1"
      },
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/chalk/ansi-styles?sponsor=1"
      }
    },
    "node_modules/argparse": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/argparse/-/argparse-2.0.1.tgz",
      "integrity": "sha512-8+9WqebbFzpX9OR+Wa6O29asIogeRMzcGtAINdpMHHyAg10f05aSFVBbcEqGf/PXw1EjAZ+q2/bEBg3DvurK3Q==",
      "dev": true,
      "license": "Python-2.0"
    },
    "node_modules/balanced-match": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/balanced-match/-/balanced-match-1.0.2.tgz",
      "integrity": "sha512-3oSeUO0TMV67hN1AmbXsK4yaqU7tjiHlbxRDZOpH0KW9+CeX4bRAaX0Anxt0tx2MrpRpWwQaPwIlISEJhYU5Pw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/base64-js": {
      "version": "1.5.1",
      "resolved": "https://registry.npmjs.org/base64-js/-/base64-js-1.5.1.tgz",
      "integrity": "sha512-AKpaYlHn8t4SVbOHCy+b5+KKgvR4vrsD8vbvrbiQJps7fKDTkjkDry6ji0rUJjC0kzbNePLwzxq8iypo41qeWA==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT"
    },
    "node_modules/bindings": {
      "version": "1.5.0",
      "resolved": "https://registry.npmjs.org/bindings/-/bindings-1.5.0.tgz",
      "integrity": "sha512-p2q/t/mhvuOj/UeLlV6566GD/guowlr0hHxClI0W9m7MWYkL1F0hLo+0Aexs9HSPCtR1SXQ0TD3MMKrXZajbiQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "file-uri-to-path": "1.0.0"
      }
    },
    "node_modules/bl": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/bl/-/bl-4.1.0.tgz",
      "integrity": "sha512-1W07cM9gS6DcLperZfFSj+bWLtaPGSOHWhPiGzXmvVJbRLdG82sH/Kn8EtW1VqWVA54AKf2h5k5BbnIbwF3h6w==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "buffer": "^5.5.0",
        "inherits": "^2.0.4",
        "readable-stream": "^3.4.0"
      }
    },
    "node_modules/brace-expansion": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-2.0.2.tgz",
      "integrity": "sha512-Jt0vHyM+jmUBqojB7E1NIYadt0vI0Qxjxd2TErW94wDz+E2LAm5vKMXXwg6ZZBTHPuUlDgQHKXvjGBdfcF1ZDQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "balanced-match": "^1.0.0"
      }
    },
    "node_modules/buffer": {
      "version": "5.7.1",
      "resolved": "https://registry.npmjs.org/buffer/-/buffer-5.7.1.tgz",
      "integrity": "sha512-EHcyIPBQ4BSGlvjB16k5KgAJ27CIsHY/2JBmCRReo48y9rQ3MaUzWX3KVlBa4U7MyX02HdVj0K7C3WaB3ju7FQ==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "base64-js": "^1.3.1",
        "ieee754": "^1.1.13"
      }
    },
    "node_modules/callsites": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/callsites/-/callsites-3.1.0.tgz",
      "integrity": "sha512-P8BjAsXvZS+VIDUI11hHCQEv74YT67YUi5JJFNWIqL235sBmjX4+qx9Muvls5ivyNENctx46xQLQ3aTuE7ssaQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/chalk": {
      "version": "4.1.2",
      "resolved": "https://registry.npmjs.org/chalk/-/chalk-4.1.2.tgz",
      "integrity": "sha512-oKnbhFyRIXpUuez8iBMmyEa4nbj4IOQyuhc/wy9kY7/WVPcwIO9VA668Pu8RkO7+0G76SLROeyw9CpQ061i4mA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "ansi-styles": "^4.1.0",
        "supports-color": "^7.1.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/chalk/chalk?sponsor=1"
      }
    },
    "node_modules/chownr": {
      "version": "1.1.4",
      "resolved": "https://registry.npmjs.org/chownr/-/chownr-1.1.4.tgz",
      "integrity": "sha512-jJ0bqzaylmJtVnNgzTeSOs8DPavpbYgEr/b0YL8/2GO3xJEhInFmhKMUnEJQjZumK7KXGFhUy89PrsJWlakBVg==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/color-convert": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/color-convert/-/color-convert-2.0.1.tgz",
      "integrity": "sha512-RRECPsj7iu/xb5oKYcsFHSppFNnsj/52OVTRKb4zP5onXwVF3zVmmToNcOfGC+CRDpfK/U584fMg38ZHCaElKQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "color-name": "~1.1.4"
      },
      "engines": {
        "node": ">=7.0.0"
      }
    },
    "node_modules/color-name": {
      "version": "1.1.4",
      "resolved": "https://registry.npmjs.org/color-name/-/color-name-1.1.4.tgz",
      "integrity": "sha512-dOy+3AuW3a2wNbZHIuMZpTcgjGuLU/uBL/ubcZF9OXbDo8ff4O8yVp5Bf0efS8uEoYo5q4Fx7dY9OgQGXgAsQA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/commander": {
      "version": "14.0.2",
      "resolved": "https://registry.npmjs.org/commander/-/commander-14.0.2.tgz",
      "integrity": "sha512-TywoWNNRbhoD0BXs1P3ZEScW8W5iKrnbithIl0YH+uCmBd0QpPOA8yc82DS3BIE5Ma6FnBVUsJ7wVUDz4dvOWQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=20"
      }
    },
    "node_modules/concat-map": {
      "version": "0.0.1",
      "resolved": "https://registry.npmjs.org/concat-map/-/concat-map-0.0.1.tgz",
      "integrity": "sha512-/Srv4dswyQNBfohGpz9o6Yb3Gz3SrUDqBH5rTuhGR7ahtlbYKnVxw2bCFMRljaA7EXHaXZ8wsHdodFvbkhKmqg==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/cross-spawn": {
      "version": "7.0.6",
      "resolved": "https://registry.npmjs.org/cross-spawn/-/cross-spawn-7.0.6.tgz",
      "integrity": "sha512-uV2QOWP2nWzsy2aMp8aRibhi9dlzF5Hgh5SHaB9OiTGEyDTiJJyx0uy51QXdyWbtAHNua4XJzUKca3OzKUd3vA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "path-key": "^3.1.0",
        "shebang-command": "^2.0.0",
        "which": "^2.0.1"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/decompress-response": {
      "version": "6.0.0",
      "resolved": "https://registry.npmjs.org/decompress-response/-/decompress-response-6.0.0.tgz",
      "integrity": "sha512-aW35yZM6Bb/4oJlZncMH2LCoZtJXTRxES17vE3hoRiowU2kWHaJKFkSBDnDR+cm9J+9QhXmREyIfv0pji9ejCQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "mimic-response": "^3.1.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/deep-extend": {
      "version": "0.6.0",
      "resolved": "https://registry.npmjs.org/deep-extend/-/deep-extend-0.6.0.tgz",
      "integrity": "sha512-LOHxIOaPYdHlJRtCQfDIVZtfw/ufM8+rVj649RIHzcm/vGwQRXFt6OPqIFWsm2XEMrNIEtWR64sY1LEKD2vAOA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=4.0.0"
      }
    },
    "node_modules/deep-is": {
      "version": "0.1.4",
      "resolved": "https://registry.npmjs.org/deep-is/-/deep-is-0.1.4.tgz",
      "integrity": "sha512-oIPzksmTg4/MriiaYGO+okXDT7ztn/w3Eptv/+gSIdMdKsJo0u4CfYNFJPy+4SKMuCqGw2wxnA+URMg3t8a/bQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/detect-libc": {
      "version": "2.1.2",
      "resolved": "https://registry.npmjs.org/detect-libc/-/detect-libc-2.1.2.tgz",
      "integrity": "sha512-Btj2BOOO83o3WyH59e8MgXsxEQVcarkUOpEYrubB0urwnN10yQ364rsiByU11nZlqWYZm05i/of7io4mzihBtQ==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/end-of-stream": {
      "version": "1.4.5",
      "resolved": "https://registry.npmjs.org/end-of-stream/-/end-of-stream-1.4.5.tgz",
      "integrity": "sha512-ooEGc6HP26xXq/N+GCGOT0JKCLDGrq2bQUZrQ7gyrJiZANJ/8YDTxTpQBXGMn+WbIQXNVpyWymm7KYVICQnyOg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "once": "^1.4.0"
      }
    },
    "node_modules/escape-string-regexp": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/escape-string-regexp/-/escape-string-regexp-4.0.0.tgz",
      "integrity": "sha512-TtpcNJ3XAzx3Gq8sWRzJaVajRs0uVxA2YAkdb1jm2YkPz4G6egUFAyA3n5vtEIZefPk5Wa4UXbKuS5fKkJWdgA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/eslint": {
      "version": "9.39.1",
      "resolved": "https://registry.npmjs.org/eslint/-/eslint-9.39.1.tgz",
      "integrity": "sha512-BhHmn2yNOFA9H9JmmIVKJmd288g9hrVRDkdoIgRCRuSySRUHH7r/DI6aAXW9T1WwUuY3DFgrcaqB+deURBLR5g==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@eslint-community/eslint-utils": "^4.8.0",
        "@eslint-community/regexpp": "^4.12.1",
        "@eslint/config-array": "^0.21.1",
        "@eslint/config-helpers": "^0.4.2",
        "@eslint/core": "^0.17.0",
        "@eslint/eslintrc": "^3.3.1",
        "@eslint/js": "9.39.1",
        "@eslint/plugin-kit": "^0.4.1",
        "@humanfs/node": "^0.16.6",
        "@humanwhocodes/module-importer": "^1.0.1",
        "@humanwhocodes/retry": "^0.4.2",
        "@types/estree": "^1.0.6",
        "ajv": "^6.12.4",
        "chalk": "^4.0.0",
        "cross-spawn": "^7.0.6",
        "debug": "^4.3.2",
        "escape-string-regexp": "^4.0.0",
        "eslint-scope": "^8.4.0",
        "eslint-visitor-keys": "^4.2.1",
        "espree": "^10.4.0",
        "esquery": "^1.5.0",
        "esutils": "^2.0.2",
        "fast-deep-equal": "^3.1.3",
        "file-entry-cache": "^8.0.0",
        "find-up": "^5.0.0",
        "glob-parent": "^6.0.2",
        "ignore": "^5.2.0",
        "imurmurhash": "^0.1.4",
        "is-glob": "^4.0.0",
        "json-stable-stringify-without-jsonify": "^1.0.1",
        "lodash.merge": "^4.6.2",
        "minimatch": "^3.1.2",
        "natural-compare": "^1.4.0",
        "optionator": "^0.9.3"
      },
      "bin": {
        "eslint": "bin/eslint.js"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "url": "https://eslint.org/donate"
      },
      "peerDependencies": {
        "jiti": "*"
      },
      "peerDependenciesMeta": {
        "jiti": {
          "optional": true
        }
      }
    },
    "node_modules/eslint-scope": {
      "version": "8.4.0",
      "resolved": "https://registry.npmjs.org/eslint-scope/-/eslint-scope-8.4.0.tgz",
      "integrity": "sha512-sNXOfKCn74rt8RICKMvJS7XKV/Xk9kA7DyJr8mJik3S7Cwgy3qlkkmyS2uQB3jiJg6VNdZd/pDBJu0nvG2NlTg==",
      "dev": true,
      "license": "BSD-2-Clause",
      "dependencies": {
        "esrecurse": "^4.3.0",
        "estraverse": "^5.2.0"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint"
      }
    },
    "node_modules/eslint-visitor-keys": {
      "version": "3.4.3",
      "resolved": "https://registry.npmjs.org/eslint-visitor-keys/-/eslint-visitor-keys-3.4.3.tgz",
      "integrity": "sha512-wpc+LXeiyiisxPlEkUzU6svyS1frIO3Mgxj1fdy7Pm8Ygzguax2N3Fa/D/ag1WqbOprdI+uY6wMUl8/a2G+iag==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": "^12.22.0 || ^14.17.0 || >=16.0.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint"
      }
    },
    "node_modules/eslint/node_modules/brace-expansion": {
      "version": "1.1.12",
      "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-1.1.12.tgz",
      "integrity": "sha512-9T9UjW3r0UW5c1Q7GTwllptXwhvYmEzFhzMfZ9H7FQWt+uZePjZPjBP/W1ZEyZ1twGWom5/56TF4lPcqjnDHcg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "balanced-match": "^1.0.0",
        "concat-map": "0.0.1"
      }
    },
    "node_modules/eslint/node_modules/eslint-visitor-keys": {
      "version": "4.2.1",
      "resolved": "https://registry.npmjs.org/eslint-visitor-keys/-/eslint-visitor-keys-4.2.1.tgz",
      "integrity": "sha512-Uhdk5sfqcee/9H/rCOJikYz67o0a2Tw2hGRPOG2Y1R2dg7brRe1uG0yaNQDHu+TO/uQPF/5eCapvYSmHUjt7JQ==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint"
      }
    },
    "node_modules/eslint/node_modules/ignore": {
      "version": "5.3.2",
      "resolved": "https://registry.npmjs.org/ignore/-/ignore-5.3.2.tgz",
      "integrity": "sha512-hsBTNUqQTDwkWtcdYI2i06Y/nUBEsNEDJKjWdigLvegy8kDuJAS8uRlpkkcQpyEXL0Z/pjDy5HBmMjRCJ2gq+g==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 4"
      }
    },
    "node_modules/eslint/node_modules/minimatch": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-3.1.2.tgz",
      "integrity": "sha512-J7p63hRiAjw1NDEww1W7i37+ByIrOWO5XQQAzZ3VOcL0PNybwpfmV/N05zFAzwQ9USyEcX6t3UO+K5aqBQOIHw==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "brace-expansion": "^1.1.7"
      },
      "engines": {
        "node": "*"
      }
    },
    "node_modules/espree": {
      "version": "10.4.0",
      "resolved": "https://registry.npmjs.org/espree/-/espree-10.4.0.tgz",
      "integrity": "sha512-j6PAQ2uUr79PZhBjP5C5fhl8e39FmRnOjsD5lGnWrFU8i2G776tBK7+nP8KuQUTTyAZUwfQqXAgrVH5MbH9CYQ==",
      "dev": true,
      "license": "BSD-2-Clause",
      "dependencies": {
        "acorn": "^8.15.0",
        "acorn-jsx": "^5.3.2",
        "eslint-visitor-keys": "^4.2.1"
      },
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint"
      }
    },
    "node_modules/espree/node_modules/eslint-visitor-keys": {
      "version": "4.2.1",
      "resolved": "https://registry.npmjs.org/eslint-visitor-keys/-/eslint-visitor-keys-4.2.1.tgz",
      "integrity": "sha512-Uhdk5sfqcee/9H/rCOJikYz67o0a2Tw2hGRPOG2Y1R2dg7brRe1uG0yaNQDHu+TO/uQPF/5eCapvYSmHUjt7JQ==",
      "dev": true,
      "license": "Apache-2.0",
      "engines": {
        "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
      },
      "funding": {
        "url": "https://opencollective.com/eslint"
      }
    },
    "node_modules/esquery": {
      "version": "1.6.0",
      "resolved": "https://registry.npmjs.org/esquery/-/esquery-1.6.0.tgz",
      "integrity": "sha512-ca9pw9fomFcKPvFLXhBKUK90ZvGibiGOvRJNbjljY7s7uq/5YO4BOzcYtJqExdx99rF6aAcnRxHmcUHcz6sQsg==",
      "dev": true,
      "license": "BSD-3-Clause",
      "dependencies": {
        "estraverse": "^5.1.0"
      },
      "engines": {
        "node": ">=0.10"
      }
    },
    "node_modules/esrecurse": {
      "version": "4.3.0",
      "resolved": "https://registry.npmjs.org/esrecurse/-/esrecurse-4.3.0.tgz",
      "integrity": "sha512-KmfKL3b6G+RXvP8N1vr3Tq1kL/oCFgn2NYXEtqP8/L3pKapUA4G8cFVaoF3SU323CD4XypR/ffioHmkti6/Tag==",
      "dev": true,
      "license": "BSD-2-Clause",
      "dependencies": {
        "estraverse": "^5.2.0"
      },
      "engines": {
        "node": ">=4.0"
      }
    },
    "node_modules/estraverse": {
      "version": "5.3.0",
      "resolved": "https://registry.npmjs.org/estraverse/-/estraverse-5.3.0.tgz",
      "integrity": "sha512-MMdARuVEQziNTeJD8DgMqmhwR11BRQ/cBP+pLtYdSTnf3MIO8fFeiINEbX36ZdNlfU/7A9f3gUw49B3oQsvwBA==",
      "dev": true,
      "license": "BSD-2-Clause",
      "engines": {
        "node": ">=4.0"
      }
    },
    "node_modules/esutils": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/esutils/-/esutils-2.0.3.tgz",
      "integrity": "sha512-kVscqXk4OCp68SZ0dkgEKVi6/8ij300KBWTJq32P/dYeWTSwK41WyTxalN1eRmA5Z9UU/LX9D7FWSmV9SAYx6g==",
      "dev": true,
      "license": "BSD-2-Clause",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/expand-template": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/expand-template/-/expand-template-2.0.3.tgz",
      "integrity": "sha512-XYfuKMvj4O35f/pOXLObndIRvyQ+/+6AhODh+OKWj9S9498pHHn/IMszH+gt0fBCRWMNfk1ZSp5x3AifmnI2vg==",
      "dev": true,
      "license": "(MIT OR WTFPL)",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/fast-deep-equal": {
      "version": "3.1.3",
      "resolved": "https://registry.npmjs.org/fast-deep-equal/-/fast-deep-equal-3.1.3.tgz",
      "integrity": "sha512-f3qQ9oQy9j2AhBe/H9VC91wLmKBCCU/gDOnKNAYG5hswO7BLKj09Hc5HYNz9cGI++xlpDCIgDaitVs03ATR84Q==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/fast-json-stable-stringify": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/fast-json-stable-stringify/-/fast-json-stable-stringify-2.1.0.tgz",
      "integrity": "sha512-lhd/wF+Lk98HZoTCtlVraHtfh5XYijIjalXck7saUtuanSDyLMxnHhSXEDJqHxD7msR8D0uCmqlkwjCV8xvwHw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/fast-levenshtein": {
      "version": "2.0.6",
      "resolved": "https://registry.npmjs.org/fast-levenshtein/-/fast-levenshtein-2.0.6.tgz",
      "integrity": "sha512-DCXu6Ifhqcks7TZKY3Hxp3y6qphY5SJZmrWMDrKcERSOXWQdMhU9Ig/PYrzyw/ul9jOIyh0N4M0tbC5hodg8dw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/fdir": {
      "version": "6.5.0",
      "resolved": "https://registry.npmjs.org/fdir/-/fdir-6.5.0.tgz",
      "integrity": "sha512-tIbYtZbucOs0BRGqPJkshJUYdL+SDH7dVM8gjy+ERp3WAUjLEFJE+02kanyHtwjWOnwrKYBiwAmM0p4kLJAnXg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=12.0.0"
      },
      "peerDependencies": {
        "picomatch": "^3 || ^4"
      },
      "peerDependenciesMeta": {
        "picomatch": {
          "optional": true
        }
      }
    },
    "node_modules/file-entry-cache": {
      "version": "8.0.0",
      "resolved": "https://registry.npmjs.org/file-entry-cache/-/file-entry-cache-8.0.0.tgz",
      "integrity": "sha512-XXTUwCvisa5oacNGRP9SfNtYBNAMi+RPwBFmblZEF7N7swHYQS6/Zfk7SRwx4D5j3CH211YNRco1DEMNVfZCnQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "flat-cache": "^4.0.0"
      },
      "engines": {
        "node": ">=16.0.0"
      }
    },
    "node_modules/file-uri-to-path": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/file-uri-to-path/-/file-uri-to-path-1.0.0.tgz",
      "integrity": "sha512-0Zt+s3L7Vf1biwWZ29aARiVYLx7iMGnEUl9x33fbB/j3jR81u/O2LbqK+Bm1CDSNDKVtJ/YjwY7TUd5SkeLQLw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/find-up": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/find-up/-/find-up-5.0.0.tgz",
      "integrity": "sha512-78/PXT1wlLLDgTzDs7sjq9hzz0vXD+zn+7wypEe4fXQxCmdmqfGsEPQxmiCSQI3ajFV91bVSsvNtrJRiW6nGng==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "locate-path": "^6.0.0",
        "path-exists": "^4.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/flat-cache": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/flat-cache/-/flat-cache-4.0.1.tgz",
      "integrity": "sha512-f7ccFPK3SXFHpx15UIGyRJ/FJQctuKZ0zVuN3frBo4HnK3cay9VEW0R6yPYFHC0AgqhukPzKjq22t5DmAyqGyw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "flatted": "^3.2.9",
        "keyv": "^4.5.4"
      },
      "engines": {
        "node": ">=16"
      }
    },
    "node_modules/flatted": {
      "version": "3.3.3",
      "resolved": "https://registry.npmjs.org/flatted/-/flatted-3.3.3.tgz",
      "integrity": "sha512-GX+ysw4PBCz0PzosHDepZGANEuFCMLrnRTiEy9McGjmkCQYwRq4A/X786G/fjM/+OjsWSU1ZrY5qyARZmO/uwg==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/frida": {
      "version": "17.6.2",
      "resolved": "https://registry.npmjs.org/frida/-/frida-17.6.2.tgz",
      "integrity": "sha512-RGvUbbjIKG+WcjWesD1Z591pOWjopSYZ8u1/wes4CV2lDvjKDqNDHuryal9eFiYKOp4YidPW3DMxqFkzvkeV0w==",
      "dev": true,
      "hasInstallScript": true,
      "license": "LGPL-2.0 WITH WxWindows-exception-3.1",
      "dependencies": {
        "bindings": "^1.5.0",
        "minimatch": "^10.0.1",
        "prebuild-install": "^7.1.3"
      },
      "engines": {
        "node": ">=16"
      }
    },
    "node_modules/frida-compile": {
      "version": "19.0.4",
      "resolved": "https://registry.npmjs.org/frida-compile/-/frida-compile-19.0.4.tgz",
      "integrity": "sha512-QGTHsV65HDI+z9etpzJLammqMBDN1TItZxiVTxU6HDPgfIshbIkzpbF8khHuxn1cIxtWYsd+DgtW7UlMTaB76A==",
      "dev": true,
      "dependencies": {
        "chalk": "^5.4.1",
        "commander": "^14.0.0",
        "frida": "^17.1.2"
      },
      "bin": {
        "frida-compile": "dist/cli.js"
      }
    },
    "node_modules/frida-compile/node_modules/chalk": {
      "version": "5.6.2",
      "resolved": "https://registry.npmjs.org/chalk/-/chalk-5.6.2.tgz",
      "integrity": "sha512-7NzBL0rN6fMUW+f7A6Io4h40qQlG+xGmtMxfbnH/K7TAtt8JQWVQK+6g0UXKMeVJoyV5EkkNsErQ8pVD3bLHbA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": "^12.17.0 || ^14.13 || >=16.0.0"
      },
      "funding": {
        "url": "https://github.com/chalk/chalk?sponsor=1"
      }
    },
    "node_modules/frida-java-bridge": {
      "version": "7.0.10",
      "resolved": "https://registry.npmjs.org/frida-java-bridge/-/frida-java-bridge-7.0.10.tgz",
      "integrity": "sha512-AtjgAHE7a2wV6M/8tZvjVqda0T8YGmSoXqkbD0r1Eq6XTFDKYbClKbZqMYHpI9OjxtkIx+xPqkHWWE3+0fDH7w==",
      "license": "LGPL-2.0 WITH WxWindows-exception-3.1"
    },
    "node_modules/frida-objc-bridge": {
      "version": "8.0.5",
      "resolved": "https://registry.npmjs.org/frida-objc-bridge/-/frida-objc-bridge-8.0.5.tgz",
      "integrity": "sha512-0xnL0VgxSQXgLj3S33S0kdAvLrCHSCIZb9HVraEgEyKnf9wOcu0KZ9fI5xzx0e0y+ry/g2Vl3yw9j3dsn92Ffg==",
      "license": "LGPL-2.0 WITH WxWindows-exception-3.1"
    },
    "node_modules/frida-remote-stream": {
      "version": "6.0.3",
      "resolved": "https://registry.npmjs.org/frida-remote-stream/-/frida-remote-stream-6.0.3.tgz",
      "integrity": "sha512-RDWCKdKJOj/nqPMJ8r6YEd4dbLyTQBqwCR1OLy0mwFi1R/rTWS0EIs3UeG0cKIEW3OaDpgGL4IQ7ecDxpgIQ3w==",
      "license": "MIT",
      "dependencies": {
        "tiny-typed-emitter": "^2.1.0"
      }
    },
    "node_modules/frida-swift-bridge": {
      "version": "3.0.2",
      "resolved": "https://registry.npmjs.org/frida-swift-bridge/-/frida-swift-bridge-3.0.2.tgz",
      "integrity": "sha512-7rfr10t/F3JMBtmfc92462lWhxEmKFP8Wz4z5v2rR0Ni/05+q1TaNoSnrVlwm9hWe0BxVQFr9LfWo3MnG8YGnA==",
      "license": "Apache-2.0"
    },
    "node_modules/frida/node_modules/minimatch": {
      "version": "10.1.1",
      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-10.1.1.tgz",
      "integrity": "sha512-enIvLvRAFZYXJzkCYG5RKmPfrFArdLv+R+lbQ53BmIMLIry74bjKzX6iHAm8WYamJkhSSEabrWN5D97XnKObjQ==",
      "dev": true,
      "license": "BlueOak-1.0.0",
      "dependencies": {
        "@isaacs/brace-expansion": "^5.0.0"
      },
      "engines": {
        "node": "20 || >=22"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/fs-constants": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/fs-constants/-/fs-constants-1.0.0.tgz",
      "integrity": "sha512-y6OAwoSIf7FyjMIv94u+b5rdheZEjzR63GTyZJm5qh4Bi+2YgwLCcI/fPFZkL5PSixOt6ZNKm+w+Hfp/Bciwow==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/github-from-package": {
      "version": "0.0.0",
      "resolved": "https://registry.npmjs.org/github-from-package/-/github-from-package-0.0.0.tgz",
      "integrity": "sha512-SyHy3T1v2NUXn29OsWdxmK6RwHD+vkj3v8en8AOBZ1wBQ/hCAQ5bAQTD02kW4W9tUp/3Qh6J8r9EvntiyCmOOw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/glob-parent": {
      "version": "6.0.2",
      "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-6.0.2.tgz",
      "integrity": "sha512-XxwI8EOhVQgWp6iDL+3b0r86f4d6AX6zSU55HfB4ydCEuXLXc5FcYeOu+nnGftS4TEju/11rt4KJPTMgbfmv4A==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "is-glob": "^4.0.3"
      },
      "engines": {
        "node": ">=10.13.0"
      }
    },
    "node_modules/globals": {
      "version": "14.0.0",
      "resolved": "https://registry.npmjs.org/globals/-/globals-14.0.0.tgz",
      "integrity": "sha512-oahGvuMGQlPw/ivIYBjVSrWAfWLBeku5tpPE2fOPLi+WHffIWbuh2tCjhyQhTBPMf5E9jDEH4FOmTYgYwbKwtQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=18"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/graphemer": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/graphemer/-/graphemer-1.4.0.tgz",
      "integrity": "sha512-EtKwoO6kxCL9WO5xipiHTZlSzBm7WLT627TqC/uVRd0HKmq8NXyebnNYxDoBi7wt8eTWrUrKXCOVaFq9x1kgag==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/has-flag": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/has-flag/-/has-flag-4.0.0.tgz",
      "integrity": "sha512-EykJT/Q1KjTWctppgIAgfSO0tKVuZUjhgMr17kqTumMl6Afv3EISleU7qZUzoXDFTAHTDC4NOoG/ZxU3EvlMPQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/ieee754": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/ieee754/-/ieee754-1.2.1.tgz",
      "integrity": "sha512-dcyqhDvX1C46lXZcVqCpK+FtMRQVdIMN6/Df5js2zouUsqG7I6sFxitIC+7KYK29KdXOLHdu9zL4sFnoVQnqaA==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "BSD-3-Clause"
    },
    "node_modules/ignore": {
      "version": "7.0.5",
      "resolved": "https://registry.npmjs.org/ignore/-/ignore-7.0.5.tgz",
      "integrity": "sha512-Hs59xBNfUIunMFgWAbGX5cq6893IbWg4KnrjbYwX3tx0ztorVgTDA6B2sxf8ejHJ4wz8BqGUMYlnzNBer5NvGg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 4"
      }
    },
    "node_modules/import-fresh": {
      "version": "3.3.1",
      "resolved": "https://registry.npmjs.org/import-fresh/-/import-fresh-3.3.1.tgz",
      "integrity": "sha512-TR3KfrTZTYLPB6jUjfx6MF9WcWrHL9su5TObK4ZkYgBdWKPOFoSoQIdEuTuR82pmtxH2spWG9h6etwfr1pLBqQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "parent-module": "^1.0.0",
        "resolve-from": "^4.0.0"
      },
      "engines": {
        "node": ">=6"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/imurmurhash": {
      "version": "0.1.4",
      "resolved": "https://registry.npmjs.org/imurmurhash/-/imurmurhash-0.1.4.tgz",
      "integrity": "sha512-JmXMZ6wuvDmLiHEml9ykzqO6lwFbof0GG4IkcGaENdCRDDmMVnny7s5HsIgHCbaq0w2MyPhDqkhTUgS2LU2PHA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.8.19"
      }
    },
    "node_modules/inherits": {
      "version": "2.0.4",
      "resolved": "https://registry.npmjs.org/inherits/-/inherits-2.0.4.tgz",
      "integrity": "sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/ini": {
      "version": "1.3.8",
      "resolved": "https://registry.npmjs.org/ini/-/ini-1.3.8.tgz",
      "integrity": "sha512-JV/yugV2uzW5iMRSiZAyDtQd+nxtUnjeLt0acNdw98kKLrvuRVyB80tsREOE7yvGVgalhZ6RNXCmEHkUKBKxew==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/is-extglob": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/is-extglob/-/is-extglob-2.1.1.tgz",
      "integrity": "sha512-SbKbANkN603Vi4jEZv49LeVJMn4yGwsbzZworEoyEiutsN3nJYdbO36zfhGJ6QEDpOZIFkDtnq5JRxmvl3jsoQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/is-glob": {
      "version": "4.0.3",
      "resolved": "https://registry.npmjs.org/is-glob/-/is-glob-4.0.3.tgz",
      "integrity": "sha512-xelSayHH36ZgE7ZWhli7pW34hNbNl8Ojv5KVmkJD4hBdD3th8Tfk9vYasLM+mXWOZhFkgZfxhLSnrwRr4elSSg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "is-extglob": "^2.1.1"
      },
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/isexe": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/isexe/-/isexe-2.0.0.tgz",
      "integrity": "sha512-RHxMLp9lnKHGHRng9QFhRCMbYAcVpn69smSGcq3f36xjgVVWThj4qqLbTLlq7Ssj8B+fIQ1EuCEGI2lKsyQeIw==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/js-yaml": {
      "version": "4.1.1",
      "resolved": "https://registry.npmjs.org/js-yaml/-/js-yaml-4.1.1.tgz",
      "integrity": "sha512-qQKT4zQxXl8lLwBtHMWwaTcGfFOZviOJet3Oy/xmGk2gZH677CJM9EvtfdSkgWcATZhj/55JZ0rmy3myCT5lsA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "argparse": "^2.0.1"
      },
      "bin": {
        "js-yaml": "bin/js-yaml.js"
      }
    },
    "node_modules/json-buffer": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/json-buffer/-/json-buffer-3.0.1.tgz",
      "integrity": "sha512-4bV5BfR2mqfQTJm+V5tPPdf+ZpuhiIvTuAB5g8kcrXOZpTT/QwwVRWBywX1ozr6lEuPdbHxwaJlm9G6mI2sfSQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/json-schema-traverse": {
      "version": "0.4.1",
      "resolved": "https://registry.npmjs.org/json-schema-traverse/-/json-schema-traverse-0.4.1.tgz",
      "integrity": "sha512-xbbCH5dCYU5T8LcEhhuh7HJ88HXuW3qsI3Y0zOZFKfZEHcpWiHU/Jxzk629Brsab/mMiHQti9wMP+845RPe3Vg==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/json-stable-stringify-without-jsonify": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/json-stable-stringify-without-jsonify/-/json-stable-stringify-without-jsonify-1.0.1.tgz",
      "integrity": "sha512-Bdboy+l7tA3OGW6FjyFHWkP5LuByj1Tk33Ljyq0axyzdk9//JSi2u3fP1QSmd1KNwq6VOKYGlAu87CisVir6Pw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/keyv": {
      "version": "4.5.4",
      "resolved": "https://registry.npmjs.org/keyv/-/keyv-4.5.4.tgz",
      "integrity": "sha512-oxVHkHR/EJf2CNXnWxRLW6mg7JyCCUcG0DtEGmL2ctUo1PNTin1PUil+r/+4r5MpVgC/fn1kjsx7mjSujKqIpw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "json-buffer": "3.0.1"
      }
    },
    "node_modules/levn": {
      "version": "0.4.1",
      "resolved": "https://registry.npmjs.org/levn/-/levn-0.4.1.tgz",
      "integrity": "sha512-+bT2uH4E5LGE7h/n3evcS/sQlJXCpIp6ym8OWJ5eV6+67Dsql/LaaT7qJBAt2rzfoa/5QBGBhxDix1dMt2kQKQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "prelude-ls": "^1.2.1",
        "type-check": "~0.4.0"
      },
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/locate-path": {
      "version": "6.0.0",
      "resolved": "https://registry.npmjs.org/locate-path/-/locate-path-6.0.0.tgz",
      "integrity": "sha512-iPZK6eYjbxRu3uB4/WZ3EsEIMJFMqAoopl3R+zuq0UjcAm/MO6KCweDgPfP3elTztoKP3KtnVHxTn2NHBSDVUw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "p-locate": "^5.0.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/lodash.merge": {
      "version": "4.6.2",
      "resolved": "https://registry.npmjs.org/lodash.merge/-/lodash.merge-4.6.2.tgz",
      "integrity": "sha512-0KpjqXRVvrYyCsX1swR/XTK0va6VQkQM6MNo7PqW77ByjAhoARA8EfrP1N4+KlKj8YS0ZUCtRT/YUuhyYDujIQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/mimic-response": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/mimic-response/-/mimic-response-3.1.0.tgz",
      "integrity": "sha512-z0yWI+4FDrrweS8Zmt4Ej5HdJmky15+L2e6Wgn3+iK5fWzb6T3fhNFq2+MeTRb064c6Wr4N/wv0DzQTjNzHNGQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/minimatch": {
      "version": "9.0.5",
      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-9.0.5.tgz",
      "integrity": "sha512-G6T0ZX48xgozx7587koeX9Ys2NYy6Gmv//P89sEte9V9whIapMNF4idKxnW2QtCcLiTWlb/wfCabAtAFWhhBow==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "brace-expansion": "^2.0.1"
      },
      "engines": {
        "node": ">=16 || 14 >=14.17"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/minimist": {
      "version": "1.2.8",
      "resolved": "https://registry.npmjs.org/minimist/-/minimist-1.2.8.tgz",
      "integrity": "sha512-2yyAR8qBkN3YuheJanUpWC5U3bb5osDywNB8RzDVlDwDHbocAJveqqj1u8+SVD7jkWT4yvsHCpWqqWqAxb0zCA==",
      "dev": true,
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/mkdirp-classic": {
      "version": "0.5.3",
      "resolved": "https://registry.npmjs.org/mkdirp-classic/-/mkdirp-classic-0.5.3.tgz",
      "integrity": "sha512-gKLcREMhtuZRwRAfqP3RFW+TK4JqApVBtOIftVgjuABpAtpxhPGaDcfvbhNvD0B8iD1oUr/txX35NjcaY6Ns/A==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/napi-build-utils": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/napi-build-utils/-/napi-build-utils-2.0.0.tgz",
      "integrity": "sha512-GEbrYkbfF7MoNaoh2iGG84Mnf/WZfB0GdGEsM8wz7Expx/LlWf5U8t9nvJKXSp3qr5IsEbK04cBGhol/KwOsWA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/natural-compare": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/natural-compare/-/natural-compare-1.4.0.tgz",
      "integrity": "sha512-OWND8ei3VtNC9h7V60qff3SVobHr996CTwgxubgyQYEpg290h9J0buyECNNJexkFm5sOajh5G116RYA1c8ZMSw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/node-abi": {
      "version": "3.87.0",
      "resolved": "https://registry.npmjs.org/node-abi/-/node-abi-3.87.0.tgz",
      "integrity": "sha512-+CGM1L1CgmtheLcBuleyYOn7NWPVu0s0EJH2C4puxgEZb9h8QpR9G2dBfZJOAUhi7VQxuBPMd0hiISWcTyiYyQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "semver": "^7.3.5"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/once": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/once/-/once-1.4.0.tgz",
      "integrity": "sha512-lNaJgI+2Q5URQBkccEKHTQOPaXdUxnZZElQTZY0MFUAuaEqe1E+Nyvgdz/aIyNi6Z9MzO5dv1H8n58/GELp3+w==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "wrappy": "1"
      }
    },
    "node_modules/optionator": {
      "version": "0.9.4",
      "resolved": "https://registry.npmjs.org/optionator/-/optionator-0.9.4.tgz",
      "integrity": "sha512-6IpQ7mKUxRcZNLIObR0hz7lxsapSSIYNZJwXPGeF0mTVqGKFIXj1DQcMoT22S3ROcLyY/rz0PWaWZ9ayWmad9g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "deep-is": "^0.1.3",
        "fast-levenshtein": "^2.0.6",
        "levn": "^0.4.1",
        "prelude-ls": "^1.2.1",
        "type-check": "^0.4.0",
        "word-wrap": "^1.2.5"
      },
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/p-limit": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/p-limit/-/p-limit-3.1.0.tgz",
      "integrity": "sha512-TYOanM3wGwNGsZN2cVTYPArw454xnXj5qmWF1bEoAc4+cU/ol7GVh7odevjp1FNHduHc3KZMcFduxU5Xc6uJRQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "yocto-queue": "^0.1.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/p-locate": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/p-locate/-/p-locate-5.0.0.tgz",
      "integrity": "sha512-LaNjtRWUBY++zB5nE/NwcaoMylSPk+S+ZHNB1TzdbMJMny6dynpAGt7X/tl/QYq3TIeE6nxHppbo2LGymrG5Pw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "p-limit": "^3.0.2"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/parent-module": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/parent-module/-/parent-module-1.0.1.tgz",
      "integrity": "sha512-GQ2EWRpQV8/o+Aw8YqtfZZPfNRWZYkbidE9k5rpl/hC3vtHHBfGm2Ifi6qWV+coDGkrUKZAxE3Lot5kcsRlh+g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "callsites": "^3.0.0"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/path-exists": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/path-exists/-/path-exists-4.0.0.tgz",
      "integrity": "sha512-ak9Qy5Q7jYb2Wwcey5Fpvg2KoAc/ZIhLSLOSBmRmygPsGwkVVt0fZa0qrtMz+m6tJTAHfZQ8FnmB4MG4LWy7/w==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/path-key": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/path-key/-/path-key-3.1.1.tgz",
      "integrity": "sha512-ojmeN0qd+y0jszEtoY48r0Peq5dwMEkIlCOu6Q5f41lfkswXuKtYrhgoTpLnyIcHm24Uhqx+5Tqm2InSwLhE6Q==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/picomatch": {
      "version": "4.0.3",
      "resolved": "https://registry.npmjs.org/picomatch/-/picomatch-4.0.3.tgz",
      "integrity": "sha512-5gTmgEY/sqK6gFXLIsQNH19lWb4ebPDLA4SdLP7dsWkIXHWlG66oPuVvXSGFPppYZz8ZDZq0dYYrbHfBCVUb1Q==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/sponsors/jonschlinkert"
      }
    },
    "node_modules/prebuild-install": {
      "version": "7.1.3",
      "resolved": "https://registry.npmjs.org/prebuild-install/-/prebuild-install-7.1.3.tgz",
      "integrity": "sha512-8Mf2cbV7x1cXPUILADGI3wuhfqWvtiLA1iclTDbFRZkgRQS0NqsPZphna9V+HyTEadheuPmjaJMsbzKQFOzLug==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "detect-libc": "^2.0.0",
        "expand-template": "^2.0.3",
        "github-from-package": "0.0.0",
        "minimist": "^1.2.3",
        "mkdirp-classic": "^0.5.3",
        "napi-build-utils": "^2.0.0",
        "node-abi": "^3.3.0",
        "pump": "^3.0.0",
        "rc": "^1.2.7",
        "simple-get": "^4.0.0",
        "tar-fs": "^2.0.0",
        "tunnel-agent": "^0.6.0"
      },
      "bin": {
        "prebuild-install": "bin.js"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/prelude-ls": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/prelude-ls/-/prelude-ls-1.2.1.tgz",
      "integrity": "sha512-vkcDPrRZo1QZLbn5RLGPpg/WmIQ65qoWWhcGKf/b5eplkkarX0m9z8ppCat4mlOqUsWpyNuYgO3VRyrYHSzX5g==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/pump": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/pump/-/pump-3.0.3.tgz",
      "integrity": "sha512-todwxLMY7/heScKmntwQG8CXVkWUOdYxIvY2s0VWAAMh/nd8SoYiRaKjlr7+iCs984f2P8zvrfWcDDYVb73NfA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "end-of-stream": "^1.1.0",
        "once": "^1.3.1"
      }
    },
    "node_modules/punycode": {
      "version": "2.3.1",
      "resolved": "https://registry.npmjs.org/punycode/-/punycode-2.3.1.tgz",
      "integrity": "sha512-vYt7UD1U9Wg6138shLtLOvdAu+8DsC/ilFtEVHcH+wydcSpNE20AfSOduf6MkRFahL5FY7X1oU7nKVZFtfq8Fg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/rc": {
      "version": "1.2.8",
      "resolved": "https://registry.npmjs.org/rc/-/rc-1.2.8.tgz",
      "integrity": "sha512-y3bGgqKj3QBdxLbLkomlohkvsA8gdAiUQlSBJnBhfn+BPxg4bc62d8TcBW15wavDfgexCgccckhcZvywyQYPOw==",
      "dev": true,
      "license": "(BSD-2-Clause OR MIT OR Apache-2.0)",
      "dependencies": {
        "deep-extend": "^0.6.0",
        "ini": "~1.3.0",
        "minimist": "^1.2.0",
        "strip-json-comments": "~2.0.1"
      },
      "bin": {
        "rc": "cli.js"
      }
    },
    "node_modules/rc/node_modules/strip-json-comments": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/strip-json-comments/-/strip-json-comments-2.0.1.tgz",
      "integrity": "sha512-4gB8na07fecVVkOI6Rs4e7T6NOTki5EmL7TUduTs6bu3EdnSycntVJ4re8kgZA+wx9IueI2Y11bfbgwtzuE0KQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/readable-stream": {
      "version": "3.6.2",
      "resolved": "https://registry.npmjs.org/readable-stream/-/readable-stream-3.6.2.tgz",
      "integrity": "sha512-9u/sniCrY3D5WdsERHzHE4G2YCXqoG5FTHUiCC4SIbr6XcLZBY05ya9EKjYek9O5xOAwjGq+1JdGBAS7Q9ScoA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "inherits": "^2.0.3",
        "string_decoder": "^1.1.1",
        "util-deprecate": "^1.0.1"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/resolve-from": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/resolve-from/-/resolve-from-4.0.0.tgz",
      "integrity": "sha512-pb/MYmXstAkysRFx8piNI1tGFNQIFA3vkE3Gq4EuA1dF6gHp/+vgZqsCGJapvy8N3Q+4o7FwvquPJcnZ7RYy4g==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/safe-buffer": {
      "version": "5.2.1",
      "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.2.1.tgz",
      "integrity": "sha512-rp3So07KcdmmKbGvgaNxQSJr7bGVSVk5S9Eq1F+ppbRo70+YeaDxkw5Dd8NPN+GD6bjnYm2VuPuCXmpuYvmCXQ==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT"
    },
    "node_modules/semver": {
      "version": "7.7.3",
      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.3.tgz",
      "integrity": "sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q==",
      "dev": true,
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/shebang-command": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/shebang-command/-/shebang-command-2.0.0.tgz",
      "integrity": "sha512-kHxr2zZpYtdmrN1qDjrrX/Z1rR1kG8Dx+gkpK1G4eXmvXswmcE1hTWBWYUzlraYw1/yZp6YuDY77YtvbN0dmDA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "shebang-regex": "^3.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/shebang-regex": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/shebang-regex/-/shebang-regex-3.0.0.tgz",
      "integrity": "sha512-7++dFhtcx3353uBaq8DDR4NuxBetBzC7ZQOhmTQInHEd6bSrXdiEyzCvG07Z44UYdLShWUyXt5M/yhz8ekcb1A==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/simple-concat": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/simple-concat/-/simple-concat-1.0.1.tgz",
      "integrity": "sha512-cSFtAPtRhljv69IK0hTVZQ+OfE9nePi/rtJmw5UjHeVyVroEqJXP1sFztKUy1qU+xvz3u/sfYJLa947b7nAN2Q==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT"
    },
    "node_modules/simple-get": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/simple-get/-/simple-get-4.0.1.tgz",
      "integrity": "sha512-brv7p5WgH0jmQJr1ZDDfKDOSeWWg+OVypG99A/5vYGPqJ6pxiaHLy8nxtFjBA7oMa01ebA9gfh1uMCFqOuXxvA==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "decompress-response": "^6.0.0",
        "once": "^1.3.1",
        "simple-concat": "^1.0.0"
      }
    },
    "node_modules/string_decoder": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/string_decoder/-/string_decoder-1.3.0.tgz",
      "integrity": "sha512-hkRX8U1WjJFd8LsDJ2yQ/wWWxaopEsABU1XfkM8A+j0+85JAGppt16cr1Whg6KIbb4okU6Mql6BOj+uup/wKeA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "safe-buffer": "~5.2.0"
      }
    },
    "node_modules/strip-json-comments": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/strip-json-comments/-/strip-json-comments-3.1.1.tgz",
      "integrity": "sha512-6fPc+R4ihwqP6N/aIv2f1gMH8lOVtWQHoqC4yK6oSDVVocumAsfCqjkXnqiYMhmMwS/mEHLp7Vehlt3ql6lEig==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=8"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/supports-color": {
      "version": "7.2.0",
      "resolved": "https://registry.npmjs.org/supports-color/-/supports-color-7.2.0.tgz",
      "integrity": "sha512-qpCAvRl9stuOHveKsn7HncJRvv501qIacKzQlO/+Lwxc9+0q2wLyv4Dfvt80/DPn2pqOBsJdDiogXGR9+OvwRw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "has-flag": "^4.0.0"
      },
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/tar-fs": {
      "version": "2.1.4",
      "resolved": "https://registry.npmjs.org/tar-fs/-/tar-fs-2.1.4.tgz",
      "integrity": "sha512-mDAjwmZdh7LTT6pNleZ05Yt65HC3E+NiQzl672vQG38jIrehtJk/J3mNwIg+vShQPcLF/LV7CMnDW6vjj6sfYQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "chownr": "^1.1.1",
        "mkdirp-classic": "^0.5.2",
        "pump": "^3.0.0",
        "tar-stream": "^2.1.4"
      }
    },
    "node_modules/tar-stream": {
      "version": "2.2.0",
      "resolved": "https://registry.npmjs.org/tar-stream/-/tar-stream-2.2.0.tgz",
      "integrity": "sha512-ujeqbceABgwMZxEJnk2HDY2DlnUZ+9oEcb1KzTVfYHio0UE6dG71n60d8D2I4qNvleWrrXpmjpt7vZeF1LnMZQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "bl": "^4.0.3",
        "end-of-stream": "^1.4.1",
        "fs-constants": "^1.0.0",
        "inherits": "^2.0.3",
        "readable-stream": "^3.1.1"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/tiny-typed-emitter": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/tiny-typed-emitter/-/tiny-typed-emitter-2.1.0.tgz",
      "integrity": "sha512-qVtvMxeXbVej0cQWKqVSSAHmKZEHAvxdF8HEUBFWts8h+xEo5m/lEiPakuyZ3BnCBjOD8i24kzNOiOLLgsSxhA==",
      "license": "MIT"
    },
    "node_modules/tinyglobby": {
      "version": "0.2.15",
      "resolved": "https://registry.npmjs.org/tinyglobby/-/tinyglobby-0.2.15.tgz",
      "integrity": "sha512-j2Zq4NyQYG5XMST4cbs02Ak8iJUdxRM0XI5QyxXuZOzKOINmWurp3smXu3y5wDcJrptwpSjgXHzIQxR0omXljQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "fdir": "^6.5.0",
        "picomatch": "^4.0.3"
      },
      "engines": {
        "node": ">=12.0.0"
      },
      "funding": {
        "url": "https://github.com/sponsors/SuperchupuDev"
      }
    },
    "node_modules/ts-api-utils": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/ts-api-utils/-/ts-api-utils-2.1.0.tgz",
      "integrity": "sha512-CUgTZL1irw8u29bzrOD/nH85jqyc74D6SshFgujOIA7osm2Rz7dYH77agkx7H4FBNxDq7Cjf+IjaX/8zwFW+ZQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=18.12"
      },
      "peerDependencies": {
        "typescript": ">=4.8.4"
      }
    },
    "node_modules/tunnel-agent": {
      "version": "0.6.0",
      "resolved": "https://registry.npmjs.org/tunnel-agent/-/tunnel-agent-0.6.0.tgz",
      "integrity": "sha512-McnNiV1l8RYeY8tBgEpuodCC1mLUdbSN+CYBL7kJsJNInOP8UjDDEwdk6Mw60vdLLrr5NHKZhMAOSrR2NZuQ+w==",
      "dev": true,
      "license": "Apache-2.0",
      "dependencies": {
        "safe-buffer": "^5.0.1"
      },
      "engines": {
        "node": "*"
      }
    },
    "node_modules/type-check": {
      "version": "0.4.0",
      "resolved": "https://registry.npmjs.org/type-check/-/type-check-0.4.0.tgz",
      "integrity": "sha512-XleUoc9uwGXqjWwXaUTZAmzMcFZ5858QA2vvx1Ur5xIcixXIP+8LnFDgRplU30us6teqdlskFfu+ae4K79Ooew==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "prelude-ls": "^1.2.1"
      },
      "engines": {
        "node": ">= 0.8.0"
      }
    },
    "node_modules/typescript": {
      "version": "5.9.3",
      "resolved": "https://registry.npmjs.org/typescript/-/typescript-5.9.3.tgz",
      "integrity": "sha512-jl1vZzPDinLr9eUt3J/t7V6FgNEw9QjvBPdysz9KfQDD41fQrC2Y4vKQdiaUpFT4bXlb1RHhLpp8wtm6M5TgSw==",
      "dev": true,
      "license": "Apache-2.0",
      "peer": true,
      "bin": {
        "tsc": "bin/tsc",
        "tsserver": "bin/tsserver"
      },
      "engines": {
        "node": ">=14.17"
      }
    },
    "node_modules/undici-types": {
      "version": "5.26.5",
      "resolved": "https://registry.npmjs.org/undici-types/-/undici-types-5.26.5.tgz",
      "integrity": "sha512-JlCMO+ehdEIKqlFxk6IfVoAUVmgz7cU7zD/h9XZ0qzeosSHmUJVOzSQvvYSYWXkFXC+IfLKSIffhv0sVZup6pA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/uri-js": {
      "version": "4.4.1",
      "resolved": "https://registry.npmjs.org/uri-js/-/uri-js-4.4.1.tgz",
      "integrity": "sha512-7rKUyy33Q1yc98pQ1DAmLtwX109F7TIfWlW1Ydo8Wl1ii1SeHieeh0HHfPeL2fMXK6z0s8ecKs9frCuLJvndBg==",
      "dev": true,
      "license": "BSD-2-Clause",
      "dependencies": {
        "punycode": "^2.1.0"
      }
    },
    "node_modules/util-deprecate": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/util-deprecate/-/util-deprecate-1.0.2.tgz",
      "integrity": "sha512-EPD5q1uXyFxJpCrLnCc1nHnq3gOa6DZBocAIiI2TaSCA7VCJ1UJDMagCzIkXNsUYfD1daK//LTEQ8xiIbrHtcw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/which": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/which/-/which-2.0.2.tgz",
      "integrity": "sha512-BLI3Tl1TW3Pvl70l3yq3Y64i+awpwXqsGBYWkkqMtnbXgrMD+yj7rhW0kuEDxzJaYXGjEW5ogapKNMEKNMjibA==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "isexe": "^2.0.0"
      },
      "bin": {
        "node-which": "bin/node-which"
      },
      "engines": {
        "node": ">= 8"
      }
    },
    "node_modules/word-wrap": {
      "version": "1.2.5",
      "resolved": "https://registry.npmjs.org/word-wrap/-/word-wrap-1.2.5.tgz",
      "integrity": "sha512-BN22B5eaMMI9UMtjrGd5g5eCYPpCPDUy0FJXbYsaT5zYxjFOckS53SQDE3pWkVoWpHXVb3BrYcEN4Twa55B5cA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/wrappy": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/wrappy/-/wrappy-1.0.2.tgz",
      "integrity": "sha512-l4Sp/DRseor9wL6EvV2+TuQn63dMkPjZ/sp9XkghTEbV9KlPS1xUsZ3u7/IQO4wxtcFB4bgpQPRcR3QCvezPcQ==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/yocto-queue": {
      "version": "0.1.0",
      "resolved": "https://registry.npmjs.org/yocto-queue/-/yocto-queue-0.1.0.tgz",
      "integrity": "sha512-rVksvsnNCdJ/ohGc6xgPwyN8eheCxsiLM8mxuE/t/mOVqJewPuO1miLpTHQiRgTKCLexL4MeAFVagts7HmNZ2Q==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    }
  }
}

```

`agent/package.json`:

```json
{
  "name": "igf-agent",
  "version": "1.0.0",
  "description": "igf frida agent",
  "private": true,
  "main": "agent/index.ts",
  "type": "module",
  "engines": {
    "node": ">=22.18.0"
  },
  "scripts": {
    "build:fruity": "frida-compile src/fruity/index.ts -o dist/fruity.js",
    "build:droid": "frida-compile src/droid/index.ts -o dist/droid.js",
    "build:transport": "frida-compile src/transport.ts -o dist/transport.js",
    "watch:fruity": "bun run build:fruity -- --watch",
    "watch:droid": "bun run build:droid -- --watch",
    "watch:transport": "bun run build:transport -- --watch",
    "build": "bun run scripts/build.ts",
    "prepare": "bun run build",
    "lint": "eslint src/**/*.ts",
    "type:fruity": "tsgo -p tsconfig.type-fruity.json",
    "type:droid": "tsgo -p tsconfig.type-droid.json",
    "type:monaco": "bun scripts/monaco.ts",
    "type": "bun run type:fruity && bun run type:droid && bun run type:monaco"
  },
  "devDependencies": {
    "@types/frida-gum": "^19.0.1",
    "@types/node": "^18.14.0",
    "@typescript-eslint/eslint-plugin": "^8.48.0",
    "@typescript-eslint/parser": "^8.48.0",
    "@typescript/native-preview": "7.0.0-dev.20251108.1",
    "eslint": "^9.39.1",
    "frida-compile": "^19.0.4"
  },
  "dependencies": {
    "frida-java-bridge": "^7.0.10",
    "frida-objc-bridge": "^8.0.5",
    "frida-remote-stream": "^6.0.3",
    "frida-swift-bridge": "^3.0.2"
  },
  "trustedDependencies": [
    "frida"
  ],
  "patchedDependencies": {
    "frida-compile@19.0.4": "patches/frida-compile@19.0.4.patch"
  }
}

```

`agent/patches/frida-compile@19.0.4.patch`:

```patch
diff --git a/dist/cli.js b/dist/cli.js
index b276e7289c0de08208e632590a48a3e53f8b264d..e7298c65d47081edcad8332ad6b2b72443e16201 100644
--- a/dist/cli.js
+++ b/dist/cli.js
@@ -46,9 +46,9 @@ async function main() {
         outputFormat: opts.outputFormat,
         bundleFormat: opts.bundleFormat,
         typeCheck: opts.typeCheck,
-        sourceMaps: opts.sourceMaps
-            ? frida.SourceMaps.Included
-            : frida.SourceMaps.Omitted,
+        sourceMaps: opts.noSourceMaps
+            ? frida.SourceMaps.Omitted
+            : frida.SourceMaps.Included,
         compression: opts.compress
             ? frida.JsCompression.Terser
             : frida.JsCompression.None,

```

`agent/scripts/build.ts`:

```ts
#!/usr/bin/env bun

import { $ } from "bun";
import { styleText } from "node:util";
import fs from "node:fs/promises";
import path from "node:path";

await $`bun run type`;

async function buildBridges() {
  const list = ["java", "objc", "swift"] as const;

  const dir = path.join("dist", "bridges");
  await fs.mkdir(dir, { recursive: true });

  // We cannot compile those bridges, since frida-compile is not giving pure valid javascript
  // for IIFE. For now, lock the package verion and download from pypi

  const pypi = await fetch("https://pypi.org/pypi/frida-tools/json");
  if (!pypi.ok)
    throw new Error(`Failed to fetch frida-tools metadata: ${pypi.statusText}`);

  const pypiData = (await pypi.json()) as { urls: { url: string }[] };
  const url = pypiData.urls.at(0)?.url;

  if (!url) throw new Error("could not locate latest frida-tools package");

  // download tar.gz
  const response = await fetch(url);
  const tgz = await response.blob();
  const archive = new Bun.Archive(tgz);
  const files = await archive.files();
  const names = list.map((name) => `${name}.js`);

  for (const [p, file] of files) {
    const basename = p.split("/").at(-1);
    if (basename && names.includes(basename)) {
      const out = path.join(dir, basename);
      Bun.write(out, await file.arrayBuffer());
      console.log(`downloaded bridge ${out}`);
    }
  }
}

await buildBridges();

const metadata = await import("../package.json", { with: { type: "json" } });

await Promise.all(
  Object.keys(metadata.scripts)
    .filter((name) => name.startsWith("build:"))
    .map((name) => $`bun run ${name}`),
);

console.log(styleText("green", "all build tasks finished"));

```

`agent/scripts/monaco.ts`:

```ts
// build .d.ts for monaco editor

import { mkdir, writeFile } from "node:fs/promises";
import { join } from "node:path";

async function wrap(urls: Record<string, string>) {
  const entries = await Promise.all(
    Object.entries(urls).map(async ([key, url]) => {
      const response = await fetch(url);
      if (!response.ok) throw new Error(`Failed to fetch from ${url}`);
      return [key + ".d.ts", await response.text()] as const;
    }),
  );

  return Object.fromEntries(entries);
}

async function main(version: "16" | "17") {
  if (version === "16") {
    return wrap({
      gum: "https://cdn.jsdelivr.net/npm/@types/frida-gum@18/index.d.ts",
    });
  } else if (version === "17") {
    const urls = {
      gum: "@types/frida-gum/index.d.ts",
      objc: "frida-objc-bridge/index.d.ts",
      java: "frida-java-bridge/index.d.ts",
      swift: "frida-swift-bridge/dist/index.d.ts",
    };

    const result = await wrap(
      Object.fromEntries(
        Object.entries(urls).map(([key, url]) => [
          key,
          import.meta.resolve(url),
        ]),
      ),
    );

    result["globals.d.ts"] = [
      'declare const ObjC: typeof import("frida-objc-bridge").default;',
      'declare const Java: typeof import("frida-java-bridge").default;',
      'declare const Swift: typeof import("frida-swift-bridge").default;',
    ].join("\n");

    return result;
  }
}

const outDir = join(import.meta.dirname, "../dist/types");
await mkdir(outDir, { recursive: true });

for (const version of ["16", "17"] as const) {
  const result = await main(version);
  const outPath = join(outDir, `frida${version}.json`);
  await writeFile(outPath, JSON.stringify(result));
  console.log(`wrote ${outPath}`);
}

```

`agent/src/common/encode-arraybuffer.ts`:

```ts
import { fromByteArray } from "base64-js";

declare global {
  interface ArrayBuffer {
    toJSON(): { type: "ArrayBuffer"; base64: string; length: number };
  }
}

// workaround: send() cannot serialize ArrayBuffer
// this function is just to show more friendly representation of an ArrayBuffer
// the agent should always use send({}, data) for blobs
ArrayBuffer.prototype.toJSON = function () {
  const limit = 32;
  const u8 = new Uint8Array(this);
  let base64 = fromByteArray(u8);
  if (base64.length > limit) base64 = base64.slice(0, limit) + "...";
  return { type: "ArrayBuffer", base64, length: this.byteLength };
};

```

`agent/src/common/exception.ts`:

```ts
export function init() {
  Process.setExceptionHandler((detail) => {
    console.error("Exception report: ");
    console.error(JSON.stringify(detail, null, 4));
    const { context } = detail;
    const backtrace = Thread.backtrace(context, Backtracer.ACCURATE).map(
      (addr) => DebugSymbol.fromAddress(addr).toString(),
    );
    send({
      subject: "fatal",
      detail: { ...detail, backtrace },
    });
    const pc = Instruction.parse(context.pc);
    console.warn(DebugSymbol.fromAddress(context.pc));
    console.error(pc.toString());
    console.error(Instruction.parse(pc.next).toString());
    console.error("Backtrace");
    console.error(backtrace.join("\n"));

    return false;
  });
}

```

`agent/src/common/fs.ts`:

```ts
export interface Roots {
  home: string;
  bundle: string;
}

```

`agent/src/common/hermes.ts`:

```ts
export type RNArch = "legacy" | "bridgeless";

export interface RNInstance {
  className: string;
  arch: RNArch;
  handle: string;
}

export function sendHermesByteCode(url: string, bytes: ArrayBuffer) {
  send({ subject: "hermes", url, size: bytes.byteLength }, bytes);
}

export function hookHermesEvaluate(label: string): InvocationListener[] {
  const listeners: InvocationListener[] = [];
  const resolver = new ApiResolver("module");
  const matches = resolver.enumerateMatches(
    "exports:*hermes*!*evaluateJavaScript*",
  );
  for (const m of matches) {
    listeners.push(
      Interceptor.attach(m.address, {
        onEnter() {
          console.log(`[${label}][Hermes] evaluateJavaScript called`);
        },
      }),
    );
  }
  return listeners;
}

export function createCallbackContext() {
  const pending = new Map<string, (result: string) => void>();
  let nextId = Math.floor(Math.random() * 100000);

  function parseCallback(message: string): boolean {
    if (!message.startsWith("frida-callback:")) return false;
    const firstColon = message.indexOf(":");
    const secondColon = message.indexOf(":", firstColon + 1);
    const id = message.substring(firstColon + 1, secondColon);
    const result = message.substring(secondColon + 1);
    const cb = pending.get(id);
    if (cb) {
      pending.delete(id);
      cb(result);
    }
    return true;
  }

  function prepare(script: string): { id: string; path: string } {
    const id = String(++nextId);
    const path = Process.getTmpDir() + `/rn-frida-${id}.js`;
    const wrapped = `
try {
  var r = (function() { return ${script} })();
  alert('frida-callback:${id}:' + JSON.stringify(r));
} catch (e) {
  alert('frida-callback:${id}:' + JSON.stringify({ error: e.message }));
}
`;
    const f = new File(path, "w");
    f.write(wrapped);
    f.close();
    return { id, path };
  }

  function register(id: string, resolve: (result: string) => void) {
    pending.set(id, resolve);
  }

  function cleanup(id: string, path: string) {
    pending.delete(id);
    // unlink(path);
  }

  return { parseCallback, prepare, register, cleanup };
}

```

`agent/src/common/hooks/context.ts`:

```ts
export interface BaseMessage {
  subject: string;
  category: string;
  symbol: string;
  dir: "enter" | "leave";
  line?: string;
  backtrace?: string[];
  extra?: Record<string, unknown>;
}

export function bt(ctx: CpuContext): string[] {
  return Thread.backtrace(ctx, Backtracer.ACCURATE).map((addr) => {
    const { moduleName, name } = DebugSymbol.fromAddress(addr);
    return `${moduleName}!${name} (${addr})`;
  });
}

```

`agent/src/common/hooks/group.ts`:

```ts
export interface HookGroup {
  list(): string[];
  status(): Record<string, boolean>;
  start(group: string): void;
  stop(group: string): void;
}

export function createNative(
  groups: readonly string[],
  get: (group: string) => InvocationListener[] | undefined,
): HookGroup {
  const active = new Map<string, InvocationListener[]>();

  return {
    list: () => [...groups],

    status() {
      const result: Record<string, boolean> = {};
      for (const group of groups) {
        result[group] = active.has(group);
      }
      return result;
    },

    start(group: string) {
      if (active.has(group)) return;
      const hooks = get(group);
      if (!hooks) return;
      active.set(group, hooks);
    },

    stop(group: string) {
      const hooks = active.get(group);
      if (!hooks) return;
      for (const hook of hooks) {
        hook.detach();
      }
      active.delete(group);
    },
  };
}

/**
 * Java hook entry with tap-style start/stop lifecycle.
 */
export interface JavaHookEntry {
  start(): void;
  stop(): void;
  status(): boolean;
  available(): boolean;
}

/**
 * Create a hook group for Java-based hooks (Android).
 * Unlike native hooks that return InvocationListener[], Java hooks
 * use method implementation replacement with their own cleanup.
 */
export function createJava(registry: Map<string, JavaHookEntry>): HookGroup {
  return {
    list() {
      return [...registry.keys()];
    },

    status() {
      const result: Record<string, boolean> = {};
      for (const [id, entry] of registry) {
        result[id] = entry.status();
      }
      return result;
    },

    start(group: string) {
      const entry = registry.get(group);
      if (!entry) throw new Error(`Unknown hook group: ${group}`);
      entry.start();
    },

    stop(group: string) {
      const entry = registry.get(group);
      if (!entry) throw new Error(`Unknown hook group: ${group}`);
      entry.stop();
    },
  };
}

```

`agent/src/common/hooks/java.ts`:

```ts
import Java from "frida-java-bridge";

export function perform<T>(fn: () => T): Promise<T> {
  return new Promise<T>((resolve, reject) => {
    Java.perform(() => {
      try {
        resolve(fn());
      } catch (e) {
        reject(e);
      }
    });
  });
}

export function patch(restores: Array<() => void>) {
  return function apply(
    method: Java.MethodDispatcher,
    fn: (original: Java.MethodDispatcher, self: Java.Wrapper, args: unknown[]) => unknown,
  ) {
    const orig = method.implementation;
    method.implementation = function (this: Java.Wrapper, ...args: unknown[]) {
      return fn(method, this, args);
    };
    restores.push(() => {
      method.implementation = orig;
    });
  };
}

export function backtrace(): string[] {
  try {
    const sw = Java.use("java.io.StringWriter").$new();
    const pw = Java.use("java.io.PrintWriter").$new(sw);
    Java.use("java.lang.Throwable").$new().printStackTrace(pw);
    return sw
      .toString()
      .split("\n")
      .slice(2, 12)
      .map((l: string) => l.trim());
  } catch {
    return [];
  }
}

```

`agent/src/common/hooks/native.ts`:

```ts
import ObjC from "frida-objc-bridge";

import { getGlobalExport } from "@/lib/polyfill.js";
import { BaseMessage, bt } from "./context.js";

export interface NativeHookSignature {
  args: string[];
  returns: string;
}

const hooked = new Map<string | null, Map<string, InvocationListener>>();
const signatures = new Map<string | null, Map<string, NativeHookSignature>>();

function formatArg(arg: NativePointer, type: string): string {
  switch (type) {
    case "int":
      return arg.toInt32().toString();
    case "uint":
      return arg.toUInt32().toString();
    case "long":
      return int64(arg.toString()).toString();
    case "float":
    case "double":
      return arg.toInt32().toString();
    case "bool":
      return arg.toInt32() !== 0 ? "true" : "false";
    case "char *": {
      if (arg.isNull()) return "NULL";
      return JSON.stringify(arg.readUtf8String());
    }
    case "void *":
      return arg.toString();
    case "id": {
      if (arg.isNull()) return "nil";
      if (ObjC.available) return new ObjC.Object(arg).toString();
      return arg.toString();
    }
    default:
      return arg.toString();
  }
}

function formatRetval(retval: NativePointer, type: string): string {
  if (type === "void") return "void";
  return formatArg(retval, type);
}

/**
 * Hook a native function by module and name.
 * @param module Module path (null for global/any module lookup)
 * @param name Function name
 * @param sig Optional type signature for argument/return logging
 */
export function hook(
  module: string | null,
  name: string,
  sig?: NativeHookSignature,
): void {
  // Check if already hooked
  {
    const functions = hooked.get(module);
    if (!functions) {
      hooked.set(module, new Map());
    } else if (functions.has(name)) {
      return;
    }
  }

  // Find the export
  const addr: NativePointer | null = module
    ? (Process.findModuleByName(module)?.findExportByName(name) ?? null)
    : getGlobalExport(name);

  if (!addr)
    throw new Error(`Export ${name} not found${module ? ` in ${module}` : ""}`);

  // Store signature for snapshot/restore
  if (sig) {
    if (!signatures.has(module)) signatures.set(module, new Map());
    signatures.get(module)!.set(name, sig);
  }

  const symbolName = module ? `${module}!${name}` : name;
  const listener = Interceptor.attach(addr, {
    onEnter(args) {
      let line = `${name}(`;
      const argParts: string[] = [];
      if (sig) {
        for (let i = 0; i < sig.args.length; i++) {
          argParts.push(`${sig.args[i]}: ${formatArg(args[i], sig.args[i])}`);
        }
      }
      line += argParts.join(", ") + ")";

      send({
        subject: "hook",
        category: "native",
        symbol: symbolName,
        dir: "enter",
        line,
        backtrace: bt(this.context),
        extra: { module, name },
      } satisfies BaseMessage);
    },
    onLeave(retval) {
      let line = `${name}()`;
      if (sig) {
        line += ` -> ${formatRetval(retval, sig.returns)}`;
      }

      send({
        subject: "hook",
        category: "native",
        symbol: symbolName,
        dir: "leave",
        line,
        backtrace: bt(this.context),
        extra: { module, name },
      } satisfies BaseMessage);
    },
  });

  hooked.get(module)!.set(name, listener);
}

/**
 * Unhook a native function.
 * @param module Module path (null for global lookup)
 * @param name Function name
 */
export function unhook(module: string | null, name: string): void {
  const functions = hooked.get(module);
  if (!functions) return;

  const listener = functions.get(name);
  if (!listener) return;

  listener.detach();
  functions.delete(name);

  if (functions.size === 0) {
    hooked.delete(module);
  }

  // Clean up stored signature
  const sigs = signatures.get(module);
  if (sigs) {
    sigs.delete(name);
    if (sigs.size === 0) signatures.delete(module);
  }
}

/**
 * List all active native hooks with optional signatures.
 */
export function list(): Array<{
  module: string | null;
  name: string;
  sig?: NativeHookSignature;
}> {
  const result: Array<{
    module: string | null;
    name: string;
    sig?: NativeHookSignature;
  }> = [];

  for (const [module, functions] of hooked) {
    for (const name of functions.keys()) {
      const sig = signatures.get(module)?.get(name);
      result.push({ module, name, sig });
    }
  }

  return result;
}

```

`agent/src/common/memory.ts`:

```ts
function safeBound(p: NativePointer): NativePointer {
  const range = Process.findRangeByAddress(p);
  if (range && range.protection.includes("r"))
    return range.base.add(range.size);

  const mod = Process.findModuleByAddress(p);
  if (mod) return mod.base.add(mod.size);

  throw new Error(`memory address ${p} cannot be read`);
}

export function dump(address: string, size: number) {
  const LIMIT = 2048;
  const p = ptr(address);
  const maxSize = Math.min(size, safeBound(p).sub(p).toUInt32(), LIMIT);
  return p.readByteArray(maxSize);
}

export interface Range {
  base: string;
  size: number;
  protection: string;
}

export function allocedRanges(): Range[] {
  return Process.enumerateMallocRanges().map(({ base, size, protection }) => ({
    base: base.toString(),
    size,
    protection,
  }));
}

export function addressInfo(address: string) {
  const p = ptr(address);

  const range = Process.findRangeByAddress(p);
  const mod = Process.findModuleByAddress(p);

  return {
    module: mod
      ? { name: mod.name, base: mod.base.toString(), size: mod.size, path: mod.path }
      : null,
    range: range
      ? { base: range.base.toString(), size: range.size, protection: range.protection, file: range.file ?? null }
      : null,
  };
}

let scanning = false;

export function scan(pattern: string, protection: string = "r--") {
  if (scanning) throw new Error("scan already in progress");
  scanning = true;

  const ranges = Process.enumerateRanges(protection);
  let matchCount = 0;

  (async () => {
    for (let i = 0; i < ranges.length; i++) {
      if (!scanning) break;
      const range = ranges[i];

      send({ subject: "memoryScan", event: "progress", current: i, total: ranges.length });

      await Memory.scan(range.base, range.size, pattern, {
        onMatch(address, size) {
          if (!scanning) return "stop";
          matchCount++;
          const preview = address.readByteArray(Math.min(size, 64));
          send({
            subject: "memoryScan",
            event: "match",
            address: address.toString(),
            size,
          }, preview);
        },
        onError() {
          // skip unreadable ranges
        },
        onComplete() {},
      });
    }
    scanning = false;
    send({ subject: "memoryScan", event: "done", count: matchCount });
  })();
}

export function stopScan() {
  scanning = false;
}

```

`agent/src/common/registry.ts`:

```ts
/* eslint-disable @typescript-eslint/no-unsafe-function-type */
/* eslint-disable @typescript-eslint/no-explicit-any */

export function createRegistry<
  T extends Record<string, Record<string, unknown>>,
>(route: T) {
  function invoke(ns: string, fn: string, args: any[]) {
    const iface = route[ns as keyof typeof route];
    if (!iface) throw new Error(`${ns} not found`);
    const method = iface[fn as keyof typeof iface] as Function;
    if (!method) throw new Error(`${ns}.${fn} not found`);
    return method(...args);
  }

  function interfaces() {
    function* gen() {
      for (const [ns, iface] of Object.entries(route)) {
        for (const method of Object.keys(iface)) {
          yield `${ns}.${method}`;
        }
      }
    }

    return Array.from(gen());
  }

  return { invoke, interfaces };
}

// Type helper for RPC route
export type RPCRoute<T> = T;

// Type helper for remote RPC
export type RemoteRPC<T extends Record<string, Record<string, unknown>>> = {
  [K in keyof T]: {
    [M in keyof T[K]]: T[K][M] extends (...args: infer A) => infer R
      ? (...args: A) => Promise<Awaited<R>>
      : never;
  };
};

```

`agent/src/common/script.ts`:

```ts
const bridges = ["ObjC", "Swift", "Java"] as const;

interface PingbackMessage {
  filename: string;
  source: string;
}

function loadBridge(name: (typeof bridges)[number]) {
  let bridge: unknown;

  send({ subject: "frida:load-bridge", name });
  recv("frida:bridge-loaded", (message: PingbackMessage) => {
    bridge = Script.evaluate(
      `/frida/bridges/${message.filename}`,
      "(function () { " +
        [
          message.source,
          `Object.defineProperty(globalThis, '${name}', { value: bridge });`,
          `return bridge;`,
        ].join("\n") +
        " })();",
    );
  }).wait();

  return bridge;
}

function init() {
  for (const name of bridges) {
    Object.defineProperty(globalThis, name, {
      enumerable: true,
      configurable: true,
      get: () => loadBridge(name),
    });
  }
}

let initialized = false;

// eslint-disable-next-line @typescript-eslint/no-explicit-any
export function evaluate(source: string, name = "userscript"): any {
  if (!initialized) {
    init();
    initialized = true;
  }

  return Script.evaluate(name, source);
}

```

`agent/src/common/sqlite.ts`:

```ts
function quote(table: string) {
  return `"${table.replace(/"/g, "")}"`;
}

function convertArrayBuffer(item: unknown) {
  if (item instanceof ArrayBuffer) {
    const view = new Uint8Array(item);
    const maxBytes = 12;
    const hexParts: string[] = [];
    const count = Math.min(view.length, maxBytes);

    for (let i = 0; i < count; i++) {
      hexParts.push(view[i].toString(16).padStart(2, "0"));
    }

    const suffix = view.length > maxBytes ? "…" : "";
    return `X'${hexParts.join("")}${suffix}'`;
  }

  return item;
}

function* all(statement: SqliteStatement) {
  let row;
  /* eslint no-cond-assign: 0 */
  while ((row = statement.step()) !== null) yield row.map(convertArrayBuffer);
}

export interface ColumnInfo {
  name: string;
  type: string;
  // notNull: string;
}

class Database {
  private db: SqliteDatabase;

  constructor(filename: string) {
    this.db = SqliteDatabase.open(filename);
  }

  tables() {
    const SQL_TABLES =
      'SELECT tbl_name FROM sqlite_master WHERE type="table" and tbl_name <> "sqlite_sequence"';
    const statement = this.prepare(SQL_TABLES);
    return [...all(statement)].map((row) => row[0] as string);
  }

  columns(table: string): ColumnInfo[] {
    type TableInfo = [
      cid: number,
      name: string,
      type: string,
      notNull: boolean,
      // eslint-disable-next-line @typescript-eslint/no-explicit-any
      defaultValue: any,
      pk: boolean,
    ];

    const statement = this.prepare(`PRAGMA table_info(${quote(table)})`);
    return [...(all(statement) as Generator<TableInfo>)].map((r) => {
      return { name: r[1], type: r[2] };
    });
  }

  prepare(sql: string, args: unknown[] = []) {
    const statement = this.db.prepare(sql);
    for (let i = 0; i < args.length; i++) {
      const index = i + 1;
      const arg = args[i];
      if (typeof arg === "number") {
        if (Math.floor(arg) === arg) statement.bindInteger(index, arg);
        else statement.bindFloat(index, arg);
      } else if (arg === null || typeof arg === "undefined") {
        statement.bindNull(index);
      } else if (arg instanceof ArrayBuffer) {
        statement.bindBlob(index, arg);
      } else {
        statement.bindText(index, `${arg}`);
      }
    }
    return statement;
  }

  close() {
    this.db.close();
  }
}

export interface DumpResult {
  header: ColumnInfo[];
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  data: any[];
}

export function dump(path: string, table: string) {
  const db = new Database(path);
  const sql = `select * from ${quote(table)} limit 500`;
  const result = {
    header: db.columns(table),
    data: [...all(db.prepare(sql))],
  };

  db.close();
  return result;
}

export function tables(path: string) {
  const db = new Database(path);
  const list = db.tables();
  db.close();
  return list;
}

```

`agent/src/common/symbol.ts`:

```ts
import { getGlobalExport } from "@/lib/polyfill.js";

const BUF_LEN = 256 * 1024;
const buf = Memory.alloc(BUF_LEN);

function cxaDemangle(name: string): string | null {
  const demangle = new NativeFunction(
    getGlobalExport("__cxa_demangle")!,
    "pointer",
    ["pointer", "pointer", "pointer", "pointer"],
  );

  const len = Memory.alloc(Process.pointerSize);
  const status = Memory.alloc(Process.pointerSize);

  len.writeUInt(BUF_LEN);
  const mangled = Memory.allocUtf8String(name);
  demangle(mangled, buf, len, status);

  const statusValue = status.readUInt();
  if (statusValue == 0) return buf.readUtf8String();
  console.error("__cxa_demangle failed, status: " + statusValue.toString(16));
  return null;
}

export interface ModuleInfo {
  name: string;
  size: number;
  version: string | null;
  path: string;
  base: string;
}

export function modules(): ModuleInfo[] {
  return Process.enumerateModules().map(
    ({ name, version, base, path, size }) => ({
      name,
      size,
      version,
      path,
      base: base.toString(),
    }),
  );
}

export function resolve(type: "objc" | "module", query: string) {
  const matches = new ApiResolver(type).enumerateMatches(query);
  return type === "module"
    ? matches.map((item) => {
        const [module, symbol] = item.name.split("!", 2);
        return Object.assign({}, item, { module, symbol });
      })
    : matches;
}

export function strings(path: string) {
  const mod = getModule(path);

  // do not include: __objc_methtype
  const valid = [
    "__objc_methname",
    "__cstring",
    "__dlopen_cstrs",
    "__objc_classname",
  ];
  const strings: string[] = [];
  const validSet = new Set(valid);

  for (const section of mod.enumerateSections()) {
    if (!validSet.has(section.name) || section.size <= 0) continue;

    const end = section.address.add(section.size);
    let p = section.address;
    while (p.compare(end) < 0) {
      const str = p.readUtf8String();
      if (!str) break;
      strings.push(str);
      p = p.add(str.length + 1);
    }
  }

  return strings;
}

function loadDemangler() {
  const canidates = [
    "/usr/lib/swift",
    "/System/Library/PrivateFrameworks/Swift/",
  ];
  for (const base of canidates) {
    try {
      return Module.load(`${base}/libswiftDemangle.dylib`);
    } catch (e) {
      continue;
    }
  }
}

let cachedSwiftDemangler: (name: string) => string | null;
function swiftDemangle(name: string) {
  if (cachedSwiftDemangler) return cachedSwiftDemangler(name);
  const mod = loadDemangler();
  if (mod) {
    const demangle = new NativeFunction(
      mod.findExportByName("swift_demangle_getDemangledName")!,
      "uint",
      ["pointer", "pointer", "uint"],
    );
    cachedSwiftDemangler = (name: string) => {
      const len = demangle(
        Memory.allocUtf8String(name),
        buf,
        BUF_LEN,
      ) as number;
      if (!len) return null;
      return buf.readUtf8String(len);
    };
    return cachedSwiftDemangler(name);
  }
  return null;
}

function tryDemangle(name: string): string | null {
  try {
    if (name.startsWith("_Z")) {
      return cxaDemangle(name);
    } else if (name.match(/(_T|_?\$[Ss])[_a-zA-Z0-9$.]+/)) {
      return swiftDemangle(name);
    }
  } catch (e) {}
  return null;
}

// accurate module lookup by path, to avoid name collision
function getModule(path: string) {
  const basename = path.substring(path.lastIndexOf("/") + 1);
  const match = Process.findModuleByName(basename);
  if (match && match.path === path) return match;

  // fallback to linear search
  const first = Process.enumerateModules().find((mod) => mod.path === path);
  if (first) return first;

  throw new Error(`Module not found: ${path}`);
}

export interface Symbol {
  name: string;
  addr: string;
  demangled: string | null;
}

type SymbolType = "f" | "v";

export interface Imported extends Symbol {
  type?: SymbolType;
}

export interface Exported extends Symbol {
  type?: SymbolType;
}

export function imports(path: string, belongs: string): Imported[] {
  return getModule(path)
    .enumerateImports()
    .filter((imp) => imp.module === belongs)
    .map(({ name, address, type }) => {
      const demangled = tryDemangle(name);
      let t: SymbolType | undefined = undefined;
      if (type === "function") {
        t = "f";
      } else if (type === "variable") {
        t = "v";
      }

      return {
        name,
        addr: address?.toString() || "",
        demangled,
        type: t,
      };
    });
}

export function dependencies(path: string) {
  return getModule(path)
    .enumerateDependencies()
    .map((dep) => dep.name);
}

export interface Section {
  name: string;
  addr: string;
  size: number;
}

export function sections(path: string): Section[] {
  return getModule(path)
    .enumerateSections()
    .map((sec) => {
      const { name, address, size } = sec;
      return { name, addr: address.toString(), size };
    });
}

export function symbolicate(p: string) {
  const { moduleName, lineNumber, fileName } = DebugSymbol.fromAddress(ptr(p));
  return {
    file: fileName,
    line: lineNumber,
    mod: moduleName,
  };
}

export function symbols(path: string): Symbol[] {
  return getModule(path)
    .enumerateSymbols()
    .filter((sym) => sym.name !== "<redacted>" && !sym.address.isNull())
    .map((sym) => {
      const { name, address } = sym;
      const demangled = tryDemangle(name);

      return {
        name,
        addr: address.toString(),
        demangled,
      };
    });
}

export function exports(path: string): Exported[] {
  return getModule(path)
    .enumerateExports()
    .filter((exp) => !exp.address.isNull())
    .map(({ name, address, type }) => {
      const demangled = tryDemangle(name);
      return {
        name,
        addr: address.toString(),
        demangled,
        type: type === "function" ? "f" : "v",
      };
    });
}

export interface ImportGroup {
  module: string;
  imports: Imported[];
}

export function importsGrouped(path: string): ImportGroup[] {
  const mod = getModule(path);
  const allImports = mod.enumerateImports();

  // Group imports by module
  const grouped = new Map<string, Imported[]>();
  for (const imp of allImports) {
    const moduleName = imp.module || "(unknown)";
    if (!grouped.has(moduleName)) {
      grouped.set(moduleName, []);
    }

    let t: SymbolType | undefined = undefined;
    if (imp.type === "function") {
      t = "f";
    } else if (imp.type === "variable") {
      t = "v";
    }

    grouped.get(moduleName)!.push({
      name: imp.name,
      addr: imp.address?.toString() || "",
      demangled: tryDemangle(imp.name),
      type: t,
    });
  }

  // Convert to array and sort alphabetically by module name
  const result: ImportGroup[] = [];
  for (const [module, imports] of grouped) {
    result.push({ module, imports });
  }
  result.sort((a, b) => a.module.localeCompare(b.module));

  return result;
}

```

`agent/src/common/syslog.ts`:

```ts
import { getGlobalExport } from "@/lib/polyfill.js";

// sys/fcntl.h
const F_SETFL = 4;
const O_NONBLOCK = 0x0004;

const stderr = 2;
const SIZEOF_INT = 4; // for mac & iOS

const subject = "syslog";
const fildes = Memory.alloc(SIZEOF_INT * 2);

let stream: UnixInputStream | null = null;

export function start() {
  const close = new NativeFunction(getGlobalExport("close"), "int", ["int"]);
  const pipe = new NativeFunction(getGlobalExport("pipe"), "int", ["pointer"]);
  const dup2 = new NativeFunction(getGlobalExport("dup2"), "int", [
    "int",
    "int",
  ]);
  const fcntl = new NativeFunction(getGlobalExport("fcntl"), "int", [
    "int",
    "int",
    "int",
  ]);

  if (stream) return;

  pipe(fildes);

  const input = fildes.readInt();
  const output = fildes.add(SIZEOF_INT).readInt();

  dup2(output, stderr);
  close(output);
  fcntl(input, F_SETFL, O_NONBLOCK);

  stream = new UnixInputStream(input);

  function read() {
    if (!stream) return;

    stream.read(4096).then((buf) => {
      if (buf.byteLength) send({ subject }, buf);
      setImmediate(read);
    });
  }

  setImmediate(read);

  Script.bindWeak(globalThis, stop);
}

export function stop() {
  if (stream) {
    stream.close();
    stream = null;
  }
}

```

`agent/src/common/taps.ts`:

```ts
export interface TapInfo {
  id: string;
  active: boolean;
  available: boolean;
}

export type TapRule =
  | { type: "builtin"; id: string }
  | { type: "objc"; cls: string; sel: string }
  | {
      type: "native";
      module: string | null;
      name: string;
      sig?: { args: string[]; returns: string };
    };


```

`agent/src/common/test-runner.ts`:

```ts
let passed = 0;
let failed = 0;
let skipped = 0;
const errors: string[] = [];

export function json(obj: unknown, indent = 2) {
  return JSON.stringify(obj, null, indent);
}

export async function test(name: string, fn: () => Promise<void>) {
  try {
    await fn();
    passed++;
    console.log(`  PASS  ${name}`);
  } catch (e) {
    failed++;
    const msg = e instanceof Error ? e.message : String(e);
    errors.push(`${name}: ${msg}`);
    console.log(`  FAIL  ${name} - ${msg}`);
  }
}

export function skip(name: string, reason: string) {
  skipped++;
  console.log(`  SKIP  ${name} - ${reason}`);
}

export function assert(cond: boolean, msg: string) {
  if (!cond) throw new Error(`assertion failed: ${msg}`);
}

export function assertType(value: unknown, type: string, label: string) {
  assert(
    typeof value === type,
    `${label}: expected ${type}, got ${typeof value}`,
  );
}

export function assertArray(
  value: unknown,
  label: string,
): asserts value is unknown[] {
  assert(Array.isArray(value), `${label}: expected array`);
}

export function assertKeys(
  obj: Record<string, unknown>,
  keys: string[],
  label: string,
) {
  for (const k of keys) {
    assert(k in obj, `${label}: missing key "${k}"`);
  }
}

export function assertNonEmpty(arr: unknown[], label: string) {
  assert(arr.length > 0, `${label}: expected non-empty array`);
}

export function summary() {
  console.log("\n=== summary ===");
  console.log(`  ${passed} passed, ${failed} failed, ${skipped} skipped`);

  if (errors.length > 0) {
    console.log("\nfailures:");
    for (const e of errors) {
      console.log(`  - ${e}`);
    }
  }
}

```

`agent/src/droid/bridge/object.ts`:

```ts
import Java from "frida-java-bridge";

/* eslint-disable @typescript-eslint/no-explicit-any */

export function toJava(value: unknown): Java.Wrapper | null {
  if (value === null || value === undefined) return null;
  if (typeof value === "string") return Java.use("java.lang.String").$new(value);
  if (typeof value === "number") return Java.use("java.lang.Double").$new(value);
  if (typeof value === "boolean")
    return Java.use("java.lang.Boolean").$new(value);
  if (Array.isArray(value)) {
    const list = Java.use("java.util.ArrayList").$new();
    for (const item of value) list.add(toJava(item));
    return list;
  }
  if (typeof value === "object") {
    const map = Java.use("java.util.HashMap").$new();
    for (const [k, v] of Object.entries(value as Record<string, unknown>)) {
      map.put(k, toJava(v));
    }
    return map;
  }
  return Java.use("java.lang.String").$new(String(value));
}

export function toJS(obj: Java.Wrapper | null): unknown {
  if (obj === null) return null;

  const cls = obj.$className;

  if (cls === "java.lang.String") return obj.toString();
  if (cls === "java.lang.Boolean") return !!obj.booleanValue();
  if (
    cls === "java.lang.Integer" ||
    cls === "java.lang.Long" ||
    cls === "java.lang.Short" ||
    cls === "java.lang.Byte" ||
    cls === "java.lang.Float" ||
    cls === "java.lang.Double"
  ) {
    return Number(obj);
  }

  if (cls === "[B") {
    const ReflectArray = Java.use("java.lang.reflect.Array");
    const length = ReflectArray.getLength(obj);
    const cap = Math.min(length, 256);
    const bytes: number[] = [];
    for (let i = 0; i < cap; i++) {
      bytes.push(Number(ReflectArray.get(obj, i)) & 0xff);
    }
    return bytes.map((b) => b.toString(16).padStart(2, "0")).join("");
  }

  if (Java.use("java.util.Map").class.isInstance(obj)) {
    const result: Record<string, unknown> = {};
    const it = obj.entrySet().iterator();
    let count = 0;
    while (it.hasNext() && count < 64) {
      const e = it.next();
      result[e.getKey().toString()] = toJS(e.getValue());
      count++;
    }
    return result;
  }

  if (Java.use("java.util.List").class.isInstance(obj)) {
    const result: unknown[] = [];
    const size = Math.min(obj.size(), 64);
    for (let i = 0; i < size; i++) {
      result.push(toJS(obj.get(i)));
    }
    return result;
  }

  return obj.toString();
}

```

`agent/src/droid/crypto/crypto.ts`:

```ts
import Java from "frida-java-bridge";
import type { BaseMessage } from "@/common/hooks/context.js";

const CIPHER_MODES: Record<number, string> = {
  1: "ENCRYPT",
  2: "DECRYPT",
  3: "WRAP",
  4: "UNWRAP",
};

function javaBt(): string[] {
  const frames = Java.use("java.lang.Thread")
    .currentThread()
    .getStackTrace();
  const result: string[] = [];
  for (let i = 2; i < Math.min(frames.length, 20); i++) {
    result.push(frames[i].toString());
  }
  return result;
}

function toBuffer(byteArr: any): ArrayBuffer | null {
  if (!byteArr) return null;
  const len = byteArr.length;
  const buf = new ArrayBuffer(len);
  const u8 = new Uint8Array(buf);
  for (let i = 0; i < len; i++) u8[i] = byteArr[i] & 0xff;
  return buf;
}

function javaHook(
  cls: any,
  method: string,
  overload: string[],
  impl: (this: any, ...args: any[]) => any,
): InvocationListener {
  const m = cls[method].overload(...overload);
  m.implementation = impl;
  return {
    detach: () => {
      m.implementation = null;
    },
  };
}

export function cipher() {
  const hooks: InvocationListener[] = [];

  Java.perform(() => {
    const Cipher = Java.use("javax.crypto.Cipher");

    // getInstance(String)
    hooks.push(
      javaHook(
        Cipher,
        "getInstance",
        ["java.lang.String"],
        function (transformation) {
          const result = this.getInstance(transformation);
          send({
            subject: "crypto",
            category: "cipher",
            symbol: "Cipher.getInstance",
            dir: "enter",
            line: `Cipher.getInstance("${transformation}")`,
            backtrace: javaBt(),
            extra: { transformation: String(transformation) },
          } satisfies BaseMessage);
          return result;
        },
      ),
    );

    // getInstance(String, String)
    hooks.push(
      javaHook(
        Cipher,
        "getInstance",
        ["java.lang.String", "java.lang.String"],
        function (transformation, provider) {
          const result = this.getInstance(transformation, provider);
          send({
            subject: "crypto",
            category: "cipher",
            symbol: "Cipher.getInstance",
            dir: "enter",
            line: `Cipher.getInstance("${transformation}", "${provider}")`,
            backtrace: javaBt(),
            extra: {
              transformation: String(transformation),
              provider: String(provider),
            },
          } satisfies BaseMessage);
          return result;
        },
      ),
    );

    // init(int, Key)
    hooks.push(
      javaHook(
        Cipher,
        "init",
        ["int", "java.security.Key"],
        function (mode, key) {
          const op = CIPHER_MODES[mode] || String(mode);
          const algo = this.getAlgorithm();
          send({
            subject: "crypto",
            category: "cipher",
            symbol: "Cipher.init",
            dir: "enter",
            line: `Cipher.init(${op}, ${key.$className}) [${algo}]`,
            backtrace: javaBt(),
            extra: { op, algo },
          } satisfies BaseMessage);
          this.init(mode, key);
        },
      ),
    );

    // init(int, Key, AlgorithmParameterSpec)
    hooks.push(
      javaHook(
        Cipher,
        "init",
        [
          "int",
          "java.security.Key",
          "java.security.spec.AlgorithmParameterSpec",
        ],
        function (mode, key, spec) {
          const op = CIPHER_MODES[mode] || String(mode);
          const algo = this.getAlgorithm();
          send({
            subject: "crypto",
            category: "cipher",
            symbol: "Cipher.init",
            dir: "enter",
            line: `Cipher.init(${op}, ${key.$className}, ${spec.$className}) [${algo}]`,
            backtrace: javaBt(),
            extra: { op, algo },
          } satisfies BaseMessage);
          this.init(mode, key, spec);
        },
      ),
    );

    // doFinal()
    hooks.push(
      javaHook(Cipher, "doFinal", [], function () {
        const algo = this.getAlgorithm();
        send({
          subject: "crypto",
          category: "cipher",
          symbol: "Cipher.doFinal",
          dir: "enter",
          line: `Cipher.doFinal() [${algo}]`,
          backtrace: javaBt(),
          extra: { algo },
        } satisfies BaseMessage);
        const result = this.doFinal();
        const buf = toBuffer(result);
        if (buf) {
          send(
            {
              subject: "crypto",
              category: "cipher",
              symbol: "Cipher.doFinal",
              dir: "leave",
              line: `Cipher.doFinal() → [${buf.byteLength}B] [${algo}]`,
              extra: { algo, detailType: "output", len: buf.byteLength },
            } satisfies BaseMessage,
            buf,
          );
        }
        return result;
      }),
    );

    // doFinal(byte[])
    hooks.push(
      javaHook(Cipher, "doFinal", ["[B"], function (input) {
        const algo = this.getAlgorithm();
        const inBuf = toBuffer(input);
        if (inBuf) {
          send(
            {
              subject: "crypto",
              category: "cipher",
              symbol: "Cipher.doFinal",
              dir: "enter",
              line: `Cipher.doFinal(input[${inBuf.byteLength}B]) [${algo}]`,
              backtrace: javaBt(),
              extra: { algo, detailType: "input", len: inBuf.byteLength },
            } satisfies BaseMessage,
            inBuf,
          );
        }
        const result = this.doFinal(input);
        const outBuf = toBuffer(result);
        if (outBuf) {
          send(
            {
              subject: "crypto",
              category: "cipher",
              symbol: "Cipher.doFinal",
              dir: "leave",
              line: `Cipher.doFinal() → [${outBuf.byteLength}B] [${algo}]`,
              extra: { algo, detailType: "output", len: outBuf.byteLength },
            } satisfies BaseMessage,
            outBuf,
          );
        }
        return result;
      }),
    );

    // update(byte[])
    hooks.push(
      javaHook(Cipher, "update", ["[B"], function (input) {
        const algo = this.getAlgorithm();
        const inBuf = toBuffer(input);
        if (inBuf) {
          send(
            {
              subject: "crypto",
              category: "cipher",
              symbol: "Cipher.update",
              dir: "enter",
              line: `Cipher.update(input[${inBuf.byteLength}B]) [${algo}]`,
              backtrace: javaBt(),
              extra: { algo, detailType: "input", len: inBuf.byteLength },
            } satisfies BaseMessage,
            inBuf,
          );
        }
        const result = this.update(input);
        const outBuf = toBuffer(result);
        if (outBuf) {
          send(
            {
              subject: "crypto",
              category: "cipher",
              symbol: "Cipher.update",
              dir: "leave",
              line: `Cipher.update() → [${outBuf.byteLength}B] [${algo}]`,
              extra: { algo, detailType: "output", len: outBuf.byteLength },
            } satisfies BaseMessage,
            outBuf,
          );
        }
        return result;
      }),
    );
  });

  return hooks;
}

export function pbkdf() {
  const hooks: InvocationListener[] = [];

  Java.perform(() => {
    const PBEKeySpec = Java.use("javax.crypto.spec.PBEKeySpec");
    const StringCls = Java.use("java.lang.String");

    const toStr = (arr: any) =>
      arr === null ? "(null)" : StringCls.$new(arr).toString();

    // PBEKeySpec(char[])
    hooks.push(
      javaHook(PBEKeySpec, "$init", ["[C"], function (pass) {
        const password = toStr(pass);
        send({
          subject: "crypto",
          category: "pbkdf",
          symbol: "PBEKeySpec",
          dir: "enter",
          line: `PBEKeySpec(pass="${password}")`,
          backtrace: javaBt(),
          extra: { password },
        } satisfies BaseMessage);
        this.$init(pass);
      }),
    );

    // PBEKeySpec(char[], byte[], int)
    hooks.push(
      javaHook(
        PBEKeySpec,
        "$init",
        ["[C", "[B", "int"],
        function (pass, salt, iter) {
          const password = toStr(pass);
          const saltBuf = toBuffer(salt);
          send(
            {
              subject: "crypto",
              category: "pbkdf",
              symbol: "PBEKeySpec",
              dir: "enter",
              line: `PBEKeySpec(pass="${password}", salt[${salt?.length ?? 0}B], iter=${iter})`,
              backtrace: javaBt(),
              extra: {
                password,
                iterations: iter,
                detailType: "salt",
                len: salt?.length ?? 0,
              },
            } satisfies BaseMessage,
            saltBuf,
          );
          this.$init(pass, salt, iter);
        },
      ),
    );

    // PBEKeySpec(char[], byte[], int, int)
    hooks.push(
      javaHook(
        PBEKeySpec,
        "$init",
        ["[C", "[B", "int", "int"],
        function (pass, salt, iter, keyLen) {
          const password = toStr(pass);
          const saltBuf = toBuffer(salt);
          send(
            {
              subject: "crypto",
              category: "pbkdf",
              symbol: "PBEKeySpec",
              dir: "enter",
              line: `PBEKeySpec(pass="${password}", salt[${salt?.length ?? 0}B], iter=${iter}, keyLen=${keyLen})`,
              backtrace: javaBt(),
              extra: {
                password,
                iterations: iter,
                keyLength: keyLen,
                detailType: "salt",
                len: salt?.length ?? 0,
              },
            } satisfies BaseMessage,
            saltBuf,
          );
          this.$init(pass, salt, iter, keyLen);
        },
      ),
    );
  });

  return hooks;
}

export function keygen() {
  const hooks: InvocationListener[] = [];

  Java.perform(() => {
    const Builder = Java.use(
      "android.security.keystore.KeyGenParameterSpec$Builder",
    );

    const boolMethods = [
      "setUserAuthenticationRequired",
      "setRandomizedEncryptionRequired",
      "setInvalidatedByBiometricEnrollment",
      "setUnlockedDeviceRequired",
      "setUserConfirmationRequired",
      "setUserPresenceRequired",
      "setIsStrongBoxBacked",
    ];

    const intMethods = [
      "setKeySize",
      "setUserAuthenticationValidityDurationSeconds",
    ];

    for (const name of boolMethods) {
      try {
        hooks.push(
          javaHook(Builder, name, ["boolean"], function (value) {
            send({
              subject: "crypto",
              category: "keygen",
              symbol: `KeyGenParameterSpec.${name}`,
              dir: "enter",
              line: `Builder.${name}(${value})`,
              backtrace: javaBt(),
              extra: { method: name, value: String(value) },
            } satisfies BaseMessage);
            return this[name](value);
          }),
        );
      } catch (_) {
        /* not available on this API level */
      }
    }

    for (const name of intMethods) {
      try {
        hooks.push(
          javaHook(Builder, name, ["int"], function (value) {
            send({
              subject: "crypto",
              category: "keygen",
              symbol: `KeyGenParameterSpec.${name}`,
              dir: "enter",
              line: `Builder.${name}(${value})`,
              backtrace: javaBt(),
              extra: { method: name, value: String(value) },
            } satisfies BaseMessage);
            return this[name](value);
          }),
        );
      } catch (_) {
        /* not available on this API level */
      }
    }
  });

  return hooks;
}

```

`agent/src/droid/crypto/index.ts`:

```ts
import { createNative } from "@/common/hooks/group.js";
import * as crypto from "./crypto.js";

const CRYPTO_GROUPS = ["cipher", "pbkdf", "keygen"] as const;

function get(group: string) {
  if (group === "cipher") return [...crypto.cipher()];
  if (group === "pbkdf") return [...crypto.pbkdf()];
  if (group === "keygen") return [...crypto.keygen()];
}

const { list, status, start, stop } = createNative(CRYPTO_GROUPS, get);
export { list, status, start, stop };

```

`agent/src/droid/hooks/broadcast.ts`:

```ts
import Java from "frida-java-bridge";

import type { BaseMessage } from "@/common/hooks/context.js";
import { patch as createPatch, backtrace } from "@/common/hooks/java.js";
import { toJS } from "@/droid/bridge/object.js";

const restores: Array<() => void> = [];
let running = false;

const patch = createPatch(restores);


function describeIntent(intent: Java.Wrapper): Record<string, unknown> {
  const info: Record<string, unknown> = {};
  try {
    const action = intent.getAction();
    if (action) info.action = action.toString();

    const component = intent.getComponent();
    if (component) info.component = component.flattenToString().toString();

    const data = intent.getDataString();
    if (data) info.data = data.toString();

    const categories = intent.getCategories();
    if (categories && !categories.isEmpty()) {
      const arr: string[] = [];
      const it = categories.iterator();
      let count = 0;
      while (it.hasNext() && count < 16) {
        arr.push(it.next().toString());
        count++;
      }
      info.categories = arr;
    }

    const extras = intent.getExtras();
    if (extras) {
      try {
        const map: Record<string, unknown> = {};
        const keys = extras.keySet();
        const it = keys.iterator();
        let count = 0;
        while (it.hasNext() && count < 32) {
          const key = it.next().toString();
          try {
            map[key] = toJS(extras.get(key));
          } catch {
            map[key] = "<unreadable>";
          }
          count++;
        }
        info.extras = map;
      } catch { /* ignore */ }
    }

    const flags = intent.getFlags();
    if (flags !== 0) info.flags = `0x${(flags >>> 0).toString(16)}`;
  } catch { /* ignore */ }

  return info;
}

function intentSummary(intent: Java.Wrapper): string {
  try {
    const action = intent.getAction()?.toString() ?? "";
    const component = intent.getComponent()?.flattenToString()?.toString() ?? "";
    if (component) return component;
    if (action) return action;
    return intent.toString();
  } catch {
    return "<intent>";
  }
}

export function start() {
  if (running || !available()) return;
  running = true;

  Java.perform(() => {
    try {
      hookSendBroadcast();
    } catch (e) {
      console.warn("broadcast: hooks unavailable:", e);
    }
  });
}

function hookSendBroadcast() {
  const ContextWrapper = Java.use("android.content.ContextWrapper");

  // sendBroadcast(Intent)
  patch(
    ContextWrapper.sendBroadcast.overload("android.content.Intent"),
    (original, self, args) => {
      const [intent] = args as [Java.Wrapper];

      send({
        subject: "hook",
        category: "broadcast",
        symbol: "Context.sendBroadcast",
        dir: "enter",
        line: `sendBroadcast(${intentSummary(intent)})`,
        backtrace: backtrace(),
        extra: { op: "send", ...describeIntent(intent) },
      } satisfies BaseMessage);

      return original.call(self, intent);
    },
  );

  // sendBroadcast(Intent, String) - with permission
  try {
    patch(
      ContextWrapper.sendBroadcast.overload(
        "android.content.Intent",
        "java.lang.String",
      ),
      (original, self, args) => {
        const [intent, perm] = args as [Java.Wrapper, Java.Wrapper | null];

        send({
          subject: "hook",
          category: "broadcast",
          symbol: "Context.sendBroadcast",
          dir: "enter",
          line: `sendBroadcast(${intentSummary(intent)}, ${perm?.toString() ?? "null"})`,
          backtrace: backtrace(),
          extra: {
            op: "send",
            permission: perm?.toString() ?? null,
            ...describeIntent(intent),
          },
        } satisfies BaseMessage);

        return original.call(self, intent, perm);
      },
    );
  } catch { /* overload may not exist */ }

  // sendOrderedBroadcast(Intent, String)
  try {
    patch(
      ContextWrapper.sendOrderedBroadcast.overload(
        "android.content.Intent",
        "java.lang.String",
      ),
      (original, self, args) => {
        const [intent, perm] = args as [Java.Wrapper, Java.Wrapper | null];

        send({
          subject: "hook",
          category: "broadcast",
          symbol: "Context.sendOrderedBroadcast",
          dir: "enter",
          line: `sendOrderedBroadcast(${intentSummary(intent)})`,
          backtrace: backtrace(),
          extra: {
            op: "sendOrdered",
            permission: perm?.toString() ?? null,
            ...describeIntent(intent),
          },
        } satisfies BaseMessage);

        return original.call(self, intent, perm);
      },
    );
  } catch { /* overload may not exist */ }

  // sendStickyBroadcast(Intent)
  try {
    patch(
      ContextWrapper.sendStickyBroadcast.overload("android.content.Intent"),
      (original, self, args) => {
        const [intent] = args as [Java.Wrapper];

        send({
          subject: "hook",
          category: "broadcast",
          symbol: "Context.sendStickyBroadcast",
          dir: "enter",
          line: `sendStickyBroadcast(${intentSummary(intent)})`,
          backtrace: backtrace(),
          extra: { op: "sendSticky", ...describeIntent(intent) },
        } satisfies BaseMessage);

        return original.call(self, intent);
      },
    );
  } catch { /* may not exist on all API levels */ }

  // registerReceiver(BroadcastReceiver, IntentFilter)
  try {
    patch(
      ContextWrapper.registerReceiver.overload(
        "android.content.BroadcastReceiver",
        "android.content.IntentFilter",
      ),
      (original, self, args) => {
        const [receiver, filter] = args as [Java.Wrapper, Java.Wrapper];

        const actions: string[] = [];
        try {
          const count = filter.countActions();
          for (let i = 0; i < count && i < 32; i++) {
            actions.push(filter.getAction(i).toString());
          }
        } catch { /* ignore */ }

        send({
          subject: "hook",
          category: "broadcast",
          symbol: "Context.registerReceiver",
          dir: "enter",
          line: `registerReceiver(${actions.join(", ") || "..."})`,
          backtrace: backtrace(),
          extra: {
            op: "register",
            receiverClass: receiver?.$className ?? null,
            actions,
          },
        } satisfies BaseMessage);

        return original.call(self, receiver, filter);
      },
    );
  } catch { /* overload may not exist */ }

  // unregisterReceiver(BroadcastReceiver)
  try {
    patch(
      ContextWrapper.unregisterReceiver.overload(
        "android.content.BroadcastReceiver",
      ),
      (original, self, args) => {
        const [receiver] = args as [Java.Wrapper];

        send({
          subject: "hook",
          category: "broadcast",
          symbol: "Context.unregisterReceiver",
          dir: "enter",
          line: `unregisterReceiver(${receiver?.$className ?? "..."})`,
          backtrace: backtrace(),
          extra: {
            op: "unregister",
            receiverClass: receiver?.$className ?? null,
          },
        } satisfies BaseMessage);

        return original.call(self, receiver);
      },
    );
  } catch { /* overload may not exist */ }
}

export function stop() {
  Java.perform(() => {
    for (let i = restores.length - 1; i >= 0; i--) {
      try {
        restores[i]();
      } catch { /* ignore */ }
    }
  });
  restores.length = 0;
  running = false;
}

export function status(): boolean {
  return running;
}

export function available(): boolean {
  if (!Java.available) return false;
  let found = false;
  Java.perform(() => {
    try {
      Java.use("android.content.ContextWrapper");
      found = true;
    } catch { /* not found */ }
  });
  return found;
}

```

`agent/src/droid/hooks/clipboard.ts`:

```ts
import Java from "frida-java-bridge";

import type { BaseMessage } from "@/common/hooks/context.js";
import { patch as createPatch, backtrace } from "@/common/hooks/java.js";

const restores: Array<() => void> = [];
let running = false;

const patch = createPatch(restores);


export function start() {
  if (running || !available()) return;
  running = true;

  Java.perform(() => {
    try {
      hookClipboardManager();
    } catch (e) {
      console.warn("clipboard: hooks unavailable:", e);
    }
  });
}

function hookClipboardManager() {
  const ClipboardManager = Java.use("android.content.ClipboardManager");

  // getPrimaryClip
  patch(
    ClipboardManager.getPrimaryClip,
    (original, self, args) => {
      const ret = original.call(self, ...args) as Java.Wrapper | null;

      let text: string | null = null;
      try {
        if (ret && ret.getItemCount() > 0) {
          const item = ret.getItemAt(0);
          const t = item.getText();
          if (t) text = t.toString();
        }
      } catch { /* ignore */ }

      send({
        subject: "hook",
        category: "clipboard",
        symbol: "ClipboardManager.getPrimaryClip",
        dir: "leave",
        line: "getPrimaryClip() // read",
        backtrace: backtrace(),
        extra: { op: "read", text },
      } satisfies BaseMessage);

      return ret;
    },
  );

  // getPrimaryClipDescription
  try {
    patch(
      ClipboardManager.getPrimaryClipDescription,
      (original, self, args) => {
        const ret = original.call(self, ...args);

        send({
          subject: "hook",
          category: "clipboard",
          symbol: "ClipboardManager.getPrimaryClipDescription",
          dir: "leave",
          line: "getPrimaryClipDescription() // read",
          backtrace: backtrace(),
          extra: { op: "read" },
        } satisfies BaseMessage);

        return ret;
      },
    );
  } catch { /* overload may not exist */ }

  // getText (deprecated but still used)
  try {
    patch(
      ClipboardManager.getText,
      (original, self, args) => {
        const ret = original.call(self, ...args) as Java.Wrapper | null;
        const text = ret?.toString() ?? null;

        send({
          subject: "hook",
          category: "clipboard",
          symbol: "ClipboardManager.getText",
          dir: "leave",
          line: "getText() // read",
          backtrace: backtrace(),
          extra: { op: "read", text },
        } satisfies BaseMessage);

        return ret;
      },
    );
  } catch { /* may not exist */ }

  // setPrimaryClip
  patch(
    ClipboardManager.setPrimaryClip.overload("android.content.ClipData"),
    (original, self, args) => {
      const [clip] = args as [Java.Wrapper];

      let text: string | null = null;
      let label: string | null = null;
      try {
        label = clip.getDescription().getLabel()?.toString() ?? null;
        if (clip.getItemCount() > 0) {
          const item = clip.getItemAt(0);
          const t = item.getText();
          if (t) text = t.toString();
        }
      } catch { /* ignore */ }

      send({
        subject: "hook",
        category: "clipboard",
        symbol: "ClipboardManager.setPrimaryClip",
        dir: "enter",
        line: `setPrimaryClip(${label ? `"${label}"` : "..."}) // write`,
        backtrace: backtrace(),
        extra: { op: "write", label, text },
      } satisfies BaseMessage);

      return original.call(self, clip);
    },
  );

  // setText (deprecated but still used)
  try {
    patch(
      ClipboardManager.setText.overload("java.lang.CharSequence"),
      (original, self, args) => {
        const [text] = args as [Java.Wrapper];
        const str = text?.toString() ?? null;

        send({
          subject: "hook",
          category: "clipboard",
          symbol: "ClipboardManager.setText",
          dir: "enter",
          line: "setText(...) // write",
          backtrace: backtrace(),
          extra: { op: "write", text: str },
        } satisfies BaseMessage);

        return original.call(self, text);
      },
    );
  } catch { /* may not exist */ }

  // hasPrimaryClip
  try {
    patch(
      ClipboardManager.hasPrimaryClip,
      (original, self, args) => {
        const ret = original.call(self, ...args);

        send({
          subject: "hook",
          category: "clipboard",
          symbol: "ClipboardManager.hasPrimaryClip",
          dir: "leave",
          line: `hasPrimaryClip() => ${ret} // query`,
          backtrace: backtrace(),
          extra: { op: "query", result: ret },
        } satisfies BaseMessage);

        return ret;
      },
    );
  } catch { /* may not exist */ }
}

export function stop() {
  Java.perform(() => {
    for (let i = restores.length - 1; i >= 0; i--) {
      try {
        restores[i]();
      } catch { /* ignore */ }
    }
  });
  restores.length = 0;
  running = false;
}

export function status(): boolean {
  return running;
}

export function available(): boolean {
  if (!Java.available) return false;
  let found = false;
  Java.perform(() => {
    try {
      Java.use("android.content.ClipboardManager");
      found = true;
    } catch { /* not found */ }
  });
  return found;
}

```

`agent/src/droid/hooks/flutter.ts`:

```ts
import Java from "frida-java-bridge";

import { patch as createPatch } from "@/common/hooks/java.js";
import { toJS } from "@/droid/bridge/object.js";

type Direction = "native" | "dart";
type ChannelType = "method" | "event" | "message";

const subject = "flutter";
const restores: Array<() => void> = [];
let running = false;

function safelyConvert(obj: Java.Wrapper | null): unknown {
  try {
    return toJS(obj);
  } catch {
    return null;
  }
}

let classIdCounter = Math.floor(Math.random() * 1024);
// todo: do we need to obfuscate?
const namespace = `org.flutter.agent`;
function nextClassName(base: string): string {
  return `${namespace}.${base}${++classIdCounter}`;
}

function verifyClass(cls: Java.Wrapper, base: string): boolean {
  const prefix = namespace + "." + base;
  return cls.$className?.startsWith(prefix);
}

const patch = createPatch(restores);

function wrapHandler(
  method: Java.MethodDispatcher,
  base: string,
  Proxy: Java.Wrapper,
) {
  const String = Java.use("java.lang.String");
  patch(method, (original, self, args) => {
    const [handler] = args as [Java.Wrapper | null];
    if (!handler || verifyClass(handler, base)) {
      return original.call(self, handler);
    }
    return original.call(
      self,
      Proxy.$new(handler, String.$new(self.name.value)),
    );
  });
}

export function start() {
  if (running || !available()) return;
  running = true;

  Java.perform(() => {
    const hooks = [
      ["MethodChannel", hookMethodChannel],
      ["BasicMessageChannel", hookBasicMessageChannel],
      ["EventChannel", hookEventChannel],
    ] as const;

    for (const [name, fn] of hooks) {
      try {
        fn();
      } catch (e) {
        console.warn(`flutter: ${name} hooks unavailable:`, e);
      }
    }
  });
}

function hookMethodChannel() {
  const MethodChannel = Java.use("io.flutter.plugin.common.MethodChannel");
  const MethodCallHandler = Java.use(
    "io.flutter.plugin.common.MethodChannel$MethodCallHandler",
  );
  const classNameBase = "MCH";
  const HandlerProxy = Java.registerClass({
    name: nextClassName(classNameBase),
    implements: [MethodCallHandler],
    fields: {
      delegate: "io.flutter.plugin.common.MethodChannel$MethodCallHandler",
      channelName: "java.lang.String",
    },
    methods: {
      $init: [
        {
          returnType: "void",
          argumentTypes: [
            "io.flutter.plugin.common.MethodChannel$MethodCallHandler",
            "java.lang.String",
          ],
          implementation(this: Java.Wrapper, d: Java.Wrapper, n: Java.Wrapper) {
            this.delegate.value = d;
            this.channelName.value = n;
          },
        },
      ],
      onMethodCall: [
        {
          returnType: "void",
          argumentTypes: [
            "io.flutter.plugin.common.MethodCall",
            "io.flutter.plugin.common.MethodChannel$Result",
          ],
          implementation(
            this: Java.Wrapper,
            call: Java.Wrapper,
            result: Java.Wrapper,
          ) {
            const name = this.channelName.value.toString();
            const method = call.method.value?.toString() || "<unknown>";
            const args = safelyConvert(call.arguments.value);

            emit("method", "dart", name, { method, args });
            this.delegate.value.onMethodCall(call, result);
          },
        },
      ],
    },
  });

  wrapHandler(
    MethodChannel.setMethodCallHandler.overload(
      "io.flutter.plugin.common.MethodChannel$MethodCallHandler",
    ),
    classNameBase,
    HandlerProxy,
  );

  // invokeMethod(String, Object)
  patch(
    MethodChannel.invokeMethod.overload("java.lang.String", "java.lang.Object"),
    (original, self, args) => {
      const [method, a] = args as [Java.Wrapper, Java.Wrapper];
      emit("method", "native", self.name.value, {
        method: method?.toString() || "<unknown>",
        args: safelyConvert(a),
      });
      return original.call(self, method, a);
    },
  );

  // invokeMethod(String, Object, Result)
  patch(
    MethodChannel.invokeMethod.overload(
      "java.lang.String",
      "java.lang.Object",
      "io.flutter.plugin.common.MethodChannel$Result",
    ),
    (original, self, args) => {
      const [method, a, cb] = args as [
        Java.Wrapper,
        Java.Wrapper,
        Java.Wrapper,
      ];
      emit("method", "native", self.name.value, {
        method: method?.toString() || "<unknown>",
        args: safelyConvert(a),
      });
      return original.call(self, method, a, cb);
    },
  );
}

function hookBasicMessageChannel() {
  const BasicMessageChannel = Java.use(
    "io.flutter.plugin.common.BasicMessageChannel",
  );
  const MessageHandler = Java.use(
    "io.flutter.plugin.common.BasicMessageChannel$MessageHandler",
  );
  const classNameBase = "BMH";
  const HandlerProxy = Java.registerClass({
    name: nextClassName(classNameBase),
    implements: [MessageHandler],
    fields: {
      delegate: "io.flutter.plugin.common.BasicMessageChannel$MessageHandler",
      channelName: "java.lang.String",
    },
    methods: {
      $init: [
        {
          returnType: "void",
          argumentTypes: [
            "io.flutter.plugin.common.BasicMessageChannel$MessageHandler",
            "java.lang.String",
          ],
          implementation(this: Java.Wrapper, d: Java.Wrapper, n: Java.Wrapper) {
            this.delegate.value = d;
            this.channelName.value = n;
          },
        },
      ],
      onMessage: [
        {
          returnType: "void",
          argumentTypes: [
            "java.lang.Object",
            "io.flutter.plugin.common.BasicMessageChannel$Reply",
          ],
          implementation(
            this: Java.Wrapper,
            message: Java.Wrapper,
            reply: Java.Wrapper,
          ) {
            const name = this.channelName.value.toString();
            emit("message", "dart", name, { args: safelyConvert(message) });
            this.delegate.value.onMessage(message, reply);
          },
        },
      ],
    },
  });

  wrapHandler(
    BasicMessageChannel.setMessageHandler.overload(
      "io.flutter.plugin.common.BasicMessageChannel$MessageHandler",
    ),
    classNameBase,
    HandlerProxy,
  );

  // send(Object)
  patch(
    BasicMessageChannel.send.overload("java.lang.Object"),
    (original, self, args) => {
      const [msg] = args as [Java.Wrapper];
      emit("message", "native", self.name.value, { args: safelyConvert(msg) });
      return original.call(self, msg);
    },
  );

  // send(Object, Reply)
  patch(
    BasicMessageChannel.send.overload(
      "java.lang.Object",
      "io.flutter.plugin.common.BasicMessageChannel$Reply",
    ),
    (original, self, args) => {
      const [msg, reply] = args as [Java.Wrapper, Java.Wrapper];
      emit("message", "native", self.name.value, { args: safelyConvert(msg) });
      return original.call(self, msg, reply);
    },
  );
}

function hookEventChannel() {
  const EventChannel = Java.use("io.flutter.plugin.common.EventChannel");
  const StreamHandler = Java.use(
    "io.flutter.plugin.common.EventChannel$StreamHandler",
  );
  const EventSink = Java.use("io.flutter.plugin.common.EventChannel$EventSink");
  const sinkBase = "ES";
  const handlerBase = "SH";

  const SinkProxy = Java.registerClass({
    name: nextClassName(sinkBase),
    implements: [EventSink],
    fields: {
      delegate: "io.flutter.plugin.common.EventChannel$EventSink",
      channelName: "java.lang.String",
    },
    methods: {
      $init: [
        {
          returnType: "void",
          argumentTypes: [
            "io.flutter.plugin.common.EventChannel$EventSink",
            "java.lang.String",
          ],
          implementation(this: Java.Wrapper, d: Java.Wrapper, n: Java.Wrapper) {
            this.delegate.value = d;
            this.channelName.value = n;
          },
        },
      ],
      success: [
        {
          returnType: "void",
          argumentTypes: ["java.lang.Object"],
          implementation(this: Java.Wrapper, value: Java.Wrapper) {
            const name = this.channelName.value.toString();
            emit("event", "native", name, {
              method: "success",
              result: safelyConvert(value),
            });
            this.delegate.value.success(value);
          },
        },
      ],
      error: [
        {
          returnType: "void",
          argumentTypes: [
            "java.lang.String",
            "java.lang.String",
            "java.lang.Object",
          ],
          implementation(
            this: Java.Wrapper,
            code: Java.Wrapper,
            message: Java.Wrapper,
            details: Java.Wrapper,
          ) {
            const name = this.channelName.value.toString();
            emit("event", "native", name, {
              method: "error",
              result: {
                code: code?.toString(),
                message: message?.toString(),
                details: safelyConvert(details),
              },
            });
            this.delegate.value.error(code, message, details);
          },
        },
      ],
      endOfStream: [
        {
          returnType: "void",
          argumentTypes: [],
          implementation(this: Java.Wrapper) {
            const name = this.channelName.value.toString();
            emit("event", "native", name, { method: "endOfStream" });
            this.delegate.value.endOfStream();
          },
        },
      ],
    },
  });

  const StreamHandlerProxy = Java.registerClass({
    name: nextClassName(handlerBase),
    implements: [StreamHandler],
    fields: {
      delegate: "io.flutter.plugin.common.EventChannel$StreamHandler",
      channelName: "java.lang.String",
    },
    methods: {
      $init: [
        {
          returnType: "void",
          argumentTypes: [
            "io.flutter.plugin.common.EventChannel$StreamHandler",
            "java.lang.String",
          ],
          implementation(this: Java.Wrapper, d: Java.Wrapper, n: Java.Wrapper) {
            this.delegate.value = d;
            this.channelName.value = n;
          },
        },
      ],
      onListen: [
        {
          returnType: "void",
          argumentTypes: [
            "java.lang.Object",
            "io.flutter.plugin.common.EventChannel$EventSink",
          ],
          implementation(
            this: Java.Wrapper,
            a: Java.Wrapper,
            sink: Java.Wrapper,
          ) {
            const name = this.channelName.value.toString();
            emit("event", "dart", name, {
              method: "listen",
              args: safelyConvert(a),
            });
            const wrapped = SinkProxy.$new(sink, this.channelName.value);
            this.delegate.value.onListen(a, wrapped);
          },
        },
      ],
      onCancel: [
        {
          returnType: "void",
          argumentTypes: ["java.lang.Object"],
          implementation(this: Java.Wrapper, a: Java.Wrapper) {
            const name = this.channelName.value.toString();
            emit("event", "dart", name, {
              method: "cancel",
              args: safelyConvert(a),
            });
            this.delegate.value.onCancel(a);
          },
        },
      ],
    },
  });

  wrapHandler(
    EventChannel.setStreamHandler.overload(
      "io.flutter.plugin.common.EventChannel$StreamHandler",
    ),
    handlerBase,
    StreamHandlerProxy,
  );
}

export function stop() {
  Java.perform(() => {
    for (let i = restores.length - 1; i >= 0; i--) {
      try {
        restores[i]();
      } catch {}
    }
  });
  restores.length = 0;
  running = false;
}

export function status(): boolean {
  return running;
}

export function available() {
  if (!Java.available) return false;
  const engine = Process.findModuleByName("libflutter.so");
  if (!engine) return false;
  let found = false;
  Java.perform(() => {
    try {
      Java.use("io.flutter.plugin.common.MethodChannel");
      found = true;
    } catch {}
  });
  return found;
}

function emit(
  type: ChannelType,
  dir: Direction,
  channel: string,
  detail: Record<string, unknown>,
) {
  send({ subject, type, dir, channel, ...detail });
}

```

`agent/src/droid/hooks/index.ts`:

```ts
import { createJava, type JavaHookEntry } from "@/common/hooks/group.js";
import * as native from "@/common/hooks/native.js";

import * as clipboard from "./clipboard.js";
import * as broadcast from "./broadcast.js";
import * as intent from "./intent.js";
import * as sharedpref from "./sharedpref.js";

const registry = new Map<string, JavaHookEntry>();

registry.set("clipboard", clipboard);
registry.set("broadcast", broadcast);
registry.set("intent", intent);
registry.set("sharedpref", sharedpref);

const { list, status, start, stop } = createJava(registry);
export { list, status, start, stop };

export interface UserHook {
  type: "native";
  module?: string | null;
  name: string;
  sig?: { args: string[]; returns: string };
}

export function userHooks(): UserHook[] {
  return native.list().map(({ module, name, sig }) => ({
    type: "native",
    module,
    name,
    sig,
  }));
}

```

`agent/src/droid/hooks/intent.ts`:

```ts
import Java from "frida-java-bridge";

import type { BaseMessage } from "@/common/hooks/context.js";
import { patch as createPatch, backtrace } from "@/common/hooks/java.js";
import { toJS } from "@/droid/bridge/object.js";

const restores: Array<() => void> = [];
let running = false;

const patch = createPatch(restores);


function describeIntent(intent: Java.Wrapper): Record<string, unknown> {
  const info: Record<string, unknown> = {};
  try {
    const action = intent.getAction();
    if (action) info.action = action.toString();

    const component = intent.getComponent();
    if (component) info.component = component.flattenToString().toString();

    const data = intent.getDataString();
    if (data) info.data = data.toString();

    const type = intent.getType();
    if (type) info.type = type.toString();

    const categories = intent.getCategories();
    if (categories && !categories.isEmpty()) {
      const arr: string[] = [];
      const it = categories.iterator();
      let count = 0;
      while (it.hasNext() && count < 16) {
        arr.push(it.next().toString());
        count++;
      }
      info.categories = arr;
    }

    const extras = intent.getExtras();
    if (extras) {
      try {
        const map: Record<string, unknown> = {};
        const keys = extras.keySet();
        const it = keys.iterator();
        let count = 0;
        while (it.hasNext() && count < 32) {
          const key = it.next().toString();
          try {
            map[key] = toJS(extras.get(key));
          } catch {
            map[key] = "<unreadable>";
          }
          count++;
        }
        info.extras = map;
      } catch { /* ignore */ }
    }

    const flags = intent.getFlags();
    if (flags !== 0) info.flags = `0x${(flags >>> 0).toString(16)}`;
  } catch { /* ignore */ }

  return info;
}

function intentSummary(intent: Java.Wrapper): string {
  try {
    const component = intent.getComponent()?.flattenToString()?.toString();
    if (component) return component;
    const action = intent.getAction()?.toString();
    if (action) return action;
    return intent.toString();
  } catch {
    return "<intent>";
  }
}

export function start() {
  if (running || !available()) return;
  running = true;

  Java.perform(() => {
    try {
      hookActivityStart();
    } catch (e) {
      console.warn("intent: Activity hooks unavailable:", e);
    }

    try {
      hookServiceStart();
    } catch (e) {
      console.warn("intent: Service hooks unavailable:", e);
    }
  });
}

function hookActivityStart() {
  const Activity = Java.use("android.app.Activity");

  // startActivity(Intent)
  patch(
    Activity.startActivity.overload("android.content.Intent"),
    (original, self, args) => {
      const [intent] = args as [Java.Wrapper];

      send({
        subject: "hook",
        category: "intent",
        symbol: "Activity.startActivity",
        dir: "enter",
        line: `startActivity(${intentSummary(intent)})`,
        backtrace: backtrace(),
        extra: { op: "startActivity", caller: self.$className, ...describeIntent(intent) },
      } satisfies BaseMessage);

      return original.call(self, intent);
    },
  );

  // startActivity(Intent, Bundle)
  try {
    patch(
      Activity.startActivity.overload("android.content.Intent", "android.os.Bundle"),
      (original, self, args) => {
        const [intent, options] = args as [Java.Wrapper, Java.Wrapper | null];

        send({
          subject: "hook",
          category: "intent",
          symbol: "Activity.startActivity",
          dir: "enter",
          line: `startActivity(${intentSummary(intent)}, options)`,
          backtrace: backtrace(),
          extra: { op: "startActivity", caller: self.$className, ...describeIntent(intent) },
        } satisfies BaseMessage);

        return original.call(self, intent, options);
      },
    );
  } catch { /* overload may not exist */ }

  // startActivityForResult(Intent, int)
  try {
    patch(
      Activity.startActivityForResult.overload("android.content.Intent", "int"),
      (original, self, args) => {
        const [intent, requestCode] = args as [Java.Wrapper, number];

        send({
          subject: "hook",
          category: "intent",
          symbol: "Activity.startActivityForResult",
          dir: "enter",
          line: `startActivityForResult(${intentSummary(intent)}, ${requestCode})`,
          backtrace: backtrace(),
          extra: {
            op: "startActivityForResult",
            caller: self.$className,
            requestCode,
            ...describeIntent(intent),
          },
        } satisfies BaseMessage);

        return original.call(self, intent, requestCode);
      },
    );
  } catch { /* overload may not exist */ }

  // startActivityForResult(Intent, int, Bundle)
  try {
    patch(
      Activity.startActivityForResult.overload(
        "android.content.Intent",
        "int",
        "android.os.Bundle",
      ),
      (original, self, args) => {
        const [intent, requestCode, options] = args as [Java.Wrapper, number, Java.Wrapper | null];

        send({
          subject: "hook",
          category: "intent",
          symbol: "Activity.startActivityForResult",
          dir: "enter",
          line: `startActivityForResult(${intentSummary(intent)}, ${requestCode}, options)`,
          backtrace: backtrace(),
          extra: {
            op: "startActivityForResult",
            caller: self.$className,
            requestCode,
            ...describeIntent(intent),
          },
        } satisfies BaseMessage);

        return original.call(self, intent, requestCode, options);
      },
    );
  } catch { /* overload may not exist */ }
}

function hookServiceStart() {
  const ContextWrapper = Java.use("android.content.ContextWrapper");

  // startService(Intent)
  patch(
    ContextWrapper.startService.overload("android.content.Intent"),
    (original, self, args) => {
      const [intent] = args as [Java.Wrapper];

      send({
        subject: "hook",
        category: "intent",
        symbol: "Context.startService",
        dir: "enter",
        line: `startService(${intentSummary(intent)})`,
        backtrace: backtrace(),
        extra: { op: "startService", caller: self.$className, ...describeIntent(intent) },
      } satisfies BaseMessage);

      return original.call(self, intent);
    },
  );

  // stopService(Intent)
  try {
    patch(
      ContextWrapper.stopService.overload("android.content.Intent"),
      (original, self, args) => {
        const [intent] = args as [Java.Wrapper];

        send({
          subject: "hook",
          category: "intent",
          symbol: "Context.stopService",
          dir: "enter",
          line: `stopService(${intentSummary(intent)})`,
          backtrace: backtrace(),
          extra: { op: "stopService", caller: self.$className, ...describeIntent(intent) },
        } satisfies BaseMessage);

        return original.call(self, intent);
      },
    );
  } catch { /* overload may not exist */ }

  // bindService(Intent, ServiceConnection, int)
  try {
    patch(
      ContextWrapper.bindService.overload(
        "android.content.Intent",
        "android.content.ServiceConnection",
        "int",
      ),
      (original, self, args) => {
        const [intent, conn, flags] = args as [Java.Wrapper, Java.Wrapper, number];

        send({
          subject: "hook",
          category: "intent",
          symbol: "Context.bindService",
          dir: "enter",
          line: `bindService(${intentSummary(intent)}, flags=0x${(flags >>> 0).toString(16)})`,
          backtrace: backtrace(),
          extra: {
            op: "bindService",
            caller: self.$className,
            flags: `0x${(flags >>> 0).toString(16)}`,
            ...describeIntent(intent),
          },
        } satisfies BaseMessage);

        return original.call(self, intent, conn, flags);
      },
    );
  } catch { /* overload may not exist */ }

  // startForegroundService(Intent)
  try {
    patch(
      ContextWrapper.startForegroundService.overload("android.content.Intent"),
      (original, self, args) => {
        const [intent] = args as [Java.Wrapper];

        send({
          subject: "hook",
          category: "intent",
          symbol: "Context.startForegroundService",
          dir: "enter",
          line: `startForegroundService(${intentSummary(intent)})`,
          backtrace: backtrace(),
          extra: { op: "startForegroundService", caller: self.$className, ...describeIntent(intent) },
        } satisfies BaseMessage);

        return original.call(self, intent);
      },
    );
  } catch { /* may not exist on older API levels */ }
}

export function stop() {
  Java.perform(() => {
    for (let i = restores.length - 1; i >= 0; i--) {
      try {
        restores[i]();
      } catch { /* ignore */ }
    }
  });
  restores.length = 0;
  running = false;
}

export function status(): boolean {
  return running;
}

export function available(): boolean {
  if (!Java.available) return false;
  let found = false;
  Java.perform(() => {
    try {
      Java.use("android.app.Activity");
      found = true;
    } catch { /* not found */ }
  });
  return found;
}

```

`agent/src/droid/hooks/jni.ts`:

```ts
/**
 * ported from https://github.com/chame1eon/jnitrace-engine

MIT License

Copyright (c) 2019 chame1eon

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
 */

import Java from "frida-java-bridge";
// bug: capturing backtrace causes crashes in some apps, skip for now
// import { bt } from "@/common/hooks/context.js";
import { findGlobalExport } from "@/lib/polyfill.js";

export interface JNIEvent {
  subject: string;
  type: string;
  method: string;
  callType: string;
  threadId: number;
  args: string[];
  ret: string;
  library?: string;
}

export interface JNILog {
  id: number;
  timestamp: string;
  type: string;
  method: string;
  callType: string;
  threadId: number | null;
  args?: string[];
  ret: string | null;
  backtrace?: string[];
  library: string | null;
  createdAt: string;
}

interface MethodDef {
  name: string;
  args: string[];
  ret: string;
}

const subject = "jni";
let listeners: InvocationListener[] = [];
const tracingThreads = new Set<number>();
let active = false;

// JNIEnv function table
const JNI_ENV: MethodDef[] = [
  { name: "reserved0", args: [], ret: "void" },
  { name: "reserved1", args: [], ret: "void" },
  { name: "reserved2", args: [], ret: "void" },
  { name: "reserved3", args: [], ret: "void" },
  { name: "GetVersion", args: ["JNIEnv*"], ret: "jint" },
  {
    name: "DefineClass",
    args: ["JNIEnv*", "char*", "jobject", "jbyte*", "jsize"],
    ret: "jclass",
  },
  { name: "FindClass", args: ["JNIEnv*", "char*"], ret: "jclass" },
  {
    name: "FromReflectedMethod",
    args: ["JNIEnv*", "jobject"],
    ret: "jmethodID",
  },
  { name: "FromReflectedField", args: ["JNIEnv*", "jobject"], ret: "jfieldID" },
  {
    name: "ToReflectedMethod",
    args: ["JNIEnv*", "jclass", "jmethodID", "jboolean"],
    ret: "jobject",
  },
  { name: "GetSuperclass", args: ["JNIEnv*", "jclass"], ret: "jclass" },
  {
    name: "IsAssignableFrom",
    args: ["JNIEnv*", "jclass", "jclass"],
    ret: "jboolean",
  },
  {
    name: "ToReflectedField",
    args: ["JNIEnv*", "jclass", "jfieldID", "jboolean"],
    ret: "jobject",
  },
  { name: "Throw", args: ["JNIEnv*", "jthrowable"], ret: "jint" },
  { name: "ThrowNew", args: ["JNIEnv*", "jclass", "char*"], ret: "jint" },
  { name: "ExceptionOccurred", args: ["JNIEnv*"], ret: "jthrowable" },
  { name: "ExceptionDescribe", args: ["JNIEnv*"], ret: "void" },
  { name: "ExceptionClear", args: ["JNIEnv*"], ret: "void" },
  { name: "FatalError", args: ["JNIEnv*", "char*"], ret: "void" },
  { name: "PushLocalFrame", args: ["JNIEnv*", "jint"], ret: "jint" },
  { name: "PopLocalFrame", args: ["JNIEnv*", "jobject"], ret: "jobject" },
  { name: "NewGlobalRef", args: ["JNIEnv*", "jobject"], ret: "jobject" },
  { name: "DeleteGlobalRef", args: ["JNIEnv*", "jobject"], ret: "void" },
  { name: "DeleteLocalRef", args: ["JNIEnv*", "jobject"], ret: "void" },
  {
    name: "IsSameObject",
    args: ["JNIEnv*", "jobject", "jobject"],
    ret: "jboolean",
  },
  { name: "NewLocalRef", args: ["JNIEnv*", "jobject"], ret: "jobject" },
  { name: "EnsureLocalCapacity", args: ["JNIEnv*", "jint"], ret: "jint" },
  { name: "AllocObject", args: ["JNIEnv*", "jclass"], ret: "jobject" },
  {
    name: "NewObject",
    args: ["JNIEnv*", "jclass", "jmethodID", "..."],
    ret: "jobject",
  },
  {
    name: "NewObjectV",
    args: ["JNIEnv*", "jclass", "jmethodID", "va_list"],
    ret: "jobject",
  },
  {
    name: "NewObjectA",
    args: ["JNIEnv*", "jclass", "jmethodID", "jvalue*"],
    ret: "jobject",
  },
  { name: "GetObjectClass", args: ["JNIEnv*", "jobject"], ret: "jclass" },
  {
    name: "IsInstanceOf",
    args: ["JNIEnv*", "jobject", "jclass"],
    ret: "jboolean",
  },
  {
    name: "GetMethodID",
    args: ["JNIEnv*", "jclass", "char*", "char*"],
    ret: "jmethodID",
  },
  {
    name: "CallObjectMethod",
    args: ["JNIEnv*", "jobject", "jmethodID", "..."],
    ret: "jobject",
  },
  {
    name: "CallObjectMethodV",
    args: ["JNIEnv*", "jobject", "jmethodID", "va_list"],
    ret: "jobject",
  },
  {
    name: "CallObjectMethodA",
    args: ["JNIEnv*", "jobject", "jmethodID", "jvalue*"],
    ret: "jobject",
  },
  {
    name: "CallBooleanMethod",
    args: ["JNIEnv*", "jobject", "jmethodID", "..."],
    ret: "jboolean",
  },
  {
    name: "CallBooleanMethodV",
    args: ["JNIEnv*", "jobject", "jmethodID", "va_list"],
    ret: "jboolean",
  },
  {
    name: "CallBooleanMethodA",
    args: ["JNIEnv*", "jobject", "jmethodID", "jvalue*"],
    ret: "jboolean",
  },
  {
    name: "CallByteMethod",
    args: ["JNIEnv*", "jobject", "jmethodID", "..."],
    ret: "jbyte",
  },
  {
    name: "CallByteMethodV",
    args: ["JNIEnv*", "jobject", "jmethodID", "va_list"],
    ret: "jbyte",
  },
  {
    name: "CallByteMethodA",
    args: ["JNIEnv*", "jobject", "jmethodID", "jvalue*"],
    ret: "jbyte",
  },
  {
    name: "CallCharMethod",
    args: ["JNIEnv*", "jobject", "jmethodID", "..."],
    ret: "jchar",
  },
  {
    name: "CallCharMethodV",
    args: ["JNIEnv*", "jobject", "jmethodID", "va_list"],
    ret: "jchar",
  },
  {
    name: "CallCharMethodA",
    args: ["JNIEnv*", "jobject", "jmethodID", "jvalue*"],
    ret: "jchar",
  },
  {
    name: "CallShortMethod",
    args: ["JNIEnv*", "jobject", "jmethodID", "..."],
    ret: "jshort",
  },
  {
    name: "CallShortMethodV",
    args: ["JNIEnv*", "jobject", "jmethodID", "va_list"],
    ret: "jshort",
  },
  {
    name: "CallShortMethodA",
    args: ["JNIEnv*", "jobject", "jmethodID", "jvalue*"],
    ret: "jshort",
  },
  {
    name: "CallIntMethod",
    args: ["JNIEnv*", "jobject", "jmethodID", "..."],
    ret: "jint",
  },
  {
    name: "CallIntMethodV",
    args: ["JNIEnv*", "jobject", "jmethodID", "va_list"],
    ret: "jint",
  },
  {
    name: "CallIntMethodA",
    args: ["JNIEnv*", "jobject", "jmethodID", "jvalue*"],
    ret: "jint",
  },
  {
    name: "CallLongMethod",
    args: ["JNIEnv*", "jobject", "jmethodID", "..."],
    ret: "jlong",
  },
  {
    name: "CallLongMethodV",
    args: ["JNIEnv*", "jobject", "jmethodID", "va_list"],
    ret: "jlong",
  },
  {
    name: "CallLongMethodA",
    args: ["JNIEnv*", "jobject", "jmethodID", "jvalue*"],
    ret: "jlong",
  },
  {
    name: "CallFloatMethod",
    args: ["JNIEnv*", "jobject", "jmethodID", "..."],
    ret: "jfloat",
  },
  {
    name: "CallFloatMethodV",
    args: ["JNIEnv*", "jobject", "jmethodID", "va_list"],
    ret: "jfloat",
  },
  {
    name: "CallFloatMethodA",
    args: ["JNIEnv*", "jobject", "jmethodID", "jvalue*"],
    ret: "jfloat",
  },
  {
    name: "CallDoubleMethod",
    args: ["JNIEnv*", "jobject", "jmethodID", "..."],
    ret: "jdouble",
  },
  {
    name: "CallDoubleMethodV",
    args: ["JNIEnv*", "jobject", "jmethodID", "va_list"],
    ret: "jdouble",
  },
  {
    name: "CallDoubleMethodA",
    args: ["JNIEnv*", "jobject", "jmethodID", "jvalue*"],
    ret: "jdouble",
  },
  {
    name: "CallVoidMethod",
    args: ["JNIEnv*", "jobject", "jmethodID", "..."],
    ret: "void",
  },
  {
    name: "CallVoidMethodV",
    args: ["JNIEnv*", "jobject", "jmethodID", "va_list"],
    ret: "void",
  },
  {
    name: "CallVoidMethodA",
    args: ["JNIEnv*", "jobject", "jmethodID", "jvalue*"],
    ret: "void",
  },
  {
    name: "CallNonvirtualObjectMethod",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "..."],
    ret: "jobject",
  },
  {
    name: "CallNonvirtualObjectMethodV",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "va_list"],
    ret: "jobject",
  },
  {
    name: "CallNonvirtualObjectMethodA",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "jvalue*"],
    ret: "jobject",
  },
  {
    name: "CallNonvirtualBooleanMethod",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "..."],
    ret: "jboolean",
  },
  {
    name: "CallNonvirtualBooleanMethodV",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "va_list"],
    ret: "jboolean",
  },
  {
    name: "CallNonvirtualBooleanMethodA",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "jvalue*"],
    ret: "jboolean",
  },
  {
    name: "CallNonvirtualByteMethod",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "..."],
    ret: "jbyte",
  },
  {
    name: "CallNonvirtualByteMethodV",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "va_list"],
    ret: "jbyte",
  },
  {
    name: "CallNonvirtualByteMethodA",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "jvalue*"],
    ret: "jbyte",
  },
  {
    name: "CallNonvirtualCharMethod",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "..."],
    ret: "jchar",
  },
  {
    name: "CallNonvirtualCharMethodV",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "va_list"],
    ret: "jchar",
  },
  {
    name: "CallNonvirtualCharMethodA",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "jvalue*"],
    ret: "jchar",
  },
  {
    name: "CallNonvirtualShortMethod",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "..."],
    ret: "jshort",
  },
  {
    name: "CallNonvirtualShortMethodV",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "va_list"],
    ret: "jshort",
  },
  {
    name: "CallNonvirtualShortMethodA",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "jvalue*"],
    ret: "jshort",
  },
  {
    name: "CallNonvirtualIntMethod",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "..."],
    ret: "jint",
  },
  {
    name: "CallNonvirtualIntMethodV",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "va_list"],
    ret: "jint",
  },
  {
    name: "CallNonvirtualIntMethodA",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "jvalue*"],
    ret: "jint",
  },
  {
    name: "CallNonvirtualLongMethod",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "..."],
    ret: "jlong",
  },
  {
    name: "CallNonvirtualLongMethodV",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "va_list"],
    ret: "jlong",
  },
  {
    name: "CallNonvirtualLongMethodA",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "jvalue*"],
    ret: "jlong",
  },
  {
    name: "CallNonvirtualFloatMethod",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "..."],
    ret: "jfloat",
  },
  {
    name: "CallNonvirtualFloatMethodV",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "va_list"],
    ret: "jfloat",
  },
  {
    name: "CallNonvirtualFloatMethodA",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "jvalue*"],
    ret: "jfloat",
  },
  {
    name: "CallNonvirtualDoubleMethod",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "..."],
    ret: "jdouble",
  },
  {
    name: "CallNonvirtualDoubleMethodV",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "va_list"],
    ret: "jdouble",
  },
  {
    name: "CallNonvirtualDoubleMethodA",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "jvalue*"],
    ret: "jdouble",
  },
  {
    name: "CallNonvirtualVoidMethod",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "..."],
    ret: "void",
  },
  {
    name: "CallNonvirtualVoidMethodV",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "va_list"],
    ret: "void",
  },
  {
    name: "CallNonvirtualVoidMethodA",
    args: ["JNIEnv*", "jobject", "jclass", "jmethodID", "jvalue*"],
    ret: "void",
  },
  {
    name: "GetFieldID",
    args: ["JNIEnv*", "jclass", "char*", "char*"],
    ret: "jfieldID",
  },
  {
    name: "GetObjectField",
    args: ["JNIEnv*", "jobject", "jfieldID"],
    ret: "jobject",
  },
  {
    name: "GetBooleanField",
    args: ["JNIEnv*", "jobject", "jfieldID"],
    ret: "jboolean",
  },
  {
    name: "GetByteField",
    args: ["JNIEnv*", "jobject", "jfieldID"],
    ret: "jbyte",
  },
  {
    name: "GetCharField",
    args: ["JNIEnv*", "jobject", "jfieldID"],
    ret: "jchar",
  },
  {
    name: "GetShortField",
    args: ["JNIEnv*", "jobject", "jfieldID"],
    ret: "jshort",
  },
  {
    name: "GetIntField",
    args: ["JNIEnv*", "jobject", "jfieldID"],
    ret: "jint",
  },
  {
    name: "GetLongField",
    args: ["JNIEnv*", "jobject", "jfieldID"],
    ret: "jlong",
  },
  {
    name: "GetFloatField",
    args: ["JNIEnv*", "jobject", "jfieldID"],
    ret: "jfloat",
  },
  {
    name: "GetDoubleField",
    args: ["JNIEnv*", "jobject", "jfieldID"],
    ret: "jdouble",
  },
  {
    name: "SetObjectField",
    args: ["JNIEnv*", "jobject", "jfieldID", "jobject"],
    ret: "void",
  },
  {
    name: "SetBooleanField",
    args: ["JNIEnv*", "jobject", "jfieldID", "jboolean"],
    ret: "void",
  },
  {
    name: "SetByteField",
    args: ["JNIEnv*", "jobject", "jfieldID", "jbyte"],
    ret: "void",
  },
  {
    name: "SetCharField",
    args: ["JNIEnv*", "jobject", "jfieldID", "jchar"],
    ret: "void",
  },
  {
    name: "SetShortField",
    args: ["JNIEnv*", "jobject", "jfieldID", "jshort"],
    ret: "void",
  },
  {
    name: "SetIntField",
    args: ["JNIEnv*", "jobject", "jfieldID", "jint"],
    ret: "void",
  },
  {
    name: "SetLongField",
    args: ["JNIEnv*", "jobject", "jfieldID", "jlong"],
    ret: "void",
  },
  {
    name: "SetFloatField",
    args: ["JNIEnv*", "jobject", "jfieldID", "jfloat"],
    ret: "void",
  },
  {
    name: "SetDoubleField",
    args: ["JNIEnv*", "jobject", "jfieldID", "jdouble"],
    ret: "void",
  },
  {
    name: "GetStaticMethodID",
    args: ["JNIEnv*", "jclass", "char*", "char*"],
    ret: "jmethodID",
  },
  {
    name: "CallStaticObjectMethod",
    args: ["JNIEnv*", "jclass", "jmethodID", "..."],
    ret: "jobject",
  },
  {
    name: "CallStaticObjectMethodV",
    args: ["JNIEnv*", "jclass", "jmethodID", "va_list"],
    ret: "jobject",
  },
  {
    name: "CallStaticObjectMethodA",
    args: ["JNIEnv*", "jclass", "jmethodID", "jvalue*"],
    ret: "jobject",
  },
  {
    name: "CallStaticBooleanMethod",
    args: ["JNIEnv*", "jclass", "jmethodID", "..."],
    ret: "jboolean",
  },
  {
    name: "CallStaticBooleanMethodV",
    args: ["JNIEnv*", "jclass", "jmethodID", "va_list"],
    ret: "jboolean",
  },
  {
    name: "CallStaticBooleanMethodA",
    args: ["JNIEnv*", "jclass", "jmethodID", "jvalue*"],
    ret: "jboolean",
  },
  {
    name: "CallStaticByteMethod",
    args: ["JNIEnv*", "jclass", "jmethodID", "..."],
    ret: "jbyte",
  },
  {
    name: "CallStaticByteMethodV",
    args: ["JNIEnv*", "jclass", "jmethodID", "va_list"],
    ret: "jbyte",
  },
  {
    name: "CallStaticByteMethodA",
    args: ["JNIEnv*", "jclass", "jmethodID", "jvalue*"],
    ret: "jbyte",
  },
  {
    name: "CallStaticCharMethod",
    args: ["JNIEnv*", "jclass", "jmethodID", "..."],
    ret: "jchar",
  },
  {
    name: "CallStaticCharMethodV",
    args: ["JNIEnv*", "jclass", "jmethodID", "va_list"],
    ret: "jchar",
  },
  {
    name: "CallStaticCharMethodA",
    args: ["JNIEnv*", "jclass", "jmethodID", "jvalue*"],
    ret: "jchar",
  },
  {
    name: "CallStaticShortMethod",
    args: ["JNIEnv*", "jclass", "jmethodID", "..."],
    ret: "jshort",
  },
  {
    name: "CallStaticShortMethodV",
    args: ["JNIEnv*", "jclass", "jmethodID", "va_list"],
    ret: "jshort",
  },
  {
    name: "CallStaticShortMethodA",
    args: ["JNIEnv*", "jclass", "jmethodID", "jvalue*"],
    ret: "jshort",
  },
  {
    name: "CallStaticIntMethod",
    args: ["JNIEnv*", "jclass", "jmethodID", "..."],
    ret: "jint",
  },
  {
    name: "CallStaticIntMethodV",
    args: ["JNIEnv*", "jclass", "jmethodID", "va_list"],
    ret: "jint",
  },
  {
    name: "CallStaticIntMethodA",
    args: ["JNIEnv*", "jclass", "jmethodID", "jvalue*"],
    ret: "jint",
  },
  {
    name: "CallStaticLongMethod",
    args: ["JNIEnv*", "jclass", "jmethodID", "..."],
    ret: "jlong",
  },
  {
    name: "CallStaticLongMethodV",
    args: ["JNIEnv*", "jclass", "jmethodID", "va_list"],
    ret: "jlong",
  },
  {
    name: "CallStaticLongMethodA",
    args: ["JNIEnv*", "jclass", "jmethodID", "jvalue*"],
    ret: "jlong",
  },
  {
    name: "CallStaticFloatMethod",
    args: ["JNIEnv*", "jclass", "jmethodID", "..."],
    ret: "jfloat",
  },
  {
    name: "CallStaticFloatMethodV",
    args: ["JNIEnv*", "jclass", "jmethodID", "va_list"],
    ret: "jfloat",
  },
  {
    name: "CallStaticFloatMethodA",
    args: ["JNIEnv*", "jclass", "jmethodID", "jvalue*"],
    ret: "jfloat",
  },
  {
    name: "CallStaticDoubleMethod",
    args: ["JNIEnv*", "jclass", "jmethodID", "..."],
    ret: "jdouble",
  },
  {
    name: "CallStaticDoubleMethodV",
    args: ["JNIEnv*", "jclass", "jmethodID", "va_list"],
    ret: "jdouble",
  },
  {
    name: "CallStaticDoubleMethodA",
    args: ["JNIEnv*", "jclass", "jmethodID", "jvalue*"],
    ret: "jdouble",
  },
  {
    name: "CallStaticVoidMethod",
    args: ["JNIEnv*", "jclass", "jmethodID", "..."],
    ret: "void",
  },
  {
    name: "CallStaticVoidMethodV",
    args: ["JNIEnv*", "jclass", "jmethodID", "va_list"],
    ret: "void",
  },
  {
    name: "CallStaticVoidMethodA",
    args: ["JNIEnv*", "jclass", "jmethodID", "jvalue*"],
    ret: "void",
  },
  {
    name: "GetStaticFieldID",
    args: ["JNIEnv*", "jclass", "char*", "char*"],
    ret: "jfieldID",
  },
  {
    name: "GetStaticObjectField",
    args: ["JNIEnv*", "jclass", "jfieldID"],
    ret: "jobject",
  },
  {
    name: "GetStaticBooleanField",
    args: ["JNIEnv*", "jclass", "jfieldID"],
    ret: "jboolean",
  },
  {
    name: "GetStaticByteField",
    args: ["JNIEnv*", "jclass", "jfieldID"],
    ret: "jbyte",
  },
  {
    name: "GetStaticCharField",
    args: ["JNIEnv*", "jclass", "jfieldID"],
    ret: "jchar",
  },
  {
    name: "GetStaticShortField",
    args: ["JNIEnv*", "jclass", "jfieldID"],
    ret: "jshort",
  },
  {
    name: "GetStaticIntField",
    args: ["JNIEnv*", "jclass", "jfieldID"],
    ret: "jint",
  },
  {
    name: "GetStaticLongField",
    args: ["JNIEnv*", "jclass", "jfieldID"],
    ret: "jlong",
  },
  {
    name: "GetStaticFloatField",
    args: ["JNIEnv*", "jclass", "jfieldID"],
    ret: "jfloat",
  },
  {
    name: "GetStaticDoubleField",
    args: ["JNIEnv*", "jclass", "jfieldID"],
    ret: "jdouble",
  },
  {
    name: "SetStaticObjectField",
    args: ["JNIEnv*", "jclass", "jfieldID", "jobject"],
    ret: "void",
  },
  {
    name: "SetStaticBooleanField",
    args: ["JNIEnv*", "jclass", "jfieldID", "jboolean"],
    ret: "void",
  },
  {
    name: "SetStaticByteField",
    args: ["JNIEnv*", "jclass", "jfieldID", "jbyte"],
    ret: "void",
  },
  {
    name: "SetStaticCharField",
    args: ["JNIEnv*", "jclass", "jfieldID", "jchar"],
    ret: "void",
  },
  {
    name: "SetStaticShortField",
    args: ["JNIEnv*", "jclass", "jfieldID", "jshort"],
    ret: "void",
  },
  {
    name: "SetStaticIntField",
    args: ["JNIEnv*", "jclass", "jfieldID", "jint"],
    ret: "void",
  },
  {
    name: "SetStaticLongField",
    args: ["JNIEnv*", "jclass", "jfieldID", "jlong"],
    ret: "void",
  },
  {
    name: "SetStaticFloatField",
    args: ["JNIEnv*", "jclass", "jfieldID", "jfloat"],
    ret: "void",
  },
  {
    name: "SetStaticDoubleField",
    args: ["JNIEnv*", "jclass", "jfieldID", "jdouble"],
    ret: "void",
  },
  { name: "NewString", args: ["JNIEnv*", "jchar*", "jsize"], ret: "jstring" },
  { name: "GetStringLength", args: ["JNIEnv*", "jstring"], ret: "jsize" },
  {
    name: "GetStringChars",
    args: ["JNIEnv*", "jstring", "jboolean*"],
    ret: "jchar*",
  },
  {
    name: "ReleaseStringChars",
    args: ["JNIEnv*", "jstring", "jchar*"],
    ret: "void",
  },
  { name: "NewStringUTF", args: ["JNIEnv*", "char*"], ret: "jstring" },
  { name: "GetStringUTFLength", args: ["JNIEnv*", "jstring"], ret: "jsize" },
  {
    name: "GetStringUTFChars",
    args: ["JNIEnv*", "jstring", "jboolean*"],
    ret: "char*",
  },
  {
    name: "ReleaseStringUTFChars",
    args: ["JNIEnv*", "jstring", "char*"],
    ret: "void",
  },
  { name: "GetArrayLength", args: ["JNIEnv*", "jarray"], ret: "jsize" },
  {
    name: "NewObjectArray",
    args: ["JNIEnv*", "jsize", "jclass", "jobject"],
    ret: "jobjectArray",
  },
  {
    name: "GetObjectArrayElement",
    args: ["JNIEnv*", "jobjectArray", "jsize"],
    ret: "jobject",
  },
  {
    name: "SetObjectArrayElement",
    args: ["JNIEnv*", "jobjectArray", "jsize", "jobject"],
    ret: "void",
  },
  { name: "NewBooleanArray", args: ["JNIEnv*", "jsize"], ret: "jbooleanArray" },
  { name: "NewByteArray", args: ["JNIEnv*", "jsize"], ret: "jbyteArray" },
  { name: "NewCharArray", args: ["JNIEnv*", "jsize"], ret: "jcharArray" },
  { name: "NewShortArray", args: ["JNIEnv*", "jsize"], ret: "jshortArray" },
  { name: "NewIntArray", args: ["JNIEnv*", "jsize"], ret: "jintArray" },
  { name: "NewLongArray", args: ["JNIEnv*", "jsize"], ret: "jlongArray" },
  { name: "NewFloatArray", args: ["JNIEnv*", "jsize"], ret: "jfloatArray" },
  { name: "NewDoubleArray", args: ["JNIEnv*", "jsize"], ret: "jdoubleArray" },
  {
    name: "GetBooleanArrayElements",
    args: ["JNIEnv*", "jbooleanArray", "jboolean*"],
    ret: "jboolean*",
  },
  {
    name: "GetByteArrayElements",
    args: ["JNIEnv*", "jbyteArray", "jboolean*"],
    ret: "jbyte*",
  },
  {
    name: "GetCharArrayElements",
    args: ["JNIEnv*", "jcharArray", "jboolean*"],
    ret: "jchar*",
  },
  {
    name: "GetShortArrayElements",
    args: ["JNIEnv*", "jshortArray", "jboolean*"],
    ret: "jshort*",
  },
  {
    name: "GetIntArrayElements",
    args: ["JNIEnv*", "jintArray", "jboolean*"],
    ret: "jint*",
  },
  {
    name: "GetLongArrayElements",
    args: ["JNIEnv*", "jlongArray", "jboolean*"],
    ret: "jlong*",
  },
  {
    name: "GetFloatArrayElements",
    args: ["JNIEnv*", "jfloatArray", "jboolean*"],
    ret: "jfloat*",
  },
  {
    name: "GetDoubleArrayElements",
    args: ["JNIEnv*", "jdoubleArray", "jboolean*"],
    ret: "jdouble*",
  },
  {
    name: "ReleaseBooleanArrayElements",
    args: ["JNIEnv*", "jbooleanArray", "jboolean*", "jint"],
    ret: "void",
  },
  {
    name: "ReleaseByteArrayElements",
    args: ["JNIEnv*", "jbyteArray", "jbyte*", "jint"],
    ret: "void",
  },
  {
    name: "ReleaseCharArrayElements",
    args: ["JNIEnv*", "jcharArray", "jchar*", "jint"],
    ret: "void",
  },
  {
    name: "ReleaseShortArrayElements",
    args: ["JNIEnv*", "jshortArray", "jshort*", "jint"],
    ret: "void",
  },
  {
    name: "ReleaseIntArrayElements",
    args: ["JNIEnv*", "jintArray", "jint*", "jint"],
    ret: "void",
  },
  {
    name: "ReleaseLongArrayElements",
    args: ["JNIEnv*", "jlongArray", "jlong*", "jint"],
    ret: "void",
  },
  {
    name: "ReleaseFloatArrayElements",
    args: ["JNIEnv*", "jfloatArray", "jfloat*", "jint"],
    ret: "void",
  },
  {
    name: "ReleaseDoubleArrayElements",
    args: ["JNIEnv*", "jdoubleArray", "jdouble*", "jint"],
    ret: "void",
  },
  {
    name: "GetBooleanArrayRegion",
    args: ["JNIEnv*", "jbooleanArray", "jsize", "jsize", "jboolean*"],
    ret: "void",
  },
  {
    name: "GetByteArrayRegion",
    args: ["JNIEnv*", "jbyteArray", "jsize", "jsize", "jbyte*"],
    ret: "void",
  },
  {
    name: "GetCharArrayRegion",
    args: ["JNIEnv*", "jcharArray", "jsize", "jsize", "jchar*"],
    ret: "void",
  },
  {
    name: "GetShortArrayRegion",
    args: ["JNIEnv*", "jshortArray", "jsize", "jsize", "jshort*"],
    ret: "void",
  },
  {
    name: "GetIntArrayRegion",
    args: ["JNIEnv*", "jintArray", "jsize", "jsize", "jint*"],
    ret: "void",
  },
  {
    name: "GetLongArrayRegion",
    args: ["JNIEnv*", "jlongArray", "jsize", "jsize", "jlong*"],
    ret: "void",
  },
  {
    name: "GetFloatArrayRegion",
    args: ["JNIEnv*", "jfloatArray", "jsize", "jsize", "jfloat*"],
    ret: "void",
  },
  {
    name: "GetDoubleArrayRegion",
    args: ["JNIEnv*", "jdoubleArray", "jsize", "jsize", "jdouble*"],
    ret: "void",
  },
  {
    name: "SetBooleanArrayRegion",
    args: ["JNIEnv*", "jbooleanArray", "jsize", "jsize", "jboolean*"],
    ret: "void",
  },
  {
    name: "SetByteArrayRegion",
    args: ["JNIEnv*", "jbyteArray", "jsize", "jsize", "jbyte*"],
    ret: "void",
  },
  {
    name: "SetCharArrayRegion",
    args: ["JNIEnv*", "jcharArray", "jsize", "jsize", "jchar*"],
    ret: "void",
  },
  {
    name: "SetShortArrayRegion",
    args: ["JNIEnv*", "jshortArray", "jsize", "jsize", "jshort*"],
    ret: "void",
  },
  {
    name: "SetIntArrayRegion",
    args: ["JNIEnv*", "jintArray", "jsize", "jsize", "jint*"],
    ret: "void",
  },
  {
    name: "SetLongArrayRegion",
    args: ["JNIEnv*", "jlongArray", "jsize", "jsize", "jlong*"],
    ret: "void",
  },
  {
    name: "SetFloatArrayRegion",
    args: ["JNIEnv*", "jfloatArray", "jsize", "jsize", "jfloat*"],
    ret: "void",
  },
  {
    name: "SetDoubleArrayRegion",
    args: ["JNIEnv*", "jdoubleArray", "jsize", "jsize", "jdouble*"],
    ret: "void",
  },
  {
    name: "RegisterNatives",
    args: ["JNIEnv*", "jclass", "JNINativeMethod*", "jint"],
    ret: "jint",
  },
  { name: "UnregisterNatives", args: ["JNIEnv*", "jclass"], ret: "jint" },
  { name: "MonitorEnter", args: ["JNIEnv*", "jobject"], ret: "jint" },
  { name: "MonitorExit", args: ["JNIEnv*", "jobject"], ret: "jint" },
  { name: "GetJavaVM", args: ["JNIEnv*", "JavaVM**"], ret: "jint" },
  {
    name: "GetStringRegion",
    args: ["JNIEnv*", "jstring", "jsize", "jsize", "jchar*"],
    ret: "void",
  },
  {
    name: "GetStringUTFRegion",
    args: ["JNIEnv*", "jstring", "jsize", "jsize", "char*"],
    ret: "void",
  },
  {
    name: "GetPrimitiveArrayCritical",
    args: ["JNIEnv*", "jarray", "jboolean*"],
    ret: "void",
  },
  {
    name: "ReleasePrimitiveArrayCritical",
    args: ["JNIEnv*", "jarray", "void*", "jint"],
    ret: "void",
  },
  {
    name: "GetStringCritical",
    args: ["JNIEnv*", "jstring", "jboolean*"],
    ret: "jchar",
  },
  {
    name: "ReleaseStringCritical",
    args: ["JNIEnv*", "jstring", "jchar*"],
    ret: "void",
  },
  { name: "NewWeakGlobalRef", args: ["JNIEnv*", "jobject"], ret: "jweak" },
  { name: "DeleteWeakGlobalRef", args: ["JNIEnv*", "jweak"], ret: "void" },
  { name: "ExceptionCheck", args: ["JNIEnv*"], ret: "jboolean" },
  {
    name: "NewDirectByteBuffer",
    args: ["JNIEnv*", "void*", "jlong"],
    ret: "jobject",
  },
  { name: "GetDirectBufferAddress", args: ["JNIEnv*", "jobject"], ret: "void" },
  {
    name: "GetDirectBufferCapacity",
    args: ["JNIEnv*", "jobject"],
    ret: "jlong",
  },
  {
    name: "GetObjectRefType",
    args: ["JNIEnv*", "jobject"],
    ret: "jobjectRefType",
  },
];

// JavaVM function table (8 entries, indices 0-7)
const JAVA_VM: MethodDef[] = [
  { name: "reserved0", args: [], ret: "void" },
  { name: "reserved1", args: [], ret: "void" },
  { name: "reserved2", args: [], ret: "void" },
  { name: "DestroyJavaVM", args: ["JavaVM*"], ret: "jint" },
  {
    name: "AttachCurrentThread",
    args: ["JavaVM*", "void**", "void*"],
    ret: "jint",
  },
  { name: "DetachCurrentThread", args: ["JavaVM*"], ret: "jint" },
  { name: "GetEnv", args: ["JavaVM*", "void**", "jint"], ret: "jint" },
  {
    name: "AttachCurrentThreadAsDaemon",
    args: ["JavaVM*", "void**", "void*"],
    ret: "jint",
  },
];

const INT_TYPES = new Set(["jint", "jsize", "jbyte", "jshort"]);

function readValue(type: string, ptr: NativePointer): string {
  try {
    if (type === "char*") {
      if (ptr.isNull()) return "null";
      return ptr.readCString() ?? ptr.toString();
    }
    if (type === "jboolean") {
      return ptr.toInt32() ? "true" : "false";
    }
    if (INT_TYPES.has(type)) {
      return ptr.toInt32().toString();
    }
    return ptr.toString();
  } catch {
    return ptr.toString();
  }
}

function readRet(type: string, ptr: NativePointer): string {
  if (type === "void") return "";
  return readValue(type, ptr);
}

function hookTable(
  fnTable: NativePointer,
  methods: MethodDef[],
  callType: "JNIEnv" | "JavaVM",
) {
  const ptrSize = Process.pointerSize;

  for (let i = 0; i < methods.length; i++) {
    const method = methods[i];
    if (method.name.startsWith("reserved")) continue;

    const fnPtr = fnTable.add(i * ptrSize).readPointer();
    if (fnPtr.isNull()) continue;

    try {
      const m = method;
      const listener = Interceptor.attach(fnPtr, {
        onEnter(args) {
          if (tracingThreads.has(this.threadId)) return;
          tracingThreads.add(this.threadId);
          this._jni = true;

          const parsed: string[] = [];
          // Skip first arg (JNIEnv* / JavaVM*)
          for (let j = 1; j < m.args.length; j++) {
            const type = m.args[j];
            if (type === "..." || type === "va_list") break;
            parsed.push(readValue(type, args[j]));
          }
          this._args = parsed;
          // this._bt = bt(this.context);
        },
        onLeave(retval) {
          if (!this._jni) return;
          tracingThreads.delete(this.threadId);

          send({
            subject,
            type: "trace",
            method: m.name,
            callType,
            threadId: this.threadId,
            args: this._args,
            ret: readRet(m.ret, retval),
            // backtrace: this._bt,
          });
        },
      });
      listeners.push(listener);
    } catch {
      // Some functions may not be interceptable
    }
  }
}

export function available(): boolean {
  return Java.available;
}

export function start(): void {
  if (active) return;
  if (!Java.available) return;

  active = true;

  Java.perform(() => {
    const env = Java.vm.getEnv();
    const envFnTable = env.handle.readPointer();
    hookTable(envFnTable, JNI_ENV, "JNIEnv");

    // Hook JavaVM methods
    try {
      const vmHandle = (Java.vm as unknown as { handle: NativePointer }).handle;
      const vmFnTable = vmHandle.readPointer();
      hookTable(vmFnTable, JAVA_VM, "JavaVM");
    } catch {
      console.warn("jni: could not hook JavaVM methods");
    }

    // Hook dlopen for native library load tracking
    try {
      const dlopen =
        findGlobalExport("android_dlopen_ext") ?? findGlobalExport("dlopen");
      if (dlopen) {
        const listener = Interceptor.attach(dlopen, {
          onEnter(args) {
            this._path = args[0].isNull() ? null : args[0].readCString();
          },
          onLeave() {
            send({
              subject,
              type: "load",
              library: this._path as string,
              method: "dlopen",
              callType: "native",
              threadId: this.threadId,
              args: [this._path],
              ret: "",
            });
          },
        });
        listeners.push(listener);
      }
    } catch {}
  });
}

export function stop(): void {
  for (const listener of listeners) {
    listener.detach();
  }
  listeners = [];
  tracingThreads.clear();
  active = false;
}

export function status(): boolean {
  return active;
}

```

`agent/src/droid/hooks/sharedpref.ts`:

```ts
import Java from "frida-java-bridge";

import type { BaseMessage } from "@/common/hooks/context.js";
import { patch as createPatch, backtrace } from "@/common/hooks/java.js";

const restores: Array<() => void> = [];
let running = false;

const patch = createPatch(restores);


export function start() {
  if (running || !available()) return;
  running = true;

  Java.perform(() => {
    try {
      hookSharedPreferencesRead();
    } catch (e) {
      console.warn("sharedpref: read hooks unavailable:", e);
    }

    try {
      hookSharedPreferencesWrite();
    } catch (e) {
      console.warn("sharedpref: write hooks unavailable:", e);
    }

    try {
      hookGetSharedPreferences();
    } catch (e) {
      console.warn("sharedpref: getSharedPreferences hook unavailable:", e);
    }
  });
}

function hookGetSharedPreferences() {
  const ContextWrapper = Java.use("android.content.ContextWrapper");

  patch(
    ContextWrapper.getSharedPreferences.overload("java.lang.String", "int"),
    (original, self, args) => {
      const [name, mode] = args as [Java.Wrapper, number];
      const prefName = name?.toString() ?? "<null>";

      send({
        subject: "hook",
        category: "sharedpref",
        symbol: "Context.getSharedPreferences",
        dir: "enter",
        line: `getSharedPreferences("${prefName}", ${mode})`,
        backtrace: backtrace(),
        extra: { op: "open", name: prefName, mode },
      } satisfies BaseMessage);

      return original.call(self, name, mode);
    },
  );
}

function hookSharedPreferencesRead() {
  const SharedPreferencesImpl = Java.use("android.app.SharedPreferencesImpl");

  const readMethods = [
    { name: "getString", argType: "java.lang.String", valueType: "string" },
    { name: "getInt", argType: "int", valueType: "int" },
    { name: "getLong", argType: "long", valueType: "long" },
    { name: "getFloat", argType: "float", valueType: "float" },
    { name: "getBoolean", argType: "boolean", valueType: "boolean" },
  ] as const;

  for (const { name, argType, valueType } of readMethods) {
    try {
      patch(
        SharedPreferencesImpl[name].overload("java.lang.String", argType),
        (original, self, args) => {
          const [key, defValue] = args as [Java.Wrapper, unknown];
          const keyStr = key?.toString() ?? "<null>";
          const ret = original.call(self, key, defValue);

          send({
            subject: "hook",
            category: "sharedpref",
            symbol: `SharedPreferences.${name}`,
            dir: "leave",
            line: `${name}("${keyStr}") => ${ret}`,
            backtrace: backtrace(),
            extra: {
              op: "read",
              method: name,
              key: keyStr,
              value: ret?.toString() ?? null,
              valueType,
            },
          } satisfies BaseMessage);

          return ret;
        },
      );
    } catch { /* overload may not exist */ }
  }

  // getStringSet
  try {
    patch(
      SharedPreferencesImpl.getStringSet.overload("java.lang.String", "java.util.Set"),
      (original, self, args) => {
        const [key, defValue] = args as [Java.Wrapper, Java.Wrapper | null];
        const keyStr = key?.toString() ?? "<null>";
        const ret = original.call(self, key, defValue);

        send({
          subject: "hook",
          category: "sharedpref",
          symbol: "SharedPreferences.getStringSet",
          dir: "leave",
          line: `getStringSet("${keyStr}")`,
          backtrace: backtrace(),
          extra: { op: "read", method: "getStringSet", key: keyStr, valueType: "stringSet" },
        } satisfies BaseMessage);

        return ret;
      },
    );
  } catch { /* may not exist */ }

  // getAll
  try {
    patch(
      SharedPreferencesImpl.getAll,
      (original, self, args) => {
        const ret = original.call(self, ...args);

        send({
          subject: "hook",
          category: "sharedpref",
          symbol: "SharedPreferences.getAll",
          dir: "leave",
          line: "getAll()",
          backtrace: backtrace(),
          extra: { op: "read", method: "getAll" },
        } satisfies BaseMessage);

        return ret;
      },
    );
  } catch { /* may not exist */ }

  // contains
  try {
    patch(
      SharedPreferencesImpl.contains.overload("java.lang.String"),
      (original, self, args) => {
        const [key] = args as [Java.Wrapper];
        const keyStr = key?.toString() ?? "<null>";
        const ret = original.call(self, key);

        send({
          subject: "hook",
          category: "sharedpref",
          symbol: "SharedPreferences.contains",
          dir: "leave",
          line: `contains("${keyStr}") => ${ret}`,
          backtrace: backtrace(),
          extra: { op: "query", method: "contains", key: keyStr, result: ret },
        } satisfies BaseMessage);

        return ret;
      },
    );
  } catch { /* may not exist */ }
}

function hookSharedPreferencesWrite() {
  const EditorImpl = Java.use("android.app.SharedPreferencesImpl$EditorImpl");

  const writeMethods = [
    { name: "putString", argType: "java.lang.String", valueType: "string" },
    { name: "putInt", argType: "int", valueType: "int" },
    { name: "putLong", argType: "long", valueType: "long" },
    { name: "putFloat", argType: "float", valueType: "float" },
    { name: "putBoolean", argType: "boolean", valueType: "boolean" },
  ] as const;

  for (const { name, argType, valueType } of writeMethods) {
    try {
      patch(
        EditorImpl[name].overload("java.lang.String", argType),
        (original, self, args) => {
          const [key, value] = args as [Java.Wrapper, unknown];
          const keyStr = key?.toString() ?? "<null>";
          const valStr = value?.toString() ?? "null";

          send({
            subject: "hook",
            category: "sharedpref",
            symbol: `SharedPreferences.Editor.${name}`,
            dir: "enter",
            line: `${name}("${keyStr}", ${valStr})`,
            backtrace: backtrace(),
            extra: { op: "write", method: name, key: keyStr, value: valStr, valueType },
          } satisfies BaseMessage);

          return original.call(self, key, value);
        },
      );
    } catch { /* overload may not exist */ }
  }

  // putStringSet
  try {
    patch(
      EditorImpl.putStringSet.overload("java.lang.String", "java.util.Set"),
      (original, self, args) => {
        const [key, values] = args as [Java.Wrapper, Java.Wrapper | null];
        const keyStr = key?.toString() ?? "<null>";

        send({
          subject: "hook",
          category: "sharedpref",
          symbol: "SharedPreferences.Editor.putStringSet",
          dir: "enter",
          line: `putStringSet("${keyStr}", ...)`,
          backtrace: backtrace(),
          extra: { op: "write", method: "putStringSet", key: keyStr, valueType: "stringSet" },
        } satisfies BaseMessage);

        return original.call(self, key, values);
      },
    );
  } catch { /* may not exist */ }

  // remove
  try {
    patch(
      EditorImpl.remove.overload("java.lang.String"),
      (original, self, args) => {
        const [key] = args as [Java.Wrapper];
        const keyStr = key?.toString() ?? "<null>";

        send({
          subject: "hook",
          category: "sharedpref",
          symbol: "SharedPreferences.Editor.remove",
          dir: "enter",
          line: `remove("${keyStr}")`,
          backtrace: backtrace(),
          extra: { op: "delete", method: "remove", key: keyStr },
        } satisfies BaseMessage);

        return original.call(self, key);
      },
    );
  } catch { /* may not exist */ }

  // clear
  try {
    patch(
      EditorImpl.clear,
      (original, self, args) => {
        send({
          subject: "hook",
          category: "sharedpref",
          symbol: "SharedPreferences.Editor.clear",
          dir: "enter",
          line: "clear()",
          backtrace: backtrace(),
          extra: { op: "delete", method: "clear" },
        } satisfies BaseMessage);

        return original.call(self, ...args);
      },
    );
  } catch { /* may not exist */ }

  // commit
  try {
    patch(
      EditorImpl.commit,
      (original, self, args) => {
        send({
          subject: "hook",
          category: "sharedpref",
          symbol: "SharedPreferences.Editor.commit",
          dir: "enter",
          line: "commit() // sync write",
          backtrace: backtrace(),
          extra: { op: "commit", method: "commit", sync: true },
        } satisfies BaseMessage);

        return original.call(self, ...args);
      },
    );
  } catch { /* may not exist */ }

  // apply
  try {
    patch(
      EditorImpl.apply,
      (original, self, args) => {
        send({
          subject: "hook",
          category: "sharedpref",
          symbol: "SharedPreferences.Editor.apply",
          dir: "enter",
          line: "apply() // async write",
          backtrace: backtrace(),
          extra: { op: "commit", method: "apply", sync: false },
        } satisfies BaseMessage);

        return original.call(self, ...args);
      },
    );
  } catch { /* may not exist */ }
}

export function stop() {
  Java.perform(() => {
    for (let i = restores.length - 1; i >= 0; i--) {
      try {
        restores[i]();
      } catch { /* ignore */ }
    }
  });
  restores.length = 0;
  running = false;
}

export function status(): boolean {
  return running;
}

export function available(): boolean {
  if (!Java.available) return false;
  let found = false;
  Java.perform(() => {
    try {
      Java.use("android.app.SharedPreferencesImpl");
      found = true;
    } catch { /* not found */ }
  });
  return found;
}

```

`agent/src/droid/index.ts`:

```ts
import { interfaces, invoke } from "./registry.js";
import * as taps from "./taps.js";
import type { TapRule } from "@/common/taps.js";

import "@/common/encode-arraybuffer.js";

rpc.exports = {
  invoke,
  interfaces,
  restore(rules: TapRule[]) {
    taps.restore(rules);
  },
  snapshot() {
    return taps.snapshot();
  },
};

```

`agent/src/droid/lib/context.ts`:

```ts
import Java from "frida-java-bridge";

export function getContext(): Java.Wrapper {
  const ActivityThread = Java.use("android.app.ActivityThread");
  return ActivityThread.currentApplication().getApplicationContext();
}

```

`agent/src/droid/lib/intent.ts`:

```ts
import Java from "frida-java-bridge";

import { getContext } from "./context.js";

export interface IntentOptions {
  action?: string;
  component?: string;
  data?: string;
  categories?: string[];
  extras?: Record<string, string | number | boolean>;
  flags?: number;
  mimeType?: string;
}

export function buildIntent(options: IntentOptions): Java.Wrapper {
  const Intent = Java.use("android.content.Intent");
  const ComponentName = Java.use("android.content.ComponentName");
  const Uri = Java.use("android.net.Uri");

  const intent = Intent.$new();

  if (options.action) intent.setAction(options.action);

  if (options.component) {
    const parts = options.component.split("/");
    if (parts.length === 2) {
      intent.setComponent(ComponentName.$new(parts[0], parts[1]));
    } else {
      const pkg = getContext().getPackageName();
      intent.setComponent(ComponentName.$new(pkg, options.component));
    }
  }

  if (options.mimeType) {
    if (options.data) {
      intent.setDataAndType(Uri.parse(options.data), options.mimeType);
    } else {
      intent.setType(options.mimeType);
    }
  } else if (options.data) {
    intent.setData(Uri.parse(options.data));
  }

  if (options.categories) {
    for (const cat of options.categories) {
      intent.addCategory(cat);
    }
  }

  if (options.extras) {
    for (const [key, value] of Object.entries(options.extras)) {
      if (typeof value === "string") {
        intent.putExtra(key, Java.use("java.lang.String").$new(value));
      } else if (typeof value === "number") {
        intent.putExtra(key, Java.use("java.lang.Integer").$new(value));
      } else if (typeof value === "boolean") {
        intent.putExtra(key, Java.use("java.lang.Boolean").$new(value));
      }
    }
  }

  if (options.flags !== undefined) {
    intent.setFlags(options.flags);
  }

  return intent;
}

```

`agent/src/droid/modules/activities.ts`:

```ts
import Java from "frida-java-bridge";

import { perform } from "@/common/hooks/java.js";
import { getContext } from "@/droid/lib/context.js";
import { buildIntent, type IntentOptions } from "@/droid/lib/intent.js";

export type { IntentOptions };

export interface ActivityEntry {
  name: string;
  exported: boolean;
  permission: string | null;
  targetActivity: string | null;
}

export function list() {
  return perform(() => {
    const PackageManager = Java.use("android.content.pm.PackageManager");

    const context = getContext();
    const pm = context.getPackageManager();
    const pkg = pm.getPackageInfo(
      context.getPackageName(),
      PackageManager.GET_ACTIVITIES.value,
    );

    const result: ActivityEntry[] = [];
    const activities = pkg.activities?.value;
    if (activities) {
      for (let i = 0; i < activities.length; i++) {
        const a = activities[i];
        result.push({
          name: a.name?.value || "",
          exported: !!a.exported?.value,
          permission: a.permission?.value || null,
          targetActivity: a.targetActivity?.value || null,
        });
      }
    }

    return result;
  });
}

export function start(options: IntentOptions) {
  return perform(() => {
    const Intent = Java.use("android.content.Intent");
    const intent = buildIntent(options);
    if (options.flags === undefined) {
      intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK.value);
    }
    getContext().startActivity(intent);
  });
}

```

`agent/src/droid/modules/app.ts`:

```ts
import { perform } from "@/common/hooks/java.js";
import { getContext } from "@/droid/lib/context.js";

export interface ApplicationInfoResult {
  packageName: string;
  processName: string;
  className: string | null;
  taskAffinity: string | null;
  permission: string | null;
  dataDir: string;
  deviceProtectedDataDir: string | null;
  nativeLibraryDir: string;
  publicSourceDir: string;
  sourceDir: string;
  splitPublicSourceDirs: string[] | null;
  splitSourceDirs: string[] | null;
  sharedLibraryFiles: string[] | null;
  uid: number;
  minSdkVersion: number;
  targetSdkVersion: number;
  enabled: boolean;
  flags: number;
  category: number | null;
}

export function info() {
  return perform(() => {
    const ai = getContext().getApplicationInfo();

    const sharedLibs = ai.sharedLibraryFiles.value;
    const splitPublic = ai.splitPublicSourceDirs.value;
    const splitSource = ai.splitSourceDirs.value;

    return {
      packageName: ai.packageName.value,
      processName: ai.processName.value,
      className: ai.className.value,
      taskAffinity: ai.taskAffinity.value,
      permission: ai.permission.value,
      dataDir: ai.dataDir.value,
      deviceProtectedDataDir: ai.deviceProtectedDataDir?.value || null,
      nativeLibraryDir: ai.nativeLibraryDir.value,
      publicSourceDir: ai.publicSourceDir.value,
      sourceDir: ai.sourceDir.value,
      splitPublicSourceDirs: splitPublic
        ? Array.from({ length: splitPublic.length }, (_, i) => splitPublic[i])
        : null,
      splitSourceDirs: splitSource
        ? Array.from({ length: splitSource.length }, (_, i) => splitSource[i])
        : null,
      sharedLibraryFiles: sharedLibs
        ? Array.from({ length: sharedLibs.length }, (_, i) => sharedLibs[i])
        : null,
      uid: ai.uid.value,
      minSdkVersion: ai.minSdkVersion.value,
      targetSdkVersion: ai.targetSdkVersion.value,
      enabled: ai.enabled.value,
      flags: ai.flags.value,
      category: ai.category?.value ?? null,
    } as ApplicationInfoResult;
  });
}

```

`agent/src/droid/modules/classes.ts`:

```ts
import Java from "frida-java-bridge";

import { perform } from "@/common/hooks/java.js";

export interface JavaMethod {
  name: string;
  returnType: string;
  argumentTypes: string[];
  isStatic: boolean;
}

export interface JavaField {
  name: string;
  type: string;
  isStatic: boolean;
}

export interface JavaClassDetail {
  name: string;
  superClass: string | null;
  interfaces: string[];
  methods: JavaMethod[];
  ownMethods: string[];
  fields: JavaField[];
}

export function list() {
  return perform(() => Java.enumerateLoadedClassesSync());
}

export function inspect(name: string) {
  return perform(() => {
    const wrapper = Java.use(name);
    const jClass = wrapper.class;

    // Superclass
    const superObj = jClass.getSuperclass();
    const superClass = superObj ? superObj.getName() : null;

    // Interfaces
    const ifaces = jClass.getInterfaces();
    const interfaces: string[] = [];
    for (let i = 0; i < ifaces.length; i++) {
      interfaces.push(ifaces[i].getName());
    }

    // Declared methods (own)
    const declaredMethods = jClass.getDeclaredMethods();
    const methods: JavaMethod[] = [];
    const ownMethods: string[] = [];
    const Modifier = Java.use("java.lang.reflect.Modifier");

    for (let i = 0; i < declaredMethods.length; i++) {
      const m = declaredMethods[i];
      const mName = m.getName();
      const retType = m.getReturnType().getName();
      const paramTypes = m.getParameterTypes();
      const argTypes: string[] = [];
      for (let j = 0; j < paramTypes.length; j++) {
        argTypes.push(paramTypes[j].getName());
      }
      const mods = m.getModifiers();
      const isStatic = Modifier.isStatic(mods);

      methods.push({
        name: mName,
        returnType: retType,
        argumentTypes: argTypes,
        isStatic,
      });
      ownMethods.push(mName);
    }

    // Declared fields
    const declaredFields = jClass.getDeclaredFields();
    const fields: JavaField[] = [];
    for (let i = 0; i < declaredFields.length; i++) {
      const f = declaredFields[i];
      const fMods = f.getModifiers();
      fields.push({
        name: f.getName(),
        type: f.getType().getName(),
        isStatic: Modifier.isStatic(fMods),
      });
    }

    return {
      name,
      superClass,
      interfaces,
      methods,
      ownMethods,
      fields,
    } as JavaClassDetail;
  });
}

```

`agent/src/droid/modules/device.ts`:

```ts
import Java from "frida-java-bridge";

import { perform } from "@/common/hooks/java.js";

export interface DeviceInfo {
  model: string;
  brand: string;
  manufacturer: string;
  product: string;
  device: string;
  board: string;
  hardware: string;
  display: string;
  fingerprint: string;
  sdk: number;
  release: string;
  codename: string;
  incremental: string;
  security: string;
  abi: string;
}

export function info() {
  return perform(() => {
    const Build = Java.use("android.os.Build");
    const VERSION = Java.use("android.os.Build$VERSION");

    return {
      model: Build.MODEL.value,
      brand: Build.BRAND.value,
      manufacturer: Build.MANUFACTURER.value,
      product: Build.PRODUCT.value,
      device: Build.DEVICE.value,
      board: Build.BOARD.value,
      hardware: Build.HARDWARE.value,
      display: Build.DISPLAY.value,
      fingerprint: Build.FINGERPRINT.value,
      sdk: VERSION.SDK_INT.value,
      release: VERSION.RELEASE.value,
      codename: VERSION.CODENAME.value,
      incremental: VERSION.INCREMENTAL.value,
      security: VERSION.SECURITY_PATCH?.value || "",
      abi: Build.SUPPORTED_ABIS?.value?.[0] || "",
    } as DeviceInfo;
  });
}

export function properties() {
  return perform(() => {
    const SystemProperties = Java.use("android.os.SystemProperties");
    const Runtime = Java.use("java.lang.Runtime");
    const BufferedReader = Java.use("java.io.BufferedReader");
    const InputStreamReader = Java.use("java.io.InputStreamReader");

    const props: Record<string, string> = {};

    try {
      const process = Runtime.getRuntime().exec("getprop");
      const reader = BufferedReader.$new(
        InputStreamReader.$new(process.getInputStream()),
      );

      let line: string | null;
      while ((line = reader.readLine()) !== null) {
        const match = /^\[(.+?)\]: \[(.*)?\]$/.exec(line);
        if (match) {
          props[match[1]] = match[2] || "";
        }
      }
      reader.close();
    } catch (_) {
      // fallback: read known properties
      const known = [
        "ro.build.version.sdk",
        "ro.build.version.release",
        "ro.build.display.id",
        "ro.product.model",
        "ro.product.brand",
        "ro.product.name",
        "ro.hardware",
        "ro.build.fingerprint",
        "ro.secure",
        "ro.debuggable",
        "ro.build.type",
      ];

      for (const key of known) {
        try {
          const val: string = SystemProperties.get(key, "");
          if (val) props[key] = val;
        } catch (_) {
          // skip
        }
      }
    }

    return props;
  });
}

```

`agent/src/droid/modules/fs.ts`:

```ts
import Java from "frida-java-bridge";

import { perform } from "@/common/hooks/java.js";
import { getContext } from "@/droid/lib/context.js";
import * as posix from "@/lib/posix.js";
import type { Roots } from "@/common/fs.js";

export interface MetaData {
  name: string;
  dir: boolean;
  protection: string | null;
  size: number | null;
  alias: boolean;
  created: Date;
  symlink: boolean;
}

export interface DirectoryListing {
  cwd: string;
  writable: boolean;
  list: MetaData[];
}

export interface FileAttributes {
  created: Date;
  gid: number;
  group: string;
  uid: number;
  owner: string;
  perm: number;
  protection: string;
  size: number;
  type: string;
}

let homeDir: string;
let bundleDir: string;

function initPaths() {
  if (homeDir) return;
  Java.perform(() => {
    const ctx = getContext();
    homeDir = ctx.getFilesDir().getParentFile().getAbsolutePath() as string;
    const File = Java.use("java.io.File");
    bundleDir = File.$new(
      ctx.getPackageCodePath() as string,
    ).getParent() as string;
  });
}

export function roots(): Roots {
  initPaths();
  return { home: homeDir, bundle: bundleDir };
}

export function ls(path: string) {
  return perform(() => {
    const File = Java.use("java.io.File");
    const cwd = path;
    const dir = File.$new(cwd);

    if (!dir.exists()) throw new Error(`Path does not exist: ${cwd}`);
    if (!dir.isDirectory()) throw new Error(`Not a directory: ${cwd}`);

    const writable = Boolean(dir.canWrite());
    const files = dir.listFiles();
    const list: MetaData[] = [];

    if (files) {
      for (let i = 0; i < files.length; i++) {
        const f = files[i];
        const absPath = f.getAbsolutePath() as string;
        const canonPath = f.getCanonicalPath() as string;

        list.push({
          name: f.getName() as string,
          dir: Boolean(f.isDirectory()),
          protection: null,
          size: f.isFile() ? Number(f.length()) : null,
          alias: false,
          created: new Date(Number(f.lastModified())),
          symlink: absPath !== canonPath,
        });
      }
    }

    return { cwd, writable, list } as DirectoryListing;
  });
}

export function rm(path: string) {
  return perform(() => {
    const File = Java.use("java.io.File");
    const target = File.$new(path);
    if (!target.exists()) throw new Error(`Path does not exist: ${path}`);

    function deleteRecursive(f: Java.Wrapper): boolean {
      if (f.isDirectory()) {
        const children = f.listFiles();
        if (children) {
          for (let i = 0; i < children.length; i++) {
            deleteRecursive(children[i]);
          }
        }
      }
      return Boolean(f.delete());
    }

    return deleteRecursive(target);
  });
}

export function cp(src: string, dst: string) {
  return perform(() => {
    const File = Java.use("java.io.File");
    const FileInputStream = Java.use("java.io.FileInputStream");
    const FileOutputStream = Java.use("java.io.FileOutputStream");
    const srcFile = File.$new(src);
    const dstFile = File.$new(dst);

    function copyRecursive(s: Java.Wrapper, d: Java.Wrapper) {
      if (s.isDirectory()) {
        d.mkdirs();
        const children = s.listFiles();
        if (children) {
          for (let i = 0; i < children.length; i++) {
            copyRecursive(children[i], File.$new(d, children[i].getName()));
          }
        }
      } else {
        const parent = d.getParentFile();
        if (parent && !parent.exists()) parent.mkdirs();

        const fis = FileInputStream.$new(s);
        const fos = FileOutputStream.$new(d);
        const buf = Java.array("byte", new Array(8192).fill(0));
        let n: number;
        while ((n = fis.read(buf) as number) !== -1) {
          fos.write(buf, 0, n);
        }
        fis.close();
        fos.close();
      }
    }

    copyRecursive(srcFile, dstFile);
    return true;
  });
}

export function mv(src: string, dst: string) {
  return posix.rename(src, dst);
}

export function mkdirp(path: string) {
  return perform(() => {
    const File = Java.use("java.io.File");
    const dir = File.$new(path);
    return Boolean(dir.mkdirs());
  });
}

export function attrs(path: string) {
  return perform(() => {
    const Os = Java.use("android.system.Os");
    const stat = Os.lstat(path);

    const mode = stat.st_mode.value as number;
    const fmt = mode & 0o170000;

    let type = "unknown";
    if (fmt === 0o100000) type = "regular";
    else if (fmt === 0o040000) type = "directory";
    else if (fmt === 0o120000) type = "symlink";
    else if (fmt === 0o060000) type = "block";
    else if (fmt === 0o020000) type = "character";
    else if (fmt === 0o010000) type = "fifo";
    else if (fmt === 0o140000) type = "socket";

    return {
      created: new Date((stat.st_ctime.value as number) * 1000),
      gid: stat.st_gid.value as number,
      group: "",
      uid: stat.st_uid.value as number,
      owner: "",
      perm: mode & 0o7777,
      protection: "",
      size: Number(stat.st_size.value),
      type,
    } as FileAttributes;
  });
}

export function text(path: string) {
  return perform(() => {
    const BufferedReader = Java.use("java.io.BufferedReader");
    const FileReader = Java.use("java.io.FileReader");
    const StringBuilder = Java.use("java.lang.StringBuilder");
    const sb = StringBuilder.$new();
    const reader = BufferedReader.$new(FileReader.$new(path));
    let line: string | null;
    while ((line = reader.readLine() as string | null) !== null) {
      sb.append(line).append("\n");
    }
    reader.close();
    return sb.toString() as string;
  });
}

export function data(path: string) {
  return posix.readFile(path);
}

export function preview(path: string) {
  return posix.readFile(path, 1024 * 1024);
}

export function access(path: string) {
  return posix.isWritable(path);
}

export function saveText(path: string, content: string) {
  return perform(() => {
    const FileOutputStream = Java.use("java.io.FileOutputStream");
    const fos = FileOutputStream.$new(path);
    const bytes = Java.use("java.lang.String").$new(content).getBytes("UTF-8");
    fos.write(bytes);
    fos.close();
    return true;
  });
}

```

`agent/src/droid/modules/keystore.ts`:

```ts
import Java from "frida-java-bridge";

import { perform } from "@/common/hooks/java.js";

export interface KeystoreAlias {
  alias: string;
  algorithm: string | null;
  entryType: string;
}

export interface KeyInfo {
  alias: string;
  algorithm: string;
  keySize: number;
  blockModes: string[];
  digests: string[];
  encryptionPaddings: string[];
  signaturePaddings: string[];
  purposes: number;
  origin: number;
  isInsideSecureHardware: boolean;
  isUserAuthenticationRequired: boolean;
  userAuthenticationValidityDurationSeconds: number;
  isInvalidatedByBiometricEnrollment: boolean;
  isTrustedUserPresenceRequired: boolean | null;
  isUserConfirmationRequired: boolean | null;
  isUserAuthenticationRequirementEnforcedBySecureHardware: boolean;
  isUserAuthenticationValidWhileOnBody: boolean;
  keyValidityStart: string | null;
  keyValidityForOriginationEnd: string | null;
  keyValidityForConsumptionEnd: string | null;
}

function toStringArray(arr: Java.Wrapper | null): string[] {
  if (!arr) return [];
  const result: string[] = [];
  for (let i = 0; i < arr.length; i++) {
    result.push(String(arr[i]));
  }
  return result;
}

export function aliases() {
  return perform(() => {
    const KeyStore = Java.use("java.security.KeyStore");
    const PrivateKeyEntry = Java.use("java.security.KeyStore$PrivateKeyEntry");
    const SecretKeyEntry = Java.use("java.security.KeyStore$SecretKeyEntry");
    const TrustedCertificateEntry = Java.use(
      "java.security.KeyStore$TrustedCertificateEntry",
    );

    const ks = KeyStore.getInstance("AndroidKeyStore");
    ks.load(null);

    const result: KeystoreAlias[] = [];
    const enumeration = ks.aliases();

    while (enumeration.hasMoreElements()) {
      const alias = enumeration.nextElement().toString();
      let algorithm: string | null = null;
      let entryType = "Unknown";

      try {
        if (ks.entryInstanceOf(alias, PrivateKeyEntry.class)) {
          entryType = "PrivateKey";
        } else if (ks.entryInstanceOf(alias, SecretKeyEntry.class)) {
          entryType = "SecretKey";
        } else if (ks.entryInstanceOf(alias, TrustedCertificateEntry.class)) {
          entryType = "TrustedCertificate";
        }
      } catch (_) {
        /* entry type check failed */
      }

      try {
        const key = ks.getKey(alias, null);
        if (key !== null) {
          algorithm = key.getAlgorithm();
        }
      } catch (_) {
        /* key may not be accessible */
      }

      result.push({ alias, algorithm, entryType });
    }

    return result;
  });
}

export function info(alias: string) {
  return perform(() => {
    const KeyStore = Java.use("java.security.KeyStore");
    const KeyFactory = Java.use("java.security.KeyFactory");
    const KeyInfoCls = Java.use("android.security.keystore.KeyInfo");
    const SecretKeyFactory = Java.use("javax.crypto.SecretKeyFactory");

    const ks = KeyStore.getInstance("AndroidKeyStore");
    ks.load(null);

    const key = ks.getKey(alias, null);
    if (key === null) {
      return null;
    }

    const algorithm = key.getAlgorithm();

    let factory: Java.Wrapper;
    try {
      factory = KeyFactory.getInstance(algorithm, "AndroidKeyStore");
    } catch (_) {
      factory = SecretKeyFactory.getInstance(algorithm, "AndroidKeyStore");
    }

    const keyInfo = Java.cast(
      factory.getKeySpec(key, KeyInfoCls.class),
      KeyInfoCls,
    );

    let isTrustedUserPresenceRequired: boolean | null = null;
    try {
      isTrustedUserPresenceRequired = keyInfo.isTrustedUserPresenceRequired();
    } catch (_) {
      /* API level */
    }

    let isUserConfirmationRequired: boolean | null = null;
    try {
      isUserConfirmationRequired = keyInfo.isUserConfirmationRequired();
    } catch (_) {
      /* API level */
    }

    const validityStart = keyInfo.getKeyValidityStart();
    const originationEnd = keyInfo.getKeyValidityForOriginationEnd();
    const consumptionEnd = keyInfo.getKeyValidityForConsumptionEnd();

    return {
      alias: keyInfo.getKeystoreAlias(),
      algorithm,
      keySize: keyInfo.getKeySize(),
      blockModes: toStringArray(keyInfo.getBlockModes()),
      digests: toStringArray(keyInfo.getDigests()),
      encryptionPaddings: toStringArray(keyInfo.getEncryptionPaddings()),
      signaturePaddings: toStringArray(keyInfo.getSignaturePaddings()),
      purposes: keyInfo.getPurposes(),
      origin: keyInfo.getOrigin(),
      isInsideSecureHardware: keyInfo.isInsideSecureHardware(),
      isUserAuthenticationRequired: keyInfo.isUserAuthenticationRequired(),
      userAuthenticationValidityDurationSeconds:
        keyInfo.getUserAuthenticationValidityDurationSeconds(),
      isInvalidatedByBiometricEnrollment:
        keyInfo.isInvalidatedByBiometricEnrollment(),
      isTrustedUserPresenceRequired,
      isUserConfirmationRequired,
      isUserAuthenticationRequirementEnforcedBySecureHardware:
        keyInfo.isUserAuthenticationRequirementEnforcedBySecureHardware(),
      isUserAuthenticationValidWhileOnBody:
        keyInfo.isUserAuthenticationValidWhileOnBody(),
      keyValidityStart: validityStart ? validityStart.toString() : null,
      keyValidityForOriginationEnd: originationEnd
        ? originationEnd.toString()
        : null,
      keyValidityForConsumptionEnd: consumptionEnd
        ? consumptionEnd.toString()
        : null,
    } as KeyInfo;
  });
}

```

`agent/src/droid/modules/lsof.ts`:

```ts
import { getGlobalExport } from "@/lib/polyfill.js";

// ---------------------------------------------------------------------------
// types
// ---------------------------------------------------------------------------

export enum FDType {
  TCP = "tcp",
  TCP6 = "tcp6",
  UDP = "udp",
  UDP6 = "udp6",
  FILE = "file",
}

export interface TcpEntry {
  fd: number | null;
  type: FDType.TCP | FDType.TCP6;
  localIp: string;
  localPort: number;
  remoteIp: string;
  remotePort: number;
  state: string;
  inode: number;
}

export interface UdpEntry {
  fd: number | null;
  type: FDType.UDP | FDType.UDP6;
  localIp: string;
  localPort: number;
  remoteIp: string;
  remotePort: number;
  inode: number;
}

export interface FileEntry {
  fd: number;
  type: FDType.FILE;
  path: string;
}

export type FileDescriptor = TcpEntry | UdpEntry | FileEntry;

// ---------------------------------------------------------------------------
// native helpers
// ---------------------------------------------------------------------------

const open = new NativeFunction(getGlobalExport("open"), "int", [
  "pointer",
  "int",
  "int",
]);
const read = new NativeFunction(getGlobalExport("read"), "int", [
  "int",
  "pointer",
  "int",
]);
const close = new NativeFunction(getGlobalExport("close"), "int", ["int"]);
const readlink = new NativeFunction(getGlobalExport("readlink"), "int", [
  "pointer",
  "pointer",
  "int",
]);
const opendir = new NativeFunction(getGlobalExport("opendir"), "pointer", [
  "pointer",
]);
const readdir = new NativeFunction(getGlobalExport("readdir"), "pointer", [
  "pointer",
]);
const closedir = new NativeFunction(getGlobalExport("closedir"), "int", [
  "pointer",
]);

// ---------------------------------------------------------------------------
// proc helpers
// ---------------------------------------------------------------------------

/** Read a proc file via chunked reads (proc files report size 0). */
function readProcFile(path: string): string {
  const pathBuf = Memory.allocUtf8String(path);
  const fd = open(pathBuf, 0 /* O_RDONLY */, 0) as number;
  if (fd < 0) return "";

  const chunkSize = 4096;
  const buf = Memory.alloc(chunkSize);
  let result = "";

  // eslint-disable-next-line no-constant-condition
  while (true) {
    const n = read(fd, buf, chunkSize) as number;
    if (n <= 0) break;
    result += buf.readUtf8String(n);
  }

  close(fd);
  return result;
}

/** Resolve a symlink path using native readlink. */
function resolveLink(path: string): string | null {
  const pathBuf = Memory.allocUtf8String(path);
  const buf = Memory.alloc(4096);
  const n = readlink(pathBuf, buf, 4096) as number;
  if (n < 0) return null;
  return buf.readUtf8String(n);
}

// ---------------------------------------------------------------------------
// TCP state mapping
// ---------------------------------------------------------------------------

const TCP_STATES: Record<string, string> = {
  "01": "ESTABLISHED",
  "02": "SYN_SENT",
  "03": "SYN_RECV",
  "04": "FIN_WAIT1",
  "05": "FIN_WAIT2",
  "06": "TIME_WAIT",
  "07": "CLOSE",
  "08": "CLOSE_WAIT",
  "09": "LAST_ACK",
  "0A": "LISTEN",
  "0B": "CLOSING",
};

// ---------------------------------------------------------------------------
// IP address parsing
// ---------------------------------------------------------------------------

/** Parse a hex-encoded IPv4 address (little-endian 32-bit). */
function parseIPv4(hex: string): string {
  const n = parseInt(hex, 16);
  return [n & 0xff, (n >> 8) & 0xff, (n >> 16) & 0xff, (n >> 24) & 0xff].join(
    ".",
  );
}

/** Parse a hex-encoded IPv6 address (4 little-endian 32-bit words). */
function parseIPv6(hex: string): string {
  // hex is 32 chars = 4 groups of 8 chars, each a LE 32-bit word
  const words: number[] = [];
  for (let i = 0; i < 32; i += 8) {
    words.push(parseInt(hex.substring(i, i + 8), 16));
  }

  // Convert each 32-bit LE word to two 16-bit network-order groups
  const groups: string[] = [];
  for (const w of words) {
    groups.push(((w & 0xff) << 8 | (w >> 8) & 0xff).toString(16));
    groups.push(((w >> 16 & 0xff) << 8 | (w >> 24) & 0xff).toString(16));
  }

  const full = groups.join(":");

  // Collapse longest run of :0: groups
  // Simple approach: just return the joined form
  return compressIPv6(full);
}

function compressIPv6(addr: string): string {
  const parts = addr.split(":");
  // Find the longest run of "0" groups
  let bestStart = -1;
  let bestLen = 0;
  let curStart = -1;
  let curLen = 0;

  for (let i = 0; i < parts.length; i++) {
    if (parts[i] === "0") {
      if (curStart === -1) curStart = i;
      curLen++;
      if (curLen > bestLen) {
        bestStart = curStart;
        bestLen = curLen;
      }
    } else {
      curStart = -1;
      curLen = 0;
    }
  }

  if (bestLen >= 2) {
    const before = parts.slice(0, bestStart);
    const after = parts.slice(bestStart + bestLen);
    const mid = bestStart === 0 && bestStart + bestLen === parts.length
      ? "::"
      : bestStart === 0
        ? "::" + after.join(":")
        : bestStart + bestLen === parts.length
          ? before.join(":") + "::"
          : before.join(":") + "::" + after.join(":");
    return mid;
  }

  return addr;
}

// ---------------------------------------------------------------------------
// /proc/self/net parsing
// ---------------------------------------------------------------------------

interface NetEntry {
  localIp: string;
  localPort: number;
  remoteIp: string;
  remotePort: number;
  state: string;
  inode: number;
}

function parseNetFile(content: string, isV6: boolean): NetEntry[] {
  const entries: NetEntry[] = [];
  const lines = content.split("\n");

  // Skip header line
  for (let i = 1; i < lines.length; i++) {
    const line = lines[i].trim();
    if (!line) continue;

    //  sl  local_address rem_address   st tx_queue rx_queue tr tm->when retrnsmt   uid  timeout inode
    const fields = line.split(/\s+/);
    if (fields.length < 10) continue;

    const [localHex, localPortHex] = fields[1].split(":");
    const [remoteHex, remotePortHex] = fields[2].split(":");

    const parseIp = isV6 ? parseIPv6 : parseIPv4;

    entries.push({
      localIp: parseIp(localHex),
      localPort: parseInt(localPortHex, 16),
      remoteIp: parseIp(remoteHex),
      remotePort: parseInt(remotePortHex, 16),
      state: fields[3],
      inode: parseInt(fields[9], 10),
    });
  }

  return entries;
}

// ---------------------------------------------------------------------------
// /proc/self/fd listing
// ---------------------------------------------------------------------------

/** d_name offset: 19 on 64-bit, 11 on 32-bit */
const DIRENT_D_NAME_OFFSET = Process.pointerSize === 8 ? 19 : 11;

interface FdLink {
  fd: number;
  target: string;
}

function listFds(): FdLink[] {
  const dirPath = Memory.allocUtf8String("/proc/self/fd");
  const dir = opendir(dirPath) as NativePointer;
  if (dir.isNull()) return [];

  const results: FdLink[] = [];

  // eslint-disable-next-line no-constant-condition
  while (true) {
    const entry = readdir(dir) as NativePointer;
    if (entry.isNull()) break;

    const name = entry.add(DIRENT_D_NAME_OFFSET).readUtf8String();
    if (!name || name === "." || name === "..") continue;

    const fdNum = parseInt(name, 10);
    if (isNaN(fdNum)) continue;

    const target = resolveLink(`/proc/self/fd/${name}`);
    if (target) {
      results.push({ fd: fdNum, target });
    }
  }

  closedir(dir);
  return results;
}

// ---------------------------------------------------------------------------
// main export
// ---------------------------------------------------------------------------

export function fds(): FileDescriptor[] {
  // 1. Parse net files
  const tcpContent = readProcFile("/proc/self/net/tcp");
  const tcp6Content = readProcFile("/proc/self/net/tcp6");
  const udpContent = readProcFile("/proc/self/net/udp");
  const udp6Content = readProcFile("/proc/self/net/udp6");

  const tcpEntries = parseNetFile(tcpContent, false);
  const tcp6Entries = parseNetFile(tcp6Content, true);
  const udpEntries = parseNetFile(udpContent, false);
  const udp6Entries = parseNetFile(udp6Content, true);

  // 2. Build inode -> net entry map
  const inodeMap = new Map<number, { entry: NetEntry; type: FDType }>();
  for (const e of tcpEntries) inodeMap.set(e.inode, { entry: e, type: FDType.TCP });
  for (const e of tcp6Entries) inodeMap.set(e.inode, { entry: e, type: FDType.TCP6 });
  for (const e of udpEntries) inodeMap.set(e.inode, { entry: e, type: FDType.UDP });
  for (const e of udp6Entries) inodeMap.set(e.inode, { entry: e, type: FDType.UDP6 });

  // 3. List fds and correlate
  const fdLinks = listFds();
  const results: FileDescriptor[] = [];
  const matchedInodes = new Set<number>();

  for (const { fd, target } of fdLinks) {
    // Check for socket:[inode]
    const socketMatch = target.match(/^socket:\[(\d+)\]$/);
    if (socketMatch) {
      const inode = parseInt(socketMatch[1], 10);
      const net = inodeMap.get(inode);
      if (net) {
        matchedInodes.add(inode);
        const { entry, type } = net;
        if (type === FDType.TCP || type === FDType.TCP6) {
          results.push({
            fd,
            type,
            localIp: entry.localIp,
            localPort: entry.localPort,
            remoteIp: entry.remoteIp,
            remotePort: entry.remotePort,
            state: TCP_STATES[entry.state] || entry.state,
            inode,
          });
        } else {
          results.push({
            fd,
            type: type as FDType.UDP | FDType.UDP6,
            localIp: entry.localIp,
            localPort: entry.localPort,
            remoteIp: entry.remoteIp,
            remotePort: entry.remotePort,
            inode,
          });
        }
      }
      // Skip unmatched sockets (no net entry found)
      continue;
    }

    // Regular file
    results.push({
      fd,
      type: FDType.FILE,
      path: target,
    });
  }

  // 4. Add unmatched net entries (sockets without an fd in our process)
  for (const [inode, { entry, type }] of inodeMap) {
    if (matchedInodes.has(inode)) continue;
    if (type === FDType.TCP || type === FDType.TCP6) {
      results.push({
        fd: null,
        type,
        localIp: entry.localIp,
        localPort: entry.localPort,
        remoteIp: entry.remoteIp,
        remotePort: entry.remotePort,
        state: TCP_STATES[entry.state] || entry.state,
        inode,
      });
    } else {
      results.push({
        fd: null,
        type: type as FDType.UDP | FDType.UDP6,
        localIp: entry.localIp,
        localPort: entry.localPort,
        remoteIp: entry.remoteIp,
        remotePort: entry.remotePort,
        inode,
      });
    }
  }

  return results;
}

```

`agent/src/droid/modules/manifest.ts`:

```ts
import Java from "frida-java-bridge";

import { perform } from "@/common/hooks/java.js";
import { getContext } from "@/droid/lib/context.js";

let cached: string | null = null;

export function xml() {
  return perform(() => {
    if (cached !== null) return cached;
    const manifest = readManifestXml();
    cached = manifest;
    return manifest;
  });
}

function readManifestXml(): string {
  const context = getContext();
  const sourceDir: string = context.getApplicationInfo().sourceDir.value;

  const ZipFile = Java.use("java.util.zip.ZipFile");
  const ByteArrayOutputStream = Java.use("java.io.ByteArrayOutputStream");

  const zip = ZipFile.$new(sourceDir);

  try {
    const entry = zip.getEntry("AndroidManifest.xml");
    if (!entry) throw new Error("AndroidManifest.xml not found in APK");

    const inputStream = zip.getInputStream(entry);
    const outputStream = ByteArrayOutputStream.$new();
    const buffer = Java.array("byte", new Array(4096).fill(0));
    let len: number;

    while ((len = inputStream.read(buffer)) !== -1) {
      outputStream.write(buffer, 0, len);
    }
    inputStream.close();

    const manifestBytes = outputStream.toByteArray();

    const ByteBuffer = Java.use("java.nio.ByteBuffer");
    const ByteOrder = Java.use("java.nio.ByteOrder");
    const buf = ByteBuffer.wrap(manifestBytes).order(
      ByteOrder.LITTLE_ENDIAN.value,
    );

    return decodeAxml(buf, manifestBytes, manifestBytes.length);
  } finally {
    zip.close();
  }
}

/**
 * Decodes a binary AndroidManifest.xml (AXML) into plain text XML.
 * Uses Java ByteBuffer for bulk reads to avoid slow element-by-element
 * Java-to-JS bridge copies.
 */
function decodeAxml(
  buf: Java.Wrapper,
  bytes: Java.Wrapper,
  length: number,
): string {
  const JavaString = Java.use("java.lang.String");

  const readInt = (offset: number): number => buf.getInt(offset);

  const END_DOC_TAG = 0x00100101;
  const START_TAG = 0x00100102;
  const END_TAG = 0x00100103;

  const numStrings = readInt(16);
  const stringIndexTableOffset = 0x24;
  const stringDataTableOffset = stringIndexTableOffset + numStrings * 4;

  const getString = (strIndex: number): string | null => {
    if (strIndex < 0) return null;

    const indexOffset = stringIndexTableOffset + strIndex * 4;
    const offsetInData = readInt(indexOffset);
    const strAbsOffset = stringDataTableOffset + offsetInData;
    const strLen = buf.getShort(strAbsOffset) & 0xffff;

    if (strLen === 0) return "";
    return JavaString.$new(
      bytes,
      strAbsOffset + 2,
      strLen * 2,
      "UTF-16LE",
    ).toString() as string;
  };

  let xmlTagOffset = readInt(12);
  for (let i = xmlTagOffset; i < length - 4; i += 4) {
    if (readInt(i) === START_TAG) {
      xmlTagOffset = i;
      break;
    }
  }

  let offset = xmlTagOffset;
  let indent = 0;
  const sb: string[] = [];

  while (offset < length) {
    const tag0 = readInt(offset);
    const nameSi = readInt(offset + 20);

    if (tag0 === START_TAG) {
      const attrCount = readInt(offset + 28);
      offset += 36;

      const elemName = getString(nameSi);
      let attrStr = "";

      for (let a = 0; a < attrCount; a++) {
        const attrNameSi = readInt(offset + 4);
        const attrValueSi = readInt(offset + 8);
        const attrResId = readInt(offset + 16);
        offset += 20;

        const attrName = getString(attrNameSi);
        let attrValue: string;

        if (attrValueSi !== -1) {
          attrValue = getString(attrValueSi) || "";
        } else {
          attrValue =
            "0x" +
            (attrResId >>> 0).toString(16).toUpperCase().padStart(8, "0");
        }

        attrValue = attrValue.replace(/"/g, "&quot;");
        attrStr += ` ${attrName}="${attrValue}"`;
      }

      const padding = "  ".repeat(indent);
      sb.push(`${padding}<${elemName}${attrStr}>`);
      indent++;
    } else if (tag0 === END_TAG) {
      indent--;
      const elemName = getString(nameSi);
      offset += 24;

      const padding = "  ".repeat(indent);
      sb.push(`${padding}</${elemName}>`);
    } else if (tag0 === END_DOC_TAG) {
      break;
    } else {
      break;
    }
  }

  return sb.join("\n");
}

```

`agent/src/droid/modules/provider.ts`:

```ts
import Java from "frida-java-bridge";

import { perform } from "@/common/hooks/java.js";
import { getContext } from "@/droid/lib/context.js";

export interface ProviderEntry {
  name: string;
  authority: string;
  exported: boolean;
  readPermission: string | null;
  writePermission: string | null;
  grantUriPermissions: boolean;
}

export function list() {
  return perform(() => {
    const PackageManager = Java.use("android.content.pm.PackageManager");

    const context = getContext();
    const pm = context.getPackageManager();
    const pkg = pm.getPackageInfo(
      context.getPackageName(),
      PackageManager.GET_PROVIDERS.value,
    );

    const result: ProviderEntry[] = [];
    const providers = pkg.providers?.value;
    if (providers) {
      for (let i = 0; i < providers.length; i++) {
        const p = providers[i];
        result.push({
          name: p.name?.value || "",
          authority: p.authority?.value || "",
          exported: !!p.exported?.value,
          readPermission: p.readPermission?.value || null,
          writePermission: p.writePermission?.value || null,
          grantUriPermissions: !!p.grantUriPermissions?.value,
        });
      }
    }

    return result;
  });
}

export interface QueryResult {
  columns: string[];
  rows: (string | number | null)[][];
}

export interface ContentValues {
  [key: string]:
    | { type: "string"; value: string }
    | { type: "integer"; value: number }
    | { type: "long"; value: number }
    | { type: "float"; value: number }
    | { type: "double"; value: number }
    | { type: "boolean"; value: boolean }
    | { type: "short"; value: number };
}

export interface QueryOptions {
  projection?: string[];
  selection?: string;
  selectionArgs?: string[];
  sortOrder?: string;
}

export function query(uri: string, options?: QueryOptions) {
  return perform(() => {
    const Uri = Java.use("android.net.Uri");

    const cr = getContext().getContentResolver();
    const contentUri = Uri.parse(uri);

    const projection = options?.projection
      ? Java.array("java.lang.String", options.projection)
      : null;

    const selectionArgs = options?.selectionArgs
      ? Java.array("java.lang.String", options.selectionArgs)
      : null;

    const cursor = cr.query(
      contentUri,
      projection,
      options?.selection || null,
      selectionArgs,
      options?.sortOrder || null,
    );

    if (!cursor) {
      return { columns: [], rows: [] } as QueryResult;
    }

    const columnNames = cursor.getColumnNames();
    const columns: string[] = [];
    for (let i = 0; i < columnNames.length; i++) {
      columns.push(columnNames[i]);
    }

    const rows: (string | number | null)[][] = [];
    const LIMIT = 500;
    let count = 0;

    while (cursor.moveToNext() && count < LIMIT) {
      const row: (string | number | null)[] = [];
      for (let col = 0; col < columns.length; col++) {
        const type = cursor.getType(col);
        switch (type) {
          case 0: // NULL
            row.push(null);
            break;
          case 1: // INTEGER
            row.push(cursor.getLong(col));
            break;
          case 2: // FLOAT
            row.push(cursor.getDouble(col));
            break;
          case 3: // STRING
            row.push(cursor.getString(col));
            break;
          case 4: // BLOB
            row.push("[blob]");
            break;
          default:
            row.push(cursor.getString(col));
        }
      }
      rows.push(row);
      count++;
    }

    cursor.close();
    return { columns, rows } as QueryResult;
  });
}

function buildContentValues(values: ContentValues): Java.Wrapper {
  const ContentValues = Java.use("android.content.ContentValues");
  const cv = ContentValues.$new();

  for (const [key, entry] of Object.entries(values)) {
    switch (entry.type) {
      case "string":
        cv.put(
          key,
          Java.use("java.lang.String").$new(entry.value as string),
        );
        break;
      case "integer":
        cv.put(
          key,
          Java.use("java.lang.Integer").$new(entry.value as number),
        );
        break;
      case "long":
        cv.put(
          key,
          Java.use("java.lang.Long").$new(entry.value as number),
        );
        break;
      case "float":
        cv.put(
          key,
          Java.use("java.lang.Float").$new(entry.value as number),
        );
        break;
      case "double":
        cv.put(
          key,
          Java.use("java.lang.Double").$new(entry.value as number),
        );
        break;
      case "boolean":
        cv.put(
          key,
          Java.use("java.lang.Boolean").$new(entry.value as boolean),
        );
        break;
      case "short":
        cv.put(
          key,
          Java.use("java.lang.Short").$new(entry.value as number),
        );
        break;
    }
  }

  return cv;
}

export function insert(uri: string, values: ContentValues) {
  return perform(() => {
    const Uri = Java.use("android.net.Uri");
    const cr = getContext().getContentResolver();
    const result = cr.insert(Uri.parse(uri), buildContentValues(values));
    return result ? (result.toString() as string) : null;
  });
}

export function update(
  uri: string,
  values: ContentValues,
  selection?: string,
  selectionArgs?: string[],
) {
  return perform(() => {
    const Uri = Java.use("android.net.Uri");
    const cr = getContext().getContentResolver();

    const args = selectionArgs
      ? Java.array("java.lang.String", selectionArgs)
      : null;

    return cr.update(
      Uri.parse(uri),
      buildContentValues(values),
      selection || null,
      args,
    ) as number;
  });
}

export function del(uri: string, selection?: string, selectionArgs?: string[]) {
  return perform(() => {
    const Uri = Java.use("android.net.Uri");
    const cr = getContext().getContentResolver();

    const args = selectionArgs
      ? Java.array("java.lang.String", selectionArgs)
      : null;

    return cr.delete(
      Uri.parse(uri),
      selection || null,
      args,
    ) as number;
  });
}

```

`agent/src/droid/modules/receivers.ts`:

```ts
import Java from "frida-java-bridge";

import { perform } from "@/common/hooks/java.js";
import { getContext } from "@/droid/lib/context.js";
import { buildIntent, type IntentOptions } from "@/droid/lib/intent.js";

export type { IntentOptions as BroadcastOptions };

export interface ReceiverEntry {
  name: string;
  exported: boolean;
  permission: string | null;
}

export function list() {
  return perform(() => {
    const PackageManager = Java.use("android.content.pm.PackageManager");

    const context = getContext();
    const pm = context.getPackageManager();
    const pkg = pm.getPackageInfo(
      context.getPackageName(),
      PackageManager.GET_RECEIVERS.value,
    );

    const result: ReceiverEntry[] = [];
    const receivers = pkg.receivers?.value;
    if (receivers) {
      for (let i = 0; i < receivers.length; i++) {
        const r = receivers[i];
        result.push({
          name: r.name?.value || "",
          exported: !!r.exported?.value,
          permission: r.permission?.value || null,
        });
      }
    }

    return result;
  });
}

export function send(options: IntentOptions) {
  return perform(() => {
    const intent = buildIntent(options);
    getContext().sendBroadcast(intent);
  });
}

```

`agent/src/droid/modules/rn.ts`:

```ts
import Java from "frida-java-bridge";
import { perform } from "@/common/hooks/java.js";
import {
  type RNArch,
  type RNInstance,
  sendHermesByteCode,
  createCallbackContext,
} from "@/common/hermes.js";
import { readFile, unlink } from "@/lib/posix.js";

const CLASS_NAMES: Record<RNArch, string> = {
  legacy: "com.facebook.react.bridge.CatalystInstanceImpl",
  bridgeless: "com.facebook.react.runtime.ReactInstance",
};

let injecting = false;
const cb = createCallbackContext();
let callbackHooked = false;

function hookBundleLoader() {
  try {
    const CatalystInstanceImpl = Java.use(CLASS_NAMES.legacy);
    CatalystInstanceImpl.loadScriptFromFile.implementation = function (
      fileName: string,
      sourceURL: string,
      loadSynchronously: boolean,
    ) {
      if (!injecting && fileName) {
        const bytes = readFile(fileName);
        if (bytes) sendHermesByteCode(fileName, bytes);
      }
      return this.loadScriptFromFile(fileName, sourceURL, loadSynchronously);
    };
  } catch {}
}

function ensureCallbackHook() {
  if (callbackHooked) return;
  callbackHooked = true;

  const DialogModule = Java.use(
    "com.facebook.react.modules.dialog.DialogModule",
  );
  DialogModule.showAlert.implementation = function (
    opt: Java.Wrapper,
    errorCallback: Java.Wrapper,
    actionCallback: Java.Wrapper,
  ) {
    const msg = opt.getString("message");
    if (msg && cb.parseCallback(msg.toString())) return;
    return this.showAlert(opt, errorCallback, actionCallback);
  };
}

function hashcode(instance: Java.Wrapper): string {
  return String(Java.use("java.lang.System").identityHashCode(instance));
}

export function arch() {
  return perform(() => {
    const result = { legacy: false, bridgeless: false };
    try { Java.use(CLASS_NAMES.legacy); result.legacy = true; } catch {}
    try { Java.use(CLASS_NAMES.bridgeless); result.bridgeless = true; } catch {}
    return result;
  });
}

export function list() {
  return perform(() => {
    const results: RNInstance[] = [];
    for (const [arch, className] of Object.entries(CLASS_NAMES) as [
      RNArch,
      string,
    ][]) {
      try {
        Java.choose(className, {
          onMatch(instance) {
            results.push({ className, arch, handle: hashcode(instance) });
          },
          onComplete() {},
        });
      } catch {}
    }
    return results;
  });
}

export function inject(
  handle: string,
  arch: RNArch,
  script: string,
): Promise<string> {
  return new Promise((resolve, reject) => {
    Java.perform(() => {
      const className = CLASS_NAMES[arch];
      let found: Java.Wrapper | null = null;

      Java.choose(className, {
        onMatch(instance) {
          if (hashcode(instance) === handle) {
            found = instance;
            return "stop" as const;
          }
        },
        onComplete() {},
      });

      if (!found) {
        reject(new Error("Instance not found for handle: " + handle));
        return;
      }

      const instance = found as Java.Wrapper;
      const { id, path } = cb.prepare(script);

      ensureCallbackHook();
      cb.register(id, resolve);

      injecting = true;
      try {
        const url = "file://" + path;
        if (arch === "bridgeless") {
          instance.loadJSBundleFromFile(path, url);
        } else {
          instance.loadScriptFromFile(path, url, false);
        }
      } finally {
        injecting = false;
      }

      unlink(path);
    });
  });
}

perform(() => {
  hookBundleLoader();
});

```

`agent/src/droid/modules/services.ts`:

```ts
import Java from "frida-java-bridge";

import { perform } from "@/common/hooks/java.js";
import { getContext } from "@/droid/lib/context.js";
import { buildIntent, type IntentOptions } from "@/droid/lib/intent.js";

export type { IntentOptions };

export interface ServiceEntry {
  name: string;
  exported: boolean;
  permission: string | null;
}

export function list() {
  return perform(() => {
    const PackageManager = Java.use("android.content.pm.PackageManager");

    const context = getContext();
    const pm = context.getPackageManager();
    const pkg = pm.getPackageInfo(
      context.getPackageName(),
      PackageManager.GET_SERVICES.value,
    );

    const result: ServiceEntry[] = [];
    const services = pkg.services?.value;
    if (services) {
      for (let i = 0; i < services.length; i++) {
        const s = services[i];
        result.push({
          name: s.name?.value || "",
          exported: !!s.exported?.value,
          permission: s.permission?.value || null,
        });
      }
    }

    return result;
  });
}

export function start(options: IntentOptions) {
  return perform(() => {
    const intent = buildIntent(options);
    getContext().startService(intent);
  });
}

export function stop(options: IntentOptions) {
  return perform(() => {
    const intent = buildIntent(options);
    return getContext().stopService(intent) as boolean;
  });
}

```

`agent/src/droid/registry.ts`:

```ts
import route from "./router.js";
import { createRegistry, type RemoteRPC } from "@/common/registry.js";

const { invoke, interfaces } = createRegistry(route);

export { invoke, interfaces };

// some typescript magic
export type RPCRoute = typeof route;

export type { RemoteRPC };

```

`agent/src/droid/router.ts`:

```ts
import * as activities from "./modules/activities.js";
import * as app from "./modules/app.js";
import * as classes from "./modules/classes.js";
import * as crypto from "./crypto/index.js";
import * as device from "./modules/device.js";
import * as fs from "./modules/fs.js";
import * as hook from "./hooks/index.js";
import * as keystore from "./modules/keystore.js";
import * as lsof from "./modules/lsof.js";
import * as manifest from "./modules/manifest.js";
import * as provider from "./modules/provider.js";
import * as rn from "./modules/rn.js";
import * as receivers from "./modules/receivers.js";
import * as services from "./modules/services.js";

import * as taps from "./taps.js";

import * as memory from "@/common/memory.js";
import * as native from "@/common/hooks/native.js";
import * as sqlite from "@/common/sqlite.js";
import * as symbol from "@/common/symbol.js";
import * as script from "@/common/script.js";
import * as syslog from "@/common/syslog.js";

export default {
  activities,
  app,
  classes,
  crypto,
  device,
  fs,
  hook,
  keystore,
  lsof,
  manifest,
  memory,
  native,
  provider,
  receivers,
  rn,
  script,
  services,
  sqlite,
  symbol,
  syslog,
  taps,
};

```

`agent/src/droid/taps.ts`:

```ts
import type { TapInfo, TapRule } from "@/common/taps.js";

import * as hookGroup from "./hooks/index.js";
import * as flutter from "./hooks/flutter.js";
import * as jni from "./hooks/jni.js";

interface TapEntry {
  start(): void;
  stop(): void;
  status(): boolean;
  available(): boolean;
}

const BUILTIN_GROUPS = [
  "clipboard",
  "broadcast",
  "intent",
  "sharedpref",
] as const;

const registry = new Map<string, TapEntry>();

for (const id of BUILTIN_GROUPS) {
  registry.set(id, {
    start: () => hookGroup.start(id),
    stop: () => hookGroup.stop(id),
    status: () => hookGroup.status()[id] ?? false,
    available: () => true,
  });
}

registry.set("flutter", flutter);
registry.set("jni", jni);

export function list(): TapInfo[] {
  const result: TapInfo[] = [];
  for (const [id, entry] of registry) {
    result.push({
      id,
      active: entry.status(),
      available: entry.available(),
    });
  }
  return result;
}

function resolve(id: string): TapEntry {
  const entry = registry.get(id);
  if (!entry) throw new Error(`Unknown tap: ${id}`);
  return entry;
}

export function active(id: string): boolean {
  return resolve(id).status();
}

export function available(id: string): boolean {
  return resolve(id).available();
}

export function start(id: string): void {
  resolve(id).start();
}

export function stop(id: string): void {
  resolve(id).stop();
}

export function snapshot(): TapRule[] {
  const rules: TapRule[] = [];

  for (const [id, entry] of registry) {
    if (entry.status()) {
      rules.push({ type: "builtin", id });
    }
  }

  return rules;
}

export function restore(rules: TapRule[]): void {
  for (const rule of rules) {
    try {
      switch (rule.type) {
        case "builtin":
          start(rule.id);
          break;
      }
    } catch (e) {
      console.warn(`taps: failed to restore rule ${JSON.stringify(rule)}:`, e);
    }
  }
}

```

`agent/src/droid/tests.ts`:

```ts
/**
 * Droid module test suite — current app only.
 *
 * Usage:
 *   frida-compile src/droid/tests.ts -o /tmp/tests.js
 *   frida -U <app> -l /tmp/tests.js
 *
 *   or directly:
 *   frida -U <app> -l src/droid/tests.ts
 */

import Java from "frida-java-bridge";

import {
  test,
  skip,
  json,
  assert,
  assertType,
  assertArray,
  assertKeys,
  assertNonEmpty,
  summary,
} from "@/common/test-runner.js";
import * as activities from "./modules/activities.js";
import * as services from "./modules/services.js";
import * as receivers from "./modules/receivers.js";
import * as provider from "./modules/provider.js";
import * as device from "./modules/device.js";
import * as fs from "./modules/fs.js";

// ---------------------------------------------------------------------------
// test suites
// ---------------------------------------------------------------------------

async function testDevice() {
  console.log("\n--- device ---");

  await test("device.info returns build fields", async () => {
    const d = await device.info();
    assertKeys(
      d as unknown as Record<string, unknown>,
      ["model", "brand", "manufacturer", "sdk", "release", "fingerprint"],
      "device.info",
    );
    assertType(d.sdk, "number", "sdk");
    assert(d.sdk > 0, "sdk should be > 0");
    assertType(d.model, "string", "model");
    assert(d.model.length > 0, "model should be non-empty");
    console.log(
      `    model=${d.model} brand=${d.brand} sdk=${d.sdk} release=${d.release}`,
    );
  });

  await test("device.properties returns key-value map", async () => {
    const props = await device.properties();
    assertType(props, "object", "properties");
    const keys = Object.keys(props);
    assert(keys.length > 0, "properties should be non-empty");
    console.log(`    ${keys.length} properties`);
  });
}

async function testActivities() {
  console.log("\n--- activities ---");

  await test("activities.list returns current app activities", async () => {
    const all = await activities.list();
    assertArray(all, "list");
    assertNonEmpty(all, "list");
    for (const a of all.slice(0, 3)) {
      assertKeys(
        a as unknown as Record<string, unknown>,
        ["name", "exported", "permission"],
        "activity entry",
      );
      assertType(a.name, "string", "name");
      assertType(a.exported, "boolean", "exported");
    }
    const exported = all.filter((a) => a.exported).length;
    console.log(`    ${all.length} activities (${exported} exported)`);
    console.log(`    first: ${all[0].name}`);
  });

  await test("activities.start opens Android Settings", async () => {
    await activities.start({
      action: "android.settings.SETTINGS",
    });
    console.log("    started Settings activity");
  });
}

async function testServices() {
  console.log("\n--- services ---");

  await test("services.list returns current app services", async () => {
    const all = await services.list();
    assertArray(all, "list");
    assertNonEmpty(all, "list");
    for (const s of all.slice(0, 3)) {
      assertKeys(
        s as unknown as Record<string, unknown>,
        ["name", "exported", "permission"],
        "service entry",
      );
    }
    const exported = all.filter((s) => s.exported).length;
    console.log(`    ${all.length} services (${exported} exported)`);
    console.log(`    first: ${all[0].name}`);
  });

  skip(
    "services.start",
    "side-effect: requires a known safe service component",
  );
  skip("services.stop", "side-effect: requires a running service");
}

async function testReceivers() {
  console.log("\n--- receivers ---");

  await test("receivers.list returns current app receivers", async () => {
    const all = await receivers.list();
    assertArray(all, "list");
    assertNonEmpty(all, "list");
    for (const r of all.slice(0, 3)) {
      assertKeys(
        r as unknown as Record<string, unknown>,
        ["name", "exported", "permission"],
        "receiver entry",
      );
    }
    const exported = all.filter((r) => r.exported).length;
    console.log(`    ${all.length} receivers (${exported} exported)`);
    console.log(`    first: ${all[0].name}`);
  });

  await test("receivers.send with a no-op custom action", async () => {
    await receivers.send({
      action: "com.igf.test.NOOP_ACTION_" + Date.now(),
    });
    console.log("    broadcast sent (no receivers expected)");
  });
}

async function testProvider() {
  console.log("\n--- provider ---");

  await test("provider.query settings/secure with selection", async () => {
    const result = await provider.query("content://settings/secure", {
      projection: ["name", "value"],
      selection: "name=?",
      selectionArgs: ["android_id"],
    });
    assertKeys(
      result as unknown as Record<string, unknown>,
      ["columns", "rows"],
      "query result",
    );
    assertArray(result.columns, "columns");
    assertArray(result.rows, "rows");
    assert(
      result.columns.length === 2,
      `expected 2 columns, got ${result.columns.length}`,
    );
    console.log(`    columns: ${result.columns.join(", ")}`);
    console.log(`    ${result.rows.length} rows`);
    if (result.rows.length > 0) {
      console.log(`    first row: ${json(result.rows[0])}`);
    }
  });

  await test("provider.query with no options returns full table", async () => {
    const result = await provider.query("content://settings/global");
    assertArray(result.columns, "columns");
    assertArray(result.rows, "rows");
    assertNonEmpty(result.rows, "rows");
    console.log(`    columns: ${result.columns.join(", ")}`);
    console.log(`    ${result.rows.length} rows (limited to 500)`);
  });

  await test("provider.query with sortOrder passes through param", async () => {
    const result = await provider.query("content://settings/global", {
      sortOrder: "name ASC",
    });
    assertNonEmpty(result.rows, "rows with sortOrder");
    console.log(`    ${result.rows.length} rows returned with sortOrder param`);
  });

  await test("provider.query with invalid uri handles gracefully", async () => {
    let threw = false;
    try {
      await provider.query("content://invalid.nonexistent.provider.12345/data");
    } catch (_) {
      threw = true;
    }
    if (!threw) console.log("    (returned empty result instead of throwing)");
    console.log("    handled gracefully");
  });

  skip("provider.insert", "side-effect: requires a writable content provider");
  skip("provider.update", "side-effect: requires a writable content provider");
  skip("provider.del", "side-effect: requires a writable content provider");
}

async function testFs() {
  console.log("\n--- fs ---");

  const { home } = await fs.roots();

  await test("fs.ls home returns app data directory listing", async () => {
    const result = await fs.ls(home);
    assertKeys(
      result as unknown as Record<string, unknown>,
      ["cwd", "list"],
      "ls result",
    );
    assertType(result.cwd, "string", "cwd");
    assertArray(result.list, "list");
    assert(result.cwd.startsWith("/"), "cwd should be absolute path");
    console.log(`    cwd=${result.cwd}`);
    console.log(`    ${result.list.length} entries`);
    if (result.list.length > 0) {
      const first = result.list[0];
      assertKeys(
        first as unknown as Record<string, unknown>,
        ["name", "dir", "size", "created", "symlink", "writable"],
        "MetaData",
      );
      console.log(
        `    first: ${first.name} (dir=${first.dir} size=${first.size})`,
      );
    }
  });

  await test("fs.ls /proc returns entries", async () => {
    const result = await fs.ls("/proc");
    assertArray(result.list, "list");
    assertNonEmpty(result.list, "list");
    console.log(`    /proc has ${result.list.length} entries`);
  });

  await test("fs.ls with invalid path throws", async () => {
    let threw = false;
    try {
      await fs.ls("/nonexistent_path_12345");
    } catch (_) {
      threw = true;
    }
    assert(threw, "should throw for invalid path");
    console.log("    correctly threw for invalid path");
  });

  await test("fs.attrs on app data dir returns stat fields", async () => {
    const result = await fs.ls(home);
    const a = await fs.attrs(result.cwd);
    assertKeys(
      a as unknown as Record<string, unknown>,
      ["uid", "gid", "perm", "size", "type", "created"],
      "attrs",
    );
    assertType(a.uid, "number", "uid");
    assertType(a.gid, "number", "gid");
    assertType(a.perm, "number", "perm");
    assert(a.type === "directory", `expected directory, got ${a.type}`);
    console.log(
      `    uid=${a.uid} gid=${a.gid} perm=${a.perm.toString(8)} type=${a.type}`,
    );
  });

  await test("fs.text reads a text file", async () => {
    const dir = home;
    const testPath = dir + "/igf_text_test_" + Date.now() + ".txt";
    await fs.saveText(testPath, "text read test content\n");

    const content = await fs.text(testPath);
    assertType(content, "string", "content");
    assert(content.length > 0, "content should be non-empty");
    assert(
      content === "text read test content\n",
      `content mismatch: ${json(content)}`,
    );
    console.log(`    read ${content.length} chars`);

    await fs.rm(testPath);
  });

  await test("fs.saveText + fs.text round-trip", async () => {
    const dir = home;
    const testPath = dir + "/igf_test_" + Date.now() + ".txt";
    const testContent = "hello from igf test\n";

    const ok = await fs.saveText(testPath, testContent);
    assert(ok === true, "saveText should return true");

    const readBack = await fs.text(testPath);
    assert(readBack === testContent, `round-trip mismatch: ${json(readBack)}`);
    console.log(`    wrote and read back ${testContent.length} chars`);

    // cleanup
    const deleted = await fs.rm(testPath);
    assert(deleted === true, "rm should return true");
    console.log("    cleaned up test file");
  });

  await test("fs.data reads binary data", async () => {
    const dir = home;
    const testPath = dir + "/igf_bin_test_" + Date.now() + ".bin";
    await fs.saveText(testPath, "binary test data");

    const buf = await fs.data(testPath);
    assert(buf !== null, "data should not return null");
    assert(buf!.byteLength > 0, "data should be non-empty");
    console.log(`    read ${buf!.byteLength} bytes`);

    await fs.rm(testPath);
  });

  await test("fs.preview reads limited data", async () => {
    const dir = home;
    const testPath = dir + "/igf_preview_test_" + Date.now() + ".txt";
    await fs.saveText(testPath, "preview test data content");

    const buf = await fs.preview(testPath);
    assert(buf !== null, "preview should not return null");
    assert(buf!.byteLength > 0, "preview should be non-empty");
    console.log(`    preview read ${buf!.byteLength} bytes`);

    await fs.rm(testPath);
  });

  await test("fs.cp copies a file", async () => {
    const dir = home;
    const srcPath = dir + "/igf_cp_src_" + Date.now() + ".txt";
    const dstPath = dir + "/igf_cp_dst_" + Date.now() + ".txt";

    await fs.saveText(srcPath, "copy test content");
    const ok = await fs.cp(srcPath, dstPath);
    assert(ok === true, "cp should return true");

    const content = await fs.text(dstPath);
    assert(content === "copy test content", `copy mismatch: ${json(content)}`);
    console.log("    copied and verified");

    await fs.rm(srcPath);
    await fs.rm(dstPath);
  });

  await test("fs.mv renames a file", async () => {
    const dir = home;
    const srcPath = dir + "/igf_mv_src_" + Date.now() + ".txt";
    const dstPath = dir + "/igf_mv_dst_" + Date.now() + ".txt";

    await fs.saveText(srcPath, "move test content");
    const ok = await fs.mv(srcPath, dstPath);
    assert(ok === true, "mv should return true");

    const content = await fs.text(dstPath);
    assert(content === "move test content", `move mismatch: ${json(content)}`);

    // src should no longer exist
    let srcExists = true;
    try {
      await fs.attrs(srcPath);
    } catch (_) {
      srcExists = false;
    }
    assert(!srcExists, "source should not exist after mv");
    console.log("    moved and verified");

    await fs.rm(dstPath);
  });

}

// ---------------------------------------------------------------------------
// runner
// ---------------------------------------------------------------------------

async function run() {
  console.log("=== droid module tests ===");

  await testDevice();
  await testActivities();
  await testServices();
  await testReceivers();
  await testProvider();
  await testFs();

  summary();
}

Java.perform(() => {
  const Handler = Java.use("android.os.Handler");
  const Looper = Java.use("android.os.Looper");
  const Runnable = Java.use("java.lang.Runnable");

  const RunnableImpl = Java.registerClass({
    name: "com.igf.test.TestRunner",
    implements: [Runnable],
    methods: {
      run() {
        run().catch((e) => {
          console.log(
            `\nFATAL: ${e instanceof Error ? e.stack || e.message : String(e)}`,
          );
        });
      },
    },
  });

  const handler = Handler.$new(Looper.getMainLooper());
  handler.post(RunnableImpl.$new());
});

```

`agent/src/fruity/bridge/nsarray.ts`:

```ts
import ObjC from "frida-objc-bridge";
import type { NSArray, NSObject } from "@/fruity/typings.js";

export function* iterateNSArray(arr: NSArray<NSObject>) {
  if (!arr.isKindOfClass_(ObjC.classes.NSArray))
    throw new Error(`Unexpected class ${arr.$className}`);

  const count = arr.count();
  for (let i = 0; i < count; i++) yield arr.objectAtIndex_(i);
}

```

`agent/src/fruity/bridge/object.ts`:

```ts
import ObjC from "frida-objc-bridge";
/* eslint-disable @typescript-eslint/no-explicit-any */
import type {
  _Nullable,
  NSArray,
  NSDictionary,
  NSObject,
} from "@/fruity/typings.js";
import { iterateNSArray } from "./nsarray.js";

const NSPropertyListImmutable = 0;

export function* keys(dict: NSDictionary<NSObject, NSObject>) {
  if (!dict.isKindOfClass_(ObjC.classes.NSDictionary))
    throw new Error(`Unexpected class ${dict.$className}`);
  yield* iterateNSArray(dict.allKeys());
}

export function toJS(value: _Nullable<ObjC.Object>): any {
  if (!value) return null;

  const { NSArray, NSData, NSDictionary, NSNumber, __NSCFBoolean, NSDate } =
    ObjC.classes;
  if (value.isKindOfClass_(__NSCFBoolean)) return value.boolValue();
  if (value.isKindOfClass_(NSArray))
    return toJsArray(value as NSArray<ObjC.Object>);
  if (value.isKindOfClass_(NSDictionary))
    return toJsDict(value as NSDictionary<ObjC.Object, ObjC.Object>);
  if (value.isKindOfClass_(NSNumber)) return parseFloat(value.toString()); // might lost precision
  if (value.isKindOfClass_(NSDate))
    return new Date(value.timeIntervalSince1970() * 1000);
  if (value.isKindOfClass_(NSData))
    return (value.bytes() as NativePointer).readByteArray(value.length());
  return value.toString();
}

type Dictionary = { [key: string]: any };

export function toJsDict(
  nsDict: NSDictionary<ObjC.Object, ObjC.Object>,
): Dictionary {
  const jsDict: Dictionary = {};
  const keys = nsDict.allKeys();
  const count = keys.count();
  for (let i = 0; i < count; i++) {
    const key = keys.objectAtIndex_(i);
    const value = nsDict.objectForKey_(key);
    jsDict[key.toString()] = toJS(value);
  }

  return jsDict;
}

export function fromBytes(address: NativePointer, size: number): Dictionary {
  const { NSData, NSPropertyListSerialization } = ObjC.classes;
  const format = Memory.alloc(Process.pointerSize);
  const err = Memory.alloc(Process.pointerSize).writePointer(NULL);
  const data = NSData.dataWithBytesNoCopy_length_freeWhenDone_(
    address,
    size,
    0,
  );
  const dict =
    NSPropertyListSerialization.propertyListFromData_mutabilityOption_format_errorDescription_(
      data,
      NSPropertyListImmutable,
      format,
      err,
    );

  const desc = err.readPointer();
  if (!desc.isNull()) throw new Error(new ObjC.Object(desc).toString());

  return toJsDict(dict);
}

export function toJsArray(
  original: NSArray<ObjC.Object>,
  limit: number = Infinity,
): any[] {
  const arr = [];
  const count = original.count();
  const len = Number.isNaN(limit) ? Math.min(count, limit) : count;
  for (let i = 0; i < len; i++) {
    const val = original.objectAtIndex_(i);
    arr.push(toJS(val));
  }
  return arr;
}

export function toObjC(value: unknown): ObjC.Object {
  if (value === null || value === undefined) return ObjC.classes.NSNull.null();
  if (typeof value === "string")
    return ObjC.classes.NSString.stringWithString_(value);
  if (typeof value === "number")
    return ObjC.classes.NSNumber.numberWithDouble_(value);
  if (typeof value === "boolean")
    return ObjC.classes.NSNumber.numberWithBool_(value ? 1 : 0);
  if (value instanceof Date)
    return ObjC.classes.NSDate.dateWithTimeIntervalSince1970_(
      value.getTime() / 1000,
    );
  if (Array.isArray(value)) {
    const arr = ObjC.classes.NSMutableArray.alloc().init();
    for (const item of value) arr.addObject_(toObjC(item));
    return arr;
  }
  if (typeof value === "object") {
    const dict = ObjC.classes.NSMutableDictionary.alloc().init();
    for (const [k, v] of Object.entries(value as Record<string, unknown>)) {
      dict.setObject_forKey_(
        toObjC(v),
        ObjC.classes.NSString.stringWithString_(k),
      );
    }
    return dict;
  }
  return ObjC.classes.NSString.stringWithString_(String(value));
}

export function description(obj: ObjC.Object) {
  if (!obj) return `${obj}`;
  if (obj.isKindOfClass_(ObjC.classes.NSBlock))
    return `<Block ${obj.handle}, invoke=${obj.handle.add(Process.pointerSize * 2).readPointer()}>`;
  if (obj.isKindOfClass_(ObjC.classes.NSArray))
    return `[Array of ${obj.count()} elements]`;
  if (obj.isKindOfClass_(ObjC.classes.NSDictionary))
    return `{Dictionary of ${obj.count()} entries}`;
  if (obj.$handle === obj.$class.$handle) return `<Class ${obj.$className}>`;
  return `${obj}`;
}

```

`agent/src/fruity/crypto/crypto.ts`:

```ts
import cf from "@/fruity/native/corefoundation.js";
import { BaseMessage, bt } from "@/common/hooks/context.js";

const CC_ALGORITHMS = ["AES", "DES", "3DES", "CAST", "RC4", "RC2"];
const HMAC_ALGORITHMS = ["SHA1", "MD5", "SHA256", "SHA384", "SHA512", "SHA224"];

export function x509() {
  const Security = Process.findModuleByName("Security");
  if (!Security) return [];

  return [
    Interceptor.attach(
      Security.getExportByName("SecCertificateCreateWithData"),
      {
        onEnter(args) {
          const { CFDataGetLength, CFDataGetBytePtr } = cf();
          const p = CFDataGetBytePtr(args[1]);
          const len = CFDataGetLength(args[1]);
          const der = p.readByteArray(len);

          send(
            {
              subject: "crypto",
              category: "x509",
              symbol: "SecCertificateCreateWithData",
              dir: "enter",
              line: `SecCertificateCreateWithData(data[${len}])`,
              backtrace: bt(this.context),
            } satisfies BaseMessage,
            der,
          );
        },
      },
    ),
  ];
}

export function cccrypt() {
  const cc = Process.findModuleByName("libcommonCrypto.dylib");
  if (!cc) return [];

  return [
    "CCCryptorCreate",
    "CCCryptorCreateFromData",
    "CCCryptorUpdate",
    "CCCryptorFinal",
    "CCCrypt",
    "CCCryptorReset",
  ]
    .map((sym) => {
      const addr = cc.getExportByName(sym);
      if (!addr) return null;

      return Interceptor.attach(addr, {
        onEnter(args) {
          this.symbol = sym;

          if (
            sym === "CCCryptorCreate" ||
            sym === "CCCryptorCreateFromData" ||
            sym === "CCCrypt"
          ) {
            const opVal = args[0].toInt32();
            const alg = args[1].toInt32();
            const op = opVal === 0 ? "encrypt" : "decrypt";
            const algo = CC_ALGORITHMS[alg] || "Unknown";

            const keyLen = args[4].toInt32();
            const key = args[3].readByteArray(keyLen);
            send(
              {
                subject: "crypto",
                category: "cccrypt",
                symbol: sym,
                dir: "enter",
                line: `${sym}(${op}, ${algo}, key[${keyLen}])`,
                backtrace: bt(this.context),
                extra: { op, algo, detailType: "key" },
              } satisfies BaseMessage,
              key,
            );
          }

          if (sym === "CCCryptorUpdate" || sym === "CCCrypt") {
            const dataInIdx = sym === "CCCrypt" ? 6 : 1;
            const lenIdx = sym === "CCCrypt" ? 7 : 2;
            const len = args[lenIdx].toInt32();
            const data = args[dataInIdx].readByteArray(len);

            send(
              {
                subject: "crypto",
                category: "cccrypt",
                symbol: sym,
                dir: "enter",
                line: `${sym}(input[${len}])`,
                backtrace: bt(this.context),
                extra: { detailType: "input", len },
              } satisfies BaseMessage,
              data,
            );

            this.outPtr = args[sym === "CCCrypt" ? 8 : 3];
            this.movedPtr = args[sym === "CCCrypt" ? 10 : 5];
          }

          if (sym === "CCCryptorFinal") {
            this.outPtr = args[1];
            this.movedPtr = args[3];
            send({
              subject: "crypto",
              category: "cccrypt",
              symbol: sym,
              dir: "enter",
              line: `${sym}()`,
              backtrace: bt(this.context),
            } satisfies BaseMessage);
          }
        },
        onLeave(retval) {
          if (
            this.outPtr &&
            !this.outPtr.isNull() &&
            this.movedPtr &&
            !this.movedPtr.isNull()
          ) {
            const moved = this.movedPtr.readPointer().toInt32();
            if (moved > 0) {
              const outData = this.outPtr.readByteArray(moved);
              send(
                {
                  subject: "crypto",
                  category: "cccrypt",
                  symbol: this.symbol,
                  dir: "leave",
                  line: `${this.symbol}() → output[${moved}]`,
                  extra: { detailType: "output", len: moved },
                } satisfies BaseMessage,
                outData,
              );
            }
          }
        },
      });
    })
    .filter((h) => h !== null);
}

export function hash() {
  const cc = Process.findModuleByName("libcommonCrypto.dylib");
  if (!cc) return [];

  const algs = ["SHA1", "SHA224", "SHA256", "SHA384", "SHA512", "MD5"];
  const hooks: InvocationListener[] = [];

  for (const alg of algs) {
    const oneShot = cc.getExportByName(`CC_${alg}`);
    if (oneShot) {
      hooks.push(
        Interceptor.attach(oneShot, {
          onEnter(args) {
            const len = args[1].toInt32();
            const backtrace = bt(this.context);

            // workaround: MobileGestalt uses MD5 to obfuscate strings, abvoid
            // todo: limit all hooks to app binaries only
            if (backtrace.at(0)?.startsWith('libMobileGestalt.dylib')) return;

            send(
              {
                subject: "crypto",
                category: "hash",
                symbol: `CC_${alg}`,
                dir: "enter",
                line: `CC_${alg}(data[${len}])`,
                backtrace,
                extra: { algo: alg, detailType: "input", len },
              } satisfies BaseMessage,
              args[0].readByteArray(len),
            );
          },
        }),
      );
    }

    const update = cc.getExportByName(`CC_${alg}_Update`);
    if (update) {
      hooks.push(
        Interceptor.attach(update, {
          onEnter(args) {
            const len = args[2].toInt32();
            send(
              {
                subject: "crypto",
                category: "hash",
                symbol: `CC_${alg}_Update`,
                dir: "enter",
                line: `CC_${alg}_Update(data[${len}])`,
                backtrace: bt(this.context),
                extra: { algo: alg, detailType: "input", len },
              } satisfies BaseMessage,
              args[1].readByteArray(len),
            );
          },
        }),
      );
    }
  }
  return hooks;
}

export function hmac() {
  const cc = Process.findModuleByName("libcommonCrypto.dylib");
  if (!cc) return [];

  const hooks: InvocationListener[] = [];

  hooks.push(
    Interceptor.attach(cc.getExportByName("CCHmac"), {
      onEnter(args) {
        const alg = args[0].toInt32();
        const keyLen = args[2].toInt32();
        const dataLen = args[4].toInt32();
        const algo = HMAC_ALGORITHMS[alg] || "Unknown";

        send(
          {
            subject: "crypto",
            category: "hmac",
            symbol: "CCHmac",
            dir: "enter",
            line: `CCHmac(${algo}, key[${keyLen}], data[${dataLen}])`,
            backtrace: bt(this.context),
            extra: { algo, detailType: "input", len: dataLen },
          } satisfies BaseMessage,
          args[3].readByteArray(dataLen),
        );
        send(
          {
            subject: "crypto",
            category: "hmac",
            symbol: "CCHmac_Key",
            dir: "enter",
            line: `CCHmac key[${keyLen}]`,
            backtrace: bt(this.context),
            extra: { algo, detailType: "key", len: keyLen },
          } satisfies BaseMessage,
          args[1].readByteArray(keyLen),
        );
      },
    }),
  );

  hooks.push(
    Interceptor.attach(cc.getExportByName("CCHmacUpdate"), {
      onEnter(args) {
        const len = args[2].toInt32();
        send(
          {
            subject: "crypto",
            category: "hmac",
            symbol: "CCHmacUpdate",
            dir: "enter",
            line: `CCHmacUpdate(data[${len}])`,
            backtrace: bt(this.context),
            extra: { detailType: "input", len },
          } satisfies BaseMessage,
          args[1].readByteArray(len),
        );
      },
    }),
  );

  return hooks;
}

```

`agent/src/fruity/crypto/index.ts`:

```ts
import { createNative } from "@/common/hooks/group.js";
import * as crypto from "./crypto.js";

const CRYPTO_GROUPS = ["cccrypt", "x509", "hash", "hmac"] as const;

function get(group: string) {
  if (group === "cccrypt") {
    return [...crypto.cccrypt()];
  } else if (group === "x509") {
    return [...crypto.x509()];
  } else if (group === "hash") {
    return [...crypto.hash()];
  } else if (group === "hmac") {
    return [...crypto.hmac()];
  }
}

const { list, status, start, stop } = createNative(CRYPTO_GROUPS, get);
export { list, status, start, stop };

```

`agent/src/fruity/hooks/biometric.ts`:

```ts
import ObjC from "frida-objc-bridge";
import { bt } from "@/common/hooks/context.js";

const LA_POLICIES: Record<number, string> = {
  1: "DeviceOwnerAuthenticationWithBiometrics",
  2: "DeviceOwnerAuthentication",
  3: "DeviceOwnerAuthenticationWithWatch",
  4: "DeviceOwnerAuthenticationWithBiometricsOrWatch",
};

/**
 * Bypass Touch ID / Face ID authentication by hooking LAContext
 */
export function bypass() {
  if (!ObjC.available) return [];

  const hooks: InvocationListener[] = [];
  const LAContext = ObjC.classes.LAContext;
  if (!LAContext) return [];

  // Hook evaluatePolicy:localizedReason:reply:
  const evaluatePolicy = LAContext["- evaluatePolicy:localizedReason:reply:"];
  if (evaluatePolicy) {
    hooks.push(
      Interceptor.attach(evaluatePolicy.implementation, {
        onEnter(args) {
          this.policy = args[2].toInt32();
          this.reason = new ObjC.Object(args[3]).toString();

          // Get the reply block and replace its implementation
          const block = new ObjC.Block(args[4]);
          const origImpl = block.implementation;

          block.implementation = function (
            _success: boolean,
            _error: NativePointer,
          ) {
            // Always call with success=true, error=null
            return origImpl(true, NULL);
          };
        },
        onLeave() {
          const policyStr =
            LA_POLICIES[this.policy] || `Unknown(${this.policy})`;
          send({
            subject: "hook",
            category: "biometric",
            symbol: "-[LAContext evaluatePolicy:localizedReason:reply:]",
            dir: "leave",
            line: `evaluatePolicy(${policyStr}) → BYPASSED`,
            backtrace: bt(this.context),
            extra: { policy: policyStr, reason: this.reason, bypassed: true },
          });
        },
      }),
    );
  }

  // Hook canEvaluatePolicy:error: to always return YES
  const canEvaluatePolicy = LAContext["- canEvaluatePolicy:error:"];
  if (canEvaluatePolicy) {
    hooks.push(
      Interceptor.attach(canEvaluatePolicy.implementation, {
        onEnter(args) {
          this.policy = args[2].toInt32();
          // Clear the error pointer if provided
          if (!args[3].isNull()) {
            args[3].writePointer(NULL);
          }
        },
        onLeave(retval) {
          // Always return YES (1)
          retval.replace(ptr(1));

          const policyStr =
            LA_POLICIES[this.policy] || `Unknown(${this.policy})`;
          send({
            subject: "hook",
            category: "biometric",
            symbol: "-[LAContext canEvaluatePolicy:error:]",
            dir: "leave",
            line: `canEvaluatePolicy(${policyStr}) → YES (forced)`,
            extra: { policy: policyStr, bypassed: true },
          });
        },
      }),
    );
  }

  // Hook evaluateAccessControl:operation:localizedReason:reply:
  const evaluateAccessControl =
    LAContext["- evaluateAccessControl:operation:localizedReason:reply:"];
  if (evaluateAccessControl) {
    hooks.push(
      Interceptor.attach(evaluateAccessControl.implementation, {
        onEnter(args) {
          this.reason = new ObjC.Object(args[4]).toString();

          // Get the reply block and replace its implementation
          const block = new ObjC.Block(args[5]);
          const origImpl = block.implementation;

          block.implementation = function (
            _success: boolean,
            _error: NativePointer,
          ) {
            return origImpl(true, NULL);
          };
        },
        onLeave() {
          send({
            subject: "hook",
            category: "biometric",
            symbol:
              "-[LAContext evaluateAccessControl:operation:localizedReason:reply:]",
            dir: "leave",
            line: `evaluateAccessControl(...) → BYPASSED`,
            backtrace: bt(this.context),
            extra: { reason: this.reason, bypassed: true },
          });
        },
      }),
    );
  }

  return hooks;
}

```

`agent/src/fruity/hooks/deviceid.ts`:

```ts
import ObjC from "frida-objc-bridge";
import { BaseMessage } from "@/common/hooks/context.js";

function randomUUID(): string {
  return ObjC.classes.NSUUID.UUIDString;
}

// Generate fake IDs once per session
const FAKE_IDFV = randomUUID();
const FAKE_IDFA = randomUUID();

/**
 * Spoof device identifiers (IDFV, IDFA) with random UUIDs
 */
export function spoof() {
  if (!ObjC.available) return [];

  const hooks: InvocationListener[] = [];

  // Log the fake IDs at startup
  send({
    subject: "hook",
    category: "deviceid",
    symbol: "init",
    dir: "enter",
    line: `Spoofing IDFV=${FAKE_IDFV}, IDFA=${FAKE_IDFA}`,
    extra: { spoofed: `IDFV=${FAKE_IDFV}, IDFA=${FAKE_IDFA}` },
  } satisfies BaseMessage);

  // Hook UIDevice identifierForVendor
  const UIDevice = ObjC.classes.UIDevice;
  if (UIDevice) {
    const idfvGetter = UIDevice["- identifierForVendor"];
    if (idfvGetter) {
      hooks.push(
        Interceptor.attach(idfvGetter.implementation, {
          onLeave(retval) {
            if (retval.isNull()) return;

            const original = new ObjC.Object(retval).UUIDString().toString();
            const fakeUUID =
              ObjC.classes.NSUUID.alloc().initWithUUIDString_(FAKE_IDFV);
            retval.replace(fakeUUID);

            send({
              subject: "hook",
              category: "deviceid",
              symbol: "-[UIDevice identifierForVendor]",
              dir: "leave",
              line: `identifierForVendor() → ${FAKE_IDFV} (was: ${original})`,
              extra: { original, spoofed: FAKE_IDFV },
            } satisfies BaseMessage);
          },
        }),
      );
    }
  }

  // Hook ASIdentifierManager advertisingIdentifier (IDFA)
  const ASIdentifierManager = ObjC.classes.ASIdentifierManager;
  if (ASIdentifierManager) {
    const idfaGetter = ASIdentifierManager["- advertisingIdentifier"];
    if (idfaGetter) {
      hooks.push(
        Interceptor.attach(idfaGetter.implementation, {
          onLeave(retval) {
            if (retval.isNull()) return;

            const original = new ObjC.Object(retval).UUIDString().toString();
            const fakeUUID =
              ObjC.classes.NSUUID.alloc().initWithUUIDString_(FAKE_IDFA);
            retval.replace(fakeUUID);

            send({
              subject: "hook",
              category: "deviceid",
              symbol: "-[ASIdentifierManager advertisingIdentifier]",
              dir: "leave",
              line: `advertisingIdentifier() → ${FAKE_IDFA} (was: ${original})`,
              extra: { original, spoofed: FAKE_IDFA },
            } satisfies BaseMessage);
          },
        }),
      );
    }
  }

  // Hook NSUUID UUIDString for any NSUUID that looks like a device ID
  // This catches cases where apps cache or transform the UUID
  const NSUUID = ObjC.classes.NSUUID;
  if (NSUUID) {
    const uuidStringGetter = NSUUID["- UUIDString"];
    if (uuidStringGetter) {
      // Track original IDFV/IDFA values to detect and replace them
      let originalIDFV: string | null = null;
      let originalIDFA: string | null = null;

      // Get the real values first
      try {
        if (UIDevice) {
          const device = UIDevice.currentDevice();
          const idfv = device.identifierForVendor();
          if (idfv) {
            originalIDFV = idfv.UUIDString().toString();
          }
        }
        if (ASIdentifierManager) {
          const manager = ASIdentifierManager.sharedManager();
          const idfa = manager.advertisingIdentifier();
          if (idfa) {
            originalIDFA = idfa.UUIDString().toString();
          }
        }
      } catch {
        // ignore errors getting original values
      }

      if (originalIDFV || originalIDFA) {
        hooks.push(
          Interceptor.attach(uuidStringGetter.implementation, {
            onLeave(retval) {
              if (retval.isNull()) return;

              const uuidStr = new ObjC.Object(retval).toString();

              // Replace if it matches original IDFV
              if (originalIDFV && uuidStr === originalIDFV) {
                const fakeStr =
                  ObjC.classes.NSString.stringWithString_(FAKE_IDFV);
                retval.replace(fakeStr);
              }
              // Replace if it matches original IDFA
              else if (originalIDFA && uuidStr === originalIDFA) {
                const fakeStr =
                  ObjC.classes.NSString.stringWithString_(FAKE_IDFA);
                retval.replace(fakeStr);
              }
            },
          }),
        );
      }
    }
  }

  return hooks;
}

```

`agent/src/fruity/hooks/fileops.ts`:

```ts
import { bt } from "@/common/hooks/context.js";

// Open flags
const O_RDONLY = 0x0000;
const O_WRONLY = 0x0001;
const O_RDWR = 0x0002;
const O_CREAT = 0x0200;
const O_TRUNC = 0x0400;
const O_EXCL = 0x0800;
const O_APPEND = 0x0008;

function formatOpenFlags(flags: number): string {
  const parts: string[] = [];

  const accessMode = flags & 0x3;
  if (accessMode === O_RDONLY) parts.push("O_RDONLY");
  else if (accessMode === O_WRONLY) parts.push("O_WRONLY");
  else if (accessMode === O_RDWR) parts.push("O_RDWR");

  if (flags & O_CREAT) parts.push("O_CREAT");
  if (flags & O_TRUNC) parts.push("O_TRUNC");
  if (flags & O_EXCL) parts.push("O_EXCL");
  if (flags & O_APPEND) parts.push("O_APPEND");

  return parts.length > 0 ? parts.join("|") : `0x${flags.toString(16)}`;
}

function q(s: string | null | undefined): string {
  return s ? `"${s}"` : "NULL";
}

/**
 * Monitor file system operations (open, create, delete, stat, access, rename, link)
 * Excludes write and fcntl as they are too verbose
 */
export function monitor() {
  const hooks: InvocationListener[] = [];
  const kernel = Process.findModuleByName("libsystem_kernel.dylib");
  if (!kernel) return [];

  // Hook open
  const openPtr = kernel.findExportByName("open");
  if (openPtr) {
    hooks.push(
      Interceptor.attach(openPtr, {
        onEnter(args) {
          this.path = args[0].readUtf8String();
          this.flags = args[1].toInt32();
        },
        onLeave(retval) {
          const fd = retval.toInt32();
          const isCreate = (this.flags & O_CREAT) !== 0;
          const flagsStr = formatOpenFlags(this.flags);

          send({
            subject: "hook",
            category: "fileops",
            symbol: "open",
            dir: "leave",
            line: `open(${q(this.path)}, ${flagsStr}) = ${fd}`,
            backtrace: bt(this.context),
            extra: { op: isCreate ? "create" : "open", path: this.path, flags: flagsStr, result: fd },
          });
        },
      }),
    );
  }

  // Hook openat
  const openatPtr = kernel.findExportByName("openat");
  if (openatPtr) {
    hooks.push(
      Interceptor.attach(openatPtr, {
        onEnter(args) {
          this.path = args[1].readUtf8String();
          this.flags = args[2].toInt32();
        },
        onLeave(retval) {
          const fd = retval.toInt32();
          const isCreate = (this.flags & O_CREAT) !== 0;
          const flagsStr = formatOpenFlags(this.flags);

          send({
            subject: "hook",
            category: "fileops",
            symbol: "openat",
            dir: "leave",
            line: `openat(AT_FDCWD, ${q(this.path)}, ${flagsStr}) = ${fd}`,
            backtrace: bt(this.context),
            extra: { op: isCreate ? "create" : "open", path: this.path, flags: flagsStr, result: fd },
          });
        },
      }),
    );
  }

  // Hook unlink (delete file)
  const unlinkPtr = kernel.findExportByName("unlink");
  if (unlinkPtr) {
    hooks.push(
      Interceptor.attach(unlinkPtr, {
        onEnter(args) {
          this.path = args[0].readUtf8String();
        },
        onLeave(retval) {
          const result = retval.toInt32();
          send({
            subject: "hook",
            category: "fileops",
            symbol: "unlink",
            dir: "leave",
            line: `unlink(${q(this.path)}) = ${result}`,
            backtrace: bt(this.context),
            extra: { op: "delete", path: this.path, result },
          });
        },
      }),
    );
  }

  // Hook unlinkat
  const unlinkatPtr = kernel.findExportByName("unlinkat");
  if (unlinkatPtr) {
    hooks.push(
      Interceptor.attach(unlinkatPtr, {
        onEnter(args) {
          this.path = args[1].readUtf8String();
        },
        onLeave(retval) {
          const result = retval.toInt32();
          send({
            subject: "hook",
            category: "fileops",
            symbol: "unlinkat",
            dir: "leave",
            line: `unlinkat(AT_FDCWD, ${q(this.path)}) = ${result}`,
            backtrace: bt(this.context),
            extra: { op: "delete", path: this.path, result },
          });
        },
      }),
    );
  }

  // Hook rmdir
  const rmdirPtr = kernel.findExportByName("rmdir");
  if (rmdirPtr) {
    hooks.push(
      Interceptor.attach(rmdirPtr, {
        onEnter(args) {
          this.path = args[0].readUtf8String();
        },
        onLeave(retval) {
          const result = retval.toInt32();
          send({
            subject: "hook",
            category: "fileops",
            symbol: "rmdir",
            dir: "leave",
            line: `rmdir(${q(this.path)}) = ${result}`,
            backtrace: bt(this.context),
            extra: { op: "delete", path: this.path, result },
          });
        },
      }),
    );
  }

  // Hook stat
  const statPtr = kernel.findExportByName("stat");
  if (statPtr) {
    hooks.push(
      Interceptor.attach(statPtr, {
        onEnter(args) {
          this.path = args[0].readUtf8String();
        },
        onLeave(retval) {
          const result = retval.toInt32();
          send({
            subject: "hook",
            category: "fileops",
            symbol: "stat",
            dir: "leave",
            line: `stat(${q(this.path)}) = ${result}`,
            backtrace: bt(this.context),
            extra: { op: "stat", path: this.path, result },
          });
        },
      }),
    );
  }

  // Hook stat64
  const stat64Ptr = kernel.findExportByName("stat64");
  if (stat64Ptr) {
    hooks.push(
      Interceptor.attach(stat64Ptr, {
        onEnter(args) {
          this.path = args[0].readUtf8String();
        },
        onLeave(retval) {
          const result = retval.toInt32();
          send({
            subject: "hook",
            category: "fileops",
            symbol: "stat64",
            dir: "leave",
            line: `stat64(${q(this.path)}) = ${result}`,
            backtrace: bt(this.context),
            extra: { op: "stat", path: this.path, result },
          });
        },
      }),
    );
  }

  // Hook lstat
  const lstatPtr = kernel.findExportByName("lstat");
  if (lstatPtr) {
    hooks.push(
      Interceptor.attach(lstatPtr, {
        onEnter(args) {
          this.path = args[0].readUtf8String();
        },
        onLeave(retval) {
          const result = retval.toInt32();
          send({
            subject: "hook",
            category: "fileops",
            symbol: "lstat",
            dir: "leave",
            line: `lstat(${q(this.path)}) = ${result}`,
            backtrace: bt(this.context),
            extra: { op: "stat", path: this.path, result },
          });
        },
      }),
    );
  }

  // Hook lstat64
  const lstat64Ptr = kernel.findExportByName("lstat64");
  if (lstat64Ptr) {
    hooks.push(
      Interceptor.attach(lstat64Ptr, {
        onEnter(args) {
          this.path = args[0].readUtf8String();
        },
        onLeave(retval) {
          const result = retval.toInt32();
          send({
            subject: "hook",
            category: "fileops",
            symbol: "lstat64",
            dir: "leave",
            line: `lstat64(${q(this.path)}) = ${result}`,
            backtrace: bt(this.context),
            extra: { op: "stat", path: this.path, result },
          });
        },
      }),
    );
  }

  // Hook access
  const accessPtr = kernel.findExportByName("access");
  if (accessPtr) {
    hooks.push(
      Interceptor.attach(accessPtr, {
        onEnter(args) {
          this.path = args[0].readUtf8String();
          this.mode = args[1].toInt32();
        },
        onLeave(retval) {
          const result = retval.toInt32();
          send({
            subject: "hook",
            category: "fileops",
            symbol: "access",
            dir: "leave",
            line: `access(${q(this.path)}, ${this.mode}) = ${result}`,
            backtrace: bt(this.context),
            extra: { op: "access", path: this.path, mode: this.mode, result },
          });
        },
      }),
    );
  }

  // Hook faccessat
  const faccessatPtr = kernel.findExportByName("faccessat");
  if (faccessatPtr) {
    hooks.push(
      Interceptor.attach(faccessatPtr, {
        onEnter(args) {
          this.path = args[1].readUtf8String();
          this.mode = args[2].toInt32();
        },
        onLeave(retval) {
          const result = retval.toInt32();
          send({
            subject: "hook",
            category: "fileops",
            symbol: "faccessat",
            dir: "leave",
            line: `faccessat(AT_FDCWD, ${q(this.path)}, ${this.mode}) = ${result}`,
            backtrace: bt(this.context),
            extra: { op: "access", path: this.path, mode: this.mode, result },
          });
        },
      }),
    );
  }

  // Hook rename
  const renamePtr = kernel.findExportByName("rename");
  if (renamePtr) {
    hooks.push(
      Interceptor.attach(renamePtr, {
        onEnter(args) {
          this.oldPath = args[0].readUtf8String();
          this.newPath = args[1].readUtf8String();
        },
        onLeave(retval) {
          const result = retval.toInt32();
          send({
            subject: "hook",
            category: "fileops",
            symbol: "rename",
            dir: "leave",
            line: `rename(${q(this.oldPath)}, ${q(this.newPath)}) = ${result}`,
            backtrace: bt(this.context),
            extra: { op: "rename", path: this.oldPath, path2: this.newPath, result },
          });
        },
      }),
    );
  }

  // Hook renameat
  const renameatPtr = kernel.findExportByName("renameat");
  if (renameatPtr) {
    hooks.push(
      Interceptor.attach(renameatPtr, {
        onEnter(args) {
          this.oldPath = args[1].readUtf8String();
          this.newPath = args[3].readUtf8String();
        },
        onLeave(retval) {
          const result = retval.toInt32();
          send({
            subject: "hook",
            category: "fileops",
            symbol: "renameat",
            dir: "leave",
            line: `renameat(AT_FDCWD, ${q(this.oldPath)}, AT_FDCWD, ${q(this.newPath)}) = ${result}`,
            backtrace: bt(this.context),
            extra: { op: "rename", path: this.oldPath, path2: this.newPath, result },
          });
        },
      }),
    );
  }

  // Hook mkdir
  const mkdirPtr = kernel.findExportByName("mkdir");
  if (mkdirPtr) {
    hooks.push(
      Interceptor.attach(mkdirPtr, {
        onEnter(args) {
          this.path = args[0].readUtf8String();
          this.mode = args[1].toInt32();
        },
        onLeave(retval) {
          const result = retval.toInt32();
          send({
            subject: "hook",
            category: "fileops",
            symbol: "mkdir",
            dir: "leave",
            line: `mkdir(${q(this.path)}, 0${this.mode.toString(8)}) = ${result}`,
            backtrace: bt(this.context),
            extra: { op: "create", path: this.path, mode: this.mode, result },
          });
        },
      }),
    );
  }

  // Hook mkdirat
  const mkdiratPtr = kernel.findExportByName("mkdirat");
  if (mkdiratPtr) {
    hooks.push(
      Interceptor.attach(mkdiratPtr, {
        onEnter(args) {
          this.path = args[1].readUtf8String();
          this.mode = args[2].toInt32();
        },
        onLeave(retval) {
          const result = retval.toInt32();
          send({
            subject: "hook",
            category: "fileops",
            symbol: "mkdirat",
            dir: "leave",
            line: `mkdirat(AT_FDCWD, ${q(this.path)}, 0${this.mode.toString(8)}) = ${result}`,
            backtrace: bt(this.context),
            extra: { op: "create", path: this.path, mode: this.mode, result },
          });
        },
      }),
    );
  }

  // Hook link
  const linkPtr = kernel.findExportByName("link");
  if (linkPtr) {
    hooks.push(
      Interceptor.attach(linkPtr, {
        onEnter(args) {
          this.oldPath = args[0].readUtf8String();
          this.newPath = args[1].readUtf8String();
        },
        onLeave(retval) {
          const result = retval.toInt32();
          send({
            subject: "hook",
            category: "fileops",
            symbol: "link",
            dir: "leave",
            line: `link(${q(this.oldPath)}, ${q(this.newPath)}) = ${result}`,
            backtrace: bt(this.context),
            extra: { op: "link", path: this.oldPath, path2: this.newPath, result },
          });
        },
      }),
    );
  }

  // Hook symlink
  const symlinkPtr = kernel.findExportByName("symlink");
  if (symlinkPtr) {
    hooks.push(
      Interceptor.attach(symlinkPtr, {
        onEnter(args) {
          this.oldPath = args[0].readUtf8String();
          this.newPath = args[1].readUtf8String();
        },
        onLeave(retval) {
          const result = retval.toInt32();
          send({
            subject: "hook",
            category: "fileops",
            symbol: "symlink",
            dir: "leave",
            line: `symlink(${q(this.oldPath)}, ${q(this.newPath)}) = ${result}`,
            backtrace: bt(this.context),
            extra: { op: "link", path: this.oldPath, path2: this.newPath, result },
          });
        },
      }),
    );
  }

  return hooks;
}

```

`agent/src/fruity/hooks/firebase.ts`:

```ts
// this script is based on the article
// https://kibty.town/blog/arc/

import ObjC from "frida-objc-bridge";
import { bt } from "@/common/hooks/context.js";
import { toJS } from "@/fruity/bridge/object.js";

interface WhereClause {
  field: string;
  value: string;
}

interface QueryInfo {
  type: "collection" | "doc";
  path: string;
  whereClauses: WhereClause[];
}

const queryStack: QueryInfo[] = [];

function formatQuery(q: QueryInfo) {
  return (
    `firebase.${q.type}("${q.path}")` +
    q.whereClauses
      .map((c) => `.where("${c.field}", "==", "${c.value}")`)
      .join("")
  );
}

function hookCollection(): InvocationListener[] {
  const cls = ObjC.classes.FIRFirestore;
  if (!cls) return [];
  const method = cls["- collectionWithPath:"];
  if (!method) return [];

  return [
    Interceptor.attach(method.implementation, {
      onEnter(args) {
        const path = new ObjC.Object(args[2]).toString();
        queryStack.push({ type: "collection", path, whereClauses: [] });
      },
    }),
  ];
}

function hookDocument(): InvocationListener[] {
  const cls = ObjC.classes.FIRCollectionReference;
  if (!cls) return [];
  const method = cls["- documentWithPath:"];
  if (!method) return [];

  return [
    Interceptor.attach(method.implementation, {
      onEnter(args) {
        const parent = new ObjC.Object(args[0]);
        const docPath = new ObjC.Object(args[2]).toString();
        const fullPath = parent.path().toString() + "/" + docPath;
        const q: QueryInfo = { type: "doc", path: fullPath, whereClauses: [] };
        queryStack.push(q);

        send({
          subject: "hook",
          category: "firebase",
          symbol: "-[FIRCollectionReference documentWithPath:]",
          dir: "enter",
          line: formatQuery(q),
          backtrace: bt(this.context),
          extra: { op: "doc", path: fullPath },
        });
      },
    }),
  ];
}

function hookWhere(): InvocationListener[] {
  const cls = ObjC.classes.FIRQuery;
  if (!cls) return [];
  const method = cls["- queryWhereField:isEqualTo:"];
  if (!method) return [];

  return [
    Interceptor.attach(method.implementation, {
      onEnter(args) {
        const field = new ObjC.Object(args[2]).toString();
        const value = new ObjC.Object(args[3]).toString();
        if (queryStack.length > 0) {
          queryStack[queryStack.length - 1].whereClauses.push({ field, value });
        }
      },
    }),
  ];
}

function hookExec(): InvocationListener[] {
  const cls = ObjC.classes.FIRQuery;
  if (!cls) return [];

  const hooks: InvocationListener[] = [];
  const selectors = [
    "- getDocuments",
    "- addSnapshotListener:",
    "- getDocument",
    "- addDocumentSnapshotListener:",
    "- getDocumentsWithCompletion:",
    "- getDocumentWithCompletion:",
  ];

  for (const sel of selectors) {
    const method = cls[sel];
    if (!method) continue;

    hooks.push(
      Interceptor.attach(method.implementation, {
        onEnter(args) {
          if (queryStack.length === 0) return;
          const q = queryStack.pop()!;
          send({
            subject: "hook",
            category: "firebase",
            symbol: `-[FIRQuery ${sel.slice(2)}]`,
            dir: "enter",
            line: formatQuery(q),
            backtrace: bt(this.context),
            extra: { op: "query", ...q },
          });
        },
      }),
    );
  }

  return hooks;
}

/**
 * Hook Firestore query operations: collection/doc lookups, where clauses, query execution
 */
export function query(): InvocationListener[] {
  if (!ObjC.available) return [];
  return [
    ...hookCollection(),
    ...hookDocument(),
    ...hookWhere(),
    ...hookExec(),
  ];
}

/**
 * Hook Firestore document write operations: setData, updateData
 */
export function write(): InvocationListener[] {
  if (!ObjC.available) return [];

  const hooks: InvocationListener[] = [];
  const FIRDocumentReference = ObjC.classes.FIRDocumentReference;
  if (!FIRDocumentReference) return [];

  const methods = [
    { sel: "- updateData:completion:", type: "update" },
    { sel: "- updateData:", type: "update" },
    { sel: "- setData:completion:", type: "set" },
    { sel: "- setData:", type: "set" },
  ];

  for (const m of methods) {
    const method = FIRDocumentReference[m.sel];
    if (method) {
      hooks.push(
        Interceptor.attach(method.implementation, {
          onEnter(args) {
            const docRef = new ObjC.Object(args[0]);
            const data = new ObjC.Object(args[2]);
            const fullPath = docRef.path().toString();
            send({
              subject: "hook",
              category: "firebase",
              symbol: `-[FIRDocumentReference ${m.sel.slice(2)}]`,
              dir: "enter",
              line: `firebase.doc("${fullPath}").${m.type}(${JSON.stringify(toJS(data))})`,
              backtrace: bt(this.context),
              extra: { op: m.type, path: fullPath },
            });
          },
        }),
      );
    }
  }

  return hooks;
}

```

`agent/src/fruity/hooks/flutter.ts`:

```ts
import ObjC from "frida-objc-bridge";

import { toJS } from "@/fruity/bridge/object.js";

type Direction = "native" | "dart";
type ChannelType = "method" | "event" | "message";

const subject = "flutter";
const hooks: InvocationListener[] = [];
const hookedBlocks = new Set<string>();
let running = false;

function getName(channel: ObjC.Object) {
  return channel.$ivars._name.toString();
}

export function start() {
  if (running || !available()) return;
  running = true;

  const {
    FlutterMethodChannel,
    FlutterBasicMessageChannel,
    FlutterEventChannel,
  } = ObjC.classes;

  const methodChannelHooks: Record<string, InvocationListenerCallbacks> = {
    "- setMethodCallHandler:": {
      onEnter(args) {
        const handler = args[2];
        if (handler.isNull()) return;

        const name = getName(new ObjC.Object(args[0]));

        ObjC.bind(new ObjC.Object(handler), { name });
        hookBlock(handler, {
          onEnter(args) {
            const ctx = ObjC.getBoundData(new ObjC.Object(args[0])) as
              | { name: string }
              | undefined;
            if (!ctx) return;
            const call = new ObjC.Object(args[1]);
            const method = call.method().toString();
            let jsArgs: unknown;

            try {
              jsArgs = toJS(call.arguments());
            } catch (_) {}

            emit("method", "dart", ctx.name, { method, args: jsArgs });

            const result = args[2];
            if (!result.isNull()) {
              ObjC.bind(new ObjC.Object(result), {
                name: ctx.name,
                method,
                dir: "native" as Direction,
              });
              hookBlock(result, resultHook);
            }
          },
        });
      },
    },
    "- invokeMethod:arguments:result:": {
      onEnter(args) {
        const name = getName(new ObjC.Object(args[0]));
        const method = new ObjC.Object(args[2]).toString();
        const a = args[3].isNull() ? null : toJS(new ObjC.Object(args[3]));
        const result = args[4];

        emit("method", "native", name, { method, args: a });

        if (!result.isNull()) {
          ObjC.bind(new ObjC.Object(result), {
            name,
            method,
            dir: "dart" as Direction,
          });
          hookBlock(result, resultHook);
        }
      },
    },
    "- invokeMethod:arguments:": {
      onEnter(args) {
        const name = getName(new ObjC.Object(args[0]));
        const method = new ObjC.Object(args[2]).toString();
        const a = args[3].isNull() ? null : toJS(new ObjC.Object(args[3]));

        emit("method", "native", name, { method, args: a });
      },
    },
  };

  for (const [sel, cb] of Object.entries(methodChannelHooks)) {
    hooks.push(
      Interceptor.attach(FlutterMethodChannel[sel].implementation, cb),
    );
  }

  if (FlutterBasicMessageChannel) {
    const messageChannelHooks: Record<string, InvocationListenerCallbacks> = {
      "- setMessageHandler:": {
        onEnter(args) {
          const handler = args[2];
          if (handler.isNull()) return;

          const name = getName(new ObjC.Object(args[0]));

          ObjC.bind(new ObjC.Object(handler), { name });
          hookBlock(handler, {
            onEnter(args) {
              const ctx = ObjC.getBoundData(new ObjC.Object(args[0])) as
                | { name: string }
                | undefined;
              if (!ctx) return;
              let msg: unknown;
              try {
                msg = args[1].isNull() ? null : toJS(new ObjC.Object(args[1]));
              } catch (_) {}
              emit("message", "dart", ctx.name, { args: msg });
            },
          });
        },
      },
      "- sendMessage:": {
        onEnter(args) {
          const name = getName(new ObjC.Object(args[0]));
          let msg: unknown;
          try {
            msg = args[2].isNull() ? null : toJS(new ObjC.Object(args[2]));
          } catch (_) {}
          emit("message", "native", name, { args: msg });
        },
      },
      "- sendMessage:reply:": {
        onEnter(args) {
          const name = getName(new ObjC.Object(args[0]));
          let msg: unknown;
          try {
            msg = args[2].isNull() ? null : toJS(new ObjC.Object(args[2]));
          } catch (_) {}
          emit("message", "native", name, { args: msg });
        },
      },
    };

    for (const [sel, cb] of Object.entries(messageChannelHooks)) {
      hooks.push(
        Interceptor.attach(FlutterBasicMessageChannel[sel].implementation, cb),
      );
    }
  }

  if (FlutterEventChannel) {
    hooks.push(
      Interceptor.attach(
        FlutterEventChannel["- setStreamHandler:"].implementation,
        {
          onEnter(args) {
            const handler = args[2];
            if (handler.isNull()) return;

            const name = getName(new ObjC.Object(args[0]));
            const handlerObj = new ObjC.Object(handler);
            ObjC.bind(handlerObj, { name });
            hookStreamHandler(handlerObj);
          },
        },
      ),
    );
  }
}

const resultHook: InvocationListenerCallbacks = {
  onEnter(args) {
    const ctx = ObjC.getBoundData(new ObjC.Object(args[0])) as
      | { name: string; method: string; dir: Direction }
      | undefined;
    if (!ctx) return;
    let res: unknown;
    try {
      res = args[1].isNull() ? null : toJS(new ObjC.Object(args[1]));
    } catch (_) {}
    emit("method", ctx.dir, ctx.name, { method: ctx.method, result: res });
  },
};

export function stop() {
  for (const hook of hooks) {
    hook.detach();
  }
  hooks.length = 0;
  hookedBlocks.clear();
  running = false;
}

export function status(): boolean {
  return running;
}

export function available() {
  if (!ObjC.available) return false;
  const engine = Process.findModuleByName("Flutter");
  return Boolean(engine && ObjC.classes.FlutterMethodChannel);
}

function hookStreamHandler(handler: ObjC.Object) {
  const selectors = [
    { sel: "- onListenWithArguments:eventSink:", method: "listen" },
    { sel: "- onCancelWithArguments:", method: "cancel" },
  ] as const;

  for (const { sel, method } of selectors) {
    const m = (handler.$class as Record<string, ObjC.ObjectMethod>)[sel];
    if (!m) continue;
    const key = m.implementation.strip().toString();
    if (hookedBlocks.has(key)) continue;
    hookedBlocks.add(key);
    hooks.push(
      Interceptor.attach(m.implementation, {
        onEnter(args) {
          const ctx = ObjC.getBoundData(new ObjC.Object(args[0])) as
            | { name: string }
            | undefined;
          if (!ctx) return;
          let a: unknown;
          try {
            a = args[2].isNull() ? null : toJS(new ObjC.Object(args[2]));
          } catch (_) {}
          emit("event", "dart", ctx.name, { method, args: a });
        },
      }),
    );
  }
}

function hookBlock(
  block: NativePointer,
  callbacks: InvocationListenerCallbacks,
) {
  const invoke = block.add(16).readPointer();
  const key = invoke.strip().toString();
  if (hookedBlocks.has(key)) return;
  hookedBlocks.add(key);
  hooks.push(Interceptor.attach(invoke, callbacks));
}

function emit(
  type: ChannelType,
  dir: Direction,
  channel: string,
  detail: Record<string, unknown>,
) {
  send({ subject, type, dir, channel, ...detail });
}

```

`agent/src/fruity/hooks/index.ts`:

```ts
import { createNative } from "@/common/hooks/group.js";
import * as sqlite from "./sqlite.js";
import * as pasteboard from "./pasteboard.js";
import * as deviceid from "./deviceid.js";
import * as biometric from "./biometric.js";
import * as fileops from "./fileops.js";
import * as firebase from "./firebase.js";
import * as native from "@/common/hooks/native.js";
import * as objc from "./objc.js";

// Available hook groups
const HOOK_GROUPS = [
  "pasteboard",
  "fileops",
  "deviceid",
  "biometric",
  "sqlite",
  "firebase",
] as const;

function get(group: string) {
  if (group === "sqlite") {
    return [
      ...sqlite.open(),
      ...sqlite.bind(),
      ...sqlite.prepare(),
      ...sqlite.exec(),
    ];
  } else if (group === "pasteboard") {
    return [...pasteboard.monitor()];
  } else if (group === "deviceid") {
    return [...deviceid.spoof()];
  } else if (group === "biometric") {
    return [...biometric.bypass()];
  } else if (group === "fileops") {
    return [...fileops.monitor()];
  } else if (group === "firebase") {
    return [...firebase.query(), ...firebase.write()];
  }
}

const { list, status, start, stop } = createNative(HOOK_GROUPS, get);
export { list, status, start, stop };

/**
 * User hook type definition
 */
export interface UserHook {
  type: "objc" | "native";
  module?: string | null;
  cls?: string;
  name: string;
  sig?: { args: string[]; returns: string };
}

/**
 * Get all user-defined hooks (both ObjC and native)
 */
export function userHooks(): UserHook[] {
  const result: UserHook[] = [];

  // Add ObjC hooks
  for (const { cls, sel } of objc.list()) {
    result.push({
      type: "objc",
      cls,
      name: sel,
    });
  }

  // Add native hooks
  for (const { module, name, sig } of native.list()) {
    result.push({
      type: "native",
      module,
      name,
      sig,
    });
  }

  return result;
}

```

`agent/src/fruity/hooks/objc.ts`:

```ts
import ObjC from "frida-objc-bridge";

import { BaseMessage, bt } from "@/common/hooks/context.js";

const hooked = new Map<string, Map<string, InvocationListener>>();

interface NSMethodSignature {
  numberOfArguments(): number;
  frameLength(): number;
  // const char *, frida automatically bridges it to string
  getArgumentTypeAtIndex_(index: number): string;
  methodReturnType(): string;
}

export function swizzle(klassName: string, sel: string) {
  if (!ObjC.available) throw new Error("Objective-C runtime is not available");

  {
    const methods = hooked.get(klassName);
    if (!methods) {
      hooked.set(klassName, new Map());
    } else if (methods.has(sel)) {
      return;
    }
  }

  const klass = ObjC.classes[klassName];
  const method = klass[sel] as ObjC.ObjectMethod | undefined;

  const sig = klass.instanceMethodSignatureForSelector_(
    ObjC.selector(sel),
  ) as NSMethodSignature | null;
  if (!method || !sig) throw new Error(`Method ${klassName} ${sel} not found`);

  const argCount = sig.numberOfArguments();
  const argIsObj: boolean[] = [];
  for (let i = 2; i < argCount; i++) {
    argIsObj.push(sig.getArgumentTypeAtIndex_(i)[0] === "@");
  }
  const retIsObj = sig.methodReturnType()[0] === "@";

  const format = (isObj: boolean, v: NativePointer) =>
    isObj ? new ObjC.Object(v).toString() : `${v}`;

  const listener = Interceptor.attach(method.implementation, {
    onEnter(args) {
      const formatted = argIsObj.map((obj, i) => format(obj, args[i + 2]));
      const argsStr = formatted.length > 0 ? formatted.join(", ") : "";

      send({
        subject: "hook",
        category: "objc",
        symbol: `${klassName} ${sel}`,
        dir: "enter",
        line: `[${klassName} ${sel}](${argsStr})`,
        backtrace: bt(this.context),
        extra: { cls: klassName, sel, args: formatted },
      } satisfies BaseMessage);
    },
    onLeave(retval) {
      const retStr = format(retIsObj, retval);
      send({
        subject: "hook",
        category: "objc",
        symbol: `${klassName} ${sel}`,
        dir: "leave",
        line: `[${klassName} ${sel}] → ${retStr}`,
        backtrace: bt(this.context),
        extra: { cls: klassName, sel, ret: retStr },
      } satisfies BaseMessage);
    },
  });

  hooked.get(klassName)!.set(sel, listener);
}

export function unswizzle(cls: string, sel: string) {
  const methods = hooked.get(cls);
  if (!methods) return;

  const listener = methods.get(sel);
  if (!listener) return;

  listener.detach();
  methods.delete(sel);

  if (methods.size === 0) {
    hooked.delete(cls);
  }
}

/**
 * List all active ObjC hooks.
 */
export function list(): Array<{ cls: string; sel: string }> {
  const result: Array<{ cls: string; sel: string }> = [];

  for (const [cls, methods] of hooked) {
    for (const sel of methods.keys()) {
      result.push({ cls, sel });
    }
  }

  return result;
}

```

`agent/src/fruity/hooks/pasteboard.ts`:

```ts
import ObjC from "frida-objc-bridge";
import { bt } from "@/common/hooks/context.js";

// Helper to get pasteboard name
const getPasteboardInfo = (
  self: ObjC.Object,
): { name: string; isGeneral: boolean; shortName: string } => {
  try {
    const name = self.name()?.toString() || "unknown";
    const isGeneral = name === "com.apple.UIKit.pboard.general";
    const shortName = isGeneral ? "generalPasteboard" : name;
    return { name, isGeneral, shortName };
  } catch {
    return { name: "unknown", isGeneral: false, shortName: "unknown" };
  }
};

/**
 * Hook UIPasteboard operations to monitor clipboard access
 */
export function monitor() {
  if (!ObjC.available) return [];

  const hooks: InvocationListener[] = [];
  const UIPasteboard = ObjC.classes.UIPasteboard;
  if (!UIPasteboard) return [];

  // Hook string getter
  const stringGetter = UIPasteboard["- string"];
  if (stringGetter) {
    hooks.push(
      Interceptor.attach(stringGetter.implementation, {
        onEnter(args) {
          this.self = new ObjC.Object(args[0]);
        },
        onLeave(retval) {
          const { name, isGeneral, shortName } = getPasteboardInfo(this.self);
          let content: ArrayBuffer | null = null;

          if (!retval.isNull()) {
            const str = new ObjC.Object(retval);
            try {
              const data = str.dataUsingEncoding_(4); // NSUTF8StringEncoding
              if (data && !data.isNull()) {
                content = data.bytes().readByteArray(data.length());
              }
            } catch {
              // ignore
            }
          }

          send(
            {
              subject: "hook",
              category: "pasteboard",
              symbol: "-[UIPasteboard string]",
              dir: "leave",
              line: `[${shortName} string] // read`,
              backtrace: bt(this.context),
              extra: { op: "read", pasteboardName: name, isGeneral, contentType: "string" },
            },
            content,
          );
        },
      }),
    );
  }

  // Hook strings getter (array)
  const stringsGetter = UIPasteboard["- strings"];
  if (stringsGetter) {
    hooks.push(
      Interceptor.attach(stringsGetter.implementation, {
        onEnter(args) {
          this.self = new ObjC.Object(args[0]);
        },
        onLeave() {
          const { name, isGeneral, shortName } = getPasteboardInfo(this.self);

          send({
            subject: "hook",
            category: "pasteboard",
            symbol: "-[UIPasteboard strings]",
            dir: "leave",
            line: `[${shortName} strings] // read`,
            backtrace: bt(this.context),
            extra: { op: "read", pasteboardName: name, isGeneral, contentType: "strings" },
          });
        },
      }),
    );
  }

  // Hook string setter
  const stringSetter = UIPasteboard["- setString:"];
  if (stringSetter) {
    hooks.push(
      Interceptor.attach(stringSetter.implementation, {
        onEnter(args) {
          this.self = new ObjC.Object(args[0]);
          this.content = null;

          if (!args[2].isNull()) {
            const str = new ObjC.Object(args[2]);
            try {
              const data = str.dataUsingEncoding_(4);
              if (data && !data.isNull()) {
                this.content = data.bytes().readByteArray(data.length());
              }
            } catch {
              // ignore
            }
          }
        },
        onLeave() {
          const { name, isGeneral, shortName } = getPasteboardInfo(this.self);

          send(
            {
              subject: "hook",
              category: "pasteboard",
              symbol: "-[UIPasteboard setString:]",
              dir: "leave",
              line: `[${shortName} setString:...] // write`,
              backtrace: bt(this.context),
              extra: { op: "write", pasteboardName: name, isGeneral, contentType: "string" },
            },
            this.content,
          );
        },
      }),
    );
  }

  // Hook data getter
  const dataGetter = UIPasteboard["- dataForPasteboardType:"];
  if (dataGetter) {
    hooks.push(
      Interceptor.attach(dataGetter.implementation, {
        onEnter(args) {
          this.self = new ObjC.Object(args[0]);
          this.pbType = new ObjC.Object(args[2]).toString();
        },
        onLeave(retval) {
          const { name, isGeneral, shortName } = getPasteboardInfo(this.self);
          let content: ArrayBuffer | null = null;

          if (!retval.isNull()) {
            const data = new ObjC.Object(retval);
            try {
              content = data.bytes().readByteArray(data.length());
            } catch {
              // ignore
            }
          }

          send(
            {
              subject: "hook",
              category: "pasteboard",
              symbol: "-[UIPasteboard dataForPasteboardType:]",
              dir: "leave",
              line: `[${shortName} dataForPasteboardType:"${this.pbType}"] // read`,
              backtrace: bt(this.context),
              extra: { op: "read", pasteboardName: name, isGeneral, contentType: this.pbType },
            },
            content,
          );
        },
      }),
    );
  }

  // Hook data setter
  const dataSetter = UIPasteboard["- setData:forPasteboardType:"];
  if (dataSetter) {
    hooks.push(
      Interceptor.attach(dataSetter.implementation, {
        onEnter(args) {
          this.self = new ObjC.Object(args[0]);
          this.pbType = new ObjC.Object(args[3]).toString();
          this.content = null;

          if (!args[2].isNull()) {
            const data = new ObjC.Object(args[2]);
            try {
              this.content = data.bytes().readByteArray(data.length());
            } catch {
              // ignore
            }
          }
        },
        onLeave() {
          const { name, isGeneral, shortName } = getPasteboardInfo(this.self);

          send(
            {
              subject: "hook",
              category: "pasteboard",
              symbol: "-[UIPasteboard setData:forPasteboardType:]",
              dir: "leave",
              line: `[${shortName} setData:... forPasteboardType:"${this.pbType}"] // write`,
              backtrace: bt(this.context),
              extra: { op: "write", pasteboardName: name, isGeneral, contentType: this.pbType },
            },
            this.content,
          );
        },
      }),
    );
  }

  // Hook items setter (general purpose)
  const itemsSetter = UIPasteboard["- setItems:"];
  if (itemsSetter) {
    hooks.push(
      Interceptor.attach(itemsSetter.implementation, {
        onEnter(args) {
          this.self = new ObjC.Object(args[0]);
        },
        onLeave() {
          const { name, isGeneral, shortName } = getPasteboardInfo(this.self);

          send({
            subject: "hook",
            category: "pasteboard",
            symbol: "-[UIPasteboard setItems:]",
            dir: "leave",
            line: `[${shortName} setItems:...] // write`,
            backtrace: bt(this.context),
            extra: { op: "write", pasteboardName: name, isGeneral, contentType: "items" },
          });
        },
      }),
    );
  }

  // Hook URL getter
  const urlGetter = UIPasteboard["- URL"];
  if (urlGetter) {
    hooks.push(
      Interceptor.attach(urlGetter.implementation, {
        onEnter(args) {
          this.self = new ObjC.Object(args[0]);
        },
        onLeave(retval) {
          const { name, isGeneral, shortName } = getPasteboardInfo(this.self);
          let content: ArrayBuffer | null = null;

          if (!retval.isNull()) {
            const url = new ObjC.Object(retval);
            try {
              const str = url.absoluteString();
              if (str) {
                const data = str.dataUsingEncoding_(4);
                if (data && !data.isNull()) {
                  content = data.bytes().readByteArray(data.length());
                }
              }
            } catch {
              // ignore
            }
          }

          send(
            {
              subject: "hook",
              category: "pasteboard",
              symbol: "-[UIPasteboard URL]",
              dir: "leave",
              line: `[${shortName} URL] // read`,
              backtrace: bt(this.context),
              extra: { op: "read", pasteboardName: name, isGeneral, contentType: "URL" },
            },
            content,
          );
        },
      }),
    );
  }

  // Hook image getter
  const imageGetter = UIPasteboard["- image"];
  if (imageGetter) {
    hooks.push(
      Interceptor.attach(imageGetter.implementation, {
        onEnter(args) {
          this.self = new ObjC.Object(args[0]);
        },
        onLeave() {
          const { name, isGeneral, shortName } = getPasteboardInfo(this.self);

          send({
            subject: "hook",
            category: "pasteboard",
            symbol: "-[UIPasteboard image]",
            dir: "leave",
            line: `[${shortName} image] // read`,
            backtrace: bt(this.context),
            extra: { op: "read", pasteboardName: name, isGeneral, contentType: "image" },
          });
        },
      }),
    );
  }

  return hooks;
}

```

`agent/src/fruity/hooks/sqlite.ts`:

```ts
import { BaseMessage, bt } from "@/common/hooks/context.js";

export function open() {
  const sqlite = Process.findModuleByName("libsqlite3.dylib");
  if (!sqlite) return [];

  const hooks: InvocationListener[] = [];

  const open = sqlite.getExportByName("sqlite3_open");
  if (open) {
    hooks.push(
      Interceptor.attach(open, {
        onEnter(args) {
          const filename = args[0].readUtf8String() || "unknown";
          send({
            subject: "hook",
            category: "sql",
            symbol: "sqlite3_open",
            dir: "enter",
            line: `sqlite3_open("${filename}")`,
            backtrace: bt(this.context),
            extra: { filename },
          } satisfies BaseMessage);
        },
      }),
    );
  }

  const open16 = sqlite.getExportByName("sqlite3_open16");
  if (open16) {
    hooks.push(
      Interceptor.attach(open16, {
        onEnter(args) {
          const filename = args[0].readUtf16String() || "unknown";
          send({
            subject: "hook",
            category: "sql",
            symbol: "sqlite3_open16",
            dir: "enter",
            line: `sqlite3_open16("${filename}")`,
            backtrace: bt(this.context),
            extra: { filename },
          } satisfies BaseMessage);
        },
      }),
    );
  }

  const open_v2 = sqlite.getExportByName("sqlite3_open_v2");
  if (open_v2) {
    hooks.push(
      Interceptor.attach(open_v2, {
        onEnter(args) {
          const filename = args[0].readUtf8String() || "unknown";
          send({
            subject: "hook",
            category: "sql",
            symbol: "sqlite3_open_v2",
            dir: "enter",
            line: `sqlite3_open_v2("${filename}")`,
            backtrace: bt(this.context),
            extra: { filename },
          } satisfies BaseMessage);
        },
      }),
    );
  }

  return hooks;
}

export function exec() {
  const sqlite = Process.findModuleByName("libsqlite3.dylib");
  if (!sqlite) return [];

  const exec = sqlite.getExportByName("sqlite3_exec");
  if (exec) {
    return [
      Interceptor.attach(exec, {
        onEnter(args) {
          const sql = args[1].readUtf8String() || "unknown";
          send({
            subject: "hook",
            category: "sql",
            symbol: "sqlite3_exec",
            dir: "enter",
            line: `sqlite3_exec: ${sql}`,
            backtrace: bt(this.context),
            extra: { sql },
          } satisfies BaseMessage);
        },
      }),
    ];
  }

  return [];
}

export function prepare() {
  const sqlite = Process.findModuleByName("libsqlite3.dylib");
  if (!sqlite) return [];

  const hooks: InvocationListener[] = [];

  const prepare = sqlite.getExportByName("sqlite3_prepare");
  if (prepare) {
    hooks.push(
      Interceptor.attach(prepare, {
        onEnter(args) {
          const sql = args[1].readUtf8String() || "unknown";
          send({
            subject: "hook",
            category: "sql",
            symbol: "sqlite3_prepare",
            dir: "enter",
            line: `sqlite3_prepare: ${sql}`,
            backtrace: bt(this.context),
            extra: { sql },
          } satisfies BaseMessage);
        },
      }),
    );
  }

  const prepare_v2 = sqlite.getExportByName("sqlite3_prepare_v2");
  if (prepare_v2) {
    hooks.push(
      Interceptor.attach(prepare_v2, {
        onEnter(args) {
          const sql = args[1].readUtf8String() || "unknown";
          send({
            subject: "hook",
            category: "sql",
            symbol: "sqlite3_prepare_v2",
            dir: "enter",
            line: `sqlite3_prepare_v2: ${sql}`,
            backtrace: bt(this.context),
            extra: { sql },
          } satisfies BaseMessage);
        },
      }),
    );
  }

  const prepare_v3 = sqlite.getExportByName("sqlite3_prepare_v3");
  if (prepare_v3) {
    hooks.push(
      Interceptor.attach(prepare_v3, {
        onEnter(args) {
          const sql = args[1].readUtf8String() || "unknown";
          send({
            subject: "hook",
            category: "sql",
            symbol: "sqlite3_prepare_v3",
            dir: "enter",
            line: `sqlite3_prepare_v3: ${sql}`,
            backtrace: bt(this.context),
            extra: { sql },
          } satisfies BaseMessage);
        },
      }),
    );
  }

  return hooks;
}

type SQLiteValue = string | number | null;

export function bind() {
  const sqlite = Process.findModuleByName("libsqlite3.dylib");
  if (!sqlite) return [];

  const hooks: InvocationListener[] = [];
  const sqlite3_sql = new NativeFunction(
    sqlite.getExportByName("sqlite3_sql"),
    "pointer",
    ["pointer"],
  );

  const valueGetters: Record<string, (args: NativePointer[]) => SQLiteValue> = {
    int: (args) => args[2].toInt32(),
    int64: (args) => args[2].toString(),
    double: (args) => args[2] as unknown as number,
    text: (args) => args[2].readUtf8String(),
    text64: (args) => args[2].readUtf8String(),
    text16: (args) => args[2].readUtf16String(),
    blob: (args) => `[Blob size=${args[3].toInt32()}]`,
    blob64: (args) => `[Blob size=${args[3].toString()}]`,
    null: () => "NULL",
    zeroblob: (args) => `[Zeroblob size=${args[2].toInt32()}]`,
    zeroblob64: (args) => `[Zeroblob size=${args[2].toString()}]`,
    value: () => "[sqlite3_value]",
    pointer: () => "[pointer]",
  };

  for (const [type, getter] of Object.entries(valueGetters)) {
    const funcName = `sqlite3_bind_${type}`;
    const func = sqlite.findExportByName(funcName);
    if (!func) continue;

    hooks.push(
      Interceptor.attach(func, {
        onEnter(args) {
          this.stmtPtr = args[0];
          this.bindIndex = args[1].toInt32();
          this.type = type;

          try {
            this.value = getter(args);
          } catch (e) {
            this.value = "[Error reading value]";
          }
        },
        onLeave(retval) {
          let sql = "";
          if (!this.stmtPtr.isNull()) {
            const sqlPtr = sqlite3_sql(this.stmtPtr) as NativePointer;
            if (!sqlPtr.isNull()) {
              sql = sqlPtr.readUtf8String() || "";
            }
          }

          const result = retval.toInt32();
          const valueStr = typeof this.value === "string" && !this.value.startsWith("[")
            ? `"${this.value}"`
            : String(this.value);

          send({
            subject: "hook",
            category: "sql",
            symbol: funcName,
            dir: "leave",
            line: `bind_${this.type}(?${this.bindIndex}, ${valueStr})${result !== 0 ? ` = ${result}` : ""}`,
            backtrace: bt(this.context),
            extra: { sql, bindIndex: this.bindIndex, bindValue: this.value },
          } satisfies BaseMessage);
        },
      }),
    );
  }

  return hooks;
}

```

`agent/src/fruity/hooks/url/common.ts`:

```ts
import ObjC from "frida-objc-bridge";

import type {
  NSString,
  NSError,
  NSURLRequest,
  NSURLResponse,
  NSHTTPURLResponse,
  NSURLSessionTask,
  NSURLSessionWebSocketTask,
  NSURLSessionWebSocketMessage,
} from "@/fruity/typings.js";

const subject = "nsurl";

/**
 * Get the IMP for a method without going through frida-objc-bridge's
 * property accessor (which can trigger a JS error).
 * Returns null if the method doesn't exist on the class.
 */
export function getMethodImp(
  clazz: ObjC.Object,
  sel: string,
  isClassMethod: boolean,
): NativePointer | null {
  const methodPtr = isClassMethod
    ? ObjC.api.class_getClassMethod(clazz.handle, ObjC.selector(sel))
    : ObjC.api.class_getInstanceMethod(clazz.handle, ObjC.selector(sel));
  if ((methodPtr as NativePointer).isNull()) return null;
  return ObjC.api.method_getImplementation(methodPtr) as NativePointer;
}

export interface TaskBoundData {
  id?: string;
}

export interface NetworkEvent {
  event: string;
  requestId: string;
  timestamp: number;
  [key: string]: unknown;
}

export interface RequestState {
  request: NSURLRequest | null;
  mechanismRecorded?: boolean;
}

interface SerializedRequest {
  url: string;
  method: string;
  headers: Record<string, string>;
  body?: string;
}

interface SerializedResponse {
  url?: string;
  mimeType?: string;
  expectedContentLength: number;
  statusCode?: number;
  headers?: Record<string, string>;
}

export const hooks: InvocationListener[] = [];

export function nextRequestId(): string {
  return ObjC.classes.NSUUID.UUID().UUIDString().toString();
}

export function emitNetworkEvent(
  event: NetworkEvent,
  data?: ArrayBuffer | null,
): void {
  if (data) return send({ subject, ...event }, data);
  send({ subject, ...event });
}

const requestStates = new Map<string, RequestState>();

export function getRequestState(requestId: string): RequestState {
  let state = requestStates.get(requestId);
  if (!state) {
    state = { request: null };
    requestStates.set(requestId, state);
  }
  return state;
}

export function hasRequestState(requestId: string): boolean {
  return requestStates.has(requestId);
}

export function removeRequestState(requestId: string): void {
  requestStates.delete(requestId);
}

export function getOrAssignTaskId(task: NSURLSessionTask): string {
  const metadata = ObjC.getBoundData(task) as TaskBoundData;
  let id = metadata?.id;
  if (!id) {
    id = nextRequestId();
    ObjC.bind(task, { id } as TaskBoundData);
  }
  return id;
}

function serializeRequest(request: NSURLRequest): SerializedRequest {
  const url = request.URL()?.absoluteString().toString();
  const method = request.HTTPMethod()?.toString() || "GET";
  const bodyData = request.HTTPBody();
  const body = bodyData
    ? (ObjC.classes.NSString.alloc().initWithData_encoding_(bodyData, 4) as
        | NSString
        | undefined)
    : undefined;

  const allHeaders = request.allHTTPHeaderFields();
  const headers: Record<string, string> = {};
  if (allHeaders) {
    const keys = allHeaders.allKeys();
    const count = keys.count();
    for (let i = 0; i < count; i++) {
      const key = keys.objectAtIndex_(i);
      const value = allHeaders.objectForKey_(key);
      if (value) {
        headers[key.toString()] = value.toString();
      }
    }
  }

  return { url, method, headers, body: body?.toString() };
}

function serializeResponse(response: NSURLResponse): SerializedResponse {
  const url = response.URL()?.absoluteString().toString();
  const mimeType = response.MIMEType()?.toString();
  const expectedContentLength = response.expectedContentLength();

  const serialized: SerializedResponse = { expectedContentLength };
  if (url) serialized.url = url;
  if (mimeType) serialized.mimeType = mimeType;

  if (response.respondsToSelector_(ObjC.selector("statusCode"))) {
    const httpResponse = response as NSHTTPURLResponse;
    serialized.statusCode = httpResponse.statusCode();

    const headerFields = httpResponse.allHeaderFields();
    const headers: Record<string, string> = {};
    if (headerFields) {
      const keys = headerFields.allKeys();
      const count = keys.count();
      for (let i = 0; i < count; i++) {
        const key = keys.objectAtIndex_(i);
        const value = headerFields.objectForKey_(key);
        if (value) {
          headers[key.toString()] = value.toString();
        }
      }
    }
    serialized.headers = headers;
  }

  return serialized;
}

export function recordRequestWillBeSent(
  requestId: string,
  request: NSURLRequest,
  redirectResponse: NSURLResponse | null,
): void {
  const event: NetworkEvent = {
    event: "requestWillBeSent",
    requestId,
    timestamp: Date.now(),
    request: serializeRequest(request),
  };
  if (redirectResponse) {
    event.redirectResponse = serializeResponse(redirectResponse);
  }
  emitNetworkEvent(event);
}

export function recordResponseReceived(
  requestId: string,
  response: NSURLResponse,
): void {
  emitNetworkEvent({
    event: "responseReceived",
    requestId,
    timestamp: Date.now(),
    response: serializeResponse(response),
  });
}

export function recordDataReceived(
  requestId: string,
  dataLength: number | string,
  data?: ArrayBuffer | null,
): void {
  emitNetworkEvent(
    {
      event: "dataReceived",
      requestId,
      timestamp: Date.now(),
      dataLength:
        typeof dataLength === "string" ? dataLength : String(dataLength),
    },
    data,
  );
}

export function recordLoadingFinished(requestId: string): void {
  emitNetworkEvent({
    event: "loadingFinished",
    requestId,
    timestamp: Date.now(),
  });
}

export function recordLoadingFailed(requestId: string, error: NSError): void {
  emitNetworkEvent({
    event: "loadingFailed",
    requestId,
    timestamp: Date.now(),
    error: error.toString(),
  });
}

export function recordMechanism(mechanism: string, requestId: string): void {
  emitNetworkEvent({
    event: "mechanism",
    requestId,
    timestamp: Date.now(),
    mechanism,
  });
}

export function recordWebSocketMessage(
  type: "send" | "receive",
  task: NSURLSessionWebSocketTask,
  message: NSURLSessionWebSocketMessage,
  error?: NSError | null,
): void {
  const event: NetworkEvent = {
    event: `webSocket${type === "send" ? "Send" : "Receive"}`,
    requestId: task.taskIdentifier().toString(),
    timestamp: Date.now(),
    messageType: message.type() === 0 ? "data" : "string",
  };

  const msgData = message.data();
  const msgString = message.string();
  if (message.type() === 0 && msgData) {
    event.dataLength = msgData.length();
  } else if (message.type() === 1 && msgString) {
    event.message = msgString.toString();
  }

  if (error) {
    event.error = error.toString();
  }

  emitNetworkEvent(event);
}

```

`agent/src/fruity/hooks/url/connection.ts`:

```ts
import ObjC from "frida-objc-bridge";

import type {
  NSObject,
  NSURLRequest,
  NSURLResponse,
  NSData,
  NSError,
} from "@/fruity/typings.js";
import { wrapObjC } from "@/fruity/typings.js";

import {
  hooks,
  getMethodImp,
  type TaskBoundData,
  nextRequestId,
  getRequestState,
  removeRequestState,
  recordRequestWillBeSent,
  recordResponseReceived,
  recordDataReceived,
  recordLoadingFinished,
  recordLoadingFailed,
  recordMechanism,
} from "./common.js";
import { hookDelegateClass } from "./lazy.js";

const delegateMethodHandlers: Record<string, InvocationListenerCallbacks> = {
  "connection:willSendRequest:redirectResponse:": {
    onEnter(args) {
      const delegate = wrapObjC<NSObject>(args[0]);
      const connection = new ObjC.Object(args[2]);
      const request = wrapObjC<NSURLRequest>(args[3]);
      const response = args[4].isNull()
        ? null
        : wrapObjC<NSURLResponse>(args[4]);

      const requestId = getOrAssignConnectionId(connection);
      const state = getRequestState(requestId);
      state.request = request;

      recordRequestWillBeSent(requestId, request, response);
      recordMechanism(
        `NSURLConnection (delegate: ${delegate.$className})`,
        requestId,
      );
    },
  },
  "connection:didReceiveResponse:": {
    onEnter(args) {
      const connection = new ObjC.Object(args[2]);
      const response = wrapObjC<NSURLResponse>(args[3]);
      const requestId = getOrAssignConnectionId(connection);
      recordResponseReceived(requestId, response);
    },
  },
  "connection:didReceiveData:": {
    onEnter(args) {
      const connection = new ObjC.Object(args[2]);
      const data = wrapObjC<NSData>(args[3]);
      const requestId = getOrAssignConnectionId(connection);
      const len = data.length();
      const chunk = len > 0 ? data.bytes().readByteArray(len) : null;
      recordDataReceived(requestId, len, chunk);
    },
  },
  "connectionDidFinishLoading:": {
    onEnter(args) {
      const connection = new ObjC.Object(args[2]);
      const requestId = getOrAssignConnectionId(connection);
      recordLoadingFinished(requestId);
      removeRequestState(requestId);
    },
  },
  "connection:didFailWithError:": {
    onEnter(args) {
      const connection = new ObjC.Object(args[2]);
      const requestId = getOrAssignConnectionId(connection);
      const state = getRequestState(requestId);
      if (state.request) {
        recordLoadingFailed(requestId, wrapObjC<NSError>(args[3]));
      }
      removeRequestState(requestId);
    },
  },
};

function getOrAssignConnectionId(connection: ObjC.Object): string {
  const metadata = ObjC.getBoundData(connection) as TaskBoundData;
  let id = metadata?.id;
  if (!id) {
    id = nextRequestId();
    ObjC.bind(connection, { id } as TaskBoundData);
  }
  return id;
}

export function hookConnectionCreation() {
  const { NSURLConnection } = ObjC.classes;
  if (!NSURLConnection) return;

  const initSelectors = [
    "initWithRequest:delegate:",
    "initWithRequest:delegate:startImmediately:",
  ];

  for (const sel of initSelectors) {
    const imp = getMethodImp(NSURLConnection, sel, false);
    if (!imp) continue;

    hooks.push(
      Interceptor.attach(imp, {
        onEnter(args) {
          // args: self, _cmd, request, delegate[, startImmediately]
          if (args[3].isNull()) return;

          const delegate = new ObjC.Object(args[3]);
          hooks.push(...hookDelegateClass(delegate, delegateMethodHandlers));
        },
      }),
    );
  }
}

export function hookAsyncMethods() {
  const { NSURLConnection } = ObjC.classes;
  if (!NSURLConnection) return;

  // +sendAsynchronousRequest:queue:completionHandler:
  const asyncSel = "sendAsynchronousRequest:queue:completionHandler:";
  const asyncImp = getMethodImp(NSURLConnection, asyncSel, true);

  if (asyncImp) {
    const hookedInvokers = new Set<string>();

    hooks.push(
      Interceptor.attach(asyncImp, {
        onEnter(args) {
          // args: self, _cmd, request, queue, completionHandler
          const request = wrapObjC<NSURLRequest>(args[2]);
          const blockPtr = args[4];
          if (blockPtr.isNull()) return;

          const requestId = nextRequestId();
          recordRequestWillBeSent(requestId, request, null);
          recordMechanism(
            "+[NSURLConnection sendAsynchronousRequest:queue:completionHandler:]",
            requestId,
          );

          // Hook the block's invoke function
          const invokePtr = blockPtr.add(0x10).readPointer();
          const key = invokePtr.toString();
          if (!hookedInvokers.has(key)) {
            hookedInvokers.add(key);
            hooks.push(
              Interceptor.attach(invokePtr, {
                onEnter(innerArgs) {
                  const block = new ObjC.Object(innerArgs[0]);
                  const meta = ObjC.getBoundData(block) as TaskBoundData;
                  if (!meta?.id) return;

                  const rid = meta.id;
                  const response = innerArgs[1];
                  const data = innerArgs[2];
                  const error = innerArgs[3];

                  if (!error.isNull()) {
                    recordLoadingFailed(rid, wrapObjC<NSError>(error));
                    return;
                  }

                  if (!response.isNull()) {
                    recordResponseReceived(
                      rid,
                      wrapObjC<NSURLResponse>(response),
                    );
                  }
                  const nsdata = data.isNull() ? null : wrapObjC<NSData>(data);
                  if (nsdata) {
                    const len = nsdata.length();
                    const chunk =
                      len > 0 ? nsdata.bytes().readByteArray(len) : null;
                    recordDataReceived(rid, len, chunk);
                  }
                  recordLoadingFinished(rid);
                },
              }),
            );
          }

          // Bind request ID to the block
          const block = new ObjC.Object(blockPtr);
          ObjC.bind(block, { id: requestId } as TaskBoundData);
        },
      }),
    );
  }
}

```

`agent/src/fruity/hooks/url/index.ts`:

```ts
/*

This module follows the approach of PonyDebugger to log NSURLSession traffics
https://github.com/FLEXTool/FLEX/blob/6cfc82bd9e64832/Classes/Network/PonyDebugger/

PonyDebugger
Copyright 2012 Square Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

*/

import ObjC from "frida-objc-bridge";

import { hooks } from "./common.js";
import {
  hookResume,
  hookTaskCompletion,
  hookTaskDataReceive,
  hookSessionCreation,
  hookAsyncMethods as hookSessionAsyncMethods,
} from "./session.js";
import {
  hookConnectionCreation,
  hookAsyncMethods as hookConnectionAsyncMethods,
} from "./connection.js";
import { hookWebSocketMethods } from "./websocket.js";
import { reset as resetLazyState } from "./lazy.js";

let running = false;

export function start() {
  if (running || !ObjC.available) return;

  console.log("start logging http URL requests");
  running = true;

  const { __NSCFURLSessionTask, NSURLSessionTask, __NSCFLocalSessionTask } =
    ObjC.classes;
  if (__NSCFURLSessionTask) {
    hooks.push(hookResume(__NSCFURLSessionTask));
    const ch = hookTaskCompletion(__NSCFURLSessionTask);
    if (ch) hooks.push(ch);
  }

  if (NSURLSessionTask) {
    hooks.push(hookResume(NSURLSessionTask));
    const ch = hookTaskCompletion(NSURLSessionTask);
    if (ch) hooks.push(ch);
  }

  if (__NSCFLocalSessionTask) {
    const dr = hookTaskDataReceive(__NSCFLocalSessionTask);
    if (dr) hooks.push(dr);
  }

  hookSessionAsyncMethods();
  hookConnectionAsyncMethods();
  hookWebSocketMethods();
  hookSessionCreation();
  hookConnectionCreation();
}

export function stop() {
  if (!running) return;
  running = false;
  for (const hook of hooks) {
    hook.detach();
  }
  hooks.length = 0;
  resetLazyState();
}

export function status(): boolean {
  return running;
}

export function available(): boolean {
  return ObjC.available;
}

```

`agent/src/fruity/hooks/url/lazy.ts`:

```ts
import ObjC from "frida-objc-bridge";

import { getMethodImp } from "./common.js";

const hookedMethods = new Set<string>();
const injectedRtsClasses = new Set<string>();

/**
 * Given a delegate object and a selector→handler map,
 * hook every selector the delegate's class implements.
 * Skip already-hooked (className, selector) pairs.
 */
export function hookDelegateClass(
  delegate: ObjC.Object,
  handlers: Record<string, InvocationListenerCallbacks>,
): InvocationListener[] {
  const listeners: InvocationListener[] = [];
  const className = delegate.$className;
  const clazz = ObjC.classes[className];
  if (!clazz) return listeners;

  for (const [sel, handler] of Object.entries(handlers)) {
    const key = `${className}\t${sel}`;
    if (hookedMethods.has(key)) continue;

    const imp = getMethodImp(clazz, sel, false);
    if (!imp) continue;

    try {
      const listener = Interceptor.attach(imp, handler);
      listeners.push(listener);
      hookedMethods.add(key);
    } catch (e) {
      console.warn(`Failed to hook ${sel} on ${className}:`, e);
    }
  }

  return listeners;
}

/**
 * If delegate implements didReceiveData: or didCompleteWithError:
 * but NOT didReceiveResponse:completionHandler:, hook its
 * respondsToSelector: to return YES for the latter.
 */
export function injectRespondsToSelector(
  delegate: ObjC.Object,
): InvocationListener | null {
  const className = delegate.$className;
  if (injectedRtsClasses.has(className)) return null;

  const clazz = ObjC.classes[className];
  if (!clazz) return null;

  const hasData = !!getMethodImp(
    clazz,
    "URLSession:dataTask:didReceiveData:",
    false,
  );
  const hasComplete = !!getMethodImp(
    clazz,
    "URLSession:task:didCompleteWithError:",
    false,
  );

  if (!hasData && !hasComplete) return null;

  // Skip if the class already implements didReceiveResponse:completionHandler:
  if (
    getMethodImp(
      clazz,
      "URLSession:dataTask:didReceiveResponse:completionHandler:",
      false,
    )
  )
    return null;

  const rtsImp = getMethodImp(clazz, "respondsToSelector:", false);
  if (!rtsImp) return null;

  injectedRtsClasses.add(className);

  const targetSel = ObjC.selector(
    "URLSession:dataTask:didReceiveResponse:completionHandler:",
  );

  return Interceptor.attach(rtsImp, {
    onEnter(args) {
      const sel = args[2] as NativePointer;
      this._replace = sel.equals(targetSel);
    },
    onLeave(retval) {
      if (this._replace) retval.replace(ptr(1));
    },
  });
}

export function reset(): void {
  hookedMethods.clear();
  injectedRtsClasses.clear();
}

```

`agent/src/fruity/hooks/url/session.ts`:

```ts
import ObjC from "frida-objc-bridge";

import type {
  NSObject,
  NSURLSessionTask,
  NSURLSessionDataTask,
  NSURLSessionDownloadTask,
  NSURLRequest,
  NSURLResponse,
  NSData,
  NSError,
  NSURL,
} from "@/fruity/typings.js";
import { wrapObjC } from "@/fruity/typings.js";
import { getGlobalExport } from "@/lib/polyfill.js";

import {
  hooks,
  getMethodImp,
  type TaskBoundData,
  nextRequestId,
  getOrAssignTaskId,
  getRequestState,
  hasRequestState,
  removeRequestState,
  recordRequestWillBeSent,
  recordResponseReceived,
  recordDataReceived,
  recordLoadingFinished,
  recordLoadingFailed,
  recordMechanism,
} from "./common.js";
import { hookDelegateClass, injectRespondsToSelector } from "./lazy.js";

function streamFileData(fileURL: NSURL, requestId: string) {
  const handle = ObjC.classes.NSFileHandle.fileHandleForReadingAtPath_(
    fileURL.path(),
  );
  if (!handle) return;

  const chunkSize = 256 * 1024;
  try {
    while (true) {
      const data = handle.readDataOfLength_(chunkSize) as NSData;
      if (!data) break;
      const len = data.length();
      if (len <= 0) break;
      const chunk = data.bytes().readByteArray(len);
      recordDataReceived(requestId, len, chunk);
    }
  } finally {
    handle.closeFile();
  }
}

const delegateMethodHandlers: Record<string, InvocationListenerCallbacks> = {
  "URLSession:task:willPerformHTTPRedirection:newRequest:completionHandler:": {
    onEnter(args) {
      if (args[4].isNull() || args[5].isNull()) return;
      const task = wrapObjC<NSURLSessionTask>(args[3]);
      const redirectResponse = wrapObjC<NSURLResponse>(args[4]);
      const newRequest = wrapObjC<NSURLRequest>(args[5]);

      // Finish the current request with the redirect (301/302) response
      const currentId = getOrAssignTaskId(task);
      recordResponseReceived(currentId, redirectResponse);
      recordLoadingFinished(currentId);
      removeRequestState(currentId);

      // New ID for the redirected request, rebind the task
      const newId = nextRequestId();
      ObjC.bind(task, { id: newId } as TaskBoundData);
      getRequestState(newId);
      recordRequestWillBeSent(newId, newRequest, redirectResponse);
    },
  },
  "URLSession:dataTask:didReceiveResponse:completionHandler:": {
    onEnter(args) {
      if (args[4].isNull() || args[5].isNull()) return;
      const delegate = wrapObjC<NSObject>(args[2]);
      const dataTask = wrapObjC<NSURLSessionDataTask>(args[3]);
      const requestId = getOrAssignTaskId(dataTask);
      recordMechanism(
        `NSURLSessionDataTask (delegate: ${delegate.$className})`,
        requestId,
      );
      recordResponseReceived(requestId, wrapObjC<NSURLResponse>(args[4]));
    },
  },
  "URLSession:task:didCompleteWithError:": {
    onEnter(args) {
      const task = wrapObjC<NSURLSessionTask>(args[3]);
      const requestId = getOrAssignTaskId(task);

      // Always emit response from task — covers completion handler tasks
      // where didReceiveResponse: may not fire
      const response = task.response();
      if (response) {
        recordResponseReceived(requestId, response);
      }

      if (!args[4].isNull()) {
        recordLoadingFailed(requestId, wrapObjC<NSError>(args[4]));
      } else {
        recordLoadingFinished(requestId);
      }
      removeRequestState(requestId);
    },
  },
  "URLSession:dataTask:didBecomeDownloadTask:": {
    onEnter(args) {
      const dataTask = wrapObjC<NSURLSessionDataTask>(args[3]);
      const downloadTask = wrapObjC<NSURLSessionDownloadTask>(args[4]);
      const dataTaskId = getOrAssignTaskId(dataTask);
      ObjC.bind(downloadTask, { id: dataTaskId } as TaskBoundData);
    },
  },
  "URLSession:downloadTask:didWriteData:totalBytesWritten:totalBytesExpectedToWrite:":
    {
      onEnter(args) {
        const delegate = wrapObjC<NSObject>(args[2]);
        const downloadTask = wrapObjC<NSURLSessionDownloadTask>(args[3]);
        const requestId = getOrAssignTaskId(downloadTask);
        const state = getRequestState(requestId);

        if (!state.mechanismRecorded) {
          state.mechanismRecorded = true;

          const response = downloadTask.response();
          if (response) {
            recordResponseReceived(requestId, response);
          }

          recordMechanism(
            `NSURLSessionDownloadTask (delegate: ${delegate.$className})`,
            requestId,
          );
        }
        recordDataReceived(requestId, args[4].toString());
      },
    },
  "URLSession:downloadTask:didFinishDownloadingToURL:": {
    onEnter(args) {
      if (args[4].isNull()) return;

      const downloadTask = wrapObjC<NSURLSessionDownloadTask>(args[3]);
      const requestId = getOrAssignTaskId(downloadTask);
      streamFileData(wrapObjC<NSURL>(args[4]), requestId);
    },
  },
};

export function hookResume(klass: ObjC.Object) {
  const imp = getMethodImp(klass, "resume", false)!;
  return Interceptor.attach(imp, {
    onEnter(args) {
      const task = wrapObjC<NSURLSessionTask>(args[0]);

      const avClass = ObjC.classes.AVAggregateAssetDownloadTask;
      if (avClass && task.isKindOfClass_(avClass)) {
        return;
      }

      // Lazily hook delegate for pre-existing sessions
      try {
        const delegate = task.session().delegate();
        if (delegate && !delegate.handle.isNull()) {
          hooks.push(...hookDelegateClass(delegate, delegateMethodHandlers));
          const rtsHook = injectRespondsToSelector(delegate);
          if (rtsHook) hooks.push(rtsHook);
        }
      } catch (_e) {
        // session may not expose delegate
      }

      // Pre-parse HTTP body to avoid thread safety issues
      const currentRequest = task.currentRequest();
      if (currentRequest) {
        currentRequest.HTTPBody();
      }

      const requestId = getOrAssignTaskId(task);
      const state = getRequestState(requestId);
      if (!state.request && currentRequest) {
        state.request = currentRequest;
        recordRequestWillBeSent(requestId, currentRequest, null);
      }
    },
  });
}

/**
 * Fallback: hook setState: on the task class to catch completion
 * for tasks whose session has no delegate and no completion handler.
 * Only emits if no delegate/CH already recorded the event
 * (checked via hasRequestState — it's removed by delegate/CH handlers).
 */
export function hookTaskCompletion(klass: ObjC.Object) {
  const imp = getMethodImp(klass, "setState:", false);
  if (!imp) return null;

  return Interceptor.attach(imp, {
    onEnter(args) {
      // NSURLSessionTaskStateCompleted = 3
      if (args[2].toInt32() !== 3) return;

      const task = wrapObjC<NSURLSessionTask>(args[0]);
      const bound = ObjC.getBoundData(task) as TaskBoundData;
      if (!bound?.id) return;

      const requestId = bound.id;
      // Already handled by delegate or completion handler
      if (!hasRequestState(requestId)) return;

      const response = task.response();
      if (response) {
        recordResponseReceived(requestId, response);
      }

      const error = task.error();
      if (error) {
        recordLoadingFailed(requestId, error as unknown as NSError);
      } else {
        recordLoadingFinished(requestId);
      }
      removeRequestState(requestId);
    },
  });
}

/**
 * Hook internal data delivery on the task class.
 * This fires for ALL data tasks regardless of delegate/CH setup,
 * covering Swift async URLSession.data(for:) and similar paths.
 *
 * The internal method receives dispatch_data_t, not NSData.
 */
export function hookTaskDataReceive(klass: ObjC.Object) {
  const sel = "_onqueue_didReceiveDispatchData:completion:";
  const imp = getMethodImp(klass, sel, false);
  if (!imp) return null;

  const dispatch_data_create_map = new NativeFunction(
    getGlobalExport("dispatch_data_create_map"),
    "pointer",
    ["pointer", "pointer", "pointer"],
  );

  return Interceptor.attach(imp, {
    onEnter(args) {
      const task = wrapObjC<NSURLSessionTask>(args[0]);
      const bound = ObjC.getBoundData(task) as TaskBoundData;
      if (!bound?.id) return;

      const dispatchData = args[2];
      if (dispatchData.isNull()) return;

      // Map dispatch_data_t to a contiguous buffer
      const bufPtr = Memory.alloc(Process.pointerSize);
      const sizePtr = Memory.alloc(Process.pointerSize);
      dispatch_data_create_map(dispatchData, bufPtr, sizePtr);
      const buf = bufPtr.readPointer();
      const len = Number(sizePtr.readULong());

      if (len > 0 && !buf.isNull()) {
        const chunk = buf.readByteArray(len);
        recordDataReceived(bound.id, len, chunk);
      }
    },
  });
}

export function hookSessionCreation() {
  const sel = "sessionWithConfiguration:delegate:delegateQueue:";
  const classes = [
    ObjC.classes.NSURLSession,
    ObjC.classes.__NSURLSessionLocal,
  ].filter(Boolean);

  for (const clazz of classes) {
    const imp = getMethodImp(clazz, sel, true);
    if (!imp) continue;

    hooks.push(
      Interceptor.attach(imp, {
        onEnter(args) {
          // args: self, _cmd, configuration, delegate, delegateQueue
          if (args[3].isNull()) return;

          const delegate = new ObjC.Object(args[3]);
          hooks.push(...hookDelegateClass(delegate, delegateMethodHandlers));
          const rtsHook = injectRespondsToSelector(delegate);
          if (rtsHook) hooks.push(rtsHook);
        },
      }),
    );
  }
}

interface CompletionBoundData {
  requestId?: string;
  isDownload?: boolean;
}

export function hookAsyncMethods() {
  const downloadSelectors = new Set([
    "downloadTaskWithRequest:completionHandler:",
    "downloadTaskWithResumeData:completionHandler:",
    "downloadTaskWithURL:completionHandler:",
  ]);

  const selectorHandlerIndex: Record<string, number> = {
    "dataTaskWithRequest:completionHandler:": 3,
    "dataTaskWithURL:completionHandler:": 3,
    "downloadTaskWithRequest:completionHandler:": 3,
    "downloadTaskWithResumeData:completionHandler:": 3,
    "downloadTaskWithURL:completionHandler:": 3,
    "uploadTaskWithRequest:fromData:completionHandler:": 4,
    "uploadTaskWithRequest:fromFile:completionHandler:": 4,
  };

  function mechanismForSelector(sel: string): string {
    if (sel.startsWith("download"))
      return "NSURLSessionDownloadTask (completionHandler)";
    if (sel.startsWith("upload"))
      return "NSURLSessionUploadTask (completionHandler)";
    return "NSURLSessionDataTask (completionHandler)";
  }

  // Force-copy blocks to heap so the pointer stays stable for ObjC.bind.
  // Stack blocks get a new address when the runtime copies them; by
  // pre-copying we ensure args[0] in the invoke matches what we bound to.
  const blockCopy = new NativeFunction(
    getGlobalExport("_Block_copy"),
    "pointer",
    ["pointer"],
  );
  const blockRelease = new NativeFunction(
    getGlobalExport("_Block_release"),
    "void",
    ["pointer"],
  );

  const hookedInvokers = new Set<string>();

  function hookCompletionInvoke(blockPtr: NativePointer) {
    const invokePtr = blockPtr.add(0x10).readPointer();
    const key = invokePtr.toString();
    if (hookedInvokers.has(key)) return;
    hookedInvokers.add(key);

    hooks.push(
      Interceptor.attach(invokePtr, {
        onEnter(args) {
          const block = new ObjC.Object(args[0]);
          const metadata = ObjC.getBoundData(block) as CompletionBoundData;
          if (!metadata?.requestId) return;

          const rid = metadata.requestId;
          const isDownload = metadata.isDownload ?? false;
          const first = args[1];
          const response = args[2];
          const error = args[3];

          if (!error.isNull()) {
            recordLoadingFailed(rid, wrapObjC<NSError>(error));
            removeRequestState(rid);
            return;
          }

          if (!response.isNull()) {
            recordResponseReceived(rid, wrapObjC<NSURLResponse>(response));
          }

          if (isDownload && !first.isNull()) {
            streamFileData(wrapObjC<NSURL>(first), rid);
          }

          recordLoadingFinished(rid);
          removeRequestState(rid);
        },
      }),
    );
  }

  function hookSelector(clazz: ObjC.Object, sel: string) {
    const imp = getMethodImp(clazz, sel, false);
    if (!imp) return;

    const handlerIndex = selectorHandlerIndex[sel];
    const isDownload = downloadSelectors.has(sel);
    const mechanism = mechanismForSelector(sel);

    hooks.push(
      Interceptor.attach(imp, {
        onEnter(args) {
          if (args[handlerIndex].isNull()) return;

          // Copy the block to heap so the pointer is stable across
          // _Block_copy calls the runtime makes internally.
          const heapBlock = blockCopy(args[handlerIndex]) as NativePointer;
          args[handlerIndex] = heapBlock;

          hookCompletionInvoke(heapBlock);
          this.blockPtr = heapBlock;
          this.mechanism = mechanism;
          this.isDownload = isDownload;
        },
        onLeave(retval) {
          if (!this.blockPtr || retval.isNull()) return;

          // Release our extra retain — the method already retained the block
          blockRelease(this.blockPtr);

          const task = wrapObjC<NSURLSessionTask>(retval);
          const requestId = getOrAssignTaskId(task);

          const block = new ObjC.Object(this.blockPtr);
          ObjC.bind(block, {
            requestId,
            isDownload: this.isDownload,
          } as CompletionBoundData);

          const request = task.originalRequest();
          if (request) {
            recordRequestWillBeSent(requestId, request, null);
          }
          recordMechanism(this.mechanism, requestId);
        },
      }),
    );
  }

  function intercept(clazz: ObjC.Object) {
    for (const sel of Object.keys(selectorHandlerIndex)) {
      hookSelector(clazz, sel);
    }
  }

  const { NSURLSession, __NSURLSessionLocal } = ObjC.classes;
  if (NSURLSession) intercept(NSURLSession);
  if (__NSURLSessionLocal) intercept(__NSURLSessionLocal);
}

```

`agent/src/fruity/hooks/url/websocket.ts`:

```ts
import ObjC from "frida-objc-bridge";

import type {
  NSURLSessionWebSocketTask,
  NSURLSessionWebSocketMessage,
  NSError,
} from "@/fruity/typings.js";
import { wrapObjC } from "@/fruity/typings.js";

import {
  hooks,
  getMethodImp,
  recordWebSocketMessage,
  emitNetworkEvent,
  type NetworkEvent,
} from "./common.js";

export function hookWebSocketMethods() {
  const classes = [
    ObjC.classes.__NSURLSessionWebSocketTask,
    ObjC.classes.NSURLSessionWebSocketTask,
  ].filter(Boolean);

  const hookedSendInvokers = new Set<string>();
  const hookedRecvInvokers = new Set<string>();

  for (const clazz of classes) {
    // -sendMessage:completionHandler:
    const sendImp = getMethodImp(clazz, "sendMessage:completionHandler:", false);
    if (sendImp) {
      hooks.push(
        Interceptor.attach(sendImp, {
          onEnter(args) {
            const task = wrapObjC<NSURLSessionWebSocketTask>(args[0]);
            const message = wrapObjC<NSURLSessionWebSocketMessage>(args[2]);
            recordWebSocketMessage("send", task, message);

            // Hook completion to capture send errors
            const blockPtr = args[3];
            if (blockPtr.isNull()) return;

            const invokePtr = blockPtr.add(0x10).readPointer();
            const key = invokePtr.toString();
            if (!hookedSendInvokers.has(key)) {
              hookedSendInvokers.add(key);
              hooks.push(
                Interceptor.attach(invokePtr, {
                  onEnter(innerArgs) {
                    if (innerArgs[1].isNull()) return;

                    const block = new ObjC.Object(innerArgs[0]);
                    const meta = ObjC.getBoundData(block) as {
                      requestId?: string;
                      messageType?: string;
                      dataLength?: number;
                      messageText?: string;
                    };
                    if (!meta?.requestId) return;

                    const event: NetworkEvent = {
                      event: "webSocketSend",
                      requestId: meta.requestId,
                      timestamp: Date.now(),
                      messageType: meta.messageType,
                    };
                    if (meta.dataLength !== undefined)
                      event.dataLength = meta.dataLength;
                    if (meta.messageText !== undefined)
                      event.message = meta.messageText;
                    event.error = wrapObjC<NSError>(innerArgs[1]).toString();
                    emitNetworkEvent(event);
                  },
                }),
              );
            }

            // Snapshot message data now while objects are alive,
            // the completion handler fires later when they may be freed
            const requestId = task.taskIdentifier().toString();
            const msgType = message.type();
            const msgData = message.data();
            const msgString = message.string();
            const snapshot: Record<string, unknown> = {
              requestId,
              messageType: msgType === 0 ? "data" : "string",
            };
            if (msgType === 0 && msgData)
              snapshot.dataLength = msgData.length();
            if (msgType === 1 && msgString)
              snapshot.messageText = msgString.toString();

            const block = new ObjC.Object(blockPtr);
            ObjC.bind(block, snapshot);
          },
        }),
      );
    }

    // -receiveMessageWithCompletionHandler:
    const recvImp = getMethodImp(clazz, "receiveMessageWithCompletionHandler:", false);
    if (recvImp) {
      hooks.push(
        Interceptor.attach(recvImp, {
          onEnter(args) {
            const task = wrapObjC<NSURLSessionWebSocketTask>(args[0]);
            const blockPtr = args[2];
            if (blockPtr.isNull()) return;

            const invokePtr = blockPtr.add(0x10).readPointer();
            const key = invokePtr.toString();
            if (!hookedRecvInvokers.has(key)) {
              hookedRecvInvokers.add(key);
              hooks.push(
                Interceptor.attach(invokePtr, {
                  onEnter(innerArgs) {
                    if (innerArgs[1].isNull()) return;

                    const block = new ObjC.Object(innerArgs[0]);
                    const meta = ObjC.getBoundData(block) as {
                      task?: NSURLSessionWebSocketTask;
                    };
                    if (!meta?.task) return;

                    recordWebSocketMessage(
                      "receive",
                      meta.task,
                      wrapObjC<NSURLSessionWebSocketMessage>(innerArgs[1]),
                      innerArgs[2].isNull()
                        ? null
                        : wrapObjC<NSError>(innerArgs[2]),
                    );
                  },
                }),
              );
            }

            const block = new ObjC.Object(blockPtr);
            ObjC.bind(block, { task });
          },
        }),
      );
    }
  }
}

```

`agent/src/fruity/hooks/xpc/index.ts`:

```ts
import ObjC from "frida-objc-bridge";

import { hookXPC } from "./libxpc.js";
import { hookNSXPC } from "./nsxpc.js";

interface XPCNodeBase {
  description: string;
}

export interface XPCDictionaryNode extends XPCNodeBase {
  type: "dictionary";
  keys: string[];
  values: XPCNode[];
}

export interface XPCArrayNode extends XPCNodeBase {
  type: "array";
  values: XPCNode[];
}

export interface XPCStringNode extends XPCNodeBase {
  type: "string";
  value: string | null;
}

export interface XPCDataNode extends XPCNodeBase {
  type: "data";
  offset: number;
  length: number;
}

export interface XPCUUIDNode extends XPCNodeBase {
  type: "uuid";
  offset: number;
  value: string;
}

export interface XPCDoubleNode extends XPCNodeBase {
  type: "double";
  value: number;
}

export interface XPCUInt64Node extends XPCNodeBase {
  type: "uint64";
  value: string;
}

export interface XPCInt64Node extends XPCNodeBase {
  type: "int64";
  value: string;
}

export interface XPCBoolNode extends XPCNodeBase {
  type: "bool";
  value: boolean;
}

export interface XPCFdNode extends XPCNodeBase {
  type: "fd";
  value: number;
  path?: string | null;
}

export interface XPCNullNode extends XPCNodeBase {
  type: "null";
}

export interface XPCDateNode extends XPCNodeBase {
  type: "date";
  value: string;
}

export interface XPCShmemNode extends XPCNodeBase {
  type: "shmem";
}

export interface XPCErrorNode extends XPCNodeBase {
  type: "error";
}

export interface XPCEndpointNode extends XPCNodeBase {
  type: "endpoint";
}

export interface XPCConnectionNode extends XPCNodeBase {
  type: "connection";
}

export interface XPCUnknownNode extends XPCNodeBase {
  type: "unknown";
}

export type XPCNode =
  | XPCDictionaryNode
  | XPCArrayNode
  | XPCStringNode
  | XPCDataNode
  | XPCUUIDNode
  | XPCDoubleNode
  | XPCUInt64Node
  | XPCInt64Node
  | XPCBoolNode
  | XPCFdNode
  | XPCNullNode
  | XPCDateNode
  | XPCShmemNode
  | XPCErrorNode
  | XPCEndpointNode
  | XPCConnectionNode
  | XPCUnknownNode;

export type XPCNodeType = XPCNode["type"];

let running = false;
const listeners: InvocationListener[] = [];

export function start(): void {
  if (running) return;
  if (!ObjC.available) return;

  console.log("start logging XPC/NSXPC traffic");
  running = true;

  listeners.push(...hookXPC(), ...hookNSXPC());
}

export function stop(): void {
  if (!running) return;
  running = false;
  for (const listener of listeners) {
    listener.detach();
  }
  listeners.length = 0;
}

export function status(): boolean {
  return running;
}

export function available(): boolean {
  return ObjC.available && Process.findModuleByName("libxpc.dylib") !== null;
}

```

`agent/src/fruity/hooks/xpc/libxpc.ts`:

```ts
import ObjC from "frida-objc-bridge";

import getLibXpcApi from "@/fruity/native/libxpc.js";
import getLibSystemApi from "@/fruity/native/libsystem.js";
import { symbolFromName } from "@/fruity/native/libdyld.js";
import { bt } from "@/common/hooks/context.js";

import type { XPCNode } from "./index.js";

const subject = "xpc";

function copyDescription(obj: NativePointer): string {
  const api = getLibXpcApi();
  const desc = api.xpc_copy_description(obj);
  const str = desc.readUtf8String();
  getLibSystemApi().free(desc);
  return str ?? "";
}

class LogSerializer {
  #dataBuffers: ArrayBuffer[] = [];
  #offset = 0;

  constructor(private readonly root: NativePointer) {}

  serialize(): [XPCNode, ArrayBuffer] {
    const json = this.dump(this.root);
    const joint = new Uint8Array(this.#offset);

    for (let i = 0, offset = 0; i < this.#dataBuffers.length; i++) {
      const buf = this.#dataBuffers[i];
      joint.set(new Uint8Array(buf), offset);
      offset += buf.byteLength;
    }

    return [json, joint.buffer as ArrayBuffer];
  }

  private appendData(data: ArrayBuffer): number {
    const offset = this.#offset;
    this.#dataBuffers.push(data);
    this.#offset += data.byteLength;
    return offset;
  }

  private dump(xpcObj: NativePointer): XPCNode {
    const api = getLibXpcApi();
    const t = api.xpc_get_type(xpcObj);
    const description = copyDescription(xpcObj);

    if (t.equals(api.xpcDictionaryType)) {
      const keys: string[] = [];
      const values: XPCNode[] = [];

      api.xpc_dictionary_apply(
        xpcObj,
        new ObjC.Block({
          retType: "bool",
          argTypes: ["pointer", "pointer"],
          implementation: (key: NativePointer, value: NativePointer) => {
            keys.push(key.readUtf8String()!);
            values.push(this.dump(value));
            return true;
          },
        }),
      );

      return { description, keys, values, type: "dictionary" };
    }

    if (t.equals(api.xpcArrayType)) {
      const values: XPCNode[] = [];
      api.xpc_array_apply(
        xpcObj,
        new ObjC.Block({
          retType: "bool",
          argTypes: ["uint64", "pointer"],
          implementation: (_index: number, value: NativePointer) => {
            values.push(this.dump(value));
            return true;
          },
        }),
      );

      return { description, values, type: "array" };
    }

    for (const xpcType of api.xpcTypes) {
      if (api.xpc_get_type(xpcObj).equals(xpcType.address)) {
        const type = xpcType.name.replace(/^_xpc_type_/, "");

        if (type === "string") {
          const value = api
            .xpc_string_get_string_ptr(xpcObj)
            .readUtf8String(api.xpc_string_get_length(xpcObj).toNumber());
          return { description, value, type };
        } else if (type === "data") {
          const base = api.xpc_data_get_bytes_ptr(xpcObj);
          const length = api.xpc_data_get_length(xpcObj).toNumber();

          let offset = 0;
          if (!base.isNull()) {
            const data = base.readByteArray(length);
            if (data) {
              offset = this.appendData(data);
            }
          }

          return { description, type, offset, length };
        } else if (type === "uuid") {
          const p = api.xpc_uuid_get_bytes(xpcObj);
          const data = p.readByteArray(16)!;
          const offset = this.appendData(data);
          const value = [...new Uint8Array(data)]
            .map((x) => x.toString(16).padStart(2, "0"))
            .join("");

          return { description, type, offset, value };
        } else if (type === "double") {
          const value = api.xpc_double_get_value(xpcObj);
          return { description, type, value };
        } else if (type === "uint64") {
          const value = api.xpc_uint64_get_value(xpcObj).toString();
          return { description, type, value };
        } else if (type === "int64") {
          const value = api.xpc_int64_get_value(xpcObj).toString();
          return { description, type, value };
        } else if (type === "bool") {
          const value = api.xpc_bool_get_value(xpcObj) !== 0;
          return { description, type, value };
        } else if (type === "fd") {
          const F_GETPATH = 50;
          const MAXPATHLEN = 1024;
          const buf = Memory.alloc(MAXPATHLEN);
          const value = api.xpc_fd_dup(xpcObj) as number;
          const rc = getLibSystemApi().fcntl(value, F_GETPATH, buf);
          const path = rc === 0 ? buf.readUtf8String() : undefined;

          return { description, type, value, path };
        } else if (type === "date") {
          const value = api.xpc_date_get_value(xpcObj).toString();
          return { description, type, value };
        } else if (
          type === "shmem" ||
          type === "error" ||
          type === "endpoint" ||
          type === "connection" ||
          type === "null"
        ) {
          return { description, type };
        }

        return { description, type: "unknown" };
      }
    }

    return { description, type: "unknown" };
  }
}

export function hookXPC(): InvocationListener[] {
  const api = getLibXpcApi();
  const listeners: InvocationListener[] = [];

  const dispatcher = symbolFromName(
    "libxpc.dylib",
    "_xpc_connection_call_event_handler",
  );
  if (dispatcher.isNull()) {
    console.warn(
      "xpc: _xpc_connection_call_event_handler not found, skipping incoming XPC hooks",
    );
    return listeners;
  }

  listeners.push(
    Interceptor.attach(dispatcher, {
      onEnter(args) {
        const conn = args[0];
        const msg = args[1];

        if (!api.xpc_get_type(msg).equals(api.xpcDictionaryType)) return;

        const name = api.xpc_connection_get_name(conn).readUtf8String();
        const pid = api.xpc_connection_get_pid(conn) as number;

        try {
          const serializer = new LogSerializer(msg);
          const [json, data] = serializer.serialize();

          send(
            {
              subject,
              event: "received",
              name,
              peer: pid,
              dir: "<",
              message: json,
            },
            data,
          );
        } catch (e) {
          console.warn("xpc: failed to serialize incoming message:", e);
        }
      },
    }),
  );

  for (const suffix of ["", "_with_reply", "_with_reply_sync"]) {
    const fnName = `xpc_connection_send_message${suffix}`;
    const fnAddr = api.libxpc.findExportByName(fnName);
    if (!fnAddr) continue;

    listeners.push(
      Interceptor.attach(fnAddr, {
        onEnter(args) {
          const conn = args[0];
          const msg = args[1];

          const name = api.xpc_connection_get_name(conn).readUtf8String();
          const pid = api.xpc_connection_get_pid(conn) as number;

          try {
            const serializer = new LogSerializer(msg);
            const [json, data] = serializer.serialize();
            const backtrace = bt(this.context);

            send(
              {
                subject,
                event: "sent",
                name,
                peer: pid,
                dir: ">",
                message: json,
                backtrace,
              },
              data,
            );
          } catch (e) {
            console.warn("xpc: failed to serialize outgoing message:", e);
          }
        },
      }),
    );
  }

  return listeners;
}

```

`agent/src/fruity/hooks/xpc/nsxpc.ts`:

```ts
import ObjC from "frida-objc-bridge";

import { symbolFromName, symbolsFromGlob } from "@/fruity/native/libdyld.js";
import { bt } from "@/common/hooks/context.js";

const subject = "xpc";

function formatArgs(
  args: InvocationArguments,
  signature: ObjC.Object,
): string[] {
  const nargs = signature.numberOfArguments();
  const result: string[] = [];
  for (let i = 2; i < nargs; i++) {
    const arg = args[i];
    const t = signature.getArgumentTypeAtIndex_(i);
    const wrapped = t.toString().startsWith("@") ? new ObjC.Object(arg) : arg;
    result.push(wrapped.toString());
  }
  return result;
}

function formatDescription(
  self: NativePointer,
  clazz: string,
  sel: string,
  args: InvocationArguments,
): string {
  const parts = sel.split(":");
  const nparams = sel.includes(":") ? parts.length - 1 : 0;

  function* gen() {
    yield `<${clazz} ${self}>`;
    if (nparams === 0) {
      yield ` ${sel}`;
      return;
    }
    for (let i = 0; i < nparams; i++) {
      if (i === 0) yield " ";
      yield `${parts[i] || ""}:${args[i + 2]}`;
    }
  }

  return [...gen()].join("");
}

export function hookNSXPC(): InvocationListener[] {
  const listeners: InvocationListener[] = [];
  if (!ObjC.available) return listeners;

  ObjC.classes.NSBundle.bundleWithPath_(
    "/System/Library/Frameworks/Foundation.framework",
  ).load();

  // Hook incoming invocations
  const invoker = symbolFromName(
    "Foundation",
    "__NSXPCCONNECTION_IS_CALLING_OUT_TO_EXPORTED_OBJECT__",
  );

  if (!invoker.isNull()) {
    listeners.push(
      Interceptor.attach(invoker.strip(), {
        onEnter(args) {
          const invocation = new ObjC.Object(args[0]);
          const target = invocation.target();
          const selector = invocation.selector();
          const sel = ObjC.selectorAsString(selector);

          const imp = target
            .methodForSelector_(selector)
            .strip() as NativePointer;
          const signature = target.methodSignatureForSelector_(
            selector,
          ) as ObjC.Object;

          this.hook = Interceptor.attach(imp, {
            onEnter(innerArgs) {
              const json = {
                type: "nsxpc",
                sel,
                args: formatArgs(innerArgs, signature),
                description: formatDescription(
                  innerArgs[0],
                  target.$className,
                  sel,
                  innerArgs,
                ),
              };

              send({
                subject,
                event: "received",
                dir: "<",
                message: json,
              });
            },
          });
        },
        onLeave() {
          this.hook.detach();
        },
      }),
    );
  }

  // Hook fast-path incoming invocations
  for (const func of symbolsFromGlob(
    "Foundation",
    "__NSXPCCONNECTION_IS_CALLING_OUT_TO_EXPORTED_OBJECT_S*",
  )) {
    const plain = func.strip();
    if (plain.isNull()) continue;

    listeners.push(
      Interceptor.attach(plain, {
        onEnter(args) {
          const targetClass = new ObjC.Object(args[0]);
          const sel = ObjC.selectorAsString(args[1]);
          const signature = targetClass.methodSignatureForSelector_(args[1]);

          const json = {
            type: "nsxpc",
            sel,
            args: formatArgs(args, signature),
            description: formatDescription(
              args[0],
              targetClass.$className,
              sel,
              args,
            ),
          };

          send({
            subject,
            event: "received",
            dir: "<",
            message: json,
          });
        },
      }),
    );
  }

  // Track proxy creation to bind connection info
  const protocol = ObjC.protocols.NSXPCProxyCreating;
  const cls = ObjC.classes.NSXPCConnection;
  if (protocol && cls) {
    for (const sel in protocol.methods) {
      if (!cls[sel]) continue;

      listeners.push(
        Interceptor.attach(cls[sel].implementation, {
          onEnter(args) {
            this.conn = args[0];
          },
          onLeave(retValue) {
            try {
              ObjC.bind(retValue, { conn: this.conn });
            } catch {
              /* may fail if retValue is not an ObjC object */
            }
          },
        }),
      );
    }
  }

  // Hook outgoing messages via distant object sends
  for (const func of symbolsFromGlob(
    "Foundation",
    "_NSXPCDistantObjectSimpleMessageSend*",
  )) {
    if (func.isNull()) continue;

    listeners.push(
      Interceptor.attach(func, {
        onEnter(args) {
          const proxy = new ObjC.Object(args[0]);
          const sel = ObjC.selectorAsString(args[1]);
          const clazz = proxy.$className;

          const signature = proxy.methodSignatureForSelector_(
            args[1],
          ) as ObjC.Object;

          let name = "";
          let peer = 0;

          try {
            const { conn } = ObjC.getBoundData(args[0]);
            if (conn) {
              const connObj = new ObjC.Object(conn as NativePointer);
              if (typeof connObj.serviceName === "function") {
                name = connObj.serviceName() + "";
                peer = connObj.processIdentifier();
              }
            }
          } catch {
            /* no bound data */
          }

          const json = {
            type: "nsxpc",
            sel,
            args: formatArgs(args, signature),
            description: formatDescription(args[0], clazz, sel, args),
          };

          const backtrace = bt(this.context);

          send({
            subject,
            event: "sent",
            name,
            peer,
            dir: ">",
            message: json,
            backtrace,
          });
        },
      }),
    );
  }

  return listeners;
}

```

`agent/src/fruity/index.ts`:

```ts
import ObjC from "frida-objc-bridge";

import { init as setupExceptionHandler } from "@/common/exception.js";
import { init as enableLifeCycleHook } from "./observers/lifecycle.js";
import { interfaces, invoke } from "./registry.js";
import * as taps from "./taps.js";
import type { TapRule } from "@/common/taps.js";

import "@/common/encode-arraybuffer.js";

setupExceptionHandler();
setImmediate(enableLifeCycleHook);

if (ObjC.available && ObjC.classes.UIApplication) {
  // disable autolock
  ObjC.schedule(ObjC.mainQueue, () => {
    try {
      ObjC.classes.UIApplication.sharedApplication()?.setIdleTimerDisabled_(
        ptr(1),
      );
    } finally {
    }
  });
}

rpc.exports = {
  invoke(namespace: string, method: string, args?: unknown[]) {
    const action = () => invoke(namespace, method, args || []);
    if (ObjC.available && ObjC.classes.NSAutoreleasePool) {
      const pool = ObjC.classes.NSAutoreleasePool.alloc().init();
      try {
        return action();
      } finally {
        pool.release();
      }
    } else {
      return action();
    }
  },
  interfaces,
  restore(rules: TapRule[]) {
    taps.restore(rules);
  },
  snapshot() {
    return taps.snapshot();
  },
};

```

`agent/src/fruity/lib/alive.ts`:

```ts
import ObjC from "frida-objc-bridge";

export class AliveTracker {
  private handles = new Set<string>();
  private hooked = false;

  constructor(private clazz: ObjC.Object) {}

  private hook() {
    if (this.hooked) return;
    this.hooked = true;

    const handles = this.handles;
    const listener = Interceptor.attach(this.clazz["- dealloc"].implementation, {
      onEnter(args) {
        handles.delete(args[0].toString());
      },
    });
    Script.bindWeak(globalThis, listener.detach.bind(listener));
  }

  track(handle: string) {
    this.hook();
    this.handles.add(handle);
  }

  has(handle: string): boolean {
    return this.handles.has(handle);
  }

  get(handle: string): ObjC.Object {
    if (!this.handles.has(handle)) {
      throw new Error(`${this.clazz.$className} ${handle} not found`);
    }
    return new ObjC.Object(ptr(handle));
  }
}

```

`agent/src/fruity/lib/dispatch.ts`:

```ts
import ObjC from "frida-objc-bridge";

export function performOnMainThread<T>(action: () => T): Promise<T> {
  const { NSThread } = ObjC.classes;

  return new Promise((resolve, reject) => {
    async function performAction() {
      try {
        const result = await action();
        resolve(result);
      } catch (e) {
        reject(e);
      }
    }

    if (NSThread.isMainThread()) {
      performAction();
    } else {
      ObjC.schedule(ObjC.mainQueue, performAction);
    }
  });
}

```

`agent/src/fruity/lib/macho.ts`:

```ts
// const MH_EXECUTE = 0x2;
// const MH_DYLIB = 0x6;
// const MH_DYLINKER = 0x7;
// const MH_BUNDLE = 0x8;

const MH_PIE = 0x200000;
const MH_NO_HEAP_EXECUTION = 0x1000000;

const LC_ENCRYPTION_INFO_64 = 0x2c;
const LC_ENCRYPTION_INFO = 0x21;

const HEADER_SIZE_64 = 8 * 4;

function flags(mod: Module) {
  return mod.base.add(0x18).readU32();
}

export function pie(mod: Module) {
  return Boolean(flags(mod) & MH_PIE);
}

export function nx(mod: Module) {
  return Boolean(flags(mod) & MH_NO_HEAP_EXECUTION);
}

interface EncryptInfo {
  ptr: NativePointer;
  offset: number;
  size: number;
  offsetOfCmd: number;
  sizeOfCmd: number;
  cryptid: number;
}

export function encryptionInfo(mod: Module): EncryptInfo | null {
  const header = mod.base;
  const magic = header.readU32();
  if (magic !== 0xfeedface && magic !== 0xfeedfacf) {
    throw new Error("Invalid Mach-O header magic value");
  }

  // const fileType = header.add(0xc).readU32();
  const ncmds = header.add(0x10).readU32();
  // const sizeOfCmds = header.add(0x14).readU32();

  for (let p = header.add(HEADER_SIZE_64), i = 0; i < ncmds; i++) {
    const cmd = p.readU32();
    const cmdSize = p.add(0x4).readU32();

    if (cmd === LC_ENCRYPTION_INFO_64 || cmd === LC_ENCRYPTION_INFO) {
      const cryptoff = p.add(8).readU32();
      const cryptsize = p.add(12).readU32();
      const cryptid = p.add(16).readU32();
      return {
        ptr: p,
        offset: cryptoff,
        size: cryptsize,
        offsetOfCmd: p.sub(header).toInt32(),
        sizeOfCmd: cmdSize,
        cryptid,
      };
    }

    p = p.add(cmdSize);
  }

  return null;
}

```

`agent/src/fruity/lib/plist.ts`:

```ts
import ObjC from "frida-objc-bridge";

import { NSData } from "@/fruity/typings.js";
import { toJS } from "@/fruity/bridge/object.js";

export function nsdata2str(data: NSData) {
  const NSUTF8StringEncoding = 4;
  return ObjC.classes.NSString.alloc()
    .initWithData_encoding_(data, NSUTF8StringEncoding)
    .toString() as string;
}

export function toXML(obj: ObjC.Object) {
  const NSPropertyListXMLFormat_v1_0 = 100;
  const xml: NSData =
    ObjC.classes.NSPropertyListSerialization.dataWithPropertyList_format_options_error_(
      obj,
      NSPropertyListXMLFormat_v1_0,
      0,
      NULL,
    );

  return nsdata2str(xml);
}

export function toJSON(obj: ObjC.Object) {
  const data: NSData =
    ObjC.classes.NSJSONSerialization.dataWithJSONObject_options_error_(
      obj,
      0,
      NULL,
    );

  return nsdata2str(data);
}

export interface UnifiedPlistFormat {
  xml: string;
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  value: any;
}

export function dump(obj: ObjC.Object) {
  const xml = toXML(obj);
  const value = toJS(obj);
  return { xml, value };
}

```

`agent/src/fruity/lib/swift.ts`:

```ts
const size = 1024;

let buf: NativePointer;
let initialized = false;
let demangler: (symbol: string) => string = (sym) => sym;

function load() {
  const canidates = [
    "/System/Library/PrivateFrameworks/Swift/libswiftDemangle.dylib",
    "/usr/lib/swift/libswiftDemangle.dylib",
  ];

  for (const path of canidates) {
    try {
      return Module.load(path);
    } catch (e) {
      continue;
    }
  }
}

export function demangle(symbol: string) {
  if (initialized) {
    return demangler(symbol);
  }

  const mod = load();
  if (!mod) {
    console.warn("Unable to find swift demangler");
    return symbol;
  }

  const p = mod.findExportByName("swift_demangle_getDemangledName");
  if (!p) {
    console.warn("swift_demangle_getDemangledName not found");
    return symbol;
  }

  const getDemangledName = new NativeFunction(p, "uint", [
    "pointer",
    "pointer",
    "uint",
  ]);

  buf = Memory.alloc(size);
  demangler = (symbol: string) => {
    const len = getDemangledName(
      Memory.allocUtf8String(symbol),
      buf,
      size,
    ) as number;
    if (!len) {
      console.log("failed to demangle name", symbol);
      return symbol;
    }
    return buf.readUtf8String(len)!;
  };

  return demangler(symbol);
}

```

`agent/src/fruity/modules/checksec.ts`:

```ts
import { encryptionInfo, pie } from "@/fruity/lib/macho.js";

export interface CheckSecFlags {
  pie: boolean;
  arc: boolean;
  canary: boolean;
  encrypted: boolean;
}

export function flags(): CheckSecFlags {
  const [main] = Process.enumerateModules();
  const uniqueNames = new Set(main.enumerateImports().map(({ name }) => name));

  return {
    pie: pie(main),
    arc: uniqueNames.has("objc_release"),
    canary: uniqueNames.has("__stack_chk_guard"),
    encrypted: encryptionInfo(main)?.cryptid === 1,
  };
}

```

`agent/src/fruity/modules/classdump.ts`:

```ts
import ObjC from "frida-objc-bridge";

type Tree<T> = {
  [name: string]: Tree<T> | T;
};

const PROPERTY_ATTRS = "TRC&WNOD" as const;
type Property = Record<(typeof PROPERTY_ATTRS)[number], string>;

// interface Property {
//   T: string; // type
//   R?: ""; // readonly
//   C?: ""; // copy
//   "&"?: ""; // strong
//   W?: ""; // weak
//   N?: ""; // nonatomic
//   D?: ""; // dynamic
// }

export interface Ivar {
  name: string;
  offset: number;
  type: string;
}

export interface Method {
  name: string;
  impl: string;
  types: string;
}

export interface ClassDetail {
  name: string;
  protocols: string[];
  methods: Method[];
  ownMethods: string[]; // lookup in methods
  proto: string[]; // superclass chain
  ivars: Ivar[];
  module: string;
  properties: Record<string, Property>;
}

export function classesForModule(path: string) {
  const ownedBy = new ModuleMap((m) => m.path === path);
  if (!ObjC.available) throw new Error("Objective-C not available");
  return ObjC.enumerateLoadedClassesSync({ ownedBy })[path];
}

export function list(scope: string): string[] {
  const mainBundle = ObjC.classes.NSBundle.mainBundle();

  const moduleMaps: { [key: string]: ModuleMap } = {
    __global__: new ModuleMap(),
    __app__: new ModuleMap((module) =>
      module.path.startsWith(mainBundle.bundlePath().toString()),
    ),
    __main__: new ModuleMap(
      (module) => module.path === Process.mainModule.path,
    ),
  };

  const ownedBy = moduleMaps.hasOwnProperty(scope)
    ? moduleMaps[scope]
    : new ModuleMap((module) => module.path === scope);

  const groupBy = ObjC.enumerateLoadedClassesSync({ ownedBy });
  const all = [];
  for (const mod in groupBy) {
    all.push(...groupBy[mod]);
  }
  return all;
}

function copyIvars(clazz: ObjC.Object) {
  const { pointerSize } = Process;
  const numIvarsBuf = Memory.alloc(pointerSize);
  const ivarHandles = ObjC.api.class_copyIvarList(clazz.handle, numIvarsBuf);
  const result: Ivar[] = [];

  if (ivarHandles.isNull()) return result;

  try {
    const numIvars = numIvarsBuf.readUInt();
    for (let i = 0; i < numIvars; i++) {
      const handle = ivarHandles.add(i * pointerSize).readPointer();
      const name = ObjC.api.ivar_getName(handle).readUtf8String() as string;
      const offset = ObjC.api.ivar_getOffset(handle).toInt32();
      const type = ObjC.api
        .ivar_getTypeEncoding(handle)
        .readUtf8String() as string;

      result.push({
        name,
        offset,
        type,
      });
    }
  } finally {
    ObjC.api.free(ivarHandles);
  }

  return result;
}

export function hierarchy(): Tree<string> {
  const tree: Tree<string> = {};
  for (const [name, clazz] of Object.entries(ObjC.classes)) {
    const chain = [name];

    let parent = clazz;
    /* eslint no-cond-assign:0 */
    while ((parent = parent.$superClass)) chain.unshift(parent.$className);

    let node = tree;
    for (const className of chain) {
      if (!node[className]) node[className] = {};
      node = node[className] as Tree<string>;
    }
  }

  return tree;
}

let api: {
  class_copyPropertyList: NativeFunction<
    NativePointer,
    [NativePointerValue, NativePointerValue]
  >;
  property_copyAttributeValue: NativeFunction<
    NativePointer,
    [NativePointerValue, NativePointerValue]
  >;
  property_getName: NativeFunction<NativePointer, [NativePointerValue]>;
};

function ObjCRuntime() {
  if (api) return api;

  const libobjc = Process.getModuleByName("libobjc.A.dylib");
  const class_copyPropertyList = new NativeFunction(
    libobjc.getExportByName("class_copyPropertyList"),
    "pointer",
    ["pointer", "pointer"],
  );

  const property_copyAttributeValue = new NativeFunction(
    libobjc.getExportByName("property_copyAttributeValue"),
    "pointer",
    ["pointer", "pointer"],
  );

  const property_getName = new NativeFunction(
    libobjc.getExportByName("property_getName"),
    "pointer",
    ["pointer"],
  );

  return (api = {
    class_copyPropertyList,
    property_copyAttributeValue,
    property_getName,
  });
}

function copyProperties(clazz: ObjC.Object): Record<string, Property> {
  const {
    property_getName,
    property_copyAttributeValue,
    class_copyPropertyList,
  } = ObjCRuntime();

  const result: Record<string, Property> = {};

  const nPropsBuf = Memory.alloc(Process.pointerSize);
  const props = class_copyPropertyList(clazz.handle, nPropsBuf);
  const nProps = nPropsBuf.readUInt();

  if (props.isNull()) return result;

  const keys: Record<string, NativePointerValue> = {};
  for (const c of PROPERTY_ATTRS) {
    keys[c] = Memory.allocUtf8String(c);
  }

  try {
    for (let i = 0; i < nProps; i++) {
      const handle = props.add(i * Process.pointerSize).readPointer();
      const namePtr = property_getName(handle);
      if (namePtr.isNull()) continue;
      const name = namePtr.readUtf8String() as string;
      const attrs: Record<string, string> = {};

      for (const [key, keyStr] of Object.entries(keys)) {
        const v = property_copyAttributeValue(handle, keyStr);
        if (v.isNull()) continue;
        attrs[key] = v.readUtf8String() as string;
      }

      result[name] = attrs;
    }
  } finally {
    ObjC.api.free(props);
  }

  return result;
}

export function inspect(name: string): ClassDetail {
  const clazz = ObjC.classes[name];
  if (!clazz) throw new Error(`class ${name} not found`);

  const methods: Method[] = clazz.$methods.map((sel) => {
    const meth = clazz[sel] as ObjC.ObjectMethod;
    // const addr = meth.implementation;

    // too much overhead
    // const mod = Process.findModuleByAddress(addr);
    // const offset = mod ? `${mod.name}+${addr.sub(mod.base)}` : "";
    // const impl = `${addr} ${offset}`;

    return {
      name: sel,
      impl: meth.implementation.toString(),
      types: meth.types,
    };
  });

  const protocols = Object.keys(clazz.$protocols);
  const module = clazz.$moduleName;
  const ivars = copyIvars(clazz);

  const proto = [];
  {
    let cur = clazz;
    while ((cur = cur.$superClass)) proto.unshift(cur.$className);
  }

  const properties = copyProperties(clazz);

  return {
    name: name,
    protocols,
    properties,
    methods,
    proto,
    ownMethods: clazz.$ownMethods,
    ivars,
    module,
  };
}

```

`agent/src/fruity/modules/cookies.ts`:

```ts
import ObjC from "frida-objc-bridge";
import type {
  NSObject,
  NSArray,
  NSDate,
  NSDictionary,
  NSURL,
  NSNumber,
  StringLike,
  NSMutableDictionary,
  NSString,
} from "@/fruity/typings.js";
import { toJsArray } from "@/fruity/bridge/object.js";

export type CookiePredicate = Partial<{
  name: string;
  domain: string;
  path: string;
}>;

export interface Cookie {
  version: number;
  name: string;
  value: string;
  expiresDate: Date | null;
  domain: string;
  path: string;
  isSecure: boolean;
  isHTTPOnly: boolean;
  portList: number[];
  comment?: string;
  commentURL?: string;
  isSessionOnly: boolean;
  sameSitePolicy?: string;
}

const PropertyKey = (suffix: string) => {
  let Foundation: Module | null = null;
  if (!Foundation) Foundation = Process.getModuleByName("Foundation");
  return new ObjC.Object(
    Foundation.getExportByName("NSHTTPCookie" + suffix).readPointer(),
  ) as NSString;
};

function NSCookieFromJS(cookie: Cookie) {
  const { NSString, NSDate } = ObjC.classes;
  const dict =
    ObjC.classes.NSMutableDictionary.alloc().init() as NSMutableDictionary<
      StringLike,
      NSObject
    >;

  dict.setObject_forKey_(
    NSString.stringWithString_(cookie.name),
    PropertyKey("Name"),
  );
  dict.setObject_forKey_(
    NSString.stringWithString_(cookie.value),
    PropertyKey("Value"),
  );
  dict.setObject_forKey_(
    NSString.stringWithString_(cookie.domain),
    PropertyKey("Domain"),
  );
  dict.setObject_forKey_(
    NSString.stringWithString_(cookie.path),
    PropertyKey("Path"),
  );
  dict.setObject_forKey_(
    NSString.stringWithString_(cookie.version.toString()),
    PropertyKey("Version"),
  );

  if (cookie.expiresDate) {
    dict.setObject_forKey_(
      NSDate.dateWithTimeIntervalSince1970_(
        cookie.expiresDate.getTime() / 1000,
      ),
      PropertyKey("Expires"),
    );
  }

  if (cookie.isSecure) {
    dict.setObject_forKey_(
      NSString.stringWithString_("TRUE"),
      PropertyKey("Secure"),
    );
  }

  if (cookie.isSessionOnly) {
    dict.setObject_forKey_(
      NSString.stringWithString_("TRUE"),
      PropertyKey("Discard"),
    );
  }

  if (cookie.portList && cookie.portList.length > 0) {
    dict.setObject_forKey_(
      NSString.stringWithString_(cookie.portList.join(",")),
      PropertyKey("Port"),
    );
  }

  if (cookie.comment) {
    dict.setObject_forKey_(
      NSString.stringWithString_(cookie.comment),
      PropertyKey("Comment"),
    );
  }

  if (cookie.commentURL) {
    dict.setObject_forKey_(
      NSString.stringWithString_(cookie.commentURL),
      PropertyKey("CommentURL"),
    );
  }

  if (cookie.sameSitePolicy) {
    dict.setObject_forKey_(
      NSString.stringWithString_(cookie.sameSitePolicy),
      PropertyKey("SameSitePolicy"),
    );
  }

  return ObjC.classes.NSHTTPCookie.cookieWithProperties_(dict);
}

function JSCookieFromNS(cookie: NSHTTPCookie) {
  const entry: Cookie = {
    version: cookie.version(),
    name: cookie.name().toString(),
    value: cookie.value().toString(),
    expiresDate: new Date(cookie.expiresDate()?.timeIntervalSince1970() * 1000),
    domain: cookie.domain().toString(),
    path: cookie.path().toString(),
    isSecure: cookie.isSecure(),
    isHTTPOnly: cookie.isHTTPOnly(),
    portList: toJsArray(cookie.portList()),
    comment: cookie.comment()?.toString(),
    commentURL: cookie.commentURL()?.toString(),
    isSessionOnly: cookie.isSessionOnly(),
  };

  if (cookie.respondsToSelector_(ObjC.selector("sameSitePolicy"))) {
    entry.sameSitePolicy = cookie.sameSitePolicy()?.toString();
  }

  return entry;
}

interface NSHTTPCookie extends NSObject {
  version(): number;
  name(): string;
  value(): string;
  expiresDate(): NSDate;
  sessionOnly(): boolean;
  domain(): string;
  path(): string;
  isSecure(): boolean;
  isHTTPOnly(): boolean;
  portList(): NSArray<NSNumber>;
  comment(): StringLike | null;
  commentURL(): NSURL | null;
  properties(): NSDictionary<StringLike, NSObject>;
  isSessionOnly(): boolean;
  sameSitePolicy(): string | null;
}

interface NSHTTPCookieStorage extends NSObject {
  cookies(): NSArray<NSHTTPCookie>;
  setCookie_(cookie: NSHTTPCookie): void;
  deleteCookie_(cookie: NSHTTPCookie): void;
  removeCookiesSinceDate_(date: NSDate): void;
}

function shared() {
  return ObjC.classes.NSHTTPCookieStorage.sharedHTTPCookieStorage() as NSHTTPCookieStorage;
}

function* iter(storage: NSHTTPCookieStorage) {
  const jar = storage.cookies();
  for (let i = 0; i < jar.count(); i++) {
    yield jar.objectAtIndex_(i);
  }
}

export function list(): Cookie[] {
  return Array.from(iter(shared())).map(JSCookieFromNS);
}

export function add(cookie: Cookie) {
  shared().setCookie_(NSCookieFromJS(cookie));
}

function find(predicate: CookiePredicate): NSHTTPCookie | undefined {
  type K = keyof CookiePredicate;
  const keys = Object.keys(predicate) as K[];
  const set = new Set(keys);
  for (const cookie of iter(shared())) {
    const valid = (Object.keys(predicate) as K[])
      .filter((key) => set.has(key))
      .every((key) => cookie[key]() + "" === predicate[key]);

    if (valid) {
      return cookie;
    }
  }
}

export function create(
  domain: string,
  name: string,
  value: string,
  expires: Date,
  httpOnly = false,
  secure = false,
) {
  throw new Error("not implemented");
}

export function update(
  predicate: CookiePredicate,
  field: "expiresDate" | "value",
  value: number | string, // timestamp or value
) {
  const cookie = find(predicate);
  if (!cookie) return false;

  const storage = shared();
  const mutable = cookie.properties().mutableCopy();

  if (field === "expiresDate") {
    const ts = value as number;
    const nsDate = ObjC.classes.NSDate.dateWithTimeIntervalSince1970_(
      ts / 1000,
    );
    mutable.setObject_forKey_(nsDate, PropertyKey("Expires"));
  } else {
    mutable.setObject_forKey_(value as string, PropertyKey("Value"));
  }

  const newCookie = ObjC.classes.NSHTTPCookie.cookieWithProperties_(mutable);
  storage.setCookie_(newCookie);
  return true;
}

export function remove(predicate: CookiePredicate) {
  const cookie = find(predicate);
  if (!cookie) return false;
  shared().deleteCookie_(cookie);
  return true;
}

export function clear() {
  const storage = shared();
  const since = ObjC.classes.NSDate.dateWithTimeIntervalSince1970_(0);
  storage.removeCookiesSinceDate_(since);
}

```

`agent/src/fruity/modules/entitlements.ts`:

```ts
import ObjC from "frida-objc-bridge";

import cf from "@/fruity/native/corefoundation.js";
import { NSData } from "@/fruity/typings.js";
import { dump, toJSON, toXML } from "@/fruity/lib/plist.js";

const kSecCSDefaultFlags = 0;
// const kSecCSInternalInformation = 1 << 0;
const kSecCSSigningInformation = 1 << 1;
const kSecCSRequirementInformation = 1 << 2;
// const kSecCSDynamicInformation = 1 << 3;
// const kSecCSContentInformation = 1 << 4;

export interface Entitlements {
  [key: string]: string | boolean | number | string[];
}

function dictionary(url: ObjC.Object): NativePointer {
  ObjC.classes.NSBundle.bundleWithPath_(
    "/System/Library/Frameworks/Security.framework",
  ).load();

  const Security = Process.getModuleByName("Security");

  const SecStaticCodeCreateWithPath = new NativeFunction(
    Security.findExportByName("SecStaticCodeCreateWithPath")!,
    "int",
    ["pointer", "uint32", "pointer"],
  );

  const kSecCodeInfoEntitlementsDict = Security.findExportByName(
    "kSecCodeInfoEntitlementsDict",
  )!.readPointer();

  const SecCodeCopySigningInformation = new NativeFunction(
    Security.findExportByName("SecCodeCopySigningInformation")!,
    "int",
    ["pointer", "uint32", "pointer"],
  );

  const { CFRetain, CFRelease } = cf();

  const pCodeRef = Memory.alloc(Process.pointerSize);
  const pSignInfo = Memory.alloc(Process.pointerSize);

  let rc = 0;

  rc = SecStaticCodeCreateWithPath(url, kSecCSDefaultFlags, pCodeRef);
  if (rc !== 0)
    throw new Error(
      `SecStaticCodeCreateWithPath failed with error code: ${rc}`,
    );

  const codeRef = pCodeRef.readPointer();
  rc = SecCodeCopySigningInformation(
    codeRef,
    kSecCSSigningInformation | kSecCSRequirementInformation,
    pSignInfo,
  );

  if (rc !== 0)
    throw new Error(
      `SecCodeCopySigningInformation failed with error code: ${rc}`,
    );

  const signInfo = pSignInfo.readPointer();
  const dict = new ObjC.Object(signInfo).objectForKey_(
    kSecCodeInfoEntitlementsDict,
  );

  try {
    return CFRetain(dict);
  } finally {
    CFRelease(signInfo);
    CFRelease(codeRef);
  }
}

function fromPath(path?: string) {
  const url = path
    ? ObjC.classes.NSURL.fileURLWithPath_(path)
    : ObjC.classes.NSBundle.mainBundle().bundleURL();
  if (!url) throw new Error(`invalid file url ${path}`);
  return dictionary(url);
}

export function plist(path?: string) {
  const dict = fromPath(path);
  try {
    return dump(new ObjC.Object(dict));
  } finally {
    cf().CFRelease(dict);
  }
}

```

`agent/src/fruity/modules/fs.ts`:

```ts
import ObjC from "frida-objc-bridge";
import type {
  NSString,
  NSFileManager,
  NSDictionary,
} from "@/fruity/typings.js";

import { toJS } from "@/fruity/bridge/object.js";
import { dump } from "@/fruity/lib/plist.js";
import * as posix from "@/lib/posix.js";
import { readdirSync, lstatSync } from "fs";
import type { Roots } from "@/common/fs.js";

export interface Item {
  type: "file" | "directory" | "symlink";
  name: string;
  path: string;
  attribute: Attributes | null;
}

export interface Attributes {
  uid: number;
  owner: string;
  size: number;
  creation: number;
  permission: number;
  gid: number;
  type?: string;
  group: string;
  modification: number;
  protection: string;
}

function shared() {
  return ObjC.classes.NSFileManager.defaultManager() as NSFileManager;
}

function throwsError<Args extends unknown[], T>(
  fn: (pError: NativePointer, ...args: Args) => T,
  ...args: Args
): T {
  const pError = Memory.alloc(Process.pointerSize).writePointer(NULL);
  const result = fn(pError, ...args);
  const err = pError.readPointer();
  if (!err.isNull())
    throw new Error(new ObjC.Object(err).localizedDescription());
  return result;
}

export interface MetaData {
  name: string;
  dir: boolean;
  protection: string | null;
  size: number | null;
  alias: boolean;
  created: Date;
  symlink: boolean;
}

let cachedRoots: Roots | null = null;

export function roots(): Roots {
  if (!cachedRoots) {
    cachedRoots = {
      home: ObjC.classes.NSString.stringWithString_("~")
        .stringByExpandingTildeInPath()
        .toString() as string,
      bundle: ObjC.classes.NSBundle.mainBundle()
        .bundlePath()
        .toString() as string,
    };
  }
  return cachedRoots;
}

export interface DirectoryListing {
  cwd: string;
  writable: boolean;
  list: MetaData[];
}

// Note: we migrate from ObjC dictionaryWithContentsOfFile_ api to POSIX to
// mitigate a memory leak problem we do not have enough time to investigate.
// However, in this way we lost some metadata like NSFileProtectionType
//
// Right now we are not using the protection info, but this is useful for
// pentest purpose. Consider adding it back in the future.

export function ls(path: string): DirectoryListing {
  const names = readdirSync(path);
  const writable = posix.isWritable(path);
  const list: MetaData[] = [];

  for (const name of names) {
    if (name.startsWith(".")) continue;

    const fullPath = path + "/" + name;
    let size: number | null = null;
    let created = new Date(0);
    let protection: string | null = null;
    let isDir = false;
    let isSymlink = false;

    try {
      const stat = lstatSync(fullPath);
      isDir = stat.isDirectory();
      isSymlink = stat.isSymbolicLink();
      size = isDir ? null : stat.size.valueOf();
      created = stat.birthtime;
      protection = "0" + (stat.mode & 0o7777).toString(8);
    } catch {
      continue;
    }

    list.push({
      name,
      dir: isDir,
      protection,
      size,
      alias: false,
      created,
      symlink: isSymlink,
    });
  }

  return { cwd: path, writable, list };
}

export function rm(path: string) {
  return throwsError((pError, path) => {
    return shared().removeItemAtPath_error_(path, pError);
  }, path);
}

export function cp(src: string, dst: string) {
  return throwsError(
    (pError, src, dst) => {
      return shared().copyItemAtPath_toPath_error_(src, dst, pError);
    },
    src,
    dst,
  );
}

export function mv(src: string, dst: string) {
  return posix.rename(src, dst);
}

const NS_FILE_ATTR_KEYS = {
  NSFileCreationDate: ["created", new Date()],
  NSFileGroupOwnerAccountID: ["gid", 0],
  NSFileGroupOwnerAccountName: ["group", ""],
  NSFileOwnerAccountID: ["uid", 0],
  NSFileOwnerAccountName: ["owner", ""],
  NSFilePosixPermissions: ["perm", 0],
  NSFileProtectionKey: ["protection", ""],
  NSFileSize: ["size", 0],
  NSFileType: ["type", ""],
} as const;

type NsFileAttrs = typeof NS_FILE_ATTR_KEYS;
type FileAttributes = {
  -readonly [K in keyof NsFileAttrs as NsFileAttrs[K][0]]: NsFileAttrs[K][1] extends number
    ? number
    : NsFileAttrs[K][1] extends string
      ? string
      : NsFileAttrs[K][1];
};

export function attrs(path: string) {
  const foundation = Process.getModuleByName("Foundation");

  const attrs = throwsError(
    (pError, path) => shared().attributesOfItemAtPath_error_(path, pError),
    path,
  );

  const result: Record<string, unknown> = {};
  for (const [nsKey, [jsKey, placeholder]] of Object.entries(
    NS_FILE_ATTR_KEYS,
  ) as [keyof NsFileAttrs, NsFileAttrs[keyof NsFileAttrs]][]) {
    const k = new ObjC.Object(
      foundation.getExportByName(nsKey).readPointer(),
    ) as NSString;
    const value = attrs.objectForKey_(k);
    result[jsKey] = toJS(value);
  }

  return result as FileAttributes;
}

export function plist(path: string) {
  return dump(ObjC.classes.NSDictionary.dictionaryWithContentsOfFile_(path));
}

const NSUTF8StringEncoding = 4;

export function text(path: string) {
  const result = throwsError(
    (pError, path) =>
      ObjC.classes.NSString.stringWithContentsOfFile_encoding_error_(
        path,
        NSUTF8StringEncoding,
        pError,
      ),
    path,
  );
  if (!result) throw new Error(`Cannot read file: ${path}`);
  return result.toString() as string;
}

export function data(path: string) {
  const nsdata = ObjC.classes.NSData.dataWithContentsOfFile_(path);
  if (!nsdata) return null;
  const len = nsdata.length() as number;
  if (len === 0) return new ArrayBuffer(0);
  return nsdata.bytes().readByteArray(len);
}

export function preview(path: string) {
  const handle = ObjC.classes.NSFileHandle.fileHandleForReadingAtPath_(path);
  if (!handle) return null;
  try {
    const nsdata = handle.readDataOfLength_(1024 * 1024);
    const len = nsdata.length() as number;
    if (len === 0) return new ArrayBuffer(0);
    return nsdata.bytes().readByteArray(len);
  } finally {
    handle.closeFile();
  }
}

export function mkdirp(p: string) {
  return throwsError((pError, path) => {
    return shared().createDirectoryAtPath_withIntermediateDirectories_attributes_error_(
      path,
      true,
      null,
      pError,
    );
  }, p);
}

export function access(path: string): boolean {
  return posix.isWritable(path);
}

export function saveText(path: string, text: string) {
  const nsstr = ObjC.classes.NSString.stringWithString_(text) as NSString;
  return nsstr.writeToFile_atomically_encoding_error_(
    path,
    true,
    NSUTF8StringEncoding,
    NULL,
  ) as boolean;
}

```

`agent/src/fruity/modules/geolocation.ts`:

```ts
import ObjC from "frida-objc-bridge";

// if (Process.pointerSize !== 8)
//   throw new Error("This module only supports 64-bit");

const CLLocationDegrees: NativeFunctionReturnType = "double";
const CLLocationCoordinate2D: NativeFunctionReturnType = [
  CLLocationDegrees,
  CLLocationDegrees,
];

let listeners: InvocationListener[] = [];
const hooked: Set<string> = new Set();

export function fake(lat: number, lng: number) {
  const pError = Memory.alloc(Process.pointerSize);
  ObjC.classes.NSBundle.bundleWithPath_(
    "/System/Library/Frameworks/CoreLocation.framework",
  ).loadAndReturnError_(pError);
  const err = pError.readPointer();
  if (!err.isNull()) {
    const error = new ObjC.Object(err);
    throw new Error(error.localizedDescription());
  }

  const CoreLocation = Process.getModuleByName("CoreLocation");
  const CLLocationCoordinate2DMake = new NativeFunction(
    CoreLocation.getExportByName("CLLocationCoordinate2DMake"),
    CLLocationCoordinate2D,
    ["double", "double"],
  );

  dismiss();

  const methods = [
    "- startUpdatingLocation",
    "- startUpdatingHeading", // heading is unavailable on macOS
    "- requestLocation",
  ];

  function fakeWithOrigin(location: ObjC.Object) {
    if (location.handle.isNull()) return location;

    const fake = CLLocationCoordinate2DMake(lat, lng);
    const newLocation = ObjC.classes.CLLocation.alloc();
    newLocation[
      "- initWithCoordinate:" +
        "altitude:" +
        "horizontalAccuracy:" +
        "verticalAccuracy:" +
        "course:" +
        "speed:" +
        "timestamp:"
    ](
      fake,
      location.altitude(),
      location.horizontalAccuracy(),
      location.verticalAccuracy(),
      location.course(),
      location.speed(),
      location.timestamp(),
    );

    return newLocation.autorelease();
  }

  const callbacks: {
    [sel: string]: (this: InvocationContext, args: InvocationArguments) => void;
  } = {
    "- locationManager:didUpdateToLocation:fromLocation:": function (args) {
      console.log(
        "- locationManager:didUpdateToLocation:fromLocation:",
        new ObjC.Object(args[3]),
        new ObjC.Object(args[4]),
      );

      const to = new ObjC.Object(args[3]);
      const from = new ObjC.Object(args[4]);

      args[3] = fakeWithOrigin(to);
      args[4] = fakeWithOrigin(from);
    },
    "- locationManager:didUpdateLocations:": function (args) {
      const newArray = ObjC.classes.NSMutableArray.alloc().init();
      const array = new ObjC.Object(args[3]);
      const count = array.count().valueOf();
      for (var i = 0; i !== count; i++) {
        const location = array.objectAtIndex_(i);
        const newLocation = fakeWithOrigin(location);
        newArray.addObject_(newLocation);
      }
      args[3] = newArray.copy().autorelease();
      newArray.release();
    },
    "- locationManager:didUpdateHeading:": function (args) {
      console.log(
        "- locationManager:didUpdateHeading:",
        new ObjC.Object(args[3]),
      );
    },
  };

  function hookDelegate(delegate: ObjC.Object) {
    const className = delegate.$className;

    if (hooked.has(className)) return;
    const clazz = ObjC.classes[className];
    for (let sel in callbacks) {
      if (sel in clazz) {
        const l = Interceptor.attach(clazz[sel].implementation, {
          onEnter: callbacks[sel],
        });
        listeners.push(l);
      }
    }

    hooked.add(className);
  }

  const instances = ObjC.chooseSync(ObjC.classes.CLLocationManager);
  for (const mgr of instances) {
    hookDelegate(mgr.delegate());
    ObjC.schedule(ObjC.mainQueue, () => mgr.startUpdatingLocation());
  }

  for (const methodName of methods) {
    const method = ObjC.classes.CLLocationManager[
      methodName
    ] as ObjC.ObjectMethod;
    if (typeof method !== "function") continue;

    Interceptor.attach(method.implementation, {
      onEnter(args) {
        const delegate = new ObjC.Object(args[0]).delegate();
        hookDelegate(delegate);
      },
    });
  }
}

export function dismiss() {
  listeners.forEach((l) => l.detach());
  listeners = [];

  hooked.clear();
}

```

`agent/src/fruity/modules/info.ts`:

```ts
import ObjC from "frida-objc-bridge";
import type {
  NSDictionary,
  NSObject,
  StringLike,
  NSArray,
} from "@/fruity/typings.js";

import { toJsArray } from "@/fruity/bridge/object.js";
import { dump } from "@/fruity/lib/plist.js";

export interface URLScheme {
  name?: string;
  schemes?: string[];
  role?: string;
}

export interface BasicInfo {
  tmp: string;
  home: string;
  id: string;
  label: string;
  path: string;
  main: string;
  version: string;
  semVer: string;
  minOS: string;
}

function getLabel(info: NSDictionary<StringLike, NSObject>) {
  for (const key of ["CFBundleDisplayName", "CFBundleName"]) {
    const value = info.objectForKey_(key);
    if (value) return value.toString();
  }

  return (
    info.objectForKey_("CFBundleAlternateNames")?.firstObject()?.toString() ||
    "N/A"
  );
}

// collect URL schemes
interface RawURLScheme {
  CFBundleURLName: string;
  CFBundleURLSchemes: string[];
  CFBundleTypeRole: string;
}

function wrapURLScheme(raw: RawURLScheme): URLScheme {
  return {
    name: raw.CFBundleURLName,
    schemes: raw.CFBundleURLSchemes,
    role: raw.CFBundleTypeRole,
  };
}

export function basics(): BasicInfo {
  const main = ObjC.classes.NSBundle.mainBundle();
  const infoDict = main.infoDictionary() as NSDictionary<StringLike, NSObject>;

  // collect readable names
  const READABLE_NAME_MAPPING = {
    version: "CFBundleVersion",
    semVer: "CFBundleShortVersionString",
    minOS: "MinimumOSVersion",
  };

  type VersionInfoKeys = keyof typeof READABLE_NAME_MAPPING;
  type VersionInfoDict = Record<VersionInfoKeys, string>;

  const versions = Object.fromEntries(
    Object.entries(READABLE_NAME_MAPPING).map(([key, label]) => [
      key,
      infoDict.objectForKey_(label)?.toString() || "N/A",
    ]),
  ) as VersionInfoDict;

  return {
    tmp: Process.getTmpDir(),
    home: Process.getHomeDir(),
    label: getLabel(infoDict),
    id: main.bundleIdentifier().toString(),
    path: main.bundlePath().toString(),
    main: main.executablePath().toString(),
    ...versions,
  };
}

export function urls(): URLScheme[] {
  const infoDict =
    ObjC.classes.NSBundle.mainBundle().infoDictionary() as NSDictionary<
      StringLike,
      NSObject
    >;
  const urlTypes = infoDict.objectForKey_("CFBundleURLTypes") as NSArray<
    NSDictionary<StringLike, NSObject>
  >;
  const rawUrls: RawURLScheme[] = urlTypes ? toJsArray(urlTypes) : [];
  return rawUrls.map(wrapURLScheme);
}

export function plist() {
  return dump(ObjC.classes.NSBundle.mainBundle().infoDictionary());
}

export interface ProcessInfo {
  platform: string;
  arch: string;
  pointerSize: number;
  pageSize: number;
}

export function processInfo(): ProcessInfo {
  const { platform, arch, pointerSize, pageSize } = Process;
  return { platform, arch, pointerSize, pageSize };
}

```

`agent/src/fruity/modules/jsc.ts`:

```ts
import ObjC from "frida-objc-bridge";
import {
  NSObject,
  StringLike,
  NSArray,
  NSDictionary,
  NSString,
} from "@/fruity/typings.js";

import * as Dictionary from "@/fruity/bridge/object.js";
import { iterateNSArray } from "@/fruity/bridge/nsarray.js";
import { AliveTracker } from "@/fruity/lib/alive.js";

interface JSContext extends NSObject {
  evaluateScript_(script: StringLike): NSObject;
  objectForKeyedSubscript_(key: StringLike): NSObject;
}

let tracker: AliveTracker | null = null;

function getTracker(): AliveTracker {
  if (!tracker) {
    tracker = new AliveTracker(ObjC.classes.JSContext);
  }
  return tracker;
}

export function list() {
  const t = getTracker();
  const result = new Map<string, string>();
  for (const instance of ObjC.chooseSync(ObjC.classes.JSContext)) {
    const handle = instance.handle.toString();
    t.track(handle);
    result.set(handle, instance.toString());
  }
  return Object.fromEntries(result);
}

function get(handle: string): JSContext {
  return getTracker().get(handle) as JSContext;
}

type BridgedClass = {
  type: "class";
  clazz: string;
};

type BridgedInstance = {
  type: "instance";
  clazz: string;
  handle: string;
  methods: { [name: string]: string }; // name -> signature
  properties: { [name: string]: string }; // name -> signature
};

type BridgedArray = {
  type: "array";
  size: number;
};

type BridgedDict = {
  type: "dict";
  keys: string[];
  size: number;
};

type BridgedValue =
  | null
  | boolean
  | number
  | string
  | BridgedClass
  | BridgedInstance
  | BridgedArray
  | BridgedDict;

function serialize(obj: NSObject | null): BridgedValue {
  if (!obj) return null;
  if (obj.isKindOfClass_(ObjC.classes.__NSCFBoolean)) return obj.boolValue();
  if (obj.isKindOfClass_(ObjC.classes.NSNumber))
    return parseFloat(obj.toString());
  if (obj.isKindOfClass_(ObjC.classes.NSString)) return obj.toString();
  if (obj.isKindOfClass_(ObjC.classes.NSArray))
    return {
      type: "array",
      size: obj.count(),
    };

  if (obj.isKindOfClass_(ObjC.classes.NSDictionary))
    return {
      type: "dict",
      keys: [...Dictionary.keys(obj as NSDictionary<NSObject, NSObject>)].map(
        (k) => `${k}`,
      ),
      size: obj.count(),
    };

  if ("isa" in obj.$ivars) {
    const { methods, properties } = findJSExport(obj);
    return {
      type: "instance",
      clazz: obj.$className,
      handle: obj.handle.toString(),
      methods,
      properties,
    };
  }

  return {
    type: "class",
    clazz: obj.$className,
  };
}

function findJSExport(obj: ObjC.Object) {
  for (const prot of Object.values(obj.$protocols)) {
    if ("JSExport" in prot.protocols) {
      const { methods, properties } = prot;

      return {
        methods: Object.fromEntries(
          Object.entries(methods).map(([name, desc]) => [name, desc.types]),
        ),
        properties: Object.fromEntries(
          Object.entries(properties).map(([name, prop]) => [name, prop["T"]]),
        ),
      };
    }
  }

  throw new Error(`${obj} does not confirm to JSExport`);
}

export type BridgedBlock = {
  type: "block";
  handle: string;
  invoke: string;
};

export type JsFunction = {
  type: "function";
  source: string;
};

export type FunctionLikeDump = BridgedBlock | JsFunction;
export type DumpValue = BridgedValue | FunctionLikeDump;

export function dump(handle: string) {
  const jsc = get(handle);
  const topKeys = jsc
    .evaluateScript_("Object.keys(this)")
    .toArray() as NSArray<NSString>;
  const funcClass = jsc.evaluateScript_("Function");

  const result = new Map<string, DumpValue>();
  for (const key of iterateNSArray(topKeys)) {
    const val = jsc.objectForKeyedSubscript_(key as NSString);
    if (!val.isObject()) continue;
    const obj = val.toObject();
    if (val.isInstanceOf_(funcClass)) {
      if (obj.isKindOfClass_(ObjC.classes.NSBlock)) {
        const p = obj.handle.add(Process.pointerSize * 2).readPointer();
        const { moduleName, name } = DebugSymbol.fromAddress(p);
        const fallback = name ?? `0x${p.toString(16)}`;
        const invoke = moduleName ? `${moduleName}!${fallback}` : fallback;

        result.set(`${key}`, {
          type: "block",
          handle: `${obj.handle}`,
          invoke,
        });
      } else {
        result.set(`${key}`, {
          type: "function",
          source: val.toString(),
        });
      }

      if (val.toString().includes("[native code]")) {
        console.log(obj.$className);
      }

      continue;
    }
    result.set(`${key}`, serialize(obj));
    console.log(key, Dictionary.description(obj));
  }
  return Object.fromEntries(result);
}

export function run(handle: string, js: string) {
  const jsc = get(handle);
  const val = jsc.evaluateScript_(js);
  if (val.isUndefined() && jsc.exception()) return jsc.exception().toString();
  return val.toString();
}

```

`agent/src/fruity/modules/keychain.ts`:

```ts
import ObjC from "frida-objc-bridge";
import { toJS } from "@/fruity/bridge/object.js";
import getSecurityApi from "@/fruity/native/security.js";

function kSec(suffix: string) {
  return Process.getModuleByName("Security")
    .getExportByName(`kSec${suffix}`)
    .readPointer();
}

const kSecClasses = {
  id: kSec("ClassIdentity"),
  cert: kSec("ClassCertificate"),
  generic: kSec("ClassGenericPassword"),
  internet: kSec("ClassInternetPassword"),
};

function encodeData(val?: ObjC.Object) {
  if (val instanceof ObjC.Object && val.isKindOfClass_(ObjC.classes.NSData)) {
    return val.base64EncodedStringWithOptions_(0).toString();
  }
  return null;
}

function readableAccount(val?: ObjC.Object) {
  if (val instanceof ObjC.Object && val.isKindOfClass_(ObjC.classes.NSData)) {
    const str = ObjC.classes.NSString!.alloc().initWithData_encoding_(val, 4);
    if (str) return str.toString();
    return str;
  }
  return `${val}`;
}

export interface KeyChainItem {
  clazz?: string;
  creation?: Date;
  modification?: Date;
  description?: string;
  comment?: string;
  creator?: string;
  type?: string;
  scriptCode?: number;
  alias?: boolean;
  invisible?: boolean;
  negative?: boolean;
  customIcon?: boolean;
  entitlementGroup?: string;
  generic?: string;
  service?: string;
  account?: string;
  label?: string;
  data?: string;
  raw?: string;
  acl?: string;
  prot?: string;
}

const cf2str = (cf: NativePointer) => new ObjC.Object(cf).toString();
const enumLookup = (prefix: string) =>
  Object.fromEntries(
    Process.getModuleByName("Security")
      .enumerateExports()
      .filter((e) => e.name.startsWith(prefix))
      .map((e) => [cf2str(e.address.readPointer()), e.name]),
  );

function dumpACL(item: ObjC.Object) {
  const kAKSKeyOpAttest = "oa";
  const kAKSKeyOpDecrypt = "od";
  const kAKSKeyOpSign = "osgn";
  const kACMKeyAclConstraintPolicy = "cpol";
  const kACMPolicyDeviceOwnerAuthentication = "DeviceOwnerAuthentication";
  const kACMKeyAclConstraintUserPasscode = "cup";
  const kACMKeyAclConstraintWatch = "cwtch";
  const kACMKeyAclConstraintBio = "cbio";
  const kAKSKeyOpDefaultAcl = "dacl";
  const kACMKeyAclParamKofN = "pkofn";

  const {
    SecAccessControlGetRequirePassword,
    SecAccessControlGetConstraints,
    SecAccessControlGetConstraint,
  } = getSecurityApi();

  const access = item.objectForKey_(kSec("AttrAccessControl"));
  if (!access) return;

  function* gen() {
    if (SecAccessControlGetRequirePassword(access))
      yield "kSecAccessControlApplicationPassword";

    const constriants = SecAccessControlGetConstraints(access);
    if (constriants.isNull()) return;

    const dict = new ObjC.Object(constriants);

    const isPrivateKey = dict.objectForKey_(kAKSKeyOpAttest);
    if (isPrivateKey) {
      yield "kSecAccessControlPrivateKeyUsage";
    }

    let opDict = dict.objectForKey_(kAKSKeyOpDecrypt);
    if (isPrivateKey) {
      opDict = dict.objectForKey_(kAKSKeyOpSign);
    }

    if (!opDict || !opDict.isKindOfClass_(ObjC.classes.NSDictionary)) {
      opDict = dict; // top-level dictionary
    }

    const policy = opDict.objectForKey_(kACMKeyAclConstraintPolicy);
    if (policy) {
      if (policy.isEqualToString_(kACMPolicyDeviceOwnerAuthentication)) {
        yield "kSecAccessControlUserPresence";
      } else {
        yield "Policy: " + policy.toString();
      }
    }

    if (opDict.objectForKey_(kACMKeyAclConstraintUserPasscode)) {
      yield "kSecAccessControlDevicePasscode";
    }

    const cbio = opDict.objectForKey_(kACMKeyAclConstraintBio);
    if (cbio) {
      yield cbio.count().intValue() > 1
        ? "kSecAccessControlBiometryCurrentSet"
        : "kSecAccessControlBiometryAny";
    }

    if (opDict.objectForKey_(kACMKeyAclConstraintWatch)) {
      yield "kSecAccessControlCompanion";
    }

    const pkofn = opDict.objectForKey_(kACMKeyAclParamKofN);
    if (pkofn) {
      yield pkofn.intValue() === 1
        ? "kSecAccessControlOr"
        : "kSecAccessControlAnd";
    }
  }

  const list = [...gen()];
  if (
    !list.length &&
    SecAccessControlGetConstraint(
      access,
      ObjC.classes.NSString!.stringWithString_(kAKSKeyOpDefaultAcl),
    )
  ) {
    return "default";
  }

  return list.join(" | ");
}

export function remove(service: string, account: string) {
  const query = ObjC.classes.NSMutableDictionary!.alloc().init();
  query.setObject_forKey_(kSec("Class"), kSec("kSecClassGenericPassword"));
  query.setObject_forKey_(kSec("AttrService"), service);
  query.setObject_forKey_(kSec("AttrAccount"), account);
  const status = getSecurityApi().SecItemDelete(query);

  const errSecItemNotFound = -25300;
  if (status === errSecItemNotFound) throw new Error("errSecItemNotFound");
  if (status !== 0)
    throw new Error(`SecItemDelete returned non zero result ${status}`);
}

export function list(withBiometricId = false): KeyChainItem[] {
  const { SecItemCopyMatching, SecAccessControlGetProtection } =
    getSecurityApi();

  const kSecAttrAccessibleLookup = enumLookup("kSecAttrAccessible");

  const result: KeyChainItem[] = [];
  const kCFBooleanTrue = ObjC.classes.__NSCFBoolean!.numberWithBool_(true);
  const query = ObjC.classes.NSMutableDictionary!.alloc().init();
  query.setObject_forKey_(kCFBooleanTrue, kSec("ReturnAttributes"));
  query.setObject_forKey_(kCFBooleanTrue, kSec("ReturnData"));
  query.setObject_forKey_(kCFBooleanTrue, kSec("ReturnRef"));
  query.setObject_forKey_(kSec("MatchLimitAll"), kSec("MatchLimit"));

  if (!withBiometricId) {
    query.setObject_forKey_(
      kSec("UseAuthenticationUIFail"),
      kSec("UseAuthenticationUI"),
    );
  }

  const KEY_MAPPING = {
    creation: kSec("AttrCreationDate"),
    modification: kSec("AttrModificationDate"),
    description: kSec("AttrDescription"),
    comment: kSec("AttrComment"),
    creator: kSec("AttrCreator"),
    type: kSec("AttrType"),
    scriptCode: kSec("AttrScriptCode"),
    alias: kSec("AttrAlias"),
    invisible: kSec("AttrIsInvisible"),
    negative: kSec("AttrIsNegative"),
    customIcon: kSec("AttrHasCustomIcon"),
    entitlementGroup: kSec("AttrAccessGroup"),
    generic: kSec("AttrGeneric"),
    service: kSec("AttrService"),
    account: kSec("AttrAccount"),
    label: kSec("AttrLabel"),
  };

  for (const [className, clazz] of Object.entries(kSecClasses)) {
    query.setObject_forKey_(clazz, kSec("Class"));

    const p = Memory.alloc(Process.pointerSize);
    const status = SecItemCopyMatching(query, p);
    if (status !== 0) continue;

    const arr = new ObjC.Object(p.readPointer());
    for (let i = 0, size = arr.count(); i < size; i++) {
      const item = arr.objectAtIndex_(i);
      const readable: KeyChainItem = {
        clazz: className,
        acl: dumpACL(item),
      };

      const access = item.objectForKey_(kSec("AttrAccessControl"));
      const prot = SecAccessControlGetProtection(access);
      readable.prot = kSecAttrAccessibleLookup[cf2str(prot)];

      for (const [key, attr] of Object.entries(KEY_MAPPING) as Array<
        [keyof KeyChainItem, NativePointer]
      >) {
        const v = item.objectForKey_(attr);
        if (v) {
          (readable as Partial<Record<keyof KeyChainItem, unknown>>)[key] =
            v.isKindOfClass_(ObjC.classes.NSData) ? v.toString() : toJS(v);
        }
      }

      const valueData = item.objectForKey_(kSec("ValueData"));
      readable.data = valueData.toString();
      readable.account = readableAccount(
        item.objectForKey_(kSec("AttrAccount")),
      );
      readable.raw = encodeData(valueData);
      result.push(readable);
    }
  }

  return result;
}

```

`agent/src/fruity/modules/lsof.ts`:

```ts
// at this moment it does not work
// import c from "./lsof.c" with { type: "text" };

// long long ago I had one lame implementation..
// https://github.com/chaitin/passionfruit/blob/e9b736f381afbfd1470855856b52b63af5de6742/agent/Tweak.xm
//
// this is based on @miticollo's gist
// https://gist.github.com/miticollo/aa27be66fd6c12fddd9079fa4f1967bf

const c = `
#include <glib.h> /* required to use (u)int16_t, (u)int32_t, (u)int64_t */

/* defined in
  * https://raw.githubusercontent.com/apple-oss-distributions/xnu/main/bsd/arm/_types.h
  */
typedef unsigned char __uint8_t;
typedef unsigned short __uint16_t;
typedef unsigned int __uint32_t;
typedef __uint32_t __darwin_uid_t; /* [???] user IDs */
typedef __uint32_t __darwin_gid_t; /* [???] process and group IDs */
typedef long long __int64_t;
typedef __int64_t __darwin_off_t;      /* [???] Used for file sizes */
typedef __uint32_t __darwin_socklen_t; /* socklen_t (duh) */

/* defined in
  * https://raw.githubusercontent.com/apple-oss-distributions/xnu/main/bsd/sys/_types/_uid_t.h
  */
typedef __darwin_uid_t uid_t;
/* defined in
  * https://raw.githubusercontent.com/apple-oss-distributions/xnu/main/bsd/sys/_types/_gid_t.h
  */
typedef __darwin_gid_t gid_t;
/* defined in
  * https://raw.githubusercontent.com/apple-oss-distributions/xnu/main/bsd/sys/_types/_off_t.h
  */
typedef __darwin_off_t off_t;
/* defined in
  * https://raw.githubusercontent.com/apple-oss-distributions/xnu/main/bsd/sys/_types/_u_short.h
  */
typedef unsigned short u_short;
/* defined in
  * https://raw.githubusercontent.com/apple-oss-distributions/xnu/main/bsd/sys/_types/_u_int32_t.h
  */
typedef unsigned int u_int32_t;
/* defined in
  * https://raw.githubusercontent.com/apple-oss-distributions/xnu/main/bsd/sys/_types/_fsid_t.h
  */
typedef struct fsid {
  int32_t val[2];
} fsid_t; /* file system id type */
/* defined in
  * https://raw.githubusercontent.com/apple-oss-distributions/xnu/main/bsd/sys/_types/_u_char.h
  */
typedef unsigned char u_char;
/* defined in
  * https://raw.githubusercontent.com/apple-oss-distributions/xnu/main/bsd/sys/_types/_sa_family_t.h
  */
typedef __uint8_t sa_family_t;
/* defined in
  * https://raw.githubusercontent.com/apple-oss-distributions/xnu/main/bsd/sys/_types/_socklen_t.h
  */
typedef __darwin_socklen_t socklen_t;

/* defined in
  * https://raw.githubusercontent.com/apple-oss-distributions/xnu/main/bsd/sys/syslimits.h
  */
#define PATH_MAX 1024 /* max bytes in pathname */

/* defined in
  * https://raw.githubusercontent.com/apple-oss-distributions/xnu/main/bsd/sys/param.h
  */
/*
  * MAXPATHLEN defines the longest permissable path length after expanding
  * symbolic links. It is used to allocate a temporary buffer from the buffer
  * pool in which to do the name expansion, hence should be a power of two,
  * and must be less than or equal to MAXBSIZE.
  */
#define MAXPATHLEN PATH_MAX

/* defined in
  * https://raw.githubusercontent.com/apple-oss-distributions/xnu/main/bsd/sys/_types/_in_addr_t.h
  */
typedef __uint32_t in_addr_t; /* base type for internet address */

#if (G_BYTE_ORDER == G_LITTLE_ENDIAN)
  #define ntohs(x) ((((x) & 0x00FF) << 8) | (((x) & 0xFF00) >> 8))
#else
  #define ntohs(x) (x)
#endif

/*
  * Internet address (a structure for historical reasons)
  */
struct in_addr {
  in_addr_t s_addr;
};

/* defined in
  * https://raw.githubusercontent.com/apple-oss-distributions/xnu/main/bsd/netinet6/in6.h
  */
#define INET6_ADDRSTRLEN 46
/*
  * IPv6 address
  */
typedef struct in6_addr {
  union {
    __uint8_t __u6_addr8[16];
    __uint16_t __u6_addr16[8];
    __uint32_t __u6_addr32[4];
  } __u6_addr; /* 128-bit IP6 address */
} in6_addr_t;

/* defined in
  * https://raw.githubusercontent.com/apple-oss-distributions/xnu/main/bsd/sys/proc_info.h
  */
/*
  * A copy of stat64 with static sized fields.
  */
struct vinfo_stat {
  uint32_t vst_dev;          /* [XSI] ID of device containing file */
  uint16_t vst_mode;         /* [XSI] Mode of file (see below) */
  uint16_t vst_nlink;        /* [XSI] Number of hard links */
  uint64_t vst_ino;          /* [XSI] File serial number */
  uid_t vst_uid;             /* [XSI] User ID of the file */
  gid_t vst_gid;             /* [XSI] Group ID of the file */
  int64_t vst_atime;         /* [XSI] Time of last access */
  int64_t vst_atimensec;     /* nsec of last access */
  int64_t vst_mtime;         /* [XSI] Last data modification time */
  int64_t vst_mtimensec;     /* last data modification nsec */
  int64_t vst_ctime;         /* [XSI] Time of last status change */
  int64_t vst_ctimensec;     /* nsec of last status change */
  int64_t vst_birthtime;     /*  File creation time(birth)  */
  int64_t vst_birthtimensec; /* nsec of File creation time */
  off_t vst_size;            /* [XSI] file size, in bytes */
  int64_t vst_blocks;        /* [XSI] blocks allocated for file */
  int32_t vst_blksize;       /* [XSI] optimal blocksize for I/O */
  uint32_t vst_flags;        /* user defined flags for file */
  uint32_t vst_gen;          /* file generation number */
  uint32_t vst_rdev;         /* [XSI] Device ID */
  int64_t vst_qspare[2];     /* RESERVED: DO NOT USE! */
};

struct vnode_info {
  struct vinfo_stat vi_stat;
  int vi_type;
  int vi_pad;
  fsid_t vi_fsid;
};

struct proc_fdinfo {
  int32_t proc_fd;
  uint32_t proc_fdtype;
};

struct vnode_info_path {
  struct vnode_info vip_vi;
  char vip_path[MAXPATHLEN]; /* tail end of it  */
};

struct proc_fileinfo {
  uint32_t fi_openflags;
  uint32_t fi_status;
  off_t fi_offset;
  int32_t fi_type;
  uint32_t fi_guardflags;
};

struct vnode_fdinfo {
  struct proc_fileinfo pfi;
  struct vnode_info pvi;
};

struct vnode_fdinfowithpath {
  struct proc_fileinfo pfi;
  struct vnode_info_path pvip;
};

struct in4in6_addr {
  u_int32_t i46a_pad32[3];
  struct in_addr i46a_addr4;
};

struct in_sockinfo {
  int insi_fport;       /* foreign port */
  int insi_lport;       /* local port */
  uint64_t insi_gencnt; /* generation count of this instance */
  uint32_t insi_flags;  /* generic IP/datagram flags */
  uint32_t insi_flow;

  uint8_t insi_vflag;  /* ini_IPV4 or ini_IPV6 */
  uint8_t insi_ip_ttl; /* time to live proto */
  uint32_t rfu_1;      /* reserved */
  /* protocol dependent part */
  union {
    struct in4in6_addr ina_46;
    struct in6_addr ina_6;
  } insi_faddr; /* foreign host table entry */
  union {
    struct in4in6_addr ina_46;
    struct in6_addr ina_6;
  } insi_laddr; /* local host table entry */
  struct {
    u_char in4_tos; /* type of service */
  } insi_v4;
  struct {
    uint8_t in6_hlim;
    int in6_cksum;
    u_short in6_ifindex;
    short in6_hops;
  } insi_v6;
};

/*
  * TCP Sockets
  */

#define TSI_T_NTIMERS 4

struct tcp_sockinfo {
  struct in_sockinfo tcpsi_ini;
  int tcpsi_state;
  int tcpsi_timer[TSI_T_NTIMERS];
  int tcpsi_mss;
  uint32_t tcpsi_flags;
  uint32_t rfu_1;    /* reserved */
  uint64_t tcpsi_tp; /* opaque handle of TCP protocol control block */
};

/* defined in
  * https://raw.githubusercontent.com/apple-oss-distributions/xnu/main/bsd/sys/un.h
  */
/*
  * [XSI] Definitions for UNIX IPC domain.
  */
struct sockaddr_un {
  unsigned char sun_len;  /* sockaddr len including null */
  sa_family_t sun_family; /* [XSI] AF_UNIX */
  char sun_path[104];     /* [XSI] path name (gag) */
};

/* defined in
  * https://raw.githubusercontent.com/apple-oss-distributions/xnu/main/bsd/sys/socket.h
  */
#define AF_UNIX 1           /* local to host (pipes) */
#define AF_INET 2           /* internetwork: UDP, TCP, etc. */
#define AF_INET6 30         /* IPv6 */
#define SOCK_MAXADDRLEN 255 /* longest possible addresses */

/*
  * Unix Domain Sockets
  */

struct un_sockinfo {
  uint64_t unsi_conn_so; /* opaque handle of connected socket */
  uint64_t
      unsi_conn_pcb; /* opaque handle of connected protocol control block */
  union {
    struct sockaddr_un ua_sun;
    char ua_dummy[SOCK_MAXADDRLEN];
  } unsi_addr; /* bound address */
  union {
    struct sockaddr_un ua_sun;
    char ua_dummy[SOCK_MAXADDRLEN];
  } unsi_caddr; /* address of socket connected to */
};

/* defined in
  * https://raw.githubusercontent.com/apple-oss-distributions/xnu/main/bsd/net/if.h
  */
#define IF_NAMESIZE 16

/*
  * PF_NDRV Sockets
  */
struct ndrv_info {
  uint32_t ndrvsi_if_family;
  uint32_t ndrvsi_if_unit;
  char ndrvsi_if_name[IF_NAMESIZE];
};

/*
  * Kernel Event Sockets
  */
struct kern_event_info {
  uint32_t kesi_vendor_code_filter;
  uint32_t kesi_class_filter;
  uint32_t kesi_subclass_filter;
};

/* defined in
  * https://raw.githubusercontent.com/apple-oss-distributions/xnu/main/bsd/sys/kern_control.h
  */
/*!
  *       @defined MAX_KCTL_NAME
  *   @discussion Kernel control names must be no longer than
  *       MAX_KCTL_NAME.
  */
#define MAX_KCTL_NAME 96

/*
  * Kernel Control Sockets
  */
struct kern_ctl_info {
  uint32_t kcsi_id;
  uint32_t kcsi_reg_unit;
  uint32_t kcsi_flags;       /* support flags */
  uint32_t kcsi_recvbufsize; /* request more than the default buffer size */
  uint32_t kcsi_sendbufsize; /* request more than the default buffer size */
  uint32_t kcsi_unit;
  char kcsi_name[MAX_KCTL_NAME]; /* unique nke identifier, provided by DTS */
};

/*
  * VSock Sockets
  */
struct vsock_sockinfo {
  uint32_t local_cid;
  uint32_t local_port;
  uint32_t remote_cid;
  uint32_t remote_port;
};

struct sockbuf_info {
  uint32_t sbi_cc;
  uint32_t sbi_hiwat; /* SO_RCVBUF, SO_SNDBUF */
  uint32_t sbi_mbcnt;
  uint32_t sbi_mbmax;
  uint32_t sbi_lowat;
  short sbi_flags;
  short sbi_timeo;
};

enum {
  SOCKINFO_IN = 1,
  SOCKINFO_TCP = 2,
};

struct socket_info {
  struct vinfo_stat soi_stat;
  uint64_t soi_so;  /* opaque handle of socket */
  uint64_t soi_pcb; /* opaque handle of protocol control block */
  int soi_type;
  int soi_protocol;
  int soi_family;
  short soi_options;
  short soi_linger;
  short soi_state;
  short soi_qlen;
  short soi_incqlen;
  short soi_qlimit;
  short soi_timeo;
  u_short soi_error;
  uint32_t soi_oobmark;
  struct sockbuf_info soi_rcv;
  struct sockbuf_info soi_snd;
  int soi_kind;
  uint32_t rfu_1; /* reserved */
  union {
    struct in_sockinfo pri_in;             /* SOCKINFO_IN */
    struct tcp_sockinfo pri_tcp;           /* SOCKINFO_TCP */
    struct un_sockinfo pri_un;             /* SOCKINFO_UN */
    struct ndrv_info pri_ndrv;             /* SOCKINFO_NDRV */
    struct kern_event_info pri_kern_event; /* SOCKINFO_KERN_EVENT */
    struct kern_ctl_info pri_kern_ctl;     /* SOCKINFO_KERN_CTL */
    struct vsock_sockinfo pri_vsock;       /* SOCKINFO_VSOCK */
  } soi_proto;
};

struct socket_fdinfo {
  struct proc_fileinfo pfi;
  struct socket_info psi;
};

/* defns of process file desc type */
#define PROX_FDTYPE_VNODE 1
#define PROX_FDTYPE_SOCKET 2
#define PROX_FDTYPE_KQUEUE 5
#define PROX_FDTYPE_PIPE 6
#define PROX_FDTYPE_NETPOLICY 9
#define PROX_FDTYPE_CHANNEL 10

/* Flavors for proc_pidinfo() */
#define PROC_PIDLISTFDS 1
#define PROC_PIDLISTFD_SIZE (sizeof(struct proc_fdinfo))

/* Flavors for proc_pidfdinfo */

#define PROC_PIDFDVNODEPATHINFO 2
#define PROC_PIDFDVNODEPATHINFO_SIZE (sizeof(struct vnode_fdinfowithpath))

#define PROC_PIDFDSOCKETINFO 3
#define PROC_PIDFDSOCKETINFO_SIZE (sizeof(struct socket_fdinfo))

/* https://developer.apple.com/library/archive/documentation/System/Conceptual/ManPages_iPhoneOS/man3/getservbyport.3.html#//apple_ref/doc/man/3/getservbyport
  */
struct servent {
  char *s_name;     /* official name of service */
  char **s_aliases; /* alias list */
  int s_port;       /* port service resides at */
  char *s_proto;    /* protocol to use */
};

/* https://raw.githubusercontent.com/apple-oss-distributions/xnu/main/libsyscall/wrappers/libproc/libproc.h
  */
extern int proc_pidinfo(int pid, int flavor, uint64_t arg, void *buffer,
                        int buffersize);
extern int proc_pidfdinfo(int pid, int fd, int flavor, void *buffer,
                          int buffersize);

/* other functions */
extern int getpid();
extern void *malloc(size_t);
extern int snprintf(char *, size_t, const char *, ...);
extern const char *inet_ntop(int, const void *, char *,
                              socklen_t); /* in libkern*/
extern struct servent *getservbyport(int, const char *);

/* my functions */
extern void push_vnode(int32_t, char *);
extern void push_socket(int32_t, char *, char *, int, char *, char *, int,
                        char *);
extern void push_pipe(int32_t);
extern void push_channel(int32_t);
extern void error(char *);

void fds(void) {
  // Figure out the size of the buffer needed to hold the list of open FDs
  int bufferSize = proc_pidinfo(getpid(), PROC_PIDLISTFDS, 0, NULL, 0);
  if (bufferSize == 0)
    error("Unable to get open file handles");

  // Get the list of open FDs
  struct proc_fdinfo *procFDInfo = (struct proc_fdinfo *)malloc(bufferSize);
  if (!procFDInfo)
    error("Out of memory. Unable to allocate buffer with %d bytes");
  /* https://github.com/palominolabs/get_process_handles/issues/1#issue-314083604
    */
  /* http://disq.us/p/dvodv4 */
  int returnedSize =
      proc_pidinfo(getpid(), PROC_PIDLISTFDS, 0, procFDInfo, bufferSize);
  int numberOfProcFDs = returnedSize / PROC_PIDLISTFD_SIZE;

  for (int i = 0; i < numberOfProcFDs; i++) {
    struct proc_fdinfo *finfo = &procFDInfo[i];
    switch (finfo->proc_fdtype) {
    case PROX_FDTYPE_VNODE: {
      // A file is open
      struct vnode_fdinfowithpath vnodeInfo;
      int bytesUsed =
          proc_pidfdinfo(getpid(), finfo->proc_fd, PROC_PIDFDVNODEPATHINFO,
                          &vnodeInfo, PROC_PIDFDVNODEPATHINFO_SIZE);
      if (bytesUsed == PROC_PIDFDVNODEPATHINFO_SIZE)
        push_vnode(finfo->proc_fd, vnodeInfo.pvip.vip_path);
      break;
    }
    case PROX_FDTYPE_SOCKET: {
      // A socket is open
      struct socket_fdinfo socketInfo;
      int bytesUsed =
          proc_pidfdinfo(getpid(), finfo->proc_fd, PROC_PIDFDSOCKETINFO,
                          &socketInfo, PROC_PIDFDSOCKETINFO_SIZE);
      if (bytesUsed == PROC_PIDFDSOCKETINFO_SIZE) {
        switch (socketInfo.psi.soi_kind) {
        case SOCKINFO_TCP:  // Type: TCP
        case SOCKINFO_IN: { // Type: UDP
          int family, lport, rport;
          char lip[INET6_ADDRSTRLEN], rip[INET6_ADDRSTRLEN];
          struct in_sockinfo *s;

          family = socketInfo.psi.soi_family;

          s = socketInfo.psi.soi_kind == SOCKINFO_TCP
                  ? &socketInfo.psi.soi_proto.pri_tcp.tcpsi_ini
                  : &socketInfo.psi.soi_proto.pri_in;
          if ((family == AF_INET) || (family == AF_INET6)) {
            if (family == AF_INET) {
              inet_ntop(AF_INET, &s->insi_laddr.ina_46.i46a_addr4, lip,
                        sizeof(lip));
              inet_ntop(AF_INET, &s->insi_faddr.ina_46.i46a_addr4, rip,
                        sizeof(rip));
            } else {
              inet_ntop(AF_INET6, &s->insi_laddr.ina_6, lip, sizeof(lip));
              inet_ntop(AF_INET6, &s->insi_faddr.ina_6, rip, sizeof(rip));
            }

            struct servent any = {"*"}; // \u2731
            struct servent *lsp = 0, *fsp = 0;
            lport = ntohs(s->insi_lport);
            rport = ntohs(s->insi_fport);
            lsp = lport ? getservbyport(lport, 0) : &any;
            fsp = rport ? getservbyport(rport, 0) : &any;

            char *protocol;
            if (family == AF_INET6) {
              protocol =
                  (socketInfo.psi.soi_kind == SOCKINFO_TCP) ? "TCP6" : "UDP6";
            } else {
              protocol =
                  (socketInfo.psi.soi_kind == SOCKINFO_TCP) ? "TCP" : "UDP";
            }

            char *lsp_name =
                (lsp) ? lsp->s_name : "Unknown (local) service name";
            char *fsp_name =
                (fsp) ? fsp->s_name : "Unknown (remote) service name";
            push_socket(finfo->proc_fd, protocol, lip, lport, lsp_name, rip,
                        rport, fsp_name);
          } else if (family == AF_UNIX) {
          }
        }
        }
      }
      break;
    }
    case PROX_FDTYPE_PIPE: {
      push_pipe(finfo->proc_fd);
      break;
    }
    case PROX_FDTYPE_KQUEUE: {
      // TODO: missing body
      break;
    }
    case PROX_FDTYPE_NETPOLICY: {
      // TODO: missing body
      break;
    }
    case PROX_FDTYPE_CHANNEL: {
      push_channel(finfo->proc_fd);
      break;
    }
    default: {
      char str[100];
      snprintf(str, sizeof(str), "Unknown process file desc type: %d!",
                finfo->proc_fdtype);
      error(str);
      break;
    }
    }
  }
}

`;

export const enum ProcFDType {
  VNODE = "vnode",
  SOCKET = "socket",
  PIPE = "pipe",
  KQUEUE = "kqueue",
  CHANNEL = "channel",
}

export interface VnodeFD {
  fd: number;
  path: string;
  type: ProcFDType.VNODE;
}

export interface SocketFD {
  fd: number;
  protocol: string;
  lip: string;
  lport: number;
  lsp: string;
  rip: string;
  rport: number;
  fsp: string;
  type: ProcFDType.SOCKET;
}

export interface PipeFD {
  fd: number;
  type: ProcFDType.PIPE;
}

export interface ChannelFD {
  fd: number;
  type: ProcFDType.CHANNEL;
}

export type FileDescriptor = VnodeFD | SocketFD | PipeFD | ChannelFD;

const libsystem = Module.load("/usr/lib/libSystem.B.dylib");

export function fds() {
  const fds: FileDescriptor[] = [];

  const push_vnode = new NativeCallback(
    (fd: number, path: NativePointer) => {
      fds.push({
        fd,
        path: path.readUtf8String()!,
        type: ProcFDType.VNODE,
      });
    },
    "void",
    ["int32", "pointer"], // TODO: more details?
  );

  const push_socket = new NativeCallback(
    function (
      fd: number,
      protocol: NativePointer,
      lip: NativePointer,
      lport: number,
      lsp: NativePointer,
      rip: NativePointer,
      rport: number,
      fsp: NativePointer,
    ): void {
      fds.push({
        fd: fd,
        protocol: protocol.readUtf8String()!,
        lip: lip.readUtf8String()!,
        lport,
        lsp: lsp.readUtf8String()!,
        rip: rip.readUtf8String()!,
        // Remote port will be 0 when the FD represents a listening socket
        rport,
        fsp: fsp.readUtf8String()!,
        type: ProcFDType.SOCKET,
      });
    },
    "void",
    [
      "int32",
      "pointer",
      "pointer",
      "int",
      "pointer",
      "pointer",
      "int",
      "pointer",
    ],
  );

  const push_pipe = new NativeCallback(
    (fd: number) => {
      fds.push({ fd, type: ProcFDType.PIPE });
    },
    "void",
    ["int32"],
  );

  const push_channel = new NativeCallback(
    (fd: number) => {
      fds.push({ fd, type: ProcFDType.CHANNEL });
    },
    "void",
    ["int32"],
  );

  const error = new NativeCallback(
    function (msg: NativePointer): void {
      throw new Error(msg.readUtf8String()!);
    },
    "void",
    ["pointer"],
  );

  const cm: CModule = new CModule(c, {
    proc_pidinfo: libsystem.getExportByName("proc_pidinfo"),
    proc_pidfdinfo: libsystem.getExportByName("proc_pidfdinfo"),
    getpid: libsystem.getExportByName("getpid"),
    malloc: libsystem.getExportByName("malloc"),
    snprintf: libsystem.getExportByName("snprintf"),
    inet_ntop: libsystem.getExportByName("inet_ntop"),
    getservbyport: libsystem.getExportByName("getservbyport"),
    push_vnode,
    push_socket,
    push_pipe,
    push_channel,
    error,
  });

  new NativeFunction(cm.fds, "void", [])();
  return fds;
}

```

`agent/src/fruity/modules/plugins.ts`:

```ts
import ObjC from "frida-objc-bridge";

export interface PluginInfo {
  identifier: string;
  extensionPoint: string;
  displayName: string;
  version: string;
  path: string;
  uuid: string;
}

export function list(): PluginInfo[] {
  const workspace = ObjC.classes.LSApplicationWorkspace.defaultWorkspace();
  const allPlugins = workspace.installedPlugins();
  const mainBundleId = ObjC.classes.NSBundle.mainBundle()
    .bundleIdentifier()
    .toString();

  const result: PluginInfo[] = [];
  const count = allPlugins.count();

  for (let i = 0; i < count; i++) {
    const plugin = allPlugins.objectAtIndex_(i);
    const containingBundle = plugin.containingBundle();
    if (!containingBundle) continue;

    const containingBundleId = containingBundle.bundleIdentifier()?.toString();
    if (containingBundleId !== mainBundleId) continue;

    result.push({
      identifier: plugin.pluginIdentifier?.()?.toString() ?? "N/A",
      extensionPoint: plugin.protocol?.()?.toString() ?? "N/A",
      displayName: plugin.localizedName?.()?.toString() ?? "N/A",
      version: containingBundle
        .shortVersionString?.()
        ?.toString() ?? "N/A",
      path: plugin.bundleURL?.()?.path?.()?.toString() ?? "N/A",
      uuid: plugin.pluginUUID?.()?.UUIDString?.()?.toString() ?? "N/A",
    });
  }

  return result;
}

```

`agent/src/fruity/modules/rn.ts`:

```ts
import ObjC from "frida-objc-bridge";
import {
  type RNArch,
  type RNInstance,
  sendHermesByteCode,
  createCallbackContext,
} from "@/common/hermes.js";
import { unlink } from "@/lib/posix.js";
import { NSData, NSURL } from "../typings.js";

const CLASS_NAMES: Record<RNArch, string> = {
  legacy: "RCTCxxBridge",
  bridgeless: "RCTInstance",
};

const interceptors: InvocationListener[] = [];
const cb = createCallbackContext();
let injecting = false;

function attachBundle(
  method: ObjC.ObjectMethod | undefined,
  callbacks: InvocationListenerCallbacks,
) {
  if (!method) return;
  interceptors.push(Interceptor.attach(method.implementation, callbacks));
}

function hookBundleLoader() {
  const { RCTJavaScriptLoader } = ObjC.classes;
  if (!RCTJavaScriptLoader) return;

  attachBundle(
    RCTJavaScriptLoader[
      "+ attemptSynchronousLoadOfBundleAtURL:sourceLength:error:"
    ],
    {
      onEnter(args) {
        if (args[2].isNull()) return;
        this.url = new ObjC.Object(args[2]).toString();
      },
      onLeave(retval) {
        if (retval.isNull() || injecting) return;
        const data = new ObjC.Object(retval) as NSData;
        const len = data.length();
        if (len)
          sendHermesByteCode(this.url, ArrayBuffer.wrap(data.bytes(), len));
      },
    },
  );
}

function hookLegacyBundleExec() {
  const { RCTCxxBridge } = ObjC.classes;
  if (!RCTCxxBridge) return;

  attachBundle(RCTCxxBridge["- executeSourceCode:withSourceURL:sync:"], {
    onEnter(args) {
      if (args[2].isNull() || args[3].isNull() || injecting) return;
      const data = new ObjC.Object(args[2]) as NSData;
      const url = new ObjC.Object(args[3]) as NSURL;
      const len = data.length();
      if (len)
        sendHermesByteCode(url.toString(), ArrayBuffer.wrap(data.bytes(), len));
    },
  });

  attachBundle(RCTCxxBridge["- executeApplicationScript:url:async:"], {
    onEnter(args) {
      if (injecting) return;
      const nsData = new ObjC.Object(args[2]);
      const url = new ObjC.Object(args[3]);
      const len = nsData.length() as number;
      if (len > 0) {
        sendHermesByteCode(
          url.toString(),
          ArrayBuffer.wrap(nsData.bytes(), len),
        );
      }
    },
  });
}

function ensureCallbackHook() {
  const { RCTAlertManager } = ObjC.classes;
  const method = RCTAlertManager["- alertWithArgs:callback:"];
  const original = method.implementation;
  method.implementation = ObjC.implement(
    method,
    function (
      handle: NativePointer,
      selector: NativePointer,
      args: NativePointer,
      callback: NativePointer,
    ) {
      const message = new ObjC.Object(args.readPointer())
        .objectForKey_("message")
        .toString();
      console.debug(`React Native alert(${message})`);
      if (cb.parseCallback(message)) return;
      return original(handle, selector, args, callback);
    },
  );
  console.log('replaced RCTAlertManager["- alertWithArgs:callback:"]');
}

export function arch() {
  return {
    legacy: CLASS_NAMES.legacy in ObjC.classes,
    bridgeless: CLASS_NAMES.bridgeless in ObjC.classes,
  };
}

export function list(): RNInstance[] {
  const results: RNInstance[] = [];
  for (const [arch, className] of Object.entries(CLASS_NAMES) as [
    RNArch,
    string,
  ][]) {
    const cls = ObjC.classes[className];
    if (!cls) continue;
    ObjC.choose(cls, {
      onMatch(instance) {
        results.push({ className, arch, handle: instance.handle.toString() });
      },
      onComplete() {},
    });
  }
  return results;
}

export function inject(
  handle: string,
  arch: RNArch,
  script: string,
): Promise<string> {
  return new Promise((resolve, reject) => {
    const className = CLASS_NAMES[arch];
    const cls = ObjC.classes[className];
    if (!cls) {
      reject(new Error("Class not found: " + className));
      return;
    }

    let found: ObjC.Object | null = null;
    ObjC.choose(cls, {
      onMatch(instance) {
        if (instance.handle.toString() === handle) {
          found = instance;
          return "stop" as const;
        }
      },
      onComplete() {},
    });

    if (!found) {
      reject(new Error("Instance not found for handle: " + handle));
      return;
    }

    const instance = found as ObjC.Object;
    const { id, path } = cb.prepare(script);
    console.log(`[rn.inject] ${arch} id=${id} path=${path}`);

    ensureCallbackHook();
    cb.register(id, (result) => {
      unlink(path);
      resolve(result);
    });

    injecting = true;
    try {
      if (arch === "legacy") {
        const nsData = ObjC.classes.NSData.dataWithContentsOfFile_(path);
        const nsURL = ObjC.classes.NSURL.fileURLWithPath_(path);
        instance["- enqueueApplicationScript:url:onComplete:"](
          nsData,
          nsURL,
          NULL,
        );
      } else {
        const sel = ["- _loadJSBundle:", "- loadJSBundle:"].find(
          (s) => s in cls,
        );
        if (!sel) {
          cb.cleanup(id, path);
          reject(new Error("No loadJSBundle method found on " + className));
          return;
        }
        instance[sel](ObjC.classes.NSURL.fileURLWithPath_(path));
      }
    } finally {
      injecting = false;
    }
  });
}

setImmediate(() => {
  hookBundleLoader();
  hookLegacyBundleExec();
});

```

`agent/src/fruity/modules/ui.ts`:

```ts
import ObjC from "frida-objc-bridge";
import { performOnMainThread } from "@/fruity/lib/dispatch.js";

type Point = [number, number];
type Size = [number, number];
type Frame = [Point, Size];

interface UIDelegate {
  name?: string;
  description?: string;
}

export interface UIDumpNode {
  clazz: string;
  description?: string;
  children?: UIDumpNode[];
  frame: Frame | null;
  delegate?: UIDelegate;
}

export async function dump() {
  const { UIWindow } = ObjC.classes;
  const win = UIWindow.keyWindow();

  const recursive = (view: ObjC.Object): UIDumpNode | null => {
    if (!view) return null;

    const clazz = view.$className;
    const description = view.description().toString();
    const subviews = view.subviews();
    const delegate: UIDelegate = {};
    if (typeof view.delegate === "function") {
      const instance = view.delegate() as ObjC.Object;
      if (instance) {
        delegate.name = instance.$className;
        delegate.description = instance.debugDescription() + "";
      }
    }

    const frame = view
      .superview()
      ?.convertRect_toView_(view.frame(), NULL) as Frame | null;

    const children: UIDumpNode[] = [];

    for (let i = 0; i < subviews.count(); i++) {
      const child = recursive(subviews.objectAtIndex_(i));
      if (child) children.push(child);
    }

    return {
      description,
      children,
      frame,
      delegate,
      clazz,
    };
  };

  await dismissHighlight();
  return performOnMainThread(() => recursive(win));
}

let overlay: ObjC.Object | null = null;

// NSMakePoint
// NSMakeSize
export function highlight(frame: Frame): void {
  const { UIWindow, UIView, UIColor } = ObjC.classes;
  if (!frame) return;

  const win = UIWindow.keyWindow();
  if (!win) return;

  ObjC.schedule(ObjC.mainQueue, () => {
    if (!overlay) {
      overlay = UIView.alloc().initWithFrame_(frame) as ObjC.Object;
      overlay.setBackgroundColor_(UIColor.yellowColor());
      overlay.setAlpha_(0.4);
    } else {
      overlay.removeFromSuperview();
      overlay.setFrame_(frame);
    }
    win.addSubview_(overlay);
  });

  Script.bindWeak(globalThis, dismissHighlight);
}

export async function dismissHighlight() {
  return performOnMainThread(() => {
    if (!overlay) return;
    overlay.removeFromSuperview();
    overlay = null;
  });
}

// highlight([[0,0],[375,812]])
// setTimeout(() => { dismissHighlight() }, 3000)
// setTimeout(() => { highlight([[100,100],[375,812]]) }, 1000)

```

`agent/src/fruity/modules/uidevice.ts`:

```ts
import ObjC from "frida-objc-bridge";

export interface UIDeviceInfo {
  name: string;
  model: string;
  localizedModel: string;
  systemName: string;
  systemVersion: string;
  identifierForVendor: string;
  batteryLevel: number;
  batteryState: string;
  userInterfaceIdiom: string;
  isMultitaskingSupported: boolean;
}

const BATTERY_STATES: Record<number, string> = {
  0: "Unknown",
  1: "Unplugged",
  2: "Charging",
  3: "Full",
};

const UI_IDIOMS: Record<number, string> = {
  0: "Phone",
  1: "Pad",
  2: "TV",
  3: "CarPlay",
  4: "Mac",
  5: "Vision",
};

export function info(): UIDeviceInfo {
  const device = ObjC.classes.UIDevice.currentDevice();

  // Enable battery monitoring so batteryLevel / batteryState return real values
  device.setBatteryMonitoringEnabled_(true);

  const batteryStateRaw: number = device.batteryState();
  const idiomRaw: number = device.userInterfaceIdiom();

  return {
    name: device.name().toString(),
    model: device.model().toString(),
    localizedModel: device.localizedModel().toString(),
    systemName: device.systemName().toString(),
    systemVersion: device.systemVersion().toString(),
    identifierForVendor: device.identifierForVendor()?.UUIDString()?.toString() ?? "N/A",
    batteryLevel: device.batteryLevel(),
    batteryState: BATTERY_STATES[batteryStateRaw] ?? `Unknown (${batteryStateRaw})`,
    userInterfaceIdiom: UI_IDIOMS[idiomRaw] ?? `Unknown (${idiomRaw})`,
    isMultitaskingSupported: !!device.isMultitaskingSupported(),
  };
}

```

`agent/src/fruity/modules/url.ts`:

```ts
import ObjC from "frida-objc-bridge";
export function open(urlStr: string) {
  const app = ObjC.classes.UIApplication.sharedApplication();

  // iOS 13 UISceneDelegate
  if (ObjC.classes.UIScene) {
    const scenes = app.connectedScenes().allObjects();
    for (let i = 0; i < scenes.count(); i++) {
      const scene = scenes.objectAtIndex_(i);
      const delegate = scene.delegate();
      if (!delegate) continue;
      ObjC.schedule(ObjC.mainQueue, () => {
        // prevent UAF!!
        const url = ObjC.classes.NSURL.URLWithString_(urlStr);
        const opt = ObjC.classes.UISceneOpenURLOptions.new();
        const ctx = ObjC.classes.UIOpenURLContext.new().initWithURL_options_(
          url,
          opt,
        );
        const imp = scene.delegate().scene_openURLContexts_.implementation;
        scene
          .delegate()
          .scene_openURLContexts_(
            scene,
            ObjC.classes.NSSet.setWithObject_(ctx),
          );
        console.log(
          "request sent to url handler:",
          delegate,
          "scene:openURLContexts:",
          "@" + imp,
        );
      });
      return;
    }
  }

  const candidates = [
    "application:handleOpenURL:", // iOS 2.0-9.0
    "application:openURL:sourceApplication:annotation:", // iOS 4.2–9.0
    "application:openURL:options:", // 9.0+
  ];

  const delegate = app.delegate();

  for (let sel of candidates) {
    const method = delegate[sel];
    if (typeof method === "function") {
      ObjC.schedule(ObjC.mainQueue, () => {
        const rest = [...new Array(method.length - 2)].map((e) => NULL);
        const url = ObjC.classes.NSURL.URLWithString_(urlStr);
        delegate[sel](app, url, ...rest);
        console.log(
          "request sent to url handler:",
          delegate,
          sel,
          "@" + method.implementation,
        );
      });
      return;
    }
  }

  throw Error(
    `delegate not found. Please file a bug (bundle id: ${ObjC.classes.NSBundle.mainBundle()})`,
  );
}

```

`agent/src/fruity/modules/userdefaults.ts`:

```ts
import ObjC from "frida-objc-bridge";
import {
  NSObject,
  NSString,
  NSData,
  NSNumber,
  NSDate,
  NSArray,
  NSDictionary,
} from "@/fruity/typings.js";

import { toJS } from "@/fruity/bridge/object.js";

/**
 * A default object must be a property list—that is, an instance of (or for collections,
 * a combination of instances of) NSData, NSString, NSNumber, NSDate, NSArray, or NSDictionary.
 * If you want to store any other type of object, you should typically archive it to create an instance of NSData.
 *
 * https://developer.apple.com/documentation/foundation/nsuserdefaults
 */

type UserDefaultsType =
  | "data"
  | "string"
  | "number"
  | "date"
  | "array"
  | "dict";
type UserDefaultsValue =
  | NSString
  | NSData
  | NSNumber
  | NSDate
  | NSArray<UserDefaultsValue>
  | NSDictionary<NSString, UserDefaultsValue>;

export interface UserDefaultsEntry {
  type: UserDefaultsType;
  readable: string;
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  value: any;
}

export interface UserDefaultsDict {
  [key: string]: UserDefaultsEntry;
}

interface NSUserDefaults extends NSObject {
  dictionaryRepresentation(): NSDictionary<string, UserDefaultsValue>;
  objectForKey_(key: string): UserDefaultsValue;
}

function typeName(value: NSObject): UserDefaultsType {
  const mapping: { [className: string]: UserDefaultsType } = {
    NSData: "data",
    NSString: "string",
    NSNumber: "number",
    NSDate: "date",
    NSArray: "array",
    NSDictionary: "dict",
  };

  for (const [className, type] of Object.entries(mapping)) {
    if (value.isKindOfClass_(ObjC.classes[className])) return type;
  }

  throw new Error(`Unknown type: ${value}`);
}

function singleton() {
  return ObjC.classes.NSUserDefaults.standardUserDefaults() as NSUserDefaults;
}

export function enumerate() {
  const asDict = singleton().dictionaryRepresentation();
  const keys = asDict.allKeys();

  function* gen() {
    for (let i = 0; i < keys.count(); i++) {
      const key = keys.objectAtIndex_(i);
      const value = asDict.objectForKey_(key) as NSObject;

      yield [
        key.toString(),
        {
          type: typeName(value),
          readable: value.toString(),
          value: toJS(value),
        },
      ];
    }
  }

  return Object.fromEntries(gen()) as UserDefaultsDict;
}

/*
 * It's impossible for us to distinguish among different types of NSNumbers and boolean values.
 * Also, we can't handle nested array and dictionary.
 *
 * So only support NSString, NSData and NSDate here.
 */

export function update(key: string, value: string | number) {
  const userDefaults = singleton();
  const current = userDefaults.objectForKey_(key);
  if (!current) throw new Error(`key ${key} not found`);
  if (
    current.isKindOfClass_(ObjC.classes.NSString) &&
    typeof value === "string"
  ) {
    // string literal
    userDefaults.setObject_forKey_(value, key);
  } else if (
    current.isKindOfClass_(ObjC.classes.NSDate) &&
    typeof value === "number"
  ) {
    // timestamp
    userDefaults.setObject_forKey_(
      ObjC.classes.NSDate.dateWithTimeIntervalSince1970_(value),
      key,
    );
  } else if (
    current.isKindOfClass_(ObjC.classes.NSData) &&
    typeof value === "string"
  ) {
    // base64 encoded string
    userDefaults.setObject_forKey_(
      ObjC.classes.NSData.alloc().initWithBase64EncodedString_options_(
        value,
        0,
      ),
      key,
    );
  } else {
    throw new Error(
      `Unable to update ${key} with ${value}, either type mismatch or unsupported type`,
    );
  }
}

export function remove(key: string) {
  // no need to do existence check
  singleton().removeObjectForKey_(key);
}

// @todo: shall we support value creation?

```

`agent/src/fruity/modules/webview.ts`:

```ts
import ObjC from "frida-objc-bridge";
import type { NSObject, StringLike, NSURL, NSString } from "@/fruity/typings.js";

import { performOnMainThread } from "@/fruity/lib/dispatch.js";

const WebViewKinds = ["UI", "WK"] as const;

type Kind = (typeof WebViewKinds)[number];

interface NSURLRequest extends NSObject {
  initWithURL_(url: NSURL): NSURLRequest;
}

interface WKPreferences extends NSObject {
  javaScriptCanOpenWindowsAutomatically(): boolean;
  siteSpecificQuirksModeEnabled(): boolean;
  fraudulentWebsiteWarningEnabled(): boolean;

  javaScriptEnabled(): boolean;
}

interface WKWebpagePreferences extends NSObject {
  allowsContentJavaScript(): boolean;
  lockdownModeEnabled(): boolean;
}

interface WKWebViewConfiguration extends NSObject {
  websiteDataStore(): NSObject;
  preferences(): WKPreferences;
  defaultWebpagePreferences(): WKWebpagePreferences;
}

interface WKWebView extends NSObject {
  configuration(): WKWebViewConfiguration;
  evaluateJavaScript_completionHandler_(
    js: StringLike,
    handler: ObjC.Block,
  ): void;
  URL(): NSURL;
  loadRequest_(req: NSURLRequest): void;
}

interface WebScriptObject extends NSObject {
  valueForKey_(key: StringLike): NSObject;
  evaluateWebScript_(script: StringLike): NSObject;
}

interface UIWebView extends NSObject {
  request(): NSURLRequest;
  URL(): NSURL;
  stringByEvaluatingJavaScriptFromString_(js: StringLike): NSString;
  valueForKeyPath_(key: StringLike): NSObject;
  windowScriptObject(): WebScriptObject;
  loadRequest_(req: NSURLRequest): void;
}

type WebView = UIWebView | WKWebView;

export interface WebViewInfo {
  handle: string;
  kind: Kind;
  title?: string;
  url?: string;
}

export interface WKWebViewInfo extends WebViewInfo {
  js: boolean; // javaScriptEnabled
  contentJs?: boolean; // allowsContentJavaScript
  fileURLAccess?: boolean; // allowFileAccessFromFileURLs
  universalFileAccess?: boolean; // allowUniversalAccessFromFileURLs
  secure?: boolean; // iOS 16.4+ contentBlockersEnabled
  jsAutoOpenWindow: boolean; // javaScriptCanOpenWindowsAutomatically
}

export type UIWebViewInfo = WebViewInfo;

function choose(clazz: ObjC.Object): Promise<ObjC.Object[]> {
  return new Promise((resolve) => {
    const instances: ObjC.Object[] = [];
    ObjC.choose(clazz, {
      onMatch(instance) {
        instances.push(instance);
      },
      onComplete() {
        resolve(instances);
      },
    });
  });
}

export async function listWK(): Promise<WKWebViewInfo[]> {
  const { WKWebView } = ObjC.classes;
  if (!WKWebView) return [];

  const kind = "WK";
  const instances = await choose(WKWebView);

  return Promise.all(
    instances.map((instance) => {
      const webview = instance as WKWebView;
      const handle = instance.handle.toString();

      const conf = webview.configuration() as WKWebViewConfiguration;
      const pref = conf.preferences();
      const webpagePref = conf.defaultWebpagePreferences();

      return performOnMainThread(async () => {
        const url = webview.URL()?.toString() ?? "";
        const title = await WKGetTitle(webview);

        return {
          handle,
          kind,
          url,
          title,
          js: pref.javaScriptEnabled(),
          contentJs: webpagePref.allowsContentJavaScript(),
          jsAutoOpenWindow: pref.javaScriptCanOpenWindowsAutomatically(),
        } as WKWebViewInfo;
      });
    }),
  );
}

export async function listUI(): Promise<UIWebViewInfo[]> {
  const { UIWebView } = ObjC.classes;
  if (!UIWebView) return [];

  const kind = "UI";
  const instances = await choose(UIWebView);

  return Promise.all(
    instances.map((instance) => {
      const webview = instance as UIWebView;
      const handle = instance.handle.toString();

      return performOnMainThread(() => {
        const req = webview.request();
        const url = req?.mainDocumentURL()?.toString() ?? "";
        const title = UIGetTitle(webview);

        return {
          handle,
          kind,
          url,
          title,
        } as UIWebViewInfo;
      });
    }),
  );
}

function WKGetTitle(webview: WKWebView) {
  if (!ObjC.classes.NSThread.isMainThread()) throw new Error("Invalid thread");

  return new Promise<string>((resolve, reject) =>
    webview.evaluateJavaScript_completionHandler_(
      "document.title",
      new ObjC.Block({
        retType: "void",
        argTypes: ["object", "object"],
        implementation(result: ObjC.Object, error: ObjC.Object) {
          if (error) reject(new Error(`Unable to get title. ${error}`));
          else resolve("" + result);
        },
      }),
    ),
  );
}

function UIGetTitle(webview: UIWebView) {
  if (!ObjC.classes.NSThread.isMainThread()) throw new Error("Invalid thread");

  try {
    return (
      webview.stringByEvaluatingJavaScriptFromString_("document.title") + ""
    );
  } catch (e) {
    throw new Error(`Unable to get title. ${e}`);
  }
}

function getInstance(kind: Kind, handle: string): Promise<WebView> {
  const clazz = ObjC.classes[`${kind}WebView`];
  if (!clazz)
    return Promise.reject(new Error(`${kind}WebView class not found`));

  return new Promise((resolve, reject) => {
    let found = false;
    ObjC.choose(clazz, {
      onMatch(instance) {
        if (instance.handle.toString() === handle) {
          found = true;
          resolve(instance as WebView);
          return "stop";
        }
      },
      onComplete() {
        if (!found) reject(new Error(`${kind}WebView ${handle} not found`));
      },
    });
  });
}

export async function evaluate(kind: Kind, handle: string, js: string) {
  const instance = await getInstance(kind, handle);

  if (kind === "UI") {
    return performOnMainThread(() => {
      const webview = instance as UIWebView;
      return webview.stringByEvaluatingJavaScriptFromString_(js) + "";
    });
  }

  return new Promise((resolve, reject) => {
    const webview = instance as WKWebView;
    webview.evaluateJavaScript_completionHandler_(
      js,
      new ObjC.Block({
        retType: "void",
        argTypes: ["object", "object"],
        implementation(result: ObjC.Object, error: ObjC.Object) {
          if (error)
            reject(new Error(`Unable to execute Javascript. ${error}`));
          else resolve("" + result);
        },
      }),
    );
  });
}

export async function navigate(
  kind: Kind,
  handle: string,
  url: string,
): Promise<void> {
  const instance = await getInstance(kind, handle);

  if (kind === "UI") {
    return performOnMainThread(() => {
      const webview = instance as UIWebView;
      const u = ObjC.classes.NSURL.URLWithString_(url);
      const req = ObjC.classes.NSURLRequest.requestWithURL_(u);
      webview.loadRequest_(req);
    });
  }

  return performOnMainThread(() => {
    const webview = instance as WKWebView;
    const u = ObjC.classes.NSURL.URLWithString_(url);
    const req = ObjC.classes.NSURLRequest.requestWithURL_(u);
    webview.loadRequest_(req);
  });
}

// export async function dump(handle: string): Promise<Record<string, string>> {
//   return performOnMainThread(() => {
//     const webview = findWebViewSync(handle, "UI") as UIWebView | null;
//     if (!webview) throw new Error(`UIWebView ${handle} not found`);

//     const jsc = webview.valueForKeyPath_(
//       "documentView.webView.mainFrame.javaScriptContext",
//     );
//     const window = webview.windowScriptObject();
//     const keys = window.evaluateWebScript_("Object.keys(this)");
//     const count = (
//       keys as unknown as { valueForKey_(k: string): number }
//     ).valueForKey_("length");
//     const result: Record<string, string> = {};

//     for (let i = 0; i < count; i++) {
//       const key = (
//         keys as unknown as { webScriptValueAtIndex_(i: number): NSObject }
//       )
//         .webScriptValueAtIndex_(i)
//         .toString();
//       if (
//         !(jsc as unknown as { objectForKeyedSubscript_(k: string): NSObject })
//           .objectForKeyedSubscript_(key)
//           .isObject()
//       )
//         continue;
//       const obj = window.valueForKey_(key);
//       if (!obj.isKindOfClass_(ObjC.classes.WebScriptObject))
//         result[key] = `<${obj.$className} ${obj.handle}>`;
//     }

//     return result;
//   });
// }

```

`agent/src/fruity/native/corefoundation.ts`:

```ts
let cached: {
  CFDataGetLength: NativeFunction<number, [NativePointerValue]>;
  CFDataGetBytePtr: NativeFunction<NativePointer, [NativePointerValue]>;
  CFRetain: NativeFunction<NativePointer, [NativePointerValue]>;
  CFRelease: NativeFunction<void, [NativePointerValue]>;
};

export default function api() {
  if (cached) return cached;

  const CoreFoundation = Process.getModuleByName("CoreFoundation");
  const CFDataGetLength = new NativeFunction(
    CoreFoundation.getExportByName("CFDataGetLength"),
    "long",
    ["pointer"],
  );

  const CFDataGetBytePtr = new NativeFunction(
    CoreFoundation.getExportByName("CFDataGetBytePtr"),
    "pointer",
    ["pointer"],
  );

  const CFRelease = new NativeFunction(
    CoreFoundation.findExportByName("CFRelease")!,
    "void",
    ["pointer"],
  );

  const CFRetain = new NativeFunction(
    CoreFoundation.findExportByName("CFRetain")!,
    "pointer",
    ["pointer"],
  );

  cached = {
    CFDataGetLength,
    CFDataGetBytePtr,
    CFRetain,
    CFRelease,
  };

  return cached;
}

```

`agent/src/fruity/native/libdyld.ts`:

```ts
import ObjC from "frida-objc-bridge";
import { getGlobalExport } from "@/lib/polyfill.js";
import getLibSystemApi from "@/fruity/native/libsystem.js";

// struct nlist_64 {
//     union {
//         uint32_t n_strx;  /* index into the string table */
//     } n_un;
//     uint8_t n_type;       /* section number or NO_SECT */
//     uint8_t n_sect;       /* see <mach-o/stab.h> */
//     uint16_t n_desc;      /* see <mach-o/stab.h> */
//     uint64_t n_value;     /* value of this symbol (or stab offset) */
// };

let cached: {
  dyldForEachInstalledSharedCache: NativeFunction<void, [NativePointerValue]>;
  dyldSharedCacheForEachImage: NativeFunction<
    void,
    [NativePointerValue, NativePointerValue]
  >;
  dyldImageGetInstallname: NativeFunction<NativePointer, [NativePointerValue]>;
  dyldImageLocalNlistContent4Symbolication: NativeFunction<
    number,
    [NativePointerValue, NativePointerValue]
  >;
  _dyld_image_count: NativeFunction<number, []>;
  _dyld_get_image_header: NativeFunction<NativePointer, [number]>;
  _dyld_get_image_vmaddr_slide: NativeFunction<Int64, [number]>;
};

function api() {
  if (cached) return cached;

  const libdyld = Module.load("/usr/lib/system/libdyld.dylib");

  function requireExport(name: string) {
    const addr = libdyld.findExportByName(name);
    if (!addr) throw new Error(`${name} not found`);
    return addr;
  }

  cached = {
    dyldForEachInstalledSharedCache: new NativeFunction(
      requireExport("dyld_for_each_installed_shared_cache"),
      "void",
      ["pointer"],
    ),
    dyldSharedCacheForEachImage: new NativeFunction(
      requireExport("dyld_shared_cache_for_each_image"),
      "void",
      ["pointer", "pointer"],
    ),
    dyldImageGetInstallname: new NativeFunction(
      requireExport("dyld_image_get_installname"),
      "pointer",
      ["pointer"],
    ),
    dyldImageLocalNlistContent4Symbolication: new NativeFunction(
      requireExport("dyld_image_local_nlist_content_4Symbolication"),
      "bool",
      ["pointer", "pointer"],
    ),
    _dyld_image_count: new NativeFunction(
      getGlobalExport("_dyld_image_count"),
      "uint32",
      [],
    ),
    _dyld_get_image_header: new NativeFunction(
      getGlobalExport("_dyld_get_image_header"),
      "pointer",
      ["uint32"],
    ),
    _dyld_get_image_vmaddr_slide: new NativeFunction(
      getGlobalExport("_dyld_get_image_vmaddr_slide"),
      "int64",
      ["uint32"],
    ),
  };

  return cached;
}

function getSlide(module: string) {
  const {
    _dyld_image_count,
    _dyld_get_image_header,
    _dyld_get_image_vmaddr_slide,
  } = api();

  const moduleInfo = Process.getModuleByName(module);
  for (let i = 0; i < _dyld_image_count(); i++) {
    const header = _dyld_get_image_header(i);
    if (moduleInfo.base.equals(header)) {
      return _dyld_get_image_vmaddr_slide(i);
    }
  }

  throw new Error(`module ${module} not found in current process`);
}

/**
 * Iterate over nlist symbols in the dyld shared cache for a given module.
 * @param visitor called for each symbol; return true to stop iteration.
 */
function forEachSymbolInDyld(
  module: string,
  visitor: (symbolName: NativePointer, value: UInt64) => boolean,
) {
  const {
    dyldForEachInstalledSharedCache,
    dyldSharedCacheForEachImage,
    dyldImageGetInstallname,
    dyldImageLocalNlistContent4Symbolication,
  } = api();

  dyldForEachInstalledSharedCache(
    new ObjC.Block({
      retType: "void",
      argTypes: ["pointer"],
      implementation(cache: NativePointer) {
        let found = false;

        dyldSharedCacheForEachImage(
          cache,
          new ObjC.Block({
            retType: "void",
            argTypes: ["pointer"],
            implementation(image: NativePointer) {
              if (found) return;

              const name = dyldImageGetInstallname(image).readUtf8String()!;
              if (!name.endsWith("/" + module)) return;
              found = true;

              dyldImageLocalNlistContent4Symbolication(
                image,
                new ObjC.Block({
                  retType: "bool",
                  argTypes: ["pointer", "uint64", "pointer"],
                  implementation(
                    nlistStart: NativePointer,
                    nlistCount: UInt64,
                    stringTable: NativePointer,
                  ) {
                    let nlist = nlistStart;
                    for (
                      let i = uint64(0);
                      i.compare(nlistCount) < 0;
                      i = i.add(1), nlist = nlist.add(16)
                    ) {
                      const n_strx = nlist.readU32();
                      const n_value = nlist.add(8).readU64();
                      const symbolName = stringTable.add(n_strx);
                      if (visitor(symbolName, n_value)) {
                        break;
                      }
                    }
                  },
                }),
              );
            },
          }),
        );
      },
    }),
  );
}

function findSymbolInDyld(module: string, symbol: string) {
  const { strcmp } = getLibSystemApi();
  let value = NULL;
  const symbolString = Memory.allocUtf8String("_" + symbol);

  forEachSymbolInDyld(module, (symbolName, n_value) => {
    if (strcmp(symbolName, symbolString) === 0) {
      value = new NativePointer(n_value);
      return true;
    }
    return false;
  });

  if (value.isNull())
    throw new Error(
      `symbol ${symbol} not found in dyld cache for module ${module}`,
    );

  const slide = getSlide(module);
  return value.add(slide);
}

function globSymbolsInDyld(module: string, pattern: string) {
  const { fnmatch } = getLibSystemApi();
  const results: NativePointer[] = [];
  const patternString = Memory.allocUtf8String("_" + pattern);

  forEachSymbolInDyld(module, (symbolName, n_value) => {
    if (fnmatch(patternString, symbolName, 0) === 0) {
      results.push(new NativePointer(n_value));
    }
    return false;
  });

  const slide = getSlide(module);
  return results.map((ptr) => ptr.add(slide));
}

export function symbolFromName(module: string, symbol: string): NativePointer {
  try {
    return findSymbolInDyld(module, symbol);
  } catch (e) {
    console.warn("libdyld: error finding symbol in dyld cache:", e);
    return DebugSymbol.getFunctionByName(symbol);
  }
}

export function symbolsFromGlob(
  module: string,
  pattern: string,
): NativePointer[] {
  try {
    return globSymbolsInDyld(module, pattern);
  } catch (e) {
    console.warn("libdyld: could not match glob pattern in dyld cache:", e);
    return DebugSymbol.findFunctionsMatching(pattern);
  }
}

```

`agent/src/fruity/native/libsystem.ts`:

```ts
let cached: {
  free: NativeFunction<void, [NativePointerValue]>;
  fcntl: NativeFunction<number, [number, number, NativePointerValue]>;
  strcmp: NativeFunction<number, [NativePointerValue, NativePointerValue]>;
  fnmatch: NativeFunction<
    number,
    [NativePointerValue, NativePointerValue, number]
  >;
};

export default function api() {
  if (cached) return cached;

  const libsystem = Process.getModuleByName("libSystem.B.dylib");
  const e = (name: string) => libsystem.getExportByName(name);

  cached = {
    free: new NativeFunction(e("free"), "void", ["pointer"]),
    fcntl: new NativeFunction(e("fcntl"), "int", ["int", "int", "pointer"]),
    strcmp: new NativeFunction(e("strcmp"), "int", ["pointer", "pointer"]),
    fnmatch: new NativeFunction(e("fnmatch"), "int", [
      "pointer",
      "pointer",
      "int",
    ]),
  };

  return cached;
}

```

`agent/src/fruity/native/libxpc.ts`:

```ts
interface XPCTypeEntry {
  name: string;
  address: NativePointer;
}

let cached: {
  libxpc: Module;
  xpc_connection_get_name: NativeFunction<NativePointer, [NativePointerValue]>;
  xpc_connection_get_pid: NativeFunction<number, [NativePointerValue]>;
  xpc_copy_description: NativeFunction<NativePointer, [NativePointerValue]>;
  xpc_get_type: NativeFunction<NativePointer, [NativePointerValue]>;
  xpc_string_get_string_ptr: NativeFunction<
    NativePointer,
    [NativePointerValue]
  >;
  xpc_string_get_length: NativeFunction<UInt64, [NativePointerValue]>;
  xpc_data_get_bytes_ptr: NativeFunction<NativePointer, [NativePointerValue]>;
  xpc_data_get_length: NativeFunction<UInt64, [NativePointerValue]>;
  xpc_uuid_get_bytes: NativeFunction<NativePointer, [NativePointerValue]>;
  xpc_double_get_value: NativeFunction<number, [NativePointerValue]>;
  xpc_bool_get_value: NativeFunction<number, [NativePointerValue]>;
  xpc_int64_get_value: NativeFunction<Int64, [NativePointerValue]>;
  xpc_uint64_get_value: NativeFunction<UInt64, [NativePointerValue]>;
  xpc_dictionary_apply: NativeFunction<
    number,
    [NativePointerValue, NativePointerValue]
  >;
  xpc_array_apply: NativeFunction<
    number,
    [NativePointerValue, NativePointerValue]
  >;
  xpc_fd_dup: NativeFunction<number, [NativePointerValue]>;
  xpc_date_get_value: NativeFunction<Int64, [NativePointerValue]>;
  xpcTypes: XPCTypeEntry[];
  xpcDictionaryType: NativePointer;
  xpcArrayType: NativePointer;
};

export default function api() {
  if (cached) return cached;

  const libxpc = Process.getModuleByName("libxpc.dylib");

  const e = (name: string) => libxpc.getExportByName(name);

  const xpcTypes = libxpc
    .enumerateExports()
    .filter((s) => s.name.startsWith("_xpc_type_"))
    .map((s) => ({ name: s.name, address: s.address }));

  cached = {
    libxpc,
    xpc_connection_get_name: new NativeFunction(
      e("xpc_connection_get_name"),
      "pointer",
      ["pointer"],
    ),
    xpc_connection_get_pid: new NativeFunction(
      e("xpc_connection_get_pid"),
      "int",
      ["pointer"],
    ),
    xpc_copy_description: new NativeFunction(
      e("xpc_copy_description"),
      "pointer",
      ["pointer"],
    ),
    xpc_get_type: new NativeFunction(e("xpc_get_type"), "pointer", [
      "pointer",
    ]),
    xpc_string_get_string_ptr: new NativeFunction(
      e("xpc_string_get_string_ptr"),
      "pointer",
      ["pointer"],
    ),
    xpc_string_get_length: new NativeFunction(
      e("xpc_string_get_length"),
      "size_t",
      ["pointer"],
    ),
    xpc_data_get_bytes_ptr: new NativeFunction(
      e("xpc_data_get_bytes_ptr"),
      "pointer",
      ["pointer"],
    ),
    xpc_data_get_length: new NativeFunction(
      e("xpc_data_get_length"),
      "size_t",
      ["pointer"],
    ),
    xpc_uuid_get_bytes: new NativeFunction(
      e("xpc_uuid_get_bytes"),
      "pointer",
      ["pointer"],
    ),
    xpc_double_get_value: new NativeFunction(
      e("xpc_double_get_value"),
      "double",
      ["pointer"],
    ),
    xpc_bool_get_value: new NativeFunction(e("xpc_bool_get_value"), "bool", [
      "pointer",
    ]),
    xpc_int64_get_value: new NativeFunction(
      e("xpc_int64_get_value"),
      "int64",
      ["pointer"],
    ),
    xpc_uint64_get_value: new NativeFunction(
      e("xpc_uint64_get_value"),
      "uint64",
      ["pointer"],
    ),
    xpc_dictionary_apply: new NativeFunction(
      e("xpc_dictionary_apply"),
      "bool",
      ["pointer", "pointer"],
    ),
    xpc_array_apply: new NativeFunction(e("xpc_array_apply"), "bool", [
      "pointer",
      "pointer",
    ]),
    xpc_fd_dup: new NativeFunction(e("xpc_fd_dup"), "int", ["pointer"]),
    xpc_date_get_value: new NativeFunction(e("xpc_date_get_value"), "int64", [
      "pointer",
    ]),
    xpcTypes,
    xpcDictionaryType:
      xpcTypes.find((s) => s.name === "_xpc_type_dictionary")?.address ?? NULL,
    xpcArrayType:
      xpcTypes.find((s) => s.name === "_xpc_type_array")?.address ?? NULL,
  };

  return cached;
}

```

`agent/src/fruity/native/security.ts`:

```ts
let cached: {
  SecItemCopyMatching: NativeFunction<
    number,
    [NativePointerValue, NativePointerValue]
  >;
  SecItemAdd: NativeFunction<number, [NativePointerValue, NativePointerValue]>;
  SecItemUpdate: NativeFunction<
    number,
    [NativePointerValue, NativePointerValue]
  >;
  SecItemDelete: NativeFunction<number, [NativePointerValue]>;
  SecAccessControlCreateWithFlags: NativeFunction<
    NativePointer,
    [NativePointerValue, NativePointerValue, number, NativePointerValue]
  >;
  SecAccessControlGetProtection: NativeFunction<
    NativePointer,
    [NativePointerValue]
  >;
  SecAccessControlGetRequirePassword: NativeFunction<
    number,
    [NativePointerValue]
  >;
  SecAccessControlGetConstraint: NativeFunction<
    NativePointer,
    [NativePointerValue, NativePointerValue]
  >;
  SecAccessControlGetConstraints: NativeFunction<
    NativePointer,
    [NativePointerValue]
  >;
  Security: Module;
};

export default function api() {
  if (cached) {
    return cached;
  }

  const Security = Process.getModuleByName("Security");

  const SecItemCopyMatching = new NativeFunction(
    Security.getExportByName("SecItemCopyMatching"),
    "int",
    ["pointer", "pointer"],
  );

  const SecItemAdd = new NativeFunction(
    Security.getExportByName("SecItemAdd"),
    "int",
    ["pointer", "pointer"],
  );

  const SecItemUpdate = new NativeFunction(
    Security.getExportByName("SecItemUpdate"),
    "int",
    ["pointer", "pointer"],
  );

  const SecItemDelete = new NativeFunction(
    Security.getExportByName("SecItemDelete"),
    "int",
    ["pointer"],
  );

  const SecAccessControlCreateWithFlags = new NativeFunction(
    Security.getExportByName("SecAccessControlCreateWithFlags"),
    "pointer",
    ["pointer", "pointer", "int", "pointer"],
  );

  const SecAccessControlGetProtection = new NativeFunction(
    Security.getExportByName("SecAccessControlGetProtection"),
    "pointer",
    ["pointer"],
  );

  const SecAccessControlGetRequirePassword = new NativeFunction(
    Security.getExportByName("SecAccessControlGetRequirePassword"),
    "bool",
    ["pointer"],
  );

  const SecAccessControlGetConstraint = new NativeFunction(
    Security.getExportByName("SecAccessControlGetConstraint"),
    "pointer",
    ["pointer", "pointer"],
  );

  const SecAccessControlGetConstraints = new NativeFunction(
    Security.getExportByName("SecAccessControlGetConstraints"),
    "pointer",
    ["pointer"],
  );

  cached = {
    SecItemCopyMatching,
    SecItemAdd,
    SecItemUpdate,
    SecItemDelete,
    SecAccessControlCreateWithFlags,
    SecAccessControlGetProtection,
    SecAccessControlGetRequirePassword,
    SecAccessControlGetConstraint,
    SecAccessControlGetConstraints,
    Security,
  };

  return cached;
}

```

`agent/src/fruity/observers/lifecycle.ts`:

```ts
import ObjC from "frida-objc-bridge";

let signalHandlerInstance: ObjC.Object;

function getSignalHandler(): ObjC.Object {
  if (!signalHandlerInstance) {
    const salt = Math.random().toString(36).slice(2);
    const name = `GrapefruitAppDelegate${salt}`;
    const MyAppDelegate = ObjC.registerProtocol({
      name: name + "Protocol",
      methods: {
        "- inactive": {
          retType: "void",
          argTypes: [],
        },
        "- background": {
          retType: "void",
          argTypes: [],
        },
        "- active": {
          retType: "void",
          argTypes: [],
        },
        "- foreground": {
          retType: "void",
          argTypes: [],
        },
      },
    });

    const subject = "lifecycle";
    const Clazz = ObjC.registerClass({
      name,
      super: ObjC.classes.NSObject,
      protocols: [MyAppDelegate, ObjC.protocols.NSObject],
      methods: {
        "- inactive": () => {
          send({ subject, event: "inactive" });
          console.warn("App will be inactive.");
        },
        "- background": () => {
          console.warn(
            "App is is now on the background. Grapefruit will be irresponsive.",
          );
          send({ subject, event: "background" });
        },
        "- active": () => {
          send({ subject, event: "active" });
          console.warn("App became active.");
        },
        "- foreground": () => {
          send({ subject, event: "foreground" });
          console.warn("App will enter foreground.");
        },
      },
    });

    signalHandlerInstance = Clazz.alloc().init();
  }

  return signalHandlerInstance as ObjC.Object;
}

function notificationCenter() {
  return ObjC.classes.NSNotificationCenter.defaultCenter();
}

export function init() {
  if (!ObjC.available || !ObjC.classes.NSNotificationCenter) {
    return;
  }

  const center = notificationCenter();
  const signalHandler = getSignalHandler();
  center.addObserver_selector_name_object_(
    signalHandler,
    ObjC.selector("inactive"),
    "UIApplicationWillResignActiveNotification",
    NULL,
  );
  center.addObserver_selector_name_object_(
    signalHandler,
    ObjC.selector("background"),
    "UIApplicationDidEnterBackgroundNotification",
    NULL,
  );
  center.addObserver_selector_name_object_(
    signalHandler,
    ObjC.selector("active"),
    "UIApplicationDidBecomeActiveNotification",
    NULL,
  );
  center.addObserver_selector_name_object_(
    signalHandler,
    ObjC.selector("foreground"),
    "UIApplicationWillEnterForegroundNotification",
    NULL,
  );
}

function dispose() {
  const center = notificationCenter();
  const signalHandler = getSignalHandler();

  center.removeObserver_name_object_(
    signalHandler,
    "UIApplicationWillResignActiveNotification",
    NULL,
  );
  center.removeObserver_name_object_(
    signalHandler,
    "UIApplicationDidEnterBackgroundNotification",
    NULL,
  );
  center.removeObserver_name_object_(
    signalHandler,
    "UIApplicationDidBecomeActiveNotification",
    NULL,
  );
  center.removeObserver_name_object_(
    signalHandler,
    "UIApplicationWillEnterForegroundNotification",
    NULL,
  );
}

Script.bindWeak(globalThis, dispose);

```

`agent/src/fruity/registry.ts`:

```ts
import route from "./router.js";
import { createRegistry, type RemoteRPC } from "@/common/registry.js";

const { invoke, interfaces } = createRegistry(route);

export { invoke, interfaces };

// some typescript magic
export type RPCRoute = typeof route;

export type { RemoteRPC };

```

`agent/src/fruity/router.ts`:

```ts
import * as checksec from "./modules/checksec.js";
import * as classdump from "./modules/classdump.js";
import * as cookies from "./modules/cookies.js";
import * as crypto from "./crypto/index.js";
import * as entitlements from "./modules/entitlements.js";
import * as fs from "./modules/fs.js";
import * as geolocation from "./modules/geolocation.js";
import * as hook from "./hooks/index.js";
import * as info from "./modules/info.js";
import * as jsc from "./modules/jsc.js";
import * as keychain from "./modules/keychain.js";
import * as lsof from "./modules/lsof.js";
import * as objc from "./hooks/objc.js";
import * as plugins from "./modules/plugins.js";
import * as rn from "./modules/rn.js";
import * as ui from "./modules/ui.js";
import * as uidevice from "./modules/uidevice.js";
import * as url from "./modules/url.js";
import * as userdefaults from "./modules/userdefaults.js";
import * as webview from "./modules/webview.js";

import * as taps from "./taps.js";

import * as memory from "@/common/memory.js";
import * as native from "@/common/hooks/native.js";
import * as sqlite from "@/common/sqlite.js";
import * as symbol from "@/common/symbol.js";
import * as script from "@/common/script.js";
import * as syslog from "@/common/syslog.js";

if (!Process.findModuleByName("UIKit")) {
  console.warn("Not an UIKit App. Todo: disable some RPC");
}

export default {
  checksec,
  classdump,
  cookies,
  crypto,
  entitlements,
  fs,
  geolocation,
  hook,
  info,
  jsc,
  keychain,
  lsof,
  memory,
  native,
  objc,
  plugins,
  rn,
  script,
  sqlite,
  symbol,
  syslog,
  taps,
  ui,
  uidevice,
  url,
  userdefaults,
  webview,
};

```

`agent/src/fruity/taps.ts`:

```ts
import type { TapInfo, TapRule } from "@/common/taps.js";

import * as hookGroup from "./hooks/index.js";
import * as nsurl from "./hooks/url/index.js";
import * as flutter from "./hooks/flutter.js";
import * as xpc from "./hooks/xpc/index.js";
import * as objc from "./hooks/objc.js";
import * as native from "@/common/hooks/native.js";

interface TapEntry {
  start(): void;
  stop(): void;
  status(): boolean;
  available(): boolean;
}

const BUILTIN_GROUPS = [
  "sqlite",
  "pasteboard",
  "deviceid",
  "biometric",
  "fileops",
] as const;

const registry = new Map<string, TapEntry>();

// Register built-in hook groups
for (const id of BUILTIN_GROUPS) {
  registry.set(id, {
    start: () => hookGroup.start(id),
    stop: () => hookGroup.stop(id),
    status: () => hookGroup.status()[id] ?? false,
    available: () => true,
  });
}

registry.set("nsurl", nsurl);
registry.set("flutter", flutter);
registry.set("xpc", xpc);

export function list(): TapInfo[] {
  const result: TapInfo[] = [];
  for (const [id, entry] of registry) {
    result.push({
      id,
      active: entry.status(),
      available: entry.available(),
    });
  }
  return result;
}

function resolve(id: string): TapEntry {
  const entry = registry.get(id);
  if (!entry) throw new Error(`Unknown tap: ${id}`);
  return entry;
}

export function active(id: string): boolean {
  return resolve(id).status();
}

export function available(id: string): boolean {
  return resolve(id).available();
}

export function start(id: string): void {
  resolve(id).start();
}

export function stop(id: string): void {
  resolve(id).stop();
}

export function snapshot(): TapRule[] {
  const rules: TapRule[] = [];

  // Collect active built-in taps
  for (const [id, entry] of registry) {
    if (entry.status()) {
      rules.push({ type: "builtin", id });
    }
  }

  // Collect active user-defined ObjC hooks
  for (const { cls, sel } of objc.list()) {
    rules.push({ type: "objc", cls, sel });
  }

  // Collect active user-defined native hooks
  for (const { module, name, sig } of native.list()) {
    rules.push({ type: "native", module, name, sig });
  }

  return rules;
}

export function restore(rules: TapRule[]): void {
  for (const rule of rules) {
    try {
      switch (rule.type) {
        case "builtin":
          start(rule.id);
          break;
        case "objc":
          objc.swizzle(rule.cls, rule.sel);
          break;
        case "native":
          native.hook(rule.module, rule.name, rule.sig);
          break;
      }
    } catch (e) {
      console.warn(`taps: failed to restore rule ${JSON.stringify(rule)}:`, e);
    }
  }
}

```

`agent/src/fruity/tests.ts`:

```ts
/**
 * Fruity module test suite — current app only.
 *
 * Usage:
 *   frida-compile src/fruity/tests.ts -o /tmp/tests.js
 *   frida -U <app> -l /tmp/tests.js
 *
 *   or directly:
 *   frida -U <app> -l src/fruity/tests.ts
 */

import ObjC from "frida-objc-bridge";

import {
  test,
  skip,
  json,
  assert,
  assertType,
  assertArray,
  assertKeys,
  assertNonEmpty,
  summary,
} from "@/common/test-runner.js";

import * as info from "./modules/info.js";
import * as checksec from "./modules/checksec.js";
import * as entitlements from "./modules/entitlements.js";
import * as classdump from "./modules/classdump.js";
import * as cookies from "./modules/cookies.js";
import * as fs from "./modules/fs.js";
import * as keychain from "./modules/keychain.js";
import * as userdefaults from "./modules/userdefaults.js";
import * as lsof from "./modules/lsof.js";

// ---------------------------------------------------------------------------
// test suites
// ---------------------------------------------------------------------------

async function testInfo() {
  console.log("\n--- info ---");

  await test("info.basics returns app info fields", async () => {
    const b = info.basics();
    assertKeys(
      b as unknown as Record<string, unknown>,
      [
        "tmp",
        "home",
        "id",
        "label",
        "path",
        "main",
        "version",
        "semVer",
        "minOS",
      ],
      "info.basics",
    );
    assertType(b.id, "string", "id");
    assert(b.id.length > 0, "id should be non-empty");
    assertType(b.path, "string", "path");
    assert(b.path.startsWith("/"), "path should be absolute");
    assertType(b.home, "string", "home");
    assert(b.home.startsWith("/"), "home should be absolute");
    console.log(
      `    id=${b.id} label=${b.label} ver=${b.version} semVer=${b.semVer}`,
    );
    console.log(`    home=${b.home}`);
    console.log(`    path=${b.path}`);
  });

  await test("info.urls returns URL schemes array", async () => {
    const u = info.urls();
    assertArray(u, "urls");
    console.log(`    ${u.length} URL schemes`);
    if (u.length > 0) {
      const first = u[0];
      console.log(
        `    first: name=${first.name} schemes=${first.schemes?.join(",")}`,
      );
    }
  });

  await test("info.plist returns Info.plist as object", async () => {
    const p = info.plist();
    assertType(p, "object", "plist");
    assert(p !== null, "plist should not be null");
    const dict = p as Record<string, unknown>;
    assert(
      "CFBundleIdentifier" in dict,
      "plist should contain CFBundleIdentifier",
    );
    console.log(`    CFBundleIdentifier=${dict.CFBundleIdentifier}`);
  });

  await test("info.processInfo returns process fields", async () => {
    const p = info.processInfo();
    assertKeys(
      p as unknown as Record<string, unknown>,
      ["platform", "arch", "pointerSize", "pageSize"],
      "processInfo",
    );
    assertType(p.platform, "string", "platform");
    assertType(p.arch, "string", "arch");
    assertType(p.pointerSize, "number", "pointerSize");
    assertType(p.pageSize, "number", "pageSize");
    assert(p.pointerSize > 0, "pointerSize should be > 0");
    assert(p.pageSize > 0, "pageSize should be > 0");
    console.log(
      `    platform=${p.platform} arch=${p.arch} ptrSize=${p.pointerSize} pageSize=${p.pageSize}`,
    );
  });
}

async function testChecksec() {
  console.log("\n--- checksec ---");

  await test("checksec.flags returns security flags", async () => {
    const f = checksec.flags();
    assertKeys(
      f as unknown as Record<string, unknown>,
      ["pie", "arc", "canary", "encrypted"],
      "checksec.flags",
    );
    assertType(f.pie, "boolean", "pie");
    assertType(f.arc, "boolean", "arc");
    assertType(f.canary, "boolean", "canary");
    assertType(f.encrypted, "boolean", "encrypted");
    console.log(
      `    pie=${f.pie} arc=${f.arc} canary=${f.canary} encrypted=${f.encrypted}`,
    );
  });
}

async function testEntitlements() {
  console.log("\n--- entitlements ---");

  await test("entitlements.plist returns entitlements dict", async () => {
    const p = entitlements.plist();
    assertType(p, "object", "plist");
    assert(p !== null, "plist should not be null");
    const keys = Object.keys(p as Record<string, unknown>);
    console.log(`    ${keys.length} entitlement keys`);
    if (keys.length > 0) {
      console.log(`    first key: ${keys[0]}`);
    }
  });
}

async function testClassdump() {
  console.log("\n--- classdump ---");

  await test("classdump.list __main__ returns classes", async () => {
    const classes = classdump.list("__main__");
    assertArray(classes, "list");
    assertNonEmpty(classes, "list");
    for (const c of classes.slice(0, 3)) {
      assertType(c, "string", "class name");
    }
    console.log(`    ${classes.length} classes in __main__`);
    console.log(`    first: ${classes[0]}`);
  });

  await test("classdump.list __app__ returns classes", async () => {
    const classes = classdump.list("__app__");
    assertArray(classes, "list");
    assertNonEmpty(classes, "list");
    console.log(`    ${classes.length} classes in __app__`);
  });

  await test("classdump.inspect on NSObject returns class detail", async () => {
    const detail = classdump.inspect("NSObject");
    assertKeys(
      detail as unknown as Record<string, unknown>,
      [
        "name",
        "protocols",
        "methods",
        "ownMethods",
        "proto",
        "ivars",
        "module",
        "properties",
      ],
      "inspect",
    );
    assert(detail.name === "NSObject", `name mismatch: ${detail.name}`);
    assertArray(detail.methods, "methods");
    assertNonEmpty(detail.methods, "methods");
    assertArray(detail.proto, "proto");
    console.log(
      `    name=${detail.name} methods=${detail.methods.length} ivars=${detail.ivars.length}`,
    );
    console.log(
      `    protocols: ${Object.keys(detail.protocols).join(", ").slice(0, 80)}`,
    );
  });

  await test("classdump.inspect method entries have expected keys", async () => {
    const detail = classdump.inspect("NSObject");
    const m = detail.methods[0];
    assertKeys(
      m as unknown as Record<string, unknown>,
      ["name", "impl", "types"],
      "method entry",
    );
    assertType(m.name, "string", "method name");
    assertType(m.impl, "string", "method impl");
    assertType(m.types, "string", "method types");
    console.log(`    sample method: ${m.name}`);
  });

  await test("classdump.inspect on nonexistent class throws", async () => {
    let threw = false;
    try {
      classdump.inspect("__IGFNonExistentClass12345__");
    } catch (_) {
      threw = true;
    }
    assert(threw, "should throw for nonexistent class");
    console.log("    correctly threw for nonexistent class");
  });
}

async function testCookies() {
  console.log("\n--- cookies ---");

  await test("cookies.list returns array of cookies", async () => {
    const all = cookies.list();
    assertArray(all, "list");
    console.log(`    ${all.length} cookies`);
    if (all.length > 0) {
      const c = all[0];
      assertKeys(
        c as unknown as Record<string, unknown>,
        ["name", "value", "domain", "path", "isSecure", "isHTTPOnly"],
        "cookie entry",
      );
      assertType(c.name, "string", "name");
      assertType(c.value, "string", "value");
      assertType(c.domain, "string", "domain");
      console.log(`    first: name=${c.name} domain=${c.domain}`);
    }
  });

  skip("cookies.add / cookies.remove", "side-effect: modifies cookie storage");
  skip("cookies.clear", "side-effect: clears all cookies");
}

async function testFs() {
  console.log("\n--- fs ---");

  const { home, bundle } = fs.roots();

  await test("fs.ls home returns app home directory listing", async () => {
    const result = fs.ls(home);
    assertKeys(
      result as unknown as Record<string, unknown>,
      ["cwd", "list"],
      "ls result",
    );
    assertType(result.cwd, "string", "cwd");
    assertArray(result.list, "list");
    assert(result.cwd.startsWith("/"), "cwd should be absolute path");
    console.log(`    cwd=${result.cwd}`);
    console.log(`    ${result.list.length} entries`);
    if (result.list.length > 0) {
      const first = result.list[0];
      assertKeys(
        first as unknown as Record<string, unknown>,
        ["name", "dir", "size", "created", "symlink", "writable"],
        "MetaData",
      );
      console.log(
        `    first: ${first.name} (dir=${first.dir} size=${first.size})`,
      );
    }
  });

  await test("fs.ls bundle returns app bundle directory listing", async () => {
    const result = fs.ls(bundle);
    assertArray(result.list, "list");
    assertNonEmpty(result.list, "list");
    assert(result.cwd.includes(".app"), "bundle path should contain .app");
    console.log(`    cwd=${result.cwd}`);
    console.log(`    ${result.list.length} entries`);
  });

  await test("fs.ls with invalid path throws", async () => {
    let threw = false;
    try {
      fs.ls("/nonexistent_path_12345");
    } catch (_) {
      threw = true;
    }
    assert(threw, "should throw for invalid path");
    console.log("    correctly threw for invalid path");
  });

  await test("fs.attrs on app home dir returns stat fields", async () => {
    const result = fs.ls(home);
    const a = fs.attrs(result.cwd);
    assertKeys(
      a as unknown as Record<string, unknown>,
      ["uid", "gid", "perm", "size", "type", "owner", "group"],
      "attrs",
    );
    assertType(a.uid, "number", "uid");
    assertType(a.gid, "number", "gid");
    assertType(a.perm, "number", "perm");
    console.log(
      `    uid=${a.uid} gid=${a.gid} perm=${a.perm.toString(8)} type=${a.type}`,
    );
  });

  await test("fs.text reads a text file", async () => {
    const testPath = home + "/igf_text_test_" + Date.now() + ".txt";
    fs.saveText(testPath, "text read test content\n");

    const content = fs.text(testPath);
    assertType(content, "string", "content");
    assert(content.length > 0, "content should be non-empty");
    assert(
      content === "text read test content\n",
      `content mismatch: ${json(content)}`,
    );
    console.log(`    read ${content.length} chars`);

    fs.rm(testPath);
  });

  await test("fs.saveText + fs.text round-trip", async () => {
    const testPath = home + "/igf_test_" + Date.now() + ".txt";
    const testContent = "hello from igf test\n";

    const ok = fs.saveText(testPath, testContent);
    assert(ok === true, "saveText should return true");

    const readBack = fs.text(testPath);
    assert(readBack === testContent, `round-trip mismatch: ${json(readBack)}`);
    console.log(`    wrote and read back ${testContent.length} chars`);

    // cleanup
    fs.rm(testPath);
    console.log("    cleaned up test file");
  });

  await test("fs.data reads binary data", async () => {
    const testPath = home + "/igf_bin_test_" + Date.now() + ".bin";
    fs.saveText(testPath, "binary test data");

    const buf = fs.data(testPath);
    assert(buf !== null, "data should not return null");
    assert(buf!.byteLength > 0, "data should be non-empty");
    console.log(`    read ${buf!.byteLength} bytes`);

    fs.rm(testPath);
  });

  await test("fs.preview reads limited data", async () => {
    const testPath = home + "/igf_preview_test_" + Date.now() + ".txt";
    fs.saveText(testPath, "preview test data content");

    const buf = fs.preview(testPath);
    assert(buf !== null, "preview should not return null");
    assert(buf!.byteLength > 0, "preview should be non-empty");
    console.log(`    preview read ${buf!.byteLength} bytes`);

    fs.rm(testPath);
  });

  await test("fs.cp copies a file", async () => {
    const srcPath = home + "/igf_cp_src_" + Date.now() + ".txt";
    const dstPath = home + "/igf_cp_dst_" + Date.now() + ".txt";

    fs.saveText(srcPath, "copy test content");
    const ok = fs.cp(srcPath, dstPath);
    assert(ok === true, "cp should return true");

    const content = fs.text(dstPath);
    assert(content === "copy test content", `copy mismatch: ${json(content)}`);
    console.log("    copied and verified");

    fs.rm(srcPath);
    fs.rm(dstPath);
  });

  await test("fs.mv renames a file", async () => {
    const srcPath = home + "/igf_mv_src_" + Date.now() + ".txt";
    const dstPath = home + "/igf_mv_dst_" + Date.now() + ".txt";

    fs.saveText(srcPath, "move test content");
    const ok = fs.mv(srcPath, dstPath);
    assert(ok === true, "mv should return true");

    const content = fs.text(dstPath);
    assert(content === "move test content", `move mismatch: ${json(content)}`);

    // src should no longer exist
    let srcExists = true;
    try {
      fs.attrs(srcPath);
    } catch (_) {
      srcExists = false;
    }
    assert(!srcExists, "source should not exist after mv");
    console.log("    moved and verified");

    fs.rm(dstPath);
  });

  await test("fs.plist reads a plist file", async () => {
    // read the app's own Info.plist
    const plistPath = bundle + "/Info.plist";
    let threw = false;
    try {
      const p = fs.plist(plistPath);
      assertType(p, "object", "plist");
      console.log(`    read plist from ${plistPath}`);
    } catch (_) {
      // some apps may not have a readable Info.plist on disk
      threw = true;
      console.log(
        "    Info.plist not readable from disk (expected for some apps)",
      );
    }
  });
}

async function testKeychain() {
  console.log("\n--- keychain ---");

  await test("keychain.list returns array of items", async () => {
    const items = keychain.list();
    assertArray(items, "list");
    console.log(`    ${items.length} keychain items`);
    if (items.length > 0) {
      const first = items[0];
      assertKeys(
        first as unknown as Record<string, unknown>,
        ["clazz"],
        "keychain item",
      );
      console.log(
        `    first: clazz=${first.clazz} service=${first.service} account=${first.account}`,
      );
    }
  });

  skip("keychain.remove", "side-effect: removes keychain item");
}

async function testUserDefaults() {
  console.log("\n--- userdefaults ---");

  await test("userdefaults.enumerate returns dict of entries", async () => {
    const defaults = userdefaults.enumerate();
    assertType(defaults, "object", "enumerate");
    const keys = Object.keys(defaults);
    assert(keys.length > 0, "should have at least one user default");
    console.log(`    ${keys.length} user defaults`);

    // check structure of first entry
    const firstKey = keys[0];
    const entry = defaults[firstKey];
    assertKeys(
      entry as unknown as Record<string, unknown>,
      ["type", "readable", "value"],
      "entry",
    );
    assertType(entry.type, "string", "type");
    assertType(entry.readable, "string", "readable");
    console.log(`    first: key=${firstKey} type=${entry.type}`);
  });

  skip("userdefaults.update", "side-effect: modifies user defaults");
  skip("userdefaults.remove", "side-effect: removes user default key");
}

async function testLsof() {
  console.log("\n--- lsof ---");

  await test("lsof.fds returns open file descriptors", async () => {
    const fds = lsof.fds();
    assertArray(fds, "fds");
    assertNonEmpty(fds, "fds");

    const vnodes = fds.filter((fd) => fd.type === "vnode");
    const sockets = fds.filter((fd) => fd.type === "socket");
    console.log(
      `    ${fds.length} open fds (${vnodes.length} vnodes, ${sockets.length} sockets)`,
    );

    if (vnodes.length > 0) {
      const v = vnodes[0];
      assertType(v.fd, "number", "fd");
      assert("path" in v, "vnode should have path");
      console.log(
        `    first vnode: fd=${v.fd} path=${(v as { path: string }).path}`,
      );
    }

    if (sockets.length > 0) {
      const s = sockets[0];
      assertType(s.fd, "number", "fd");
      assert("protocol" in s, "socket should have protocol");
      console.log(
        `    first socket: fd=${s.fd} protocol=${(s as { protocol: string }).protocol}`,
      );
    }
  });
}

// ---------------------------------------------------------------------------
// runner
// ---------------------------------------------------------------------------

async function run() {
  console.log("=== fruity module tests ===");

  const bundleId = ObjC.classes.NSBundle.mainBundle()
    .bundleIdentifier()
    .toString();
  console.log(`target bundle: ${bundleId}\n`);

  await testInfo();
  await testChecksec();
  await testEntitlements();
  await testClassdump();
  await testCookies();
  await testFs();
  await testKeychain();
  await testUserDefaults();
  await testLsof();

  summary();
}

ObjC.schedule(ObjC.mainQueue, () => {
  run().catch((e) => {
    console.log(
      `\nFATAL: ${e instanceof Error ? e.stack || e.message : String(e)}`,
    );
  });
});

```

`agent/src/fruity/typings.ts`:

```ts
import ObjC from "frida-objc-bridge";
export interface NSObject extends ObjC.Object {
  respondsToSelector_(sel: NativePointer): boolean;
  isKindOfClass_(cls: ObjC.Object): boolean;
  toString(): string;
}

export interface NSNumber extends NSObject {
  intValue(): number;
}

export type _Nullable<T> = T | null;
export type StringLike = string | NSString;

export interface NSString extends NSObject {
  UTF8String(): NativePointer;
  writeToFile_atomically_encoding_error_(
    path: StringLike,
    atomically: boolean,
    encoding: number,
    error: NativePointer,
  ): boolean;
  lastPathComponent(): NSString;
  stringByDeletingLastPathComponent(): NSString;
  stringByDeletingPathExtension(): NSString;
  stringByAppendingPathComponent_(str: StringLike): NSString;
}

export interface NSArray<T> extends NSObject {
  count(): number;
  objectAtIndex_(index: number): T;
}

export interface NSSet<T> extends NSObject {
  count(): number;
  allObjects(): NSArray<T>;
}

export interface NSURL extends NSObject {
  absoluteString(): string;
  path(): NSString | null;
}

export interface NSDictionary<K, V> extends NSObject {
  objectForKey_(key: K): _Nullable<V>;
  allKeys(): NSArray<K>;
  mutableCopy(): NSMutableDictionary<K, V>;
  copy(): NSDictionary<K, V>;
}

export interface NSMutableDictionary<K, V> extends NSDictionary<K, V> {
  setObject_forKey_(obj: V | string | number, key: K | string): void;
  removeObjectForKey_(key: K | string): void;
}

export interface NSDate extends NSObject {
  timeIntervalSince1970(): number;
}

export interface NSError extends NSObject {
  code(): number;
  domain(): NSString;
  userInfo(): NSDictionary<NSString, NSObject>;
}

export interface NSData extends NSObject {
  writeToFile_atomically_(path: StringLike, atomically: boolean): boolean;
  bytes(): NativePointer;
  length(): number;
}

export interface NSMutableData extends NSData {
  appendData_(data: NSData): void;
}

export interface NSURLRequest extends NSObject {
  URL(): NSURL;
  HTTPMethod(): NSString;
  HTTPBody(): NSData | null;
  allHTTPHeaderFields(): NSDictionary<NSString, NSString> | null;
}

export interface NSURLResponse extends NSObject {
  URL(): NSURL;
  MIMEType(): NSString | null;
  expectedContentLength(): number;
}

export interface NSHTTPURLResponse extends NSURLResponse {
  statusCode(): number;
  allHeaderFields(): NSDictionary<NSString, NSString> | null;
}

export interface NSURLSessionTask extends NSObject {
  taskIdentifier(): number;
  originalRequest(): NSURLRequest | null;
  currentRequest(): NSURLRequest | null;
  response(): NSURLResponse | null;
  state(): number;
  delegate(): NSObject | null;
  setDelegate_(delegate: NSObject): void;
}

export type NSURLSessionDataTask = NSURLSessionTask;
export type NSURLSessionDownloadTask = NSURLSessionTask;
export type NSURLSessionWebSocketTask = NSURLSessionTask;

export interface NSURLSessionWebSocketMessage extends NSObject {
  type(): number; // 0 = data, 1 = string
  data(): NSData | null;
  string(): NSString | null;
}

export function wrapObjC<T extends NSObject>(ptr: NativePointer): T {
  return new ObjC.Object(ptr) as T;
}

export type NSFileAttribute = NSDictionary<NSString, NSObject>;

export interface NSFileManager extends NSObject {
  contentsOfDirectoryAtPath_error_(
    path: StringLike,
    pError: NativePointer,
  ): NSArray<NSString>;
  fileExistsAtPath_isDirectory_(
    path: StringLike,
    pIsDir: NativePointer,
  ): boolean;
  attributesOfItemAtPath_error_(
    path: StringLike,
    pError: NativePointer,
  ): NSFileAttribute;
  removeItemAtPath_error_(path: StringLike, pError: NativePointer): boolean;
  moveItemAtPath_toPath_error_(
    src: StringLike,
    dst: StringLike,
    pError: NativePointer,
  ): boolean;
  copyItemAtPath_toPath_error_(
    src: StringLike,
    dst: StringLike,
    pError: NativePointer,
  ): boolean;
  createDirectoryAtPath_withIntermediateDirectories_attributes_error_(
    path: StringLike,
    intermediate: boolean,
    attributes: _Nullable<NSFileAttribute>,
    pError: NativePointer,
  ): boolean;
  contentsOfDirectoryAtURL_includingPropertiesForKeys_options_error_(
    url: NSURL,
    keys: NSArray<NSString>,
    options: number,
    pError: NativePointer,
  ): NSArray<NSURL>;
}

```

`agent/src/lib/polyfill.ts`:

```ts
interface Module16 {
  findExportByName(
    moduleName: string | null,
    exportName: string,
  ): NativePointer | null;
  getExportByName(moduleName: string | null, exportName: string): NativePointer;
}

export function findGlobalExport(name: string) {
  if ("findExportByName" in Module)
    return (Module as unknown as Module16).findExportByName(null, name);

  return Module.findGlobalExportByName(name);
}

export function getGlobalExport(name: string) {
  if ("getExportByName" in Module)
    return (Module as unknown as Module16).getExportByName(null, name);

  return Module.getGlobalExportByName(name);
}

```

`agent/src/lib/posix.ts`:

```ts
import { getGlobalExport } from "@/lib/polyfill.js";

interface PosixApi {
  open: NativeFunction<number, [NativePointer, number, number]>;
  read: NativeFunction<number, [number, NativePointer, number]>;
  close: NativeFunction<number, [number]>;
  lseek: NativeFunction<Int64, [number, Int64 | number, number]>;
  rename: NativeFunction<number, [NativePointer, NativePointer]>;
  unlink: NativeFunction<number, [NativePointer]>;
  access: NativeFunction<number, [NativePointer, number]>;
  mkdir: NativeFunction<number, [NativePointer, number]>;
}

let cachedApi: PosixApi;

function getApi(): PosixApi {
  if (cachedApi) return cachedApi;
  cachedApi = {
    open: new NativeFunction(getGlobalExport("open"), "int", [
      "pointer",
      "int",
      "int",
    ]),
    read: new NativeFunction(getGlobalExport("read"), "int", [
      "int",
      "pointer",
      "int",
    ]),
    close: new NativeFunction(getGlobalExport("close"), "int", ["int"]),
    lseek: new NativeFunction(getGlobalExport("lseek"), "int64", [
      "int",
      "int64",
      "int",
    ]),
    rename: new NativeFunction(getGlobalExport("rename"), "int", [
      "pointer",
      "pointer",
    ]),
    unlink: new NativeFunction(getGlobalExport("unlink"), "int", ["pointer"]),
    access: new NativeFunction(getGlobalExport("access"), "int", [
      "pointer",
      "int",
    ]),
    mkdir: new NativeFunction(getGlobalExport("mkdir"), "int", [
      "pointer",
      "int",
    ]),
  };
  return cachedApi;
}

const O_RDONLY = 0;
const SEEK_END = 2;
const SEEK_SET = 0;
const W_OK = 2;

export function readFile(filePath: string, limit?: number): ArrayBuffer | null {
  if (limit !== undefined && limit <= 0) return new ArrayBuffer(0);

  const api = getApi();
  const pathBuf = Memory.allocUtf8String(filePath);
  const fd = api.open(pathBuf, O_RDONLY, 0) as number;
  if (fd < 0) return null;

  const size = Number(api.lseek(fd, 0, SEEK_END));
  const toRead = limit ? Math.min(size, limit) : size;
  if (toRead <= 0) {
    api.close(fd);
    return new ArrayBuffer(0);
  }

  api.lseek(fd, 0, SEEK_SET);
  const buf = Memory.alloc(toRead);
  let total = 0;
  while (total < toRead) {
    const n = api.read(fd, buf.add(total), toRead - total) as number;
    if (n <= 0) break;
    total += n;
  }

  api.close(fd);
  return buf.readByteArray(total);
}

export function rename(src: string, dst: string): boolean {
  const api = getApi();
  const srcBuf = Memory.allocUtf8String(src);
  const dstBuf = Memory.allocUtf8String(dst);
  const result = api.rename(srcBuf, dstBuf) as number;
  if (result !== 0) throw new Error(`rename failed: ${src} -> ${dst}`);
  return true;
}

export function unlink(path: string): void {
  const api = getApi();
  api.unlink(Memory.allocUtf8String(path));
}

export function isWritable(path: string): boolean {
  const api = getApi();
  const pathBuf = Memory.allocUtf8String(path);
  return (api.access(pathBuf, W_OK) as number) === 0;
}

```

`agent/src/transport.ts`:

```ts
import ObjC from "frida-objc-bridge";
import Java from "frida-java-bridge";

import { mkdirp as objcMkdirp } from "./fruity/modules/fs.js";
import { mkdirp as javaMkdirp } from "./droid/modules/fs.js";

import fs from "fs";
import path from "path";
import RemoteStreamController, { type Packet } from "frida-remote-stream";

rpc.exports.len = function (path: string) {
  return fs.statSync(path).size;
};

const MH_MAGIC_64 = 0xfeedfacf;
const LC_ENCRYPTION_INFO_64 = 0x2c;
const HEADER_SIZE_64 = 8 * 4; // 32 bytes
const DUMP_CHUNK_SIZE = 1024 * 1024; // 1MB

interface EncryptionInfo {
  cryptoff: number;
  cryptsize: number;
  cryptid: number;
  encCmdOffset: number;
}

function parseEncryptionInfo(path: string): EncryptionInfo | null {
  const fd = new File(path, "r");
  try {
    const headerBuf = fd.readBytes(HEADER_SIZE_64);
    const header = new DataView(headerBuf);

    const magic = header.getUint32(0, true);
    if (magic !== MH_MAGIC_64) return null;

    const ncmds = header.getUint32(16, true);
    const sizeOfCmds = header.getUint32(20, true);

    const cmdsBuf = fd.readBytes(sizeOfCmds);
    const cmds = new DataView(cmdsBuf);

    let offset = 0;
    for (let i = 0; i < ncmds && offset + 8 <= cmdsBuf.byteLength; i++) {
      const cmd = cmds.getUint32(offset, true);
      const cmdsize = cmds.getUint32(offset + 4, true);

      if (cmd === LC_ENCRYPTION_INFO_64) {
        return {
          cryptoff: cmds.getUint32(offset + 8, true),
          cryptsize: cmds.getUint32(offset + 12, true),
          cryptid: cmds.getUint32(offset + 16, true),
          encCmdOffset: HEADER_SIZE_64 + offset,
        };
      }

      offset += cmdsize;
    }

    return null;
  } finally {
    fd.close();
  }
}

function waitForAck() {
  recv("ack", () => {}).wait();
}

function sendChunk(data: ArrayBuffer) {
  send({ event: "data" }, data);
  waitForAck();
}

function streamFromDisk(
  path: string,
  offset: number,
  size: number,
  patch?: { offset: number; data: ArrayBuffer },
) {
  const fd = new File(path, "r");
  try {
    fd.seek(offset);
    let remaining = size;
    let filePos = offset;

    while (remaining > 0) {
      const toRead = Math.min(DUMP_CHUNK_SIZE, remaining);
      const chunk = fd.readBytes(toRead);

      if (patch && filePos <= patch.offset && patch.offset < filePos + toRead) {
        const patchOffset = patch.offset - filePos;
        const dst = new Uint8Array(chunk);
        const src = new Uint8Array(patch.data);
        for (let i = 0; i < src.length; i++) {
          dst[patchOffset + i] = src[i];
        }
      }

      sendChunk(chunk);
      remaining -= toRead;
      filePos += toRead;
    }
  } finally {
    fd.close();
  }
}

function streamFromMemory(base: NativePointer, offset: number, size: number) {
  let remaining = size;
  let p = base.add(offset);

  while (remaining > 0) {
    const toRead = Math.min(DUMP_CHUNK_SIZE, remaining);
    const chunk = p.readByteArray(toRead);
    if (chunk) sendChunk(chunk);
    remaining -= toRead;
    p = p.add(toRead);
  }
}

rpc.exports.dump = function (path: string): void {
  let fileSize: number;
  try {
    fileSize = fs.statSync(path).size;
  } catch {
    send({ event: "error", message: `file not found: ${path}` });
    return;
  }

  const encInfo = parseEncryptionInfo(path);

  if (!encInfo || encInfo.cryptid === 0) {
    send({ event: "info", size: fileSize });
    waitForAck();
    streamFromDisk(path, 0, fileSize);
    send({ event: "end" });
    return;
  }

  const mod = Module.load(path);
  const range = Process.findRangeByAddress(mod.base);
  const fatOffset = range!.file!.offset;

  send({ event: "info", size: fileSize });
  waitForAck();

  // Phase A: disk [0, fatOffset+cryptoff) — with LC_ENCRYPTION_INFO patch
  const phaseASize = fatOffset + encInfo.cryptoff;
  if (phaseASize > 0) {
    const zeroPatch = new ArrayBuffer(12);
    streamFromDisk(path, 0, phaseASize, {
      offset: fatOffset + encInfo.encCmdOffset + 8,
      data: zeroPatch,
    });
  }

  // Phase B: memory [mod.base+cryptoff, mod.base+cryptoff+cryptsize) — decrypted
  streamFromMemory(mod.base, encInfo.cryptoff, encInfo.cryptsize);

  // Phase C: disk [fatOffset+cryptoff+cryptsize, fileSize) — remainder
  const phaseCStart = fatOffset + encInfo.cryptoff + encInfo.cryptsize;
  const phaseCSize = fileSize - phaseCStart;
  if (phaseCSize > 0) {
    streamFromDisk(path, phaseCStart, phaseCSize);
  }

  send({ event: "end" });
};

/**
 * download a file via stream
 * @param path source path
 */

rpc.exports.pull = function (path: string) {
  const label = `${Process.id}:${path}`;
  const controller = new RemoteStreamController();
  controller.events.on("send", ({ stanza, data }: Packet) => {
    send(
      {
        name: "+stream",
        payload: stanza,
      },
      data?.buffer as ArrayBuffer,
    );
  });

  function onStreamMessage(
    message: { payload: { [key: string]: string } },
    data: ArrayBuffer | null,
  ) {
    controller.receive({
      stanza: message.payload,
      data: data as unknown as Buffer<ArrayBufferLike>,
    });
    recv("+stream", onStreamMessage);
  }

  recv("+stream", onStreamMessage);
  fs.createReadStream(path).pipe(
    controller.open(label, { meta: { type: "data" } }),
  );
};

function mkdirp(path: string) {
  if (ObjC.available) return objcMkdirp(path);
  else if (Java.available) return javaMkdirp(path);

  throw new Error("mkdirp is not supported on this platform");
}

/**
 * upload a file via stream
 * @param path destination path
 */
rpc.exports.push = function (dest: string) {
  const dir = path.dirname(dest);
  mkdirp(dir);

  const streams = new RemoteStreamController();

  streams.events.on("send", ({ stanza, data }: Packet) => {
    send(
      {
        name: "+stream",
        payload: stanza,
      },
      data?.buffer as ArrayBuffer,
    );
  });

  function onStreamMessage(
    message: { payload: Packet },
    data: ArrayBuffer | null,
  ) {
    const packet: Packet = {
      stanza: message.payload,
      data: data ? Buffer.from(data) : null,
    };
    streams.receive(packet);
    recv("+stream", onStreamMessage);
  }
  recv("+stream", onStreamMessage);

  streams.events.on("stream", (stream) =>
    stream.pipe(fs.createWriteStream(dest)),
  );
};

```

`agent/tsconfig.json`:

```json
{
  "compilerOptions": {
    "target": "ES2022",
    "lib": ["ES2022"],
    "module": "Node16",
    "strict": true,
    "noEmit": true,
    "paths": {
      "@/*": ["./src/*"],
    },
  },
  "include": ["src/**/*.ts"],
}

```

`agent/tsconfig.type-droid.json`:

```json
{
  "extends": "./tsconfig.json",
  "compilerOptions": {
    "declaration": true,
    "experimentalDecorators": true,
    "emitDeclarationOnly": true,
    "outDir": "types",
    "target": "ES2019",
    "skipLibCheck": true,
    "noEmit": false,
  },
  "files": ["src/droid/registry.ts"],
  "include": [],
}

```

`agent/tsconfig.type-fruity.json`:

```json
{
  "extends": "./tsconfig.json",
  "compilerOptions": {
    "declaration": true,
    "experimentalDecorators": true,
    "emitDeclarationOnly": true,
    "outDir": "types",
    "target": "ES2019",
    "skipLibCheck": true,
    "noEmit": false,
  },
  "files": ["src/fruity/registry.ts"],
  "include": [],
}

```

`bun.lock`:

```lock
{
  "lockfileVersion": 1,
  "configVersion": 1,
  "workspaces": {
    "": {
      "name": "igf",
      "dependencies": {
        "@hono/node-server": "^1.19.9",
        "@types/better-sqlite3": "^7.6.13",
        "@types/bun": "^1.3.6",
        "better-sqlite3": "^12.6.2",
        "drizzle-orm": "^0.45.1",
        "env-paths": "^3.0.0",
        "frida": "^17.6.2",
        "frida-remote-stream": "^6.0.3",
        "frida16": "npm:frida@^16.7.19",
        "hono": "^4.11.6",
        "socket.io": "^4.8.3",
      },
      "devDependencies": {
        "@types/node": "^24.10.9",
        "@typescript/native-preview": "^7.0.0-dev.20260222.1",
        "drizzle-kit": "^0.31.9",
        "socket.io-client": "^4.8.3",
        "tsdown": "^0.20.1",
        "typescript": "^5.9.3",
      },
    },
  },
  "trustedDependencies": [
    "better-sqlite3",
    "frida",
    "frida16",
  ],
  "patchedDependencies": {
    "frida@16.7.19": "patches/frida@16.7.19.patch",
    "frida@17.6.2": "patches/frida@17.6.2.patch",
  },
  "packages": {
    "@babel/generator": ["@babel/generator@8.0.0-beta.4", "", { "dependencies": { "@babel/parser": "^8.0.0-beta.4", "@babel/types": "^8.0.0-beta.4", "@jridgewell/gen-mapping": "^0.3.12", "@jridgewell/trace-mapping": "^0.3.28", "@types/jsesc": "^2.5.0", "jsesc": "^3.0.2" } }, "sha512-5xRfRZk6wx1BRu2XnTE8cTh2mx1ixrZ3/vpn7p/RCJpgctL6pexVVHE3eqtwlYvHhPAuOYCAlnsAyXpBdmfh5Q=="],

    "@babel/helper-string-parser": ["@babel/helper-string-parser@8.0.0-beta.4", "", {}, "sha512-FGwbdQ/I2nJXXfyxa7dT0Fr/zPWwgX7m+hNVj0HrIHYJtyLxSQeQY1Kd8QkAYviQJV3OWFlRLuGd5epF03bdQg=="],

    "@babel/helper-validator-identifier": ["@babel/helper-validator-identifier@8.0.0-beta.4", "", {}, "sha512-6t0IaUEzlinbLmsGIvBZIHEJGjuchx+cMj+FbS78zL17tucYervgbwO07V5/CgBenVraontpmyMCTVyqCfxhFQ=="],

    "@babel/parser": ["@babel/parser@8.0.0-beta.4", "", { "dependencies": { "@babel/types": "^8.0.0-beta.4" }, "bin": "./bin/babel-parser.js" }, "sha512-fBcUqUN3eenLyg25QFkOwY1lmV6L0RdG92g6gxyS2CVCY8kHdibkQz1+zV3bLzxcvNnfHoi3i9n5Dci+g93acg=="],

    "@babel/types": ["@babel/types@8.0.0-beta.4", "", { "dependencies": { "@babel/helper-string-parser": "^8.0.0-beta.4", "@babel/helper-validator-identifier": "^8.0.0-beta.4" } }, "sha512-xjk2xqYp25ePzAs0I08hN2lrbUDDQFfCjwq6MIEa8HwHa0WK8NfNtdvtXod8Ku2CbE1iui7qwWojGvjQiyrQeA=="],

    "@drizzle-team/brocli": ["@drizzle-team/brocli@0.10.2", "", {}, "sha512-z33Il7l5dKjUgGULTqBsQBQwckHh5AbIuxhdsIxDDiZAzBOrZO6q9ogcWC65kU382AfynTfgNumVcNIjuIua6w=="],

    "@emnapi/core": ["@emnapi/core@1.8.1", "", { "dependencies": { "@emnapi/wasi-threads": "1.1.0", "tslib": "^2.4.0" } }, "sha512-AvT9QFpxK0Zd8J0jopedNm+w/2fIzvtPKPjqyw9jwvBaReTTqPBk9Hixaz7KbjimP+QNz605/XnjFcDAL2pqBg=="],

    "@emnapi/runtime": ["@emnapi/runtime@1.8.1", "", { "dependencies": { "tslib": "^2.4.0" } }, "sha512-mehfKSMWjjNol8659Z8KxEMrdSJDDot5SXMq00dM8BN4o+CLNXQ0xH2V7EchNHV4RmbZLmmPdEaXZc5H2FXmDg=="],

    "@emnapi/wasi-threads": ["@emnapi/wasi-threads@1.1.0", "", { "dependencies": { "tslib": "^2.4.0" } }, "sha512-WI0DdZ8xFSbgMjR1sFsKABJ/C5OnRrjT06JXbZKexJGrDuPTzZdDYfFlsgcCXCyf+suG5QU2e/y1Wo2V/OapLQ=="],

    "@esbuild-kit/core-utils": ["@esbuild-kit/core-utils@3.3.2", "", { "dependencies": { "esbuild": "~0.18.20", "source-map-support": "^0.5.21" } }, "sha512-sPRAnw9CdSsRmEtnsl2WXWdyquogVpB3yZ3dgwJfe8zrOzTsV7cJvmwrKVa+0ma5BoiGJ+BoqkMvawbayKUsqQ=="],

    "@esbuild-kit/esm-loader": ["@esbuild-kit/esm-loader@2.6.5", "", { "dependencies": { "@esbuild-kit/core-utils": "^3.3.2", "get-tsconfig": "^4.7.0" } }, "sha512-FxEMIkJKnodyA1OaCUoEvbYRkoZlLZ4d/eXFu9Fh8CbBBgP5EmZxrfTRyN0qpXZ4vOvqnE5YdRdcrmUUXuU+dA=="],

    "@esbuild/aix-ppc64": ["@esbuild/aix-ppc64@0.25.12", "", { "os": "aix", "cpu": "ppc64" }, "sha512-Hhmwd6CInZ3dwpuGTF8fJG6yoWmsToE+vYgD4nytZVxcu1ulHpUQRAB1UJ8+N1Am3Mz4+xOByoQoSZf4D+CpkA=="],

    "@esbuild/android-arm": ["@esbuild/android-arm@0.25.12", "", { "os": "android", "cpu": "arm" }, "sha512-VJ+sKvNA/GE7Ccacc9Cha7bpS8nyzVv0jdVgwNDaR4gDMC/2TTRc33Ip8qrNYUcpkOHUT5OZ0bUcNNVZQ9RLlg=="],

    "@esbuild/android-arm64": ["@esbuild/android-arm64@0.25.12", "", { "os": "android", "cpu": "arm64" }, "sha512-6AAmLG7zwD1Z159jCKPvAxZd4y/VTO0VkprYy+3N2FtJ8+BQWFXU+OxARIwA46c5tdD9SsKGZ/1ocqBS/gAKHg=="],

    "@esbuild/android-x64": ["@esbuild/android-x64@0.25.12", "", { "os": "android", "cpu": "x64" }, "sha512-5jbb+2hhDHx5phYR2By8GTWEzn6I9UqR11Kwf22iKbNpYrsmRB18aX/9ivc5cabcUiAT/wM+YIZ6SG9QO6a8kg=="],

    "@esbuild/darwin-arm64": ["@esbuild/darwin-arm64@0.25.12", "", { "os": "darwin", "cpu": "arm64" }, "sha512-N3zl+lxHCifgIlcMUP5016ESkeQjLj/959RxxNYIthIg+CQHInujFuXeWbWMgnTo4cp5XVHqFPmpyu9J65C1Yg=="],

    "@esbuild/darwin-x64": ["@esbuild/darwin-x64@0.25.12", "", { "os": "darwin", "cpu": "x64" }, "sha512-HQ9ka4Kx21qHXwtlTUVbKJOAnmG1ipXhdWTmNXiPzPfWKpXqASVcWdnf2bnL73wgjNrFXAa3yYvBSd9pzfEIpA=="],

    "@esbuild/freebsd-arm64": ["@esbuild/freebsd-arm64@0.25.12", "", { "os": "freebsd", "cpu": "arm64" }, "sha512-gA0Bx759+7Jve03K1S0vkOu5Lg/85dou3EseOGUes8flVOGxbhDDh/iZaoek11Y8mtyKPGF3vP8XhnkDEAmzeg=="],

    "@esbuild/freebsd-x64": ["@esbuild/freebsd-x64@0.25.12", "", { "os": "freebsd", "cpu": "x64" }, "sha512-TGbO26Yw2xsHzxtbVFGEXBFH0FRAP7gtcPE7P5yP7wGy7cXK2oO7RyOhL5NLiqTlBh47XhmIUXuGciXEqYFfBQ=="],

    "@esbuild/linux-arm": ["@esbuild/linux-arm@0.25.12", "", { "os": "linux", "cpu": "arm" }, "sha512-lPDGyC1JPDou8kGcywY0YILzWlhhnRjdof3UlcoqYmS9El818LLfJJc3PXXgZHrHCAKs/Z2SeZtDJr5MrkxtOw=="],

    "@esbuild/linux-arm64": ["@esbuild/linux-arm64@0.25.12", "", { "os": "linux", "cpu": "arm64" }, "sha512-8bwX7a8FghIgrupcxb4aUmYDLp8pX06rGh5HqDT7bB+8Rdells6mHvrFHHW2JAOPZUbnjUpKTLg6ECyzvas2AQ=="],

    "@esbuild/linux-ia32": ["@esbuild/linux-ia32@0.25.12", "", { "os": "linux", "cpu": "ia32" }, "sha512-0y9KrdVnbMM2/vG8KfU0byhUN+EFCny9+8g202gYqSSVMonbsCfLjUO+rCci7pM0WBEtz+oK/PIwHkzxkyharA=="],

    "@esbuild/linux-loong64": ["@esbuild/linux-loong64@0.25.12", "", { "os": "linux", "cpu": "none" }, "sha512-h///Lr5a9rib/v1GGqXVGzjL4TMvVTv+s1DPoxQdz7l/AYv6LDSxdIwzxkrPW438oUXiDtwM10o9PmwS/6Z0Ng=="],

    "@esbuild/linux-mips64el": ["@esbuild/linux-mips64el@0.25.12", "", { "os": "linux", "cpu": "none" }, "sha512-iyRrM1Pzy9GFMDLsXn1iHUm18nhKnNMWscjmp4+hpafcZjrr2WbT//d20xaGljXDBYHqRcl8HnxbX6uaA/eGVw=="],

    "@esbuild/linux-ppc64": ["@esbuild/linux-ppc64@0.25.12", "", { "os": "linux", "cpu": "ppc64" }, "sha512-9meM/lRXxMi5PSUqEXRCtVjEZBGwB7P/D4yT8UG/mwIdze2aV4Vo6U5gD3+RsoHXKkHCfSxZKzmDssVlRj1QQA=="],

    "@esbuild/linux-riscv64": ["@esbuild/linux-riscv64@0.25.12", "", { "os": "linux", "cpu": "none" }, "sha512-Zr7KR4hgKUpWAwb1f3o5ygT04MzqVrGEGXGLnj15YQDJErYu/BGg+wmFlIDOdJp0PmB0lLvxFIOXZgFRrdjR0w=="],

    "@esbuild/linux-s390x": ["@esbuild/linux-s390x@0.25.12", "", { "os": "linux", "cpu": "s390x" }, "sha512-MsKncOcgTNvdtiISc/jZs/Zf8d0cl/t3gYWX8J9ubBnVOwlk65UIEEvgBORTiljloIWnBzLs4qhzPkJcitIzIg=="],

    "@esbuild/linux-x64": ["@esbuild/linux-x64@0.25.12", "", { "os": "linux", "cpu": "x64" }, "sha512-uqZMTLr/zR/ed4jIGnwSLkaHmPjOjJvnm6TVVitAa08SLS9Z0VM8wIRx7gWbJB5/J54YuIMInDquWyYvQLZkgw=="],

    "@esbuild/netbsd-arm64": ["@esbuild/netbsd-arm64@0.25.12", "", { "os": "none", "cpu": "arm64" }, "sha512-xXwcTq4GhRM7J9A8Gv5boanHhRa/Q9KLVmcyXHCTaM4wKfIpWkdXiMog/KsnxzJ0A1+nD+zoecuzqPmCRyBGjg=="],

    "@esbuild/netbsd-x64": ["@esbuild/netbsd-x64@0.25.12", "", { "os": "none", "cpu": "x64" }, "sha512-Ld5pTlzPy3YwGec4OuHh1aCVCRvOXdH8DgRjfDy/oumVovmuSzWfnSJg+VtakB9Cm0gxNO9BzWkj6mtO1FMXkQ=="],

    "@esbuild/openbsd-arm64": ["@esbuild/openbsd-arm64@0.25.12", "", { "os": "openbsd", "cpu": "arm64" }, "sha512-fF96T6KsBo/pkQI950FARU9apGNTSlZGsv1jZBAlcLL1MLjLNIWPBkj5NlSz8aAzYKg+eNqknrUJ24QBybeR5A=="],

    "@esbuild/openbsd-x64": ["@esbuild/openbsd-x64@0.25.12", "", { "os": "openbsd", "cpu": "x64" }, "sha512-MZyXUkZHjQxUvzK7rN8DJ3SRmrVrke8ZyRusHlP+kuwqTcfWLyqMOE3sScPPyeIXN/mDJIfGXvcMqCgYKekoQw=="],

    "@esbuild/openharmony-arm64": ["@esbuild/openharmony-arm64@0.25.12", "", { "os": "none", "cpu": "arm64" }, "sha512-rm0YWsqUSRrjncSXGA7Zv78Nbnw4XL6/dzr20cyrQf7ZmRcsovpcRBdhD43Nuk3y7XIoW2OxMVvwuRvk9XdASg=="],

    "@esbuild/sunos-x64": ["@esbuild/sunos-x64@0.25.12", "", { "os": "sunos", "cpu": "x64" }, "sha512-3wGSCDyuTHQUzt0nV7bocDy72r2lI33QL3gkDNGkod22EsYl04sMf0qLb8luNKTOmgF/eDEDP5BFNwoBKH441w=="],

    "@esbuild/win32-arm64": ["@esbuild/win32-arm64@0.25.12", "", { "os": "win32", "cpu": "arm64" }, "sha512-rMmLrur64A7+DKlnSuwqUdRKyd3UE7oPJZmnljqEptesKM8wx9J8gx5u0+9Pq0fQQW8vqeKebwNXdfOyP+8Bsg=="],

    "@esbuild/win32-ia32": ["@esbuild/win32-ia32@0.25.12", "", { "os": "win32", "cpu": "ia32" }, "sha512-HkqnmmBoCbCwxUKKNPBixiWDGCpQGVsrQfJoVGYLPT41XWF8lHuE5N6WhVia2n4o5QK5M4tYr21827fNhi4byQ=="],

    "@esbuild/win32-x64": ["@esbuild/win32-x64@0.25.12", "", { "os": "win32", "cpu": "x64" }, "sha512-alJC0uCZpTFrSL0CCDjcgleBXPnCrEAhTBILpeAp7M/OFgoqtAetfBzX0xM00MUsVVPpVjlPuMbREqnZCXaTnA=="],

    "@hono/node-server": ["@hono/node-server@1.19.9", "", { "peerDependencies": { "hono": "^4" } }, "sha512-vHL6w3ecZsky+8P5MD+eFfaGTyCeOHUIFYMGpQGbrBTSmNNoxv0if69rEZ5giu36weC5saFuznL411gRX7bJDw=="],

    "@isaacs/balanced-match": ["@isaacs/balanced-match@4.0.1", "", {}, "sha512-yzMTt9lEb8Gv7zRioUilSglI0c0smZ9k5D65677DLWLtWJaXIS3CqcGyUFByYKlnUj6TkjLVs54fBl6+TiGQDQ=="],

    "@isaacs/brace-expansion": ["@isaacs/brace-expansion@5.0.0", "", { "dependencies": { "@isaacs/balanced-match": "^4.0.1" } }, "sha512-ZT55BDLV0yv0RBm2czMiZ+SqCGO7AvmOM3G/w2xhVPH+te0aKgFjmBvGlL1dH+ql2tgGO3MVrbb3jCKyvpgnxA=="],

    "@jridgewell/gen-mapping": ["@jridgewell/gen-mapping@0.3.13", "", { "dependencies": { "@jridgewell/sourcemap-codec": "^1.5.0", "@jridgewell/trace-mapping": "^0.3.24" } }, "sha512-2kkt/7niJ6MgEPxF0bYdQ6etZaA+fQvDcLKckhy1yIQOzaoKjBBjSj63/aLVjYE3qhRt5dvM+uUyfCg6UKCBbA=="],

    "@jridgewell/resolve-uri": ["@jridgewell/resolve-uri@3.1.2", "", {}, "sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw=="],

    "@jridgewell/sourcemap-codec": ["@jridgewell/sourcemap-codec@1.5.5", "", {}, "sha512-cYQ9310grqxueWbl+WuIUIaiUaDcj7WOq5fVhEljNVgRfOUhY9fy2zTvfoqWsnebh8Sl70VScFbICvJnLKB0Og=="],

    "@jridgewell/trace-mapping": ["@jridgewell/trace-mapping@0.3.31", "", { "dependencies": { "@jridgewell/resolve-uri": "^3.1.0", "@jridgewell/sourcemap-codec": "^1.4.14" } }, "sha512-zzNR+SdQSDJzc8joaeP8QQoCQr8NuYx2dIIytl1QeBEZHJ9uW6hebsrYgbz8hJwUQao3TWCMtmfV8Nu1twOLAw=="],

    "@napi-rs/wasm-runtime": ["@napi-rs/wasm-runtime@1.1.1", "", { "dependencies": { "@emnapi/core": "^1.7.1", "@emnapi/runtime": "^1.7.1", "@tybys/wasm-util": "^0.10.1" } }, "sha512-p64ah1M1ld8xjWv3qbvFwHiFVWrq1yFvV4f7w+mzaqiR4IlSgkqhcRdHwsGgomwzBH51sRY4NEowLxnaBjcW/A=="],

    "@oxc-project/types": ["@oxc-project/types@0.110.0", "", {}, "sha512-6Ct21OIlrEnFEJk5LT4e63pk3btsI6/TusD/GStLi7wYlGJNOl1GI9qvXAnRAxQU9zqA2Oz+UwhfTOU2rPZVow=="],

    "@quansync/fs": ["@quansync/fs@1.0.0", "", { "dependencies": { "quansync": "^1.0.0" } }, "sha512-4TJ3DFtlf1L5LDMaM6CanJ/0lckGNtJcMjQ1NAV6zDmA0tEHKZtxNKin8EgPaVX1YzljbxckyT2tJrpQKAtngQ=="],

    "@rolldown/binding-android-arm64": ["@rolldown/binding-android-arm64@1.0.0-rc.1", "", { "os": "android", "cpu": "arm64" }, "sha512-He6ZoCfv5D7dlRbrhNBkuMVIHd0GDnjJwbICE1OWpG7G3S2gmJ+eXkcNLJjzjNDpeI2aRy56ou39AJM9AD8YFA=="],

    "@rolldown/binding-darwin-arm64": ["@rolldown/binding-darwin-arm64@1.0.0-rc.1", "", { "os": "darwin", "cpu": "arm64" }, "sha512-YzJdn08kSOXnj85ghHauH2iHpOJ6eSmstdRTLyaziDcUxe9SyQJgGyx/5jDIhDvtOcNvMm2Ju7m19+S/Rm1jFg=="],

    "@rolldown/binding-darwin-x64": ["@rolldown/binding-darwin-x64@1.0.0-rc.1", "", { "os": "darwin", "cpu": "x64" }, "sha512-cIvAbqM+ZVV6lBSKSBtlNqH5iCiW933t1q8j0H66B3sjbe8AxIRetVqfGgcHcJtMzBIkIALlL9fcDrElWLJQcQ=="],

    "@rolldown/binding-freebsd-x64": ["@rolldown/binding-freebsd-x64@1.0.0-rc.1", "", { "os": "freebsd", "cpu": "x64" }, "sha512-rVt+B1B/qmKwCl1XD02wKfgh3vQPXRXdB/TicV2w6g7RVAM1+cZcpigwhLarqiVCxDObFZ7UgXCxPC7tpDoRog=="],

    "@rolldown/binding-linux-arm-gnueabihf": ["@rolldown/binding-linux-arm-gnueabihf@1.0.0-rc.1", "", { "os": "linux", "cpu": "arm" }, "sha512-69YKwJJBOFprQa1GktPgbuBOfnn+EGxu8sBJ1TjPER+zhSpYeaU4N07uqmyBiksOLGXsMegymuecLobfz03h8Q=="],

    "@rolldown/binding-linux-arm64-gnu": ["@rolldown/binding-linux-arm64-gnu@1.0.0-rc.1", "", { "os": "linux", "cpu": "arm64" }, "sha512-9JDhHUf3WcLfnViFWm+TyorqUtnSAHaCzlSNmMOq824prVuuzDOK91K0Hl8DUcEb9M5x2O+d2/jmBMsetRIn3g=="],

    "@rolldown/binding-linux-arm64-musl": ["@rolldown/binding-linux-arm64-musl@1.0.0-rc.1", "", { "os": "linux", "cpu": "arm64" }, "sha512-UvApLEGholmxw/HIwmUnLq3CwdydbhaHHllvWiCTNbyGom7wTwOtz5OAQbAKZYyiEOeIXZNPkM7nA4Dtng7CLw=="],

    "@rolldown/binding-linux-x64-gnu": ["@rolldown/binding-linux-x64-gnu@1.0.0-rc.1", "", { "os": "linux", "cpu": "x64" }, "sha512-uVctNgZHiGnJx5Fij7wHLhgw4uyZBVi6mykeWKOqE7bVy9Hcxn0fM/IuqdMwk6hXlaf9fFShDTFz2+YejP+x0A=="],

    "@rolldown/binding-linux-x64-musl": ["@rolldown/binding-linux-x64-musl@1.0.0-rc.1", "", { "os": "linux", "cpu": "x64" }, "sha512-T6Eg0xWwcxd/MzBcuv4Z37YVbUbJxy5cMNnbIt/Yr99wFwli30O4BPlY8hKeGyn6lWNtU0QioBS46lVzDN38bg=="],

    "@rolldown/binding-openharmony-arm64": ["@rolldown/binding-openharmony-arm64@1.0.0-rc.1", "", { "os": "none", "cpu": "arm64" }, "sha512-PuGZVS2xNJyLADeh2F04b+Cz4NwvpglbtWACgrDOa5YDTEHKwmiTDjoD5eZ9/ptXtcpeFrMqD2H4Zn33KAh1Eg=="],

    "@rolldown/binding-wasm32-wasi": ["@rolldown/binding-wasm32-wasi@1.0.0-rc.1", "", { "dependencies": { "@napi-rs/wasm-runtime": "^1.1.1" }, "cpu": "none" }, "sha512-2mOxY562ihHlz9lEXuaGEIDCZ1vI+zyFdtsoa3M62xsEunDXQE+DVPO4S4x5MPK9tKulG/aFcA/IH5eVN257Cw=="],

    "@rolldown/binding-win32-arm64-msvc": ["@rolldown/binding-win32-arm64-msvc@1.0.0-rc.1", "", { "os": "win32", "cpu": "arm64" }, "sha512-oQVOP5cfAWZwRD0Q3nGn/cA9FW3KhMMuQ0NIndALAe6obqjLhqYVYDiGGRGrxvnjJsVbpLwR14gIUYnpIcHR1g=="],

    "@rolldown/binding-win32-x64-msvc": ["@rolldown/binding-win32-x64-msvc@1.0.0-rc.1", "", { "os": "win32", "cpu": "x64" }, "sha512-Ydsxxx++FNOuov3wCBPaYjZrEvKOOGq3k+BF4BPridhg2pENfitSRD2TEuQ8i33bp5VptuNdC9IzxRKU031z5A=="],

    "@rolldown/pluginutils": ["@rolldown/pluginutils@1.0.0-rc.1", "", {}, "sha512-UTBjtTxVOhodhzFVp/ayITaTETRHPUPYZPXQe0WU0wOgxghMojXxYjOiPOauKIYNWJAWS2fd7gJgGQK8GU8vDA=="],

    "@socket.io/component-emitter": ["@socket.io/component-emitter@3.1.2", "", {}, "sha512-9BCxFwvbGg/RsZK9tjXd8s4UcwR0MWeFQ1XEKIQVVvAGJyINdrqKMcTRyLoK8Rse1GjzLV9cwjWV1olXRWEXVA=="],

    "@tybys/wasm-util": ["@tybys/wasm-util@0.10.1", "", { "dependencies": { "tslib": "^2.4.0" } }, "sha512-9tTaPJLSiejZKx+Bmog4uSubteqTvFrVrURwkmHixBo0G4seD0zUxp98E1DzUBJxLQ3NPwXrGKDiVjwx/DpPsg=="],

    "@types/better-sqlite3": ["@types/better-sqlite3@7.6.13", "", { "dependencies": { "@types/node": "*" } }, "sha512-NMv9ASNARoKksWtsq/SHakpYAYnhBrQgGD8zkLYk/jaK8jUGn08CfEdTRgYhMypUQAfzSP8W6gNLe0q19/t4VA=="],

    "@types/bun": ["@types/bun@1.3.6", "", { "dependencies": { "bun-types": "1.3.6" } }, "sha512-uWCv6FO/8LcpREhenN1d1b6fcspAB+cefwD7uti8C8VffIv0Um08TKMn98FynpTiU38+y2dUO55T11NgDt8VAA=="],

    "@types/cors": ["@types/cors@2.8.19", "", { "dependencies": { "@types/node": "*" } }, "sha512-mFNylyeyqN93lfe/9CSxOGREz8cpzAhH+E93xJ4xWQf62V8sQ/24reV2nyzUWM6H6Xji+GGHpkbLe7pVoUEskg=="],

    "@types/estree": ["@types/estree@1.0.8", "", {}, "sha512-dWHzHa2WqEXI/O1E9OjrocMTKJl2mSrEolh1Iomrv6U+JuNwaHXsXx9bLu5gG7BUWFIN0skIQJQ/L1rIex4X6w=="],

    "@types/jsesc": ["@types/jsesc@2.5.1", "", {}, "sha512-9VN+6yxLOPLOav+7PwjZbxiID2bVaeq0ED4qSQmdQTdjnXJSaCVKTR58t15oqH1H5t8Ng2ZX1SabJVoN9Q34bw=="],

    "@types/node": ["@types/node@24.10.9", "", { "dependencies": { "undici-types": "~7.16.0" } }, "sha512-ne4A0IpG3+2ETuREInjPNhUGis1SFjv1d5asp8MzEAGtOZeTeHVDOYqOgqfhvseqg/iXty2hjBf1zAOb7RNiNw=="],

    "@typescript/native-preview": ["@typescript/native-preview@7.0.0-dev.20260222.1", "", { "optionalDependencies": { "@typescript/native-preview-darwin-arm64": "7.0.0-dev.20260222.1", "@typescript/native-preview-darwin-x64": "7.0.0-dev.20260222.1", "@typescript/native-preview-linux-arm": "7.0.0-dev.20260222.1", "@typescript/native-preview-linux-arm64": "7.0.0-dev.20260222.1", "@typescript/native-preview-linux-x64": "7.0.0-dev.20260222.1", "@typescript/native-preview-win32-arm64": "7.0.0-dev.20260222.1", "@typescript/native-preview-win32-x64": "7.0.0-dev.20260222.1" }, "bin": { "tsgo": "bin/tsgo.js" } }, "sha512-Uxon0iNhNqH/HkWvKmTmr7d5TJp6yomoyFHNpLIEghy91/DNWEtKMuLjNDYPFcoNxWpuJW9vuWTWeu3mcqT94Q=="],

    "@typescript/native-preview-darwin-arm64": ["@typescript/native-preview-darwin-arm64@7.0.0-dev.20260222.1", "", { "os": "darwin", "cpu": "arm64" }, "sha512-aXfK/s3QlbzXvZoFQ07KJDNx86q61nCITSreqLytnqjhjsXUUuMACsxjy/YsReLG2bdii+mHTA2WB2IB0LKKGA=="],

    "@typescript/native-preview-darwin-x64": ["@typescript/native-preview-darwin-x64@7.0.0-dev.20260222.1", "", { "os": "darwin", "cpu": "x64" }, "sha512-+bHnCeONX47pmVXTt6kuwxiLayDVqkLtshjqpqthXMWFFGk+1K/5ASbFEb2FumSABgB9hQ/xqkjj5QHUgGmbPg=="],

    "@typescript/native-preview-linux-arm": ["@typescript/native-preview-linux-arm@7.0.0-dev.20260222.1", "", { "os": "linux", "cpu": "arm" }, "sha512-bavfJlI3JNH2F/7BX0drZ4JCSjLsCc2Dy5e2s6pc2wuLIzJ6hIjFaXIeB9TDbVYJE+MlLf6rtQF9nP9iSsgk9g=="],

    "@typescript/native-preview-linux-arm64": ["@typescript/native-preview-linux-arm64@7.0.0-dev.20260222.1", "", { "os": "linux", "cpu": "arm64" }, "sha512-Usm9oJzLPqK7Z7echSSaHnmTXhr3knLXycoyVZwRrmWC33aX2efZb+XrdaV/SMhdYjYHCZ6mE60qcK4nEaXdng=="],

    "@typescript/native-preview-linux-x64": ["@typescript/native-preview-linux-x64@7.0.0-dev.20260222.1", "", { "os": "linux", "cpu": "x64" }, "sha512-JaOwNBJ2nA0C/MBfMXilrVNv+hUpIzs7JtpSgpOsXa3Hq7BL2rnoO6WMuCo8IHz7v8+Lr+MPJufXVEHfrOtf5A=="],

    "@typescript/native-preview-win32-arm64": ["@typescript/native-preview-win32-arm64@7.0.0-dev.20260222.1", "", { "os": "win32", "cpu": "arm64" }, "sha512-Mngr3qdeO7Ey3DtsHe4oqIghXYcjOr9pVQtKXbijfT0slRtVPeF1TmEb/eH+Z+LsY1SOW8c/Cig1G4NDXZnghw=="],

    "@typescript/native-preview-win32-x64": ["@typescript/native-preview-win32-x64@7.0.0-dev.20260222.1", "", { "os": "win32", "cpu": "x64" }, "sha512-8Gps/FPcQiyoHeDhRY3RXhJSJwQQuUIP5lepYO3+2xvCPPeeNBoOueiLoGKxno4CYbS4O2fPdVmymboX0ApjZA=="],

    "accepts": ["accepts@1.3.8", "", { "dependencies": { "mime-types": "~2.1.34", "negotiator": "0.6.3" } }, "sha512-PYAthTa2m2VKxuvSD3DPC/Gy+U+sOA1LAuT8mkmRuvw+NACSaeXEQ+NHcVF7rONl6qcaxV3Uuemwawk+7+SJLw=="],

    "ansis": ["ansis@4.2.0", "", {}, "sha512-HqZ5rWlFjGiV0tDm3UxxgNRqsOTniqoKZu0pIAfh7TZQMGuZK+hH0drySty0si0QXj1ieop4+SkSfPZBPPkHig=="],

    "ast-kit": ["ast-kit@3.0.0-beta.1", "", { "dependencies": { "@babel/parser": "^8.0.0-beta.4", "estree-walker": "^3.0.3", "pathe": "^2.0.3" } }, "sha512-trmleAnZ2PxN/loHWVhhx1qeOHSRXq4TDsBBxq3GqeJitfk3+jTQ+v/C1km/KYq9M7wKqCewMh+/NAvVH7m+bw=="],

    "base64-js": ["base64-js@1.5.1", "", {}, "sha512-AKpaYlHn8t4SVbOHCy+b5+KKgvR4vrsD8vbvrbiQJps7fKDTkjkDry6ji0rUJjC0kzbNePLwzxq8iypo41qeWA=="],

    "base64id": ["base64id@2.0.0", "", {}, "sha512-lGe34o6EHj9y3Kts9R4ZYs/Gr+6N7MCaMlIFA3F1R2O5/m7K06AxfSeO5530PEERE6/WyEg3lsuyw4GHlPZHog=="],

    "better-sqlite3": ["better-sqlite3@12.6.2", "", { "dependencies": { "bindings": "^1.5.0", "prebuild-install": "^7.1.1" } }, "sha512-8VYKM3MjCa9WcaSAI3hzwhmyHVlH8tiGFwf0RlTsZPWJ1I5MkzjiudCo4KC4DxOaL/53A5B1sI/IbldNFDbsKA=="],

    "bindings": ["bindings@1.5.0", "", { "dependencies": { "file-uri-to-path": "1.0.0" } }, "sha512-p2q/t/mhvuOj/UeLlV6566GD/guowlr0hHxClI0W9m7MWYkL1F0hLo+0Aexs9HSPCtR1SXQ0TD3MMKrXZajbiQ=="],

    "birpc": ["birpc@4.0.0", "", {}, "sha512-LShSxJP0KTmd101b6DRyGBj57LZxSDYWKitQNW/mi8GRMvZb078Uf9+pveax1DrVL89vm7mWe+TovdI/UDOuPw=="],

    "bl": ["bl@4.1.0", "", { "dependencies": { "buffer": "^5.5.0", "inherits": "^2.0.4", "readable-stream": "^3.4.0" } }, "sha512-1W07cM9gS6DcLperZfFSj+bWLtaPGSOHWhPiGzXmvVJbRLdG82sH/Kn8EtW1VqWVA54AKf2h5k5BbnIbwF3h6w=="],

    "buffer": ["buffer@5.7.1", "", { "dependencies": { "base64-js": "^1.3.1", "ieee754": "^1.1.13" } }, "sha512-EHcyIPBQ4BSGlvjB16k5KgAJ27CIsHY/2JBmCRReo48y9rQ3MaUzWX3KVlBa4U7MyX02HdVj0K7C3WaB3ju7FQ=="],

    "buffer-from": ["buffer-from@1.1.2", "", {}, "sha512-E+XQCRwSbaaiChtv6k6Dwgc+bx+Bs6vuKJHHl5kox/BaKbhiXzqQOwK4cO22yElGp2OCmjwVhT3HmxgyPGnJfQ=="],

    "bun-types": ["bun-types@1.3.6", "", { "dependencies": { "@types/node": "*" } }, "sha512-OlFwHcnNV99r//9v5IIOgQ9Uk37gZqrNMCcqEaExdkVq3Avwqok1bJFmvGMCkCE0FqzdY8VMOZpfpR3lwI+CsQ=="],

    "cac": ["cac@6.7.14", "", {}, "sha512-b6Ilus+c3RrdDk+JhLKUAQfzzgLEPy6wcXqS7f/xe1EETvsDP6GORG7SFuOs6cID5YkqchW/LXZbX5bc8j7ZcQ=="],

    "chownr": ["chownr@1.1.4", "", {}, "sha512-jJ0bqzaylmJtVnNgzTeSOs8DPavpbYgEr/b0YL8/2GO3xJEhInFmhKMUnEJQjZumK7KXGFhUy89PrsJWlakBVg=="],

    "cookie": ["cookie@0.7.2", "", {}, "sha512-yki5XnKuf750l50uGTllt6kKILY4nQ1eNIQatoXEByZ5dWgnKqbnqmTrBE5B4N7lrMJKQ2ytWMiTO2o0v6Ew/w=="],

    "cors": ["cors@2.8.5", "", { "dependencies": { "object-assign": "^4", "vary": "^1" } }, "sha512-KIHbLJqu73RGr/hnbrO9uBeixNGuvSQjul/jdFvS/KFSIH1hWVd1ng7zOHx+YrEfInLG7q4n6GHQ9cDtxv/P6g=="],

    "debug": ["debug@4.4.3", "", { "dependencies": { "ms": "^2.1.3" } }, "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA=="],

    "decompress-response": ["decompress-response@6.0.0", "", { "dependencies": { "mimic-response": "^3.1.0" } }, "sha512-aW35yZM6Bb/4oJlZncMH2LCoZtJXTRxES17vE3hoRiowU2kWHaJKFkSBDnDR+cm9J+9QhXmREyIfv0pji9ejCQ=="],

    "deep-extend": ["deep-extend@0.6.0", "", {}, "sha512-LOHxIOaPYdHlJRtCQfDIVZtfw/ufM8+rVj649RIHzcm/vGwQRXFt6OPqIFWsm2XEMrNIEtWR64sY1LEKD2vAOA=="],

    "defu": ["defu@6.1.4", "", {}, "sha512-mEQCMmwJu317oSz8CwdIOdwf3xMif1ttiM8LTufzc3g6kR+9Pe236twL8j3IYT1F7GfRgGcW6MWxzZjLIkuHIg=="],

    "detect-libc": ["detect-libc@2.1.2", "", {}, "sha512-Btj2BOOO83o3WyH59e8MgXsxEQVcarkUOpEYrubB0urwnN10yQ364rsiByU11nZlqWYZm05i/of7io4mzihBtQ=="],

    "drizzle-kit": ["drizzle-kit@0.31.9", "", { "dependencies": { "@drizzle-team/brocli": "^0.10.2", "@esbuild-kit/esm-loader": "^2.5.5", "esbuild": "^0.25.4", "esbuild-register": "^3.5.0" }, "bin": { "drizzle-kit": "bin.cjs" } }, "sha512-GViD3IgsXn7trFyBUUHyTFBpH/FsHTxYJ66qdbVggxef4UBPHRYxQaRzYLTuekYnk9i5FIEL9pbBIwMqX/Uwrg=="],

    "drizzle-orm": ["drizzle-orm@0.45.1", "", { "peerDependencies": { "@aws-sdk/client-rds-data": ">=3", "@cloudflare/workers-types": ">=4", "@electric-sql/pglite": ">=0.2.0", "@libsql/client": ">=0.10.0", "@libsql/client-wasm": ">=0.10.0", "@neondatabase/serverless": ">=0.10.0", "@op-engineering/op-sqlite": ">=2", "@opentelemetry/api": "^1.4.1", "@planetscale/database": ">=1.13", "@prisma/client": "*", "@tidbcloud/serverless": "*", "@types/better-sqlite3": "*", "@types/pg": "*", "@types/sql.js": "*", "@upstash/redis": ">=1.34.7", "@vercel/postgres": ">=0.8.0", "@xata.io/client": "*", "better-sqlite3": ">=7", "bun-types": "*", "expo-sqlite": ">=14.0.0", "gel": ">=2", "knex": "*", "kysely": "*", "mysql2": ">=2", "pg": ">=8", "postgres": ">=3", "sql.js": ">=1", "sqlite3": ">=5" }, "optionalPeers": ["@aws-sdk/client-rds-data", "@cloudflare/workers-types", "@electric-sql/pglite", "@libsql/client", "@libsql/client-wasm", "@neondatabase/serverless", "@op-engineering/op-sqlite", "@opentelemetry/api", "@planetscale/database", "@prisma/client", "@tidbcloud/serverless", "@types/better-sqlite3", "@types/pg", "@types/sql.js", "@upstash/redis", "@vercel/postgres", "@xata.io/client", "better-sqlite3", "bun-types", "expo-sqlite", "gel", "knex", "kysely", "mysql2", "pg", "postgres", "sql.js", "sqlite3"] }, "sha512-Te0FOdKIistGNPMq2jscdqngBRfBpC8uMFVwqjf6gtTVJHIQ/dosgV/CLBU2N4ZJBsXL5savCba9b0YJskKdcA=="],

    "dts-resolver": ["dts-resolver@2.1.3", "", { "peerDependencies": { "oxc-resolver": ">=11.0.0" }, "optionalPeers": ["oxc-resolver"] }, "sha512-bihc7jPC90VrosXNzK0LTE2cuLP6jr0Ro8jk+kMugHReJVLIpHz/xadeq3MhuwyO4TD4OA3L1Q8pBBFRc08Tsw=="],

    "empathic": ["empathic@2.0.0", "", {}, "sha512-i6UzDscO/XfAcNYD75CfICkmfLedpyPDdozrLMmQc5ORaQcdMoc21OnlEylMIqI7U8eniKrPMxxtj8k0vhmJhA=="],

    "end-of-stream": ["end-of-stream@1.4.5", "", { "dependencies": { "once": "^1.4.0" } }, "sha512-ooEGc6HP26xXq/N+GCGOT0JKCLDGrq2bQUZrQ7gyrJiZANJ/8YDTxTpQBXGMn+WbIQXNVpyWymm7KYVICQnyOg=="],

    "engine.io": ["engine.io@6.6.4", "", { "dependencies": { "@types/cors": "^2.8.12", "@types/node": ">=10.0.0", "accepts": "~1.3.4", "base64id": "2.0.0", "cookie": "~0.7.2", "cors": "~2.8.5", "debug": "~4.3.1", "engine.io-parser": "~5.2.1", "ws": "~8.17.1" } }, "sha512-ZCkIjSYNDyGn0R6ewHDtXgns/Zre/NT6Agvq1/WobF7JXgFff4SeDroKiCO3fNJreU9YG429Sc81o4w5ok/W5g=="],

    "engine.io-client": ["engine.io-client@6.6.3", "", { "dependencies": { "@socket.io/component-emitter": "~3.1.0", "debug": "~4.3.1", "engine.io-parser": "~5.2.1", "ws": "~8.17.1", "xmlhttprequest-ssl": "~2.1.1" } }, "sha512-T0iLjnyNWahNyv/lcjS2y4oE358tVS/SYQNxYXGAJ9/GLgH4VCvOQ/mhTjqU88mLZCQgiG8RIegFHYCdVC+j5w=="],

    "engine.io-parser": ["engine.io-parser@5.2.3", "", {}, "sha512-HqD3yTBfnBxIrbnM1DoD6Pcq8NECnh8d4As1Qgh0z5Gg3jRRIqijury0CL3ghu/edArpUYiYqQiDUQBIs4np3Q=="],

    "env-paths": ["env-paths@3.0.0", "", {}, "sha512-dtJUTepzMW3Lm/NPxRf3wP4642UWhjL2sQxc+ym2YMj1m/H2zDNQOlezafzkHwn6sMstjHTwG6iQQsctDW/b1A=="],

    "esbuild": ["esbuild@0.25.12", "", { "optionalDependencies": { "@esbuild/aix-ppc64": "0.25.12", "@esbuild/android-arm": "0.25.12", "@esbuild/android-arm64": "0.25.12", "@esbuild/android-x64": "0.25.12", "@esbuild/darwin-arm64": "0.25.12", "@esbuild/darwin-x64": "0.25.12", "@esbuild/freebsd-arm64": "0.25.12", "@esbuild/freebsd-x64": "0.25.12", "@esbuild/linux-arm": "0.25.12", "@esbuild/linux-arm64": "0.25.12", "@esbuild/linux-ia32": "0.25.12", "@esbuild/linux-loong64": "0.25.12", "@esbuild/linux-mips64el": "0.25.12", "@esbuild/linux-ppc64": "0.25.12", "@esbuild/linux-riscv64": "0.25.12", "@esbuild/linux-s390x": "0.25.12", "@esbuild/linux-x64": "0.25.12", "@esbuild/netbsd-arm64": "0.25.12", "@esbuild/netbsd-x64": "0.25.12", "@esbuild/openbsd-arm64": "0.25.12", "@esbuild/openbsd-x64": "0.25.12", "@esbuild/openharmony-arm64": "0.25.12", "@esbuild/sunos-x64": "0.25.12", "@esbuild/win32-arm64": "0.25.12", "@esbuild/win32-ia32": "0.25.12", "@esbuild/win32-x64": "0.25.12" }, "bin": { "esbuild": "bin/esbuild" } }, "sha512-bbPBYYrtZbkt6Os6FiTLCTFxvq4tt3JKall1vRwshA3fdVztsLAatFaZobhkBC8/BrPetoa0oksYoKXoG4ryJg=="],

    "esbuild-register": ["esbuild-register@3.6.0", "", { "dependencies": { "debug": "^4.3.4" }, "peerDependencies": { "esbuild": ">=0.12 <1" } }, "sha512-H2/S7Pm8a9CL1uhp9OvjwrBh5Pvx0H8qVOxNu8Wed9Y7qv56MPtq+GGM8RJpq6glYJn9Wspr8uw7l55uyinNeg=="],

    "estree-walker": ["estree-walker@3.0.3", "", { "dependencies": { "@types/estree": "^1.0.0" } }, "sha512-7RUKfXgSMMkzt6ZuXmqapOurLGPPfgj6l9uRZ7lRGolvk0y2yocc35LdcxKC5PQZdn2DMqioAQ2NoWcrTKmm6g=="],

    "expand-template": ["expand-template@2.0.3", "", {}, "sha512-XYfuKMvj4O35f/pOXLObndIRvyQ+/+6AhODh+OKWj9S9498pHHn/IMszH+gt0fBCRWMNfk1ZSp5x3AifmnI2vg=="],

    "fdir": ["fdir@6.5.0", "", { "peerDependencies": { "picomatch": "^3 || ^4" }, "optionalPeers": ["picomatch"] }, "sha512-tIbYtZbucOs0BRGqPJkshJUYdL+SDH7dVM8gjy+ERp3WAUjLEFJE+02kanyHtwjWOnwrKYBiwAmM0p4kLJAnXg=="],

    "file-uri-to-path": ["file-uri-to-path@1.0.0", "", {}, "sha512-0Zt+s3L7Vf1biwWZ29aARiVYLx7iMGnEUl9x33fbB/j3jR81u/O2LbqK+Bm1CDSNDKVtJ/YjwY7TUd5SkeLQLw=="],

    "frida": ["frida@17.6.2", "", { "dependencies": { "bindings": "^1.5.0", "minimatch": "^10.0.1", "prebuild-install": "^7.1.3" } }, "sha512-RGvUbbjIKG+WcjWesD1Z591pOWjopSYZ8u1/wes4CV2lDvjKDqNDHuryal9eFiYKOp4YidPW3DMxqFkzvkeV0w=="],

    "frida-remote-stream": ["frida-remote-stream@6.0.3", "", { "dependencies": { "tiny-typed-emitter": "^2.1.0" } }, "sha512-RDWCKdKJOj/nqPMJ8r6YEd4dbLyTQBqwCR1OLy0mwFi1R/rTWS0EIs3UeG0cKIEW3OaDpgGL4IQ7ecDxpgIQ3w=="],

    "frida16": ["frida@16.7.19", "", { "dependencies": { "bindings": "^1.5.0", "minimatch": "^10.0.1", "prebuild-install": "^7.1.3" } }, "sha512-OqMpRpzOzilQyIo9WpBcw8kgj11awAP/eQVDTUFQ1bg/2s9ceNnBqrRmIUlqvFeTo96b++9ijA8Ly5xkVMUyQw=="],

    "fs-constants": ["fs-constants@1.0.0", "", {}, "sha512-y6OAwoSIf7FyjMIv94u+b5rdheZEjzR63GTyZJm5qh4Bi+2YgwLCcI/fPFZkL5PSixOt6ZNKm+w+Hfp/Bciwow=="],

    "get-tsconfig": ["get-tsconfig@4.13.0", "", { "dependencies": { "resolve-pkg-maps": "^1.0.0" } }, "sha512-1VKTZJCwBrvbd+Wn3AOgQP/2Av+TfTCOlE4AcRJE72W1ksZXbAx8PPBR9RzgTeSPzlPMHrbANMH3LbltH73wxQ=="],

    "github-from-package": ["github-from-package@0.0.0", "", {}, "sha512-SyHy3T1v2NUXn29OsWdxmK6RwHD+vkj3v8en8AOBZ1wBQ/hCAQ5bAQTD02kW4W9tUp/3Qh6J8r9EvntiyCmOOw=="],

    "hono": ["hono@4.11.6", "", {}, "sha512-ofIiiHyl34SV6AuhE3YT2mhO5HRWokce+eUYE82TsP6z0/H3JeJcjVWEMSIAiw2QkjDOEpES/lYsg8eEbsLtdw=="],

    "hookable": ["hookable@6.0.1", "", {}, "sha512-uKGyY8BuzN/a5gvzvA+3FVWo0+wUjgtfSdnmjtrOVwQCZPHpHDH2WRO3VZSOeluYrHoDCiXFffZXs8Dj1ULWtw=="],

    "ieee754": ["ieee754@1.2.1", "", {}, "sha512-dcyqhDvX1C46lXZcVqCpK+FtMRQVdIMN6/Df5js2zouUsqG7I6sFxitIC+7KYK29KdXOLHdu9zL4sFnoVQnqaA=="],

    "import-without-cache": ["import-without-cache@0.2.5", "", {}, "sha512-B6Lc2s6yApwnD2/pMzFh/d5AVjdsDXjgkeJ766FmFuJELIGHNycKRj+l3A39yZPM4CchqNCB4RITEAYB1KUM6A=="],

    "inherits": ["inherits@2.0.4", "", {}, "sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ=="],

    "ini": ["ini@1.3.8", "", {}, "sha512-JV/yugV2uzW5iMRSiZAyDtQd+nxtUnjeLt0acNdw98kKLrvuRVyB80tsREOE7yvGVgalhZ6RNXCmEHkUKBKxew=="],

    "jsesc": ["jsesc@3.1.0", "", { "bin": { "jsesc": "bin/jsesc" } }, "sha512-/sM3dO2FOzXjKQhJuo0Q173wf2KOo8t4I8vHy6lF9poUp7bKT0/NHE8fPX23PwfhnykfqnC2xRxOnVw5XuGIaA=="],

    "mime-db": ["mime-db@1.52.0", "", {}, "sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg=="],

    "mime-types": ["mime-types@2.1.35", "", { "dependencies": { "mime-db": "1.52.0" } }, "sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw=="],

    "mimic-response": ["mimic-response@3.1.0", "", {}, "sha512-z0yWI+4FDrrweS8Zmt4Ej5HdJmky15+L2e6Wgn3+iK5fWzb6T3fhNFq2+MeTRb064c6Wr4N/wv0DzQTjNzHNGQ=="],

    "minimatch": ["minimatch@10.1.1", "", { "dependencies": { "@isaacs/brace-expansion": "^5.0.0" } }, "sha512-enIvLvRAFZYXJzkCYG5RKmPfrFArdLv+R+lbQ53BmIMLIry74bjKzX6iHAm8WYamJkhSSEabrWN5D97XnKObjQ=="],

    "minimist": ["minimist@1.2.8", "", {}, "sha512-2yyAR8qBkN3YuheJanUpWC5U3bb5osDywNB8RzDVlDwDHbocAJveqqj1u8+SVD7jkWT4yvsHCpWqqWqAxb0zCA=="],

    "mkdirp-classic": ["mkdirp-classic@0.5.3", "", {}, "sha512-gKLcREMhtuZRwRAfqP3RFW+TK4JqApVBtOIftVgjuABpAtpxhPGaDcfvbhNvD0B8iD1oUr/txX35NjcaY6Ns/A=="],

    "ms": ["ms@2.1.3", "", {}, "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA=="],

    "napi-build-utils": ["napi-build-utils@2.0.0", "", {}, "sha512-GEbrYkbfF7MoNaoh2iGG84Mnf/WZfB0GdGEsM8wz7Expx/LlWf5U8t9nvJKXSp3qr5IsEbK04cBGhol/KwOsWA=="],

    "negotiator": ["negotiator@0.6.3", "", {}, "sha512-+EUsqGPLsM+j/zdChZjsnX51g4XrHFOIXwfnCVPGlQk/k5giakcKsuxCObBRu6DSm9opw/O6slWbJdghQM4bBg=="],

    "node-abi": ["node-abi@3.80.0", "", { "dependencies": { "semver": "^7.3.5" } }, "sha512-LyPuZJcI9HVwzXK1GPxWNzrr+vr8Hp/3UqlmWxxh8p54U1ZbclOqbSog9lWHaCX+dBaiGi6n/hIX+mKu74GmPA=="],

    "object-assign": ["object-assign@4.1.1", "", {}, "sha512-rJgTQnkUnH1sFw8yT6VSU3zD3sWmu6sZhIseY8VX+GRu3P6F7Fu+JNDoXfklElbLJSnc3FUQHVe4cU5hj+BcUg=="],

    "obug": ["obug@2.1.1", "", {}, "sha512-uTqF9MuPraAQ+IsnPf366RG4cP9RtUi7MLO1N3KEc+wb0a6yKpeL0lmk2IB1jY5KHPAlTc6T/JRdC/YqxHNwkQ=="],

    "once": ["once@1.4.0", "", { "dependencies": { "wrappy": "1" } }, "sha512-lNaJgI+2Q5URQBkccEKHTQOPaXdUxnZZElQTZY0MFUAuaEqe1E+Nyvgdz/aIyNi6Z9MzO5dv1H8n58/GELp3+w=="],

    "pathe": ["pathe@2.0.3", "", {}, "sha512-WUjGcAqP1gQacoQe+OBJsFA7Ld4DyXuUIjZ5cc75cLHvJ7dtNsTugphxIADwspS+AraAUePCKrSVtPLFj/F88w=="],

    "picomatch": ["picomatch@4.0.3", "", {}, "sha512-5gTmgEY/sqK6gFXLIsQNH19lWb4ebPDLA4SdLP7dsWkIXHWlG66oPuVvXSGFPppYZz8ZDZq0dYYrbHfBCVUb1Q=="],

    "prebuild-install": ["prebuild-install@7.1.3", "", { "dependencies": { "detect-libc": "^2.0.0", "expand-template": "^2.0.3", "github-from-package": "0.0.0", "minimist": "^1.2.3", "mkdirp-classic": "^0.5.3", "napi-build-utils": "^2.0.0", "node-abi": "^3.3.0", "pump": "^3.0.0", "rc": "^1.2.7", "simple-get": "^4.0.0", "tar-fs": "^2.0.0", "tunnel-agent": "^0.6.0" }, "bin": "bin.js" }, "sha512-8Mf2cbV7x1cXPUILADGI3wuhfqWvtiLA1iclTDbFRZkgRQS0NqsPZphna9V+HyTEadheuPmjaJMsbzKQFOzLug=="],

    "pump": ["pump@3.0.3", "", { "dependencies": { "end-of-stream": "^1.1.0", "once": "^1.3.1" } }, "sha512-todwxLMY7/heScKmntwQG8CXVkWUOdYxIvY2s0VWAAMh/nd8SoYiRaKjlr7+iCs984f2P8zvrfWcDDYVb73NfA=="],

    "quansync": ["quansync@1.0.0", "", {}, "sha512-5xZacEEufv3HSTPQuchrvV6soaiACMFnq1H8wkVioctoH3TRha9Sz66lOxRwPK/qZj7HPiSveih9yAyh98gvqA=="],

    "rc": ["rc@1.2.8", "", { "dependencies": { "deep-extend": "^0.6.0", "ini": "~1.3.0", "minimist": "^1.2.0", "strip-json-comments": "~2.0.1" }, "bin": "cli.js" }, "sha512-y3bGgqKj3QBdxLbLkomlohkvsA8gdAiUQlSBJnBhfn+BPxg4bc62d8TcBW15wavDfgexCgccckhcZvywyQYPOw=="],

    "readable-stream": ["readable-stream@3.6.2", "", { "dependencies": { "inherits": "^2.0.3", "string_decoder": "^1.1.1", "util-deprecate": "^1.0.1" } }, "sha512-9u/sniCrY3D5WdsERHzHE4G2YCXqoG5FTHUiCC4SIbr6XcLZBY05ya9EKjYek9O5xOAwjGq+1JdGBAS7Q9ScoA=="],

    "resolve-pkg-maps": ["resolve-pkg-maps@1.0.0", "", {}, "sha512-seS2Tj26TBVOC2NIc2rOe2y2ZO7efxITtLZcGSOnHHNOQ7CkiUBfw0Iw2ck6xkIhPwLhKNLS8BO+hEpngQlqzw=="],

    "rolldown": ["rolldown@1.0.0-rc.1", "", { "dependencies": { "@oxc-project/types": "=0.110.0", "@rolldown/pluginutils": "1.0.0-rc.1" }, "optionalDependencies": { "@rolldown/binding-android-arm64": "1.0.0-rc.1", "@rolldown/binding-darwin-arm64": "1.0.0-rc.1", "@rolldown/binding-darwin-x64": "1.0.0-rc.1", "@rolldown/binding-freebsd-x64": "1.0.0-rc.1", "@rolldown/binding-linux-arm-gnueabihf": "1.0.0-rc.1", "@rolldown/binding-linux-arm64-gnu": "1.0.0-rc.1", "@rolldown/binding-linux-arm64-musl": "1.0.0-rc.1", "@rolldown/binding-linux-x64-gnu": "1.0.0-rc.1", "@rolldown/binding-linux-x64-musl": "1.0.0-rc.1", "@rolldown/binding-openharmony-arm64": "1.0.0-rc.1", "@rolldown/binding-wasm32-wasi": "1.0.0-rc.1", "@rolldown/binding-win32-arm64-msvc": "1.0.0-rc.1", "@rolldown/binding-win32-x64-msvc": "1.0.0-rc.1" }, "bin": { "rolldown": "bin/cli.mjs" } }, "sha512-M3AeZjYE6UclblEf531Hch0WfVC/NOL43Cc+WdF3J50kk5/fvouHhDumSGTh0oRjbZ8C4faaVr5r6Nx1xMqDGg=="],

    "rolldown-plugin-dts": ["rolldown-plugin-dts@0.21.5", "", { "dependencies": { "@babel/generator": "8.0.0-beta.4", "@babel/parser": "8.0.0-beta.4", "@babel/types": "8.0.0-beta.4", "ast-kit": "^3.0.0-beta.1", "birpc": "^4.0.0", "dts-resolver": "^2.1.3", "get-tsconfig": "^4.13.0", "obug": "^2.1.1" }, "peerDependencies": { "@ts-macro/tsc": "^0.3.6", "@typescript/native-preview": ">=7.0.0-dev.20250601.1", "rolldown": "^1.0.0-beta.57", "typescript": "^5.0.0", "vue-tsc": "~3.2.0" }, "optionalPeers": ["@ts-macro/tsc", "@typescript/native-preview", "typescript", "vue-tsc"] }, "sha512-tS3jz7Fq1FWx5Jqih7pZ3zH4Bsnu+VYH5aY7e9o7Joxu5hi9ApMULmM+LVIGxoGVjjMjZGFMEcbdiZ17j/5eNA=="],

    "safe-buffer": ["safe-buffer@5.2.1", "", {}, "sha512-rp3So07KcdmmKbGvgaNxQSJr7bGVSVk5S9Eq1F+ppbRo70+YeaDxkw5Dd8NPN+GD6bjnYm2VuPuCXmpuYvmCXQ=="],

    "semver": ["semver@7.7.3", "", { "bin": "bin/semver.js" }, "sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q=="],

    "simple-concat": ["simple-concat@1.0.1", "", {}, "sha512-cSFtAPtRhljv69IK0hTVZQ+OfE9nePi/rtJmw5UjHeVyVroEqJXP1sFztKUy1qU+xvz3u/sfYJLa947b7nAN2Q=="],

    "simple-get": ["simple-get@4.0.1", "", { "dependencies": { "decompress-response": "^6.0.0", "once": "^1.3.1", "simple-concat": "^1.0.0" } }, "sha512-brv7p5WgH0jmQJr1ZDDfKDOSeWWg+OVypG99A/5vYGPqJ6pxiaHLy8nxtFjBA7oMa01ebA9gfh1uMCFqOuXxvA=="],

    "socket.io": ["socket.io@4.8.3", "", { "dependencies": { "accepts": "~1.3.4", "base64id": "~2.0.0", "cors": "~2.8.5", "debug": "~4.4.1", "engine.io": "~6.6.0", "socket.io-adapter": "~2.5.2", "socket.io-parser": "~4.2.4" } }, "sha512-2Dd78bqzzjE6KPkD5fHZmDAKRNe3J15q+YHDrIsy9WEkqttc7GY+kT9OBLSMaPbQaEd0x1BjcmtMtXkfpc+T5A=="],

    "socket.io-adapter": ["socket.io-adapter@2.5.5", "", { "dependencies": { "debug": "~4.3.4", "ws": "~8.17.1" } }, "sha512-eLDQas5dzPgOWCk9GuuJC2lBqItuhKI4uxGgo9aIV7MYbk2h9Q6uULEh8WBzThoI7l+qU9Ast9fVUmkqPP9wYg=="],

    "socket.io-client": ["socket.io-client@4.8.3", "", { "dependencies": { "@socket.io/component-emitter": "~3.1.0", "debug": "~4.4.1", "engine.io-client": "~6.6.1", "socket.io-parser": "~4.2.4" } }, "sha512-uP0bpjWrjQmUt5DTHq9RuoCBdFJF10cdX9X+a368j/Ft0wmaVgxlrjvK3kjvgCODOMMOz9lcaRzxmso0bTWZ/g=="],

    "socket.io-parser": ["socket.io-parser@4.2.4", "", { "dependencies": { "@socket.io/component-emitter": "~3.1.0", "debug": "~4.3.1" } }, "sha512-/GbIKmo8ioc+NIWIhwdecY0ge+qVBSMdgxGygevmdHj24bsfgtCmcUUcQ5ZzcylGFHsN3k4HB4Cgkl96KVnuew=="],

    "source-map": ["source-map@0.6.1", "", {}, "sha512-UjgapumWlbMhkBgzT7Ykc5YXUT46F0iKu8SGXq0bcwP5dz/h0Plj6enJqjz1Zbq2l5WaqYnrVbwWOWMyF3F47g=="],

    "source-map-support": ["source-map-support@0.5.21", "", { "dependencies": { "buffer-from": "^1.0.0", "source-map": "^0.6.0" } }, "sha512-uBHU3L3czsIyYXKX88fdrGovxdSCoTGDRZ6SYXtSRxLZUzHg5P/66Ht6uoUlHu9EZod+inXhKo3qQgwXUT/y1w=="],

    "string_decoder": ["string_decoder@1.3.0", "", { "dependencies": { "safe-buffer": "~5.2.0" } }, "sha512-hkRX8U1WjJFd8LsDJ2yQ/wWWxaopEsABU1XfkM8A+j0+85JAGppt16cr1Whg6KIbb4okU6Mql6BOj+uup/wKeA=="],

    "strip-json-comments": ["strip-json-comments@2.0.1", "", {}, "sha512-4gB8na07fecVVkOI6Rs4e7T6NOTki5EmL7TUduTs6bu3EdnSycntVJ4re8kgZA+wx9IueI2Y11bfbgwtzuE0KQ=="],

    "tar-fs": ["tar-fs@2.1.4", "", { "dependencies": { "chownr": "^1.1.1", "mkdirp-classic": "^0.5.2", "pump": "^3.0.0", "tar-stream": "^2.1.4" } }, "sha512-mDAjwmZdh7LTT6pNleZ05Yt65HC3E+NiQzl672vQG38jIrehtJk/J3mNwIg+vShQPcLF/LV7CMnDW6vjj6sfYQ=="],

    "tar-stream": ["tar-stream@2.2.0", "", { "dependencies": { "bl": "^4.0.3", "end-of-stream": "^1.4.1", "fs-constants": "^1.0.0", "inherits": "^2.0.3", "readable-stream": "^3.1.1" } }, "sha512-ujeqbceABgwMZxEJnk2HDY2DlnUZ+9oEcb1KzTVfYHio0UE6dG71n60d8D2I4qNvleWrrXpmjpt7vZeF1LnMZQ=="],

    "tiny-typed-emitter": ["tiny-typed-emitter@2.1.0", "", {}, "sha512-qVtvMxeXbVej0cQWKqVSSAHmKZEHAvxdF8HEUBFWts8h+xEo5m/lEiPakuyZ3BnCBjOD8i24kzNOiOLLgsSxhA=="],

    "tinyexec": ["tinyexec@1.0.2", "", {}, "sha512-W/KYk+NFhkmsYpuHq5JykngiOCnxeVL8v8dFnqxSD8qEEdRfXk1SDM6JzNqcERbcGYj9tMrDQBYV9cjgnunFIg=="],

    "tinyglobby": ["tinyglobby@0.2.15", "", { "dependencies": { "fdir": "^6.5.0", "picomatch": "^4.0.3" } }, "sha512-j2Zq4NyQYG5XMST4cbs02Ak8iJUdxRM0XI5QyxXuZOzKOINmWurp3smXu3y5wDcJrptwpSjgXHzIQxR0omXljQ=="],

    "tree-kill": ["tree-kill@1.2.2", "", { "bin": { "tree-kill": "cli.js" } }, "sha512-L0Orpi8qGpRG//Nd+H90vFB+3iHnue1zSSGmNOOCh1GLJ7rUKVwV2HvijphGQS2UmhUZewS9VgvxYIdgr+fG1A=="],

    "tsdown": ["tsdown@0.20.1", "", { "dependencies": { "ansis": "^4.2.0", "cac": "^6.7.14", "defu": "^6.1.4", "empathic": "^2.0.0", "hookable": "^6.0.1", "import-without-cache": "^0.2.5", "obug": "^2.1.1", "picomatch": "^4.0.3", "rolldown": "1.0.0-rc.1", "rolldown-plugin-dts": "^0.21.5", "semver": "^7.7.3", "tinyexec": "^1.0.2", "tinyglobby": "^0.2.15", "tree-kill": "^1.2.2", "unconfig-core": "^7.4.2", "unrun": "^0.2.26" }, "peerDependencies": { "@arethetypeswrong/core": "^0.18.1", "@vitejs/devtools": "*", "publint": "^0.3.0", "typescript": "^5.0.0", "unplugin-lightningcss": "^0.4.0", "unplugin-unused": "^0.5.0" }, "optionalPeers": ["@arethetypeswrong/core", "@vitejs/devtools", "publint", "typescript", "unplugin-lightningcss", "unplugin-unused"], "bin": { "tsdown": "dist/run.mjs" } }, "sha512-Wo1BzqNQVZ6SFQV8rjQBwMmNubO+yV3F+vp2WNTjEaS4S5CT1C1dHtUbeFMrCEasZpGy5w6TshpehNnfTe8QBQ=="],

    "tslib": ["tslib@2.8.1", "", {}, "sha512-oJFu94HQb+KVduSUQL7wnpmqnfmLsOA/nAh6b6EH0wCEoK0/mPeXU6c3wKDV83MkOuHPRHtSXKKU99IBazS/2w=="],

    "tunnel-agent": ["tunnel-agent@0.6.0", "", { "dependencies": { "safe-buffer": "^5.0.1" } }, "sha512-McnNiV1l8RYeY8tBgEpuodCC1mLUdbSN+CYBL7kJsJNInOP8UjDDEwdk6Mw60vdLLrr5NHKZhMAOSrR2NZuQ+w=="],

    "typescript": ["typescript@5.9.3", "", { "bin": { "tsc": "bin/tsc", "tsserver": "bin/tsserver" } }, "sha512-jl1vZzPDinLr9eUt3J/t7V6FgNEw9QjvBPdysz9KfQDD41fQrC2Y4vKQdiaUpFT4bXlb1RHhLpp8wtm6M5TgSw=="],

    "unconfig-core": ["unconfig-core@7.4.2", "", { "dependencies": { "@quansync/fs": "^1.0.0", "quansync": "^1.0.0" } }, "sha512-VgPCvLWugINbXvMQDf8Jh0mlbvNjNC6eSUziHsBCMpxR05OPrNrvDnyatdMjRgcHaaNsCqz+wjNXxNw1kRLHUg=="],

    "undici-types": ["undici-types@7.16.0", "", {}, "sha512-Zz+aZWSj8LE6zoxD+xrjh4VfkIG8Ya6LvYkZqtUQGJPZjYl53ypCaUwWqo7eI0x66KBGeRo+mlBEkMSeSZ38Nw=="],

    "unrun": ["unrun@0.2.26", "", { "dependencies": { "rolldown": "1.0.0-rc.1" }, "peerDependencies": { "synckit": "^0.11.11" }, "optionalPeers": ["synckit"], "bin": { "unrun": "dist/cli.mjs" } }, "sha512-A3DQLBcDyTui4Hlaoojkldg+8x+CIR+tcSHY0wzW+CgB4X/DNyH58jJpXp1B/EkE+yG6tU8iH1mWsLtwFU3IQg=="],

    "util-deprecate": ["util-deprecate@1.0.2", "", {}, "sha512-EPD5q1uXyFxJpCrLnCc1nHnq3gOa6DZBocAIiI2TaSCA7VCJ1UJDMagCzIkXNsUYfD1daK//LTEQ8xiIbrHtcw=="],

    "vary": ["vary@1.1.2", "", {}, "sha512-BNGbWLfd0eUPabhkXUVm0j8uuvREyTh5ovRa/dyow/BqAbZJyC+5fU+IzQOzmAKzYqYRAISoRhdQr3eIZ/PXqg=="],

    "wrappy": ["wrappy@1.0.2", "", {}, "sha512-l4Sp/DRseor9wL6EvV2+TuQn63dMkPjZ/sp9XkghTEbV9KlPS1xUsZ3u7/IQO4wxtcFB4bgpQPRcR3QCvezPcQ=="],

    "ws": ["ws@8.17.1", "", { "peerDependencies": { "bufferutil": "^4.0.1", "utf-8-validate": ">=5.0.2" }, "optionalPeers": ["bufferutil", "utf-8-validate"] }, "sha512-6XQFvXTkbfUOZOKKILFG1PDK2NDQs4azKQl26T0YS5CxqWLgXajbPZ+h4gZekJyRqFU8pvnbAbbs/3TgRPy+GQ=="],

    "xmlhttprequest-ssl": ["xmlhttprequest-ssl@2.1.2", "", {}, "sha512-TEU+nJVUUnA4CYJFLvK5X9AOeH4KvDvhIfm0vV1GaQRtchnG0hgK5p8hw/xjv8cunWYCsiPCSDzObPyhEwq3KQ=="],

    "@esbuild-kit/core-utils/esbuild": ["esbuild@0.18.20", "", { "optionalDependencies": { "@esbuild/android-arm": "0.18.20", "@esbuild/android-arm64": "0.18.20", "@esbuild/android-x64": "0.18.20", "@esbuild/darwin-arm64": "0.18.20", "@esbuild/darwin-x64": "0.18.20", "@esbuild/freebsd-arm64": "0.18.20", "@esbuild/freebsd-x64": "0.18.20", "@esbuild/linux-arm": "0.18.20", "@esbuild/linux-arm64": "0.18.20", "@esbuild/linux-ia32": "0.18.20", "@esbuild/linux-loong64": "0.18.20", "@esbuild/linux-mips64el": "0.18.20", "@esbuild/linux-ppc64": "0.18.20", "@esbuild/linux-riscv64": "0.18.20", "@esbuild/linux-s390x": "0.18.20", "@esbuild/linux-x64": "0.18.20", "@esbuild/netbsd-x64": "0.18.20", "@esbuild/openbsd-x64": "0.18.20", "@esbuild/sunos-x64": "0.18.20", "@esbuild/win32-arm64": "0.18.20", "@esbuild/win32-ia32": "0.18.20", "@esbuild/win32-x64": "0.18.20" }, "bin": { "esbuild": "bin/esbuild" } }, "sha512-ceqxoedUrcayh7Y7ZX6NdbbDzGROiyVBgC4PriJThBKSVPWnnFHZAkfI1lJT8QFkOwH4qOS2SJkS4wvpGl8BpA=="],

    "@types/cors/@types/node": ["@types/node@24.10.0", "", { "dependencies": { "undici-types": "~7.16.0" } }, "sha512-qzQZRBqkFsYyaSWXuEHc2WR9c0a0CXwiE5FWUvn7ZM+vdy1uZLfCunD38UzhuB7YN/J11ndbDBcTmOdxJo9Q7A=="],

    "bun-types/@types/node": ["@types/node@24.10.0", "", { "dependencies": { "undici-types": "~7.16.0" } }, "sha512-qzQZRBqkFsYyaSWXuEHc2WR9c0a0CXwiE5FWUvn7ZM+vdy1uZLfCunD38UzhuB7YN/J11ndbDBcTmOdxJo9Q7A=="],

    "engine.io/@types/node": ["@types/node@24.10.0", "", { "dependencies": { "undici-types": "~7.16.0" } }, "sha512-qzQZRBqkFsYyaSWXuEHc2WR9c0a0CXwiE5FWUvn7ZM+vdy1uZLfCunD38UzhuB7YN/J11ndbDBcTmOdxJo9Q7A=="],

    "engine.io/debug": ["debug@4.3.7", "", { "dependencies": { "ms": "^2.1.3" } }, "sha512-Er2nc/H7RrMXZBFCEim6TCmMk02Z8vLC2Rbi1KEBggpo0fS6l0S1nnapwmIi3yW/+GOJap1Krg4w0Hg80oCqgQ=="],

    "engine.io-client/debug": ["debug@4.3.7", "", { "dependencies": { "ms": "^2.1.3" } }, "sha512-Er2nc/H7RrMXZBFCEim6TCmMk02Z8vLC2Rbi1KEBggpo0fS6l0S1nnapwmIi3yW/+GOJap1Krg4w0Hg80oCqgQ=="],

    "socket.io-adapter/debug": ["debug@4.3.7", "", { "dependencies": { "ms": "^2.1.3" } }, "sha512-Er2nc/H7RrMXZBFCEim6TCmMk02Z8vLC2Rbi1KEBggpo0fS6l0S1nnapwmIi3yW/+GOJap1Krg4w0Hg80oCqgQ=="],

    "socket.io-parser/debug": ["debug@4.3.7", "", { "dependencies": { "ms": "^2.1.3" } }, "sha512-Er2nc/H7RrMXZBFCEim6TCmMk02Z8vLC2Rbi1KEBggpo0fS6l0S1nnapwmIi3yW/+GOJap1Krg4w0Hg80oCqgQ=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/android-arm": ["@esbuild/android-arm@0.18.20", "", { "os": "android", "cpu": "arm" }, "sha512-fyi7TDI/ijKKNZTUJAQqiG5T7YjJXgnzkURqmGj13C6dCqckZBLdl4h7bkhHt/t0WP+zO9/zwroDvANaOqO5Sw=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/android-arm64": ["@esbuild/android-arm64@0.18.20", "", { "os": "android", "cpu": "arm64" }, "sha512-Nz4rJcchGDtENV0eMKUNa6L12zz2zBDXuhj/Vjh18zGqB44Bi7MBMSXjgunJgjRhCmKOjnPuZp4Mb6OKqtMHLQ=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/android-x64": ["@esbuild/android-x64@0.18.20", "", { "os": "android", "cpu": "x64" }, "sha512-8GDdlePJA8D6zlZYJV/jnrRAi6rOiNaCC/JclcXpB+KIuvfBN4owLtgzY2bsxnx666XjJx2kDPUmnTtR8qKQUg=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/darwin-arm64": ["@esbuild/darwin-arm64@0.18.20", "", { "os": "darwin", "cpu": "arm64" }, "sha512-bxRHW5kHU38zS2lPTPOyuyTm+S+eobPUnTNkdJEfAddYgEcll4xkT8DB9d2008DtTbl7uJag2HuE5NZAZgnNEA=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/darwin-x64": ["@esbuild/darwin-x64@0.18.20", "", { "os": "darwin", "cpu": "x64" }, "sha512-pc5gxlMDxzm513qPGbCbDukOdsGtKhfxD1zJKXjCCcU7ju50O7MeAZ8c4krSJcOIJGFR+qx21yMMVYwiQvyTyQ=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/freebsd-arm64": ["@esbuild/freebsd-arm64@0.18.20", "", { "os": "freebsd", "cpu": "arm64" }, "sha512-yqDQHy4QHevpMAaxhhIwYPMv1NECwOvIpGCZkECn8w2WFHXjEwrBn3CeNIYsibZ/iZEUemj++M26W3cNR5h+Tw=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/freebsd-x64": ["@esbuild/freebsd-x64@0.18.20", "", { "os": "freebsd", "cpu": "x64" }, "sha512-tgWRPPuQsd3RmBZwarGVHZQvtzfEBOreNuxEMKFcd5DaDn2PbBxfwLcj4+aenoh7ctXcbXmOQIn8HI6mCSw5MQ=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/linux-arm": ["@esbuild/linux-arm@0.18.20", "", { "os": "linux", "cpu": "arm" }, "sha512-/5bHkMWnq1EgKr1V+Ybz3s1hWXok7mDFUMQ4cG10AfW3wL02PSZi5kFpYKrptDsgb2WAJIvRcDm+qIvXf/apvg=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/linux-arm64": ["@esbuild/linux-arm64@0.18.20", "", { "os": "linux", "cpu": "arm64" }, "sha512-2YbscF+UL7SQAVIpnWvYwM+3LskyDmPhe31pE7/aoTMFKKzIc9lLbyGUpmmb8a8AixOL61sQ/mFh3jEjHYFvdA=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/linux-ia32": ["@esbuild/linux-ia32@0.18.20", "", { "os": "linux", "cpu": "ia32" }, "sha512-P4etWwq6IsReT0E1KHU40bOnzMHoH73aXp96Fs8TIT6z9Hu8G6+0SHSw9i2isWrD2nbx2qo5yUqACgdfVGx7TA=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/linux-loong64": ["@esbuild/linux-loong64@0.18.20", "", { "os": "linux", "cpu": "none" }, "sha512-nXW8nqBTrOpDLPgPY9uV+/1DjxoQ7DoB2N8eocyq8I9XuqJ7BiAMDMf9n1xZM9TgW0J8zrquIb/A7s3BJv7rjg=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/linux-mips64el": ["@esbuild/linux-mips64el@0.18.20", "", { "os": "linux", "cpu": "none" }, "sha512-d5NeaXZcHp8PzYy5VnXV3VSd2D328Zb+9dEq5HE6bw6+N86JVPExrA6O68OPwobntbNJ0pzCpUFZTo3w0GyetQ=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/linux-ppc64": ["@esbuild/linux-ppc64@0.18.20", "", { "os": "linux", "cpu": "ppc64" }, "sha512-WHPyeScRNcmANnLQkq6AfyXRFr5D6N2sKgkFo2FqguP44Nw2eyDlbTdZwd9GYk98DZG9QItIiTlFLHJHjxP3FA=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/linux-riscv64": ["@esbuild/linux-riscv64@0.18.20", "", { "os": "linux", "cpu": "none" }, "sha512-WSxo6h5ecI5XH34KC7w5veNnKkju3zBRLEQNY7mv5mtBmrP/MjNBCAlsM2u5hDBlS3NGcTQpoBvRzqBcRtpq1A=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/linux-s390x": ["@esbuild/linux-s390x@0.18.20", "", { "os": "linux", "cpu": "s390x" }, "sha512-+8231GMs3mAEth6Ja1iK0a1sQ3ohfcpzpRLH8uuc5/KVDFneH6jtAJLFGafpzpMRO6DzJ6AvXKze9LfFMrIHVQ=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/linux-x64": ["@esbuild/linux-x64@0.18.20", "", { "os": "linux", "cpu": "x64" }, "sha512-UYqiqemphJcNsFEskc73jQ7B9jgwjWrSayxawS6UVFZGWrAAtkzjxSqnoclCXxWtfwLdzU+vTpcNYhpn43uP1w=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/netbsd-x64": ["@esbuild/netbsd-x64@0.18.20", "", { "os": "none", "cpu": "x64" }, "sha512-iO1c++VP6xUBUmltHZoMtCUdPlnPGdBom6IrO4gyKPFFVBKioIImVooR5I83nTew5UOYrk3gIJhbZh8X44y06A=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/openbsd-x64": ["@esbuild/openbsd-x64@0.18.20", "", { "os": "openbsd", "cpu": "x64" }, "sha512-e5e4YSsuQfX4cxcygw/UCPIEP6wbIL+se3sxPdCiMbFLBWu0eiZOJ7WoD+ptCLrmjZBK1Wk7I6D/I3NglUGOxg=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/sunos-x64": ["@esbuild/sunos-x64@0.18.20", "", { "os": "sunos", "cpu": "x64" }, "sha512-kDbFRFp0YpTQVVrqUd5FTYmWo45zGaXe0X8E1G/LKFC0v8x0vWrhOWSLITcCn63lmZIxfOMXtCfti/RxN/0wnQ=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/win32-arm64": ["@esbuild/win32-arm64@0.18.20", "", { "os": "win32", "cpu": "arm64" }, "sha512-ddYFR6ItYgoaq4v4JmQQaAI5s7npztfV4Ag6NrhiaW0RrnOXqBkgwZLofVTlq1daVTQNhtI5oieTvkRPfZrePg=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/win32-ia32": ["@esbuild/win32-ia32@0.18.20", "", { "os": "win32", "cpu": "ia32" }, "sha512-Wv7QBi3ID/rROT08SABTS7eV4hX26sVduqDOTe1MvGMjNd3EjOz4b7zeexIR62GTIEKrfJXKL9LFxTYgkyeu7g=="],

    "@esbuild-kit/core-utils/esbuild/@esbuild/win32-x64": ["@esbuild/win32-x64@0.18.20", "", { "os": "win32", "cpu": "x64" }, "sha512-kTdfRcSiDfQca/y9QIkng02avJ+NCaQvrMejlsB3RRv5sE9rRoeBPISaZpKxHELzRxZyLvNts1P27W3wV+8geQ=="],
  }
}

```

`docs/arch.md`:

```md
# Project Architecture

## High-Level Overview

The high-level architecture is composed of four logical layers and the connections between them:

- Web UI (React frontend)
  - [React](https://react.dev/)
  - [TanStack Query](https://tanstack.com/query/)
  - [Socket.IO](https://socket.io/) client
  - WebSocket to maintain frida session state in realtime
  - [shadcn UI](https://ui.shadcn.com/)
  - [tailwindcss](https://tailwindcss.com/)
  - [Base UI](https://base-ui.com/)

- Backend Server
  - [Hono](https://hono.dev/) for REST API
  - [Socket.IO](https://socket.io/) for real-time API
  - [Drizzle ORM](https://orm.drizzle.team/) with SQLite for data persistence
  - Acts as the Frida session manager and the bridge between the frontend and agent

- Frida Session / Backend Process
  - A Frida session is created per client connection and the platform-specific agent script is loaded into the target process
  - RPC surface exposed by the agent follows the pattern `script.exports.invoke(namespace, method, args)`
  - The web server proxies RPC calls, streams logs, and persists hook/trace data into stores

- Target Device (Frida Agent injected into app)
  - Agent runs inside the target app (iOS / Android) and provides:
    - Registry for module routing
    - Modules for inspection and control
    - Hooks for runtime interception
    - Bridges for language/runtime interop
  - Communicates with the backend over the Frida transport channel

## Directory Structure

- agent/ — Frida agent in TypeScript, compiled per platform. iOS (fruity) and Android (droid) agents, compiled outputs (dist/) and generated types/ used by the frontend.
- gui/ — React web frontend (Vite, Tailwind, shadcn/ui). Main code under gui/src with components, hooks, RPC client.
- src/ — Backend server (Hono + Socket.IO)
  - app.ts: REST API
  - ws.ts: Socket.IO server and session management
- drizzle/ — Database migration files (auto-generated by drizzle-kit)
- scripts/ — Build and development helper scripts

### Socket.IO

Two namespaces handle real-time communication:

- **`/devices`** — Broadcasts device list changes to all connected clients
- **`/session`** — Manages individual Frida sessions (one per connected client)

Session lifecycle:

1. Client connects with query params (`device`, `platform`, `mode`, `bundle`/`pid`)
2. Server attaches to the Frida device and resolves the target PID
3. A Frida session is created and the platform-specific agent script is loaded
4. Data stores (HookStore, CryptoStore, etc.) are initialized per session
5. The `ready` event is emitted with the PID
6. RPC calls, logs, and hook events are proxied between client and agent
7. Tap snapshots are persisted after changes

### Data Stores

Each store class follows a consistent pattern: `append()`, `query()`, `count()`, `rm()`. All stores use a composite key of `(deviceId, identifier)` for session isolation.

| Store          | Backing        | Purpose                                       |
| -------------- | -------------- | --------------------------------------------- |
| `HookStore`    | SQLite         | ObjC/native method hook logs                  |
| `CryptoStore`  | SQLite         | Cryptographic API interception logs           |
| `NSURLStore`   | SQLite + files | HTTP/HTTPS request logs with body attachments |
| `FlutterStore` | SQLite         | Flutter method channel events                 |
| `JNIStore`     | SQLite         | Android JNI call traces                       |
| `TapStore`     | File system    | Hook rule snapshots for persistence           |
| `LogWriter`    | File system    | Syslog and agent log streaming                |

Due to the limitation of web UI, there is no project or workspace concept, all data is stored in a global directory and disambiguated by device ID and target identifier (bundle or PID).

### Database Schema (Drizzle + SQLite)

Uses [Drizzle ORM](https://orm.drizzle.team/) with SQLite. Runtime uses `bun:sqlite` under Bun or `better-sqlite3` under Node.js.

Migrations live in `drizzle/` and are auto-generated by `drizzle-kit`.

### Session Context

The `SessionContext` manages the active instrumentation session:

- Current platform (`fruity` / `droid`)
- Device ID, bundle/PID, mode
- Socket.IO connection lifecycle
- Typed RPC proxies that are platform-aware (accessing the wrong platform's API throws)

### RPC Client

The frontend creates a proxy-based RPC client (`gui/src/lib/rpc.ts`) that:

- Queues calls until the `ready` event fires
- Provides namespace.method(...args) syntax via `Proxy`
- Returns typed promises matching the agent's exported interfaces
- Rejects pending calls on disconnect

TanStack Query hooks (`useRpcQuery`, `useDroidRpcQuery`, etc.) wrap RPC calls with caching, refetching, and error handling.

## Agent

### Platform-Specific Agents

Two independent agents compiled by `frida-compile`:

- **`fruity`** (iOS) — Uses `frida-objc-bridge` and `frida-swift-bridge`
- **`droid`** (Android) — Uses `frida-java-bridge`

Each agent exports four RPC methods:

```typescript
rpc.exports = {
  invoke(namespace, method, args)   // Dynamic method dispatch
  interfaces()                      // List all available namespace.method pairs
  restore(rules)                    // Restore previously saved hook rules
  snapshot()                        // Capture current hook state
}
```

### Module Registry Pattern

Each platform defines a static router (`router.ts`) mapping namespace names to module objects:

```typescript
// fruity/router.ts
export default { checksec, classdump, cookies, crypto, fs, keychain, ... }
```

The `createRegistry(route)` function (in `common/registry.ts`) wraps the router to produce `invoke()` and `interfaces()` functions. When `invoke("fs", "ls", ["/"])` is called, it looks up `route.fs.ls` and calls it with the arguments.

## Build & Asset Pipeline

### Agent Build

`frida-compile` compiles TypeScript to Frida-compatible JavaScript:

- `dist/fruity.js` — iOS agent
- `dist/droid.js` — Android agent
- `dist/transport.js` — File transfer helper

Type definitions are generated via `tsgo` and output to `agent/types/` for use by the frontend (aliased as `@agent` in Vite config).

Bridge scripts (Java, ObjC, Swift) are downloaded from PyPI packages and stored in `dist/bridges/`.

### Bun SEA Build

The `scripts/build-bun.ts` script:

1. Builds the GUI (`gui/dist/`)
2. Builds the agent (`agent/dist/`)
3. Packs GUI, agent, and Drizzle migrations into `assets.tgz`
4. Prebuilds native Frida modules for target platforms
5. Compiles to standalone binary via `bun build --compile --target=<platform>`

At runtime, embedded assets are extracted from the tarball (`src/lib/assets.ts`).

### npm Package Build

`tsdown` bundles the backend into a single ESM file (`dist/index.mjs`). Uses `better-sqlite3` for Node.js compatibility. The package includes pre-built agent and GUI assets.

```

`docs/dev.md`:

```md
# Development Setup & Workflow

## Prerequisites

- [Bun](https://bun.sh/) (primary runtime, recommended)
- Node.js >= 22.18.0 (alternative runtime for npm package)
- A device running [frida-server](https://frida.re/docs/installation/) connected via USB or network
- iOS or Android target device/emulator

## Installation

```bash
# Clone the repository
git clone https://github.com/chichou/grapefruit.git
cd grapefruit

# Install all dependencies (root + agent + gui)
bun install
```

Each workspace has its own `package.json`. The root `prepare` script handles building the agent and GUI automatically after install.

## Available Scripts

### Root

| Script                       | Description                                   |
| ---------------------------- | --------------------------------------------- |
| `bun run dev:both`           | Start backend + frontend dev servers together |
| `bun run dev`                | Backend only with file watching (`--watch`)   |
| `bun run start`              | Start backend without watch                   |
| `bun test`                   | Run tests with Bun test runner                |
| `bun run test:coverage`      | Run tests with LCOV coverage output           |
| `bun run test:coverage:text` | Run tests with text coverage summary          |
| `bun run build:cli`          | Build single executable for current platform  |
| `bun run build:npm`          | Build npm distribution package                |
| `bun run build:all`          | Cross-compile for all platforms               |

### Agent (`agent/`)

| Script                    | Description                                  |
| ------------------------- | -------------------------------------------- |
| `bun run build`           | Build all agents + types                     |
| `bun run build:fruity`    | Build iOS agent only                         |
| `bun run build:droid`     | Build Android agent only                     |
| `bun run build:transport` | Build transport layer                        |
| `bun run watch:fruity`    | Build iOS agent in watch mode                |
| `bun run watch:droid`     | Build Android agent in watch mode            |
| `bun run type`            | Generate TypeScript definitions for frontend |
| `bun run lint`            | Lint agent source                            |

### GUI (`gui/`)

| Script            | Description                         |
| ----------------- | ----------------------------------- |
| `bun run dev`     | Vite dev server                     |
| `bun run build`   | Production build (typecheck + Vite) |
| `bun run lint`    | Lint frontend source                |
| `bun run preview` | Preview production build locally    |

## Environment Variables

| Variable        | Default                             | Description                                       |
| --------------- | ----------------------------------- | ------------------------------------------------- |
| `FRIDA_VERSION` | `17`                                | Frida version to use (`16` or `17`)               |
| `HOST`          | `localhost` (prod) / hostname (dev) | Server bind address                               |
| `PORT`          | `31337`                             | Server port                                       |
| `BACKEND_PORT`  | `31337`                             | Backend port (dev mode only)                      |
| `WEB_PORT`      | `3000` (dev) / same as PORT (prod)  | Frontend port                                     |
| `FRIDA_TIMEOUT` | `1000`                              | Device discovery timeout (ms)                     |
| `NODE_ENV`      | —                                   | `development` or `production`                     |
| `SQLITE`        | —                                   | Set to `better-sqlite3` for Node.js compatibility |

CLI arguments (`--frida`, `--host`, `--port`) take precedence over environment variables.

## Build Targets

### CLI Binary (Bun SEA)

Single executable application using Bun's `--compile` flag:

```bash
# Current platform
bun run build:cli

# Cross-compile all platforms
bun run build:all
```

Outputs to `build/Release/`:

- `igf-linux-x64`
- `igf-windows-x64.exe`
- `igf-darwin-x64`
- `igf-darwin-arm64`

The build process:

1. Compiles agent and GUI
2. Creates `assets.tgz` (GUI dist, agent dist, Drizzle migrations)
3. Prebuilds native Frida modules for each target
4. Produces standalone binaries via `bun build --compile`

### npm Package

```bash
bun run build:npm
# or
npm pack
```

Bundles with `tsdown`, uses `better-sqlite3` for Node.js compatibility. The package includes a `bin/igf` entry point.

## Testing

Tests use Bun's built-in test runner.

```bash
# Run all tests
bun test

# With text coverage summary
bun run test:coverage:text

# With LCOV output (for CI)
bun run test:coverage
```

Test files live in `src/tests/`:

- `app.test.ts` — HTTP API tests
- `agent.test.ts` — Agent integration tests
- `ws.test.ts` — Socket.IO session tests

Coverage output goes to `coverage/lcov.info`.

## Development Tips

- The dev server (`bun run dev:both`) starts the backend on port 31337 and the Vite frontend on port 3000. The frontend proxies `/api` and `/socket.io/` to the backend.
- When working on the agent only, use `bun run watch:fruity` or `bun run watch:droid` for live rebuilds.
- Agent RPC can be tested directly with Frida CLI:
  ```bash
  frida -U -F -l agent/src/fruity/index.ts \
    -e 'rpc.exports.invoke("info", "processInfo", [])' -q
  ```
- Data (logs, database, cache) is stored in platform-specific locations:
  - macOS: `~/Library/Application Support/igf`
  - Linux: `~/.local/share/igf`
  - Windows: `%APPDATA%\igf`

```

`docs/rpc.md`:

```md
# RPC Design

## Overview

igf uses a 3-layer communication architecture:

```
UI (React)  ←──Socket.IO / REST──→  Server (Hono)  ←──Frida RPC──→  Agent (in-process)
```

- **UI ↔ Server**: Socket.IO for real-time RPC and events, REST for data queries and file transfers
- **Server ↔ Agent**: Frida's `script.exports` RPC mechanism over USB/network

## Agent RPC Exports

Every platform agent (fruity/droid) exports four methods via `rpc.exports`:

### `invoke(namespace, method, args)`

The primary dispatch function. Routes calls through the module registry:

```typescript
// Example: list files in root directory
script.exports.invoke("fs", "ls", ["/"])

// Example: dump keychain items (iOS)
script.exports.invoke("keychain", "list", [])
```

### `interfaces()`

Returns an array of all available `namespace.method` strings:

```typescript
script.exports.interfaces()
// → ["checksec.flags", "classdump.hierarchy", "fs.ls", "fs.read", ...]
```

### `restore(rules)`

Restores previously saved hook rules (taps). Called automatically on session start to re-establish hooks from a prior session:

```typescript
script.exports.restore([
  { category: "objc", symbol: "-[NSURLSession dataTaskWithRequest:]", ... }
])
```

### `snapshot()`

Captures the current set of active hook rules for persistence:

```typescript
const rules = script.exports.snapshot()
// → [{ category: "objc", symbol: "...", ... }, ...]
```

## Registry Pattern

The registry is defined in `agent/src/common/registry.ts`:

```typescript
function createRegistry(route) {
  function invoke(ns, fn, args) {
    const iface = route[ns]
    if (!iface) throw new Error(`${ns} not found`)
    const method = iface[fn]
    if (!method) throw new Error(`${ns}.${fn} not found`)
    return method(...args)
  }

  function interfaces() {
    // yields all "namespace.method" strings
  }

  return { invoke, interfaces }
}
```

Each platform defines a router mapping namespaces to module objects:

```typescript
// agent/src/fruity/router.ts
export default {
  checksec,    // binary security checks
  classdump,   // runtime class extraction
  cookies,     // HTTP cookie access
  crypto,      // crypto API interception control
  fs,          // filesystem operations
  info,        // app info (bundle, version, paths)
  keychain,    // keychain dumping
  // ...
}
```

Types flow end-to-end: `RemoteRPC<T>` converts synchronous module methods to async promises, matching the RPC boundary.

## Socket.IO Events

### Namespaces

| Namespace | Purpose |
|-----------|---------|
| `/devices` | Device list change notifications |
| `/session` | Individual instrumentation session |

### Server → Client Events

| Event | Payload | Description |
|-------|---------|-------------|
| `ready` | `(pid: number)` | Session initialized, agent loaded |
| `log` | `(level: string, text: string)` | Agent log output |
| `syslog` | `(text: string)` | System log entry |
| `hook` | `(msg: BaseHookMessage)` | Hook interception event |
| `crypto` | `(msg: BaseHookMessage, data?: ArrayBuffer)` | Crypto API call captured |
| `nsurl` | `(event: NSURLEvent)` | Network request event (iOS) |
| `jni` | `(event: JNIEvent)` | JNI call event (Android) |
| `flutter` | `(event: Record<string, unknown>)` | Flutter method channel event |
| `lifecycle` | `(event: string)` | App lifecycle change (active/inactive/foreground/background) |
| `detached` | `(reason: string)` | Session disconnected |
| `fatal` | `(detail: unknown)` | Fatal error |
| `change` | `()` | Device list changed (on `/devices` namespace) |
| `invalid` | `()` | Invalid session parameters |

### Client → Server Events

| Event | Payload | Description |
|-------|---------|-------------|
| `rpc` | `(namespace, method, args, ack)` | Invoke agent RPC method |
| `eval` | `(source, name, ack)` | Evaluate JavaScript in agent |
| `clearLog` | `(type: "syslog" \| "agent", ack)` | Clear log file |

### Connection Parameters

The `/session` namespace expects these query params on connect:

| Param | Values | Description |
|-------|--------|-------------|
| `device` | device ID | Target Frida device |
| `platform` | `fruity` \| `droid` | iOS or Android |
| `mode` | `app` \| `daemon` | Attach to app or daemon process |
| `bundle` | bundle ID | App identifier (for `app` mode) |
| `pid` | number | Process ID (for `daemon` mode) |
| `name` | string | Display name |

## REST API Endpoints

All endpoints are prefixed with `/api`.

### Device Management

| Method | Path | Description |
|--------|------|-------------|
| `GET` | `/version` | Get Frida and igf versions |
| `GET` | `/d.ts/pack` | Get agent TypeScript type definitions |
| `GET` | `/devices` | List connected devices |
| `GET` | `/device/:device/apps` | List apps on device |
| `GET` | `/device/:device/processes` | List processes on device |
| `GET` | `/device/:device/icon/:bundle` | Get app icon (PNG) |
| `GET` | `/device/:device/info` | Get device system parameters |
| `POST` | `/device/:device/kill/:pid` | Kill a process |
| `PUT` | `/devices/remote/:hostname` | Add remote Frida device |
| `DELETE` | `/devices/remote/:hostname` | Remove remote Frida device |

### File Transfer

| Method | Path | Description |
|--------|------|-------------|
| `GET` | `/download/:device/:pid?path=...` | Download file from device |
| `POST` | `/upload/:device/:pid` | Upload file to device |

### Data & History

| Method | Path | Description |
|--------|------|-------------|
| `GET` | `/logs/:device/:identifier/:type` | Stream log file (syslog/agent) |
| `DELETE` | `/logs/:device/:identifier` | Delete all logs |
| `GET` | `/hooks/:device/:identifier` | Query hook logs (paginated) |
| `DELETE` | `/hooks/:device/:identifier` | Clear hook logs |
| `GET` | `/history/crypto/:device/:identifier` | Query crypto logs |
| `DELETE` | `/history/crypto/:device/:identifier` | Clear crypto logs |
| `GET` | `/history/jni/:device/:identifier` | Query JNI traces |
| `DELETE` | `/history/jni/:device/:identifier` | Clear JNI traces |
| `GET` | `/history/flutter/:device/:identifier` | Query Flutter logs |
| `DELETE` | `/history/flutter/:device/:identifier` | Clear Flutter logs |
| `GET` | `/history/nsurl/:device/:identifier` | Query network request logs |
| `DELETE` | `/history/nsurl/:device/:identifier` | Clear network request logs |
| `GET` | `/history/nsurl/:device/:identifier/attachment/:requestId` | Download request body |
| `GET` | `/taps/:device/:identifier` | Load tap snapshot |
| `DELETE` | `/taps/:device/:identifier` | Clear tap snapshot |

Query parameters for history endpoints: `limit`, `offset`, `since`, `category` (hooks), `method` (JNI).

### LLM

| Method | Path | Description |
|--------|------|-------------|
| `POST` | `/llm` | LLM integration endpoint |

## End-to-End Data Flow

### Example: Hooking an Objective-C Method

1. **User** clicks "Add Hook" in the Hooks panel, selects `-[NSURLSession dataTaskWithRequest:]`

2. **Frontend** emits Socket.IO RPC:
   ```javascript
   socket.emit("rpc", "taps", "add", [{ category: "objc", symbol: "..." }], callback)
   ```

3. **Server** (`ws.ts`) receives the `rpc` event and calls:
   ```javascript
   script.exports.invoke("taps", "add", [{ category: "objc", symbol: "..." }])
   ```

4. **Agent** (`common/taps.ts`) installs the Interceptor hook in the target process

5. **Agent** sends hook events back via `send()` when the hooked method is called

6. **Server** receives script messages, persists to `HookStore` (SQLite), and emits:
   ```javascript
   socket.emit("hook", { symbol, direction, timestamp, ... })
   ```

7. **Frontend** receives the `hook` event, updates TanStack Query cache, and renders the log entry

8. **Server** auto-saves the tap snapshot after changes via `script.exports.snapshot()`, persisted to disk for session recovery

### Example: Browsing the Filesystem

1. **Frontend** calls `rpc.fs.ls("/var/mobile")` via the proxy
2. Proxy emits `socket.emit("rpc", "fs", "ls", ["/var/mobile"], callback)`
3. Server calls `script.exports.invoke("fs", "ls", ["/var/mobile"])`
4. Agent's `fs` module calls Frida's `ObjC.classes.NSFileManager` APIs
5. Result propagates back through `ack` callback to the frontend promise

## Type Sharing Across Layers

Types flow from agent to frontend:

1. Agent modules define method signatures in TypeScript
2. `tsgo` generates type definitions to `agent/types/`
3. Vite aliases `@agent` to `../agent/types` so the GUI can import them
4. `RemoteRPC<T>` type helper wraps all methods as async (reflecting the RPC boundary)
5. `createProxy()` returns a typed proxy matching the agent interface

This ensures that calling `rpc.fs.ls("/")` in the frontend is fully type-checked against the agent's actual `fs.ls` implementation.

```

`drizzle.config.ts`:

```ts
import { defineConfig } from "drizzle-kit";

export default defineConfig({
  schema: "./src/lib/schema.ts",
  out: "./drizzle",
  dialect: "sqlite",
});

```

`drizzle/0000_opposite_sentry.sql`:

```sql
CREATE TABLE `crypto` (
	`id` integer PRIMARY KEY AUTOINCREMENT NOT NULL,
	`device_id` text NOT NULL,
	`identifier` text NOT NULL,
	`timestamp` text NOT NULL,
	`symbol` text NOT NULL,
	`direction` text NOT NULL,
	`line` text,
	`extra` text,
	`backtrace` text,
	`data` blob,
	`created_at` text DEFAULT CURRENT_TIMESTAMP
);
--> statement-breakpoint
CREATE INDEX `idx_crypto_device_identifier` ON `crypto` (`device_id`,`identifier`);--> statement-breakpoint
CREATE INDEX `idx_crypto_timestamp` ON `crypto` (`timestamp`);--> statement-breakpoint
CREATE TABLE `flutter` (
	`id` integer PRIMARY KEY AUTOINCREMENT NOT NULL,
	`device_id` text NOT NULL,
	`identifier` text NOT NULL,
	`timestamp` text NOT NULL,
	`type` text NOT NULL,
	`direction` text NOT NULL,
	`channel` text NOT NULL,
	`data` text,
	`created_at` text DEFAULT CURRENT_TIMESTAMP
);
--> statement-breakpoint
CREATE INDEX `idx_flutter_device_identifier` ON `flutter` (`device_id`,`identifier`);--> statement-breakpoint
CREATE INDEX `idx_flutter_timestamp` ON `flutter` (`timestamp`);--> statement-breakpoint
CREATE TABLE `hooks` (
	`id` integer PRIMARY KEY AUTOINCREMENT NOT NULL,
	`device_id` text NOT NULL,
	`identifier` text NOT NULL,
	`timestamp` text NOT NULL,
	`category` text NOT NULL,
	`symbol` text NOT NULL,
	`direction` text NOT NULL,
	`line` text,
	`extra` text,
	`created_at` text DEFAULT CURRENT_TIMESTAMP
);
--> statement-breakpoint
CREATE INDEX `idx_hooks_device_identifier` ON `hooks` (`device_id`,`identifier`);--> statement-breakpoint
CREATE INDEX `idx_hooks_timestamp` ON `hooks` (`timestamp`);--> statement-breakpoint
CREATE INDEX `idx_hooks_category` ON `hooks` (`category`);--> statement-breakpoint
CREATE TABLE `jni` (
	`id` integer PRIMARY KEY AUTOINCREMENT NOT NULL,
	`device_id` text NOT NULL,
	`identifier` text NOT NULL,
	`timestamp` text NOT NULL,
	`type` text NOT NULL,
	`method` text NOT NULL,
	`call_type` text NOT NULL,
	`thread_id` integer,
	`args` text,
	`ret` text,
	`backtrace` text,
	`library` text,
	`created_at` text DEFAULT CURRENT_TIMESTAMP
);
--> statement-breakpoint
CREATE INDEX `idx_jni_device_identifier` ON `jni` (`device_id`,`identifier`);--> statement-breakpoint
CREATE INDEX `idx_jni_method` ON `jni` (`method`);--> statement-breakpoint
CREATE INDEX `idx_jni_timestamp` ON `jni` (`timestamp`);--> statement-breakpoint
CREATE TABLE `nsurl_requests` (
	`id` integer PRIMARY KEY AUTOINCREMENT NOT NULL,
	`device_id` text NOT NULL,
	`identifier` text NOT NULL,
	`request_id` text NOT NULL,
	`data` text NOT NULL,
	`attachment` text,
	`mime` text,
	`created_at` text DEFAULT CURRENT_TIMESTAMP,
	`updated_at` text DEFAULT CURRENT_TIMESTAMP
);
--> statement-breakpoint
CREATE INDEX `idx_nsurl_requests_device_identifier` ON `nsurl_requests` (`device_id`,`identifier`);--> statement-breakpoint
CREATE UNIQUE INDEX `idx_nsurl_requests_request_id` ON `nsurl_requests` (`device_id`,`identifier`,`request_id`);--> statement-breakpoint
CREATE TABLE `preferences` (
	`key` text PRIMARY KEY NOT NULL,
	`value` text
);

```

`drizzle/0001_cheerful_zaran.sql`:

```sql
CREATE TABLE `xpc_logs` (
	`id` integer PRIMARY KEY AUTOINCREMENT NOT NULL,
	`device_id` text NOT NULL,
	`identifier` text NOT NULL,
	`timestamp` text NOT NULL,
	`protocol` text NOT NULL,
	`event` text NOT NULL,
	`direction` text NOT NULL,
	`service` text,
	`peer` integer,
	`message` text NOT NULL,
	`backtrace` text,
	`created_at` text DEFAULT CURRENT_TIMESTAMP
);
--> statement-breakpoint
CREATE INDEX `idx_xpc_logs_device_identifier` ON `xpc_logs` (`device_id`,`identifier`);--> statement-breakpoint
CREATE INDEX `idx_xpc_logs_timestamp` ON `xpc_logs` (`timestamp`);--> statement-breakpoint
CREATE INDEX `idx_xpc_logs_protocol` ON `xpc_logs` (`protocol`);
```

`drizzle/0002_conscious_tyrannus.sql`:

```sql
CREATE TABLE `hbc` (
	`id` integer PRIMARY KEY AUTOINCREMENT NOT NULL,
	`device_id` text NOT NULL,
	`identifier` text NOT NULL,
	`url` text NOT NULL,
	`hash` text NOT NULL,
	`size` integer NOT NULL,
	`data` blob NOT NULL,
	`created_at` text DEFAULT CURRENT_TIMESTAMP
);
--> statement-breakpoint
CREATE INDEX `idx_hbc_device_identifier` ON `hbc` (`device_id`,`identifier`);--> statement-breakpoint
CREATE UNIQUE INDEX `idx_hbc_hash` ON `hbc` (`hash`);--> statement-breakpoint
CREATE INDEX `idx_hbc_created_at` ON `hbc` (`created_at`);
```

`drizzle/meta/0000_snapshot.json`:

```json
{
  "version": "6",
  "dialect": "sqlite",
  "id": "b1d6fc40-4ed0-4219-a5ea-662dfebc1328",
  "prevId": "00000000-0000-0000-0000-000000000000",
  "tables": {
    "crypto": {
      "name": "crypto",
      "columns": {
        "id": {
          "name": "id",
          "type": "integer",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": true
        },
        "device_id": {
          "name": "device_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "identifier": {
          "name": "identifier",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "timestamp": {
          "name": "timestamp",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "symbol": {
          "name": "symbol",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "direction": {
          "name": "direction",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "line": {
          "name": "line",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "extra": {
          "name": "extra",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "backtrace": {
          "name": "backtrace",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "data": {
          "name": "data",
          "type": "blob",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        }
      },
      "indexes": {
        "idx_crypto_device_identifier": {
          "name": "idx_crypto_device_identifier",
          "columns": [
            "device_id",
            "identifier"
          ],
          "isUnique": false
        },
        "idx_crypto_timestamp": {
          "name": "idx_crypto_timestamp",
          "columns": [
            "timestamp"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "flutter": {
      "name": "flutter",
      "columns": {
        "id": {
          "name": "id",
          "type": "integer",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": true
        },
        "device_id": {
          "name": "device_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "identifier": {
          "name": "identifier",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "timestamp": {
          "name": "timestamp",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "type": {
          "name": "type",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "direction": {
          "name": "direction",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "channel": {
          "name": "channel",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "data": {
          "name": "data",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        }
      },
      "indexes": {
        "idx_flutter_device_identifier": {
          "name": "idx_flutter_device_identifier",
          "columns": [
            "device_id",
            "identifier"
          ],
          "isUnique": false
        },
        "idx_flutter_timestamp": {
          "name": "idx_flutter_timestamp",
          "columns": [
            "timestamp"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "hooks": {
      "name": "hooks",
      "columns": {
        "id": {
          "name": "id",
          "type": "integer",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": true
        },
        "device_id": {
          "name": "device_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "identifier": {
          "name": "identifier",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "timestamp": {
          "name": "timestamp",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "category": {
          "name": "category",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "symbol": {
          "name": "symbol",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "direction": {
          "name": "direction",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "line": {
          "name": "line",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "extra": {
          "name": "extra",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        }
      },
      "indexes": {
        "idx_hooks_device_identifier": {
          "name": "idx_hooks_device_identifier",
          "columns": [
            "device_id",
            "identifier"
          ],
          "isUnique": false
        },
        "idx_hooks_timestamp": {
          "name": "idx_hooks_timestamp",
          "columns": [
            "timestamp"
          ],
          "isUnique": false
        },
        "idx_hooks_category": {
          "name": "idx_hooks_category",
          "columns": [
            "category"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "jni": {
      "name": "jni",
      "columns": {
        "id": {
          "name": "id",
          "type": "integer",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": true
        },
        "device_id": {
          "name": "device_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "identifier": {
          "name": "identifier",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "timestamp": {
          "name": "timestamp",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "type": {
          "name": "type",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "method": {
          "name": "method",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "call_type": {
          "name": "call_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "thread_id": {
          "name": "thread_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "args": {
          "name": "args",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "ret": {
          "name": "ret",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "backtrace": {
          "name": "backtrace",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "library": {
          "name": "library",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        }
      },
      "indexes": {
        "idx_jni_device_identifier": {
          "name": "idx_jni_device_identifier",
          "columns": [
            "device_id",
            "identifier"
          ],
          "isUnique": false
        },
        "idx_jni_method": {
          "name": "idx_jni_method",
          "columns": [
            "method"
          ],
          "isUnique": false
        },
        "idx_jni_timestamp": {
          "name": "idx_jni_timestamp",
          "columns": [
            "timestamp"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "nsurl_requests": {
      "name": "nsurl_requests",
      "columns": {
        "id": {
          "name": "id",
          "type": "integer",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": true
        },
        "device_id": {
          "name": "device_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "identifier": {
          "name": "identifier",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "request_id": {
          "name": "request_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "data": {
          "name": "data",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "attachment": {
          "name": "attachment",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "mime": {
          "name": "mime",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        }
      },
      "indexes": {
        "idx_nsurl_requests_device_identifier": {
          "name": "idx_nsurl_requests_device_identifier",
          "columns": [
            "device_id",
            "identifier"
          ],
          "isUnique": false
        },
        "idx_nsurl_requests_request_id": {
          "name": "idx_nsurl_requests_request_id",
          "columns": [
            "device_id",
            "identifier",
            "request_id"
          ],
          "isUnique": true
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "preferences": {
      "name": "preferences",
      "columns": {
        "key": {
          "name": "key",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "value": {
          "name": "value",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    }
  },
  "views": {},
  "enums": {},
  "_meta": {
    "schemas": {},
    "tables": {},
    "columns": {}
  },
  "internal": {
    "indexes": {}
  }
}
```

`drizzle/meta/0001_snapshot.json`:

```json
{
  "version": "6",
  "dialect": "sqlite",
  "id": "43e721b4-e32c-4dfc-a400-0d418b08a763",
  "prevId": "b1d6fc40-4ed0-4219-a5ea-662dfebc1328",
  "tables": {
    "crypto": {
      "name": "crypto",
      "columns": {
        "id": {
          "name": "id",
          "type": "integer",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": true
        },
        "device_id": {
          "name": "device_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "identifier": {
          "name": "identifier",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "timestamp": {
          "name": "timestamp",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "symbol": {
          "name": "symbol",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "direction": {
          "name": "direction",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "line": {
          "name": "line",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "extra": {
          "name": "extra",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "backtrace": {
          "name": "backtrace",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "data": {
          "name": "data",
          "type": "blob",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        }
      },
      "indexes": {
        "idx_crypto_device_identifier": {
          "name": "idx_crypto_device_identifier",
          "columns": [
            "device_id",
            "identifier"
          ],
          "isUnique": false
        },
        "idx_crypto_timestamp": {
          "name": "idx_crypto_timestamp",
          "columns": [
            "timestamp"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "flutter": {
      "name": "flutter",
      "columns": {
        "id": {
          "name": "id",
          "type": "integer",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": true
        },
        "device_id": {
          "name": "device_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "identifier": {
          "name": "identifier",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "timestamp": {
          "name": "timestamp",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "type": {
          "name": "type",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "direction": {
          "name": "direction",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "channel": {
          "name": "channel",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "data": {
          "name": "data",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        }
      },
      "indexes": {
        "idx_flutter_device_identifier": {
          "name": "idx_flutter_device_identifier",
          "columns": [
            "device_id",
            "identifier"
          ],
          "isUnique": false
        },
        "idx_flutter_timestamp": {
          "name": "idx_flutter_timestamp",
          "columns": [
            "timestamp"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "hooks": {
      "name": "hooks",
      "columns": {
        "id": {
          "name": "id",
          "type": "integer",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": true
        },
        "device_id": {
          "name": "device_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "identifier": {
          "name": "identifier",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "timestamp": {
          "name": "timestamp",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "category": {
          "name": "category",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "symbol": {
          "name": "symbol",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "direction": {
          "name": "direction",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "line": {
          "name": "line",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "extra": {
          "name": "extra",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        }
      },
      "indexes": {
        "idx_hooks_device_identifier": {
          "name": "idx_hooks_device_identifier",
          "columns": [
            "device_id",
            "identifier"
          ],
          "isUnique": false
        },
        "idx_hooks_timestamp": {
          "name": "idx_hooks_timestamp",
          "columns": [
            "timestamp"
          ],
          "isUnique": false
        },
        "idx_hooks_category": {
          "name": "idx_hooks_category",
          "columns": [
            "category"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "jni": {
      "name": "jni",
      "columns": {
        "id": {
          "name": "id",
          "type": "integer",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": true
        },
        "device_id": {
          "name": "device_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "identifier": {
          "name": "identifier",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "timestamp": {
          "name": "timestamp",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "type": {
          "name": "type",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "method": {
          "name": "method",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "call_type": {
          "name": "call_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "thread_id": {
          "name": "thread_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "args": {
          "name": "args",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "ret": {
          "name": "ret",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "backtrace": {
          "name": "backtrace",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "library": {
          "name": "library",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        }
      },
      "indexes": {
        "idx_jni_device_identifier": {
          "name": "idx_jni_device_identifier",
          "columns": [
            "device_id",
            "identifier"
          ],
          "isUnique": false
        },
        "idx_jni_method": {
          "name": "idx_jni_method",
          "columns": [
            "method"
          ],
          "isUnique": false
        },
        "idx_jni_timestamp": {
          "name": "idx_jni_timestamp",
          "columns": [
            "timestamp"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "nsurl_requests": {
      "name": "nsurl_requests",
      "columns": {
        "id": {
          "name": "id",
          "type": "integer",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": true
        },
        "device_id": {
          "name": "device_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "identifier": {
          "name": "identifier",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "request_id": {
          "name": "request_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "data": {
          "name": "data",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "attachment": {
          "name": "attachment",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "mime": {
          "name": "mime",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        }
      },
      "indexes": {
        "idx_nsurl_requests_device_identifier": {
          "name": "idx_nsurl_requests_device_identifier",
          "columns": [
            "device_id",
            "identifier"
          ],
          "isUnique": false
        },
        "idx_nsurl_requests_request_id": {
          "name": "idx_nsurl_requests_request_id",
          "columns": [
            "device_id",
            "identifier",
            "request_id"
          ],
          "isUnique": true
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "preferences": {
      "name": "preferences",
      "columns": {
        "key": {
          "name": "key",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "value": {
          "name": "value",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "xpc_logs": {
      "name": "xpc_logs",
      "columns": {
        "id": {
          "name": "id",
          "type": "integer",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": true
        },
        "device_id": {
          "name": "device_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "identifier": {
          "name": "identifier",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "timestamp": {
          "name": "timestamp",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "protocol": {
          "name": "protocol",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "event": {
          "name": "event",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "direction": {
          "name": "direction",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "service": {
          "name": "service",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "peer": {
          "name": "peer",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "message": {
          "name": "message",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "backtrace": {
          "name": "backtrace",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        }
      },
      "indexes": {
        "idx_xpc_logs_device_identifier": {
          "name": "idx_xpc_logs_device_identifier",
          "columns": [
            "device_id",
            "identifier"
          ],
          "isUnique": false
        },
        "idx_xpc_logs_timestamp": {
          "name": "idx_xpc_logs_timestamp",
          "columns": [
            "timestamp"
          ],
          "isUnique": false
        },
        "idx_xpc_logs_protocol": {
          "name": "idx_xpc_logs_protocol",
          "columns": [
            "protocol"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    }
  },
  "views": {},
  "enums": {},
  "_meta": {
    "schemas": {},
    "tables": {},
    "columns": {}
  },
  "internal": {
    "indexes": {}
  }
}
```

`drizzle/meta/0002_snapshot.json`:

```json
{
  "version": "6",
  "dialect": "sqlite",
  "id": "f0269e92-526d-4def-a4b4-915c8a4f61d2",
  "prevId": "43e721b4-e32c-4dfc-a400-0d418b08a763",
  "tables": {
    "crypto": {
      "name": "crypto",
      "columns": {
        "id": {
          "name": "id",
          "type": "integer",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": true
        },
        "device_id": {
          "name": "device_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "identifier": {
          "name": "identifier",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "timestamp": {
          "name": "timestamp",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "symbol": {
          "name": "symbol",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "direction": {
          "name": "direction",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "line": {
          "name": "line",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "extra": {
          "name": "extra",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "backtrace": {
          "name": "backtrace",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "data": {
          "name": "data",
          "type": "blob",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        }
      },
      "indexes": {
        "idx_crypto_device_identifier": {
          "name": "idx_crypto_device_identifier",
          "columns": [
            "device_id",
            "identifier"
          ],
          "isUnique": false
        },
        "idx_crypto_timestamp": {
          "name": "idx_crypto_timestamp",
          "columns": [
            "timestamp"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "flutter": {
      "name": "flutter",
      "columns": {
        "id": {
          "name": "id",
          "type": "integer",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": true
        },
        "device_id": {
          "name": "device_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "identifier": {
          "name": "identifier",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "timestamp": {
          "name": "timestamp",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "type": {
          "name": "type",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "direction": {
          "name": "direction",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "channel": {
          "name": "channel",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "data": {
          "name": "data",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        }
      },
      "indexes": {
        "idx_flutter_device_identifier": {
          "name": "idx_flutter_device_identifier",
          "columns": [
            "device_id",
            "identifier"
          ],
          "isUnique": false
        },
        "idx_flutter_timestamp": {
          "name": "idx_flutter_timestamp",
          "columns": [
            "timestamp"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "hbc": {
      "name": "hbc",
      "columns": {
        "id": {
          "name": "id",
          "type": "integer",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": true
        },
        "device_id": {
          "name": "device_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "identifier": {
          "name": "identifier",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "url": {
          "name": "url",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "hash": {
          "name": "hash",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "size": {
          "name": "size",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "data": {
          "name": "data",
          "type": "blob",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        }
      },
      "indexes": {
        "idx_hbc_device_identifier": {
          "name": "idx_hbc_device_identifier",
          "columns": [
            "device_id",
            "identifier"
          ],
          "isUnique": false
        },
        "idx_hbc_hash": {
          "name": "idx_hbc_hash",
          "columns": [
            "hash"
          ],
          "isUnique": true
        },
        "idx_hbc_created_at": {
          "name": "idx_hbc_created_at",
          "columns": [
            "created_at"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "hooks": {
      "name": "hooks",
      "columns": {
        "id": {
          "name": "id",
          "type": "integer",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": true
        },
        "device_id": {
          "name": "device_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "identifier": {
          "name": "identifier",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "timestamp": {
          "name": "timestamp",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "category": {
          "name": "category",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "symbol": {
          "name": "symbol",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "direction": {
          "name": "direction",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "line": {
          "name": "line",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "extra": {
          "name": "extra",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        }
      },
      "indexes": {
        "idx_hooks_device_identifier": {
          "name": "idx_hooks_device_identifier",
          "columns": [
            "device_id",
            "identifier"
          ],
          "isUnique": false
        },
        "idx_hooks_timestamp": {
          "name": "idx_hooks_timestamp",
          "columns": [
            "timestamp"
          ],
          "isUnique": false
        },
        "idx_hooks_category": {
          "name": "idx_hooks_category",
          "columns": [
            "category"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "jni": {
      "name": "jni",
      "columns": {
        "id": {
          "name": "id",
          "type": "integer",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": true
        },
        "device_id": {
          "name": "device_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "identifier": {
          "name": "identifier",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "timestamp": {
          "name": "timestamp",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "type": {
          "name": "type",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "method": {
          "name": "method",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "call_type": {
          "name": "call_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "thread_id": {
          "name": "thread_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "args": {
          "name": "args",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "ret": {
          "name": "ret",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "backtrace": {
          "name": "backtrace",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "library": {
          "name": "library",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        }
      },
      "indexes": {
        "idx_jni_device_identifier": {
          "name": "idx_jni_device_identifier",
          "columns": [
            "device_id",
            "identifier"
          ],
          "isUnique": false
        },
        "idx_jni_method": {
          "name": "idx_jni_method",
          "columns": [
            "method"
          ],
          "isUnique": false
        },
        "idx_jni_timestamp": {
          "name": "idx_jni_timestamp",
          "columns": [
            "timestamp"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "nsurl_requests": {
      "name": "nsurl_requests",
      "columns": {
        "id": {
          "name": "id",
          "type": "integer",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": true
        },
        "device_id": {
          "name": "device_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "identifier": {
          "name": "identifier",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "request_id": {
          "name": "request_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "data": {
          "name": "data",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "attachment": {
          "name": "attachment",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "mime": {
          "name": "mime",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        }
      },
      "indexes": {
        "idx_nsurl_requests_device_identifier": {
          "name": "idx_nsurl_requests_device_identifier",
          "columns": [
            "device_id",
            "identifier"
          ],
          "isUnique": false
        },
        "idx_nsurl_requests_request_id": {
          "name": "idx_nsurl_requests_request_id",
          "columns": [
            "device_id",
            "identifier",
            "request_id"
          ],
          "isUnique": true
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "preferences": {
      "name": "preferences",
      "columns": {
        "key": {
          "name": "key",
          "type": "text",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": false
        },
        "value": {
          "name": "value",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    },
    "xpc_logs": {
      "name": "xpc_logs",
      "columns": {
        "id": {
          "name": "id",
          "type": "integer",
          "primaryKey": true,
          "notNull": true,
          "autoincrement": true
        },
        "device_id": {
          "name": "device_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "identifier": {
          "name": "identifier",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "timestamp": {
          "name": "timestamp",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "protocol": {
          "name": "protocol",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "event": {
          "name": "event",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "direction": {
          "name": "direction",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "service": {
          "name": "service",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "peer": {
          "name": "peer",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "message": {
          "name": "message",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "autoincrement": false
        },
        "backtrace": {
          "name": "backtrace",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false
        },
        "created_at": {
          "name": "created_at",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "autoincrement": false,
          "default": "CURRENT_TIMESTAMP"
        }
      },
      "indexes": {
        "idx_xpc_logs_device_identifier": {
          "name": "idx_xpc_logs_device_identifier",
          "columns": [
            "device_id",
            "identifier"
          ],
          "isUnique": false
        },
        "idx_xpc_logs_timestamp": {
          "name": "idx_xpc_logs_timestamp",
          "columns": [
            "timestamp"
          ],
          "isUnique": false
        },
        "idx_xpc_logs_protocol": {
          "name": "idx_xpc_logs_protocol",
          "columns": [
            "protocol"
          ],
          "isUnique": false
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "checkConstraints": {}
    }
  },
  "views": {},
  "enums": {},
  "_meta": {
    "schemas": {},
    "tables": {},
    "columns": {}
  },
  "internal": {
    "indexes": {}
  }
}
```

`drizzle/meta/_journal.json`:

```json
{
  "version": "7",
  "dialect": "sqlite",
  "entries": [
    {
      "idx": 0,
      "version": "6",
      "when": 1771515903054,
      "tag": "0000_opposite_sentry",
      "breakpoints": true
    },
    {
      "idx": 1,
      "version": "6",
      "when": 1771554924766,
      "tag": "0001_cheerful_zaran",
      "breakpoints": true
    },
    {
      "idx": 2,
      "version": "6",
      "when": 1771796311177,
      "tag": "0002_conscious_tyrannus",
      "breakpoints": true
    }
  ]
}
```

`gui/README.md`:

```md
# Frontend GUI for igf

`npm run dev` to start vite. However, it is recommended to return to the parent directory and run `npm run dev:both` to start both frontend and backend API.

```

`gui/bun.lock`:

```lock
{
  "lockfileVersion": 1,
  "configVersion": 0,
  "workspaces": {
    "": {
      "name": "igf-gui",
      "dependencies": {
        "@base-ui/react": "^1.2.0",
        "@frida/react-use-r2": "^2.0.0",
        "@monaco-editor/react": "^4.7.0",
        "@tailwindcss/vite": "^4.1.16",
        "@tanstack/react-query": "^5.90.20",
        "@tanstack/react-table": "^8.21.3",
        "@tanstack/react-virtual": "^3.13.18",
        "@xterm/xterm": "^6.0.0",
        "class-variance-authority": "^0.7.1",
        "clsx": "^2.1.1",
        "cmdk": "^1.1.1",
        "date-fns": "^4.1.0",
        "dockview": "^4.11.0",
        "i18next": "^25.6.1",
        "leaflet": "^1.9.4",
        "lucide-react": "^0.552.0",
        "magika": "^1.0.0",
        "react": "^19.1.1",
        "react-day-picker": "^9.13.0",
        "react-dom": "^19.1.1",
        "react-i18next": "^16.2.4",
        "react-resizable-panels": "^4.6.4",
        "react-router": "^7.9.5",
        "react-window": "^2.2.5",
        "socket.io-client": "^4.8.1",
        "sonner": "^2.0.7",
        "tailwind-merge": "^3.3.1",
        "tailwindcss": "^4.1.16",
      },
      "devDependencies": {
        "@eslint/js": "^9.36.0",
        "@types/leaflet": "^1.9.21",
        "@types/node": "^24.6.0",
        "@types/react": "^19.1.16",
        "@types/react-dom": "^19.1.9",
        "@typescript/native-preview": "^7.0.0-dev.20260222.1",
        "@vitejs/plugin-react": "^5.1.0",
        "eslint": "^9.36.0",
        "eslint-plugin-react-hooks": "^5.2.0",
        "eslint-plugin-react-refresh": "^0.4.22",
        "globals": "^16.4.0",
        "shadcn": "^3.5.0",
        "tw-animate-css": "^1.4.0",
        "typescript-eslint": "^8.45.0",
        "vite": "npm:rolldown-vite@7.1.14",
      },
    },
  },
  "trustedDependencies": [
    "core-js",
  ],
  "packages": {
    "@antfu/ni": ["@antfu/ni@25.0.0", "", { "dependencies": { "ansis": "^4.0.0", "fzf": "^0.5.2", "package-manager-detector": "^1.3.0", "tinyexec": "^1.0.1" }, "bin": { "na": "bin/na.mjs", "nci": "bin/nci.mjs", "ni": "bin/ni.mjs", "nlx": "bin/nlx.mjs", "nr": "bin/nr.mjs", "nun": "bin/nun.mjs", "nup": "bin/nup.mjs" } }, "sha512-9q/yCljni37pkMr4sPrI3G4jqdIk074+iukc5aFJl7kmDCCsiJrbZ6zKxnES1Gwg+i9RcDZwvktl23puGslmvA=="],

    "@babel/code-frame": ["@babel/code-frame@7.27.1", "", { "dependencies": { "@babel/helper-validator-identifier": "^7.27.1", "js-tokens": "^4.0.0", "picocolors": "^1.1.1" } }, "sha512-cjQ7ZlQ0Mv3b47hABuTevyTuYN4i+loJKGeV9flcCgIK37cCXRh+L1bd3iBHlynerhQ7BhCkn2BPbQUL+rGqFg=="],

    "@babel/compat-data": ["@babel/compat-data@7.28.5", "", {}, "sha512-6uFXyCayocRbqhZOB+6XcuZbkMNimwfVGFji8CTZnCzOHVGvDqzvitu1re2AU5LROliz7eQPhB8CpAMvnx9EjA=="],

    "@babel/core": ["@babel/core@7.28.5", "", { "dependencies": { "@babel/code-frame": "^7.27.1", "@babel/generator": "^7.28.5", "@babel/helper-compilation-targets": "^7.27.2", "@babel/helper-module-transforms": "^7.28.3", "@babel/helpers": "^7.28.4", "@babel/parser": "^7.28.5", "@babel/template": "^7.27.2", "@babel/traverse": "^7.28.5", "@babel/types": "^7.28.5", "@jridgewell/remapping": "^2.3.5", "convert-source-map": "^2.0.0", "debug": "^4.1.0", "gensync": "^1.0.0-beta.2", "json5": "^2.2.3", "semver": "^6.3.1" } }, "sha512-e7jT4DxYvIDLk1ZHmU/m/mB19rex9sv0c2ftBtjSBv+kVM/902eh0fINUzD7UwLLNR+jU585GxUJ8/EBfAM5fw=="],

    "@babel/generator": ["@babel/generator@7.28.5", "", { "dependencies": { "@babel/parser": "^7.28.5", "@babel/types": "^7.28.5", "@jridgewell/gen-mapping": "^0.3.12", "@jridgewell/trace-mapping": "^0.3.28", "jsesc": "^3.0.2" } }, "sha512-3EwLFhZ38J4VyIP6WNtt2kUdW9dokXA9Cr4IVIFHuCpZ3H8/YFOl5JjZHisrn1fATPBmKKqXzDFvh9fUwHz6CQ=="],

    "@babel/helper-annotate-as-pure": ["@babel/helper-annotate-as-pure@7.27.3", "", { "dependencies": { "@babel/types": "^7.27.3" } }, "sha512-fXSwMQqitTGeHLBC08Eq5yXz2m37E4pJX1qAU1+2cNedz/ifv/bVXft90VeSav5nFO61EcNgwr0aJxbyPaWBPg=="],

    "@babel/helper-compilation-targets": ["@babel/helper-compilation-targets@7.27.2", "", { "dependencies": { "@babel/compat-data": "^7.27.2", "@babel/helper-validator-option": "^7.27.1", "browserslist": "^4.24.0", "lru-cache": "^5.1.1", "semver": "^6.3.1" } }, "sha512-2+1thGUUWWjLTYTHZWK1n8Yga0ijBz1XAhUXcKy81rd5g6yh7hGqMp45v7cadSbEHc9G3OTv45SyneRN3ps4DQ=="],

    "@babel/helper-create-class-features-plugin": ["@babel/helper-create-class-features-plugin@7.28.5", "", { "dependencies": { "@babel/helper-annotate-as-pure": "^7.27.3", "@babel/helper-member-expression-to-functions": "^7.28.5", "@babel/helper-optimise-call-expression": "^7.27.1", "@babel/helper-replace-supers": "^7.27.1", "@babel/helper-skip-transparent-expression-wrappers": "^7.27.1", "@babel/traverse": "^7.28.5", "semver": "^6.3.1" }, "peerDependencies": { "@babel/core": "^7.0.0" } }, "sha512-q3WC4JfdODypvxArsJQROfupPBq9+lMwjKq7C33GhbFYJsufD0yd/ziwD+hJucLeWsnFPWZjsU2DNFqBPE7jwQ=="],

    "@babel/helper-globals": ["@babel/helper-globals@7.28.0", "", {}, "sha512-+W6cISkXFa1jXsDEdYA8HeevQT/FULhxzR99pxphltZcVaugps53THCeiWA8SguxxpSp3gKPiuYfSWopkLQ4hw=="],

    "@babel/helper-member-expression-to-functions": ["@babel/helper-member-expression-to-functions@7.28.5", "", { "dependencies": { "@babel/traverse": "^7.28.5", "@babel/types": "^7.28.5" } }, "sha512-cwM7SBRZcPCLgl8a7cY0soT1SptSzAlMH39vwiRpOQkJlh53r5hdHwLSCZpQdVLT39sZt+CRpNwYG4Y2v77atg=="],

    "@babel/helper-module-imports": ["@babel/helper-module-imports@7.27.1", "", { "dependencies": { "@babel/traverse": "^7.27.1", "@babel/types": "^7.27.1" } }, "sha512-0gSFWUPNXNopqtIPQvlD5WgXYI5GY2kP2cCvoT8kczjbfcfuIljTbcWrulD1CIPIX2gt1wghbDy08yE1p+/r3w=="],

    "@babel/helper-module-transforms": ["@babel/helper-module-transforms@7.28.3", "", { "dependencies": { "@babel/helper-module-imports": "^7.27.1", "@babel/helper-validator-identifier": "^7.27.1", "@babel/traverse": "^7.28.3" }, "peerDependencies": { "@babel/core": "^7.0.0" } }, "sha512-gytXUbs8k2sXS9PnQptz5o0QnpLL51SwASIORY6XaBKF88nsOT0Zw9szLqlSGQDP/4TljBAD5y98p2U1fqkdsw=="],

    "@babel/helper-optimise-call-expression": ["@babel/helper-optimise-call-expression@7.27.1", "", { "dependencies": { "@babel/types": "^7.27.1" } }, "sha512-URMGH08NzYFhubNSGJrpUEphGKQwMQYBySzat5cAByY1/YgIRkULnIy3tAMeszlL/so2HbeilYloUmSpd7GdVw=="],

    "@babel/helper-plugin-utils": ["@babel/helper-plugin-utils@7.27.1", "", {}, "sha512-1gn1Up5YXka3YYAHGKpbideQ5Yjf1tDa9qYcgysz+cNCXukyLl6DjPXhD3VRwSb8c0J9tA4b2+rHEZtc6R0tlw=="],

    "@babel/helper-replace-supers": ["@babel/helper-replace-supers@7.27.1", "", { "dependencies": { "@babel/helper-member-expression-to-functions": "^7.27.1", "@babel/helper-optimise-call-expression": "^7.27.1", "@babel/traverse": "^7.27.1" }, "peerDependencies": { "@babel/core": "^7.0.0" } }, "sha512-7EHz6qDZc8RYS5ElPoShMheWvEgERonFCs7IAonWLLUTXW59DP14bCZt89/GKyreYn8g3S83m21FelHKbeDCKA=="],

    "@babel/helper-skip-transparent-expression-wrappers": ["@babel/helper-skip-transparent-expression-wrappers@7.27.1", "", { "dependencies": { "@babel/traverse": "^7.27.1", "@babel/types": "^7.27.1" } }, "sha512-Tub4ZKEXqbPjXgWLl2+3JpQAYBJ8+ikpQ2Ocj/q/r0LwE3UhENh7EUabyHjz2kCEsrRY83ew2DQdHluuiDQFzg=="],

    "@babel/helper-string-parser": ["@babel/helper-string-parser@7.27.1", "", {}, "sha512-qMlSxKbpRlAridDExk92nSobyDdpPijUq2DW6oDnUqd0iOGxmQjyqhMIihI9+zv4LPyZdRje2cavWPbCbWm3eA=="],

    "@babel/helper-validator-identifier": ["@babel/helper-validator-identifier@7.28.5", "", {}, "sha512-qSs4ifwzKJSV39ucNjsvc6WVHs6b7S03sOh2OcHF9UHfVPqWWALUsNUVzhSBiItjRZoLHx7nIarVjqKVusUZ1Q=="],

    "@babel/helper-validator-option": ["@babel/helper-validator-option@7.27.1", "", {}, "sha512-YvjJow9FxbhFFKDSuFnVCe2WxXk1zWc22fFePVNEaWJEu8IrZVlda6N0uHwzZrUM1il7NC9Mlp4MaJYbYd9JSg=="],

    "@babel/helpers": ["@babel/helpers@7.28.4", "", { "dependencies": { "@babel/template": "^7.27.2", "@babel/types": "^7.28.4" } }, "sha512-HFN59MmQXGHVyYadKLVumYsA9dBFun/ldYxipEjzA4196jpLZd8UjEEBLkbEkvfYreDqJhZxYAWFPtrfhNpj4w=="],

    "@babel/parser": ["@babel/parser@7.28.5", "", { "dependencies": { "@babel/types": "^7.28.5" }, "bin": { "parser": "bin/babel-parser.js" } }, "sha512-KKBU1VGYR7ORr3At5HAtUQ+TV3SzRCXmA/8OdDZiLDBIZxVyzXuztPjfLd3BV1PRAQGCMWWSHYhL0F8d5uHBDQ=="],

    "@babel/plugin-syntax-jsx": ["@babel/plugin-syntax-jsx@7.27.1", "", { "dependencies": { "@babel/helper-plugin-utils": "^7.27.1" }, "peerDependencies": { "@babel/core": "^7.0.0-0" } }, "sha512-y8YTNIeKoyhGd9O0Jiyzyyqk8gdjnumGTQPsz0xOZOQ2RmkVJeZ1vmmfIvFEKqucBG6axJGBZDE/7iI5suUI/w=="],

    "@babel/plugin-syntax-typescript": ["@babel/plugin-syntax-typescript@7.27.1", "", { "dependencies": { "@babel/helper-plugin-utils": "^7.27.1" }, "peerDependencies": { "@babel/core": "^7.0.0-0" } }, "sha512-xfYCBMxveHrRMnAWl1ZlPXOZjzkN82THFvLhQhFXFt81Z5HnN+EtUkZhv/zcKpmT3fzmWZB0ywiBrbC3vogbwQ=="],

    "@babel/plugin-transform-modules-commonjs": ["@babel/plugin-transform-modules-commonjs@7.27.1", "", { "dependencies": { "@babel/helper-module-transforms": "^7.27.1", "@babel/helper-plugin-utils": "^7.27.1" }, "peerDependencies": { "@babel/core": "^7.0.0-0" } }, "sha512-OJguuwlTYlN0gBZFRPqwOGNWssZjfIUdS7HMYtN8c1KmwpwHFBwTeFZrg9XZa+DFTitWOW5iTAG7tyCUPsCCyw=="],

    "@babel/plugin-transform-react-jsx-self": ["@babel/plugin-transform-react-jsx-self@7.27.1", "", { "dependencies": { "@babel/helper-plugin-utils": "^7.27.1" }, "peerDependencies": { "@babel/core": "^7.0.0-0" } }, "sha512-6UzkCs+ejGdZ5mFFC/OCUrv028ab2fp1znZmCZjAOBKiBK2jXD1O+BPSfX8X2qjJ75fZBMSnQn3Rq2mrBJK2mw=="],

    "@babel/plugin-transform-react-jsx-source": ["@babel/plugin-transform-react-jsx-source@7.27.1", "", { "dependencies": { "@babel/helper-plugin-utils": "^7.27.1" }, "peerDependencies": { "@babel/core": "^7.0.0-0" } }, "sha512-zbwoTsBruTeKB9hSq73ha66iFeJHuaFkUbwvqElnygoNbj/jHRsSeokowZFN3CZ64IvEqcmmkVe89OPXc7ldAw=="],

    "@babel/plugin-transform-typescript": ["@babel/plugin-transform-typescript@7.28.5", "", { "dependencies": { "@babel/helper-annotate-as-pure": "^7.27.3", "@babel/helper-create-class-features-plugin": "^7.28.5", "@babel/helper-plugin-utils": "^7.27.1", "@babel/helper-skip-transparent-expression-wrappers": "^7.27.1", "@babel/plugin-syntax-typescript": "^7.27.1" }, "peerDependencies": { "@babel/core": "^7.0.0-0" } }, "sha512-x2Qa+v/CuEoX7Dr31iAfr0IhInrVOWZU/2vJMJ00FOR/2nM0BcBEclpaf9sWCDc+v5e9dMrhSH8/atq/kX7+bA=="],

    "@babel/preset-typescript": ["@babel/preset-typescript@7.28.5", "", { "dependencies": { "@babel/helper-plugin-utils": "^7.27.1", "@babel/helper-validator-option": "^7.27.1", "@babel/plugin-syntax-jsx": "^7.27.1", "@babel/plugin-transform-modules-commonjs": "^7.27.1", "@babel/plugin-transform-typescript": "^7.28.5" }, "peerDependencies": { "@babel/core": "^7.0.0-0" } }, "sha512-+bQy5WOI2V6LJZpPVxY+yp66XdZ2yifu0Mc1aP5CQKgjn4QM5IN2i5fAZ4xKop47pr8rpVhiAeu+nDQa12C8+g=="],

    "@babel/runtime": ["@babel/runtime@7.28.6", "", {}, "sha512-05WQkdpL9COIMz4LjTxGpPNCdlpyimKppYNoJ5Di5EUObifl8t4tuLuUBBZEpoLYOmfvIWrsp9fCl0HoPRVTdA=="],

    "@babel/template": ["@babel/template@7.27.2", "", { "dependencies": { "@babel/code-frame": "^7.27.1", "@babel/parser": "^7.27.2", "@babel/types": "^7.27.1" } }, "sha512-LPDZ85aEJyYSd18/DkjNh4/y1ntkE5KwUHWTiqgRxruuZL2F1yuHligVHLvcHY2vMHXttKFpJn6LwfI7cw7ODw=="],

    "@babel/traverse": ["@babel/traverse@7.28.5", "", { "dependencies": { "@babel/code-frame": "^7.27.1", "@babel/generator": "^7.28.5", "@babel/helper-globals": "^7.28.0", "@babel/parser": "^7.28.5", "@babel/template": "^7.27.2", "@babel/types": "^7.28.5", "debug": "^4.3.1" } }, "sha512-TCCj4t55U90khlYkVV/0TfkJkAkUg3jZFA3Neb7unZT8CPok7iiRfaX0F+WnqWqt7OxhOn0uBKXCw4lbL8W0aQ=="],

    "@babel/types": ["@babel/types@7.28.5", "", { "dependencies": { "@babel/helper-string-parser": "^7.27.1", "@babel/helper-validator-identifier": "^7.28.5" } }, "sha512-qQ5m48eI/MFLQ5PxQj4PFaprjyCTLI37ElWMmNs0K8Lk3dVeOdNpB3ks8jc7yM5CDmVC73eMVk/trk3fgmrUpA=="],

    "@base-ui/react": ["@base-ui/react@1.2.0", "", { "dependencies": { "@babel/runtime": "^7.28.6", "@base-ui/utils": "0.2.5", "@floating-ui/react-dom": "^2.1.6", "@floating-ui/utils": "^0.2.10", "tabbable": "^6.4.0", "use-sync-external-store": "^1.6.0" }, "peerDependencies": { "@types/react": "^17 || ^18 || ^19", "react": "^17 || ^18 || ^19", "react-dom": "^17 || ^18 || ^19" }, "optionalPeers": ["@types/react"] }, "sha512-O6aEQHcm+QyGTFY28xuwRD3SEJGZOBDpyjN2WvpfWYFVhg+3zfXPysAILqtM0C1kWC82MccOE/v1j+GHXE4qIw=="],

    "@base-ui/utils": ["@base-ui/utils@0.2.5", "", { "dependencies": { "@babel/runtime": "^7.28.6", "@floating-ui/utils": "^0.2.10", "reselect": "^5.1.1", "use-sync-external-store": "^1.6.0" }, "peerDependencies": { "@types/react": "^17 || ^18 || ^19", "react": "^17 || ^18 || ^19", "react-dom": "^17 || ^18 || ^19" }, "optionalPeers": ["@types/react"] }, "sha512-oYC7w0gp76RI5MxprlGLV0wze0SErZaRl3AAkeP3OnNB/UBMb6RqNf6ZSIlxOc9Qp68Ab3C2VOcJQyRs7Xc7Vw=="],

    "@date-fns/tz": ["@date-fns/tz@1.4.1", "", {}, "sha512-P5LUNhtbj6YfI3iJjw5EL9eUAG6OitD0W3fWQcpQjDRc/QIsL0tRNuO1PcDvPccWL1fSTXXdE1ds+l95DV/OFA=="],

    "@dotenvx/dotenvx": ["@dotenvx/dotenvx@1.51.1", "", { "dependencies": { "commander": "^11.1.0", "dotenv": "^17.2.1", "eciesjs": "^0.4.10", "execa": "^5.1.1", "fdir": "^6.2.0", "ignore": "^5.3.0", "object-treeify": "1.1.33", "picomatch": "^4.0.2", "which": "^4.0.0" }, "bin": { "dotenvx": "src/cli/dotenvx.js" } }, "sha512-fqcQxcxC4LOaUlW8IkyWw8x0yirlLUkbxohz9OnWvVWjf73J5yyw7jxWnkOJaUKXZotcGEScDox9MU6rSkcDgg=="],

    "@ecies/ciphers": ["@ecies/ciphers@0.2.5", "", { "peerDependencies": { "@noble/ciphers": "^1.0.0" } }, "sha512-GalEZH4JgOMHYYcYmVqnFirFsjZHeoGMDt9IxEnM9F7GRUUyUksJ7Ou53L83WHJq3RWKD3AcBpo0iQh0oMpf8A=="],

    "@emnapi/core": ["@emnapi/core@1.7.0", "", { "dependencies": { "@emnapi/wasi-threads": "1.1.0", "tslib": "^2.4.0" } }, "sha512-pJdKGq/1iquWYtv1RRSljZklxHCOCAJFJrImO5ZLKPJVJlVUcs8yFwNQlqS0Lo8xT1VAXXTCZocF9n26FWEKsw=="],

    "@emnapi/runtime": ["@emnapi/runtime@1.7.0", "", { "dependencies": { "tslib": "^2.4.0" } }, "sha512-oAYoQnCYaQZKVS53Fq23ceWMRxq5EhQsE0x0RdQ55jT7wagMu5k+fS39v1fiSLrtrLQlXwVINenqhLMtTrV/1Q=="],

    "@emnapi/wasi-threads": ["@emnapi/wasi-threads@1.1.0", "", { "dependencies": { "tslib": "^2.4.0" } }, "sha512-WI0DdZ8xFSbgMjR1sFsKABJ/C5OnRrjT06JXbZKexJGrDuPTzZdDYfFlsgcCXCyf+suG5QU2e/y1Wo2V/OapLQ=="],

    "@eslint-community/eslint-utils": ["@eslint-community/eslint-utils@4.9.0", "", { "dependencies": { "eslint-visitor-keys": "^3.4.3" }, "peerDependencies": { "eslint": "^6.0.0 || ^7.0.0 || >=8.0.0" } }, "sha512-ayVFHdtZ+hsq1t2Dy24wCmGXGe4q9Gu3smhLYALJrr473ZH27MsnSL+LKUlimp4BWJqMDMLmPpx/Q9R3OAlL4g=="],

    "@eslint-community/regexpp": ["@eslint-community/regexpp@4.12.2", "", {}, "sha512-EriSTlt5OC9/7SXkRSCAhfSxxoSUgBm33OH+IkwbdpgoqsSsUg7y3uh+IICI/Qg4BBWr3U2i39RpmycbxMq4ew=="],

    "@eslint/config-array": ["@eslint/config-array@0.21.1", "", { "dependencies": { "@eslint/object-schema": "^2.1.7", "debug": "^4.3.1", "minimatch": "^3.1.2" } }, "sha512-aw1gNayWpdI/jSYVgzN5pL0cfzU02GT3NBpeT/DXbx1/1x7ZKxFPd9bwrzygx/qiwIQiJ1sw/zD8qY/kRvlGHA=="],

    "@eslint/config-helpers": ["@eslint/config-helpers@0.4.2", "", { "dependencies": { "@eslint/core": "^0.17.0" } }, "sha512-gBrxN88gOIf3R7ja5K9slwNayVcZgK6SOUORm2uBzTeIEfeVaIhOpCtTox3P6R7o2jLFwLFTLnC7kU/RGcYEgw=="],

    "@eslint/core": ["@eslint/core@0.17.0", "", { "dependencies": { "@types/json-schema": "^7.0.15" } }, "sha512-yL/sLrpmtDaFEiUj1osRP4TI2MDz1AddJL+jZ7KSqvBuliN4xqYY54IfdN8qD8Toa6g1iloph1fxQNkjOxrrpQ=="],

    "@eslint/eslintrc": ["@eslint/eslintrc@3.3.1", "", { "dependencies": { "ajv": "^6.12.4", "debug": "^4.3.2", "espree": "^10.0.1", "globals": "^14.0.0", "ignore": "^5.2.0", "import-fresh": "^3.2.1", "js-yaml": "^4.1.0", "minimatch": "^3.1.2", "strip-json-comments": "^3.1.1" } }, "sha512-gtF186CXhIl1p4pJNGZw8Yc6RlshoePRvE0X91oPGb3vZ8pM3qOS9W9NGPat9LziaBV7XrJWGylNQXkGcnM3IQ=="],

    "@eslint/js": ["@eslint/js@9.39.1", "", {}, "sha512-S26Stp4zCy88tH94QbBv3XCuzRQiZ9yXofEILmglYTh/Ug/a9/umqvgFtYBAo3Lp0nsI/5/qH1CCrbdK3AP1Tw=="],

    "@eslint/object-schema": ["@eslint/object-schema@2.1.7", "", {}, "sha512-VtAOaymWVfZcmZbp6E2mympDIHvyjXs/12LqWYjVw6qjrfF+VK+fyG33kChz3nnK+SU5/NeHOqrTEHS8sXO3OA=="],

    "@eslint/plugin-kit": ["@eslint/plugin-kit@0.4.1", "", { "dependencies": { "@eslint/core": "^0.17.0", "levn": "^0.4.1" } }, "sha512-43/qtrDUokr7LJqoF2c3+RInu/t4zfrpYdoSDfYyhg52rwLV6TnOvdG4fXm7IkSB3wErkcmJS9iEhjVtOSEjjA=="],

    "@floating-ui/core": ["@floating-ui/core@1.7.3", "", { "dependencies": { "@floating-ui/utils": "^0.2.10" } }, "sha512-sGnvb5dmrJaKEZ+LDIpguvdX3bDlEllmv4/ClQ9awcmCZrlx5jQyyMWFM5kBI+EyNOCDDiKk8il0zeuX3Zlg/w=="],

    "@floating-ui/dom": ["@floating-ui/dom@1.7.4", "", { "dependencies": { "@floating-ui/core": "^1.7.3", "@floating-ui/utils": "^0.2.10" } }, "sha512-OOchDgh4F2CchOX94cRVqhvy7b3AFb+/rQXyswmzmGakRfkMgoWVjfnLWkRirfLEfuD4ysVW16eXzwt3jHIzKA=="],

    "@floating-ui/react-dom": ["@floating-ui/react-dom@2.1.6", "", { "dependencies": { "@floating-ui/dom": "^1.7.4" }, "peerDependencies": { "react": ">=16.8.0", "react-dom": ">=16.8.0" } }, "sha512-4JX6rEatQEvlmgU80wZyq9RT96HZJa88q8hp0pBd+LrczeDI4o6uA2M+uvxngVHo4Ihr8uibXxH6+70zhAFrVw=="],

    "@floating-ui/utils": ["@floating-ui/utils@0.2.10", "", {}, "sha512-aGTxbpbg8/b5JfU1HXSrbH3wXZuLPJcNEcZQFMxLs3oSzgtVu6nFPkbbGGUvBcUjKV2YyB9Wxxabo+HEH9tcRQ=="],

    "@frida/react-use-r2": ["@frida/react-use-r2@2.0.0", "", { "peerDependencies": { "react": "^18.3.1" } }, "sha512-OhgFRigM4mk1sf5upPdsf9ow9e4sapzDDruXXuIa1scyYp6f4DqEpOUhWnLEMXNgZKdGeBYqvRlxcDija15VuA=="],

    "@humanfs/core": ["@humanfs/core@0.19.1", "", {}, "sha512-5DyQ4+1JEUzejeK1JGICcideyfUbGixgS9jNgex5nqkW+cY7WZhxBigmieN5Qnw9ZosSNVC9KQKyb+GUaGyKUA=="],

    "@humanfs/node": ["@humanfs/node@0.16.7", "", { "dependencies": { "@humanfs/core": "^0.19.1", "@humanwhocodes/retry": "^0.4.0" } }, "sha512-/zUx+yOsIrG4Y43Eh2peDeKCxlRt/gET6aHfaKpuq267qXdYDFViVHfMaLyygZOnl0kGWxFIgsBy8QFuTLUXEQ=="],

    "@humanwhocodes/module-importer": ["@humanwhocodes/module-importer@1.0.1", "", {}, "sha512-bxveV4V8v5Yb4ncFTT3rPSgZBOpCkjfK0y4oVVVJwIuDVBRMDXrPyXRL988i5ap9m9bnyEEjWfm5WkBmtffLfA=="],

    "@humanwhocodes/retry": ["@humanwhocodes/retry@0.4.3", "", {}, "sha512-bV0Tgo9K4hfPCek+aMAn81RppFKv2ySDQeMoSZuvTASywNTnVJCArCZE2FWqpvIatKu7VMRLWlR1EazvVhDyhQ=="],

    "@inquirer/ansi": ["@inquirer/ansi@1.0.2", "", {}, "sha512-S8qNSZiYzFd0wAcyG5AXCvUHC5Sr7xpZ9wZ2py9XR88jUz8wooStVx5M6dRzczbBWjic9NP7+rY0Xi7qqK/aMQ=="],

    "@inquirer/confirm": ["@inquirer/confirm@5.1.20", "", { "dependencies": { "@inquirer/core": "^10.3.1", "@inquirer/type": "^3.0.10" }, "peerDependencies": { "@types/node": ">=18" } }, "sha512-HDGiWh2tyRZa0M1ZnEIUCQro25gW/mN8ODByicQrbR1yHx4hT+IOpozCMi5TgBtUdklLwRI2mv14eNpftDluEw=="],

    "@inquirer/core": ["@inquirer/core@10.3.1", "", { "dependencies": { "@inquirer/ansi": "^1.0.2", "@inquirer/figures": "^1.0.15", "@inquirer/type": "^3.0.10", "cli-width": "^4.1.0", "mute-stream": "^3.0.0", "signal-exit": "^4.1.0", "wrap-ansi": "^6.2.0", "yoctocolors-cjs": "^2.1.3" }, "peerDependencies": { "@types/node": ">=18" } }, "sha512-hzGKIkfomGFPgxKmnKEKeA+uCYBqC+TKtRx5LgyHRCrF6S2MliwRIjp3sUaWwVzMp7ZXVs8elB0Tfe682Rpg4w=="],

    "@inquirer/figures": ["@inquirer/figures@1.0.15", "", {}, "sha512-t2IEY+unGHOzAaVM5Xx6DEWKeXlDDcNPeDyUpsRc6CUhBfU3VQOEl+Vssh7VNp1dR8MdUJBWhuObjXCsVpjN5g=="],

    "@inquirer/type": ["@inquirer/type@3.0.10", "", { "peerDependencies": { "@types/node": ">=18" } }, "sha512-BvziSRxfz5Ov8ch0z/n3oijRSEcEsHnhggm4xFZe93DHcUCTlutlq9Ox4SVENAfcRD22UQq7T/atg9Wr3k09eA=="],

    "@isaacs/balanced-match": ["@isaacs/balanced-match@4.0.1", "", {}, "sha512-yzMTt9lEb8Gv7zRioUilSglI0c0smZ9k5D65677DLWLtWJaXIS3CqcGyUFByYKlnUj6TkjLVs54fBl6+TiGQDQ=="],

    "@isaacs/brace-expansion": ["@isaacs/brace-expansion@5.0.0", "", { "dependencies": { "@isaacs/balanced-match": "^4.0.1" } }, "sha512-ZT55BDLV0yv0RBm2czMiZ+SqCGO7AvmOM3G/w2xhVPH+te0aKgFjmBvGlL1dH+ql2tgGO3MVrbb3jCKyvpgnxA=="],

    "@jridgewell/gen-mapping": ["@jridgewell/gen-mapping@0.3.13", "", { "dependencies": { "@jridgewell/sourcemap-codec": "^1.5.0", "@jridgewell/trace-mapping": "^0.3.24" } }, "sha512-2kkt/7niJ6MgEPxF0bYdQ6etZaA+fQvDcLKckhy1yIQOzaoKjBBjSj63/aLVjYE3qhRt5dvM+uUyfCg6UKCBbA=="],

    "@jridgewell/remapping": ["@jridgewell/remapping@2.3.5", "", { "dependencies": { "@jridgewell/gen-mapping": "^0.3.5", "@jridgewell/trace-mapping": "^0.3.24" } }, "sha512-LI9u/+laYG4Ds1TDKSJW2YPrIlcVYOwi2fUC6xB43lueCjgxV4lffOCZCtYFiH6TNOX+tQKXx97T4IKHbhyHEQ=="],

    "@jridgewell/resolve-uri": ["@jridgewell/resolve-uri@3.1.2", "", {}, "sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw=="],

    "@jridgewell/sourcemap-codec": ["@jridgewell/sourcemap-codec@1.5.5", "", {}, "sha512-cYQ9310grqxueWbl+WuIUIaiUaDcj7WOq5fVhEljNVgRfOUhY9fy2zTvfoqWsnebh8Sl70VScFbICvJnLKB0Og=="],

    "@jridgewell/trace-mapping": ["@jridgewell/trace-mapping@0.3.31", "", { "dependencies": { "@jridgewell/resolve-uri": "^3.1.0", "@jridgewell/sourcemap-codec": "^1.4.14" } }, "sha512-zzNR+SdQSDJzc8joaeP8QQoCQr8NuYx2dIIytl1QeBEZHJ9uW6hebsrYgbz8hJwUQao3TWCMtmfV8Nu1twOLAw=="],

    "@mapbox/node-pre-gyp": ["@mapbox/node-pre-gyp@1.0.9", "", { "dependencies": { "detect-libc": "^2.0.0", "https-proxy-agent": "^5.0.0", "make-dir": "^3.1.0", "node-fetch": "^2.6.7", "nopt": "^5.0.0", "npmlog": "^5.0.1", "rimraf": "^3.0.2", "semver": "^7.3.5", "tar": "^6.1.11" }, "bin": { "node-pre-gyp": "bin/node-pre-gyp" } }, "sha512-aDF3S3rK9Q2gey/WAttUlISduDItz5BU3306M9Eyv6/oS40aMprnopshtlKTykxRNIBEZuRMaZAnbrQ4QtKGyw=="],

    "@modelcontextprotocol/sdk": ["@modelcontextprotocol/sdk@1.21.1", "", { "dependencies": { "ajv": "^8.17.1", "ajv-formats": "^3.0.1", "content-type": "^1.0.5", "cors": "^2.8.5", "cross-spawn": "^7.0.5", "eventsource": "^3.0.2", "eventsource-parser": "^3.0.0", "express": "^5.0.1", "express-rate-limit": "^7.5.0", "pkce-challenge": "^5.0.0", "raw-body": "^3.0.0", "zod": "^3.23.8", "zod-to-json-schema": "^3.24.1" }, "peerDependencies": { "@cfworker/json-schema": "^4.1.1" }, "optionalPeers": ["@cfworker/json-schema"] }, "sha512-UyLFcJLDvUuZbGnaQqXFT32CpPpGj7VS19roLut6gkQVhb439xUzYWbsUvdI3ZPL+2hnFosuugtYWE0Mcs1rmQ=="],

    "@monaco-editor/loader": ["@monaco-editor/loader@1.7.0", "", { "dependencies": { "state-local": "^1.0.6" } }, "sha512-gIwR1HrJrrx+vfyOhYmCZ0/JcWqG5kbfG7+d3f/C1LXk2EvzAbHSg3MQ5lO2sMlo9izoAZ04shohfKLVT6crVA=="],

    "@monaco-editor/react": ["@monaco-editor/react@4.7.0", "", { "dependencies": { "@monaco-editor/loader": "^1.5.0" }, "peerDependencies": { "monaco-editor": ">= 0.25.0 < 1", "react": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0", "react-dom": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0" } }, "sha512-cyzXQCtO47ydzxpQtCGSQGOC8Gk3ZUeBXFAxD+CWXYFo5OqZyZUonFl0DwUlTyAfRHntBfw2p3w4s9R6oe1eCA=="],

    "@mswjs/interceptors": ["@mswjs/interceptors@0.40.0", "", { "dependencies": { "@open-draft/deferred-promise": "^2.2.0", "@open-draft/logger": "^0.3.0", "@open-draft/until": "^2.0.0", "is-node-process": "^1.2.0", "outvariant": "^1.4.3", "strict-event-emitter": "^0.5.1" } }, "sha512-EFd6cVbHsgLa6wa4RljGj6Wk75qoHxUSyc5asLyyPSyuhIcdS2Q3Phw6ImS1q+CkALthJRShiYfKANcQMuMqsQ=="],

    "@napi-rs/wasm-runtime": ["@napi-rs/wasm-runtime@1.0.7", "", { "dependencies": { "@emnapi/core": "^1.5.0", "@emnapi/runtime": "^1.5.0", "@tybys/wasm-util": "^0.10.1" } }, "sha512-SeDnOO0Tk7Okiq6DbXmmBODgOAb9dp9gjlphokTUxmt8U3liIP1ZsozBahH69j/RJv+Rfs6IwUKHTgQYJ/HBAw=="],

    "@noble/ciphers": ["@noble/ciphers@1.3.0", "", {}, "sha512-2I0gnIVPtfnMw9ee9h1dJG7tp81+8Ob3OJb3Mv37rx5L40/b0i7djjCVvGOVqc9AEIQyvyu1i6ypKdFw8R8gQw=="],

    "@noble/curves": ["@noble/curves@1.9.7", "", { "dependencies": { "@noble/hashes": "1.8.0" } }, "sha512-gbKGcRUYIjA3/zCCNaWDciTMFI0dCkvou3TL8Zmy5Nc7sJ47a0jtOeZoTaMxkuqRo9cRhjOdZJXegxYE5FN/xw=="],

    "@noble/hashes": ["@noble/hashes@1.8.0", "", {}, "sha512-jCs9ldd7NwzpgXDIf6P3+NrHh9/sD6CQdxHyjQI+h/6rDNo88ypBxxz45UDuZHz9r3tNz7N/VInSVoVdtXEI4A=="],

    "@nodelib/fs.scandir": ["@nodelib/fs.scandir@2.1.5", "", { "dependencies": { "@nodelib/fs.stat": "2.0.5", "run-parallel": "^1.1.9" } }, "sha512-vq24Bq3ym5HEQm2NKCr3yXDwjc7vTsEThRDnkp2DK9p1uqLR+DHurm/NOTo0KG7HYHU7eppKZj3MyqYuMBf62g=="],

    "@nodelib/fs.stat": ["@nodelib/fs.stat@2.0.5", "", {}, "sha512-RkhPPp2zrqDAQA/2jNhnztcPAlv64XdhIp7a7454A5ovI7Bukxgt7MX7udwAu3zg1DcpPU0rz3VV1SeaqvY4+A=="],

    "@nodelib/fs.walk": ["@nodelib/fs.walk@1.2.8", "", { "dependencies": { "@nodelib/fs.scandir": "2.1.5", "fastq": "^1.6.0" } }, "sha512-oGB+UxlgWcgQkgwo8GcEGwemoTFt3FIO9ababBmaGwXIoBKZ+GTy0pP185beGg7Llih/NSHSV2XAs1lnznocSg=="],

    "@open-draft/deferred-promise": ["@open-draft/deferred-promise@2.2.0", "", {}, "sha512-CecwLWx3rhxVQF6V4bAgPS5t+So2sTbPgAzafKkVizyi7tlwpcFpdFqq+wqF2OwNBmqFuu6tOyouTuxgpMfzmA=="],

    "@open-draft/logger": ["@open-draft/logger@0.3.0", "", { "dependencies": { "is-node-process": "^1.2.0", "outvariant": "^1.4.0" } }, "sha512-X2g45fzhxH238HKO4xbSr7+wBS8Fvw6ixhTDuvLd5mqh6bJJCFAPwU9mPDxbcrRtfxv4u5IHCEH77BmxvXmmxQ=="],

    "@open-draft/until": ["@open-draft/until@2.1.0", "", {}, "sha512-U69T3ItWHvLwGg5eJ0n3I62nWuE6ilHlmz7zM0npLBRvPRd7e6NYmg54vvRtP5mZG7kZqZCFVdsTWo7BPtBujg=="],

    "@oxc-project/runtime": ["@oxc-project/runtime@0.92.0", "", {}, "sha512-Z7x2dZOmznihvdvCvLKMl+nswtOSVxS2H2ocar+U9xx6iMfTp0VGIrX6a4xB1v80IwOPC7dT1LXIJrY70Xu3Jw=="],

    "@oxc-project/types": ["@oxc-project/types@0.93.0", "", {}, "sha512-yNtwmWZIBtJsMr5TEfoZFDxIWV6OdScOpza/f5YxbqUMJk+j6QX3Cf3jgZShGEFYWQJ5j9mJ6jM0tZHu2J9Yrg=="],

    "@radix-ui/primitive": ["@radix-ui/primitive@1.1.3", "", {}, "sha512-JTF99U/6XIjCBo0wqkU5sK10glYe27MRRsfwoiq5zzOEZLHU3A3KCMa5X/azekYRCJ0HlwI0crAXS/5dEHTzDg=="],

    "@radix-ui/react-compose-refs": ["@radix-ui/react-compose-refs@1.1.2", "", { "peerDependencies": { "@types/react": "*", "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc" } }, "sha512-z4eqJvfiNnFMHIIvXP3CY57y2WJs5g2v3X0zm9mEJkrkNv4rDxu+sg9Jh8EkXyeqBkB7SOcboo9dMVqhyrACIg=="],

    "@radix-ui/react-context": ["@radix-ui/react-context@1.1.2", "", { "peerDependencies": { "@types/react": "*", "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc" } }, "sha512-jCi/QKUM2r1Ju5a3J64TH2A5SpKAgh0LpknyqdQ4m6DCV0xJ2HG1xARRwNGPQfi1SLdLWZ1OJz6F4OMBBNiGJA=="],

    "@radix-ui/react-dialog": ["@radix-ui/react-dialog@1.1.15", "", { "dependencies": { "@radix-ui/primitive": "1.1.3", "@radix-ui/react-compose-refs": "1.1.2", "@radix-ui/react-context": "1.1.2", "@radix-ui/react-dismissable-layer": "1.1.11", "@radix-ui/react-focus-guards": "1.1.3", "@radix-ui/react-focus-scope": "1.1.7", "@radix-ui/react-id": "1.1.1", "@radix-ui/react-portal": "1.1.9", "@radix-ui/react-presence": "1.1.5", "@radix-ui/react-primitive": "2.1.3", "@radix-ui/react-slot": "1.2.3", "@radix-ui/react-use-controllable-state": "1.2.2", "aria-hidden": "^1.2.4", "react-remove-scroll": "^2.6.3" }, "peerDependencies": { "@types/react": "*", "@types/react-dom": "*", "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc", "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc" } }, "sha512-TCglVRtzlffRNxRMEyR36DGBLJpeusFcgMVD9PZEzAKnUs1lKCgX5u9BmC2Yg+LL9MgZDugFFs1Vl+Jp4t/PGw=="],

    "@radix-ui/react-dismissable-layer": ["@radix-ui/react-dismissable-layer@1.1.11", "", { "dependencies": { "@radix-ui/primitive": "1.1.3", "@radix-ui/react-compose-refs": "1.1.2", "@radix-ui/react-primitive": "2.1.3", "@radix-ui/react-use-callback-ref": "1.1.1", "@radix-ui/react-use-escape-keydown": "1.1.1" }, "peerDependencies": { "@types/react": "*", "@types/react-dom": "*", "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc", "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc" } }, "sha512-Nqcp+t5cTB8BinFkZgXiMJniQH0PsUt2k51FUhbdfeKvc4ACcG2uQniY/8+h1Yv6Kza4Q7lD7PQV0z0oicE0Mg=="],

    "@radix-ui/react-focus-guards": ["@radix-ui/react-focus-guards@1.1.3", "", { "peerDependencies": { "@types/react": "*", "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc" } }, "sha512-0rFg/Rj2Q62NCm62jZw0QX7a3sz6QCQU0LpZdNrJX8byRGaGVTqbrW9jAoIAHyMQqsNpeZ81YgSizOt5WXq0Pw=="],

    "@radix-ui/react-focus-scope": ["@radix-ui/react-focus-scope@1.1.7", "", { "dependencies": { "@radix-ui/react-compose-refs": "1.1.2", "@radix-ui/react-primitive": "2.1.3", "@radix-ui/react-use-callback-ref": "1.1.1" }, "peerDependencies": { "@types/react": "*", "@types/react-dom": "*", "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc", "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc" } }, "sha512-t2ODlkXBQyn7jkl6TNaw/MtVEVvIGelJDCG41Okq/KwUsJBwQ4XVZsHAVUkK4mBv3ewiAS3PGuUWuY2BoK4ZUw=="],

    "@radix-ui/react-id": ["@radix-ui/react-id@1.1.1", "", { "dependencies": { "@radix-ui/react-use-layout-effect": "1.1.1" }, "peerDependencies": { "@types/react": "*", "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc" } }, "sha512-kGkGegYIdQsOb4XjsfM97rXsiHaBwco+hFI66oO4s9LU+PLAC5oJ7khdOVFxkhsmlbpUqDAvXw11CluXP+jkHg=="],

    "@radix-ui/react-portal": ["@radix-ui/react-portal@1.1.9", "", { "dependencies": { "@radix-ui/react-primitive": "2.1.3", "@radix-ui/react-use-layout-effect": "1.1.1" }, "peerDependencies": { "@types/react": "*", "@types/react-dom": "*", "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc", "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc" } }, "sha512-bpIxvq03if6UNwXZ+HTK71JLh4APvnXntDc6XOX8UVq4XQOVl7lwok0AvIl+b8zgCw3fSaVTZMpAPPagXbKmHQ=="],

    "@radix-ui/react-presence": ["@radix-ui/react-presence@1.1.5", "", { "dependencies": { "@radix-ui/react-compose-refs": "1.1.2", "@radix-ui/react-use-layout-effect": "1.1.1" }, "peerDependencies": { "@types/react": "*", "@types/react-dom": "*", "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc", "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc" } }, "sha512-/jfEwNDdQVBCNvjkGit4h6pMOzq8bHkopq458dPt2lMjx+eBQUohZNG9A7DtO/O5ukSbxuaNGXMjHicgwy6rQQ=="],

    "@radix-ui/react-primitive": ["@radix-ui/react-primitive@2.1.3", "", { "dependencies": { "@radix-ui/react-slot": "1.2.3" }, "peerDependencies": { "@types/react": "*", "@types/react-dom": "*", "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc", "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc" } }, "sha512-m9gTwRkhy2lvCPe6QJp4d3G1TYEUHn/FzJUtq9MjH46an1wJU+GdoGC5VLof8RX8Ft/DlpshApkhswDLZzHIcQ=="],

    "@radix-ui/react-slot": ["@radix-ui/react-slot@1.2.3", "", { "dependencies": { "@radix-ui/react-compose-refs": "1.1.2" }, "peerDependencies": { "@types/react": "*", "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc" } }, "sha512-aeNmHnBxbi2St0au6VBVC7JXFlhLlOnvIIlePNniyUNAClzmtAUEY8/pBiK3iHjufOlwA+c20/8jngo7xcrg8A=="],

    "@radix-ui/react-use-callback-ref": ["@radix-ui/react-use-callback-ref@1.1.1", "", { "peerDependencies": { "@types/react": "*", "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc" } }, "sha512-FkBMwD+qbGQeMu1cOHnuGB6x4yzPjho8ap5WtbEJ26umhgqVXbhekKUQO+hZEL1vU92a3wHwdp0HAcqAUF5iDg=="],

    "@radix-ui/react-use-controllable-state": ["@radix-ui/react-use-controllable-state@1.2.2", "", { "dependencies": { "@radix-ui/react-use-effect-event": "0.0.2", "@radix-ui/react-use-layout-effect": "1.1.1" }, "peerDependencies": { "@types/react": "*", "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc" } }, "sha512-BjasUjixPFdS+NKkypcyyN5Pmg83Olst0+c6vGov0diwTEo6mgdqVR6hxcEgFuh4QrAs7Rc+9KuGJ9TVCj0Zzg=="],

    "@radix-ui/react-use-effect-event": ["@radix-ui/react-use-effect-event@0.0.2", "", { "dependencies": { "@radix-ui/react-use-layout-effect": "1.1.1" }, "peerDependencies": { "@types/react": "*", "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc" } }, "sha512-Qp8WbZOBe+blgpuUT+lw2xheLP8q0oatc9UpmiemEICxGvFLYmHm9QowVZGHtJlGbS6A6yJ3iViad/2cVjnOiA=="],

    "@radix-ui/react-use-escape-keydown": ["@radix-ui/react-use-escape-keydown@1.1.1", "", { "dependencies": { "@radix-ui/react-use-callback-ref": "1.1.1" }, "peerDependencies": { "@types/react": "*", "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc" } }, "sha512-Il0+boE7w/XebUHyBjroE+DbByORGR9KKmITzbR7MyQ4akpORYP/ZmbhAr0DG7RmmBqoOnZdy2QlvajJ2QA59g=="],

    "@radix-ui/react-use-layout-effect": ["@radix-ui/react-use-layout-effect@1.1.1", "", { "peerDependencies": { "@types/react": "*", "react": "^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc" } }, "sha512-RbJRS4UWQFkzHTTwVymMTUv8EqYhOp8dOOviLj2ugtTiXRaRQS7GLGxZTLL1jWhMeoSCf5zmcZkqTl9IiYfXcQ=="],

    "@rolldown/binding-android-arm64": ["@rolldown/binding-android-arm64@1.0.0-beta.41", "", { "os": "android", "cpu": "arm64" }, "sha512-Edflndd9lU7JVhVIvJlZhdCj5DkhYDJPIRn4Dx0RUdfc8asP9xHOI5gMd8MesDDx+BJpdIT/uAmVTearteU/mQ=="],

    "@rolldown/binding-darwin-arm64": ["@rolldown/binding-darwin-arm64@1.0.0-beta.41", "", { "os": "darwin", "cpu": "arm64" }, "sha512-XGCzqfjdk7550PlyZRTBKbypXrB7ATtXhw/+bjtxnklLQs0mKP/XkQVOKyn9qGKSlvH8I56JLYryVxl0PCvSNw=="],

    "@rolldown/binding-darwin-x64": ["@rolldown/binding-darwin-x64@1.0.0-beta.41", "", { "os": "darwin", "cpu": "x64" }, "sha512-Ho6lIwGJed98zub7n0xcRKuEtnZgbxevAmO4x3zn3C3N4GVXZD5xvCvTVxSMoeBJwTcIYzkVDRTIhylQNsTgLQ=="],

    "@rolldown/binding-freebsd-x64": ["@rolldown/binding-freebsd-x64@1.0.0-beta.41", "", { "os": "freebsd", "cpu": "x64" }, "sha512-ijAZETywvL+gACjbT4zBnCp5ez1JhTRs6OxRN4J+D6AzDRbU2zb01Esl51RP5/8ZOlvB37xxsRQ3X4YRVyYb3g=="],

    "@rolldown/binding-linux-arm-gnueabihf": ["@rolldown/binding-linux-arm-gnueabihf@1.0.0-beta.41", "", { "os": "linux", "cpu": "arm" }, "sha512-EgIOZt7UildXKFEFvaiLNBXm+4ggQyGe3E5Z1QP9uRcJJs9omihOnm897FwOBQdCuMvI49iBgjFrkhH+wMJ2MA=="],

    "@rolldown/binding-linux-arm64-gnu": ["@rolldown/binding-linux-arm64-gnu@1.0.0-beta.41", "", { "os": "linux", "cpu": "arm64" }, "sha512-F8bUwJq8v/JAU8HSwgF4dztoqJ+FjdyjuvX4//3+Fbe2we9UktFeZ27U4lRMXF1vxWtdV4ey6oCSqI7yUrSEeg=="],

    "@rolldown/binding-linux-arm64-musl": ["@rolldown/binding-linux-arm64-musl@1.0.0-beta.41", "", { "os": "linux", "cpu": "arm64" }, "sha512-MioXcCIX/wB1pBnBoJx8q4OGucUAfC1+/X1ilKFsjDK05VwbLZGRgOVD5OJJpUQPK86DhQciNBrfOKDiatxNmg=="],

    "@rolldown/binding-linux-x64-gnu": ["@rolldown/binding-linux-x64-gnu@1.0.0-beta.41", "", { "os": "linux", "cpu": "x64" }, "sha512-m66M61fizvRCwt5pOEiZQMiwBL9/y0bwU/+Kc4Ce/Pef6YfoEkR28y+DzN9rMdjo8Z28NXjsDPq9nH4mXnAP0g=="],

    "@rolldown/binding-linux-x64-musl": ["@rolldown/binding-linux-x64-musl@1.0.0-beta.41", "", { "os": "linux", "cpu": "x64" }, "sha512-yRxlSfBvWnnfrdtJfvi9lg8xfG5mPuyoSHm0X01oiE8ArmLRvoJGHUTJydCYz+wbK2esbq5J4B4Tq9WAsOlP1Q=="],

    "@rolldown/binding-openharmony-arm64": ["@rolldown/binding-openharmony-arm64@1.0.0-beta.41", "", { "os": "none", "cpu": "arm64" }, "sha512-PHVxYhBpi8UViS3/hcvQQb9RFqCtvFmFU1PvUoTRiUdBtgHA6fONNHU4x796lgzNlVSD3DO/MZNk1s5/ozSMQg=="],

    "@rolldown/binding-wasm32-wasi": ["@rolldown/binding-wasm32-wasi@1.0.0-beta.41", "", { "dependencies": { "@napi-rs/wasm-runtime": "^1.0.5" }, "cpu": "none" }, "sha512-OAfcO37ME6GGWmj9qTaDT7jY4rM0T2z0/8ujdQIJQ2x2nl+ztO32EIwURfmXOK0U1tzkyuaKYvE34Pug/ucXlQ=="],

    "@rolldown/binding-win32-arm64-msvc": ["@rolldown/binding-win32-arm64-msvc@1.0.0-beta.41", "", { "os": "win32", "cpu": "arm64" }, "sha512-NIYGuCcuXaq5BC4Q3upbiMBvmZsTsEPG9k/8QKQdmrch+ocSy5Jv9tdpdmXJyighKqm182nh/zBt+tSJkYoNlg=="],

    "@rolldown/binding-win32-ia32-msvc": ["@rolldown/binding-win32-ia32-msvc@1.0.0-beta.41", "", { "os": "win32", "cpu": "ia32" }, "sha512-kANdsDbE5FkEOb5NrCGBJBCaZ2Sabp3D7d4PRqMYJqyLljwh9mDyYyYSv5+QNvdAmifj+f3lviNEUUuUZPEFPw=="],

    "@rolldown/binding-win32-x64-msvc": ["@rolldown/binding-win32-x64-msvc@1.0.0-beta.41", "", { "os": "win32", "cpu": "x64" }, "sha512-UlpxKmFdik0Y2VjZrgUCgoYArZJiZllXgIipdBRV1hw6uK45UbQabSTW6Kp6enuOu7vouYWftwhuxfpE8J2JAg=="],

    "@rolldown/pluginutils": ["@rolldown/pluginutils@1.0.0-beta.43", "", {}, "sha512-5Uxg7fQUCmfhax7FJke2+8B6cqgeUJUD9o2uXIKXhD+mG0mL6NObmVoi9wXEU1tY89mZKgAYA6fTbftx3q2ZPQ=="],

    "@sec-ant/readable-stream": ["@sec-ant/readable-stream@0.4.1", "", {}, "sha512-831qok9r2t8AlxLko40y2ebgSDhenenCatLVeW/uBtnHPyhHOvG0C7TvfgecV+wHzIm5KUICgzmVpWS+IMEAeg=="],

    "@sindresorhus/merge-streams": ["@sindresorhus/merge-streams@4.0.0", "", {}, "sha512-tlqY9xq5ukxTUZBmoOp+m61cqwQD5pHJtFY3Mn8CA8ps6yghLH/Hw8UPdqg4OLmFW3IFlcXnQNmo/dh8HzXYIQ=="],

    "@socket.io/component-emitter": ["@socket.io/component-emitter@3.1.2", "", {}, "sha512-9BCxFwvbGg/RsZK9tjXd8s4UcwR0MWeFQ1XEKIQVVvAGJyINdrqKMcTRyLoK8Rse1GjzLV9cwjWV1olXRWEXVA=="],

    "@tailwindcss/node": ["@tailwindcss/node@4.1.17", "", { "dependencies": { "@jridgewell/remapping": "^2.3.4", "enhanced-resolve": "^5.18.3", "jiti": "^2.6.1", "lightningcss": "1.30.2", "magic-string": "^0.30.21", "source-map-js": "^1.2.1", "tailwindcss": "4.1.17" } }, "sha512-csIkHIgLb3JisEFQ0vxr2Y57GUNYh447C8xzwj89U/8fdW8LhProdxvnVH6U8M2Y73QKiTIH+LWbK3V2BBZsAg=="],

    "@tailwindcss/oxide": ["@tailwindcss/oxide@4.1.17", "", { "optionalDependencies": { "@tailwindcss/oxide-android-arm64": "4.1.17", "@tailwindcss/oxide-darwin-arm64": "4.1.17", "@tailwindcss/oxide-darwin-x64": "4.1.17", "@tailwindcss/oxide-freebsd-x64": "4.1.17", "@tailwindcss/oxide-linux-arm-gnueabihf": "4.1.17", "@tailwindcss/oxide-linux-arm64-gnu": "4.1.17", "@tailwindcss/oxide-linux-arm64-musl": "4.1.17", "@tailwindcss/oxide-linux-x64-gnu": "4.1.17", "@tailwindcss/oxide-linux-x64-musl": "4.1.17", "@tailwindcss/oxide-wasm32-wasi": "4.1.17", "@tailwindcss/oxide-win32-arm64-msvc": "4.1.17", "@tailwindcss/oxide-win32-x64-msvc": "4.1.17" } }, "sha512-F0F7d01fmkQhsTjXezGBLdrl1KresJTcI3DB8EkScCldyKp3Msz4hub4uyYaVnk88BAS1g5DQjjF6F5qczheLA=="],

    "@tailwindcss/oxide-android-arm64": ["@tailwindcss/oxide-android-arm64@4.1.17", "", { "os": "android", "cpu": "arm64" }, "sha512-BMqpkJHgOZ5z78qqiGE6ZIRExyaHyuxjgrJ6eBO5+hfrfGkuya0lYfw8fRHG77gdTjWkNWEEm+qeG2cDMxArLQ=="],

    "@tailwindcss/oxide-darwin-arm64": ["@tailwindcss/oxide-darwin-arm64@4.1.17", "", { "os": "darwin", "cpu": "arm64" }, "sha512-EquyumkQweUBNk1zGEU/wfZo2qkp/nQKRZM8bUYO0J+Lums5+wl2CcG1f9BgAjn/u9pJzdYddHWBiFXJTcxmOg=="],

    "@tailwindcss/oxide-darwin-x64": ["@tailwindcss/oxide-darwin-x64@4.1.17", "", { "os": "darwin", "cpu": "x64" }, "sha512-gdhEPLzke2Pog8s12oADwYu0IAw04Y2tlmgVzIN0+046ytcgx8uZmCzEg4VcQh+AHKiS7xaL8kGo/QTiNEGRog=="],

    "@tailwindcss/oxide-freebsd-x64": ["@tailwindcss/oxide-freebsd-x64@4.1.17", "", { "os": "freebsd", "cpu": "x64" }, "sha512-hxGS81KskMxML9DXsaXT1H0DyA+ZBIbyG/sSAjWNe2EDl7TkPOBI42GBV3u38itzGUOmFfCzk1iAjDXds8Oh0g=="],

    "@tailwindcss/oxide-linux-arm-gnueabihf": ["@tailwindcss/oxide-linux-arm-gnueabihf@4.1.17", "", { "os": "linux", "cpu": "arm" }, "sha512-k7jWk5E3ldAdw0cNglhjSgv501u7yrMf8oeZ0cElhxU6Y2o7f8yqelOp3fhf7evjIS6ujTI3U8pKUXV2I4iXHQ=="],

    "@tailwindcss/oxide-linux-arm64-gnu": ["@tailwindcss/oxide-linux-arm64-gnu@4.1.17", "", { "os": "linux", "cpu": "arm64" }, "sha512-HVDOm/mxK6+TbARwdW17WrgDYEGzmoYayrCgmLEw7FxTPLcp/glBisuyWkFz/jb7ZfiAXAXUACfyItn+nTgsdQ=="],

    "@tailwindcss/oxide-linux-arm64-musl": ["@tailwindcss/oxide-linux-arm64-musl@4.1.17", "", { "os": "linux", "cpu": "arm64" }, "sha512-HvZLfGr42i5anKtIeQzxdkw/wPqIbpeZqe7vd3V9vI3RQxe3xU1fLjss0TjyhxWcBaipk7NYwSrwTwK1hJARMg=="],

    "@tailwindcss/oxide-linux-x64-gnu": ["@tailwindcss/oxide-linux-x64-gnu@4.1.17", "", { "os": "linux", "cpu": "x64" }, "sha512-M3XZuORCGB7VPOEDH+nzpJ21XPvK5PyjlkSFkFziNHGLc5d6g3di2McAAblmaSUNl8IOmzYwLx9NsE7bplNkwQ=="],

    "@tailwindcss/oxide-linux-x64-musl": ["@tailwindcss/oxide-linux-x64-musl@4.1.17", "", { "os": "linux", "cpu": "x64" }, "sha512-k7f+pf9eXLEey4pBlw+8dgfJHY4PZ5qOUFDyNf7SI6lHjQ9Zt7+NcscjpwdCEbYi6FI5c2KDTDWyf2iHcCSyyQ=="],

    "@tailwindcss/oxide-wasm32-wasi": ["@tailwindcss/oxide-wasm32-wasi@4.1.17", "", { "cpu": "none" }, "sha512-cEytGqSSoy7zK4JRWiTCx43FsKP/zGr0CsuMawhH67ONlH+T79VteQeJQRO/X7L0juEUA8ZyuYikcRBf0vsxhg=="],

    "@tailwindcss/oxide-win32-arm64-msvc": ["@tailwindcss/oxide-win32-arm64-msvc@4.1.17", "", { "os": "win32", "cpu": "arm64" }, "sha512-JU5AHr7gKbZlOGvMdb4722/0aYbU+tN6lv1kONx0JK2cGsh7g148zVWLM0IKR3NeKLv+L90chBVYcJ8uJWbC9A=="],

    "@tailwindcss/oxide-win32-x64-msvc": ["@tailwindcss/oxide-win32-x64-msvc@4.1.17", "", { "os": "win32", "cpu": "x64" }, "sha512-SKWM4waLuqx0IH+FMDUw6R66Hu4OuTALFgnleKbqhgGU30DY20NORZMZUKgLRjQXNN2TLzKvh48QXTig4h4bGw=="],

    "@tailwindcss/vite": ["@tailwindcss/vite@4.1.17", "", { "dependencies": { "@tailwindcss/node": "4.1.17", "@tailwindcss/oxide": "4.1.17", "tailwindcss": "4.1.17" }, "peerDependencies": { "vite": "^5.2.0 || ^6 || ^7" } }, "sha512-4+9w8ZHOiGnpcGI6z1TVVfWaX/koK7fKeSYF3qlYg2xpBtbteP2ddBxiarL+HVgfSJGeK5RIxRQmKm4rTJJAwA=="],

    "@tanstack/query-core": ["@tanstack/query-core@5.90.20", "", {}, "sha512-OMD2HLpNouXEfZJWcKeVKUgQ5n+n3A2JFmBaScpNDUqSrQSjiveC7dKMe53uJUg1nDG16ttFPz2xfilz6i2uVg=="],

    "@tanstack/react-query": ["@tanstack/react-query@5.90.20", "", { "dependencies": { "@tanstack/query-core": "5.90.20" }, "peerDependencies": { "react": "^18 || ^19" } }, "sha512-vXBxa+qeyveVO7OA0jX1z+DeyCA4JKnThKv411jd5SORpBKgkcVnYKCiBgECvADvniBX7tobwBmg01qq9JmMJw=="],

    "@tanstack/react-table": ["@tanstack/react-table@8.21.3", "", { "dependencies": { "@tanstack/table-core": "8.21.3" }, "peerDependencies": { "react": ">=16.8", "react-dom": ">=16.8" } }, "sha512-5nNMTSETP4ykGegmVkhjcS8tTLW6Vl4axfEGQN3v0zdHYbK4UfoqfPChclTrJ4EoK9QynqAu9oUf8VEmrpZ5Ww=="],

    "@tanstack/react-virtual": ["@tanstack/react-virtual@3.13.18", "", { "dependencies": { "@tanstack/virtual-core": "3.13.18" }, "peerDependencies": { "react": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0", "react-dom": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0" } }, "sha512-dZkhyfahpvlaV0rIKnvQiVoWPyURppl6w4m9IwMDpuIjcJ1sD9YGWrt0wISvgU7ewACXx2Ct46WPgI6qAD4v6A=="],

    "@tanstack/table-core": ["@tanstack/table-core@8.21.3", "", {}, "sha512-ldZXEhOBb8Is7xLs01fR3YEc3DERiz5silj8tnGkFZytt1abEvl/GhUmCE0PMLaMPTa3Jk4HbKmRlHmu+gCftg=="],

    "@tanstack/virtual-core": ["@tanstack/virtual-core@3.13.18", "", {}, "sha512-Mx86Hqu1k39icq2Zusq+Ey2J6dDWTjDvEv43PJtRCoEYTLyfaPnxIQ6iy7YAOK0NV/qOEmZQ/uCufrppZxTgcg=="],

    "@tensorflow/tfjs": ["@tensorflow/tfjs@4.22.0", "", { "dependencies": { "@tensorflow/tfjs-backend-cpu": "4.22.0", "@tensorflow/tfjs-backend-webgl": "4.22.0", "@tensorflow/tfjs-converter": "4.22.0", "@tensorflow/tfjs-core": "4.22.0", "@tensorflow/tfjs-data": "4.22.0", "@tensorflow/tfjs-layers": "4.22.0", "argparse": "^1.0.10", "chalk": "^4.1.0", "core-js": "3.29.1", "regenerator-runtime": "^0.13.5", "yargs": "^16.0.3" }, "bin": { "tfjs-custom-module": "dist/tools/custom_module/cli.js" } }, "sha512-0TrIrXs6/b7FLhLVNmfh8Sah6JgjBPH4mZ8JGb7NU6WW+cx00qK5BcAZxw7NCzxj6N8MRAIfHq+oNbPUNG5VAg=="],

    "@tensorflow/tfjs-backend-cpu": ["@tensorflow/tfjs-backend-cpu@4.22.0", "", { "dependencies": { "@types/seedrandom": "^2.4.28", "seedrandom": "^3.0.5" }, "peerDependencies": { "@tensorflow/tfjs-core": "4.22.0" } }, "sha512-1u0FmuLGuRAi8D2c3cocHTASGXOmHc/4OvoVDENJayjYkS119fcTcQf4iHrtLthWyDIPy3JiPhRrZQC9EwnhLw=="],

    "@tensorflow/tfjs-backend-webgl": ["@tensorflow/tfjs-backend-webgl@4.22.0", "", { "dependencies": { "@tensorflow/tfjs-backend-cpu": "4.22.0", "@types/offscreencanvas": "~2019.3.0", "@types/seedrandom": "^2.4.28", "seedrandom": "^3.0.5" }, "peerDependencies": { "@tensorflow/tfjs-core": "4.22.0" } }, "sha512-H535XtZWnWgNwSzv538czjVlbJebDl5QTMOth4RXr2p/kJ1qSIXE0vZvEtO+5EC9b00SvhplECny2yDewQb/Yg=="],

    "@tensorflow/tfjs-converter": ["@tensorflow/tfjs-converter@4.22.0", "", { "peerDependencies": { "@tensorflow/tfjs-core": "4.22.0" } }, "sha512-PT43MGlnzIo+YfbsjM79Lxk9lOq6uUwZuCc8rrp0hfpLjF6Jv8jS84u2jFb+WpUeuF4K33ZDNx8CjiYrGQ2trQ=="],

    "@tensorflow/tfjs-core": ["@tensorflow/tfjs-core@4.22.0", "", { "dependencies": { "@types/long": "^4.0.1", "@types/offscreencanvas": "~2019.7.0", "@types/seedrandom": "^2.4.28", "@webgpu/types": "0.1.38", "long": "4.0.0", "node-fetch": "~2.6.1", "seedrandom": "^3.0.5" } }, "sha512-LEkOyzbknKFoWUwfkr59vSB68DMJ4cjwwHgicXN0DUi3a0Vh1Er3JQqCI1Hl86GGZQvY8ezVrtDIvqR1ZFW55A=="],

    "@tensorflow/tfjs-data": ["@tensorflow/tfjs-data@4.22.0", "", { "dependencies": { "@types/node-fetch": "^2.1.2", "node-fetch": "~2.6.1", "string_decoder": "^1.3.0" }, "peerDependencies": { "@tensorflow/tfjs-core": "4.22.0", "seedrandom": "^3.0.5" } }, "sha512-dYmF3LihQIGvtgJrt382hSRH4S0QuAp2w1hXJI2+kOaEqo5HnUPG0k5KA6va+S1yUhx7UBToUKCBHeLHFQRV4w=="],

    "@tensorflow/tfjs-layers": ["@tensorflow/tfjs-layers@4.22.0", "", { "peerDependencies": { "@tensorflow/tfjs-core": "4.22.0" } }, "sha512-lybPj4ZNj9iIAPUj7a8ZW1hg8KQGfqWLlCZDi9eM/oNKCCAgchiyzx8OrYoWmRrB+AM6VNEeIT+2gZKg5ReihA=="],

    "@tensorflow/tfjs-node": ["@tensorflow/tfjs-node@4.22.0", "", { "dependencies": { "@mapbox/node-pre-gyp": "1.0.9", "@tensorflow/tfjs": "4.22.0", "adm-zip": "^0.5.2", "google-protobuf": "^3.9.2", "https-proxy-agent": "^2.2.1", "progress": "^2.0.0", "rimraf": "^2.6.2", "tar": "^6.2.1" } }, "sha512-uHrXeUlfgkMxTZqHkESSV7zSdKdV0LlsBeblqkuKU9nnfxB1pC6DtoyYVaLxznzZy7WQSegjcohxxCjAf6Dc7w=="],

    "@ts-morph/common": ["@ts-morph/common@0.27.0", "", { "dependencies": { "fast-glob": "^3.3.3", "minimatch": "^10.0.1", "path-browserify": "^1.0.1" } }, "sha512-Wf29UqxWDpc+i61k3oIOzcUfQt79PIT9y/MWfAGlrkjg6lBC1hwDECLXPVJAhWjiGbfBCxZd65F/LIZF3+jeJQ=="],

    "@tybys/wasm-util": ["@tybys/wasm-util@0.10.1", "", { "dependencies": { "tslib": "^2.4.0" } }, "sha512-9tTaPJLSiejZKx+Bmog4uSubteqTvFrVrURwkmHixBo0G4seD0zUxp98E1DzUBJxLQ3NPwXrGKDiVjwx/DpPsg=="],

    "@types/babel__core": ["@types/babel__core@7.20.5", "", { "dependencies": { "@babel/parser": "^7.20.7", "@babel/types": "^7.20.7", "@types/babel__generator": "*", "@types/babel__template": "*", "@types/babel__traverse": "*" } }, "sha512-qoQprZvz5wQFJwMDqeseRXWv3rqMvhgpbXFfVyWhbx9X47POIA6i/+dXefEmZKoAgOaTdaIgNSMqMIU61yRyzA=="],

    "@types/babel__generator": ["@types/babel__generator@7.27.0", "", { "dependencies": { "@babel/types": "^7.0.0" } }, "sha512-ufFd2Xi92OAVPYsy+P4n7/U7e68fex0+Ee8gSG9KX7eo084CWiQ4sdxktvdl0bOPupXtVJPY19zk6EwWqUQ8lg=="],

    "@types/babel__template": ["@types/babel__template@7.4.4", "", { "dependencies": { "@babel/parser": "^7.1.0", "@babel/types": "^7.0.0" } }, "sha512-h/NUaSyG5EyxBIp8YRxo4RMe2/qQgvyowRwVMzhYhBCONbW8PUsg4lkFMrhgZhUe5z3L3MiLDuvyJ/CaPa2A8A=="],

    "@types/babel__traverse": ["@types/babel__traverse@7.28.0", "", { "dependencies": { "@babel/types": "^7.28.2" } }, "sha512-8PvcXf70gTDZBgt9ptxJ8elBeBjcLOAcOtoO/mPJjtji1+CdGbHgm77om1GrsPxsiE+uXIpNSK64UYaIwQXd4Q=="],

    "@types/estree": ["@types/estree@1.0.8", "", {}, "sha512-dWHzHa2WqEXI/O1E9OjrocMTKJl2mSrEolh1Iomrv6U+JuNwaHXsXx9bLu5gG7BUWFIN0skIQJQ/L1rIex4X6w=="],

    "@types/geojson": ["@types/geojson@7946.0.16", "", {}, "sha512-6C8nqWur3j98U6+lXDfTUWIfgvZU+EumvpHKcYjujKH7woYyLj2sUmff0tRhrqM7BohUw7Pz3ZB1jj2gW9Fvmg=="],

    "@types/json-schema": ["@types/json-schema@7.0.15", "", {}, "sha512-5+fP8P8MFNC+AyZCDxrB2pkZFPGzqQWUzpSeuuVLvm8VMcorNYavBqoFcxK8bQz4Qsbn4oUEEem4wDLfcysGHA=="],

    "@types/leaflet": ["@types/leaflet@1.9.21", "", { "dependencies": { "@types/geojson": "*" } }, "sha512-TbAd9DaPGSnzp6QvtYngntMZgcRk+igFELwR2N99XZn7RXUdKgsXMR+28bUO0rPsWp8MIu/f47luLIQuSLYv/w=="],

    "@types/long": ["@types/long@4.0.2", "", {}, "sha512-MqTGEo5bj5t157U6fA/BiDynNkn0YknVdh48CMPkTSpFTVmvao5UQmm7uEF6xBEo7qIMAlY/JSleYaE6VOdpaA=="],

    "@types/node": ["@types/node@24.10.0", "", { "dependencies": { "undici-types": "~7.16.0" } }, "sha512-qzQZRBqkFsYyaSWXuEHc2WR9c0a0CXwiE5FWUvn7ZM+vdy1uZLfCunD38UzhuB7YN/J11ndbDBcTmOdxJo9Q7A=="],

    "@types/node-fetch": ["@types/node-fetch@2.6.13", "", { "dependencies": { "@types/node": "*", "form-data": "^4.0.4" } }, "sha512-QGpRVpzSaUs30JBSGPjOg4Uveu384erbHBoT1zeONvyCfwQxIkUshLAOqN/k9EjGviPRmWTTe6aH2qySWKTVSw=="],

    "@types/offscreencanvas": ["@types/offscreencanvas@2019.3.0", "", {}, "sha512-esIJx9bQg+QYF0ra8GnvfianIY8qWB0GBx54PK5Eps6m+xTj86KLavHv6qDhzKcu5UUOgNfJ2pWaIIV7TRUd9Q=="],

    "@types/react": ["@types/react@19.2.3", "", { "dependencies": { "csstype": "^3.0.2" } }, "sha512-k5dJVszUiNr1DSe8Cs+knKR6IrqhqdhpUwzqhkS8ecQTSf3THNtbfIp/umqHMpX2bv+9dkx3fwDv/86LcSfvSg=="],

    "@types/react-dom": ["@types/react-dom@19.2.2", "", { "peerDependencies": { "@types/react": "^19.2.0" } }, "sha512-9KQPoO6mZCi7jcIStSnlOWn2nEF3mNmyr3rIAsGnAbQKYbRLyqmeSc39EVgtxXVia+LMT8j3knZLAZAh+xLmrw=="],

    "@types/seedrandom": ["@types/seedrandom@2.4.34", "", {}, "sha512-ytDiArvrn/3Xk6/vtylys5tlY6eo7Ane0hvcx++TKo6RxQXuVfW0AF/oeWqAj9dN29SyhtawuXstgmPlwNcv/A=="],

    "@types/statuses": ["@types/statuses@2.0.6", "", {}, "sha512-xMAgYwceFhRA2zY+XbEA7mxYbA093wdiW8Vu6gZPGWy9cmOyU9XesH1tNcEWsKFd5Vzrqx5T3D38PWx1FIIXkA=="],

    "@types/trusted-types": ["@types/trusted-types@2.0.7", "", {}, "sha512-ScaPdn1dQczgbl0QFTeTOmVHFULt394XJgOQNoyVhZ6r2vLnMLJfBPd53SB52T/3G36VI1/g2MZaX0cwDuXsfw=="],

    "@typescript-eslint/eslint-plugin": ["@typescript-eslint/eslint-plugin@8.46.4", "", { "dependencies": { "@eslint-community/regexpp": "^4.10.0", "@typescript-eslint/scope-manager": "8.46.4", "@typescript-eslint/type-utils": "8.46.4", "@typescript-eslint/utils": "8.46.4", "@typescript-eslint/visitor-keys": "8.46.4", "graphemer": "^1.4.0", "ignore": "^7.0.0", "natural-compare": "^1.4.0", "ts-api-utils": "^2.1.0" }, "peerDependencies": { "@typescript-eslint/parser": "^8.46.4", "eslint": "^8.57.0 || ^9.0.0", "typescript": ">=4.8.4 <6.0.0" } }, "sha512-R48VhmTJqplNyDxCyqqVkFSZIx1qX6PzwqgcXn1olLrzxcSBDlOsbtcnQuQhNtnNiJ4Xe5gREI1foajYaYU2Vg=="],

    "@typescript-eslint/parser": ["@typescript-eslint/parser@8.46.4", "", { "dependencies": { "@typescript-eslint/scope-manager": "8.46.4", "@typescript-eslint/types": "8.46.4", "@typescript-eslint/typescript-estree": "8.46.4", "@typescript-eslint/visitor-keys": "8.46.4", "debug": "^4.3.4" }, "peerDependencies": { "eslint": "^8.57.0 || ^9.0.0", "typescript": ">=4.8.4 <6.0.0" } }, "sha512-tK3GPFWbirvNgsNKto+UmB/cRtn6TZfyw0D6IKrW55n6Vbs7KJoZtI//kpTKzE/DUmmnAFD8/Ca46s7Obs92/w=="],

    "@typescript-eslint/project-service": ["@typescript-eslint/project-service@8.46.4", "", { "dependencies": { "@typescript-eslint/tsconfig-utils": "^8.46.4", "@typescript-eslint/types": "^8.46.4", "debug": "^4.3.4" }, "peerDependencies": { "typescript": ">=4.8.4 <6.0.0" } }, "sha512-nPiRSKuvtTN+no/2N1kt2tUh/HoFzeEgOm9fQ6XQk4/ApGqjx0zFIIaLJ6wooR1HIoozvj2j6vTi/1fgAz7UYQ=="],

    "@typescript-eslint/scope-manager": ["@typescript-eslint/scope-manager@8.46.4", "", { "dependencies": { "@typescript-eslint/types": "8.46.4", "@typescript-eslint/visitor-keys": "8.46.4" } }, "sha512-tMDbLGXb1wC+McN1M6QeDx7P7c0UWO5z9CXqp7J8E+xGcJuUuevWKxuG8j41FoweS3+L41SkyKKkia16jpX7CA=="],

    "@typescript-eslint/tsconfig-utils": ["@typescript-eslint/tsconfig-utils@8.46.4", "", { "peerDependencies": { "typescript": ">=4.8.4 <6.0.0" } }, "sha512-+/XqaZPIAk6Cjg7NWgSGe27X4zMGqrFqZ8atJsX3CWxH/jACqWnrWI68h7nHQld0y+k9eTTjb9r+KU4twLoo9A=="],

    "@typescript-eslint/type-utils": ["@typescript-eslint/type-utils@8.46.4", "", { "dependencies": { "@typescript-eslint/types": "8.46.4", "@typescript-eslint/typescript-estree": "8.46.4", "@typescript-eslint/utils": "8.46.4", "debug": "^4.3.4", "ts-api-utils": "^2.1.0" }, "peerDependencies": { "eslint": "^8.57.0 || ^9.0.0", "typescript": ">=4.8.4 <6.0.0" } }, "sha512-V4QC8h3fdT5Wro6vANk6eojqfbv5bpwHuMsBcJUJkqs2z5XnYhJzyz9Y02eUmF9u3PgXEUiOt4w4KHR3P+z0PQ=="],

    "@typescript-eslint/types": ["@typescript-eslint/types@8.46.4", "", {}, "sha512-USjyxm3gQEePdUwJBFjjGNG18xY9A2grDVGuk7/9AkjIF1L+ZrVnwR5VAU5JXtUnBL/Nwt3H31KlRDaksnM7/w=="],

    "@typescript-eslint/typescript-estree": ["@typescript-eslint/typescript-estree@8.46.4", "", { "dependencies": { "@typescript-eslint/project-service": "8.46.4", "@typescript-eslint/tsconfig-utils": "8.46.4", "@typescript-eslint/types": "8.46.4", "@typescript-eslint/visitor-keys": "8.46.4", "debug": "^4.3.4", "fast-glob": "^3.3.2", "is-glob": "^4.0.3", "minimatch": "^9.0.4", "semver": "^7.6.0", "ts-api-utils": "^2.1.0" }, "peerDependencies": { "typescript": ">=4.8.4 <6.0.0" } }, "sha512-7oV2qEOr1d4NWNmpXLR35LvCfOkTNymY9oyW+lUHkmCno7aOmIf/hMaydnJBUTBMRCOGZh8YjkFOc8dadEoNGA=="],

    "@typescript-eslint/utils": ["@typescript-eslint/utils@8.46.4", "", { "dependencies": { "@eslint-community/eslint-utils": "^4.7.0", "@typescript-eslint/scope-manager": "8.46.4", "@typescript-eslint/types": "8.46.4", "@typescript-eslint/typescript-estree": "8.46.4" }, "peerDependencies": { "eslint": "^8.57.0 || ^9.0.0", "typescript": ">=4.8.4 <6.0.0" } }, "sha512-AbSv11fklGXV6T28dp2Me04Uw90R2iJ30g2bgLz529Koehrmkbs1r7paFqr1vPCZi7hHwYxYtxfyQMRC8QaVSg=="],

    "@typescript-eslint/visitor-keys": ["@typescript-eslint/visitor-keys@8.46.4", "", { "dependencies": { "@typescript-eslint/types": "8.46.4", "eslint-visitor-keys": "^4.2.1" } }, "sha512-/++5CYLQqsO9HFGLI7APrxBJYo+5OCMpViuhV8q5/Qa3o5mMrF//eQHks+PXcsAVaLdn817fMuS7zqoXNNZGaw=="],

    "@typescript/native-preview": ["@typescript/native-preview@7.0.0-dev.20260222.1", "", { "optionalDependencies": { "@typescript/native-preview-darwin-arm64": "7.0.0-dev.20260222.1", "@typescript/native-preview-darwin-x64": "7.0.0-dev.20260222.1", "@typescript/native-preview-linux-arm": "7.0.0-dev.20260222.1", "@typescript/native-preview-linux-arm64": "7.0.0-dev.20260222.1", "@typescript/native-preview-linux-x64": "7.0.0-dev.20260222.1", "@typescript/native-preview-win32-arm64": "7.0.0-dev.20260222.1", "@typescript/native-preview-win32-x64": "7.0.0-dev.20260222.1" }, "bin": { "tsgo": "bin/tsgo.js" } }, "sha512-Uxon0iNhNqH/HkWvKmTmr7d5TJp6yomoyFHNpLIEghy91/DNWEtKMuLjNDYPFcoNxWpuJW9vuWTWeu3mcqT94Q=="],

    "@typescript/native-preview-darwin-arm64": ["@typescript/native-preview-darwin-arm64@7.0.0-dev.20260222.1", "", { "os": "darwin", "cpu": "arm64" }, "sha512-aXfK/s3QlbzXvZoFQ07KJDNx86q61nCITSreqLytnqjhjsXUUuMACsxjy/YsReLG2bdii+mHTA2WB2IB0LKKGA=="],

    "@typescript/native-preview-darwin-x64": ["@typescript/native-preview-darwin-x64@7.0.0-dev.20260222.1", "", { "os": "darwin", "cpu": "x64" }, "sha512-+bHnCeONX47pmVXTt6kuwxiLayDVqkLtshjqpqthXMWFFGk+1K/5ASbFEb2FumSABgB9hQ/xqkjj5QHUgGmbPg=="],

    "@typescript/native-preview-linux-arm": ["@typescript/native-preview-linux-arm@7.0.0-dev.20260222.1", "", { "os": "linux", "cpu": "arm" }, "sha512-bavfJlI3JNH2F/7BX0drZ4JCSjLsCc2Dy5e2s6pc2wuLIzJ6hIjFaXIeB9TDbVYJE+MlLf6rtQF9nP9iSsgk9g=="],

    "@typescript/native-preview-linux-arm64": ["@typescript/native-preview-linux-arm64@7.0.0-dev.20260222.1", "", { "os": "linux", "cpu": "arm64" }, "sha512-Usm9oJzLPqK7Z7echSSaHnmTXhr3knLXycoyVZwRrmWC33aX2efZb+XrdaV/SMhdYjYHCZ6mE60qcK4nEaXdng=="],

    "@typescript/native-preview-linux-x64": ["@typescript/native-preview-linux-x64@7.0.0-dev.20260222.1", "", { "os": "linux", "cpu": "x64" }, "sha512-JaOwNBJ2nA0C/MBfMXilrVNv+hUpIzs7JtpSgpOsXa3Hq7BL2rnoO6WMuCo8IHz7v8+Lr+MPJufXVEHfrOtf5A=="],

    "@typescript/native-preview-win32-arm64": ["@typescript/native-preview-win32-arm64@7.0.0-dev.20260222.1", "", { "os": "win32", "cpu": "arm64" }, "sha512-Mngr3qdeO7Ey3DtsHe4oqIghXYcjOr9pVQtKXbijfT0slRtVPeF1TmEb/eH+Z+LsY1SOW8c/Cig1G4NDXZnghw=="],

    "@typescript/native-preview-win32-x64": ["@typescript/native-preview-win32-x64@7.0.0-dev.20260222.1", "", { "os": "win32", "cpu": "x64" }, "sha512-8Gps/FPcQiyoHeDhRY3RXhJSJwQQuUIP5lepYO3+2xvCPPeeNBoOueiLoGKxno4CYbS4O2fPdVmymboX0ApjZA=="],

    "@vitejs/plugin-react": ["@vitejs/plugin-react@5.1.0", "", { "dependencies": { "@babel/core": "^7.28.4", "@babel/plugin-transform-react-jsx-self": "^7.27.1", "@babel/plugin-transform-react-jsx-source": "^7.27.1", "@rolldown/pluginutils": "1.0.0-beta.43", "@types/babel__core": "^7.20.5", "react-refresh": "^0.18.0" }, "peerDependencies": { "vite": "^4.2.0 || ^5.0.0 || ^6.0.0 || ^7.0.0" } }, "sha512-4LuWrg7EKWgQaMJfnN+wcmbAW+VSsCmqGohftWjuct47bv8uE4n/nPpq4XjJPsxgq00GGG5J8dvBczp8uxScew=="],

    "@webgpu/types": ["@webgpu/types@0.1.38", "", {}, "sha512-7LrhVKz2PRh+DD7+S+PVaFd5HxaWQvoMqBbsV9fNJO1pjUs1P8bM2vQVNfk+3URTqbuTI7gkXi0rfsN0IadoBA=="],

    "@xterm/xterm": ["@xterm/xterm@6.0.0", "", {}, "sha512-TQwDdQGtwwDt+2cgKDLn0IRaSxYu1tSUjgKarSDkUM0ZNiSRXFpjxEsvc/Zgc5kq5omJ+V0a8/kIM2WD3sMOYg=="],

    "abbrev": ["abbrev@1.1.1", "", {}, "sha512-nne9/IiQ/hzIhY6pdDnbBtz7DjPTKrY00P/zvPSm5pOFkl6xuGrGnXn/VtTNNfNtAfZ9/1RtehkszU9qcTii0Q=="],

    "accepts": ["accepts@2.0.0", "", { "dependencies": { "mime-types": "^3.0.0", "negotiator": "^1.0.0" } }, "sha512-5cvg6CtKwfgdmVqY1WIiXKc3Q1bkRqGLi+2W/6ao+6Y7gu/RCwRuAhGEzh5B4KlszSuTLgZYuqFqo5bImjNKng=="],

    "acorn": ["acorn@8.15.0", "", { "bin": "bin/acorn" }, "sha512-NZyJarBfL7nWwIq+FDL6Zp/yHEhePMNnnJ0y3qfieCrmNvYct8uvtiV41UvlSe6apAfk0fY1FbWx+NwfmpvtTg=="],

    "acorn-jsx": ["acorn-jsx@5.3.2", "", { "peerDependencies": { "acorn": "^6.0.0 || ^7.0.0 || ^8.0.0" } }, "sha512-rq9s+JNhf0IChjtDXxllJ7g41oZk5SlXtp0LHwyA5cejwn7vKmKp4pPri6YEePv2PU65sAsegbXtIinmDFDXgQ=="],

    "adm-zip": ["adm-zip@0.5.16", "", {}, "sha512-TGw5yVi4saajsSEgz25grObGHEUaDrniwvA2qwSC060KfqGPdglhvPMA2lPIoxs3PQIItj2iag35fONcQqgUaQ=="],

    "agent-base": ["agent-base@7.1.4", "", {}, "sha512-MnA+YT8fwfJPgBx3m60MNqakm30XOkyIoH1y6huTQvC0PwZG7ki8NacLBcrPbNoo8vEZy7Jpuk7+jMO+CUovTQ=="],

    "ajv": ["ajv@6.12.6", "", { "dependencies": { "fast-deep-equal": "^3.1.1", "fast-json-stable-stringify": "^2.0.0", "json-schema-traverse": "^0.4.1", "uri-js": "^4.2.2" } }, "sha512-j3fVLgvTo527anyYyJOGTYJbG+vnnQYvE0m5mmkc1TK+nxAppkCLMIL0aZ4dblVCNoGShhm+kzE4ZUykBoMg4g=="],

    "ajv-formats": ["ajv-formats@3.0.1", "", { "dependencies": { "ajv": "^8.0.0" }, "peerDependencies": { "ajv": "^8.0.0" } }, "sha512-8iUql50EUR+uUcdRQ3HDqa6EVyo3docL8g5WJ3FNcWmu62IbkGUue/pEyLBW8VGKKucTPgqeks4fIU1DA4yowQ=="],

    "ansi-regex": ["ansi-regex@6.2.2", "", {}, "sha512-Bq3SmSpyFHaWjPk8If9yc6svM8c56dB5BAtW4Qbw5jHTwwXXcTLoRMkpDJp6VL0XzlWaCHTXrkFURMYmD0sLqg=="],

    "ansi-styles": ["ansi-styles@4.3.0", "", { "dependencies": { "color-convert": "^2.0.1" } }, "sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg=="],

    "ansis": ["ansis@4.2.0", "", {}, "sha512-HqZ5rWlFjGiV0tDm3UxxgNRqsOTniqoKZu0pIAfh7TZQMGuZK+hH0drySty0si0QXj1ieop4+SkSfPZBPPkHig=="],

    "aproba": ["aproba@2.1.0", "", {}, "sha512-tLIEcj5GuR2RSTnxNKdkK0dJ/GrC7P38sUkiDmDuHfsHmbagTFAxDVIBltoklXEVIQ/f14IL8IMJ5pn9Hez1Ew=="],

    "are-we-there-yet": ["are-we-there-yet@2.0.0", "", { "dependencies": { "delegates": "^1.0.0", "readable-stream": "^3.6.0" } }, "sha512-Ci/qENmwHnsYo9xKIcUJN5LeDKdJ6R1Z1j9V/J5wyq8nh/mYPEpIKJbBZXtZjG04HiK7zV/p6Vs9952MrMeUIw=="],

    "argparse": ["argparse@1.0.10", "", { "dependencies": { "sprintf-js": "~1.0.2" } }, "sha512-o5Roy6tNG4SL/FOkCAN6RzjiakZS25RLYFrcMttJqbdd8BWrnA+fGz57iN5Pb06pvBGvl5gQ0B48dJlslXvoTg=="],

    "aria-hidden": ["aria-hidden@1.2.6", "", { "dependencies": { "tslib": "^2.0.0" } }, "sha512-ik3ZgC9dY/lYVVM++OISsaYDeg1tb0VtP5uL3ouh1koGOaUMDPpbFIei4JkFimWUFPn90sbMNMXQAIVOlnYKJA=="],

    "ast-types": ["ast-types@0.16.1", "", { "dependencies": { "tslib": "^2.0.1" } }, "sha512-6t10qk83GOG8p0vKmaCr8eiilZwO171AvbROMtvvNiwrTly62t+7XkA8RdIIVbpMhCASAsxgAzdRSwh6nw/5Dg=="],

    "asynckit": ["asynckit@0.4.0", "", {}, "sha512-Oei9OH4tRh0YqU3GxhX79dM/mwVgvbZJaSNaRk+bshkj0S5cfHcgYakreBjrHwatXKbz+IoIdYLxrKim2MjW0Q=="],

    "balanced-match": ["balanced-match@1.0.2", "", {}, "sha512-3oSeUO0TMV67hN1AmbXsK4yaqU7tjiHlbxRDZOpH0KW9+CeX4bRAaX0Anxt0tx2MrpRpWwQaPwIlISEJhYU5Pw=="],

    "baseline-browser-mapping": ["baseline-browser-mapping@2.8.26", "", { "bin": "dist/cli.js" }, "sha512-73lC1ugzwoaWCLJ1LvOgrR5xsMLTqSKIEoMHVtL9E/HNk0PXtTM76ZIm84856/SF7Nv8mPZxKoBsgpm0tR1u1Q=="],

    "body-parser": ["body-parser@2.2.0", "", { "dependencies": { "bytes": "^3.1.2", "content-type": "^1.0.5", "debug": "^4.4.0", "http-errors": "^2.0.0", "iconv-lite": "^0.6.3", "on-finished": "^2.4.1", "qs": "^6.14.0", "raw-body": "^3.0.0", "type-is": "^2.0.0" } }, "sha512-02qvAaxv8tp7fBa/mw1ga98OGm+eCbqzJOKoRt70sLmfEEi+jyBYVTDGfCL/k06/4EMk/z01gCe7HoCH/f2LTg=="],

    "brace-expansion": ["brace-expansion@1.1.12", "", { "dependencies": { "balanced-match": "^1.0.0", "concat-map": "0.0.1" } }, "sha512-9T9UjW3r0UW5c1Q7GTwllptXwhvYmEzFhzMfZ9H7FQWt+uZePjZPjBP/W1ZEyZ1twGWom5/56TF4lPcqjnDHcg=="],

    "braces": ["braces@3.0.3", "", { "dependencies": { "fill-range": "^7.1.1" } }, "sha512-yQbXgO/OSZVD2IsiLlro+7Hf6Q18EJrKSEsdoMzKePKXct3gvD8oLcOQdIzGupr5Fj+EDe8gO/lxc1BzfMpxvA=="],

    "browserslist": ["browserslist@4.28.0", "", { "dependencies": { "baseline-browser-mapping": "^2.8.25", "caniuse-lite": "^1.0.30001754", "electron-to-chromium": "^1.5.249", "node-releases": "^2.0.27", "update-browserslist-db": "^1.1.4" }, "bin": "cli.js" }, "sha512-tbydkR/CxfMwelN0vwdP/pLkDwyAASZ+VfWm4EOwlB6SWhx1sYnWLqo8N5j0rAzPfzfRaxt0mM/4wPU/Su84RQ=="],

    "bytes": ["bytes@3.1.2", "", {}, "sha512-/Nf7TyzTx6S3yRJObOAV7956r8cr2+Oj8AC5dt8wSP3BQAoeX58NoHyCU8P8zGkNXStjTSi6fzO6F0pBdcYbEg=="],

    "call-bind-apply-helpers": ["call-bind-apply-helpers@1.0.2", "", { "dependencies": { "es-errors": "^1.3.0", "function-bind": "^1.1.2" } }, "sha512-Sp1ablJ0ivDkSzjcaJdxEunN5/XvksFJ2sMBFfq6x0ryhQV/2b/KwFe21cMpmHtPOSij8K99/wSfoEuTObmuMQ=="],

    "call-bound": ["call-bound@1.0.4", "", { "dependencies": { "call-bind-apply-helpers": "^1.0.2", "get-intrinsic": "^1.3.0" } }, "sha512-+ys997U96po4Kx/ABpBCqhA9EuxJaQWDQg7295H4hBphv3IZg0boBKuwYpt4YXp6MZ5AmZQnU/tyMTlRpaSejg=="],

    "callsites": ["callsites@3.1.0", "", {}, "sha512-P8BjAsXvZS+VIDUI11hHCQEv74YT67YUi5JJFNWIqL235sBmjX4+qx9Muvls5ivyNENctx46xQLQ3aTuE7ssaQ=="],

    "caniuse-lite": ["caniuse-lite@1.0.30001754", "", {}, "sha512-x6OeBXueoAceOmotzx3PO4Zpt4rzpeIFsSr6AAePTZxSkXiYDUmpypEl7e2+8NCd9bD7bXjqyef8CJYPC1jfxg=="],

    "chalk": ["chalk@4.1.2", "", { "dependencies": { "ansi-styles": "^4.1.0", "supports-color": "^7.1.0" } }, "sha512-oKnbhFyRIXpUuez8iBMmyEa4nbj4IOQyuhc/wy9kY7/WVPcwIO9VA668Pu8RkO7+0G76SLROeyw9CpQ061i4mA=="],

    "chownr": ["chownr@2.0.0", "", {}, "sha512-bIomtDF5KGpdogkLd9VspvFzk9KfpyyGlS8YFVZl7TGPBHL5snIOnxeshwVgPteQ9b4Eydl+pVbIyE1DcvCWgQ=="],

    "class-variance-authority": ["class-variance-authority@0.7.1", "", { "dependencies": { "clsx": "^2.1.1" } }, "sha512-Ka+9Trutv7G8M6WT6SeiRWz792K5qEqIGEGzXKhAE6xOWAY6pPH8U+9IY3oCMv6kqTmLsv7Xh/2w2RigkePMsg=="],

    "cli-cursor": ["cli-cursor@5.0.0", "", { "dependencies": { "restore-cursor": "^5.0.0" } }, "sha512-aCj4O5wKyszjMmDT4tZj93kxyydN/K5zPWSCe6/0AV/AA1pqe5ZBIw0a2ZfPQV7lL5/yb5HsUreJ6UFAF1tEQw=="],

    "cli-spinners": ["cli-spinners@2.9.2", "", {}, "sha512-ywqV+5MmyL4E7ybXgKys4DugZbX0FC6LnwrhjuykIjnK9k8OQacQ7axGKnjDXWNhns0xot3bZI5h55H8yo9cJg=="],

    "cli-width": ["cli-width@4.1.0", "", {}, "sha512-ouuZd4/dm2Sw5Gmqy6bGyNNNe1qt9RpmxveLSO7KcgsTnU7RXfsw+/bukWGo1abgBiMAic068rclZsO4IWmmxQ=="],

    "cliui": ["cliui@8.0.1", "", { "dependencies": { "string-width": "^4.2.0", "strip-ansi": "^6.0.1", "wrap-ansi": "^7.0.0" } }, "sha512-BSeNnyus75C4//NQ9gQt1/csTXyo/8Sb+afLAkzAptFuMsod9HFokGNudZpi/oQV73hnVK+sR+5PVRMd+Dr7YQ=="],

    "clsx": ["clsx@2.1.1", "", {}, "sha512-eYm0QWBtUrBWZWG0d386OGAw16Z995PiOVo2B7bjWSbHedGl5e0ZWaq65kOGgUSNesEIDkB9ISbTg/JK9dhCZA=="],

    "cmdk": ["cmdk@1.1.1", "", { "dependencies": { "@radix-ui/react-compose-refs": "^1.1.1", "@radix-ui/react-dialog": "^1.1.6", "@radix-ui/react-id": "^1.1.0", "@radix-ui/react-primitive": "^2.0.2" }, "peerDependencies": { "react": "^18 || ^19 || ^19.0.0-rc", "react-dom": "^18 || ^19 || ^19.0.0-rc" } }, "sha512-Vsv7kFaXm+ptHDMZ7izaRsP70GgrW9NBNGswt9OZaVBLlE0SNpDq8eu/VGXyF9r7M0azK3Wy7OlYXsuyYLFzHg=="],

    "code-block-writer": ["code-block-writer@13.0.3", "", {}, "sha512-Oofo0pq3IKnsFtuHqSF7TqBfr71aeyZDVJ0HpmqB7FBM2qEigL0iPONSCZSO9pE9dZTAxANe5XHG9Uy0YMv8cg=="],

    "color-convert": ["color-convert@2.0.1", "", { "dependencies": { "color-name": "~1.1.4" } }, "sha512-RRECPsj7iu/xb5oKYcsFHSppFNnsj/52OVTRKb4zP5onXwVF3zVmmToNcOfGC+CRDpfK/U584fMg38ZHCaElKQ=="],

    "color-name": ["color-name@1.1.4", "", {}, "sha512-dOy+3AuW3a2wNbZHIuMZpTcgjGuLU/uBL/ubcZF9OXbDo8ff4O8yVp5Bf0efS8uEoYo5q4Fx7dY9OgQGXgAsQA=="],

    "color-support": ["color-support@1.1.3", "", { "bin": { "color-support": "bin.js" } }, "sha512-qiBjkpbMLO/HL68y+lh4q0/O1MZFj2RX6X/KmMa3+gJD3z+WwI1ZzDHysvqHGS3mP6mznPckpXmw1nI9cJjyRg=="],

    "combined-stream": ["combined-stream@1.0.8", "", { "dependencies": { "delayed-stream": "~1.0.0" } }, "sha512-FQN4MRfuJeHf7cBbBMJFXhKSDq+2kAArBlmRBvcvFE5BB1HZKXtSFASDhdlz9zOYwxh8lDdnvmMOe/+5cdoEdg=="],

    "commander": ["commander@14.0.2", "", {}, "sha512-TywoWNNRbhoD0BXs1P3ZEScW8W5iKrnbithIl0YH+uCmBd0QpPOA8yc82DS3BIE5Ma6FnBVUsJ7wVUDz4dvOWQ=="],

    "concat-map": ["concat-map@0.0.1", "", {}, "sha512-/Srv4dswyQNBfohGpz9o6Yb3Gz3SrUDqBH5rTuhGR7ahtlbYKnVxw2bCFMRljaA7EXHaXZ8wsHdodFvbkhKmqg=="],

    "console-control-strings": ["console-control-strings@1.1.0", "", {}, "sha512-ty/fTekppD2fIwRvnZAVdeOiGd1c7YXEixbgJTNzqcxJWKQnjJ/V1bNEEE6hygpM3WjwHFUVK6HTjWSzV4a8sQ=="],

    "content-disposition": ["content-disposition@1.0.0", "", { "dependencies": { "safe-buffer": "5.2.1" } }, "sha512-Au9nRL8VNUut/XSzbQA38+M78dzP4D+eqg3gfJHMIHHYa3bg067xj1KxMUWj+VULbiZMowKngFFbKczUrNJ1mg=="],

    "content-type": ["content-type@1.0.5", "", {}, "sha512-nTjqfcBFEipKdXCv4YDQWCfmcLZKm81ldF0pAopTvyrFGVbcR6P/VAAd5G7N+0tTr8QqiU0tFadD6FK4NtJwOA=="],

    "convert-source-map": ["convert-source-map@2.0.0", "", {}, "sha512-Kvp459HrV2FEJ1CAsi1Ku+MY3kasH19TFykTz2xWmMeq6bk2NU3XXvfJ+Q61m0xktWwt+1HSYf3JZsTms3aRJg=="],

    "cookie": ["cookie@1.0.2", "", {}, "sha512-9Kr/j4O16ISv8zBBhJoi4bXOYNTkFLOqSL3UDB0njXxCXNezjeyVrJyGOWtgfs/q2km1gwBcfH8q1yEGoMYunA=="],

    "cookie-signature": ["cookie-signature@1.2.2", "", {}, "sha512-D76uU73ulSXrD1UXF4KE2TMxVVwhsnCgfAyTg9k8P6KGZjlXKrOLe4dJQKI3Bxi5wjesZoFXJWElNWBjPZMbhg=="],

    "core-js": ["core-js@3.29.1", "", {}, "sha512-+jwgnhg6cQxKYIIjGtAHq2nwUOolo9eoFZ4sHfUH09BLXBgxnH4gA0zEd+t+BO2cNB8idaBtZFcFTRjQJRJmAw=="],

    "cors": ["cors@2.8.5", "", { "dependencies": { "object-assign": "^4", "vary": "^1" } }, "sha512-KIHbLJqu73RGr/hnbrO9uBeixNGuvSQjul/jdFvS/KFSIH1hWVd1ng7zOHx+YrEfInLG7q4n6GHQ9cDtxv/P6g=="],

    "cosmiconfig": ["cosmiconfig@9.0.0", "", { "dependencies": { "env-paths": "^2.2.1", "import-fresh": "^3.3.0", "js-yaml": "^4.1.0", "parse-json": "^5.2.0" }, "peerDependencies": { "typescript": ">=4.9.5" } }, "sha512-itvL5h8RETACmOTFc4UfIyB2RfEHi71Ax6E/PivVxq9NseKbOWpeyHEOIbmAw1rs8Ak0VursQNww7lf7YtUwzg=="],

    "cross-spawn": ["cross-spawn@7.0.6", "", { "dependencies": { "path-key": "^3.1.0", "shebang-command": "^2.0.0", "which": "^2.0.1" } }, "sha512-uV2QOWP2nWzsy2aMp8aRibhi9dlzF5Hgh5SHaB9OiTGEyDTiJJyx0uy51QXdyWbtAHNua4XJzUKca3OzKUd3vA=="],

    "csstype": ["csstype@3.1.3", "", {}, "sha512-M1uQkMl8rQK/szD0LNhtqxIPLpimGm8sOBwU7lLnCpSbTyY3yeU1Vc7l4KT5zT4s/yOxHH5O7tIuuLOCnLADRw=="],

    "data-uri-to-buffer": ["data-uri-to-buffer@4.0.1", "", {}, "sha512-0R9ikRb668HB7QDxT1vkpuUBtqc53YyAwMwGeUFKRojY/NWKvdZ+9UYtRfGmhqNbRkTSVpMbmyhXipFFv2cb/A=="],

    "date-fns": ["date-fns@4.1.0", "", {}, "sha512-Ukq0owbQXxa/U3EGtsdVBkR1w7KOQ5gIBqdH2hkvknzZPYvBxb/aa6E8L7tmjFtkwZBu3UXBbjIgPo/Ez4xaNg=="],

    "date-fns-jalali": ["date-fns-jalali@4.1.0-0", "", {}, "sha512-hTIP/z+t+qKwBDcmmsnmjWTduxCg+5KfdqWQvb2X/8C9+knYY6epN/pfxdDuyVlSVeFz0sM5eEfwIUQ70U4ckg=="],

    "debug": ["debug@4.4.3", "", { "dependencies": { "ms": "^2.1.3" } }, "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA=="],

    "dedent": ["dedent@1.7.0", "", { "peerDependencies": { "babel-plugin-macros": "^3.1.0" }, "optionalPeers": ["babel-plugin-macros"] }, "sha512-HGFtf8yhuhGhqO07SV79tRp+br4MnbdjeVxotpn1QBl30pcLLCQjX5b2295ll0fv8RKDKsmWYrl05usHM9CewQ=="],

    "deep-is": ["deep-is@0.1.4", "", {}, "sha512-oIPzksmTg4/MriiaYGO+okXDT7ztn/w3Eptv/+gSIdMdKsJo0u4CfYNFJPy+4SKMuCqGw2wxnA+URMg3t8a/bQ=="],

    "deepmerge": ["deepmerge@4.3.1", "", {}, "sha512-3sUqbMEc77XqpdNO7FRyRog+eW3ph+GYCbj+rK+uYyRMuwsVy0rMiVtPn+QJlKFvWP/1PYpapqYn0Me2knFn+A=="],

    "delayed-stream": ["delayed-stream@1.0.0", "", {}, "sha512-ZySD7Nf91aLB0RxL4KGrKHBXl7Eds1DAmEdcoVawXnLD7SDhpNgtuII2aAkg7a7QS41jxPSZ17p4VdGnMHk3MQ=="],

    "delegates": ["delegates@1.0.0", "", {}, "sha512-bd2L678uiWATM6m5Z1VzNCErI3jiGzt6HGY8OVICs40JQq/HALfbyNJmp0UDakEY4pMMaN0Ly5om/B1VI/+xfQ=="],

    "depd": ["depd@2.0.0", "", {}, "sha512-g7nH6P6dyDioJogAAGprGpCtVImJhpPk/roCzdb3fIh61/s/nPsfR6onyMwkCAR/OlC3yBC0lESvUoQEAssIrw=="],

    "detect-libc": ["detect-libc@2.1.2", "", {}, "sha512-Btj2BOOO83o3WyH59e8MgXsxEQVcarkUOpEYrubB0urwnN10yQ364rsiByU11nZlqWYZm05i/of7io4mzihBtQ=="],

    "detect-node-es": ["detect-node-es@1.1.0", "", {}, "sha512-ypdmJU/TbBby2Dxibuv7ZLW3Bs1QEmM7nHjEANfohJLvE0XVujisn1qPJcZxg+qDucsr+bP6fLD1rPS3AhJ7EQ=="],

    "diff": ["diff@8.0.2", "", {}, "sha512-sSuxWU5j5SR9QQji/o2qMvqRNYRDOcBTgsJ/DeCf4iSN4gW+gNMXM7wFIP+fdXZxoNiAnHUTGjCr+TSWXdRDKg=="],

    "dockview": ["dockview@4.11.0", "", { "dependencies": { "dockview-core": "^4.11.0" }, "peerDependencies": { "react": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0" } }, "sha512-C8QQPsK2SSfKgEFzC9vRADLok2YIr/AKdKRvnzWxo6SkPpH4t7oJvZJr2egL0bna1iUJaVcrWJEMZcI6slnsNA=="],

    "dockview-core": ["dockview-core@4.11.0", "", {}, "sha512-v7I9fjJ7mNsRCrtN4fLeopc46mufqUEie7hszJ4m37f3zWTnj73herI30021+v5BIxgM3Et/S95fI+ibdYZbQg=="],

    "dompurify": ["dompurify@3.2.7", "", { "optionalDependencies": { "@types/trusted-types": "^2.0.7" } }, "sha512-WhL/YuveyGXJaerVlMYGWhvQswa7myDG17P7Vu65EWC05o8vfeNbvNf4d/BOvH99+ZW+LlQsc1GDKMa1vNK6dw=="],

    "dotenv": ["dotenv@17.2.3", "", {}, "sha512-JVUnt+DUIzu87TABbhPmNfVdBDt18BLOWjMUFJMSi/Qqg7NTYtabbvSNJGOJ7afbRuv9D/lngizHtP7QyLQ+9w=="],

    "dunder-proto": ["dunder-proto@1.0.1", "", { "dependencies": { "call-bind-apply-helpers": "^1.0.1", "es-errors": "^1.3.0", "gopd": "^1.2.0" } }, "sha512-KIN/nDJBQRcXw0MLVhZE9iQHmG68qAVIBg9CqmUYjmQIhgij9U5MFvrqkUL5FbtyyzZuOeOt0zdeRe4UY7ct+A=="],

    "eciesjs": ["eciesjs@0.4.16", "", { "dependencies": { "@ecies/ciphers": "^0.2.4", "@noble/ciphers": "^1.3.0", "@noble/curves": "^1.9.7", "@noble/hashes": "^1.8.0" } }, "sha512-dS5cbA9rA2VR4Ybuvhg6jvdmp46ubLn3E+px8cG/35aEDNclrqoCjg6mt0HYZ/M+OoESS3jSkCrqk1kWAEhWAw=="],

    "ee-first": ["ee-first@1.1.1", "", {}, "sha512-WMwm9LhRUo+WUaRN+vRuETqG89IgZphVSNkdFgeb6sS/E4OrDIN7t48CAewSHXc6C8lefD8KKfr5vY61brQlow=="],

    "electron-to-chromium": ["electron-to-chromium@1.5.250", "", {}, "sha512-/5UMj9IiGDMOFBnN4i7/Ry5onJrAGSbOGo3s9FEKmwobGq6xw832ccET0CE3CkkMBZ8GJSlUIesZofpyurqDXw=="],

    "emoji-regex": ["emoji-regex@10.6.0", "", {}, "sha512-toUI84YS5YmxW219erniWD0CIVOo46xGKColeNQRgOzDorgBi1v4D71/OFzgD9GO2UGKIv1C3Sp8DAn0+j5w7A=="],

    "encodeurl": ["encodeurl@2.0.0", "", {}, "sha512-Q0n9HRi4m6JuGIV1eFlmvJB7ZEVxu93IrMyiMsGC0lrMJMWzRgx6WGquyfQgZVb31vhGgXnfmPNNXmxnOkRBrg=="],

    "engine.io-client": ["engine.io-client@6.6.3", "", { "dependencies": { "@socket.io/component-emitter": "~3.1.0", "debug": "~4.3.1", "engine.io-parser": "~5.2.1", "ws": "~8.17.1", "xmlhttprequest-ssl": "~2.1.1" } }, "sha512-T0iLjnyNWahNyv/lcjS2y4oE358tVS/SYQNxYXGAJ9/GLgH4VCvOQ/mhTjqU88mLZCQgiG8RIegFHYCdVC+j5w=="],

    "engine.io-parser": ["engine.io-parser@5.2.3", "", {}, "sha512-HqD3yTBfnBxIrbnM1DoD6Pcq8NECnh8d4As1Qgh0z5Gg3jRRIqijury0CL3ghu/edArpUYiYqQiDUQBIs4np3Q=="],

    "enhanced-resolve": ["enhanced-resolve@5.18.3", "", { "dependencies": { "graceful-fs": "^4.2.4", "tapable": "^2.2.0" } }, "sha512-d4lC8xfavMeBjzGr2vECC3fsGXziXZQyJxD868h2M/mBI3PwAuODxAkLkq5HYuvrPYcUtiLzsTo8U3PgX3Ocww=="],

    "env-paths": ["env-paths@2.2.1", "", {}, "sha512-+h1lkLKhZMTYjog1VEpJNG7NZJWcuc2DDk/qsqSTRRCOXiLjeQ1d1/udrUGhqMxUgAlwKNZ0cf2uqan5GLuS2A=="],

    "error-ex": ["error-ex@1.3.4", "", { "dependencies": { "is-arrayish": "^0.2.1" } }, "sha512-sqQamAnR14VgCr1A618A3sGrygcpK+HEbenA/HiEAkkUwcZIIB/tgWqHFxWgOyDh4nB4JCRimh79dR5Ywc9MDQ=="],

    "es-define-property": ["es-define-property@1.0.1", "", {}, "sha512-e3nRfgfUZ4rNGL232gUgX06QNyyez04KdjFrF+LTRoOXmrOgFKDg4BCdsjW8EnT69eqdYGmRpJwiPVYNrCaW3g=="],

    "es-errors": ["es-errors@1.3.0", "", {}, "sha512-Zf5H2Kxt2xjTvbJvP2ZWLEICxA6j+hAmMzIlypy4xcBg1vKVnx89Wy0GbS+kf5cwCVFFzdCFh2XSCFNULS6csw=="],

    "es-object-atoms": ["es-object-atoms@1.1.1", "", { "dependencies": { "es-errors": "^1.3.0" } }, "sha512-FGgH2h8zKNim9ljj7dankFPcICIK9Cp5bm+c2gQSYePhpaG5+esrLODihIorn+Pe6FGJzWhXQotPv73jTaldXA=="],

    "es-set-tostringtag": ["es-set-tostringtag@2.1.0", "", { "dependencies": { "es-errors": "^1.3.0", "get-intrinsic": "^1.2.6", "has-tostringtag": "^1.0.2", "hasown": "^2.0.2" } }, "sha512-j6vWzfrGVfyXxge+O0x5sh6cvxAog0a/4Rdd2K36zCMV5eJ+/+tOAngRO8cODMNWbVRdVlmGZQL2YS3yR8bIUA=="],

    "es6-promise": ["es6-promise@4.2.8", "", {}, "sha512-HJDGx5daxeIvxdBxvG2cb9g4tEvwIk3i8+nhX0yGrYmZUzbkdg8QbDevheDB8gd0//uPj4c1EQua8Q+MViT0/w=="],

    "es6-promisify": ["es6-promisify@5.0.0", "", { "dependencies": { "es6-promise": "^4.0.3" } }, "sha512-C+d6UdsYDk0lMebHNR4S2NybQMMngAOnOwYBQjTOiv0MkoJMP0Myw2mgpDLBcpfCmRLxyFqYhS/CfOENq4SJhQ=="],

    "escalade": ["escalade@3.2.0", "", {}, "sha512-WUj2qlxaQtO4g6Pq5c29GTcWGDyd8itL8zTlipgECz3JesAiiOKotd8JU6otB3PACgG6xkJUyVhboMS+bje/jA=="],

    "escape-html": ["escape-html@1.0.3", "", {}, "sha512-NiSupZ4OeuGwr68lGIeym/ksIZMJodUGOSCZ/FSnTxcrekbvqrgdUxlJOMpijaKZVjAJrWrGs/6Jy8OMuyj9ow=="],

    "escape-string-regexp": ["escape-string-regexp@4.0.0", "", {}, "sha512-TtpcNJ3XAzx3Gq8sWRzJaVajRs0uVxA2YAkdb1jm2YkPz4G6egUFAyA3n5vtEIZefPk5Wa4UXbKuS5fKkJWdgA=="],

    "eslint": ["eslint@9.39.1", "", { "dependencies": { "@eslint-community/eslint-utils": "^4.8.0", "@eslint-community/regexpp": "^4.12.1", "@eslint/config-array": "^0.21.1", "@eslint/config-helpers": "^0.4.2", "@eslint/core": "^0.17.0", "@eslint/eslintrc": "^3.3.1", "@eslint/js": "9.39.1", "@eslint/plugin-kit": "^0.4.1", "@humanfs/node": "^0.16.6", "@humanwhocodes/module-importer": "^1.0.1", "@humanwhocodes/retry": "^0.4.2", "@types/estree": "^1.0.6", "ajv": "^6.12.4", "chalk": "^4.0.0", "cross-spawn": "^7.0.6", "debug": "^4.3.2", "escape-string-regexp": "^4.0.0", "eslint-scope": "^8.4.0", "eslint-visitor-keys": "^4.2.1", "espree": "^10.4.0", "esquery": "^1.5.0", "esutils": "^2.0.2", "fast-deep-equal": "^3.1.3", "file-entry-cache": "^8.0.0", "find-up": "^5.0.0", "glob-parent": "^6.0.2", "ignore": "^5.2.0", "imurmurhash": "^0.1.4", "is-glob": "^4.0.0", "json-stable-stringify-without-jsonify": "^1.0.1", "lodash.merge": "^4.6.2", "minimatch": "^3.1.2", "natural-compare": "^1.4.0", "optionator": "^0.9.3" }, "peerDependencies": { "jiti": "*" }, "bin": "bin/eslint.js" }, "sha512-BhHmn2yNOFA9H9JmmIVKJmd288g9hrVRDkdoIgRCRuSySRUHH7r/DI6aAXW9T1WwUuY3DFgrcaqB+deURBLR5g=="],

    "eslint-plugin-react-hooks": ["eslint-plugin-react-hooks@5.2.0", "", { "peerDependencies": { "eslint": "^3.0.0 || ^4.0.0 || ^5.0.0 || ^6.0.0 || ^7.0.0 || ^8.0.0-0 || ^9.0.0" } }, "sha512-+f15FfK64YQwZdJNELETdn5ibXEUQmW1DZL6KXhNnc2heoy/sg9VJJeT7n8TlMWouzWqSWavFkIhHyIbIAEapg=="],

    "eslint-plugin-react-refresh": ["eslint-plugin-react-refresh@0.4.24", "", { "peerDependencies": { "eslint": ">=8.40" } }, "sha512-nLHIW7TEq3aLrEYWpVaJ1dRgFR+wLDPN8e8FpYAql/bMV2oBEfC37K0gLEGgv9fy66juNShSMV8OkTqzltcG/w=="],

    "eslint-scope": ["eslint-scope@8.4.0", "", { "dependencies": { "esrecurse": "^4.3.0", "estraverse": "^5.2.0" } }, "sha512-sNXOfKCn74rt8RICKMvJS7XKV/Xk9kA7DyJr8mJik3S7Cwgy3qlkkmyS2uQB3jiJg6VNdZd/pDBJu0nvG2NlTg=="],

    "eslint-visitor-keys": ["eslint-visitor-keys@4.2.1", "", {}, "sha512-Uhdk5sfqcee/9H/rCOJikYz67o0a2Tw2hGRPOG2Y1R2dg7brRe1uG0yaNQDHu+TO/uQPF/5eCapvYSmHUjt7JQ=="],

    "espree": ["espree@10.4.0", "", { "dependencies": { "acorn": "^8.15.0", "acorn-jsx": "^5.3.2", "eslint-visitor-keys": "^4.2.1" } }, "sha512-j6PAQ2uUr79PZhBjP5C5fhl8e39FmRnOjsD5lGnWrFU8i2G776tBK7+nP8KuQUTTyAZUwfQqXAgrVH5MbH9CYQ=="],

    "esprima": ["esprima@4.0.1", "", { "bin": { "esparse": "bin/esparse.js", "esvalidate": "bin/esvalidate.js" } }, "sha512-eGuFFw7Upda+g4p+QHvnW0RyTX/SVeJBDM/gCtMARO0cLuT2HcEKnTPvhjV6aGeqrCB/sbNop0Kszm0jsaWU4A=="],

    "esquery": ["esquery@1.6.0", "", { "dependencies": { "estraverse": "^5.1.0" } }, "sha512-ca9pw9fomFcKPvFLXhBKUK90ZvGibiGOvRJNbjljY7s7uq/5YO4BOzcYtJqExdx99rF6aAcnRxHmcUHcz6sQsg=="],

    "esrecurse": ["esrecurse@4.3.0", "", { "dependencies": { "estraverse": "^5.2.0" } }, "sha512-KmfKL3b6G+RXvP8N1vr3Tq1kL/oCFgn2NYXEtqP8/L3pKapUA4G8cFVaoF3SU323CD4XypR/ffioHmkti6/Tag=="],

    "estraverse": ["estraverse@5.3.0", "", {}, "sha512-MMdARuVEQziNTeJD8DgMqmhwR11BRQ/cBP+pLtYdSTnf3MIO8fFeiINEbX36ZdNlfU/7A9f3gUw49B3oQsvwBA=="],

    "esutils": ["esutils@2.0.3", "", {}, "sha512-kVscqXk4OCp68SZ0dkgEKVi6/8ij300KBWTJq32P/dYeWTSwK41WyTxalN1eRmA5Z9UU/LX9D7FWSmV9SAYx6g=="],

    "etag": ["etag@1.8.1", "", {}, "sha512-aIL5Fx7mawVa300al2BnEE4iNvo1qETxLrPI/o05L7z6go7fCw1J6EQmbK4FmJ2AS7kgVF/KEZWufBfdClMcPg=="],

    "eventsource": ["eventsource@3.0.7", "", { "dependencies": { "eventsource-parser": "^3.0.1" } }, "sha512-CRT1WTyuQoD771GW56XEZFQ/ZoSfWid1alKGDYMmkt2yl8UXrVR4pspqWNEcqKvVIzg6PAltWjxcSSPrboA4iA=="],

    "eventsource-parser": ["eventsource-parser@3.0.6", "", {}, "sha512-Vo1ab+QXPzZ4tCa8SwIHJFaSzy4R6SHf7BY79rFBDf0idraZWAkYrDjDj8uWaSm3S2TK+hJ7/t1CEmZ7jXw+pg=="],

    "execa": ["execa@9.6.0", "", { "dependencies": { "@sindresorhus/merge-streams": "^4.0.0", "cross-spawn": "^7.0.6", "figures": "^6.1.0", "get-stream": "^9.0.0", "human-signals": "^8.0.1", "is-plain-obj": "^4.1.0", "is-stream": "^4.0.1", "npm-run-path": "^6.0.0", "pretty-ms": "^9.2.0", "signal-exit": "^4.1.0", "strip-final-newline": "^4.0.0", "yoctocolors": "^2.1.1" } }, "sha512-jpWzZ1ZhwUmeWRhS7Qv3mhpOhLfwI+uAX4e5fOcXqwMR7EcJ0pj2kV1CVzHVMX/LphnKWD3LObjZCoJ71lKpHw=="],

    "express": ["express@5.1.0", "", { "dependencies": { "accepts": "^2.0.0", "body-parser": "^2.2.0", "content-disposition": "^1.0.0", "content-type": "^1.0.5", "cookie": "^0.7.1", "cookie-signature": "^1.2.1", "debug": "^4.4.0", "encodeurl": "^2.0.0", "escape-html": "^1.0.3", "etag": "^1.8.1", "finalhandler": "^2.1.0", "fresh": "^2.0.0", "http-errors": "^2.0.0", "merge-descriptors": "^2.0.0", "mime-types": "^3.0.0", "on-finished": "^2.4.1", "once": "^1.4.0", "parseurl": "^1.3.3", "proxy-addr": "^2.0.7", "qs": "^6.14.0", "range-parser": "^1.2.1", "router": "^2.2.0", "send": "^1.1.0", "serve-static": "^2.2.0", "statuses": "^2.0.1", "type-is": "^2.0.1", "vary": "^1.1.2" } }, "sha512-DT9ck5YIRU+8GYzzU5kT3eHGA5iL+1Zd0EutOmTE9Dtk+Tvuzd23VBU+ec7HPNSTxXYO55gPV/hq4pSBJDjFpA=="],

    "express-rate-limit": ["express-rate-limit@7.5.1", "", { "peerDependencies": { "express": ">= 4.11" } }, "sha512-7iN8iPMDzOMHPUYllBEsQdWVB6fPDMPqwjBaFrgr4Jgr/+okjvzAy+UHlYYL/Vs0OsOrMkwS6PJDkFlJwoxUnw=="],

    "fast-deep-equal": ["fast-deep-equal@3.1.3", "", {}, "sha512-f3qQ9oQy9j2AhBe/H9VC91wLmKBCCU/gDOnKNAYG5hswO7BLKj09Hc5HYNz9cGI++xlpDCIgDaitVs03ATR84Q=="],

    "fast-glob": ["fast-glob@3.3.3", "", { "dependencies": { "@nodelib/fs.stat": "^2.0.2", "@nodelib/fs.walk": "^1.2.3", "glob-parent": "^5.1.2", "merge2": "^1.3.0", "micromatch": "^4.0.8" } }, "sha512-7MptL8U0cqcFdzIzwOTHoilX9x5BrNqye7Z/LuC7kCMRio1EMSyqRK3BEAUD7sXRq4iT4AzTVuZdhgQ2TCvYLg=="],

    "fast-json-stable-stringify": ["fast-json-stable-stringify@2.1.0", "", {}, "sha512-lhd/wF+Lk98HZoTCtlVraHtfh5XYijIjalXck7saUtuanSDyLMxnHhSXEDJqHxD7msR8D0uCmqlkwjCV8xvwHw=="],

    "fast-levenshtein": ["fast-levenshtein@2.0.6", "", {}, "sha512-DCXu6Ifhqcks7TZKY3Hxp3y6qphY5SJZmrWMDrKcERSOXWQdMhU9Ig/PYrzyw/ul9jOIyh0N4M0tbC5hodg8dw=="],

    "fast-uri": ["fast-uri@3.1.0", "", {}, "sha512-iPeeDKJSWf4IEOasVVrknXpaBV0IApz/gp7S2bb7Z4Lljbl2MGJRqInZiUrQwV16cpzw/D3S5j5Julj/gT52AA=="],

    "fastq": ["fastq@1.19.1", "", { "dependencies": { "reusify": "^1.0.4" } }, "sha512-GwLTyxkCXjXbxqIhTsMI2Nui8huMPtnxg7krajPJAjnEG/iiOS7i+zCtWGZR9G0NBKbXKh6X9m9UIsYX/N6vvQ=="],

    "fdir": ["fdir@6.5.0", "", { "peerDependencies": { "picomatch": "^3 || ^4" } }, "sha512-tIbYtZbucOs0BRGqPJkshJUYdL+SDH7dVM8gjy+ERp3WAUjLEFJE+02kanyHtwjWOnwrKYBiwAmM0p4kLJAnXg=="],

    "fetch-blob": ["fetch-blob@3.2.0", "", { "dependencies": { "node-domexception": "^1.0.0", "web-streams-polyfill": "^3.0.3" } }, "sha512-7yAQpD2UMJzLi1Dqv7qFYnPbaPx7ZfFK6PiIxQ4PfkGPyNyl2Ugx+a/umUonmKqjhM4DnfbMvdX6otXq83soQQ=="],

    "figures": ["figures@6.1.0", "", { "dependencies": { "is-unicode-supported": "^2.0.0" } }, "sha512-d+l3qxjSesT4V7v2fh+QnmFnUWv9lSpjarhShNTgBOfA0ttejbQUAlHLitbjkoRiDulW0OPoQPYIGhIC8ohejg=="],

    "file-entry-cache": ["file-entry-cache@8.0.0", "", { "dependencies": { "flat-cache": "^4.0.0" } }, "sha512-XXTUwCvisa5oacNGRP9SfNtYBNAMi+RPwBFmblZEF7N7swHYQS6/Zfk7SRwx4D5j3CH211YNRco1DEMNVfZCnQ=="],

    "fill-range": ["fill-range@7.1.1", "", { "dependencies": { "to-regex-range": "^5.0.1" } }, "sha512-YsGpe3WHLK8ZYi4tWDg2Jy3ebRz2rXowDxnld4bkQB00cc/1Zw9AWnC0i9ztDJitivtQvaI9KaLyKrc+hBW0yg=="],

    "finalhandler": ["finalhandler@2.1.0", "", { "dependencies": { "debug": "^4.4.0", "encodeurl": "^2.0.0", "escape-html": "^1.0.3", "on-finished": "^2.4.1", "parseurl": "^1.3.3", "statuses": "^2.0.1" } }, "sha512-/t88Ty3d5JWQbWYgaOGCCYfXRwV1+be02WqYYlL6h0lEiUAMPM8o8qKGO01YIkOHzka2up08wvgYD0mDiI+q3Q=="],

    "find-up": ["find-up@5.0.0", "", { "dependencies": { "locate-path": "^6.0.0", "path-exists": "^4.0.0" } }, "sha512-78/PXT1wlLLDgTzDs7sjq9hzz0vXD+zn+7wypEe4fXQxCmdmqfGsEPQxmiCSQI3ajFV91bVSsvNtrJRiW6nGng=="],

    "flat-cache": ["flat-cache@4.0.1", "", { "dependencies": { "flatted": "^3.2.9", "keyv": "^4.5.4" } }, "sha512-f7ccFPK3SXFHpx15UIGyRJ/FJQctuKZ0zVuN3frBo4HnK3cay9VEW0R6yPYFHC0AgqhukPzKjq22t5DmAyqGyw=="],

    "flatted": ["flatted@3.3.3", "", {}, "sha512-GX+ysw4PBCz0PzosHDepZGANEuFCMLrnRTiEy9McGjmkCQYwRq4A/X786G/fjM/+OjsWSU1ZrY5qyARZmO/uwg=="],

    "form-data": ["form-data@4.0.5", "", { "dependencies": { "asynckit": "^0.4.0", "combined-stream": "^1.0.8", "es-set-tostringtag": "^2.1.0", "hasown": "^2.0.2", "mime-types": "^2.1.12" } }, "sha512-8RipRLol37bNs2bhoV67fiTEvdTrbMUYcFTiy3+wuuOnUog2QBHCZWXDRijWQfAkhBj2Uf5UnVaiWwA5vdd82w=="],

    "formdata-polyfill": ["formdata-polyfill@4.0.10", "", { "dependencies": { "fetch-blob": "^3.1.2" } }, "sha512-buewHzMvYL29jdeQTVILecSaZKnt/RJWjoZCF5OW60Z67/GmSLBkOFM7qh1PI3zFNtJbaZL5eQu1vLfazOwj4g=="],

    "forwarded": ["forwarded@0.2.0", "", {}, "sha512-buRG0fpBtRHSTCOASe6hD258tEubFoRLb4ZNA6NxMVHNw2gOcwHo9wyablzMzOA5z9xA9L1KNjk/Nt6MT9aYow=="],

    "fresh": ["fresh@2.0.0", "", {}, "sha512-Rx/WycZ60HOaqLKAi6cHRKKI7zxWbJ31MhntmtwMoaTeF7XFH9hhBp8vITaMidfljRQ6eYWCKkaTK+ykVJHP2A=="],

    "fs-extra": ["fs-extra@11.3.2", "", { "dependencies": { "graceful-fs": "^4.2.0", "jsonfile": "^6.0.1", "universalify": "^2.0.0" } }, "sha512-Xr9F6z6up6Ws+NjzMCZc6WXg2YFRlrLP9NQDO3VQrWrfiojdhS56TzueT88ze0uBdCTwEIhQ3ptnmKeWGFAe0A=="],

    "fs-minipass": ["fs-minipass@2.1.0", "", { "dependencies": { "minipass": "^3.0.0" } }, "sha512-V/JgOLFCS+R6Vcq0slCuaeWEdNC3ouDlJMNIsacH2VtALiu9mV4LPrHc5cDl8k5aw6J8jwgWWpiTo5RYhmIzvg=="],

    "fs.realpath": ["fs.realpath@1.0.0", "", {}, "sha512-OO0pH2lK6a0hZnAdau5ItzHPI6pUlvI7jMVnxUQRtw4owF2wk8lOSabtGDCTP4Ggrg2MbGnWO9X8K1t4+fGMDw=="],

    "fsevents": ["fsevents@2.3.3", "", { "os": "darwin" }, "sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw=="],

    "function-bind": ["function-bind@1.1.2", "", {}, "sha512-7XHNxH7qX9xG5mIwxkhumTox/MIRNcOgDrxWsMt2pAr23WHp6MrRlN7FBSFpCpr+oVO0F744iUgR82nJMfG2SA=="],

    "fuzzysort": ["fuzzysort@3.1.0", "", {}, "sha512-sR9BNCjBg6LNgwvxlBd0sBABvQitkLzoVY9MYYROQVX/FvfJ4Mai9LsGhDgd8qYdds0bY77VzYd5iuB+v5rwQQ=="],

    "fzf": ["fzf@0.5.2", "", {}, "sha512-Tt4kuxLXFKHy8KT40zwsUPUkg1CrsgY25FxA2U/j/0WgEDCk3ddc/zLTCCcbSHX9FcKtLuVaDGtGE/STWC+j3Q=="],

    "gauge": ["gauge@3.0.2", "", { "dependencies": { "aproba": "^1.0.3 || ^2.0.0", "color-support": "^1.1.2", "console-control-strings": "^1.0.0", "has-unicode": "^2.0.1", "object-assign": "^4.1.1", "signal-exit": "^3.0.0", "string-width": "^4.2.3", "strip-ansi": "^6.0.1", "wide-align": "^1.1.2" } }, "sha512-+5J6MS/5XksCuXq++uFRsnUd7Ovu1XenbeuIuNRJxYWjgQbPuFhT14lAvsWfqfAmnwluf1OwMjz39HjfLPci0Q=="],

    "gensync": ["gensync@1.0.0-beta.2", "", {}, "sha512-3hN7NaskYvMDLQY55gnW3NQ+mesEAepTqlg+VEbj7zzqEMBVNhzcGYYeqFo/TlYz6eQiFcp1HcsCZO+nGgS8zg=="],

    "get-caller-file": ["get-caller-file@2.0.5", "", {}, "sha512-DyFP3BM/3YHTQOCUL/w0OZHR0lpKeGrxotcHWcqNEdnltqFwXVfhEBQ94eIo34AfQpo0rGki4cyIiftY06h2Fg=="],

    "get-east-asian-width": ["get-east-asian-width@1.4.0", "", {}, "sha512-QZjmEOC+IT1uk6Rx0sX22V6uHWVwbdbxf1faPqJ1QhLdGgsRGCZoyaQBm/piRdJy/D2um6hM1UP7ZEeQ4EkP+Q=="],

    "get-intrinsic": ["get-intrinsic@1.3.0", "", { "dependencies": { "call-bind-apply-helpers": "^1.0.2", "es-define-property": "^1.0.1", "es-errors": "^1.3.0", "es-object-atoms": "^1.1.1", "function-bind": "^1.1.2", "get-proto": "^1.0.1", "gopd": "^1.2.0", "has-symbols": "^1.1.0", "hasown": "^2.0.2", "math-intrinsics": "^1.1.0" } }, "sha512-9fSjSaos/fRIVIp+xSJlE6lfwhES7LNtKaCBIamHsjr2na1BiABJPo0mOjjz8GJDURarmCPGqaiVg5mfjb98CQ=="],

    "get-nonce": ["get-nonce@1.0.1", "", {}, "sha512-FJhYRoDaiatfEkUK8HKlicmu/3SGFD51q3itKDGoSTysQJBnfOcxU5GxnhE1E6soB76MbT0MBtnKJuXyAx+96Q=="],

    "get-own-enumerable-keys": ["get-own-enumerable-keys@1.0.0", "", {}, "sha512-PKsK2FSrQCyxcGHsGrLDcK0lx+0Ke+6e8KFFozA9/fIQLhQzPaRvJFdcz7+Axg3jUH/Mq+NI4xa5u/UT2tQskA=="],

    "get-proto": ["get-proto@1.0.1", "", { "dependencies": { "dunder-proto": "^1.0.1", "es-object-atoms": "^1.0.0" } }, "sha512-sTSfBjoXBp89JvIKIefqw7U2CCebsc74kiY6awiGogKtoSGbgjYE/G/+l9sF3MWFPNc9IcoOC4ODfKHfxFmp0g=="],

    "get-stream": ["get-stream@9.0.1", "", { "dependencies": { "@sec-ant/readable-stream": "^0.4.1", "is-stream": "^4.0.1" } }, "sha512-kVCxPF3vQM/N0B1PmoqVUqgHP+EeVjmZSQn+1oCRPxd2P21P2F19lIgbR3HBosbB1PUhOAoctJnfEn2GbN2eZA=="],

    "glob": ["glob@7.2.3", "", { "dependencies": { "fs.realpath": "^1.0.0", "inflight": "^1.0.4", "inherits": "2", "minimatch": "^3.1.1", "once": "^1.3.0", "path-is-absolute": "^1.0.0" } }, "sha512-nFR0zLpU2YCaRxwoCJvL6UvCH2JFyFVIvwTLsIf21AuHlMskA1hhTdk+LlYJtOlYt9v6dvszD2BGRqBL+iQK9Q=="],

    "glob-parent": ["glob-parent@6.0.2", "", { "dependencies": { "is-glob": "^4.0.3" } }, "sha512-XxwI8EOhVQgWp6iDL+3b0r86f4d6AX6zSU55HfB4ydCEuXLXc5FcYeOu+nnGftS4TEju/11rt4KJPTMgbfmv4A=="],

    "globals": ["globals@16.5.0", "", {}, "sha512-c/c15i26VrJ4IRt5Z89DnIzCGDn9EcebibhAOjw5ibqEHsE1wLUgkPn9RDmNcUKyU87GeaL633nyJ+pplFR2ZQ=="],

    "google-protobuf": ["google-protobuf@3.21.4", "", {}, "sha512-MnG7N936zcKTco4Jd2PX2U96Kf9PxygAPKBug+74LHzmHXmceN16MmRcdgZv+DGef/S9YvQAfRsNCn4cjf9yyQ=="],

    "gopd": ["gopd@1.2.0", "", {}, "sha512-ZUKRh6/kUFoAiTAtTYPZJ3hw9wNxx+BIBOijnlG9PnrJsCcSjs1wyyD6vJpaYtgnzDrKYRSqf3OO6Rfa93xsRg=="],

    "graceful-fs": ["graceful-fs@4.2.11", "", {}, "sha512-RbJ5/jmFcNNCcDV5o9eTnBLJ/HszWV0P73bc+Ff4nS/rJj+YaS6IGyiOL0VoBYX+l1Wrl3k63h/KrH+nhJ0XvQ=="],

    "graphemer": ["graphemer@1.4.0", "", {}, "sha512-EtKwoO6kxCL9WO5xipiHTZlSzBm7WLT627TqC/uVRd0HKmq8NXyebnNYxDoBi7wt8eTWrUrKXCOVaFq9x1kgag=="],

    "graphql": ["graphql@16.12.0", "", {}, "sha512-DKKrynuQRne0PNpEbzuEdHlYOMksHSUI8Zc9Unei5gTsMNA2/vMpoMz/yKba50pejK56qj98qM0SjYxAKi13gQ=="],

    "has-flag": ["has-flag@4.0.0", "", {}, "sha512-EykJT/Q1KjTWctppgIAgfSO0tKVuZUjhgMr17kqTumMl6Afv3EISleU7qZUzoXDFTAHTDC4NOoG/ZxU3EvlMPQ=="],

    "has-symbols": ["has-symbols@1.1.0", "", {}, "sha512-1cDNdwJ2Jaohmb3sg4OmKaMBwuC48sYni5HUw2DvsC8LjGTLK9h+eb1X6RyuOHe4hT0ULCW68iomhjUoKUqlPQ=="],

    "has-tostringtag": ["has-tostringtag@1.0.2", "", { "dependencies": { "has-symbols": "^1.0.3" } }, "sha512-NqADB8VjPFLM2V0VvHUewwwsw0ZWBaIdgo+ieHtK3hasLz4qeCRjYcqfB6AQrBggRKppKF8L52/VqdVsO47Dlw=="],

    "has-unicode": ["has-unicode@2.0.1", "", {}, "sha512-8Rf9Y83NBReMnx0gFzA8JImQACstCYWUplepDa9xprwwtmgEZUF0h/i5xSA625zB/I37EtrswSST6OXxwaaIJQ=="],

    "hasown": ["hasown@2.0.2", "", { "dependencies": { "function-bind": "^1.1.2" } }, "sha512-0hJU9SCPvmMzIBdZFqNPXWa6dqh7WdH0cII9y+CyS8rG3nL48Bclra9HmKhVVUHyPWNH5Y7xDwAB7bfgSjkUMQ=="],

    "headers-polyfill": ["headers-polyfill@4.0.3", "", {}, "sha512-IScLbePpkvO846sIwOtOTDjutRMWdXdJmXdMvk6gCBHxFO8d+QKOQedyZSxFTTFYRSmlgSTDtXqqq4pcenBXLQ=="],

    "html-parse-stringify": ["html-parse-stringify@3.0.1", "", { "dependencies": { "void-elements": "3.1.0" } }, "sha512-KknJ50kTInJ7qIScF3jeaFRpMpE8/lfiTdzf/twXyPBLAGrLRTmkz3AdTnKeh40X8k9L2fdYwEp/42WGXIRGcg=="],

    "http-errors": ["http-errors@2.0.0", "", { "dependencies": { "depd": "2.0.0", "inherits": "2.0.4", "setprototypeof": "1.2.0", "statuses": "2.0.1", "toidentifier": "1.0.1" } }, "sha512-FtwrG/euBzaEjYeRqOgly7G0qviiXoJWnvEH2Z1plBdXgbyjv34pHTSb9zoeHMyDy33+DWy5Wt9Wo+TURtOYSQ=="],

    "https-proxy-agent": ["https-proxy-agent@7.0.6", "", { "dependencies": { "agent-base": "^7.1.2", "debug": "4" } }, "sha512-vK9P5/iUfdl95AI+JVyUuIcVtd4ofvtrOr3HNtM2yxC9bnMbEdp3x01OhQNnjb8IJYi38VlTE3mBXwcfvywuSw=="],

    "human-signals": ["human-signals@8.0.1", "", {}, "sha512-eKCa6bwnJhvxj14kZk5NCPc6Hb6BdsU9DZcOnmQKSnO1VKrfV0zCvtttPZUsBvjmNDn8rpcJfpwSYnHBjc95MQ=="],

    "i18next": ["i18next@25.6.2", "", { "dependencies": { "@babel/runtime": "^7.27.6" }, "peerDependencies": { "typescript": "^5" } }, "sha512-0GawNyVUw0yvJoOEBq1VHMAsqdM23XrHkMtl2gKEjviJQSLVXsrPqsoYAxBEugW5AB96I2pZkwRxyl8WZVoWdw=="],

    "iconv-lite": ["iconv-lite@0.7.0", "", { "dependencies": { "safer-buffer": ">= 2.1.2 < 3.0.0" } }, "sha512-cf6L2Ds3h57VVmkZe+Pn+5APsT7FpqJtEhhieDCvrE2MK5Qk9MyffgQyuxQTm6BChfeZNtcOLHp9IcWRVcIcBQ=="],

    "ignore": ["ignore@5.3.2", "", {}, "sha512-hsBTNUqQTDwkWtcdYI2i06Y/nUBEsNEDJKjWdigLvegy8kDuJAS8uRlpkkcQpyEXL0Z/pjDy5HBmMjRCJ2gq+g=="],

    "import-fresh": ["import-fresh@3.3.1", "", { "dependencies": { "parent-module": "^1.0.0", "resolve-from": "^4.0.0" } }, "sha512-TR3KfrTZTYLPB6jUjfx6MF9WcWrHL9su5TObK4ZkYgBdWKPOFoSoQIdEuTuR82pmtxH2spWG9h6etwfr1pLBqQ=="],

    "imurmurhash": ["imurmurhash@0.1.4", "", {}, "sha512-JmXMZ6wuvDmLiHEml9ykzqO6lwFbof0GG4IkcGaENdCRDDmMVnny7s5HsIgHCbaq0w2MyPhDqkhTUgS2LU2PHA=="],

    "inflight": ["inflight@1.0.6", "", { "dependencies": { "once": "^1.3.0", "wrappy": "1" } }, "sha512-k92I/b08q4wvFscXCLvqfsHCrjrF7yiXsQuIVvVE7N82W3+aqpzuUdBbfhWcy/FZR3/4IgflMgKLOsvPDrGCJA=="],

    "inherits": ["inherits@2.0.4", "", {}, "sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ=="],

    "ipaddr.js": ["ipaddr.js@1.9.1", "", {}, "sha512-0KI/607xoxSToH7GjN1FfSbLoU0+btTicjsQSWQlh/hZykN8KpmMf7uYwPW3R+akZ6R/w18ZlXSHBYXiYUPO3g=="],

    "is-arrayish": ["is-arrayish@0.2.1", "", {}, "sha512-zz06S8t0ozoDXMG+ube26zeCTNXcKIPJZJi8hBrF4idCLms4CG9QtK7qBl1boi5ODzFpjswb5JPmHCbMpjaYzg=="],

    "is-extglob": ["is-extglob@2.1.1", "", {}, "sha512-SbKbANkN603Vi4jEZv49LeVJMn4yGwsbzZworEoyEiutsN3nJYdbO36zfhGJ6QEDpOZIFkDtnq5JRxmvl3jsoQ=="],

    "is-fullwidth-code-point": ["is-fullwidth-code-point@3.0.0", "", {}, "sha512-zymm5+u+sCsSWyD9qNaejV3DFvhCKclKdizYaJUuHA83RLjb7nSuGnddCHGv0hk+KY7BMAlsWeK4Ueg6EV6XQg=="],

    "is-glob": ["is-glob@4.0.3", "", { "dependencies": { "is-extglob": "^2.1.1" } }, "sha512-xelSayHH36ZgE7ZWhli7pW34hNbNl8Ojv5KVmkJD4hBdD3th8Tfk9vYasLM+mXWOZhFkgZfxhLSnrwRr4elSSg=="],

    "is-interactive": ["is-interactive@2.0.0", "", {}, "sha512-qP1vozQRI+BMOPcjFzrjXuQvdak2pHNUMZoeG2eRbiSqyvbEf/wQtEOTOX1guk6E3t36RkaqiSt8A/6YElNxLQ=="],

    "is-node-process": ["is-node-process@1.2.0", "", {}, "sha512-Vg4o6/fqPxIjtxgUH5QLJhwZ7gW5diGCVlXpuUfELC62CuxM1iHcRe51f2W1FDy04Ai4KJkagKjx3XaqyfRKXw=="],

    "is-number": ["is-number@7.0.0", "", {}, "sha512-41Cifkg6e8TylSpdtTpeLVMqvSBEVzTttHvERD741+pnZ8ANv0004MRL43QKPDlK9cGvNp6NZWZUBlbGXYxxng=="],

    "is-obj": ["is-obj@3.0.0", "", {}, "sha512-IlsXEHOjtKhpN8r/tRFj2nDyTmHvcfNeu/nrRIcXE17ROeatXchkojffa1SpdqW4cr/Fj6QkEf/Gn4zf6KKvEQ=="],

    "is-plain-obj": ["is-plain-obj@4.1.0", "", {}, "sha512-+Pgi+vMuUNkJyExiMBt5IlFoMyKnr5zhJ4Uspz58WOhBF5QoIZkFyNHIbBAtHwzVAgk5RtndVNsDRN61/mmDqg=="],

    "is-promise": ["is-promise@4.0.0", "", {}, "sha512-hvpoI6korhJMnej285dSg6nu1+e6uxs7zG3BYAm5byqDsgJNWwxzM6z6iZiAgQR4TJ30JmBTOwqZUw3WlyH3AQ=="],

    "is-regexp": ["is-regexp@3.1.0", "", {}, "sha512-rbku49cWloU5bSMI+zaRaXdQHXnthP6DZ/vLnfdSKyL4zUzuWnomtOEiZZOd+ioQ+avFo/qau3KPTc7Fjy1uPA=="],

    "is-stream": ["is-stream@4.0.1", "", {}, "sha512-Dnz92NInDqYckGEUJv689RbRiTSEHCQ7wOVeALbkOz999YpqT46yMRIGtSNl2iCL1waAZSx40+h59NV/EwzV/A=="],

    "is-unicode-supported": ["is-unicode-supported@2.1.0", "", {}, "sha512-mE00Gnza5EEB3Ds0HfMyllZzbBrmLOX3vfWoj9A9PEnTfratQ/BcaJOuMhnkhjXvb2+FkY3VuHqtAGpTPmglFQ=="],

    "isexe": ["isexe@2.0.0", "", {}, "sha512-RHxMLp9lnKHGHRng9QFhRCMbYAcVpn69smSGcq3f36xjgVVWThj4qqLbTLlq7Ssj8B+fIQ1EuCEGI2lKsyQeIw=="],

    "jiti": ["jiti@2.6.1", "", { "bin": "lib/jiti-cli.mjs" }, "sha512-ekilCSN1jwRvIbgeg/57YFh8qQDNbwDb9xT/qu2DAHbFFZUicIl4ygVaAvzveMhMVr3LnpSKTNnwt8PoOfmKhQ=="],

    "js-tokens": ["js-tokens@4.0.0", "", {}, "sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ=="],

    "js-yaml": ["js-yaml@4.1.0", "", { "dependencies": { "argparse": "^2.0.1" }, "bin": "bin/js-yaml.js" }, "sha512-wpxZs9NoxZaJESJGIZTyDEaYpl0FKSA+FB9aJiyemKhMwkxQg63h4T1KJgUGHpTqPDNRcmmYLugrRjJlBtWvRA=="],

    "jsesc": ["jsesc@3.1.0", "", { "bin": "bin/jsesc" }, "sha512-/sM3dO2FOzXjKQhJuo0Q173wf2KOo8t4I8vHy6lF9poUp7bKT0/NHE8fPX23PwfhnykfqnC2xRxOnVw5XuGIaA=="],

    "json-buffer": ["json-buffer@3.0.1", "", {}, "sha512-4bV5BfR2mqfQTJm+V5tPPdf+ZpuhiIvTuAB5g8kcrXOZpTT/QwwVRWBywX1ozr6lEuPdbHxwaJlm9G6mI2sfSQ=="],

    "json-parse-even-better-errors": ["json-parse-even-better-errors@2.3.1", "", {}, "sha512-xyFwyhro/JEof6Ghe2iz2NcXoj2sloNsWr/XsERDK/oiPCfaNhl5ONfp+jQdAZRQQ0IJWNzH9zIZF7li91kh2w=="],

    "json-schema-traverse": ["json-schema-traverse@0.4.1", "", {}, "sha512-xbbCH5dCYU5T8LcEhhuh7HJ88HXuW3qsI3Y0zOZFKfZEHcpWiHU/Jxzk629Brsab/mMiHQti9wMP+845RPe3Vg=="],

    "json-stable-stringify-without-jsonify": ["json-stable-stringify-without-jsonify@1.0.1", "", {}, "sha512-Bdboy+l7tA3OGW6FjyFHWkP5LuByj1Tk33Ljyq0axyzdk9//JSi2u3fP1QSmd1KNwq6VOKYGlAu87CisVir6Pw=="],

    "json5": ["json5@2.2.3", "", { "bin": "lib/cli.js" }, "sha512-XmOWe7eyHYH14cLdVPoyg+GOH3rYX++KpzrylJwSW98t3Nk+U8XOl8FWKOgwtzdb8lXGf6zYwDUzeHMWfxasyg=="],

    "jsonfile": ["jsonfile@6.2.0", "", { "dependencies": { "universalify": "^2.0.0" }, "optionalDependencies": { "graceful-fs": "^4.1.6" } }, "sha512-FGuPw30AdOIUTRMC2OMRtQV+jkVj2cfPqSeWXv1NEAJ1qZ5zb1X6z1mFhbfOB/iy3ssJCD+3KuZ8r8C3uVFlAg=="],

    "keyv": ["keyv@4.5.4", "", { "dependencies": { "json-buffer": "3.0.1" } }, "sha512-oxVHkHR/EJf2CNXnWxRLW6mg7JyCCUcG0DtEGmL2ctUo1PNTin1PUil+r/+4r5MpVgC/fn1kjsx7mjSujKqIpw=="],

    "kleur": ["kleur@4.1.5", "", {}, "sha512-o+NO+8WrRiQEE4/7nwRJhN1HWpVmJm511pBHUxPLtp0BUISzlBplORYSmTclCnJvQq2tKu/sgl3xVpkc7ZWuQQ=="],

    "leaflet": ["leaflet@1.9.4", "", {}, "sha512-nxS1ynzJOmOlHp+iL3FyWqK89GtNL8U8rvlMOsQdTTssxZwCXh8N2NB3GDQOL+YR3XnWyZAxwQixURb+FA74PA=="],

    "levn": ["levn@0.4.1", "", { "dependencies": { "prelude-ls": "^1.2.1", "type-check": "~0.4.0" } }, "sha512-+bT2uH4E5LGE7h/n3evcS/sQlJXCpIp6ym8OWJ5eV6+67Dsql/LaaT7qJBAt2rzfoa/5QBGBhxDix1dMt2kQKQ=="],

    "lightningcss": ["lightningcss@1.30.2", "", { "dependencies": { "detect-libc": "^2.0.3" }, "optionalDependencies": { "lightningcss-android-arm64": "1.30.2", "lightningcss-darwin-arm64": "1.30.2", "lightningcss-darwin-x64": "1.30.2", "lightningcss-freebsd-x64": "1.30.2", "lightningcss-linux-arm-gnueabihf": "1.30.2", "lightningcss-linux-arm64-gnu": "1.30.2", "lightningcss-linux-arm64-musl": "1.30.2", "lightningcss-linux-x64-gnu": "1.30.2", "lightningcss-linux-x64-musl": "1.30.2", "lightningcss-win32-arm64-msvc": "1.30.2", "lightningcss-win32-x64-msvc": "1.30.2" } }, "sha512-utfs7Pr5uJyyvDETitgsaqSyjCb2qNRAtuqUeWIAKztsOYdcACf2KtARYXg2pSvhkt+9NfoaNY7fxjl6nuMjIQ=="],

    "lightningcss-android-arm64": ["lightningcss-android-arm64@1.30.2", "", { "os": "android", "cpu": "arm64" }, "sha512-BH9sEdOCahSgmkVhBLeU7Hc9DWeZ1Eb6wNS6Da8igvUwAe0sqROHddIlvU06q3WyXVEOYDZ6ykBZQnjTbmo4+A=="],

    "lightningcss-darwin-arm64": ["lightningcss-darwin-arm64@1.30.2", "", { "os": "darwin", "cpu": "arm64" }, "sha512-ylTcDJBN3Hp21TdhRT5zBOIi73P6/W0qwvlFEk22fkdXchtNTOU4Qc37SkzV+EKYxLouZ6M4LG9NfZ1qkhhBWA=="],

    "lightningcss-darwin-x64": ["lightningcss-darwin-x64@1.30.2", "", { "os": "darwin", "cpu": "x64" }, "sha512-oBZgKchomuDYxr7ilwLcyms6BCyLn0z8J0+ZZmfpjwg9fRVZIR5/GMXd7r9RH94iDhld3UmSjBM6nXWM2TfZTQ=="],

    "lightningcss-freebsd-x64": ["lightningcss-freebsd-x64@1.30.2", "", { "os": "freebsd", "cpu": "x64" }, "sha512-c2bH6xTrf4BDpK8MoGG4Bd6zAMZDAXS569UxCAGcA7IKbHNMlhGQ89eRmvpIUGfKWNVdbhSbkQaWhEoMGmGslA=="],

    "lightningcss-linux-arm-gnueabihf": ["lightningcss-linux-arm-gnueabihf@1.30.2", "", { "os": "linux", "cpu": "arm" }, "sha512-eVdpxh4wYcm0PofJIZVuYuLiqBIakQ9uFZmipf6LF/HRj5Bgm0eb3qL/mr1smyXIS1twwOxNWndd8z0E374hiA=="],

    "lightningcss-linux-arm64-gnu": ["lightningcss-linux-arm64-gnu@1.30.2", "", { "os": "linux", "cpu": "arm64" }, "sha512-UK65WJAbwIJbiBFXpxrbTNArtfuznvxAJw4Q2ZGlU8kPeDIWEX1dg3rn2veBVUylA2Ezg89ktszWbaQnxD/e3A=="],

    "lightningcss-linux-arm64-musl": ["lightningcss-linux-arm64-musl@1.30.2", "", { "os": "linux", "cpu": "arm64" }, "sha512-5Vh9dGeblpTxWHpOx8iauV02popZDsCYMPIgiuw97OJ5uaDsL86cnqSFs5LZkG3ghHoX5isLgWzMs+eD1YzrnA=="],

    "lightningcss-linux-x64-gnu": ["lightningcss-linux-x64-gnu@1.30.2", "", { "os": "linux", "cpu": "x64" }, "sha512-Cfd46gdmj1vQ+lR6VRTTadNHu6ALuw2pKR9lYq4FnhvgBc4zWY1EtZcAc6EffShbb1MFrIPfLDXD6Xprbnni4w=="],

    "lightningcss-linux-x64-musl": ["lightningcss-linux-x64-musl@1.30.2", "", { "os": "linux", "cpu": "x64" }, "sha512-XJaLUUFXb6/QG2lGIW6aIk6jKdtjtcffUT0NKvIqhSBY3hh9Ch+1LCeH80dR9q9LBjG3ewbDjnumefsLsP6aiA=="],

    "lightningcss-win32-arm64-msvc": ["lightningcss-win32-arm64-msvc@1.30.2", "", { "os": "win32", "cpu": "arm64" }, "sha512-FZn+vaj7zLv//D/192WFFVA0RgHawIcHqLX9xuWiQt7P0PtdFEVaxgF9rjM/IRYHQXNnk61/H/gb2Ei+kUQ4xQ=="],

    "lightningcss-win32-x64-msvc": ["lightningcss-win32-x64-msvc@1.30.2", "", { "os": "win32", "cpu": "x64" }, "sha512-5g1yc73p+iAkid5phb4oVFMB45417DkRevRbt/El/gKXJk4jid+vPFF/AXbxn05Aky8PapwzZrdJShv5C0avjw=="],

    "lines-and-columns": ["lines-and-columns@1.2.4", "", {}, "sha512-7ylylesZQ/PV29jhEDl3Ufjo6ZX7gCqJr5F7PKrqc93v7fzSymt1BpwEU8nAUXs8qzzvqhbjhK5QZg6Mt/HkBg=="],

    "locate-path": ["locate-path@6.0.0", "", { "dependencies": { "p-locate": "^5.0.0" } }, "sha512-iPZK6eYjbxRu3uB4/WZ3EsEIMJFMqAoopl3R+zuq0UjcAm/MO6KCweDgPfP3elTztoKP3KtnVHxTn2NHBSDVUw=="],

    "lodash.merge": ["lodash.merge@4.6.2", "", {}, "sha512-0KpjqXRVvrYyCsX1swR/XTK0va6VQkQM6MNo7PqW77ByjAhoARA8EfrP1N4+KlKj8YS0ZUCtRT/YUuhyYDujIQ=="],

    "log-symbols": ["log-symbols@6.0.0", "", { "dependencies": { "chalk": "^5.3.0", "is-unicode-supported": "^1.3.0" } }, "sha512-i24m8rpwhmPIS4zscNzK6MSEhk0DUWa/8iYQWxhffV8jkI4Phvs3F+quL5xvS0gdQR0FyTCMMH33Y78dDTzzIw=="],

    "long": ["long@4.0.0", "", {}, "sha512-XsP+KhQif4bjX1kbuSiySJFNAehNxgLb6hPRGJ9QsUr8ajHkuXGdrHmFUTUUXhDwVX2R5bY4JNZEwbUiMhV+MA=="],

    "lru-cache": ["lru-cache@5.1.1", "", { "dependencies": { "yallist": "^3.0.2" } }, "sha512-KpNARQA3Iwv+jTA0utUVVbrh+Jlrr1Fv0e56GGzAFOXN7dk/FviaDW8LHmK52DlcH4WP2n6gI8vN1aesBFgo9w=="],

    "lucide-react": ["lucide-react@0.552.0", "", { "peerDependencies": { "react": "^16.5.1 || ^17.0.0 || ^18.0.0 || ^19.0.0" } }, "sha512-g9WCjmfwqbexSnZE+2cl21PCfXOcqnGeWeMTNAOGEfpPbm/ZF4YIq77Z8qWrxbu660EKuLB4nSLggoKnCb+isw=="],

    "magic-string": ["magic-string@0.30.21", "", { "dependencies": { "@jridgewell/sourcemap-codec": "^1.5.5" } }, "sha512-vd2F4YUyEXKGcLHoq+TEyCjxueSeHnFxyyjNp80yg0XV4vUhnDer/lvvlqM/arB5bXQN5K2/3oinyCRyx8T2CQ=="],

    "magika": ["magika@1.0.0", "", { "dependencies": { "@tensorflow/tfjs": "^4.22.0" }, "optionalDependencies": { "@tensorflow/tfjs-node": "^4.22.0", "chalk": "^5.3.0", "commander": "^13.1.0" }, "bin": { "magika-js": "dist/cjs/magika-cli.js" } }, "sha512-s4pEu6yg2oDi3mlAnZCifK/PTJitmZ0GpXqLihP/u2MhEqfcB3OQ1Z7Ip7QqkDA51Mj5uEsFePdyhkBEyZLu+Q=="],

    "make-dir": ["make-dir@3.1.0", "", { "dependencies": { "semver": "^6.0.0" } }, "sha512-g3FeP20LNwhALb/6Cz6Dd4F2ngze0jz7tbzrD2wAV+o9FeNHe4rL+yK2md0J/fiSf1sa1ADhXqi5+oVwOM/eGw=="],

    "marked": ["marked@14.0.0", "", { "bin": { "marked": "bin/marked.js" } }, "sha512-uIj4+faQ+MgHgwUW1l2PsPglZLOLOT1uErt06dAPtx2kjteLAkbsd/0FiYg/MGS+i7ZKLb7w2WClxHkzOOuryQ=="],

    "math-intrinsics": ["math-intrinsics@1.1.0", "", {}, "sha512-/IXtbwEk5HTPyEwyKX6hGkYXxM9nbj64B+ilVJnC/R6B0pH5G4V3b0pVbL7DBj4tkhBAppbQUlf6F6Xl9LHu1g=="],

    "media-typer": ["media-typer@1.1.0", "", {}, "sha512-aisnrDP4GNe06UcKFnV5bfMNPBUw4jsLGaWwWfnH3v02GnBuXX2MCVn5RbrWo0j3pczUilYblq7fQ7Nw2t5XKw=="],

    "merge-descriptors": ["merge-descriptors@2.0.0", "", {}, "sha512-Snk314V5ayFLhp3fkUREub6WtjBfPdCPY1Ln8/8munuLuiYhsABgBVWsozAG+MWMbVEvcdcpbi9R7ww22l9Q3g=="],

    "merge-stream": ["merge-stream@2.0.0", "", {}, "sha512-abv/qOcuPfk3URPfDzmZU1LKmuw8kT+0nIHvKrKgFrwifol/doWcdA4ZqsWQ8ENrFKkd67Mfpo/LovbIUsbt3w=="],

    "merge2": ["merge2@1.4.1", "", {}, "sha512-8q7VEgMJW4J8tcfVPy8g09NcQwZdbwFEqhe/WZkoIzjn/3TGDwtOCYtXGxA3O8tPzpczCCDgv+P2P5y00ZJOOg=="],

    "micromatch": ["micromatch@4.0.8", "", { "dependencies": { "braces": "^3.0.3", "picomatch": "^2.3.1" } }, "sha512-PXwfBhYu0hBCPw8Dn0E+WDYb7af3dSLVWKi3HGv84IdF4TyFoC0ysxFd0Goxw7nSv4T/PzEJQxsYsEiFCKo2BA=="],

    "mime-db": ["mime-db@1.54.0", "", {}, "sha512-aU5EJuIN2WDemCcAp2vFBfp/m4EAhWJnUNSSw0ixs7/kXbd6Pg64EmwJkNdFhB8aWt1sH2CTXrLxo/iAGV3oPQ=="],

    "mime-types": ["mime-types@3.0.1", "", { "dependencies": { "mime-db": "^1.54.0" } }, "sha512-xRc4oEhT6eaBpU1XF7AjpOFD+xQmXNB5OVKwp4tqCuBpHLS/ZbBDrc07mYTDqVMg6PfxUjjNp85O6Cd2Z/5HWA=="],

    "mimic-fn": ["mimic-fn@2.1.0", "", {}, "sha512-OqbOk5oEQeAZ8WXWydlu9HJjz9WVdEIvamMCcXmuqUYjTknH/sqsWvhQ3vgwKFRR1HpjvNBKQ37nbJgYzGqGcg=="],

    "mimic-function": ["mimic-function@5.0.1", "", {}, "sha512-VP79XUPxV2CigYP3jWwAUFSku2aKqBH7uTAapFWCBqutsbmDo96KY5o8uh6U+/YSIn5OxJnXp73beVkpqMIGhA=="],

    "minimatch": ["minimatch@3.1.2", "", { "dependencies": { "brace-expansion": "^1.1.7" } }, "sha512-J7p63hRiAjw1NDEww1W7i37+ByIrOWO5XQQAzZ3VOcL0PNybwpfmV/N05zFAzwQ9USyEcX6t3UO+K5aqBQOIHw=="],

    "minimist": ["minimist@1.2.8", "", {}, "sha512-2yyAR8qBkN3YuheJanUpWC5U3bb5osDywNB8RzDVlDwDHbocAJveqqj1u8+SVD7jkWT4yvsHCpWqqWqAxb0zCA=="],

    "minipass": ["minipass@5.0.0", "", {}, "sha512-3FnjYuehv9k6ovOEbyOswadCDPX1piCfhV8ncmYtHOjuPwylVWsghTLo7rabjC3Rx5xD4HDx8Wm1xnMF7S5qFQ=="],

    "minizlib": ["minizlib@2.1.2", "", { "dependencies": { "minipass": "^3.0.0", "yallist": "^4.0.0" } }, "sha512-bAxsR8BVfj60DWXHE3u30oHzfl4G7khkSuPW+qvpd7jFRHm7dLxOjUk1EHACJ/hxLY8phGJ0YhYHZo7jil7Qdg=="],

    "mkdirp": ["mkdirp@1.0.4", "", { "bin": { "mkdirp": "bin/cmd.js" } }, "sha512-vVqVZQyf3WLx2Shd0qJ9xuvqgAyKPLAiqITEtqW0oIUjzo3PePDd6fW9iFz30ef7Ysp/oiWqbhszeGWW2T6Gzw=="],

    "monaco-editor": ["monaco-editor@0.55.1", "", { "dependencies": { "dompurify": "3.2.7", "marked": "14.0.0" } }, "sha512-jz4x+TJNFHwHtwuV9vA9rMujcZRb0CEilTEwG2rRSpe/A7Jdkuj8xPKttCgOh+v/lkHy7HsZ64oj+q3xoAFl9A=="],

    "ms": ["ms@2.1.3", "", {}, "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA=="],

    "msw": ["msw@2.12.1", "", { "dependencies": { "@inquirer/confirm": "^5.0.0", "@mswjs/interceptors": "^0.40.0", "@open-draft/deferred-promise": "^2.2.0", "@types/statuses": "^2.0.4", "cookie": "^1.0.2", "graphql": "^16.8.1", "headers-polyfill": "^4.0.2", "is-node-process": "^1.2.0", "outvariant": "^1.4.3", "path-to-regexp": "^6.3.0", "picocolors": "^1.1.1", "rettime": "^0.7.0", "statuses": "^2.0.2", "strict-event-emitter": "^0.5.1", "tough-cookie": "^6.0.0", "type-fest": "^4.26.1", "until-async": "^3.0.2", "yargs": "^17.7.2" }, "peerDependencies": { "typescript": ">= 4.8.x" }, "bin": "cli/index.js" }, "sha512-arzsi9IZjjByiEw21gSUP82qHM8zkV69nNpWV6W4z72KiLvsDWoOp678ORV6cNfU/JGhlX0SsnD4oXo9gI6I2A=="],

    "mute-stream": ["mute-stream@3.0.0", "", {}, "sha512-dkEJPVvun4FryqBmZ5KhDo0K9iDXAwn08tMLDinNdRBNPcYEDiWYysLcc6k3mjTMlbP9KyylvRpd4wFtwrT9rw=="],

    "nanoid": ["nanoid@3.3.11", "", { "bin": "bin/nanoid.cjs" }, "sha512-N8SpfPUnUp1bK+PMYW8qSWdl9U+wwNWI4QKxOYDy9JAro3WMX7p2OeVRF9v+347pnakNevPmiHhNmZ2HbFA76w=="],

    "natural-compare": ["natural-compare@1.4.0", "", {}, "sha512-OWND8ei3VtNC9h7V60qff3SVobHr996CTwgxubgyQYEpg290h9J0buyECNNJexkFm5sOajh5G116RYA1c8ZMSw=="],

    "negotiator": ["negotiator@1.0.0", "", {}, "sha512-8Ofs/AUQh8MaEcrlq5xOX0CQ9ypTF5dl78mjlMNfOK08fzpgTHQRQPBxcPlEtIw0yRpws+Zo/3r+5WRby7u3Gg=="],

    "node-domexception": ["node-domexception@1.0.0", "", {}, "sha512-/jKZoMpw0F8GRwl4/eLROPA3cfcXtLApP0QzLmUT/HuPCZWyB7IY9ZrMeKw2O/nFIqPQB3PVM9aYm0F312AXDQ=="],

    "node-fetch": ["node-fetch@3.3.2", "", { "dependencies": { "data-uri-to-buffer": "^4.0.0", "fetch-blob": "^3.1.4", "formdata-polyfill": "^4.0.10" } }, "sha512-dRB78srN/l6gqWulah9SrxeYnxeddIG30+GOqK/9OlLVyLg3HPnr6SqOWTWOXKRwC2eGYCkZ59NNuSgvSrpgOA=="],

    "node-releases": ["node-releases@2.0.27", "", {}, "sha512-nmh3lCkYZ3grZvqcCH+fjmQ7X+H0OeZgP40OierEaAptX4XofMh5kwNbWh7lBduUzCcV/8kZ+NDLCwm2iorIlA=="],

    "nopt": ["nopt@5.0.0", "", { "dependencies": { "abbrev": "1" }, "bin": { "nopt": "bin/nopt.js" } }, "sha512-Tbj67rffqceeLpcRXrT7vKAN8CwfPeIBgM7E6iBkmKLV7bEMwpGgYLGv0jACUsECaa/vuxP0IjEont6umdMgtQ=="],

    "npm-run-path": ["npm-run-path@6.0.0", "", { "dependencies": { "path-key": "^4.0.0", "unicorn-magic": "^0.3.0" } }, "sha512-9qny7Z9DsQU8Ou39ERsPU4OZQlSTP47ShQzuKZ6PRXpYLtIFgl/DEBYEXKlvcEa+9tHVcK8CF81Y2V72qaZhWA=="],

    "npmlog": ["npmlog@5.0.1", "", { "dependencies": { "are-we-there-yet": "^2.0.0", "console-control-strings": "^1.1.0", "gauge": "^3.0.0", "set-blocking": "^2.0.0" } }, "sha512-AqZtDUWOMKs1G/8lwylVjrdYgqA4d9nu8hc+0gzRxlDb1I10+FHBGMXs6aiQHFdCUUlqH99MUMuLfzWDNDtfxw=="],

    "object-assign": ["object-assign@4.1.1", "", {}, "sha512-rJgTQnkUnH1sFw8yT6VSU3zD3sWmu6sZhIseY8VX+GRu3P6F7Fu+JNDoXfklElbLJSnc3FUQHVe4cU5hj+BcUg=="],

    "object-inspect": ["object-inspect@1.13.4", "", {}, "sha512-W67iLl4J2EXEGTbfeHCffrjDfitvLANg0UlX3wFUUSTx92KXRFegMHUVgSqE+wvhAbi4WqjGg9czysTV2Epbew=="],

    "object-treeify": ["object-treeify@1.1.33", "", {}, "sha512-EFVjAYfzWqWsBMRHPMAXLCDIJnpMhdWAqR7xG6M6a2cs6PMFpl/+Z20w9zDW4vkxOFfddegBKq9Rehd0bxWE7A=="],

    "on-finished": ["on-finished@2.4.1", "", { "dependencies": { "ee-first": "1.1.1" } }, "sha512-oVlzkg3ENAhCk2zdv7IJwd/QUD4z2RxRwpkcGY8psCVcCYZNq4wYnVWALHM+brtuJjePWiYF/ClmuDr8Ch5+kg=="],

    "once": ["once@1.4.0", "", { "dependencies": { "wrappy": "1" } }, "sha512-lNaJgI+2Q5URQBkccEKHTQOPaXdUxnZZElQTZY0MFUAuaEqe1E+Nyvgdz/aIyNi6Z9MzO5dv1H8n58/GELp3+w=="],

    "onetime": ["onetime@5.1.2", "", { "dependencies": { "mimic-fn": "^2.1.0" } }, "sha512-kbpaSSGJTWdAY5KPVeMOKXSrPtr8C8C7wodJbcsd51jRnmD+GZu8Y0VoU6Dm5Z4vWr0Ig/1NKuWRKf7j5aaYSg=="],

    "optionator": ["optionator@0.9.4", "", { "dependencies": { "deep-is": "^0.1.3", "fast-levenshtein": "^2.0.6", "levn": "^0.4.1", "prelude-ls": "^1.2.1", "type-check": "^0.4.0", "word-wrap": "^1.2.5" } }, "sha512-6IpQ7mKUxRcZNLIObR0hz7lxsapSSIYNZJwXPGeF0mTVqGKFIXj1DQcMoT22S3ROcLyY/rz0PWaWZ9ayWmad9g=="],

    "ora": ["ora@8.2.0", "", { "dependencies": { "chalk": "^5.3.0", "cli-cursor": "^5.0.0", "cli-spinners": "^2.9.2", "is-interactive": "^2.0.0", "is-unicode-supported": "^2.0.0", "log-symbols": "^6.0.0", "stdin-discarder": "^0.2.2", "string-width": "^7.2.0", "strip-ansi": "^7.1.0" } }, "sha512-weP+BZ8MVNnlCm8c0Qdc1WSWq4Qn7I+9CJGm7Qali6g44e/PUzbjNqJX5NJ9ljlNMosfJvg1fKEGILklK9cwnw=="],

    "outvariant": ["outvariant@1.4.3", "", {}, "sha512-+Sl2UErvtsoajRDKCE5/dBz4DIvHXQQnAxtQTF04OJxY0+DyZXSo5P5Bb7XYWOh81syohlYL24hbDwxedPUJCA=="],

    "p-limit": ["p-limit@3.1.0", "", { "dependencies": { "yocto-queue": "^0.1.0" } }, "sha512-TYOanM3wGwNGsZN2cVTYPArw454xnXj5qmWF1bEoAc4+cU/ol7GVh7odevjp1FNHduHc3KZMcFduxU5Xc6uJRQ=="],

    "p-locate": ["p-locate@5.0.0", "", { "dependencies": { "p-limit": "^3.0.2" } }, "sha512-LaNjtRWUBY++zB5nE/NwcaoMylSPk+S+ZHNB1TzdbMJMny6dynpAGt7X/tl/QYq3TIeE6nxHppbo2LGymrG5Pw=="],

    "package-manager-detector": ["package-manager-detector@1.5.0", "", {}, "sha512-uBj69dVlYe/+wxj8JOpr97XfsxH/eumMt6HqjNTmJDf/6NO9s+0uxeOneIz3AsPt2m6y9PqzDzd3ATcU17MNfw=="],

    "parent-module": ["parent-module@1.0.1", "", { "dependencies": { "callsites": "^3.0.0" } }, "sha512-GQ2EWRpQV8/o+Aw8YqtfZZPfNRWZYkbidE9k5rpl/hC3vtHHBfGm2Ifi6qWV+coDGkrUKZAxE3Lot5kcsRlh+g=="],

    "parse-json": ["parse-json@5.2.0", "", { "dependencies": { "@babel/code-frame": "^7.0.0", "error-ex": "^1.3.1", "json-parse-even-better-errors": "^2.3.0", "lines-and-columns": "^1.1.6" } }, "sha512-ayCKvm/phCGxOkYRSCM82iDwct8/EonSEgCSxWxD7ve6jHggsFl4fZVQBPRNgQoKiuV/odhFrGzQXZwbifC8Rg=="],

    "parse-ms": ["parse-ms@4.0.0", "", {}, "sha512-TXfryirbmq34y8QBwgqCVLi+8oA3oWx2eAnSn62ITyEhEYaWRlVZ2DvMM9eZbMs/RfxPu/PK/aBLyGj4IrqMHw=="],

    "parseurl": ["parseurl@1.3.3", "", {}, "sha512-CiyeOxFT/JZyN5m0z9PfXw4SCBJ6Sygz1Dpl0wqjlhDEGGBP1GnsUVEL0p63hoG1fcj3fHynXi9NYO4nWOL+qQ=="],

    "path-browserify": ["path-browserify@1.0.1", "", {}, "sha512-b7uo2UCUOYZcnF/3ID0lulOJi/bafxa1xPe7ZPsammBSpjSWQkjNxlt635YGS2MiR9GjvuXCtz2emr3jbsz98g=="],

    "path-exists": ["path-exists@4.0.0", "", {}, "sha512-ak9Qy5Q7jYb2Wwcey5Fpvg2KoAc/ZIhLSLOSBmRmygPsGwkVVt0fZa0qrtMz+m6tJTAHfZQ8FnmB4MG4LWy7/w=="],

    "path-is-absolute": ["path-is-absolute@1.0.1", "", {}, "sha512-AVbw3UJ2e9bq64vSaS9Am0fje1Pa8pbGqTTsmXfaIiMpnr5DlDhfJOuLj9Sf95ZPVDAUerDfEk88MPmPe7UCQg=="],

    "path-key": ["path-key@3.1.1", "", {}, "sha512-ojmeN0qd+y0jszEtoY48r0Peq5dwMEkIlCOu6Q5f41lfkswXuKtYrhgoTpLnyIcHm24Uhqx+5Tqm2InSwLhE6Q=="],

    "path-to-regexp": ["path-to-regexp@6.3.0", "", {}, "sha512-Yhpw4T9C6hPpgPeA28us07OJeqZ5EzQTkbfwuhsUg0c237RomFoETJgmp2sa3F/41gfLE6G5cqcYwznmeEeOlQ=="],

    "picocolors": ["picocolors@1.1.1", "", {}, "sha512-xceH2snhtb5M9liqDsmEw56le376mTZkEX/jEb/RxNFyegNul7eNslCXP9FDj/Lcu0X8KEyMceP2ntpaHrDEVA=="],

    "picomatch": ["picomatch@4.0.3", "", {}, "sha512-5gTmgEY/sqK6gFXLIsQNH19lWb4ebPDLA4SdLP7dsWkIXHWlG66oPuVvXSGFPppYZz8ZDZq0dYYrbHfBCVUb1Q=="],

    "pkce-challenge": ["pkce-challenge@5.0.0", "", {}, "sha512-ueGLflrrnvwB3xuo/uGob5pd5FN7l0MsLf0Z87o/UQmRtwjvfylfc9MurIxRAWywCYTgrvpXBcqjV4OfCYGCIQ=="],

    "postcss": ["postcss@8.5.6", "", { "dependencies": { "nanoid": "^3.3.11", "picocolors": "^1.1.1", "source-map-js": "^1.2.1" } }, "sha512-3Ybi1tAuwAP9s0r1UQ2J4n5Y0G05bJkpUIO0/bI9MhwmD70S5aTWbXGBwxHrelT+XM1k6dM0pk+SwNkpTRN7Pg=="],

    "prelude-ls": ["prelude-ls@1.2.1", "", {}, "sha512-vkcDPrRZo1QZLbn5RLGPpg/WmIQ65qoWWhcGKf/b5eplkkarX0m9z8ppCat4mlOqUsWpyNuYgO3VRyrYHSzX5g=="],

    "pretty-ms": ["pretty-ms@9.3.0", "", { "dependencies": { "parse-ms": "^4.0.0" } }, "sha512-gjVS5hOP+M3wMm5nmNOucbIrqudzs9v/57bWRHQWLYklXqoXKrVfYW2W9+glfGsqtPgpiz5WwyEEB+ksXIx3gQ=="],

    "progress": ["progress@2.0.3", "", {}, "sha512-7PiHtLll5LdnKIMw100I+8xJXR5gW2QwWYkT6iJva0bXitZKa/XMrSbdmg3r2Xnaidz9Qumd0VPaMrZlF9V9sA=="],

    "prompts": ["prompts@2.4.2", "", { "dependencies": { "kleur": "^3.0.3", "sisteransi": "^1.0.5" } }, "sha512-NxNv/kLguCA7p3jE8oL2aEBsrJWgAakBpgmgK6lpPWV+WuOmY6r2/zbAVnP+T8bQlA0nzHXSJSJW0Hq7ylaD2Q=="],

    "proxy-addr": ["proxy-addr@2.0.7", "", { "dependencies": { "forwarded": "0.2.0", "ipaddr.js": "1.9.1" } }, "sha512-llQsMLSUDUPT44jdrU/O37qlnifitDP+ZwrmmZcoSKyLKvtZxpyV0n2/bD/N4tBAAZ/gJEdZU7KMraoK1+XYAg=="],

    "punycode": ["punycode@2.3.1", "", {}, "sha512-vYt7UD1U9Wg6138shLtLOvdAu+8DsC/ilFtEVHcH+wydcSpNE20AfSOduf6MkRFahL5FY7X1oU7nKVZFtfq8Fg=="],

    "qs": ["qs@6.14.0", "", { "dependencies": { "side-channel": "^1.1.0" } }, "sha512-YWWTjgABSKcvs/nWBi9PycY/JiPJqOD4JA6o9Sej2AtvSGarXxKC3OQSk4pAarbdQlKAh5D4FCQkJNkW+GAn3w=="],

    "queue-microtask": ["queue-microtask@1.2.3", "", {}, "sha512-NuaNSa6flKT5JaSYQzJok04JzTL1CA6aGhv5rfLW3PgqA+M2ChpZQnAC8h8i4ZFkBS8X5RqkDBHA7r4hej3K9A=="],

    "range-parser": ["range-parser@1.2.1", "", {}, "sha512-Hrgsx+orqoygnmhFbKaHE6c296J+HTAQXoxEF6gNupROmmGJRoyzfG3ccAveqCBrwr/2yxQ5BVd/GTl5agOwSg=="],

    "raw-body": ["raw-body@3.0.1", "", { "dependencies": { "bytes": "3.1.2", "http-errors": "2.0.0", "iconv-lite": "0.7.0", "unpipe": "1.0.0" } }, "sha512-9G8cA+tuMS75+6G/TzW8OtLzmBDMo8p1JRxN5AZ+LAp8uxGA8V8GZm4GQ4/N5QNQEnLmg6SS7wyuSmbKepiKqA=="],

    "react": ["react@19.2.0", "", {}, "sha512-tmbWg6W31tQLeB5cdIBOicJDJRR2KzXsV7uSK9iNfLWQ5bIZfxuPEHp7M8wiHyHnn0DD1i7w3Zmin0FtkrwoCQ=="],

    "react-day-picker": ["react-day-picker@9.13.2", "", { "dependencies": { "@date-fns/tz": "^1.4.1", "date-fns": "^4.1.0", "date-fns-jalali": "^4.1.0-0" }, "peerDependencies": { "react": ">=16.8.0" } }, "sha512-IMPiXfXVIAuR5Yk58DDPBC8QKClrhdXV+Tr/alBrwrHUw0qDDYB1m5zPNuTnnPIr/gmJ4ChMxmtqPdxm8+R4Eg=="],

    "react-dom": ["react-dom@19.2.0", "", { "dependencies": { "scheduler": "^0.27.0" }, "peerDependencies": { "react": "^19.2.0" } }, "sha512-UlbRu4cAiGaIewkPyiRGJk0imDN2T3JjieT6spoL2UeSf5od4n5LB/mQ4ejmxhCFT1tYe8IvaFulzynWovsEFQ=="],

    "react-i18next": ["react-i18next@16.2.4", "", { "dependencies": { "@babel/runtime": "^7.27.6", "html-parse-stringify": "^3.0.1", "use-sync-external-store": "^1.6.0" }, "peerDependencies": { "i18next": ">= 25.5.2", "react": ">= 16.8.0", "typescript": "^5" } }, "sha512-pvbcPQ+YuQQoRkKBA4VCU9aO8dOgP/vdKEizIYXcAk3+AmI8yQKSJaCzxQQu4Kgg2zWZm3ax9KqHv8ItUlRY0A=="],

    "react-refresh": ["react-refresh@0.18.0", "", {}, "sha512-QgT5//D3jfjJb6Gsjxv0Slpj23ip+HtOpnNgnb2S5zU3CB26G/IDPGoy4RJB42wzFE46DRsstbW6tKHoKbhAxw=="],

    "react-remove-scroll": ["react-remove-scroll@2.7.1", "", { "dependencies": { "react-remove-scroll-bar": "^2.3.7", "react-style-singleton": "^2.2.3", "tslib": "^2.1.0", "use-callback-ref": "^1.3.3", "use-sidecar": "^1.1.3" }, "peerDependencies": { "@types/react": "*", "react": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0 || ^19.0.0-rc" } }, "sha512-HpMh8+oahmIdOuS5aFKKY6Pyog+FNaZV/XyJOq7b4YFwsFHe5yYfdbIalI4k3vU2nSDql7YskmUseHsRrJqIPA=="],

    "react-remove-scroll-bar": ["react-remove-scroll-bar@2.3.8", "", { "dependencies": { "react-style-singleton": "^2.2.2", "tslib": "^2.0.0" }, "peerDependencies": { "@types/react": "*", "react": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0" } }, "sha512-9r+yi9+mgU33AKcj6IbT9oRCO78WriSj6t/cF8DWBZJ9aOGPOTEDvdUDz1FwKim7QXWwmHqtdHnRJfhAxEG46Q=="],

    "react-resizable-panels": ["react-resizable-panels@4.6.4", "", { "peerDependencies": { "react": "^18.0.0 || ^19.0.0", "react-dom": "^18.0.0 || ^19.0.0" } }, "sha512-E7Szs1xyaMZ7xOI2gG4TECNz4r/gmpV1AsXyZRnER6OQnfFf9uclFmrHHZR3h/iF8vQS+nQ1LKyZv9bzwGxPSg=="],

    "react-router": ["react-router@7.9.5", "", { "dependencies": { "cookie": "^1.0.1", "set-cookie-parser": "^2.6.0" }, "peerDependencies": { "react": ">=18", "react-dom": ">=18" } }, "sha512-JmxqrnBZ6E9hWmf02jzNn9Jm3UqyeimyiwzD69NjxGySG6lIz/1LVPsoTCwN7NBX2XjCEa1LIX5EMz1j2b6u6A=="],

    "react-style-singleton": ["react-style-singleton@2.2.3", "", { "dependencies": { "get-nonce": "^1.0.0", "tslib": "^2.0.0" }, "peerDependencies": { "@types/react": "*", "react": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0 || ^19.0.0-rc" } }, "sha512-b6jSvxvVnyptAiLjbkWLE/lOnR4lfTtDAl+eUC7RZy+QQWc6wRzIV2CE6xBuMmDxc2qIihtDCZD5NPOFl7fRBQ=="],

    "react-window": ["react-window@2.2.5", "", { "peerDependencies": { "react": "^18.0.0 || ^19.0.0", "react-dom": "^18.0.0 || ^19.0.0" } }, "sha512-6viWvPSZvVuMIe9hrl4IIZoVfO/npiqOb03m4Z9w+VihmVzBbiudUrtUqDpsWdKvd/Ai31TCR25CBcFFAUm28w=="],

    "readable-stream": ["readable-stream@3.6.2", "", { "dependencies": { "inherits": "^2.0.3", "string_decoder": "^1.1.1", "util-deprecate": "^1.0.1" } }, "sha512-9u/sniCrY3D5WdsERHzHE4G2YCXqoG5FTHUiCC4SIbr6XcLZBY05ya9EKjYek9O5xOAwjGq+1JdGBAS7Q9ScoA=="],

    "recast": ["recast@0.23.11", "", { "dependencies": { "ast-types": "^0.16.1", "esprima": "~4.0.0", "source-map": "~0.6.1", "tiny-invariant": "^1.3.3", "tslib": "^2.0.1" } }, "sha512-YTUo+Flmw4ZXiWfQKGcwwc11KnoRAYgzAE2E7mXKCjSviTKShtxBsN6YUUBB2gtaBzKzeKunxhUwNHQuRryhWA=="],

    "regenerator-runtime": ["regenerator-runtime@0.13.11", "", {}, "sha512-kY1AZVr2Ra+t+piVaJ4gxaFaReZVH40AKNo7UCX6W+dEwBo/2oZJzqfuN1qLq1oL45o56cPaTXELwrTh8Fpggg=="],

    "require-directory": ["require-directory@2.1.1", "", {}, "sha512-fGxEI7+wsG9xrvdjsrlmL22OMTTiHRwAMroiEeMgq8gzoLC/PQr7RsRDSTLUg/bZAZtF+TVIkHc6/4RIKrui+Q=="],

    "require-from-string": ["require-from-string@2.0.2", "", {}, "sha512-Xf0nWe6RseziFMu+Ap9biiUbmplq6S9/p+7w7YXP/JBHhrUDDUhwa+vANyubuqfZWTveU//DYVGsDG7RKL/vEw=="],

    "reselect": ["reselect@5.1.1", "", {}, "sha512-K/BG6eIky/SBpzfHZv/dd+9JBFiS4SWV7FIujVyJRux6e45+73RaUHXLmIR1f7WOMaQ0U1km6qwklRQxpJJY0w=="],

    "resolve-from": ["resolve-from@4.0.0", "", {}, "sha512-pb/MYmXstAkysRFx8piNI1tGFNQIFA3vkE3Gq4EuA1dF6gHp/+vgZqsCGJapvy8N3Q+4o7FwvquPJcnZ7RYy4g=="],

    "restore-cursor": ["restore-cursor@5.1.0", "", { "dependencies": { "onetime": "^7.0.0", "signal-exit": "^4.1.0" } }, "sha512-oMA2dcrw6u0YfxJQXm342bFKX/E4sG9rbTzO9ptUcR/e8A33cHuvStiYOwH7fszkZlZ1z/ta9AAoPk2F4qIOHA=="],

    "rettime": ["rettime@0.7.0", "", {}, "sha512-LPRKoHnLKd/r3dVxcwO7vhCW+orkOGj9ViueosEBK6ie89CijnfRlhaDhHq/3Hxu4CkWQtxwlBG0mzTQY6uQjw=="],

    "reusify": ["reusify@1.1.0", "", {}, "sha512-g6QUff04oZpHs0eG5p83rFLhHeV00ug/Yf9nZM6fLeUrPguBTkTQOdpAWWspMh55TZfVQDPaN3NQJfbVRAxdIw=="],

    "rimraf": ["rimraf@2.7.1", "", { "dependencies": { "glob": "^7.1.3" }, "bin": { "rimraf": "./bin.js" } }, "sha512-uWjbaKIK3T1OSVptzX7Nl6PvQ3qAGtKEtVRjRuazjfL3Bx5eI409VZSqgND+4UNnmzLVdPj9FqFJNPqBZFve4w=="],

    "rolldown": ["rolldown@1.0.0-beta.41", "", { "dependencies": { "@oxc-project/types": "=0.93.0", "@rolldown/pluginutils": "1.0.0-beta.41", "ansis": "=4.2.0" }, "optionalDependencies": { "@rolldown/binding-android-arm64": "1.0.0-beta.41", "@rolldown/binding-darwin-arm64": "1.0.0-beta.41", "@rolldown/binding-darwin-x64": "1.0.0-beta.41", "@rolldown/binding-freebsd-x64": "1.0.0-beta.41", "@rolldown/binding-linux-arm-gnueabihf": "1.0.0-beta.41", "@rolldown/binding-linux-arm64-gnu": "1.0.0-beta.41", "@rolldown/binding-linux-arm64-musl": "1.0.0-beta.41", "@rolldown/binding-linux-x64-gnu": "1.0.0-beta.41", "@rolldown/binding-linux-x64-musl": "1.0.0-beta.41", "@rolldown/binding-openharmony-arm64": "1.0.0-beta.41", "@rolldown/binding-wasm32-wasi": "1.0.0-beta.41", "@rolldown/binding-win32-arm64-msvc": "1.0.0-beta.41", "@rolldown/binding-win32-ia32-msvc": "1.0.0-beta.41", "@rolldown/binding-win32-x64-msvc": "1.0.0-beta.41" }, "bin": "bin/cli.mjs" }, "sha512-U+NPR0Bkg3wm61dteD2L4nAM1U9dtaqVrpDXwC36IKRHpEO/Ubpid4Nijpa2imPchcVNHfxVFwSSMJdwdGFUbg=="],

    "router": ["router@2.2.0", "", { "dependencies": { "debug": "^4.4.0", "depd": "^2.0.0", "is-promise": "^4.0.0", "parseurl": "^1.3.3", "path-to-regexp": "^8.0.0" } }, "sha512-nLTrUKm2UyiL7rlhapu/Zl45FwNgkZGaCpZbIHajDYgwlJCOzLSk+cIPAnsEqV955GjILJnKbdQC1nVPz+gAYQ=="],

    "run-parallel": ["run-parallel@1.2.0", "", { "dependencies": { "queue-microtask": "^1.2.2" } }, "sha512-5l4VyZR86LZ/lDxZTR6jqL8AFE2S0IFLMP26AbjsLVADxHdhB/c0GUsH+y39UfCi3dzz8OlQuPmnaJOMoDHQBA=="],

    "safe-buffer": ["safe-buffer@5.2.1", "", {}, "sha512-rp3So07KcdmmKbGvgaNxQSJr7bGVSVk5S9Eq1F+ppbRo70+YeaDxkw5Dd8NPN+GD6bjnYm2VuPuCXmpuYvmCXQ=="],

    "safer-buffer": ["safer-buffer@2.1.2", "", {}, "sha512-YZo3K82SD7Riyi0E1EQPojLz7kpepnSQI9IyPbHHg1XXXevb5dJI7tpyN2ADxGcQbHG7vcyRHk0cbwqcQriUtg=="],

    "scheduler": ["scheduler@0.27.0", "", {}, "sha512-eNv+WrVbKu1f3vbYJT/xtiF5syA5HPIMtf9IgY/nKg0sWqzAUEvqY/xm7OcZc/qafLx/iO9FgOmeSAp4v5ti/Q=="],

    "seedrandom": ["seedrandom@3.0.5", "", {}, "sha512-8OwmbklUNzwezjGInmZ+2clQmExQPvomqjL7LFqOYqtmuxRgQYqOD3mHaU+MvZn5FLUeVxVfQjwLZW/n/JFuqg=="],

    "semver": ["semver@6.3.1", "", { "bin": "bin/semver.js" }, "sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA=="],

    "send": ["send@1.2.0", "", { "dependencies": { "debug": "^4.3.5", "encodeurl": "^2.0.0", "escape-html": "^1.0.3", "etag": "^1.8.1", "fresh": "^2.0.0", "http-errors": "^2.0.0", "mime-types": "^3.0.1", "ms": "^2.1.3", "on-finished": "^2.4.1", "range-parser": "^1.2.1", "statuses": "^2.0.1" } }, "sha512-uaW0WwXKpL9blXE2o0bRhoL2EGXIrZxQ2ZQ4mgcfoBxdFmQold+qWsD2jLrfZ0trjKL6vOw0j//eAwcALFjKSw=="],

    "serve-static": ["serve-static@2.2.0", "", { "dependencies": { "encodeurl": "^2.0.0", "escape-html": "^1.0.3", "parseurl": "^1.3.3", "send": "^1.2.0" } }, "sha512-61g9pCh0Vnh7IutZjtLGGpTA355+OPn2TyDv/6ivP2h/AdAVX9azsoxmg2/M6nZeQZNYBEwIcsne1mJd9oQItQ=="],

    "set-blocking": ["set-blocking@2.0.0", "", {}, "sha512-KiKBS8AnWGEyLzofFfmvKwpdPzqiy16LvQfK3yv/fVH7Bj13/wl3JSR1J+rfgRE9q7xUJK4qvgS8raSOeLUehw=="],

    "set-cookie-parser": ["set-cookie-parser@2.7.2", "", {}, "sha512-oeM1lpU/UvhTxw+g3cIfxXHyJRc/uidd3yK1P242gzHds0udQBYzs3y8j4gCCW+ZJ7ad0yctld8RYO+bdurlvw=="],

    "setprototypeof": ["setprototypeof@1.2.0", "", {}, "sha512-E5LDX7Wrp85Kil5bhZv46j8jOeboKq5JMmYM3gVGdGH8xFpPWXUMsNrlODCrkoxMEeNi/XZIwuRvY4XNwYMJpw=="],

    "shadcn": ["shadcn@3.5.0", "", { "dependencies": { "@antfu/ni": "^25.0.0", "@babel/core": "^7.28.0", "@babel/parser": "^7.28.0", "@babel/plugin-transform-typescript": "^7.28.0", "@babel/preset-typescript": "^7.27.1", "@dotenvx/dotenvx": "^1.48.4", "@modelcontextprotocol/sdk": "^1.17.2", "browserslist": "^4.26.2", "commander": "^14.0.0", "cosmiconfig": "^9.0.0", "dedent": "^1.6.0", "deepmerge": "^4.3.1", "diff": "^8.0.2", "execa": "^9.6.0", "fast-glob": "^3.3.3", "fs-extra": "^11.3.1", "fuzzysort": "^3.1.0", "https-proxy-agent": "^7.0.6", "kleur": "^4.1.5", "msw": "^2.10.4", "node-fetch": "^3.3.2", "ora": "^8.2.0", "postcss": "^8.5.6", "prompts": "^2.4.2", "recast": "^0.23.11", "stringify-object": "^5.0.0", "ts-morph": "^26.0.0", "tsconfig-paths": "^4.2.0", "zod": "^3.24.1", "zod-to-json-schema": "^3.24.6" }, "bin": "dist/index.js" }, "sha512-5f9tn7gHOiI8CqJ8LGrUEmX6dOivGgSbHkMCeOMCzxHZy9cPwyuRXt7ZyjwukO8QH9kGqi6oiKOpfvTXNGBP4g=="],

    "shebang-command": ["shebang-command@2.0.0", "", { "dependencies": { "shebang-regex": "^3.0.0" } }, "sha512-kHxr2zZpYtdmrN1qDjrrX/Z1rR1kG8Dx+gkpK1G4eXmvXswmcE1hTWBWYUzlraYw1/yZp6YuDY77YtvbN0dmDA=="],

    "shebang-regex": ["shebang-regex@3.0.0", "", {}, "sha512-7++dFhtcx3353uBaq8DDR4NuxBetBzC7ZQOhmTQInHEd6bSrXdiEyzCvG07Z44UYdLShWUyXt5M/yhz8ekcb1A=="],

    "side-channel": ["side-channel@1.1.0", "", { "dependencies": { "es-errors": "^1.3.0", "object-inspect": "^1.13.3", "side-channel-list": "^1.0.0", "side-channel-map": "^1.0.1", "side-channel-weakmap": "^1.0.2" } }, "sha512-ZX99e6tRweoUXqR+VBrslhda51Nh5MTQwou5tnUDgbtyM0dBgmhEDtWGP/xbKn6hqfPRHujUNwz5fy/wbbhnpw=="],

    "side-channel-list": ["side-channel-list@1.0.0", "", { "dependencies": { "es-errors": "^1.3.0", "object-inspect": "^1.13.3" } }, "sha512-FCLHtRD/gnpCiCHEiJLOwdmFP+wzCmDEkc9y7NsYxeF4u7Btsn1ZuwgwJGxImImHicJArLP4R0yX4c2KCrMrTA=="],

    "side-channel-map": ["side-channel-map@1.0.1", "", { "dependencies": { "call-bound": "^1.0.2", "es-errors": "^1.3.0", "get-intrinsic": "^1.2.5", "object-inspect": "^1.13.3" } }, "sha512-VCjCNfgMsby3tTdo02nbjtM/ewra6jPHmpThenkTYh8pG9ucZ/1P8So4u4FGBek/BjpOVsDCMoLA/iuBKIFXRA=="],

    "side-channel-weakmap": ["side-channel-weakmap@1.0.2", "", { "dependencies": { "call-bound": "^1.0.2", "es-errors": "^1.3.0", "get-intrinsic": "^1.2.5", "object-inspect": "^1.13.3", "side-channel-map": "^1.0.1" } }, "sha512-WPS/HvHQTYnHisLo9McqBHOJk2FkHO/tlpvldyrnem4aeQp4hai3gythswg6p01oSoTl58rcpiFAjF2br2Ak2A=="],

    "signal-exit": ["signal-exit@4.1.0", "", {}, "sha512-bzyZ1e88w9O1iNJbKnOlvYTrWPDl46O1bG0D3XInv+9tkPrxrN8jUUTiFlDkkmKWgn1M6CfIA13SuGqOa9Korw=="],

    "sisteransi": ["sisteransi@1.0.5", "", {}, "sha512-bLGGlR1QxBcynn2d5YmDX4MGjlZvy2MRBDRNHLJ8VI6l6+9FUiyTFNJ0IveOSP0bcXgVDPRcfGqA0pjaqUpfVg=="],

    "socket.io-client": ["socket.io-client@4.8.1", "", { "dependencies": { "@socket.io/component-emitter": "~3.1.0", "debug": "~4.3.2", "engine.io-client": "~6.6.1", "socket.io-parser": "~4.2.4" } }, "sha512-hJVXfu3E28NmzGk8o1sHhN3om52tRvwYeidbj7xKy2eIIse5IoKX3USlS6Tqt3BHAtflLIkCQBkzVrEEfWUyYQ=="],

    "socket.io-parser": ["socket.io-parser@4.2.4", "", { "dependencies": { "@socket.io/component-emitter": "~3.1.0", "debug": "~4.3.1" } }, "sha512-/GbIKmo8ioc+NIWIhwdecY0ge+qVBSMdgxGygevmdHj24bsfgtCmcUUcQ5ZzcylGFHsN3k4HB4Cgkl96KVnuew=="],

    "sonner": ["sonner@2.0.7", "", { "peerDependencies": { "react": "^18.0.0 || ^19.0.0 || ^19.0.0-rc", "react-dom": "^18.0.0 || ^19.0.0 || ^19.0.0-rc" } }, "sha512-W6ZN4p58k8aDKA4XPcx2hpIQXBRAgyiWVkYhT7CvK6D3iAu7xjvVyhQHg2/iaKJZ1XVJ4r7XuwGL+WGEK37i9w=="],

    "source-map": ["source-map@0.6.1", "", {}, "sha512-UjgapumWlbMhkBgzT7Ykc5YXUT46F0iKu8SGXq0bcwP5dz/h0Plj6enJqjz1Zbq2l5WaqYnrVbwWOWMyF3F47g=="],

    "source-map-js": ["source-map-js@1.2.1", "", {}, "sha512-UXWMKhLOwVKb728IUtQPXxfYU+usdybtUrK/8uGE8CQMvrhOpwvzDBwj0QhSL7MQc7vIsISBG8VQ8+IDQxpfQA=="],

    "sprintf-js": ["sprintf-js@1.0.3", "", {}, "sha512-D9cPgkvLlV3t3IzL0D0YLvGA9Ahk4PcvVwUbN0dSGr1aP0Nrt4AEnTUbuGvquEC0mA64Gqt1fzirlRs5ibXx8g=="],

    "state-local": ["state-local@1.0.7", "", {}, "sha512-HTEHMNieakEnoe33shBYcZ7NX83ACUjCu8c40iOGEZsngj9zRnkqS9j1pqQPXwobB0ZcVTk27REb7COQ0UR59w=="],

    "statuses": ["statuses@2.0.2", "", {}, "sha512-DvEy55V3DB7uknRo+4iOGT5fP1slR8wQohVdknigZPMpMstaKJQWhwiYBACJE3Ul2pTnATihhBYnRhZQHGBiRw=="],

    "stdin-discarder": ["stdin-discarder@0.2.2", "", {}, "sha512-UhDfHmA92YAlNnCfhmq0VeNL5bDbiZGg7sZ2IvPsXubGkiNa9EC+tUTsjBRsYUAz87btI6/1wf4XoVvQ3uRnmQ=="],

    "strict-event-emitter": ["strict-event-emitter@0.5.1", "", {}, "sha512-vMgjE/GGEPEFnhFub6pa4FmJBRBVOLpIII2hvCZ8Kzb7K0hlHo7mQv6xYrBvCL2LtAIBwFUK8wvuJgTVSQ5MFQ=="],

    "string-width": ["string-width@7.2.0", "", { "dependencies": { "emoji-regex": "^10.3.0", "get-east-asian-width": "^1.0.0", "strip-ansi": "^7.1.0" } }, "sha512-tsaTIkKW9b4N+AEj+SVA+WhJzV7/zMhcSu78mLKWSk7cXMOSHsBKFWUs0fWwq8QyK3MgJBQRX6Gbi4kYbdvGkQ=="],

    "string_decoder": ["string_decoder@1.3.0", "", { "dependencies": { "safe-buffer": "~5.2.0" } }, "sha512-hkRX8U1WjJFd8LsDJ2yQ/wWWxaopEsABU1XfkM8A+j0+85JAGppt16cr1Whg6KIbb4okU6Mql6BOj+uup/wKeA=="],

    "stringify-object": ["stringify-object@5.0.0", "", { "dependencies": { "get-own-enumerable-keys": "^1.0.0", "is-obj": "^3.0.0", "is-regexp": "^3.1.0" } }, "sha512-zaJYxz2FtcMb4f+g60KsRNFOpVMUyuJgA51Zi5Z1DOTC3S59+OQiVOzE9GZt0x72uBGWKsQIuBKeF9iusmKFsg=="],

    "strip-ansi": ["strip-ansi@7.1.2", "", { "dependencies": { "ansi-regex": "^6.0.1" } }, "sha512-gmBGslpoQJtgnMAvOVqGZpEz9dyoKTCzy2nfz/n8aIFhN/jCE/rCmcxabB6jOOHV+0WNnylOxaxBQPSvcWklhA=="],

    "strip-bom": ["strip-bom@3.0.0", "", {}, "sha512-vavAMRXOgBVNF6nyEEmL3DBK19iRpDcoIwW+swQ+CbGiu7lju6t+JklA1MHweoWtadgt4ISVUsXLyDq34ddcwA=="],

    "strip-final-newline": ["strip-final-newline@4.0.0", "", {}, "sha512-aulFJcD6YK8V1G7iRB5tigAP4TsHBZZrOV8pjV++zdUwmeV8uzbY7yn6h9MswN62adStNZFuCIx4haBnRuMDaw=="],

    "strip-json-comments": ["strip-json-comments@3.1.1", "", {}, "sha512-6fPc+R4ihwqP6N/aIv2f1gMH8lOVtWQHoqC4yK6oSDVVocumAsfCqjkXnqiYMhmMwS/mEHLp7Vehlt3ql6lEig=="],

    "supports-color": ["supports-color@7.2.0", "", { "dependencies": { "has-flag": "^4.0.0" } }, "sha512-qpCAvRl9stuOHveKsn7HncJRvv501qIacKzQlO/+Lwxc9+0q2wLyv4Dfvt80/DPn2pqOBsJdDiogXGR9+OvwRw=="],

    "tabbable": ["tabbable@6.4.0", "", {}, "sha512-05PUHKSNE8ou2dwIxTngl4EzcnsCDZGJ/iCLtDflR/SHB/ny14rXc+qU5P4mG9JkusiV7EivzY9Mhm55AzAvCg=="],

    "tailwind-merge": ["tailwind-merge@3.4.0", "", {}, "sha512-uSaO4gnW+b3Y2aWoWfFpX62vn2sR3skfhbjsEnaBI81WD1wBLlHZe5sWf0AqjksNdYTbGBEd0UasQMT3SNV15g=="],

    "tailwindcss": ["tailwindcss@4.1.17", "", {}, "sha512-j9Ee2YjuQqYT9bbRTfTZht9W/ytp5H+jJpZKiYdP/bpnXARAuELt9ofP0lPnmHjbga7SNQIxdTAXCmtKVYjN+Q=="],

    "tapable": ["tapable@2.3.0", "", {}, "sha512-g9ljZiwki/LfxmQADO3dEY1CbpmXT5Hm2fJ+QaGKwSXUylMybePR7/67YW7jOrrvjEgL1Fmz5kzyAjWVWLlucg=="],

    "tar": ["tar@6.2.1", "", { "dependencies": { "chownr": "^2.0.0", "fs-minipass": "^2.0.0", "minipass": "^5.0.0", "minizlib": "^2.1.1", "mkdirp": "^1.0.3", "yallist": "^4.0.0" } }, "sha512-DZ4yORTwrbTj/7MZYq2w+/ZFdI6OZ/f9SFHR+71gIVUZhOQPHzVCLpvRnPgyaMpfWxxk/4ONva3GQSyNIKRv6A=="],

    "tiny-invariant": ["tiny-invariant@1.3.3", "", {}, "sha512-+FbBPE1o9QAYvviau/qC5SE3caw21q3xkvWKBtja5vgqOWIHHJ3ioaq1VPfn/Szqctz2bU/oYeKd9/z5BL+PVg=="],

    "tinyexec": ["tinyexec@1.0.2", "", {}, "sha512-W/KYk+NFhkmsYpuHq5JykngiOCnxeVL8v8dFnqxSD8qEEdRfXk1SDM6JzNqcERbcGYj9tMrDQBYV9cjgnunFIg=="],

    "tinyglobby": ["tinyglobby@0.2.15", "", { "dependencies": { "fdir": "^6.5.0", "picomatch": "^4.0.3" } }, "sha512-j2Zq4NyQYG5XMST4cbs02Ak8iJUdxRM0XI5QyxXuZOzKOINmWurp3smXu3y5wDcJrptwpSjgXHzIQxR0omXljQ=="],

    "tldts": ["tldts@7.0.17", "", { "dependencies": { "tldts-core": "^7.0.17" }, "bin": "bin/cli.js" }, "sha512-Y1KQBgDd/NUc+LfOtKS6mNsC9CCaH+m2P1RoIZy7RAPo3C3/t8X45+zgut31cRZtZ3xKPjfn3TkGTrctC2TQIQ=="],

    "tldts-core": ["tldts-core@7.0.17", "", {}, "sha512-DieYoGrP78PWKsrXr8MZwtQ7GLCUeLxihtjC1jZsW1DnvSMdKPitJSe8OSYDM2u5H6g3kWJZpePqkp43TfLh0g=="],

    "to-regex-range": ["to-regex-range@5.0.1", "", { "dependencies": { "is-number": "^7.0.0" } }, "sha512-65P7iz6X5yEr1cwcgvQxbbIw7Uk3gOy5dIdtZ4rDveLqhrdJP+Li/Hx6tyK0NEb+2GCyneCMJiGqrADCSNk8sQ=="],

    "toidentifier": ["toidentifier@1.0.1", "", {}, "sha512-o5sSPKEkg/DIQNmH43V0/uerLrpzVedkUh8tGNvaeXpfpuwjKenlSox/2O/BTlZUtEe+JG7s5YhEz608PlAHRA=="],

    "tough-cookie": ["tough-cookie@6.0.0", "", { "dependencies": { "tldts": "^7.0.5" } }, "sha512-kXuRi1mtaKMrsLUxz3sQYvVl37B0Ns6MzfrtV5DvJceE9bPyspOqk9xxv7XbZWcfLWbFmm997vl83qUWVJA64w=="],

    "tr46": ["tr46@0.0.3", "", {}, "sha512-N3WMsuqV66lT30CrXNbEjx4GEwlow3v6rr4mCcv6prnfwhS01rkgyFdjPNBYd9br7LpXV1+Emh01fHnq2Gdgrw=="],

    "ts-api-utils": ["ts-api-utils@2.1.0", "", { "peerDependencies": { "typescript": ">=4.8.4" } }, "sha512-CUgTZL1irw8u29bzrOD/nH85jqyc74D6SshFgujOIA7osm2Rz7dYH77agkx7H4FBNxDq7Cjf+IjaX/8zwFW+ZQ=="],

    "ts-morph": ["ts-morph@26.0.0", "", { "dependencies": { "@ts-morph/common": "~0.27.0", "code-block-writer": "^13.0.3" } }, "sha512-ztMO++owQnz8c/gIENcM9XfCEzgoGphTv+nKpYNM1bgsdOVC/jRZuEBf6N+mLLDNg68Kl+GgUZfOySaRiG1/Ug=="],

    "tsconfig-paths": ["tsconfig-paths@4.2.0", "", { "dependencies": { "json5": "^2.2.2", "minimist": "^1.2.6", "strip-bom": "^3.0.0" } }, "sha512-NoZ4roiN7LnbKn9QqE1amc9DJfzvZXxF4xDavcOWt1BPkdx+m+0gJuPM+S0vCe7zTJMYUP0R8pO2XMr+Y8oLIg=="],

    "tslib": ["tslib@2.8.1", "", {}, "sha512-oJFu94HQb+KVduSUQL7wnpmqnfmLsOA/nAh6b6EH0wCEoK0/mPeXU6c3wKDV83MkOuHPRHtSXKKU99IBazS/2w=="],

    "tw-animate-css": ["tw-animate-css@1.4.0", "", {}, "sha512-7bziOlRqH0hJx80h/3mbicLW7o8qLsH5+RaLR2t+OHM3D0JlWGODQKQ4cxbK7WlvmUxpcj6Kgu6EKqjrGFe3QQ=="],

    "type-check": ["type-check@0.4.0", "", { "dependencies": { "prelude-ls": "^1.2.1" } }, "sha512-XleUoc9uwGXqjWwXaUTZAmzMcFZ5858QA2vvx1Ur5xIcixXIP+8LnFDgRplU30us6teqdlskFfu+ae4K79Ooew=="],

    "type-fest": ["type-fest@4.41.0", "", {}, "sha512-TeTSQ6H5YHvpqVwBRcnLDCBnDOHWYu7IvGbHT6N8AOymcr9PJGjc1GTtiWZTYg0NCgYwvnYWEkVChQAr9bjfwA=="],

    "type-is": ["type-is@2.0.1", "", { "dependencies": { "content-type": "^1.0.5", "media-typer": "^1.1.0", "mime-types": "^3.0.0" } }, "sha512-OZs6gsjF4vMp32qrCbiVSkrFmXtG/AZhY3t0iAMrMBiAZyV9oALtXO8hsrHbMXF9x6L3grlFuwW2oAz7cav+Gw=="],

    "typescript": ["typescript@5.9.3", "", { "bin": { "tsc": "bin/tsc", "tsserver": "bin/tsserver" } }, "sha512-jl1vZzPDinLr9eUt3J/t7V6FgNEw9QjvBPdysz9KfQDD41fQrC2Y4vKQdiaUpFT4bXlb1RHhLpp8wtm6M5TgSw=="],

    "typescript-eslint": ["typescript-eslint@8.46.4", "", { "dependencies": { "@typescript-eslint/eslint-plugin": "8.46.4", "@typescript-eslint/parser": "8.46.4", "@typescript-eslint/typescript-estree": "8.46.4", "@typescript-eslint/utils": "8.46.4" }, "peerDependencies": { "eslint": "^8.57.0 || ^9.0.0", "typescript": ">=4.8.4 <6.0.0" } }, "sha512-KALyxkpYV5Ix7UhvjTwJXZv76VWsHG+NjNlt/z+a17SOQSiOcBdUXdbJdyXi7RPxrBFECtFOiPwUJQusJuCqrg=="],

    "undici-types": ["undici-types@7.16.0", "", {}, "sha512-Zz+aZWSj8LE6zoxD+xrjh4VfkIG8Ya6LvYkZqtUQGJPZjYl53ypCaUwWqo7eI0x66KBGeRo+mlBEkMSeSZ38Nw=="],

    "unicorn-magic": ["unicorn-magic@0.3.0", "", {}, "sha512-+QBBXBCvifc56fsbuxZQ6Sic3wqqc3WWaqxs58gvJrcOuN83HGTCwz3oS5phzU9LthRNE9VrJCFCLUgHeeFnfA=="],

    "universalify": ["universalify@2.0.1", "", {}, "sha512-gptHNQghINnc/vTGIk0SOFGFNXw7JVrlRUtConJRlvaw6DuX0wO5Jeko9sWrMBhh+PsYAZ7oXAiOnf/UKogyiw=="],

    "unpipe": ["unpipe@1.0.0", "", {}, "sha512-pjy2bYhSsufwWlKwPc+l3cN7+wuJlK6uz0YdJEOlQDbl6jo/YlPi4mb8agUkVC8BF7V8NuzeyPNqRksA3hztKQ=="],

    "until-async": ["until-async@3.0.2", "", {}, "sha512-IiSk4HlzAMqTUseHHe3VhIGyuFmN90zMTpD3Z3y8jeQbzLIq500MVM7Jq2vUAnTKAFPJrqwkzr6PoTcPhGcOiw=="],

    "update-browserslist-db": ["update-browserslist-db@1.1.4", "", { "dependencies": { "escalade": "^3.2.0", "picocolors": "^1.1.1" }, "peerDependencies": { "browserslist": ">= 4.21.0" }, "bin": "cli.js" }, "sha512-q0SPT4xyU84saUX+tomz1WLkxUbuaJnR1xWt17M7fJtEJigJeWUNGUqrauFXsHnqev9y9JTRGwk13tFBuKby4A=="],

    "uri-js": ["uri-js@4.4.1", "", { "dependencies": { "punycode": "^2.1.0" } }, "sha512-7rKUyy33Q1yc98pQ1DAmLtwX109F7TIfWlW1Ydo8Wl1ii1SeHieeh0HHfPeL2fMXK6z0s8ecKs9frCuLJvndBg=="],

    "use-callback-ref": ["use-callback-ref@1.3.3", "", { "dependencies": { "tslib": "^2.0.0" }, "peerDependencies": { "@types/react": "*", "react": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0 || ^19.0.0-rc" } }, "sha512-jQL3lRnocaFtu3V00JToYz/4QkNWswxijDaCVNZRiRTO3HQDLsdu1ZtmIUvV4yPp+rvWm5j0y0TG/S61cuijTg=="],

    "use-sidecar": ["use-sidecar@1.1.3", "", { "dependencies": { "detect-node-es": "^1.1.0", "tslib": "^2.0.0" }, "peerDependencies": { "@types/react": "*", "react": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0 || ^19.0.0-rc" } }, "sha512-Fedw0aZvkhynoPYlA5WXrMCAMm+nSWdZt6lzJQ7Ok8S6Q+VsHmHpRWndVRJ8Be0ZbkfPc5LRYH+5XrzXcEeLRQ=="],

    "use-sync-external-store": ["use-sync-external-store@1.6.0", "", { "peerDependencies": { "react": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0" } }, "sha512-Pp6GSwGP/NrPIrxVFAIkOQeyw8lFenOHijQWkUTrDvrF4ALqylP2C/KCkeS9dpUM3KvYRQhna5vt7IL95+ZQ9w=="],

    "util-deprecate": ["util-deprecate@1.0.2", "", {}, "sha512-EPD5q1uXyFxJpCrLnCc1nHnq3gOa6DZBocAIiI2TaSCA7VCJ1UJDMagCzIkXNsUYfD1daK//LTEQ8xiIbrHtcw=="],

    "vary": ["vary@1.1.2", "", {}, "sha512-BNGbWLfd0eUPabhkXUVm0j8uuvREyTh5ovRa/dyow/BqAbZJyC+5fU+IzQOzmAKzYqYRAISoRhdQr3eIZ/PXqg=="],

    "vite": ["rolldown-vite@7.1.14", "", { "dependencies": { "@oxc-project/runtime": "0.92.0", "fdir": "^6.5.0", "lightningcss": "^1.30.1", "picomatch": "^4.0.3", "postcss": "^8.5.6", "rolldown": "1.0.0-beta.41", "tinyglobby": "^0.2.15" }, "optionalDependencies": { "fsevents": "~2.3.3" }, "peerDependencies": { "@types/node": "^20.19.0 || >=22.12.0", "esbuild": "^0.25.0", "jiti": ">=1.21.0", "less": "^4.0.0", "sass": "^1.70.0", "sass-embedded": "^1.70.0", "stylus": ">=0.54.8", "sugarss": "^5.0.0", "terser": "^5.16.0", "tsx": "^4.8.1", "yaml": "^2.4.2" }, "optionalPeers": ["esbuild", "less", "sass", "sass-embedded", "stylus", "sugarss", "terser", "tsx", "yaml"], "bin": { "vite": "bin/vite.js" } }, "sha512-eSiiRJmovt8qDJkGyZuLnbxAOAdie6NCmmd0NkTC0RJI9duiSBTfr8X2mBYJOUFzxQa2USaHmL99J9uMxkjCyw=="],

    "void-elements": ["void-elements@3.1.0", "", {}, "sha512-Dhxzh5HZuiHQhbvTW9AMetFfBHDMYpo23Uo9btPXgdYP+3T5S+p+jgNy7spra+veYhBP2dCSgxR/i2Y02h5/6w=="],

    "web-streams-polyfill": ["web-streams-polyfill@3.3.3", "", {}, "sha512-d2JWLCivmZYTSIoge9MsgFCZrt571BikcWGYkjC1khllbTeDlGqZ2D8vD8E/lJa8WGWbb7Plm8/XJYV7IJHZZw=="],

    "webidl-conversions": ["webidl-conversions@3.0.1", "", {}, "sha512-2JAn3z8AR6rjK8Sm8orRC0h/bcl/DqL7tRPdGZ4I1CjdF+EaMLmYxBHyXuKL849eucPFhvBoxMsflfOb8kxaeQ=="],

    "whatwg-url": ["whatwg-url@5.0.0", "", { "dependencies": { "tr46": "~0.0.3", "webidl-conversions": "^3.0.0" } }, "sha512-saE57nupxk6v3HY35+jzBwYa0rKSy0XR8JSxZPwgLr7ys0IBzhGviA1/TUGJLmSVqs8pb9AnvICXEuOHLprYTw=="],

    "which": ["which@2.0.2", "", { "dependencies": { "isexe": "^2.0.0" }, "bin": { "node-which": "bin/node-which" } }, "sha512-BLI3Tl1TW3Pvl70l3yq3Y64i+awpwXqsGBYWkkqMtnbXgrMD+yj7rhW0kuEDxzJaYXGjEW5ogapKNMEKNMjibA=="],

    "wide-align": ["wide-align@1.1.5", "", { "dependencies": { "string-width": "^1.0.2 || 2 || 3 || 4" } }, "sha512-eDMORYaPNZ4sQIuuYPDHdQvf4gyCF9rEEV/yPxGfwPkRodwEgiMUUXTx/dex+Me0wxx53S+NgUHaP7y3MGlDmg=="],

    "word-wrap": ["word-wrap@1.2.5", "", {}, "sha512-BN22B5eaMMI9UMtjrGd5g5eCYPpCPDUy0FJXbYsaT5zYxjFOckS53SQDE3pWkVoWpHXVb3BrYcEN4Twa55B5cA=="],

    "wrap-ansi": ["wrap-ansi@6.2.0", "", { "dependencies": { "ansi-styles": "^4.0.0", "string-width": "^4.1.0", "strip-ansi": "^6.0.0" } }, "sha512-r6lPcBGxZXlIcymEu7InxDMhdW0KDxpLgoFLcguasxCaJ/SOIZwINatK9KY/tf+ZrlywOKU0UDj3ATXUBfxJXA=="],

    "wrappy": ["wrappy@1.0.2", "", {}, "sha512-l4Sp/DRseor9wL6EvV2+TuQn63dMkPjZ/sp9XkghTEbV9KlPS1xUsZ3u7/IQO4wxtcFB4bgpQPRcR3QCvezPcQ=="],

    "ws": ["ws@8.17.1", "", { "peerDependencies": { "bufferutil": "^4.0.1", "utf-8-validate": ">=5.0.2" }, "optionalPeers": ["bufferutil", "utf-8-validate"] }, "sha512-6XQFvXTkbfUOZOKKILFG1PDK2NDQs4azKQl26T0YS5CxqWLgXajbPZ+h4gZekJyRqFU8pvnbAbbs/3TgRPy+GQ=="],

    "xmlhttprequest-ssl": ["xmlhttprequest-ssl@2.1.2", "", {}, "sha512-TEU+nJVUUnA4CYJFLvK5X9AOeH4KvDvhIfm0vV1GaQRtchnG0hgK5p8hw/xjv8cunWYCsiPCSDzObPyhEwq3KQ=="],

    "y18n": ["y18n@5.0.8", "", {}, "sha512-0pfFzegeDWJHJIAmTLRP2DwHjdF5s7jo9tuztdQxAhINCdvS+3nGINqPd00AphqJR/0LhANUS6/+7SCb98YOfA=="],

    "yallist": ["yallist@4.0.0", "", {}, "sha512-3wdGidZyq5PB084XLES5TpOSRA3wjXAlIWMhum2kRcv/41Sn2emQ0dycQW4uZXLejwKvg6EsvbdlVL+FYEct7A=="],

    "yargs": ["yargs@17.7.2", "", { "dependencies": { "cliui": "^8.0.1", "escalade": "^3.1.1", "get-caller-file": "^2.0.5", "require-directory": "^2.1.1", "string-width": "^4.2.3", "y18n": "^5.0.5", "yargs-parser": "^21.1.1" } }, "sha512-7dSzzRQ++CKnNI/krKnYRV7JKKPUXMEh61soaHKg9mrWEhzFWhFnxPxGl+69cD1Ou63C13NUPCnmIcrvqCuM6w=="],

    "yargs-parser": ["yargs-parser@21.1.1", "", {}, "sha512-tVpsJW7DdjecAiFpbIB1e3qxIQsE6NoPc5/eTdrbbIC4h0LVsWhnoa3g+m2HclBIujHzsxZ4VJVA+GUuc2/LBw=="],

    "yocto-queue": ["yocto-queue@0.1.0", "", {}, "sha512-rVksvsnNCdJ/ohGc6xgPwyN8eheCxsiLM8mxuE/t/mOVqJewPuO1miLpTHQiRgTKCLexL4MeAFVagts7HmNZ2Q=="],

    "yoctocolors": ["yoctocolors@2.1.2", "", {}, "sha512-CzhO+pFNo8ajLM2d2IW/R93ipy99LWjtwblvC1RsoSUMZgyLbYFr221TnSNT7GjGdYui6P459mw9JH/g/zW2ug=="],

    "yoctocolors-cjs": ["yoctocolors-cjs@2.1.3", "", {}, "sha512-U/PBtDf35ff0D8X8D0jfdzHYEPFxAI7jJlxZXwCSez5M3190m+QobIfh+sWDWSHMCWWJN2AWamkegn6vr6YBTw=="],

    "zod": ["zod@3.25.76", "", {}, "sha512-gzUt/qt81nXsFGKIFcC3YnfEAx5NkunCfnDlvuBSSFS02bcXu4Lmea0AFIUwbLWxWPx3d9p8S5QoaujKcNQxcQ=="],

    "zod-to-json-schema": ["zod-to-json-schema@3.24.6", "", { "peerDependencies": { "zod": "^3.24.1" } }, "sha512-h/z3PKvcTcTetyjl1fkj79MHNEjm+HpD6NXheWjzOekY7kV+lwDYnHw+ivHkijnCSMz1yJaWBD9vu/Fcmk+vEg=="],

    "@dotenvx/dotenvx/commander": ["commander@11.1.0", "", {}, "sha512-yPVavfyCcRhmorC7rWlkHn15b4wDVgVmBA7kV4QVBsF7kv/9TKJAbAXVTxvTnwP8HHKjRCJDClKbciiYS7p0DQ=="],

    "@dotenvx/dotenvx/execa": ["execa@5.1.1", "", { "dependencies": { "cross-spawn": "^7.0.3", "get-stream": "^6.0.0", "human-signals": "^2.1.0", "is-stream": "^2.0.0", "merge-stream": "^2.0.0", "npm-run-path": "^4.0.1", "onetime": "^5.1.2", "signal-exit": "^3.0.3", "strip-final-newline": "^2.0.0" } }, "sha512-8uSpZZocAZRBAPIEINJj3Lo9HyGitllczc27Eh5YYojjMFMn8yHMDMaUHE2Jqfq05D/wucwI4JGURyXt1vchyg=="],

    "@dotenvx/dotenvx/which": ["which@4.0.0", "", { "dependencies": { "isexe": "^3.1.1" }, "bin": { "node-which": "bin/which.js" } }, "sha512-GlaYyEb07DPxYCKhKzplCWBJtvxZcZMrL+4UkrTSJHHPyZU4mYYTv3qaOe77H7EODLSSopAUFAc6W8U4yqvscg=="],

    "@eslint-community/eslint-utils/eslint-visitor-keys": ["eslint-visitor-keys@3.4.3", "", {}, "sha512-wpc+LXeiyiisxPlEkUzU6svyS1frIO3Mgxj1fdy7Pm8Ygzguax2N3Fa/D/ag1WqbOprdI+uY6wMUl8/a2G+iag=="],

    "@eslint/eslintrc/globals": ["globals@14.0.0", "", {}, "sha512-oahGvuMGQlPw/ivIYBjVSrWAfWLBeku5tpPE2fOPLi+WHffIWbuh2tCjhyQhTBPMf5E9jDEH4FOmTYgYwbKwtQ=="],

    "@mapbox/node-pre-gyp/https-proxy-agent": ["https-proxy-agent@5.0.1", "", { "dependencies": { "agent-base": "6", "debug": "4" } }, "sha512-dFcAjpTQFgoLMzC2VwU+C/CbS7uRL0lWmxDITmqm7C+7F0Odmj6s9l6alZc6AELXhrnggM2CeWSXHGOdX2YtwA=="],

    "@mapbox/node-pre-gyp/node-fetch": ["node-fetch@2.7.0", "", { "dependencies": { "whatwg-url": "^5.0.0" }, "peerDependencies": { "encoding": "^0.1.0" }, "optionalPeers": ["encoding"] }, "sha512-c4FRfUm/dbcWZ7U+1Wq0AwCyFL+3nt2bEw05wfxSz+DWpWsitgmSgYmy2dQdWyKC1694ELPqMs/YzUSNozLt8A=="],

    "@mapbox/node-pre-gyp/rimraf": ["rimraf@3.0.2", "", { "dependencies": { "glob": "^7.1.3" }, "bin": { "rimraf": "bin.js" } }, "sha512-JZkJMZkAGFFPP2YqXZXPbMlMBgsxzE8ILs4lMIX/2o0L9UBw9O/Y3o6wFw/i9YLapcUJWwqbi3kdxIPdC62TIA=="],

    "@mapbox/node-pre-gyp/semver": ["semver@7.7.3", "", { "bin": "bin/semver.js" }, "sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q=="],

    "@modelcontextprotocol/sdk/ajv": ["ajv@8.17.1", "", { "dependencies": { "fast-deep-equal": "^3.1.3", "fast-uri": "^3.0.1", "json-schema-traverse": "^1.0.0", "require-from-string": "^2.0.2" } }, "sha512-B/gBuNg5SiMTrPkC+A2+cW0RszwxYmn6VYxB/inlBStS5nx6xHIt/ehKRhIMhqusl7a8LjQoZnjCs5vhwxOQ1g=="],

    "@tensorflow/tfjs/yargs": ["yargs@16.2.0", "", { "dependencies": { "cliui": "^7.0.2", "escalade": "^3.1.1", "get-caller-file": "^2.0.5", "require-directory": "^2.1.1", "string-width": "^4.2.0", "y18n": "^5.0.5", "yargs-parser": "^20.2.2" } }, "sha512-D1mvvtDG0L5ft/jGWkLpG1+m0eQxOfaBvTNELraWj22wSVUMWxZUvYgJYcKh6jGGIkJFhH4IZPQhR4TKpc8mBw=="],

    "@tensorflow/tfjs-core/@types/offscreencanvas": ["@types/offscreencanvas@2019.7.3", "", {}, "sha512-ieXiYmgSRXUDeOntE1InxjWyvEelZGP63M+cGuquuRLuIKKT1osnkXjxev9B7d1nXSug5vpunx+gNlbVxMlC9A=="],

    "@tensorflow/tfjs-core/node-fetch": ["node-fetch@2.6.13", "", { "dependencies": { "whatwg-url": "^5.0.0" }, "peerDependencies": { "encoding": "^0.1.0" }, "optionalPeers": ["encoding"] }, "sha512-StxNAxh15zr77QvvkmveSQ8uCQ4+v5FkvNTj0OESmiHu+VRi/gXArXtkWMElOsOUNLtUEvI4yS+rdtOHZTwlQA=="],

    "@tensorflow/tfjs-data/node-fetch": ["node-fetch@2.6.13", "", { "dependencies": { "whatwg-url": "^5.0.0" }, "peerDependencies": { "encoding": "^0.1.0" }, "optionalPeers": ["encoding"] }, "sha512-StxNAxh15zr77QvvkmveSQ8uCQ4+v5FkvNTj0OESmiHu+VRi/gXArXtkWMElOsOUNLtUEvI4yS+rdtOHZTwlQA=="],

    "@tensorflow/tfjs-node/https-proxy-agent": ["https-proxy-agent@2.2.4", "", { "dependencies": { "agent-base": "^4.3.0", "debug": "^3.1.0" } }, "sha512-OmvfoQ53WLjtA9HeYP9RNrWMJzzAz1JGaSFr1nijg0PVR1JaD/xbJq1mdEIIlxGpXp9eSe/O2LgU9DJmTPd0Eg=="],

    "@ts-morph/common/minimatch": ["minimatch@10.1.1", "", { "dependencies": { "@isaacs/brace-expansion": "^5.0.0" } }, "sha512-enIvLvRAFZYXJzkCYG5RKmPfrFArdLv+R+lbQ53BmIMLIry74bjKzX6iHAm8WYamJkhSSEabrWN5D97XnKObjQ=="],

    "@typescript-eslint/eslint-plugin/ignore": ["ignore@7.0.5", "", {}, "sha512-Hs59xBNfUIunMFgWAbGX5cq6893IbWg4KnrjbYwX3tx0ztorVgTDA6B2sxf8ejHJ4wz8BqGUMYlnzNBer5NvGg=="],

    "@typescript-eslint/typescript-estree/minimatch": ["minimatch@9.0.5", "", { "dependencies": { "brace-expansion": "^2.0.1" } }, "sha512-G6T0ZX48xgozx7587koeX9Ys2NYy6Gmv//P89sEte9V9whIapMNF4idKxnW2QtCcLiTWlb/wfCabAtAFWhhBow=="],

    "@typescript-eslint/typescript-estree/semver": ["semver@7.7.3", "", { "bin": "bin/semver.js" }, "sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q=="],

    "ajv-formats/ajv": ["ajv@8.17.1", "", { "dependencies": { "fast-deep-equal": "^3.1.3", "fast-uri": "^3.0.1", "json-schema-traverse": "^1.0.0", "require-from-string": "^2.0.2" } }, "sha512-B/gBuNg5SiMTrPkC+A2+cW0RszwxYmn6VYxB/inlBStS5nx6xHIt/ehKRhIMhqusl7a8LjQoZnjCs5vhwxOQ1g=="],

    "body-parser/iconv-lite": ["iconv-lite@0.6.3", "", { "dependencies": { "safer-buffer": ">= 2.1.2 < 3.0.0" } }, "sha512-4fCk79wshMdzMp2rH06qWrJE4iolqLhCUH+OiuIgU++RB0+94NlDL81atO7GX55uUKueo0txHNtvEyI6D7WdMw=="],

    "cliui/string-width": ["string-width@4.2.3", "", { "dependencies": { "emoji-regex": "^8.0.0", "is-fullwidth-code-point": "^3.0.0", "strip-ansi": "^6.0.1" } }, "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g=="],

    "cliui/strip-ansi": ["strip-ansi@6.0.1", "", { "dependencies": { "ansi-regex": "^5.0.1" } }, "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A=="],

    "cliui/wrap-ansi": ["wrap-ansi@7.0.0", "", { "dependencies": { "ansi-styles": "^4.0.0", "string-width": "^4.1.0", "strip-ansi": "^6.0.0" } }, "sha512-YVGIj2kamLSTxw6NsZjoBxfSwsn0ycdesmc4p+Q21c5zPuZ1pl+NfxVdxPtdHvmNVOQ6XSYG4AUtyt/Fi7D16Q=="],

    "engine.io-client/debug": ["debug@4.3.7", "", { "dependencies": { "ms": "^2.1.3" } }, "sha512-Er2nc/H7RrMXZBFCEim6TCmMk02Z8vLC2Rbi1KEBggpo0fS6l0S1nnapwmIi3yW/+GOJap1Krg4w0Hg80oCqgQ=="],

    "express/cookie": ["cookie@0.7.2", "", {}, "sha512-yki5XnKuf750l50uGTllt6kKILY4nQ1eNIQatoXEByZ5dWgnKqbnqmTrBE5B4N7lrMJKQ2ytWMiTO2o0v6Ew/w=="],

    "fast-glob/glob-parent": ["glob-parent@5.1.2", "", { "dependencies": { "is-glob": "^4.0.1" } }, "sha512-AOIgSQCepiJYwP3ARnGx+5VnTu2HBYdzbGP45eLw1vr3zB3vZLeyed1sC9hnbcOc9/SrMyM5RPQrkGz4aS9Zow=="],

    "form-data/mime-types": ["mime-types@2.1.35", "", { "dependencies": { "mime-db": "1.52.0" } }, "sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw=="],

    "fs-minipass/minipass": ["minipass@3.3.6", "", { "dependencies": { "yallist": "^4.0.0" } }, "sha512-DxiNidxSEK+tHG6zOIklvNOwm3hvCrbUrdtzY74U6HKTJxvIDfOUL5W5P2Ghd3DTkhhKPYGqeNUIh5qcM4YBfw=="],

    "gauge/signal-exit": ["signal-exit@3.0.7", "", {}, "sha512-wnD2ZE+l+SPC/uoS0vXeE9L1+0wuaMqKlfz9AMUo38JsyLSBWSFcHR1Rri62LZc12vLr1gb3jl7iwQhgwpAbGQ=="],

    "gauge/string-width": ["string-width@4.2.3", "", { "dependencies": { "emoji-regex": "^8.0.0", "is-fullwidth-code-point": "^3.0.0", "strip-ansi": "^6.0.1" } }, "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g=="],

    "gauge/strip-ansi": ["strip-ansi@6.0.1", "", { "dependencies": { "ansi-regex": "^5.0.1" } }, "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A=="],

    "http-errors/statuses": ["statuses@2.0.1", "", {}, "sha512-RwNA9Z/7PrK06rYLIzFMlaF+l73iwpzsqRIFgbMLbTcLD6cOao82TaWefPXQvB2fOC4AjuYSEndS7N/mTCbkdQ=="],

    "i18next/@babel/runtime": ["@babel/runtime@7.28.4", "", {}, "sha512-Q/N6JNWvIvPnLDvjlE1OUBLPQHH6l3CltCEsHIujp45zQUSSh8K+gHnaEX45yAT1nyngnINhvWtzN+Nb9D8RAQ=="],

    "js-yaml/argparse": ["argparse@2.0.1", "", {}, "sha512-8+9WqebbFzpX9OR+Wa6O29asIogeRMzcGtAINdpMHHyAg10f05aSFVBbcEqGf/PXw1EjAZ+q2/bEBg3DvurK3Q=="],

    "log-symbols/chalk": ["chalk@5.6.2", "", {}, "sha512-7NzBL0rN6fMUW+f7A6Io4h40qQlG+xGmtMxfbnH/K7TAtt8JQWVQK+6g0UXKMeVJoyV5EkkNsErQ8pVD3bLHbA=="],

    "log-symbols/is-unicode-supported": ["is-unicode-supported@1.3.0", "", {}, "sha512-43r2mRvz+8JRIKnWJ+3j8JtjRKZ6GmjzfaE/qiBJnikNnYv/6bagRJ1kUhNk8R5EX/GkobD+r+sfxCPJsiKBLQ=="],

    "lru-cache/yallist": ["yallist@3.1.1", "", {}, "sha512-a4UGQaWPH59mOXUYnAG2ewncQS4i4F43Tv3JoAM+s2VDAmS9NsK8GpDMLrCHPksFT7h3K6TOoUNn2pb7RoXx4g=="],

    "magika/chalk": ["chalk@5.6.2", "", {}, "sha512-7NzBL0rN6fMUW+f7A6Io4h40qQlG+xGmtMxfbnH/K7TAtt8JQWVQK+6g0UXKMeVJoyV5EkkNsErQ8pVD3bLHbA=="],

    "magika/commander": ["commander@13.1.0", "", {}, "sha512-/rFeCpNJQbhSZjGVwO9RFV3xPqbnERS8MmIQzCtD/zl6gpJuV/bMLuN92oG3F7d8oDEHHRrujSXNUr8fpjntKw=="],

    "micromatch/picomatch": ["picomatch@2.3.1", "", {}, "sha512-JU3teHTNjmE2VCGFzuY8EXzCDVwEqB2a8fsIvwaStHhAWJEeVd1o1QD80CU6+ZdEXXSLbSsuLwJjkCBWqRQUVA=="],

    "minizlib/minipass": ["minipass@3.3.6", "", { "dependencies": { "yallist": "^4.0.0" } }, "sha512-DxiNidxSEK+tHG6zOIklvNOwm3hvCrbUrdtzY74U6HKTJxvIDfOUL5W5P2Ghd3DTkhhKPYGqeNUIh5qcM4YBfw=="],

    "npm-run-path/path-key": ["path-key@4.0.0", "", {}, "sha512-haREypq7xkM7ErfgIyA0z+Bj4AGKlMSdlQE2jvJo6huWD1EdkKYV+G/T4nq0YEF2vgTT8kqMFKo1uHn950r4SQ=="],

    "ora/chalk": ["chalk@5.6.2", "", {}, "sha512-7NzBL0rN6fMUW+f7A6Io4h40qQlG+xGmtMxfbnH/K7TAtt8JQWVQK+6g0UXKMeVJoyV5EkkNsErQ8pVD3bLHbA=="],

    "prompts/kleur": ["kleur@3.0.3", "", {}, "sha512-eTIzlVOSUR+JxdDFepEYcBMtZ9Qqdef+rnzWdRZuMbOywu5tO2w2N7rqjoANZ5k9vywhL6Br1VRjUIgTQx4E8w=="],

    "react-i18next/@babel/runtime": ["@babel/runtime@7.28.4", "", {}, "sha512-Q/N6JNWvIvPnLDvjlE1OUBLPQHH6l3CltCEsHIujp45zQUSSh8K+gHnaEX45yAT1nyngnINhvWtzN+Nb9D8RAQ=="],

    "restore-cursor/onetime": ["onetime@7.0.0", "", { "dependencies": { "mimic-function": "^5.0.0" } }, "sha512-VXJjc87FScF88uafS3JllDgvAm+c/Slfz06lorj2uAY34rlUu0Nt+v8wreiImcrgAjjIHp1rXpTDlLOGw29WwQ=="],

    "rolldown/@rolldown/pluginutils": ["@rolldown/pluginutils@1.0.0-beta.41", "", {}, "sha512-ycMEPrS3StOIeb87BT3/+bu+blEtyvwQ4zmo2IcJQy0Rd1DAAhKksA0iUZ3MYSpJtjlPhg0Eo6mvVS6ggPhRbw=="],

    "router/path-to-regexp": ["path-to-regexp@8.3.0", "", {}, "sha512-7jdwVIRtsP8MYpdXSwOS0YdD0Du+qOoF/AEPIt88PcCFrZCzx41oxku1jD88hZBwbNUIEfpqvuhjFaMAqMTWnA=="],

    "socket.io-client/debug": ["debug@4.3.7", "", { "dependencies": { "ms": "^2.1.3" } }, "sha512-Er2nc/H7RrMXZBFCEim6TCmMk02Z8vLC2Rbi1KEBggpo0fS6l0S1nnapwmIi3yW/+GOJap1Krg4w0Hg80oCqgQ=="],

    "socket.io-parser/debug": ["debug@4.3.7", "", { "dependencies": { "ms": "^2.1.3" } }, "sha512-Er2nc/H7RrMXZBFCEim6TCmMk02Z8vLC2Rbi1KEBggpo0fS6l0S1nnapwmIi3yW/+GOJap1Krg4w0Hg80oCqgQ=="],

    "wide-align/string-width": ["string-width@4.2.3", "", { "dependencies": { "emoji-regex": "^8.0.0", "is-fullwidth-code-point": "^3.0.0", "strip-ansi": "^6.0.1" } }, "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g=="],

    "wrap-ansi/string-width": ["string-width@4.2.3", "", { "dependencies": { "emoji-regex": "^8.0.0", "is-fullwidth-code-point": "^3.0.0", "strip-ansi": "^6.0.1" } }, "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g=="],

    "wrap-ansi/strip-ansi": ["strip-ansi@6.0.1", "", { "dependencies": { "ansi-regex": "^5.0.1" } }, "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A=="],

    "yargs/string-width": ["string-width@4.2.3", "", { "dependencies": { "emoji-regex": "^8.0.0", "is-fullwidth-code-point": "^3.0.0", "strip-ansi": "^6.0.1" } }, "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g=="],

    "@dotenvx/dotenvx/execa/get-stream": ["get-stream@6.0.1", "", {}, "sha512-ts6Wi+2j3jQjqi70w5AlN8DFnkSwC+MqmxEzdEALB2qXZYV3X/b1CTfgPLGJNMeAWxdPfU8FO1ms3NUfaHCPYg=="],

    "@dotenvx/dotenvx/execa/human-signals": ["human-signals@2.1.0", "", {}, "sha512-B4FFZ6q/T2jhhksgkbEW3HBvWIfDW85snkQgawt07S7J5QXTk6BkNV+0yAeZrM5QpMAdYlocGoljn0sJ/WQkFw=="],

    "@dotenvx/dotenvx/execa/is-stream": ["is-stream@2.0.1", "", {}, "sha512-hFoiJiTl63nn+kstHGBtewWSKnQLpyb155KHheA1l39uvtO9nWIop1p3udqPcUd/xbF1VLMO4n7OI6p7RbngDg=="],

    "@dotenvx/dotenvx/execa/npm-run-path": ["npm-run-path@4.0.1", "", { "dependencies": { "path-key": "^3.0.0" } }, "sha512-S48WzZW777zhNIrn7gxOlISNAqi9ZC/uQFnRdbeIHhZhCA6UqpkOT8T1G7BvfdgP4Er8gF4sUbaS0i7QvIfCWw=="],

    "@dotenvx/dotenvx/execa/signal-exit": ["signal-exit@3.0.7", "", {}, "sha512-wnD2ZE+l+SPC/uoS0vXeE9L1+0wuaMqKlfz9AMUo38JsyLSBWSFcHR1Rri62LZc12vLr1gb3jl7iwQhgwpAbGQ=="],

    "@dotenvx/dotenvx/execa/strip-final-newline": ["strip-final-newline@2.0.0", "", {}, "sha512-BrpvfNAE3dcvq7ll3xVumzjKjZQ5tI1sEUIKr3Uoks0XUl45St3FlatVqef9prk4jRDzhW6WZg+3bk93y6pLjA=="],

    "@dotenvx/dotenvx/which/isexe": ["isexe@3.1.1", "", {}, "sha512-LpB/54B+/2J5hqQ7imZHfdU31OlgQqx7ZicVlkm9kzg9/w8GKLEcFfJl/t7DCEDueOyBAD6zCCwTO6Fzs0NoEQ=="],

    "@mapbox/node-pre-gyp/https-proxy-agent/agent-base": ["agent-base@6.0.2", "", { "dependencies": { "debug": "4" } }, "sha512-RZNwNclF7+MS/8bDg70amg32dyeZGZxiDuQmZxKLAlQjr3jGyLx+4Kkk58UO7D2QdgFIQCovuSuZESne6RG6XQ=="],

    "@modelcontextprotocol/sdk/ajv/json-schema-traverse": ["json-schema-traverse@1.0.0", "", {}, "sha512-NM8/P9n3XjXhIZn1lLhkFaACTOURQXjWhV4BA/RnOv8xvgqtqpAX9IO4mRQxSx1Rlo4tqzeqb0sOlruaOy3dug=="],

    "@tensorflow/tfjs-node/https-proxy-agent/agent-base": ["agent-base@4.3.0", "", { "dependencies": { "es6-promisify": "^5.0.0" } }, "sha512-salcGninV0nPrwpGNn4VTXBb1SOuXQBiqbrNXoeizJsHrsL6ERFM2Ne3JUSBWRE6aeNJI2ROP/WEEIDUiDe3cg=="],

    "@tensorflow/tfjs-node/https-proxy-agent/debug": ["debug@3.2.7", "", { "dependencies": { "ms": "^2.1.1" } }, "sha512-CFjzYYAi4ThfiQvizrFQevTTXHtnCqWfe7x1AhgEscTz6ZbLbfoLRLPugTQyBth6f8ZERVUSyWHFD/7Wu4t1XQ=="],

    "@tensorflow/tfjs/yargs/cliui": ["cliui@7.0.4", "", { "dependencies": { "string-width": "^4.2.0", "strip-ansi": "^6.0.0", "wrap-ansi": "^7.0.0" } }, "sha512-OcRE68cOsVMXp1Yvonl/fzkQOyjLSu/8bhPDfQt0e0/Eb283TKP20Fs2MqoPsr9SwA595rRCA+QMzYc9nBP+JQ=="],

    "@tensorflow/tfjs/yargs/string-width": ["string-width@4.2.3", "", { "dependencies": { "emoji-regex": "^8.0.0", "is-fullwidth-code-point": "^3.0.0", "strip-ansi": "^6.0.1" } }, "sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g=="],

    "@tensorflow/tfjs/yargs/yargs-parser": ["yargs-parser@20.2.9", "", {}, "sha512-y11nGElTIV+CT3Zv9t7VKl+Q3hTQoT9a1Qzezhhl6Rp21gJ/IVTW7Z3y9EWXhuUBC2Shnf+DX0antecpAwSP8w=="],

    "@typescript-eslint/typescript-estree/minimatch/brace-expansion": ["brace-expansion@2.0.2", "", { "dependencies": { "balanced-match": "^1.0.0" } }, "sha512-Jt0vHyM+jmUBqojB7E1NIYadt0vI0Qxjxd2TErW94wDz+E2LAm5vKMXXwg6ZZBTHPuUlDgQHKXvjGBdfcF1ZDQ=="],

    "ajv-formats/ajv/json-schema-traverse": ["json-schema-traverse@1.0.0", "", {}, "sha512-NM8/P9n3XjXhIZn1lLhkFaACTOURQXjWhV4BA/RnOv8xvgqtqpAX9IO4mRQxSx1Rlo4tqzeqb0sOlruaOy3dug=="],

    "cliui/string-width/emoji-regex": ["emoji-regex@8.0.0", "", {}, "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A=="],

    "cliui/strip-ansi/ansi-regex": ["ansi-regex@5.0.1", "", {}, "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ=="],

    "form-data/mime-types/mime-db": ["mime-db@1.52.0", "", {}, "sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg=="],

    "gauge/string-width/emoji-regex": ["emoji-regex@8.0.0", "", {}, "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A=="],

    "gauge/strip-ansi/ansi-regex": ["ansi-regex@5.0.1", "", {}, "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ=="],

    "wide-align/string-width/emoji-regex": ["emoji-regex@8.0.0", "", {}, "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A=="],

    "wide-align/string-width/strip-ansi": ["strip-ansi@6.0.1", "", { "dependencies": { "ansi-regex": "^5.0.1" } }, "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A=="],

    "wrap-ansi/string-width/emoji-regex": ["emoji-regex@8.0.0", "", {}, "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A=="],

    "wrap-ansi/strip-ansi/ansi-regex": ["ansi-regex@5.0.1", "", {}, "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ=="],

    "yargs/string-width/emoji-regex": ["emoji-regex@8.0.0", "", {}, "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A=="],

    "yargs/string-width/strip-ansi": ["strip-ansi@6.0.1", "", { "dependencies": { "ansi-regex": "^5.0.1" } }, "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A=="],

    "@tensorflow/tfjs/yargs/cliui/strip-ansi": ["strip-ansi@6.0.1", "", { "dependencies": { "ansi-regex": "^5.0.1" } }, "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A=="],

    "@tensorflow/tfjs/yargs/cliui/wrap-ansi": ["wrap-ansi@7.0.0", "", { "dependencies": { "ansi-styles": "^4.0.0", "string-width": "^4.1.0", "strip-ansi": "^6.0.0" } }, "sha512-YVGIj2kamLSTxw6NsZjoBxfSwsn0ycdesmc4p+Q21c5zPuZ1pl+NfxVdxPtdHvmNVOQ6XSYG4AUtyt/Fi7D16Q=="],

    "@tensorflow/tfjs/yargs/string-width/emoji-regex": ["emoji-regex@8.0.0", "", {}, "sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A=="],

    "@tensorflow/tfjs/yargs/string-width/strip-ansi": ["strip-ansi@6.0.1", "", { "dependencies": { "ansi-regex": "^5.0.1" } }, "sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A=="],

    "wide-align/string-width/strip-ansi/ansi-regex": ["ansi-regex@5.0.1", "", {}, "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ=="],

    "yargs/string-width/strip-ansi/ansi-regex": ["ansi-regex@5.0.1", "", {}, "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ=="],

    "@tensorflow/tfjs/yargs/cliui/strip-ansi/ansi-regex": ["ansi-regex@5.0.1", "", {}, "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ=="],

    "@tensorflow/tfjs/yargs/string-width/strip-ansi/ansi-regex": ["ansi-regex@5.0.1", "", {}, "sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ=="],
  }
}

```

`gui/components.json`:

```json
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "base-vega",
  "rsc": false,
  "tsx": true,
  "tailwind": {
    "config": "",
    "css": "src/index.css",
    "baseColor": "slate",
    "cssVariables": true,
    "prefix": ""
  },
  "iconLibrary": "lucide",
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  },
  "registries": {}
}

```

`gui/eslint.config.js`:

```js
import js from "@eslint/js";
import globals from "globals";
import reactHooks from "eslint-plugin-react-hooks";
import reactRefresh from "eslint-plugin-react-refresh";
import tseslint from "typescript-eslint";
import { defineConfig, globalIgnores } from "eslint/config";

export default defineConfig([
  globalIgnores([
    "dist",
    "./src/components/ui/**/*",
    "./src/components/theme-provider.tsx",
  ]),
  {
    files: ["**/*.{ts,tsx}"],
    extends: [
      js.configs.recommended,
      tseslint.configs.recommended,
      reactHooks.configs["recommended-latest"],
      reactRefresh.configs.vite,
    ],
    languageOptions: {
      ecmaVersion: 2020,
      globals: globals.browser,
    },
    rules: {
      "react-refresh/only-export-components": "off",
    },
  },
]);

```

`gui/index.html`:

```html
<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <link
            rel="icon"
            type="image/svg+xml"
            href="/src/assets/grapefruit.svg"
        />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Grapefruit</title>
    </head>
    <body>
        <div id="root"></div>
        <script type="module" src="/src/main.tsx"></script>
    </body>
</html>

```

`gui/package.json`:

```json
{
  "name": "igf-gui",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "engines": {
    "node": ">=22.18.0"
  },
  "scripts": {
    "dev": "vite",
    "build": "tsgo -b && vite build",
    "lint": "eslint .",
    "preview": "vite preview",
    "prepare": "bun run build"
  },
  "dependencies": {
    "@base-ui/react": "^1.2.0",
    "@frida/react-use-r2": "^2.0.0",
    "@monaco-editor/react": "^4.7.0",
    "@tailwindcss/vite": "^4.1.16",
    "@tanstack/react-query": "^5.90.20",
    "@tanstack/react-table": "^8.21.3",
    "@tanstack/react-virtual": "^3.13.18",
    "@xterm/xterm": "^6.0.0",
    "class-variance-authority": "^0.7.1",
    "clsx": "^2.1.1",
    "cmdk": "^1.1.1",
    "date-fns": "^4.1.0",
    "dockview": "^4.11.0",
    "i18next": "^25.6.1",
    "leaflet": "^1.9.4",
    "lucide-react": "^0.552.0",
    "magika": "^1.0.0",
    "react": "^19.1.1",
    "react-day-picker": "^9.13.0",
    "react-dom": "^19.1.1",
    "react-i18next": "^16.2.4",
    "react-resizable-panels": "^4.6.4",
    "react-router": "^7.9.5",
    "react-window": "^2.2.5",
    "socket.io-client": "^4.8.1",
    "sonner": "^2.0.7",
    "tailwind-merge": "^3.3.1",
    "tailwindcss": "^4.1.16"
  },
  "devDependencies": {
    "@eslint/js": "^9.36.0",
    "@types/leaflet": "^1.9.21",
    "@types/node": "^24.6.0",
    "@types/react": "^19.1.16",
    "@types/react-dom": "^19.1.9",
    "@typescript/native-preview": "^7.0.0-dev.20260222.1",
    "@vitejs/plugin-react": "^5.1.0",
    "eslint": "^9.36.0",
    "eslint-plugin-react-hooks": "^5.2.0",
    "eslint-plugin-react-refresh": "^0.4.22",
    "globals": "^16.4.0",
    "shadcn": "^3.5.0",
    "tw-animate-css": "^1.4.0",
    "typescript-eslint": "^8.45.0",
    "vite": "npm:rolldown-vite@7.1.14"
  },
  "trustedDependencies": [
    "core-js"
  ]
}

```

`gui/src/App.css`:

```css
/* Custom dockview theme that inherits from the app's color system */
.dockview-theme-app {
    --dv-paneview-active-outline-color: var(--primary);
    --dv-tabs-and-actions-container-font-size: 13px;
    --dv-tabs-and-actions-container-height: 40px;
    --dv-drag-over-background-color: color-mix(
        in oklch,
        var(--accent) 50%,
        transparent
    );
    --dv-drag-over-border-color: transparent;
    --dv-tabs-container-scrollbar-color: var(--muted-foreground);
    --dv-icon-hover-background-color: color-mix(
        in oklch,
        var(--accent) 50%,
        transparent
    );
    --dv-floating-box-shadow: 0 4px 12px
        color-mix(in oklch, var(--background) 60%, transparent);
    --dv-overlay-z-index: 999;
    --dv-tab-font-size: inherit;
    --dv-border-radius: 6px;
    --dv-tab-margin: 0 4px 0 0;
    --dv-sash-color: transparent;
    --dv-active-sash-color: var(--primary);
    --dv-active-sash-transition-duration: 0.1s;
    --dv-active-sash-transition-delay: 0.5s;

    --dv-background-color: var(--background);
    --dv-group-view-background-color: var(--background);
    --dv-tabs-and-actions-container-background-color: var(--secondary);
    --dv-activegroup-visiblepanel-tab-background-color: var(--background);
    --dv-activegroup-hiddenpanel-tab-background-color: var(--muted);
    --dv-inactivegroup-visiblepanel-tab-background-color: var(--background);
    --dv-inactivegroup-hiddenpanel-tab-background-color: var(--muted);
    --dv-tab-divider-color: transparent;
    --dv-activegroup-visiblepanel-tab-color: var(--foreground);
    --dv-activegroup-hiddenpanel-tab-color: var(--muted-foreground);
    --dv-inactivegroup-visiblepanel-tab-color: var(--muted-foreground);
    --dv-inactivegroup-hiddenpanel-tab-color: color-mix(
        in oklch,
        var(--muted-foreground) 60%,
        transparent
    );
    --dv-separator-border: var(--border);
    --dv-paneview-header-border-color: var(--border);
    --dv-scrollbar-background-color: color-mix(
        in oklch,
        var(--muted-foreground) 40%,
        transparent
    );
}

.dockview-theme-app .dv-tab {
    padding: 0.375rem 0.75rem;
}

.dockview-theme-app .dv-tab .dv-default-tab .dv-default-tab-content {
    line-height: 1.4;
}

```

`gui/src/App.tsx`:

```tsx
import { Routes, Route } from "react-router";
import { useTranslation } from "react-i18next";

import "dockview/dist/styles/dockview.css";

import "./App.css";
import { WelcomePage } from "./components/pages/WelcomePage";
import { DefaultMessage } from "./components/pages/DefaultMessage";
import { AppsView } from "./components/pages/AppsView";
import { ProcessesView } from "./components/pages/ProcessesView";
import { Workspace } from "./components/layout/Workspace";
import { WorkspaceIndex } from "./components/layout/WorkspaceIndex";

import { FruityGeneralPanel } from "./components/panels/FruityGeneralPanel";
import { FruityDevicePanel } from "./components/panels/FruityDevicePanel";
import { DroidGeneralPanel } from "./components/panels/DroidGeneralPanel";
import { DroidComponentsPanel } from "./components/panels/DroidComponentsPanel";
import { DroidDevicePanel } from "./components/panels/DroidDevicePanel";
import { ModulesPanel } from "./components/panels/ModulesPanel";
import { FruityClassesPanel } from "./components/panels/FruityClassesPanel";
import { DroidClassesPanel } from "./components/panels/DroidClassesPanel";
import { FruityURLSchemesPanel } from "./components/panels/FruityURLSchemesPanel";
import { DroidURLSchemesPanel } from "./components/panels/DroidURLSchemesPanel";
import { FruityGeolocationPanel } from "./components/panels/FruityGeolocationPanel";
import { FruityHooksPanel } from "./components/panels/FruityHooksPanel";
import { FruityPluginsPanel } from "./components/panels/FruityPluginsPanel";
import { DroidHooksPanel } from "./components/panels/DroidHooksPanel";
import { PlaceholderPanel } from "./components/panels/PlaceholderPanel";

import { Platform, useSession } from "./context/SessionContext";
import { AlertTriangle } from "lucide-react";

function GeneralPanelRoute() {
  const { platform } = useSession();
  return platform === Platform.Droid ? <DroidGeneralPanel /> : <FruityGeneralPanel />;
}

function ClassesPanelRoute() {
  const { platform } = useSession();
  return platform === Platform.Droid ? <DroidClassesPanel /> : <FruityClassesPanel />;
}

function URLSchemesPanelRoute() {
  const { platform } = useSession();
  return platform === Platform.Droid ? <DroidURLSchemesPanel /> : <FruityURLSchemesPanel />;
}

function DevicePanelRoute() {
  const { platform } = useSession();
  return platform === Platform.Droid ? <DroidDevicePanel /> : <FruityDevicePanel />;
}

function HooksPanelRoute() {
  const { platform } = useSession();
  return platform === Platform.Droid ? <DroidHooksPanel /> : <FruityHooksPanel />;
}

function App() {
  const { t } = useTranslation();

  return (
    <>
      <div className="fixed top-0 left-0 right-0 z-50 block bg-yellow-100 px-4 py-3 text-center text-sm font-medium text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200 sm:hidden">
        <div className="flex items-center justify-center gap-2">
          <AlertTriangle className="h-4 w-4" />
          <span>{t("desktop_only_warning")}</span>
        </div>
      </div>
      <Routes>
        {/* Welcome page with device list */}
        <Route path="/" element={<WelcomePage />}>
          <Route index element={<DefaultMessage />} />
          {/* Apps list for a device */}
          <Route path="list/:udid/apps" element={<AppsView />} />
          {/* Processes list for a device */}
          <Route path="list/:udid/processes" element={<ProcessesView />} />
        </Route>

        {/* Workspace with platform and mode as route params */}
        <Route path="/workspace/:platform/:device/:mode/:target" element={<Workspace />}>
          {/* Default view based on platform/mode */}
          <Route index element={<WorkspaceIndex />} />
          {/* Platform-aware panels */}
          <Route path="general" element={<GeneralPanelRoute />} />
          <Route path="modules" element={<ModulesPanel />} />
          <Route path="classes" element={<ClassesPanelRoute />} />
          <Route path="urls" element={<URLSchemesPanelRoute />} />
          <Route path="extensions" element={<FruityPluginsPanel />} />
          <Route path="geolocation" element={<FruityGeolocationPanel />} />
          <Route path="hooks" element={<HooksPanelRoute />} />
          {/* Android (droid) panels */}
          <Route path="components" element={<DroidComponentsPanel />} />
          <Route path="device" element={<DevicePanelRoute />} />
          {/* Placeholder for unsupported modes */}
          <Route path="placeholder" element={<PlaceholderPanel />} />
        </Route>
      </Routes>
    </>
  );
}

export default App;

```

`gui/src/assets/grapefruit.svg`:

```svg
<?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 24.0.2, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve">
<style type="text/css">
	.st0{fill:none;}
	.st1{fill:#FAC369;}
	.st2{fill:#FFA745;}
	.st3{fill:#ED5E40;}
	.st4{fill:#DD8571;}
	.st5{fill:url(#New_Pattern_Swatch_5);}
	.st6{fill:#FCDAB5;stroke:#FEB157;stroke-width:10;stroke-miterlimit:10;}
	.st7{fill:url(#New_Pattern_Swatch_9);}
</style>
<pattern  width="52" height="52" patternUnits="userSpaceOnUse" id="New_Pattern_Swatch_5" viewBox="0 -52 52 52" style="overflow:visible;">
	<g>
		<rect y="-52" class="st0" width="52" height="52"/>
		<rect y="-52" class="st1" width="52" height="52"/>
		<circle class="st2" cx="9.25" cy="-43.75" r="1.5"/>
		<circle class="st2" cx="42.25" cy="-22.75" r="1.5"/>
		<circle class="st2" cx="21.25" cy="-27.75" r="1.5"/>
		<circle class="st2" cx="37.25" cy="-39.75" r="1.5"/>
		<circle class="st2" cx="9.25" cy="-6.75" r="1.5"/>
	</g>
</pattern>
<pattern  width="52" height="52" patternUnits="userSpaceOnUse" id="New_Pattern_Swatch_9" viewBox="0 -52 52 52" style="overflow:visible;">
	<g>
		<rect y="-52" class="st0" width="52" height="52"/>
		<rect y="-52" class="st3" width="52" height="52"/>
		<ellipse class="st4" cx="12.75" cy="-21.75" rx="1" ry="8.5"/>
		<ellipse class="st4" cx="4.75" cy="-12.75" rx="1" ry="8.5"/>
		<ellipse class="st4" cx="20.75" cy="-23.75" rx="1" ry="8.5"/>
		<ellipse class="st4" cx="26.75" cy="-11.75" rx="1" ry="8.5"/>
		<ellipse class="st4" cx="30.75" cy="-32.75" rx="1" ry="8.5"/>
		<ellipse class="st4" cx="36.75" cy="-28.75" rx="1" ry="8.5"/>
		<ellipse class="st4" cx="47.75" cy="-41.75" rx="1" ry="8.5"/>
		<ellipse class="st4" cx="43.75" cy="-12.75" rx="1" ry="8.5"/>
		<ellipse class="st4" cx="7.75" cy="-42.75" rx="1" ry="8.5"/>
		<ellipse class="st4" cx="19.75" cy="-42.75" rx="1" ry="8.5"/>
	</g>
</pattern>
<g>
</g>
<circle class="st5" cx="159.65" cy="200.65" r="120.65"/>
<circle class="st6" cx="303.61" cy="280.36" r="166.39"/>
<path class="st7" d="M314.85,254.17l37.13-78.85c6.3-13.39-1.54-29.16-16.02-32.2l-9.26-1.95c-14.64-3.08-28.28,8.39-27.75,23.34
	l3.04,87.02C302.22,258.61,311.83,260.58,314.85,254.17z"/>
<path class="st7" d="M327.46,264.08l67.75-54.84c11.5-9.31,11.3-26.92-0.41-35.97l-7.49-5.78c-11.84-9.14-29.11-4.75-35.15,8.93
	l-35.14,79.67C314.16,262.58,321.95,268.54,327.46,264.08z"/>
<path class="st7" d="M301.52,250.6l-4.7-87.03c-0.8-14.78-15.18-24.94-29.38-20.75l-9.08,2.68c-14.35,4.23-20.92,20.8-13.37,33.71
	l43.94,75.18C292.51,260.5,301.9,257.68,301.52,250.6z"/>
<path class="st7" d="M289.45,256.1l-45.38-74.41c-7.71-12.63-25.19-14.77-35.7-4.35l-6.72,6.66c-10.63,10.52-8.56,28.23,4.2,36.02
	l74.32,45.37C286.21,269.09,293.14,262.16,289.45,256.1z"/>
<path class="st7" d="M279.47,266.86l-74.17-45.78c-12.59-7.77-29.14-1.75-33.8,12.29l-2.98,8.98c-4.71,14.2,5.15,29.04,20.06,30.21
	l86.81,6.79C282.46,279.9,285.51,270.58,279.47,266.86z"/>
<path class="st7" d="M276.41,280.7l-86.97-5.74c-14.77-0.97-26.58,12.09-24.12,26.68l1.57,9.33c2.48,14.75,18.15,23.25,31.87,17.3
	l79.89-34.64C285.16,290.83,283.49,281.17,276.41,280.7z"/>
<path class="st7" d="M279.64,294.68l-79.52,35.67c-13.5,6.06-17.82,23.13-8.81,34.87l5.76,7.51c9.1,11.87,26.93,12.04,36.26,0.36
	l54.36-68.02C292.12,299.53,286.11,291.78,279.64,294.68z"/>
<path class="st7" d="M334.71,276.44l85.28-17.97c14.48-3.05,22.32-18.82,16.01-32.21l-4.03-8.56c-6.38-13.53-23.75-17.49-35.36-8.05
	l-67.56,54.93C323.55,269.05,327.77,277.9,334.71,276.44z"/>
<path class="st7" d="M334.24,291.31l83.77,24.07c14.22,4.09,28.54-6.17,29.23-20.96l0.44-9.45c0.7-14.94-12.8-26.57-27.47-23.67
	l-85.42,16.89C327.84,279.56,327.43,289.36,334.24,291.31z"/>
<path class="st7" d="M328.57,304.58l63.82,59.36c10.84,10.08,28.24,7.4,35.55-5.46l4.67-8.23c7.39-13,0.61-29.49-13.79-33.54
	L335,293.12C328.18,291.2,323.37,299.75,328.57,304.58z"/>
<path class="st7" d="M316.26,311.74l27.51,82.7c4.67,14.04,21.23,20.05,33.81,12.26l8.05-4.98c12.72-7.87,14.68-25.58,3.99-36.04
	l-62.23-60.9C322.33,299.81,314.02,305.01,316.26,311.74z"/>
<path class="st7" d="M302.62,312.74l-15.77,85.72c-2.68,14.56,8.93,27.8,23.71,27.05l9.45-0.48c14.94-0.76,25.2-15.33,20.88-29.65
	l-25.15-83.36C313.69,305.23,303.9,305.77,302.62,312.74z"/>
<path class="st7" d="M288.62,306.31l-54.75,67.82c-9.3,11.52-5.41,28.69,7.94,35.08l8.54,4.09c13.49,6.46,29.46-1.46,32.49-16.1
	l17.66-85.26C301.94,304.98,293.07,300.79,288.62,306.31z"/>
</svg>

```

`gui/src/assets/logo.svg`:

```svg
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1883.29 371.75"><defs><style>.a{fill:none;}.b{fill:#fac369;}.c{fill:#ffa745;}.d{fill:#ed5e40;}.e{fill:#dd8571;}.f{fill:url(#a);}.g{fill:#fcdab5;stroke:#feb157;stroke-miterlimit:10;stroke-width:10px;}.h{fill:url(#b);}.i{fill:url(#o);}.j{fill:#498849;}.k{fill:#5e9b4d;}</style><pattern id="a" x="-39" y="-80" width="52" height="52" patternUnits="userSpaceOnUse" viewBox="0 0 52 52"><rect class="a" width="52" height="52"/><rect class="b" width="52" height="52"/><circle class="c" cx="9.25" cy="8.25" r="1.5"/><circle class="c" cx="42.25" cy="29.25" r="1.5"/><circle class="c" cx="21.25" cy="24.25" r="1.5"/><circle class="c" cx="37.25" cy="12.25" r="1.5"/><circle class="c" cx="9.25" cy="45.25" r="1.5"/></pattern><pattern id="b" width="52" height="52" patternUnits="userSpaceOnUse" viewBox="0 0 52 52"><rect class="a" width="52" height="52"/><rect class="d" width="52" height="52"/><ellipse class="e" cx="12.75" cy="30.25" rx="1" ry="8.5"/><ellipse class="e" cx="4.75" cy="39.25" rx="1" ry="8.5"/><ellipse class="e" cx="20.75" cy="28.25" rx="1" ry="8.5"/><ellipse class="e" cx="26.75" cy="40.25" rx="1" ry="8.5"/><ellipse class="e" cx="30.75" cy="19.25" rx="1" ry="8.5"/><ellipse class="e" cx="36.75" cy="23.25" rx="1" ry="8.5"/><ellipse class="e" cx="47.75" cy="10.25" rx="1" ry="8.5"/><ellipse class="e" cx="43.75" cy="39.25" rx="1" ry="8.5"/><ellipse class="e" cx="7.75" cy="9.25" rx="1" ry="8.5"/><ellipse class="e" cx="19.75" cy="9.25" rx="1" ry="8.5"/></pattern><pattern id="o" width="52" height="52" patternUnits="userSpaceOnUse" viewBox="0 0 52 52"><rect class="a" width="52" height="52"/><rect class="b" width="52" height="52"/><circle class="c" cx="9.25" cy="8.25" r="1.5"/><circle class="c" cx="42.25" cy="29.25" r="1.5"/><circle class="c" cx="21.25" cy="24.25" r="1.5"/><circle class="c" cx="37.25" cy="12.25" r="1.5"/><circle class="c" cx="9.25" cy="45.25" r="1.5"/></pattern></defs><title>grapefruit</title><circle class="f" cx="120.65" cy="120.65" r="120.65"/><circle class="g" cx="264.61" cy="200.36" r="166.39"/><path class="h" d="M314.85,254.17,352,175.31a22.92,22.92,0,0,0-16-32.2l-9.26-2a23,23,0,0,0-27.76,23.34l3,87A6.77,6.77,0,0,0,314.85,254.17Z" transform="translate(-39 -80)"/><path class="h" d="M327.46,264.08l67.74-54.84a22.91,22.91,0,0,0-.41-36l-7.49-5.79a23,23,0,0,0-35.14,8.94L317,256.09A6.76,6.76,0,0,0,327.46,264.08Z" transform="translate(-39 -80)"/><path class="h" d="M301.52,250.6l-4.7-87a22.92,22.92,0,0,0-29.38-20.75l-9.07,2.67A23,23,0,0,0,245,179.2l43.93,75.18A6.76,6.76,0,0,0,301.52,250.6Z" transform="translate(-39 -80)"/><path class="h" d="M289.45,256.1l-45.38-74.4a22.93,22.93,0,0,0-35.71-4.36L201.64,184a23,23,0,0,0,4.2,36l74.32,45.37A6.76,6.76,0,0,0,289.45,256.1Z" transform="translate(-39 -80)"/><path class="h" d="M279.47,266.86,205.3,221.08a22.92,22.92,0,0,0-33.8,12.29l-3,9a23,23,0,0,0,20.06,30.21l86.81,6.79A6.76,6.76,0,0,0,279.47,266.86Z" transform="translate(-39 -80)"/><path class="h" d="M276.41,280.7l-87-5.74a22.92,22.92,0,0,0-24.11,26.69L166.9,311a23,23,0,0,0,31.87,17.3l79.88-34.63A6.76,6.76,0,0,0,276.41,280.7Z" transform="translate(-39 -80)"/><path class="h" d="M279.64,294.68l-79.52,35.67a22.93,22.93,0,0,0-8.81,34.87l5.76,7.51a23,23,0,0,0,36.26.36l54.36-68A6.76,6.76,0,0,0,279.64,294.68Z" transform="translate(-39 -80)"/><path class="h" d="M334.71,276.44l85.28-18a22.93,22.93,0,0,0,16-32.21l-4-8.56a23,23,0,0,0-35.36-8l-67.56,54.93A6.76,6.76,0,0,0,334.71,276.44Z" transform="translate(-39 -80)"/><path class="h" d="M334.24,291.31,418,315.38a22.92,22.92,0,0,0,29.23-21l.45-9.45a23,23,0,0,0-27.47-23.67L334.8,278.18A6.76,6.76,0,0,0,334.24,291.31Z" transform="translate(-39 -80)"/><path class="h" d="M328.57,304.58l63.81,59.36a22.93,22.93,0,0,0,35.55-5.46l4.68-8.23a23,23,0,0,0-13.79-33.54L335,293.12A6.76,6.76,0,0,0,328.57,304.58Z" transform="translate(-39 -80)"/><path class="h" d="M316.26,311.74l27.51,82.7a22.92,22.92,0,0,0,33.81,12.26l8.05-5a23,23,0,0,0,4-36L327.4,304.77A6.76,6.76,0,0,0,316.26,311.74Z" transform="translate(-39 -80)"/><path class="h" d="M302.62,312.74l-15.77,85.72a22.93,22.93,0,0,0,23.71,27.05L320,425a23,23,0,0,0,20.88-29.65L315.74,312A6.76,6.76,0,0,0,302.62,312.74Z" transform="translate(-39 -80)"/><path class="h" d="M288.62,306.31l-54.75,67.82a22.92,22.92,0,0,0,7.94,35.08l8.54,4.08a23,23,0,0,0,32.49-16.1l17.66-85.26A6.76,6.76,0,0,0,288.62,306.31Z" transform="translate(-39 -80)"/><path class="i" d="M601.84,355.8a32.37,32.37,0,0,1-32.4-32.4v-108a32.37,32.37,0,0,1,32.4-32.4h108a32.37,32.37,0,0,1,32.4,32.4v11.76h-29v-6.72q0-6-1.32-7.2t-7.32-1.2H606.88q-6,0-7.32,1.2t-1.32,7.2v97.92q0,6,1.32,7.2t7.32,1.2h97.68q6,0,7.32-1.2t1.32-7.2V288.6H673.36v-29h68.88V323.4a32.37,32.37,0,0,1-32.4,32.4Z" transform="translate(-39 -80)"/><path class="i" d="M767.68,355.8v-107a32.37,32.37,0,0,1,32.16-32.16h77.52v28.56H804.88c-4,0-6.45.44-7.32,1.32s-1.32,3.32-1.32,7.32v102Z" transform="translate(-39 -80)"/><path class="i" d="M927,355.8a30.83,30.83,0,0,1-22.8-9.48,31.15,31.15,0,0,1-9.36-22.68V271.8h112.8v-18q0-6-1.32-7.32T999,245.16H894.87V216.6h109.2a30.83,30.83,0,0,1,22.8,9.48,31.15,31.15,0,0,1,9.36,22.68v107Zm5-28.56h75.6V298H923.43V318.6q0,6,1.32,7.32T932.07,327.24Z" transform="translate(-39 -80)"/><path class="i" d="M1061.91,411V216.6h109.44a30.55,30.55,0,0,1,22.56,9.48,31.15,31.15,0,0,1,9.36,22.68v74.88a31.15,31.15,0,0,1-9.36,22.68,30.55,30.55,0,0,1-22.56,9.48h-80.88V411Zm37.44-83.76h66.72q6,0,7.32-1.32t1.32-7.32V253.8q0-6-1.32-7.32t-7.32-1.32h-66.72q-6,0-7.44,1.32t-1.44,7.32v64.8q0,6,1.44,7.32T1099.35,327.24Z" transform="translate(-39 -80)"/><path class="i" d="M1252.71,355.8a32.37,32.37,0,0,1-32.16-32.16V248.76a32.37,32.37,0,0,1,32.16-32.16h77a30.83,30.83,0,0,1,22.8,9.48,31.15,31.15,0,0,1,9.36,22.68V300.6h-112.8v18c0,4,.43,6.44,1.32,7.32s3.32,1.32,7.32,1.32h104.16V355.8Zm-3.6-81.36h84.24V253.8c0-4-.45-6.44-1.32-7.32s-3.33-1.32-7.32-1.32h-67c-4,0-6.45.44-7.32,1.32s-1.32,3.32-1.32,7.32Z" transform="translate(-39 -80)"/><path class="i" d="M1387.1,355.8V203.16A32,32,0,0,1,1419.26,171h52.08v28.8h-47q-6,0-7.32,1.32t-1.32,7.08v8.4h55.68v28.56h-55.68V355.8Z" transform="translate(-39 -80)"/><path class="i" d="M1488.62,355.8v-107a32.37,32.37,0,0,1,32.16-32.16h77.52v28.56h-72.48q-6,0-7.32,1.32t-1.32,7.32v102Z" transform="translate(-39 -80)"/><path class="i" d="M1648.22,355.8a30.83,30.83,0,0,1-22.8-9.48,31.15,31.15,0,0,1-9.36-22.68v-107h28.56v102q0,6,1.32,7.32t7.32,1.32h67q6,0,7.32-1.32t1.32-7.32v-102h28.56v107a31.15,31.15,0,0,1-9.36,22.68,30.83,30.83,0,0,1-22.8,9.48Z" transform="translate(-39 -80)"/><path class="i" d="M1782.62,355.8V216.6h28.56V355.8Z" transform="translate(-39 -80)"/><path class="i" d="M1870.21,355.8a30.83,30.83,0,0,1-22.8-9.48,31.15,31.15,0,0,1-9.36-22.68V173.16h28.56V216.6h55.68v28.56h-55.68V318.6q0,6,1.32,7.32t7.32,1.32h47V355.8Z" transform="translate(-39 -80)"/><path class="j" d="M1832.32,129s4.27,27.13-6.44,45-37.3,26.87-37.3,26.87-1-28.08,9.16-45.11S1832.32,129,1832.32,129Z" transform="translate(-39 -80)"/><path class="k" d="M1832.32,129A88,88,0,0,0,1803,149.35c-11.43,13.11-13.13,34.7-13.13,34.7s25.17,2.34,35.27-13.17C1834.75,156.07,1832.32,129,1832.32,129Z" transform="translate(-39 -80)"/></svg>
```

`gui/src/components/layout/BottomPanelView.tsx`:

```tsx
import { useEffect, useState, useRef } from "react";
import { t } from "i18next";
import { useQuery } from "@tanstack/react-query";
import {
  FileText,
  Activity,
  Anchor,
  Terminal,
  Lock,
} from "lucide-react";

import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import { Status, Platform, useSession } from "@/context/SessionContext";

import { LogPanel, type LogViewerHandle } from "../shared/LogPanel";
import { HookResultsView } from "../shared/HookResultsView";
import { CryptoResultsView } from "../shared/CryptoResultsView";
import { CodeScratchPadTab } from "../tabs/CodeScratchPadTab";

const BOTTOM_PANEL_TAB_STATE = "BOTTOM_PANEL_TAB_STATE";

export function BottomPanelView() {
  const { fruity, droid, platform, status, socket, device, identifier } =
    useSession();
  const [activeTab, setActiveTab] = useState<string>(() => {
    try {
      return localStorage.getItem(BOTTOM_PANEL_TAB_STATE) || "logs";
    } catch {
      return "logs";
    }
  });

  const syslogRef = useRef<LogViewerHandle>(null);
  const logRef = useRef<LogViewerHandle>(null);


  const { data: syslogHistory } = useQuery<string>({
    queryKey: ["logHistory", device, identifier, "syslog"],
    queryFn: async () => {
      const res = await fetch(
        `/api/logs/${device}/${identifier}/syslog?limit=5000`,
      );
      if (!res.ok) throw new Error("Failed to load syslog history");
      return res.text();
    },
    enabled: !!device && !!identifier,
    staleTime: Infinity,
    gcTime: 0,
  });

  const { data: agentLogHistory } = useQuery<string>({
    queryKey: ["logHistory", device, identifier, "agent"],
    queryFn: async () => {
      const res = await fetch(
        `/api/logs/${device}/${identifier}/agent?limit=5000`,
      );
      if (!res.ok) throw new Error("Failed to load agent log history");
      return res.text();
    },
    enabled: !!device && !!identifier,
    staleTime: Infinity,
    gcTime: 0,
  });

  useEffect(() => {
    if (syslogHistory && syslogHistory.length > 0) {
      syslogRef.current?.append(syslogHistory);
    }
  }, [syslogHistory]);

  useEffect(() => {
    if (agentLogHistory && agentLogHistory.length > 0) {
      logRef.current?.append(agentLogHistory);
    }
  }, [agentLogHistory]);

  useEffect(() => {
    const syslogApi = platform === Platform.Droid ? droid : fruity;
    syslogApi?.syslog.start();

    return () => {
      syslogApi?.syslog.stop();
    };
  }, [fruity, droid, platform, status, socket]);

  useEffect(() => {
    const handleSyslog = (message: string) => {
      syslogRef.current?.append(message);
    };
    const handleLog = (level: string, message: string) => {
      logRef.current?.append(`[${level}] ${message}`);
    };

    if (status === Status.Ready && socket) {
      socket.on("syslog", handleSyslog);
      socket.on("log", handleLog);
    }

    return () => {
      if (socket) {
        socket.off("syslog", handleSyslog);
        socket.off("log", handleLog);
      }
    };
  }, [socket, status]);

  useEffect(() => {
    localStorage.setItem(BOTTOM_PANEL_TAB_STATE, activeTab);
  }, [activeTab]);

  // Listen for REPL content additions to auto-switch to REPL tab
  useEffect(() => {
    const handleReplContentAdded = () => {
      setActiveTab("repl");
    };

    window.addEventListener("repl:content-added", handleReplContentAdded);
    return () => {
      window.removeEventListener("repl:content-added", handleReplContentAdded);
    };
  }, []);

  return (
    <Tabs
      value={activeTab}
      onValueChange={setActiveTab}
      className="h-full flex flex-col"
    >
      <TabsList className="w-full justify-start rounded-none border-b bg-transparent p-0">
        <TabsTrigger
          value="logs"
          className="rounded-none border-b-2 border-transparent data-active:border-primary flex items-center gap-2"
        >
          <FileText className="h-4 w-4" />
          {t("logs")}
        </TabsTrigger>
        <TabsTrigger
          value="hooks"
          className="rounded-none border-b-2 border-transparent data-active:border-primary flex items-center gap-2"
        >
          <Anchor className="h-4 w-4" />
          {t("hooks")}
        </TabsTrigger>
        <TabsTrigger
          value="crypto"
          className="rounded-none border-b-2 border-transparent data-active:border-primary flex items-center gap-2"
        >
          <Lock className="h-4 w-4" />
          {t("crypto_results")}
        </TabsTrigger>
        <TabsTrigger
          value="agent-logs"
          className="rounded-none border-b-2 border-transparent data-active:border-primary flex items-center gap-2"
        >
          <Activity className="h-4 w-4" />
          {t("agent_logs")}
        </TabsTrigger>
        <TabsTrigger
          value="repl"
          className="rounded-none border-b-2 border-transparent data-active:border-primary flex items-center gap-2"
        >
          <Terminal className="h-4 w-4" />
          {t("code_scratch_pad")}
        </TabsTrigger>
      </TabsList>
      <TabsContent
        value="logs"
        className="flex-1 overflow-hidden mt-0"
        keepMounted
        hidden={activeTab !== "logs"}
      >
        <LogPanel
          ref={syslogRef}
          downloadUrl={`/api/logs/${device}/${identifier}/syslog?download=1`}
          onClear={() => socket?.emit("clearLog", "syslog", () => {})}
        />
      </TabsContent>
      <TabsContent
        value="hooks"
        className="flex-1 overflow-hidden mt-0"
        keepMounted
        hidden={activeTab !== "hooks"}
      >
        <HookResultsView />
      </TabsContent>
      <TabsContent
        value="crypto"
        className="flex-1 overflow-hidden mt-0"
        keepMounted
        hidden={activeTab !== "crypto"}
      >
        <CryptoResultsView />
      </TabsContent>
      <TabsContent
        value="agent-logs"
        className="flex-1 overflow-hidden mt-0"
        keepMounted
        hidden={activeTab !== "agent-logs"}
      >
        <LogPanel
          ref={logRef}
          downloadUrl={`/api/logs/${device}/${identifier}/agent?download=1`}
          onClear={() => socket?.emit("clearLog", "agent", () => {})}
        />
      </TabsContent>
      <TabsContent
        value="repl"
        className="flex-1 overflow-hidden mt-0"
        keepMounted
        hidden={activeTab !== "repl"}
      >
        <CodeScratchPadTab />
      </TabsContent>
    </Tabs>
  );
}

```

`gui/src/components/layout/LeftPanelView.tsx`:

```tsx
import { Link, NavLink, Outlet } from "react-router";
import { t } from "i18next";
import {
  Info,
  Package,
  Braces,
  Link as LinkIcon,
  MapPin,
  Anchor,
  Blocks,
  Puzzle,
  Smartphone,
} from "lucide-react";

import {
  Tooltip,
  TooltipContent,
  TooltipTrigger,
} from "@/components/ui/tooltip";
import { DarkmodeToggle } from "../shared/DarkmodeToggle";
import { LanguageSelector } from "../shared/LanguageSelector";
import { useSession, Platform, Mode } from "@/context/SessionContext";

import logo from "../../assets/grapefruit.svg";

interface NavItemProps {
  to: string;
  icon: React.ReactNode;
  label: string;
}

function NavItem({ to, icon, label }: NavItemProps) {
  return (
    <NavLink
      to={to}
      className={({ isActive }) =>
        `p-2 flex items-center justify-center hover:bg-sidebar-accent transition-colors ${
          isActive ? "bg-sidebar-accent border-l-2 border-primary" : ""
        }`
      }
    >
      <Tooltip>
        <TooltipTrigger>{icon}</TooltipTrigger>
        <TooltipContent side="right">{label}</TooltipContent>
      </Tooltip>
    </NavLink>
  );
}

interface ActionNavItemProps {
  icon: React.ReactNode;
  label: string;
  onClick: () => void;
}

function ActionNavItem({ icon, label, onClick }: ActionNavItemProps) {
  return (
    <div
      role="button"
      tabIndex={0}
      onClick={onClick}
      onKeyDown={(e) => { if (e.key === "Enter" || e.key === " ") onClick(); }}
      className="p-2 flex items-center justify-center hover:bg-sidebar-accent transition-colors cursor-pointer"
    >
      <Tooltip>
        <TooltipTrigger>{icon}</TooltipTrigger>
        <TooltipContent side="right">{label}</TooltipContent>
      </Tooltip>
    </div>
  );
}

type NavEntry =
  | { kind: "route"; route: string; icon: React.ReactNode; label: string }
  | { kind: "action"; id: string; icon: React.ReactNode; label: string; action: () => void };

export function LeftPanelView() {
  const { device, bundle, platform, mode, pid } = useSession();
  // Determine the target for URL (bundle for app mode, pid for daemon mode)
  const target = mode === Mode.App ? bundle : pid;
  const basePath = `/workspace/${platform}/${device}/${mode}/${target}`;

  const navKey = `${platform}:${mode}`;
  const navItems: NavEntry[] = ({
    [`${Platform.Fruity}:${Mode.App}`]: [
      { kind: "route", route: "general", icon: <Info className="h-5 w-5" />, label: t("general") },
      { kind: "route", route: "modules", icon: <Package className="h-5 w-5" />, label: t("modules") },
      { kind: "route", route: "classes", icon: <Braces className="h-5 w-5" />, label: t("classes") },
      { kind: "route", route: "urls", icon: <LinkIcon className="h-5 w-5" />, label: "URL Schemes" },
      { kind: "route", route: "extensions", icon: <Blocks className="h-5 w-5" />, label: "Extensions" },
      { kind: "route", route: "hooks", icon: <Anchor className="h-5 w-5" />, label: t("hooks") },
      { kind: "route", route: "device", icon: <Smartphone className="h-5 w-5" />, label: t("device_info") },
      { kind: "route", route: "geolocation", icon: <MapPin className="h-5 w-5" />, label: t("geolocation_simulation") },
    ],
    [`${Platform.Fruity}:${Mode.Daemon}`]: [
      { kind: "route", route: "modules", icon: <Package className="h-5 w-5" />, label: t("modules") },
      { kind: "route", route: "classes", icon: <Braces className="h-5 w-5" />, label: t("classes") },
      { kind: "route", route: "hooks", icon: <Anchor className="h-5 w-5" />, label: t("hooks") },
      { kind: "route", route: "device", icon: <Smartphone className="h-5 w-5" />, label: t("device_info") },
    ],
    [`${Platform.Droid}:${Mode.App}`]: [
      { kind: "route", route: "general", icon: <Info className="h-5 w-5" />, label: t("general") },
      { kind: "route", route: "components", icon: <Puzzle className="h-5 w-5" />, label: t("components") },
      { kind: "route", route: "classes", icon: <Braces className="h-5 w-5" />, label: t("classes") },
      { kind: "route", route: "urls", icon: <LinkIcon className="h-5 w-5" />, label: "URL Schemes" },
      { kind: "route", route: "hooks", icon: <Anchor className="h-5 w-5" />, label: t("hooks") },
      { kind: "route", route: "modules", icon: <Package className="h-5 w-5" />, label: t("modules") },
      { kind: "route", route: "device", icon: <Smartphone className="h-5 w-5" />, label: t("device_info") },
    ],
    [`${Platform.Droid}:${Mode.Daemon}`]: [
      { kind: "route", route: "modules", icon: <Package className="h-5 w-5" />, label: t("modules") },
      { kind: "route", route: "classes", icon: <Braces className="h-5 w-5" />, label: t("classes") },
      { kind: "route", route: "hooks", icon: <Anchor className="h-5 w-5" />, label: t("hooks") },
      { kind: "route", route: "device", icon: <Smartphone className="h-5 w-5" />, label: t("device_info") },
    ],
  } satisfies Record<string, NavEntry[]>)[navKey] ?? [];

  return (
    <div className="flex h-full">
      <div className="w-16 bg-sidebar border-r border-sidebar-border flex flex-col">
        <div className="p-2 flex items-center justify-center border-b border-sidebar-border">
          <Link to={`/list/${device}/apps`} className="flex items-center">
            <img src={logo} alt={t("logo_alt")} className="h-6 w-6" />
          </Link>
        </div>

        {navItems.length > 0 ? (
          <div className="flex-1 flex flex-col gap-1 pt-2">
            {navItems.map((item) =>
              item.kind === "route" ? (
                <NavItem
                  key={item.route}
                  to={`${basePath}/${item.route}`}
                  icon={item.icon}
                  label={item.label}
                />
              ) : (
                <ActionNavItem
                  key={item.id}
                  icon={item.icon}
                  label={item.label}
                  onClick={item.action}
                />
              ),
            )}
          </div>
        ) : (
          <div className="flex-1" />
        )}

        {/* Settings at bottom */}
        <div className="flex flex-col gap-1 py-2 items-center">
          <LanguageSelector />
          <DarkmodeToggle />
        </div>
      </div>

      <div className="flex-1 overflow-auto">
        <Outlet />
      </div>
    </div>
  );
}

```

`gui/src/components/layout/StatusBar.tsx`:

```tsx
import { useTranslation } from "react-i18next";
import { useNavigate } from "react-router";
import { useMutation } from "@tanstack/react-query";
import {
  PanelBottomClose,
  PanelBottomOpen,
  RefreshCw,
  XCircle,
  Unplug,
  Circle,
  Loader2,
  CircleAlert,
} from "lucide-react";

import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";

import { Status, useSession } from "@/context/SessionContext";

interface StatusBarProps {
  bottomPanelVisible: boolean;
  setBottomPanelVisible: (visible: boolean) => void;
}

export function StatusBar({
  bottomPanelVisible,
  setBottomPanelVisible,
}: StatusBarProps) {
  const { t } = useTranslation();
  const { status, device, pid } = useSession();
  const navigate = useNavigate();

  const getStatusColor = () => {
    switch (status) {
      case Status.Ready:
        return "bg-green-600 dark:bg-green-900";
      case Status.Disconnected:
        return "bg-orange-500 dark:bg-orange-900";
      case Status.Connecting:
      default:
        return "bg-muted text-muted-foreground";
    }
  };

  const getStatusIcon = () => {
    switch (status) {
      case Status.Ready:
        return <Circle className="w-3 h-3 fill-current" />;
      case Status.Disconnected:
        return <CircleAlert className="w-3 h-3" />;
      case Status.Connecting:
      default:
        return <Loader2 className="w-3 h-3 animate-spin" />;
    }
  };

  const handleReloadPage = () => {
    window.location.reload();
  };

  const killProcessMutation = useMutation({
    mutationFn: async () => {
      const res = await fetch(`/api/device/${device}/kill/${pid}`, { method: "POST" });
      if (!res.ok) throw new Error("Failed to kill process");
    },
    onSuccess: () => {
      navigate(`/list/${device}/apps`);
    },
  });

  const handleKillProcess = () => {
    if (!device || !pid) return;
    killProcessMutation.mutate();
  };

  const handleDetach = () => {
    if (device) {
      navigate(`/list/${device}/apps`);
    }
  };

  return (
    <footer
      className={`${getStatusColor()} px-4 py-1 text-sm text-white flex items-center justify-between`}
    >
      <div className="flex items-center gap-1">
        <DropdownMenu>
          <DropdownMenuTrigger
            render={
              <button
                type="button"
                className="hover:bg-white/20 px-1 py-0.5 rounded transition-colors cursor-pointer flex items-center gap-1.5"
              />
            }
          >
            {getStatusIcon()}
            {status === Status.Ready && t("connected")}
            {status === Status.Connecting && t("connecting")}
            {status === Status.Disconnected && t("disconnected")}
          </DropdownMenuTrigger>
          <DropdownMenuContent align="start">
            <DropdownMenuItem onClick={handleReloadPage}>
              <RefreshCw className="w-4 h-4 mr-2" />
              {t("reload_page")}
            </DropdownMenuItem>
            <DropdownMenuItem
              onClick={handleKillProcess}
              disabled={status !== Status.Ready}
            >
              <XCircle className="w-4 h-4 mr-2" />
              {t("kill_process")}
            </DropdownMenuItem>
            <DropdownMenuItem onClick={handleDetach}>
              <Unplug className="w-4 h-4 mr-2" />
              {t("detach")}
            </DropdownMenuItem>
          </DropdownMenuContent>
        </DropdownMenu>
        {status === Status.Disconnected && (
          <button
            type="button"
            onClick={handleReloadPage}
            className="hover:bg-white/20 px-1 py-0.5 rounded transition-colors flex items-center gap-1"
          >
            <RefreshCw className="w-3 h-3" />
            {t("reload")}
          </button>
        )}
      </div>
      <button
        type="button"
        onClick={() => setBottomPanelVisible(!bottomPanelVisible)}
        className="p-0.5 hover:bg-white/20 rounded transition-colors"
        title={bottomPanelVisible ? t("hide_panel") : t("show_panel")}
      >
        {bottomPanelVisible ? (
          <PanelBottomClose className="w-4 h-4" />
        ) : (
          <PanelBottomOpen className="w-4 h-4" />
        )}
      </button>
    </footer>
  );
}

```

`gui/src/components/layout/Workspace.tsx`:

```tsx
import { useEffect, useMemo, useRef, useState } from "react";
import { t } from "i18next";
import { StatusBar } from "./StatusBar";

import {
  type DockviewApi,
  type DockviewTheme,
  DockviewReact,
  type DockviewReadyEvent,
} from "dockview";

import type { PanelImperativeHandle } from "react-resizable-panels";
import {
  ResizableHandle,
  ResizablePanel,
  ResizablePanelGroup,
} from "@/components/ui/resizable";

import { LeftPanelView } from "./LeftPanelView";
import { BottomPanelView } from "./BottomPanelView";
import { useSession } from "@/context/SessionContext";
import SessionProvider from "../providers/SessionProvider";
import { FruityHandlesTab } from "../tabs/FruityHandlesTab";
import { FruityInfoPlistTab } from "../tabs/FruityInfoPlistTab";
import { FruityEntitlementsTab } from "../tabs/FruityEntitlementsTab";
import {
  ModuleImportsTab,
  ModuleSectionsTab,
  ModuleClassesTab,
  ModuleSymbolsTab,
  ModuleExportedTab,
} from "../tabs/ModuleViewTabs";
import { FruityClassDetailTab } from "../tabs/FruityClassDetailTab";
import { FruityClassDumpTab } from "../tabs/FruityClassDumpTab";
import { DroidClassDetailTab } from "../tabs/DroidClassDetailTab";
import { FinderTab } from "../tabs/FinderTab";
import { ImagePreviewTab } from "../tabs/ImagePreviewTab";
import { HexPreviewTab } from "../tabs/HexPreviewTab";
import { TextEditorTab } from "../tabs/TextEditorTab";
import { FruityPlistPreviewTab } from "../tabs/FruityPlistPreviewTab";
import { SQLiteEditorTab } from "../tabs/SQLiteEditorTab";
import { FontPreviewTab } from "../tabs/FontPreviewTab";
import { FruityBinaryCookieTab } from "../tabs/FruityBinaryCookieTab";
import { FruityKeychainTab } from "../tabs/FruityKeychainTab";
import { FruityUIDumpTab } from "../tabs/FruityUIDumpTab";
import { MemoryPreviewTab } from "../tabs/MemoryPreviewTab";
import { MemoryScanTab } from "../tabs/MemoryScanTab";
import { FruityWebViewTab } from "../tabs/FruityWebViewTab";
import { FruityJSCTab } from "../tabs/FruityJSCTab";
import { FruityUserDefaultsTab } from "../tabs/FruityUserDefaultsTab";
import { HomeTab } from "../tabs/HomeTab";
import { FruityDisassemblyTab } from "../tabs/FruityDisassemblyTab";
import { FruityNSURLTab } from "../tabs/FruityNSURLTab";
import { FlutterMethodChannelsTab } from "../tabs/FlutterMethodChannelsTab";
import { JNITab } from "../tabs/DroidJNITab";
import { DroidHandlesTab } from "../tabs/DroidHandlesTab";
import { DroidKeystoreTab } from "../tabs/DroidKeystoreTab";
import { FruityInfoPlistInsightsTab } from "../tabs/FruityInfoPlistInsightsTab";
import { DroidManifestTab } from "../tabs/DroidManifestTab";
import { DroidProvidersTab } from "../tabs/DroidProvidersTab";
import { FruityXPCTab } from "../tabs/FruityXPCTab";
import { ReactNativeTab } from "../tabs/ReactNativeTab";
import { NoCloseTabHeader } from "../tabs/NoCloseTabHeader";

import { DockContext, useDockActions } from "@/context/DockContext";
import { R2Provider } from "../providers/R2Provider";

const themeApp: DockviewTheme = {
  name: "app",
  className: "dockview-theme-app",
};

function WorkspaceContent() {
  const { bundle, device, mode, pid } = useSession();

  useEffect(() => {
    const target = bundle || (pid ? `PID ${pid}` : "");
    document.title = "Grapefruit" + (target ? ` - ${target}` : "");
  }, [bundle, pid]);

  const [bottomPanelVisible, setBottomPanelVisible] = useState(() => {
    try {
      const saved = localStorage.getItem("workspace-bottom-panel-visible");
      return saved !== null ? JSON.parse(saved) : true;
    } catch {
      return true;
    }
  });

  useEffect(() => {
    localStorage.setItem(
      "workspace-bottom-panel-visible",
      JSON.stringify(bottomPanelVisible),
    );
    const panel = bottomPanelRef.current;
    if (!panel) return;
    if (bottomPanelVisible) {
      panel.expand();
    } else {
      panel.collapse();
    }
    mountedRef.current = true;
  }, [bottomPanelVisible]);

  const bottomPanelRef = useRef<PanelImperativeHandle>(null);
  const mountedRef = useRef(false);

  const [dockApi, setDockApi] = useState<DockviewApi | null>(null);
  const { openSingletonPanel, openFilePanel } = useDockActions(dockApi);

  const dockContextValue = useMemo(
    () => ({
      api: dockApi,
      openSingletonPanel,
      openFilePanel,
    }),
    [dockApi, openSingletonPanel, openFilePanel],
  );

  const components = {
    home: HomeTab,
    handles: FruityHandlesTab,
    infoPlist: FruityInfoPlistTab,
    entitlements: FruityEntitlementsTab,
    moduleDetail: ModuleImportsTab,
    moduleImports: ModuleImportsTab,
    moduleSections: ModuleSectionsTab,
    moduleClasses: ModuleClassesTab,
    moduleSymbols: ModuleSymbolsTab,
    moduleExported: ModuleExportedTab,
    classDetail: FruityClassDetailTab,
    classDump: FruityClassDumpTab,
    javaClassDetail: DroidClassDetailTab,
    finder: FinderTab,
    imagePreview: ImagePreviewTab,
    hexPreview: HexPreviewTab,
    textEditor: TextEditorTab,
    plistPreview: FruityPlistPreviewTab,
    sqliteEditor: SQLiteEditorTab,
    fontPreview: FontPreviewTab,
    binaryCookie: FruityBinaryCookieTab,
    keychain: FruityKeychainTab,
    uiDump: FruityUIDumpTab,
    memory: MemoryPreviewTab,
    memoryScan: MemoryScanTab,
    webview: FruityWebViewTab,
    jsc: FruityJSCTab,
    userdefaults: FruityUserDefaultsTab,
    disassembly: FruityDisassemblyTab,
    nsurl: FruityNSURLTab,
    flutterChannels: FlutterMethodChannelsTab,
    jni: JNITab,
    droidHandles: DroidHandlesTab,
    keystore: DroidKeystoreTab,
    infoPlistInsights: FruityInfoPlistInsightsTab,
    droidManifest: DroidManifestTab,
    droidProviders: DroidProvidersTab,
    xpc: FruityXPCTab,
    reactNative: ReactNativeTab,
  };

  const tabComponents = {
    noClose: NoCloseTabHeader,
  };

  const getLayoutKey = () => {
    if (!device) return null;
    const target = bundle || pid;
    if (!target) return null;
    return `workspace-dockview-layout:${device}:${mode}:${target}`;
  };

  const onReady = (event: DockviewReadyEvent) => {
    setDockApi(event.api);

    const layoutKey = getLayoutKey();
    const savedLayoutWithMeta = layoutKey
      ? localStorage.getItem(layoutKey)
      : null;

    if (savedLayoutWithMeta) {
      try {
        const { layout } = JSON.parse(savedLayoutWithMeta);
        event.api.fromJSON(layout);
      } catch (e) {
        console.error("Failed to restore dockview layout:", e);
        if (layoutKey) {
          localStorage.removeItem(layoutKey);
        }
        createDefaultLayout(event.api);
      }
    } else {
      createDefaultLayout(event.api);
    }

    event.api.onDidLayoutChange(() => {
      const layout = event.api.toJSON();
      const key = getLayoutKey();
      if (key) {
        localStorage.setItem(
          key,
          JSON.stringify({ device, mode, target: bundle || pid, layout }),
        );
      }
    });
  };

  const createDefaultLayout = (dockApi: DockviewApi) => {
    dockApi.addPanel({
      id: "home_tab",
      component: "home",
      tabComponent: "noClose",
      title: t("home"),
    });
  };

  return (
    <DockContext.Provider value={dockContextValue}>
      <div className="flex h-screen flex-col">
        <ResizablePanelGroup
          orientation="horizontal"
          className="h-full"
          autoSaveId="workspace-left-split"
        >
          <ResizablePanel
            defaultSize="20%"
            minSize="15%"
            className="flex flex-col"
          >
            <LeftPanelView />
          </ResizablePanel>
          <ResizableHandle withHandle />
          <ResizablePanel>
            <ResizablePanelGroup
              orientation="vertical"
              className="h-full"
              autoSaveId="workspace-bottom-split"
            >
              <ResizablePanel id="dock">
                <DockviewReact
                  theme={themeApp}
                  onReady={onReady}
                  components={components}
                  tabComponents={tabComponents}
                />
              </ResizablePanel>
              <ResizableHandle />
              <ResizablePanel
                id="bottom"
                panelRef={bottomPanelRef}
                defaultSize="30%"
                minSize="10%"
                collapsible
                collapsedSize={0}
                onResize={(size) => {
                  if (!mountedRef.current) return;
                  setBottomPanelVisible(size.asPercentage > 0);
                }}
              >
                <BottomPanelView />
              </ResizablePanel>
            </ResizablePanelGroup>
          </ResizablePanel>
        </ResizablePanelGroup>
        <StatusBar
          bottomPanelVisible={bottomPanelVisible}
          setBottomPanelVisible={setBottomPanelVisible}
        />
      </div>
    </DockContext.Provider>
  );
}

export function Workspace() {
  return (
    <SessionProvider>
      <R2Provider>
        <WorkspaceContent />
      </R2Provider>
    </SessionProvider>
  );
}

```

`gui/src/components/layout/WorkspaceIndex.tsx`:

```tsx
import { Navigate } from "react-router";
import { Mode, useSession } from "@/context/SessionContext";

/**
 * Redirects to the default tab for the workspace based on platform and mode.
 * This ensures the URL reflects the active sidebar tab.
 */
export function WorkspaceIndex() {
  const { mode } = useSession();

  if (mode === Mode.App) {
    return <Navigate to="general" replace />;
  }

  if (mode === Mode.Daemon) {
    return <Navigate to="modules" replace />;
  }

  return <Navigate to="general" replace />;
}

```

`gui/src/components/pages/AppsView.tsx`:

```tsx
import { useParams, Link, useSearchParams } from "react-router";
import { useTranslation } from "react-i18next";
import { AlertCircleIcon, Search } from "lucide-react";
import { useQuery } from "@tanstack/react-query";
import { useState } from "react";

import { Badge } from "@/components/ui/badge";
import { Skeleton } from "@/components/ui/skeleton";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";

interface Application {
  name: string;
  identifier: string;
  pid: number;
}

import type { DeviceInfo } from "@/types/device";

function AppCardSkeleton() {
  return (
    <div className="block rounded-lg p-6 max-w-40 mx-auto">
      <div className="mb-3 flex items-center justify-center">
        <Skeleton className="h-16 w-16 rounded-2xl" />
      </div>
      <div className="space-y-1 text-center">
        <Skeleton className="mx-auto h-5 w-24" />
        <Skeleton className="mx-auto h-3 w-28" />
      </div>
    </div>
  );
}

function getPlatformFromDeviceInfo(
  info: DeviceInfo | undefined,
): "fruity" | "droid" {
  if (info?.os?.name?.toLowerCase().includes("android")) {
    return "droid";
  }
  return "fruity";
}

interface AppCardProps {
  app: Application;
  udid: string;
  platform: "fruity" | "droid";
}

function AppCard({ app, udid, platform }: AppCardProps) {
  return (
    <Link
      to={`/workspace/${platform}/${udid}/app/${app.identifier}`}
      className="block rounded-lg p-6 transition-colors hover:bg-accent dark:hover:bg-accent max-w-40 mx-auto"
    >
      <div className="relative mb-3 flex items-center justify-center">
        <img
          src={`/api/device/${udid}/icon/${app.identifier}`}
          alt={app.name}
          loading="lazy"
          className="h-16 w-16 rounded-2xl"
          onError={(e) => {
            e.currentTarget.src =
              "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='48' height='48'%3E%3Crect width='48' height='48' fill='%23ddd'/%3E%3C/svg%3E";
          }}
        />
        {app.pid !== 0 && (
          <Badge
            className="absolute -right-1 -top-1 bg-green-500 px-1 py-0 text-xs"
            variant="default"
          >
            {app.pid}
          </Badge>
        )}
      </div>
      <div className="space-y-1 text-center">
        <p className="line-clamp-2 text-sm font-medium leading-tight dark:text-foreground">
          {app.name}
        </p>
        <p className="line-clamp-1 text-xs text-muted-foreground">
          {app.identifier}
        </p>
      </div>
    </Link>
  );
}

export function AppsView() {
  const { udid } = useParams();
  const { t } = useTranslation();
  const [searchParams] = useSearchParams();
  const platformParam = searchParams.get("platform");
  const [searchQuery, setSearchQuery] = useState("");

  const {
    data: apps = [],
    isLoading: appsLoading,
    error: appsError,
  } = useQuery<Application[], Error>({
    queryKey: ["apps", udid, platformParam],
    queryFn: async ({ signal }) => {
      const url = platformParam
        ? `/api/device/${udid}/apps?platform=${platformParam}`
        : `/api/device/${udid}/apps`;
      const res = await fetch(url, { signal });
      if (!res.ok) throw new Error(t("failed_to_fetch_apps"));
      return res.json();
    },
    enabled: !!udid,
  });

  const {
    data: deviceInfo,
    isLoading: infoLoading,
    error: infoError,
  } = useQuery<DeviceInfo, Error>({
    queryKey: ["deviceInfo", udid],
    queryFn: async ({ signal }) => {
      const res = await fetch(`/api/device/${udid}/info`, { signal });
      if (!res.ok) throw new Error(t("failed_to_fetch_device_info"));
      return res.json();
    },
    enabled: !!udid,
  });

  const platform =
    (platformParam as "fruity" | "droid" | null) ||
    getPlatformFromDeviceInfo(deviceInfo);
  const loading = infoLoading || appsLoading;
  const error = infoError || appsError;

  const filteredApps = apps.filter((app) => {
    const query = searchQuery.toLowerCase();
    return (
      app.name.toLowerCase().includes(query) ||
      app.identifier.toLowerCase().includes(query)
    );
  });

  if (loading) {
    return (
      <div className="p-6">
        <Skeleton className="mb-2 h-8 w-48" />
        <Skeleton className="mb-6 h-4 w-96" />

        <div className="mb-6 flex gap-2">
          <Skeleton className="h-9 w-16" />
          <Skeleton className="h-9 w-24" />
        </div>

        <div className="grid grid-cols-2 gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 2xl:grid-cols-10">
          {Array.from({ length: 16 }).map((_, i) => (
            <AppCardSkeleton key={i} />
          ))}
        </div>
      </div>
    );
  }

  if (error) {
    return (
      <div className="p-6 flex items-center justify-center h-full">
        <Alert variant="destructive" className="max-w-md w-full">
          <AlertCircleIcon />
          <AlertTitle>{t("error")}</AlertTitle>
          <AlertDescription>
            <p>{error.message}</p>
          </AlertDescription>
        </Alert>
      </div>
    );
  }

  return (
    <div className="p-6">
      <div className="sticky top-0 z-10 bg-background py-4 flex items-center gap-2">
        {deviceInfo && (
          <div className="min-w-0 shrink-0">
            <h1 className="text-sm font-bold dark:text-foreground leading-tight">
              {deviceInfo.name || t("device")}
            </h1>
            <p className="text-xs text-muted-foreground truncate">
              {deviceInfo.arch} {deviceInfo.os?.name} {deviceInfo.os?.version}
            </p>
          </div>
        )}
        <div className="flex mx-auto border rounded-md overflow-hidden">
          <Button variant="default" size="sm" className="rounded-none border-0">
            {t("apps")}
          </Button>
          <Button variant="ghost" size="sm" className="rounded-none border-0" nativeButton={false} render={<Link to={`/list/${udid}/processes`} />}>
            {t("processes")}
          </Button>
        </div>
        <div className="relative shrink-0 w-56">
          <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
          <Input
            type="text"
            placeholder={t("search_apps")}
            value={searchQuery}
            onChange={(e) => setSearchQuery(e.target.value)}
            className="pl-10"
          />
        </div>
      </div>

      <div className="mt-4 grid grid-cols-2 gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 2xl:grid-cols-8 3xl:grid-cols-10">
        {filteredApps.map((app) => (
          <AppCard
            key={app.identifier}
            app={app}
            udid={udid!}
            platform={platform}
          />
        ))}
      </div>

      {filteredApps.length === 0 && (
        <p className="text-center text-muted-foreground py-8">
          {searchQuery ? t("no_apps_matching_search") : t("no_apps_found")}
        </p>
      )}
    </div>
  );
}

```

`gui/src/components/pages/DefaultMessage.tsx`:

```tsx
import { useTranslation } from "react-i18next";

export function DefaultMessage() {
  const { t } = useTranslation();

  return (
    <div className="flex h-full items-center justify-center">
      <div className="text-center">
        <p className="text-lg text-muted-foreground">{t("please_select_device")}</p>
        <p className="text-muted-foreground mt-4">{t("new_to_grapefruit")}</p>
        <p>
          <a
            href="http://github.com/chichou/grapefruit"
            target="_blank"
            className="hover:text-amber-500 transition-colors duration-200"
          >
            GitHub
          </a>
          <a
            href="https://discord.gg/pwutZNx"
            target="_blank"
            className="ml-2 hover:text-amber-500 transition-colors duration-200"
          >
            Discord
          </a>
        </p>
      </div>
    </div>
  );
}

```

`gui/src/components/pages/Devices.tsx`:

```tsx
import io from "socket.io-client";
import { useEffect, useState } from "react";
import { Link, useParams } from "react-router";
import { useTranslation } from "react-i18next";
import { TriangleAlert, RefreshCw, Plus, X } from "lucide-react";
import { useQuery, useMutation, useQueryClient } from "@tanstack/react-query";
import { toast } from "sonner";

import { Spinner } from "@/components/ui/spinner";
import { Separator } from "@/components/ui/separator";
import { Button } from "@/components/ui/button";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";

interface Device {
  id: string;
  type: "usb" | "local" | "remote";
  removable: boolean;
  name: string;
}

export function Devices() {
  const [addMenuOpen, setAddMenuOpen] = useState(false);
  const [ipAddress, setIpAddress] = useState("");
  const { udid } = useParams();
  const { t } = useTranslation();
  const queryClient = useQueryClient();

  const {
    data: devices = [],
    isLoading: loading,
    error,
    refetch,
  } = useQuery<Device[], Error>({
    queryKey: ["devices"],
    queryFn: async () => {
      const res = await fetch("/api/devices");
      if (!res.ok) {
        throw new Error(t("failed_to_fetch_devices"));
      }
      return res.json();
    },
  });

  const addDeviceMutation = useMutation({
    mutationFn: async (ip: string) => {
      const response = await fetch(`/api/devices/remote/${ip}`, {
        method: "PUT",
      });
      if (response.status !== 204) {
        throw new Error("Failed to add remote device");
      }
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ["devices"] });
      setAddMenuOpen(false);
      setIpAddress("");
    },
    onError: (error) => {
      toast.error(error.message);
    },
  });

  const deleteDeviceMutation = useMutation({
    mutationFn: async (ip: string) => {
      const response = await fetch(`/api/devices/remote/${ip}`, {
        method: "DELETE",
      });
      if (!response.ok) {
        throw new Error("Failed to remove remote device");
      }
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ["devices"] });
    },
    onError: (error) => {
      toast.error(error.message);
    },
  });

  const handleAddRemoteDevice = () => {
    if (!ipAddress.trim()) return;
    addDeviceMutation.mutate(ipAddress);
  };

  const handleDeleteRemoteDevice = (ip: string) => {
    deleteDeviceMutation.mutate(ip);
  };

  useEffect(() => {
    const socket = io("/devices").on("change", () => {
      console.log("device changed");
      queryClient.invalidateQueries({ queryKey: ["devices"] });
    });

    return () => {
      socket.disconnect();
    };
  }, [queryClient]);

  if (loading) {
    return (
      <>
        <h2 className="mb-4 text-lg  dark:text-foreground font-light">
          <Spinner className="inline-block h-5 w-5 animate-spin" />
        </h2>
        <div className="flex flex-col gap-2" role="status" aria-live="polite">
          {Array.from({ length: 3 }).map((_, i) => (
            <div
              key={i}
              className="h-8 w-3/4 rounded-md bg-accent animate-pulse"
            />
          ))}
        </div>
      </>
    );
  }

  if (error) {
    return (
      <>
        <p className="text-sm text-red-500 dark:text-red-400">
          {t("error")}: {error.message}
        </p>
      </>
    );
  }

  return (
    <>
      <div className="flex items-end justify-between mb-4">
        <Button
          variant="outline"
          size="icon-sm"
          onClick={() => refetch()}
          title={t("reload")}
        >
          <RefreshCw className="h-4 w-4" />
        </Button>
        <DropdownMenu open={addMenuOpen} onOpenChange={setAddMenuOpen}>
          <DropdownMenuTrigger
            render={<Button variant="outline" size="icon-sm" title={t("add_device")} />}
          >
            <Plus className="h-4 w-4" />
          </DropdownMenuTrigger>
          <DropdownMenuContent align="start" className="w-64 p-4">
            <div className="space-y-3">
              <label className="text-sm font-medium">
                {t("add_remote_device")}
              </label>
              <input
                type="text"
                placeholder={t("ip_address")}
                value={ipAddress}
                onChange={(e) => setIpAddress(e.target.value)}
                onKeyDown={(e) => {
                  if (e.key === "Enter") handleAddRemoteDevice();
                }}
                className="w-full rounded-md border border-input bg-background px-3 py-2 text-sm"
              />
              <div className="flex gap-2">
                <Button
                  size="sm"
                  onClick={handleAddRemoteDevice}
                  disabled={addDeviceMutation.isPending || !ipAddress.trim()}
                >
                  {t("confirm")}
                </Button>
                <Button
                  size="sm"
                  variant="outline"
                  onClick={() => {
                    setAddMenuOpen(false);
                    setIpAddress("");
                  }}
                >
                  {t("cancel")}
                </Button>
              </div>
            </div>
          </DropdownMenuContent>
        </DropdownMenu>
      </div>
      <Separator className="mb-4" />
      {devices.length === 0 ? (
        <p className="text-sm text-muted-foreground text-center flex items-center justify-center gap-2">
          <TriangleAlert className="h-4 w-4" />
          {t("no_devices_found")}
        </p>
      ) : (
        <ul className="flex flex-col gap-2">
          {devices.map((device) => (
            <li key={device.id} className="flex items-center gap-2 min-w-0">
              <Link
                to={`/list/${device.id}/apps`}
                className={`flex-1 block rounded-md px-3 py-2 text-sm transition-colors hover:bg-accent min-w-0 truncate ${
                  udid === device.id
                    ? "bg-accent font-medium text-accent-foreground"
                    : "text-muted-foreground"
                }`}
                title={device.name || device.id}
              >
                {device.name || device.id}
              </Link>
              {device.type === "remote" && (
                <DropdownMenu>
                  <DropdownMenuTrigger
                    render={
                      <Button
                        variant="ghost"
                        size="icon-sm"
                        title={t("delete")}
                        className="shrink-0 flex-none"
                      />
                    }
                  >
                    <X className="h-4 w-4" />
                  </DropdownMenuTrigger>
                  <DropdownMenuContent align="end">
                    <DropdownMenuItem
                      onClick={() => handleDeleteRemoteDevice(device.id)}
                      className="text-destructive focus:text-destructive"
                    >
                      {t("disconnect")}
                    </DropdownMenuItem>
                  </DropdownMenuContent>
                </DropdownMenu>
              )}
            </li>
          ))}
        </ul>
      )}
    </>
  );
}

```

`gui/src/components/pages/ProcessesView.tsx`:

```tsx
import { useState, useMemo } from "react";
import { useParams, Link } from "react-router";
import { useTranslation } from "react-i18next";
import { AlertCircleIcon, ArrowUpDown, Search, XCircle } from "lucide-react";
import { useQuery, useMutation, useQueryClient } from "@tanstack/react-query";
import { toast } from "sonner";

import { Skeleton } from "@/components/ui/skeleton";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";

interface Process {
  name: string;
  pid: number;
  path?: string;
  user?: string;
  ppid?: number;
  started?: string;
}

import type { DeviceInfo } from "@/types/device";

type SortField = "pid" | "name" | "user" | "path";
type SortDirection = "asc" | "desc";

interface SortState {
  field: SortField;
  direction: SortDirection;
}

function getPlatformFromDeviceInfo(info: DeviceInfo | undefined): "fruity" | "droid" {
  if (info?.os?.name?.toLowerCase().includes("android")) {
    return "droid";
  }
  return "fruity";
}

export function ProcessesView() {
  const { udid } = useParams();
  const { t } = useTranslation();
  const queryClient = useQueryClient();
  const [searchQuery, setSearchQuery] = useState("");
  const [sort, setSort] = useState<SortState>({ field: "pid", direction: "asc" });

  const killProcessMutation = useMutation({
    mutationFn: async (pid: number) => {
      const res = await fetch(`/api/device/${udid}/kill/${pid}`, { method: "POST" });
      if (!res.ok) throw new Error("Failed to kill process");
      return pid;
    },
    onSuccess: (pid) => {
      toast.success(t("process_killed", { pid }));
      queryClient.invalidateQueries({ queryKey: ["processes", udid] });
    },
    onError: () => {
      toast.error(t("failed_to_kill_process"));
    },
  });

  const handleKillProcess = (pid: number, e: React.MouseEvent) => {
    e.preventDefault();
    e.stopPropagation();
    killProcessMutation.mutate(pid);
  };

  const {
    data: processes = [],
    isLoading: processesLoading,
    error: processesError,
  } = useQuery<Process[], Error>({
    queryKey: ["processes", udid],
    queryFn: async ({ signal }) => {
      const res = await fetch(`/api/device/${udid}/processes`, { signal });
      if (!res.ok) throw new Error(t("failed_to_fetch_processes"));
      return res.json();
    },
    enabled: !!udid,
    refetchInterval: 5000,
  });

  const {
    data: deviceInfo,
    isLoading: infoLoading,
    error: infoError,
  } = useQuery<DeviceInfo, Error>({
    queryKey: ["deviceInfo", udid],
    queryFn: async ({ signal }) => {
      const res = await fetch(`/api/device/${udid}/info`, { signal });
      if (!res.ok) throw new Error(t("failed_to_fetch_device_info"));
      return res.json();
    },
    enabled: !!udid,
  });

  const platform = getPlatformFromDeviceInfo(deviceInfo);
  const loading = infoLoading || processesLoading;
  const error = infoError || processesError;

  const handleSort = (field: SortField) => {
    setSort((prev) => ({
      field,
      direction: prev.field === field && prev.direction === "asc" ? "desc" : "asc",
    }));
  };

  const filteredAndSortedProcesses = useMemo(() => {
    const query = searchQuery.toLowerCase();
    const filtered = processes.filter((p) =>
      p.name.toLowerCase().includes(query) ||
      p.pid.toString().includes(query) ||
      p.path?.toLowerCase().includes(query) ||
      p.user?.toLowerCase().includes(query)
    );

    const sortAccessors: Record<SortField, (p: Process) => string | number> = {
      pid: (p) => p.pid,
      name: (p) => p.name.toLowerCase(),
      user: (p) => (p.user ?? "").toLowerCase(),
      path: (p) => (p.path ?? "").toLowerCase(),
    };
    const accessor = sortAccessors[sort.field];
    const dir = sort.direction === "asc" ? 1 : -1;

    return [...filtered].sort((a, b) => {
      const aVal = accessor(a), bVal = accessor(b);
      return aVal < bVal ? -dir : aVal > bVal ? dir : 0;
    });
  }, [processes, searchQuery, sort]);

  const SortableHead = ({ field, children }: { field: SortField; children: React.ReactNode }) => (
    <TableHead
      className="cursor-pointer hover:bg-muted/50 select-none"
      onClick={() => handleSort(field)}
    >
      <div className="flex items-center gap-1">
        {children}
        <ArrowUpDown className={`h-3 w-3 ${sort.field === field ? "text-amber-500" : "text-muted-foreground"}`} />
      </div>
    </TableHead>
  );

  if (loading) {
    return (
      <div className="p-6">
        <Skeleton className="mb-2 h-8 w-48" />
        <Skeleton className="mb-6 h-4 w-96" />

        <div className="mb-6 flex gap-2">
          <Skeleton className="h-9 w-16" />
          <Skeleton className="h-9 w-24" />
        </div>

        <Skeleton className="h-64 w-full" />
      </div>
    );
  }

  if (error) {
    return (
      <div className="p-6 flex items-center justify-center h-full">
        <Alert variant="destructive" className="max-w-md w-full">
          <AlertCircleIcon />
          <AlertTitle>{t("error")}</AlertTitle>
          <AlertDescription>
            <p>{error.message}</p>
          </AlertDescription>
        </Alert>
      </div>
    );
  }

  return (
    <div className="p-6">
      <div className="sticky top-0 z-10 bg-background py-4 flex items-center gap-2">
        {deviceInfo && (
          <div className="min-w-0 shrink-0">
            <h1 className="text-sm font-bold dark:text-foreground leading-tight">
              {deviceInfo.name || t("device")}
            </h1>
            <p className="text-xs text-muted-foreground truncate">
              {deviceInfo.arch} {deviceInfo.os?.name} {deviceInfo.os?.version}
            </p>
          </div>
        )}
        <div className="flex mx-auto border rounded-md overflow-hidden">
          <Button variant="ghost" size="sm" className="rounded-none border-0" nativeButton={false} render={<Link to={`/list/${udid}/apps`} />}>
            {t("apps")}
          </Button>
          <Button variant="default" size="sm" className="rounded-none border-0">
            {t("processes")}
          </Button>
        </div>
        <div className="relative shrink-0 w-56">
          <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
          <Input
            type="text"
            placeholder={t("search_processes")}
            value={searchQuery}
            onChange={(e: React.ChangeEvent<HTMLInputElement>) => setSearchQuery(e.target.value)}
            className="pl-10"
          />
        </div>
      </div>

      {filteredAndSortedProcesses.length === 0 ? (
        <p className="text-center text-muted-foreground">
          {searchQuery ? t("no_processes_matching_search") : t("no_processes_found")}
        </p>
      ) : (
        <div className="rounded-md border">
          <Table>
            <TableHeader>
              <TableRow>
                <SortableHead field="pid">PID</SortableHead>
                <SortableHead field="name">{t("name")}</SortableHead>
                <SortableHead field="user">{t("user")}</SortableHead>
                <SortableHead field="path">{t("path")}</SortableHead>
                <TableHead className="w-12"></TableHead>
              </TableRow>
            </TableHeader>
            <TableBody>
              {filteredAndSortedProcesses.map((process) => (
                <TableRow key={process.pid} className="cursor-pointer">
                  <TableCell>
                    <Link
                      to={`/workspace/${platform}/${udid}/daemon/${process.pid}?name=${encodeURIComponent(process.name)}`}
                      className="text-amber-600 dark:text-amber-400 hover:underline"
                    >
                      {process.pid}
                    </Link>
                  </TableCell>
                  <TableCell>
                    <Link
                      to={`/workspace/${platform}/${udid}/daemon/${process.pid}?name=${encodeURIComponent(process.name)}`}
                      className="block"
                    >
                      {process.name}
                    </Link>
                  </TableCell>
                  <TableCell className="text-muted-foreground">
                    {process.user ?? "-"}
                  </TableCell>
                  <TableCell
                    className="text-muted-foreground text-xs font-mono truncate max-w-xs"
                    title={process.path}
                  >
                    {process.path ?? "-"}
                  </TableCell>
                  <TableCell>
                    <DropdownMenu>
                      <DropdownMenuTrigger
                        render={
                          <button
                            type="button"
                            onClick={(e) => e.stopPropagation()}
                            className="p-1 rounded hover:bg-red-100 dark:hover:bg-red-900/30 text-muted-foreground hover:text-red-500 transition-colors"
                            title={t("kill_process")}
                          />
                        }
                      >
                        <XCircle className="w-4 h-4" />
                      </DropdownMenuTrigger>
                      <DropdownMenuContent align="end">
                        <DropdownMenuItem
                          onClick={(e) => handleKillProcess(process.pid, e)}
                          className="text-destructive focus:text-destructive"
                        >
                          {t("kill_process")}
                        </DropdownMenuItem>
                      </DropdownMenuContent>
                    </DropdownMenu>
                  </TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
        </div>
      )}
    </div>
  );
}

```

`gui/src/components/pages/WelcomePage.tsx`:

```tsx
import { useTranslation } from "react-i18next";
import { Link, Outlet } from "react-router";

import logo from "../../assets/logo.svg";
import { Devices } from "./Devices";
import { DarkmodeToggle } from "../shared/DarkmodeToggle";
import { LanguageSelector } from "../shared/LanguageSelector";

export function WelcomePage() {
  const { t } = useTranslation();

  return (
    <div className="flex h-screen w-screen flex-col overflow-hidden sm:flex-row">
      <div className="flex w-full flex-col border-b border-border bg-sidebar p-4 sm:h-full sm:w-64 sm:border-b-0 sm:border-r">
        <div className="mb-6 flex items-center justify-center gap-2 px-4">
          <Link to="/">
            <img src={logo} alt={t("logo_alt")} className="h-10 w-40" />
          </Link>
        </div>
        <div className="mb-4">
          <Devices />
        </div>
        <footer className="mt-auto flex items-center gap-2 pt-4">
          <LanguageSelector />
          <DarkmodeToggle />
        </footer>
      </div>
      <main className="flex-1 overflow-auto">
        <Outlet />
      </main>
    </div>
  );
}

```

`gui/src/components/panels/DroidClassesPanel.tsx`:

```tsx
import { useMemo, useState } from "react";
import { useTranslation } from "react-i18next";
import { Search } from "lucide-react";
import { List, type RowComponentProps } from "react-window";

import { Input } from "@/components/ui/input";
import { Skeleton } from "@/components/ui/skeleton";
import { useDock } from "@/context/DockContext";
import { useDroidQuery } from "@/lib/queries";

const ITEM_HEIGHT = 32;

export function DroidClassesPanel() {
  const { t } = useTranslation();
  const { openFilePanel } = useDock();
  const [search, setSearch] = useState("");

  const { data: classes = [], isLoading } = useDroidQuery(
    ["classes"],
    (api) => api.classes.list() as Promise<string[]>
  );

  const filteredClasses = useMemo(() => {
    if (!search.trim()) return classes;
    const query = search.toLowerCase();
    return classes.filter((c) => c.toLowerCase().includes(query));
  }, [classes, search]);

  return (
    <div className="h-full flex flex-col">
      <div className="p-3 space-y-3 border-b border-border/50">
        {!isLoading && (
          <>
            <div className="relative">
              <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
              <Input
                placeholder={t("search")}
                value={search}
                onChange={(e) => setSearch(e.target.value)}
                className="pl-9 h-8 text-sm"
              />
            </div>
            <div className="text-xs text-muted-foreground">
              {filteredClasses.length.toLocaleString()} / {classes.length.toLocaleString()} {t("items")}
            </div>
          </>
        )}
      </div>
      <div className="flex-1 min-h-0 h-full overflow-hidden">
        {isLoading ? (
          <div className="px-3 py-1.5 space-y-2">
            {Array.from({ length: 16 }).map((_, i) => (
              <Skeleton key={i} className="h-5" style={{ width: `${40 + (i * 17) % 50}%` }} />
            ))}
          </div>
        ) : filteredClasses.length === 0 ? (
          <div className="flex items-center justify-center h-full text-muted-foreground text-sm">
            {t("no_results")}
          </div>
        ) : (
          <List
            rowComponent={ClassRow}
            rowCount={filteredClasses.length}
            rowHeight={ITEM_HEIGHT}
            rowProps={{ classes: filteredClasses, openFilePanel }}
          />
        )}
      </div>
    </div>
  );
}

function ClassRow({
  index,
  style,
  classes,
  openFilePanel,
}: RowComponentProps<{
  classes: string[];
  openFilePanel: (panel: {
    id: string;
    component: string;
    title: string;
    params: { className: string };
  }) => void;
}>) {
  const className = classes[index];

  return (
    <div
      className="px-3 py-1.5 border-b border-border/50 hover:bg-accent/50 transition-colors"
      style={style}
    >
      <button
        type="button"
        className="text-sm font-mono truncate text-foreground hover:text-primary transition-colors w-full text-left cursor-pointer"
        onClick={() =>
          openFilePanel({
            id: `javaclass_${className}`,
            component: "javaClassDetail",
            title: className,
            params: { className },
          })
        }
      >
        {className}
      </button>
    </div>
  );
}

```

`gui/src/components/panels/DroidComponentsPanel.tsx`:

```tsx
import { useCallback, useMemo, useState } from "react";
import { useTranslation } from "react-i18next";
import { Play, Radio, Search, ShieldCheck, Globe } from "lucide-react";
import { List, type RowComponentProps } from "react-window";
import { toast } from "sonner";

import { Input } from "@/components/ui/input";
import { Tabs, TabsList, TabsTrigger } from "@/components/ui/tabs";
import {
  Tooltip,
  TooltipTrigger,
  TooltipContent,
  TooltipProvider,
} from "@/components/ui/tooltip";
import { Spinner } from "@/components/ui/spinner";
import { useDroidQuery, useDroidMutation } from "@/lib/queries";

import type { ActivityEntry } from "@agent/droid/modules/activities";
import type { ServiceEntry } from "@agent/droid/modules/services";
import type { ReceiverEntry } from "@agent/droid/modules/receivers";

const ITEM_HEIGHT = 56;

type ComponentEntry = ActivityEntry | ServiceEntry | ReceiverEntry;

function shortName(fullName: string): string {
  const idx = fullName.lastIndexOf(".");
  return idx >= 0 ? fullName.substring(idx + 1) : fullName;
}

export function DroidComponentsPanel() {
  const { t } = useTranslation();
  const [search, setSearch] = useState("");
  const [activeTab, setActiveTab] = useState("activities");

  const { data: activities = [], isLoading: activitiesLoading } =
    useDroidQuery<ActivityEntry[]>(["activities"], (api) =>
      api.activities.list(),
    );

  const { data: services = [], isLoading: servicesLoading } = useDroidQuery<
    ServiceEntry[]
  >(["services"], (api) => api.services.list());

  const { data: receivers = [], isLoading: receiversLoading } =
    useDroidQuery<ReceiverEntry[]>(["receivers"], (api) =>
      api.receivers.list(),
    );

  const startActivityMutation = useDroidMutation<
    void,
    { component: string }
  >((api, { component }) => api.activities.start({ component }));

  const startServiceMutation = useDroidMutation<void, { component: string }>(
    (api, { component }) => api.services.start({ component }),
  );

  const stopServiceMutation = useDroidMutation<
    boolean,
    { component: string }
  >((api, { component }) => api.services.stop({ component }));

  const sendBroadcastMutation = useDroidMutation<
    void,
    { component: string }
  >((api, { component }) => api.receivers.send({ component }));

  const filterItems = useCallback(<T extends ComponentEntry>(items: T[]): T[] => {
    if (!search.trim()) return items;
    const query = search.toLowerCase();
    return items.filter((item) => item.name.toLowerCase().includes(query));
  }, [search]);

  const filteredActivities = useMemo(
    () => filterItems(activities),
    [activities, filterItems],
  );
  const filteredServices = useMemo(
    () => filterItems(services),
    [filterItems, services],
  );
  const filteredReceivers = useMemo(
    () => filterItems(receivers),
    [filterItems, receivers],
  );

  const currentItems =
    activeTab === "activities"
      ? filteredActivities
      : activeTab === "services"
        ? filteredServices
        : filteredReceivers;

  const totalItems =
    activeTab === "activities"
      ? activities
      : activeTab === "services"
        ? services
        : receivers;

  const isLoading =
    activeTab === "activities"
      ? activitiesLoading
      : activeTab === "services"
        ? servicesLoading
        : receiversLoading;

  const handleAction = async (name: string) => {
    try {
      if (activeTab === "activities") {
        await startActivityMutation.mutateAsync({ component: name });
        toast.success(t("start_activity"), { description: name });
      } else if (activeTab === "services") {
        await startServiceMutation.mutateAsync({ component: name });
        toast.success(t("start_service"), { description: name });
      } else {
        await sendBroadcastMutation.mutateAsync({ component: name });
        toast.success(t("send_broadcast"), { description: name });
      }
    } catch (err) {
      toast.error((err as Error).message);
    }
  };

  const handleStopService = async (name: string) => {
    try {
      await stopServiceMutation.mutateAsync({ component: name });
      toast.success(t("stop_service"));
    } catch (err) {
      toast.error((err as Error).message);
    }
  };

  return (
    <div className="h-full flex flex-col">
      <div className="p-4 space-y-4">
        <div className="relative">
          <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
          <Input
            placeholder={t("search")}
            value={search}
            onChange={(e) => setSearch(e.target.value)}
            className="pl-9"
          />
        </div>
        <Tabs value={activeTab} onValueChange={setActiveTab}>
          <TabsList variant="line" className="w-full">
            <TabsTrigger value="activities" className="flex-1">
              {t("activities")}
            </TabsTrigger>
            <TabsTrigger value="services" className="flex-1">
              {t("services")}
            </TabsTrigger>
            <TabsTrigger value="receivers" className="flex-1">
              {t("receivers")}
            </TabsTrigger>
          </TabsList>
        </Tabs>
        <div className="text-xs text-muted-foreground">
          {currentItems.length} / {totalItems.length}
        </div>
      </div>
      <div className="flex-1 min-h-0 h-full">
        {isLoading ? (
          <div className="flex items-center justify-center h-full gap-2 text-muted-foreground">
            <Spinner />
            {t("loading")}...
          </div>
        ) : currentItems.length === 0 ? (
          <div className="flex items-center justify-center h-full text-muted-foreground">
            {t("no_components")}
          </div>
        ) : (
          <div className="flex h-full">
            <List
              rowComponent={ComponentRow}
              rowCount={currentItems.length}
              rowHeight={ITEM_HEIGHT}
              rowProps={{
                items: currentItems,
                activeTab,
                onAction: handleAction,
                onStopService: handleStopService,
                t,
              }}
            />
          </div>
        )}
      </div>
    </div>
  );
}

function ComponentRow({
  index,
  style,
  items,
  activeTab,
  onAction,
  t,
}: RowComponentProps<{
  items: ComponentEntry[];
  activeTab: string;
  onAction: (name: string) => void;
  onStopService: (name: string) => void;
  t: (key: string) => string;
}>) {
  const item = items[index];

  return (
    <div
      className="px-4 py-2 border-b border-border hover:bg-accent group"
      style={style}
    >
      <div className="flex items-center justify-between">
        <div className="min-w-0 flex-1">
          <div className="text-sm font-medium truncate">
            {shortName(item.name)}
          </div>
          <div className="text-xs text-muted-foreground font-mono truncate">
            {item.name}
          </div>
        </div>
        <div className="flex items-center gap-1 shrink-0 ml-2">
          {item.exported && (
            <TooltipProvider>
              <Tooltip>
                <TooltipTrigger
                  render={
                    <span className="text-muted-foreground shrink-0" />
                  }
                >
                  <Globe className="h-3.5 w-3.5" />
                </TooltipTrigger>
                <TooltipContent>{t("exported")}</TooltipContent>
              </Tooltip>
            </TooltipProvider>
          )}
          {item.permission && (
            <TooltipProvider>
              <Tooltip>
                <TooltipTrigger
                  render={
                    <span className="text-muted-foreground shrink-0" />
                  }
                >
                  <ShieldCheck className="h-3.5 w-3.5" />
                </TooltipTrigger>
                <TooltipContent>{item.permission}</TooltipContent>
              </Tooltip>
            </TooltipProvider>
          )}
          {activeTab !== "services" && (
            <TooltipProvider>
              <Tooltip>
                <TooltipTrigger
                  render={
                    <button
                      type="button"
                      className="p-1 rounded text-amber-700 dark:text-amber-400 opacity-0 group-hover:opacity-100 hover:bg-amber-100 dark:hover:bg-amber-900/50 transition-opacity"
                      onClick={() => onAction(item.name)}
                    />
                  }
                >
                  {activeTab === "receivers" ? (
                    <Radio className="h-3.5 w-3.5" />
                  ) : (
                    <Play className="h-3.5 w-3.5" />
                  )}
                </TooltipTrigger>
                <TooltipContent>
                  {activeTab === "activities"
                    ? t("start_activity")
                    : t("send_broadcast")}
                </TooltipContent>
              </Tooltip>
            </TooltipProvider>
          )}
        </div>
      </div>
    </div>
  );
}

```

`gui/src/components/panels/DroidDevicePanel.tsx`:

```tsx
import { useTranslation } from "react-i18next";

import { Skeleton } from "@/components/ui/skeleton";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";

import { useDroidQuery } from "@/lib/queries";

import type { DeviceInfo } from "@agent/droid/modules/device";

export function DroidDevicePanel() {
  const { t } = useTranslation();

  const {
    data: deviceInfo,
    isLoading,
    error,
  } = useDroidQuery<DeviceInfo>(["deviceInfo"], (api) => api.device.info());

  return (
    <div className="h-full p-4 overflow-auto">
      {error && (
        <Alert variant="destructive" className="mb-4">
          <AlertTitle>{t("error")}</AlertTitle>
          <AlertDescription>{(error as Error)?.message}</AlertDescription>
        </Alert>
      )}
      {isLoading ? (
        <div className="space-y-4">
          <Skeleton className="h-4 w-24" />
          <Skeleton className="h-4 w-3/4" />
          <Skeleton className="h-4 w-1/2" />
        </div>
      ) : deviceInfo ? (
        <div className="space-y-4 pb-4">
          <div className="text-sm font-medium">{t("device_info")}</div>
          <div className="grid grid-cols-2 gap-3">
            <div>
              <div className="text-sm text-muted-foreground mb-1">
                {t("model")}
              </div>
              <div className="text-sm">{deviceInfo.model}</div>
            </div>
            <div>
              <div className="text-sm text-muted-foreground mb-1">
                {t("brand")}
              </div>
              <div className="text-sm">{deviceInfo.brand}</div>
            </div>
            <div>
              <div className="text-sm text-muted-foreground mb-1">
                {t("manufacturer")}
              </div>
              <div className="text-sm">{deviceInfo.manufacturer}</div>
            </div>
            <div>
              <div className="text-sm text-muted-foreground mb-1">
                {t("android_version")}
              </div>
              <div className="text-sm">{deviceInfo.release}</div>
            </div>
            <div>
              <div className="text-sm text-muted-foreground mb-1">
                {t("sdk_version")}
              </div>
              <div className="text-sm">{deviceInfo.sdk}</div>
            </div>
            <div>
              <div className="text-sm text-muted-foreground mb-1">
                ABI
              </div>
              <div className="text-sm font-mono">{deviceInfo.abi}</div>
            </div>
            <div className="col-span-2">
              <div className="text-sm text-muted-foreground mb-1">
                {t("security_patch")}
              </div>
              <div className="text-sm">{deviceInfo.security}</div>
            </div>
          </div>
        </div>
      ) : (
        <div className="text-sm text-muted-foreground">
          {t("no_device_info")}
        </div>
      )}
    </div>
  );
}

```

`gui/src/components/panels/DroidGeneralPanel.tsx`:

```tsx
import { useState } from "react";
import { useTranslation } from "react-i18next";
import { Copy, Check } from "lucide-react";

import { Badge } from "@/components/ui/badge";
import { Skeleton } from "@/components/ui/skeleton";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";

import { Status, useSession } from "@/context/SessionContext";
import { useDock } from "@/context/DockContext";
import { useDroidQuery } from "@/lib/queries";

import type { ApplicationInfoResult } from "@agent/droid/modules/app";


function CopyButton({ text }: { text: string }) {
  const [copied, setCopied] = useState(false);

  const handleCopy = async () => {
    await navigator.clipboard.writeText(text);
    setCopied(true);
    setTimeout(() => setCopied(false), 2000);
  };

  return (
    <button
      type="button"
      onClick={handleCopy}
      className="ml-2 p-1 text-muted-foreground hover:text-muted-foreground dark:hover:text-muted-foreground"
      title="Copy to clipboard"
    >
      {copied ? (
        <Check className="w-3 h-3 text-green-500" />
      ) : (
        <Copy className="w-3 h-3" />
      )}
    </button>
  );
}

function PathDisplay({ path, onClick }: { path: string; onClick: () => void }) {
  return (
    <button
      type="button"
      onClick={onClick}
      className="text-left flex items-start text-sm font-mono break-all hover:text-amber-600 dark:hover:text-amber-400 transition-colors cursor-pointer hover:underline"
    >
      {path}
    </button>
  );
}

function DownloadLink({ path, href }: { path: string; href: string }) {
  return (
    <a
      href={href}
      download
      className="text-left text-sm font-mono break-all hover:text-amber-600 dark:hover:text-amber-400 transition-colors hover:underline"
    >
      {path}
    </a>
  );
}

function SectionLabel({ children }: { children: React.ReactNode }) {
  return (
    <div className="text-sm font-medium text-muted-foreground uppercase tracking-wider mt-4 mb-2">
      {children}
    </div>
  );
}

function InfoRow({ label, children }: { label: string; children: React.ReactNode }) {
  return (
    <div>
      <div className="text-sm text-muted-foreground mb-1">{label}</div>
      {children}
    </div>
  );
}

export function DroidGeneralPanel() {
  const { t } = useTranslation();
  const { status, device, bundle, pid } = useSession();
  const { openSingletonPanel } = useDock();

  const {
    data: appInfo,
    isLoading,
    error,
  } = useDroidQuery<ApplicationInfoResult>(["appInfo"], (api) => api.app.info());

  const openFinderTab = (path: string) => {
    openSingletonPanel({
      id: "finder_tab",
      component: "finder",
      title: t("finder"),
      params: { path },
    });
  };

  const downloadUrl = (path: string) =>
    `/api/download/${device}/${pid}?path=${encodeURIComponent(path)}`;

  if (error) {
    return (
      <div className="h-full p-4 overflow-auto">
        <Alert variant="destructive" className="mb-4">
          <AlertTitle>{t("error")}</AlertTitle>
          <AlertDescription>{(error as Error)?.message}</AlertDescription>
        </Alert>
      </div>
    );
  }

  if (isLoading) {
    return (
      <div className="h-full p-4 overflow-auto">
        <div className="space-y-4">
          <div className="flex gap-4">
            <Skeleton className="h-16 w-16 rounded-xl shrink-0" />
            <div className="flex-1 space-y-2">
              <Skeleton className="h-4 w-24" />
              <Skeleton className="h-4 w-full" />
            </div>
          </div>
          <Skeleton className="h-4 w-24" />
          <Skeleton className="h-4 w-3/4" />
        </div>
      </div>
    );
  }

  if (!appInfo) {
    return (
      <div className="h-full p-4 overflow-auto">
        <div className="text-sm text-muted-foreground">
          {status === Status.Ready ? t("no_app_info") : t("connect_to_view_app_info")}
        </div>
      </div>
    );
  }

  return (
    <div className="h-full p-4 overflow-auto">
      <div className="space-y-3 pb-4">
        <div className="flex gap-4">
          <img
            src={`/api/device/${device}/icon/${bundle}`}
            alt={appInfo.packageName}
            loading="lazy"
            className="h-16 w-16 rounded-xl shrink-0"
            onError={(e) => {
              e.currentTarget.src =
                "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='64' height='64'%3E%3Crect width='64' height='64' fill='%23ddd'/%3E%3C/svg%3E";
            }}
          />
          <div className="flex-1 min-w-0">
            <div>
              <div className="text-sm text-muted-foreground mb-1">
                {t("package_name")}
              </div>
              <div className="text-sm font-mono break-all">
                {appInfo.packageName}
              </div>
            </div>
          </div>
        </div>

        <InfoRow label={t("process_name")}>
          <div className="text-sm font-mono break-all">{appInfo.processName}</div>
        </InfoRow>

        <div className="flex items-center gap-2 flex-wrap">
          <Badge variant="secondary" className="text-xs">
            UID: {appInfo.uid}
          </Badge>
          <Badge variant="secondary" className="text-xs">
            {t("target_sdk")}: {appInfo.targetSdkVersion}
          </Badge>
          <Badge variant="secondary" className="text-xs">
            {t("min_sdk")}: {appInfo.minSdkVersion}
          </Badge>
        </div>

        <SectionLabel>{t("directories")}</SectionLabel>

        <InfoRow label={t("data_dir")}>
          <div className="flex items-start">
            <PathDisplay path={appInfo.dataDir} onClick={() => openFinderTab(appInfo.dataDir)} />
            <CopyButton text={appInfo.dataDir} />
          </div>
        </InfoRow>

        {appInfo.deviceProtectedDataDir && (
          <InfoRow label={t("data_dir") + " (DE)"}>
            <div className="flex items-center text-sm font-mono break-all">
              {appInfo.deviceProtectedDataDir}
              <CopyButton text={appInfo.deviceProtectedDataDir} />
            </div>
          </InfoRow>
        )}

        <InfoRow label={t("native_library_dir")}>
          <div className="flex items-start">
            <PathDisplay path={appInfo.nativeLibraryDir} onClick={() => openFinderTab(appInfo.nativeLibraryDir)} />
            <CopyButton text={appInfo.nativeLibraryDir} />
          </div>
        </InfoRow>

        <InfoRow label={t("public_source_dir")}>
          <div className="flex items-center text-sm font-mono break-all">
            {appInfo.publicSourceDir}
            <CopyButton text={appInfo.publicSourceDir} />
          </div>
        </InfoRow>

        <InfoRow label={t("source_dir")}>
          <div className="flex items-center text-sm font-mono break-all">
            {appInfo.sourceDir}
            <CopyButton text={appInfo.sourceDir} />
          </div>
        </InfoRow>

        {appInfo.splitPublicSourceDirs && appInfo.splitPublicSourceDirs.length > 0 && (
          <InfoRow label={t("split_apks")}>
            <div className="space-y-1">
              {appInfo.splitPublicSourceDirs.map((p) => (
                <div key={p} className="flex items-center">
                  <DownloadLink path={p} href={downloadUrl(p)} />
                  <CopyButton text={p} />
                </div>
              ))}
            </div>
          </InfoRow>
        )}

        {appInfo.sharedLibraryFiles && appInfo.sharedLibraryFiles.length > 0 && (
          <InfoRow label={t("shared_library_files")}>
            <div className="space-y-1">
              {appInfo.sharedLibraryFiles.map((p) => (
                <div key={p} className="flex items-center">
                  <DownloadLink path={p} href={downloadUrl(p)} />
                  <CopyButton text={p} />
                </div>
              ))}
            </div>
          </InfoRow>
        )}
      </div>
    </div>
  );
}

```

`gui/src/components/panels/DroidHookControlPanel.tsx`:

```tsx
import { useEffect, useState } from "react";
import { useTranslation } from "react-i18next";
import {
  Loader2,
  Clipboard,
  Radio,
  Send,
  FileKey,
  Trash2,
} from "lucide-react";

import { Button } from "@/components/ui/button";
import { Switch } from "@/components/ui/switch";
import { Label } from "@/components/ui/label";
import { Skeleton } from "@/components/ui/skeleton";
import { useSession, Status } from "@/context/SessionContext";
import { useDroidQuery } from "@/lib/queries";

interface TapInfo {
  id: string;
  active: boolean;
  available: boolean;
}

interface UserHook {
  type: "native";
  module?: string | null;
  name: string;
}

interface HookGroup {
  id: string;
  icon: React.ReactNode;
  nameKey: string;
  descKey: string;
}

const HOOK_GROUPS: HookGroup[] = [
  {
    id: "clipboard",
    icon: <Clipboard className="h-4 w-4" />,
    nameKey: "hook_clipboard",
    descKey: "hook_clipboard_desc",
  },
  {
    id: "broadcast",
    icon: <Radio className="h-4 w-4" />,
    nameKey: "hook_broadcast",
    descKey: "hook_broadcast_desc",
  },
  {
    id: "intent",
    icon: <Send className="h-4 w-4" />,
    nameKey: "hook_intent",
    descKey: "hook_intent_desc",
  },
  {
    id: "sharedpref",
    icon: <FileKey className="h-4 w-4" />,
    nameKey: "hook_sharedpref",
    descKey: "hook_sharedpref_desc",
  },
];

export function DroidHookControlPanel() {
  const { t } = useTranslation();
  const { droid, status } = useSession();
  const [hookStatus, setHookStatus] = useState<Record<string, boolean>>({});
  const [loading, setLoading] = useState<Record<string, boolean>>({});
  const [removingHook, setRemovingHook] = useState<string | null>(null);

  const { data: tapList, isLoading: isLoadingStatus } = useDroidQuery<TapInfo[]>(
    ["tapsList"],
    (api) => api.taps.list(),
  );

  const {
    data: userHooks = [],
    refetch: refetchUserHooks,
  } = useDroidQuery<UserHook[]>(
    ["userHooks"],
    (api) => api.hook.userHooks(),
  );

  useEffect(() => {
    if (tapList) {
      const statusMap: Record<string, boolean> = {};
      for (const tap of tapList) {
        statusMap[tap.id] = tap.active;
      }
      setHookStatus(statusMap);
    }
  }, [tapList]);

  useEffect(() => {
    const handleRefresh = () => { refetchUserHooks(); };
    window.addEventListener("hooks:refresh", handleRefresh);
    return () => window.removeEventListener("hooks:refresh", handleRefresh);
  }, [refetchUserHooks]);

  const handleToggle = async (groupId: string, enabled: boolean) => {
    if (!droid) return;

    setLoading((prev) => ({ ...prev, [groupId]: true }));

    try {
      if (enabled) {
        await droid.taps.start(groupId);
      } else {
        await droid.taps.stop(groupId);
      }
      setHookStatus((prev) => ({ ...prev, [groupId]: enabled }));
    } catch (error) {
      console.error(
        `Failed to ${enabled ? "start" : "stop"} hook group ${groupId}:`,
        error,
      );
    } finally {
      setLoading((prev) => ({ ...prev, [groupId]: false }));
    }
  };

  const handleRemoveHook = async (hook: UserHook) => {
    if (!droid) return;
    const key = `native:${hook.module || "null"}:${hook.name}`;
    setRemovingHook(key);
    try {
      await droid.native.unhook(hook.module ?? null, hook.name);
      await refetchUserHooks();
    } catch (error) {
      console.error("Failed to remove hook:", error);
    } finally {
      setRemovingHook(null);
    }
  };

  const isDisabled = status !== Status.Ready;

  if (isLoadingStatus) {
    return (
      <div className="p-3 space-y-4">
        <Skeleton className="h-5 w-20" />
        <div className="space-y-3">
          <Skeleton className="h-3 w-24" />
          {Array.from({ length: 4 }).map((_, i) => (
            <div key={i} className="flex items-start space-x-3 p-2">
              <Skeleton className="h-4 w-4 rounded shrink-0 mt-0.5" />
              <div className="flex-1 space-y-1.5">
                <div className="flex items-center justify-between">
                  <Skeleton className="h-4 w-28" />
                  <Skeleton className="h-5 w-9 rounded-full" />
                </div>
                <Skeleton className="h-3 w-full" />
              </div>
            </div>
          ))}
        </div>
      </div>
    );
  }

  return (
    <div className="p-3 space-y-4">
      <h2 className="text-base font-semibold">{t("hooks")}</h2>

      <div className="space-y-3">
        <h3 className="text-sm font-medium text-muted-foreground uppercase tracking-wide">
          {t("hook_builtin")}
        </h3>
        <div className="space-y-3">
          {HOOK_GROUPS.map((group) => (
            <div
              key={group.id}
              className="flex items-start space-x-3 p-2 rounded-md hover:bg-muted/50 transition-colors"
            >
              <div className="shrink-0 mt-0.5 text-muted-foreground">
                {group.icon}
              </div>
              <div className="flex-1 min-w-0">
                <div className="flex items-center justify-between">
                  <Label
                    htmlFor={`hook-${group.id}`}
                    className="text-sm font-medium cursor-pointer"
                  >
                    {t(group.nameKey)}
                  </Label>
                  {loading[group.id] ? (
                    <Loader2 className="h-4 w-4 animate-spin text-muted-foreground" />
                  ) : (
                    <Switch
                      id={`hook-${group.id}`}
                      checked={hookStatus[group.id] || false}
                      onCheckedChange={(checked) =>
                        handleToggle(group.id, checked)
                      }
                      disabled={isDisabled}
                    />
                  )}
                </div>
                <p className="text-sm text-muted-foreground mt-1 leading-relaxed">
                  {t(group.descKey)}
                </p>
              </div>
            </div>
          ))}
        </div>
      </div>

      {/* User Defined Hooks Section */}
      <div className="space-y-3">
        <h3 className="text-sm font-medium text-muted-foreground uppercase tracking-wide">
          {t("hook_user_defined")}
        </h3>
        {userHooks.length === 0 ? (
          <p className="text-sm text-muted-foreground italic">
            {t("hook_user_no_hooks")}
          </p>
        ) : (
          <div className="space-y-1">
            {userHooks.map((hook) => {
              const key = `native:${hook.module || "null"}:${hook.name}`;
              const label = hook.module ? `${hook.module}!${hook.name}` : hook.name;
              const isRemoving = removingHook === key;
              return (
                <div
                  key={key}
                  className="flex items-center justify-between p-2 rounded-md hover:bg-muted/50 transition-colors group"
                >
                  <div className="flex-1 min-w-0">
                    <div className="font-mono text-xs truncate" title={label}>
                      {label}
                    </div>
                  </div>
                  <div className="flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
                    <Button
                      variant="ghost"
                      size="icon"
                      className="h-6 w-6 text-destructive hover:text-destructive"
                      onClick={() => handleRemoveHook(hook)}
                      disabled={isRemoving || isDisabled}
                      title={t("hook_remove")}
                    >
                      {isRemoving ? (
                        <Loader2 className="h-3.5 w-3.5 animate-spin" />
                      ) : (
                        <Trash2 className="h-3.5 w-3.5" />
                      )}
                    </Button>
                  </div>
                </div>
              );
            })}
          </div>
        )}
      </div>
    </div>
  );
}

```

`gui/src/components/panels/DroidHooksPanel.tsx`:

```tsx
import { DroidHookControlPanel } from "./DroidHookControlPanel";

export function DroidHooksPanel() {
  return (
    <div className="h-full overflow-auto">
      <DroidHookControlPanel />
    </div>
  );
}

```

`gui/src/components/panels/DroidURLSchemesPanel.tsx`:

```tsx
import { useEffect, useMemo, useRef, useState } from "react";
import { useTranslation } from "react-i18next";
import { Search, Send, Eraser } from "lucide-react";

import { Badge } from "@/components/ui/badge";
import { Skeleton } from "@/components/ui/skeleton";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";
import { Input } from "@/components/ui/input";
import { Button } from "@/components/ui/button";
import { ButtonGroup } from "@/components/ui/button-group";
import { Textarea } from "@/components/ui/textarea";
import {
  ResizablePanel,
  ResizablePanelGroup,
  ResizableHandle,
} from "@/components/ui/resizable";

import { useSession } from "@/context/SessionContext";
import { useDock } from "@/context/DockContext";
import { useDroidQuery, useDroidMutation } from "@/lib/queries";

interface DroidURLScheme {
  activity: string;
  schemes: string[];
  hosts: string[];
  browsable: boolean;
  actions: string[];
}

function parseManifestSchemes(xml: string): DroidURLScheme[] {
  const parser = new DOMParser();
  const doc = parser.parseFromString(xml, "text/xml");

  if (doc.documentElement.tagName === "parsererror") {
    return [];
  }

  const result: DroidURLScheme[] = [];

  const activities = doc.querySelectorAll("activity, activity-alias");

  for (const activity of activities) {
    const activityName = activity.getAttribute("name") || "";
    const filters = activity.querySelectorAll("intent-filter");

    for (const filter of filters) {
      const dataEls = filter.querySelectorAll("data");
      const schemes: string[] = [];
      const hosts: string[] = [];

      for (const data of dataEls) {
        const scheme = data.getAttribute("scheme");
        if (scheme) schemes.push(scheme);
        const host = data.getAttribute("host");
        if (host) hosts.push(host);
      }

      if (schemes.length === 0) continue;

      const actions: string[] = [];
      for (const action of filter.querySelectorAll("action")) {
        const name = action.getAttribute("name");
        if (name) actions.push(name);
      }

      let browsable = false;
      for (const category of filter.querySelectorAll("category")) {
        if (
          category.getAttribute("name") ===
          "android.intent.category.BROWSABLE"
        ) {
          browsable = true;
          break;
        }
      }

      result.push({
        activity: activityName,
        schemes: [...new Set(schemes)],
        hosts: [...new Set(hosts)],
        browsable,
        actions,
      });
    }
  }

  return result;
}

function shortName(fullName: string): string {
  const idx = fullName.lastIndexOf(".");
  return idx >= 0 ? fullName.substring(idx + 1) : fullName;
}

function DroidURLSendView({ scheme }: { scheme: string }) {
  const { t } = useTranslation();
  const { droid } = useSession();
  const [url, setURL] = useState("");
  const textareaRef = useRef<HTMLTextAreaElement>(null);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const launchMutation = useDroidMutation<void, { data: string }>(
    (api, { data }) =>
      api.activities.start({
        action: "android.intent.action.VIEW",
        data,
      }),
  );

  useEffect(() => {
    setURL(scheme + "://");
    textareaRef.current?.focus();
  }, [scheme]);

  const handleSend = async () => {
    if (isLoading || !droid) return;
    setError(null);
    setIsLoading(true);
    try {
      await launchMutation.mutateAsync({ data: url });
    } catch (e) {
      setError(`${e}`);
    } finally {
      setIsLoading(false);
    }
  };

  const handleKeyDown = (event: React.KeyboardEvent<HTMLTextAreaElement>) => {
    if (event.key === "Enter") {
      event.preventDefault();
      handleSend();
    }
  };

  const reset = () => {
    if (isLoading) return;
    setURL(scheme + "://");
    textareaRef.current?.focus();
  };

  return (
    <div className="h-full flex flex-col">
      <div className="flex flex-col flex-1 p-2 gap-2">
        <Textarea
          ref={textareaRef}
          value={url}
          onChange={(e) => setURL(e.target.value)}
          onKeyDown={handleKeyDown}
          className="font-mono resize-none flex-1 min-h-0"
          placeholder={t("enter_url_scheme")}
          readOnly={isLoading}
        />
        <div className="flex justify-end shrink-0">
          <div className="inline-flex items-center gap-2">
            {error && (
              <span className="text-sm text-destructive">{error}</span>
            )}
            <ButtonGroup>
              <Button
                size="sm"
                onClick={reset}
                variant="outline"
                disabled={isLoading}
                title={t("reset")}
                className="px-2"
              >
                <Eraser className="size-4" />
              </Button>
              <Button
                size="sm"
                onClick={handleSend}
                className="gap-2"
                variant="outline"
                disabled={isLoading}
              >
                <Send className="size-4" />
                {t("send")}
              </Button>
            </ButtonGroup>
          </div>
        </div>
      </div>
    </div>
  );
}

export function DroidURLSchemesPanel() {
  const { t } = useTranslation();
  const { openSingletonPanel } = useDock();
  const [searchQuery, setSearchQuery] = useState("");
  const [selectedScheme, setSelectedScheme] = useState<string | null>(null);

  const openManifest = () => {
    openSingletonPanel({
      id: "droid_manifest_tab",
      component: "droidManifest",
      title: "AndroidManifest.xml",
    });
  };

  const {
    data: manifestXml,
    isLoading,
    error,
  } = useDroidQuery(["manifest"], (api) => api.manifest.xml());

  const allSchemes = useMemo(() => {
    if (!manifestXml) return [];
    return parseManifestSchemes(manifestXml);
  }, [manifestXml]);

  const filteredSchemes = useMemo(() => {
    if (!searchQuery.trim()) return allSchemes;
    const query = searchQuery.toLowerCase();
    return allSchemes.filter(
      (entry) =>
        entry.activity.toLowerCase().includes(query) ||
        entry.schemes.some((s) => s.toLowerCase().includes(query)) ||
        entry.hosts.some((h) => h.toLowerCase().includes(query)),
    );
  }, [searchQuery, allSchemes]);

  const schemeList = (
    <>
      {error && (
        <Alert variant="destructive">
          <AlertTitle>{t("error")}</AlertTitle>
          <AlertDescription>{(error as Error)?.message}</AlertDescription>
        </Alert>
      )}
      {isLoading ? (
        <div className="space-y-4">
          <Skeleton className="h-8 w-48" />
          <Skeleton className="h-4 w-3/4" />
          <Skeleton className="h-4 w-1/2" />
        </div>
      ) : filteredSchemes.length > 0 ? (
        <div className="space-y-4">
          {filteredSchemes.map((entry, index) => (
            <div key={index} className="rounded-lg p-2">
              <div className="flex items-center justify-between gap-2 mb-1">
                <span
                  className="text-xs truncate"
                  title={entry.activity}
                >
                  {shortName(entry.activity)}
                </span>
                <div className="flex items-center gap-1 shrink-0">
                  {entry.browsable && (
                    <Badge className="text-xs bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300">
                      BROWSABLE
                    </Badge>
                  )}
                  {entry.actions.includes("android.intent.action.VIEW") && (
                    <Badge variant="outline" className="text-xs">
                      VIEW
                    </Badge>
                  )}
                </div>
              </div>
              <div className="text-xs text-muted-foreground font-mono mb-1 truncate">
                {entry.activity}
              </div>
              {entry.hosts.length > 0 && (
                <div className="flex flex-wrap gap-1 mb-1 ml-1">
                  {entry.hosts.map((h, i) => (
                    <Badge
                      key={i}
                      variant="secondary"
                      className="text-xs font-mono"
                    >
                      {h}
                    </Badge>
                  ))}
                </div>
              )}
              <div className="space-y-1 ml-1">
                {entry.schemes.map((s, i) => (
                  <button
                    key={i}
                    type="button"
                    className="w-full cursor-pointer text-left font-mono text-sm text-amber-600 dark:text-amber-400 rounded-sm px-1 py-0.5 transition-colors hover:underline"
                    onClick={() => setSelectedScheme(s)}
                  >
                    {s}://
                    {entry.hosts.length > 0 ? entry.hosts[0] : ""}
                  </button>
                ))}
              </div>
            </div>
          ))}
        </div>
      ) : (
        <div className="flex flex-col items-center justify-center gap-2 p-8 text-center text-muted-foreground">
          <span className="text-sm">
            {searchQuery.trim()
              ? t("no_results")
              : t("no_url_schemes")}
          </span>
          {!searchQuery.trim() && (
            <Button
              variant="link"
              size="sm"
              className="text-xs"
              onClick={openManifest}
            >
              {t("open_manifest")}
            </Button>
          )}
        </div>
      )}
    </>
  );

  return (
    <div className="h-full flex flex-col">
      <div className="p-4 pb-2">
        <div className="relative">
          <Search className="absolute left-2 top-2.5 h-4 w-4 text-muted-foreground" />
          <Input
            placeholder={t("search")}
            value={searchQuery}
            onChange={(e) => setSearchQuery(e.target.value)}
            className="pl-8"
          />
        </div>
      </div>
      {selectedScheme ? (
        <ResizablePanelGroup orientation="vertical" className="flex-1 min-h-0">
          <ResizablePanel defaultSize="60%" minSize="30%">
            <div className="flex-1 overflow-auto p-4 pt-2 h-full">
              {schemeList}
            </div>
          </ResizablePanel>
          <ResizableHandle withHandle />
          <ResizablePanel minSize="20%" className="border-t">
            <DroidURLSendView scheme={selectedScheme} />
          </ResizablePanel>
        </ResizablePanelGroup>
      ) : (
        <div className="flex-1 overflow-auto p-4 pt-2">
          {schemeList}
        </div>
      )}
    </div>
  );
}

```

`gui/src/components/panels/FruityClassesPanel.tsx`:

```tsx
import { useMemo, useState } from "react";
import { useParams } from "react-router";
import { useTranslation } from "react-i18next";
import { Search, FileCode } from "lucide-react";
import { List, type RowComponentProps } from "react-window";

import { Input } from "@/components/ui/input";
import { Skeleton } from "@/components/ui/skeleton";
import { ToggleGroup, ToggleGroupItem } from "@/components/ui/toggle-group";
import { Button } from "@/components/ui/button";
import { useDock } from "@/context/DockContext";
import { useFruityQuery } from "@/lib/queries";

const ITEM_HEIGHT = 32;

type ScopeType = "__main__" | "__app__" | "__global__";

export function FruityClassesPanel() {
  const { t } = useTranslation();
  const { mode } = useParams();
  const { openFilePanel } = useDock();
  const isDaemon = mode === "daemon";
  const [scope, setScope] = useState<ScopeType>(isDaemon ? "__main__" : "__app__");
  const [search, setSearch] = useState("");

  const { data: classes = [], isLoading } = useFruityQuery(
    ["classes", scope],
    (api) => api.classdump.list(scope) as Promise<string[]>
  );

  const filteredClasses = useMemo(() => {
    if (!search.trim()) return classes;
    const query = search.toLowerCase();
    return classes.filter((c) => c.toLowerCase().includes(query));
  }, [classes, search]);

  const handleScopeChange = (value: string) => {
    if (value) setScope(value as ScopeType);
  };

  return (
    <div className="h-full flex flex-col">
      <div className="p-3 space-y-3 border-b border-border/50">
        <ToggleGroup
          value={[scope]}
          onValueChange={(values) => {
            const last = values[values.length - 1];
            if (last) handleScopeChange(last);
          }}
          variant="outline"
          size="sm"
          className="w-full"
        >
          <ToggleGroupItem value="__main__" className="flex-1">{t("main")}</ToggleGroupItem>
          {!isDaemon && (
            <ToggleGroupItem value="__app__" className="flex-1">{t("app")}</ToggleGroupItem>
          )}
          <ToggleGroupItem value="__global__" className="flex-1">{t("global")}</ToggleGroupItem>
        </ToggleGroup>
        {!isLoading && (
          <>
            <div className="relative">
              <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
              <Input
                placeholder={t("search")}
                value={search}
                onChange={(e) => setSearch(e.target.value)}
                className="pl-9 h-8 text-sm"
              />
            </div>
            <div className="text-xs text-muted-foreground">
              {filteredClasses.length.toLocaleString()} / {classes.length.toLocaleString()} {t("items")}
            </div>
          </>
        )}
      </div>
      <div className="flex-1 min-h-0 h-full overflow-hidden">
        {isLoading ? (
          <div className="px-3 py-1.5 space-y-2">
            {Array.from({ length: 16 }).map((_, i) => (
              <Skeleton key={i} className="h-5" style={{ width: `${40 + (i * 17) % 50}%` }} />
            ))}
          </div>
        ) : filteredClasses.length === 0 ? (
          <div className="flex items-center justify-center h-full text-muted-foreground text-sm">
            {t("no_results")}
          </div>
        ) : (
          <List
            rowComponent={ClassRow}
            rowCount={filteredClasses.length}
            rowHeight={ITEM_HEIGHT}
            rowProps={{ classes: filteredClasses, openFilePanel }}
          />
        )}
      </div>
    </div>
  );
}

function ClassRow({
  index,
  style,
  classes,
  openFilePanel,
}: RowComponentProps<{
  classes: string[];
  openFilePanel: (panel: {
    id: string;
    component: string;
    title: string;
    params: { className: string };
  }) => void;
}>) {
  const className = classes[index];

  return (
    <div
      className="px-3 py-1.5 border-b border-border/50 hover:bg-accent/50 transition-colors group flex items-center"
      style={style}
    >
      <button
        type="button"
        className="text-sm font-mono truncate text-foreground/80 hover:text-primary transition-colors flex-1 text-left cursor-pointer"
        onClick={() =>
          openFilePanel({
            id: `class_${className}`,
            component: "classDetail",
            title: className,
            params: { className },
          })
        }
      >
        {className}
      </button>
      <Button
        variant="ghost"
        size="icon"
        className="h-6 w-6 shrink-0 text-muted-foreground"
        title="classdump"
        onClick={() =>
          openFilePanel({
            id: `classdump_${className}`,
            component: "classDump",
            title: `Classdump - ${className}`,
            params: { className },
          })
        }
      >
        <FileCode className="h-3.5 w-3.5" />
      </Button>
    </div>
  );
}

```

`gui/src/components/panels/FruityDevicePanel.tsx`:

```tsx
import { useTranslation } from "react-i18next";

import { Skeleton } from "@/components/ui/skeleton";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";

import { useFruityQuery } from "@/lib/queries";

import type { UIDeviceInfo } from "@agent/fruity/modules/uidevice";

export function FruityDevicePanel() {
  const { t } = useTranslation();

  const {
    data: deviceInfo,
    isLoading,
    error,
  } = useFruityQuery<UIDeviceInfo>(["uideviceInfo"], (api) => api.uidevice.info());

  return (
    <div className="h-full p-4 overflow-auto">
      {error && (
        <Alert variant="destructive" className="mb-4">
          <AlertTitle>{t("error")}</AlertTitle>
          <AlertDescription>{(error as Error)?.message}</AlertDescription>
        </Alert>
      )}
      {isLoading ? (
        <div className="space-y-4">
          <Skeleton className="h-4 w-24" />
          <Skeleton className="h-4 w-3/4" />
          <Skeleton className="h-4 w-1/2" />
        </div>
      ) : deviceInfo ? (
        <div className="space-y-4 pb-4">
          <div className="text-sm font-medium">{t("device_info")}</div>
          <div className="grid grid-cols-2 gap-3">
            <div>
              <div className="text-sm text-muted-foreground mb-1">
                {t("uidevice_name")}
              </div>
              <div className="text-sm">{deviceInfo.name}</div>
            </div>
            <div>
              <div className="text-sm text-muted-foreground mb-1">
                {t("model")}
              </div>
              <div className="text-sm">{deviceInfo.model}</div>
            </div>
            <div>
              <div className="text-sm text-muted-foreground mb-1">
                {t("uidevice_localized_model")}
              </div>
              <div className="text-sm">{deviceInfo.localizedModel}</div>
            </div>
            <div>
              <div className="text-sm text-muted-foreground mb-1">
                {t("uidevice_system")}
              </div>
              <div className="text-sm">{deviceInfo.systemName} {deviceInfo.systemVersion}</div>
            </div>
            <div>
              <div className="text-sm text-muted-foreground mb-1">
                {t("uidevice_idiom")}
              </div>
              <div className="text-sm">{deviceInfo.userInterfaceIdiom}</div>
            </div>
            <div>
              <div className="text-sm text-muted-foreground mb-1">
                {t("uidevice_battery")}
              </div>
              <div className="text-sm">
                {deviceInfo.batteryLevel >= 0
                  ? `${Math.round(deviceInfo.batteryLevel * 100)}%`
                  : "N/A"}{" "}
                ({deviceInfo.batteryState})
              </div>
            </div>
            <div className="col-span-2">
              <div className="text-sm text-muted-foreground mb-1">
                {t("uidevice_idfv")}
              </div>
              <div className="text-sm font-mono">{deviceInfo.identifierForVendor}</div>
            </div>
            <div>
              <div className="text-sm text-muted-foreground mb-1">
                {t("uidevice_multitasking")}
              </div>
              <div className="text-sm">{deviceInfo.isMultitaskingSupported ? "Yes" : "No"}</div>
            </div>
          </div>
        </div>
      ) : (
        <div className="text-sm text-muted-foreground">
          {t("no_device_info")}
        </div>
      )}
    </div>
  );
}

```

`gui/src/components/panels/FruityGeneralPanel.tsx`:

```tsx
import { useState } from "react";
import { useTranslation } from "react-i18next";
import { Copy, Check } from "lucide-react";

import { Badge } from "@/components/ui/badge";
import { Skeleton } from "@/components/ui/skeleton";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";

import { Status, useSession } from "@/context/SessionContext";
import { useDock } from "@/context/DockContext";
import { useFruityQuery } from "@/lib/queries";

import type { BasicInfo } from "@agent/fruity/modules/info";

function CopyButton({ text }: { text: string }) {
  const [copied, setCopied] = useState(false);

  const handleCopy = async () => {
    await navigator.clipboard.writeText(text);
    setCopied(true);
    setTimeout(() => setCopied(false), 2000);
  };

  return (
    <button
      type="button"
      onClick={handleCopy}
      className="ml-2 p-1 text-muted-foreground hover:text-muted-foreground dark:hover:text-muted-foreground"
      title="Copy to clipboard"
    >
      {copied ? (
        <Check className="w-3 h-3 text-green-500" />
      ) : (
        <Copy className="w-3 h-3" />
      )}
    </button>
  );
}

function PathDisplay({ path, onClick }: { path: string; onClick: () => void }) {
  return (
    <button
      type="button"
      onClick={onClick}
      className="text-left flex items-start text-sm font-mono break-all hover:text-amber-600 dark:hover:text-amber-400 transition-colors cursor-pointer hover:underline"
    >
      {path}
    </button>
  );
}

export function FruityGeneralPanel() {
  const { t } = useTranslation();
  const { status, device, bundle } = useSession();
  const { openSingletonPanel } = useDock();

  const {
    data: basicInfo,
    isLoading,
    error,
  } = useFruityQuery<BasicInfo>(["appInfo"], (api) => api.info.basics());

  const openFinderTab = (path: string) => {
    openSingletonPanel({
      id: "finder_tab",
      component: "finder",
      title: t("finder"),
      params: { path },
    });
  };

  if (error) {
    return (
      <div className="h-full p-4 overflow-auto">
        <Alert variant="destructive" className="mb-4">
          <AlertTitle>{t("error")}</AlertTitle>
          <AlertDescription>{(error as Error)?.message}</AlertDescription>
        </Alert>
      </div>
    );
  }

  if (isLoading) {
    return (
      <div className="h-full p-4 overflow-auto">
        <div className="space-y-4">
          <div className="flex gap-4">
            <Skeleton className="h-16 w-16 rounded-xl shrink-0" />
            <div className="flex-1 space-y-2">
              <Skeleton className="h-4 w-24" />
              <Skeleton className="h-4 w-full" />
            </div>
          </div>
          <Skeleton className="h-4 w-24" />
          <Skeleton className="h-4 w-3/4" />
        </div>
      </div>
    );
  }

  if (!basicInfo) {
    return (
      <div className="h-full p-4 overflow-auto">
        <div className="text-sm text-muted-foreground">
          {status === Status.Ready ? t("no_app_info") : t("connect_to_view_app_info")}
        </div>
      </div>
    );
  }

  return (
    <div className="h-full p-4 overflow-auto">
      <div className="space-y-4 pb-4">
        <div className="flex gap-4">
          <img
            src={`/api/device/${device}/icon/${bundle}`}
            alt={basicInfo.label}
            loading="lazy"
            className="h-16 w-16 rounded-xl shrink-0"
            onError={(e) => {
              e.currentTarget.src =
                "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='64' height='64'%3E%3Crect width='64' height='64' fill='%23ddd'/%3E%3C/svg%3E";
            }}
          />
          <div className="flex-1 min-w-0">
            <div>
              <div className="text-sm text-muted-foreground mb-1">
                {t("app_name")}
              </div>
              <div className="text-sm">{basicInfo.label || "N/A"}</div>
            </div>
            <div className="mt-2">
              <div className="text-sm text-muted-foreground mb-1">
                {t("bundle_id")}
              </div>
              <div className="text-sm font-mono break-all">
                {basicInfo.id || "N/A"}
              </div>
            </div>
          </div>
        </div>
        <div>
          <div className="text-sm text-muted-foreground mb-1">
            {t("version")}
          </div>
          <div className="flex items-center gap-2 text-sm">
            <span>{basicInfo.version || "N/A"}</span>
            <Badge variant="secondary" className="text-xs">
              {basicInfo.semVer || "N/A"}
            </Badge>
          </div>
        </div>
        <div>
          <div className="text-sm text-muted-foreground mb-1">
            {t("min_os")}
          </div>
          <Badge variant="outline">{basicInfo.minOS || "N/A"}</Badge>
        </div>
        <div>
          <div className="text-sm text-muted-foreground mb-1">
            {t("bundle_path")}
          </div>
          {basicInfo.path ? (
            <div className="flex items-start">
              <PathDisplay
                path={basicInfo.path}
                onClick={() => openFinderTab(basicInfo.path)}
              />
              <CopyButton text={basicInfo.path} />
            </div>
          ) : (
            <span className="text-sm">{"N/A"}</span>
          )}
        </div>
        <div>
          <div className="text-sm text-muted-foreground mb-1">
            {t("executable")}
          </div>
          <div className="flex items-center text-sm font-mono break-all">
            {basicInfo.main || "N/A"}
            {basicInfo.main && <CopyButton text={basicInfo.main} />}
          </div>
        </div>
        <div>
          <div className="text-sm text-muted-foreground mb-1">
            {t("tmp_dir")}
          </div>
          <div className="flex items-center text-sm font-mono break-all">
            {basicInfo.tmp || "N/A"}
            {basicInfo.tmp && <CopyButton text={basicInfo.tmp} />}
          </div>
        </div>
        <div>
          <div className="text-sm text-muted-foreground mb-1">
            {t("home_dir")}
          </div>
          {basicInfo.home ? (
            <div className="flex items-start">
              <PathDisplay
                path={basicInfo.home}
                onClick={() => openFinderTab(basicInfo.home)}
              />
              <CopyButton text={basicInfo.home} />
            </div>
          ) : (
            <span className="text-sm">{"N/A"}</span>
          )}
        </div>
      </div>
    </div>
  );
}

```

`gui/src/components/panels/FruityGeolocationPanel.tsx`:

```tsx
import { useCallback, useEffect, useRef, useState } from "react";
import L from "leaflet";
import "leaflet/dist/leaflet.css";
import { useSession } from "@/context/SessionContext";
import { Status } from "@/context/SessionContext";
import { Button } from "@/components/ui/button";
import { useTranslation } from "react-i18next";

const MAP_PICKER_STATE = "MAP_PICKER_STATE";

interface MapState {
  center: [number, number];
  zoom: number;
}

function getStoredView(): MapState {
  try {
    const stored = localStorage.getItem(MAP_PICKER_STATE);
    if (stored) {
      const parsed = JSON.parse(stored);
      return { center: parsed.center as [number, number], zoom: parsed.zoom };
    }
  } catch {
    void 0;
  }
  return { center: [37.334392145274386, -122.00797505475639], zoom: 14 };
}

function storeView(center: [number, number], zoom: number): void {
  localStorage.setItem(MAP_PICKER_STATE, JSON.stringify({ center, zoom }));
}

export function FruityGeolocationPanel() {
  const { t } = useTranslation();
  const { fruity, status } = useSession();
  const [lat, setLat] = useState<number | null>(null);
  const [lng, setLng] = useState<number | null>(null);
  const mapRef = useRef<HTMLDivElement>(null);
  const mapInstanceRef = useRef<L.Map | null>(null);
  const markerRef = useRef<L.Marker | null>(null);

  const stopSimulation = useCallback(async () => {
    if (!fruity) return;
    try {
      await fruity.geolocation.dismiss();
    } catch (err) {
      console.error("Failed to dismiss geolocation simulation:", err);
    }
    setLat(null);
    setLng(null);
    if (markerRef.current) {
      markerRef.current.remove();
      markerRef.current = null;
    }
  }, [fruity]);

  const fakeGeolocation = useCallback(
    async (lat: number, lng: number) => {
      if (!fruity) return;
      try {
        await fruity.geolocation.fake(lat, lng);
      } catch (err) {
        console.error("Failed to fake geolocation:", err);
      }
    },
    [fruity],
  );

  const setupMap = useCallback(() => {
    if (!mapRef.current || mapInstanceRef.current) return;

    const initialState = getStoredView();
    const map = L.map(mapRef.current).setView(
      initialState.center,
      initialState.zoom,
    );
    mapInstanceRef.current = map;

    L.tileLayer("https://b.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      minZoom: 4,
      maxZoom: 18,
      attribution:
        '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
      id: "mapbox/streets-v11",
      tileSize: 512,
      zoomOffset: -1,
    }).addTo(map);

    map.on("click", async (e: L.LeafletMouseEvent) => {
      const { lat: newLat, lng: newLng } = e.latlng;
      setLat(newLat);
      setLng(newLng);

      if (markerRef.current) {
        markerRef.current.remove();
      }

      const marker = L.marker(e.latlng).addTo(map);
      markerRef.current = marker;

      // marker.bindPopup(popupContent).openPopup();
    });

    const saveView = () => {
      if (!mapInstanceRef.current) return;
      const center = mapInstanceRef.current.getCenter();
      storeView([center.lat, center.lng], mapInstanceRef.current.getZoom());
    };

    for (const event of ["zoomlevelschange", "zoomend", "moveend", "resize"]) {
      map.on(event, saveView);
    }
  }, []);

  useEffect(() => {
    if (lat !== null && lng !== null) {
      fakeGeolocation(lat, lng);
    }
  }, [lat, lng, fakeGeolocation]);

  useEffect(() => {
    if (status === Status.Ready) {
      setupMap();
    }
  }, [status, setupMap]);

  useEffect(() => {
    return () => {
      if (mapInstanceRef.current) {
        mapInstanceRef.current.remove();
        mapInstanceRef.current = null;
      }
    };
  }, []);

  return (
    <div className="h-full flex flex-col">
      <div className="flex items-center gap-2 p-2 border-b">
        <span className="text-sm font-medium leading-8">
          {t("simulated_location")}
        </span>
        {lat !== null && lng !== null && (
          <span className="text-xs text-muted-foreground leading-8">
            {lat.toFixed(6)}, {lng.toFixed(6)}
          </span>
        )}
        {lat !== null && lng !== null && (
          <Button
            variant="destructive"
            size="sm"
            onClick={stopSimulation}
            className="ml-auto"
          >
            {t("stop")}
          </Button>
        )}
      </div>
      <div ref={mapRef} className="flex-1" style={{ minHeight: 0 }} />
    </div>
  );
}

```

`gui/src/components/panels/FruityHookControlPanel.tsx`:

```tsx
import { useEffect, useState } from "react";
import { useTranslation } from "react-i18next";
import {
  Database,
  Loader2,
  Clipboard,
  Fingerprint,
  Smartphone,
  FolderOpen,
} from "lucide-react";

import { Switch } from "@/components/ui/switch";
import { Label } from "@/components/ui/label";
import { Skeleton } from "@/components/ui/skeleton";
import { useSession, Status } from "@/context/SessionContext";
import { useFruityQuery } from "@/lib/queries";
import { FruityUserHooksList } from "./FruityUserHooksList";

interface TapInfo {
  id: string;
  active: boolean;
  available: boolean;
}

interface HookGroup {
  id: string;
  icon: React.ReactNode;
  nameKey: string;
  descKey: string;
}

const HOOK_GROUPS: HookGroup[] = [
  {
    id: "sqlite",
    icon: <Database className="h-4 w-4" />,
    nameKey: "hook_sqlite",
    descKey: "hook_sqlite_desc",
  },
  {
    id: "pasteboard",
    icon: <Clipboard className="h-4 w-4" />,
    nameKey: "hook_pasteboard",
    descKey: "hook_pasteboard_desc",
  },
  {
    id: "deviceid",
    icon: <Smartphone className="h-4 w-4" />,
    nameKey: "hook_deviceid",
    descKey: "hook_deviceid_desc",
  },
  {
    id: "biometric",
    icon: <Fingerprint className="h-4 w-4" />,
    nameKey: "hook_biometric",
    descKey: "hook_biometric_desc",
  },
  {
    id: "fileops",
    icon: <FolderOpen className="h-4 w-4" />,
    nameKey: "hook_fileops",
    descKey: "hook_fileops_desc",
  },
];

export function FruityHookControlPanel() {
  const { t } = useTranslation();
  const { fruity, status } = useSession();
  const [hookStatus, setHookStatus] = useState<Record<string, boolean>>({});
  const [loading, setLoading] = useState<Record<string, boolean>>({});

  // Fetch tap status from agent via taps.list() RPC
  const { data: tapList, isLoading: isLoadingStatus } = useFruityQuery<TapInfo[]>(
    ["tapsList"],
    (api) => api.taps.list(),
  );

  // Update local state when tap list is fetched
  useEffect(() => {
    if (tapList) {
      const statusMap: Record<string, boolean> = {};
      for (const tap of tapList) {
        statusMap[tap.id] = tap.active;
      }
      setHookStatus(statusMap);
    }
  }, [tapList]);

  const handleToggle = async (groupId: string, enabled: boolean) => {
    if (!fruity) return;

    setLoading((prev) => ({ ...prev, [groupId]: true }));

    try {
      if (enabled) {
        await fruity.taps.start(groupId);
      } else {
        await fruity.taps.stop(groupId);
      }
      setHookStatus((prev) => ({ ...prev, [groupId]: enabled }));
    } catch (error) {
      console.error(
        `Failed to ${enabled ? "start" : "stop"} hook group ${groupId}:`,
        error,
      );
    } finally {
      setLoading((prev) => ({ ...prev, [groupId]: false }));
    }
  };

  const isDisabled = status !== Status.Ready;

  if (isLoadingStatus) {
    return (
      <div className="p-3 space-y-4">
        <Skeleton className="h-5 w-20" />
        <div className="space-y-3">
          <Skeleton className="h-3 w-24" />
          {Array.from({ length: 5 }).map((_, i) => (
            <div key={i} className="flex items-start space-x-3 p-2">
              <Skeleton className="h-4 w-4 rounded shrink-0 mt-0.5" />
              <div className="flex-1 space-y-1.5">
                <div className="flex items-center justify-between">
                  <Skeleton className="h-4 w-28" />
                  <Skeleton className="h-5 w-9 rounded-full" />
                </div>
                <Skeleton className="h-3 w-full" />
              </div>
            </div>
          ))}
        </div>
      </div>
    );
  }

  return (
    <div className="p-3 space-y-4">
      <h2 className="text-base font-semibold">{t("hooks")}</h2>

      {/* Built-in Hooks Section */}
      <div className="space-y-3">
        <h3 className="text-sm font-medium text-muted-foreground uppercase tracking-wide">
          {t("hook_builtin")}
        </h3>
        <div className="space-y-3">
          {HOOK_GROUPS.map((group) => (
            <div
              key={group.id}
              className="flex items-start space-x-3 p-2 rounded-md hover:bg-muted/50 transition-colors"
            >
              <div className="shrink-0 mt-0.5 text-muted-foreground">
                {group.icon}
              </div>
              <div className="flex-1 min-w-0">
                <div className="flex items-center justify-between">
                  <Label
                    htmlFor={`hook-${group.id}`}
                    className="text-sm font-medium cursor-pointer"
                  >
                    {t(group.nameKey)}
                  </Label>
                  {loading[group.id] ? (
                    <Loader2 className="h-4 w-4 animate-spin text-muted-foreground" />
                  ) : (
                    <Switch
                      id={`hook-${group.id}`}
                      checked={hookStatus[group.id] || false}
                      onCheckedChange={(checked) =>
                        handleToggle(group.id, checked)
                      }
                      disabled={isDisabled}
                    />
                  )}
                </div>
                <p className="text-sm text-muted-foreground mt-1 leading-relaxed">
                  {t(group.descKey)}
                </p>
              </div>
            </div>
          ))}
        </div>
      </div>

      {/* User Defined Hooks Section */}
      <div className="space-y-3">
        <h3 className="text-sm font-medium text-muted-foreground uppercase tracking-wide">
          {t("hook_user_defined")}
        </h3>
        <FruityUserHooksList />
      </div>
    </div>
  );
}

```

`gui/src/components/panels/FruityHooksPanel.tsx`:

```tsx
import { FruityHookControlPanel } from "./FruityHookControlPanel";

export function FruityHooksPanel() {
  return (
    <div className="h-full overflow-auto">
      <FruityHookControlPanel />
    </div>
  );
}

```

`gui/src/components/panels/FruityPluginsPanel.tsx`:

```tsx
import { useMemo, useState } from "react";
import { useTranslation } from "react-i18next";
import { Search, Copy, Check } from "lucide-react";

import { Badge } from "@/components/ui/badge";
import { Input } from "@/components/ui/input";
import { Spinner } from "@/components/ui/spinner";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";

import { useFruityQuery } from "@/lib/queries";

import type { PluginInfo } from "@agent/fruity/modules/plugins";

function CopyableText({ text, hideText }: { text: string; hideText?: boolean }) {
  const [copied, setCopied] = useState(false);

  const handleCopy = async () => {
    await navigator.clipboard.writeText(text);
    setCopied(true);
    setTimeout(() => setCopied(false), 2000);
  };

  return (
    <span className="inline-flex items-center gap-1 font-mono text-sm break-all">
      {!hideText && text}
      <button
        type="button"
        onClick={handleCopy}
        className="p-0.5 text-muted-foreground hover:text-foreground shrink-0"
      >
        {copied ? (
          <Check className="w-3 h-3 text-green-500" />
        ) : (
          <Copy className="w-3 h-3" />
        )}
      </button>
    </span>
  );
}

export function FruityPluginsPanel() {
  const { t } = useTranslation();
  const [search, setSearch] = useState("");

  const {
    data: plugins,
    isLoading,
    error,
  } = useFruityQuery<PluginInfo[]>(["plugins"], (api) => api.plugins.list());

  const filtered = useMemo(() => {
    if (!plugins) return [];
    if (!search.trim()) return plugins;
    const q = search.toLowerCase();
    return plugins.filter(
      (p) =>
        p.identifier.toLowerCase().includes(q) ||
        p.extensionPoint.toLowerCase().includes(q) ||
        p.displayName.toLowerCase().includes(q),
    );
  }, [plugins, search]);

  if (error) {
    return (
      <div className="h-full p-4 overflow-auto">
        <Alert variant="destructive">
          <AlertTitle>{t("error")}</AlertTitle>
          <AlertDescription>{(error as Error)?.message}</AlertDescription>
        </Alert>
      </div>
    );
  }

  return (
    <div className="h-full flex flex-col">
      <div className="p-4 pb-2 space-y-2">
        <div className="relative">
          <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
          <Input
            placeholder={t("search")}
            value={search}
            onChange={(e) => setSearch(e.target.value)}
            className="pl-9"
          />
        </div>
        {plugins && (
          <div className="text-sm text-muted-foreground">
            {filtered.length} / {plugins.length}
          </div>
        )}
      </div>
      <div className="flex-1 min-h-0 overflow-auto">
        {isLoading ? (
          <div className="flex items-center justify-center h-full gap-2 text-muted-foreground">
            <Spinner />
            {t("loading")}...
          </div>
        ) : filtered.length === 0 ? (
          <div className="flex items-center justify-center h-full text-muted-foreground text-sm">
            No extensions found
          </div>
        ) : (
          <div className="divide-y divide-border">
            {filtered.map((plugin) => (
              <div
                key={plugin.identifier}
                className="px-4 py-3 hover:bg-accent space-y-1.5"
              >
                <div className="flex items-center justify-between gap-2">
                  <span className="text-sm font-medium truncate">
                    {plugin.displayName !== "N/A"
                      ? plugin.displayName
                      : plugin.identifier.split(".").pop()}
                  </span>
                  <Badge variant="secondary" className="text-xs shrink-0">
                    {plugin.extensionPoint}
                  </Badge>
                </div>
                <div className="space-y-0.5">
                  <CopyableText text={plugin.identifier} />
                </div>
                {plugin.path !== "N/A" && (
                  <div className="flex items-center gap-1 min-w-0">
                    <div
                      dir="rtl"
                      className="text-xs text-muted-foreground font-mono truncate"
                    >
                      <bdi>{plugin.path}</bdi>
                    </div>
                    <CopyableText text={plugin.path} hideText />
                  </div>
                )}
              </div>
            ))}
          </div>
        )}
      </div>
    </div>
  );
}

```

`gui/src/components/panels/FruityURLSchemesPanel.tsx`:

```tsx
import { useEffect, useState } from "react";
import { useTranslation } from "react-i18next";
import { Search } from "lucide-react";

import { Badge } from "@/components/ui/badge";
import { Skeleton } from "@/components/ui/skeleton";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";
import { Input } from "@/components/ui/input";
import {
  ResizablePanel,
  ResizablePanelGroup,
  ResizableHandle,
} from "@/components/ui/resizable";

import { FruityURLSendView } from "./FruityURLSendView";
import { useFruityQuery } from "@/lib/queries";

import type { URLScheme } from "@agent/fruity/modules/info";

export function FruityURLSchemesPanel() {
  const { t } = useTranslation();
  const [searchQuery, setSearchQuery] = useState("");
  const [selectedScheme, setSelectedScheme] = useState<string | null>(null);

  const {
    data: urlSchemes,
    isLoading,
    error,
  } = useFruityQuery(["urlSchemes"], (api) => api.info.urls());

  const [filteredSchemes, setFilteredSchemes] = useState<URLScheme[] | null>(
    null,
  );

  useEffect(() => {
    if (!urlSchemes) {
      setFilteredSchemes(null);
      return;
    }

    if (!searchQuery.trim()) {
      setFilteredSchemes(urlSchemes);
      return;
    }

    const query = searchQuery.toLowerCase();
    const filtered = urlSchemes.filter(
      (scheme) =>
        scheme.name?.toLowerCase().includes(query) ||
        scheme.schemes?.some((s) => s.toLowerCase().includes(query)),
    );
    setFilteredSchemes(filtered);
  }, [searchQuery, urlSchemes]);

  const schemeList = (
    <>
      {error && (
        <Alert variant="destructive">
          <AlertTitle>{t("error")}</AlertTitle>
          <AlertDescription>
            {(error as Error)?.message}
          </AlertDescription>
        </Alert>
      )}
      {isLoading ? (
        <div className="space-y-4">
          <Skeleton className="h-8 w-48" />
          <Skeleton className="h-4 w-3/4" />
          <Skeleton className="h-4 w-1/2" />
        </div>
      ) : filteredSchemes && filteredSchemes.length > 0 ? (
        <div className="space-y-4">
          {filteredSchemes.map((scheme: URLScheme, index: number) => (
            <div key={index} className="rounded-lg p-2">
              <div className="flex items-center justify-between gap-2 mb-1">
                <span className="text-xs">
                  {scheme.name || "(empty)"}
                </span>
                <Badge variant="outline" className="text-xs shrink-0">
                  {scheme.role}
                </Badge>
              </div>
              <div className="space-y-1 ml-1">
                {scheme.schemes?.map((s, i) => (
                  <button
                    key={i}
                    type="button"
                    className="w-full cursor-pointer text-left font-mono text-sm text-amber-600 dark:text-amber-400 rounded-sm px-1 py-0.5 transition-colors hover:underline"
                    onClick={() => s && setSelectedScheme(s)}
                  >
                    {s}://
                  </button>
                ))}
              </div>
            </div>
          ))}
        </div>
      ) : (
        <div className="space-y-4">
          <Skeleton className="h-8 w-48" />
          <Skeleton className="h-4 w-3/4" />
          <Skeleton className="h-4 w-1/2" />
        </div>
      )}
    </>
  );

  return (
    <div className="h-full flex flex-col">
      <div className="p-4 pb-2">
        <div className="relative">
          <Search className="absolute left-2 top-2.5 h-4 w-4 text-muted-foreground" />
          <Input
            placeholder={t("search")}
            value={searchQuery}
            onChange={(e) => setSearchQuery(e.target.value)}
            className="pl-8"
          />
        </div>
      </div>
      {selectedScheme ? (
        <ResizablePanelGroup orientation="vertical" className="flex-1 min-h-0">
          <ResizablePanel defaultSize="60%" minSize="30%">
            <div className="flex-1 overflow-auto p-4 pt-2 h-full">
              {schemeList}
            </div>
          </ResizablePanel>
          <ResizableHandle withHandle />
          <ResizablePanel minSize="20%" className="border-t">
            <FruityURLSendView scheme={selectedScheme} />
          </ResizablePanel>
        </ResizablePanelGroup>
      ) : (
        <div className="flex-1 overflow-auto p-4 pt-2">
          {schemeList}
        </div>
      )}
    </div>
  );
}

```

`gui/src/components/panels/FruityURLSendView.tsx`:

```tsx
import { useEffect, useRef, useState } from "react";
import { useTranslation } from "react-i18next";
import { Send, Eraser } from "lucide-react";

import { useSession } from "@/context/SessionContext";
import { ButtonGroup } from "@/components/ui/button-group";
import { Button } from "@/components/ui/button";
import { Textarea } from "@/components/ui/textarea";

interface URLSendViewProps {
  scheme: string;
}

export function FruityURLSendView({ scheme }: URLSendViewProps) {
  const { t } = useTranslation();
  const [url, setURL] = useState("");
  const textareaRef = useRef<HTMLTextAreaElement>(null);

  const { fruity } = useSession();
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    setURL(scheme + "://");
    textareaRef.current?.focus();
  }, [scheme]);

  const handleSend = async () => {
    if (isLoading || !fruity) {
      return;
    }

    setError(null);
    setIsLoading(true);

    try {
      await fruity.url.open(url);
    } catch (e) {
      setError(`${e}`);
    } finally {
      setIsLoading(false);
    }
  };

  const handleKeyDown = (event: React.KeyboardEvent<HTMLTextAreaElement>) => {
    if (event.key === "Enter") {
      event.preventDefault();
      handleSend();
    }
  };

  const reset = () => {
    if (isLoading) {
      return;
    }
    setURL(scheme + "://");
    textareaRef.current?.focus();
  };

  return (
    <div className="h-full flex flex-col">
      <div className="flex flex-col flex-1 p-2 gap-2">
        <Textarea
          ref={textareaRef}
          value={url}
          onChange={(e) => setURL(e.target.value)}
          onKeyDown={handleKeyDown}
          className="font-mono resize-none flex-1 min-h-0"
          placeholder={t("enter_url_scheme")}
          readOnly={isLoading}
        />
        <div className="flex justify-end shrink-0">
          <div className="inline-flex items-center gap-2">
            {error && <span className="text-sm text-destructive">{error}</span>}
            <ButtonGroup>
              <Button
                size="sm"
                onClick={reset}
                variant="outline"
                disabled={isLoading}
                title={t("reset")}
                className="px-2"
              >
                <Eraser className="size-4" />
              </Button>
              <Button
                size="sm"
                onClick={handleSend}
                className="gap-2"
                variant="outline"
                disabled={isLoading}
              >
                <Send className="size-4" />
                {t("send")}
              </Button>
            </ButtonGroup>
          </div>
        </div>
      </div>
    </div>
  );
}

```

`gui/src/components/panels/FruityUserHooksList.tsx`:

```tsx
import { useEffect, useState } from "react";
import { useTranslation } from "react-i18next";
import { Trash2, Loader2 } from "lucide-react";

import { Button } from "@/components/ui/button";
import { useSession, Status } from "@/context/SessionContext";
import { formatObjCMethod } from "@/lib/hook-template";
import { useFruityQuery } from "@/lib/queries";

interface UserHook {
  type: "objc" | "native";
  module?: string | null;
  cls?: string;
  name: string;
}

export function FruityUserHooksList() {
  const { t } = useTranslation();
  const { fruity, status } = useSession();
  const [removingHook, setRemovingHook] = useState<string | null>(null);

  const {
    data: hooks = [],
    isLoading: loading,
    refetch,
  } = useFruityQuery<UserHook[]>(["userHooks"], (api) => api.hook.userHooks());

  // Listen for hooks:refresh event to reload the list
  useEffect(() => {
    const handleRefresh = () => {
      refetch();
    };
    window.addEventListener("hooks:refresh", handleRefresh);
    return () => window.removeEventListener("hooks:refresh", handleRefresh);
  }, [refetch]);

  const getHookKey = (hook: UserHook): string => {
    if (hook.type === "objc") {
      return `objc:${hook.cls}:${hook.name}`;
    }
    return `native:${hook.module || "null"}:${hook.name}`;
  };

  const getHookLabel = (hook: UserHook): string => {
    if (hook.type === "objc" && hook.cls) {
      return formatObjCMethod(hook.cls, hook.name);
    }
    return hook.module ? `${hook.module}!${hook.name}` : hook.name;
  };

  const handleRemove = async (hook: UserHook) => {
    if (!fruity) return;

    const key = getHookKey(hook);
    setRemovingHook(key);

    try {
      if (hook.type === "objc" && hook.cls) {
        await fruity.objc.unswizzle(hook.cls, hook.name);
      } else if (hook.type === "native") {
        await fruity.native.unhook(hook.module ?? null, hook.name);
      }
      // Refresh the list
      await refetch();
    } catch (error) {
      console.error("Failed to remove hook:", error);
    } finally {
      setRemovingHook(null);
    }
  };

  const isDisabled = status !== Status.Ready;

  // Group hooks by type
  const objcHooks = hooks.filter((h) => h.type === "objc");
  const nativeHooks = hooks.filter((h) => h.type === "native");

  if (loading) {
    return (
      <div className="flex items-center justify-center py-4">
        <Loader2 className="h-4 w-4 animate-spin text-muted-foreground" />
      </div>
    );
  }

  if (hooks.length === 0) {
    return (
      <p className="text-xs text-muted-foreground italic">
        {t("hook_user_no_hooks")}
      </p>
    );
  }

  const renderHookItem = (hook: UserHook) => {
    const key = getHookKey(hook);
    const isRemoving = removingHook === key;

    return (
      <div
        key={key}
        className="flex items-center justify-between p-2 rounded-md hover:bg-muted/50 transition-colors group"
      >
        <div className="flex-1 min-w-0">
          <div
            className="font-mono text-xs truncate"
            title={getHookLabel(hook)}
          >
            {getHookLabel(hook)}
          </div>
        </div>
        <div className="flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
          <Button
            variant="ghost"
            size="icon"
            className="h-6 w-6 text-destructive hover:text-destructive"
            onClick={() => handleRemove(hook)}
            disabled={isRemoving || isDisabled}
            title={t("hook_remove")}
          >
            {isRemoving ? (
              <Loader2 className="h-3.5 w-3.5 animate-spin" />
            ) : (
              <Trash2 className="h-3.5 w-3.5" />
            )}
          </Button>
        </div>
      </div>
    );
  };

  return (
    <div className="space-y-3">
      {objcHooks.length > 0 && (
        <div>
          <div className="text-[10px] font-medium text-muted-foreground uppercase tracking-wide mb-1">
            Objective-C ({objcHooks.length})
          </div>
          <div className="space-y-1">{objcHooks.map(renderHookItem)}</div>
        </div>
      )}

      {nativeHooks.length > 0 && (
        <div>
          <div className="text-[10px] font-medium text-muted-foreground uppercase tracking-wide mb-1">
            {t("hook_native")} ({nativeHooks.length})
          </div>
          <div className="space-y-1">{nativeHooks.map(renderHookItem)}</div>
        </div>
      )}
    </div>
  );
}

```

`gui/src/components/panels/ModulesPanel.tsx`:

```tsx
import { useMemo, useState } from "react";
import { useTranslation } from "react-i18next";
import { toast } from "sonner";
import { Search, EllipsisVertical, ArrowDownToLine, ArrowUpFromLine } from "lucide-react";
import { List, type RowComponentProps } from "react-window";

import { useDock } from "@/context/DockContext";
import { Input } from "@/components/ui/input";
import { Skeleton } from "@/components/ui/skeleton";
import { Button } from "@/components/ui/button";
import {
  DropdownMenu,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuSeparator,
} from "@/components/ui/dropdown-menu";
import { Platform, useSession } from "@/context/SessionContext";
import { usePlatformQuery } from "@/lib/queries";
import type { ModuleInfo } from "@agent/common/symbol";

const ITEM_HEIGHT = 72;

export function ModulesPanel() {
  const { t } = useTranslation();
  const { openFilePanel } = useDock();
  const { platform, device, pid } = useSession();
  const isDroid = platform === Platform.Droid;
  const [search, setSearch] = useState("");

  const { data: modules = [], isLoading } = usePlatformQuery(
    ["modules"],
    (api) => api.symbol.modules(),
  );

  const filteredModules = useMemo(() => {
    if (!search.trim()) return modules;
    const query = search.toLowerCase();
    return modules.filter(
      (m) =>
        m.name.toLowerCase().includes(query) ||
        m.path.toLowerCase().includes(query),
    );
  }, [modules, search]);

  return (
    <div className="h-full flex flex-col">
      <div className="p-4 space-y-4">
        <div className="relative">
          <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
          <Input
            placeholder={t("search")}
            value={search}
            onChange={(e) => setSearch(e.target.value)}
            className="pl-9"
          />
        </div>
        <div className="text-xs text-muted-foreground">
          {filteredModules.length} / {modules.length}
        </div>
      </div>
      <div className="flex-1 min-h-0 h-full">
        {isLoading ? (
          <div className="px-4 space-y-3">
            {Array.from({ length: 8 }).map((_, i) => (
              <div key={i} className="space-y-1.5">
                <Skeleton className="h-4 w-48" />
                <Skeleton className="h-3 w-64" />
                <Skeleton className="h-3 w-80" />
              </div>
            ))}
          </div>
        ) : (
          <div className="flex h-full">
            <List
              rowComponent={ModuleRow}
              rowCount={filteredModules.length}
              rowHeight={ITEM_HEIGHT}
              rowProps={{ modules: filteredModules, openFilePanel, isDroid, device, pid }}
            />
          </div>
        )}
      </div>
    </div>
  );
}

function ModuleRow({
  index,
  style,
  modules,
  openFilePanel,
  isDroid,
  device,
  pid,
}: RowComponentProps<{
  modules: ModuleInfo[];
  isDroid: boolean;
  device: string | undefined;
  pid: number | undefined;
  openFilePanel: (panel: {
    id: string;
    component: string;
    title: string;
    params: { path: string };
  }) => void;
}>) {
  const { t } = useTranslation();
  const mod = modules[index];

  const openModuleView = (component: string, suffix: string) => {
    openFilePanel({
      id: `module_${mod.base}_${component}`,
      component,
      title: `${mod.name} - ${suffix}`,
      params: { path: mod.path },
    });
  };

  return (
    <div
      className="group px-4 py-2 border-b border-border hover:bg-accent relative"
      style={style}
    >
      <div className="flex items-start justify-between">
        <button
          type="button"
          className="text-sm font-medium truncate text-left text-amber-600 dark:text-amber-400 hover:underline cursor-pointer"
          onClick={() => openModuleView("moduleExported", t("exports"))}
        >
          {mod.name}
        </button>
        <DropdownMenu>
          <DropdownMenuTrigger
            render={
              <Button
                variant="ghost"
                size="icon"
                className="h-6 w-6 shrink-0"
              />
            }
          >
            <EllipsisVertical className="h-4 w-4" />
          </DropdownMenuTrigger>
          <DropdownMenuContent align="end" className="min-w-40">
            <DropdownMenuItem onClick={() => openModuleView("moduleImports", t("imports"))}>
              <ArrowDownToLine className="h-4 w-4" />
              {t("imports")}
            </DropdownMenuItem>
            <DropdownMenuItem onClick={() => openModuleView("moduleExported", t("exports"))}>
              <ArrowUpFromLine className="h-4 w-4" />
              {t("exports")}
            </DropdownMenuItem>
            <DropdownMenuItem onClick={() => openModuleView("moduleSymbols", t("symbols"))}>
              <span className="h-4 w-4" />
              {t("symbols")}
            </DropdownMenuItem>
            <DropdownMenuSeparator />
            <DropdownMenuItem onClick={() => openModuleView("moduleSections", t("sections"))}>
              <span className="h-4 w-4" />
              {t("sections")}
            </DropdownMenuItem>
            {!isDroid && (
              <DropdownMenuItem onClick={() => openModuleView("moduleClasses", t("classes"))}>
                <span className="h-4 w-4" />
                {t("classes")}
              </DropdownMenuItem>
            )}
            {!isDroid && (
              <>
                <DropdownMenuSeparator />
                <DropdownMenuItem onClick={async () => {
                  const url = `/api/dump/${device}/${pid}?path=${encodeURIComponent(mod.path)}`;
                  const res = await fetch(url, { method: "HEAD" });
                  if (res.ok) {
                    location.replace(url);
                  } else {
                    toast.warning(t("dump_decrypted_error"));
                  }
                }}>
                  <span className="h-4 w-4" />
                  {t("dump_decrypted")}
                </DropdownMenuItem>
              </>
            )}
          </DropdownMenuContent>
        </DropdownMenu>
      </div>
      <div className="text-xs text-muted-foreground font-mono truncate">
        {mod.base.toLowerCase()}-
        {"0x" + (parseInt(mod.base, 16) + mod.size).toString(16).toLowerCase()}
      </div>
      <div className="text-xs text-muted-foreground truncate">{mod.path}</div>
    </div>
  );
}

```

`gui/src/components/panels/PlaceholderPanel.tsx`:

```tsx
import { useTranslation } from "react-i18next";
import { Construction } from "lucide-react";

import { useSession, Platform, Mode } from "@/context/SessionContext";

export function PlaceholderPanel() {
  const { t } = useTranslation();
  const { platform, mode } = useSession();

  const getPlatformName = () => {
    if (platform === Platform.Fruity) return "iOS";
    if (platform === Platform.Droid) return "Android";
    return "Unknown";
  };

  const getModeName = () => {
    if (mode === Mode.App) return t("app");
    if (mode === Mode.Daemon) return t("daemon");
    return "Unknown";
  };

  return (
    <div className="flex flex-col items-center justify-center h-full text-muted-foreground gap-4">
      <Construction className="h-16 w-16" />
      <div className="text-center">
        <h2 className="text-lg font-semibold mb-2">
          {getPlatformName()} {getModeName()} {t("mode")}
        </h2>
        <p className="text-sm">
          {t("feature_coming_soon")}
        </p>
      </div>
    </div>
  );
}

```

`gui/src/components/providers/R2Provider.tsx`:

```tsx
import { type ReactNode, useCallback } from "react";
import { useR2, type Platform, type Architecture } from "@frida/react-use-r2";
import { useSession } from "@/context/SessionContext";
import { useFruityQuery } from "@/lib/queries";

interface ProcessInfo {
  platform: string;
  arch: string;
  pointerSize: number;
  pageSize: number;
}

function mapPlatform(platform: string): Platform {
  const platformMap: Record<string, Platform> = {
    darwin: "darwin",
    linux: "linux",
    windows: "windows",
  };
  return platformMap[platform] ?? "darwin";
}

function mapArch(arch: string): Architecture {
  const archMap: Record<string, Architecture> = {
    arm: "arm",
    ia32: "ia32",
    x86: "ia32",
    x64: "x64",
  };
  return archMap[arch] ?? "arm64";
}

export function R2Provider({ children }: { children: ReactNode }) {
  const { fruity } = useSession();

  const { data: processInfo } = useFruityQuery<ProcessInfo>(
    ["processInfo"],
    (api) => api.info.processInfo(),
  );

  const onReadRequest = useCallback(
    async (address: bigint, size: number): Promise<Uint8Array | null> => {
      if (!fruity) return null;

      // Agent's memory.dump has a 2KB limit, so we need to chunk reads
      const CHUNK_SIZE = 2048;
      const result = new Uint8Array(size);
      let offset = 0;

      while (offset < size) {
        const chunkSize = Math.min(CHUNK_SIZE, size - offset);
        const chunkAddress = address + BigInt(offset);
        try {
          const chunk = await fruity.memory.dump(
            "0x" + chunkAddress.toString(16),
            chunkSize,
          );
          if (chunk === null) {
            // Read failed - fill remaining with zeros
            return null;
          }
          result.set(new Uint8Array(chunk), offset);
          offset += chunk.byteLength;
          // If we got less than requested, stop
          if (chunk.byteLength < chunkSize) {
            break;
          }
        } catch {
          return null;
        }
      }

      return result;
    },
    [fruity],
  );

  useR2({
    source: processInfo
      ? {
          platform: mapPlatform(processInfo.platform),
          arch: mapArch(processInfo.arch),
          pointerSize: processInfo.pointerSize,
          pageSize: processInfo.pageSize,
          onReadRequest,
        }
      : undefined,
  });

  return <>{children}</>;
}

```

`gui/src/components/providers/SessionProvider.tsx`:

```tsx
import { type ReactNode, useMemo, useEffect, useState } from "react";
import { Navigate, useParams, useSearchParams } from "react-router";
import { io, Socket } from "socket.io-client";

import {
  Status,
  Mode,
  SessionContext,
  type StatusType,
  type PlatformType,
  type ModeType,
} from "@/context/SessionContext";

import {
  createAPI,
  type SessionClientEvents,
  type SessionServerEvents,
} from "@/lib/rpc";
import { fnv1a } from "@/lib/hash";

import { CrashDialog, type CrashDetail } from "@/components/shared/CrashDialog";
import { DeniedDialog } from "@/components/shared/DeniedDialog";

function SessionProvider({ children }: { children: ReactNode }) {
  const params = useParams();
  const [searchParams] = useSearchParams();

  // Extract platform, mode, device from route params
  const platform = params.platform as PlatformType | undefined;
  const mode = params.mode as ModeType | undefined;
  const device = params.device;

  // For app mode, use bundle; for daemon mode, use pid from URL
  const bundle = mode === Mode.App ? params.target : undefined;
  const targetPid = mode === Mode.Daemon ? parseInt(params.target || "0", 10) : undefined;
  const processName = mode === Mode.Daemon ? (searchParams.get("name") ?? undefined) : undefined;

  const [status, setStatus] = useState<StatusType>(Status.Disconnected);
  const [pid, setPid] = useState<number | undefined>(targetPid);
  const [fridaMajor, setFridaMajor] = useState(17);
  const [crashDetail, setCrashDetail] = useState<CrashDetail | null>(null);
  const [denied, setDenied] = useState(false);

  useEffect(() => {
    fetch("/api/version")
      .then((r) => r.json())
      .then((v: { frida: string }) => {
        const major = parseInt(v.frida, 10);
        if (major === 16 || major === 17) setFridaMajor(major);
      })
      .catch(() => {});
  }, []);

  // Compute project identifier matching server-side logic
  const identifier = useMemo(() => {
    if (mode === Mode.App && bundle) return bundle;
    if (mode === Mode.Daemon && targetPid) {
      const pname = processName || "pid";
      return `${pname}-${fnv1a(pname + targetPid)}`;
    }
    return undefined;
  }, [mode, bundle, targetPid, processName]);

  const { socket, fruity, droid } = useMemo(() => {
    if (!device || !platform || !mode) {
      console.warn("Device, platform, or mode missing from URL.");
      setStatus(Status.Disconnected);
      return { socket: null, fruity: null, droid: null };
    }

    // Build query params based on mode
    const query: Record<string, string> = { device, platform, mode };
    if (mode === Mode.App && bundle) {
      query.bundle = bundle;
    } else if (mode === Mode.Daemon && targetPid) {
      query.pid = String(targetPid);
      if (processName) query.name = processName;
    }

    const socket: Socket<SessionClientEvents, SessionServerEvents> = io(
      "/session",
      { query },
    );

    socket
      .on("denied", () => {
        setDenied(true);
      })
      .on("invalid", () => {
        // bug workaround: first time connection
        // the server receives empty query
        location.reload();
      })
      .on("ready", (newPid: number) => {
        console.log("socket.io ready");
        setStatus(Status.Ready);
        setPid(newPid);
      })
      .on("log", (level: string, message: string) => {
        console.log("agent log", level, message);
      })
      .on("syslog", (message: string) => {
        console.log("syslog", message);
      })
      .on("connect", () => {
        console.debug("socket.io connect");
        setStatus(Status.Connecting);
      })
      .on("fatal", (detail) => {
        setCrashDetail(detail as CrashDetail);
      })
      .on("disconnect", () => {
        console.debug("socket.io disconnect");
        setStatus(Status.Disconnected);
        if (mode === Mode.App) {
          setPid(undefined);
        }
      });

    const { fruity, droid } = createAPI(socket, platform);
    setStatus(Status.Connecting);

    return { socket, fruity, droid };
  }, [device, platform, mode, bundle, targetPid, processName]);

  useEffect(() => {
    return () => {
      if (status === Status.Ready && socket) {
        console.debug("disconnect for", bundle || targetPid);
        socket.disconnect();
      }
    };
  }, [device, platform, mode, bundle, targetPid, processName, socket, status]);

  const contextValue = useMemo(
    () => ({
      platform,
      mode,
      device,
      bundle,
      pid,
      identifier,
      fruity,
      droid,
      status,
      socket,
      fridaMajor,
    }),
    [platform, mode, device, bundle, pid, identifier, fruity, droid, status, socket, fridaMajor],
  );

  // Validate required params
  if (!device || !platform || !mode) {
    return <Navigate to="/" replace />;
  }

  // For app mode, bundle is required
  if (mode === Mode.App && !bundle) {
    return <Navigate to="/" replace />;
  }

  // For daemon mode, pid is required
  if (mode === Mode.Daemon && !targetPid) {
    return <Navigate to="/" replace />;
  }

  return (
    <SessionContext.Provider value={contextValue}>
      {children}
      <DeniedDialog open={denied} />
      <CrashDialog detail={crashDetail} showRelaunch={mode === Mode.App} />
    </SessionContext.Provider>
  );
}

export default SessionProvider;

```

`gui/src/components/providers/ThemeProvider.tsx`:

```tsx
import { createContext, useContext, useEffect, useState } from "react";

type Theme = "dark" | "light" | "system";

type ThemeProviderProps = {
  children: React.ReactNode;
  defaultTheme?: Theme;
  storageKey?: string;
};

type ThemeProviderState = {
  theme: Theme;
  setTheme: (theme: Theme) => void;
};

const initialState: ThemeProviderState = {
  theme: "system",
  setTheme: () => null,
};

const ThemeProviderContext = createContext<ThemeProviderState>(initialState);

export function ThemeProvider({
  children,
  defaultTheme = "system",
  storageKey = "vite-ui-theme",
  ...props
}: ThemeProviderProps) {
  const [theme, setTheme] = useState<Theme>(
    () => (localStorage.getItem(storageKey) as Theme) || defaultTheme
  );

  useEffect(() => {
    const root = window.document.documentElement;

    root.classList.remove("light", "dark");

    if (theme === "system") {
      const systemTheme = window.matchMedia("(prefers-color-scheme: dark)")
        .matches
        ? "dark"
        : "light";

      root.classList.add(systemTheme);
      return;
    }

    root.classList.add(theme);
  }, [theme]);

  const value = {
    theme,
    setTheme: (theme: Theme) => {
      localStorage.setItem(storageKey, theme);
      setTheme(theme);
    },
  };

  return (
    <ThemeProviderContext.Provider {...props} value={value}>
      {children}
    </ThemeProviderContext.Provider>
  );
}

export const useTheme = () => {
  const context = useContext(ThemeProviderContext);

  if (context === undefined)
    throw new Error("useTheme must be used within a ThemeProvider");

  return context;
};

```

`gui/src/components/shared/ConsoleRepl.tsx`:

```tsx
import {
  useState,
  useRef,
  useCallback,
  useEffect,
  forwardRef,
  useImperativeHandle,
} from "react";
import { Trash2 } from "lucide-react";
import { Button } from "@/components/ui/button";
import { Spinner } from "@/components/ui/spinner";
import JsonTreeView from "./JsonTreeView";

export interface ConsoleReplHandle {
  clear: () => void;
}

interface ConsoleReplProps {
  onEvaluate: (input: string) => Promise<unknown>;
  placeholder?: string;
}

interface ReplEntry {
  id: number;
  input: string;
  status: "loading" | "success" | "error";
  result?: unknown;
  error?: string;
}

let nextId = 0;

const ConsoleRepl = forwardRef<ConsoleReplHandle, ConsoleReplProps>(
  function ConsoleRepl({ onEvaluate, placeholder = "Expression..." }, ref) {
    const [entries, setEntries] = useState<ReplEntry[]>([]);
    const [input, setInput] = useState("");
    const [historyIndex, setHistoryIndex] = useState(-1);
    const historyRef = useRef<string[]>([]);
    const scrollRef = useRef<HTMLDivElement>(null);
    const inputRef = useRef<HTMLInputElement>(null);

    useImperativeHandle(ref, () => ({
      clear() {
        setEntries([]);
      },
    }));

    // Auto-scroll to bottom on new entries
    useEffect(() => {
      const el = scrollRef.current;
      if (el) el.scrollTop = el.scrollHeight;
    }, [entries]);

    const submit = useCallback(
      async (expr: string) => {
        const trimmed = expr.trim();
        if (!trimmed) return;

        historyRef.current.push(trimmed);
        setHistoryIndex(-1);
        setInput("");

        const id = nextId++;
        const entry: ReplEntry = { id, input: trimmed, status: "loading" };
        setEntries((prev) => [...prev, entry]);

        try {
          const result = await onEvaluate(trimmed);
          setEntries((prev) =>
            prev.map((e) =>
              e.id === id ? { ...e, status: "success", result } : e,
            ),
          );
        } catch (err) {
          setEntries((prev) =>
            prev.map((e) =>
              e.id === id
                ? {
                    ...e,
                    status: "error",
                    error: err instanceof Error ? err.message : String(err),
                  }
                : e,
            ),
          );
        }
      },
      [onEvaluate],
    );

    const handleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {
      if (e.key === "Enter") {
        e.preventDefault();
        submit(input);
        return;
      }

      const history = historyRef.current;
      if (e.key === "ArrowUp") {
        e.preventDefault();
        if (history.length === 0) return;
        const next =
          historyIndex === -1 ? history.length - 1 : Math.max(0, historyIndex - 1);
        setHistoryIndex(next);
        setInput(history[next]);
      } else if (e.key === "ArrowDown") {
        e.preventDefault();
        if (historyIndex === -1) return;
        const next = historyIndex + 1;
        if (next >= history.length) {
          setHistoryIndex(-1);
          setInput("");
        } else {
          setHistoryIndex(next);
          setInput(history[next]);
        }
      }
    };

    return (
      <div className="h-full flex flex-col">
        {/* Toolbar */}
        <div className="flex items-center justify-end px-2 py-1 border-b">
          <Button
            variant="ghost"
            size="icon"
            className="h-6 w-6"
            onClick={() => setEntries([])}
            title="Clear console"
          >
            <Trash2 className="h-3 w-3" />
          </Button>
        </div>

        {/* History */}
        <div ref={scrollRef} className="flex-1 overflow-y-auto px-3 py-2">
          {entries.map((entry) => (
            <div key={entry.id} className="mb-2">
              <div className="font-mono text-[11px] text-muted-foreground">
                <span className="text-blue-500 dark:text-blue-400 mr-1">
                  &gt;
                </span>
                {entry.input}
              </div>
              <div className="pl-4 mt-0.5">
                {entry.status === "loading" && (
                  <Spinner className="h-3 w-3" />
                )}
                {entry.status === "error" && (
                  <span className="font-mono text-[11px] text-red-600 dark:text-red-400">
                    {entry.error}
                  </span>
                )}
                {entry.status === "success" && (
                  <ReplResult value={entry.result} />
                )}
              </div>
            </div>
          ))}
        </div>

        {/* Input */}
        <div className="flex items-center border-t px-3 py-1.5 gap-2">
          <span className="font-mono text-[11px] text-blue-500 dark:text-blue-400 shrink-0">
            &gt;
          </span>
          <input
            ref={inputRef}
            value={input}
            onChange={(e) => {
              setInput(e.target.value);
              setHistoryIndex(-1);
            }}
            onKeyDown={handleKeyDown}
            placeholder={placeholder}
            className="flex-1 bg-transparent font-mono text-[11px] outline-none placeholder:text-muted-foreground"
            autoFocus
          />
        </div>
      </div>
    );
  },
);

function ReplResult({ value }: { value: unknown }) {
  if (value === undefined) {
    return (
      <span className="font-mono text-[11px] text-muted-foreground">
        undefined
      </span>
    );
  }
  if (value !== null && typeof value === "object") {
    return <JsonTreeView value={value} defaultExpanded={2} />;
  }
  // Inline primitive
  return (
    <div className="font-mono text-[11px]">
      <InlineValue value={value} />
    </div>
  );
}

function InlineValue({ value }: { value: unknown }) {
  if (value === null) {
    return <span className="text-muted-foreground">null</span>;
  }
  switch (typeof value) {
    case "string":
      return (
        <span className="text-emerald-600 dark:text-emerald-400">
          &quot;{value}&quot;
        </span>
      );
    case "number":
      return <span className="text-sky-600 dark:text-sky-400">{value}</span>;
    case "boolean":
      return (
        <span className="text-amber-600 dark:text-amber-400">
          {String(value)}
        </span>
      );
    default:
      return <span className="text-muted-foreground">{String(value)}</span>;
  }
}

export default ConsoleRepl;

```

`gui/src/components/shared/CrashDialog.tsx`:

```tsx
import { useNavigate } from "react-router";

import {
  AlertDialog,
  AlertDialogContent,
  AlertDialogHeader,
  AlertDialogTitle,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogAction,
} from "@/components/ui/alert-dialog";
import { Badge } from "@/components/ui/badge";
import { ScrollArea } from "@/components/ui/scroll-area";

export interface CrashDetail {
  type: string;
  address: string;
  message?: string;
  memory?: { operation: string; address: string };
  context: Record<string, unknown>;
  backtrace?: string[];
}

const SIMD_REGISTER = /^[qds]\d+$/;

function getGeneralRegisters(
  ctx: Record<string, unknown>,
): [string, string][] {
  return Object.entries(ctx)
    .filter(([key]) => !SIMD_REGISTER.test(key) && key !== "nativeContext")
    .map(([key, value]) => [key, String(value)]);
}

export function CrashDialog({
  detail,
  showRelaunch,
}: {
  detail: CrashDetail | null;
  showRelaunch: boolean;
}) {
  const navigate = useNavigate();

  return (
    <AlertDialog open={detail !== null}>
      <AlertDialogContent size="lg">
        <AlertDialogHeader>
          <AlertDialogTitle>Process Crashed</AlertDialogTitle>
          <AlertDialogDescription>
            The target process encountered a fatal error and will be terminated.
          </AlertDialogDescription>
        </AlertDialogHeader>
        {detail && (
          <ScrollArea className="max-h-[60vh]">
            <div className="space-y-4 text-sm">
              <div className="space-y-1.5">
                <div className="flex items-center gap-2">
                  <span className="text-muted-foreground w-20 shrink-0">
                    Type
                  </span>
                  <Badge variant="destructive">{detail.type}</Badge>
                </div>
                <div className="flex items-center gap-2">
                  <span className="text-muted-foreground w-20 shrink-0">
                    Address
                  </span>
                  <span className="font-mono text-xs">{detail.address}</span>
                </div>
                {detail.message && (
                  <div className="flex items-start gap-2">
                    <span className="text-muted-foreground w-20 shrink-0">
                      Message
                    </span>
                    <span className="text-xs">{detail.message}</span>
                  </div>
                )}
                {detail.memory && (
                  <div className="flex items-center gap-2">
                    <span className="text-muted-foreground w-20 shrink-0">
                      Memory
                    </span>
                    <span className="text-xs">
                      <Badge variant="outline" className="mr-1.5">
                        {detail.memory.operation}
                      </Badge>
                      <span className="font-mono">
                        {detail.memory.address}
                      </span>
                    </span>
                  </div>
                )}
              </div>
              <div>
                <span className="text-muted-foreground text-xs font-medium uppercase tracking-wide">
                  Registers
                </span>
                <div className="mt-1.5 grid grid-cols-2 gap-x-6 gap-y-0.5">
                  {getGeneralRegisters(detail.context).map(
                    ([name, value]) => (
                      <div
                        key={name}
                        className="flex items-center gap-2 py-0.5 border-b border-border/30"
                      >
                        <span className="text-muted-foreground font-mono text-xs w-8 shrink-0 text-right">
                          {name}
                        </span>
                        <span className="font-mono text-xs">{value}</span>
                      </div>
                    ),
                  )}
                </div>
              </div>
              {detail.backtrace && detail.backtrace.length > 0 && (
                <div>
                  <span className="text-muted-foreground text-xs font-medium uppercase tracking-wide">
                    Backtrace
                  </span>
                  <div className="mt-1.5 space-y-0.5">
                    {detail.backtrace.map((frame, i) => (
                      <div
                        key={i}
                        className="flex items-baseline gap-2 py-0.5 border-b border-border/30"
                      >
                        <span className="text-muted-foreground font-mono text-xs w-4 shrink-0 text-right">
                          {i}
                        </span>
                        <span className="font-mono text-xs break-all">
                          {frame}
                        </span>
                      </div>
                    ))}
                  </div>
                </div>
              )}
            </div>
          </ScrollArea>
        )}
        <AlertDialogFooter>
          {showRelaunch && (
            <AlertDialogAction onClick={() => location.reload()}>
              Relaunch
            </AlertDialogAction>
          )}
          <AlertDialogAction variant="outline" onClick={() => navigate("/")}>
            Home
          </AlertDialogAction>
        </AlertDialogFooter>
      </AlertDialogContent>
    </AlertDialog>
  );
}

```

`gui/src/components/shared/CryptoResultsView.tsx`:

```tsx
import {
  useEffect,
  useRef,
  useState,
  useCallback,
  useMemo,
  type CSSProperties,
} from "react";
import { useTranslation } from "react-i18next";
import { List, type ListImperativeAPI } from "react-window";
import { ChevronRight, Trash2, ChevronsDown } from "lucide-react";

import { Button } from "@/components/ui/button";
import { ScrollArea } from "@/components/ui/scroll-area";
import { Badge } from "@/components/ui/badge";
import { Switch } from "@/components/ui/switch";
import { Label } from "@/components/ui/label";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import {
  ResizableHandle,
  ResizablePanel,
  ResizablePanelGroup,
} from "@/components/ui/resizable";
import { useSession, Status, Platform } from "@/context/SessionContext";
import { useFruityQuery, useDroidQuery } from "@/lib/queries";
import { useLogStream } from "@/hooks/useLogStream";
import { toTime } from "@/lib/format";

import type { BaseMessage as BaseHookMessage } from "@agent/common/hooks/context";

interface CryptoEntry {
  id: number;
  timestamp: Date;
  message: BaseHookMessage;
  data?: ArrayBuffer;
}

const ROW_HEIGHT = 32;

function base64ToArrayBuffer(base64: string): ArrayBuffer {
  const bin = atob(base64);
  const buf = new Uint8Array(bin.length);
  for (let i = 0; i < bin.length; i++) buf[i] = bin.charCodeAt(i);
  return buf.buffer;
}

function formatHexDump(buffer: ArrayBuffer): string {
  const bytes = new Uint8Array(buffer);
  const lines: string[] = [];
  for (let offset = 0; offset < bytes.length; offset += 16) {
    const chunk = bytes.slice(offset, offset + 16);
    const addr = offset.toString(16).padStart(8, "0");
    const hexParts: string[] = [];
    for (let i = 0; i < 16; i += 2) {
      if (i < chunk.length) {
        const h = chunk[i].toString(16).padStart(2, "0");
        const h2 =
          i + 1 < chunk.length
            ? chunk[i + 1].toString(16).padStart(2, "0")
            : "  ";
        hexParts.push(h + h2);
      } else {
        hexParts.push("    ");
      }
    }
    const ascii = Array.from(chunk)
      .map((b) => (b >= 0x20 && b <= 0x7e ? String.fromCharCode(b) : "."))
      .join("")
      .padEnd(16);
    lines.push(`${addr}: ${hexParts.join(" ")}  ${ascii}`);
  }
  return lines.join("\n");
}

const FRUITY_CRYPTO_GROUPS = ["cccrypt", "x509", "hash", "hmac"] as const;
const DROID_CRYPTO_GROUPS = ["cipher", "pbkdf", "keygen"] as const;

interface CryptoRowProps {
  entries: CryptoEntry[];
  selectedId: number | null;
  onSelect: (id: number) => void;
}

function CryptoRow(
  props: {
    ariaAttributes: {
      "aria-posinset": number;
      "aria-setsize": number;
      role: "listitem";
    };
    index: number;
    style: CSSProperties;
  } & CryptoRowProps,
) {
  const { index, style, entries, selectedId, onSelect } = props;
  const entry = entries[index];

  if (!entry) return null;

  const { message, timestamp, data } = entry;
  const isSelected = selectedId === entry.id;
  const extra = message.extra as
    | { op?: string; algo?: string; detailType?: string; len?: number }
    | undefined;

  return (
    <div
      style={style}
      className={`flex items-center px-3 py-1 border-b border-border/50 hover:bg-muted/30 text-xs gap-2 cursor-pointer ${isSelected ? "bg-accent" : ""}`}
      onClick={() => onSelect(entry.id)}
    >
      <span className="text-muted-foreground font-mono w-24 shrink-0">
        {toTime(timestamp)}
      </span>
      <Badge
        variant={message.dir === "enter" ? "default" : "secondary"}
        className="h-5 px-1.5 text-[10px] shrink-0"
      >
        <ChevronRight
          className={`h-3 w-3 ${message.dir === "leave" ? "rotate-180" : ""}`}
        />
      </Badge>
      <span
        className="font-mono text-primary truncate w-40 shrink-0"
        title={message.symbol}
      >
        {message.symbol}
      </span>
      {extra?.op && (
        <Badge variant="outline" className="h-5 px-1.5 text-[10px] shrink-0">
          {extra.op}
        </Badge>
      )}
      {extra?.algo && (
        <Badge variant="outline" className="h-5 px-1.5 text-[10px] shrink-0">
          {extra.algo}
        </Badge>
      )}
      {extra?.detailType && (
        <Badge variant="secondary" className="h-5 px-1.5 text-[10px] shrink-0">
          {extra.detailType}
          {extra.len !== undefined && ` ${extra.len}B`}
        </Badge>
      )}
      <span
        className="font-mono text-muted-foreground truncate flex-1 min-w-0"
        title={message.line || ""}
      >
        {message.line || ""}
      </span>
      {data && (
        <Badge variant="secondary" className="h-5 px-1.5 text-[10px] shrink-0">
          {data.byteLength}B
        </Badge>
      )}
    </div>
  );
}

const CRYPTO_DETAIL_TAB_STATE = "CRYPTO_DETAIL_TAB_STATE";

function DetailPanel({ entry }: { entry: CryptoEntry }) {
  const { t } = useTranslation();
  const { message, data } = entry;
  const extra = message.extra as Record<string, unknown> | undefined;

  const hasData = !!data;
  const hasBt = !!message.backtrace?.length;

  const savedTab = localStorage.getItem(CRYPTO_DETAIL_TAB_STATE);
  const availableTabs = [
    "detail",
    ...(hasData ? ["hexdump"] : []),
    ...(hasBt ? ["backtrace"] : []),
  ];
  const defaultTab =
    savedTab && availableTabs.includes(savedTab)
      ? savedTab
      : hasData
        ? "hexdump"
        : hasBt
          ? "backtrace"
          : "detail";

  return (
    <Tabs
      defaultValue={defaultTab}
      onValueChange={(v) => localStorage.setItem(CRYPTO_DETAIL_TAB_STATE, v)}
      className="h-full flex flex-col"
    >
      <TabsList variant="line" className="mx-2 mt-2 shrink-0">
        <TabsTrigger value="detail">{t("crypto_detail_tab")}</TabsTrigger>
        {hasData && (
          <TabsTrigger value="hexdump">{t("crypto_hexdump_tab")}</TabsTrigger>
        )}
        {hasBt && (
          <TabsTrigger value="backtrace">
            {t("crypto_backtrace_tab")}
          </TabsTrigger>
        )}
      </TabsList>

      <TabsContent value="detail" className="flex-1 min-h-0">
        <ScrollArea className="h-full">
          <div className="p-3 space-y-3">
            <div>
              <div className="text-xs font-semibold text-muted-foreground mb-1">
                Symbol
              </div>
              <pre className="text-xs font-mono break-all">
                {message.symbol}
              </pre>
            </div>
            <div>
              <div className="text-xs font-semibold text-muted-foreground mb-1">
                Direction
              </div>
              <Badge
                variant={message.dir === "enter" ? "default" : "secondary"}
                className="text-xs"
              >
                {message.dir}
              </Badge>
            </div>
            {message.line && (
              <div>
                <div className="text-xs font-semibold text-muted-foreground mb-1">
                  Detail
                </div>
                <pre className="text-xs font-mono whitespace-pre-wrap break-all bg-muted p-2 rounded select-all">
                  {message.line}
                </pre>
              </div>
            )}
            {extra && Object.keys(extra).length > 0 && (
              <div>
                <div className="text-xs font-semibold text-muted-foreground mb-1">
                  Extra
                </div>
                <div className="space-y-0.5">
                  {Object.entries(extra).map(([k, v]) => (
                    <div key={k} className="text-xs font-mono break-all">
                      <span className="text-blue-500 dark:text-blue-400">
                        {k}
                      </span>
                      <span className="text-muted-foreground">: </span>
                      <span>{String(v)}</span>
                    </div>
                  ))}
                </div>
              </div>
            )}
          </div>
        </ScrollArea>
      </TabsContent>

      {hasData && (
        <TabsContent value="hexdump" className="flex-1 min-h-0">
          <ScrollArea className="h-full">
            <div className="p-3">
              <div className="text-xs text-muted-foreground mb-2">
                {data.byteLength} bytes
              </div>
              <pre className="font-mono text-[11px] leading-5 select-all">
                {formatHexDump(data)}
              </pre>
            </div>
          </ScrollArea>
        </TabsContent>
      )}

      {hasBt && (
        <TabsContent value="backtrace" className="flex-1 min-h-0">
          <ScrollArea className="h-full">
            <div className="p-2 font-mono text-xs space-y-1">
              {message.backtrace!.map((frame, index) => (
                <div
                  key={index}
                  className="p-1.5 rounded hover:bg-muted/50 break-all"
                >
                  <span className="text-muted-foreground mr-2">#{index}</span>
                  {frame}
                </div>
              ))}
            </div>
          </ScrollArea>
        </TabsContent>
      )}
    </Tabs>
  );
}

const mapHistory = (record: Record<string, unknown>, id: number): CryptoEntry => ({
  id,
  timestamp: new Date(record.timestamp as string),
  message: {
    subject: "crypto",
    category: "crypto",
    symbol: record.symbol as string,
    dir: record.direction as "enter" | "leave",
    line: (record.line as string) ?? undefined,
    extra: record.extra as Record<string, unknown> | undefined,
    backtrace: record.backtrace as string[] | undefined,
  },
  data: record.data ? base64ToArrayBuffer(record.data as string) : undefined,
});

const mapSocket = (id: number, ...args: unknown[]): CryptoEntry => ({
  id,
  timestamp: new Date(),
  message: args[0] as BaseHookMessage,
  data: args[1] as ArrayBuffer | undefined,
});

export function CryptoResultsView() {
  const { t } = useTranslation();
  const { fruity, droid, status, device, identifier, platform } = useSession();
  const isDroid = platform === Platform.Droid;
  const cryptoGroups = isDroid ? DROID_CRYPTO_GROUPS : FRUITY_CRYPTO_GROUPS;

  const listRef = useRef<ListImperativeAPI>(null);
  const containerRef = useRef<HTMLDivElement>(null);
  const [listHeight, setListHeight] = useState(300);
  const [autoScroll, setAutoScroll] = useState(true);

  const {
    entries,
    selectedId,
    setSelectedId,
    selectedEntry,
    clear,
  } = useLogStream<CryptoEntry>({
    event: "crypto",
    path: "history/crypto",
    key: "logs",
    fromRecord: mapHistory,
    fromEvent: mapSocket,
    max: 10000,
  });

  const handleSelect = useCallback((id: number) => {
    setSelectedId(selectedId === id ? null : id);
  }, [selectedId, setSelectedId]);

  // Crypto sub-group toggle state
  const [cryptoStatus, setCryptoStatus] = useState<Record<string, boolean>>({});
  const [loading, setLoading] = useState<Record<string, boolean>>({});

  // Fetch crypto sub-group status (platform-aware)
  const { data: fruityInitStatus } = useFruityQuery<Record<string, boolean>>(
    ["cryptoStatus", device ?? "", identifier ?? ""],
    (api) => api.crypto.status(),
    { enabled: !isDroid },
  );
  const { data: droidInitStatus } = useDroidQuery<Record<string, boolean>>(
    ["cryptoStatus", device ?? "", identifier ?? ""],
    (api) => api.crypto.status(),
    { enabled: isDroid },
  );

  const initialStatus = isDroid ? droidInitStatus : fruityInitStatus;

  useEffect(() => {
    if (initialStatus) {
      setCryptoStatus(initialStatus);
    }
  }, [initialStatus]);

  const handleToggle = async (groupId: string, enabled: boolean) => {
    const api = isDroid ? droid : fruity;
    if (!api) return;

    setLoading((prev) => ({ ...prev, [groupId]: true }));

    try {
      if (enabled) {
        await api.crypto.start(groupId);
      } else {
        await api.crypto.stop(groupId);
      }
      setCryptoStatus((prev) => ({ ...prev, [groupId]: enabled }));
    } catch (error) {
      console.error(
        `Failed to ${enabled ? "start" : "stop"} crypto group ${groupId}:`,
        error,
      );
    } finally {
      setLoading((prev) => ({ ...prev, [groupId]: false }));
    }
  };

  // Resize observer
  useEffect(() => {
    if (!containerRef.current) return;

    const observer = new ResizeObserver((entries) => {
      for (const entry of entries) {
        setListHeight(entry.contentRect.height);
      }
    });

    observer.observe(containerRef.current);
    return () => observer.disconnect();
  }, []);

  // Auto-scroll when new entries arrive
  useEffect(() => {
    if (autoScroll && listRef.current && entries.length > 0) {
      requestAnimationFrame(() => {
        listRef.current?.scrollToRow({
          index: entries.length - 1,
          align: "end",
        });
      });
    }
  }, [entries.length, autoScroll]);

  const handleRowsRendered = useCallback(
    (visibleRows: { startIndex: number; stopIndex: number }) => {
      const isNearBottom = visibleRows.stopIndex >= entries.length - 3;
      setAutoScroll(isNearBottom);
    },
    [entries.length],
  );

  const scrollToLatest = useCallback(() => {
    if (listRef.current && entries.length > 0) {
      listRef.current.scrollToRow({ index: entries.length - 1, align: "end" });
      setAutoScroll(true);
    }
  }, [entries.length]);

  const rowProps: CryptoRowProps = useMemo(
    () => ({ entries, selectedId, onSelect: handleSelect }),
    [entries, selectedId, handleSelect],
  );

  const isDisabled = status !== Status.Ready;

  return (
    <div className="h-full flex flex-col">
      {/* Header with toggles */}
      <div className="flex items-center justify-between px-3 py-2 border-b bg-muted/30">
        <div className="flex items-center gap-4">
          {cryptoGroups.map((group) => (
            <div key={group} className="flex items-center gap-1.5">
              <Switch
                id={`crypto-${group}`}
                checked={cryptoStatus[group] || false}
                onCheckedChange={(checked) => handleToggle(group, checked)}
                disabled={isDisabled || loading[group]}
                className="scale-75"
              />
              <Label
                htmlFor={`crypto-${group}`}
                className={`text-xs cursor-pointer ${loading[group] ? "animate-pulse" : ""}`}
              >
                {group}
              </Label>
            </div>
          ))}
        </div>
        <div className="flex items-center gap-2">
          <span className="text-xs text-muted-foreground">
            {entries.length.toLocaleString()}
          </span>
          {!autoScroll && (
            <Button
              variant="secondary"
              size="sm"
              onClick={scrollToLatest}
              className="h-6 px-2 text-[10px] gap-1"
            >
              <ChevronsDown className="h-3 w-3" />
            </Button>
          )}
          <Button
            variant="ghost"
            size="sm"
            onClick={clear}
            className="h-7 px-2"
          >
            <Trash2 className="h-3.5 w-3.5" />
          </Button>
        </div>
      </div>

      {/* Two-column content */}
      <ResizablePanelGroup
        orientation="horizontal"
        className="flex-1 min-h-0"
        autoSaveId="crypto-results-split"
      >
        {/* Left: entry list */}
        <ResizablePanel
          defaultSize={selectedEntry ? "60%" : "100%"}
          minSize="30%"
        >
          <div ref={containerRef} className="h-full">
            {entries.length === 0 ? (
              <div className="flex items-center justify-center h-full text-muted-foreground text-sm">
                {t("crypto_no_results")}
              </div>
            ) : (
              <List
                listRef={listRef}
                style={{ height: listHeight, width: "100%" }}
                rowCount={entries.length}
                rowHeight={ROW_HEIGHT}
                rowProps={rowProps}
                rowComponent={CryptoRow}
                onRowsRendered={handleRowsRendered}
                overscanCount={20}
              />
            )}
          </div>
        </ResizablePanel>

        {/* Right: detail panel (only when selected) */}
        {selectedEntry && (
          <>
            <ResizableHandle />
            <ResizablePanel defaultSize="40%" minSize="20%">
              <DetailPanel key={selectedEntry.id} entry={selectedEntry} />
            </ResizablePanel>
          </>
        )}
      </ResizablePanelGroup>
    </div>
  );
}

```

`gui/src/components/shared/DarkmodeToggle.tsx`:

```tsx
import { useTranslation } from "react-i18next";
import { SunIcon, MoonIcon } from "lucide-react";

import { useTheme } from "../providers/ThemeProvider";

import { Button } from "../ui/button";
import { Tooltip, TooltipContent, TooltipTrigger } from "../ui/tooltip";

export function DarkmodeToggle() {
  const { theme, setTheme } = useTheme();

  const toggleDarkMode = () => {
    setTheme(theme === "dark" ? "light" : "dark");
  };

  const { t } = useTranslation();

  return (
    <Tooltip>
      <TooltipContent>{t("toggle_dark_mode")}</TooltipContent>
      <TooltipTrigger
        render={
          <Button
            variant="outline"
            size="icon"
            onClick={toggleDarkMode}
            aria-label={t("toggle_dark_mode")}
          />
        }
      >
        {theme === "dark" ? (
          <SunIcon className="h-5 w-5" />
        ) : (
          <MoonIcon className="h-5 w-5" />
        )}
      </TooltipTrigger>
    </Tooltip>
  );
}

```

`gui/src/components/shared/DeniedDialog.tsx`:

```tsx
import { useNavigate } from "react-router";

import {
  AlertDialog,
  AlertDialogContent,
  AlertDialogHeader,
  AlertDialogTitle,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogAction,
} from "@/components/ui/alert-dialog";

export function DeniedDialog({ open }: { open: boolean }) {
  const navigate = useNavigate();

  return (
    <AlertDialog open={open}>
      <AlertDialogContent>
        <AlertDialogHeader>
          <AlertDialogTitle>Unavailable</AlertDialogTitle>
          <AlertDialogDescription>
            Due to regulation limitations, Grapefruit cannot work on this
            application.
          </AlertDialogDescription>
        </AlertDialogHeader>
        <AlertDialogFooter>
          <AlertDialogAction variant="outline" onClick={() => navigate("/")}>
            Home
          </AlertDialogAction>
        </AlertDialogFooter>
      </AlertDialogContent>
    </AlertDialog>
  );
}

```

`gui/src/components/shared/HexView.tsx`:

```tsx
import { List, type RowComponentProps } from "react-window";

export type Stride = 8 | 16 | 32 | 64;

interface HexViewParams {
  data: Uint8Array;
  stride: Stride;
}

export default function HexView({ data, stride }: HexViewParams) {
  const count = Math.ceil(data.byteLength / stride);

  return (
    <List
      rowComponent={HexRow}
      rowCount={count}
      rowHeight={24}
      rowProps={{ data, stride }}
    />
  );
}

function printable(value: number) {
  return value >= 32 && value <= 126 ? String.fromCharCode(value) : ".";
}

function HexRow({
  index,
  data,
  stride,
  style,
}: RowComponentProps<{
  data: Uint8Array;
  stride: Stride;
}>) {
  const start = index * stride;
  const end = Math.min(start + stride);
  const chunk = Array.from(data.slice(start, end));
  const offset = start.toString(16).padStart(8, "0");
  const w = stride * 3 - 1;
  const xxd = chunk.map((val) => val.toString(16).padStart(2, "0"));
  const hexColumn = xxd.join(" ").padEnd(w, " ");
  const ascii = chunk.map(printable).join("");

  return (
    <div className="flex items-start leading-6 text-sm gap-4" style={style}>
      <code className="text-green-500">{offset}</code>
      <code className="whitespace-pre">{hexColumn}</code>
      <code className="whitespace-pre">{ascii}</code>
    </div>
  );
}

```

`gui/src/components/shared/HookResultsView.tsx`:

```tsx
import {
  useEffect,
  useRef,
  useState,
  useCallback,
  useMemo,
  type CSSProperties,
} from "react";
import { useTranslation } from "react-i18next";
import { List, type ListImperativeAPI } from "react-window";
import {
  ChevronRight,
  Layers,
  Database,
  Trash2,
  ChevronsDown,
  Clipboard,
  Fingerprint,
  Smartphone,
  FolderOpen,
  Copy,
  Check,
} from "lucide-react";

import { Button } from "@/components/ui/button";
import {
  Popover,
  PopoverContent,
  PopoverTrigger,
} from "@/components/ui/popover";
import { ScrollArea } from "@/components/ui/scroll-area";
import { Badge } from "@/components/ui/badge";
import { useLogStream } from "@/hooks/useLogStream";
import { toTime } from "@/lib/format";

import type { BaseMessage as BaseHookMessage } from "@agent/common/hooks/context";

interface HookEntry {
  id: number;
  timestamp: Date;
  message: BaseHookMessage;
}

const ROW_HEIGHT = 32;

function CategoryIcon({ category }: { category: string }) {
  switch (category) {
    case "sql":
      return <Database className="h-3.5 w-3.5" />;
    case "pasteboard":
      return <Clipboard className="h-3.5 w-3.5" />;
    case "biometric":
      return <Fingerprint className="h-3.5 w-3.5" />;
    case "deviceid":
      return <Smartphone className="h-3.5 w-3.5" />;
    case "fileops":
      return <FolderOpen className="h-3.5 w-3.5" />;
    default:
      return <Layers className="h-3.5 w-3.5" />;
  }
}

function formatSummary(message: BaseHookMessage): string {
  return message.line || "";
}

function SummaryPopover({ summary }: { summary: string }) {
  const [copied, setCopied] = useState(false);

  if (!summary) {
    return <span className="text-muted-foreground/30">--</span>;
  }

  const handleCopy = async () => {
    try {
      await navigator.clipboard.writeText(summary);
      setCopied(true);
      setTimeout(() => setCopied(false), 2000);
    } catch (e) {
      console.error("Failed to copy:", e);
    }
  };

  return (
    <Popover>
      <PopoverTrigger nativeButton={false} render={<span
          className="font-mono text-muted-foreground truncate flex-1 min-w-0 cursor-pointer hover:text-foreground"
          title={summary}
        />}>
          {summary}
      </PopoverTrigger>
      <PopoverContent className="w-[500px] p-0" align="start">
        <div className="flex items-center justify-end p-2 border-b">
          <Button
            variant="ghost"
            size="sm"
            className="h-6 px-2 text-xs gap-1"
            onClick={handleCopy}
          >
            {copied ? (
              <>
                <Check className="h-3 w-3" />
                Copied
              </>
            ) : (
              <>
                <Copy className="h-3 w-3" />
                Copy
              </>
            )}
          </Button>
        </div>
        <ScrollArea className="max-h-[300px]">
          <div className="p-3 font-mono text-xs whitespace-pre-wrap break-all">
            {summary}
          </div>
        </ScrollArea>
      </PopoverContent>
    </Popover>
  );
}

function StackTracePopover({
  bt,
  t,
}: {
  bt?: string[];
  t: (key: string) => string;
}) {
  if (!bt || bt.length === 0) {
    return <span className="text-muted-foreground/30 text-xs px-2">--</span>;
  }

  return (
    <Popover>
      <PopoverTrigger render={<Button variant="outline" size="sm" className="h-6 px-1.5" />}>
          <Layers className="h-3 w-3" />
      </PopoverTrigger>
      <PopoverContent className="w-[600px] p-0" align="end">
        <div className="p-3 border-b">
          <h4 className="font-medium text-sm">{t("hook_stack_trace")}</h4>
        </div>
        <ScrollArea className="h-[400px]">
          <div className="p-2 font-mono text-xs space-y-1">
            {bt.map((frame, index) => (
              <div
                key={index}
                className="p-1.5 rounded hover:bg-muted/50 break-all"
              >
                <span className="text-muted-foreground mr-2">#{index}</span>
                {frame}
              </div>
            ))}
          </div>
        </ScrollArea>
      </PopoverContent>
    </Popover>
  );
}

interface HookRowProps {
  entries: HookEntry[];
  t: (key: string) => string;
}

function HookRow(
  props: {
    ariaAttributes: {
      "aria-posinset": number;
      "aria-setsize": number;
      role: "listitem";
    };
    index: number;
    style: CSSProperties;
  } & HookRowProps,
) {
  const { index, style, entries, t } = props;
  const entry = entries[index];

  if (!entry) return null;

  const { message, timestamp } = entry;

  return (
    <div
      style={style}
      className="flex items-center px-3 py-1 border-b border-border/50 hover:bg-muted/30 text-xs gap-2"
    >
      <span className="text-muted-foreground font-mono w-24 shrink-0">
        {toTime(timestamp)}
      </span>
      <Badge
        variant="outline"
        className="flex items-center gap-1 h-5 px-1.5 shrink-0"
      >
        <CategoryIcon category={message.category} />
        <span className="text-[10px]">{message.category}</span>
      </Badge>
      <Badge
        variant={message.dir === "enter" ? "default" : "secondary"}
        className="h-5 px-1.5 text-[10px] shrink-0"
      >
        <ChevronRight
          className={`h-3 w-3 ${message.dir === "leave" ? "rotate-180" : ""}`}
        />
      </Badge>
      <span
        className="font-mono text-primary truncate w-48 shrink-0"
        title={message.symbol}
      >
        {message.symbol}
      </span>
      <SummaryPopover summary={formatSummary(message)} />
      <div className="shrink-0">
        <StackTracePopover bt={message.backtrace} t={t} />
      </div>
    </div>
  );
}

const mapHistory = (record: Record<string, unknown>, id: number): HookEntry | null => {
  if (record.category === "crypto") return null;
  return {
    id,
    timestamp: new Date(record.timestamp as string),
    message: {
      subject: "hook",
      category: record.category as string,
      symbol: record.symbol as string,
      dir: record.direction as "enter" | "leave",
      line: (record.line as string) ?? undefined,
      extra: record.extra as Record<string, unknown> | undefined,
    },
  };
};

const mapSocket = (id: number, ...args: unknown[]): HookEntry | null => {
  const message = args[0] as BaseHookMessage;
  if (message.category === "crypto") return null;
  return { id, timestamp: new Date(), message };
};

export function HookResultsView() {
  const { t } = useTranslation();
  const listRef = useRef<ListImperativeAPI>(null);
  const containerRef = useRef<HTMLDivElement>(null);
  const [listHeight, setListHeight] = useState(300);
  const [autoScroll, setAutoScroll] = useState(true);

  const {
    entries,
    clear,
  } = useLogStream<HookEntry>({
    event: "hook",
    path: "hooks",
    key: "hooks",
    fromRecord: (record, id) => mapHistory(record, id)!,
    fromEvent: mapSocket,
    max: 10000,
  });

  // Filter out null entries from mapHistory (crypto category)
  const filteredEntries = useMemo(
    () => entries.filter((e): e is HookEntry => e !== null),
    [entries],
  );

  // Resize observer for container
  useEffect(() => {
    if (!containerRef.current) return;

    const observer = new ResizeObserver((entries) => {
      for (const entry of entries) {
        setListHeight(entry.contentRect.height);
      }
    });

    observer.observe(containerRef.current);
    return () => observer.disconnect();
  }, []);

  // Auto-scroll when new entries arrive
  useEffect(() => {
    if (autoScroll && listRef.current && filteredEntries.length > 0) {
      requestAnimationFrame(() => {
        listRef.current?.scrollToRow({
          index: filteredEntries.length - 1,
          align: "end",
        });
      });
    }
  }, [filteredEntries.length, autoScroll]);

  const handleRowsRendered = useCallback(
    (visibleRows: { startIndex: number; stopIndex: number }) => {
      const isNearBottom = visibleRows.stopIndex >= filteredEntries.length - 3;
      setAutoScroll(isNearBottom);
    },
    [filteredEntries.length],
  );

  const scrollToLatest = useCallback(() => {
    if (listRef.current && filteredEntries.length > 0) {
      listRef.current.scrollToRow({ index: filteredEntries.length - 1, align: "end" });
      setAutoScroll(true);
    }
  }, [filteredEntries.length]);

  const rowProps: HookRowProps = useMemo(() => ({ entries: filteredEntries, t }), [filteredEntries, t]);

  return (
    <div className="h-full flex flex-col">
      {/* Header */}
      <div className="flex items-center justify-between px-3 py-2 border-b bg-muted/30">
        <div className="flex items-center gap-2 text-sm text-muted-foreground">
          <span>
            {filteredEntries.length.toLocaleString()} {t("hook_results").toLowerCase()}
          </span>
          {!autoScroll && (
            <Button
              variant="secondary"
              size="sm"
              onClick={scrollToLatest}
              className="h-6 px-2 text-[10px] gap-1"
            >
              <ChevronsDown className="h-3 w-3" />
              {t("scroll_to_latest")}
            </Button>
          )}
        </div>
        <Button
          variant="ghost"
          size="sm"
          onClick={clear}
          className="h-7 px-2"
        >
          <Trash2 className="h-3.5 w-3.5 mr-1" />
        </Button>
      </div>

      {/* Content */}
      <div ref={containerRef} className="flex-1 min-h-0">
        {filteredEntries.length === 0 ? (
          <div className="flex items-center justify-center h-full text-muted-foreground text-sm">
            {t("hook_no_results")}
          </div>
        ) : (
          <List
            listRef={listRef}
            style={{ height: listHeight, width: "100%" }}
            rowCount={filteredEntries.length}
            rowHeight={ROW_HEIGHT}
            rowProps={rowProps}
            rowComponent={HookRow}
            onRowsRendered={handleRowsRendered}
            overscanCount={20}
          />
        )}
      </div>
    </div>
  );
}

```

`gui/src/components/shared/HttpResponseBodyView.tsx`:

```tsx
import { useMemo } from "react";
import { useQuery } from "@tanstack/react-query";
import { Loader2 } from "lucide-react";
import Editor from "@monaco-editor/react";

import { useTheme } from "@/components/providers/ThemeProvider";
import HexView from "./HexView";
import { t } from "i18next";

function mimeToLanguage(mime: string | undefined): string | null {
  if (!mime) return null;
  const lower = mime.toLowerCase().split(";")[0].trim();
  if (lower.includes("json")) return "json";
  if (lower.includes("xml") || lower.includes("svg")) return "xml";
  if (lower.includes("html")) return "html";
  if (lower.includes("css")) return "css";
  if (lower.includes("javascript") || lower.includes("ecmascript"))
    return "javascript";
  if (lower.includes("typescript")) return "typescript";
  if (lower.includes("yaml") || lower.includes("yml")) return "yaml";
  if (lower.includes("text/plain")) return "plaintext";
  if (lower.includes("x-plist")) return "xml";
  return null;
}

function isImageMime(mime: string | undefined): boolean {
  if (!mime) return false;
  return mime.toLowerCase().startsWith("image/");
}

function tryDecodeUtf8(buf: ArrayBuffer): string | null {
  try {
    const decoder = new TextDecoder("utf-8", { fatal: true });
    return decoder.decode(buf);
  } catch {
    return null;
  }
}

export function HttpResponseBodyView({
  url,
  mime,
}: {
  url: string;
  mime: string | undefined;
}) {
  const { theme } = useTheme();

  const { data, isLoading, error } = useQuery<{
    text: string | null;
    bytes: Uint8Array;
  }>({
    queryKey: ["responseBody", url],
    queryFn: async () => {
      const res = await fetch(url);
      if (!res.ok) throw new Error(`Failed to fetch: ${res.status}`);
      const buf = await res.arrayBuffer();
      return { text: tryDecodeUtf8(buf), bytes: new Uint8Array(buf) };
    },
    staleTime: Infinity,
    gcTime: 5 * 60 * 1000,
    enabled: !isImageMime(mime),
  });

  const language = useMemo(() => mimeToLanguage(mime), [mime]);

  if (isImageMime(mime)) {
    return (
      <img
        src={url}
        alt="Response body"
        className="max-w-full max-h-96 object-contain rounded border"
      />
    );
  }

  if (isLoading)
    return (
      <span className="text-xs text-muted-foreground inline-flex items-center gap-1.5">
        <Loader2 className="h-3 w-3 animate-spin" />
        {t("loading")}
      </span>
    );

  if (error)
    return (
      <span className="text-xs text-red-500">
        Failed to load body: {(error as Error).message}
      </span>
    );

  if (!data) return null;

  // Binary data — not valid UTF-8
  if (data.text === null) {
    return (
      <div className="h-full border rounded overflow-hidden">
        <HexView data={data.bytes} stride={16} />
      </div>
    );
  }

  // Valid UTF-8 with a known language — Monaco editor
  if (language) {
    return (
      <div className="border rounded overflow-hidden h-full">
        <Editor
          height="100%"
          language={language}
          value={data.text}
          theme={theme === "dark" ? "vs-dark" : "light"}
          options={{
            readOnly: true,
            minimap: { enabled: false },
            scrollBeyondLastLine: false,
            wordWrap: "on",
            fontSize: 12,
            lineNumbers: "on",
            folding: true,
            contextmenu: false,
            domReadOnly: true,
          }}
        />
      </div>
    );
  }

  // Fallback: plain text
  return (
    <pre className="text-xs font-mono whitespace-pre-wrap break-all max-h-96 overflow-auto">
      {data.text}
    </pre>
  );
}

```

`gui/src/components/shared/JsonTreeView.tsx`:

```tsx
import { useState } from "react";
import { ChevronRight, ChevronDown } from "lucide-react";

function JsonLeaf({ value }: { value: unknown }) {
  if (value === null) {
    return <span className="text-muted-foreground">null</span>;
  }
  if (value === undefined) {
    return <span className="text-muted-foreground">undefined</span>;
  }
  switch (typeof value) {
    case "string":
      return (
        <span className="text-emerald-600 dark:text-emerald-400">
          &quot;{value}&quot;
        </span>
      );
    case "number":
      return (
        <span className="text-sky-600 dark:text-sky-400">{value}</span>
      );
    case "boolean":
      return (
        <span className="text-amber-600 dark:text-amber-400">
          {String(value)}
        </span>
      );
    default:
      return (
        <span className="text-muted-foreground">{String(value)}</span>
      );
  }
}

function JsonNode({
  value,
  label,
  depth,
  defaultExpanded,
}: {
  value: unknown;
  label?: string;
  depth: number;
  defaultExpanded: number;
}) {
  const [expanded, setExpanded] = useState(depth < defaultExpanded);
  const paddingLeft = depth * 16 + 4;

  if (Array.isArray(value)) {
    const count = value.length;
    return (
      <div>
        <div
          className="flex items-center hover:bg-accent/50 py-px font-mono"
          style={{ paddingLeft }}
        >
          <button
            type="button"
            onClick={() => setExpanded(!expanded)}
            className="p-0.5 mr-1 shrink-0"
          >
            {expanded ? (
              <ChevronDown className="w-3 h-3" />
            ) : (
              <ChevronRight className="w-3 h-3" />
            )}
          </button>
          {label !== undefined && (
            <span className="text-blue-500 dark:text-blue-400 mr-1">
              {label}
              <span className="text-muted-foreground">: </span>
            </span>
          )}
          <span className="text-muted-foreground">
            [
            {!expanded && (
              <span className="ml-1">
                ...{count} {count === 1 ? "item" : "items"}]
              </span>
            )}
          </span>
        </div>
        {expanded && (
          <>
            {value.map((item, i) => (
              <JsonNode
                key={i}
                value={item}
                label={`${i}`}
                depth={depth + 1}
                defaultExpanded={defaultExpanded}
              />
            ))}
            <div
              className="text-muted-foreground font-mono py-px"
              style={{ paddingLeft: paddingLeft + 20 }}
            >
              ]
            </div>
          </>
        )}
      </div>
    );
  }

  if (value !== null && typeof value === "object") {
    const entries = Object.entries(value as Record<string, unknown>);
    const count = entries.length;
    return (
      <div>
        <div
          className="flex items-center hover:bg-accent/50 py-px font-mono"
          style={{ paddingLeft }}
        >
          <button
            type="button"
            onClick={() => setExpanded(!expanded)}
            className="p-0.5 mr-1 shrink-0"
          >
            {expanded ? (
              <ChevronDown className="w-3 h-3" />
            ) : (
              <ChevronRight className="w-3 h-3" />
            )}
          </button>
          {label !== undefined && (
            <span className="text-blue-500 dark:text-blue-400 mr-1">
              {label}
              <span className="text-muted-foreground">: </span>
            </span>
          )}
          <span className="text-muted-foreground">
            {"{"}
            {!expanded && (
              <span className="ml-1">
                ...{count} {count === 1 ? "key" : "keys"}
                {"}"}
              </span>
            )}
          </span>
        </div>
        {expanded && (
          <>
            {entries.map(([key, val]) => (
              <JsonNode
                key={key}
                value={val}
                label={key}
                depth={depth + 1}
                defaultExpanded={defaultExpanded}
              />
            ))}
            <div
              className="text-muted-foreground font-mono py-px"
              style={{ paddingLeft: paddingLeft + 20 }}
            >
              {"}"}
            </div>
          </>
        )}
      </div>
    );
  }

  // Leaf node
  return (
    <div
      className="flex items-center hover:bg-accent/50 py-px font-mono"
      style={{ paddingLeft }}
    >
      <span className="w-5 shrink-0" />
      {label !== undefined && (
        <span className="text-blue-500 dark:text-blue-400 mr-1">
          {label}
          <span className="text-muted-foreground">: </span>
        </span>
      )}
      <JsonLeaf value={value} />
    </div>
  );
}

export default function JsonTreeView({
  value,
  defaultExpanded = 2,
}: {
  value: unknown;
  defaultExpanded?: number;
}) {
  return (
    <div className="text-[11px] leading-relaxed select-text">
      <JsonNode value={value} depth={0} defaultExpanded={defaultExpanded} />
    </div>
  );
}

```

`gui/src/components/shared/LanguageSelector.tsx`:

```tsx
import { useTranslation } from "react-i18next";
import { Check, Languages } from "lucide-react";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from "../ui/dropdown-menu";
import { Button } from "../ui/button";

export function LanguageSelector() {
  const { t, i18n } = useTranslation();

  const changeLanguage = (lng: string) => {
    i18n.changeLanguage(lng);
  };

  const languages = [
    { value: "en", label: t("language_en") },
    { value: "cn", label: t("language_cn") },
  ];

  return (
    <DropdownMenu>
      <DropdownMenuTrigger
        render={<Button variant="outline" size="icon" className="gap-2" />}
      >
        <Languages />
      </DropdownMenuTrigger>
      <DropdownMenuContent align="start">
        {languages.map((lang) => (
          <DropdownMenuItem
            key={lang.value}
            onClick={() => changeLanguage(lang.value)}
            className="gap-2"
          >
            {lang.value === i18n.language && <Check className="h-4 w-4" />}
            {lang.value !== i18n.language && <span className="w-4" />}
            {lang.label}
          </DropdownMenuItem>
        ))}
      </DropdownMenuContent>
    </DropdownMenu>
  );
}

```

`gui/src/components/shared/LogPanel.tsx`:

```tsx
import { forwardRef, useRef, useImperativeHandle } from "react";
import { ChevronDown, Save, Trash2 } from "lucide-react";

import { Button } from "@/components/ui/button";
import { LogViewer, type LogViewerHandle } from "./LogViewer";

interface LogPanelProps {
  downloadUrl: string;
  onClear: () => void;
}

export type { LogViewerHandle };

export const LogPanel = forwardRef<LogViewerHandle, LogPanelProps>(
  ({ downloadUrl, onClear }, ref) => {
    const logRef = useRef<LogViewerHandle>(null);

    useImperativeHandle(ref, () => ({
      append: (text: string) => logRef.current?.append(text),
      clear: () => logRef.current?.clear(),
      scrollToBottom: () => logRef.current?.scrollToBottom(),
    }));

    return (
      <div className="relative h-full">
        <LogViewer ref={logRef} />
        <div className="absolute bottom-4 right-4 z-10 flex gap-1">
          <Button
            variant="secondary"
            size="icon"
            className="h-8 w-8 rounded-full shadow-md"
            onClick={() => logRef.current?.scrollToBottom()}
          >
            <ChevronDown className="h-4 w-4" />
          </Button>
          <Button
            variant="secondary"
            size="icon"
            className="h-8 w-8 rounded-full shadow-md"
            nativeButton={false}
            render={<a href={downloadUrl} download />}
          >
            <Save className="h-4 w-4" />
          </Button>
          <Button
            variant="destructive"
            size="icon"
            className="h-8 w-8 rounded-full shadow-md"
            onClick={() => {
              logRef.current?.clear();
              onClear();
            }}
          >
            <Trash2 className="h-4 w-4" />
          </Button>
        </div>
      </div>
    );
  },
);

LogPanel.displayName = "LogPanel";

```

`gui/src/components/shared/LogTable.tsx`:

```tsx
import { useRef, type RefObject } from "react";
import {
  useReactTable,
  getCoreRowModel,
  flexRender,
  type ColumnDef,
} from "@tanstack/react-table";
import { useVirtualizer } from "@tanstack/react-virtual";

const ROW_HEIGHT = 32;

export function LogTable<T extends { id: number }>({
  data,
  columns,
  selectedId,
  onSelect,
  scrollRef,
}: {
  data: T[];
  columns: ColumnDef<T>[];
  selectedId: number | null;
  onSelect: (id: number | null) => void;
  scrollRef?: RefObject<HTMLDivElement | null>;
}) {
  const internalRef = useRef<HTMLDivElement>(null);
  const containerRef = scrollRef ?? internalRef;

  const table = useReactTable({
    data,
    columns,
    getCoreRowModel: getCoreRowModel(),
    getRowId: (row) => String(row.id),
  });

  const { rows } = table.getRowModel();

  const rowVirtualizer = useVirtualizer({
    count: rows.length,
    getScrollElement: () => containerRef.current,
    estimateSize: () => ROW_HEIGHT,
    overscan: 20,
  });

  const virtualRows = rowVirtualizer.getVirtualItems();
  const totalSize = rowVirtualizer.getTotalSize();

  return (
    <div ref={containerRef} className="flex-1 overflow-auto">
      <table className="w-full text-xs border-collapse">
        <thead className="sticky top-0 bg-background z-10">
          {table.getHeaderGroups().map((headerGroup) => (
            <tr key={headerGroup.id} className="border-b">
              {headerGroup.headers.map((header) => (
                <th
                  key={header.id}
                  className="text-left font-medium p-2 text-muted-foreground"
                  style={{ width: header.getSize() }}
                >
                  {flexRender(
                    header.column.columnDef.header,
                    header.getContext(),
                  )}
                </th>
              ))}
            </tr>
          ))}
        </thead>
        <tbody>
          {virtualRows.length > 0 && virtualRows[0].start > 0 && (
            <tr>
              <td
                colSpan={columns.length}
                style={{ height: virtualRows[0].start }}
              />
            </tr>
          )}
          {virtualRows.map((virtualRow) => {
            const row = rows[virtualRow.index];
            return (
              <tr
                key={row.id}
                className={`border-b cursor-pointer hover:bg-muted/50 ${
                  selectedId === row.original.id ? "bg-accent" : ""
                }`}
                style={{ height: virtualRow.size }}
                onClick={() =>
                  onSelect(
                    selectedId === row.original.id ? null : row.original.id,
                  )
                }
              >
                {row.getVisibleCells().map((cell) => (
                  <td
                    key={cell.id}
                    className="p-2 truncate"
                    style={{
                      width: cell.column.getSize(),
                      maxWidth: cell.column.getSize(),
                    }}
                  >
                    {flexRender(
                      cell.column.columnDef.cell,
                      cell.getContext(),
                    )}
                  </td>
                ))}
              </tr>
            );
          })}
          {virtualRows.length > 0 && (
            <tr>
              <td
                colSpan={columns.length}
                style={{
                  height:
                    totalSize -
                    (virtualRows[virtualRows.length - 1]?.end ?? 0),
                }}
              />
            </tr>
          )}
        </tbody>
      </table>
    </div>
  );
}

```

`gui/src/components/shared/LogViewer.tsx`:

```tsx
import { useEffect, useRef, useCallback, useImperativeHandle, forwardRef, memo } from "react";
import { cn } from "@/lib/utils";

const DEFAULT_MAX_LINES = 5000;
const TRIM_AMOUNT = 1000;

export interface LogViewerHandle {
  append: (text: string) => void;
  clear: () => void;
  scrollToBottom: () => void;
}

interface LogViewerProps {
  maxLines?: number;
  className?: string;
}

interface LogLine {
  id: number;
  text: string;
}

const LogLineComponent = memo(({ text }: { text: string }) => (
  <div className="whitespace-pre-wrap break-all font-mono text-xs leading-5 px-2">
    {text}
  </div>
));

LogLineComponent.displayName = "LogLineComponent";

export const LogViewer = forwardRef<LogViewerHandle, LogViewerProps>(
  ({ maxLines = DEFAULT_MAX_LINES, className }, ref) => {
    const containerRef = useRef<HTMLDivElement>(null);
    const linesRef = useRef<LogLine[]>([]);
    const nextIdRef = useRef(0);
    const isAutoScrollRef = useRef(true);
    const renderRequestRef = useRef<number | null>(null);
    const pendingLinesRef = useRef<LogLine[]>([]);

    const checkAutoScroll = useCallback(() => {
      const container = containerRef.current;
      if (!container) return;
      const threshold = 50;
      const isAtBottom =
        container.scrollHeight - container.scrollTop - container.clientHeight < threshold;
      isAutoScrollRef.current = isAtBottom;
    }, []);

    const scrollToBottom = useCallback(() => {
      const container = containerRef.current;
      if (container && isAutoScrollRef.current) {
        container.scrollTop = container.scrollHeight;
      }
    }, []);

    const renderLines = useCallback(() => {
      const container = containerRef.current;
      if (!container) return;

      const fragment = document.createDocumentFragment();
      for (const line of pendingLinesRef.current) {
        const div = document.createElement("div");
        div.className = "whitespace-pre-wrap break-all font-mono text-xs leading-5 px-2";
        div.textContent = line.text;
        div.dataset.lineId = String(line.id);
        fragment.appendChild(div);
      }
      container.appendChild(fragment);
      pendingLinesRef.current = [];

      // Trim DOM if over limit
      const currentLineCount = linesRef.current.length;
      if (currentLineCount > maxLines) {
        const removeCount = currentLineCount - maxLines + TRIM_AMOUNT;
        const children = container.children;
        for (let i = 0; i < removeCount && children.length > 0; i++) {
          children[0].remove();
        }
        linesRef.current = linesRef.current.slice(removeCount);
      }

      scrollToBottom();
      renderRequestRef.current = null;
    }, [maxLines, scrollToBottom]);

    const scheduleRender = useCallback(() => {
      if (renderRequestRef.current === null) {
        renderRequestRef.current = requestAnimationFrame(renderLines);
      }
    }, [renderLines]);

    const append = useCallback(
      (text: string) => {
        const lines = text.split("\n");
        const newLines: LogLine[] = [];

        for (const line of lines) {
          if (line === "" && lines.length > 1 && lines[lines.length - 1] === "") {
            continue;
          }
          newLines.push({
            id: nextIdRef.current++,
            text: line,
          });
        }

        linesRef.current.push(...newLines);
        pendingLinesRef.current.push(...newLines);
        scheduleRender();
      },
      [scheduleRender]
    );

    const clear = useCallback(() => {
      const container = containerRef.current;
      if (container) {
        container.innerHTML = "";
      }
      linesRef.current = [];
      pendingLinesRef.current = [];
      nextIdRef.current = 0;
    }, []);

    const forceScrollToBottom = useCallback(() => {
      const container = containerRef.current;
      if (container) {
        container.scrollTop = container.scrollHeight;
      }
    }, []);

    useImperativeHandle(ref, () => ({ append, clear, scrollToBottom: forceScrollToBottom }), [append, clear, forceScrollToBottom]);

    useEffect(() => {
      const container = containerRef.current;
      if (!container) return;

      container.addEventListener("scroll", checkAutoScroll);
      return () => {
        container.removeEventListener("scroll", checkAutoScroll);
        if (renderRequestRef.current !== null) {
          cancelAnimationFrame(renderRequestRef.current);
        }
      };
    }, [checkAutoScroll]);

    return (
      <div
        ref={containerRef}
        className={cn(
          "h-full w-full overflow-auto bg-background text-foreground",
          className
        )}
      />
    );
  }
);

LogViewer.displayName = "LogViewer";

```

`gui/src/components/shared/NativeHookDialog.tsx`:

```tsx
import { useState, useEffect, useCallback } from "react";
import { useTranslation } from "react-i18next";
import { Plus, X, Loader2, Sparkles } from "lucide-react";

import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
  DialogDescription,
  DialogFooter,
} from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";

const NATIVE_TYPES = [
  "void *",
  "int",
  "uint",
  "long",
  "float",
  "double",
  "bool",
  "char *",
  "id",
  "void",
] as const;

const ARG_TYPES = NATIVE_TYPES.filter((t) => t !== "void");

interface NativeHookDialogProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  functionName: string;
  modulePath: string | null;
  onConfirm: (sig: { args: string[]; returns: string }) => void;
}

export function NativeHookDialog({
  open,
  onOpenChange,
  functionName,
  modulePath,
  onConfirm,
}: NativeHookDialogProps) {
  const { t } = useTranslation();
  const [args, setArgs] = useState<string[]>([]);
  const [returns, setReturns] = useState("void");
  const [loading, setLoading] = useState(false);
  const [llmError, setLlmError] = useState<string | null>(null);

  const queryLLM = useCallback(async () => {
    setLoading(true);
    setLlmError(null);

    const prompt = `Give me the argument types of function ${functionName}, return in format like
{"args":["void *", "int"], "returns": "void *"}

Do not include qualifiers. My program can only handle few native types:
"void *", "int", "uint", "long", "float", "double", "bool", "char *", "id", "void"

please normalize type to those. if a type is an Objective-C class or instance, use "id".

only the json part, without any descriptions. if this function is not in your knowledge, return

{"error": "unknown function"}

do not make up or guess`;

    const res = await fetch("/api/llm", {
      method: "POST",
      body: prompt,
    }).catch(() => null);

    if (!res) {
      setLlmError(t("llm_query_failed", "Failed to query LLM"));
      setLoading(false);
      return;
    }

    if (!res.ok) {
      setLlmError(
        res.status === 500
          ? t("llm_not_configured", "LLM not configured")
          : t("llm_request_failed", "LLM request failed"),
      );
      setLoading(false);
      return;
    }

    const text = await res.text();

    const jsonMatch = text.match(/\{[\s\S]*\}/);
    if (!jsonMatch) {
      setLlmError(t("llm_invalid_response", "Invalid response from LLM"));
      setLoading(false);
      return;
    }

    let data: Record<string, unknown>;
    try {
      data = JSON.parse(jsonMatch[0]);
    } catch {
      setLlmError(t("llm_invalid_response", "Invalid response from LLM"));
      setLoading(false);
      return;
    }

    if (Array.isArray(data.args)) {
      setArgs(data.args as string[]);
    }
    if (data.returns) {
      setReturns(data.returns as string);
    }
    setLoading(false);
  }, [functionName, t]);

  // Auto-query LLM when dialog opens
  useEffect(() => {
    if (open) {
      setArgs([]);
      setReturns("void");
      setLlmError(null);
      queryLLM();
    }
  }, [open, queryLLM]);

  const addParam = () => {
    setArgs((prev) => [...prev, "void *"]);
  };

  const removeParam = (index: number) => {
    setArgs((prev) => prev.filter((_, i) => i !== index));
  };

  const updateParam = (index: number, value: string) => {
    setArgs((prev) => prev.map((v, i) => (i === index ? value : v)));
  };

  const handleConfirm = () => {
    onConfirm({ args, returns });
    onOpenChange(false);
  };

  const label = modulePath ? `${modulePath}!${functionName}` : functionName;

  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent className="sm:max-w-lg">
        <DialogHeader>
          <DialogTitle className="font-mono text-sm break-all">
            {label}
          </DialogTitle>
          <DialogDescription>
            {t(
              "hook_native_dialog_desc",
              "Configure parameter types for this native function hook.",
            )}
          </DialogDescription>
        </DialogHeader>

        <div className="space-y-4">
          {/* LLM status */}
          {loading && (
            <div className="flex items-center gap-2 text-sm text-muted-foreground">
              <Loader2 className="h-4 w-4 animate-spin" />
              Querying AI for function signature...
            </div>
          )}
          {llmError && (
            <div className="flex items-center justify-between text-sm">
              <span className="text-muted-foreground">{llmError}</span>
              <Button
                variant="ghost"
                size="sm"
                onClick={queryLLM}
                disabled={loading}
                className="gap-1"
              >
                <Sparkles className="h-3.5 w-3.5" />
                Retry
              </Button>
            </div>
          )}

          {/* Return type */}
          <div className="flex items-center gap-2">
            <span className="text-sm font-medium w-20 shrink-0">Returns</span>
            <Select
              value={returns}
              onValueChange={(v) => v !== null && setReturns(v)}
            >
              <SelectTrigger className="font-mono text-xs">
                <SelectValue />
              </SelectTrigger>
              <SelectContent>
                {NATIVE_TYPES.map((t) => (
                  <SelectItem key={t} value={t}>
                    {t}
                  </SelectItem>
                ))}
              </SelectContent>
            </Select>
          </div>

          {/* Arguments */}
          <div className="space-y-2">
            <div className="flex items-center justify-between">
              <span className="text-sm font-medium">Arguments</span>
              <Button
                variant="outline"
                size="sm"
                onClick={addParam}
                className="gap-1 h-7"
              >
                <Plus className="h-3.5 w-3.5" />
                Add param
              </Button>
            </div>

            {args.length === 0 && (
              <p className="text-xs text-muted-foreground">No parameters</p>
            )}

            {args.map((arg, i) => (
              <div key={i} className="flex items-center gap-2">
                <span className="text-xs text-muted-foreground w-8 shrink-0 text-right">
                  #{i}
                </span>
                <Select
                  value={arg}
                  onValueChange={(v) => v !== null && updateParam(i, v)}
                >
                  <SelectTrigger className="font-mono text-xs">
                    <SelectValue />
                  </SelectTrigger>
                  <SelectContent>
                    {ARG_TYPES.map((t) => (
                      <SelectItem key={t} value={t}>
                        {t}
                      </SelectItem>
                    ))}
                  </SelectContent>
                </Select>
                <Button
                  variant="ghost"
                  size="icon"
                  className="h-7 w-7 shrink-0"
                  onClick={() => removeParam(i)}
                >
                  <X className="h-3.5 w-3.5" />
                </Button>
              </div>
            ))}
          </div>
        </div>

        <DialogFooter>
          <Button variant="outline" onClick={() => onOpenChange(false)}>
            Dismiss
          </Button>
          <Button onClick={handleConfirm} disabled={loading}>
            Confirm
          </Button>
        </DialogFooter>
      </DialogContent>
    </Dialog>
  );
}

```

`gui/src/components/shared/PlistTreeView.tsx`:

```tsx
import { useEffect, useState } from "react";
import { ChevronRight, ChevronDown } from "lucide-react";

export type PlistValue =
  | string
  | number
  | boolean
  | null
  | PlistValue[]
  | { [key: string]: PlistValue };

export interface PlistTreeNode {
  key?: string;
  value: PlistValue;
  expanded: boolean;
  children?: PlistTreeNode[];
}

function isObject(value: PlistValue): value is { [key: string]: PlistValue } {
  return value !== null && typeof value === "object" && !Array.isArray(value);
}

function isArray(value: PlistValue): value is PlistValue[] {
  return Array.isArray(value);
}

function buildTree(
  value: PlistValue,
  key?: string,
  expanded = true,
): PlistTreeNode {
  if (isObject(value)) {
    const entries = Object.entries(value);
    const children = entries.map(([k, v]) => buildTree(v, k, expanded));
    return {
      key,
      value,
      expanded,
      children,
    };
  } else if (isArray(value)) {
    const children = value.map((v, i) => buildTree(v, `[${i}]`, expanded));
    return {
      key,
      value,
      expanded,
      children,
    };
  }
  return { key, value, expanded: true };
}

function PlistNode({
  node,
  depth = 0,
  forceExpanded,
  forceCollapsed,
}: {
  node: PlistTreeNode;
  depth?: number;
  forceExpanded?: boolean;
  forceCollapsed?: boolean;
}) {
  const [expanded, setExpanded] = useState(
    forceCollapsed ? false : (forceExpanded ?? node.expanded),
  );

  useEffect(() => {
    if (forceCollapsed) {
      setExpanded(false);
    } else if (forceExpanded !== undefined) {
      setExpanded(forceExpanded);
    }
  }, [forceExpanded, forceCollapsed]);

  const hasChildren = node.children && node.children.length > 0;

  const renderValue = (value: PlistValue): string => {
    if (value === null) return "null";
    if (typeof value === "string") {
      return `"${value}"`;
    }
    if (typeof value === "boolean") {
      return value ? "true" : "false";
    }
    return String(value);
  };

  return (
    <div>
      <div
        className="flex items-center hover:bg-accent py-0.5 font-mono"
        style={{ paddingLeft: `${depth * 20 + 8}px` }}
      >
        {hasChildren ? (
          <button
            type="button"
            onClick={() => setExpanded(!expanded)}
            className="p-0.5 mr-1"
          >
            {expanded ? (
              <ChevronDown className="w-3 h-3" />
            ) : (
              <ChevronRight className="w-3 h-3" />
            )}
          </button>
        ) : (
          <span className="w-5" />
        )}
        {node.key && (
          <span className="text-amber-600 dark:text-amber-400 mr-2 text-sm after:content-[':']">
            {node.key}
          </span>
        )}
        {hasChildren ? (
          <span className="text-muted-foreground text-sm">
            {isObject(node.value) ? "{" : "["}
            {!expanded && node.children && node.children.length > 0 && (
              <span className="text-muted-foreground ml-2">
                ...{node.children.length} items
              </span>
            )}
            {!expanded && "}"}
          </span>
        ) : (
          <span className="text-orange-600 dark:text-orange-400 font-mono text-sm">
            {renderValue(node.value)}
          </span>
        )}
      </div>
      {expanded && hasChildren && (
        <div>
          {node.children!.map((child, i) => (
            <PlistNode
              key={i}
              node={child}
              depth={depth + 1}
              forceExpanded={forceExpanded}
              forceCollapsed={forceCollapsed}
            />
          ))}
          <div
            className="text-muted-foreground text-sm"
            style={{ paddingLeft: `${depth * 20 + 8 + 20}px` }}
          >
            {isObject(node.value) ? "}" : "]"}
          </div>
        </div>
      )}
    </div>
  );
}

interface PlistTreeProps {
  data:
    | string
    | number
    | boolean
    | PlistValue[]
    | { [key: string]: PlistValue };
  expanded: boolean;
}

export default function PlistTreeView({ data, expanded }: PlistTreeProps) {
  const tree = buildTree(data);

  return tree.children ? (
    tree.children.map((child, i) => (
      <PlistNode
        key={i}
        node={child}
        forceCollapsed={!expanded}
        forceExpanded={expanded}
      />
    ))
  ) : (
    <PlistNode
      node={tree}
      forceCollapsed={!expanded}
      forceExpanded={expanded}
    />
  );
}

```

`gui/src/components/shared/SymbolsTableView.tsx`:

```tsx
import { useMemo, useState, useRef, useCallback } from "react";
import { useTranslation } from "react-i18next";
import { useNavigate } from "react-router";
import { toast } from "sonner";
import { Search, FileCode, Database, Anchor, Code } from "lucide-react";
import { Spinner } from "@/components/ui/spinner";
import {
  useReactTable,
  getCoreRowModel,
  getFilteredRowModel,
  flexRender,
  type ColumnDef,
  type ColumnResizeMode,
  type RowSelectionState,
} from "@tanstack/react-table";
import { useVirtualizer } from "@tanstack/react-virtual";
import { Input } from "@/components/ui/input";
import { Button } from "@/components/ui/button";
import { Checkbox } from "@/components/ui/checkbox";
import { useDock } from "@/context/DockContext";
import { useSession, Status, Mode, Platform } from "@/context/SessionContext";
import { useRepl } from "@/context/useRepl";
import { native, type NativeHookTarget } from "@/lib/hook-template";
import { NativeHookDialog } from "@/components/shared/NativeHookDialog";

import type { Symbol, Exported } from "@agent/common/symbol";

export type SymbolItem = Symbol | Exported;

interface SymbolsTableViewProps {
  symbols: SymbolItem[] | null;
  loading: boolean;
  modulePath?: string;
}

const DEFAULT_WIDTHS = {
  select: 32,
  actions: 60,
  type: 32,
  name: 300,
  address: 140,
  demangled: 400,
};

export function SymbolsTableView({
  symbols,
  loading,
  modulePath,
}: SymbolsTableViewProps) {
  const { t } = useTranslation();
  const { openFilePanel } = useDock();
  const { fruity, droid, status, platform, mode, device, bundle, pid, fridaMajor } = useSession();
  const api = platform === Platform.Droid ? droid : fruity;
  const { appendCode } = useRepl();
  const navigate = useNavigate();

  const hooksPath = `/workspace/${platform}/${device}/${mode}/${mode === Mode.App ? bundle : pid}/hooks`;
  const [globalFilter, setGlobalFilter] = useState("");
  const [rowSelection, setRowSelection] = useState<RowSelectionState>({});
  const [hookDialogOpen, setHookDialogOpen] = useState(false);
  const [hookDialogTarget, setHookDialogTarget] = useState<SymbolItem | null>(null);
  const [columnSizing, setColumnSizing] = useState<Record<string, number>>({
    select: DEFAULT_WIDTHS.select,
    actions: DEFAULT_WIDTHS.actions,
    type: DEFAULT_WIDTHS.type,
    name: DEFAULT_WIDTHS.name,
    address: DEFAULT_WIDTHS.address,
    demangled: DEFAULT_WIDTHS.demangled,
  });
  const tableContainerRef = useRef<HTMLDivElement>(null);

  const openDisassemblyTab = useCallback(
    (address: string, name?: string) => {
      openFilePanel({
        id: `disasm_${address}`,
        component: "disassembly",
        title: name ? `${name}` : address,
        params: { address, name },
      });
    },
    [openFilePanel],
  );

  const openClassTab = useCallback(
    (className: string) => {
      openFilePanel({
        id: `class_${className}`,
        component: "classDetail",
        title: className,
        params: { className },
      });
    },
    [openFilePanel],
  );

  const handleAddressClick = useCallback(
    (item: SymbolItem) => {
      // Check if it's an ObjC class reference
      if (item.name.startsWith("OBJC_CLASS_$_")) {
        const className = item.name.replace("OBJC_CLASS_$_", "");
        openClassTab(className);
        return;
      }
      // Open disassembly if clickable (already validated by isClickable)
      if (item.addr) {
        openDisassemblyTab(item.addr, item.name);
      }
    },
    [openClassTab, openDisassemblyTab],
  );

  const isClickable = useCallback((item: SymbolItem): boolean => {
    // ObjC class references are always clickable
    if (item.name.startsWith("OBJC_CLASS_$_")) return true;
    // No address means not clickable
    if (!item.addr) return false;
    // Check if item has type info (Exported/Imported types have this)
    const typed = item as Exported;
    if (typed.type !== undefined) {
      // Only functions are clickable for disassembly
      return typed.type === "f";
    }
    // For Symbol type (no type field), assume it's clickable
    return true;
  }, []);

  const isFunction = useCallback((item: SymbolItem): boolean => {
    const typed = item as Exported;
    return typed.type === "f";
  }, []);

  const data = useMemo(() => symbols ?? [], [symbols]);

  const handleHookFunction = useCallback(
    (item: SymbolItem) => {
      if (!api || status !== Status.Ready) return;
      setHookDialogTarget(item);
      setHookDialogOpen(true);
    },
    [api, status],
  );

  const handleHookConfirm = useCallback(
    async (sig: { args: string[]; returns: string }) => {
      if (!api || !hookDialogTarget) return;
      try {
        await api.native.hook(modulePath ?? null, hookDialogTarget.name, sig);
        navigate(hooksPath);
        toast.success(t("hook_added"), {
          description: modulePath
            ? `${modulePath}!${hookDialogTarget.name}`
            : hookDialogTarget.name,
        });
        window.dispatchEvent(new CustomEvent("hooks:refresh"));
      } catch (error) {
        console.error("Failed to hook function:", error);
        toast.error(t("hook_failed"));
      }
    },
    [api, hookDialogTarget, modulePath, navigate, hooksPath, t],
  );

  const handleGenerateCode = useCallback(
    (item: SymbolItem) => {
      const target: NativeHookTarget = {
        type: "native",
        module: modulePath ?? null,
        name: item.name,
      };
      const code = native(target, fridaMajor);
      appendCode(code);
    },
    [modulePath, appendCode, fridaMajor],
  );

  const handleBatchGenerateCode = useCallback(() => {
    const selectedIndices = Object.keys(rowSelection).filter(
      (key) => rowSelection[key],
    );
    const selectedItems = selectedIndices
      .map((idx) => data[parseInt(idx)])
      .filter((item) => item && isFunction(item));

    const codes = selectedItems.map((item) => {
      const target: NativeHookTarget = {
        type: "native",
        module: modulePath ?? null,
        name: item.name,
      };
      return native(target, fridaMajor);
    });

    if (codes.length > 0) {
      appendCode(codes.join("\n"));
    }
  }, [rowSelection, data, modulePath, appendCode, isFunction, fridaMajor]);

  const columns = useMemo<ColumnDef<SymbolItem>[]>(() => {
    const cols: ColumnDef<SymbolItem>[] = [];

    cols.push({
      id: "select",
      header: "",
      size: 90,
      minSize: 90,
      cell: ({ row }) => {
        const item = row.original;
        if (!isFunction(item)) return <span className="h-4 w-4" />;
        return (
          <div className="flex items-center gap-1">
            <Checkbox
              checked={row.getIsSelected()}
              onCheckedChange={(value) => row.toggleSelected(!!value)}
              aria-label="Select row"
              className="shrink-0"
            />
            <Button
              variant="ghost"
              size="icon"
              className="h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity"
              onClick={() => handleHookFunction(item)}
              disabled={status !== Status.Ready}
              title={t("hook_add")}
            >
              <Anchor className="h-3.5 w-3.5" />
            </Button>
            <Button
              variant="ghost"
              size="icon"
              className="h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity"
              onClick={() => handleGenerateCode(item)}
              title={t("hook_generate_code")}
            >
              <Code className="h-3.5 w-3.5" />
            </Button>
          </div>
        );
      },
      enableResizing: false,
    });

    cols.push(
      {
        id: "type",
        header: "",
        size: DEFAULT_WIDTHS.type,
        minSize: 32,
        maxSize: 50,
        cell: ({ row }) => {
          const item = row.original as Exported;
          if (item.type === "f") {
            return <FileCode className="w-3.5 h-3.5 text-amber-500" />;
          } else if (item.type === "v") {
            return <Database className="w-3.5 h-3.5 text-green-500" />;
          }
          return null;
        },
      },
      {
        accessorKey: "name",
        header: () => t("name"),
        size: DEFAULT_WIDTHS.name,
        minSize: 100,
      },
      {
        accessorKey: "addr",
        header: () => t("address"),
        size: DEFAULT_WIDTHS.address,
        minSize: 80,
        cell: ({ row }) => {
          const item = row.original;
          const addr = item.addr;
          if (!addr) return "-";
          if (isClickable(item)) {
            return (
              <button
                type="button"
                className="text-amber-600 dark:text-amber-400 hover:underline cursor-pointer"
                onClick={() => handleAddressClick(item)}
              >
                {addr}
              </button>
            );
          }
          return <span className="text-muted-foreground">{addr}</span>;
        },
      },
      {
        accessorKey: "demangled",
        header: () => t("demangled"),
        size: DEFAULT_WIDTHS.demangled,
        minSize: 100,
        cell: ({ getValue }) => getValue() || "-",
      },
    );

    return cols;
  }, [
    t,
    handleAddressClick,
    isClickable,
    isFunction,
    handleHookFunction,
    handleGenerateCode,
    status,
  ]);

  const table = useReactTable({
    data,
    columns,
    state: {
      globalFilter,
      columnSizing,
      rowSelection,
    },
    onGlobalFilterChange: setGlobalFilter,
    onColumnSizingChange: setColumnSizing,
    onRowSelectionChange: setRowSelection,
    getCoreRowModel: getCoreRowModel(),
    getFilteredRowModel: getFilteredRowModel(),
    columnResizeMode: "onChange" as ColumnResizeMode,
    enableColumnResizing: true,
    enableRowSelection: (row) => isFunction(row.original),
  });

  const { rows } = table.getRowModel();

  const rowVirtualizer = useVirtualizer({
    count: rows.length,
    getScrollElement: () => tableContainerRef.current,
    estimateSize: () => 32,
    overscan: 20,
  });

  const virtualRows = rowVirtualizer.getVirtualItems();
  const totalSize = rowVirtualizer.getTotalSize();

  const selectedCount = Object.keys(rowSelection).filter(
    (key) => rowSelection[key],
  ).length;

  if (loading) {
    return (
      <div className="flex items-center justify-center h-full gap-2 text-muted-foreground">
        <Spinner />
        {t("loading")}...
      </div>
    );
  }

  if (!symbols || symbols.length === 0) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        {t("no_results")}
      </div>
    );
  }

  return (
    <div className="flex flex-col h-full">
      <NativeHookDialog
        open={hookDialogOpen}
        onOpenChange={setHookDialogOpen}
        functionName={hookDialogTarget?.name ?? ""}
        modulePath={modulePath ?? null}
        onConfirm={handleHookConfirm}
      />
      <div className="flex items-center gap-2 mb-2">
        <div className="relative flex-1">
          <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
          <Input
            placeholder={t("search")}
            value={globalFilter}
            onChange={(e) => setGlobalFilter(e.target.value)}
            className="pl-9"
          />
        </div>
      </div>

      <div className="flex items-center gap-2 mb-2">
        <Checkbox
          checked={table.getIsAllPageRowsSelected()}
          indeterminate={table.getIsSomePageRowsSelected()}
          onCheckedChange={(value) =>
            table.toggleAllPageRowsSelected(!!value)
          }
          aria-label="Select all"
          className="shrink-0"
        />
        <Button
          variant="outline"
          size="sm"
          onClick={handleBatchGenerateCode}
          disabled={selectedCount === 0}
          className="gap-1.5"
        >
          <Code className="h-4 w-4" />
          {t("hook_batch_generate")}
        </Button>
        {selectedCount > 0 && (
          <span className="text-sm text-muted-foreground">
            {t("hook_selected_count", { count: selectedCount })}
          </span>
        )}
      </div>

      <div className="text-xs text-muted-foreground mb-1">
        {rows.length.toLocaleString()} / {data.length.toLocaleString()}{" "}
        {t("items")}
      </div>
      <div ref={tableContainerRef} className="overflow-auto flex-1">
        <table
          className="w-full text-sm border-collapse"
          style={{ width: table.getCenterTotalSize() }}
        >
          <thead className="sticky top-0 bg-background z-10">
            {table.getHeaderGroups().map((headerGroup) => (
              <tr key={headerGroup.id} className="border-b">
                {headerGroup.headers.map((header) => (
                  <th
                    key={header.id}
                    className="relative text-left font-medium p-2 select-none"
                    style={{ width: header.getSize() }}
                  >
                    {header.isPlaceholder
                      ? null
                      : flexRender(
                          header.column.columnDef.header,
                          header.getContext(),
                        )}
                    {header.column.getCanResize() && (
                      <div
                        onMouseDown={header.getResizeHandler()}
                        onTouchStart={header.getResizeHandler()}
                        className={`absolute right-0 top-0 h-full w-1 cursor-col-resize select-none touch-none hover:bg-amber-500/50 ${
                          header.column.getIsResizing() ? "bg-amber-500" : ""
                        }`}
                      />
                    )}
                  </th>
                ))}
              </tr>
            ))}
          </thead>
          <tbody>
            {/* Spacer for virtual scroll */}
            {virtualRows.length > 0 && virtualRows[0].start > 0 && (
              <tr>
                <td
                  colSpan={columns.length}
                  style={{ height: virtualRows[0].start }}
                />
              </tr>
            )}
            {virtualRows.map((virtualRow) => {
              const row = rows[virtualRow.index];
              return (
                <tr
                  key={virtualRow.index}
                  className="border-b hover:bg-muted/50 group"
                  style={{ height: virtualRow.size }}
                >
                  {row.getVisibleCells().map((cell) => (
                    <td
                      key={cell.id}
                      className="p-2 font-mono text-xs truncate"
                      style={{
                        width: cell.column.getSize(),
                        maxWidth: cell.column.getSize(),
                      }}
                    >
                      {flexRender(
                        cell.column.columnDef.cell,
                        cell.getContext(),
                      )}
                    </td>
                  ))}
                </tr>
              );
            })}
            {/* Spacer for virtual scroll end */}
            {virtualRows.length > 0 && (
              <tr>
                <td
                  colSpan={columns.length}
                  style={{
                    height:
                      totalSize -
                      (virtualRows[virtualRows.length - 1]?.end ?? 0),
                  }}
                />
              </tr>
            )}
          </tbody>
        </table>
      </div>
    </div>
  );
}

```

`gui/src/components/shared/Terminal.tsx`:

```tsx
import { useEffect, useRef } from "react";
import { Terminal as XTerm } from "@xterm/xterm";
import "@xterm/xterm/css/xterm.css";
import { useTheme } from "@/components/providers/ThemeProvider";

interface TerminalProps {
  onTerminalReady?: (terminal: XTerm) => void;
}

export function Terminal({ onTerminalReady }: TerminalProps) {
  const { theme } = useTheme();
  const terminalRef = useRef<HTMLDivElement>(null);
  const xtermRef = useRef<XTerm | null>(null);

  useEffect(() => {
    if (!terminalRef.current) return;

    const term = new XTerm({
      convertEol: true,
      theme: {
        background: theme === "dark" ? "#000000" : "#ffffff",
        foreground: theme === "dark" ? "#d0d0d0" : "#333333",
      },
      fontSize: 12,
      fontFamily: "monospace",
      rows: 24,
      cols: 80,
    });

    term.open(terminalRef.current);
    xtermRef.current = term;

    if (onTerminalReady) {
      onTerminalReady(term);
    }

    const resizeTerminal = () => {
      const dims = terminalRef.current?.getBoundingClientRect();
      if (dims) {
        const cols = Math.floor(dims.width / 8);
        const rows = Math.floor(dims.height / 16);
        if (cols > 0 && rows > 0) {
          term.resize(cols, rows);
        }
      }
    };

    const observer = new ResizeObserver(resizeTerminal);
    observer.observe(terminalRef.current);

    resizeTerminal();

    return () => {
      observer.disconnect();
      term.dispose();
    };
  }, [onTerminalReady, theme]);

  useEffect(() => {
    if (xtermRef.current) {
      xtermRef.current.options.theme = {
        background: theme === "dark" ? "#000000" : "#ffffff",
        foreground: theme === "dark" ? "#d0d0d0" : "#333333",
      };
    }
  }, [theme]);

  return <div ref={terminalRef} className="h-full w-full" />;
}

```

`gui/src/components/shared/UnifiedPlistViewer.tsx`:

```tsx
import { useState } from "react";
import { useTranslation } from "react-i18next";
import { Button } from "@/components/ui/button";
import { Download, Copy, Check, ChevronDown, ChevronUp } from "lucide-react";
import Editor, { loader } from "@monaco-editor/react";
import { useTheme } from "@/components/providers/ThemeProvider";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import PlistTreeView, { type PlistValue } from "./PlistTreeView";

export type { PlistValue };

loader.init().then((monaco) => {
  monaco.languages.register({ id: "xml" });
});

export interface PlistViewParams {
  xml: string;
  value: PlistValue;
  filename?: string;
}

export function PlistView({
  xml,
  value,
  filename = "Info.plist",
}: PlistViewParams) {
  const { t } = useTranslation();
  const { theme } = useTheme();
  const [copied, setCopied] = useState<boolean>(false);
  const [expandAll, setExpandAll] = useState(false);
  const [viewMode, setViewMode] = useState<"tree" | "text">("text");

  const handleDownload = () => {
    const blob = new Blob([xml], { type: "application/xml" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  };

  const handleCopy = async () => {
    await navigator.clipboard.writeText(xml);
    setCopied(true);
    setTimeout(() => setCopied(false), 2000);
  };

  const handleExpandAll = () => setExpandAll(true);
  const handleCollapseAll = () => setExpandAll(false);

  return (
    <div className="h-full flex flex-col">
      <div className="flex items-center justify-between p-2 border-b">
        <Tabs
          value={viewMode}
          onValueChange={(v) => setViewMode(v as "tree" | "text")}
        >
          <TabsList variant="line" className="w-auto h-8">
            <TabsTrigger value="tree" className="px-3">
              {t("tree")}
            </TabsTrigger>
            <TabsTrigger value="text" className="px-3">
              {t("text")}
            </TabsTrigger>
          </TabsList>
        </Tabs>
        <div className="flex items-center gap-2">
          {viewMode === "tree" && (
            <>
              <Button variant="outline" size="sm" onClick={handleExpandAll}>
                <ChevronDown className="h-4 w-4 mr-2" />
                {t("expand_all")}
              </Button>
              <Button variant="outline" size="sm" onClick={handleCollapseAll}>
                <ChevronUp className="h-4 w-4 mr-2" />
                {t("collapse_all")}
              </Button>
            </>
          )}
          <Button
            variant="outline"
            size="sm"
            onClick={handleCopy}
            disabled={!xml}
          >
            {copied ? (
              <Check className="h-4 w-4 mr-2 text-green-500" />
            ) : (
              <Copy className="h-4 w-4 mr-2" />
            )}
            {t("copy")}
          </Button>
          <Button
            variant="outline"
            size="sm"
            onClick={handleDownload}
            disabled={!xml}
          >
            <Download className="h-4 w-4 mr-2" />
            {t("download")}
          </Button>
        </div>
      </div>
      <div className="flex-1 overflow-hidden">
        <Tabs
          value={viewMode}
          onValueChange={(v) => setViewMode(v as "tree" | "text")}
          className="h-full flex flex-col"
        >
          <TabsContent value="tree" className="flex-1 overflow-auto p-4 m-0">
            {value ? (
              <PlistTreeView data={value} expanded={expandAll} />
            ) : (
              <div className="flex items-center justify-center h-full text-muted-foreground">
                {t("no_content")}
              </div>
            )}
          </TabsContent>
          <TabsContent value="text" className="flex-1 m-0">
            {xml ? (
              <Editor
                height="100%"
                language="xml"
                value={xml}
                theme={theme === "dark" ? "vs-dark" : "light"}
                options={{
                  readOnly: true,
                  minimap: { enabled: false },
                  scrollBeyondLastLine: false,
                  wordWrap: "on",
                  fontSize: 13,
                  lineNumbers: "on",
                  folding: true,
                  automaticLayout: true,
                }}
              />
            ) : (
              <div className="flex items-center justify-center h-full text-muted-foreground">
                {t("no_content")}
              </div>
            )}
          </TabsContent>
        </Tabs>
      </div>
    </div>
  );
}

```

`gui/src/components/shared/XPCTreeView.tsx`:

```tsx
import { useState } from "react";
import { ChevronRight, ChevronDown } from "lucide-react";

import type { XPCNode } from "@/lib/rpc";

function XPCLeaf({ node }: { node: XPCNode }) {
  switch (node.type) {
    case "string":
      return (
        <span className="text-emerald-600 dark:text-emerald-400">
          {node.description}
        </span>
      );
    case "bool":
      return (
        <span className="text-amber-600 dark:text-amber-400">
          {String(node.description)}
        </span>
      );
    case "int64":
    case "uint64":
    case "double":
      return (
        <span className="text-sky-600 dark:text-sky-400">
          {node.description}
        </span>
      );
    case "uuid":
      return (
        <span className="text-cyan-600 dark:text-cyan-400">
          {node.description}
        </span>
      );
    case "data":
      return <span className="text-muted-foreground">{node.description}</span>;
    case "fd":
      return (
        <span className="text-orange-600 dark:text-orange-400">
          {node.description}
        </span>
      );
    case "date":
      return (
        <span className="text-rose-600 dark:text-rose-400">{node.value}</span>
      );
    case "null":
      return <span className="text-muted-foreground">null</span>;
    case "error":
      return (
        <span className="text-red-600 dark:text-red-400">
          {node.description}
        </span>
      );
    case "shmem":
      return <span className="text-muted-foreground">{node.description}</span>;
    case "endpoint":
      return <span className="text-muted-foreground">{node.description}</span>;
    case "connection":
      return <span className="text-muted-foreground">{node.description}</span>;
    default:
      return <span className="text-muted-foreground">{node.description}</span>;
  }
}

function XPCTreeNode({
  node,
  label,
  depth,
}: {
  node: XPCNode;
  label?: string;
  depth: number;
}) {
  const [expanded, setExpanded] = useState(depth < 3);
  const paddingLeft = depth * 16 + 4;

  // short description for xpc collection types
  const shorten = (str: string) => {
    const end = str.indexOf(", contents");
    return end !== -1 ? str.substring(0, end) + " }" : str;
  };

  if (node.type === "dictionary") {
    return (
      <div>
        <div
          className="flex items-center hover:bg-accent/50 py-px font-mono"
          style={{ paddingLeft }}
        >
          <button
            type="button"
            onClick={() => setExpanded(!expanded)}
            className="p-0.5 mr-1 shrink-0"
          >
            {expanded ? (
              <ChevronDown className="w-3 h-3" />
            ) : (
              <ChevronRight className="w-3 h-3" />
            )}
          </button>
          {label !== undefined && (
            <span className="text-blue-500 dark:text-blue-400 mr-1">
              {label}
              <span className="text-muted-foreground">: </span>
            </span>
          )}
          <span className="text-muted-foreground">
            {shorten(node.description)}
          </span>
        </div>
        {expanded && (
          <>
            {node.keys.map((key, i) => (
              <XPCTreeNode
                key={i}
                node={node.values[i]}
                label={key}
                depth={depth + 1}
              />
            ))}
            <div
              className="text-muted-foreground font-mono py-px"
              style={{ paddingLeft: paddingLeft + 20 }}
            ></div>
          </>
        )}
      </div>
    );
  }

  if (node.type === "array") {
    return (
      <div>
        <div
          className="flex items-center hover:bg-accent/50 py-px font-mono"
          style={{ paddingLeft }}
        >
          <button
            type="button"
            onClick={() => setExpanded(!expanded)}
            className="p-0.5 mr-1 shrink-0"
          >
            {expanded ? (
              <ChevronDown className="w-3 h-3" />
            ) : (
              <ChevronRight className="w-3 h-3" />
            )}
          </button>
          {label !== undefined && (
            <span className="text-blue-500 dark:text-blue-400 mr-1">
              {label}
              <span className="text-muted-foreground">: </span>
            </span>
          )}
          <span className="text-muted-foreground">
            {shorten(node.description)}
          </span>
        </div>
        {expanded && (
          <>
            {node.values.map((val, i) => (
              <XPCTreeNode
                key={i}
                node={val}
                label={`${i}`}
                depth={depth + 1}
              />
            ))}
            <div
              className="text-muted-foreground font-mono py-px"
              style={{ paddingLeft: paddingLeft + 20 }}
            ></div>
          </>
        )}
      </div>
    );
  }

  // Leaf node
  return (
    <div
      className="flex items-center hover:bg-accent/50 py-px font-mono"
      style={{ paddingLeft }}
    >
      <span className="w-5 shrink-0" />
      {label !== undefined && (
        <span className="text-blue-500 dark:text-blue-400 mr-1">
          {label}
          <span className="text-muted-foreground">: </span>
        </span>
      )}
      <XPCLeaf node={node} />
    </div>
  );
}

export default function XPCTreeView({ node }: { node: XPCNode }) {
  return (
    <div className="text-[11px] leading-relaxed select-text">
      <XPCTreeNode node={node} depth={0} />
    </div>
  );
}

```

`gui/src/components/tabs/CodeScratchPadTab.tsx`:

```tsx
import { useState, useCallback, useRef, useEffect } from "react";
import { useTranslation } from "react-i18next";
import {
  Download,
  Copy,
  Check,
  Play,
  Save,
  AlertCircle,
  Trash2,
} from "lucide-react";
import { useQuery } from "@tanstack/react-query";
import Editor, { type OnMount, type BeforeMount } from "@monaco-editor/react";

import { Button } from "@/components/ui/button";
import { Spinner } from "@/components/ui/spinner";
import {
  ResizablePanelGroup,
  ResizablePanel,
  ResizableHandle,
} from "@/components/ui/resizable";
import { useTheme } from "@/components/providers/ThemeProvider";
import { useRepl } from "@/context/useRepl";
import { useSession } from "@/context/SessionContext";

async function loadFridaTypes(): Promise<Record<string, string>> {
  const res = await fetch("/api/d.ts/pack");
  if (!res.ok) throw new Error("Failed to load TypeScript definitions");
  return res.json();
}

interface EvalEntry {
  id: number;
  source: string;
  status: "loading" | "success" | "error";
  result?: string;
}

// eslint-disable-next-line @typescript-eslint/no-explicit-any
function formatError(err: any): string {
  if (typeof err === "string") return err;
  if (err?.message) {
    const loc = [err.fileName, err.lineNumber].filter(Boolean).join(":");
    return loc ? `${err.message} (${loc})` : err.message;
  }
  if (typeof err === "object" && err !== null) {
    const { name, description, ...rest } = err;
    const label = description || name || "Error";
    const details = Object.entries(rest)
      .map(([k, v]) => `${k}: ${v}`)
      .join(", ");
    return details ? `${label} (${details})` : label;
  }
  return String(err);
}

// eslint-disable-next-line @typescript-eslint/no-explicit-any
function formatResult(value: any): string {
  if (value === null) return "null";
  if (typeof value !== "object") return String(value);
  try {
    return JSON.stringify(value, null, 2);
  } catch {
    return String(value);
  }
}

let nextId = 0;

export function CodeScratchPadTab() {
  const { t } = useTranslation();
  const { theme } = useTheme();
  const { content, setContent, save, dirty } = useRepl();
  const { socket } = useSession();
  const [copied, setCopied] = useState(false);
  const [entries, setEntries] = useState<EvalEntry[]>([]);
  const listEndRef = useRef<HTMLDivElement>(null);
  const { data: dts, isPending } = useQuery({
    queryKey: ["typescript"],
    queryFn: loadFridaTypes,
    retry: false,
  });

  useEffect(() => {
    listEndRef.current?.scrollIntoView({ behavior: "smooth" });
  }, [entries]);

  const handleRun = useCallback(() => {
    if (!socket || !content.trim()) return;
    save();
    const id = nextId++;
    setEntries((prev) => [...prev, { id, source: content, status: "loading" }]);
    socket.emit("eval", content, "userscript", (err, result) => {
      console.debug("user script eval result", err, result);
      setEntries((prev) =>
        prev.map((e) =>
          e.id === id
            ? err
              ? {
                  ...e,
                  status: "error" as const,
                  result: formatError(err),
                }
              : {
                  ...e,
                  status: "success" as const,
                  result:
                    result !== undefined ? formatResult(result) : undefined,
                }
            : e,
        ),
      );
    });
  }, [socket, content, save]);

  const handleClearEntries = useCallback(() => setEntries([]), []);

  const handleChange = useCallback(
    (value: string | undefined) => {
      if (value !== undefined) setContent(value);
    },
    [setContent],
  );

  const saveRef = useRef(save);
  saveRef.current = save;

  const handleBeforeMount = useCallback<BeforeMount>(
    (monaco) => {
      const jsDefaults = monaco.languages.typescript.javascriptDefaults;
      jsDefaults.setCompilerOptions({
        ...jsDefaults.getCompilerOptions(),
        target: monaco.languages.typescript.ScriptTarget.ESNext,
        lib: ["esnext"],
        allowJs: true,
        checkJs: false,
      });

      if (dts) {
        for (const [name, source] of Object.entries(dts)) {
          jsDefaults.addExtraLib(source, name);
        }
      }
    },
    [dts],
  );

  const monacoRef = useRef<Parameters<OnMount>[1] | null>(null);

  const handleEditorMount = useCallback<OnMount>((editor, monaco) => {
    monacoRef.current = monaco;

    editor.addAction({
      id: "save",
      label: "Save",
      keybindings: [monaco.KeyMod.CtrlCmd | monaco.KeyCode.KeyS],
      run: () => saveRef.current(),
    });
  }, []);

  const handleDownload = useCallback(() => {
    const blob = new Blob([content], { type: "text/javascript" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "script.js";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  }, [content]);

  const handleCopy = useCallback(async () => {
    try {
      await navigator.clipboard.writeText(content);
      setCopied(true);
      setTimeout(() => setCopied(false), 2000);
    } catch (err) {
      console.error("Failed to copy:", err);
    }
  }, [content]);

  const running = entries.some((e) => e.status === "loading");

  return (
    <div className="h-full flex flex-col">
      <div className="flex items-center justify-between px-3 py-1.5 border-b bg-muted/30">
        <div className="flex items-center gap-1">
          <Button
            variant="default"
            size="sm"
            className="h-7 px-2 gap-1.5"
            onClick={handleRun}
            disabled={running || !socket || !content.trim()}
          >
            {running ? (
              <Spinner className="h-3.5 w-3.5" />
            ) : (
              <Play className="h-3.5 w-3.5" />
            )}
            {t("run")}
          </Button>
          <Button
            variant="ghost"
            size="sm"
            className="h-7 px-2 gap-1.5"
            onClick={save}
            disabled={!dirty}
          >
            <Save className="h-3.5 w-3.5" />
            {t("save")}
          </Button>
        </div>
        <div className="flex items-center gap-1">
          <Button
            variant="ghost"
            size="sm"
            className="h-7 px-2 gap-1.5"
            onClick={handleDownload}
          >
            <Download className="h-3.5 w-3.5" />
            {t("repl_download")}
          </Button>
          <Button
            variant="ghost"
            size="sm"
            className="h-7 px-2 gap-1.5"
            onClick={handleCopy}
          >
            {copied ? (
              <>
                <Check className="h-3.5 w-3.5 text-green-500" />
                {t("copied")}
              </>
            ) : (
              <>
                <Copy className="h-3.5 w-3.5" />
                {t("repl_copy")}
              </>
            )}
          </Button>
        </div>
      </div>
      <div className="flex-1 min-h-0">
        <ResizablePanelGroup
          orientation="horizontal"
          autoSaveId="code-scratch-pad-split"
        >
          <ResizablePanel defaultSize="65%" minSize="30%">
            {isPending ? (
              <div className="flex items-center justify-center h-full gap-2 text-muted-foreground">
                <Spinner className="w-5 h-5" />
                <span>{t("loading")}...</span>
              </div>
            ) : (
              <Editor
                height="100%"
                language="javascript"
                value={content}
                onChange={handleChange}
                beforeMount={handleBeforeMount}
                onMount={handleEditorMount}
                theme={theme === "dark" ? "vs-dark" : "light"}
                options={{
                  minimap: { enabled: false },
                  scrollBeyondLastLine: false,
                  wordWrap: "on",
                  fontSize: 13,
                  lineNumbers: "on",
                  folding: true,
                  automaticLayout: true,
                  tabSize: 2,
                  insertSpaces: true,
                  formatOnPaste: true,
                }}
              />
            )}
          </ResizablePanel>
          <ResizableHandle />
          <ResizablePanel defaultSize="35%" minSize="15%">
            <div className="h-full flex flex-col">
              <div className="flex items-center justify-between px-3 py-1.5 border-b bg-muted/30">
                <span className="text-xs font-medium text-muted-foreground">
                  {t("output")}
                </span>
                {entries.length > 0 && (
                  <Button
                    variant="ghost"
                    size="sm"
                    className="h-5 w-5 p-0"
                    onClick={handleClearEntries}
                  >
                    <Trash2 className="h-3 w-3" />
                  </Button>
                )}
              </div>
              <div className="flex-1 overflow-y-auto">
                {entries.length === 0 ? null : (
                  <div className="divide-y">
                    {entries.map((entry) => (
                      <div
                        key={entry.id}
                        className="px-3 py-2 text-xs space-y-1"
                      >
                        <pre
                          className="font-mono text-muted-foreground truncate"
                          title={entry.source}
                        >
                          {entry.source}
                        </pre>
                        {entry.status === "loading" ? (
                          <div className="flex items-center gap-1.5 text-muted-foreground">
                            <Spinner className="h-3 w-3" />
                            <span>Evaluating...</span>
                          </div>
                        ) : entry.status === "error" ? (
                          <div className="flex items-start gap-1.5 text-destructive">
                            <AlertCircle className="h-3 w-3 mt-0.5 shrink-0" />
                            <span className="break-all">{entry.result}</span>
                          </div>
                        ) : entry.result !== undefined ? (
                          <pre className="font-mono text-green-600 dark:text-green-400 whitespace-pre-wrap break-all">
                            {entry.result}
                          </pre>
                        ) : (
                          <span className="text-muted-foreground italic">
                            undefined
                          </span>
                        )}
                      </div>
                    ))}
                    <div ref={listEndRef} />
                  </div>
                )}
              </div>
            </div>
          </ResizablePanel>
        </ResizablePanelGroup>
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/DirectoryTree.tsx`:

```tsx
import { useEffect, useRef, useState } from "react";
import { ChevronRight, ChevronDown, Folder, FolderOpen } from "lucide-react";
import { Spinner } from "@/components/ui/spinner";
import type {
  TreeNode,
  RootType,
  LoadDirectoryFn,
  DirectorySelectFn,
} from "../../lib/file-explorer.ts";
import type { MetaData } from "@agent/fruity/modules/fs";

interface DirectoryTreeProps {
  root: RootType;
  rootPath: string;
  apiReady: boolean;
  loadDirectory: LoadDirectoryFn;
  onDirectorySelect: DirectorySelectFn;
  currentPath?: string | null;
}

function createRootNode(root: RootType): TreeNode {
  return {
    meta: {
      name: root,
      dir: true,
      protection: null,
      size: null,
      alias: false,
      created: new Date(),
      symlink: false,
    },
    children: null,
    isLoading: true,
    isExpanded: true,
  };
}

function buildDirectoryNodes(list: MetaData[]): TreeNode[] {
  return list
    .filter((item) => item.dir)
    .map((meta) => ({
      meta,
      children: null,
      isLoading: false,
      isExpanded: false,
    }));
}

function updateNodeAtPath(
  nodes: TreeNode[],
  path: string[],
  pathIndex: number,
  updater: (node: TreeNode) => TreeNode,
): TreeNode[] {
  return nodes.map((node) => {
    if (node.meta.name !== path[pathIndex]) {
      return node;
    }
    if (pathIndex === path.length - 1) {
      return updater(node);
    }
    if (node.children) {
      return {
        ...node,
        children: updateNodeAtPath(node.children, path, pathIndex + 1, updater),
      };
    }
    return node;
  });
}

function getNodeAtPath(
  nodes: TreeNode[],
  path: string[],
  pathIndex: number,
): TreeNode | null {
  const node = nodes.find((n) => n.meta.name === path[pathIndex]);
  if (!node) return null;
  if (pathIndex === path.length - 1) return node;
  if (!node.children) return null;
  return getNodeAtPath(node.children, path, pathIndex + 1);
}

function absoluteToTreePath(
  absolutePath: string,
  rootPath: string,
  root: RootType,
): string[] | null {
  if (absolutePath === rootPath) return [root];
  if (!absolutePath.startsWith(rootPath + "/")) return null;
  const relative = absolutePath.slice(rootPath.length + 1);
  return [root, ...relative.split("/")];
}

export function DirectoryTree({
  root,
  rootPath,
  apiReady,
  loadDirectory,
  onDirectorySelect,
  currentPath,
}: DirectoryTreeProps) {
  const [nodes, setNodes] = useState<TreeNode[]>([]);
  const [activePath, setActivePath] = useState<string | null>(null);
  const nodesRef = useRef(nodes);
  nodesRef.current = nodes;
  const lastInternalNavRef = useRef<string | null>(null);

  useEffect(() => {
    if (!apiReady) return;
    setNodes([createRootNode(root)]);
    loadDirectory(rootPath)
      .then(({ list }) => {
        setNodes([
          {
            ...createRootNode(root),
            children: buildDirectoryNodes(list),
            isLoading: false,
            isExpanded: true,
          },
        ]);
      })
      .catch(() => {
        setNodes([
          {
            ...createRootNode(root),
            children: [],
            isLoading: false,
            isExpanded: true,
          },
        ]);
      });
  }, [apiReady, root, rootPath, loadDirectory]);

  // Sync tree expansion/highlight when currentPath changes externally
  // (e.g. navigating into a folder from the file list)
  useEffect(() => {
    if (!currentPath) return;

    // Skip if this navigation originated from the tree itself
    if (lastInternalNavRef.current === currentPath) {
      lastInternalNavRef.current = null;
      return;
    }
    lastInternalNavRef.current = null;

    const segments = absoluteToTreePath(currentPath, rootPath, root);
    if (!segments) return;

    // Set highlight immediately
    setActivePath(segments.join("/"));

    let cancelled = false;

    // Walk depth-by-depth, loading children as needed and expanding
    (async () => {
      for (let i = 0; i < segments.length; i++) {
        if (cancelled) return;
        const pathSoFar = segments.slice(0, i + 1);
        const node = getNodeAtPath(nodesRef.current, pathSoFar, 0);
        if (!node) return;

        // Expand this node
        setNodes((prev) =>
          updateNodeAtPath(prev, pathSoFar, 0, (n) => ({
            ...n,
            isExpanded: true,
          })),
        );

        // If children not loaded, load them
        if (node.children === null && i < segments.length - 1) {
          const isRootNode =
            pathSoFar.length === 1 && pathSoFar[0] === root;
          const fullPath = isRootNode
            ? rootPath
            : `${rootPath}/${pathSoFar.slice(1).join("/")}`;

          try {
            const { list } = await loadDirectory(fullPath);
            if (cancelled) return;
            setNodes((prev) =>
              updateNodeAtPath(prev, pathSoFar, 0, (n) => ({
                ...n,
                children: buildDirectoryNodes(list),
                isLoading: false,
                isExpanded: true,
              })),
            );
            // Allow state to settle so nodesRef picks up new children
            await new Promise((r) => setTimeout(r, 0));
          } catch {
            return;
          }
        }
      }
    })();

    return () => {
      cancelled = true;
    };
  }, [currentPath, rootPath, root, loadDirectory]);

  const handleNodeClick = (path: string[]) => {
    const pathStr = path.join("/");
    setActivePath(pathStr);
    const targetNode = getNodeAtPath(nodes, path, 0);
    if (!targetNode) return;

    const isRootNode = path.length === 1 && path[0] === root;
    const fullPath = isRootNode ? rootPath : `${rootPath}/${path.slice(1).join("/")}`;

    lastInternalNavRef.current = fullPath;
    onDirectorySelect(fullPath);

    if (targetNode.isExpanded) {
      setNodes((prev) =>
        updateNodeAtPath(prev, path, 0, (n) => ({
          ...n,
          isExpanded: false,
        })),
      );
      return;
    }

    if (targetNode.children !== null) {
      setNodes((prev) =>
        updateNodeAtPath(prev, path, 0, (n) => ({
          ...n,
          isExpanded: true,
        })),
      );
      return;
    }

    setNodes((prev) =>
      updateNodeAtPath(prev, path, 0, (n) => ({
        ...n,
        isLoading: true,
      })),
    );

    loadDirectory(fullPath)
      .then(({ list }) => {
        setNodes((prev) =>
          updateNodeAtPath(prev, path, 0, (n) => ({
            ...n,
            children: buildDirectoryNodes(list),
            isLoading: false,
            isExpanded: true,
          })),
        );
      })
      .catch(() => {
        setNodes((prev) =>
          updateNodeAtPath(prev, path, 0, (n) => ({
            ...n,
            children: [],
            isLoading: false,
            isExpanded: true,
          })),
        );
      });
  };

  const renderNode = (node: TreeNode, path: string[], depth: number) => {
    const currentPath = [...path, node.meta.name];
    const pathStr = currentPath.join("/");
    const isActive = activePath === pathStr;

    return (
      <div key={node.meta.name}>
        <button
          type="button"
          className={`flex items-center w-full py-1 px-2 text-left ${
            isActive
              ? "bg-amber-100 dark:bg-amber-900"
              : "hover:bg-accent"
          }`}
          style={{ paddingLeft: `${depth * 16 + 8}px` }}
          onClick={() => handleNodeClick(currentPath)}
        >
          <span className="w-4 h-4 mr-1 shrink-0 flex items-center justify-center">
            {node.isLoading ? (
              <Spinner className="size-3" />
            ) : node.isExpanded ? (
              <ChevronDown className="w-3 h-3" />
            ) : (
              <ChevronRight className="w-3 h-3" />
            )}
          </span>
          {node.isExpanded ? (
            <FolderOpen className="w-4 h-4 mr-2 shrink-0 text-yellow-500" />
          ) : (
            <Folder className="w-4 h-4 mr-2 shrink-0 text-yellow-500" />
          )}
          <span className="text-sm truncate">{node.meta.name}</span>
        </button>
        {node.isExpanded && node.children && (
          <div>
            {node.children.map((child) =>
              renderNode(child, currentPath, depth + 1),
            )}
          </div>
        )}
      </div>
    );
  };

  return (
    <div className="overflow-auto h-full">
      {nodes.map((node) => renderNode(node, [], 0))}
    </div>
  );
}

```

`gui/src/components/tabs/DisassemblyTab.css`:

```css
.disassembly-view {
    font-family:
        ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas,
        "Liberation Mono", monospace;
    font-size: 13px;
    line-height: 1.4;
    /*white-space: pre-wrap;*/
    /* Force dark theme for R2 terminal output */
    background-color: #1b1b1f;
    color: #fafafa;
    border-radius: 4px;
}

.disassembly-view a {
    color: #e0a050;
    text-decoration: none;
}

.disassembly-view a:hover {
    text-decoration: underline;
}

```

`gui/src/components/tabs/DroidClassDetailTab.tsx`:

```tsx
import { useMemo, useState } from "react";
import { useTranslation } from "react-i18next";
import type { IDockviewPanelProps } from "dockview";
import { Search, Loader2 } from "lucide-react";

import { useDock } from "@/context/DockContext";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";
import { Input } from "@/components/ui/input";
import { Badge } from "@/components/ui/badge";
import { Tabs, TabsList, TabsTrigger, TabsContent } from "@/components/ui/tabs";
import { useDroidQuery } from "@/lib/queries";

import type { JavaClassDetail } from "@agent/droid/modules/classes";

export interface JavaClassDetailParams {
  className: string;
}

export function DroidClassDetailTab({
  params,
}: IDockviewPanelProps<JavaClassDetailParams>) {
  const { openFilePanel } = useDock();
  const { t } = useTranslation();

  const [activeTab, setActiveTab] = useState("methods");
  const [methodSearch, setMethodSearch] = useState("");
  const [fieldSearch, setFieldSearch] = useState("");

  const { data: classInfo, isLoading } = useDroidQuery<JavaClassDetail>(
    ["javaClassDetail", params.className],
    (api) => api.classes.inspect(params.className),
  );

  const openClassTab = (className: string) => {
    openFilePanel({
      id: `javaclass_${className}`,
      component: "javaClassDetail",
      title: className,
      params: { className },
    });
  };

  const displayedMethods = useMemo(() => {
    if (!classInfo) return [];
    let methods = classInfo.methods;
    if (methodSearch.trim()) {
      const query = methodSearch.toLowerCase();
      methods = methods.filter((m) => m.name.toLowerCase().includes(query));
    }
    return methods;
  }, [classInfo, methodSearch]);

  const displayedFields = useMemo(() => {
    if (!classInfo) return [];
    let fields = classInfo.fields;
    if (fieldSearch.trim()) {
      const query = fieldSearch.toLowerCase();
      fields = fields.filter((f) => f.name.toLowerCase().includes(query));
    }
    return fields;
  }, [classInfo, fieldSearch]);

  if (isLoading) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        <Loader2 className="h-4 w-4 animate-spin mr-2" />
        {t("loading")}
      </div>
    );
  }

  if (!classInfo) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        {t("no_results")}
      </div>
    );
  }

  return (
    <div className="h-full flex flex-col p-4 overflow-y-auto">
      {/* Header: superclass chain + interfaces */}
      <div className="flex flex-wrap gap-2 items-center mb-2 text-sm">
        <div className="flex flex-wrap gap-1 items-center">
          {classInfo.superClass && (
            <span className="flex items-center">
              <button
                type="button"
                className="text-amber-600 dark:text-amber-400 hover:underline cursor-pointer font-mono"
                onClick={() => openClassTab(classInfo.superClass!)}
              >
                {classInfo.superClass}
              </button>
              <span className="mx-1 text-muted-foreground">/</span>
            </span>
          )}
          <span className="font-mono font-semibold">{classInfo.name}</span>
        </div>
        {classInfo.interfaces.length > 0 && (
          <div className="flex flex-wrap gap-1 items-center ml-2">
            {classInfo.interfaces.map((iface) => (
              <Badge
                key={iface}
                variant="secondary"
                className="font-mono text-[10px] px-1.5 py-0"
              >
                {iface}
              </Badge>
            ))}
          </div>
        )}
      </div>

      <div className="flex-1 flex flex-col overflow-hidden">
        <Tabs
          value={activeTab}
          onValueChange={setActiveTab}
          className="flex flex-col h-full"
        >
          <TabsList>
            <TabsTrigger value="methods">
              {t("methods")} ({classInfo.methods.length})
            </TabsTrigger>
            <TabsTrigger value="fields">
              {t("fields")} ({classInfo.fields.length})
            </TabsTrigger>
          </TabsList>

          <TabsContent value="methods" className="flex-1 overflow-hidden">
            <section className="h-full flex flex-col">
              <div className="relative mb-2">
                <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
                <Input
                  placeholder={t("search")}
                  value={methodSearch}
                  onChange={(e) => setMethodSearch(e.target.value)}
                  className="pl-9 h-8 text-sm"
                />
              </div>
              {displayedMethods.length > 0 ? (
                <div className="border rounded flex-1 overflow-auto min-h-0">
                  <Table>
                    <TableHeader>
                      <TableRow>
                        <TableHead className="w-8" />
                        <TableHead>{t("name")}</TableHead>
                        <TableHead>{t("return_type")}</TableHead>
                        <TableHead>{t("parameters")}</TableHead>
                      </TableRow>
                    </TableHeader>
                    <TableBody>
                      {displayedMethods.map((method, i) => (
                        <TableRow key={`${method.name}-${i}`}>
                          <TableCell className="text-center">
                            {method.isStatic && (
                              <Badge
                                variant="outline"
                                className="text-[10px] px-1"
                              >
                                S
                              </Badge>
                            )}
                          </TableCell>
                          <TableCell className="font-mono text-xs">
                            {method.name}
                          </TableCell>
                          <TableCell className="font-mono text-xs text-muted-foreground">
                            {method.returnType}
                          </TableCell>
                          <TableCell className="font-mono text-xs text-muted-foreground">
                            {method.argumentTypes.join(", ") || "-"}
                          </TableCell>
                        </TableRow>
                      ))}
                    </TableBody>
                  </Table>
                </div>
              ) : (
                <div className="text-sm text-muted-foreground py-4 text-center border rounded">
                  {t("no_results")}
                </div>
              )}
            </section>
          </TabsContent>

          <TabsContent value="fields" className="flex-1 overflow-hidden">
            <section className="h-full flex flex-col">
              <div className="relative mb-2">
                <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
                <Input
                  placeholder={t("search")}
                  value={fieldSearch}
                  onChange={(e) => setFieldSearch(e.target.value)}
                  className="pl-9 h-8 text-sm"
                />
              </div>
              {displayedFields.length > 0 ? (
                <div className="border rounded flex-1 overflow-auto min-h-0">
                  <Table>
                    <TableHeader>
                      <TableRow>
                        <TableHead className="w-8" />
                        <TableHead>{t("name")}</TableHead>
                        <TableHead>{t("type")}</TableHead>
                      </TableRow>
                    </TableHeader>
                    <TableBody>
                      {displayedFields.map((field) => (
                        <TableRow key={field.name}>
                          <TableCell className="text-center">
                            {field.isStatic && (
                              <Badge
                                variant="outline"
                                className="text-[10px] px-1"
                              >
                                S
                              </Badge>
                            )}
                          </TableCell>
                          <TableCell className="font-mono text-xs">
                            {field.name}
                          </TableCell>
                          <TableCell className="font-mono text-xs text-muted-foreground">
                            {field.type}
                          </TableCell>
                        </TableRow>
                      ))}
                    </TableBody>
                  </Table>
                </div>
              ) : (
                <div className="text-sm text-muted-foreground py-4 text-center border rounded">
                  {t("no_results")}
                </div>
              )}
            </section>
          </TabsContent>
        </Tabs>
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/DroidHandlesTab.tsx`:

```tsx
import { useMemo, useRef, useState, useEffect } from "react";
import { useTranslation } from "react-i18next";
import { Button } from "@/components/ui/button";
import { Spinner } from "@/components/ui/spinner";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import { ArrowDown, ArrowUp, ArrowUpDown, RefreshCw } from "lucide-react";
import { Checkbox } from "@/components/ui/checkbox";
import { Label } from "@/components/ui/label";
import { useDroidQuery } from "@/lib/queries";

import type {
  FileDescriptor,
  TcpEntry,
  UdpEntry,
  FileEntry,
} from "@agent/droid/modules/lsof";

function isTcp(fd: FileDescriptor): fd is TcpEntry {
  return fd.type === "tcp" || fd.type === "tcp6";
}

function isUdp(fd: FileDescriptor): fd is UdpEntry {
  return fd.type === "udp" || fd.type === "udp6";
}

function isFile(fd: FileDescriptor): fd is FileEntry {
  return fd.type === "file";
}

function getDetails(handle: FileDescriptor): string {
  if (isTcp(handle))
    return `${handle.localIp}:${handle.localPort} → ${handle.remoteIp}:${handle.remotePort} (${handle.state})`;
  if (isUdp(handle))
    return `${handle.localIp}:${handle.localPort} → ${handle.remoteIp}:${handle.remotePort}`;
  if (isFile(handle)) return handle.path;
  return "";
}

type SortKey = "fd" | "type" | "details";
type SortOrder = "asc" | "desc";

export function DroidHandlesTab() {
  const { t } = useTranslation();
  const [sortKey, setSortKey] = useState<SortKey>("fd");
  const [sortOrder, setSortOrder] = useState<SortOrder>("asc");
  const [reloadInterval, setReloadInterval] = useState(0);
  const [showTcp, setShowTcp] = useState(true);
  const [showUdp, setShowUdp] = useState(true);
  const [showFile, setShowFile] = useState(true);
  const intervalRef = useRef<ReturnType<typeof setInterval> | null>(null);

  const {
    data: handles = [],
    isLoading,
    refetch,
  } = useDroidQuery<FileDescriptor[]>(
    ["droidHandles"],
    (api) => api.lsof.fds(),
  );

  useEffect(() => {
    if (intervalRef.current) {
      clearInterval(intervalRef.current);
      intervalRef.current = null;
    }

    if (reloadInterval > 0) {
      intervalRef.current = setInterval(() => refetch(), reloadInterval * 1000);
    }

    return () => {
      if (intervalRef.current) {
        clearInterval(intervalRef.current);
      }
    };
  }, [reloadInterval, refetch]);

  const handleSort = (key: SortKey) => {
    if (sortKey === key) {
      setSortOrder(sortOrder === "asc" ? "desc" : "asc");
    } else {
      setSortKey(key);
      setSortOrder("asc");
    }
  };

  const filteredAndSortedHandles = useMemo(() => {
    return handles
      .filter((handle) => {
        if (isTcp(handle) && !showTcp) return false;
        if (isUdp(handle) && !showUdp) return false;
        if (isFile(handle) && !showFile) return false;
        return true;
      })
      .sort((a, b) => {
        let cmp = 0;
        switch (sortKey) {
          case "fd":
            cmp = (a.fd ?? -1) - (b.fd ?? -1);
            break;
          case "type":
            cmp = a.type.localeCompare(b.type);
            break;
          case "details":
            cmp = getDetails(a).localeCompare(getDetails(b));
            break;
        }
        return sortOrder === "asc" ? cmp : -cmp;
      });
  }, [handles, sortKey, sortOrder, showTcp, showUdp, showFile]);

  const SortIcon = ({ column }: { column: SortKey }) => {
    if (sortKey !== column) return <ArrowUpDown className="h-4 w-4 ml-1" />;
    return sortOrder === "asc" ? (
      <ArrowUp className="h-4 w-4 ml-1" />
    ) : (
      <ArrowDown className="h-4 w-4 ml-1" />
    );
  };

  return (
    <div className="h-full flex flex-col">
      <div className="flex items-center justify-between p-4">
        <div className="flex items-center gap-4">
          <div className="flex items-center gap-2">
            <Checkbox
              id="filter-tcp"
              checked={showTcp}
              onCheckedChange={(checked) => setShowTcp(checked === true)}
            />
            <Label htmlFor="filter-tcp" className="text-sm cursor-pointer">
              TCP
            </Label>
          </div>
          <div className="flex items-center gap-2">
            <Checkbox
              id="filter-udp"
              checked={showUdp}
              onCheckedChange={(checked) => setShowUdp(checked === true)}
            />
            <Label htmlFor="filter-udp" className="text-sm cursor-pointer">
              UDP
            </Label>
          </div>
          <div className="flex items-center gap-2">
            <Checkbox
              id="filter-file"
              checked={showFile}
              onCheckedChange={(checked) => setShowFile(checked === true)}
            />
            <Label htmlFor="filter-file" className="text-sm cursor-pointer">
              File
            </Label>
          </div>
        </div>
        <div className="flex items-center gap-2">
          <Select
            value={String(reloadInterval)}
            onValueChange={(value) => setReloadInterval(Number(value))}
          >
            <SelectTrigger className="w-28 h-8 text-xs">
              <SelectValue />
            </SelectTrigger>
            <SelectContent>
              <SelectItem value="0">{t("never")}</SelectItem>
              <SelectItem value="5">{t("5s")}</SelectItem>
              <SelectItem value="10">{t("10s")}</SelectItem>
              <SelectItem value="60">{t("1min")}</SelectItem>
            </SelectContent>
          </Select>
          <Button
            variant="outline"
            size="sm"
            onClick={() => refetch()}
            disabled={isLoading}
          >
            <RefreshCw
              className={`h-4 w-4 mr-2 ${isLoading ? "animate-spin" : ""}`}
            />
            {t("reload")}
          </Button>
        </div>
      </div>
      <div className="flex-1 overflow-auto border-t border-border">
        {isLoading && handles.length === 0 ? (
          <div className="flex items-center justify-center h-full gap-2 text-muted-foreground">
            <Spinner />
            {t("loading")}...
          </div>
        ) : (
          <Table>
            <TableHeader>
              <TableRow>
                <TableHead
                  className="w-16 cursor-pointer select-none hover:bg-accent"
                  onClick={() => handleSort("fd")}
                >
                  <div className="flex items-center">
                    {t("file_descriptor")}
                    <SortIcon column="fd" />
                  </div>
                </TableHead>
                <TableHead
                  className="w-24 cursor-pointer select-none hover:bg-accent"
                  onClick={() => handleSort("type")}
                >
                  <div className="flex items-center">
                    {t("type")}
                    <SortIcon column="type" />
                  </div>
                </TableHead>
                <TableHead
                  className="cursor-pointer select-none hover:bg-accent"
                  onClick={() => handleSort("details")}
                >
                  <div className="flex items-center">
                    {t("details")}
                    <SortIcon column="details" />
                  </div>
                </TableHead>
              </TableRow>
            </TableHeader>
            <TableBody>
              {filteredAndSortedHandles.map((handle, idx) => (
                <TableRow key={`${handle.fd ?? "no-fd"}-${handle.type}-${idx}`}>
                  <TableCell className="font-mono">
                    {handle.fd !== null ? handle.fd : "\u2014"}
                  </TableCell>
                  <TableCell>{handle.type}</TableCell>
                  <TableCell className="font-mono text-xs break-all">
                    {getDetails(handle)}
                  </TableCell>
                </TableRow>
              ))}
              {handles.length === 0 && !isLoading && (
                <TableRow>
                  <TableCell
                    colSpan={3}
                    className="text-center text-muted-foreground"
                  >
                    {t("no_results")}
                  </TableCell>
                </TableRow>
              )}
            </TableBody>
          </Table>
        )}
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/DroidJNITab.tsx`:

```tsx
import { useEffect, useMemo, useRef, useState } from "react";
import { useQuery, useMutation } from "@tanstack/react-query";
import { useTranslation } from "react-i18next";
import { type ColumnDef } from "@tanstack/react-table";

import { Trash2, Play, Square, Loader2, ChevronsDown } from "lucide-react";

import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import {
  ResizableHandle,
  ResizablePanel,
  ResizablePanelGroup,
} from "@/components/ui/resizable";
import { LogTable } from "@/components/shared/LogTable";
import { Status, useSession } from "@/context/SessionContext";
import { useLogStream } from "@/hooks/useLogStream";
import { toTime } from "@/lib/format";

const TAP_ID = "jni";
import type { JNIEvent } from "@agent/droid/hooks/jni";

interface JNIDisplayEvent {
  type: string;
  method: string;
  callType: string;
  threadId: number;
  args: string[];
  ret: string;
  backtrace?: string[];
  library?: string | null;
}

interface JNIEntry {
  id: number;
  timestamp: Date;
  event: JNIDisplayEvent;
}

function argsPreview(args: string[]): string {
  if (!args || args.length === 0) return "";
  const joined = args.join(", ");
  return joined.length > 80 ? `${joined.slice(0, 80)}...` : joined;
}

const mapHistory = (record: Record<string, unknown>, id: number): JNIEntry => ({
  id,
  timestamp: new Date(record.timestamp as string),
  event: {
    type: (record.type as string) ?? "trace",
    method: record.method as string,
    callType: (record.callType as string) ?? "JNIEnv",
    threadId: (record.threadId as number) ?? 0,
    args: (record.args as string[]) ?? [],
    ret: (record.ret as string) ?? "",
    backtrace: record.backtrace as string[] | undefined,
    library: record.library as string | null | undefined,
  },
});

const mapSocket = (id: number, ...args: unknown[]): JNIEntry => {
  const raw = args[0] as JNIEvent;
  return {
    id,
    timestamp: new Date(),
    event: {
      type: raw.type,
      method: raw.method,
      callType: raw.callType,
      threadId: raw.threadId,
      args: raw.args,
      ret: raw.ret,
      library: raw.type === "load" ? raw.library : undefined,
    },
  };
};

const columns: ColumnDef<JNIEntry>[] = [
  {
    id: "timestamp",
    header: "Time",
    size: 96,
    cell: ({ row }) => (
      <span className="font-mono text-muted-foreground">
        {toTime(row.original.timestamp)}
      </span>
    ),
  },
  {
    id: "tid",
    header: "TID",
    size: 48,
    cell: ({ row }) => (
      <span className="font-mono text-muted-foreground text-center">
        {row.original.event.threadId ?? "-"}
      </span>
    ),
  },
  {
    id: "type",
    header: "Type",
    size: 64,
    cell: ({ row }) => {
      const { event } = row.original;
      const isLoad = event.type === "load";
      return (
        <Badge
          variant={
            isLoad
              ? "outline"
              : event.callType === "JavaVM"
                ? "secondary"
                : "default"
          }
          className="h-5 px-1.5 text-[10px]"
        >
          {isLoad ? "load" : event.callType}
        </Badge>
      );
    },
  },
  {
    id: "method",
    header: "Method",
    size: 220,
    cell: ({ row }) => (
      <span
        className="font-mono text-primary truncate"
        title={row.original.event.method}
      >
        {row.original.event.method}
      </span>
    ),
  },
  {
    id: "args",
    header: "Args",
    size: 200,
    cell: ({ row }) => {
      const text = argsPreview(row.original.event.args);
      return (
        <span className="font-mono text-muted-foreground truncate" title={text}>
          {text || "--"}
        </span>
      );
    },
  },
];

export function JNITab() {
  const { t } = useTranslation();
  const { status, device, identifier, droid } = useSession();

  const [isActive, setIsActive] = useState<boolean | null>(null);
  const [searchFilter, setSearchFilter] = useState("");
  const tableContainerRef = useRef<HTMLDivElement>(null);

  const {
    entries,
    selectedId,
    setSelectedId,
    clear,
    clearMutation,
  } = useLogStream<JNIEntry>({
    event: "jni",
    path: "history/jni",
    key: "logs",
    fromRecord: mapHistory,
    fromEvent: mapSocket,
  });

  // Sync initial active state from agent
  const { data: initialActive } = useQuery({
    queryKey: ["jniActive", device],
    queryFn: () => droid!.taps.active(TAP_ID),
    enabled: status === Status.Ready && !!droid,
  });

  useEffect(() => {
    if (initialActive !== undefined && isActive === null)
      setIsActive(initialActive);
  }, [initialActive, isActive]);

  // Reset active state on session change
  useEffect(() => {
    setIsActive(false);
  }, [device, identifier]);

  // Toggle start/stop
  const toggleMutation = useMutation({
    mutationFn: async (enable: boolean) => {
      if (!droid) return;
      if (enable) {
        await droid.taps.start(TAP_ID);
      } else {
        await droid.taps.stop(TAP_ID);
      }
    },
    onSuccess: (_, enable) => {
      setIsActive(enable);
    },
  });

  // Filter entries
  const filteredEntries = useMemo(() => {
    const q = searchFilter.trim().toLowerCase();
    if (!q) return entries;
    return entries.filter(
      (e) =>
        e.event.method.toLowerCase().includes(q) ||
        e.event.args.some((a) => a.toLowerCase().includes(q)) ||
        (e.event.library?.toLowerCase().includes(q) ?? false),
    );
  }, [entries, searchFilter]);

  const selectedEntry = useMemo(
    () => filteredEntries.find((e) => e.id === selectedId) ?? null,
    [filteredEntries, selectedId],
  );

  const notReady = status !== Status.Ready;

  return (
    <ResizablePanelGroup
      orientation="horizontal"
      className="h-full"
      autoSaveId="jni-split"
    >
      {/* Left: toolbar + event list */}
      <ResizablePanel defaultSize="65%" minSize="30%">
        <div className="h-full flex flex-col overflow-hidden">
          {/* Toolbar */}
          <div className="flex items-center gap-2 p-2 border-b shrink-0">
            {isActive ? (
              <Button
                variant="outline"
                size="sm"
                className="h-8 px-2.5 text-xs text-red-500 hover:text-red-600"
                onClick={() => toggleMutation.mutate(false)}
                disabled={notReady || toggleMutation.isPending || !droid}
              >
                {toggleMutation.isPending ? (
                  <Loader2 className="w-3.5 h-3.5 animate-spin" />
                ) : (
                  <Square className="w-3.5 h-3.5" />
                )}
                Stop
              </Button>
            ) : (
              <Button
                variant="outline"
                size="sm"
                className="h-8 px-2.5 text-xs text-green-600 hover:text-green-700"
                onClick={() => toggleMutation.mutate(true)}
                disabled={notReady || toggleMutation.isPending || !droid}
              >
                {toggleMutation.isPending ? (
                  <Loader2 className="w-3.5 h-3.5 animate-spin" />
                ) : (
                  <Play className="w-3.5 h-3.5" />
                )}
                Start
              </Button>
            )}
            <Input
              value={searchFilter}
              onChange={(e) => setSearchFilter(e.target.value)}
              placeholder="Filter..."
              className="h-8 max-w-xs"
            />
            <span className="text-xs text-muted-foreground ml-auto">
              {filteredEntries.length} event
              {filteredEntries.length !== 1 ? "s" : ""}
            </span>
            <Button
              variant="ghost"
              size="icon"
              className="h-8 w-8"
              onClick={() =>
                tableContainerRef.current?.scrollTo({
                  top: tableContainerRef.current.scrollHeight,
                  behavior: "smooth",
                })
              }
            >
              <ChevronsDown className="w-4 h-4" />
            </Button>
            <Button
              variant="ghost"
              size="icon"
              className="h-8 w-8 text-red-500 hover:text-red-600 hover:bg-red-100 dark:hover:bg-red-950/30"
              onClick={clear}
              disabled={clearMutation.isPending || entries.length === 0}
            >
              <Trash2 className="h-4 w-4" />
            </Button>
          </div>

          {/* Virtualized table */}
          <LogTable
            data={filteredEntries}
            columns={columns}
            selectedId={selectedId}
            onSelect={setSelectedId}
            scrollRef={tableContainerRef}
          />
        </div>
      </ResizablePanel>

      <ResizableHandle />

      {/* Right: detail panel */}
      <ResizablePanel defaultSize="35%" minSize="15%">
        <div className="h-full overflow-auto p-3 text-xs">
          {!selectedEntry ? (
            <div className="h-full flex items-center justify-center text-muted-foreground">
              Select an event to view details
            </div>
          ) : (
            <div className="space-y-3">
              <div className="space-y-1">
                <div>
                  <span className="text-muted-foreground">{t("time")}: </span>
                  {toTime(selectedEntry.timestamp)}
                </div>
                <div>
                  <span className="text-muted-foreground">Method: </span>
                  <span className="font-mono text-primary">
                    {selectedEntry.event.method}
                  </span>
                </div>
                <div>
                  <span className="text-muted-foreground">Call Type: </span>
                  {selectedEntry.event.callType}
                </div>
                <div>
                  <span className="text-muted-foreground">Thread ID: </span>
                  {selectedEntry.event.threadId}
                </div>
                {selectedEntry.event.library && (
                  <div>
                    <span className="text-muted-foreground">Library: </span>
                    {selectedEntry.event.library}
                  </div>
                )}
              </div>

              {selectedEntry.event.args.length > 0 && (
                <div>
                  <div className="text-muted-foreground mb-1">Arguments</div>
                  <pre className="rounded border bg-muted/20 p-2 overflow-auto max-h-40 whitespace-pre-wrap break-all">
                    {selectedEntry.event.args
                      .map((a, i) => `[${i}] ${a}`)
                      .join("\n")}
                  </pre>
                </div>
              )}

              {selectedEntry.event.ret && (
                <div>
                  <div className="text-muted-foreground mb-1">Return Value</div>
                  <pre className="rounded border bg-muted/20 p-2 overflow-auto max-h-20 whitespace-pre-wrap break-all">
                    {selectedEntry.event.ret}
                  </pre>
                </div>
              )}

              {selectedEntry.event.backtrace &&
                selectedEntry.event.backtrace.length > 0 && (
                  <div>
                    <div className="text-muted-foreground mb-1">Backtrace</div>
                    <div className="rounded border bg-muted/20 p-2 overflow-auto max-h-60 text-[10px] font-mono space-y-0.5">
                      {selectedEntry.event.backtrace.map((frame, i) => (
                        <div
                          key={i}
                          className="p-1 rounded hover:bg-muted/50 break-all"
                        >
                          <span className="text-muted-foreground mr-2">
                            #{i}
                          </span>
                          {frame}
                        </div>
                      ))}
                    </div>
                  </div>
                )}
            </div>
          )}
        </div>
      </ResizablePanel>
    </ResizablePanelGroup>
  );
}

```

`gui/src/components/tabs/DroidKeystoreTab.tsx`:

```tsx
import { useMemo, useState } from "react";
import { useTranslation } from "react-i18next";
import { Search, Loader2 } from "lucide-react";
import { List, type RowComponentProps } from "react-window";

import { Input } from "@/components/ui/input";
import { Badge } from "@/components/ui/badge";
import { Skeleton } from "@/components/ui/skeleton";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";
import {
  ResizableHandle,
  ResizablePanel,
  ResizablePanelGroup,
} from "@/components/ui/resizable";
import { useDroidQuery } from "@/lib/queries";

import type { KeystoreAlias, KeyInfo } from "@agent/droid/modules/keystore";

const ITEM_HEIGHT = 56;

function decodePurposes(purposes: number): string[] {
  const result: string[] = [];
  if (purposes & 1) result.push("ENCRYPT");
  if (purposes & 2) result.push("DECRYPT");
  if (purposes & 4) result.push("SIGN");
  if (purposes & 8) result.push("VERIFY");
  return result.length > 0 ? result : ["NONE"];
}

function decodeOrigin(origin: number): string {
  switch (origin) {
    case 1:
      return "GENERATED";
    case 2:
      return "IMPORTED";
    case 4:
      return "UNKNOWN";
    default:
      return `OTHER (${origin})`;
  }
}

function SectionLabel({ children }: { children: React.ReactNode }) {
  return (
    <div className="text-xs font-medium text-muted-foreground uppercase tracking-wider mt-6 mb-2 first:mt-0">
      {children}
    </div>
  );
}

function InfoRow({
  label,
  children,
}: {
  label: string;
  children: React.ReactNode;
}) {
  return (
    <div className="flex items-start py-1.5 border-b border-border/50">
      <div className="text-xs text-muted-foreground w-48 shrink-0">
        {label}
      </div>
      <div className="text-sm flex-1 min-w-0">{children}</div>
    </div>
  );
}

function BoolBadge({ value }: { value: boolean | null }) {
  if (value === null)
    return <span className="text-xs text-muted-foreground">N/A</span>;
  return (
    <Badge
      variant={value ? "default" : "secondary"}
      className="text-[10px] px-1.5 py-0"
    >
      {value ? "Yes" : "No"}
    </Badge>
  );
}

function ArrayDisplay({ items }: { items: string[] }) {
  if (items.length === 0)
    return <span className="text-xs text-muted-foreground">None</span>;
  return (
    <div className="flex gap-1 flex-wrap">
      {items.map((item) => (
        <Badge
          key={item}
          variant="outline"
          className="text-[10px] px-1.5 py-0 font-mono"
        >
          {item}
        </Badge>
      ))}
    </div>
  );
}

// --- Detail pane ---

function KeyDetail({
  alias,
  entryType,
}: {
  alias: string;
  entryType: string;
}) {
  const { t } = useTranslation();

  const {
    data: keyInfo,
    isLoading,
    error,
  } = useDroidQuery<KeyInfo | null>(
    ["keystoreInfo", alias],
    (api) => api.keystore.info(alias),
  );

  if (error) {
    return (
      <div className="h-full p-4 overflow-auto">
        <Alert variant="destructive">
          <AlertTitle>{t("error")}</AlertTitle>
          <AlertDescription>{(error as Error)?.message}</AlertDescription>
        </Alert>
      </div>
    );
  }

  if (isLoading) {
    return (
      <div className="h-full p-4 overflow-auto">
        <div className="space-y-3">
          <Skeleton className="h-4 w-48" />
          <Skeleton className="h-4 w-full" />
          <Skeleton className="h-4 w-3/4" />
          <Skeleton className="h-4 w-full" />
        </div>
      </div>
    );
  }

  if (!keyInfo) {
    return (
      <div className="h-full p-4 overflow-auto">
        <div className="text-sm text-muted-foreground">{t("no_data")}</div>
      </div>
    );
  }

  return (
    <div className="h-full p-4 overflow-auto">
      <div className="max-w-2xl space-y-1">
        <SectionLabel>{t("key_properties")}</SectionLabel>
        <InfoRow label={t("alias")}>{keyInfo.alias}</InfoRow>
        <InfoRow label={t("hook_algorithm")}>{keyInfo.algorithm}</InfoRow>
        <InfoRow label={t("key_size")}>{keyInfo.keySize} bits</InfoRow>
        <InfoRow label={t("entry_type")}>
          <Badge variant="secondary" className="text-[10px] px-1.5 py-0">
            {entryType}
          </Badge>
        </InfoRow>
        <InfoRow label={t("origin")}>
          {decodeOrigin(keyInfo.origin)}
        </InfoRow>
        <InfoRow label={t("purposes")}>
          <ArrayDisplay items={decodePurposes(keyInfo.purposes)} />
        </InfoRow>

        <SectionLabel>{t("crypto_config")}</SectionLabel>
        <InfoRow label={t("block_modes")}>
          <ArrayDisplay items={keyInfo.blockModes} />
        </InfoRow>
        <InfoRow label={t("digests")}>
          <ArrayDisplay items={keyInfo.digests} />
        </InfoRow>
        <InfoRow label={t("encryption_paddings")}>
          <ArrayDisplay items={keyInfo.encryptionPaddings} />
        </InfoRow>
        <InfoRow label={t("signature_paddings")}>
          <ArrayDisplay items={keyInfo.signaturePaddings} />
        </InfoRow>

        <SectionLabel>{t("security_properties")}</SectionLabel>
        <InfoRow label={t("inside_secure_hardware")}>
          <BoolBadge value={keyInfo.isInsideSecureHardware} />
        </InfoRow>
        <InfoRow label={t("user_auth_required")}>
          <BoolBadge value={keyInfo.isUserAuthenticationRequired} />
        </InfoRow>
        <InfoRow label={t("auth_validity_seconds")}>
          {keyInfo.userAuthenticationValidityDurationSeconds}
        </InfoRow>
        <InfoRow label={t("auth_enforced_by_hardware")}>
          <BoolBadge
            value={
              keyInfo.isUserAuthenticationRequirementEnforcedBySecureHardware
            }
          />
        </InfoRow>
        <InfoRow label={t("biometric_invalidation")}>
          <BoolBadge value={keyInfo.isInvalidatedByBiometricEnrollment} />
        </InfoRow>
        <InfoRow label={t("trusted_presence_required")}>
          <BoolBadge value={keyInfo.isTrustedUserPresenceRequired} />
        </InfoRow>
        <InfoRow label={t("user_confirmation_required")}>
          <BoolBadge value={keyInfo.isUserConfirmationRequired} />
        </InfoRow>
        <InfoRow label={t("auth_valid_on_body")}>
          <BoolBadge
            value={keyInfo.isUserAuthenticationValidWhileOnBody}
          />
        </InfoRow>

        {(keyInfo.keyValidityStart ||
          keyInfo.keyValidityForOriginationEnd ||
          keyInfo.keyValidityForConsumptionEnd) && (
          <>
            <SectionLabel>{t("validity")}</SectionLabel>
            {keyInfo.keyValidityStart && (
              <InfoRow label={t("validity_start")}>
                {keyInfo.keyValidityStart}
              </InfoRow>
            )}
            {keyInfo.keyValidityForOriginationEnd && (
              <InfoRow label={t("validity_origination_end")}>
                {keyInfo.keyValidityForOriginationEnd}
              </InfoRow>
            )}
            {keyInfo.keyValidityForConsumptionEnd && (
              <InfoRow label={t("validity_consumption_end")}>
                {keyInfo.keyValidityForConsumptionEnd}
              </InfoRow>
            )}
          </>
        )}
      </div>
    </div>
  );
}

// --- List pane ---

function AliasRow({
  index,
  style,
  items,
  selected,
  onClick,
}: RowComponentProps<{
  items: KeystoreAlias[];
  selected: string | null;
  onClick: (alias: string) => void;
}>) {
  const item = items[index];
  const isSelected = item.alias === selected;

  return (
    <button
      type="button"
      className={`w-full text-left px-4 py-2 border-b border-border hover:bg-accent ${isSelected ? "bg-accent" : ""}`}
      style={style}
      onClick={() => onClick(item.alias)}
    >
      <div className="flex items-center justify-between">
        <div className="min-w-0 flex-1">
          <div className="text-sm font-medium truncate">{item.alias}</div>
          <div className="text-xs text-muted-foreground font-mono truncate">
            {item.algorithm ?? "N/A"}
          </div>
        </div>
        <div className="flex items-center gap-1 shrink-0 ml-2">
          <Badge variant="secondary" className="text-[10px] px-1.5 py-0">
            {item.entryType}
          </Badge>
        </div>
      </div>
    </button>
  );
}

// --- Main tab ---

export function DroidKeystoreTab() {
  const { t } = useTranslation();
  const [search, setSearch] = useState("");
  const [selected, setSelected] = useState<string | null>(null);

  const { data: keys = [], isLoading } = useDroidQuery<KeystoreAlias[]>(
    ["keystoreAliases"],
    (api) => api.keystore.aliases(),
  );

  const filtered = useMemo(() => {
    if (!search.trim()) return keys;
    const query = search.toLowerCase();
    return keys.filter(
      (k) =>
        k.alias.toLowerCase().includes(query) ||
        k.algorithm?.toLowerCase().includes(query) ||
        k.entryType.toLowerCase().includes(query),
    );
  }, [keys, search]);

  const selectedEntry = keys.find((k) => k.alias === selected);

  const listPane = (
    <div className="h-full flex flex-col">
      <div className="p-3 space-y-2 border-b border-border">
        <div className="relative">
          <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
          <Input
            placeholder={t("search")}
            value={search}
            onChange={(e) => setSearch(e.target.value)}
            className="pl-9"
          />
        </div>
        <div className="text-xs text-muted-foreground">
          {filtered.length} / {keys.length}
        </div>
      </div>
      <div className="flex-1 min-h-0">
        {isLoading ? (
          <div className="flex items-center justify-center h-full text-muted-foreground">
            <Loader2 className="h-4 w-4 animate-spin mr-2" />
            {t("loading")}...
          </div>
        ) : filtered.length === 0 ? (
          <div className="flex items-center justify-center h-full text-muted-foreground">
            {t("no_keystore_aliases")}
          </div>
        ) : (
          <div className="flex h-full">
            <List
              rowComponent={AliasRow}
              rowCount={filtered.length}
              rowHeight={ITEM_HEIGHT}
              rowProps={{
                items: filtered,
                selected,
                onClick: setSelected,
              }}
            />
          </div>
        )}
      </div>
    </div>
  );

  if (!selected || !selectedEntry) {
    return listPane;
  }

  return (
    <ResizablePanelGroup
      orientation="horizontal"
      className="h-full"
      autoSaveId="keystore-tab-split"
    >
      <ResizablePanel defaultSize="35%" minSize="20%">
        {listPane}
      </ResizablePanel>
      <ResizableHandle withHandle />
      <ResizablePanel>
        <KeyDetail
          alias={selected}
          entryType={selectedEntry.entryType}
        />
      </ResizablePanel>
    </ResizablePanelGroup>
  );
}

```

`gui/src/components/tabs/DroidManifestTab.tsx`:

```tsx
import { useState } from "react";
import { useTranslation } from "react-i18next";
import { Copy, Check, Download } from "lucide-react";
import Editor from "@monaco-editor/react";

import { useTheme } from "@/components/providers/ThemeProvider";
import { Button } from "@/components/ui/button";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import { Skeleton } from "@/components/ui/skeleton";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";
import { ManifestInsights } from "@/components/tabs/ManifestInsights";
import { useDroidQuery } from "@/lib/queries";

export function DroidManifestTab() {
  const { t } = useTranslation();
  const { theme } = useTheme();
  const [viewMode, setViewMode] = useState<"xml" | "insight">("xml");
  const [copied, setCopied] = useState(false);
  const {
    data: xml,
    isLoading,
    error,
  } = useDroidQuery(["manifest"], (api) => api.manifest.xml());

  const handleCopy = async () => {
    if (!xml) return;
    await navigator.clipboard.writeText(xml);
    setCopied(true);
    setTimeout(() => setCopied(false), 2000);
  };

  const handleDownload = () => {
    if (!xml) return;
    const blob = new Blob([xml], { type: "application/xml" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "AndroidManifest.xml";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  };

  return (
    <div className="h-full flex flex-col">
      <div className="flex items-center justify-between p-4 border-b">
        <Tabs
          value={viewMode}
          onValueChange={(v) => setViewMode(v as "xml" | "insight")}
        >
          <TabsList variant="line" className="w-auto h-8">
            <TabsTrigger value="xml" className="px-3">
              XML
            </TabsTrigger>
            <TabsTrigger value="insight" className="px-3">
              {t("insights")}
            </TabsTrigger>
          </TabsList>
        </Tabs>
        {viewMode === "xml" && <div className="flex items-center gap-2">
          <Button
            variant="outline"
            size="sm"
            onClick={handleCopy}
            disabled={!xml}
          >
            {copied ? (
              <Check className="h-4 w-4 mr-2 text-green-500" />
            ) : (
              <Copy className="h-4 w-4 mr-2" />
            )}
            {t("copy")}
          </Button>
          <Button
            variant="outline"
            size="sm"
            onClick={handleDownload}
            disabled={!xml}
          >
            <Download className="h-4 w-4 mr-2" />
            {t("download")}
          </Button>
        </div>}
      </div>
      <div className="flex-1 overflow-hidden">
        {error ? (
          <div className="p-4">
            <Alert variant="destructive">
              <AlertTitle>{t("error")}</AlertTitle>
              <AlertDescription>{(error as Error)?.message}</AlertDescription>
            </Alert>
          </div>
        ) : isLoading ? (
          <div className="p-4 space-y-4">
            <Skeleton className="h-8 w-48" />
            <Skeleton className="h-4 w-full" />
            <Skeleton className="h-4 w-3/4" />
            <Skeleton className="h-4 w-1/2" />
          </div>
        ) : xml ? (
          <Tabs
            value={viewMode}
            onValueChange={(v) => setViewMode(v as "xml" | "insight")}
            className="h-full flex flex-col"
          >
            <TabsContent value="xml" className="flex-1 m-0 flex flex-col overflow-hidden">
              <div className="flex-1">
                <Editor
                  height="100%"
                  language="xml"
                  value={xml}
                  theme={theme === "dark" ? "vs-dark" : "light"}
                  options={{
                    readOnly: true,
                    minimap: { enabled: false },
                    scrollBeyondLastLine: false,
                    wordWrap: "on",
                    fontSize: 13,
                    lineNumbers: "on",
                    folding: true,
                    automaticLayout: true,
                  }}
                />
              </div>
            </TabsContent>
            <TabsContent value="insight" className="flex-1 overflow-hidden m-0">
              <ManifestInsights xml={xml} />
            </TabsContent>
          </Tabs>
        ) : (
          <div className="flex items-center justify-center h-full text-muted-foreground">
            {t("no_content")}
          </div>
        )}
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/DroidProvidersTab.tsx`:

```tsx
import { useMemo, useState } from "react";
import { useTranslation } from "react-i18next";
import { Search, Globe, Play } from "lucide-react";
import { List, type RowComponentProps } from "react-window";

import { Input } from "@/components/ui/input";
import { Spinner } from "@/components/ui/spinner";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";
import { Button } from "@/components/ui/button";
import { Label } from "@/components/ui/label";
import {
  ResizableHandle,
  ResizablePanel,
  ResizablePanelGroup,
} from "@/components/ui/resizable";
import { useDroidQuery, useDroidMutation } from "@/lib/queries";

import type { ProviderEntry } from "@agent/droid/modules/provider";
import type { QueryResult, QueryOptions } from "@agent/droid/modules/provider";

const ITEM_HEIGHT = 56;

function shortName(fullName: string): string {
  const idx = fullName.lastIndexOf(".");
  return idx >= 0 ? fullName.substring(idx + 1) : fullName;
}

// --- Provider list row ---

function ProviderRow({
  index,
  style,
  items,
  selected,
  onClick,
}: RowComponentProps<{
  items: ProviderEntry[];
  selected: string | null;
  onClick: (authority: string) => void;
}>) {
  const item = items[index];
  const isSelected = item.authority === selected;

  return (
    <button
      type="button"
      className={`w-full text-left px-4 py-2 border-b border-border hover:bg-accent ${isSelected ? "bg-accent" : ""}`}
      style={style}
      onClick={() => onClick(item.authority)}
    >
      <div className="flex items-center justify-between">
        <div className="min-w-0 flex-1">
          <div className="text-sm font-medium truncate">
            {shortName(item.name)}
          </div>
          <div className="text-xs text-muted-foreground font-mono truncate">
            {item.authority}
          </div>
        </div>
        <div className="flex items-center gap-1 shrink-0 ml-2">
          {item.exported && (
            <Globe className="h-3.5 w-3.5 text-muted-foreground" />
          )}
        </div>
      </div>
    </button>
  );
}

// --- Query error display ---

function formatError(error: unknown): { message: string; stack?: string } {
  if (error instanceof Error) {
    return { message: error.message, stack: error.stack };
  }
  if (typeof error === "object" && error !== null) {
    const obj = error as Record<string, unknown>;
    const message = typeof obj.message === "string" ? obj.message : "";
    const stack = typeof obj.stack === "string" ? obj.stack : undefined;
    const description = typeof obj.description === "string" ? obj.description : undefined;
    return {
      message: message || description || JSON.stringify(error, null, 2),
      stack,
    };
  }
  return { message: String(error) };
}

function QueryError({ error }: { error: unknown }) {
  const { t } = useTranslation();
  const { message, stack } = formatError(error);

  return (
    <div className="p-4">
      <Alert variant="destructive">
        <AlertTitle>{t("error")}</AlertTitle>
        <AlertDescription className="font-mono text-xs whitespace-pre-wrap mt-2">
          {message}
          {stack && (
            <>
              {"\n\n"}
              {stack}
            </>
          )}
        </AlertDescription>
      </Alert>
    </div>
  );
}

// --- Query results table ---

function ResultsTable({ result }: { result: QueryResult }) {
  const { t } = useTranslation();

  if (result.columns.length === 0) {
    return (
      <div className="text-sm text-muted-foreground p-4">
        {t("query_executed_no_results")}
      </div>
    );
  }

  return (
    <div className="overflow-auto h-full">
      <table className="w-full text-sm border-collapse">
        <thead className="sticky top-0 bg-background z-10">
          <tr>
            {result.columns.map((col) => (
              <th
                key={col}
                className="text-left px-3 py-2 border-b border-border font-medium text-xs text-muted-foreground whitespace-nowrap"
              >
                {col}
              </th>
            ))}
          </tr>
        </thead>
        <tbody>
          {result.rows.map((row, i) => (
            <tr key={i} className="hover:bg-accent">
              {row.map((cell, j) => (
                <td
                  key={j}
                  className="px-3 py-1.5 border-b border-border/50 font-mono text-xs whitespace-nowrap max-w-xs truncate"
                >
                  {cell === null ? (
                    <span className="text-muted-foreground italic">NULL</span>
                  ) : (
                    String(cell)
                  )}
                </td>
              ))}
            </tr>
          ))}
        </tbody>
      </table>
      <div className="text-xs text-muted-foreground p-2 border-t border-border">
        {t("rows_returned", { count: result.rows.length })}
      </div>
    </div>
  );
}

// --- Query pane ---

function QueryPane({
  initialUri,
}: {
  initialUri: string;
}) {
  const { t } = useTranslation();
  const [uri, setUri] = useState(initialUri);
  const [projection, setProjection] = useState("");
  const [selection, setSelection] = useState("");
  const [selectionArgs, setSelectionArgs] = useState("");
  const [sortOrder, setSortOrder] = useState("");

  // Sync URI when provider selection changes
  const [lastInitialUri, setLastInitialUri] = useState(initialUri);
  if (initialUri !== lastInitialUri) {
    setUri(initialUri);
    setLastInitialUri(initialUri);
  }

  const queryMutation = useDroidMutation<
    QueryResult,
    { uri: string; options?: QueryOptions }
  >((api, { uri, options }) => api.provider.query(uri, options));

  const handleExecute = () => {
    if (!uri.trim()) return;

    const options: QueryOptions = {};
    if (projection.trim()) {
      options.projection = projection.split(",").map((s) => s.trim());
    }
    if (selection.trim()) {
      options.selection = selection;
    }
    if (selectionArgs.trim()) {
      options.selectionArgs = selectionArgs.split(",").map((s) => s.trim());
    }
    if (sortOrder.trim()) {
      options.sortOrder = sortOrder;
    }

    queryMutation.mutate(
      { uri: uri.trim(), options: Object.keys(options).length > 0 ? options : undefined },
    );
  };

  return (
    <div className="h-full flex flex-col">
      <div className="p-4 space-y-3 border-b border-border shrink-0">
        <div className="space-y-1.5">
          <Label className="text-xs">Content URI</Label>
          <Input
            placeholder="content://authority/path"
            value={uri}
            onChange={(e) => setUri(e.target.value)}
            className="font-mono text-sm"
            onKeyDown={(e) => { if (e.key === "Enter") handleExecute(); }}
          />
        </div>
        <div className="grid grid-cols-2 gap-3">
          <div className="space-y-1.5">
            <Label className="text-xs">{t("projection")}</Label>
            <Input
              placeholder={t("projection_placeholder")}
              value={projection}
              onChange={(e) => setProjection(e.target.value)}
              className="text-xs"
            />
          </div>
          <div className="space-y-1.5">
            <Label className="text-xs">{t("sort_order")}</Label>
            <Input
              placeholder={t("sort_order_placeholder")}
              value={sortOrder}
              onChange={(e) => setSortOrder(e.target.value)}
              className="text-xs"
            />
          </div>
          <div className="space-y-1.5">
            <Label className="text-xs">{t("selection")}</Label>
            <Input
              placeholder={t("selection_placeholder")}
              value={selection}
              onChange={(e) => setSelection(e.target.value)}
              className="text-xs"
            />
          </div>
          <div className="space-y-1.5">
            <Label className="text-xs">{t("selection_args")}</Label>
            <Input
              placeholder={t("selection_args_placeholder")}
              value={selectionArgs}
              onChange={(e) => setSelectionArgs(e.target.value)}
              className="text-xs"
            />
          </div>
        </div>
        <Button
          size="sm"
          onClick={handleExecute}
          disabled={!uri.trim() || queryMutation.isPending}
        >
          <Play className="h-3.5 w-3.5 mr-1.5" />
          {t("execute")}
        </Button>
      </div>
      <div className="flex-1 min-h-0 overflow-auto">
        {queryMutation.isPending ? (
          <div className="flex items-center justify-center h-full gap-2 text-muted-foreground">
            <Spinner />
            {t("loading")}...
          </div>
        ) : queryMutation.isError ? (
          <QueryError error={queryMutation.error} />
        ) : queryMutation.data ? (
          <ResultsTable result={queryMutation.data} />
        ) : (
          <div className="flex items-center justify-center h-full text-muted-foreground text-sm">
            {t("no_query_results")}
          </div>
        )}
      </div>
    </div>
  );
}

// --- Main tab ---

export function DroidProvidersTab() {
  const { t } = useTranslation();
  const [search, setSearch] = useState("");
  const [selectedAuthority, setSelectedAuthority] = useState<string | null>(null);

  const { data: providers = [], isLoading } = useDroidQuery<ProviderEntry[]>(
    ["providers"],
    (api) => api.provider.list(),
  );

  const filtered = useMemo(() => {
    if (!search.trim()) return providers;
    const query = search.toLowerCase();
    return providers.filter(
      (p) =>
        p.name.toLowerCase().includes(query) ||
        p.authority.toLowerCase().includes(query),
    );
  }, [providers, search]);

  const handleSelect = (authority: string) => {
    setSelectedAuthority(authority);
  };

  const queryUri = selectedAuthority ? `content://${selectedAuthority}/` : "";

  const listPane = (
    <div className="h-full flex flex-col">
      <div className="p-3 space-y-2 border-b border-border">
        <div className="relative">
          <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
          <Input
            placeholder={t("search")}
            value={search}
            onChange={(e) => setSearch(e.target.value)}
            className="pl-9"
          />
        </div>
        <div className="text-xs text-muted-foreground">
          {filtered.length} / {providers.length}
        </div>
      </div>
      <div className="flex-1 min-h-0">
        {isLoading ? (
          <div className="flex items-center justify-center h-full gap-2 text-muted-foreground">
            <Spinner />
            {t("loading")}...
          </div>
        ) : filtered.length === 0 ? (
          <div className="flex items-center justify-center h-full text-muted-foreground">
            {t("no_providers")}
          </div>
        ) : (
          <div className="flex h-full">
            <List
              rowComponent={ProviderRow}
              rowCount={filtered.length}
              rowHeight={ITEM_HEIGHT}
              rowProps={{
                items: filtered,
                selected: selectedAuthority,
                onClick: handleSelect,
              }}
            />
          </div>
        )}
      </div>
    </div>
  );

  return (
    <ResizablePanelGroup
      orientation="horizontal"
      className="h-full"
      autoSaveId="providers-tab-split"
    >
      <ResizablePanel defaultSize="35%" minSize="20%">
        {listPane}
      </ResizablePanel>
      <ResizableHandle withHandle />
      <ResizablePanel>
        <QueryPane initialUri={queryUri} />
      </ResizablePanel>
    </ResizablePanelGroup>
  );
}

```

`gui/src/components/tabs/FileTable.tsx`:

```tsx
import { useState, useRef, useEffect, useCallback } from "react";
import { useTranslation } from "react-i18next";
import {
  Folder,
  File,
  Download,
  Pencil,
  Trash2,
  SquareArrowOutUpRight,
  FileText,
  Binary,
  Database,
  FileJson,
  FileImage,
  Type,
  Check,
  X,
  Loader2,
  Upload,
  RefreshCw,
} from "lucide-react";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Checkbox } from "@/components/ui/checkbox";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
} from "@/components/ui/dialog";
import type { MetaData } from "@agent/fruity/modules/fs";
import { formatSize, formatDate, typeFor } from "../../lib/file-explorer.ts";

interface FileTableProps {
  items: MetaData[];
  isLoading: boolean;
  cwd: string;
  onDownload: (fileName: string) => void;
  onPreview: (fileName: string, type: string) => void;
  onNavigate?: (folderName: string) => void;
  onRename: (oldName: string, newName: string) => Promise<void>;
  onDelete: (fileName: string) => Promise<void>;
  onBatchDelete?: (fileNames: string[]) => Promise<void>;
  onUpload?: () => void;
  onRefresh?: () => void;
  isReadOnly?: boolean;
}

export function FileTable({
  items,
  isLoading,
  cwd,
  onDownload,
  onPreview,
  onNavigate,
  onRename,
  onDelete,
  onBatchDelete,
  onUpload,
  onRefresh,
  isReadOnly,
}: FileTableProps) {
  const { t } = useTranslation();
  const [editingFile, setEditingFile] = useState<string | null>(null);
  const [editValue, setEditValue] = useState("");
  const [isRenaming, setIsRenaming] = useState(false);
  const [deletingFile, setDeletingFile] = useState<string | null>(null);
  const [selectedFiles, setSelectedFiles] = useState<Set<string>>(new Set());
  const [isBatchDeleting, setIsBatchDeleting] = useState(false);
  const [showBatchDeleteDialog, setShowBatchDeleteDialog] = useState(false);
  const inputRef = useRef<HTMLInputElement>(null);

  // Preserve scroll position across dockview tab switches.
  // Dockview hides inactive panels with display:none which resets scrollTop.
  const scrollTopRef = useRef(0);
  const observerRef = useRef<IntersectionObserver | null>(null);

  useEffect(() => {
    scrollTopRef.current = 0;
  }, [cwd]);

  // Clear selection when items change
  useEffect(() => {
    setSelectedFiles(new Set());
  }, [items]);

  const scrollContainerRef = useCallback((el: HTMLDivElement | null) => {
    if (observerRef.current) {
      observerRef.current.disconnect();
      observerRef.current = null;
    }
    if (!el) return;

    el.addEventListener(
      "scroll",
      () => {
        scrollTopRef.current = el.scrollTop;
      },
      { passive: true },
    );

    observerRef.current = new IntersectionObserver((entries) => {
      if (entries[0]?.isIntersecting && scrollTopRef.current > 0) {
        el.scrollTop = scrollTopRef.current;
      }
    });
    observerRef.current.observe(el);

    if (scrollTopRef.current > 0) {
      requestAnimationFrame(() => {
        el.scrollTop = scrollTopRef.current;
      });
    }
  }, []);

  // Focus input when editing starts
  useEffect(() => {
    if (editingFile && inputRef.current) {
      inputRef.current.focus();
      // Select filename without extension
      const dotIndex = editValue.lastIndexOf(".");
      if (dotIndex > 0) {
        inputRef.current.setSelectionRange(0, dotIndex);
      } else {
        inputRef.current.select();
      }
    }
  }, [editingFile, editValue]);

  const startEditing = (fileName: string) => {
    setEditingFile(fileName);
    setEditValue(fileName);
  };

  const cancelEditing = () => {
    setEditingFile(null);
    setEditValue("");
  };

  const confirmRename = async () => {
    if (!editingFile || !editValue.trim() || editValue === editingFile) {
      cancelEditing();
      return;
    }

    setIsRenaming(true);
    try {
      await onRename(editingFile, editValue.trim());
      setEditingFile(null);
      setEditValue("");
    } catch (err) {
      console.error("Failed to rename:", err);
    } finally {
      setIsRenaming(false);
    }
  };

  const handleKeyDown = (e: React.KeyboardEvent) => {
    if (e.key === "Enter") {
      e.preventDefault();
      confirmRename();
    } else if (e.key === "Escape") {
      e.preventDefault();
      cancelEditing();
    }
  };

  const handleDelete = async (fileName: string) => {
    setDeletingFile(fileName);
    try {
      await onDelete(fileName);
    } catch (err) {
      console.error("Failed to delete:", err);
    } finally {
      setDeletingFile(null);
    }
  };

  const toggleSelect = (fileName: string) => {
    setSelectedFiles((prev) => {
      const next = new Set(prev);
      if (next.has(fileName)) {
        next.delete(fileName);
      } else {
        next.add(fileName);
      }
      return next;
    });
  };

  const toggleSelectAll = () => {
    if (selectedFiles.size === items.length) {
      setSelectedFiles(new Set());
    } else {
      setSelectedFiles(new Set(items.map((item) => item.name)));
    }
  };

  const handleBatchDelete = async () => {
    if (!onBatchDelete || selectedFiles.size === 0) return;

    setShowBatchDeleteDialog(false);
    setIsBatchDeleting(true);
    try {
      await onBatchDelete(Array.from(selectedFiles));
      setSelectedFiles(new Set());
    } catch (err) {
      console.error("Failed to batch delete:", err);
    } finally {
      setIsBatchDeleting(false);
    }
  };

  if (isLoading) {
    return (
      <div className="flex flex-col h-full">
        <div className="flex-1 flex items-center justify-center text-muted-foreground">
          <Loader2 className="h-4 w-4 animate-spin mr-2" />
          {t("loading")}
        </div>
        {cwd && (
          <div className="px-2 py-1 text-xs text-muted-foreground border-t">
            {cwd}
          </div>
        )}
      </div>
    );
  }

  if (items.length === 0) {
    return (
      <div className="flex flex-col h-full">
        {(onRefresh || (!isReadOnly && onUpload)) && (
          <div className="flex items-center gap-2 px-2 py-1 border-b">
            {!isReadOnly && onUpload && (
              <Button
                variant="outline"
                size="sm"
                className="h-7 text-xs"
                onClick={onUpload}
              >
                <Upload className="h-3 w-3 mr-1" />
                {t("upload")}
              </Button>
            )}
            {onRefresh && (
              <Button
                variant="outline"
                size="sm"
                className="h-7 text-xs"
                onClick={onRefresh}
              >
                <RefreshCw className="h-3 w-3" />
              </Button>
            )}
          </div>
        )}
        <div className="flex-1 flex items-center justify-center text-muted-foreground">
          {t("empty_directory")}
        </div>
        {cwd && (
          <div className="px-2 py-1 text-xs text-muted-foreground border-t">
            {cwd}
          </div>
        )}
      </div>
    );
  }

  return (
    <div className="flex flex-col h-full">
      {!isReadOnly && (
        <div className="flex items-center gap-2 px-2 py-1 border-b shrink-0">
          <Checkbox
            checked={
              selectedFiles.size === items.length && items.length > 0
            }
            onCheckedChange={toggleSelectAll}
            aria-label={t("select_all")}
          />
          {selectedFiles.size > 0 && (
            <>
              <span className="text-xs text-muted-foreground">
                {t("selected_count", { count: selectedFiles.size })}
              </span>
              <Button
                variant="outline"
                size="sm"
                className="h-7 text-xs text-destructive hover:text-destructive"
                disabled={isBatchDeleting}
                onClick={() => setShowBatchDeleteDialog(true)}
              >
                {isBatchDeleting ? (
                  <Loader2 className="h-3 w-3 animate-spin mr-1" />
                ) : (
                  <Trash2 className="h-3 w-3 mr-1" />
                )}
                {t("batch_delete")}
              </Button>
              <Dialog
                open={showBatchDeleteDialog}
                onOpenChange={setShowBatchDeleteDialog}
              >
                <DialogContent>
                  <DialogHeader>
                    <DialogTitle>{t("batch_delete")}</DialogTitle>
                    <DialogDescription>
                      {t("batch_delete_confirm", {
                        count: selectedFiles.size,
                      })}
                      {" "}
                      {t("batch_delete_warning")}
                    </DialogDescription>
                  </DialogHeader>
                  <DialogFooter>
                    <Button
                      variant="outline"
                      onClick={() => setShowBatchDeleteDialog(false)}
                    >
                      {t("cancel")}
                    </Button>
                    <Button
                      variant="destructive"
                      onClick={handleBatchDelete}
                    >
                      {t("delete")}
                    </Button>
                  </DialogFooter>
                </DialogContent>
              </Dialog>
            </>
          )}
          {(onUpload || onRefresh) && (
            <div className="flex items-center gap-2 ml-auto">
              {onUpload && (
                <Button
                  variant="outline"
                  size="sm"
                  className="h-7 text-xs"
                  onClick={onUpload}
                >
                  <Upload className="h-3 w-3 mr-1" />
                  {t("upload")}
                </Button>
              )}
              {onRefresh && (
                <Button
                  variant="outline"
                  size="sm"
                  className="h-7 text-xs"
                  onClick={onRefresh}
                >
                  <RefreshCw className="h-3 w-3" />
                </Button>
              )}
            </div>
          )}
        </div>
      )}
      <div ref={scrollContainerRef} className="flex-1 overflow-auto">
        <Table>
          <TableHeader>
            <TableRow>
              {!isReadOnly && <TableHead className="w-8"></TableHead>}
              <TableHead className="w-8"></TableHead>
              <TableHead>{t("name")}</TableHead>
              <TableHead className="w-32"></TableHead>
              <TableHead className="w-24 text-right">{t("size")}</TableHead>
              <TableHead className="w-48">{t("modified")}</TableHead>
              <TableHead className="w-4"></TableHead>
            </TableRow>
          </TableHeader>
          <TableBody>
            {items.map((item) => {
              const isFolder = item.dir;
              const isEditing = editingFile === item.name;
              const isDeleting = deletingFile === item.name;

              return (
                <TableRow key={item.name} className="group">
                  {!isReadOnly && (
                    <TableCell>
                      <Checkbox
                        checked={selectedFiles.has(item.name)}
                        onCheckedChange={() => toggleSelect(item.name)}
                      />
                    </TableCell>
                  )}
                  <TableCell>
                    {isFolder ? (
                      <Folder className="w-4 h-4 text-yellow-500" />
                    ) : (
                      <File className="w-4 h-4 text-muted-foreground" />
                    )}
                  </TableCell>
                  <TableCell className="font-mono text-sm">
                    {isEditing ? (
                      <div className="flex items-center gap-1">
                        <Input
                          ref={inputRef}
                          value={editValue}
                          onChange={(e) => setEditValue(e.target.value)}
                          onKeyDown={handleKeyDown}
                          className="h-7 text-sm font-mono"
                          disabled={isRenaming}
                        />
                        <Button
                          variant="ghost"
                          size="icon"
                          className="h-7 w-7 text-green-600 shrink-0"
                          onClick={confirmRename}
                          disabled={isRenaming}
                          title={t("confirm")}
                        >
                          {isRenaming ? (
                            <Loader2 className="h-4 w-4 animate-spin" />
                          ) : (
                            <Check className="h-4 w-4" />
                          )}
                        </Button>
                        <Button
                          variant="ghost"
                          size="icon"
                          className="h-7 w-7 shrink-0"
                          onClick={cancelEditing}
                          disabled={isRenaming}
                          title={t("cancel")}
                        >
                          <X className="h-4 w-4" />
                        </Button>
                      </div>
                    ) : isFolder ? (
                      <button
                        type="button"
                        onClick={() => onNavigate?.(item.name)}
                        className="hover:text-amber-600 dark:hover:text-amber-400 hover:underline"
                      >
                        {item.name}
                      </button>
                    ) : (
                      <button
                        type="button"
                        onClick={() => onPreview(item.name, typeFor(item.name))}
                        className="hover:text-amber-600 dark:hover:text-amber-400 hover:underline"
                      >
                        {item.name}
                      </button>
                    )}
                  </TableCell>
                  <TableCell>
                    {!isEditing && (
                      <div className="flex gap-1">
                        {isFolder ? (
                          <div className="h-7 w-7" />
                        ) : (
                          <Button
                            variant="ghost"
                            size="icon"
                            className="h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity"
                            onClick={() => onDownload(item.name)}
                            title={t("download")}
                          >
                            <Download className="h-4 w-4" />
                          </Button>
                        )}
                        {!isReadOnly && (
                          <Button
                            variant="ghost"
                            size="icon"
                            className="h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity"
                            onClick={() => startEditing(item.name)}
                            title={t("rename")}
                          >
                            <Pencil className="h-4 w-4" />
                          </Button>
                        )}
                        {!isFolder && (
                          <DropdownMenu>
                            <DropdownMenuTrigger
                              render={
                                <Button
                                  variant="ghost"
                                  size="icon"
                                  className="h-7 w-7"
                                  title={t("open_with")}
                                />
                              }
                            >
                              <SquareArrowOutUpRight className="h-4 w-4" />
                            </DropdownMenuTrigger>
                            <DropdownMenuContent align="start" className="min-w-44">
                              <DropdownMenuItem
                                onClick={() => onPreview(item.name, "text")}
                              >
                                <FileText className="mr-2 h-4 w-4" />
                                {t("text_editor")}
                              </DropdownMenuItem>
                              <DropdownMenuItem
                                onClick={() => onPreview(item.name, "hex")}
                              >
                                <Binary className="mr-2 h-4 w-4" />
                                {t("hex_view")}
                              </DropdownMenuItem>
                              <DropdownMenuItem
                                onClick={() => onPreview(item.name, "sqlite")}
                              >
                                <Database className="mr-2 h-4 w-4" />
                                {t("sqlite_editor")}
                              </DropdownMenuItem>
                              <DropdownMenuItem
                                onClick={() => onPreview(item.name, "image")}
                              >
                                <FileImage className="mr-2 h-4 w-4" />
                                {t("image_preview")}
                              </DropdownMenuItem>
                              <DropdownMenuItem
                                onClick={() => onPreview(item.name, "plist")}
                              >
                                <FileJson className="mr-2 h-4 w-4" />
                                {t("plist_preview")}
                              </DropdownMenuItem>
                              <DropdownMenuItem
                                onClick={() => onPreview(item.name, "font")}
                              >
                                <Type className="mr-2 h-4 w-4" />
                                {t("font_preview")}
                              </DropdownMenuItem>
                            </DropdownMenuContent>
                          </DropdownMenu>
                        )}
                      </div>
                    )}
                  </TableCell>
                  <TableCell className="text-right text-sm">
                    {isFolder ? "-" : formatSize(item.size)}
                  </TableCell>
                  <TableCell className="text-sm text-muted-foreground">
                    {formatDate(item.created)}
                  </TableCell>
                  <TableCell>
                    {!isReadOnly && (
                      <DropdownMenu>
                        <DropdownMenuTrigger
                          render={
                            <Button
                              variant="ghost"
                              size="icon"
                              className="h-7 w-7 text-destructive hover:text-destructive"
                              title={t("delete")}
                              disabled={isDeleting}
                            />
                          }
                        >
                          {isDeleting ? (
                            <Loader2 className="h-4 w-4 animate-spin" />
                          ) : (
                            <Trash2 className="h-4 w-4" />
                          )}
                        </DropdownMenuTrigger>
                        <DropdownMenuContent align="start">
                          <DropdownMenuItem
                            onClick={() => handleDelete(item.name)}
                            className="text-destructive focus:text-destructive"
                          >
                            {t("delete")}
                          </DropdownMenuItem>
                        </DropdownMenuContent>
                      </DropdownMenu>
                    )}
                  </TableCell>
                </TableRow>
              );
            })}
          </TableBody>
        </Table>
      </div>
      {cwd && (
        <div className="px-2 py-1 text-xs text-muted-foreground border-t shrink-0">
          {cwd}
        </div>
      )}
    </div>
  );
}

```

`gui/src/components/tabs/FinderTab.tsx`:

```tsx
import { useCallback, useEffect, useRef, useState } from "react";
import { useTranslation } from "react-i18next";
import type { IDockviewPanelProps } from "dockview";
import { toast } from "sonner";
import { useMutation } from "@tanstack/react-query";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import {
  ResizablePanelGroup,
  ResizablePanel,
  ResizableHandle,
} from "@/components/ui/resizable";
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
} from "@/components/ui/dialog";
import { Progress } from "@/components/ui/progress";
import { Mode, Platform, Status, useSession } from "@/context/SessionContext";
import { useDock } from "@/context/DockContext";
import { useFruityMutation, useDroidMutation } from "@/lib/queries";
import { DirectoryTree } from "./DirectoryTree";
import { FileTable } from "./FileTable";
import type { FinderTabParams, UploadFile } from "../../lib/file-explorer.ts";

export type { FinderTabParams };

// Recursively read all files from a FileSystemDirectoryEntry
function readAllEntries(
  dirEntry: FileSystemDirectoryEntry,
  basePath: string,
): Promise<{ file: File; relativePath: string }[]> {
  return new Promise((resolve, reject) => {
    const reader = dirEntry.createReader();
    const results: Promise<{ file: File; relativePath: string }[]>[] = [];

    function readBatch() {
      reader.readEntries((entries) => {
        if (entries.length === 0) {
          Promise.all(results)
            .then((arrays) => resolve(arrays.flat()))
            .catch(reject);
          return;
        }
        for (const entry of entries) {
          const entryPath = basePath ? `${basePath}/${entry.name}` : entry.name;
          if (entry.isDirectory) {
            results.push(
              readAllEntries(entry as FileSystemDirectoryEntry, entryPath),
            );
          } else if (entry.isFile) {
            results.push(
              new Promise((res, rej) => {
                (entry as FileSystemFileEntry).file(
                  (file) => res([{ file, relativePath: entryPath }]),
                  rej,
                );
              }),
            );
          }
        }
        readBatch();
      }, reject);
    }
    readBatch();
  });
}

export function FinderTab({ params }: IDockviewPanelProps<FinderTabParams>) {
  const { fruity, droid, status, pid, device, platform, mode, identifier } =
    useSession();
  const { t } = useTranslation();
  const { openSingletonPanel } = useDock();
  const isDroid = platform === Platform.Droid;
  const isDaemon = mode === Mode.Daemon;

  const storageKey =
    device && identifier ? `finder-state:${device}:${identifier}` : null;

  const initialPath = params?.path || "~";
  const defaultTab = initialPath === "!" ? "bundle" : "home";

  // Restore saved state from localStorage (scoped to device + app)
  const [savedState] = useState(() => {
    if (!storageKey) return null;
    try {
      return JSON.parse(localStorage.getItem(storageKey) || "{}");
    } catch {
      return null;
    }
  });
  const [activeTab, setActiveTab] = useState<"home" | "bundle">(() => {
    if (savedState?.activeTab === "home" || savedState?.activeTab === "bundle")
      return savedState.activeTab;
    return defaultTab;
  });
  const [initialSavedCwd] = useState<string | null>(
    () => savedState?.fullCwd || null,
  );
  const restoredRef = useRef(false);
  const fileInputRef = useRef<HTMLInputElement>(null);
  const uploadAbortRef = useRef(false);

  const [items, setItems] = useState<
    import("@agent/fruity/modules/fs").MetaData[]
  >([]);
  const [isLoading, setIsLoading] = useState(false);

  const [fullCwd, setFullCwd] = useState<string | null>(null);
  const [cwdWritable, setCwdWritable] = useState(false);
  const [uploadOpen, setUploadOpen] = useState(false);
  const [uploadFiles, setUploadFiles] = useState<UploadFile[]>([]);
  const [isDragOver, setIsDragOver] = useState(false);
  const fsApi = isDroid ? droid : fruity;
  const apiReady = status === Status.Ready && !!fsApi;

  const [roots, setRoots] = useState<{
    home: string;
    bundle: string;
  } | null>(null);

  const loadDirectory = useCallback(
    async (
      path: string,
    ): Promise<import("@agent/fruity/modules/fs").DirectoryListing> => {
      if (!fsApi) return { cwd: "", writable: false, list: [] };
      return fsApi.fs.ls(path);
    },
    [fsApi],
  );

  const fruityRenameMutation = useFruityMutation<
    boolean,
    { src: string; dst: string }
  >((api, { src, dst }) => api.fs.mv(src, dst));

  const fruityDeleteMutation = useFruityMutation<boolean, { path: string }>(
    (api, { path }) => api.fs.rm(path),
  );

  const droidRenameMutation = useDroidMutation<
    boolean,
    { src: string; dst: string }
  >((api, { src, dst }) => api.fs.mv(src, dst));

  const droidDeleteMutation = useDroidMutation<boolean, { path: string }>(
    (api, { path }) => api.fs.rm(path),
  );

  const renameMutation = isDroid ? droidRenameMutation : fruityRenameMutation;
  const deleteMutation = isDroid ? droidDeleteMutation : fruityDeleteMutation;

  const handleDirectorySelect = useCallback(
    (path: string) => {
      setIsLoading(true);
      loadDirectory(path)
        .then(({ cwd, writable, list }) => {
          const data = [...list].sort((a, b) => {
            if (a.dir !== b.dir) return a.dir ? -1 : 1;
            return a.name.localeCompare(b.name);
          });
          setFullCwd(cwd);
          setCwdWritable(writable);
          setItems(data);
        })
        .catch(() => {
          setItems([]);
        })
        .finally(() => setIsLoading(false));
    },
    [loadDirectory],
  );

  const handleDownload = useCallback(
    (fileName: string) => {
      if (pid === undefined || fullCwd === null) return;

      const url = new URL(window.location.href);
      url.pathname = `/api/download/${device}/${pid}`;
      url.searchParams.set("path", `${fullCwd}/${fileName}`);
      location.replace(url.toString());
    },
    [pid, device, fullCwd],
  );

  const handlePreview = useCallback(
    (fileName: string, type: string) => {
      const fullPath = `${fullCwd}/${fileName}`;
      const panelId = `preview-${fileName}`;

      const componentMap: Record<string, string> = {
        hex: "hexPreview",
        text: "textEditor",
        sqlite: "sqliteEditor",
        image: "imagePreview",
        plist: "plistPreview",
        font: "fontPreview",
      };

      const component = componentMap[type];
      if (!component) return;

      openSingletonPanel({
        id: panelId,
        component,
        title: fileName,
        params: { path: fullPath },
      });
    },
    [fullCwd, openSingletonPanel],
  );

  const handleRename = useCallback(
    async (oldName: string, newName: string) => {
      if (!fullCwd) return;

      const src = `${fullCwd}/${oldName}`;
      const dst = `${fullCwd}/${newName}`;

      await renameMutation.mutateAsync({ src, dst });
      toast.success(t("file_renamed"));
      // Refresh directory listing
      handleDirectorySelect(fullCwd);
    },
    [fullCwd, renameMutation, t, handleDirectorySelect],
  );

  const handleDelete = useCallback(
    async (fileName: string) => {
      if (!fullCwd) return;

      const path = `${fullCwd}/${fileName}`;

      await deleteMutation.mutateAsync({ path });
      toast.success(t("file_deleted"));
      // Refresh directory listing
      handleDirectorySelect(fullCwd);
    },
    [fullCwd, deleteMutation, t, handleDirectorySelect],
  );

  const uploadFileMutation = useMutation({
    mutationFn: async ({
      file,
      targetPath,
    }: {
      file: File;
      targetPath: string;
    }) => {
      const formData = new FormData();
      formData.append("path", targetPath);
      formData.append("file", file);

      const url = new URL(window.location.href);
      url.pathname = `/api/upload/${device}/${pid}`;
      const response = await fetch(url.toString(), {
        method: "POST",
        body: formData,
      });

      if (!response.ok) {
        throw new Error(await response.text());
      }
    },
  });

  const uploadFileList = useCallback(
    async (entries: { file: File; targetPath: string }[]) => {
      if (entries.length === 0 || !fullCwd) return;

      const newFiles: UploadFile[] = entries.map((e) => ({
        name: e.targetPath.replace(`${fullCwd}/`, ""),
        progress: 0,
      }));
      setUploadFiles(newFiles);
      setUploadOpen(true);
      uploadAbortRef.current = false;

      for (let i = 0; i < entries.length; i++) {
        if (uploadAbortRef.current) break;
        const { file, targetPath } = entries[i];
        try {
          await uploadFileMutation.mutateAsync({ file, targetPath });
          setUploadFiles((prev) =>
            prev.map((f, idx) => (idx === i ? { ...f, progress: 100 } : f)),
          );
        } catch (err) {
          setUploadFiles((prev) =>
            prev.map((f, idx) =>
              idx === i
                ? { ...f, progress: 0, error: (err as Error).message }
                : f,
            ),
          );
        }
      }

      setTimeout(() => {
        setUploadOpen(false);
        handleDirectorySelect(fullCwd);
      }, 500);
    },
    [fullCwd, handleDirectorySelect, uploadFileMutation],
  );

  const handleDrop = useCallback(
    async (e: React.DragEvent) => {
      e.preventDefault();
      setIsDragOver(false);
      if (!cwdWritable || !pid || !device || !fullCwd) return;

      // Try webkitGetAsEntry for folder support
      const dataItems = Array.from(e.dataTransfer.items);
      const allEntries: { file: File; targetPath: string }[] = [];
      let usedEntryApi = false;

      for (const item of dataItems) {
        const entry = item.webkitGetAsEntry?.();
        if (entry) {
          usedEntryApi = true;
          if (entry.isDirectory) {
            const dirFiles = await readAllEntries(
              entry as FileSystemDirectoryEntry,
              entry.name,
            );
            for (const { file, relativePath } of dirFiles) {
              allEntries.push({
                file,
                targetPath: `${fullCwd}/${relativePath}`,
              });
            }
          } else if (entry.isFile) {
            const file = await new Promise<File>((resolve, reject) => {
              (entry as FileSystemFileEntry).file(resolve, reject);
            });
            allEntries.push({
              file,
              targetPath: `${fullCwd}/${file.name}`,
            });
          }
        }
      }

      // Fallback to plain files if webkitGetAsEntry not available
      if (!usedEntryApi) {
        const files = Array.from(e.dataTransfer.files);
        for (const file of files) {
          allEntries.push({
            file,
            targetPath: `${fullCwd}/${file.name}`,
          });
        }
      }

      if (allEntries.length === 0) return;
      await uploadFileList(allEntries);
    },
    [cwdWritable, pid, device, fullCwd, uploadFileList],
  );

  const handleBatchDelete = useCallback(
    async (fileNames: string[]) => {
      if (!fullCwd) return;

      for (const fileName of fileNames) {
        const path = `${fullCwd}/${fileName}`;
        await deleteMutation.mutateAsync({ path });
      }
      toast.success(t("file_deleted"));
      handleDirectorySelect(fullCwd);
    },
    [fullCwd, deleteMutation, t, handleDirectorySelect],
  );

  const handleNavigate = useCallback(
    (folderName: string) => {
      if (!fullCwd) return;
      handleDirectorySelect(`${fullCwd}/${folderName}`);
    },
    [fullCwd, handleDirectorySelect],
  );

  const handleUpload = useCallback(() => {
    fileInputRef.current?.click();
  }, []);

  const handleFileInputChange = useCallback(
    async (e: React.ChangeEvent<HTMLInputElement>) => {
      const files = e.target.files;
      if (!files || files.length === 0 || !fullCwd) return;

      const entries = Array.from(files).map((file) => ({
        file,
        targetPath: `${fullCwd}/${file.name}`,
      }));
      await uploadFileList(entries);

      // Reset input so the same files can be re-selected
      e.target.value = "";
    },
    [fullCwd, uploadFileList],
  );

  useEffect(() => {
    if (!apiReady) return;
    fsApi.fs.roots().then(setRoots);
  }, [apiReady, fsApi]);

  useEffect(() => {
    if (!apiReady || !roots) return;

    // Absolute path from params takes priority
    if (params?.path?.startsWith("/")) {
      if (params.path.startsWith(roots.bundle)) {
        setActiveTab("bundle");
      } else {
        setActiveTab("home");
      }
      handleDirectorySelect(params.path);
      return;
    }

    // On first load, restore saved directory from localStorage
    if (!restoredRef.current && initialSavedCwd) {
      restoredRef.current = true;
      handleDirectorySelect(initialSavedCwd);
      return;
    }
    restoredRef.current = true;

    handleDirectorySelect(activeTab === "bundle" ? roots.bundle : roots.home);
  }, [apiReady, roots, activeTab, handleDirectorySelect, initialSavedCwd, params?.path]);

  // Persist finder state to localStorage
  useEffect(() => {
    if (!storageKey || !fullCwd) return;
    try {
      localStorage.setItem(storageKey, JSON.stringify({ activeTab, fullCwd }));
    } catch {
      localStorage.removeItem(storageKey);
    }
  }, [storageKey, activeTab, fullCwd]);

  const isReadOnly = !cwdWritable;

  return (
    <>
      <input
        ref={fileInputRef}
        type="file"
        multiple
        className="hidden"
        onChange={handleFileInputChange}
      />
      <ResizablePanelGroup orientation="horizontal" autoSaveId="finder-split">
        <ResizablePanel defaultSize="15%" minSize="5%" maxSize="80%">
          <Tabs
            value={activeTab}
            onValueChange={(v) => setActiveTab(v as "bundle" | "home")}
            className="h-full flex flex-col"
          >
            <TabsList variant="line" className="w-full">
              <TabsTrigger value="home" className="flex-1">
                {t("home")}
              </TabsTrigger>
              {!isDaemon && (
                <TabsTrigger value="bundle" className="flex-1">
                  {isDroid ? "APK" : t("bundle")}
                </TabsTrigger>
              )}
            </TabsList>
            {!isDaemon && (
              <TabsContent
                value="bundle"
                className="flex-1 overflow-hidden mt-0"
              >
                {roots && (
                  <DirectoryTree
                    root="!"
                    rootPath={roots.bundle}
                    apiReady={apiReady}
                    loadDirectory={loadDirectory}
                    onDirectorySelect={handleDirectorySelect}
                    currentPath={activeTab === "bundle" ? fullCwd : null}
                  />
                )}
              </TabsContent>
            )}
            <TabsContent value="home" className="flex-1 overflow-hidden mt-0">
              {roots && (
                <DirectoryTree
                  root="~"
                  rootPath={roots.home}
                  apiReady={apiReady}
                  loadDirectory={loadDirectory}
                  onDirectorySelect={handleDirectorySelect}
                  currentPath={activeTab === "home" ? fullCwd : null}
                />
              )}
            </TabsContent>
          </Tabs>
        </ResizablePanel>
        <ResizableHandle withHandle />
        <ResizablePanel defaultSize="85%">
          <div
            className="h-full relative"
            onDragOver={(e) => {
              e.preventDefault();
              if (cwdWritable) setIsDragOver(true);
            }}
            onDragLeave={() => setIsDragOver(false)}
            onDrop={handleDrop}
          >
            {isDragOver && (
              <div className="absolute inset-0 bg-primary/10 flex items-center justify-center z-10 border-2 border-dashed border-primary">
                <span className="text-primary font-medium">
                  {t("drop_files_here")}
                </span>
              </div>
            )}
            <FileTable
              items={items}
              isLoading={isLoading}
              cwd={fullCwd!}
              onDownload={handleDownload}
              onPreview={handlePreview}
              onNavigate={handleNavigate}
              onRename={handleRename}
              onDelete={handleDelete}
              onBatchDelete={handleBatchDelete}
              onUpload={!isReadOnly ? handleUpload : undefined}
              onRefresh={
                fullCwd ? () => handleDirectorySelect(fullCwd) : undefined
              }
              isReadOnly={isReadOnly}
            />
          </div>
        </ResizablePanel>
      </ResizablePanelGroup>
      <Dialog
        open={uploadOpen}
        onOpenChange={(open) => {
          if (!open) uploadAbortRef.current = true;
          setUploadOpen(open);
        }}
      >
        <DialogContent>
          <DialogHeader>
            <DialogTitle>{t("uploading")}</DialogTitle>
          </DialogHeader>
          <div className="space-y-3 max-h-80 overflow-auto">
            {uploadFiles.map((file) => (
              <div key={file.name} className="space-y-1">
                <div className="flex justify-between text-sm">
                  <span className="truncate max-w-[200px]">{file.name}</span>
                  {file.error ? (
                    <span className="text-destructive text-xs">
                      {file.error}
                    </span>
                  ) : (
                    <span className="text-xs text-muted-foreground">
                      {file.progress === 100
                        ? t("completed")
                        : `${file.progress}%`}
                    </span>
                  )}
                </div>
                <Progress value={file.progress} />
              </div>
            ))}
          </div>
        </DialogContent>
      </Dialog>
    </>
  );
}

```

`gui/src/components/tabs/FlutterMethodChannelsTab.tsx`:

```tsx
import { useEffect, useMemo, useRef, useState } from "react";
import { useQuery, useMutation } from "@tanstack/react-query";
import { useTranslation } from "react-i18next";
import { type ColumnDef } from "@tanstack/react-table";

import { Trash2, Play, Square, Loader2, ChevronsDown } from "lucide-react";

import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { Checkbox } from "@/components/ui/checkbox";
import { Input } from "@/components/ui/input";
import {
  ResizableHandle,
  ResizablePanel,
  ResizablePanelGroup,
} from "@/components/ui/resizable";
import { LogTable } from "@/components/shared/LogTable";
import { Status, Platform, useSession } from "@/context/SessionContext";
import { useLogStream } from "@/hooks/useLogStream";
import { toTime } from "@/lib/format";

const TAP_ID = "flutter";

interface FlutterEvent {
  type: "method" | "event" | "message";
  dir: "native" | "dart";
  channel: string;
  method?: string;
  args?: unknown;
  result?: unknown;
}

interface FlutterEntry {
  id: number;
  timestamp: Date;
  channel: string;
  method: string;
  direction: "dart" | "native";
  type: "method" | "event" | "message";
  event: FlutterEvent;
}

function toEntry(event: FlutterEvent, timestamp: Date, id: number): FlutterEntry {
  return {
    id,
    timestamp,
    channel: event.channel ?? "<unknown>",
    method: event.method ?? "-",
    direction: event.dir === "native" ? "native" : "dart",
    type: event.type ?? "method",
    event,
  };
}

function preview(value: unknown): string {
  if (value === null || value === undefined) return "";
  if (typeof value === "string")
    return value.length > 96 ? `${value.slice(0, 96)}...` : value;
  if (typeof value === "number" || typeof value === "boolean")
    return `${value}`;
  if (Array.isArray(value)) return `[${value.length} items]`;
  if (typeof value === "object") {
    const keys = Object.keys(value);
    if (keys.length === 0) return "{}";
    return `{${keys.slice(0, 4).join(", ")}${keys.length > 4 ? ", ..." : ""}}`;
  }
  return `${value}`;
}

function formatJson(value: unknown): string {
  if (value === undefined) return "";
  if (typeof value === "string") return value;
  try {
    return JSON.stringify(value, null, 2);
  } catch {
    return `${value}`;
  }
}

const mapHistory = (record: Record<string, unknown>, id: number): FlutterEntry => {
  const data = record.data as Record<string, unknown> | undefined;
  const event: FlutterEvent = {
    type: (record.type as FlutterEvent["type"]) ?? "method",
    dir: (record.direction as FlutterEvent["dir"]) ?? "dart",
    channel: record.channel as string,
    ...data,
  };
  return toEntry(event, new Date(record.timestamp as string), id);
};

const mapSocket = (id: number, ...args: unknown[]): FlutterEntry =>
  toEntry(args[0] as FlutterEvent, new Date(), id);

const columns: ColumnDef<FlutterEntry>[] = [
  {
    id: "timestamp",
    header: "Time",
    size: 96,
    cell: ({ row }) => (
      <span className="font-mono text-muted-foreground">
        {toTime(row.original.timestamp)}
      </span>
    ),
  },
  {
    id: "direction",
    header: "Dir",
    size: 80,
    cell: ({ row }) => (
      <Badge
        variant={row.original.direction === "dart" ? "default" : "secondary"}
        className="h-5 px-1.5 text-[10px]"
      >
        {row.original.direction === "dart" ? "\u2192 Native" : "\u2192 Dart"}
      </Badge>
    ),
  },
  {
    accessorKey: "channel",
    header: "Channel",
    size: 240,
    cell: ({ getValue }) => (
      <span className="font-mono truncate" title={getValue<string>()}>
        {getValue<string>()}
      </span>
    ),
  },
  {
    accessorKey: "method",
    header: "Method",
    size: 180,
    cell: ({ getValue }) => (
      <span className="font-mono truncate" title={getValue<string>()}>
        {getValue<string>()}
      </span>
    ),
  },
  {
    id: "args",
    header: "Args",
    size: 200,
    cell: ({ row }) => {
      const text = preview(row.original.event.args);
      return (
        <span className="text-muted-foreground truncate" title={text}>
          {text || "--"}
        </span>
      );
    },
  },
];

export function FlutterMethodChannelsTab() {
  const { t } = useTranslation();
  const { platform, status, device, identifier, fruity, droid } = useSession();

  const api = platform === Platform.Fruity ? fruity : droid;

  const [isActive, setIsActive] = useState<boolean | null>(null);
  const [searchFilter, setSearchFilter] = useState("");
  const [showDart, setShowDart] = useState(true);
  const [showNative, setShowNative] = useState(true);
  const tableContainerRef = useRef<HTMLDivElement>(null);

  // Check if flutter is available
  const { data: flutterAvailable, isLoading: flutterLoading } = useQuery({
    queryKey: ["flutterAvailable", platform, device],
    queryFn: () => api!.taps.available(TAP_ID),
    enabled: status === Status.Ready && !!api,
    staleTime: Infinity,
    gcTime: 0,
    retry: false,
  });

  const {
    entries,
    selectedId,
    setSelectedId,
    clear,
    clearMutation,
  } = useLogStream<FlutterEntry>({
    event: "flutter",
    path: "history/flutter",
    key: "logs",
    fromRecord: mapHistory,
    fromEvent: mapSocket,
    enabled: !!flutterAvailable,
  });

  // Sync initial active state from agent
  const { data: initialActive } = useQuery({
    queryKey: ["flutterActive", platform, device],
    queryFn: () => api!.taps.active(TAP_ID),
    enabled: status === Status.Ready && !!api,
  });

  useEffect(() => {
    if (initialActive !== undefined && isActive === null)
      setIsActive(initialActive);
  }, [initialActive, isActive]);

  // Reset active state on session change
  useEffect(() => {
    setIsActive(false);
  }, [platform, device, identifier]);

  // Toggle start/stop
  const toggleMutation = useMutation({
    mutationFn: async (enable: boolean) => {
      if (!api) return;
      if (enable) {
        await api.taps.start(TAP_ID);
      } else {
        await api.taps.stop(TAP_ID);
      }
    },
    onSuccess: (_, enable) => {
      setIsActive(enable);
    },
  });

  // Filter entries
  const filteredEntries = useMemo(() => {
    const q = searchFilter.trim().toLowerCase();
    return entries.filter((e) => {
      if (e.direction === "dart" && !showDart) return false;
      if (e.direction === "native" && !showNative) return false;
      if (
        q &&
        !e.channel.toLowerCase().includes(q) &&
        !e.method.toLowerCase().includes(q)
      )
        return false;
      return true;
    });
  }, [entries, searchFilter, showDart, showNative]);

  const selectedEntry = useMemo(
    () => filteredEntries.find((e) => e.id === selectedId) ?? null,
    [filteredEntries, selectedId],
  );

  const notReady =
    status !== Status.Ready || flutterLoading || !flutterAvailable;

  return (
    <ResizablePanelGroup
      orientation="horizontal"
      className="h-full"
      autoSaveId="flutter-split"
    >
      {/* Left: toolbar + event list */}
      <ResizablePanel defaultSize="65%" minSize="30%">
        <div className="h-full flex flex-col overflow-hidden">
          {/* Toolbar */}
          <div className="flex items-center gap-2 p-2 border-b shrink-0">
            {isActive ? (
              <Button
                variant="outline"
                size="sm"
                className="h-8 px-2.5 text-xs text-red-500 hover:text-red-600"
                onClick={() => toggleMutation.mutate(false)}
                disabled={notReady || toggleMutation.isPending || !api}
              >
                {toggleMutation.isPending ? (
                  <Loader2 className="w-3.5 h-3.5 animate-spin" />
                ) : (
                  <Square className="w-3.5 h-3.5" />
                )}
                Stop
              </Button>
            ) : (
              <Button
                variant="outline"
                size="sm"
                className="h-8 px-2.5 text-xs text-green-600 hover:text-green-700"
                onClick={() => toggleMutation.mutate(true)}
                disabled={notReady || toggleMutation.isPending || !api}
              >
                {toggleMutation.isPending ? (
                  <Loader2 className="w-3.5 h-3.5 animate-spin" />
                ) : (
                  <Play className="w-3.5 h-3.5" />
                )}
                Start
              </Button>
            )}
            <Input
              value={searchFilter}
              onChange={(e) => setSearchFilter(e.target.value)}
              placeholder={t("search")}
              className="h-8 max-w-xs"
            />
            <label className="flex items-center gap-1.5 text-sm shrink-0">
              <Checkbox checked={showDart} onCheckedChange={setShowDart} />
              {"\u2192 Native"}
            </label>
            <label className="flex items-center gap-1.5 text-sm shrink-0">
              <Checkbox checked={showNative} onCheckedChange={setShowNative} />
              {"\u2192 Dart"}
            </label>
            <span className="text-xs text-muted-foreground ml-auto">
              {filteredEntries.length} event
              {filteredEntries.length !== 1 ? "s" : ""}
            </span>
            <Button
              variant="ghost"
              size="icon"
              className="h-8 w-8"
              onClick={() =>
                tableContainerRef.current?.scrollTo({
                  top: tableContainerRef.current.scrollHeight,
                  behavior: "smooth",
                })
              }
            >
              <ChevronsDown className="w-4 h-4" />
            </Button>
            <Button
              variant="ghost"
              size="icon"
              className="h-8 w-8 text-red-500 hover:text-red-600 hover:bg-red-100 dark:hover:bg-red-950/30"
              onClick={clear}
              disabled={clearMutation.isPending || entries.length === 0}
            >
              <Trash2 className="w-4 h-4" />
            </Button>
          </div>

          {/* Virtualized table */}
          <LogTable
            data={filteredEntries}
            columns={columns}
            selectedId={selectedId}
            onSelect={setSelectedId}
            scrollRef={tableContainerRef}
          />
        </div>
      </ResizablePanel>

      <ResizableHandle />

      {/* Right: detail panel */}
      <ResizablePanel defaultSize="35%" minSize="15%">
        <div className="h-full overflow-auto p-3 text-xs">
          {!selectedEntry ? (
            <div className="h-full flex items-center justify-center text-muted-foreground">
              {t("flutter_select_event")}
            </div>
          ) : (
            <div className="space-y-3">
              <div className="space-y-1">
                <div>
                  <span className="text-muted-foreground">{t("time")}: </span>
                  {toTime(selectedEntry.timestamp)}
                </div>
                <div>
                  <span className="text-muted-foreground">
                    {t("flutter_channel")}:{" "}
                  </span>
                  {selectedEntry.channel}
                </div>
                <div>
                  <span className="text-muted-foreground">{t("method")}: </span>
                  {selectedEntry.method}
                </div>
                <div>
                  <span className="text-muted-foreground">
                    {t("hook_direction")}:{" "}
                  </span>
                  {selectedEntry.direction === "dart"
                    ? "\u2192 Native"
                    : "\u2192 Dart"}
                </div>
              </div>

              <div>
                <div className="text-muted-foreground mb-1">args</div>
                <pre className="rounded border bg-muted/20 p-2 overflow-auto max-h-40 whitespace-pre-wrap break-all">
                  {formatJson(selectedEntry.event.args) || "-"}
                </pre>
              </div>

              <div>
                <div className="text-muted-foreground mb-1">result</div>
                <pre className="rounded border bg-muted/20 p-2 overflow-auto max-h-40 whitespace-pre-wrap break-all">
                  {formatJson(selectedEntry.event.result) || "-"}
                </pre>
              </div>
            </div>
          )}
        </div>
      </ResizablePanel>
    </ResizablePanelGroup>
  );
}

```

`gui/src/components/tabs/FontPreviewTab.tsx`:

```tsx
import { useCallback, useEffect, useState, useRef } from "react";
import { Italic, Bold, Underline, Loader2 } from "lucide-react";
import type { IDockviewPanelProps } from "dockview";
import { useTranslation } from "react-i18next";

import { ToggleGroup, ToggleGroupItem } from "@/components/ui/toggle-group";
import { Slider } from "@/components/ui/slider";
import { useSession } from "@/context/SessionContext";

export interface FontPreviewTabParams {
  path: string;
}

const KEY_TEXT = "font_preview_text";
const KEY_SIZE = "font_preview_size";

export function FontPreviewTab({
  params,
}: IDockviewPanelProps<FontPreviewTabParams>) {
  const { pid, device } = useSession();
  const { t } = useTranslation();

  const fullPath = params?.path || "";
  const fontUrl = `/api/download/${device}/${pid}?path=${encodeURIComponent(fullPath)}`;

  const [isLoading, setIsLoading] = useState(true);
  const [hasError, setHasError] = useState(false);
  const [isItalic, setIsItalic] = useState(false);
  const [isBold, setIsBold] = useState(false);
  const [isUnderline, setIsUnderline] = useState(false);
  const [fontSize, setFontSize] = useState(() => {
    const saved = localStorage.getItem(KEY_SIZE);
    return saved ? Number(saved) : 32;
  });
  const contentRef = useRef<HTMLDivElement>(null);

  const previewText =
    localStorage.getItem(KEY_TEXT) ||
    "The quick brown fox jumps over the lazy dog";

  useEffect(() => {
    const loadFont = async () => {
      setHasError(false);
      setIsLoading(true);
      try {
        const fontFace = new FontFace("PreviewFont", `url('${fontUrl}')`);
        await fontFace.load();
        document.fonts.add(fontFace);
      } catch (e) {
        console.error("Failed to load font preview", e);
        setHasError(true);
      } finally {
        setIsLoading(false);
      }
    };

    loadFont();
  }, [fontUrl]);

  useEffect(() => {
    if (!contentRef.current) return;

    const observer = new MutationObserver(() => {
      const text = contentRef.current?.textContent || "";
      localStorage.setItem(KEY_TEXT, text);
    });

    observer.observe(contentRef.current, {
      characterData: true,
      childList: true,
      subtree: true,
    });

    return () => observer.disconnect();
  }, []);

  const handlePaste = useCallback((e: React.ClipboardEvent) => {
    e.preventDefault();
    const plain = e.clipboardData.getData("text/plain");
    const selection = getSelection();
    if (!selection?.rangeCount) return;

    const range = selection.getRangeAt(0);
    range.deleteContents();

    const textNode = document.createTextNode(plain);
    range.insertNode(textNode);
    range.setStartAfter(textNode);
    range.collapse(true);

    selection.removeAllRanges();
    selection.addRange(range);
  }, []);

  const handleKeyDown = useCallback((e: React.KeyboardEvent) => {
    if (e.ctrlKey || e.metaKey) {
      switch (e.key.toLowerCase()) {
        case "b":
        case "i":
        case "u":
          e.preventDefault();
          return;
      }
    }
  }, []);

  if (isLoading) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        <Loader2 className="h-4 w-4 animate-spin mr-2" />
        {t("loading")}
      </div>
    );
  }

  if (hasError) {
    return (
      <div className="flex items-center justify-center h-full text-destructive">
        {t("failed_to_load_font_preview")}
      </div>
    );
  }

  return (
    <div className="h-full flex flex-col p-4">
      <div className="flex items-center gap-2 mb-4 flex-wrap">
        <ToggleGroup
          className="rounded-md border"
          value={[
            ...(isBold ? ["bold"] : []),
            ...(isItalic ? ["italic"] : []),
            ...(isUnderline ? ["underline"] : []),
          ]}
          onValueChange={(values) => {
            setIsBold(values.includes("bold"));
            setIsItalic(values.includes("italic"));
            setIsUnderline(values.includes("underline"));
          }}
        >
          <ToggleGroupItem
            value="bold"
            aria-label="Toggle bold"
            className="px-2 py-1 text-xs transition-colors rounded-none first:rounded-l-md last:rounded-r-md aria-pressed:bg-primary aria-pressed:text-primary-foreground"
          >
            <Bold size="14" />
          </ToggleGroupItem>
          <ToggleGroupItem
            value="italic"
            aria-label="Toggle italic"
            className="px-2 py-1 text-xs transition-colors rounded-none first:rounded-l-md last:rounded-r-md aria-pressed:bg-primary aria-pressed:text-primary-foreground"
          >
            <Italic size="14" />
          </ToggleGroupItem>
          <ToggleGroupItem
            value="underline"
            aria-label="Toggle underline"
            className="px-2 py-1 text-xs transition-colors rounded-none first:rounded-l-md last:rounded-r-md aria-pressed:bg-primary aria-pressed:text-primary-foreground"
          >
            <Underline size="14" />
          </ToggleGroupItem>
        </ToggleGroup>
        <Slider
          value={[fontSize]}
          min={12}
          max={200}
          step={1}
          className="w-32"
          onValueChange={(value) => {
            const arr = Array.isArray(value) ? value : [value];
            const newSize = arr[0];
            setFontSize(newSize);
            localStorage.setItem(KEY_SIZE, newSize.toString());
          }}
        />
        <span className="text-sm w-12">{fontSize}px</span>
      </div>
      <div
        ref={contentRef}
        contentEditable
        suppressContentEditableWarning
        onPaste={handlePaste}
        onKeyDown={handleKeyDown}
        className="flex-1 flex items-center justify-center outline-none text-center wrap-break-word px-4"
        style={{
          fontFamily: "'PreviewFont', sans-serif",
          fontSize: `${fontSize}px`,
          fontStyle: isItalic ? "italic" : "normal",
          fontWeight: isBold ? "bold" : "normal",
          textDecoration: isUnderline ? "underline" : "none",
          userSelect: "text",
          cursor: "text",
        }}
      >
        {previewText}
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/FruityBinaryCookieTab.tsx`:

```tsx
import { useState } from "react";
import { useTranslation } from "react-i18next";
import {
  RefreshCw,
  Trash2,
  Shield,
  Globe,
  Calendar,
  Lock,
  Check,
  X,
} from "lucide-react";
import { Button } from "@/components/ui/button";
import { Spinner } from "@/components/ui/spinner";
import { Input } from "@/components/ui/input";
import {
  Popover,
  PopoverContent,
  PopoverTrigger,
} from "@/components/ui/popover";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";
import { Calendar as CalendarComponent } from "@/components/ui/calendar";
import { toast } from "sonner";
import { useSession } from "@/context/SessionContext";
import { useFruityQuery, useFruityMutation, useQueryClient } from "@/lib/queries";
import {
  useReactTable,
  getCoreRowModel,
  flexRender,
  type ColumnDef,
  type ColumnResizeMode,
} from "@tanstack/react-table";
import type { Cookie, CookiePredicate } from "@agent/fruity/modules/cookies";

function formatDate(date: Date | null): string {
  if (!date) return "-";
  return new Date(date).toLocaleString();
}

export function FruityBinaryCookieTab() {
  const { t } = useTranslation();
  const { fruity } = useSession();
  const queryClient = useQueryClient();

  const [editingCookie, setEditingCookie] = useState<Cookie | null>(null);
  const [editValue, setEditValue] = useState("");
  const [isSaving, setIsSaving] = useState(false);
  const [editingExpiresCookie, setEditingExpiresCookie] =
    useState<Cookie | null>(null);
  const [expiresDate, setExpiresDate] = useState<Date>(new Date());
  const [isExpiresPopoverOpen, setIsExpiresPopoverOpen] = useState(false);
  const [columnSizing, setColumnSizing] = useState<Record<string, number>>({});

  const {
    data: cookies = [],
    isLoading,
    refetch,
  } = useFruityQuery<Cookie[]>(["cookies"], (api) => api.cookies.list());

  const clearMutation = useFruityMutation<void, void>(
    (api) => api.cookies.clear(),
    {
      onSuccess: () => {
        queryClient.invalidateQueries({ queryKey: ["cookies"] });
      },
    },
  );

  const removeMutation = useFruityMutation<boolean, CookiePredicate>(
    (api, predicate) => api.cookies.remove(predicate),
    {
      onSuccess: () => {
        queryClient.invalidateQueries({ queryKey: ["cookies"] });
      },
    },
  );

  const handleClear = async () => {
    try {
      await clearMutation.mutateAsync();
      toast.success(t("cookies_cleared"));
      refetch();
    } catch (err) {
      console.error("Failed to clear cookies:", err);
      toast.error(t("failed_to_clear_cookies"));
    }
  };

  const handleRemove = async (cookie: Cookie) => {
    try {
      await removeMutation.mutateAsync({
        name: cookie.name,
        domain: cookie.domain,
        path: cookie.path,
      } as CookiePredicate);
      toast.success(t("cookie_removed"));
    } catch (err) {
      console.error("Failed to remove cookie:", err);
      toast.error(t("failed_to_remove_cookie"));
    }
  };

  const startEditing = (cookie: Cookie) => {
    setEditingCookie(cookie);
    setEditValue(cookie.value);
  };

  const cancelEditing = () => {
    setEditingCookie(null);
    setEditValue("");
  };

  const saveValue = async () => {
    if (!fruity || !editingCookie) return;
    setIsSaving(true);
    try {
      const predicate: CookiePredicate = {
        name: editingCookie.name,
        domain: editingCookie.domain,
        path: editingCookie.path,
      };
      const success = await fruity.cookies.update(
        predicate,
        "value",
        editValue,
      );
      if (success) {
        queryClient.invalidateQueries({ queryKey: ["cookies"] });
        setEditingCookie(null);
        setEditValue("");
      }
    } finally {
      setIsSaving(false);
    }
  };

  const startEditingExpires = (cookie: Cookie) => {
    setEditingExpiresCookie(cookie);
    setExpiresDate(
      cookie.expiresDate ? new Date(cookie.expiresDate) : new Date(),
    );
    setIsExpiresPopoverOpen(true);
  };

  const cancelEditingExpires = () => {
    setEditingExpiresCookie(null);
    setIsExpiresPopoverOpen(false);
  };

  const saveExpiresDate = async () => {
    if (!fruity || !editingExpiresCookie) return;
    setIsSaving(true);
    try {
      const predicate: CookiePredicate = {
        name: editingExpiresCookie.name,
        domain: editingExpiresCookie.domain,
        path: editingExpiresCookie.path,
      };
      const success = await fruity.cookies.update(
        predicate,
        "expiresDate",
        expiresDate.getTime(),
      );
      if (success) {
        queryClient.invalidateQueries({ queryKey: ["cookies"] });
        setEditingExpiresCookie(null);
        setIsExpiresPopoverOpen(false);
      }
    } finally {
      setIsSaving(false);
    }
  };

  const columns: ColumnDef<Cookie>[] = [
      {
        accessorKey: "domain",
        header: () => (
          <>
            <Globe className="w-4 h-4 inline mr-1" />
            {t("domain")}
          </>
        ),
        size: 192,
        minSize: 100,
        cell: ({ row }) => (
          <span className="truncate block" title={row.original.domain}>
            {row.original.domain}
          </span>
        ),
      },
      {
        accessorKey: "name",
        header: () => (
          <>
            <Shield className="w-4 h-4 inline mr-1" />
            {t("name")}
          </>
        ),
        size: 160,
        minSize: 80,
      },
      {
        accessorKey: "value",
        header: () => t("value"),
        size: 200,
        minSize: 120,
        cell: ({ row }) => {
          const cookie = row.original;
          const isEditing =
            editingCookie?.name === cookie.name &&
            editingCookie?.domain === cookie.domain &&
            editingCookie?.path === cookie.path;

          if (isEditing) {
            return (
              <div className="flex items-center gap-1">
                <Input
                  value={editValue}
                  onChange={(e) => setEditValue(e.target.value)}
                  onKeyDown={(e) => {
                    if (e.key === "Enter") {
                      e.preventDefault();
                      saveValue();
                    } else if (e.key === "Escape") {
                      e.preventDefault();
                      cancelEditing();
                    }
                  }}
                  className="h-7 text-xs"
                  disabled={isSaving}
                  autoFocus
                />
                <Button
                  variant="ghost"
                  size="icon"
                  className="h-7 w-7 text-green-600"
                  onClick={saveValue}
                  disabled={isSaving}
                  title={t("save")}
                >
                  <Check className="h-4 w-4" />
                </Button>
                <Button
                  variant="ghost"
                  size="icon"
                  className="h-7 w-7"
                  onClick={cancelEditing}
                  disabled={isSaving}
                  title={t("discard")}
                >
                  <X className="h-4 w-4" />
                </Button>
              </div>
            );
          }

          return (
            <button
              type="button"
              className="w-full text-left hover:bg-accent px-1 py-0.5 rounded truncate"
              onClick={() => startEditing(cookie)}
              title={cookie.value}
            >
              {cookie.value}
            </button>
          );
        },
      },
      {
        accessorKey: "expiresDate",
        header: () => (
          <>
            <Calendar className="w-4 h-4 inline mr-1" />
            {t("expires")}
          </>
        ),
        size: 128,
        minSize: 80,
        cell: ({ row }) => {
          const cookie = row.original;
          const isEditingExpires =
            isExpiresPopoverOpen &&
            editingExpiresCookie?.name === cookie.name &&
            editingExpiresCookie?.domain === cookie.domain &&
            editingExpiresCookie?.path === cookie.path;

          return (
            <Popover
              open={isEditingExpires}
              onOpenChange={(open) => {
                if (open) {
                  startEditingExpires(cookie);
                } else {
                  cancelEditingExpires();
                }
              }}
            >
              <PopoverTrigger
                render={
                  <button
                    type="button"
                    className="w-full text-left hover:bg-accent px-1 py-0.5 rounded"
                  />
                }
              >
                {formatDate(cookie.expiresDate)}
              </PopoverTrigger>
              <PopoverContent className="w-auto p-3" align="start">
                <div className="flex flex-col gap-3">
                  <CalendarComponent
                    mode="single"
                    selected={expiresDate}
                    onSelect={(date) => date && setExpiresDate(date)}
                    className="rounded-md border"
                  />
                  <div className="flex items-center gap-2">
                    <Input
                      type="time"
                      value={expiresDate.toTimeString().slice(0, 5)}
                      onChange={(e) => {
                        const [hours, minutes] = e.target.value
                          .split(":")
                          .map(Number);
                        const newDate = new Date(expiresDate);
                        newDate.setHours(hours, minutes);
                        setExpiresDate(newDate);
                      }}
                      className="w-24"
                    />
                  </div>
                  <div className="flex justify-end gap-2">
                    <Button
                      variant="outline"
                      size="sm"
                      onClick={cancelEditingExpires}
                    >
                      Discard
                    </Button>
                    <Button
                      size="sm"
                      onClick={saveExpiresDate}
                      disabled={isSaving}
                    >
                      Save
                    </Button>
                  </div>
                </div>
              </PopoverContent>
            </Popover>
          );
        },
      },
      {
        accessorKey: "path",
        header: () => t("path"),
        size: 96,
        minSize: 60,
      },
      {
        accessorKey: "isSecure",
        header: () => (
          <span className="flex items-center justify-center">
            <Lock className="w-4 h-4 inline mr-1" />
            {t("secure")}
          </span>
        ),
        size: 80,
        minSize: 50,
        cell: ({ row }) =>
          row.original.isSecure ? (
            <span className="text-green-600 text-center block">✓</span>
          ) : (
            <span className="text-muted-foreground text-center block">-</span>
          ),
      },
      {
        accessorKey: "isHTTPOnly",
        header: () => (
          <span className="flex items-center justify-center">HTTP Only</span>
        ),
        size: 80,
        minSize: 50,
        cell: ({ row }) =>
          row.original.isHTTPOnly ? (
            <span className="text-green-600 text-center block">✓</span>
          ) : (
            <span className="text-muted-foreground text-center block">-</span>
          ),
      },
      {
        accessorKey: "isSessionOnly",
        header: () => (
          <span className="flex items-center justify-center">
            Session Cookie
          </span>
        ),
        size: 80,
        minSize: 50,
        cell: ({ row }) =>
          row.original.isSessionOnly ? (
            <span className="text-amber-600 text-center block">✓</span>
          ) : (
            <span className="text-muted-foreground text-center block">-</span>
          ),
      },
      {
        id: "actions",
        header: "",
        size: 96,
        minSize: 60,
        enableResizing: false,
        cell: ({ row }) => {
          const cookie = row.original;
          return (
            <div className="flex justify-end gap-1">
              <DropdownMenu>
                <DropdownMenuTrigger
                  render={
                    <Button
                      variant="ghost"
                      size="icon"
                      className="h-7 w-7 text-destructive hover:text-destructive"
                      title={t("remove")}
                    />
                  }
                >
                  <Trash2 className="h-4 w-4" />
                </DropdownMenuTrigger>
                <DropdownMenuContent align="end">
                  <DropdownMenuItem
                    onClick={() => handleRemove(cookie)}
                    className="text-destructive focus:text-destructive"
                  >
                    {t("remove")}
                  </DropdownMenuItem>
                </DropdownMenuContent>
              </DropdownMenu>
            </div>
          );
        },
      },
  ];

  const table = useReactTable({
    data: cookies,
    columns,
    state: { columnSizing },
    onColumnSizingChange: setColumnSizing,
    getCoreRowModel: getCoreRowModel(),
    columnResizeMode: "onChange" as ColumnResizeMode,
    enableColumnResizing: true,
  });

  return (
    <div className="flex flex-col h-full">
      <div className="flex items-center gap-2 p-2 border-b">
        <Button
          variant="outline"
          size="sm"
          onClick={() => refetch()}
          disabled={isLoading}
        >
          <RefreshCw className="w-4 h-4 mr-2" />
          {t("reload")}
        </Button>
        <DropdownMenu>
          <DropdownMenuTrigger
            render={
              <Button
                variant="destructive"
                size="sm"
                disabled={isLoading || cookies.length === 0}
              />
            }
          >
            <Trash2 className="w-4 h-4 mr-2" />
            {t("clear")}
          </DropdownMenuTrigger>
          <DropdownMenuContent align="start">
            <DropdownMenuItem
              onClick={handleClear}
              className="text-destructive focus:text-destructive"
            >
              {t("clear")}
            </DropdownMenuItem>
          </DropdownMenuContent>
        </DropdownMenu>
      </div>
      <div className="flex-1 overflow-auto">
        {isLoading && cookies.length === 0 ? (
          <div className="flex items-center justify-center h-full gap-2 text-muted-foreground">
            <Spinner />
            {t("loading")}...
          </div>
        ) : cookies.length === 0 ? (
          <div className="flex items-center justify-center h-full text-muted-foreground">
            {t("no_cookies")}
          </div>
        ) : (
          <table
            className="w-full text-sm border-collapse"
            style={{ width: table.getCenterTotalSize() }}
          >
            <thead className="sticky top-0 bg-background z-10">
              {table.getHeaderGroups().map((headerGroup) => (
                <tr key={headerGroup.id} className="border-b">
                  {headerGroup.headers.map((header) => (
                    <th
                      key={header.id}
                      className="relative text-left font-medium p-2 select-none"
                      style={{ width: header.getSize() }}
                    >
                      {header.isPlaceholder
                        ? null
                        : flexRender(
                            header.column.columnDef.header,
                            header.getContext(),
                          )}
                      {header.column.getCanResize() && (
                        <div
                          onMouseDown={header.getResizeHandler()}
                          onTouchStart={header.getResizeHandler()}
                          className={`absolute right-0 top-0 h-full w-1 cursor-col-resize select-none touch-none hover:bg-amber-500/50 ${
                            header.column.getIsResizing() ? "bg-amber-500" : ""
                          }`}
                        />
                      )}
                    </th>
                  ))}
                </tr>
              ))}
            </thead>
            <tbody>
              {table.getRowModel().rows.map((row) => (
                <tr
                  key={`${row.original.domain}${row.original.path}${row.original.name}`}
                  className="border-b hover:bg-muted/50"
                >
                  {row.getVisibleCells().map((cell) => (
                    <td
                      key={cell.id}
                      className="p-2 font-mono text-xs"
                      style={{
                        width: cell.column.getSize(),
                        maxWidth: cell.column.getSize(),
                      }}
                    >
                      {flexRender(
                        cell.column.columnDef.cell,
                        cell.getContext(),
                      )}
                    </td>
                  ))}
                </tr>
              ))}
            </tbody>
          </table>
        )}
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/FruityClassDetailTab.tsx`:

```tsx
import { useMemo, useState, useCallback } from "react";
import { useTranslation } from "react-i18next";
import { useNavigate } from "react-router";
import { toast } from "sonner";
import type { IDockviewPanelProps } from "dockview";
import { Anchor, Code, Loader2, Search } from "lucide-react";
import { List, type RowComponentProps } from "react-window";

import { useDock } from "@/context/DockContext";
import { useSession, Status, Mode } from "@/context/SessionContext";
import { useRepl } from "@/context/useRepl";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";
import { Checkbox } from "@/components/ui/checkbox";
import { Input } from "@/components/ui/input";
import { Button } from "@/components/ui/button";
import { Switch } from "@/components/ui/switch";
import { useFruityQuery } from "@/lib/queries";
import {
  objc,
  formatObjCMethod,
  type ObjCHookTarget,
} from "@/lib/hook-template.ts";

import type { ClassDetail } from "@agent/fruity/modules/classdump";

export interface ClassDetailParams {
  className: string;
}

const METHOD_ROW_HEIGHT = 32;

interface MethodRowProps {
  methods: ClassDetail["methods"];
  selectedMethods: Set<string>;
  onSelect: (name: string, checked: boolean) => void;
  onHook: (name: string) => void;
  onGenerate: (name: string) => void;
  onDisasm: (address: string, name: string) => void;
  hookDisabled: boolean;
  hookAddLabel: string;
  generateLabel: string;
}

function MethodRow({
  index,
  style,
  methods,
  selectedMethods,
  onSelect,
  onHook,
  onGenerate,
  onDisasm,
  hookDisabled,
  hookAddLabel,
  generateLabel,
}: RowComponentProps<MethodRowProps>) {
  const { name: method, types, impl } = methods[index];

  return (
    <div
      className="px-2 hover:bg-muted/50 group flex items-center gap-2"
      style={style}
    >
      <Checkbox
        checked={selectedMethods.has(method)}
        onCheckedChange={(checked) => onSelect(method, !!checked)}
        aria-label={`Select ${method}`}
      />
      <div className="min-w-0 flex-1 flex items-center gap-2">
        <span className="font-mono text-sm truncate ml-1" title={method}>
          {method}
        </span>
        <span
          className="font-mono text-muted-foreground truncate text-xs shrink-0"
          title={types}
        >
          {types}
        </span>
      </div>
      <div className="flex items-center gap-0.5 shrink-0">
        <Button
          variant="ghost"
          size="icon"
          className="h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity"
          onClick={() => onHook(method)}
          disabled={hookDisabled}
          title={hookAddLabel}
        >
          <Anchor className="h-3.5 w-3.5" />
        </Button>
        <Button
          variant="ghost"
          size="icon"
          className="h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity"
          onClick={() => onGenerate(method)}
          title={generateLabel}
        >
          <Code className="h-3.5 w-3.5" />
        </Button>
      </div>
      <button
        type="button"
        className="font-mono text-xs text-primary hover:underline cursor-pointer shrink-0"
        onClick={() => onDisasm(impl, method)}
      >
        {impl}
      </button>
    </div>
  );
}

export function FruityClassDetailTab({
  params,
}: IDockviewPanelProps<ClassDetailParams>) {
  const { openFilePanel } = useDock();
  const { t } = useTranslation();
  const { fruity, status, platform, mode, device, bundle, pid } = useSession();
  const { appendCode } = useRepl();
  const navigate = useNavigate();

  const hooksPath = `/workspace/${platform}/${device}/${mode}/${mode === Mode.App ? bundle : pid}/hooks`;
  const [showInherited, setShowInherited] = useState(false);
  const [methodSearch, setMethodSearch] = useState("");
  const [selectedMethods, setSelectedMethods] = useState<Set<string>>(
    new Set(),
  );
  const [isHooking, setIsHooking] = useState(false);

  const { data: classInfo, isLoading } = useFruityQuery<ClassDetail>(
    ["classDetail", params.className],
    (api) => api.classdump.inspect(params.className),
  );

  const openClassTab = (className: string) => {
    openFilePanel({
      id: `class_${className}`,
      component: "classDetail",
      title: className,
      params: { className },
    });
  };

  const openDisassemblyTab = useCallback(
    (address: string, methodName: string) => {
      openFilePanel({
        id: `disasm_${address}`,
        component: "disassembly",
        title: methodName,
        params: { address, name: methodName },
      });
    },
    [openFilePanel],
  );

  const ivarEntries = useMemo(() => classInfo?.ivars ?? [], [classInfo]);
  const ownMethodsSet = useMemo(
    () => new Set(classInfo?.ownMethods ?? []),
    [classInfo?.ownMethods],
  );
  const displayedMethods = useMemo(() => {
    if (!classInfo) return [];
    let allMethods = classInfo.methods;
    if (!showInherited) {
      allMethods = allMethods.filter((method) =>
        ownMethodsSet.has(method.name),
      );
    }
    if (methodSearch.trim()) {
      const query = methodSearch.toLowerCase();
      allMethods = allMethods.filter((method) =>
        method.name.toLowerCase().includes(query),
      );
    }
    return allMethods;
  }, [classInfo, showInherited, ownMethodsSet, methodSearch]);

  const handleHookMethod = useCallback(
    async (methodName: string) => {
      if (!fruity || status !== Status.Ready || !classInfo) return;
      try {
        await fruity.objc.swizzle(classInfo.name, methodName);
        navigate(hooksPath);
        toast.success(t("hook_added"), {
          description: formatObjCMethod(classInfo.name, methodName),
        });
        window.dispatchEvent(new CustomEvent("hooks:refresh"));
      } catch (error) {
        console.error("Failed to hook method:", error);
        toast.error(t("hook_failed"));
      }
    },
    [fruity, status, classInfo, navigate, hooksPath, t],
  );

  const handleGenerateCode = useCallback(
    (methodName: string) => {
      if (!classInfo) return;
      const target: ObjCHookTarget = {
        type: "objc",
        cls: classInfo.name,
        sel: methodName,
      };
      const code = objc(target);
      appendCode(code);
    },
    [classInfo, appendCode],
  );

  const handleSelectMethod = useCallback(
    (methodName: string, checked: boolean) => {
      setSelectedMethods((prev) => {
        const next = new Set(prev);
        if (checked) next.add(methodName);
        else next.delete(methodName);
        return next;
      });
    },
    [],
  );

  const handleSelectAll = useCallback(
    (checked: boolean) => {
      if (checked) {
        setSelectedMethods(new Set(displayedMethods.map((m) => m.name)));
      } else {
        setSelectedMethods(new Set());
      }
    },
    [displayedMethods],
  );

  const handleBatchGenerateCode = useCallback(() => {
    if (!classInfo) return;
    const codes: string[] = [];
    for (const methodName of selectedMethods) {
      const target: ObjCHookTarget = {
        type: "objc",
        cls: classInfo.name,
        sel: methodName,
      };
      codes.push(objc(target));
    }
    if (codes.length > 0) appendCode(codes.join("\n"));
  }, [classInfo, selectedMethods, appendCode]);

  const handleBatchHook = useCallback(async () => {
    if (!fruity || status !== Status.Ready || !classInfo) return;
    setIsHooking(true);
    try {
      let successCount = 0;
      for (const methodName of selectedMethods) {
        try {
          await fruity.objc.swizzle(classInfo.name, methodName);
          successCount++;
        } catch (error) {
          console.error(`Failed to hook ${methodName}:`, error);
        }
      }
      if (successCount > 0) {
        navigate(hooksPath);
        toast.success(t("hook_added_count", { count: successCount }));
        window.dispatchEvent(new CustomEvent("hooks:refresh"));
        setSelectedMethods(new Set());
      }
    } finally {
      setIsHooking(false);
    }
  }, [fruity, status, classInfo, selectedMethods, navigate, hooksPath, t]);

  const selectedCount = selectedMethods.size;

  if (isLoading) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        <Loader2 className="h-4 w-4 animate-spin mr-2" />
        {t("loading")}
      </div>
    );
  }

  if (!classInfo) {
    return (
      <div className="flex items-center justify-center h-full text-destructive">
        {t("failed_to_load_class")}
      </div>
    );
  }

  return (
    <div className="h-full flex flex-col p-4">
      <div className="mb-2 text-sm">
        <div className="flex flex-wrap gap-1 items-center">
          {classInfo.proto.map((cls) => (
            <span key={cls} className="flex items-center">
              <button
                type="button"
                className="text-amber-600 dark:text-amber-400 hover:underline cursor-pointer font-mono"
                onClick={() => openClassTab(cls)}
              >
                {cls}
              </button>
              <span className="mx-1 text-muted-foreground">/</span>
            </span>
          ))}
          <span className="font-mono font-semibold">{classInfo.name}</span>
        </div>
        <div className="text-xs text-muted-foreground font-mono mt-0.5 truncate" title={classInfo.module}>
          {classInfo.module}
        </div>
      </div>

      <div className="flex-1 flex gap-4 min-h-0">
        {/* Left: Methods */}
        <section className="flex-1 flex flex-col min-w-0">
          <div className="flex items-center gap-2 mb-1 px-2">
            <Checkbox
              checked={
                displayedMethods.length > 0 &&
                displayedMethods.every((m) =>
                  selectedMethods.has(m.name),
                )
              }
              onCheckedChange={(checked) => handleSelectAll(!!checked)}
              aria-label="Select all"
            />
            <h3 className="text-xs font-medium text-muted-foreground">
              {t("methods")} ({displayedMethods.length})
            </h3>
            {selectedCount > 0 && (
              <span className="text-xs text-muted-foreground">
                {selectedCount} {t("selected")}
              </span>
            )}
            <div className="flex-1" />
            <Button
              variant="outline"
              size="sm"
              onClick={handleBatchHook}
              disabled={
                status !== Status.Ready ||
                selectedCount === 0 ||
                isHooking
              }
              className="gap-1.5 h-7"
            >
              {isHooking ? (
                <Loader2 className="h-3.5 w-3.5 animate-spin" />
              ) : (
                <Anchor className="h-3.5 w-3.5" />
              )}
              {t("hook_add")}
            </Button>
            <Button
              variant="outline"
              size="sm"
              onClick={handleBatchGenerateCode}
              disabled={selectedCount === 0}
              className="gap-1.5 h-7"
            >
              <Code className="h-3.5 w-3.5" />
              {t("hook_generate_code")}
            </Button>
            <label className="flex items-center gap-1.5 text-xs cursor-pointer">
              <Switch
                checked={showInherited}
                onCheckedChange={setShowInherited}
              />
              {t("show_inherited")}
            </label>
            <div className="relative w-48 shrink-0">
              <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
              <Input
                placeholder={t("search")}
                value={methodSearch}
                onChange={(e) => setMethodSearch(e.target.value)}
                className="pl-9 h-8 text-sm"
              />
            </div>
          </div>

          {displayedMethods.length > 0 ? (
            <div className="flex-1 min-h-0">
              <List
                rowComponent={MethodRow}
                rowCount={displayedMethods.length}
                rowHeight={METHOD_ROW_HEIGHT}
                rowProps={{
                  methods: displayedMethods,
                  selectedMethods,
                  onSelect: handleSelectMethod,
                  onHook: handleHookMethod,
                  onGenerate: handleGenerateCode,
                  onDisasm: openDisassemblyTab,
                  hookDisabled: status !== Status.Ready,
                  hookAddLabel: t("hook_add"),
                  generateLabel: t("hook_generate_code"),
                }}
              />
            </div>
          ) : (
            <div className="text-sm text-muted-foreground py-4 text-center">
              {t("no_results")}
            </div>
          )}
        </section>

        {/* Right: Protocols & Ivars */}
        {(classInfo.protocols.length > 0 || ivarEntries.length > 0) && (
          <aside className="w-64 shrink-0 flex flex-col gap-3 overflow-y-auto">
            {classInfo.protocols.length > 0 && (
              <section>
                <h3 className="text-xs font-medium text-muted-foreground mb-1">
                  {t("protocols")} ({classInfo.protocols.length})
                </h3>
                <div className="flex flex-wrap gap-1.5">
                  {classInfo.protocols.map((protocol) => (
                    <span
                      key={protocol}
                      className="text-xs font-mono bg-muted px-2 py-0.5 rounded"
                    >
                      {protocol}
                    </span>
                  ))}
                </div>
              </section>
            )}

            {ivarEntries.length > 0 && (
              <section>
                <h3 className="text-xs font-medium text-muted-foreground mb-1">
                  ivar ({ivarEntries.length})
                </h3>
                <div className="border rounded">
                  <Table>
                    <TableHeader>
                      <TableRow>
                        <TableHead className="w-24">{t("offset")}</TableHead>
                        <TableHead>{t("name")}</TableHead>
                      </TableRow>
                    </TableHeader>
                    <TableBody>
                      {ivarEntries.map(({ offset, name }) => (
                        <TableRow key={`${offset}-${name}`}>
                          <TableCell className="font-mono text-xs">
                            {offset}
                          </TableCell>
                          <TableCell className="font-mono text-xs">
                            {name}
                          </TableCell>
                        </TableRow>
                      ))}
                    </TableBody>
                  </Table>
                </div>
              </section>
            )}
          </aside>
        )}
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/FruityClassDumpTab.tsx`:

```tsx
import { useCallback, useMemo } from "react";
import { Copy, Download, Loader2 } from "lucide-react";
import { useTranslation } from "react-i18next";
import { toast } from "sonner";
import type { IDockviewPanelProps } from "dockview";
import Editor, { loader } from "@monaco-editor/react";

import { useTheme } from "@/components/providers/ThemeProvider";
import { Button } from "@/components/ui/button";
import { useFruityQuery } from "@/lib/queries";
import { header, type ClassDumpInfo } from "../../lib/classdump-header.ts";

import type { ClassDetail } from "@agent/fruity/modules/classdump";

loader.init().then((monaco) => {
  monaco.languages.register({ id: "objective-c" });
});

export interface ClassDumpParams {
  className: string;
}

export function FruityClassDumpTab({
  params,
}: IDockviewPanelProps<ClassDumpParams>) {
  const { t } = useTranslation();
  const { theme } = useTheme();

  const { data: classInfo, isLoading } = useFruityQuery<ClassDetail>(
    ["classDetail", params.className],
    (api) => api.classdump.inspect(params.className),
  );

  const content = useMemo(
    () => (classInfo ? header(classInfo as ClassDumpInfo) : ""),
    [classInfo],
  );

  const handleCopy = useCallback(() => {
    navigator.clipboard.writeText(content);
    toast.success(t("copied"));
  }, [content, t]);

  const handleDownload = useCallback(() => {
    const blob = new Blob([content], { type: "text/plain" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = `${params.className}.h`;
    a.click();
    URL.revokeObjectURL(url);
  }, [content, params.className]);

  if (isLoading) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        <Loader2 className="h-4 w-4 animate-spin mr-2" />
        {t("loading")}
      </div>
    );
  }

  if (!classInfo) {
    return (
      <div className="flex items-center justify-center h-full text-destructive">
        {t("failed_to_load_class")}
      </div>
    );
  }

  return (
    <div className="h-full flex flex-col">
      <div className="flex items-center gap-1 p-1 border-b shrink-0">
        <Button
          variant="ghost"
          size="sm"
          onClick={handleCopy}
          className="gap-1.5 h-7"
        >
          <Copy className="h-3.5 w-3.5" />
          {t("copy")}
        </Button>
        <Button
          variant="ghost"
          size="sm"
          onClick={handleDownload}
          className="gap-1.5 h-7"
        >
          <Download className="h-3.5 w-3.5" />
          {t("download")}
        </Button>
      </div>
      <div className="flex-1 min-h-0">
        <Editor
          height="100%"
          language="objective-c"
          value={content}
          theme={theme === "dark" ? "vs-dark" : "light"}
          options={{
            readOnly: true,
            minimap: { enabled: false },
            scrollBeyondLastLine: false,
            wordWrap: "on",
            fontSize: 13,
            lineNumbers: "on",
            folding: true,
            automaticLayout: true,
          }}
        />
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/FruityDisassemblyTab.tsx`:

```tsx
import { useR2 } from "@frida/react-use-r2";

import "./DisassemblyTab.css";
import { useEffect, useState } from "react";
import { useTranslation } from "react-i18next";
import type { IDockviewPanelProps } from "dockview";
import { Loader2 } from "lucide-react";

export interface DisassemblyTabParams {
  address: string;
  name?: string;
}

export function FruityDisassemblyTab({
  params,
}: IDockviewPanelProps<DisassemblyTabParams>) {
  const { t } = useTranslation();
  const address = params?.address || "";
  const [html, setHtml] = useState<string>("");
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const { executeR2Command } = useR2();

  useEffect(() => {
    if (!address || !executeR2Command) return;

    let ignore = false;
    setIsLoading(true);
    setError(null);

    async function disassemble() {
      try {
        // Seek to address and disassemble
        const command = [`s ${address}`, "pd 50", "pdj 50"];
        const result = await executeR2Command(command.join(";"));

        if (ignore) return;

        const lines = result.trimEnd().split("\n");
        // Last line is JSON metadata from pdj, skip it
        const htmlContent = lines.slice(0, lines.length - 1).join("\n");

        setHtml(htmlContent);
        setIsLoading(false);
      } catch (e) {
        if (ignore) return;
        setError(e instanceof Error ? e.message : "Failed to disassemble");
        setIsLoading(false);
      }
    }

    disassemble();

    return () => {
      ignore = true;
    };
  }, [address, executeR2Command]);

  if (isLoading) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        <Loader2 className="h-4 w-4 animate-spin mr-2" />
        {t("loading")}...
      </div>
    );
  }

  if (error) {
    return (
      <div className="flex items-center justify-center h-full text-destructive">
        {error}
      </div>
    );
  }

  if (!html) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        {t("no_results")}
      </div>
    );
  }

  return (
    <div className="h-full flex flex-col">
      <div className="flex items-center gap-2 p-2 border-b bg-[#1b1b1f] text-muted-foreground">
        <span className="text-xs font-mono">{params?.name || address}</span>
      </div>
      <div className="disassembly-view flex-1 overflow-auto p-3">
        <div dangerouslySetInnerHTML={{ __html: html }} />
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/FruityEntitlementsTab.tsx`:

```tsx
import { useTranslation } from "react-i18next";
import type { IDockviewPanelProps } from "dockview";
import { Loader2 } from "lucide-react";

import { PlistView, type PlistValue } from "@/components/shared/UnifiedPlistViewer";
import { useFruityQuery } from "@/lib/queries";

export interface EntitlementsTabParams {
  path?: string;
}

export function FruityEntitlementsTab({
  params,
}: IDockviewPanelProps<EntitlementsTabParams>) {
  const { t } = useTranslation();

  const { data, isLoading } = useFruityQuery(
    ["entitlements", params?.path ?? ""],
    (api) => api.entitlements.plist(params?.path)
  );

  if (isLoading) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        <Loader2 className="h-4 w-4 animate-spin mr-2" />
        {t("loading")}
      </div>
    );
  }

  return (
    <PlistView
      xml={data?.xml ?? ""}
      value={(data?.value as PlistValue) ?? null}
      filename="Entitlements.plist"
    />
  );
}

```

`gui/src/components/tabs/FruityHandlesTab.tsx`:

```tsx
import { useMemo, useRef, useState, useEffect } from "react";
import { useTranslation } from "react-i18next";
import { Button } from "@/components/ui/button";
import { Spinner } from "@/components/ui/spinner";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import { ArrowDown, ArrowUp, ArrowUpDown, RefreshCw } from "lucide-react";
import { Checkbox } from "@/components/ui/checkbox";
import { Label } from "@/components/ui/label";
import { useFruityQuery } from "@/lib/queries";
import { useDock } from "@/context/DockContext";

import type {
  FileDescriptor,
  VnodeFD,
  SocketFD,
} from "@agent/fruity/modules/lsof";
import type { BasicInfo } from "@agent/fruity/modules/info";

function isVnodeFD(fd: FileDescriptor): fd is VnodeFD {
  return fd.type === "vnode";
}

function isSocketFD(fd: FileDescriptor): fd is SocketFD {
  return fd.type === "socket";
}

function getDetails(handle: FileDescriptor): string {
  if (isVnodeFD(handle)) return handle.path;
  if (isSocketFD(handle))
    return `${handle.protocol} ${handle.lip}:${handle.lport} → ${handle.rip}:${handle.rport}`;
  return "";
}

type SortKey = "fd" | "type" | "details";
type SortOrder = "asc" | "desc";

export function FruityHandlesTab() {
  const { t } = useTranslation();
  const { openSingletonPanel } = useDock();
  const [sortKey, setSortKey] = useState<SortKey>("fd");
  const [sortOrder, setSortOrder] = useState<SortOrder>("asc");
  const [reloadInterval, setReloadInterval] = useState(0);
  const [showVnode, setShowVnode] = useState(true);
  const [showSocket, setShowSocket] = useState(true);
  const [showPipe, setShowPipe] = useState(true);
  const [showChannel, setShowChannel] = useState(true);
  const intervalRef = useRef<ReturnType<typeof setInterval> | null>(null);

  const { data: appInfo } = useFruityQuery<BasicInfo>(
    ["appInfo"],
    (api) => api.info.basics(),
  );

  const {
    data: handles = [],
    isLoading,
    refetch,
  } = useFruityQuery<FileDescriptor[]>(["handles"], (api) => api.lsof.fds());

  useEffect(() => {
    if (intervalRef.current) {
      clearInterval(intervalRef.current);
      intervalRef.current = null;
    }

    if (reloadInterval > 0) {
      intervalRef.current = setInterval(() => refetch(), reloadInterval * 1000);
    }

    return () => {
      if (intervalRef.current) {
        clearInterval(intervalRef.current);
      }
    };
  }, [reloadInterval, refetch]);

  const handleSort = (key: SortKey) => {
    if (sortKey === key) {
      setSortOrder(sortOrder === "asc" ? "desc" : "asc");
    } else {
      setSortKey(key);
      setSortOrder("asc");
    }
  };

  const filteredAndSortedHandles = useMemo(() => {
    return handles
      .filter((handle) => {
        if (handle.type === "vnode" && !showVnode) return false;
        if (handle.type === "socket" && !showSocket) return false;
        if (handle.type === "pipe" && !showPipe) return false;
        if (handle.type === "channel" && !showChannel) return false;
        return true;
      })
      .sort((a, b) => {
        let cmp = 0;
        switch (sortKey) {
          case "fd":
            cmp = a.fd - b.fd;
            break;
          case "type":
            cmp = a.type.localeCompare(b.type);
            break;
          case "details":
            cmp = getDetails(a).localeCompare(getDetails(b));
            break;
        }
        return sortOrder === "asc" ? cmp : -cmp;
      });
  }, [handles, sortKey, sortOrder, showVnode, showSocket, showPipe, showChannel]);

  const SortIcon = ({ column }: { column: SortKey }) => {
    if (sortKey !== column) return <ArrowUpDown className="h-4 w-4 ml-1" />;
    return sortOrder === "asc" ? (
      <ArrowUp className="h-4 w-4 ml-1" />
    ) : (
      <ArrowDown className="h-4 w-4 ml-1" />
    );
  };

  return (
    <div className="h-full flex flex-col">
      <div className="flex items-center justify-between p-4">
        <div className="flex items-center gap-4">
          <div className="flex items-center gap-2">
            <Checkbox
              id="filter-vnode"
              checked={showVnode}
              onCheckedChange={(checked) => setShowVnode(checked === true)}
            />
            <Label htmlFor="filter-vnode" className="text-sm cursor-pointer">
              vnode
            </Label>
          </div>
          <div className="flex items-center gap-2">
            <Checkbox
              id="filter-socket"
              checked={showSocket}
              onCheckedChange={(checked) => setShowSocket(checked === true)}
            />
            <Label htmlFor="filter-socket" className="text-sm cursor-pointer">
              socket
            </Label>
          </div>
          <div className="flex items-center gap-2">
            <Checkbox
              id="filter-pipe"
              checked={showPipe}
              onCheckedChange={(checked) => setShowPipe(checked === true)}
            />
            <Label htmlFor="filter-pipe" className="text-sm cursor-pointer">
              pipe
            </Label>
          </div>
          <div className="flex items-center gap-2">
            <Checkbox
              id="filter-channel"
              checked={showChannel}
              onCheckedChange={(checked) => setShowChannel(checked === true)}
            />
            <Label htmlFor="filter-channel" className="text-sm cursor-pointer">
              channel
            </Label>
          </div>
        </div>
        <div className="flex items-center gap-2">
          <Select
            value={String(reloadInterval)}
            onValueChange={(value) => setReloadInterval(Number(value))}
          >
            <SelectTrigger className="w-28 h-8 text-xs">
              <SelectValue />
            </SelectTrigger>
            <SelectContent>
              <SelectItem value="0">{t("never")}</SelectItem>
              <SelectItem value="1">{t("1s")}</SelectItem>
              <SelectItem value="10">{t("10s")}</SelectItem>
              <SelectItem value="60">{t("1min")}</SelectItem>
            </SelectContent>
          </Select>
          <Button
            variant="outline"
            size="sm"
            onClick={() => refetch()}
            disabled={isLoading}
          >
            <RefreshCw
              className={`h-4 w-4 mr-2 ${isLoading ? "animate-spin" : ""}`}
            />
            {t("reload")}
          </Button>
        </div>
      </div>
      <div className="flex-1 overflow-auto border-t border-border">
        {isLoading && handles.length === 0 ? (
          <div className="flex items-center justify-center h-full gap-2 text-muted-foreground">
            <Spinner />
            {t("loading")}
          </div>
        ) : (
          <Table>
            <TableHeader>
              <TableRow>
                <TableHead
                  className="w-16 cursor-pointer select-none hover:bg-accent"
                  onClick={() => handleSort("fd")}
                >
                  <div className="flex items-center">
                    {t("file_descriptor")}
                    <SortIcon column="fd" />
                  </div>
                </TableHead>
                <TableHead
                  className="w-24 cursor-pointer select-none hover:bg-accent"
                  onClick={() => handleSort("type")}
                >
                  <div className="flex items-center">
                    {t("type")}
                    <SortIcon column="type" />
                  </div>
                </TableHead>
                <TableHead
                  className="cursor-pointer select-none hover:bg-accent"
                  onClick={() => handleSort("details")}
                >
                  <div className="flex items-center">
                    {t("details")}
                    <SortIcon column="details" />
                  </div>
                </TableHead>
              </TableRow>
            </TableHeader>
            <TableBody>
              {filteredAndSortedHandles.map((handle) => (
                <TableRow key={handle.fd}>
                  <TableCell className="font-mono">{handle.fd}</TableCell>
                  <TableCell>{handle.type}</TableCell>
                  <TableCell className="font-mono text-xs break-all">
                    {isVnodeFD(handle) && (
                      appInfo && (handle.path.startsWith(appInfo.home) || handle.path.startsWith(appInfo.path)) ? (
                        <button
                          type="button"
                          onClick={() => {
                            const dir = handle.path.substring(0, handle.path.lastIndexOf("/")) || "/";
                            openSingletonPanel({
                              id: "finder_tab",
                              component: "finder",
                              title: "Finder",
                              params: { path: dir },
                            });
                          }}
                          className="text-left underline text-amber-600 hover:text-amber-500 dark:text-amber-400 dark:hover:text-amber-300"
                        >
                          {handle.path}
                        </button>
                      ) : (
                        <span>{handle.path}</span>
                      )
                    )}
                    {isSocketFD(handle) && (
                      <span>
                        {handle.protocol} {handle.lip}:{handle.lport} →{" "}
                        {handle.rip}:{handle.rport}
                      </span>
                    )}
                  </TableCell>
                </TableRow>
              ))}
              {handles.length === 0 && !isLoading && (
                <TableRow>
                  <TableCell
                    colSpan={3}
                    className="text-center text-muted-foreground"
                  >
                    {t("no_results")}
                  </TableCell>
                </TableRow>
              )}
            </TableBody>
          </Table>
        )}
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/FruityInfoPlistInsightsTab.tsx`:

```tsx
import { useState } from "react";
import { useTranslation } from "react-i18next";

import { Skeleton } from "@/components/ui/skeleton";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";
import { InfoPlistInsights } from "@/components/tabs/InfoPlistInsights";
import { useFruityQuery } from "@/lib/queries";

export function FruityInfoPlistInsightsTab() {
  const { t } = useTranslation();
  const [permsOpen, setPermsOpen] = useState(false);

  const {
    data,
    isLoading,
    error,
  } = useFruityQuery(["infoPlist"], (api) => api.info.plist());

  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  const value = (data?.value as Record<string, any>) ?? null;

  return (
    <div className="h-full flex flex-col">
      <div className="flex-1 overflow-hidden">
        {error ? (
          <div className="p-4">
            <Alert variant="destructive">
              <AlertTitle>{t("error")}</AlertTitle>
              <AlertDescription>{(error as Error)?.message}</AlertDescription>
            </Alert>
          </div>
        ) : isLoading ? (
          <div className="p-4 space-y-4">
            <Skeleton className="h-8 w-48" />
            <Skeleton className="h-4 w-full" />
            <Skeleton className="h-4 w-3/4" />
            <Skeleton className="h-4 w-1/2" />
          </div>
        ) : value ? (
          <InfoPlistInsights value={value} permsOpen={permsOpen} setPermsOpen={setPermsOpen} />
        ) : (
          <div className="flex items-center justify-center h-full text-muted-foreground">
            {t("no_content")}
          </div>
        )}
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/FruityInfoPlistTab.tsx`:

```tsx
import { useTranslation } from "react-i18next";
import { Loader2 } from "lucide-react";

import { PlistView, type PlistValue } from "@/components/shared/UnifiedPlistViewer";
import { useFruityQuery } from "@/lib/queries";

export function FruityInfoPlistTab() {
  const { t } = useTranslation();

  const { data, isLoading } = useFruityQuery(["infoPlist"], (api) =>
    api.info.plist()
  );

  if (isLoading) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        <Loader2 className="h-4 w-4 animate-spin mr-2" />
        {t("loading")}
      </div>
    );
  }

  return (
    <PlistView
      xml={data?.xml ?? ""}
      value={(data?.value as PlistValue) ?? null}
      filename="Info.plist"
    />
  );
}

```

`gui/src/components/tabs/FruityJSCTab.tsx`:

```tsx
import { useState, useRef } from "react";
import { useTranslation } from "react-i18next";
import Editor, { type Monaco } from "@monaco-editor/react";
import type { editor } from "monaco-editor";
import {
  RefreshCw,
  Play,
  ChevronRight,
  ChevronDown,
  Braces,
  Brackets,
  Hash,
  Type,
  ToggleLeft,
  Box,
  FileCode,
  Terminal,
} from "lucide-react";
import { Button } from "@/components/ui/button";
import { Spinner } from "@/components/ui/spinner";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";
import {
  ResizablePanelGroup,
  ResizablePanel,
  ResizableHandle,
} from "@/components/ui/resizable";
import { Tabs, TabsList, TabsTrigger, TabsContent } from "@/components/ui/tabs";
import { useTheme } from "@/components/providers/ThemeProvider";
import { useFruityQuery, useFruityMutation } from "@/lib/queries";

// Configure Monaco for JSC JavaScript (no DOM, just ESNext)
function handleEditorWillMount(monaco: Monaco) {
  monaco.languages.typescript.javascriptDefaults.setCompilerOptions({
    target: monaco.languages.typescript.ScriptTarget.ESNext,
    allowNonTsExtensions: true,
    lib: ["esnext"],
  });

  monaco.languages.typescript.javascriptDefaults.setDiagnosticsOptions({
    noSemanticValidation: false,
    noSyntaxValidation: false,
  });
}

interface JSCEntry {
  handle: string;
  description: string;
}

function ValueIcon({ value }: { value: unknown }) {
  if (value === null || value === undefined) {
    return <span className="text-muted-foreground">null</span>;
  }
  if (typeof value === "boolean") {
    return <ToggleLeft className="w-3 h-3 text-purple-500" />;
  }
  if (typeof value === "number") {
    return <Hash className="w-3 h-3 text-amber-500" />;
  }
  if (typeof value === "string") {
    return <Type className="w-3 h-3 text-green-500" />;
  }
  if (Array.isArray(value)) {
    return <Brackets className="w-3 h-3 text-orange-500" />;
  }
  if (typeof value === "object") {
    const obj = value as Record<string, unknown>;
    if (obj.type === "function" || obj.type === "block") {
      return <FileCode className="w-3 h-3 text-yellow-500" />;
    }
    if (obj.type === "instance" || obj.type === "class") {
      return <Box className="w-3 h-3 text-pink-500" />;
    }
    return <Braces className="w-3 h-3 text-cyan-500" />;
  }
  return null;
}

function ValuePreview({ value }: { value: unknown }) {
  if (value === null)
    return <span className="text-muted-foreground">null</span>;
  if (value === undefined)
    return <span className="text-muted-foreground">undefined</span>;
  if (typeof value === "boolean") {
    return (
      <span className="text-purple-600 dark:text-purple-400">
        {value ? "true" : "false"}
      </span>
    );
  }
  if (typeof value === "number") {
    return <span className="text-amber-600 dark:text-amber-400">{value}</span>;
  }
  if (typeof value === "string") {
    return (
      <span className="text-green-600 dark:text-green-400 break-all">
        "{value}"
      </span>
    );
  }
  if (Array.isArray(value)) {
    return (
      <span className="text-orange-600 dark:text-orange-400">
        Array[{value.length}]
      </span>
    );
  }
  if (typeof value === "object") {
    const obj = value as Record<string, unknown>;
    if (obj.type === "function") {
      return (
        <span className="text-yellow-600 dark:text-yellow-400">ƒ function</span>
      );
    }
    if (obj.type === "block") {
      return (
        <span className="text-yellow-600 dark:text-yellow-400">
          ƒ block @ {String(obj.handle)}
        </span>
      );
    }
    if (obj.type === "instance") {
      return (
        <span className="text-pink-600 dark:text-pink-400">
          {String(obj.clazz)} @ {String(obj.handle)}
        </span>
      );
    }
    if (obj.type === "class") {
      return (
        <span className="text-pink-600 dark:text-pink-400">
          class {String(obj.clazz)}
        </span>
      );
    }
    if (obj.type === "array") {
      return (
        <span className="text-orange-600 dark:text-orange-400">
          NSArray[{String(obj.size)}]
        </span>
      );
    }
    if (obj.type === "dict") {
      return (
        <span className="text-cyan-600 dark:text-cyan-400">
          NSDictionary[{String(obj.size)}]
        </span>
      );
    }
    const keys = Object.keys(obj);
    return (
      <span className="text-cyan-600 dark:text-cyan-400">
        {`{${keys.length} keys}`}
      </span>
    );
  }
  return <span>{String(value)}</span>;
}

function TreeNode({
  name,
  value,
  depth = 0,
}: {
  name: string;
  value: unknown;
  depth?: number;
}) {
  const [expanded, setExpanded] = useState(false);
  const isExpandable =
    value !== null &&
    typeof value === "object" &&
    Object.keys(value as object).length > 0;

  const obj = value as Record<string, unknown> | null;
  const childEntries = isExpandable ? Object.entries(obj!) : [];

  return (
    <div className="font-mono text-xs">
      <div
        className={`flex items-center gap-1 py-0.5 px-1 hover:bg-accent rounded ${
          isExpandable ? "cursor-pointer" : ""
        }`}
        style={{ paddingLeft: `${depth * 16 + 4}px` }}
        onClick={() => isExpandable && setExpanded(!expanded)}
      >
        {isExpandable ? (
          expanded ? (
            <ChevronDown className="w-3 h-3 shrink-0" />
          ) : (
            <ChevronRight className="w-3 h-3 shrink-0" />
          )
        ) : (
          <span className="w-3" />
        )}
        <ValueIcon value={value} />
        <span className="font-medium text-foreground">{name}</span>
        <span className="text-muted-foreground">:</span>
        <span className="ml-1 truncate">
          <ValuePreview value={value} />
        </span>
      </div>
      {expanded && isExpandable && (
        <div>
          {childEntries.map(([key, val]) => (
            <TreeNode key={key} name={key} value={val} depth={depth + 1} />
          ))}
        </div>
      )}
    </div>
  );
}

function DumpView({
  data,
  t,
}: {
  data: Record<string, unknown>;
  t: (key: string, options?: Record<string, unknown>) => string;
}) {
  const entries = Object.entries(data);
  const [filter, setFilter] = useState("");

  const filteredEntries = filter
    ? entries.filter(([key]) =>
        key.toLowerCase().includes(filter.toLowerCase()),
      )
    : entries;

  return (
    <div className="flex flex-col h-full">
      <div className="p-2 border-b">
        <input
          type="text"
          placeholder={t("filter_by_name")}
          value={filter}
          onChange={(e) => setFilter(e.target.value)}
          className="w-full px-2 py-1 text-sm border rounded bg-background"
        />
      </div>
      <div className="flex-1 overflow-auto p-2">
        {filteredEntries.length === 0 ? (
          <div className="text-center text-muted-foreground py-4">
            {filter ? t("no_matching_entries") : t("no_global_objects")}
          </div>
        ) : (
          filteredEntries.map(([key, value]) => (
            <TreeNode key={key} name={key} value={value} />
          ))
        )}
      </div>
      <div className="p-2 border-t text-xs text-muted-foreground">
        {t("entries_count", {
          filtered: filteredEntries.length,
          total: entries.length,
        })}
      </div>
    </div>
  );
}

export function FruityJSCTab() {
  const { t } = useTranslation();
  const { theme } = useTheme();
  const [selectedHandle, setSelectedHandle] = useState<string | null>(null);
  const [activeTab, setActiveTab] = useState("dump");
  const [jsCode, setJsCode] = useState(
    () => localStorage.getItem("jsc-repl-code") ?? "1 + 1",
  );
  const [jsResult, setJsResult] = useState<string | null>(null);
  const [dumpResult, setDumpResult] = useState<Record<string, unknown> | null>(
    null,
  );
  const editorRef = useRef<editor.IStandaloneCodeEditor | null>(null);

  const {
    data: contexts,
    isLoading,
    refetch,
  } = useFruityQuery<Record<string, string>>(["jsc"], (api) => api.jsc.list());

  const runMutation = useFruityMutation<string, { handle: string; js: string }>(
    (api, { handle, js }) => api.jsc.run(handle, js),
  );

  const dumpMutation = useFruityMutation<
    Record<string, unknown>,
    { handle: string }
  >((api, { handle }) => api.jsc.dump(handle));

  const entries: JSCEntry[] = [];
  if (contexts) {
    for (const [handle, description] of Object.entries(contexts)) {
      entries.push({ handle, description });
    }
  }

  const selectedEntry =
    entries.find((e) => e.handle === selectedHandle) ?? null;

  const selectEntry = async (handle: string) => {
    if (selectedHandle === handle) {
      setSelectedHandle(null);
      setJsResult(null);
      setDumpResult(null);
    } else {
      setSelectedHandle(handle);
      setJsResult(null);
      setDumpResult(null);
      // Load globals immediately
      try {
        const result = await dumpMutation.mutateAsync({ handle });
        setDumpResult(result);
      } catch (e) {
        console.error("Failed to dump:", e);
      }
    }
  };

  const executeJs = async (handle: string) => {
    try {
      const result = await runMutation.mutateAsync({ handle, js: jsCode });
      setJsResult(result);
    } catch (e) {
      setJsResult(`Error: ${(e as Error).message}`);
    }
  };

  const handleEditorDidMount = (editor: editor.IStandaloneCodeEditor) => {
    editorRef.current = editor;
  };

  return (
    <div className="flex flex-col h-full">
      <div className="flex items-center gap-2 p-2 border-b">
        <Button
          variant="outline"
          size="sm"
          onClick={() => refetch()}
          disabled={isLoading}
        >
          <RefreshCw
            className={`w-4 h-4 mr-2 ${isLoading ? "animate-spin" : ""}`}
          />
          {t("reload")}
        </Button>
        <span className="text-sm text-muted-foreground ml-auto">
          {t("jsc_contexts", { count: entries.length })}
        </span>
      </div>
      <div className="flex-1 overflow-hidden">
        {isLoading ? (
          <div className="flex items-center justify-center h-full gap-2 text-muted-foreground">
            <Spinner className="w-5 h-5" />
            <span>{t("loading")}</span>
          </div>
        ) : entries.length === 0 ? (
          <div className="flex items-center justify-center h-full text-muted-foreground">
            {t("no_jscontext_found")}
          </div>
        ) : (
          <ResizablePanelGroup orientation="horizontal">
            {/* Left Panel - JSContext List */}
            <ResizablePanel defaultSize="35%" minSize="20%">
              <div className="h-full overflow-auto">
                <Table>
                  <TableHeader>
                    <TableRow>
                      <TableHead>{t("handle")}</TableHead>
                      <TableHead>{t("description")}</TableHead>
                    </TableRow>
                  </TableHeader>
                  <TableBody>
                    {entries.map((entry) => (
                      <TableRow
                        key={entry.handle}
                        className={`cursor-pointer ${
                          selectedHandle === entry.handle ? "bg-accent" : ""
                        }`}
                        onClick={() => selectEntry(entry.handle)}
                      >
                        <TableCell className="font-mono text-xs">
                          {entry.handle}
                        </TableCell>
                        <TableCell
                          className="font-mono text-sm truncate max-w-[200px]"
                          title={entry.description}
                        >
                          {entry.description}
                        </TableCell>
                      </TableRow>
                    ))}
                  </TableBody>
                </Table>
              </div>
            </ResizablePanel>

            <ResizableHandle withHandle />

            {/* Right Panel - Detail View */}
            <ResizablePanel defaultSize="65%" minSize="30%">
              <div className="h-full overflow-hidden">
                {selectedEntry ? (
                  <Tabs
                    value={activeTab}
                    onValueChange={setActiveTab}
                    className="flex flex-col h-full"
                  >
                    <div className="flex items-center justify-between p-2 border-b">
                      <TabsList>
                        <TabsTrigger value="dump">
                          <Braces className="w-4 h-4 mr-1" />
                          {t("globals")}
                        </TabsTrigger>
                        <TabsTrigger value="repl">
                          <Terminal className="w-4 h-4 mr-1" />
                          REPL
                        </TabsTrigger>
                      </TabsList>
                    </div>

                    <TabsContent value="dump" className="flex-1 min-h-0">
                      {dumpMutation.isPending ? (
                        <div className="flex items-center justify-center h-full gap-2 text-muted-foreground">
                          <Spinner className="w-5 h-5" />
                          <span>{t("loading_globals")}</span>
                        </div>
                      ) : dumpResult ? (
                        <DumpView data={dumpResult} t={t} />
                      ) : (
                        <div className="flex items-center justify-center h-full text-muted-foreground">
                          {t("failed_to_load_globals")}
                        </div>
                      )}
                    </TabsContent>

                    <TabsContent value="repl" className="flex-1 min-h-0">
                      <div className="flex flex-col h-full p-4 gap-3">
                        <div className="flex items-center justify-between">
                          <span className="text-sm font-medium">
                            {t("execute_javascript")}
                          </span>
                          <Button
                            size="sm"
                            onClick={() => executeJs(selectedEntry.handle)}
                            disabled={runMutation.isPending}
                          >
                            <Play className="w-4 h-4 mr-2" />
                            {t("run")}
                          </Button>
                        </div>
                        <div className="flex-1 min-h-0 border rounded overflow-hidden">
                          <Editor
                            height="100%"
                            language="javascript"
                            value={jsCode}
                            onChange={(value) => {
                              const code = value || "";
                              setJsCode(code);
                              localStorage.setItem("jsc-repl-code", code);
                            }}
                            beforeMount={handleEditorWillMount}
                            onMount={handleEditorDidMount}
                            theme={theme === "dark" ? "vs-dark" : "light"}
                            options={{
                              minimap: { enabled: false },
                              scrollBeyondLastLine: false,
                              fontSize: 13,
                              lineNumbers: "on",
                              folding: true,
                              automaticLayout: true,
                              tabSize: 2,
                              wordWrap: "on",
                              suggestOnTriggerCharacters: true,
                              quickSuggestions: true,
                            }}
                          />
                        </div>
                        {jsResult !== null && (
                          <div className="shrink-0">
                            <div className="text-sm text-muted-foreground mb-1">
                              {t("result")}:
                            </div>
                            <pre className="font-mono text-xs bg-muted p-3 rounded overflow-x-auto max-h-40 whitespace-pre-wrap">
                              {jsResult}
                            </pre>
                          </div>
                        )}
                      </div>
                    </TabsContent>
                  </Tabs>
                ) : (
                  <div className="flex items-center justify-center h-full text-muted-foreground">
                    {t("select_jscontext")}
                  </div>
                )}
              </div>
            </ResizablePanel>
          </ResizablePanelGroup>
        )}
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/FruityKeychainTab.tsx`:

```tsx
import { useState, useMemo } from "react";
import { useTranslation } from "react-i18next";
import {
  RefreshCw,
  Trash2,
  Key,
  User,
  Server,
  ChevronDown,
  ChevronRight,
  Download,
  Copy,
  Check,
  ChevronsDownUp,
  ChevronsUpDown,
} from "lucide-react";
import { Button } from "@/components/ui/button";
import { Checkbox } from "@/components/ui/checkbox";
import { Spinner } from "@/components/ui/spinner";
import {
  Popover,
  PopoverContent,
  PopoverTrigger,
} from "@/components/ui/popover";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";
import { useFruityQuery, useFruityMutation, useQueryClient } from "@/lib/queries";
import {
  useReactTable,
  getCoreRowModel,
  getExpandedRowModel,
  flexRender,
  type ColumnDef,
  type ColumnResizeMode,
  type ExpandedState,
} from "@tanstack/react-table";

import type { KeyChainItem } from "@agent/fruity/modules/keychain";

function formatBoolean(value: boolean | undefined): string {
  return value ? "✓" : "-";
}

function hexDump(base64Data: string | undefined): string {
  if (!base64Data) return "";

  try {
    const binaryString = atob(base64Data);
    const bytes = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      bytes[i] = binaryString.charCodeAt(i);
    }

    const lines: string[] = [];
    const bytesPerLine = 16;

    for (let offset = 0; offset < bytes.length; offset += bytesPerLine) {
      const lineBytes = bytes.slice(offset, offset + bytesPerLine);
      const hexPart = Array.from(lineBytes)
        .map((b) => b.toString(16).padStart(2, "0"))
        .join(" ");
      const asciiPart = Array.from(lineBytes)
        .map((b) => {
          const char = String.fromCharCode(b);
          return b >= 32 && b <= 126 ? char : ".";
        })
        .join("");

      const offsetHex = offset.toString(16).padStart(8, "0");
      lines.push(`${offsetHex}  ${hexPart.padEnd(47, " ")}  |${asciiPart}|`);
    }

    return lines.join("\n");
  } catch {
    return "<invalid base64>";
  }
}

export function FruityKeychainTab() {
  const { t } = useTranslation();
  const queryClient = useQueryClient();
  const [withBiometricId, setWithBiometricId] = useState(false);
  const [expanded, setExpanded] = useState<ExpandedState>({});
  const [copySuccessIndex, setCopySuccessIndex] = useState<string | null>(null);
  const [classFilterOpen, setClassFilterOpen] = useState(false);
  const [protFilterOpen, setProtFilterOpen] = useState(false);
  const [selectedClasses, setSelectedClasses] = useState<Set<string>>(
    new Set(),
  );
  const [selectedProts, setSelectedProts] = useState<Set<string>>(new Set());
  const [columnSizing, setColumnSizing] = useState<Record<string, number>>({});

  const {
    data: items = [],
    isLoading,
    refetch,
  } = useFruityQuery<KeyChainItem[]>(
    ["keychain", String(withBiometricId)],
    (api) => api.keychain.list(withBiometricId),
  );

  const removeMutation = useFruityMutation<
    void,
    { service: string; account: string }
  >((api, { service, account }) => api.keychain.remove(service, account), {
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ["keychain"] });
    },
  });

  const handleDelete = async (item: KeyChainItem) => {
    const service = item.service || "";
    const account = item.account || "";
    await removeMutation.mutateAsync({ service, account });
  };

  const downloadRaw = (item: KeyChainItem) => {
    if (!item.raw) return;
    try {
      const binaryString = atob(item.raw);
      const bytes = new Uint8Array(binaryString.length);
      for (let i = 0; i < binaryString.length; i++) {
        bytes[i] = binaryString.charCodeAt(i);
      }
      const blob = new Blob([bytes], { type: "application/octet-stream" });
      const url = URL.createObjectURL(blob);
      const link = document.createElement("a");
      link.href = url;
      const filename = `${item.service || "unknown"}-${item.account || "unknown"}.bin`;
      link.download = filename;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
    } catch {
      console.error("Failed to download raw data");
    }
  };

  const copyToClipboardRaw = async (item: KeyChainItem, rowId: string) => {
    if (!item.raw) return;
    try {
      const binaryString = atob(item.raw);
      const bytes = new Uint8Array(binaryString.length);
      for (let i = 0; i < binaryString.length; i++) {
        bytes[i] = binaryString.charCodeAt(i);
      }
      const decoder = new TextDecoder("utf-8", { fatal: false });
      const text = decoder.decode(bytes);
      await navigator.clipboard.writeText(text);
      setCopySuccessIndex(rowId);
      setTimeout(() => setCopySuccessIndex(null), 2000);
    } catch {
      console.error("Failed to copy raw data to clipboard");
    }
  };

  const allClasses = Array.from(
    new Set(items.map((i) => i.clazz).filter(Boolean) as string[]),
  );
  const allProts = Array.from(
    new Set(items.map((i) => i.prot).filter(Boolean) as string[]),
  );

  const toggleClass = (clazz: string) => {
    setSelectedClasses((prev) => {
      const next = new Set(prev);
      if (next.has(clazz)) {
        next.delete(clazz);
      } else {
        next.add(clazz);
      }
      return next;
    });
  };

  const toggleProt = (prot: string) => {
    setSelectedProts((prev) => {
      const next = new Set(prev);
      if (next.has(prot)) {
        next.delete(prot);
      } else {
        next.add(prot);
      }
      return next;
    });
  };

  const filteredItems = useMemo(() => {
    return items.filter((item) => {
      const clazz = item.clazz || "";
      const prot = item.prot || "";
      if (selectedClasses.size > 0 && !selectedClasses.has(clazz)) {
        return false;
      }
      if (selectedProts.size > 0 && !selectedProts.has(prot)) {
        return false;
      }
      return true;
    });
  }, [items, selectedClasses, selectedProts]);

  const clearFilters = () => {
    setSelectedClasses(new Set());
    setSelectedProts(new Set());
  };

  const columns: ColumnDef<KeyChainItem>[] = [
      {
        id: "expand",
        header: "",
        size: 32,
        minSize: 32,
        enableResizing: false,
        cell: ({ row }) =>
          row.getIsExpanded() ? (
            <ChevronDown className="w-4 h-4" />
          ) : (
            <ChevronRight className="w-4 h-4" />
          ),
      },
      {
        accessorKey: "service",
        header: () => (
          <>
            <Server className="w-4 h-4 inline mr-1" />
            {t("service")}
          </>
        ),
        size: 160,
        minSize: 80,
        cell: ({ row }) => (
          <span
            className="truncate block font-mono"
            title={row.original.service}
          >
            {row.original.service || "-"}
          </span>
        ),
      },
      {
        accessorKey: "account",
        header: () => (
          <>
            <User className="w-4 h-4 inline mr-1" />
            {t("account")}
          </>
        ),
        size: 160,
        minSize: 80,
        cell: ({ row }) => (
          <span
            className="truncate block font-mono"
            title={row.original.account}
          >
            {row.original.account || "-"}
          </span>
        ),
      },
      {
        accessorKey: "label",
        header: () => (
          <>
            <Key className="w-4 h-4 inline mr-1" />
            {t("label")}
          </>
        ),
        size: 160,
        minSize: 80,
        cell: ({ row }) => row.original.label || "-",
      },
      {
        accessorKey: "entitlementGroup",
        header: () => (
          <>
            <Server className="w-4 h-4 inline mr-1" />
            {t("entitlement_group")}
          </>
        ),
        size: 192,
        minSize: 80,
        cell: ({ row }) => (
          <span
            className="truncate block"
            title={row.original.entitlementGroup}
          >
            {row.original.entitlementGroup || "-"}
          </span>
        ),
      },
      {
        accessorKey: "prot",
        header: () => (
          <Popover open={protFilterOpen} onOpenChange={setProtFilterOpen}>
            <PopoverTrigger
              render={<Button variant="ghost" size="sm" className="h-8 px-1" />}
            >
              <Server className="w-4 h-4 inline mr-1" />
              {t("prot")}
              {selectedProts.size > 0 && (
                <span className="ml-1 text-xs bg-primary text-primary-foreground rounded-full px-1.5">
                  {selectedProts.size}
                </span>
              )}
            </PopoverTrigger>
            <PopoverContent className="w-100 p-3" align="start">
              <div className="flex flex-col gap-2">
                <div className="flex items-center justify-between">
                  <span className="font-medium text-sm">{t("filter")}</span>
                  {(selectedProts.size > 0 || allProts.length > 0) && (
                    <Button
                      variant="ghost"
                      size="sm"
                      className="h-6 text-xs"
                      onClick={clearFilters}
                    >
                      {t("clear")}
                    </Button>
                  )}
                </div>
                <div className="max-h-48 overflow-y-auto flex flex-col gap-1">
                  {allProts.map((prot) => (
                    <label
                      key={prot}
                      className="flex items-center gap-2 cursor-pointer hover:bg-accent px-1 rounded"
                    >
                      <Checkbox
                        checked={selectedProts.has(prot)}
                        onCheckedChange={() => toggleProt(prot)}
                      />
                      <span className="text-sm truncate">{prot}</span>
                    </label>
                  ))}
                  {allProts.length === 0 && (
                    <span className="text-sm text-muted-foreground">
                      {t("no_values")}
                    </span>
                  )}
                </div>
              </div>
            </PopoverContent>
          </Popover>
        ),
        size: 128,
        minSize: 60,
        cell: ({ row }) => (
          <span className="truncate block" title={row.original.prot}>
            {row.original.prot || "-"}
          </span>
        ),
      },
      {
        accessorKey: "clazz",
        header: () => (
          <Popover open={classFilterOpen} onOpenChange={setClassFilterOpen}>
            <PopoverTrigger
              render={<Button variant="ghost" size="sm" className="h-8 px-1" />}
            >
              {t("class")}
              {selectedClasses.size > 0 && (
                <span className="ml-1 text-xs bg-primary text-primary-foreground rounded-full px-1.5">
                  {selectedClasses.size}
                </span>
              )}
            </PopoverTrigger>
            <PopoverContent className="w-48 p-3" align="start">
              <div className="flex flex-col gap-2">
                <div className="flex items-center justify-between">
                  <span className="font-medium text-sm">{t("filter")}</span>
                  {(selectedClasses.size > 0 || allClasses.length > 0) && (
                    <Button
                      variant="ghost"
                      size="sm"
                      className="h-6 text-xs"
                      onClick={clearFilters}
                    >
                      {t("clear")}
                    </Button>
                  )}
                </div>
                <div className="max-h-48 overflow-y-auto flex flex-col gap-1">
                  {allClasses.map((clazz) => (
                    <label
                      key={clazz}
                      className="flex items-center gap-2 cursor-pointer hover:bg-accent px-1 rounded"
                    >
                      <Checkbox
                        checked={selectedClasses.has(clazz)}
                        onCheckedChange={() => toggleClass(clazz)}
                      />
                      <span className="text-sm">{clazz}</span>
                    </label>
                  ))}
                  {allClasses.length === 0 && (
                    <span className="text-sm text-muted-foreground">
                      {t("no_values")}
                    </span>
                  )}
                </div>
              </div>
            </PopoverContent>
          </Popover>
        ),
        size: 96,
        minSize: 60,
        cell: ({ row }) => row.original.clazz || "-",
      },
      {
        accessorKey: "acl",
        header: () => t("acl"),
        size: 192,
        minSize: 80,
        cell: ({ row }) => (
          <span className="truncate block" title={row.original.acl}>
            {row.original.acl || "-"}
          </span>
        ),
      },
      {
        id: "actions",
        header: () => t("actions"),
        size: 96,
        minSize: 60,
        enableResizing: false,
        cell: ({ row }) => {
          const item = row.original;
          return (
            <div
              className="flex justify-end gap-1"
              onClick={(e) => e.stopPropagation()}
            >
              <DropdownMenu>
                <DropdownMenuTrigger
                  render={
                    <Button
                      variant="ghost"
                      size="icon"
                      className="h-7 w-7 text-destructive hover:text-destructive"
                      title={t("remove")}
                    />
                  }
                >
                  <Trash2 className="h-4 w-4" />
                </DropdownMenuTrigger>
                <DropdownMenuContent align="end">
                  <DropdownMenuItem
                    onClick={() => handleDelete(item)}
                    className="text-destructive focus:text-destructive"
                  >
                    {t("remove")}
                  </DropdownMenuItem>
                </DropdownMenuContent>
              </DropdownMenu>
            </div>
          );
        },
      },
  ];

  const table = useReactTable({
    data: filteredItems,
    columns,
    state: { columnSizing, expanded },
    onColumnSizingChange: setColumnSizing,
    onExpandedChange: setExpanded,
    getCoreRowModel: getCoreRowModel(),
    getExpandedRowModel: getExpandedRowModel(),
    columnResizeMode: "onChange" as ColumnResizeMode,
    enableColumnResizing: true,
  });

  const expandAll = () => {
    const allExpanded: Record<string, boolean> = {};
    filteredItems.forEach((_, i) => {
      allExpanded[String(i)] = true;
    });
    setExpanded(allExpanded);
  };

  const collapseAll = () => {
    setExpanded({});
  };

  const hasExpanded =
    typeof expanded === "object" && Object.keys(expanded).length > 0;

  return (
    <div className="flex flex-col h-full">
      <div className="flex items-center gap-2 p-2 border-b">
        <Button
          variant="outline"
          size="sm"
          onClick={() => refetch()}
          disabled={isLoading}
        >
          <RefreshCw className="w-4 h-4 mr-2" />
          {t("reload")}
        </Button>
        <div className="flex">
          <Button
            variant="outline"
            size="sm"
            className="rounded-r-none border-r-0"
            onClick={expandAll}
            disabled={isLoading || filteredItems.length === 0}
            title={t("expand_all")}
          >
            <ChevronsUpDown className="w-4 h-4" />
          </Button>
          <Button
            variant="outline"
            size="sm"
            className="rounded-l-none"
            onClick={collapseAll}
            disabled={isLoading || !hasExpanded}
            title={t("collapse_all")}
          >
            <ChevronsDownUp className="w-4 h-4" />
          </Button>
        </div>
        <div className="flex items-center gap-2 ml-auto">
          <label className="text-sm flex items-center gap-2">
            <input
              type="checkbox"
              checked={withBiometricId}
              onChange={(e) => setWithBiometricId(e.target.checked)}
              className="rounded"
            />
            {t("require_biometric_id")}
          </label>
        </div>
      </div>
      <div className="flex-1 overflow-auto">
        {isLoading ? (
          <div className="flex items-center justify-center h-full gap-2 text-muted-foreground">
            <Spinner className="w-5 h-5" />
            <span>{t("loading")}...</span>
          </div>
        ) : filteredItems.length === 0 ? (
          <div className="flex items-center justify-center h-full text-muted-foreground">
            {t("no_keychain_items")}
          </div>
        ) : (
          <table
            className="w-full text-sm border-collapse"
            style={{ width: table.getCenterTotalSize() }}
          >
            <thead className="sticky top-0 bg-background z-10">
              {table.getHeaderGroups().map((headerGroup) => (
                <tr key={headerGroup.id} className="border-b">
                  {headerGroup.headers.map((header) => (
                    <th
                      key={header.id}
                      className="relative text-left font-medium p-2 select-none"
                      style={{ width: header.getSize() }}
                    >
                      {header.isPlaceholder
                        ? null
                        : flexRender(
                            header.column.columnDef.header,
                            header.getContext(),
                          )}
                      {header.column.getCanResize() && (
                        <div
                          onMouseDown={header.getResizeHandler()}
                          onTouchStart={header.getResizeHandler()}
                          className={`absolute right-0 top-0 h-full w-1 cursor-col-resize select-none touch-none hover:bg-amber-500/50 ${
                            header.column.getIsResizing() ? "bg-amber-500" : ""
                          }`}
                        />
                      )}
                    </th>
                  ))}
                </tr>
              ))}
            </thead>
            <tbody>
              {table.getRowModel().rows.map((row) => (
                <>
                  <tr
                    key={row.id}
                    className="border-b hover:bg-muted/50 cursor-pointer"
                    onClick={() => row.toggleExpanded()}
                  >
                    {row.getVisibleCells().map((cell) => (
                      <td
                        key={cell.id}
                        className="p-2 font-mono text-xs truncate"
                        style={{
                          width: cell.column.getSize(),
                          maxWidth: cell.column.getSize(),
                        }}
                      >
                        {flexRender(
                          cell.column.columnDef.cell,
                          cell.getContext(),
                        )}
                      </td>
                    ))}
                  </tr>
                  {row.getIsExpanded() && (
                    <tr key={`${row.id}-detail`} className="border-b">
                      <td
                        colSpan={columns.length}
                        className="bg-muted/50 px-4 py-3"
                      >
                        <div className="space-y-2 text-xs">
                          <div className="grid grid-cols-2 gap-x-6 gap-y-1">
                            <div className="flex gap-2">
                              <span className="text-muted-foreground shrink-0">
                                {t("creation_time")}:
                              </span>
                              <span className="font-mono truncate">
                                {row.original.creation
                                  ? new Date(
                                      row.original.creation,
                                    ).toLocaleString()
                                  : "-"}
                              </span>
                            </div>
                            <div className="flex gap-2">
                              <span className="text-muted-foreground shrink-0">
                                {t("modification_time")}:
                              </span>
                              <span className="font-mono truncate">
                                {row.original.modification
                                  ? new Date(
                                      row.original.modification,
                                    ).toLocaleString()
                                  : "-"}
                              </span>
                            </div>
                            <div className="flex gap-2">
                              <span className="text-muted-foreground shrink-0">
                                {t("comment")}:
                              </span>
                              <span
                                className="font-mono truncate"
                                title={row.original.comment}
                              >
                                {row.original.comment || "-"}
                              </span>
                            </div>
                            <div className="flex gap-2">
                              <span className="text-muted-foreground shrink-0">
                                {t("creator")}:
                              </span>
                              <span
                                className="font-mono truncate"
                                title={row.original.creator}
                              >
                                {row.original.creator || "-"}
                              </span>
                            </div>
                          </div>
                          <div className="flex gap-4 text-muted-foreground">
                            <span>
                              {t("alias")}:{" "}
                              <span className="text-foreground">
                                {formatBoolean(row.original.alias)}
                              </span>
                            </span>
                            <span>
                              {t("invisible")}:{" "}
                              <span className="text-foreground">
                                {formatBoolean(row.original.invisible)}
                              </span>
                            </span>
                            <span>
                              {t("custom_icon")}:{" "}
                              <span className="text-foreground">
                                {formatBoolean(row.original.customIcon)}
                              </span>
                            </span>
                          </div>
                          {row.original.data && (
                            <div className="flex gap-2">
                              <span className="text-muted-foreground shrink-0">
                                {t("data")}:
                              </span>
                              <span
                                className="font-mono truncate"
                                title={row.original.data}
                              >
                                {row.original.data}
                              </span>
                            </div>
                          )}
                          {row.original.raw && (
                            <div>
                              <div className="flex items-center gap-1 mb-1">
                                <span className="text-muted-foreground">
                                  {t("raw")}:
                                </span>
                                <Button
                                  variant="ghost"
                                  size="icon"
                                  className="h-5 w-5"
                                  onClick={() => downloadRaw(row.original)}
                                  title={t("download")}
                                >
                                  <Download className="h-3 w-3" />
                                </Button>
                                <Button
                                  variant="ghost"
                                  size="icon"
                                  className="h-5 w-5"
                                  onClick={() =>
                                    copyToClipboardRaw(row.original, row.id)
                                  }
                                  title={t("copy")}
                                >
                                  {copySuccessIndex === row.id ? (
                                    <Check className="h-3 w-3 text-green-500" />
                                  ) : (
                                    <Copy className="h-3 w-3" />
                                  )}
                                </Button>
                              </div>
                              <pre className="font-mono text-xs bg-background/50 p-2 rounded overflow-x-auto max-h-40">
                                {hexDump(row.original.raw)}
                              </pre>
                            </div>
                          )}
                        </div>
                      </td>
                    </tr>
                  )}
                </>
              ))}
            </tbody>
          </table>
        )}
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/FruityNSURLTab.tsx`:

```tsx
import { useCallback, useEffect, useRef, useState } from "react";
import { useQuery, useMutation } from "@tanstack/react-query";
import {
  Trash2,
  ArrowUp,
  ArrowDown,
  Download,
  Copy,
  Check,
  Loader2,
  Play,
  Square,
  ChevronsDown,
} from "lucide-react";

import {
  formats,
  generate,
  type FormatId,
  type RequestInfo,
} from "@/lib/codegen";

import { Button, buttonVariants } from "@/components/ui/button";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import { ScrollArea } from "@/components/ui/scroll-area";
import {
  ResizableHandle,
  ResizablePanel,
  ResizablePanelGroup,
} from "@/components/ui/resizable";

import { HttpResponseBodyView } from "@/components/shared/HttpResponseBodyView";
import { useSession, Status } from "@/context/SessionContext";

const TAP_ID = "nsurl";
import { useFruityQuery } from "@/lib/queries";
import type { NSURLEvent } from "@/lib/rpc";

interface WebSocketMessage {
  direction: "send" | "receive";
  messageType: "data" | "string";
  message?: string;
  dataLength?: number;
  error?: string;
  timestamp: number;
}

interface CapturedRequest {
  id: string;
  method: string;
  url: string;
  statusCode?: number;
  mimeType?: string;
  size: bigint;
  startTime: number;
  endTime?: number;
  duration?: number;
  requestHeaders: Record<string, string>;
  responseHeaders?: Record<string, string>;
  requestBody?: string;
  error?: string;
  mechanism?: string;
  isWebSocket?: boolean;
  wsMessages?: WebSocketMessage[];
  attachment?: string | null;
}

function formatSize(bytes: bigint | number): string {
  const n = Number(bytes);
  if (!n || n <= 0) return "0 B";
  const units = ["B", "KB", "MB", "GB", "TB"];
  const i = Math.min(
    Math.floor(Math.log(n) / Math.log(1024)),
    units.length - 1,
  );
  return `${(n / Math.pow(1024, i)).toFixed(i > 0 ? 1 : 0)} ${units[i]}`;
}

function formatDuration(ms: number | undefined): string {
  if (ms === undefined) return "-";
  if (ms < 1000) return `${ms}ms`;
  return `${(ms / 1000).toFixed(2)}s`;
}

function statusColor(code: number | undefined): string {
  if (!code) return "";
  if (code >= 200 && code < 300) return "text-green-600";
  if (code >= 300 && code < 400) return "text-yellow-600";
  if (code >= 400) return "text-red-600";
  return "";
}

function parseUrl(raw: string): {
  pathname: string;
  host: string;
  params: [string, string][];
} {
  try {
    const u = new URL(raw);
    return {
      pathname: u.pathname,
      host: u.host,
      params: [...u.searchParams.entries()],
    };
  } catch {
    return { pathname: raw, host: "", params: [] };
  }
}

function parseCookieValue(value: string): { key: string; value: string }[] {
  return value.split(/;\s*/).map((pair) => {
    const eq = pair.indexOf("=");
    if (eq === -1) return { key: pair.trim(), value: "" };
    return { key: pair.substring(0, eq).trim(), value: pair.substring(eq + 1) };
  });
}

function handleEventPure(
  map: Map<string, CapturedRequest>,
  event: NSURLEvent,
) {
  const { event: eventType, requestId } = event;

  function getOrCreate(id: string): CapturedRequest {
    let entry = map.get(id);
    if (!entry) {
      entry = {
        id,
        method: "",
        url: "",
        requestHeaders: {},
        size: 0n,
        startTime: event.timestamp,
      };
      map.set(id, entry);
    }
    return entry;
  }

  switch (eventType) {
    case "requestWillBeSent": {
      const req = event["request"] as
        | {
            method: string;
            url: string;
            headers: Record<string, string>;
            body?: string;
          }
        | undefined;
      if (!req) break;
      const entry = getOrCreate(requestId);
      entry.method = req.method;
      entry.url = req.url;
      entry.requestHeaders = req.headers || {};
      entry.requestBody = req.body;
      break;
    }
    case "responseReceived": {
      const resp = event["response"] as
        | {
            url?: string;
            mimeType?: string;
            statusCode?: number;
            headers?: Record<string, string>;
          }
        | undefined;
      if (!resp) break;
      const entry = getOrCreate(requestId);
      entry.statusCode = resp.statusCode;
      entry.mimeType = resp.mimeType;
      entry.responseHeaders = resp.headers;
      if (resp.url && !entry.url) entry.url = resp.url;
      break;
    }
    case "dataReceived": {
      const entry = getOrCreate(requestId);
      try {
        entry.size += BigInt(event["dataLength"] as string);
      } catch {
        /* ignore invalid */
      }
      break;
    }
    case "loadingFinished": {
      const entry = getOrCreate(requestId);
      entry.endTime = event.timestamp;
      entry.duration = event.timestamp - entry.startTime;
      if (event["hasBody"] || event["attachment"]) {
        entry.attachment = entry.attachment ?? requestId;
      }
      break;
    }
    case "loadingFailed": {
      const entry = getOrCreate(requestId);
      entry.error = event["error"] as string | undefined;
      entry.endTime = event.timestamp;
      entry.duration = event.timestamp - entry.startTime;
      break;
    }
    case "mechanism": {
      const entry = getOrCreate(requestId);
      entry.mechanism = event["mechanism"] as string | undefined;
      break;
    }
    case "webSocketSend":
    case "webSocketReceive": {
      const entry = getOrCreate(requestId);
      entry.isWebSocket = true;
      if (!entry.method) entry.method = "WS";
      if (!entry.wsMessages) entry.wsMessages = [];
      entry.wsMessages.push({
        direction: eventType === "webSocketSend" ? "send" : "receive",
        messageType: (event["messageType"] as "data" | "string") ?? "data",
        message: event["message"] as string | undefined,
        dataLength: event["dataLength"]
          ? Number(event["dataLength"])
          : undefined,
        error: event["error"] as string | undefined,
        timestamp: event.timestamp,
      });
      break;
    }
  }
}

function HeadersView({
  headers,
}: {
  headers: Record<string, string> | undefined;
}) {
  if (!headers || Object.keys(headers).length === 0) return <span>(none)</span>;

  const entries = Object.entries(headers);
  return (
    <div className="space-y-0.5">
      {entries.map(([k, v], i) => {
        const lower = k.toLowerCase();
        const isCookie = lower === "cookie" || lower === "set-cookie";
        return (
          <div key={i} className="text-xs font-mono break-all">
            <span className="text-blue-500 dark:text-blue-400">{k}</span>
            <span className="text-muted-foreground">: </span>
            {isCookie ? (
              <span>
                {parseCookieValue(v).map((c, j) => (
                  <span key={j}>
                    {j > 0 && <span className="text-muted-foreground">; </span>}
                    <span className="text-blue-500 dark:text-blue-400">
                      {c.key}
                    </span>
                    {c.value && (
                      <>
                        <span className="text-muted-foreground">=</span>
                        <span className="text-emerald-600 dark:text-emerald-400">
                          {c.value}
                        </span>
                      </>
                    )}
                  </span>
                ))}
              </span>
            ) : (
              <span className="text-foreground">{v}</span>
            )}
          </div>
        );
      })}
    </div>
  );
}

function CopyAsButtons({ request }: { request: RequestInfo }) {
  const [copied, setCopied] = useState<FormatId | null>(null);

  const handleCopy = useCallback(
    (id: FormatId) => {
      navigator.clipboard.writeText(generate(id, request));
      setCopied(id);
      setTimeout(() => setCopied(null), 1500);
    },
    [request],
  );

  return (
    <div className="flex items-center gap-2 mt-2">
      <span className="text-xs text-muted-foreground">Copy as</span>
      {formats.map((f) => (
        <button
          key={f.id}
          onClick={() => handleCopy(f.id)}
          className="inline-flex items-center gap-1.5 h-7 px-2.5 text-xs border rounded-md border-input text-foreground hover:bg-accent transition cursor-pointer"
        >
          {copied === f.id ? (
            <Check className="w-3.5 h-3.5 text-green-500" />
          ) : (
            <Copy className="w-3.5 h-3.5" />
          )}
          {f.label}
        </button>
      ))}
    </div>
  );
}

export function FruityNSURLTab() {
  const { socket, status, device, identifier, fruity } = useSession();

  const [requests, setRequests] = useState<Map<string, CapturedRequest>>(
    () => new Map(),
  );
  const [selectedId, setSelectedId] = useState<string | null>(null);
  const tableEndRef = useRef<HTMLDivElement>(null);
  const pendingRef = useRef<NSURLEvent[]>([]);
  const timerRef = useRef<ReturnType<typeof setTimeout> | null>(null);

  // NSURL hook toggle
  const [hookEnabled, setHookEnabled] = useState<boolean | null>(null);
  const [hookLoading, setHookLoading] = useState(false);

  const { data: initialActive } = useFruityQuery<boolean>(
    ["nsurlActive", device ?? "", identifier ?? ""],
    (api) => api.taps.active(TAP_ID),
  );

  // Seed local state from the first successful query; never override manual toggles
  useEffect(() => {
    if (initialActive !== undefined && hookEnabled === null) {
      setHookEnabled(initialActive);
    }
  }, [initialActive, hookEnabled]);

  const handleToggleHook = async (enabled: boolean) => {
    if (!fruity) return;
    setHookLoading(true);
    try {
      if (enabled) {
        await fruity.taps.start(TAP_ID);
      } else {
        await fruity.taps.stop(TAP_ID);
      }
      setHookEnabled(enabled);
    } catch (error) {
      console.error(
        `Failed to ${enabled ? "start" : "stop"} NSURL hook:`,
        error,
      );
    } finally {
      setHookLoading(false);
    }
  };

  const flushPending = useCallback(() => {
    timerRef.current = null;
    if (pendingRef.current.length === 0) return;

    const incoming = pendingRef.current;
    pendingRef.current = [];

    setRequests((prev) => {
      const next = new Map(prev);
      for (const event of incoming) {
        handleEventPure(next, event);
      }
      return next;
    });
  }, []);

  useEffect(() => {
    if (status !== Status.Ready || !socket) return;

    const onNsurl = (event: NSURLEvent) => {
      pendingRef.current.push(event);
      if (!timerRef.current) {
        timerRef.current = setTimeout(flushPending, 100);
      }
    };

    socket.on("nsurl", onNsurl);
    return () => {
      socket.off("nsurl", onNsurl);
      if (timerRef.current) {
        clearTimeout(timerRef.current);
        timerRef.current = null;
      }
    };
  }, [socket, status, flushPending]);

  // Load historical NSURL records from database
  const { data: nsurlHistory } = useQuery<{
    requests: (CapturedRequest & { size: string | number })[];
  }>({
    queryKey: ["nsurlHistory", device, identifier],
    queryFn: async () => {
      const res = await fetch(
        `/api/history/nsurl/${device}/${identifier}?limit=5000`,
      );
      if (!res.ok) throw new Error("Failed to load NSURL history");
      return res.json();
    },
    enabled: !!device && !!identifier,
    staleTime: Infinity,
    gcTime: 0,
  });

  useEffect(() => {
    if (!nsurlHistory?.requests?.length) return;
    setRequests(() => {
      const map = new Map<string, CapturedRequest>();
      for (const req of [...nsurlHistory.requests].reverse()) {
        map.set(req.id, { ...req, size: BigInt(req.size || 0) });
      }
      return map;
    });
  }, [nsurlHistory]);

  const clearNsurlMutation = useMutation({
    mutationFn: async () => {
      if (!device || !identifier) return;
      const res = await fetch(`/api/history/nsurl/${device}/${identifier}`, {
        method: "DELETE",
      });
      if (!res.ok)
        throw new Error("Failed to clear NSURL records from database");
    },
  });

  const handleClear = () => {
    setRequests(new Map());
    setSelectedId(null);
    clearNsurlMutation.mutate();
  };

  const requestList = Array.from(requests.values());
  const selectedRequest = selectedId ? requests.get(selectedId) : null;

  return (
    <div className="flex flex-col h-full">
      {/* Toolbar */}
      <div className="flex items-center gap-2 p-2 border-b">
        {hookEnabled ? (
          <Button
            variant="outline"
            size="sm"
            className="h-8 px-2.5 text-xs text-red-500 hover:text-red-600"
            onClick={() => handleToggleHook(false)}
            disabled={hookLoading || status !== Status.Ready}
          >
            {hookLoading ? (
              <Loader2 className="w-3.5 h-3.5 animate-spin" />
            ) : (
              <Square className="w-3.5 h-3.5" />
            )}
            Stop
          </Button>
        ) : (
          <Button
            variant="outline"
            size="sm"
            className="h-8 px-2.5 text-xs text-green-600 hover:text-green-700"
            onClick={() => handleToggleHook(true)}
            disabled={hookLoading || status !== Status.Ready}
          >
            {hookLoading ? (
              <Loader2 className="w-3.5 h-3.5 animate-spin" />
            ) : (
              <Play className="w-3.5 h-3.5" />
            )}
            Start
          </Button>
        )}
        <a
          href={`/api/history/nsurl/${device}/${identifier}/har`}
          download={`${identifier}.har`}
          className={buttonVariants({ variant: "outline", size: "sm" }) + " h-8 px-2.5 text-xs no-underline"}
        >
          <Download className="w-3.5 h-3.5" />
          Export HAR
        </a>
        <span className="text-xs text-muted-foreground ml-auto">
          {requestList.length} request{requestList.length !== 1 ? "s" : ""}
        </span>
        <Button
          variant="ghost"
          size="icon"
          className="h-8 w-8"
          onClick={() =>
            tableEndRef.current?.scrollIntoView({ behavior: "smooth" })
          }
        >
          <ChevronsDown className="w-4 h-4" />
        </Button>
        <Button
          variant="ghost"
          size="icon"
          className="h-8 w-8 text-red-500 hover:text-red-600 hover:bg-red-100 dark:hover:bg-red-950/30"
          onClick={handleClear}
        >
          <Trash2 className="w-4 h-4" />
        </Button>
      </div>

      <ResizablePanelGroup orientation="vertical" className="flex-1">
        {/* Request List */}
        <ResizablePanel
          defaultSize={selectedRequest ? "50%" : "100%"}
          minSize="20%"
        >
          <ScrollArea className="h-full">
            <Table>
              <TableHeader>
                <TableRow>
                  <TableHead className="w-16">Method</TableHead>
                  <TableHead>URL</TableHead>
                  <TableHead className="w-16">Status</TableHead>
                  <TableHead className="w-24">MIME</TableHead>
                  <TableHead className="w-16">Size</TableHead>
                  <TableHead className="w-16">Time</TableHead>
                </TableRow>
              </TableHeader>
              <TableBody>
                {requestList.map((req) => (
                  <TableRow
                    key={req.id}
                    className={`cursor-pointer ${selectedId === req.id ? "bg-accent" : ""} ${req.error ? "text-red-500" : ""}`}
                    onClick={() =>
                      setSelectedId(selectedId === req.id ? null : req.id)
                    }
                  >
                    <TableCell className="font-mono text-xs">
                      {req.method}
                    </TableCell>
                    <TableCell
                      className="font-mono text-xs max-w-md truncate"
                      title={req.url}
                    >
                      {req.url}
                    </TableCell>
                    <TableCell
                      className={`font-mono text-xs ${statusColor(req.statusCode)}`}
                    >
                      {req.statusCode ?? (req.error ? "ERR" : "-")}
                    </TableCell>
                    <TableCell className="text-xs truncate max-w-24">
                      {req.isWebSocket
                        ? `websocket (${req.wsMessages?.length ?? 0})`
                        : (req.mimeType ?? "-")}
                    </TableCell>
                    <TableCell className="text-xs">
                      {req.size > 0n ? formatSize(req.size) : "-"}
                    </TableCell>
                    <TableCell className="text-xs">
                      {formatDuration(req.duration)}
                    </TableCell>
                  </TableRow>
                ))}
              </TableBody>
            </Table>
            <div ref={tableEndRef} />
          </ScrollArea>
        </ResizablePanel>

        {selectedRequest && (
          <>
            <ResizableHandle />
            <ResizablePanel defaultSize="50%" minSize="20%">
              <Tabs defaultValue="request" className="h-full flex flex-col">
                <TabsList variant="line" className="mx-2 mt-2">
                  <TabsTrigger value="request">Request</TabsTrigger>
                  <TabsTrigger value="response">Response</TabsTrigger>
                  {selectedRequest.isWebSocket && (
                    <TabsTrigger value="messages">
                      Messages
                      {selectedRequest.wsMessages
                        ? ` (${selectedRequest.wsMessages.length})`
                        : ""}
                    </TabsTrigger>
                  )}
                </TabsList>

                <TabsContent value="request" className="overflow-auto">
                  <ScrollArea className="h-full">
                    {(() => {
                      const parsed = parseUrl(selectedRequest.url);
                      return (
                        <div className="p-3">
                          <div>
                            <div className="text-xs font-semibold text-muted-foreground mb-1">
                              General
                            </div>
                            <pre className="text-xs font-mono whitespace-pre-wrap break-all">
                              {selectedRequest.method} {parsed.pathname}
                              {`\nHost: ${parsed.host}`}
                              {selectedRequest.mechanism &&
                                `\nMechanism: ${selectedRequest.mechanism}`}
                            </pre>
                            <CopyAsButtons
                              request={{
                                method: selectedRequest.method,
                                url: selectedRequest.url,
                                headers: selectedRequest.requestHeaders,
                                body: selectedRequest.requestBody,
                              }}
                            />
                          </div>
                          <div className="grid grid-cols-2 gap-3 mt-3">
                            <div className="space-y-3">
                              {parsed.params.length > 0 && (
                                <div>
                                  <div className="text-xs font-semibold text-muted-foreground mb-1">
                                    Query Parameters
                                  </div>
                                  <div className="space-y-0.5">
                                    {parsed.params.map(([k, v], i) => (
                                      <div
                                        key={i}
                                        className="text-xs font-mono break-all"
                                      >
                                        <span className="text-muted-foreground">
                                          {k}:
                                        </span>{" "}
                                        {v}
                                      </div>
                                    ))}
                                  </div>
                                </div>
                              )}
                              <div>
                                <div className="text-xs font-semibold text-muted-foreground mb-1">
                                  Headers
                                </div>
                                <HeadersView
                                  headers={selectedRequest.requestHeaders}
                                />
                              </div>
                            </div>
                            <div>
                              <div className="text-xs font-semibold text-muted-foreground mb-1">
                                Body
                              </div>
                              <pre className="text-xs font-mono whitespace-pre-wrap break-all">
                                {selectedRequest.requestBody || "(none)"}
                              </pre>
                            </div>
                          </div>
                        </div>
                      );
                    })()}
                  </ScrollArea>
                </TabsContent>

                <TabsContent
                  value="response"
                  className="overflow-hidden h-full"
                >
                  <div className="grid grid-cols-2 h-full min-h-0">
                    <ScrollArea className="h-full border-r overflow-hidden">
                      <div className="p-3 space-y-3">
                        <div>
                          <div className="text-xs font-semibold text-muted-foreground mb-1">
                            Status
                          </div>
                          <pre className="text-xs font-mono whitespace-pre-wrap break-all">
                            {selectedRequest.statusCode ?? "Pending"}
                            {selectedRequest.error &&
                              ` (Error: ${selectedRequest.error})`}
                          </pre>
                        </div>
                        <div>
                          <div className="text-xs font-semibold text-muted-foreground mb-1">
                            Headers
                          </div>
                          <HeadersView
                            headers={selectedRequest.responseHeaders}
                          />
                        </div>
                      </div>
                    </ScrollArea>
                    <div className="h-full flex flex-col overflow-hidden">
                      <div className="flex items-center gap-2 p-3 pb-0">
                        <div className="text-xs font-semibold text-muted-foreground">
                          Body
                        </div>
                        {selectedRequest.attachment && (
                          <a
                            href={`/api/history/nsurl/${device}/${identifier}/attachment/${encodeURIComponent(selectedRequest.id)}`}
                            download={selectedRequest.id}
                            className="inline-flex items-center gap-1 h-5 px-1.5 text-[10px] border rounded border-input text-foreground hover:bg-accent transition"
                          >
                            <Download className="w-3 h-3" />
                            Download
                          </a>
                        )}
                      </div>
                      <div className="flex-1 min-h-0 p-3">
                        {selectedRequest.attachment ? (
                          <HttpResponseBodyView
                            url={`/api/history/nsurl/${device}/${identifier}/attachment/${encodeURIComponent(selectedRequest.id)}`}
                            mime={selectedRequest.mimeType}
                          />
                        ) : (
                          <span className="text-xs text-muted-foreground">
                            (none)
                          </span>
                        )}
                      </div>
                    </div>
                  </div>
                </TabsContent>

                {selectedRequest.isWebSocket && (
                  <TabsContent value="messages" className="overflow-auto">
                    <ScrollArea className="h-full">
                      <div className="p-3">
                        {!selectedRequest.wsMessages?.length ? (
                          <div className="text-xs text-muted-foreground text-center py-4">
                            No messages yet
                          </div>
                        ) : (
                          <div className="space-y-1">
                            {selectedRequest.wsMessages.map((msg, i) => (
                              <div
                                key={i}
                                className={`flex items-start gap-2 text-xs font-mono p-1.5 rounded ${
                                  msg.direction === "send"
                                    ? "bg-blue-50 dark:bg-blue-950/30"
                                    : "bg-green-50 dark:bg-green-950/30"
                                }`}
                              >
                                {msg.direction === "send" ? (
                                  <ArrowUp className="w-3 h-3 mt-0.5 text-blue-500 shrink-0" />
                                ) : (
                                  <ArrowDown className="w-3 h-3 mt-0.5 text-green-500 shrink-0" />
                                )}
                                <div className="min-w-0 flex-1">
                                  {msg.message ? (
                                    <pre className="whitespace-pre-wrap break-all">
                                      {msg.message}
                                    </pre>
                                  ) : (
                                    <span className="text-muted-foreground">
                                      [{msg.messageType}
                                      {msg.dataLength !== undefined &&
                                        ` ${formatSize(msg.dataLength)}`}
                                      ]
                                    </span>
                                  )}
                                  {msg.error && (
                                    <span className="text-red-500">
                                      {" "}
                                      Error: {msg.error}
                                    </span>
                                  )}
                                </div>
                              </div>
                            ))}
                          </div>
                        )}
                      </div>
                    </ScrollArea>
                  </TabsContent>
                )}
              </Tabs>
            </ResizablePanel>
          </>
        )}
      </ResizablePanelGroup>
    </div>
  );
}

```

`gui/src/components/tabs/FruityPlistPreviewTab.tsx`:

```tsx
import { useTranslation } from "react-i18next";
import type { IDockviewPanelProps } from "dockview";
import { Loader2 } from "lucide-react";

import { PlistView } from "@/components/shared/UnifiedPlistViewer";
import { type PlistValue } from "@/components/shared/PlistTreeView";
import { useFruityQuery } from "@/lib/queries";

export interface PlistFilePreviewTabParams {
  path: string;
}

export function FruityPlistPreviewTab({
  params,
}: IDockviewPanelProps<PlistFilePreviewTabParams>) {
  const { t } = useTranslation();

  const fullPath = params?.path || "";

  const {
    data,
    isLoading,
    error,
  } = useFruityQuery(
    ["plistPreview", fullPath],
    (api) => api.fs.plist(fullPath),
    { enabled: !!fullPath }
  );

  if (isLoading) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        <Loader2 className="w-6 h-6 animate-spin mr-2" />
        {t("loading")}
      </div>
    );
  }

  if (error) {
    return (
      <div className="flex items-center justify-center h-full text-destructive">
        {(error as Error).message}
      </div>
    );
  }

  return (
    <PlistView
      xml={data?.xml ?? ""}
      value={(data?.value as PlistValue) ?? null}
      filename={fullPath.split("/").pop() || "plist"}
    />
  );
}

```

`gui/src/components/tabs/FruityUIDumpTab.tsx`:

```tsx
import { useState, useCallback, useEffect } from "react";
import { useTranslation } from "react-i18next";
import { useSession } from "@/context/SessionContext";
import { useDock } from "@/context/DockContext";
import { RefreshCw, Copy, Check, ChevronsDownUp, ChevronsUpDown } from "lucide-react";
import { Button } from "@/components/ui/button";
import { Spinner } from "@/components/ui/spinner";
import { ScrollArea } from "@/components/ui/scroll-area";
import { ButtonGroup } from "@/components/ui/button-group";
import { Tooltip, TooltipTrigger, TooltipContent } from "@/components/ui/tooltip";
import { useFruityQuery } from "@/lib/queries";

const FONT_SIZES = [0.75, 1, 1.25, 1.5] as const;

import type { UIDumpNode } from "@agent/fruity/modules/ui";

// Tokenizer for description syntax highlighting
function* tokenize(text: string, delimiters: string): IterableIterator<string> {
  let left = 0;
  for (let i = 0; i < text.length; i++) {
    const ch = text.charAt(i);
    if (delimiters.includes(ch)) {
      if (left < i) yield text.substring(left, i);
      yield ch;
      left = i + 1;
    }
  }
  yield text.substring(left);
}

interface Token {
  type: string;
  word: string;
}

function* scan(text: string): IterableIterator<Token> {
  const delimiters = "'<>: ;=()";
  let prev: string | undefined;
  let type: string;
  const operators = "<,>;:=";
  const booleanValues = ["YES", "NO"];
  const tokens = tokenize(text, delimiters);

  for (const token of tokens) {
    if (token === "'") {
      let word = token;
      for (const next of tokens) {
        word += next;
        if (next === "'") break;
      }
      yield { type: "str", word };
      continue;
    }
    if (token.match(/^0x?[\da-fA-F]+$/)) {
      type = "hex";
    } else if (token.match(/^[\d.]+$/)) {
      type = "num";
    } else if (operators.includes(token)) {
      type = "op";
    } else if (prev === "<") {
      type = "clazz";
    } else if (booleanValues.includes(token)) {
      type = "bool";
    } else {
      type = "";
    }
    yield { type, word: token };
    prev = token;
  }
}

// Description component with syntax highlighting
function Description({ text }: { text: string }) {
  const tokens = [...scan(text)];

  const typeToClass: Record<string, string> = {
    num: "text-amber-600 dark:text-amber-400",
    str: "text-purple-600 dark:text-purple-400",
    hex: "text-yellow-600 dark:text-yellow-500",
    bool: "text-green-600 dark:text-green-500",
    op: "text-teal-600 dark:text-teal-400",
    clazz: "text-pink-600 dark:text-pink-500 cursor-pointer hover:bg-black/10 dark:hover:bg-black/20",
  };

  return (
    <span className="text-muted-foreground">
      {tokens.map((token, i) => {
        if (!token.type) return token.word;
        return (
          <span key={i} className={typeToClass[token.type] || ""}>
            {token.word}
          </span>
        );
      })}
    </span>
  );
}

interface TreeNodeProps {
  node: UIDumpNode;
  depth?: number;
  defaultExpanded?: boolean;
  onHighlight?: (node: UIDumpNode) => void;
  onDismissHighlight?: () => void;
  onOpenClass?: (className: string) => void;
}

function TreeNode({
  node,
  depth = 0,
  defaultExpanded = true,
  onHighlight,
  onDismissHighlight,
  onOpenClass,
}: TreeNodeProps) {
  const [expanded, setExpanded] = useState(defaultExpanded);
  const hasChildren = node.children && node.children.length > 0;

  return (
    <li className="font-mono text-xs list-none">
      <p
        className="flex items-start gap-1 py-0.5 cursor-pointer transition-colors duration-200 whitespace-nowrap hover:bg-accent"
        style={{ paddingLeft: `${(depth + 1) * 16}px` }}
        onMouseEnter={() => onHighlight?.(node)}
        onMouseLeave={() => onDismissHighlight?.()}
      >
        {hasChildren ? (
          <span
            onClick={(e) => {
              e.stopPropagation();
              setExpanded(!expanded);
            }}
            className="cursor-pointer text-muted-foreground hover:text-foreground select-none w-4"
          >
            {expanded ? "−" : "+"}
          </span>
        ) : (
          <span className="text-muted-foreground w-4">·</span>
        )}
        {node.description ? (
          <Description text={node.description} />
        ) : (
          <span className="text-amber-600 dark:text-amber-400">{node.clazz}</span>
        )}
        {node.delegate?.name && (
          <span
            className="ml-4 text-yellow-700 dark:text-yellow-200 bg-muted px-1 cursor-pointer hover:text-yellow-600 dark:hover:text-yellow-400"
            title={node.delegate.name}
            onClick={(e) => {
              e.stopPropagation();
              if (node.delegate?.name) {
                onOpenClass?.(node.delegate.name);
              }
            }}
          >
            delegate: {node.delegate.description || node.delegate.name}
          </span>
        )}
      </p>
      {expanded && hasChildren && (
        <ul>
          {node.children!.map((child, i) => (
            <TreeNode
              key={i}
              node={child}
              depth={depth + 1}
              defaultExpanded={defaultExpanded}
              onHighlight={onHighlight}
              onDismissHighlight={onDismissHighlight}
              onOpenClass={onOpenClass}
            />
          ))}
        </ul>
      )}
    </li>
  );
}

// Recursively collect descriptions from tree
function collectDescriptions(node: UIDumpNode, depth: number = 0): string[] {
  const lines: string[] = [];
  const indent = "  ".repeat(depth);
  const text = node.description || node.clazz;
  const delegate = node.delegate?.description || node.delegate?.name;
  lines.push(indent + text + (delegate ? ` [delegate: ${delegate}]` : ""));
  if (node.children) {
    for (const child of node.children) {
      lines.push(...collectDescriptions(child, depth + 1));
    }
  }
  return lines;
}

export function FruityUIDumpTab() {
  const { t } = useTranslation();
  const { fruity } = useSession();
  const { openFilePanel } = useDock();
  const [scale, setScale] = useState(1);
  const [expandKey, setExpandKey] = useState(0);
  const [allExpanded, setAllExpanded] = useState(true);
  const [copied, setCopied] = useState(false);

  const { data, isLoading, error, refetch } = useFruityQuery(
    ["uiDump"],
    // Don't include preview (screenshots) - it's slow
    (api) => api.ui.dump(),
  );

  const handleHighlight = useCallback(
    (node: UIDumpNode) => {
      if (fruity && node.frame) {
        fruity.ui.highlight(node.frame).catch(() => {});
      }
    },
    [fruity],
  );

  const handleDismissHighlight = useCallback(() => {
    if (fruity) {
      fruity.ui.dismissHighlight().catch(() => {});
    }
  }, [fruity]);

  const handleCopy = useCallback(() => {
    if (!data) return;
    const text = collectDescriptions(data).join("\n");
    navigator.clipboard.writeText(text).then(() => {
      setCopied(true);
    }).catch(() => {});
  }, [data]);

  useEffect(() => {
    if (copied) {
      const timer = setTimeout(() => setCopied(false), 2000);
      return () => clearTimeout(timer);
    }
  }, [copied]);

  useEffect(() => {
    return () => {
      fruity?.ui.dismissHighlight().catch(() => {});
    };
  }, [fruity]);

  const handleExpandAll = useCallback(() => {
    setAllExpanded(true);
    setExpandKey((k) => k + 1);
  }, []);

  const handleCollapseAll = useCallback(() => {
    setAllExpanded(false);
    setExpandKey((k) => k + 1);
  }, []);

  const handleOpenClass = useCallback(
    (className: string) => {
      openFilePanel({
        id: `class_${className}`,
        component: "classDetail",
        title: className,
        params: { className },
      });
    },
    [openFilePanel],
  );

  return (
    <div className="h-full flex flex-col">
      <div className="flex items-center justify-between p-3 border-b border-border">
        <ButtonGroup>
          <Tooltip>
            <TooltipTrigger render={<Button
                variant="outline"
                size="sm"
                onClick={() => refetch()}
                disabled={isLoading}
              />}>
                <RefreshCw
                  className={`h-4 w-4 ${isLoading ? "animate-spin" : ""}`}
                />
            </TooltipTrigger>
            <TooltipContent>{t("reload")}</TooltipContent>
          </Tooltip>
          <Tooltip>
            <TooltipTrigger render={<Button variant="outline" size="sm" onClick={handleExpandAll} />}>
                <ChevronsUpDown className="h-4 w-4" />
            </TooltipTrigger>
            <TooltipContent>{t("expand_all")}</TooltipContent>
          </Tooltip>
          <Tooltip>
            <TooltipTrigger render={<Button variant="outline" size="sm" onClick={handleCollapseAll} />}>
                <ChevronsDownUp className="h-4 w-4" />
            </TooltipTrigger>
            <TooltipContent>{t("collapse_all")}</TooltipContent>
          </Tooltip>
          <Tooltip>
            <TooltipTrigger render={<Button
                variant="outline"
                size="sm"
                onClick={handleCopy}
                className={copied ? "text-green-600 border-green-600 dark:text-green-400 dark:border-green-400" : ""}
              />}>
                {copied ? (
                  <Check className="h-4 w-4" />
                ) : (
                  <Copy className="h-4 w-4" />
                )}
            </TooltipTrigger>
            <TooltipContent>{copied ? t("copied") : t("copy")}</TooltipContent>
          </Tooltip>
        </ButtonGroup>
        <ButtonGroup>
          {FONT_SIZES.map((s) => (
            <Button
              key={s}
              variant={scale === s ? "default" : "outline"}
              size="sm"
              onClick={() => setScale(s)}
            >
              {Math.round(s * 100)}%
            </Button>
          ))}
        </ButtonGroup>
      </div>

      {error && (
        <div className="p-4 text-sm text-red-500 dark:text-red-400">
          {(error as Error)?.message || "Failed to dump UI"}
        </div>
      )}

      <div className="flex-1 overflow-auto">
        <ScrollArea className="h-full">
          <ul
            className="p-2"
            style={{
              transform: `scale(${scale})`,
              transformOrigin: "top left",
            }}
          >
            {isLoading && !data ? (
              <div className="text-sm text-muted-foreground flex items-center gap-2"><Spinner />{t("loading")}</div>
            ) : data ? (
              <TreeNode
                key={expandKey}
                node={data}
                defaultExpanded={allExpanded}
                onHighlight={handleHighlight}
                onDismissHighlight={handleDismissHighlight}
                onOpenClass={handleOpenClass}
              />
            ) : (
              <div className="text-sm text-muted-foreground">
                {t("no_data")}
              </div>
            )}
          </ul>
        </ScrollArea>
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/FruityUserDefaultsTab.tsx`:

```tsx
import { useState, useMemo } from "react";
import { useTranslation } from "react-i18next";
import {
  RefreshCw,
  Trash2,
  Search,
  Edit2,
  Check,
  X,
  CalendarIcon,
  Clock,
} from "lucide-react";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Spinner } from "@/components/ui/spinner";
import { Calendar } from "@/components/ui/calendar";
import {
  Popover,
  PopoverContent,
  PopoverTrigger,
} from "@/components/ui/popover";
import { Label } from "@/components/ui/label";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";
import { useFruityQuery, useFruityMutation, useQueryClient } from "@/lib/queries";
import {
  useReactTable,
  getCoreRowModel,
  flexRender,
  type ColumnDef,
  type ColumnResizeMode,
} from "@tanstack/react-table";

import type { UserDefaultsEntry } from "@agent/fruity/modules/userdefaults";

interface UserDefaultsItem extends UserDefaultsEntry {
  key: string;
}

function getTypeBadgeColor(type: string): string {
  switch (type) {
    case "string":
      return "bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";
    case "number":
      return "bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200";
    case "date":
      return "bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200";
    case "data":
      return "bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200";
    case "array":
      return "bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";
    case "dict":
      return "bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200";
    default:
      return "bg-muted text-muted-foreground";
  }
}

export function FruityUserDefaultsTab() {
  const { t } = useTranslation();
  const queryClient = useQueryClient();
  const [searchQuery, setSearchQuery] = useState("");
  const [editingKey, setEditingKey] = useState<string | null>(null);
  const [editValue, setEditValue] = useState("");
  const [datePickerKey, setDatePickerKey] = useState<string | null>(null);
  const [datePickerValue, setDatePickerValue] = useState<Date | undefined>(
    undefined,
  );
  const [timeHours, setTimeHours] = useState<string>("00");
  const [timeMinutes, setTimeMinutes] = useState<string>("00");
  const [timeSeconds, setTimeSeconds] = useState<string>("00");
  const [columnSizing, setColumnSizing] = useState<Record<string, number>>({});

  const {
    data: defaults,
    isLoading,
    refetch,
  } = useFruityQuery(["userdefaults"], (api) => api.userdefaults.enumerate());

  const removeMutation = useFruityMutation(
    (api, { key }: { key: string }) => api.userdefaults.remove(key),
    {
      onSuccess: () => {
        queryClient.invalidateQueries({ queryKey: ["fruity", "userdefaults"] });
      },
    },
  );

  const updateMutation = useFruityMutation(
    (api, { key, value }: { key: string; value: string | number }) =>
      api.userdefaults.update(key, value),
    {
      onSuccess: () => {
        queryClient.invalidateQueries({ queryKey: ["fruity", "userdefaults"] });
        setEditingKey(null);
      },
    },
  );

  const items: UserDefaultsItem[] = useMemo(() => {
    if (!defaults) return [];
    return Object.entries(defaults).map(([key, entry]) => ({
      key,
      ...entry,
    }));
  }, [defaults]);

  const filteredItems = useMemo(() => {
    if (!searchQuery) return items;
    const query = searchQuery.toLowerCase();
    return items.filter(
      (item) =>
        item.key.toLowerCase().includes(query) ||
        item.readable.toLowerCase().includes(query),
    );
  }, [items, searchQuery]);

  const handleDelete = async (key: string) => {
    await removeMutation.mutateAsync({ key });
  };

  const startEdit = (item: UserDefaultsItem) => {
    if (item.type === "string") {
      setEditingKey(item.key);
      setEditValue(item.readable);
    }
  };

  const startDateEdit = (item: UserDefaultsItem) => {
    const date = new Date(item.readable);
    setDatePickerKey(item.key);
    setDatePickerValue(date);
    setTimeHours(date.getHours().toString().padStart(2, "0"));
    setTimeMinutes(date.getMinutes().toString().padStart(2, "0"));
    setTimeSeconds(date.getSeconds().toString().padStart(2, "0"));
  };

  const handleDateSelect = (date: Date | undefined) => {
    if (!date) return;
    const newDate = new Date(date);
    newDate.setHours(parseInt(timeHours) || 0);
    newDate.setMinutes(parseInt(timeMinutes) || 0);
    newDate.setSeconds(parseInt(timeSeconds) || 0);
    setDatePickerValue(newDate);
  };

  const saveDateTimeEdit = async () => {
    if (!datePickerValue || !datePickerKey) return;
    const finalDate = new Date(datePickerValue);
    finalDate.setHours(parseInt(timeHours) || 0);
    finalDate.setMinutes(parseInt(timeMinutes) || 0);
    finalDate.setSeconds(parseInt(timeSeconds) || 0);
    const timestamp = finalDate.getTime() / 1000;
    await updateMutation.mutateAsync({ key: datePickerKey, value: timestamp });
    setDatePickerKey(null);
    setDatePickerValue(undefined);
  };

  const closeDatePicker = () => {
    setDatePickerKey(null);
    setDatePickerValue(undefined);
  };

  const saveEdit = async (key: string) => {
    await updateMutation.mutateAsync({ key, value: editValue });
  };

  const cancelEdit = () => {
    setEditingKey(null);
    setEditValue("");
  };

  const columns: ColumnDef<UserDefaultsItem>[] = [
      {
        accessorKey: "type",
        header: () => t("type"),
        size: 80,
        minSize: 60,
        cell: ({ row }) => (
          <span
            className={`px-2 py-1 text-xs rounded ${getTypeBadgeColor(row.original.type)}`}
          >
            {row.original.type}
          </span>
        ),
      },
      {
        accessorKey: "key",
        header: () => t("key"),
        size: 300,
        minSize: 150,
        cell: ({ row }) => (
          <span
            className="font-mono text-sm break-all"
            title={row.original.key}
          >
            {row.original.key}
          </span>
        ),
      },
      {
        accessorKey: "readable",
        header: () => t("value"),
        size: 400,
        minSize: 200,
        cell: ({ row }) => {
          const item = row.original;
          if (editingKey === item.key) {
            return (
              <div className="flex items-center gap-2">
                <Input
                  value={editValue}
                  onChange={(e) => setEditValue(e.target.value)}
                  className="h-7 text-xs font-mono"
                />
                <Button
                  size="icon"
                  variant="ghost"
                  className="h-7 w-7"
                  onClick={() => saveEdit(item.key)}
                  disabled={updateMutation.isPending}
                >
                  <Check className="w-4 h-4 text-green-500" />
                </Button>
                <Button
                  size="icon"
                  variant="ghost"
                  className="h-7 w-7"
                  onClick={cancelEdit}
                >
                  <X className="w-4 h-4 text-red-500" />
                </Button>
              </div>
            );
          }
          return (
            <pre
              className="font-mono text-xs whitespace-pre-wrap break-all max-h-32 overflow-auto"
              title={item.readable}
            >
              {item.readable}
            </pre>
          );
        },
      },
      {
        id: "actions",
        header: () => t("actions"),
        size: 96,
        minSize: 60,
        enableResizing: false,
        cell: ({ row }) => {
          const item = row.original;
          return (
            <div className="flex justify-end gap-1">
              {item.type === "string" && editingKey !== item.key && (
                <Button
                  variant="ghost"
                  size="icon"
                  className="h-7 w-7"
                  onClick={() => startEdit(item)}
                  title={t("edit")}
                >
                  <Edit2 className="h-4 w-4" />
                </Button>
              )}
              {item.type === "date" && (
                <Popover
                  open={datePickerKey === item.key}
                  onOpenChange={(open) => {
                    if (!open) {
                      closeDatePicker();
                    }
                  }}
                >
                  <PopoverTrigger
                    render={
                      <Button
                        variant="ghost"
                        size="icon"
                        className="h-7 w-7"
                        onClick={() => startDateEdit(item)}
                        title={t("edit")}
                      />
                    }
                  >
                    <CalendarIcon className="h-4 w-4" />
                  </PopoverTrigger>
                  <PopoverContent className="w-auto p-3" align="end">
                    <Calendar
                      mode="single"
                      selected={datePickerValue}
                      onSelect={handleDateSelect}
                      defaultMonth={datePickerValue}
                    />
                    <div className="border-t pt-3 mt-3">
                      <div className="flex items-center gap-2">
                        <Clock className="h-4 w-4 text-muted-foreground" />
                        <Label className="text-sm">{t("time")}</Label>
                      </div>
                      <div className="flex items-center gap-1 mt-2">
                        <Input
                          type="number"
                          min="0"
                          max="23"
                          value={timeHours}
                          onChange={(e) =>
                            setTimeHours(
                              e.target.value.padStart(2, "0").slice(-2),
                            )
                          }
                          className="w-14 h-8 text-center font-mono"
                          placeholder="HH"
                        />
                        <span className="text-lg">:</span>
                        <Input
                          type="number"
                          min="0"
                          max="59"
                          value={timeMinutes}
                          onChange={(e) =>
                            setTimeMinutes(
                              e.target.value.padStart(2, "0").slice(-2),
                            )
                          }
                          className="w-14 h-8 text-center font-mono"
                          placeholder="MM"
                        />
                        <span className="text-lg">:</span>
                        <Input
                          type="number"
                          min="0"
                          max="59"
                          value={timeSeconds}
                          onChange={(e) =>
                            setTimeSeconds(
                              e.target.value.padStart(2, "0").slice(-2),
                            )
                          }
                          className="w-14 h-8 text-center font-mono"
                          placeholder="SS"
                        />
                      </div>
                    </div>
                    <div className="flex justify-end gap-2 mt-3 pt-3 border-t">
                      <Button
                        variant="outline"
                        size="sm"
                        onClick={closeDatePicker}
                      >
                        {t("cancel")}
                      </Button>
                      <Button
                        size="sm"
                        onClick={saveDateTimeEdit}
                        disabled={updateMutation.isPending}
                      >
                        {t("save")}
                      </Button>
                    </div>
                  </PopoverContent>
                </Popover>
              )}
              <DropdownMenu>
                <DropdownMenuTrigger
                  render={
                    <Button
                      variant="ghost"
                      size="icon"
                      className="h-7 w-7 text-destructive hover:text-destructive"
                      title={t("remove")}
                    />
                  }
                >
                  <Trash2 className="h-4 w-4" />
                </DropdownMenuTrigger>
                <DropdownMenuContent align="end">
                  <DropdownMenuItem
                    onClick={() => handleDelete(item.key)}
                    className="text-destructive focus:text-destructive"
                  >
                    {t("remove")}
                  </DropdownMenuItem>
                </DropdownMenuContent>
              </DropdownMenu>
            </div>
          );
        },
      },
  ];

  const table = useReactTable({
    data: filteredItems,
    columns,
    state: { columnSizing },
    onColumnSizingChange: setColumnSizing,
    getCoreRowModel: getCoreRowModel(),
    columnResizeMode: "onChange" as ColumnResizeMode,
    enableColumnResizing: true,
  });

  return (
    <div className="flex flex-col h-full">
      <div className="flex items-center gap-2 p-2 border-b">
        <Button
          variant="outline"
          size="sm"
          onClick={() => refetch()}
          disabled={isLoading}
        >
          <RefreshCw className="w-4 h-4 mr-2" />
          {t("reload")}
        </Button>
        <div className="flex-1 max-w-sm ml-auto">
          <div className="relative">
            <Search className="absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground" />
            <Input
              placeholder={t("search")}
              value={searchQuery}
              onChange={(e) => setSearchQuery(e.target.value)}
              className="pl-8 h-8"
            />
          </div>
        </div>
        <span className="text-sm text-muted-foreground">
          {filteredItems.length} / {items.length}
        </span>
      </div>
      <div className="flex-1 overflow-auto">
        {isLoading ? (
          <div className="flex items-center justify-center h-full gap-2 text-muted-foreground">
            <Spinner className="w-5 h-5" />
            <span>{t("loading")}...</span>
          </div>
        ) : filteredItems.length === 0 ? (
          <div className="flex items-center justify-center h-full text-muted-foreground">
            {searchQuery ? "No matching entries" : "No UserDefaults entries"}
          </div>
        ) : (
          <table
            className="w-full text-sm border-collapse"
            style={{ width: table.getCenterTotalSize() }}
          >
            <thead className="sticky top-0 bg-background z-10">
              {table.getHeaderGroups().map((headerGroup) => (
                <tr key={headerGroup.id} className="border-b">
                  {headerGroup.headers.map((header) => (
                    <th
                      key={header.id}
                      className="relative text-left font-medium p-2 select-none"
                      style={{ width: header.getSize() }}
                    >
                      {header.isPlaceholder
                        ? null
                        : flexRender(
                            header.column.columnDef.header,
                            header.getContext(),
                          )}
                      {header.column.getCanResize() && (
                        <div
                          onMouseDown={header.getResizeHandler()}
                          onTouchStart={header.getResizeHandler()}
                          className={`absolute right-0 top-0 h-full w-1 cursor-col-resize select-none touch-none hover:bg-amber-500/50 ${
                            header.column.getIsResizing() ? "bg-amber-500" : ""
                          }`}
                        />
                      )}
                    </th>
                  ))}
                </tr>
              ))}
            </thead>
            <tbody>
              {table.getRowModel().rows.map((row) => (
                <tr
                  key={row.original.key}
                  className="border-b hover:bg-muted/50"
                >
                  {row.getVisibleCells().map((cell) => (
                    <td
                      key={cell.id}
                      className="p-2 text-xs"
                      style={{
                        width: cell.column.getSize(),
                        maxWidth: cell.column.getSize(),
                      }}
                    >
                      {flexRender(
                        cell.column.columnDef.cell,
                        cell.getContext(),
                      )}
                    </td>
                  ))}
                </tr>
              ))}
            </tbody>
          </table>
        )}
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/FruityWebViewTab.tsx`:

```tsx
import { useState, useRef } from "react";
import { useTranslation } from "react-i18next";
import Editor, { type Monaco } from "@monaco-editor/react";
import type { editor } from "monaco-editor";
import {
  RefreshCw,
  Play,
  Globe,
  ExternalLink,
  Check,
  X,
  Navigation,
} from "lucide-react";
import { Button } from "@/components/ui/button";
import { ButtonGroup } from "@/components/ui/button-group";
import { Input } from "@/components/ui/input";
import { Spinner } from "@/components/ui/spinner";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";
import {
  Tooltip,
  TooltipContent,
  TooltipTrigger,
} from "@/components/ui/tooltip";
import {
  ResizablePanelGroup,
  ResizablePanel,
  ResizableHandle,
} from "@/components/ui/resizable";
import { useTheme } from "@/components/providers/ThemeProvider";
import { useFruityQuery, useFruityMutation } from "@/lib/queries";

import type {
  WKWebViewInfo,
  UIWebViewInfo,
} from "@agent/fruity/modules/webview";

type WebViewKind = "UI" | "WK";
type WebViewEntry = WKWebViewInfo | UIWebViewInfo;

// Configure Monaco to include DOM types for JavaScript
function handleEditorWillMount(monaco: Monaco) {
  monaco.languages.typescript.javascriptDefaults.setCompilerOptions({
    target: monaco.languages.typescript.ScriptTarget.ESNext,
    allowNonTsExtensions: true,
    lib: ["esnext", "dom", "dom.iterable"],
  });

  monaco.languages.typescript.javascriptDefaults.setDiagnosticsOptions({
    noSemanticValidation: false,
    noSyntaxValidation: false,
  });
}

function isWKWebView(entry: WebViewEntry): entry is WKWebViewInfo {
  return entry.kind === "WK";
}

function BooleanBadge({
  value,
  label,
  t,
}: {
  value: boolean | undefined;
  label: string;
  t: (key: string) => string;
}) {
  if (value === undefined) return null;
  return (
    <Tooltip>
      <TooltipTrigger
        render={
          <span
            className={`inline-flex items-center gap-1 px-1.5 py-0.5 text-xs rounded ${
              value
                ? "bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"
                : "bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"
            }`}
          />
        }
      >
        {value ? <Check className="w-3 h-3" /> : <X className="w-3 h-3" />}
        {label}
      </TooltipTrigger>
      <TooltipContent>
        {label}: {value ? t("enabled") : t("disabled")}
      </TooltipContent>
    </Tooltip>
  );
}

export function FruityWebViewTab() {
  const { t } = useTranslation();
  const { theme } = useTheme();
  const [selectedHandle, setSelectedHandle] = useState<string | null>(null);
  const [jsCode, setJsCode] = useState(`// Execute JavaScript in the WebView
// DOM APIs are available (document, window, etc.)

document.title`);
  const [jsResult, setJsResult] = useState<string | null>(null);
  const [navigateUrl, setNavigateUrl] = useState("");
  const editorRef = useRef<editor.IStandaloneCodeEditor | null>(null);

  const {
    data: wkWebviews = [],
    isLoading: isLoadingWK,
    refetch: refetchWK,
  } = useFruityQuery(["webviews", "wk"], (api) => api.webview.listWK());

  const {
    data: uiWebviews = [],
    isLoading: isLoadingUI,
    refetch: refetchUI,
  } = useFruityQuery(["webviews", "ui"], (api) => api.webview.listUI());

  const isLoading = isLoadingWK || isLoadingUI;

  const evaluateMutation = useFruityMutation(
    (
      api,
      { kind, handle, js }: { kind: WebViewKind; handle: string; js: string },
    ) => api.webview.evaluate(kind, handle, js),
  );

  const navigateMutation = useFruityMutation(
    (
      api,
      { kind, handle, url }: { kind: WebViewKind; handle: string; url: string },
    ) => api.webview.navigate(kind, handle, url),
  );

  const entries: WebViewEntry[] = [...wkWebviews, ...uiWebviews];
  const selectedEntry =
    entries.find((e) => e.handle === selectedHandle) ?? null;

  const refetch = () => {
    refetchWK();
    refetchUI();
  };

  const selectEntry = (handle: string) => {
    if (selectedHandle === handle) {
      setSelectedHandle(null);
      setJsResult(null);
    } else {
      setSelectedHandle(handle);
      setJsResult(null);
    }
  };

  const executeJs = async (entry: WebViewEntry) => {
    try {
      const result = await evaluateMutation.mutateAsync({
        kind: entry.kind,
        handle: entry.handle,
        js: jsCode,
      });
      setJsResult(String(result));
    } catch (e) {
      setJsResult(`Error: ${(e as Error).message}`);
    }
  };

  const doNavigate = async (entry: WebViewEntry) => {
    if (!navigateUrl) return;
    try {
      await navigateMutation.mutateAsync({
        kind: entry.kind,
        handle: entry.handle,
        url: navigateUrl,
      });
      setNavigateUrl("");
      refetch();
    } catch (e) {
      console.error("Failed to navigate:", e);
    }
  };

  const handleEditorDidMount = (editor: editor.IStandaloneCodeEditor) => {
    editorRef.current = editor;
  };

  return (
    <div className="flex flex-col h-full">
      <div className="flex items-center gap-2 p-2 border-b">
        <Button
          variant="outline"
          size="sm"
          onClick={() => refetch()}
          disabled={isLoading}
        >
          <RefreshCw className="w-4 h-4 mr-2" />
          {t("reload")}
        </Button>
        <span className="text-sm text-muted-foreground ml-auto">
          {entries.length} {t("webviews")}
        </span>
      </div>
      <div className="flex-1 overflow-hidden">
        {isLoading ? (
          <div className="flex items-center justify-center h-full gap-2 text-muted-foreground">
            <Spinner className="w-5 h-5" />
            <span>{t("loading")}...</span>
          </div>
        ) : entries.length === 0 ? (
          <div className="flex items-center justify-center h-full text-muted-foreground">
            {t("no_webviews")}
          </div>
        ) : (
          <ResizablePanelGroup orientation="horizontal">
            {/* Left Panel - WebView List */}
            <ResizablePanel defaultSize="40%" minSize="25%">
              <div className="h-full overflow-auto">
                <Table>
                  <TableHeader>
                    <TableRow>
                      <TableHead className="w-24">{t("type")}</TableHead>
                      <TableHead>
                        {t("title")} / URL
                      </TableHead>
                    </TableRow>
                  </TableHeader>
                  <TableBody>
                    {entries.map((entry) => (
                      <TableRow
                        key={entry.handle}
                        className={`cursor-pointer ${
                          selectedHandle === entry.handle ? "bg-accent" : ""
                        }`}
                        onClick={() => selectEntry(entry.handle)}
                      >
                        <TableCell>
                          <span
                            className={`px-2 py-1 text-xs rounded ${
                              entry.kind === "WK"
                                ? "bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200"
                                : "bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200"
                            }`}
                          >
                            {entry.kind}WebView
                          </span>
                        </TableCell>
                        <TableCell>
                          <div
                            className="truncate font-medium"
                            title={entry.title}
                          >
                            {entry.title || "-"}
                          </div>
                          <div
                            className="truncate text-xs text-muted-foreground font-mono"
                            title={entry.url}
                          >
                            {entry.url || "-"}
                          </div>
                        </TableCell>
                      </TableRow>
                    ))}
                  </TableBody>
                </Table>
              </div>
            </ResizablePanel>

            <ResizableHandle withHandle />

            {/* Right Panel - Detail View */}
            <ResizablePanel defaultSize="60%" minSize="30%">
              <div className="h-full overflow-auto">
                {selectedEntry ? (
                  <div className="flex flex-col h-full p-4 gap-4">
                    {/* Header */}
                    <div className="flex items-center gap-2">
                      <span
                        className={`px-2 py-1 text-xs rounded ${
                          selectedEntry.kind === "WK"
                            ? "bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200"
                            : "bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200"
                        }`}
                      >
                        {selectedEntry.kind}WebView
                      </span>
                      <span className="font-mono text-xs text-muted-foreground">
                        {selectedEntry.handle}
                      </span>
                    </div>

                    {/* WKWebView-specific properties */}
                    {isWKWebView(selectedEntry) && (
                      <div>
                        <div className="text-sm font-medium mb-2">
                          {t("configuration")}
                        </div>
                        <div className="flex flex-wrap gap-2">
                          <BooleanBadge
                            value={selectedEntry.js}
                            label="JavaScript"
                            t={t}
                          />
                          <BooleanBadge
                            value={selectedEntry.contentJs}
                            label={t("content_js")}
                            t={t}
                          />
                          <BooleanBadge
                            value={selectedEntry.jsAutoOpenWindow}
                            label={t("auto_open_windows")}
                            t={t}
                          />
                          <BooleanBadge
                            value={selectedEntry.fileURLAccess}
                            label={t("file_url_access")}
                            t={t}
                          />
                          <BooleanBadge
                            value={selectedEntry.universalFileAccess}
                            label={t("universal_file_access")}
                            t={t}
                          />
                          <BooleanBadge
                            value={selectedEntry.secure}
                            label={t("secure")}
                            t={t}
                          />
                        </div>
                      </div>
                    )}

                    {/* Current URL */}
                    <div>
                      <div className="flex items-center gap-2 mb-2">
                        <Globe className="w-4 h-4 text-muted-foreground" />
                        <span className="text-sm font-medium">
                          {t("current_url")}
                        </span>
                      </div>
                      <div className="font-mono text-sm bg-muted p-2 rounded flex items-center gap-2">
                        <span className="truncate flex-1">
                          {selectedEntry.url || "about:blank"}
                        </span>
                        {selectedEntry.url && (
                          <a
                            href={selectedEntry.url}
                            target="_blank"
                            rel="noopener noreferrer"
                            className="text-amber-500 hover:text-amber-600 shrink-0"
                          >
                            <ExternalLink className="w-4 h-4" />
                          </a>
                        )}
                      </div>
                    </div>

                    {/* Navigate */}
                    <div>
                      <div className="text-sm font-medium mb-2">
                        {t("navigate_to_url")}
                      </div>
                      <ButtonGroup className="w-full">
                        <Input
                          placeholder="https://example.com"
                          value={navigateUrl}
                          onChange={(e) => setNavigateUrl(e.target.value)}
                          onKeyDown={(e) => {
                            if (e.key === "Enter" && navigateUrl) {
                              doNavigate(selectedEntry);
                            }
                          }}
                          className="flex-1"
                        />
                        <Button
                          variant="outline"
                          onClick={() => doNavigate(selectedEntry)}
                          disabled={!navigateUrl || navigateMutation.isPending}
                          title={t("navigate")}
                        >
                          <Navigation className="w-4 h-4" />
                        </Button>
                      </ButtonGroup>
                    </div>

                    {/* Execute JavaScript - fills remaining space */}
                    <div className="flex flex-col flex-1 min-h-0">
                      <div className="flex items-center justify-between mb-2">
                        <span className="text-sm font-medium">
                          {t("execute_javascript")}
                        </span>
                        <Button
                          size="sm"
                          onClick={() => executeJs(selectedEntry)}
                          disabled={evaluateMutation.isPending}
                        >
                          <Play className="w-4 h-4 mr-2" />
                          {t("run")}
                        </Button>
                      </div>
                      <div className="flex-1 min-h-0 border rounded overflow-hidden">
                        <Editor
                          height="100%"
                          language="javascript"
                          value={jsCode}
                          onChange={(value) => setJsCode(value || "")}
                          beforeMount={handleEditorWillMount}
                          onMount={handleEditorDidMount}
                          theme={theme === "dark" ? "vs-dark" : "light"}
                          options={{
                            minimap: { enabled: false },
                            scrollBeyondLastLine: false,
                            fontSize: 13,
                            lineNumbers: "on",
                            folding: true,
                            automaticLayout: true,
                            tabSize: 2,
                            wordWrap: "on",
                            suggestOnTriggerCharacters: true,
                            quickSuggestions: true,
                          }}
                        />
                      </div>
                      {jsResult !== null && (
                        <div className="mt-3 shrink-0">
                          <div className="text-sm text-muted-foreground mb-1">
                            {t("result")}:
                          </div>
                          <pre className="font-mono text-xs bg-muted p-3 rounded overflow-x-auto max-h-32 whitespace-pre-wrap">
                            {jsResult}
                          </pre>
                        </div>
                      )}
                    </div>
                  </div>
                ) : (
                  <div className="flex items-center justify-center h-full text-muted-foreground">
                    {t("select_webview")}
                  </div>
                )}
              </div>
            </ResizablePanel>
          </ResizablePanelGroup>
        )}
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/FruityXPCTab.tsx`:

```tsx
import { useCallback, useEffect, useMemo, useRef, useState } from "react";
import { type ColumnDef } from "@tanstack/react-table";
import { useQuery, useMutation } from "@tanstack/react-query";

import {
  Trash2,
  Play,
  Square,
  Loader2,
  ArrowDown,
  ArrowUp,
} from "lucide-react";

import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import {
  ResizableHandle,
  ResizablePanel,
  ResizablePanelGroup,
} from "@/components/ui/resizable";
import XPCTreeView from "@/components/shared/XPCTreeView";
import { LogTable } from "@/components/shared/LogTable";
import { Status, useSession } from "@/context/SessionContext";

import {
  isNSXPCMessage,
  type XPCSocketEvent,
  type XPCNode,
  type NSXPCMessage,
} from "@/lib/rpc";

interface XPCEntry {
  id: number;
  timestamp: Date;
  dir: "<" | ">";
  name: string;
  peer: number;
  message: XPCNode;
  backtrace?: string[];
}

interface NSXPCEntry {
  id: number;
  timestamp: Date;
  dir: "<" | ">";
  name: string;
  peer: number;
  sel: string;
  args: string[];
  description: string;
  backtrace?: string[];
}

const MAX_ENTRIES = 8000;
const THROTTLE_MS = 100;

import { toTime } from "@/lib/format";

function messagePreview(message: XPCNode): string {
  const desc = message.description;
  if (typeof desc === "string") {
    return desc.length > 120 ? `${desc.slice(0, 120)}...` : desc;
  }
  return JSON.stringify(message).slice(0, 120);
}

function argsPreview(args: string[]): string {
  if (!args || args.length === 0) return "";
  const joined = args.join(", ");
  return joined.length > 80 ? `${joined.slice(0, 80)}...` : joined;
}

const DirCell = ({ dir }: { dir: "<" | ">" }) =>
  dir === "<" ? (
    <ArrowDown className="w-3.5 h-3.5 text-green-500" />
  ) : (
    <ArrowUp className="w-3.5 h-3.5 text-blue-500" />
  );

// XPC table columns
const xpcColumns: ColumnDef<XPCEntry>[] = [
  {
    id: "timestamp",
    header: "Time",
    size: 96,
    cell: ({ row }) => (
      <span className="font-mono text-muted-foreground">
        {toTime(row.original.timestamp)}
      </span>
    ),
  },
  {
    id: "dir",
    header: "",
    size: 32,
    cell: ({ row }) => <DirCell dir={row.original.dir} />,
  },
  {
    id: "service",
    header: "Service",
    size: 180,
    cell: ({ row }) => (
      <span className="font-mono text-primary truncate" title={row.original.name}>
        {row.original.name || "-"}
      </span>
    ),
  },
  {
    id: "pid",
    header: "PID",
    size: 56,
    cell: ({ row }) => (
      <span className="font-mono text-muted-foreground">
        {row.original.peer || "-"}
      </span>
    ),
  },
  {
    id: "message",
    header: "Message",
    size: 300,
    cell: ({ row }) => (
      <span
        className="font-mono text-muted-foreground truncate"
        title={messagePreview(row.original.message)}
      >
        {messagePreview(row.original.message)}
      </span>
    ),
  },
];

// NSXPC table columns
const nsxpcColumns: ColumnDef<NSXPCEntry>[] = [
  {
    id: "timestamp",
    header: "Time",
    size: 96,
    cell: ({ row }) => (
      <span className="font-mono text-muted-foreground">
        {toTime(row.original.timestamp)}
      </span>
    ),
  },
  {
    id: "dir",
    header: "",
    size: 32,
    cell: ({ row }) => <DirCell dir={row.original.dir} />,
  },
  {
    id: "service",
    header: "Service",
    size: 150,
    cell: ({ row }) => (
      <span className="font-mono text-primary truncate" title={row.original.name}>
        {row.original.name || "-"}
      </span>
    ),
  },
  {
    id: "pid",
    header: "PID",
    size: 56,
    cell: ({ row }) => (
      <span className="font-mono text-muted-foreground">
        {row.original.peer || "-"}
      </span>
    ),
  },
  {
    id: "selector",
    header: "Selector",
    size: 200,
    cell: ({ row }) => (
      <span className="font-mono text-primary truncate" title={row.original.sel}>
        {row.original.sel}
      </span>
    ),
  },
  {
    id: "args",
    header: "Args",
    size: 200,
    cell: ({ row }) => {
      const text = argsPreview(row.original.args);
      return (
        <span className="font-mono text-muted-foreground truncate" title={text}>
          {text || "--"}
        </span>
      );
    },
  },
];


function XPCDetailPanel({ entry }: { entry: XPCEntry | null }) {
  if (!entry) {
    return (
      <div className="h-full flex items-center justify-center text-muted-foreground text-xs">
        Select a message to view details
      </div>
    );
  }

  return (
    <div className="h-full overflow-auto p-3 text-xs space-y-3">
      <div>
        <div className="text-muted-foreground mb-1">Message</div>
        <div className="rounded border bg-muted/20 p-2 overflow-auto max-h-[60vh]">
          <XPCTreeView node={entry.message} />
        </div>
      </div>

      {entry.backtrace && entry.backtrace.length > 0 && (
        <div>
          <div className="text-muted-foreground mb-1">Backtrace</div>
          <div className="rounded border bg-muted/20 p-2 overflow-auto max-h-60 text-[10px] font-mono space-y-0.5">
            {entry.backtrace.map((frame, i) => (
              <div key={i} className="p-1 rounded hover:bg-muted/50 break-all">
                <span className="text-muted-foreground mr-2">#{i}</span>
                {frame}
              </div>
            ))}
          </div>
        </div>
      )}
    </div>
  );
}

function NSXPCDetailPanel({ entry }: { entry: NSXPCEntry | null }) {
  if (!entry) {
    return (
      <div className="h-full flex items-center justify-center text-muted-foreground text-xs">
        Select a message to view details
      </div>
    );
  }

  return (
    <div className="h-full overflow-auto p-3 text-xs space-y-3">
      <div className="space-y-1">
        <div>
          <span className="text-muted-foreground">Selector: </span>
          <span className="font-mono text-primary">{entry.sel}</span>
        </div>
      </div>

      <div>
        <div className="text-muted-foreground mb-1">Description</div>
        <pre className="rounded border bg-muted/20 p-2 overflow-auto max-h-20 whitespace-pre-wrap break-all">
          {entry.description}
        </pre>
      </div>

      {entry.args.length > 0 && (
        <div>
          <div className="text-muted-foreground mb-1">Arguments</div>
          <pre className="rounded border bg-muted/20 p-2 overflow-auto max-h-40 whitespace-pre-wrap break-all">
            {entry.args.map((a, i) => `[${i}] ${a}`).join("\n")}
          </pre>
        </div>
      )}

      {entry.backtrace && entry.backtrace.length > 0 && (
        <div>
          <div className="text-muted-foreground mb-1">Backtrace</div>
          <div className="rounded border bg-muted/20 p-2 overflow-auto max-h-60 text-[10px] font-mono space-y-0.5">
            {entry.backtrace.map((frame, i) => (
              <div key={i} className="p-1 rounded hover:bg-muted/50 break-all">
                <span className="text-muted-foreground mr-2">#{i}</span>
                {frame}
              </div>
            ))}
          </div>
        </div>
      )}
    </div>
  );
}

interface XPCHistoryLog {
  id: number;
  timestamp: string;
  protocol: string;
  event: string;
  direction: string;
  service: string | null;
  peer: number | null;
  message?: XPCNode | NSXPCMessage;
  backtrace?: string[];
  createdAt: string;
}

export function FruityXPCTab() {
  const { socket, status, device, identifier, fruity } = useSession();

  const [xpcEntries, setXpcEntries] = useState<XPCEntry[]>([]);
  const [nsxpcEntries, setNsxpcEntries] = useState<NSXPCEntry[]>([]);
  const [selectedXpcId, setSelectedXpcId] = useState<number | null>(null);
  const [selectedNsxpcId, setSelectedNsxpcId] = useState<number | null>(null);
  const [searchFilter, setSearchFilter] = useState("");
  const [hookEnabled, setHookEnabled] = useState(false);
  const [hookLoading, setHookLoading] = useState(false);

  const xpcIdRef = useRef(1);
  const nsxpcIdRef = useRef(1);
  const pendingXpcRef = useRef<XPCEntry[]>([]);
  const pendingNsxpcRef = useRef<NSXPCEntry[]>([]);
  const timerRef = useRef<ReturnType<typeof setTimeout> | null>(null);

  const handleToggleHook = async (enabled: boolean) => {
    if (!fruity) return;
    setHookLoading(true);
    try {
      if (enabled) {
        await fruity.taps.start("xpc");
      } else {
        await fruity.taps.stop("xpc");
      }
      setHookEnabled(enabled);
    } catch (error) {
      console.error(
        `Failed to ${enabled ? "start" : "stop"} XPC hook:`,
        error,
      );
    } finally {
      setHookLoading(false);
    }
  };

  // Load persisted history
  const { data: history } = useQuery<{ logs: XPCHistoryLog[] }>({
    queryKey: ["xpcHistory", device, identifier],
    queryFn: async () => {
      const res = await fetch(
        `/api/history/xpc/${device}/${identifier}?limit=5000`,
      );
      if (!res.ok) throw new Error("Failed to load XPC history");
      return res.json();
    },
    enabled: status === Status.Ready && !!device && !!identifier,
    staleTime: Infinity,
  });

  useEffect(() => {
    if (!history?.logs) return;

    const xpc: XPCEntry[] = [];
    const nsxpc: NSXPCEntry[] = [];

    for (const record of [...history.logs].reverse()) {
      if (!record.message) continue;
      const msg = record.message;

      if (isNSXPCMessage(msg)) {
        nsxpc.push({
          id: nsxpcIdRef.current++,
          timestamp: new Date(record.timestamp),
          dir: record.direction as "<" | ">",
          name: record.service ?? "",
          peer: record.peer ?? 0,
          sel: msg.sel,
          args: msg.args,
          description: msg.description,
          backtrace: record.backtrace,
        });
      } else {
        xpc.push({
          id: xpcIdRef.current++,
          timestamp: new Date(record.timestamp),
          dir: record.direction as "<" | ">",
          name: record.service ?? "",
          peer: record.peer ?? 0,
          message: msg,
          backtrace: record.backtrace,
        });
      }
    }

    setXpcEntries(xpc);
    setNsxpcEntries(nsxpc);
  }, [history]);

  // Clear mutation
  const clearMutation = useMutation({
    mutationFn: async () => {
      if (!device || !identifier) return;
      const res = await fetch(`/api/history/xpc/${device}/${identifier}`, {
        method: "DELETE",
      });
      if (!res.ok) throw new Error("Failed to clear XPC history");
    },
    onSuccess: () => {
      setXpcEntries([]);
      setNsxpcEntries([]);
      setSelectedXpcId(null);
      setSelectedNsxpcId(null);
      xpcIdRef.current = 1;
      nsxpcIdRef.current = 1;
      pendingXpcRef.current = [];
      pendingNsxpcRef.current = [];
    },
  });

  const flushPending = useCallback(() => {
    timerRef.current = null;

    if (pendingXpcRef.current.length > 0) {
      const incoming = pendingXpcRef.current;
      pendingXpcRef.current = [];
      setXpcEntries((prev) => {
        const merged = [...prev, ...incoming];
        return merged.length > MAX_ENTRIES ? merged.slice(-MAX_ENTRIES) : merged;
      });
    }

    if (pendingNsxpcRef.current.length > 0) {
      const incoming = pendingNsxpcRef.current;
      pendingNsxpcRef.current = [];
      setNsxpcEntries((prev) => {
        const merged = [...prev, ...incoming];
        return merged.length > MAX_ENTRIES ? merged.slice(-MAX_ENTRIES) : merged;
      });
    }
  }, []);

  useEffect(() => {
    if (status !== Status.Ready || !socket) return;

    const onXpc = (raw: XPCSocketEvent) => {
      const msg = raw.message;

      if (isNSXPCMessage(msg)) {
        pendingNsxpcRef.current.push({
          id: nsxpcIdRef.current++,
          timestamp: new Date(),
          dir: raw.dir,
          name: raw.name ?? "",
          peer: raw.peer ?? 0,
          sel: msg.sel,
          args: msg.args,
          description: msg.description,
          backtrace: raw.backtrace,
        });
      } else {
        pendingXpcRef.current.push({
          id: xpcIdRef.current++,
          timestamp: new Date(),
          dir: raw.dir,
          name: raw.name ?? "",
          peer: raw.peer ?? 0,
          message: msg,
          backtrace: raw.backtrace,
        });
      }

      if (!timerRef.current) {
        timerRef.current = setTimeout(flushPending, THROTTLE_MS);
      }
    };

    socket.on("xpc", onXpc);
    return () => {
      socket.off("xpc", onXpc);
      if (timerRef.current) {
        clearTimeout(timerRef.current);
        timerRef.current = null;
      }
    };
  }, [status, socket, flushPending]);

  const handleClear = () => {
    setXpcEntries([]);
    setNsxpcEntries([]);
    setSelectedXpcId(null);
    setSelectedNsxpcId(null);
    xpcIdRef.current = 1;
    nsxpcIdRef.current = 1;
    pendingXpcRef.current = [];
    pendingNsxpcRef.current = [];
    clearMutation.mutate();
  };

  // Filtered entries
  const filteredXpc = useMemo(() => {
    const q = searchFilter.trim().toLowerCase();
    if (!q) return xpcEntries;
    return xpcEntries.filter(
      (e) =>
        (e.name?.toLowerCase().includes(q) ?? false) ||
        messagePreview(e.message).toLowerCase().includes(q),
    );
  }, [xpcEntries, searchFilter]);

  const filteredNsxpc = useMemo(() => {
    const q = searchFilter.trim().toLowerCase();
    if (!q) return nsxpcEntries;
    return nsxpcEntries.filter(
      (e) =>
        e.sel.toLowerCase().includes(q) ||
        e.description.toLowerCase().includes(q) ||
        (e.name?.toLowerCase().includes(q) ?? false),
    );
  }, [nsxpcEntries, searchFilter]);

  const selectedXpc = useMemo(
    () => filteredXpc.find((e) => e.id === selectedXpcId) ?? null,
    [filteredXpc, selectedXpcId],
  );

  const selectedNsxpc = useMemo(
    () => filteredNsxpc.find((e) => e.id === selectedNsxpcId) ?? null,
    [filteredNsxpc, selectedNsxpcId],
  );

  const notReady = status !== Status.Ready;

  return (
    <div className="flex flex-col h-full">
      {/* Toolbar */}
      <div className="flex items-center gap-2 p-2 border-b shrink-0">
        {hookEnabled ? (
          <Button
            variant="outline"
            size="sm"
            className="h-8 px-2.5 text-xs text-red-500 hover:text-red-600"
            onClick={() => handleToggleHook(false)}
            disabled={hookLoading || notReady}
          >
            {hookLoading ? (
              <Loader2 className="w-3.5 h-3.5 animate-spin" />
            ) : (
              <Square className="w-3.5 h-3.5" />
            )}
            Stop
          </Button>
        ) : (
          <Button
            variant="outline"
            size="sm"
            className="h-8 px-2.5 text-xs text-green-600 hover:text-green-700"
            onClick={() => handleToggleHook(true)}
            disabled={hookLoading || notReady}
          >
            {hookLoading ? (
              <Loader2 className="w-3.5 h-3.5 animate-spin" />
            ) : (
              <Play className="w-3.5 h-3.5" />
            )}
            Start
          </Button>
        )}
        <Input
          value={searchFilter}
          onChange={(e) => setSearchFilter(e.target.value)}
          placeholder="Filter..."
          className="h-8 max-w-xs"
        />
        <span className="text-xs text-muted-foreground ml-auto">
          {xpcEntries.length + nsxpcEntries.length} event
          {xpcEntries.length + nsxpcEntries.length !== 1 ? "s" : ""}
        </span>
        <Button
          variant="ghost"
          size="icon"
          className="h-8 w-8 text-red-500 hover:text-red-600 hover:bg-red-100 dark:hover:bg-red-950/30"
          onClick={handleClear}
          disabled={xpcEntries.length === 0 && nsxpcEntries.length === 0}
        >
          <Trash2 className="h-4 w-4" />
        </Button>
      </div>

      {/* Tabs */}
      <Tabs defaultValue="xpc" className="flex-1 flex flex-col min-h-0">
        <TabsList variant="line" className="mx-2 mt-1">
          <TabsTrigger value="xpc">XPC ({filteredXpc.length})</TabsTrigger>
          <TabsTrigger value="nsxpc">NSXPC ({filteredNsxpc.length})</TabsTrigger>
        </TabsList>

        <TabsContent value="xpc" className="flex-1 min-h-0">
          <ResizablePanelGroup
            orientation="horizontal"
            className="h-full"
            autoSaveId="xpc-split"
          >
            <ResizablePanel defaultSize="65%" minSize="30%">
              <div className="h-full flex flex-col overflow-hidden">
                <LogTable
                  data={filteredXpc}
                  columns={xpcColumns}
                  selectedId={selectedXpcId}
                  onSelect={setSelectedXpcId}
                />
              </div>
            </ResizablePanel>
            <ResizableHandle />
            <ResizablePanel defaultSize="35%" minSize="15%">
              <XPCDetailPanel entry={selectedXpc} />
            </ResizablePanel>
          </ResizablePanelGroup>
        </TabsContent>

        <TabsContent value="nsxpc" className="flex-1 min-h-0">
          <ResizablePanelGroup
            orientation="horizontal"
            className="h-full"
            autoSaveId="nsxpc-split"
          >
            <ResizablePanel defaultSize="65%" minSize="30%">
              <div className="h-full flex flex-col overflow-hidden">
                <LogTable
                  data={filteredNsxpc}
                  columns={nsxpcColumns}
                  selectedId={selectedNsxpcId}
                  onSelect={setSelectedNsxpcId}
                />
              </div>
            </ResizablePanel>
            <ResizableHandle />
            <ResizablePanel defaultSize="35%" minSize="15%">
              <NSXPCDetailPanel entry={selectedNsxpc} />
            </ResizablePanel>
          </ResizablePanelGroup>
        </TabsContent>
      </Tabs>
    </div>
  );
}

```

`gui/src/components/tabs/HermesTab.tsx`:

```tsx
import { useCallback, useEffect, useMemo, useRef, useState } from "react";
import { useQuery, useMutation } from "@tanstack/react-query";
import { Download, Trash2, RefreshCw } from "lucide-react";

import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";
import { Status, useSession } from "@/context/SessionContext";

interface HermesEntry {
  id: number;
  url: string;
  hash: string;
  size: number;
  createdAt: string | null;
}

function formatSize(bytes: number): string {
  if (bytes < 1024) return bytes + " B";
  if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + " KB";
  return (bytes / (1024 * 1024)).toFixed(1) + " MB";
}

function filenameFromUrl(url: string): string {
  const parts = url.split("/");
  return parts[parts.length - 1] || url;
}

export function HermesTab() {
  const { socket, status, device, identifier } = useSession();
  const [entries, setEntries] = useState<HermesEntry[]>([]);
  const [sortBy, setSortBy] = useState<"id" | "hash">("id");

  // Load historical data
  const { data: history, refetch: refetchHistory } = useQuery<{
    logs: HermesEntry[];
    total: number;
  }>({
    queryKey: ["hermesHistory", device, identifier],
    queryFn: async () => {
      const res = await fetch(`/api/hermes/${device}/${identifier}?limit=1000`);
      if (!res.ok) throw new Error("Failed to load Hermes history");
      return res.json();
    },
    enabled: !!device && !!identifier,
    staleTime: Infinity,
    gcTime: 0,
  });

  // Merge history into entries on load
  useEffect(() => {
    if (history?.logs) {
      setEntries(history.logs);
    }
  }, [history]);

  // Live socket events with batching
  const pendingRef = useRef<HermesEntry[]>([]);
  const timerRef = useRef<ReturnType<typeof setTimeout> | null>(null);
  const nextIdRef = useRef(100000);

  const flushPending = useCallback(() => {
    timerRef.current = null;
    if (pendingRef.current.length === 0) return;

    const newEntries = pendingRef.current;
    pendingRef.current = [];

    setEntries((prev) => [...newEntries, ...prev]);
  }, []);

  useEffect(() => {
    if (status !== Status.Ready || !socket) return;

    const onHermes = (event: { url: string; hash: string; size: number }) => {
      const entry: HermesEntry = {
        id: nextIdRef.current++,
        url: event.url,
        hash: event.hash,
        size: event.size,
        createdAt: new Date().toISOString(),
      };
      pendingRef.current.push(entry);
      if (!timerRef.current) {
        timerRef.current = setTimeout(flushPending, 100);
      }
    };

    socket.on("hermes", onHermes);
    return () => {
      socket.off("hermes", onHermes);
      if (timerRef.current) {
        clearTimeout(timerRef.current);
        timerRef.current = null;
      }
    };
  }, [socket, status, flushPending]);

  // Delete mutation
  const clearMutation = useMutation({
    mutationFn: async () => {
      if (!device || !identifier) return;
      const res = await fetch(`/api/hermes/${device}/${identifier}`, {
        method: "DELETE",
      });
      if (!res.ok) throw new Error("Failed to clear Hermes records");
    },
    onSuccess: () => {
      setEntries([]);
      refetchHistory();
    },
  });

  // Download handler
  const handleDownload = async (entry: HermesEntry) => {
    try {
      const res = await fetch(
        `/api/hermes/${device}/${identifier}/download/${entry.id}`,
      );
      if (!res.ok) throw new Error("Download failed");

      const blob = await res.blob();
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = filenameFromUrl(entry.url);
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    } catch (error) {
      console.error("Failed to download Hermes:", error);
    }
  };

  // Sorted entries
  const sortedEntries = useMemo(() => {
    const sorted = [...entries];
    if (sortBy === "hash") {
      sorted.sort((a, b) => a.hash.localeCompare(b.hash));
    }
    // Default (id) is already desc from server + prepend
    return sorted;
  }, [entries, sortBy]);

  return (
    <div className="h-full flex flex-col">
      {/* Toolbar */}
      <div className="flex items-center gap-2 px-4 py-2 border-b">
        <h2 className="text-sm font-semibold">Hermes Capture</h2>
        <Badge variant="secondary" className="text-xs">
          {entries.length}
        </Badge>
        <div className="flex-1" />
        <Button
          size="sm"
          variant="ghost"
          onClick={() => setSortBy(sortBy === "id" ? "hash" : "id")}
        >
          Sort: {sortBy === "id" ? "Newest" : "Hash"}
        </Button>
        <Button size="sm" variant="ghost" onClick={() => refetchHistory()}>
          <RefreshCw className="w-3.5 h-3.5" />
        </Button>
        <Button
          size="sm"
          variant="ghost"
          onClick={() => clearMutation.mutate()}
          disabled={clearMutation.isPending || entries.length === 0}
        >
          <Trash2 className="w-3.5 h-3.5" />
        </Button>
      </div>

      {/* Table */}
      <div className="flex-1 overflow-auto">
        <Table>
          <TableHeader>
            <TableRow>
              <TableHead className="w-12">ID</TableHead>
              <TableHead>File</TableHead>
              <TableHead className="w-40">Hash</TableHead>
              <TableHead className="w-20 text-right">Size</TableHead>
              <TableHead className="w-44">Time</TableHead>
              <TableHead className="w-12" />
            </TableRow>
          </TableHeader>
          <TableBody>
            {sortedEntries.map((entry) => (
              <TableRow key={`${entry.id}-${entry.hash}`}>
                <TableCell className="text-xs text-muted-foreground">
                  {entry.id}
                </TableCell>
                <TableCell
                  className="font-mono text-xs truncate max-w-[300px]"
                  title={entry.url}
                >
                  {filenameFromUrl(entry.url)}
                </TableCell>
                <TableCell
                  className="font-mono text-xs text-muted-foreground"
                  title={entry.hash}
                >
                  {entry.hash.slice(0, 16)}...
                </TableCell>
                <TableCell className="text-xs text-right">
                  {formatSize(entry.size)}
                </TableCell>
                <TableCell className="text-xs text-muted-foreground">
                  {entry.createdAt
                    ? new Date(entry.createdAt).toLocaleTimeString()
                    : "-"}
                </TableCell>
                <TableCell>
                  <Button
                    size="sm"
                    variant="ghost"
                    className="h-6 w-6 p-0"
                    onClick={() => handleDownload(entry)}
                    title="Download"
                  >
                    <Download className="w-3.5 h-3.5" />
                  </Button>
                </TableCell>
              </TableRow>
            ))}
            {sortedEntries.length === 0 && (
              <TableRow>
                <TableCell
                  colSpan={6}
                  className="text-center text-muted-foreground text-sm py-8"
                >
                  No Hermes captures yet. Start RN hooks to intercept Hermes
                  bytecode.
                </TableCell>
              </TableRow>
            )}
          </TableBody>
        </Table>
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/HexPreviewTab.tsx`:

```tsx
import { useState } from "react";
import type { IDockviewPanelProps } from "dockview";
import { useQuery } from "@tanstack/react-query";
import { t } from "i18next";
import { Loader2 } from "lucide-react";

import { useSession } from "@/context/SessionContext";
import HexView, { type Stride } from "@/components/shared/HexView";

export interface HexPreviewTabParams {
  path: string;
}

export function HexPreviewTab({
  params,
}: IDockviewPanelProps<HexPreviewTabParams>) {
  const { fruity, droid, device, pid } = useSession();
  const [stride, setStride] = useState<Stride>(16);
  const fullPath = params?.path || "";

  const fileUrl = `/api/download/${device}/${pid}?path=${encodeURIComponent(fullPath)}`;

  const {
    data: content,
    isLoading,
    error,
  } = useQuery<Uint8Array, Error>({
    queryKey: ["hexPreview", device, pid, fullPath],
    queryFn: async () => {
      const r = await fetch(fileUrl);
      if (!r.ok) throw new Error("Failed to load file");
      return new Uint8Array(await r.arrayBuffer());
    },
    enabled: !!(fruity || droid) && !!fullPath,
  });

  if (isLoading) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        <Loader2 className="h-4 w-4 animate-spin mr-2" />
        {t("loading")}
      </div>
    );
  }

  if (error) {
    return (
      <div className="flex items-center justify-center h-full text-destructive">
        {error.message}
      </div>
    );
  }

  if (!content) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        No content
      </div>
    );
  }

  return (
    <div className="h-full flex flex-col">
      <div className="flex items-center gap-2 p-2 border-b">
        <span className="text-sm text-muted-foreground">Stride:</span>
        <select
          value={stride}
          onChange={(e) => setStride(Number(e.target.value) as Stride)}
          className="px-2 py-1 text-sm border rounded bg-background"
        >
          <option value={8}>8</option>
          <option value={16}>16</option>
          <option value={32}>32</option>
        </select>
      </div>
      <div className="flex-1 w-full h-full min-h-0">
        <HexView data={content} stride={stride} />
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/HomeTab.tsx`:

```tsx
import { useTranslation } from "react-i18next";
import {
  FileText,
  FileCode,
  FileSearch,
  FolderOpen,
  FolderSearch,
  FolderKey,
  Cookie,
  Layout,
  Shield,
  Globe,
  Code,
  Settings,
  Network,
  Smartphone,
  KeyRound,
  Database,
  Cpu,
  Cable,
  Search,
} from "lucide-react";

import logo from "@/assets/logo.svg";
import { useDock } from "@/context/DockContext";
import { useSession, Platform, Mode } from "@/context/SessionContext";

interface FeatureItem {
  icon: React.ReactNode;
  id: string;
  component: string;
  title: string;
  desc: string;
  params?: Record<string, string>;
}

function LauncherItem({
  icon,
  id,
  component,
  title,
  desc,
  params,
}: FeatureItem) {
  const { openSingletonPanel } = useDock();

  return (
    <button
      type="button"
      onClick={() => openSingletonPanel({ id, component, title, params })}
      className="flex items-center gap-3 p-3 rounded-lg hover:bg-accent transition-colors text-left"
    >
      <div className="w-12 h-12 shrink-0 rounded-xl bg-primary/10 flex items-center justify-center text-primary">
        {icon}
      </div>
      <div className="min-w-0">
        <h3 className="font-medium text-base">{title}</h3>
        <p className="text-sm text-muted-foreground truncate">{desc}</p>
      </div>
    </button>
  );
}

export function HomeTab() {
  const { t } = useTranslation();
  const { platform, mode } = useSession();

  const isFruityApp = platform === Platform.Fruity && mode === Mode.App;
  const isFruityDaemon = platform === Platform.Fruity && mode === Mode.Daemon;
  const isDroidApp = platform === Platform.Droid && mode === Mode.App;

  const fruityAppFeatures: FeatureItem[] = [
    {
      icon: <FolderSearch className="w-6 h-6" />,
      id: "finder_tab",
      component: "finder",
      title: t("finder"),
      desc: t("home_finder_desc"),
      params: { path: "~" },
    },
    {
      icon: <FolderOpen className="w-6 h-6" />,
      id: "handles_tab",
      component: "handles",
      title: "lsof",
      desc: t("home_lsof_desc"),
    },
    {
      icon: <FileText className="w-6 h-6" />,
      id: "info_plist_tab",
      component: "infoPlist",
      title: "Info.plist",
      desc: t("home_infoplist_desc"),
    },
    {
      icon: <FileSearch className="w-6 h-6" />,
      id: "info_plist_insights_tab",
      component: "infoPlistInsights",
      title: t("plist_insights_title"),
      desc: t("home_plist_insights_desc"),
    },
    {
      icon: <Cookie className="w-6 h-6" />,
      id: "binary_cookie_tab",
      component: "binaryCookie",
      title: "Binary Cookies",
      desc: t("home_cookies_desc"),
    },
    {
      icon: <Settings className="w-6 h-6" />,
      id: "userdefaults_tab",
      component: "userdefaults",
      title: "UserDefaults",
      desc: t("home_userdefaults_desc"),
    },
    {
      icon: <Shield className="w-6 h-6" />,
      id: "entitlements_tab",
      component: "entitlements",
      title: "Entitlements",
      desc: t("home_entitlements_desc"),
    },
    {
      icon: <FolderKey className="w-6 h-6" />,
      id: "keychain_tab",
      component: "keychain",
      title: "KeyChain",
      desc: t("home_keychain_desc"),
    },
    {
      icon: <Layout className="w-6 h-6" />,
      id: "ui_dump_tab",
      component: "uiDump",
      title: t("inspect_ui"),
      desc: t("home_ui_desc"),
    },
    {
      icon: <Globe className="w-6 h-6" />,
      id: "webview_tab",
      component: "webview",
      title: "WebViews",
      desc: t("home_webview_desc"),
    },
    {
      icon: <Code className="w-6 h-6" />,
      id: "jsc_tab",
      component: "jsc",
      title: "JSContext",
      desc: t("home_jsc_desc"),
    },
    {
      icon: <Search className="w-6 h-6" />,
      id: "memory_scan_tab",
      component: "memoryScan",
      title: t("memory_scanner"),
      desc: t("home_memory_scan_desc"),
    },
    {
      icon: <Network className="w-6 h-6" />,
      id: "nsurl_tab",
      component: "nsurl",
      title: "NSURL",
      desc: t("home_nsurl_desc"),
    },
    {
      icon: <Smartphone className="w-6 h-6" />,
      id: "flutter_channels_tab",
      component: "flutterChannels",
      title: t("flutter_channels"),
      desc: t("flutter_channels_desc"),
    },
    {
      icon: <Cable className="w-6 h-6" />,
      id: "xpc_tab",
      component: "xpc",
      title: "XPC",
      desc: t("home_xpc_desc"),
    },
    {
      icon: <Smartphone className="w-6 h-6" />,
      id: "rn_tab",
      component: "reactNative",
      title: "React Native",
      desc: "RN bridge inspector, JS injection REPL",
    },
  ];

  const fruityDaemonFeatures: FeatureItem[] = [
    {
      icon: <FolderSearch className="w-6 h-6" />,
      id: "finder_tab",
      component: "finder",
      title: t("finder"),
      desc: t("home_finder_desc"),
      params: { path: "/" },
    },
    {
      icon: <FolderOpen className="w-6 h-6" />,
      id: "handles_tab",
      component: "handles",
      title: "lsof",
      desc: t("home_lsof_desc"),
    },
    {
      icon: <Network className="w-6 h-6" />,
      id: "nsurl_tab",
      component: "nsurl",
      title: "NSURL",
      desc: t("home_nsurl_desc"),
    },
    {
      icon: <Cable className="w-6 h-6" />,
      id: "xpc_tab",
      component: "xpc",
      title: "XPC",
      desc: "Trace XPC and NSXPC inter-process communication",
    },
  ];

  const droidAppFeatures: FeatureItem[] = [
    {
      icon: <FolderSearch className="w-6 h-6" />,
      id: "finder_tab",
      component: "finder",
      title: t("finder"),
      desc: t("home_finder_desc"),
      params: { path: "/" },
    },
    {
      icon: <FolderOpen className="w-6 h-6" />,
      id: "droid_handles_tab",
      component: "droidHandles",
      title: "lsof",
      desc: t("home_lsof_desc"),
    },
    {
      icon: <FileCode className="w-6 h-6" />,
      id: "droid_manifest_tab",
      component: "droidManifest",
      title: "AndroidManifest.xml",
      desc: t("home_manifest_desc"),
    },
    {
      icon: <KeyRound className="w-6 h-6" />,
      id: "keystore_tab",
      component: "keystore",
      title: t("keystore"),
      desc: t("home_keystore_desc"),
    },
    {
      icon: <Database className="w-6 h-6" />,
      id: "droid_providers_tab",
      component: "droidProviders",
      title: t("content_providers"),
      desc: t("home_providers_desc"),
    },
    {
      icon: <Cpu className="w-6 h-6" />,
      id: "jni_trace_tab",
      component: "jni",
      title: t("jni_trace"),
      desc: t("home_jni_desc"),
    },
    {
      icon: <Smartphone className="w-6 h-6" />,
      id: "flutter_channels_tab",
      component: "flutterChannels",
      title: t("flutter_channels"),
      desc: t("flutter_channels_desc"),
    },
    {
      icon: <Smartphone className="w-6 h-6" />,
      id: "rn_tab",
      component: "reactNative",
      title: "React Native",
      desc: "RN bridge inspector, JS injection REPL",
    },
  ];

  const droidDaemonFeatures: FeatureItem[] = [
    {
      icon: <FolderSearch className="w-6 h-6" />,
      id: "finder_tab",
      component: "finder",
      title: t("finder"),
      desc: t("home_finder_desc"),
      params: { path: "/" },
    },
    {
      icon: <Cpu className="w-6 h-6" />,
      id: "jni_trace_tab",
      component: "jni",
      title: t("jni_trace"),
      desc: t("home_jni_desc"),
    },
  ];

  const features = isFruityApp
    ? fruityAppFeatures
    : isFruityDaemon
      ? fruityDaemonFeatures
      : isDroidApp
        ? droidAppFeatures
        : droidDaemonFeatures;

  return (
    <div className="h-full flex flex-col items-center p-8 overflow-auto">
      <div className="max-w-5xl w-full space-y-6">
        <div className="flex justify-center">
          <img src={logo} alt="logo" className="h-10 w-40" />
        </div>
        <div className="grid grid-cols-2 lg:grid-cols-3 gap-1">
          {features.map((feature) => (
            <LauncherItem key={feature.id} {...feature} />
          ))}
        </div>
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/ImagePreviewTab.tsx`:

```tsx
import { useState } from "react";
import type { IDockviewPanelProps } from "dockview";
import { useSession } from "@/context/SessionContext";
import { ZoomIn, ZoomOut } from "lucide-react";
import { Button } from "@/components/ui/button";

export interface ImagePreviewTabParams {
  path: string;
}

export function ImagePreviewTab({ params }: IDockviewPanelProps<ImagePreviewTabParams>) {
  const { pid, device } = useSession();
  const [zoom, setZoom] = useState(100);

  const fullPath = params?.path || "";

  if (!pid || !device) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        No session available
      </div>
    );
  }

  const imageUrl = `/api/download/${device}/${pid}?path=${encodeURIComponent(fullPath)}`;

  return (
    <div className="flex flex-col h-full">
      <div className="flex-none bg-muted/50 border-b px-4 py-2 flex items-center justify-between">
        <span className="text-sm truncate">{fullPath}</span>
        <div className="flex items-center gap-2 ml-4">
          <Button
            variant="ghost"
            size="icon"
            className="h-8 w-8"
            onClick={() => setZoom((z) => Math.max(25, z - 10))}
            disabled={zoom <= 25}
          >
            <ZoomOut className="h-4 w-4" />
          </Button>
          <input
            type="range"
            min="25"
            max="200"
            value={zoom}
            onChange={(e) => setZoom(Number(e.target.value))}
            className="w-32 h-2 bg-input rounded-lg appearance-none cursor-pointer accent-primary"
          />
          <span className="text-sm w-12 text-right">{zoom}%</span>
          <Button
            variant="ghost"
            size="icon"
            className="h-8 w-8"
            onClick={() => setZoom((z) => Math.min(200, z + 10))}
            disabled={zoom >= 200}
          >
            <ZoomIn className="h-4 w-4" />
          </Button>
        </div>
      </div>
      <div className="flex-1 overflow-auto p-4 bg-background">
        <div className="flex items-center justify-center min-h-full">
          <img
            src={imageUrl}
            alt={fullPath}
            style={{ transform: `scale(${zoom / 100})` }}
            className="max-w-none transition-transform duration-75"
            onError={(e) => {
              e.currentTarget.style.display = "none";
              e.currentTarget.parentElement!.innerHTML = `
                <div class="text-foreground text-center">
                  <div class="text-4xl mb-2">🖼️</div>
                  <div>Failed to load image</div>
                  <div class="text-sm text-muted-foreground mt-2">${fullPath}</div>
                </div>
              `;
            }}
          />
        </div>
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/InfoPlistInsights.tsx`:

```tsx
import { useState } from "react";
import type { TFunction } from "i18next";
import { useTranslation } from "react-i18next";
import {
  ShieldAlert,
  ShieldCheck,
  Info,
  AlertTriangle,
  Lock,
  Unlock,
  ChevronRight,
  Globe,
} from "lucide-react";
import { Badge } from "@/components/ui/badge";

type Severity = "high" | "medium" | "info" | "ok";

interface Insight {
  id: string;
  severity: Severity;
  title: string;
  description: string;
  list?: string[];
}

interface PermissionEntry {
  key: string;
  label: string;
  description: string;
  usageDescription: string;
  sensitive: boolean;
}

interface URLSchemeEntry {
  name?: string;
  schemes: string[];
  role?: string;
}

const SENSITIVE_PERMISSIONS = new Set([
  "NSCameraUsageDescription",
  "NSMicrophoneUsageDescription",
  "NSContactsUsageDescription",
  "NSFaceIDUsageDescription",
  "NSLocationAlwaysAndWhenInUseUsageDescription",
  "NSLocationUsageDescription",
  "NSLocationWhenInUseUsageDescription",
  "NSLocationAlwaysUsageDescription",
  "NSHealthClinicalHealthRecordsShareUsageDescription",
  "NSHealthShareUsageDescription",
  "NSHealthUpdateUsageDescription",
  "NSPhotoLibraryUsageDescription",
  "NSPhotoLibraryAddUsageDescription",
]);

const PERMISSION_LABELS: Record<string, string> = {
  NSBluetoothAlwaysUsageDescription: "Bluetooth Always",
  NSBluetoothPeripheralUsageDescription: "Bluetooth Peripheral",
  NSCalendarsUsageDescription: "Calendars",
  NSRemindersUsageDescription: "Reminders",
  NSCameraUsageDescription: "Camera",
  NSMicrophoneUsageDescription: "Microphone",
  NSContactsUsageDescription: "Contacts",
  NSFaceIDUsageDescription: "Face ID",
  NSDesktopFolderUsageDescription: "Desktop Folder",
  NSDocumentsFolderUsageDescription: "Documents Folder",
  NSDownloadsFolderUsageDescription: "Downloads Folder",
  NSNetworkVolumesUsageDescription: "Network Volumes",
  NSRemovableVolumesUsageDescription: "Removable Volumes",
  NSFileProviderPresenceUsageDescription: "File Provider Presence",
  NSFileProviderDomainUsageDescription: "File Provider Domain",
  NSHealthClinicalHealthRecordsShareUsageDescription: "Health Records",
  NSHealthShareUsageDescription: "Health Share",
  NSHealthUpdateUsageDescription: "Health Update",
  NSHomeKitUsageDescription: "HomeKit",
  NSLocationAlwaysAndWhenInUseUsageDescription: "Location Always & When In Use",
  NSLocationUsageDescription: "Location",
  NSLocationWhenInUseUsageDescription: "Location When In Use",
  NSLocationAlwaysUsageDescription: "Location Always",
  NSAppleMusicUsageDescription: "Apple Music / Media Library",
  NSMotionUsageDescription: "Motion & Fitness",
  NFCReaderUsageDescription: "NFC Reader",
  NSPhotoLibraryAddUsageDescription: "Photo Library (Add Only)",
  NSPhotoLibraryUsageDescription: "Photo Library",
  NSAppleScriptEnabled: "AppleScript",
  NSAppleEventsUsageDescription: "Apple Events",
  NSSystemAdministrationUsageDescription: "System Administration",
  NSSiriUsageDescription: "Siri",
  NSSpeechRecognitionUsageDescription: "Speech Recognition",
  NSVideoSubscriberAccountUsageDescription: "Video Subscriber Account",
  UIRequiresPersistentWiFi: "Persistent Wi-Fi",
};

const PERMISSION_DESCRIPTIONS: Record<string, string> = {
  NSBluetoothAlwaysUsageDescription: "Access Bluetooth at all times",
  NSBluetoothPeripheralUsageDescription: "Connect to Bluetooth peripherals",
  NSCalendarsUsageDescription: "Access calendar data",
  NSRemindersUsageDescription: "Access reminders",
  NSCameraUsageDescription: "Capture photos and video",
  NSMicrophoneUsageDescription: "Record audio",
  NSContactsUsageDescription: "Read contacts",
  NSFaceIDUsageDescription: "Authenticate with Face ID",
  NSDesktopFolderUsageDescription: "Access Desktop folder",
  NSDocumentsFolderUsageDescription: "Access Documents folder",
  NSDownloadsFolderUsageDescription: "Access Downloads folder",
  NSNetworkVolumesUsageDescription: "Access network volumes",
  NSRemovableVolumesUsageDescription: "Access removable volumes",
  NSFileProviderPresenceUsageDescription:
    "Know when other apps access managed files",
  NSFileProviderDomainUsageDescription:
    "Access files managed by a file provider",
  NSHealthClinicalHealthRecordsShareUsageDescription:
    "Read clinical health records",
  NSHealthShareUsageDescription: "Read HealthKit data",
  NSHealthUpdateUsageDescription: "Write HealthKit data",
  NSHomeKitUsageDescription: "Access HomeKit configuration",
  NSLocationAlwaysAndWhenInUseUsageDescription: "Access location at all times",
  NSLocationUsageDescription: "Access location",
  NSLocationWhenInUseUsageDescription: "Access location while in foreground",
  NSLocationAlwaysUsageDescription: "Access location always (legacy)",
  NSAppleMusicUsageDescription: "Access media library",
  NSMotionUsageDescription: "Access accelerometer / motion data",
  NFCReaderUsageDescription: "Scan NFC tags",
  NSPhotoLibraryAddUsageDescription: "Add photos to photo library",
  NSPhotoLibraryUsageDescription: "Access photo library",
  NSAppleScriptEnabled: "AppleScript is enabled",
  NSAppleEventsUsageDescription: "Send Apple events",
  NSSystemAdministrationUsageDescription: "Manipulate system configuration",
  NSSiriUsageDescription: "Send data to Siri",
  NSSpeechRecognitionUsageDescription:
    "Send data to speech recognition servers",
  NSVideoSubscriberAccountUsageDescription: "Access TV provider account",
  UIRequiresPersistentWiFi: "Requires persistent Wi-Fi connection",
};

const ALL_PERMISSION_KEYS = Object.keys(PERMISSION_LABELS);

// eslint-disable-next-line @typescript-eslint/no-explicit-any
function parsePlistInsights(value: Record<string, any>, t: TFunction) {
  const insights: Insight[] = [];

  // --- ATS analysis ---
  const ats = value.NSAppTransportSecurity as
    | Record<string, unknown>
    | undefined;
  if (ats) {
    if (ats.NSAllowsArbitraryLoads === true) {
      insights.push({
        id: "ats_arbitrary",
        severity: "high",
        title: t("plist_ats_arbitrary_title"),
        description: t("plist_ats_arbitrary_desc"),
      });
    } else {
      insights.push({
        id: "ats_arbitrary",
        severity: "ok",
        title: t("plist_ats_arbitrary_off_title"),
        description: t("plist_ats_arbitrary_off_desc"),
      });
    }

    if (ats.NSAllowsArbitraryLoadsForMedia === true) {
      insights.push({
        id: "ats_media",
        severity: "medium",
        title: t("plist_ats_media_title"),
        description: t("plist_ats_media_desc"),
      });
    }

    if (ats.NSAllowsArbitraryLoadsInWebContent === true) {
      insights.push({
        id: "ats_webcontent",
        severity: "medium",
        title: t("plist_ats_webcontent_title"),
        description: t("plist_ats_webcontent_desc"),
      });
    }

    if (ats.NSAllowsLocalNetworking === true) {
      insights.push({
        id: "ats_local",
        severity: "info",
        title: t("plist_ats_local_title"),
        description: t("plist_ats_local_desc"),
      });
    }

    if (ats.NSExceptionDomains) {
      const domains = Object.keys(
        ats.NSExceptionDomains as Record<string, unknown>,
      );
      insights.push({
        id: "ats_exceptions",
        severity: "info",
        title: t("plist_ats_exceptions_title", { count: domains.length }),
        description: t("plist_ats_exceptions_desc"),
        list: domains,
      });
    }
  } else {
    insights.push({
      id: "ats_default",
      severity: "ok",
      title: t("plist_ats_default_title"),
      description: t("plist_ats_default_desc"),
    });
  }

  // --- Encryption ---
  if (value.ITSAppUsesNonExemptEncryption === true) {
    insights.push({
      id: "encryption",
      severity: "info",
      title: t("plist_encryption_yes_title"),
      description: t("plist_encryption_yes_desc"),
    });
  } else if (value.ITSAppUsesNonExemptEncryption === false) {
    insights.push({
      id: "encryption",
      severity: "ok",
      title: t("plist_encryption_no_title"),
      description: t("plist_encryption_no_desc"),
    });
  } else {
    insights.push({
      id: "encryption",
      severity: "info",
      title: t("plist_encryption_missing_title"),
      description: t("plist_encryption_missing_desc"),
    });
  }

  // --- Permissions ---
  const permissions: PermissionEntry[] = [];
  for (const key of ALL_PERMISSION_KEYS) {
    if (key in value) {
      const usageDesc =
        typeof value[key] === "string" ? value[key] : String(value[key]);
      permissions.push({
        key,
        label: PERMISSION_LABELS[key],
        description: PERMISSION_DESCRIPTIONS[key],
        usageDescription: usageDesc,
        sensitive: SENSITIVE_PERMISSIONS.has(key),
      });
    }
  }

  const sensitiveCount = permissions.filter((p) => p.sensitive).length;
  if (sensitiveCount >= 5) {
    insights.push({
      id: "permissions",
      severity: "medium",
      title: t("plist_perms_excessive_title", { count: sensitiveCount }),
      description: t("plist_perms_excessive_desc", { count: sensitiveCount }),
    });
  } else if (sensitiveCount > 0) {
    insights.push({
      id: "permissions",
      severity: "info",
      title: t("plist_perms_some_title", { count: sensitiveCount }),
      description: t("plist_perms_some_desc", { count: sensitiveCount }),
    });
  } else if (permissions.length > 0) {
    insights.push({
      id: "permissions",
      severity: "ok",
      title: t("plist_perms_none_sensitive_title"),
      description: t("plist_perms_none_sensitive_desc", {
        count: permissions.length,
      }),
    });
  }

  // --- URL Schemes ---
  const urlTypes = value.CFBundleURLTypes as
    | Array<Record<string, unknown>>
    | undefined;
  const urlSchemes: URLSchemeEntry[] = [];
  if (urlTypes && Array.isArray(urlTypes)) {
    for (const entry of urlTypes) {
      urlSchemes.push({
        name: entry.CFBundleURLName as string | undefined,
        schemes: (entry.CFBundleURLSchemes as string[] | undefined) ?? [],
        role: entry.CFBundleTypeRole as string | undefined,
      });
    }
  }

  return { insights, permissions, urlSchemes };
}

const SEVERITY_CONFIG: Record<
  Severity,
  {
    icon: React.ComponentType<{ className?: string }>;
    badge: string;
    labelKey: string;
  }
> = {
  high: {
    icon: ShieldAlert,
    badge: "bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400",
    labelKey: "severity_high",
  },
  medium: {
    icon: AlertTriangle,
    badge:
      "bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400",
    labelKey: "severity_medium",
  },
  info: {
    icon: Info,
    badge: "bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",
    labelKey: "severity_info",
  },
  ok: {
    icon: ShieldCheck,
    badge:
      "bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",
    labelKey: "severity_ok",
  },
};

function InsightCard({ insight }: { insight: Insight }) {
  const { t } = useTranslation();
  const cfg = SEVERITY_CONFIG[insight.severity];
  const Icon = cfg.icon;
  return (
    <div className="flex gap-3 rounded-lg border p-4">
      <div className={`mt-0.5 shrink-0 rounded p-1.5 ${cfg.badge}`}>
        <Icon className="h-4 w-4" />
      </div>
      <div className="min-w-0 flex-1">
        <div className="flex items-center gap-2 mb-1">
          <span className="font-medium text-sm">{insight.title}</span>
          <span
            className={`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${cfg.badge}`}
          >
            {t(cfg.labelKey)}
          </span>
        </div>
        <p className="text-xs text-muted-foreground leading-relaxed">
          {insight.description}
        </p>
        {insight.list && insight.list.length > 0 && (
          <ul className="mt-2 space-y-1">
            {insight.list.map((item, idx) => (
              <li
                key={idx}
                className="text-xs text-muted-foreground flex items-start gap-1.5"
              >
                <span className="text-muted-foreground/50 select-none">•</span>
                <span className="font-mono">{item}</span>
              </li>
            ))}
          </ul>
        )}
      </div>
    </div>
  );
}

function PermissionRow({ perm }: { perm: PermissionEntry }) {
  const { t } = useTranslation();
  return (
    <div className="flex items-start gap-3 py-2.5 border-b last:border-b-0">
      <div className="mt-0.5 shrink-0">
        {perm.sensitive ? (
          <Unlock className="h-4 w-4 text-amber-500" />
        ) : (
          <Lock className="h-4 w-4 text-muted-foreground" />
        )}
      </div>
      <div className="min-w-0 flex-1">
        <div className="flex items-center gap-2 flex-wrap">
          <span className="text-xs font-mono font-medium">{perm.key}</span>
          {perm.sensitive && (
            <Badge
              variant="outline"
              className="text-[10px] px-1.5 py-0 border-amber-400 text-amber-600 dark:text-amber-400"
            >
              {t("plist_perm_sensitive")}
            </Badge>
          )}
        </div>
        <p className="text-xs text-muted-foreground mt-0.5">
          {perm.label} — {perm.description}
        </p>
        {perm.usageDescription && (
          <p className="text-xs text-muted-foreground/70 mt-0.5 italic">
            "{perm.usageDescription}"
          </p>
        )}
      </div>
    </div>
  );
}

export function InfoPlistInsights({
  value,
  permsOpen,
  setPermsOpen,
}: {
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  value: Record<string, any>;
  permsOpen: boolean;
  setPermsOpen: React.Dispatch<React.SetStateAction<boolean>>;
}) {
  const { t } = useTranslation();
  const { insights, permissions, urlSchemes } = parsePlistInsights(value, t);
  const [urlsOpen, setUrlsOpen] = useState(false);

  const highCount = insights.filter((i) => i.severity === "high").length;
  const mediumCount = insights.filter((i) => i.severity === "medium").length;
  const sensitivePerms = permissions.filter((p) => p.sensitive);

  return (
    <div className="h-full overflow-auto">
      <div className="p-4 max-w-3xl mx-auto space-y-6">
        {/* Summary bar */}
        <div className="flex items-center gap-4 rounded-lg border p-3 bg-muted/30">
          <div className="flex items-center gap-1.5 text-sm">
            <span className="h-2.5 w-2.5 rounded-full bg-red-500 inline-block" />
            <span className="font-medium">{highCount}</span>
            <span className="text-muted-foreground">
              {t("manifest_summary_high")}
            </span>
          </div>
          <div className="flex items-center gap-1.5 text-sm">
            <span className="h-2.5 w-2.5 rounded-full bg-amber-500 inline-block" />
            <span className="font-medium">{mediumCount}</span>
            <span className="text-muted-foreground">
              {t("manifest_summary_medium")}
            </span>
          </div>
          <div className="flex items-center gap-1.5 text-sm">
            <Unlock className="h-3.5 w-3.5 text-amber-500" />
            <span className="font-medium">{sensitivePerms.length}</span>
            <span className="text-muted-foreground">
              {t("plist_summary_sensitive_perms")}
            </span>
          </div>
          <div className="flex items-center gap-1.5 text-sm">
            <Lock className="h-3.5 w-3.5 text-muted-foreground" />
            <span className="font-medium">
              {permissions.length - sensitivePerms.length}
            </span>
            <span className="text-muted-foreground">
              {t("manifest_summary_normal_perms")}
            </span>
          </div>
        </div>

        {/* Security findings */}
        <section>
          <h2 className="text-sm font-semibold mb-3 text-foreground">
            {t("manifest_security_findings")}
          </h2>
          <div className="space-y-2">
            {insights.map((insight) => (
              <InsightCard key={insight.id} insight={insight} />
            ))}
          </div>
        </section>

        {/* Permissions */}
        <section>
          <button
            className="flex items-center gap-1.5 w-full text-left mb-3 group"
            onClick={() => setPermsOpen((o) => !o)}
          >
            <ChevronRight
              className={`h-4 w-4 text-muted-foreground transition-transform duration-150 ${permsOpen ? "rotate-90" : ""}`}
            />
            <h2 className="text-sm font-semibold text-foreground group-hover:text-foreground/80">
              {permissions.length > 0
                ? t("plist_declared_permissions_count", {
                    count: permissions.length,
                  })
                : t("plist_declared_permissions")}
            </h2>
          </button>
          {permsOpen &&
            (permissions.length > 0 ? (
              <div className="rounded-lg border px-4 divide-y-0">
                {[...permissions]
                  .sort((a, b) => (b.sensitive ? 1 : 0) - (a.sensitive ? 1 : 0))
                  .map((perm) => (
                    <PermissionRow key={perm.key} perm={perm} />
                  ))}
              </div>
            ) : (
              <div className="rounded-lg border p-4 text-sm text-muted-foreground">
                {t("plist_no_permissions_desc")}
              </div>
            ))}
        </section>

        {/* URL Schemes */}
        {urlSchemes.length > 0 && (
          <section>
            <button
              className="flex items-center gap-1.5 w-full text-left mb-3 group"
              onClick={() => setUrlsOpen((o) => !o)}
            >
              <ChevronRight
                className={`h-4 w-4 text-muted-foreground transition-transform duration-150 ${urlsOpen ? "rotate-90" : ""}`}
              />
              <h2 className="text-sm font-semibold text-foreground group-hover:text-foreground/80">
                {t("plist_url_schemes_count", {
                  count: urlSchemes.reduce((n, u) => n + u.schemes.length, 0),
                })}
              </h2>
            </button>
            {urlsOpen && (
              <div className="rounded-lg border px-4 divide-y-0">
                {urlSchemes.map((entry, idx) => (
                  <div
                    key={idx}
                    className="flex items-start gap-3 py-2.5 border-b last:border-b-0"
                  >
                    <div className="mt-0.5 shrink-0">
                      <Globe className="h-4 w-4 text-muted-foreground" />
                    </div>
                    <div className="min-w-0 flex-1">
                      <div className="flex items-center gap-2 flex-wrap">
                        <span className="text-xs font-mono font-medium">
                          {entry.schemes.map((s) => `${s}://`).join(", ")}
                        </span>
                        {entry.role && (
                          <Badge
                            variant="outline"
                            className="text-[10px] px-1.5 py-0"
                          >
                            {entry.role}
                          </Badge>
                        )}
                      </div>
                      {entry.name && (
                        <p className="text-xs text-muted-foreground mt-0.5">
                          {entry.name}
                        </p>
                      )}
                    </div>
                  </div>
                ))}
              </div>
            )}
          </section>
        )}
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/ManifestInsights.tsx`:

```tsx
import { useState } from "react";
import type { TFunction } from "i18next";
import { useTranslation } from "react-i18next";
import { ShieldAlert, ShieldCheck, Info, AlertTriangle, Lock, Unlock, ChevronRight } from "lucide-react";
import { Badge } from "@/components/ui/badge";

type Severity = "high" | "medium" | "info" | "ok";

interface Insight {
  id: string;
  severity: Severity;
  title: string;
  description: string;
}

interface PermissionEntry {
  name: string;
  dangerous: boolean;
  descKey?: string;
}

// Maps android.permission.FOO → translation key "perm_desc_FOO"
const DANGEROUS_PERM_DESC_KEYS: Record<string, string> = {
  "android.permission.CAMERA": "perm_desc_CAMERA",
  "android.permission.RECORD_AUDIO": "perm_desc_RECORD_AUDIO",
  "android.permission.READ_CONTACTS": "perm_desc_READ_CONTACTS",
  "android.permission.WRITE_CONTACTS": "perm_desc_WRITE_CONTACTS",
  "android.permission.READ_CALL_LOG": "perm_desc_READ_CALL_LOG",
  "android.permission.WRITE_CALL_LOG": "perm_desc_WRITE_CALL_LOG",
  "android.permission.PROCESS_OUTGOING_CALLS": "perm_desc_PROCESS_OUTGOING_CALLS",
  "android.permission.READ_CALENDAR": "perm_desc_READ_CALENDAR",
  "android.permission.WRITE_CALENDAR": "perm_desc_WRITE_CALENDAR",
  "android.permission.ACCESS_FINE_LOCATION": "perm_desc_ACCESS_FINE_LOCATION",
  "android.permission.ACCESS_COARSE_LOCATION": "perm_desc_ACCESS_COARSE_LOCATION",
  "android.permission.ACCESS_BACKGROUND_LOCATION": "perm_desc_ACCESS_BACKGROUND_LOCATION",
  "android.permission.READ_PHONE_STATE": "perm_desc_READ_PHONE_STATE",
  "android.permission.READ_PHONE_NUMBERS": "perm_desc_READ_PHONE_NUMBERS",
  "android.permission.CALL_PHONE": "perm_desc_CALL_PHONE",
  "android.permission.ANSWER_PHONE_CALLS": "perm_desc_ANSWER_PHONE_CALLS",
  "android.permission.ADD_VOICEMAIL": "perm_desc_ADD_VOICEMAIL",
  "android.permission.USE_SIP": "perm_desc_USE_SIP",
  "android.permission.SEND_SMS": "perm_desc_SEND_SMS",
  "android.permission.RECEIVE_SMS": "perm_desc_RECEIVE_SMS",
  "android.permission.READ_SMS": "perm_desc_READ_SMS",
  "android.permission.RECEIVE_WAP_PUSH": "perm_desc_RECEIVE_WAP_PUSH",
  "android.permission.RECEIVE_MMS": "perm_desc_RECEIVE_MMS",
  "android.permission.BODY_SENSORS": "perm_desc_BODY_SENSORS",
  "android.permission.BODY_SENSORS_BACKGROUND": "perm_desc_BODY_SENSORS_BACKGROUND",
  "android.permission.READ_EXTERNAL_STORAGE": "perm_desc_READ_EXTERNAL_STORAGE",
  "android.permission.WRITE_EXTERNAL_STORAGE": "perm_desc_WRITE_EXTERNAL_STORAGE",
  "android.permission.MANAGE_EXTERNAL_STORAGE": "perm_desc_MANAGE_EXTERNAL_STORAGE",
  "android.permission.ACCESS_MEDIA_LOCATION": "perm_desc_ACCESS_MEDIA_LOCATION",
  "android.permission.SYSTEM_ALERT_WINDOW": "perm_desc_SYSTEM_ALERT_WINDOW",
  "android.permission.REQUEST_INSTALL_PACKAGES": "perm_desc_REQUEST_INSTALL_PACKAGES",
  "android.permission.GET_ACCOUNTS": "perm_desc_GET_ACCOUNTS",
  "android.permission.BLUETOOTH_SCAN": "perm_desc_BLUETOOTH_SCAN",
  "android.permission.BLUETOOTH_CONNECT": "perm_desc_BLUETOOTH_CONNECT",
  "android.permission.UWB_RANGING": "perm_desc_UWB_RANGING",
  "android.permission.ACTIVITY_RECOGNITION": "perm_desc_ACTIVITY_RECOGNITION",
  "android.permission.POST_NOTIFICATIONS": "perm_desc_POST_NOTIFICATIONS",
};

const ANDROID_NS = "http://schemas.android.com/apk/res/android";

function getAndroidAttr(el: Element | null | undefined, name: string): string | null {
  if (!el) return null;
  return (
    el.getAttributeNS(ANDROID_NS, name) ??
    el.getAttribute(`android:${name}`) ??
    el.getAttribute(name)
  );
}

/** Normalise compiled-manifest hex booleans (0x00000000 / 0xffffffff) to "true"/"false" */
function normaliseBool(value: string | null): string | null {
  if (value === null) return null;
  const v = value.toLowerCase();
  if (v === "true" || v === "0xffffffff") return "true";
  if (v === "false" || v === "0x00000000" || v === "0x0") return "false";
  return value;
}

function parseManifestInsights(
  xml: string,
  t: TFunction
): { insights: Insight[]; permissions: PermissionEntry[]; packageName: string | null } {
  const parser = new DOMParser();
  const doc = parser.parseFromString(xml, "application/xml");
  const insights: Insight[] = [];

  const manifest = doc.querySelector("manifest");
  const packageName = manifest?.getAttribute("package") ?? null;
  const application = doc.querySelector("application");

  // android:debuggable
  const debuggable = normaliseBool(getAndroidAttr(application, "debuggable"));
  if (debuggable === "true") {
    insights.push({
      id: "debuggable",
      severity: "high",
      title: t("manifest_debuggable_on_title"),
      description: t("manifest_debuggable_on_desc"),
    });
  } else {
    insights.push({
      id: "debuggable",
      severity: "ok",
      title: t("manifest_debuggable_off_title"),
      description: t("manifest_debuggable_off_desc"),
    });
  }

  // android:allowBackup
  const allowBackup = normaliseBool(getAndroidAttr(application, "allowBackup"));
  if (allowBackup !== "false") {
    insights.push({
      id: "allowBackup",
      severity: "medium",
      title: t("manifest_allowbackup_on_title"),
      description:
        allowBackup === null
          ? t("manifest_allowbackup_on_default_desc")
          : t("manifest_allowbackup_on_explicit_desc"),
    });
  } else {
    insights.push({
      id: "allowBackup",
      severity: "ok",
      title: t("manifest_allowbackup_off_title"),
      description: t("manifest_allowbackup_off_desc"),
    });
  }

  // android:usesCleartextTraffic
  const cleartext = normaliseBool(getAndroidAttr(application, "usesCleartextTraffic"));
  if (cleartext === "true") {
    insights.push({
      id: "cleartext",
      severity: "high",
      title: t("manifest_cleartext_title"),
      description: t("manifest_cleartext_desc"),
    });
  }

  // android:networkSecurityConfig
  const nsc = getAndroidAttr(application, "networkSecurityConfig");
  if (!nsc) {
    insights.push({
      id: "nsc",
      severity: "info",
      title: t("manifest_nsc_title"),
      description: t("manifest_nsc_desc"),
    });
  }

  // Permissions
  const permissionElements = doc.querySelectorAll("uses-permission");
  const permissions: PermissionEntry[] = Array.from(permissionElements).map((el) => {
    const name = getAndroidAttr(el, "name") ?? "";
    const descKey = DANGEROUS_PERM_DESC_KEYS[name];
    return { name, dangerous: !!descKey, descKey };
  });

  const dangerousCount = permissions.filter((p) => p.dangerous).length;
  if (dangerousCount >= 8) {
    insights.push({
      id: "permissions",
      severity: "medium",
      title: t("manifest_perms_excessive_title", { count: dangerousCount }),
      description: t("manifest_perms_excessive_desc", { count: dangerousCount }),
    });
  } else if (dangerousCount > 0) {
    insights.push({
      id: "permissions",
      severity: "info",
      title: t("manifest_perms_some_title", { count: dangerousCount }),
      description: t("manifest_perms_some_desc", { count: dangerousCount }),
    });
  } else if (permissions.length > 0) {
    insights.push({
      id: "permissions",
      severity: "ok",
      title: t("manifest_perms_none_title"),
      description: t("manifest_perms_none_desc", { count: permissions.length }),
    });
  }

  return { insights, permissions, packageName };
}

const SEVERITY_CONFIG: Record<
  Severity,
  {
    icon: React.ComponentType<{ className?: string }>;
    badge: string;
    labelKey: string;
  }
> = {
  high: {
    icon: ShieldAlert,
    badge: "bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400",
    labelKey: "severity_high",
  },
  medium: {
    icon: AlertTriangle,
    badge: "bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400",
    labelKey: "severity_medium",
  },
  info: {
    icon: Info,
    badge: "bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",
    labelKey: "severity_info",
  },
  ok: {
    icon: ShieldCheck,
    badge: "bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",
    labelKey: "severity_ok",
  },
};

function InsightCard({ insight }: { insight: Insight }) {
  const { t } = useTranslation();
  const cfg = SEVERITY_CONFIG[insight.severity];
  const Icon = cfg.icon;
  return (
    <div className="flex gap-3 rounded-lg border p-4">
      <div className={`mt-0.5 shrink-0 rounded p-1.5 ${cfg.badge}`}>
        <Icon className="h-4 w-4" />
      </div>
      <div className="min-w-0 flex-1">
        <div className="flex items-center gap-2 mb-1">
          <span className="font-medium text-sm">{insight.title}</span>
          <span
            className={`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${cfg.badge}`}
          >
            {t(cfg.labelKey)}
          </span>
        </div>
        <p className="text-xs text-muted-foreground leading-relaxed">{insight.description}</p>
      </div>
    </div>
  );
}

function PermissionRow({ perm }: { perm: PermissionEntry }) {
  const { t } = useTranslation();
  const shortName = perm.name.replace(/^android\.permission\./, "");
  return (
    <div className="flex items-start gap-3 py-2.5 border-b last:border-b-0">
      <div className="mt-0.5 shrink-0">
        {perm.dangerous ? (
          <Unlock className="h-4 w-4 text-amber-500" />
        ) : (
          <Lock className="h-4 w-4 text-muted-foreground" />
        )}
      </div>
      <div className="min-w-0 flex-1">
        <div className="flex items-center gap-2 flex-wrap">
          <span className="text-xs font-mono font-medium">{shortName}</span>
          {perm.dangerous && (
            <Badge
              variant="outline"
              className="text-[10px] px-1.5 py-0 border-amber-400 text-amber-600 dark:text-amber-400"
            >
              {t("manifest_perm_dangerous")}
            </Badge>
          )}
        </div>
        {perm.descKey ? (
          <p className="text-xs text-muted-foreground mt-0.5">{t(perm.descKey)}</p>
        ) : (
          <p className="text-xs text-muted-foreground mt-0.5 font-mono break-all">{perm.name}</p>
        )}
      </div>
    </div>
  );
}

export function ManifestInsights({ xml }: { xml: string }) {
  const { t } = useTranslation();
  const [permsOpen, setPermsOpen] = useState(false);
  const { insights, permissions } = parseManifestInsights(xml, t);

  const highCount = insights.filter((i) => i.severity === "high").length;
  const mediumCount = insights.filter((i) => i.severity === "medium").length;
  const dangerousPerms = permissions.filter((p) => p.dangerous);

  return (
    <div className="h-full overflow-auto">
      <div className="p-4 max-w-3xl mx-auto space-y-6">
        {/* Summary bar */}
        <div className="flex items-center gap-4 rounded-lg border p-3 bg-muted/30">
          <div className="flex items-center gap-1.5 text-sm">
            <span className="h-2.5 w-2.5 rounded-full bg-red-500 inline-block" />
            <span className="font-medium">{highCount}</span>
            <span className="text-muted-foreground">{t("manifest_summary_high")}</span>
          </div>
          <div className="flex items-center gap-1.5 text-sm">
            <span className="h-2.5 w-2.5 rounded-full bg-amber-500 inline-block" />
            <span className="font-medium">{mediumCount}</span>
            <span className="text-muted-foreground">{t("manifest_summary_medium")}</span>
          </div>
          <div className="flex items-center gap-1.5 text-sm">
            <Unlock className="h-3.5 w-3.5 text-amber-500" />
            <span className="font-medium">{dangerousPerms.length}</span>
            <span className="text-muted-foreground">{t("manifest_summary_dangerous_perms")}</span>
          </div>
          <div className="flex items-center gap-1.5 text-sm">
            <Lock className="h-3.5 w-3.5 text-muted-foreground" />
            <span className="font-medium">{permissions.length - dangerousPerms.length}</span>
            <span className="text-muted-foreground">{t("manifest_summary_normal_perms")}</span>
          </div>
        </div>

        {/* Security findings */}
        <section>
          <h2 className="text-sm font-semibold mb-3 text-foreground">
            {t("manifest_security_findings")}
          </h2>
          <div className="space-y-2">
            {insights.map((insight) => (
              <InsightCard key={insight.id} insight={insight} />
            ))}
          </div>
        </section>

        {/* Permissions */}
        <section>
          <button
            className="flex items-center gap-1.5 w-full text-left mb-3 group"
            onClick={() => setPermsOpen((o) => !o)}
          >
            <ChevronRight
              className={`h-4 w-4 text-muted-foreground transition-transform duration-150 ${permsOpen ? "rotate-90" : ""}`}
            />
            <h2 className="text-sm font-semibold text-foreground group-hover:text-foreground/80">
              {permissions.length > 0
                ? t("manifest_declared_permissions_count", { count: permissions.length })
                : t("manifest_declared_permissions")}
            </h2>
          </button>
          {permsOpen && (
            permissions.length > 0 ? (
              <div className="rounded-lg border px-4 divide-y-0">
                {[...permissions]
                  .sort((a, b) => (b.dangerous ? 1 : 0) - (a.dangerous ? 1 : 0))
                  .map((perm) => (
                    <PermissionRow key={perm.name} perm={perm} />
                  ))}
              </div>
            ) : (
              <div className="rounded-lg border p-4 text-sm text-muted-foreground">
                {t("manifest_no_permissions_desc")}
              </div>
            )
          )}
        </section>
      </div>
    </div>
  );
}

```

`gui/src/components/tabs/MemoryPreviewTab.tsx`:

```tsx
import type { IDockviewPanelProps } from "dockview";
import { Loader2 } from "lucide-react";
import { t } from "i18next";

import HexView from "../shared/HexView";
import { useFruityQuery } from "@/lib/queries";

export interface MemoryPreviewTabParams {
  address: string;
  size: number;
}

export function MemoryPreviewTab({
  params,
}: IDockviewPanelProps<MemoryPreviewTabParams>) {
  const address = params?.address;
  const size = params?.size;

  const {
    data: rawData,
    isLoading,
    error,
  } = useFruityQuery<ArrayBuffer | null>(
    ["memory", address ?? "", String(size ?? 0)],
    (api) => api.memory.dump(address!, size!),
    { enabled: !!address && !!size },
  );

  if (isLoading) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        <Loader2 className="h-4 w-4 animate-spin mr-2" />
        {t("loading")}
      </div>
    );
  }

  if (error) {
    return (
      <div className="flex items-center justify-center h-full text-red-500">
        {(error as Error).message}
      </div>
    );
  }

  if (!rawData) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        No data
      </div>
    );
  }

  return <HexView data={new Uint8Array(rawData)} stride={16} />;
}

```

`gui/src/components/tabs/MemoryScanTab.tsx`:

```tsx
import { useCallback, useEffect, useRef, useState } from "react";
import { useMutation } from "@tanstack/react-query";
import { useVirtualizer } from "@tanstack/react-virtual";
import { Play, Square, Loader2 } from "lucide-react";

import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import { Checkbox } from "@/components/ui/checkbox";
import { Progress } from "@/components/ui/progress";
import {
  ResizableHandle,
  ResizablePanel,
  ResizablePanelGroup,
} from "@/components/ui/resizable";

import HexView from "@/components/shared/HexView";
import { Platform, Status, useSession } from "@/context/SessionContext";
import { usePlatformQuery } from "@/lib/queries";
import type { MemoryScanEvent } from "@/lib/rpc";

type DataType =
  | "hex"
  | "utf8"
  | "utf16"
  | "int8"
  | "uint8"
  | "int16"
  | "uint16"
  | "int32"
  | "uint32"
  | "float"
  | "double";

interface ScanResult {
  address: string;
  size: number;
  preview: Uint8Array;
}

const ROW_HEIGHT = 28;
const MAX_RESULTS = 10000;

function toHexPattern(dataType: DataType, input: string): string | null {
  const trimmed = input.trim();
  if (!trimmed) return null;

  switch (dataType) {
    case "hex":
      return trimmed;

    case "utf8":
      return Array.from(new TextEncoder().encode(trimmed))
        .map((b) => b.toString(16).padStart(2, "0"))
        .join(" ");

    case "utf16": {
      const bytes: string[] = [];
      for (let i = 0; i < trimmed.length; i++) {
        const code = trimmed.charCodeAt(i);
        bytes.push((code & 0xff).toString(16).padStart(2, "0"));
        bytes.push(((code >> 8) & 0xff).toString(16).padStart(2, "0"));
      }
      return bytes.join(" ");
    }

    case "int8":
    case "uint8": {
      const n = parseInt(trimmed, 10);
      if (isNaN(n)) return null;
      const v = dataType === "int8" ? (n < 0 ? (n + 256) & 0xff : n & 0xff) : n & 0xff;
      return v.toString(16).padStart(2, "0");
    }

    case "int16":
    case "uint16": {
      const n = parseInt(trimmed, 10);
      if (isNaN(n)) return null;
      const v = dataType === "int16" ? (n < 0 ? (n + 65536) & 0xffff : n & 0xffff) : n & 0xffff;
      return [v & 0xff, (v >> 8) & 0xff]
        .map((b) => b.toString(16).padStart(2, "0"))
        .join(" ");
    }

    case "int32":
    case "uint32": {
      const n = parseInt(trimmed, 10);
      if (isNaN(n)) return null;
      const v = n >>> 0;
      return [v & 0xff, (v >> 8) & 0xff, (v >> 16) & 0xff, (v >> 24) & 0xff]
        .map((b) => b.toString(16).padStart(2, "0"))
        .join(" ");
    }

    case "float": {
      const n = parseFloat(trimmed);
      if (isNaN(n)) return null;
      const buf = new ArrayBuffer(4);
      new DataView(buf).setFloat32(0, n, true);
      return Array.from(new Uint8Array(buf))
        .map((b) => b.toString(16).padStart(2, "0"))
        .join(" ");
    }

    case "double": {
      const n = parseFloat(trimmed);
      if (isNaN(n)) return null;
      const buf = new ArrayBuffer(8);
      new DataView(buf).setFloat64(0, n, true);
      return Array.from(new Uint8Array(buf))
        .map((b) => b.toString(16).padStart(2, "0"))
        .join(" ");
    }
  }
}

function formatHexPreview(data: Uint8Array): string {
  const hex = Array.from(data.slice(0, 16))
    .map((b) => b.toString(16).padStart(2, "0"))
    .join(" ");
  const ascii = Array.from(data.slice(0, 16))
    .map((b) => (b >= 0x20 && b < 0x7f ? String.fromCharCode(b) : "."))
    .join("");
  return `${hex}  ${ascii}`;
}

const DUMP_SIZE = 256;

interface AddressInfo {
  module: { name: string; base: string; size: number; path: string } | null;
  range: { base: string; size: number; protection: string; file: { path: string; offset: number; size: number } | null } | null;
}

function DetailPanel({ address }: { address: string }) {
  const { data, isLoading, error } = usePlatformQuery<ArrayBuffer | null>(
    ["memoryScanDetail", address],
    (api) => api.memory.dump(address, DUMP_SIZE),
  );

  const { data: info } = usePlatformQuery<AddressInfo>(
    ["memoryScanInfo", address],
    (api) => api.memory.addressInfo(address),
  );

  if (isLoading) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground text-xs">
        <Loader2 className="h-4 w-4 animate-spin mr-2" />
        Loading...
      </div>
    );
  }

  if (error) {
    return (
      <div className="flex items-center justify-center h-full text-red-500 text-xs">
        {(error as Error).message}
      </div>
    );
  }

  if (!data) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground text-xs">
        No data
      </div>
    );
  }

  return (
    <div className="h-full flex flex-col overflow-hidden">
      <div className="px-3 py-1.5 border-b shrink-0 space-y-0.5">
        <div className="text-xs font-mono">{address}</div>
        {info?.module && (
          <div className="text-xs text-muted-foreground">
            <span className="text-primary">{info.module.name}</span>
            {" + "}
            <span className="font-mono">
              0x{(parseInt(address, 16) - parseInt(info.module.base, 16)).toString(16)}
            </span>
            <span className="ml-2 truncate" title={info.module.path}>
              {info.module.path}
            </span>
          </div>
        )}
        {info?.range && (
          <div className="text-xs text-muted-foreground">
            <span className="font-mono">{info.range.protection}</span>
            <span className="ml-2">
              {info.range.base} ({info.range.size} bytes)
            </span>
            {info.range.file && (
              <span className="ml-2 truncate" title={info.range.file.path}>
                {info.range.file.path}
              </span>
            )}
          </div>
        )}
      </div>
      <div className="flex-1 overflow-auto p-2">
        <HexView data={new Uint8Array(data)} stride={16} />
      </div>
    </div>
  );
}

export function MemoryScanTab() {
  const { platform, status, socket, fruity, droid } = useSession();

  const api = platform === Platform.Fruity ? fruity : droid;

  const [dataType, setDataType] = useState<DataType>("hex");
  const [pattern, setPattern] = useState("");
  const [protR, setProtR] = useState(true);
  const [protW, setProtW] = useState(false);
  const [protX, setProtX] = useState(false);
  const [scanning, setScanning] = useState(false);
  const [results, setResults] = useState<ScanResult[]>([]);
  const [progress, setProgress] = useState<{ current: number; total: number }>({ current: 0, total: 0 });
  const [matchCount, setMatchCount] = useState(0);
  const [selectedAddress, setSelectedAddress] = useState<string | null>(null);

  const listRef = useRef<HTMLDivElement>(null);

  const scanMutation = useMutation({
    mutationFn: async () => {
      const hexPattern = toHexPattern(dataType, pattern);
      if (!hexPattern || !api) throw new Error("Invalid pattern");
      setResults([]);
      setMatchCount(0);
      setProgress({ current: 0, total: 0 });
      setSelectedAddress(null);
      setScanning(true);
      const prot = `${protR ? "r" : "-"}${protW ? "w" : "-"}${protX ? "x" : "-"}`;
      await api.memory.scan(hexPattern, prot);
    },
    onError: () => {
      setScanning(false);
    },
  });

  const stopMutation = useMutation({
    mutationFn: async () => {
      if (!api) return;
      await api.memory.stopScan();
    },
    onSuccess: () => {
      setScanning(false);
    },
  });

  const handleEvent = useCallback((event: MemoryScanEvent, data?: ArrayBuffer) => {
    switch (event.event) {
      case "match":
        setMatchCount((c) => c + 1);
        setResults((prev) => {
          if (prev.length >= MAX_RESULTS) return prev;
          return [
            ...prev,
            {
              address: event.address!,
              size: event.size!,
              preview: data ? new Uint8Array(data) : new Uint8Array(),
            },
          ];
        });
        break;
      case "progress":
        setProgress({ current: event.current!, total: event.total! });
        break;
      case "done":
        setScanning(false);
        setMatchCount(event.count!);
        break;
    }
  }, []);

  useEffect(() => {
    if (status !== Status.Ready || !socket) return;

    socket.on("memoryScan", handleEvent);
    return () => {
      socket.off("memoryScan", handleEvent);
    };
  }, [status, socket, handleEvent]);

  const rowVirtualizer = useVirtualizer({
    count: results.length,
    getScrollElement: () => listRef.current,
    estimateSize: () => ROW_HEIGHT,
    overscan: 20,
  });

  const virtualRows = rowVirtualizer.getVirtualItems();

  const ready = status === Status.Ready && !!api;
  const canScan = ready && !scanning && !!pattern.trim() && !!toHexPattern(dataType, pattern);

  return (
    <ResizablePanelGroup
      orientation="horizontal"
      className="h-full"
      autoSaveId="memory-scan-split"
    >
      {/* Left: toolbar + results */}
      <ResizablePanel defaultSize="60%" minSize="30%">
        <div className="h-full flex flex-col overflow-hidden">
          {/* Toolbar */}
          <div className="flex items-center gap-2 p-2 border-b shrink-0 flex-wrap">
            <Select value={dataType} onValueChange={(v) => { if (v) setDataType(v as DataType); }}>
              <SelectTrigger className="w-28 h-8 text-xs">
                <SelectValue />
              </SelectTrigger>
              <SelectContent>
                <SelectItem value="hex">Hex</SelectItem>
                <SelectItem value="utf8">UTF-8</SelectItem>
                <SelectItem value="utf16">UTF-16</SelectItem>
                <SelectItem value="int8">Int8</SelectItem>
                <SelectItem value="uint8">UInt8</SelectItem>
                <SelectItem value="int16">Int16</SelectItem>
                <SelectItem value="uint16">UInt16</SelectItem>
                <SelectItem value="int32">Int32</SelectItem>
                <SelectItem value="uint32">UInt32</SelectItem>
                <SelectItem value="float">Float</SelectItem>
                <SelectItem value="double">Double</SelectItem>
              </SelectContent>
            </Select>

            <Input
              value={pattern}
              onChange={(e) => setPattern(e.target.value)}
              placeholder={dataType === "hex" ? "AA BB CC ??" : "Value..."}
              className="h-8 flex-1 min-w-[120px] max-w-xs font-mono text-xs"
              onKeyDown={(e) => {
                if (e.key === "Enter" && canScan) scanMutation.mutate();
              }}
            />

            <label className="flex items-center gap-1.5 text-xs shrink-0">
              <Checkbox checked={protR} onCheckedChange={setProtR} />
              Read
            </label>
            <label className="flex items-center gap-1.5 text-xs shrink-0">
              <Checkbox checked={protW} onCheckedChange={setProtW} />
              Write
            </label>
            <label className="flex items-center gap-1.5 text-xs shrink-0">
              <Checkbox checked={protX} onCheckedChange={setProtX} />
              Execute
            </label>

            {scanning ? (
              <Button
                variant="outline"
                size="sm"
                className="h-8 px-2.5 text-xs text-red-500 hover:text-red-600"
                onClick={() => stopMutation.mutate()}
                disabled={stopMutation.isPending}
              >
                {stopMutation.isPending ? (
                  <Loader2 className="w-3.5 h-3.5 animate-spin" />
                ) : (
                  <Square className="w-3.5 h-3.5" />
                )}
                Stop
              </Button>
            ) : (
              <Button
                variant="outline"
                size="sm"
                className="h-8 px-2.5 text-xs"
                onClick={() => scanMutation.mutate()}
                disabled={!canScan || scanMutation.isPending}
              >
                {scanMutation.isPending ? (
                  <Loader2 className="w-3.5 h-3.5 animate-spin" />
                ) : (
                  <Play className="w-3.5 h-3.5" />
                )}
                Scan
              </Button>
            )}
          </div>

          {/* Status bar */}
          <div className="flex items-center gap-3 px-3 py-1.5 border-b text-xs text-muted-foreground shrink-0">
            {scanning ? (
              <>
                <span>
                  Scanning... {progress.current}/{progress.total} ranges
                </span>
                <Progress
                  value={progress.total > 0 ? (progress.current / progress.total) * 100 : 0}
                  className="flex-1 max-w-xs"
                />
              </>
            ) : (
              <span>{results.length > 0 ? "Scan complete" : "Ready"}</span>
            )}
            <span className="ml-auto">{matchCount} matches</span>
          </div>

          {/* Results list */}
          <div ref={listRef} className="flex-1 overflow-auto">
            <div
              style={{
                height: rowVirtualizer.getTotalSize(),
                width: "100%",
                position: "relative",
              }}
            >
              {virtualRows.map((virtualRow) => {
                const result = results[virtualRow.index];
                return (
                  <div
                    key={virtualRow.key}
                    className={`absolute left-0 right-0 flex items-center px-3 font-mono text-xs cursor-pointer hover:bg-muted/50 border-b border-border/50 ${
                      selectedAddress === result.address ? "bg-accent" : ""
                    }`}
                    style={{
                      height: virtualRow.size,
                      transform: `translateY(${virtualRow.start}px)`,
                    }}
                    onClick={() =>
                      setSelectedAddress(
                        selectedAddress === result.address ? null : result.address,
                      )
                    }
                  >
                    <span className="w-32 shrink-0 text-primary">
                      {result.address}
                    </span>
                    <span className="truncate text-muted-foreground">
                      {formatHexPreview(result.preview)}
                    </span>
                  </div>
                );
              })}
            </div>
          </div>
        </div>
      </ResizablePanel>

      <ResizableHandle />

      {/* Right: detail hex dump */}
      <ResizablePanel defaultSize="40%" minSize="20%">
        {selectedAddress ? (
          <DetailPanel address={selectedAddress} />
        ) : (
          <div className="h-full flex items-center justify-center text-muted-foreground text-xs">
            Select a result to view hex dump
          </div>
        )}
      </ResizablePanel>
    </ResizablePanelGroup>
  );
}

```

`gui/src/components/tabs/ModuleViewTabs.tsx`:

```tsx
import type { IDockviewPanelProps } from "dockview";

import { ImportsListView } from "../views/ImportsListView";
import { SectionsListView } from "../views/SectionsListView";
import { ClassesListView } from "../views/ClassesListView";
import { SymbolsListView } from "../views/SymbolsListView";
import { ExportedListView } from "../views/ExportedListView";

interface ModuleViewParams {
  path: string;
}

export function ModuleImportsTab({
  params,
}: IDockviewPanelProps<ModuleViewParams>) {
  return (
    <div className="h-full flex flex-col p-4 overflow-hidden">
      <ImportsListView path={params.path} />
    </div>
  );
}

export function ModuleSectionsTab({
  params,
}: IDockviewPanelProps<ModuleViewParams>) {
  return (
    <div className="h-full flex flex-col p-4 overflow-hidden">
      <SectionsListView path={params.path} />
    </div>
  );
}

export function ModuleClassesTab({
  params,
}: IDockviewPanelProps<ModuleViewParams>) {
  return (
    <div className="h-full flex flex-col p-4 overflow-hidden">
      <ClassesListView path={params.path} />
    </div>
  );
}

export function ModuleSymbolsTab({
  params,
}: IDockviewPanelProps<ModuleViewParams>) {
  return (
    <div className="h-full flex flex-col p-4 overflow-hidden">
      <SymbolsListView path={params.path} />
    </div>
  );
}

export function ModuleExportedTab({
  params,
}: IDockviewPanelProps<ModuleViewParams>) {
  return (
    <div className="h-full flex flex-col p-4 overflow-hidden">
      <ExportedListView path={params.path} />
    </div>
  );
}

```

`gui/src/components/tabs/NoCloseTabHeader.tsx`:

```tsx
import type { IDockviewPanelHeaderProps } from "dockview";

export function NoCloseTabHeader({ api }: IDockviewPanelHeaderProps) {
  return (
    <div className="dv-default-tab">
      <span className="dv-default-tab-content">{api.title}</span>
    </div>
  );
}

```

`gui/src/components/tabs/ReactNativeTab.tsx`:

```tsx
import { useState, useCallback, useEffect } from "react";
import { Download, RefreshCw, Trash2, X } from "lucide-react";
import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { ScrollArea } from "@/components/ui/scroll-area";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";
import {
  ResizablePanelGroup,
  ResizablePanel,
  ResizableHandle,
} from "@/components/ui/resizable";
import { Spinner } from "../ui/spinner";
import { usePlatformQuery } from "@/lib/queries";
import { useQuery } from "@tanstack/react-query";
import { Platform, Status, useSession } from "@/context/SessionContext";
import ConsoleRepl from "@/components/shared/ConsoleRepl";
import { t } from "i18next";

interface RNInstance {
  className: string;
  arch: "legacy" | "bridgeless";
  handle: string;
}

interface HermesEntry {
  id: number;
  url: string;
  hash: string;
  size: number;
  createdAt: string | null;
}

function formatSize(bytes: number): string {
  if (bytes < 1024) return bytes + " B";
  if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + " KB";
  return (bytes / (1024 * 1024)).toFixed(1) + " MB";
}

function filenameFromUrl(url: string): string {
  const parts = url.split("/");
  return parts[parts.length - 1] || url;
}

export function ReactNativeTab() {
  const [selected, setSelected] = useState<RNInstance | null>(null);
  const { fruity, droid, platform, socket, status, device, identifier } =
    useSession();

  const { data: archResult, isLoading: archLoading } = usePlatformQuery<{
    legacy: boolean;
    bridgeless: boolean;
  }>(["rnArch"], (api) => api.rn.arch());

  const detected = archResult?.legacy || archResult?.bridgeless;

  const {
    data: instances = [],
    isLoading: instancesLoading,
    refetch,
  } = usePlatformQuery<RNInstance[]>(["rnList"], (api) => api.rn.list(), {
    enabled: !!detected,
  });

  // Hermes bundles from REST
  const {
    data: hermesData,
    isLoading: hermesLoading,
    refetch: refetchHermes,
  } = useQuery<{ logs: HermesEntry[]; total: number }>({
    queryKey: ["hermesHistory", device, identifier],
    queryFn: async () => {
      const res = await fetch(`/api/hermes/${device}/${identifier}?limit=1000`);
      if (!res.ok) throw new Error("Failed to load Hermes bundles");
      return res.json();
    },
    enabled: !!device && !!identifier,
    staleTime: 0,
    gcTime: 0,
  });

  const hermesBundles = hermesData?.logs ?? [];

  // Reload list on websocket hermes event
  useEffect(() => {
    if (status !== Status.Ready || !socket) return;
    const onHermes = () => {
      refetchHermes();
    };
    socket.on("hermes", onHermes);
    return () => {
      socket.off("hermes", onHermes);
    };
  }, [socket, status, refetchHermes]);

  const handleDownload = async (entry: HermesEntry) => {
    const res = await fetch(
      `/api/hermes/${device}/${identifier}/download/${entry.id}`,
    );
    if (!res.ok) return;
    const blob = await res.blob();
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = filenameFromUrl(entry.url);
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  };

  const handleDeleteBundle = async (entry: HermesEntry) => {
    const res = await fetch(
      `/api/hermes/${device}/${identifier}/${entry.id}`,
      { method: "DELETE" },
    );
    if (res.ok) refetchHermes();
  };

  const handleClearBundles = async () => {
    const res = await fetch(`/api/hermes/${device}/${identifier}`, {
      method: "DELETE",
    });
    if (res.ok) refetchHermes();
  };

  const api = platform === Platform.Droid ? droid : fruity;

  const handleEvaluate = useCallback(
    async (input: string) => {
      if (!selected || !api) throw new Error("No instance selected");
      const raw = await api.rn.inject(selected.handle, selected.arch, input);
      if (raw === "undefined" || raw === undefined) return undefined;
      const parsed = JSON.parse(raw);
      if (
        parsed !== null &&
        typeof parsed === "object" &&
        "error" in parsed &&
        typeof parsed.error === "string"
      ) {
        throw new Error(parsed.error);
      }
      return parsed;
    },
    [selected, api],
  );

  if (archLoading) {
    return (
      <div className="h-full flex items-center justify-center text-muted-foreground">
        <Spinner className="mr-2" />
        {t("loading")}
      </div>
    );
  }

  if (!detected) {
    return (
      <div className="h-full flex items-center justify-center text-sm text-muted-foreground">
        {t("rn_not_detected")}
      </div>
    );
  }

  return (
    <ResizablePanelGroup
      orientation="horizontal"
      autoSaveId="rn-instances"
      className="h-full"
    >
      <ResizablePanel defaultSize={30} minSize={20}>
        <div className="h-full flex flex-col border-r">
          <ResizablePanelGroup
            orientation="vertical"
            autoSaveId="rn-left-panel"
          >
            {/* Top: Instances */}
            <ResizablePanel defaultSize={50} minSize={20}>
              <div className="h-full flex flex-col">
                <div className="flex items-center justify-between px-3 py-2 border-b gap-2">
                  <div className="flex items-center gap-1.5">
                    <h2 className="text-sm font-semibold">
                      {t("rn_instances")}
                    </h2>
                    {archResult?.legacy && (
                      <Badge className="text-[10px] px-1.5 py-0">legacy</Badge>
                    )}
                    {archResult?.bridgeless && (
                      <Badge className="text-[10px] px-1.5 py-0">
                        bridgeless
                      </Badge>
                    )}
                  </div>
                  <Button
                    variant="ghost"
                    size="icon"
                    className="h-7 w-7"
                    onClick={() => refetch()}
                    disabled={instancesLoading}
                  >
                    <RefreshCw
                      className={`h-3.5 w-3.5 ${instancesLoading ? "animate-spin" : ""}`}
                    />
                  </Button>
                </div>
                <ScrollArea className="flex-1">
                  {instancesLoading ? (
                    <div className="flex items-center justify-center py-8 text-muted-foreground">
                      <Spinner className="mr-2" />
                      <span className="text-sm">{t("loading")}</span>
                    </div>
                  ) : instances.length === 0 ? (
                    <div className="px-3 py-4 text-xs text-muted-foreground text-center">
                      {t("rn_no_instances")}
                    </div>
                  ) : (
                    instances.map((inst) => (
                      <button
                        key={inst.handle}
                        className={`w-full text-left px-3 py-2 text-sm border-b hover:bg-accent transition-colors ${
                          selected?.handle === inst.handle ? "bg-accent" : ""
                        }`}
                        onClick={() => setSelected(inst)}
                      >
                        <div className="flex items-center gap-2 min-w-0">
                          <Badge className="text-[10px] px-1.5 py-0 shrink-0">
                            {inst.arch}
                          </Badge>
                          <span className="text-xs truncate">
                            {inst.className}
                          </span>
                          <span className="font-mono text-xs text-muted-foreground truncate shrink-0">
                            {inst.handle}
                          </span>
                        </div>
                      </button>
                    ))
                  )}
                </ScrollArea>
              </div>
            </ResizablePanel>

            <ResizableHandle />

            {/* Bottom: Hermes Bundles */}
            <ResizablePanel defaultSize={50} minSize={20}>
              <div className="h-full flex flex-col">
                <div className="flex items-center justify-between px-3 py-2 border-b gap-2">
                  <div className="flex items-center gap-1.5">
                    <h2 className="text-sm font-semibold">
                      {t("rn_js_bundles")}
                    </h2>
                    <Badge
                      variant="secondary"
                      className="text-[10px] px-1.5 py-0"
                    >
                      {hermesBundles.length}
                    </Badge>
                  </div>
                  <div className="flex items-center gap-0.5">
                    <Button
                      variant="ghost"
                      size="icon"
                      className="h-7 w-7"
                      onClick={() => refetchHermes()}
                      disabled={hermesLoading}
                    >
                      <RefreshCw
                        className={`h-3.5 w-3.5 ${hermesLoading ? "animate-spin" : ""}`}
                      />
                    </Button>
                    <DropdownMenu>
                      <DropdownMenuTrigger
                        render={
                          <Button
                            variant="ghost"
                            size="icon"
                            className="h-7 w-7"
                            disabled={hermesBundles.length === 0}
                          />
                        }
                      >
                        <Trash2 className="h-3.5 w-3.5" />
                      </DropdownMenuTrigger>
                      <DropdownMenuContent align="end">
                        <DropdownMenuItem
                          onClick={handleClearBundles}
                          className="text-destructive focus:text-destructive"
                        >
                          {t("clear_all")}
                        </DropdownMenuItem>
                      </DropdownMenuContent>
                    </DropdownMenu>
                  </div>
                </div>
                <ScrollArea className="flex-1">
                  {hermesLoading ? (
                    <div className="flex items-center justify-center py-8 text-muted-foreground">
                      <Spinner className="mr-2" />
                      <span className="text-sm">{t("loading")}</span>
                    </div>
                  ) : hermesBundles.length === 0 ? (
                    <div className="px-3 py-4 text-xs text-muted-foreground text-center">
                      {t("rn_no_bundles")}
                    </div>
                  ) : (
                    hermesBundles.map((entry) => (
                      <div
                        key={entry.id}
                        className="flex items-center gap-2 px-3 py-1.5 border-b hover:bg-accent/50 min-w-0"
                      >
                        <div className="flex-1 min-w-0">
                          <div
                            className="font-mono text-xs truncate"
                            title={entry.url}
                          >
                            {filenameFromUrl(entry.url)}
                          </div>
                          <div className="flex items-center gap-2 text-[10px] text-muted-foreground">
                            <span className="font-mono">
                              {entry.hash.slice(0, 12)}
                            </span>
                            <span>{formatSize(entry.size)}</span>
                          </div>
                        </div>
                        <Button
                          variant="ghost"
                          size="icon"
                          className="h-6 w-6 shrink-0"
                          onClick={() => handleDownload(entry)}
                          title={t("download")}
                        >
                          <Download className="h-3 w-3" />
                        </Button>
                        <DropdownMenu>
                          <DropdownMenuTrigger
                            render={
                              <Button
                                variant="ghost"
                                size="icon"
                                className="h-6 w-6 shrink-0"
                              />
                            }
                          >
                            <X className="h-3 w-3" />
                          </DropdownMenuTrigger>
                          <DropdownMenuContent align="end">
                            <DropdownMenuItem
                              onClick={() => handleDeleteBundle(entry)}
                              className="text-destructive focus:text-destructive"
                            >
                              {t("delete")}
                            </DropdownMenuItem>
                          </DropdownMenuContent>
                        </DropdownMenu>
                      </div>
                    ))
                  )}
                </ScrollArea>
              </div>
            </ResizablePanel>
          </ResizablePanelGroup>
        </div>
      </ResizablePanel>
      <ResizableHandle withHandle />
      <ResizablePanel defaultSize={70} minSize={30}>
        {selected ? (
          <ConsoleRepl
            key={selected.handle}
            onEvaluate={handleEvaluate}
            placeholder={t("rn_js_expression")}
          />
        ) : (
          <div className="h-full flex items-center justify-center text-sm text-muted-foreground">
            {t("rn_select_instance")}
          </div>
        )}
      </ResizablePanel>
    </ResizablePanelGroup>
  );
}

```

`gui/src/components/tabs/SQLiteEditorTab.tsx`:

```tsx
import { useEffect, useState } from "react";
import { useTranslation } from "react-i18next";
import type { IDockviewPanelProps } from "dockview";
import { Loader2 } from "lucide-react";

import type { DumpResult } from "@agent/common/sqlite";

import { Platform, useSession } from "@/context/SessionContext";
import { Input } from "@/components/ui/input";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";
import {
  ResizablePanelGroup,
  ResizablePanel,
  ResizableHandle,
} from "@/components/ui/resizable";
import { useQuery, useMutation } from "@tanstack/react-query";

export interface SQLiteEditorTabParams {
  path: string;
}

export function SQLiteEditorTab({
  params,
}: IDockviewPanelProps<SQLiteEditorTabParams>) {
  const { t } = useTranslation();
  const { fruity, droid, platform } = useSession();
  const sqlite =
    (platform === Platform.Droid ? droid?.sqlite : fruity?.sqlite) ?? null;

  const [filteredTables, setFilteredTables] = useState<string[]>([]);
  const [tableSearch, setTableSearch] = useState("");
  const [dumpResult, setDumpResult] = useState<DumpResult | null>(null);

  const fullPath = params?.path || "";

  // Fetch tables
  const {
    data: tables = [],
    isLoading,
    error,
  } = useQuery<string[], Error>({
    queryKey: ["sqliteTables", fullPath],
    queryFn: () => sqlite!.tables(fullPath),
    enabled: !!sqlite && !!fullPath,
    staleTime: 0,
    gcTime: 0,
  });

  // Mutation for loading table data (dump)
  const dumpMutation = useMutation<DumpResult, Error, { table: string }>({
    mutationFn: ({ table }) => sqlite!.dump(fullPath, table),
  });

  useEffect(() => {
    setFilteredTables(tables);
  }, [tables]);

  const loadTableData = async (tableName: string) => {
    try {
      const result = await dumpMutation.mutateAsync({ table: tableName });
      setDumpResult(result);
    } catch (err) {
      console.error("Failed to load table data:", err);
    }
  };

  useEffect(() => {
    if (tableSearch.trim() === "") {
      setFilteredTables(tables);
    } else {
      const lower = tableSearch.toLowerCase();
      setFilteredTables(tables.filter((t) => t.toLowerCase().includes(lower)));
    }
  }, [tableSearch, tables]);

  const isLoadingTable = dumpMutation.isPending;

  if (isLoading) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        <Loader2 className="h-4 w-4 animate-spin mr-2" />
        {t("loading")}...
      </div>
    );
  }

  if (error) {
    return (
      <div className="flex items-center justify-center h-full text-destructive">
        {(error as Error).message}
      </div>
    );
  }

  return (
    <ResizablePanelGroup
      orientation="horizontal"
      autoSaveId="sqlite-editor"
      className="h-full"
    >
      <ResizablePanel defaultSize="30%" minSize="20%">
        <div className="h-full flex flex-col border-r">
          <div className="p-2 border-b">
            <Input
              placeholder={t("search")}
              value={tableSearch}
              onChange={(e) => setTableSearch(e.target.value)}
            />
          </div>
          <div className="flex-1 overflow-auto">
            {filteredTables.map((table) => (
              <button
                key={table}
                onClick={() => loadTableData(table)}
                disabled={isLoadingTable}
                className="w-full px-3 py-2 text-left hover:bg-accent hover:text-accent-foreground text-sm truncate disabled:opacity-50"
              >
                {table}
              </button>
            ))}
          </div>
        </div>
      </ResizablePanel>
      <ResizableHandle withHandle />
      <ResizablePanel defaultSize="70%" minSize="30%">
        <div className="h-full overflow-auto">
          {dumpResult ? (
            <Table>
              <TableHeader>
                <TableRow>
                  {dumpResult.header.map((h, i) => (
                    <TableHead key={i}>
                      <div className="flex flex-col">
                        <span>{h.name}</span>
                        <span className="text-xs text-muted-foreground">
                          {h.type}
                        </span>
                      </div>
                    </TableHead>
                  ))}
                </TableRow>
              </TableHeader>
              <TableBody>
                {dumpResult.data.map((row, rowIndex) => (
                  <TableRow key={rowIndex}>
                    {dumpResult.header.map((_, colIndex) => (
                      <TableCell key={colIndex}>
                        {row[colIndex] === null ||
                        row[colIndex] === undefined
                          ? "NULL"
                          : String(row[colIndex])}
                      </TableCell>
                    ))}
                  </TableRow>
                ))}
              </TableBody>
            </Table>
          ) : (
            <div className="flex items-center justify-center h-full text-muted-foreground text-sm">
              {t("select_table_or_execute")}
            </div>
          )}
        </div>
      </ResizablePanel>
    </ResizablePanelGroup>
  );
}

```

`gui/src/components/tabs/TextEditorTab.tsx`:

```tsx
import Editor, { loader } from "@monaco-editor/react";
import type { IDockviewPanelProps } from "dockview";
import { Loader2 } from "lucide-react";
import { Magika } from "magika";
import { useCallback, useEffect, useState } from "react";
import { useTranslation } from "react-i18next";

import { useTheme } from "@/components/providers/ThemeProvider";
import { Platform, useSession } from "@/context/SessionContext";
import { useDock } from "@/context/DockContext";
import { Button } from "@/components/ui/button";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import { useQuery } from "@tanstack/react-query";

const LANGUAGES = [
  { value: "javascript", label: "JavaScript", ext: ["js", "mjs", "cjs"] },
  { value: "typescript", label: "TypeScript", ext: ["ts", "tsx"] },
  { value: "css", label: "CSS", ext: ["css"] },
  { value: "html", label: "HTML", ext: ["html", "htm"] },
  { value: "xml", label: "XML", ext: ["xml"] },
  { value: "json", label: "JSON", ext: ["json", "jsonc", "jsonl"] },
  { value: "wasm", label: "WebAssembly", ext: ["wasm"] },
  { value: "kotlin", label: "Kotlin", ext: ["kt", "kts"] },
  { value: "java", label: "Java", ext: ["java"] },
  { value: "gradle", label: "Gradle", ext: ["gradle"] },
  { value: "smali", label: "Smali", ext: ["smali"] },
  { value: "swift", label: "Swift", ext: ["swift"] },
  { value: "objectivec", label: "Objective-C", ext: ["m", "mm"] },
  { value: "dart", label: "Dart", ext: ["dart"] },
  { value: "yaml", label: "YAML", ext: ["yml", "yaml"] },
  { value: "ini", label: "INI", ext: ["ini"] },
  { value: "toml", label: "TOML", ext: ["toml"] },
  { value: "lua", label: "Lua", ext: ["lua"] },
  { value: "python", label: "Python", ext: ["py", "pyw"] },
  { value: "protobuf", label: "Protocol Buffers", ext: ["proto", "textproto"] },
  { value: "shell", label: "Shell", ext: ["sh", "bash", "zsh"] },
  { value: "sql", label: "SQL", ext: ["sql"] },
  { value: "markdown", label: "Markdown", ext: ["md", "markdown"] },
  { value: "ruby", label: "Ruby", ext: ["rb"] },
  { value: "plaintext", label: "Plain Text", ext: ["txt", "text", "log"] },
];

const MAGIKA_TO_SYNTAX: Record<string, string> = {
  // --- Web / Hybrid ---
  javascript: "javascript",
  typescript: "typescript",
  tsx: "typescript",
  jsx: "javascript",
  css: "css",
  html: "html",
  json: "json",
  jsonc: "json",
  jsonl: "json",
  vue: "html", // Vue files often highlight well as HTML or specialized vue
  wasm: "wasm",

  // --- Native Android ---
  kotlin: "kotlin",
  java: "java",
  gradle: "gradle",
  xml: "xml",
  smali: "smali", // Common in decompiled Android apps

  // --- Native iOS ---
  swift: "swift",
  objectivec: "objectivec",
  appleplist: "xml",

  // --- Cross Platform ---
  dart: "dart", // Flutter

  // --- Config / Data / Scripts ---
  yaml: "yaml",
  ini: "ini",
  toml: "toml",
  lua: "lua",
  python: "python",
  proto: "protobuf",
  textproto: "protobuf",
  shell: "shell",
  sql: "sql",
  markdown: "markdown",
  ruby: "ruby", // often used for Fastlane files
  pem: "plaintext", // Certificates
  license: "plaintext",

  // --- Fallbacks ---
  txt: "plaintext",
  txtutf8: "plaintext",
  txtascii: "plaintext",
};

export interface TextEditorTabParams {
  path: string;
}

export function TextEditorTab({
  params,
}: IDockviewPanelProps<TextEditorTabParams>) {
  const { t } = useTranslation();
  const { theme } = useTheme();
  const { fruity, droid, platform } = useSession();
  const { openSingletonPanel } = useDock();
  const [content, setContent] = useState<string | null>(null);
  const [isInvalidUtf8, setIsInvalidUtf8] = useState(false);
  const [selectedLanguage, setSelectedLanguage] = useState<string>("");

  const [magika, setMagika] = useState<Magika | null>(null);

  const fullPath = params?.path || "";

  loader.init().then((monaco) => {
    for (let i = 0; i < LANGUAGES.length; i++) {
      monaco.languages.register({ id: LANGUAGES[i].value });
    }
  });

  useEffect(() => {
    Magika.create().then(setMagika);
  }, []);

  const detectSyntaxFromBytes = useCallback(
    async (u8: Uint8Array): Promise<string> => {
      if (magika) {
        const info = await magika.identifyBytes(u8);

        if (info.status === "ok") {
          const label = info.prediction.dl.label;
          const isText = info.prediction.dl.is_text;

          if (!isText) return "plaintext";

          const mappedSyntax = MAGIKA_TO_SYNTAX[label];
          if (mappedSyntax) return mappedSyntax;
        }
      }

      return "plaintext";
    },
    [magika],
  );

  const fs = (platform === Platform.Droid ? droid?.fs : fruity?.fs) ?? null;

  const {
    data: rawData,
    isLoading,
    error,
  } = useQuery<ArrayBuffer | null, Error>({
    queryKey: ["filePreview", fullPath],
    queryFn: () => fs!.preview(fullPath),
    enabled: !!fs && !!fullPath,
    staleTime: 0,
    gcTime: 0,
  });

  useEffect(() => {
    if (!rawData) return;

    const processData = async () => {
      const u8 = new Uint8Array(rawData);
      setSelectedLanguage(await detectSyntaxFromBytes(u8));

      try {
        const text = new TextDecoder("utf-8", { fatal: true }).decode(u8);
        setContent(text);
        setIsInvalidUtf8(false);
      } catch {
        setContent(null);
        setIsInvalidUtf8(true);
      }
    };

    processData();
  }, [rawData, detectSyntaxFromBytes]);

  const handleOpenInHexPreview = useCallback(() => {
    openSingletonPanel({
      id: `hexPreview-${fullPath}`,
      component: "hexPreview",
      title: fullPath.split("/").pop()!,
      params: { path: fullPath },
    });
  }, [fullPath, openSingletonPanel]);

  if (isLoading) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        <Loader2 className="w-6 h-6 animate-spin mr-2" />
        {t("loading")}...
      </div>
    );
  }

  if (error) {
    return (
      <div className="flex items-center justify-center h-full text-destructive">
        {(error as Error).message}
      </div>
    );
  }

  if (isInvalidUtf8) {
    return (
      <div className="flex flex-col items-center justify-center h-full gap-4 p-8 text-center">
        <div className="text-destructive text-lg">{t("invalid_utf8_file")}</div>
        <div className="text-muted-foreground text-sm max-w-md">
          {t("invalid_utf8_description")}
        </div>
        <Button onClick={handleOpenInHexPreview}>
          {t("open_in_hex_preview")}
        </Button>
      </div>
    );
  }

  if (!content) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        {t("no_content")}
      </div>
    );
  }

  return (
    <div className="h-full flex flex-col bg-background">
      <div className="flex-none px-4 py-2 bg-muted/50 border-b flex justify-between items-center gap-4">
        <span className="truncate text-sm">{fullPath}</span>
        <Select value={selectedLanguage} onValueChange={(v) => { if (v) setSelectedLanguage(v) }}>
          <SelectTrigger className="w-40">
            <SelectValue />
          </SelectTrigger>
          <SelectContent>
            {LANGUAGES.map((lang) => (
              <SelectItem key={lang.value} value={lang.value}>
                {lang.label}
              </SelectItem>
            ))}
          </SelectContent>
        </Select>
      </div>
      <div className="flex-1 overflow-hidden">
        <Editor
          height="100%"
          language={selectedLanguage}
          value={content}
          theme={theme === "dark" ? "vs-dark" : "light"}
          options={{
            readOnly: true,
            minimap: { enabled: false },
            scrollBeyondLastLine: false,
            wordWrap: "on",
            fontSize: 13,
            lineNumbers: "on",
            folding: true,
            automaticLayout: true,
          }}
        />
      </div>
    </div>
  );
}

```

`gui/src/components/ui/alert-dialog.tsx`:

```tsx
"use client"

import * as React from "react"
import { AlertDialog as AlertDialogPrimitive } from "@base-ui/react/alert-dialog"

import { cn } from "@/lib/utils"
import { Button } from "@/components/ui/button"

function AlertDialog({ ...props }: AlertDialogPrimitive.Root.Props) {
  return <AlertDialogPrimitive.Root data-slot="alert-dialog" {...props} />
}

function AlertDialogTrigger({ ...props }: AlertDialogPrimitive.Trigger.Props) {
  return (
    <AlertDialogPrimitive.Trigger data-slot="alert-dialog-trigger" {...props} />
  )
}

function AlertDialogPortal({ ...props }: AlertDialogPrimitive.Portal.Props) {
  return (
    <AlertDialogPrimitive.Portal data-slot="alert-dialog-portal" {...props} />
  )
}

function AlertDialogOverlay({
  className,
  ...props
}: AlertDialogPrimitive.Backdrop.Props) {
  return (
    <AlertDialogPrimitive.Backdrop
      data-slot="alert-dialog-overlay"
      className={cn(
        "data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 bg-black/10 duration-100 supports-backdrop-filter:backdrop-blur-xs fixed inset-0 isolate z-50",
        className
      )}
      {...props}
    />
  )
}

function AlertDialogContent({
  className,
  size = "default",
  ...props
}: AlertDialogPrimitive.Popup.Props & {
  size?: "default" | "sm" | "lg"
}) {
  return (
    <AlertDialogPortal>
      <AlertDialogOverlay />
      <AlertDialogPrimitive.Popup
        data-slot="alert-dialog-content"
        data-size={size}
        className={cn(
          "data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 bg-background ring-foreground/10 gap-6 rounded-xl p-6 ring-1 duration-100 data-[size=default]:max-w-xs data-[size=sm]:max-w-xs data-[size=lg]:max-w-2xl data-[size=default]:sm:max-w-lg data-[size=lg]:sm:max-w-2xl group/alert-dialog-content fixed top-1/2 left-1/2 z-50 grid w-full -translate-x-1/2 -translate-y-1/2 outline-none",
          className
        )}
        {...props}
      />
    </AlertDialogPortal>
  )
}

function AlertDialogHeader({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-dialog-header"
      className={cn("grid grid-rows-[auto_1fr] place-items-center gap-1.5 text-center has-data-[slot=alert-dialog-media]:grid-rows-[auto_auto_1fr] has-data-[slot=alert-dialog-media]:gap-x-6 sm:group-data-[size=default]/alert-dialog-content:place-items-start sm:group-data-[size=default]/alert-dialog-content:text-left sm:group-data-[size=default]/alert-dialog-content:has-data-[slot=alert-dialog-media]:grid-rows-[auto_1fr]", className)}
      {...props}
    />
  )
}

function AlertDialogFooter({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-dialog-footer"
      className={cn(
        "flex flex-col-reverse gap-2 group-data-[size=sm]/alert-dialog-content:grid group-data-[size=sm]/alert-dialog-content:grid-cols-2 sm:flex-row sm:justify-end",
        className
      )}
      {...props}
    />
  )
}

function AlertDialogMedia({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-dialog-media"
      className={cn("bg-muted mb-2 inline-flex size-16 items-center justify-center rounded-md sm:group-data-[size=default]/alert-dialog-content:row-span-2 *:[svg:not([class*='size-'])]:size-8", className)}
      {...props}
    />
  )
}

function AlertDialogTitle({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Title>) {
  return (
    <AlertDialogPrimitive.Title
      data-slot="alert-dialog-title"
      className={cn("text-lg font-medium sm:group-data-[size=default]/alert-dialog-content:group-has-data-[slot=alert-dialog-media]/alert-dialog-content:col-start-2", className)}
      {...props}
    />
  )
}

function AlertDialogDescription({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Description>) {
  return (
    <AlertDialogPrimitive.Description
      data-slot="alert-dialog-description"
      className={cn("text-muted-foreground *:[a]:hover:text-foreground text-sm text-balance md:text-pretty *:[a]:underline *:[a]:underline-offset-3", className)}
      {...props}
    />
  )
}

function AlertDialogAction({
  className,
  ...props
}: React.ComponentProps<typeof Button>) {
  return (
    <Button
      data-slot="alert-dialog-action"
      className={cn(className)}
      {...props}
    />
  )
}

function AlertDialogCancel({
  className,
  variant = "outline",
  size = "default",
  ...props
}: AlertDialogPrimitive.Close.Props &
  Pick<React.ComponentProps<typeof Button>, "variant" | "size">) {
  return (
    <AlertDialogPrimitive.Close
      data-slot="alert-dialog-cancel"
      className={cn(className)}
      render={<Button variant={variant} size={size} />}
      {...props}
    />
  )
}

export {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogMedia,
  AlertDialogOverlay,
  AlertDialogPortal,
  AlertDialogTitle,
  AlertDialogTrigger,
}

```

`gui/src/components/ui/alert.tsx`:

```tsx
import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const alertVariants = cva("grid gap-0.5 rounded-lg border px-4 py-3 text-left text-sm has-data-[slot=alert-action]:relative has-data-[slot=alert-action]:pr-18 has-[>svg]:grid-cols-[auto_1fr] has-[>svg]:gap-x-2.5 *:[svg]:row-span-2 *:[svg]:translate-y-0.5 *:[svg]:text-current *:[svg:not([class*='size-'])]:size-4 w-full relative group/alert", {
  variants: {
    variant: {
      default: "bg-card text-card-foreground",
      destructive: "text-destructive bg-card *:data-[slot=alert-description]:text-destructive/90 *:[svg]:text-current",
    },
  },
  defaultVariants: {
    variant: "default",
  },
})

function Alert({
  className,
  variant,
  ...props
}: React.ComponentProps<"div"> & VariantProps<typeof alertVariants>) {
  return (
    <div
      data-slot="alert"
      role="alert"
      className={cn(alertVariants({ variant }), className)}
      {...props}
    />
  )
}

function AlertTitle({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-title"
      className={cn(
        "font-medium group-has-[>svg]/alert:col-start-2 [&_a]:hover:text-foreground [&_a]:underline [&_a]:underline-offset-3",
        className
      )}
      {...props}
    />
  )
}

function AlertDescription({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-description"
      className={cn(
        "text-muted-foreground text-sm text-balance md:text-pretty [&_p:not(:last-child)]:mb-4 [&_a]:hover:text-foreground [&_a]:underline [&_a]:underline-offset-3",
        className
      )}
      {...props}
    />
  )
}

function AlertAction({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-action"
      className={cn("absolute top-2.5 right-3", className)}
      {...props}
    />
  )
}

export { Alert, AlertTitle, AlertDescription, AlertAction }

```

`gui/src/components/ui/badge.tsx`:

```tsx
import { mergeProps } from "@base-ui/react/merge-props"
import { useRender } from "@base-ui/react/use-render"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const badgeVariants = cva(
  "h-5 gap-1 rounded-4xl border border-transparent px-2 py-0.5 text-xs font-medium transition-all has-data-[icon=inline-end]:pr-1.5 has-data-[icon=inline-start]:pl-1.5 [&>svg]:size-3! inline-flex items-center justify-center w-fit whitespace-nowrap shrink-0 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive overflow-hidden group/badge",
  {
    variants: {
      variant: {
        default: "bg-primary text-primary-foreground [a]:hover:bg-primary/80",
        secondary: "bg-secondary text-secondary-foreground [a]:hover:bg-secondary/80",
        destructive: "bg-destructive/10 [a]:hover:bg-destructive/20 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 text-destructive dark:bg-destructive/20",
        outline: "border-border text-foreground [a]:hover:bg-muted [a]:hover:text-muted-foreground",
        ghost: "hover:bg-muted hover:text-muted-foreground dark:hover:bg-muted/50",
        link: "text-primary underline-offset-4 hover:underline",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

function Badge({
  className,
  variant = "default",
  render,
  ...props
}: useRender.ComponentProps<"span"> & VariantProps<typeof badgeVariants>) {
  return useRender({
    defaultTagName: "span",
    props: mergeProps<"span">(
      {
        className: cn(badgeVariants({ className, variant })),
      },
      props
    ),
    render,
    state: {
      slot: "badge",
      variant,
    },
  })
}

export { Badge, badgeVariants }


```

`gui/src/components/ui/button-group.tsx`:

```tsx
import { mergeProps } from "@base-ui/react/merge-props"
import { useRender } from "@base-ui/react/use-render"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"
import { Separator } from "@/components/ui/separator"

const buttonGroupVariants = cva(
  "has-[>[data-slot=button-group]]:gap-2 has-[select[aria-hidden=true]:last-child]:[&>[data-slot=select-trigger]:last-of-type]:rounded-r-md flex w-fit items-stretch *:focus-visible:z-10 *:focus-visible:relative [&>[data-slot=select-trigger]:not([class*='w-'])]:w-fit [&>input]:flex-1",
  {
    variants: {
      orientation: {
        horizontal:
          "[&>[data-slot]:not(:has(~[data-slot]))]:rounded-r-md! [&>[data-slot]~[data-slot]]:rounded-l-none [&>[data-slot]~[data-slot]]:border-l-0 *:data-slot:rounded-r-none",
        vertical:
          "[&>[data-slot]:not(:has(~[data-slot]))]:rounded-b-md! flex-col [&>[data-slot]~[data-slot]]:rounded-t-none [&>[data-slot]~[data-slot]]:border-t-0 *:data-slot:rounded-b-none",
      },
    },
    defaultVariants: {
      orientation: "horizontal",
    },
  }
)

function ButtonGroup({
  className,
  orientation,
  ...props
}: React.ComponentProps<"div"> & VariantProps<typeof buttonGroupVariants>) {
  return (
    <div
      role="group"
      data-slot="button-group"
      data-orientation={orientation}
      className={cn(buttonGroupVariants({ orientation }), className)}
      {...props}
    />
  )
}

function ButtonGroupText({
  className,
  render,
  ...props
}: useRender.ComponentProps<"div">) {
  return useRender({
    defaultTagName: "div",
    props: mergeProps<"div">(
      {
        className: cn(
          "bg-muted gap-2 rounded-md border px-2.5 text-sm font-medium shadow-xs [&_svg:not([class*='size-'])]:size-4 flex items-center [&_svg]:pointer-events-none",
          className
        ),
      },
      props
    ),
    render,
    state: {
      slot: "button-group-text",
    },
  })
}

function ButtonGroupSeparator({
  className,
  orientation = "vertical",
  ...props
}: React.ComponentProps<typeof Separator>) {
  return (
    <Separator
      data-slot="button-group-separator"
      orientation={orientation}
      className={cn(
        "bg-input relative self-stretch data-horizontal:mx-px data-horizontal:w-auto data-vertical:my-px data-vertical:h-auto",
        className
      )}
      {...props}
    />
  )
}

export {
  ButtonGroup,
  ButtonGroupSeparator,
  ButtonGroupText,
  buttonGroupVariants,
}

```

`gui/src/components/ui/button.tsx`:

```tsx
import { Button as ButtonPrimitive } from "@base-ui/react/button"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const buttonVariants = cva(
  "focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:aria-invalid:border-destructive/50 rounded-md border border-transparent bg-clip-padding text-sm font-medium focus-visible:ring-3 aria-invalid:ring-3 [&_svg:not([class*='size-'])]:size-4 inline-flex items-center justify-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none shrink-0 [&_svg]:shrink-0 outline-none group/button select-none",
  {
    variants: {
      variant: {
        default: "bg-primary text-primary-foreground hover:bg-primary/80",
        outline: "border-border bg-background hover:bg-muted hover:text-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 aria-expanded:bg-muted aria-expanded:text-foreground shadow-xs",
        secondary: "bg-secondary text-secondary-foreground hover:bg-secondary/80 aria-expanded:bg-secondary aria-expanded:text-secondary-foreground",
        ghost: "hover:bg-muted hover:text-foreground dark:hover:bg-muted/50 aria-expanded:bg-muted aria-expanded:text-foreground",
        destructive: "bg-destructive/10 hover:bg-destructive/20 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/20 text-destructive focus-visible:border-destructive/40 dark:hover:bg-destructive/30",
        link: "text-primary underline-offset-4 hover:underline",
      },
      size: {
        default: "h-9 gap-1.5 px-2.5 in-data-[slot=button-group]:rounded-md has-data-[icon=inline-end]:pr-2 has-data-[icon=inline-start]:pl-2",
        xs: "h-6 gap-1 rounded-[min(var(--radius-md),8px)] px-2 text-xs in-data-[slot=button-group]:rounded-md has-data-[icon=inline-end]:pr-1.5 has-data-[icon=inline-start]:pl-1.5 [&_svg:not([class*='size-'])]:size-3",
        sm: "h-8 gap-1 rounded-[min(var(--radius-md),10px)] px-2.5 in-data-[slot=button-group]:rounded-md has-data-[icon=inline-end]:pr-1.5 has-data-[icon=inline-start]:pl-1.5",
        lg: "h-10 gap-1.5 px-2.5 has-data-[icon=inline-end]:pr-3 has-data-[icon=inline-start]:pl-3",
        icon: "size-9",
        "icon-xs": "size-6 rounded-[min(var(--radius-md),8px)] in-data-[slot=button-group]:rounded-md [&_svg:not([class*='size-'])]:size-3",
        "icon-sm": "size-8 rounded-[min(var(--radius-md),10px)] in-data-[slot=button-group]:rounded-md",
        "icon-lg": "size-10",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

function Button({
  className,
  variant = "default",
  size = "default",
  ...props
}: ButtonPrimitive.Props & VariantProps<typeof buttonVariants>) {
  return (
    <ButtonPrimitive
      data-slot="button"
      className={cn(buttonVariants({ variant, size, className }))}
      {...props}
    />
  )
}

export { Button, buttonVariants }

```

`gui/src/components/ui/calendar.tsx`:

```tsx
import * as React from "react"
import {
  ChevronDownIcon,
  ChevronLeftIcon,
  ChevronRightIcon,
} from "lucide-react"
import {
  DayPicker,
  getDefaultClassNames,
  type DayButton,
} from "react-day-picker"

import { cn } from "@/lib/utils"
import { Button, buttonVariants } from "@/components/ui/button"

function Calendar({
  className,
  classNames,
  showOutsideDays = true,
  captionLayout = "label",
  buttonVariant = "ghost",
  formatters,
  components,
  ...props
}: React.ComponentProps<typeof DayPicker> & {
  buttonVariant?: React.ComponentProps<typeof Button>["variant"]
}) {
  const defaultClassNames = getDefaultClassNames()

  return (
    <DayPicker
      showOutsideDays={showOutsideDays}
      className={cn(
        "bg-background group/calendar p-3 [--cell-size:--spacing(8)] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",
        String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,
        String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,
        className
      )}
      captionLayout={captionLayout}
      formatters={{
        formatMonthDropdown: (date) =>
          date.toLocaleString("default", { month: "short" }),
        ...formatters,
      }}
      classNames={{
        root: cn("w-fit", defaultClassNames.root),
        months: cn(
          "flex gap-4 flex-col md:flex-row relative",
          defaultClassNames.months
        ),
        month: cn("flex flex-col w-full gap-4", defaultClassNames.month),
        nav: cn(
          "flex items-center gap-1 w-full absolute top-0 inset-x-0 justify-between",
          defaultClassNames.nav
        ),
        button_previous: cn(
          buttonVariants({ variant: buttonVariant }),
          "size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",
          defaultClassNames.button_previous
        ),
        button_next: cn(
          buttonVariants({ variant: buttonVariant }),
          "size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",
          defaultClassNames.button_next
        ),
        month_caption: cn(
          "flex items-center justify-center h-(--cell-size) w-full px-(--cell-size)",
          defaultClassNames.month_caption
        ),
        dropdowns: cn(
          "w-full flex items-center text-sm font-medium justify-center h-(--cell-size) gap-1.5",
          defaultClassNames.dropdowns
        ),
        dropdown_root: cn(
          "relative has-focus:border-ring border border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] rounded-md",
          defaultClassNames.dropdown_root
        ),
        dropdown: cn(
          "absolute bg-popover inset-0 opacity-0",
          defaultClassNames.dropdown
        ),
        caption_label: cn(
          "select-none font-medium",
          captionLayout === "label"
            ? "text-sm"
            : "rounded-md pl-2 pr-1 flex items-center gap-1 text-sm h-8 [&>svg]:text-muted-foreground [&>svg]:size-3.5",
          defaultClassNames.caption_label
        ),
        table: "w-full border-collapse",
        weekdays: cn("flex", defaultClassNames.weekdays),
        weekday: cn(
          "text-muted-foreground rounded-md flex-1 font-normal text-[0.8rem] select-none",
          defaultClassNames.weekday
        ),
        week: cn("flex w-full mt-2", defaultClassNames.week),
        week_number_header: cn(
          "select-none w-(--cell-size)",
          defaultClassNames.week_number_header
        ),
        week_number: cn(
          "text-[0.8rem] select-none text-muted-foreground",
          defaultClassNames.week_number
        ),
        day: cn(
          "relative w-full h-full p-0 text-center [&:last-child[data-selected=true]_button]:rounded-r-md group/day aspect-square select-none",
          props.showWeekNumber
            ? "[&:nth-child(2)[data-selected=true]_button]:rounded-l-md"
            : "[&:first-child[data-selected=true]_button]:rounded-l-md",
          defaultClassNames.day
        ),
        range_start: cn(
          "rounded-l-md bg-accent",
          defaultClassNames.range_start
        ),
        range_middle: cn("rounded-none", defaultClassNames.range_middle),
        range_end: cn("rounded-r-md bg-accent", defaultClassNames.range_end),
        today: cn(
          "bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",
          defaultClassNames.today
        ),
        outside: cn(
          "text-muted-foreground aria-selected:text-muted-foreground",
          defaultClassNames.outside
        ),
        disabled: cn(
          "text-muted-foreground opacity-50",
          defaultClassNames.disabled
        ),
        hidden: cn("invisible", defaultClassNames.hidden),
        ...classNames,
      }}
      components={{
        Root: ({ className, rootRef, ...props }) => {
          return (
            <div
              data-slot="calendar"
              ref={rootRef}
              className={cn(className)}
              {...props}
            />
          )
        },
        Chevron: ({ className, orientation, ...props }) => {
          if (orientation === "left") {
            return (
              <ChevronLeftIcon className={cn("size-4", className)} {...props} />
            )
          }

          if (orientation === "right") {
            return (
              <ChevronRightIcon
                className={cn("size-4", className)}
                {...props}
              />
            )
          }

          return (
            <ChevronDownIcon className={cn("size-4", className)} {...props} />
          )
        },
        DayButton: CalendarDayButton,
        WeekNumber: ({ children, ...props }) => {
          return (
            <td {...props}>
              <div className="flex size-(--cell-size) items-center justify-center text-center">
                {children}
              </div>
            </td>
          )
        },
        ...components,
      }}
      {...props}
    />
  )
}

function CalendarDayButton({
  className,
  day,
  modifiers,
  ...props
}: React.ComponentProps<typeof DayButton>) {
  const defaultClassNames = getDefaultClassNames()

  const ref = React.useRef<HTMLButtonElement>(null)
  React.useEffect(() => {
    if (modifiers.focused) ref.current?.focus()
  }, [modifiers.focused])

  return (
    <Button
      ref={ref}
      variant="ghost"
      size="icon"
      data-day={day.date.toLocaleDateString()}
      data-selected-single={
        modifiers.selected &&
        !modifiers.range_start &&
        !modifiers.range_end &&
        !modifiers.range_middle
      }
      data-range-start={modifiers.range_start}
      data-range-end={modifiers.range_end}
      data-range-middle={modifiers.range_middle}
      className={cn(
        "data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 dark:hover:text-accent-foreground flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-1 leading-none font-normal group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] data-[range-end=true]:rounded-md data-[range-end=true]:rounded-r-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-start=true]:rounded-l-md [&>span]:text-xs [&>span]:opacity-70",
        defaultClassNames.day,
        className
      )}
      {...props}
    />
  )
}

export { Calendar, CalendarDayButton }

```

`gui/src/components/ui/card.tsx`:

```tsx
import * as React from "react"

import { cn } from "@/lib/utils"

function Card({
  className,
  size = "default",
  ...props
}: React.ComponentProps<"div"> & { size?: "default" | "sm" }) {
  return (
    <div
      data-slot="card"
      data-size={size}
      className={cn("ring-foreground/10 bg-card text-card-foreground gap-6 overflow-hidden rounded-xl py-6 text-sm shadow-xs ring-1 has-[>img:first-child]:pt-0 data-[size=sm]:gap-4 data-[size=sm]:py-4 *:[img:first-child]:rounded-t-xl *:[img:last-child]:rounded-b-xl group/card flex flex-col", className)}
      {...props}
    />
  )
}

function CardHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-header"
      className={cn(
        "gap-1 rounded-t-xl px-6 group-data-[size=sm]/card:px-4 [.border-b]:pb-6 group-data-[size=sm]/card:[.border-b]:pb-4 group/card-header @container/card-header grid auto-rows-min items-start has-data-[slot=card-action]:grid-cols-[1fr_auto] has-data-[slot=card-description]:grid-rows-[auto_auto]",
        className
      )}
      {...props}
    />
  )
}

function CardTitle({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-title"
      className={cn("text-base leading-normal font-medium group-data-[size=sm]/card:text-sm", className)}
      {...props}
    />
  )
}

function CardDescription({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

function CardAction({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-action"
      className={cn(
        "col-start-2 row-span-2 row-start-1 self-start justify-self-end",
        className
      )}
      {...props}
    />
  )
}

function CardContent({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-content"
      className={cn("px-6 group-data-[size=sm]/card:px-4", className)}
      {...props}
    />
  )
}

function CardFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-footer"
      className={cn("rounded-b-xl px-6 group-data-[size=sm]/card:px-4 [.border-t]:pt-6 group-data-[size=sm]/card:[.border-t]:pt-4 flex items-center", className)}
      {...props}
    />
  )
}

export {
  Card,
  CardHeader,
  CardFooter,
  CardTitle,
  CardAction,
  CardDescription,
  CardContent,
}

```

`gui/src/components/ui/checkbox.tsx`:

```tsx
import { Checkbox as CheckboxPrimitive } from "@base-ui/react/checkbox"

import { cn } from "@/lib/utils"
import { CheckIcon } from "lucide-react"

function Checkbox({ className, ...props }: CheckboxPrimitive.Root.Props) {
  return (
    <CheckboxPrimitive.Root
      data-slot="checkbox"
      className={cn(
        "border-input dark:bg-input/30 data-checked:bg-primary data-checked:text-primary-foreground dark:data-checked:bg-primary data-checked:border-primary aria-invalid:aria-checked:border-primary aria-invalid:border-destructive dark:aria-invalid:border-destructive/50 focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 flex size-4 items-center justify-center rounded-[4px] border shadow-xs transition-shadow group-has-disabled/field:opacity-50 focus-visible:ring-3 aria-invalid:ring-3 peer relative shrink-0 outline-none after:absolute after:-inset-x-3 after:-inset-y-2 disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      {...props}
    >
      <CheckboxPrimitive.Indicator
        data-slot="checkbox-indicator"
        className="[&>svg]:size-3.5 grid place-content-center text-current transition-none"
      >
        <CheckIcon
        />
      </CheckboxPrimitive.Indicator>
    </CheckboxPrimitive.Root>
  )
}

export { Checkbox }

```

`gui/src/components/ui/command.tsx`:

```tsx
import * as React from "react"
import { Command as CommandPrimitive } from "cmdk"

import { cn } from "@/lib/utils"
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogHeader,
  DialogTitle,
} from "@/components/ui/dialog"
import {
  InputGroup,
  InputGroupAddon,
} from "@/components/ui/input-group"
import { SearchIcon, CheckIcon } from "lucide-react"

function Command({
  className,
  ...props
}: React.ComponentProps<typeof CommandPrimitive>) {
  return (
    <CommandPrimitive
      data-slot="command"
      className={cn(
        "bg-popover text-popover-foreground rounded-xl! p-1 flex size-full flex-col overflow-hidden",
        className
      )}
      {...props}
    />
  )
}

function CommandDialog({
  title = "Command Palette",
  description = "Search for a command to run...",
  children,
  className,
  showCloseButton = false,
  ...props
}: Omit<React.ComponentProps<typeof Dialog>, "children"> & {
  title?: string
  description?: string
  className?: string
  showCloseButton?: boolean
  children: React.ReactNode
}) {
  return (
    <Dialog {...props}>
      <DialogHeader className="sr-only">
        <DialogTitle>{title}</DialogTitle>
        <DialogDescription>{description}</DialogDescription>
      </DialogHeader>
      <DialogContent
        className={cn(
          "rounded-xl! top-1/3 translate-y-0 overflow-hidden p-0",
          className
        )}
        showCloseButton={showCloseButton}
      >
        {children}
      </DialogContent>
    </Dialog>
  )
}

function CommandInput({
  className,
  ...props
}: React.ComponentProps<typeof CommandPrimitive.Input>) {
  return (
    <div data-slot="command-input-wrapper" className="p-1 pb-0">
      <InputGroup className="bg-input/30 border-input/30 h-8! rounded-lg! shadow-none! *:data-[slot=input-group-addon]:pl-2!">
        <CommandPrimitive.Input
          data-slot="command-input"
          className={cn(
            "w-full text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",
            className
          )}
          {...props}
        />
        <InputGroupAddon>
          <SearchIcon className="size-4 shrink-0 opacity-50" />
        </InputGroupAddon>
      </InputGroup>
    </div>
  )
}

function CommandList({
  className,
  ...props
}: React.ComponentProps<typeof CommandPrimitive.List>) {
  return (
    <CommandPrimitive.List
      data-slot="command-list"
      className={cn(
        "no-scrollbar max-h-72 scroll-py-1 outline-none overflow-x-hidden overflow-y-auto",
        className
      )}
      {...props}
    />
  )
}

function CommandEmpty({
  className,
  ...props
}: React.ComponentProps<typeof CommandPrimitive.Empty>) {
  return (
    <CommandPrimitive.Empty
      data-slot="command-empty"
      className={cn("py-6 text-center text-sm", className)}
      {...props}
    />
  )
}

function CommandGroup({
  className,
  ...props
}: React.ComponentProps<typeof CommandPrimitive.Group>) {
  return (
    <CommandPrimitive.Group
      data-slot="command-group"
      className={cn("text-foreground **:[[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 **:[[cmdk-group-heading]]:px-2 **:[[cmdk-group-heading]]:py-1.5 **:[[cmdk-group-heading]]:text-xs **:[[cmdk-group-heading]]:font-medium", className)}
      {...props}
    />
  )
}

function CommandSeparator({
  className,
  ...props
}: React.ComponentProps<typeof CommandPrimitive.Separator>) {
  return (
    <CommandPrimitive.Separator
      data-slot="command-separator"
      className={cn("bg-border -mx-1 h-px w-auto", className)}
      {...props}
    />
  )
}

function CommandItem({
  className,
  children,
  ...props
}: React.ComponentProps<typeof CommandPrimitive.Item>) {
  return (
    <CommandPrimitive.Item
      data-slot="command-item"
      className={cn(
        "data-selected:bg-muted data-selected:text-foreground data-selected:**:[svg]:text-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none in-data-[slot=dialog-content]:rounded-lg! [&_svg:not([class*='size-'])]:size-4 group/command-item data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0",
        className
      )}
      {...props}
    >
      {children}
      <CheckIcon className="ml-auto opacity-0 group-has-data-[slot=command-shortcut]/command-item:hidden group-data-[checked=true]/command-item:opacity-100" />
    </CommandPrimitive.Item>
  )
}

function CommandShortcut({
  className,
  ...props
}: React.ComponentProps<"span">) {
  return (
    <span
      data-slot="command-shortcut"
      className={cn("text-muted-foreground group-data-selected/command-item:text-foreground ml-auto text-xs tracking-widest", className)}
      {...props}
    />
  )
}

export {
  Command,
  CommandDialog,
  CommandInput,
  CommandList,
  CommandEmpty,
  CommandGroup,
  CommandItem,
  CommandShortcut,
  CommandSeparator,
}

```

`gui/src/components/ui/dialog.tsx`:

```tsx
"use client"

import * as React from "react"
import { Dialog as DialogPrimitive } from "@base-ui/react/dialog"

import { cn } from "@/lib/utils"
import { Button } from "@/components/ui/button"
import { XIcon } from "lucide-react"

function Dialog({ ...props }: DialogPrimitive.Root.Props) {
  return <DialogPrimitive.Root data-slot="dialog" {...props} />
}

function DialogTrigger({ ...props }: DialogPrimitive.Trigger.Props) {
  return <DialogPrimitive.Trigger data-slot="dialog-trigger" {...props} />
}

function DialogPortal({ ...props }: DialogPrimitive.Portal.Props) {
  return <DialogPrimitive.Portal data-slot="dialog-portal" {...props} />
}

function DialogClose({ ...props }: DialogPrimitive.Close.Props) {
  return <DialogPrimitive.Close data-slot="dialog-close" {...props} />
}

function DialogOverlay({
  className,
  ...props
}: DialogPrimitive.Backdrop.Props) {
  return (
    <DialogPrimitive.Backdrop
      data-slot="dialog-overlay"
      className={cn("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 bg-black/10 duration-100 supports-backdrop-filter:backdrop-blur-xs fixed inset-0 isolate z-50", className)}
      {...props}
    />
  )
}

function DialogContent({
  className,
  children,
  showCloseButton = true,
  ...props
}: DialogPrimitive.Popup.Props & {
  showCloseButton?: boolean
}) {
  return (
    <DialogPortal>
      <DialogOverlay />
      <DialogPrimitive.Popup
        data-slot="dialog-content"
        className={cn(
          "bg-background data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 ring-foreground/10 grid max-w-[calc(100%-2rem)] gap-6 rounded-xl p-6 text-sm ring-1 duration-100 sm:max-w-md fixed top-1/2 left-1/2 z-50 w-full -translate-x-1/2 -translate-y-1/2 outline-none",
          className
        )}
        {...props}
      >
        {children}
        {showCloseButton && (
          <DialogPrimitive.Close
            data-slot="dialog-close"
            render={
              <Button
                variant="ghost"
                className="absolute top-4 right-4"
                size="icon-sm"
              />
            }
          >
            <XIcon
            />
            <span className="sr-only">Close</span>
          </DialogPrimitive.Close>
        )}
      </DialogPrimitive.Popup>
    </DialogPortal>
  )
}

function DialogHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="dialog-header"
      className={cn("gap-2 flex flex-col", className)}
      {...props}
    />
  )
}

function DialogFooter({
  className,
  showCloseButton = false,
  children,
  ...props
}: React.ComponentProps<"div"> & {
  showCloseButton?: boolean
}) {
  return (
    <div
      data-slot="dialog-footer"
      className={cn(
        "flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",
        className
      )}
      {...props}
    >
      {children}
      {showCloseButton && (
        <DialogPrimitive.Close render={<Button variant="outline" />}>
          Close
        </DialogPrimitive.Close>
      )}
    </div>
  )
}

function DialogTitle({ className, ...props }: DialogPrimitive.Title.Props) {
  return (
    <DialogPrimitive.Title
      data-slot="dialog-title"
      className={cn("leading-none font-medium", className)}
      {...props}
    />
  )
}

function DialogDescription({
  className,
  ...props
}: DialogPrimitive.Description.Props) {
  return (
    <DialogPrimitive.Description
      data-slot="dialog-description"
      className={cn("text-muted-foreground *:[a]:hover:text-foreground text-sm *:[a]:underline *:[a]:underline-offset-3", className)}
      {...props}
    />
  )
}

export {
  Dialog,
  DialogClose,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogOverlay,
  DialogPortal,
  DialogTitle,
  DialogTrigger,
}

```

`gui/src/components/ui/dropdown-menu.tsx`:

```tsx
import * as React from "react"
import { Menu as MenuPrimitive } from "@base-ui/react/menu"

import { cn } from "@/lib/utils"
import { ChevronRightIcon, CheckIcon } from "lucide-react"

function DropdownMenu({ ...props }: MenuPrimitive.Root.Props) {
  return <MenuPrimitive.Root data-slot="dropdown-menu" {...props} />
}

function DropdownMenuPortal({ ...props }: MenuPrimitive.Portal.Props) {
  return <MenuPrimitive.Portal data-slot="dropdown-menu-portal" {...props} />
}

function DropdownMenuTrigger({ ...props }: MenuPrimitive.Trigger.Props) {
  return <MenuPrimitive.Trigger data-slot="dropdown-menu-trigger" {...props} />
}

function DropdownMenuContent({
  align = "start",
  alignOffset = 0,
  side = "bottom",
  sideOffset = 4,
  className,
  ...props
}: MenuPrimitive.Popup.Props &
  Pick<
    MenuPrimitive.Positioner.Props,
    "align" | "alignOffset" | "side" | "sideOffset"
  >) {
  return (
    <MenuPrimitive.Portal>
      <MenuPrimitive.Positioner
        className="isolate z-50 outline-none"
        align={align}
        alignOffset={alignOffset}
        side={side}
        sideOffset={sideOffset}
      >
        <MenuPrimitive.Popup
          data-slot="dropdown-menu-content"
          className={cn("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 ring-foreground/10 bg-popover text-popover-foreground min-w-32 rounded-md p-1 shadow-md ring-1 duration-100 data-[side=inline-start]:slide-in-from-right-2 data-[side=inline-end]:slide-in-from-left-2 z-50 max-h-(--available-height) w-(--anchor-width) origin-(--transform-origin) overflow-x-hidden overflow-y-auto outline-none data-closed:overflow-hidden", className )}
          {...props}
        />
      </MenuPrimitive.Positioner>
    </MenuPrimitive.Portal>
  )
}

function DropdownMenuGroup({ ...props }: MenuPrimitive.Group.Props) {
  return <MenuPrimitive.Group data-slot="dropdown-menu-group" {...props} />
}

function DropdownMenuLabel({
  className,
  inset,
  ...props
}: MenuPrimitive.GroupLabel.Props & {
  inset?: boolean
}) {
  return (
    <MenuPrimitive.GroupLabel
      data-slot="dropdown-menu-label"
      data-inset={inset}
      className={cn("text-muted-foreground px-2 py-1.5 text-xs font-medium data-inset:pl-8", className)}
      {...props}
    />
  )
}

function DropdownMenuItem({
  className,
  inset,
  variant = "default",
  ...props
}: MenuPrimitive.Item.Props & {
  inset?: boolean
  variant?: "default" | "destructive"
}) {
  return (
    <MenuPrimitive.Item
      data-slot="dropdown-menu-item"
      data-inset={inset}
      data-variant={variant}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:text-destructive not-data-[variant=destructive]:focus:**:text-accent-foreground gap-2 rounded-sm px-2 py-1.5 text-sm data-inset:pl-8 [&_svg:not([class*='size-'])]:size-4 group/dropdown-menu-item relative flex cursor-default items-center outline-hidden select-none data-disabled:pointer-events-none data-disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0",
        className
      )}
      {...props}
    />
  )
}

function DropdownMenuSub({ ...props }: MenuPrimitive.SubmenuRoot.Props) {
  return <MenuPrimitive.SubmenuRoot data-slot="dropdown-menu-sub" {...props} />
}

function DropdownMenuSubTrigger({
  className,
  inset,
  children,
  ...props
}: MenuPrimitive.SubmenuTrigger.Props & {
  inset?: boolean
}) {
  return (
    <MenuPrimitive.SubmenuTrigger
      data-slot="dropdown-menu-sub-trigger"
      data-inset={inset}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-open:bg-accent data-open:text-accent-foreground not-data-[variant=destructive]:focus:**:text-accent-foreground gap-2 rounded-sm px-2 py-1.5 text-sm data-inset:pl-8 [&_svg:not([class*='size-'])]:size-4 data-popup-open:bg-accent data-popup-open:text-accent-foreground flex cursor-default items-center outline-hidden select-none [&_svg]:pointer-events-none [&_svg]:shrink-0",
        className
      )}
      {...props}
    >
      {children}
      <ChevronRightIcon className="ml-auto" />
    </MenuPrimitive.SubmenuTrigger>
  )
}

function DropdownMenuSubContent({
  align = "start",
  alignOffset = -3,
  side = "right",
  sideOffset = 0,
  className,
  ...props
}: React.ComponentProps<typeof DropdownMenuContent>) {
  return (
    <DropdownMenuContent
      data-slot="dropdown-menu-sub-content"
      className={cn("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 ring-foreground/10 bg-popover text-popover-foreground min-w-[96px] rounded-md p-1 shadow-lg ring-1 duration-100 w-auto", className)}
      align={align}
      alignOffset={alignOffset}
      side={side}
      sideOffset={sideOffset}
      {...props}
    />
  )
}

function DropdownMenuCheckboxItem({
  className,
  children,
  checked,
  inset,
  ...props
}: MenuPrimitive.CheckboxItem.Props & {
  inset?: boolean
}) {
  return (
    <MenuPrimitive.CheckboxItem
      data-slot="dropdown-menu-checkbox-item"
      data-inset={inset}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground focus:**:text-accent-foreground gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm data-inset:pl-8 [&_svg:not([class*='size-'])]:size-4 relative flex cursor-default items-center outline-hidden select-none data-disabled:pointer-events-none data-disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0",
        className
      )}
      checked={checked}
      {...props}
    >
      <span
        className="absolute right-2 flex items-center justify-center pointer-events-none"
        data-slot="dropdown-menu-checkbox-item-indicator"
      >
        <MenuPrimitive.CheckboxItemIndicator>
          <CheckIcon
          />
        </MenuPrimitive.CheckboxItemIndicator>
      </span>
      {children}
    </MenuPrimitive.CheckboxItem>
  )
}

function DropdownMenuRadioGroup({ ...props }: MenuPrimitive.RadioGroup.Props) {
  return (
    <MenuPrimitive.RadioGroup
      data-slot="dropdown-menu-radio-group"
      {...props}
    />
  )
}

function DropdownMenuRadioItem({
  className,
  children,
  inset,
  ...props
}: MenuPrimitive.RadioItem.Props & {
  inset?: boolean
}) {
  return (
    <MenuPrimitive.RadioItem
      data-slot="dropdown-menu-radio-item"
      data-inset={inset}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground focus:**:text-accent-foreground gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm data-inset:pl-8 [&_svg:not([class*='size-'])]:size-4 relative flex cursor-default items-center outline-hidden select-none data-disabled:pointer-events-none data-disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0",
        className
      )}
      {...props}
    >
      <span
        className="absolute right-2 flex items-center justify-center pointer-events-none"
        data-slot="dropdown-menu-radio-item-indicator"
      >
        <MenuPrimitive.RadioItemIndicator>
          <CheckIcon
          />
        </MenuPrimitive.RadioItemIndicator>
      </span>
      {children}
    </MenuPrimitive.RadioItem>
  )
}

function DropdownMenuSeparator({
  className,
  ...props
}: MenuPrimitive.Separator.Props) {
  return (
    <MenuPrimitive.Separator
      data-slot="dropdown-menu-separator"
      className={cn("bg-border -mx-1 my-1 h-px", className)}
      {...props}
    />
  )
}

function DropdownMenuShortcut({
  className,
  ...props
}: React.ComponentProps<"span">) {
  return (
    <span
      data-slot="dropdown-menu-shortcut"
      className={cn("text-muted-foreground group-focus/dropdown-menu-item:text-accent-foreground ml-auto text-xs tracking-widest", className)}
      {...props}
    />
  )
}

export {
  DropdownMenu,
  DropdownMenuPortal,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuGroup,
  DropdownMenuLabel,
  DropdownMenuItem,
  DropdownMenuCheckboxItem,
  DropdownMenuRadioGroup,
  DropdownMenuRadioItem,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuSub,
  DropdownMenuSubTrigger,
  DropdownMenuSubContent,
}

```

`gui/src/components/ui/input-group.tsx`:

```tsx
"use client"

import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"
import { Button } from "@/components/ui/button"
import { Input } from "@/components/ui/input"
import { Textarea } from "@/components/ui/textarea"

function InputGroup({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="input-group"
      role="group"
      className={cn(
        "border-input dark:bg-input/30 has-[[data-slot=input-group-control]:focus-visible]:border-ring has-[[data-slot=input-group-control]:focus-visible]:ring-ring/50 has-[[data-slot][aria-invalid=true]]:ring-destructive/20 has-[[data-slot][aria-invalid=true]]:border-destructive dark:has-[[data-slot][aria-invalid=true]]:ring-destructive/40 h-9 rounded-md border shadow-xs transition-[color,box-shadow] in-data-[slot=combobox-content]:focus-within:border-inherit in-data-[slot=combobox-content]:focus-within:ring-0 has-[[data-slot=input-group-control]:focus-visible]:ring-3 has-[[data-slot][aria-invalid=true]]:ring-3 has-[>[data-align=block-end]]:h-auto has-[>[data-align=block-end]]:flex-col has-[>[data-align=block-start]]:h-auto has-[>[data-align=block-start]]:flex-col has-[>[data-align=block-end]]:[&>input]:pt-3 has-[>[data-align=block-start]]:[&>input]:pb-3 has-[>[data-align=inline-end]]:[&>input]:pr-1.5 has-[>[data-align=inline-start]]:[&>input]:pl-1.5 group/input-group relative flex w-full min-w-0 items-center outline-none has-[>textarea]:h-auto",
        className
      )}
      {...props}
    />
  )
}

const inputGroupAddonVariants = cva(
  "text-muted-foreground h-auto gap-2 py-1.5 text-sm font-medium group-data-[disabled=true]/input-group:opacity-50 [&>kbd]:rounded-[calc(var(--radius)-5px)] [&>svg:not([class*='size-'])]:size-4 flex cursor-text items-center justify-center select-none",
  {
    variants: {
      align: {
        "inline-start": "pl-2 has-[>button]:-ml-1 has-[>kbd]:ml-[-0.15rem] order-first",
        "inline-end": "pr-2 has-[>button]:-mr-1 has-[>kbd]:mr-[-0.15rem] order-last",
        "block-start":
          "px-2.5 pt-2 group-has-[>input]/input-group:pt-2 [.border-b]:pb-2 order-first w-full justify-start",
        "block-end":
          "px-2.5 pb-2 group-has-[>input]/input-group:pb-2 [.border-t]:pt-2 order-last w-full justify-start",
      },
    },
    defaultVariants: {
      align: "inline-start",
    },
  }
)

function InputGroupAddon({
  className,
  align = "inline-start",
  ...props
}: React.ComponentProps<"div"> & VariantProps<typeof inputGroupAddonVariants>) {
  return (
    <div
      role="group"
      data-slot="input-group-addon"
      data-align={align}
      className={cn(inputGroupAddonVariants({ align }), className)}
      onClick={(e) => {
        if ((e.target as HTMLElement).closest("button")) {
          return
        }
        e.currentTarget.parentElement?.querySelector("input")?.focus()
      }}
      {...props}
    />
  )
}

const inputGroupButtonVariants = cva(
  "gap-2 text-sm shadow-none flex items-center",
  {
    variants: {
      size: {
        xs: "h-6 gap-1 rounded-[calc(var(--radius)-5px)] px-1.5 [&>svg:not([class*='size-'])]:size-3.5",
        sm: "",
        "icon-xs": "size-6 rounded-[calc(var(--radius)-5px)] p-0 has-[>svg]:p-0",
        "icon-sm": "size-8 p-0 has-[>svg]:p-0",
      },
    },
    defaultVariants: {
      size: "xs",
    },
  }
)

function InputGroupButton({
  className,
  type = "button",
  variant = "ghost",
  size = "xs",
  ...props
}: Omit<React.ComponentProps<typeof Button>, "size" | "type"> &
  VariantProps<typeof inputGroupButtonVariants> & {
    type?: "button" | "submit" | "reset"
  }) {
  return (
    <Button
      type={type}
      data-size={size}
      variant={variant}
      className={cn(inputGroupButtonVariants({ size }), className)}
      {...props}
    />
  )
}

function InputGroupText({ className, ...props }: React.ComponentProps<"span">) {
  return (
    <span
      className={cn(
        "text-muted-foreground gap-2 text-sm [&_svg:not([class*='size-'])]:size-4 flex items-center [&_svg]:pointer-events-none",
        className
      )}
      {...props}
    />
  )
}

function InputGroupInput({
  className,
  ...props
}: React.ComponentProps<"input">) {
  return (
    <Input
      data-slot="input-group-control"
      className={cn("rounded-none border-0 bg-transparent shadow-none ring-0 focus-visible:ring-0 aria-invalid:ring-0 dark:bg-transparent flex-1", className)}
      {...props}
    />
  )
}

function InputGroupTextarea({
  className,
  ...props
}: React.ComponentProps<"textarea">) {
  return (
    <Textarea
      data-slot="input-group-control"
      className={cn("rounded-none border-0 bg-transparent py-2 shadow-none ring-0 focus-visible:ring-0 aria-invalid:ring-0 dark:bg-transparent flex-1 resize-none", className)}
      {...props}
    />
  )
}

export {
  InputGroup,
  InputGroupAddon,
  InputGroupButton,
  InputGroupText,
  InputGroupInput,
  InputGroupTextarea,
}

```

`gui/src/components/ui/input.tsx`:

```tsx
import * as React from "react"
import { Input as InputPrimitive } from "@base-ui/react/input"

import { cn } from "@/lib/utils"

function Input({ className, type, ...props }: React.ComponentProps<"input">) {
  return (
    <InputPrimitive
      type={type}
      data-slot="input"
      className={cn(
        "dark:bg-input/30 border-input focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:aria-invalid:border-destructive/50 h-9 rounded-md border bg-transparent px-2.5 py-1 text-base shadow-xs transition-[color,box-shadow] file:h-7 file:text-sm file:font-medium focus-visible:ring-3 aria-invalid:ring-3 md:text-sm file:text-foreground placeholder:text-muted-foreground w-full min-w-0 outline-none file:inline-flex file:border-0 file:bg-transparent disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      {...props}
    />
  )
}

export { Input }

```

`gui/src/components/ui/label.tsx`:

```tsx
import * as React from "react"

import { cn } from "@/lib/utils"

function Label({ className, ...props }: React.ComponentProps<"label">) {
  return (
    <label
      data-slot="label"
      className={cn(
        "gap-2 text-sm leading-none font-medium group-data-[disabled=true]:opacity-50 peer-disabled:opacity-50 flex items-center select-none group-data-[disabled=true]:pointer-events-none peer-disabled:cursor-not-allowed",
        className
      )}
      {...props}
    />
  )
}

export { Label }

```

`gui/src/components/ui/popover.tsx`:

```tsx
import * as React from "react"
import { Popover as PopoverPrimitive } from "@base-ui/react/popover"

import { cn } from "@/lib/utils"

function Popover({ ...props }: PopoverPrimitive.Root.Props) {
  return <PopoverPrimitive.Root data-slot="popover" {...props} />
}

function PopoverTrigger({ ...props }: PopoverPrimitive.Trigger.Props) {
  return <PopoverPrimitive.Trigger data-slot="popover-trigger" {...props} />
}

function PopoverContent({
  className,
  align = "center",
  alignOffset = 0,
  side = "bottom",
  sideOffset = 4,
  ...props
}: PopoverPrimitive.Popup.Props &
  Pick<
    PopoverPrimitive.Positioner.Props,
    "align" | "alignOffset" | "side" | "sideOffset"
  >) {
  return (
    <PopoverPrimitive.Portal>
      <PopoverPrimitive.Positioner
        align={align}
        alignOffset={alignOffset}
        side={side}
        sideOffset={sideOffset}
        className="isolate z-50"
      >
        <PopoverPrimitive.Popup
          data-slot="popover-content"
          className={cn(
            "bg-popover text-popover-foreground data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 ring-foreground/10 flex flex-col gap-4 rounded-md p-4 text-sm shadow-md ring-1 duration-100 data-[side=inline-start]:slide-in-from-right-2 data-[side=inline-end]:slide-in-from-left-2 z-50 w-72 origin-(--transform-origin) outline-hidden",
            className
          )}
          {...props}
        />
      </PopoverPrimitive.Positioner>
    </PopoverPrimitive.Portal>
  )
}

function PopoverHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="popover-header"
      className={cn("flex flex-col gap-1 text-sm", className)}
      {...props}
    />
  )
}

function PopoverTitle({ className, ...props }: PopoverPrimitive.Title.Props) {
  return (
    <PopoverPrimitive.Title
      data-slot="popover-title"
      className={cn("font-medium", className)}
      {...props}
    />
  )
}

function PopoverDescription({
  className,
  ...props
}: PopoverPrimitive.Description.Props) {
  return (
    <PopoverPrimitive.Description
      data-slot="popover-description"
      className={cn("text-muted-foreground", className)}
      {...props}
    />
  )
}

export {
  Popover,
  PopoverContent,
  PopoverDescription,
  PopoverHeader,
  PopoverTitle,
  PopoverTrigger,
}

```

`gui/src/components/ui/progress.tsx`:

```tsx
import { Progress as ProgressPrimitive } from "@base-ui/react/progress"

import { cn } from "@/lib/utils"

function Progress({
  className,
  children,
  value,
  ...props
}: ProgressPrimitive.Root.Props) {
  return (
    <ProgressPrimitive.Root
      value={value}
      data-slot="progress"
      className={cn("flex flex-wrap gap-3", className)}
      {...props}
    >
      {children}
      <ProgressTrack>
        <ProgressIndicator />
      </ProgressTrack>
    </ProgressPrimitive.Root>
  )
}

function ProgressTrack({ className, ...props }: ProgressPrimitive.Track.Props) {
  return (
    <ProgressPrimitive.Track
      className={cn(
        "bg-muted h-1.5 rounded-full relative flex w-full items-center overflow-x-hidden",
        className
      )}
      data-slot="progress-track"
      {...props}
    />
  )
}

function ProgressIndicator({
  className,
  ...props
}: ProgressPrimitive.Indicator.Props) {
  return (
    <ProgressPrimitive.Indicator
      data-slot="progress-indicator"
      className={cn("bg-primary h-full transition-all", className)}
      {...props}
    />
  )
}

function ProgressLabel({ className, ...props }: ProgressPrimitive.Label.Props) {
  return (
    <ProgressPrimitive.Label
      className={cn("text-sm font-medium", className)}
      data-slot="progress-label"
      {...props}
    />
  )
}

function ProgressValue({ className, ...props }: ProgressPrimitive.Value.Props) {
  return (
    <ProgressPrimitive.Value
      className={cn("text-muted-foreground ml-auto text-sm tabular-nums", className)}
      data-slot="progress-value"
      {...props}
    />
  )
}

export {
  Progress,
  ProgressTrack,
  ProgressIndicator,
  ProgressLabel,
  ProgressValue,
}

```

`gui/src/components/ui/radio-group.tsx`:

```tsx
import { Radio as RadioPrimitive } from "@base-ui/react/radio"
import { RadioGroup as RadioGroupPrimitive } from "@base-ui/react/radio-group"

import { cn } from "@/lib/utils"
import { CircleIcon } from "lucide-react"

function RadioGroup({ className, ...props }: RadioGroupPrimitive.Props) {
  return (
    <RadioGroupPrimitive
      data-slot="radio-group"
      className={cn("grid gap-3 w-full", className)}
      {...props}
    />
  )
}

function RadioGroupItem({ className, ...props }: RadioPrimitive.Root.Props) {
  return (
    <RadioPrimitive.Root
      data-slot="radio-group-item"
      className={cn(
        "border-input text-primary dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:aria-invalid:border-destructive/50 flex size-4 rounded-full shadow-xs focus-visible:ring-3 aria-invalid:ring-3 group/radio-group-item peer relative aspect-square shrink-0 border outline-none after:absolute after:-inset-x-3 after:-inset-y-2 disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      {...props}
    >
      <RadioPrimitive.Indicator
        data-slot="radio-group-indicator"
        className="group-aria-invalid/radio-group-item:text-destructive text-primary flex size-4 items-center justify-center"
      >
        <CircleIcon className="absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2 fill-current" />
      </RadioPrimitive.Indicator>
    </RadioPrimitive.Root>
  )
}

export { RadioGroup, RadioGroupItem }

```

`gui/src/components/ui/resizable.tsx`:

```tsx
"use client";

import * as ResizablePrimitive from "react-resizable-panels";

import { cn } from "@/lib/utils";

function ResizablePanelGroup({
  className,
  autoSaveId,
  ...props
}: ResizablePrimitive.GroupProps & { autoSaveId?: string }) {
  const saved = ResizablePrimitive.useDefaultLayout({
    groupId: autoSaveId ?? "",
    storage: localStorage,
  });

  return (
    <ResizablePrimitive.Group
      data-slot="resizable-panel-group"
      className={cn(
        "flex h-full w-full aria-[orientation=vertical]:flex-col",
        className,
      )}
      {...(autoSaveId ? saved : {})}
      {...props}
    />
  );
}

function ResizablePanel({ ...props }: ResizablePrimitive.PanelProps) {
  return <ResizablePrimitive.Panel data-slot="resizable-panel" {...props} />;
}

function ResizableHandle({
  withHandle,
  className,
  ...props
}: ResizablePrimitive.SeparatorProps & {
  withHandle?: boolean;
}) {
  return (
    <ResizablePrimitive.Separator
      data-slot="resizable-handle"
      className={cn(
        "bg-border focus-visible:ring-ring ring-offset-background relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:outline-hidden aria-[orientation=horizontal]:h-px aria-[orientation=horizontal]:w-full aria-[orientation=horizontal]:after:left-0 aria-[orientation=horizontal]:after:h-1 aria-[orientation=horizontal]:after:w-full aria-[orientation=horizontal]:after:translate-x-0 aria-[orientation=horizontal]:after:-translate-y-1/2 [&[aria-orientation=horizontal]>div]:rotate-90",
        className,
      )}
      {...props}
    >
      {withHandle && (
        <div className="bg-border h-6 w-1 rounded-lg z-10 flex shrink-0" />
      )}
    </ResizablePrimitive.Separator>
  );
}

export { ResizableHandle, ResizablePanel, ResizablePanelGroup };

```

`gui/src/components/ui/scroll-area.tsx`:

```tsx
import { ScrollArea as ScrollAreaPrimitive } from "@base-ui/react/scroll-area"

import { cn } from "@/lib/utils"

function ScrollArea({
  className,
  children,
  ...props
}: ScrollAreaPrimitive.Root.Props) {
  return (
    <ScrollAreaPrimitive.Root
      data-slot="scroll-area"
      className={cn("relative", className)}
      {...props}
    >
      <ScrollAreaPrimitive.Viewport
        data-slot="scroll-area-viewport"
        className="focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1"
      >
        {children}
      </ScrollAreaPrimitive.Viewport>
      <ScrollBar />
      <ScrollAreaPrimitive.Corner />
    </ScrollAreaPrimitive.Root>
  )
}

function ScrollBar({
  className,
  orientation = "vertical",
  ...props
}: ScrollAreaPrimitive.Scrollbar.Props) {
  return (
    <ScrollAreaPrimitive.Scrollbar
      data-slot="scroll-area-scrollbar"
      data-orientation={orientation}
      orientation={orientation}
      className={cn(
        "data-horizontal:h-2.5 data-horizontal:flex-col data-horizontal:border-t data-horizontal:border-t-transparent data-vertical:h-full data-vertical:w-2.5 data-vertical:border-l data-vertical:border-l-transparent flex touch-none p-px transition-colors select-none",
        className
      )}
      {...props}
    >
      <ScrollAreaPrimitive.Thumb
        data-slot="scroll-area-thumb"
        className="rounded-full bg-border relative flex-1"
      />
    </ScrollAreaPrimitive.Scrollbar>
  )
}

export { ScrollArea, ScrollBar }

```

`gui/src/components/ui/select.tsx`:

```tsx
import * as React from "react"
import { Select as SelectPrimitive } from "@base-ui/react/select"

import { cn } from "@/lib/utils"
import { ChevronDownIcon, CheckIcon, ChevronUpIcon } from "lucide-react"

const Select = SelectPrimitive.Root

function SelectGroup({ className, ...props }: SelectPrimitive.Group.Props) {
  return (
    <SelectPrimitive.Group
      data-slot="select-group"
      className={cn("scroll-my-1 p-1", className)}
      {...props}
    />
  )
}

function SelectValue({ className, ...props }: SelectPrimitive.Value.Props) {
  return (
    <SelectPrimitive.Value
      data-slot="select-value"
      className={cn("flex flex-1 text-left", className)}
      {...props}
    />
  )
}

function SelectTrigger({
  className,
  size = "default",
  children,
  ...props
}: SelectPrimitive.Trigger.Props & {
  size?: "sm" | "default"
}) {
  return (
    <SelectPrimitive.Trigger
      data-slot="select-trigger"
      data-size={size}
      className={cn(
        "border-input data-placeholder:text-muted-foreground dark:bg-input/30 dark:hover:bg-input/50 focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:aria-invalid:border-destructive/50 gap-1.5 rounded-md border bg-transparent py-2 pr-2 pl-2.5 text-sm shadow-xs transition-[color,box-shadow] focus-visible:ring-3 aria-invalid:ring-3 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:gap-1.5 [&_svg:not([class*='size-'])]:size-4 flex w-fit items-center justify-between whitespace-nowrap outline-none disabled:cursor-not-allowed disabled:opacity-50 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center [&_svg]:pointer-events-none [&_svg]:shrink-0",
        className
      )}
      {...props}
    >
      {children}
      <SelectPrimitive.Icon
        render={
          <ChevronDownIcon className="text-muted-foreground size-4 pointer-events-none" />
        }
      />
    </SelectPrimitive.Trigger>
  )
}

function SelectContent({
  className,
  children,
  side = "bottom",
  sideOffset = 4,
  align = "center",
  alignOffset = 0,
  alignItemWithTrigger = true,
  ...props
}: SelectPrimitive.Popup.Props &
  Pick<
    SelectPrimitive.Positioner.Props,
    "align" | "alignOffset" | "side" | "sideOffset" | "alignItemWithTrigger"
  >) {
  return (
    <SelectPrimitive.Portal>
      <SelectPrimitive.Positioner
        side={side}
        sideOffset={sideOffset}
        align={align}
        alignOffset={alignOffset}
        alignItemWithTrigger={alignItemWithTrigger}
        className="isolate z-50"
      >
        <SelectPrimitive.Popup
          data-slot="select-content"
          data-align-trigger={alignItemWithTrigger}
          className={cn("bg-popover text-popover-foreground data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 ring-foreground/10 min-w-36 rounded-md shadow-md ring-1 duration-100 data-[side=inline-start]:slide-in-from-right-2 data-[side=inline-end]:slide-in-from-left-2 relative isolate z-50 max-h-(--available-height) w-(--anchor-width) origin-(--transform-origin) overflow-x-hidden overflow-y-auto data-[align-trigger=true]:animate-none", className )}
          {...props}
        >
          <SelectScrollUpButton />
          <SelectPrimitive.List>{children}</SelectPrimitive.List>
          <SelectScrollDownButton />
        </SelectPrimitive.Popup>
      </SelectPrimitive.Positioner>
    </SelectPrimitive.Portal>
  )
}

function SelectLabel({
  className,
  ...props
}: SelectPrimitive.GroupLabel.Props) {
  return (
    <SelectPrimitive.GroupLabel
      data-slot="select-label"
      className={cn("text-muted-foreground px-2 py-1.5 text-xs", className)}
      {...props}
    />
  )
}

function SelectItem({
  className,
  children,
  ...props
}: SelectPrimitive.Item.Props) {
  return (
    <SelectPrimitive.Item
      data-slot="select-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground not-data-[variant=destructive]:focus:**:text-accent-foreground gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2 relative flex w-full cursor-default items-center outline-hidden select-none data-disabled:pointer-events-none data-disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0",
        className
      )}
      {...props}
    >
      <SelectPrimitive.ItemText className="flex flex-1 gap-2 shrink-0 whitespace-nowrap">
        {children}
      </SelectPrimitive.ItemText>
      <SelectPrimitive.ItemIndicator
        render={<span className="pointer-events-none absolute right-2 flex size-4 items-center justify-center" />}
      >
        <CheckIcon className="pointer-events-none" />
      </SelectPrimitive.ItemIndicator>
    </SelectPrimitive.Item>
  )
}

function SelectSeparator({
  className,
  ...props
}: SelectPrimitive.Separator.Props) {
  return (
    <SelectPrimitive.Separator
      data-slot="select-separator"
      className={cn("bg-border -mx-1 my-1 h-px pointer-events-none", className)}
      {...props}
    />
  )
}

function SelectScrollUpButton({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.ScrollUpArrow>) {
  return (
    <SelectPrimitive.ScrollUpArrow
      data-slot="select-scroll-up-button"
      className={cn("bg-popover z-10 flex cursor-default items-center justify-center py-1 [&_svg:not([class*='size-'])]:size-4 top-0 w-full", className)}
      {...props}
    >
      <ChevronUpIcon
      />
    </SelectPrimitive.ScrollUpArrow>
  )
}

function SelectScrollDownButton({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.ScrollDownArrow>) {
  return (
    <SelectPrimitive.ScrollDownArrow
      data-slot="select-scroll-down-button"
      className={cn("bg-popover z-10 flex cursor-default items-center justify-center py-1 [&_svg:not([class*='size-'])]:size-4 bottom-0 w-full", className)}
      {...props}
    >
      <ChevronDownIcon
      />
    </SelectPrimitive.ScrollDownArrow>
  )
}

export {
  Select,
  SelectContent,
  SelectGroup,
  SelectItem,
  SelectLabel,
  SelectScrollDownButton,
  SelectScrollUpButton,
  SelectSeparator,
  SelectTrigger,
  SelectValue,
}

```

`gui/src/components/ui/separator.tsx`:

```tsx
import { Separator as SeparatorPrimitive } from "@base-ui/react/separator"

import { cn } from "@/lib/utils"

function Separator({
  className,
  orientation = "horizontal",
  ...props
}: SeparatorPrimitive.Props) {
  return (
    <SeparatorPrimitive
      data-slot="separator"
      orientation={orientation}
      className={cn(
        "bg-border shrink-0 data-horizontal:h-px data-horizontal:w-full data-vertical:w-px data-vertical:self-stretch",
        className
      )}
      {...props}
    />
  )
}

export { Separator }

```

`gui/src/components/ui/skeleton.tsx`:

```tsx
import { cn } from "@/lib/utils"

function Skeleton({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="skeleton"
      className={cn("bg-muted rounded-md animate-pulse", className)}
      {...props}
    />
  )
}

export { Skeleton }

```

`gui/src/components/ui/slider.tsx`:

```tsx
import * as React from "react"
import { Slider as SliderPrimitive } from "@base-ui/react/slider"

import { cn } from "@/lib/utils"

function Slider({
  className,
  defaultValue,
  value,
  min = 0,
  max = 100,
  ...props
}: SliderPrimitive.Root.Props) {
  const _values = React.useMemo(
    () =>
      Array.isArray(value)
        ? value
        : Array.isArray(defaultValue)
          ? defaultValue
          : [min, max],
    [value, defaultValue, min, max]
  )

  return (
    <SliderPrimitive.Root
      className={cn("data-horizontal:w-full data-vertical:h-full", className)}
      data-slot="slider"
      defaultValue={defaultValue}
      value={value}
      min={min}
      max={max}
      thumbAlignment="edge"
      {...props}
    >
      <SliderPrimitive.Control className="data-vertical:min-h-40 relative flex w-full touch-none items-center select-none data-disabled:opacity-50 data-vertical:h-full data-vertical:w-auto data-vertical:flex-col">
        <SliderPrimitive.Track
          data-slot="slider-track"
          className="bg-muted rounded-full data-horizontal:h-1.5 data-horizontal:w-full data-vertical:h-full data-vertical:w-1.5 relative grow overflow-hidden select-none"
        >
          <SliderPrimitive.Indicator
            data-slot="slider-range"
            className="bg-primary select-none data-horizontal:h-full data-vertical:w-full"
          />
        </SliderPrimitive.Track>
        {Array.from({ length: _values.length }, (_, index) => (
          <SliderPrimitive.Thumb
            data-slot="slider-thumb"
            key={index}
            className="border-primary ring-ring/50 size-4 rounded-full border bg-white shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden block shrink-0 select-none disabled:pointer-events-none disabled:opacity-50"
          />
        ))}
      </SliderPrimitive.Control>
    </SliderPrimitive.Root>
  )
}

export { Slider }

```

`gui/src/components/ui/spinner.tsx`:

```tsx
import { cn } from "@/lib/utils"
import { Loader2Icon } from "lucide-react"

function Spinner({ className, ...props }: React.ComponentProps<"svg">) {
  return (
    <Loader2Icon role="status" aria-label="Loading" className={cn("size-4 animate-spin", className)} {...props} />
  )
}

export { Spinner }

```

`gui/src/components/ui/switch.tsx`:

```tsx
import { Switch as SwitchPrimitive } from "@base-ui/react/switch"

import { cn } from "@/lib/utils"

function Switch({
  className,
  size = "default",
  ...props
}: SwitchPrimitive.Root.Props & {
  size?: "sm" | "default"
}) {
  return (
    <SwitchPrimitive.Root
      data-slot="switch"
      data-size={size}
      className={cn(
        "data-checked:bg-primary data-unchecked:bg-input focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:aria-invalid:border-destructive/50 dark:data-unchecked:bg-input/80 shrink-0 rounded-full border border-transparent shadow-xs focus-visible:ring-3 aria-invalid:ring-3 data-[size=default]:h-[18.4px] data-[size=default]:w-[32px] data-[size=sm]:h-[14px] data-[size=sm]:w-[24px] peer group/switch relative inline-flex items-center transition-all outline-none after:absolute after:-inset-x-3 after:-inset-y-2 data-disabled:cursor-not-allowed data-disabled:opacity-50",
        className
      )}
      {...props}
    >
      <SwitchPrimitive.Thumb
        data-slot="switch-thumb"
        className="bg-background dark:data-unchecked:bg-foreground dark:data-checked:bg-primary-foreground rounded-full group-data-[size=default]/switch:size-4 group-data-[size=sm]/switch:size-3 group-data-[size=default]/switch:data-checked:translate-x-[calc(100%-2px)] group-data-[size=sm]/switch:data-checked:translate-x-[calc(100%-2px)] group-data-[size=default]/switch:data-unchecked:translate-x-0 group-data-[size=sm]/switch:data-unchecked:translate-x-0 pointer-events-none block ring-0 transition-transform"
      />
    </SwitchPrimitive.Root>
  )
}

export { Switch }

```

`gui/src/components/ui/table.tsx`:

```tsx
import * as React from "react"

import { cn } from "@/lib/utils"

function Table({ className, ...props }: React.ComponentProps<"table">) {
  return (
    <div data-slot="table-container" className="relative w-full overflow-x-auto">
      <table
        data-slot="table"
        className={cn("w-full caption-bottom text-sm", className)}
        {...props}
      />
    </div>
  )
}

function TableHeader({ className, ...props }: React.ComponentProps<"thead">) {
  return (
    <thead
      data-slot="table-header"
      className={cn("[&_tr]:border-b", className)}
      {...props}
    />
  )
}

function TableBody({ className, ...props }: React.ComponentProps<"tbody">) {
  return (
    <tbody
      data-slot="table-body"
      className={cn("[&_tr:last-child]:border-0", className)}
      {...props}
    />
  )
}

function TableFooter({ className, ...props }: React.ComponentProps<"tfoot">) {
  return (
    <tfoot
      data-slot="table-footer"
      className={cn("bg-muted/50 border-t font-medium [&>tr]:last:border-b-0", className)}
      {...props}
    />
  )
}

function TableRow({ className, ...props }: React.ComponentProps<"tr">) {
  return (
    <tr
      data-slot="table-row"
      className={cn("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors", className)}
      {...props}
    />
  )
}

function TableHead({ className, ...props }: React.ComponentProps<"th">) {
  return (
    <th
      data-slot="table-head"
      className={cn("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0", className)}
      {...props}
    />
  )
}

function TableCell({ className, ...props }: React.ComponentProps<"td">) {
  return (
    <td
      data-slot="table-cell"
      className={cn("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0", className)}
      {...props}
    />
  )
}

function TableCaption({
  className,
  ...props
}: React.ComponentProps<"caption">) {
  return (
    <caption
      data-slot="table-caption"
      className={cn("text-muted-foreground mt-4 text-sm", className)}
      {...props}
    />
  )
}

export {
  Table,
  TableHeader,
  TableBody,
  TableFooter,
  TableHead,
  TableRow,
  TableCell,
  TableCaption,
}

```

`gui/src/components/ui/tabs.tsx`:

```tsx
import { Tabs as TabsPrimitive } from "@base-ui/react/tabs"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

function Tabs({
  className,
  orientation = "horizontal",
  ...props
}: TabsPrimitive.Root.Props) {
  return (
    <TabsPrimitive.Root
      data-slot="tabs"
      orientation={orientation}
      data-horizontal={orientation === "horizontal" ? "" : undefined}
      data-vertical={orientation === "vertical" ? "" : undefined}
      className={cn(
        "gap-2 group/tabs flex data-horizontal:flex-col",
        className
      )}
      {...props}
    />
  )
}

const tabsListVariants = cva(
  "rounded-lg p-[3px] group-data-horizontal/tabs:h-9 data-[variant=line]:rounded-none group/tabs-list text-muted-foreground inline-flex w-fit items-center justify-center group-data-vertical/tabs:h-fit group-data-vertical/tabs:flex-col",
  {
    variants: {
      variant: {
        default: "bg-muted",
        line: "gap-1 bg-transparent",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

function TabsList({
  className,
  variant = "default",
  ...props
}: TabsPrimitive.List.Props & VariantProps<typeof tabsListVariants>) {
  return (
    <TabsPrimitive.List
      data-slot="tabs-list"
      data-variant={variant}
      className={cn(tabsListVariants({ variant }), className)}
      {...props}
    />
  )
}

function TabsTrigger({ className, ...props }: TabsPrimitive.Tab.Props) {
  return (
    <TabsPrimitive.Tab
      data-slot="tabs-trigger"
      className={cn(
        "gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium group-data-[variant=default]/tabs-list:data-active:shadow-sm group-data-[variant=line]/tabs-list:data-active:shadow-none [&_svg:not([class*='size-'])]:size-4 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring text-foreground/60 hover:text-foreground dark:text-muted-foreground dark:hover:text-foreground relative inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center whitespace-nowrap transition-all group-data-vertical/tabs:w-full group-data-vertical/tabs:justify-start focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0",
        "group-data-[variant=line]/tabs-list:bg-transparent group-data-[variant=line]/tabs-list:data-active:bg-transparent dark:group-data-[variant=line]/tabs-list:data-active:border-transparent dark:group-data-[variant=line]/tabs-list:data-active:bg-transparent",
        "data-active:bg-background dark:data-active:text-foreground dark:data-active:border-input dark:data-active:bg-input/30 data-active:text-foreground",
        "after:bg-foreground after:absolute after:opacity-0 after:transition-opacity group-data-horizontal/tabs:after:inset-x-0 group-data-horizontal/tabs:after:bottom-[-5px] group-data-horizontal/tabs:after:h-0.5 group-data-vertical/tabs:after:inset-y-0 group-data-vertical/tabs:after:-right-1 group-data-vertical/tabs:after:w-0.5 group-data-[variant=line]/tabs-list:data-active:after:opacity-100",
        className
      )}
      {...props}
    />
  )
}

function TabsContent({ className, ...props }: TabsPrimitive.Panel.Props) {
  return (
    <TabsPrimitive.Panel
      data-slot="tabs-content"
      className={cn("text-sm flex-1 outline-none", className)}
      {...props}
    />
  )
}

export { Tabs, TabsList, TabsTrigger, TabsContent, tabsListVariants }

```

`gui/src/components/ui/textarea.tsx`:

```tsx
import * as React from "react"

import { cn } from "@/lib/utils"

function Textarea({ className, ...props }: React.ComponentProps<"textarea">) {
  return (
    <textarea
      data-slot="textarea"
      className={cn(
        "border-input dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:aria-invalid:border-destructive/50 rounded-md border bg-transparent px-2.5 py-2 text-base shadow-xs transition-[color,box-shadow] focus-visible:ring-3 aria-invalid:ring-3 md:text-sm placeholder:text-muted-foreground flex field-sizing-content min-h-16 w-full outline-none disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      {...props}
    />
  )
}

export { Textarea }

```

`gui/src/components/ui/toggle-group.tsx`:

```tsx
"use client"

import * as React from "react"
import { Toggle as TogglePrimitive } from "@base-ui/react/toggle"
import { ToggleGroup as ToggleGroupPrimitive } from "@base-ui/react/toggle-group"
import { type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"
import { toggleVariants } from "@/components/ui/toggle"

const ToggleGroupContext = React.createContext<
  VariantProps<typeof toggleVariants> & {
    spacing?: number
    orientation?: "horizontal" | "vertical"
  }
>({
  size: "default",
  variant: "default",
  spacing: 0,
  orientation: "horizontal",
})

function ToggleGroup({
  className,
  variant,
  size,
  spacing = 0,
  orientation = "horizontal",
  children,
  ...props
}: ToggleGroupPrimitive.Props &
  VariantProps<typeof toggleVariants> & {
    spacing?: number
    orientation?: "horizontal" | "vertical"
  }) {
  return (
    <ToggleGroupPrimitive
      data-slot="toggle-group"
      data-variant={variant}
      data-size={size}
      data-spacing={spacing}
      data-orientation={orientation}
      style={{ "--gap": spacing } as React.CSSProperties}
      className={cn(
        "rounded-md data-[spacing=0]:data-[variant=outline]:shadow-xs group/toggle-group flex w-fit flex-row items-center gap-[--spacing(var(--gap))] data-vertical:flex-col data-vertical:items-stretch",
        className
      )}
      {...props}
    >
      <ToggleGroupContext.Provider
        value={{ variant, size, spacing, orientation }}
      >
        {children}
      </ToggleGroupContext.Provider>
    </ToggleGroupPrimitive>
  )
}

function ToggleGroupItem({
  className,
  children,
  variant = "default",
  size = "default",
  ...props
}: TogglePrimitive.Props & VariantProps<typeof toggleVariants>) {
  const context = React.useContext(ToggleGroupContext)

  return (
    <TogglePrimitive
      data-slot="toggle-group-item"
      data-variant={context.variant || variant}
      data-size={context.size || size}
      data-spacing={context.spacing}
      className={cn(
        "data-[state=on]:bg-muted group-data-[spacing=0]/toggle-group:rounded-none group-data-[spacing=0]/toggle-group:px-2 group-data-[spacing=0]/toggle-group:shadow-none group-data-horizontal/toggle-group:data-[spacing=0]:first:rounded-l-md group-data-vertical/toggle-group:data-[spacing=0]:first:rounded-t-md group-data-horizontal/toggle-group:data-[spacing=0]:last:rounded-r-md group-data-vertical/toggle-group:data-[spacing=0]:last:rounded-b-md shrink-0 focus:z-10 focus-visible:z-10 group-data-horizontal/toggle-group:data-[spacing=0]:data-[variant=outline]:border-l-0 group-data-vertical/toggle-group:data-[spacing=0]:data-[variant=outline]:border-t-0 group-data-horizontal/toggle-group:data-[spacing=0]:data-[variant=outline]:first:border-l group-data-vertical/toggle-group:data-[spacing=0]:data-[variant=outline]:first:border-t",
        toggleVariants({
          variant: context.variant || variant,
          size: context.size || size,
        }),
        className
      )}
      {...props}
    >
      {children}
    </TogglePrimitive>
  )
}

export { ToggleGroup, ToggleGroupItem }

```

`gui/src/components/ui/toggle.tsx`:

```tsx
import { Toggle as TogglePrimitive } from "@base-ui/react/toggle"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const toggleVariants = cva(
  "hover:text-foreground aria-pressed:bg-muted focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive gap-1 rounded-md text-sm font-medium transition-[color,box-shadow] [&_svg:not([class*='size-'])]:size-4 group/toggle hover:bg-muted inline-flex items-center justify-center whitespace-nowrap outline-none focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0",
  {
    variants: {
      variant: {
        default: "bg-transparent",
        outline: "border-input hover:bg-muted border bg-transparent shadow-xs",
      },
      size: {
        default: "h-9 min-w-9 px-2",
        sm: "h-8 min-w-8 px-1.5",
        lg: "h-10 min-w-10 px-2.5",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

function Toggle({
  className,
  variant = "default",
  size = "default",
  ...props
}: TogglePrimitive.Props & VariantProps<typeof toggleVariants>) {
  return (
    <TogglePrimitive
      data-slot="toggle"
      className={cn(toggleVariants({ variant, size, className }))}
      {...props}
    />
  )
}

export { Toggle, toggleVariants }

```

`gui/src/components/ui/tooltip.tsx`:

```tsx
import { Tooltip as TooltipPrimitive } from "@base-ui/react/tooltip"

import { cn } from "@/lib/utils"

function TooltipProvider({
  delay = 0,
  ...props
}: TooltipPrimitive.Provider.Props) {
  return (
    <TooltipPrimitive.Provider
      data-slot="tooltip-provider"
      delay={delay}
      {...props}
    />
  )
}

function Tooltip({ ...props }: TooltipPrimitive.Root.Props) {
  return <TooltipPrimitive.Root data-slot="tooltip" {...props} />
}

function TooltipTrigger({ ...props }: TooltipPrimitive.Trigger.Props) {
  return <TooltipPrimitive.Trigger data-slot="tooltip-trigger" {...props} />
}

function TooltipContent({
  className,
  side = "top",
  sideOffset = 4,
  align = "center",
  alignOffset = 0,
  children,
  ...props
}: TooltipPrimitive.Popup.Props &
  Pick<
    TooltipPrimitive.Positioner.Props,
    "align" | "alignOffset" | "side" | "sideOffset"
  >) {
  return (
    <TooltipPrimitive.Portal>
      <TooltipPrimitive.Positioner
        align={align}
        alignOffset={alignOffset}
        side={side}
        sideOffset={sideOffset}
        className="isolate z-50"
      >
        <TooltipPrimitive.Popup
          data-slot="tooltip-content"
          className={cn(
            "data-open:animate-in data-open:fade-in-0 data-open:zoom-in-95 data-[state=delayed-open]:animate-in data-[state=delayed-open]:fade-in-0 data-[state=delayed-open]:zoom-in-95 data-closed:animate-out data-closed:fade-out-0 data-closed:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 rounded-md px-3 py-1.5 text-xs data-[side=inline-start]:slide-in-from-right-2 data-[side=inline-end]:slide-in-from-left-2 bg-foreground text-background z-50 w-fit max-w-xs origin-(--transform-origin)",
            className
          )}
          {...props}
        >
          {children}
          <TooltipPrimitive.Arrow className="size-2.5 translate-y-[calc(-50%-2px)] rotate-45 rounded-[2px] data-[side=inline-end]:top-1/2! data-[side=inline-end]:-left-1 data-[side=inline-end]:-translate-y-1/2 data-[side=inline-start]:top-1/2! data-[side=inline-start]:-right-1 data-[side=inline-start]:-translate-y-1/2 bg-foreground fill-foreground z-50 data-[side=bottom]:top-1 data-[side=left]:top-1/2! data-[side=left]:-right-1 data-[side=left]:-translate-y-1/2 data-[side=right]:top-1/2! data-[side=right]:-left-1 data-[side=right]:-translate-y-1/2 data-[side=top]:-bottom-2.5" />
        </TooltipPrimitive.Popup>
      </TooltipPrimitive.Positioner>
    </TooltipPrimitive.Portal>
  )
}

export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }

```

`gui/src/components/views/ClassesListView.tsx`:

```tsx
const escapeRegExp = (value: string) =>
  value.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");

import { useCallback, useState } from "react";
import { useTranslation } from "react-i18next";
import { Search } from "lucide-react";
import { Input } from "@/components/ui/input";
import { Spinner } from "@/components/ui/spinner";
import { useDock } from "@/context/DockContext";
import { useFruityQuery } from "@/lib/queries";

interface ClassesListViewProps {
  path: string;
}

export function ClassesListView({ path }: ClassesListViewProps) {
  const { openFilePanel } = useDock();
  const { t } = useTranslation();
  const [searchValue, setSearchValue] = useState("");

  const { data: classes, isLoading: loading } = useFruityQuery(
    ["moduleClasses", path],
    (api) => api.classdump.classesForModule(path)
  );

  const searchTerm = searchValue.trim();
  const searchLower = searchTerm.toLowerCase();

  const filtered = classes?.filter((c) =>
    c.toLowerCase().includes(searchLower),
  );

  const highlightMatch = useCallback(
    (className: string) => {
      if (!searchTerm) {
        return className;
      }

      const regex = new RegExp(`(${escapeRegExp(searchTerm)})`, "ig");
      const parts = className.split(regex);

      return parts.map((part, index) => {
        if (part.toLowerCase() === searchLower && part.length > 0) {
          return (
            <span
              key={`${className}-${index}`}
              className="rounded bg-yellow-200 px-0.5 text-yellow-900 dark:bg-yellow-400/70 dark:text-yellow-900"
            >
              {part}
            </span>
          );
        }

        return <span key={`${className}-${index}-plain`}>{part}</span>;
      });
    },
    [searchLower, searchTerm],
  );

  const openClassTab = useCallback(
    (className: string) => {
      openFilePanel({
        id: `class_${className}`,
        component: "classDetail",
        title: className,
        params: { className },
      });
    },
    [openFilePanel],
  );

  if (loading) {
    return (
      <div className="flex items-center justify-center h-full gap-2 text-muted-foreground">
        <Spinner />
        {t("loading")}...
      </div>
    );
  }

  if (!classes || classes.length === 0) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        {t("no_results")}
      </div>
    );
  }

  return (
    <div className="flex flex-col h-full">
      <div className="relative mb-3">
        <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
        <Input
          placeholder={t("search")}
          value={searchValue}
          onChange={(e) => setSearchValue(e.target.value)}
          className="pl-9 h-8 text-sm"
        />
      </div>
      <div className="text-xs text-muted-foreground mb-2">
        {filtered?.length.toLocaleString() ?? 0} / {classes?.length.toLocaleString() ?? 0} {t("items")}
      </div>
      <div className="flex-1 overflow-auto">
        {filtered && filtered.length > 0 ? (
          <div className="flex flex-wrap gap-3">
            {filtered.map((className) => (
              <button
                key={className}
                type="button"
                className="cursor-pointer rounded-md border border-border/50 bg-muted/30 px-3 py-1.5 text-xs font-mono text-foreground/90 transition-colors hover:bg-accent hover:text-accent-foreground hover:border-accent"
                onClick={() => openClassTab(className)}
              >
                {highlightMatch(className)}
              </button>
            ))}
          </div>
        ) : (
          <div className="flex h-full items-center justify-center text-sm text-muted-foreground">
            {t("no_results")}
          </div>
        )}
      </div>
    </div>
  );
}

```

`gui/src/components/views/ExportedListView.tsx`:

```tsx
import { SymbolsTableView } from "../shared/SymbolsTableView";
import { usePlatformQuery } from "@/lib/queries";


interface ExportedListViewProps {
  path: string;
}

export function ExportedListView({ path }: ExportedListViewProps) {
  const { data: exported, isLoading: loading } = usePlatformQuery(
    ["exports", path],
    (api) => api.symbol.exports(path)
  );

  return <SymbolsTableView symbols={exported ?? null} loading={loading} />;
}

```

`gui/src/components/views/ImportsListView.tsx`:

```tsx
import { useMemo, useState, useRef, useCallback } from "react";
import { useTranslation } from "react-i18next";
import { useNavigate } from "react-router";
import { toast } from "sonner";
import {
  ChevronRight,
  ChevronDown,
  ExternalLink,
  Search,
  Anchor,
  Code,
} from "lucide-react";
import { useDock } from "@/context/DockContext";
import { Spinner } from "@/components/ui/spinner";
import { usePlatformQuery } from "@/lib/queries";
import { useSession, Status, Mode, Platform } from "@/context/SessionContext";
import { useRepl } from "@/context/useRepl";
import { Input } from "@/components/ui/input";
import { Button } from "@/components/ui/button";
import { native, type NativeHookTarget } from "@/lib/hook-template";
import { NativeHookDialog } from "@/components/shared/NativeHookDialog";

import type { ImportGroup, Imported } from "@agent/common/symbol";

interface ImportsListViewProps {
  path: string;
}

const DEFAULT_WIDTHS = {
  icon: 90,
  name: 300,
  address: 140,
  demangled: 400,
};

export function ImportsListView({ path }: ImportsListViewProps) {
  const { openFilePanel } = useDock();
  const { t } = useTranslation();
  const { fruity, droid, status, platform, mode, device, bundle, pid, fridaMajor } = useSession();
  const api = platform === Platform.Droid ? droid : fruity;
  const { appendCode } = useRepl();
  const navigate = useNavigate();

  const hooksPath = `/workspace/${platform}/${device}/${mode}/${mode === Mode.App ? bundle : pid}/hooks`;
  const [expandedModules, setExpandedModules] = useState<Set<string>>(
    new Set(),
  );
  const [search, setSearch] = useState("");
  const [columnWidths, setColumnWidths] = useState(DEFAULT_WIDTHS);
  const [hookDialogOpen, setHookDialogOpen] = useState(false);
  const [hookDialogTarget, setHookDialogTarget] = useState<{
    module: string;
    name: string;
  } | null>(null);

  const resizing = useRef<{
    column: keyof typeof DEFAULT_WIDTHS;
    startX: number;
    startWidth: number;
  } | null>(null);

  const { data: importGroups, isLoading: loading } = usePlatformQuery(
    ["importsGrouped", path],
    (rpc) => rpc.symbol.importsGrouped(path),
  );

  const filteredGroups = useMemo(() => {
    if (!importGroups) return [];
    if (!search.trim()) return importGroups;

    const query = search.toLowerCase();
    return importGroups
      .map((group) => {
        const moduleMatches = group.module.toLowerCase().includes(query);
        const matchingImports = group.imports.filter(
          (imp) =>
            imp.name.toLowerCase().includes(query) ||
            imp.addr.toLowerCase().includes(query) ||
            (imp.demangled && imp.demangled.toLowerCase().includes(query)),
        );

        if (moduleMatches || matchingImports.length > 0) {
          return {
            ...group,
            imports: moduleMatches ? group.imports : matchingImports,
          };
        }
        return null;
      })
      .filter((group): group is ImportGroup => group !== null);
  }, [importGroups, search]);

  const toggleModule = (module: string) => {
    setExpandedModules((prev) => {
      const next = new Set(prev);
      if (next.has(module)) {
        next.delete(module);
      } else {
        next.add(module);
      }
      return next;
    });
  };

  const expandAll = () => {
    if (!filteredGroups) return;
    setExpandedModules(new Set(filteredGroups.map((g) => g.module)));
  };

  const collapseAll = () => {
    setExpandedModules(new Set());
  };

  const openModuleTab = (modulePath: string, e: React.MouseEvent) => {
    e.stopPropagation();
    const name = modulePath.split("/").pop() || modulePath;
    openFilePanel({
      id: `module_${modulePath}`,
      component: "moduleImports",
      title: name,
      params: { path: modulePath },
    });
  };

  const openDisassemblyTab = (address: string, name?: string) => {
    openFilePanel({
      id: `disasm_${address}`,
      component: "disassembly",
      title: name ? `${name}` : address,
      params: { address, name },
    });
  };

  const openClassTab = (className: string) => {
    openFilePanel({
      id: `class_${className}`,
      component: "classDetail",
      title: className,
      params: { className },
    });
  };

  const handleAddressClick = (imp: Imported) => {
    // Check if it's an ObjC class reference
    if (imp.name.startsWith("OBJC_CLASS_$_")) {
      const className = imp.name.replace("OBJC_CLASS_$_", "");
      openClassTab(className);
      return;
    }
    // Only open disassembly for functions
    if (imp.type === "f" && imp.addr) {
      openDisassemblyTab(imp.addr, imp.name);
    }
  };

  const isClickable = (imp: Imported): boolean => {
    // ObjC class references are always clickable
    if (imp.name.startsWith("OBJC_CLASS_$_")) return true;
    // Only functions with addresses are clickable for disassembly
    return imp.type === "f" && !!imp.addr;
  };

  const isFunction = (imp: Imported): boolean => {
    return imp.type === "f";
  };

  const handleHookFunction = (module: string, imp: Imported) => {
    if (!api || status !== Status.Ready) return;
    setHookDialogTarget({ module, name: imp.name });
    setHookDialogOpen(true);
  };

  const handleHookConfirm = async (sig: {
    args: string[];
    returns: string;
  }) => {
    if (!api || !hookDialogTarget) return;
    try {
      await api.native.hook(
        hookDialogTarget.module,
        hookDialogTarget.name,
        sig,
      );
      navigate(hooksPath);
      toast.success(t("hook_added"), {
        description: `${hookDialogTarget.module}!${hookDialogTarget.name}`,
      });
      window.dispatchEvent(new CustomEvent("hooks:refresh"));
    } catch (error) {
      console.error("Failed to hook function:", error);
      toast.error(t("hook_failed"));
    }
  };

  const handleGenerateCode = (module: string, imp: Imported) => {
    const target: NativeHookTarget = {
      type: "native",
      module,
      name: imp.name,
    };
    const code = native(target, fridaMajor);
    appendCode(code);
  };

  const handleMouseDown = useCallback(
    (column: keyof typeof DEFAULT_WIDTHS, e: React.MouseEvent) => {
      e.preventDefault();
      resizing.current = {
        column,
        startX: e.clientX,
        startWidth: columnWidths[column],
      };

      const handleMouseMove = (e: MouseEvent) => {
        if (!resizing.current) return;
        const delta = e.clientX - resizing.current.startX;
        const newWidth = Math.max(40, resizing.current.startWidth + delta);
        setColumnWidths((prev) => ({
          ...prev,
          [resizing.current!.column]: newWidth,
        }));
      };

      const handleMouseUp = () => {
        resizing.current = null;
        document.removeEventListener("mousemove", handleMouseMove);
        document.removeEventListener("mouseup", handleMouseUp);
      };

      document.addEventListener("mousemove", handleMouseMove);
      document.addEventListener("mouseup", handleMouseUp);
    },
    [columnWidths],
  );

  if (loading) {
    return (
      <div className="flex items-center justify-center h-full gap-2 text-muted-foreground">
        <Spinner />
        {t("loading")}...
      </div>
    );
  }

  if (!importGroups || importGroups.length === 0) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        {t("no_results")}
      </div>
    );
  }

  // Build flat row list for rendering
  const rows: Array<
    | { type: "group"; group: ImportGroup; isExpanded: boolean }
    | { type: "import"; import: Imported; module: string }
  > = [];

  for (const group of filteredGroups) {
    const isExpanded = expandedModules.has(group.module);
    rows.push({ type: "group", group, isExpanded });
    if (isExpanded) {
      for (const imp of group.imports) {
        rows.push({ type: "import", import: imp, module: group.module });
      }
    }
  }

  const ResizeHandle = ({
    column,
  }: {
    column: keyof typeof DEFAULT_WIDTHS;
  }) => (
    <div
      className="absolute right-0 top-0 h-full w-1 cursor-col-resize hover:bg-amber-500/50 active:bg-amber-500"
      onMouseDown={(e) => handleMouseDown(column, e)}
    />
  );

  return (
    <div className="flex flex-col h-full">
      <NativeHookDialog
        open={hookDialogOpen}
        onOpenChange={setHookDialogOpen}
        functionName={hookDialogTarget?.name ?? ""}
        modulePath={hookDialogTarget?.module ?? null}
        onConfirm={handleHookConfirm}
      />
      <div className="flex items-center gap-2 mb-3">
        <div className="relative flex-1">
          <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
          <Input
            placeholder={t("search")}
            value={search}
            onChange={(e) => setSearch(e.target.value)}
            className="pl-9"
          />
        </div>
        <button
          type="button"
          className="flex items-center gap-2 px-3 py-1.5 text-xs font-medium bg-muted border border-border rounded-md hover:bg-accent cursor-pointer transition"
          onClick={expandAll}
        >
          <span>⤢</span>
          {t("expand_all")}
        </button>
        <button
          type="button"
          className="flex items-center gap-2 px-3 py-1.5 text-xs font-medium bg-muted border border-border rounded-md hover:bg-accent cursor-pointer transition"
          onClick={collapseAll}
        >
          <span>⤡</span>
          {t("collapse_all")}
        </button>
      </div>

      <div className="overflow-auto flex-1">
        <table className="w-full text-sm border-collapse">
          <thead className="sticky top-0 bg-background z-10">
            <tr className="border-b">
              <th
                className="relative text-left font-medium p-2"
                style={{ width: columnWidths.icon }}
              />
              <th
                className="relative text-left font-medium p-2"
                style={{ width: columnWidths.name }}
              >
                {t("name")}
                <ResizeHandle column="name" />
              </th>
              <th
                className="relative text-left font-medium p-2"
                style={{ width: columnWidths.address }}
              >
                {t("address")}
                <ResizeHandle column="address" />
              </th>
              <th
                className="relative text-left font-medium p-2"
                style={{ width: columnWidths.demangled }}
              >
                {t("demangled")}
                <ResizeHandle column="demangled" />
              </th>
            </tr>
          </thead>
          <tbody>
            {rows.map((row, idx) => {
              if (row.type === "group") {
                const { group, isExpanded } = row;
                return (
                  <tr
                    key={`group-${group.module}`}
                    className="cursor-pointer bg-muted/30 hover:bg-muted/50 border-b"
                    onClick={() => toggleModule(group.module)}
                  >
                    <td className="p-2" style={{ width: columnWidths.icon }}>
                      <div className="flex items-center gap-1">
                        {isExpanded ? (
                          <ChevronDown className="w-4 h-4 shrink-0" />
                        ) : (
                          <ChevronRight className="w-4 h-4 shrink-0" />
                        )}
                      </div>
                    </td>
                    <td colSpan={3} className="p-2 font-medium">
                      <div className="flex items-center gap-2">
                        <span className="truncate">{group.module}</span>
                        <span className="px-1.5 py-0.5 text-[10px] rounded bg-amber-100 text-amber-700 dark:bg-amber-900/50 dark:text-amber-300">
                          {group.imports.length}
                        </span>
                        <button
                          type="button"
                          className="p-1 rounded hover:bg-accent text-muted-foreground hover:text-amber-600 dark:hover:text-amber-400"
                          onClick={(e) => openModuleTab(group.module, e)}
                          aria-label="Open module"
                        >
                          <ExternalLink className="w-3.5 h-3.5" />
                        </button>
                      </div>
                    </td>
                  </tr>
                );
              } else {
                const { import: imp, module } = row;
                return (
                  <tr
                    key={`import-${idx}`}
                    className="border-b hover:bg-muted/50 group"
                  >
                    <td className="p-2" style={{ width: columnWidths.icon }}>
                      <div className="flex items-center gap-0.5">
                        {isFunction(imp) ? (
                          <>
                            <Button
                              variant="ghost"
                              size="icon"
                              className="h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity"
                              onClick={() => handleHookFunction(module, imp)}
                              disabled={status !== Status.Ready}
                              title={t("hook_add")}
                            >
                              <Anchor className="h-3.5 w-3.5" />
                            </Button>
                            <Button
                              variant="ghost"
                              size="icon"
                              className="h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity"
                              onClick={() => handleGenerateCode(module, imp)}
                              title={t("hook_generate_code")}
                            >
                              <Code className="h-3.5 w-3.5" />
                            </Button>
                          </>
                        ) : null}
                      </div>
                    </td>
                    <td
                      className="p-2 font-mono text-xs truncate"
                      style={{
                        width: columnWidths.name,
                        maxWidth: columnWidths.name,
                      }}
                    >
                      {imp.name}
                    </td>
                    <td
                      className="p-2 font-mono text-xs"
                      style={{ width: columnWidths.address }}
                    >
                      {imp.addr ? (
                        isClickable(imp) ? (
                          <button
                            type="button"
                            className="text-amber-600 dark:text-amber-400 hover:underline cursor-pointer"
                            onClick={() => handleAddressClick(imp)}
                          >
                            {imp.addr}
                          </button>
                        ) : (
                          <span className="text-muted-foreground">
                            {imp.addr}
                          </span>
                        )
                      ) : (
                        "-"
                      )}
                    </td>
                    <td
                      className="p-2 font-mono text-xs truncate"
                      style={{
                        width: columnWidths.demangled,
                        maxWidth: columnWidths.demangled,
                      }}
                    >
                      {imp.demangled || "-"}
                    </td>
                  </tr>
                );
              }
            })}
          </tbody>
        </table>
      </div>
    </div>
  );
}

```

`gui/src/components/views/SectionsListView.tsx`:

```tsx
import { useTranslation } from "react-i18next";
import { useDock } from "@/context/DockContext";
import { Spinner } from "@/components/ui/spinner";
import { usePlatformQuery } from "@/lib/queries";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";

interface SectionsListViewProps {
  path: string;
}

export function SectionsListView({
  path,
}: SectionsListViewProps) {
  const { openFilePanel } = useDock();
  const { t } = useTranslation();

  const { data: sections, isLoading: loading } = usePlatformQuery(
    ["sections", path],
    (api) => api.symbol.sections(path)
  );

  const openMemoryPreviewTab = (address: string, size: number) => {
    openFilePanel({
      id: `memory_${address}_${size}`,
      component: "memory",
      title: `Memory ${address}`,
      params: { address, size },
    });
  };

  if (loading) {
    return (
      <div className="flex items-center justify-center h-full gap-2 text-muted-foreground">
        <Spinner />
        {t("loading")}...
      </div>
    );
  }

  if (!sections || sections.length === 0) {
    return (
      <div className="flex items-center justify-center h-full text-muted-foreground">
        {t("no_results")}
      </div>
    );
  }

  return (
    <div className="overflow-auto h-full">
      <Table>
        <TableHeader>
          <TableRow>
            <TableHead>{t("name")}</TableHead>
            <TableHead>{t("address")}</TableHead>
            <TableHead className="text-right">{t("size")}</TableHead>
          </TableRow>
        </TableHeader>
        <TableBody>
          {sections.map((section) => (
            <TableRow key={section.addr}>
              <TableCell className="font-mono">{section.name}</TableCell>
              <TableCell className="font-mono">
                <button
                  type="button"
                  className="text-amber-600 dark:text-amber-400 hover:underline cursor-pointer text-left"
                  onClick={() =>
                    openMemoryPreviewTab(section.addr, section.size)
                  }
                >
                  {section.addr}
                </button>
              </TableCell>
              <TableCell className="font-mono text-right">
                {"0x" + section.size.toString(16)}
              </TableCell>
            </TableRow>
          ))}
        </TableBody>
      </Table>
    </div>
  );
}

```

`gui/src/components/views/SymbolsListView.tsx`:

```tsx
import { SymbolsTableView } from "../shared/SymbolsTableView";
import { usePlatformQuery } from "@/lib/queries";


interface SymbolsListViewProps {
  path: string;
}

export function SymbolsListView({ path }: SymbolsListViewProps) {
  const { data: symbols, isLoading: loading } = usePlatformQuery(
    ["symbols", path],
    (api) => api.symbol.symbols(path)
  );

  return <SymbolsTableView symbols={symbols ?? null} loading={loading} />;
}

```

`gui/src/context/DockContext.ts`:

```ts
import React, { useCallback, useContext } from "react";
import type { DockviewApi, AddPanelOptions } from "dockview";

export interface DockContextType {
  api: DockviewApi | null;
  /**
   * Open or focus a singleton panel (only one instance allowed).
   * If the panel already exists, it will be focused instead of creating a new one.
   */
  openSingletonPanel: (options: AddPanelOptions) => void;
  /**
   * Open or focus a file viewer panel.
   * Panels are identified by their id (e.g. constructed from file path).
   * If a panel with the same id exists, it will be focused.
   */
  openFilePanel: (options: AddPanelOptions) => void;
}

const defaultContext: DockContextType = {
  api: null,
  openSingletonPanel: () => {},
  openFilePanel: () => {},
};

export const DockContext = React.createContext<DockContextType>(defaultContext);

export const useDock = () => useContext(DockContext);

export function useDockActions(api: DockviewApi | null) {
  const openSingletonPanel = useCallback(
    (options: AddPanelOptions) => {
      if (!api) return;

      const existingPanel = api.getPanel(options.id);
      if (existingPanel) {
        // Update params if provided
        if (options.params) {
          existingPanel.api.updateParameters(options.params);
        }
        existingPanel.api.setActive();
        return;
      }

      api.addPanel(options);
    },
    [api],
  );

  const openFilePanel = useCallback(
    (options: AddPanelOptions) => {
      if (!api) return;

      const existingPanel = api.getPanel(options.id);
      if (existingPanel) {
        existingPanel.api.setActive();
        return;
      }

      api.addPanel(options);
    },
    [api],
  );

  return { openSingletonPanel, openFilePanel };
}

```

`gui/src/context/ReplContext.tsx`:

```tsx
import React, { useState, useCallback } from "react";
import { ReplContext } from "./useRepl";

const STORAGE_KEY = "igf:repl:content";

export function ReplProvider({ children }: { children: React.ReactNode }) {
  const [content, setContentState] = useState(
    () => localStorage.getItem(STORAGE_KEY) ?? "",
  );
  const [dirty, setDirty] = useState(false);

  const setContent = useCallback((value: string) => {
    setContentState(value);
    setDirty(true);
  }, []);

  const save = useCallback(() => {
    setContentState((cur) => {
      localStorage.setItem(STORAGE_KEY, cur);
      return cur;
    });
    setDirty(false);
  }, []);

  const appendCode = useCallback((code: string) => {
    setContentState((prev) => {
      const separator = prev.length > 0 && !prev.endsWith("\n") ? "\n\n" : "";
      const next = prev + separator + code;
      return next;
    });
    setDirty(true);
    window.dispatchEvent(new CustomEvent("repl:content-added"));
  }, []);

  return (
    <ReplContext.Provider value={{ content, setContent, appendCode, save, dirty }}>
      {children}
    </ReplContext.Provider>
  );
}

```

`gui/src/context/SessionContext.ts`:

```ts
import React from "react";
import {
  type AsyncFruityRPC,
  type AsyncDroidRPC,
  type SessionClientEvents,
  type SessionServerEvents,
} from "@/lib/rpc";
import type { Socket } from "socket.io-client";

export const Status = {
  Connecting: "connecting",
  Ready: "ready",
  Disconnected: "disconnected",
} as const;

export type StatusType = (typeof Status)[keyof typeof Status];

export const Platform = {
  Fruity: "fruity",
  Droid: "droid",
} as const;

export type PlatformType = (typeof Platform)[keyof typeof Platform];

export const Mode = {
  App: "app",
  Daemon: "daemon",
} as const;

export type ModeType = (typeof Mode)[keyof typeof Mode];

export type LoggerCallback = (level: string, message: string) => void;
export type SysLoggerCallback = (message: string) => void;

interface SessionContextType {
  platform: PlatformType | undefined;
  mode: ModeType | undefined;
  device: string | undefined;
  bundle: string | undefined;
  pid: number | undefined;
  /** Project identifier for data API calls (bundle ID for app, name-hash for daemon) */
  identifier: string | undefined;
  /** Typed iOS RPC API. Throws if connected to Android. */
  fruity: AsyncFruityRPC | null;
  /** Typed Android RPC API. Throws if connected to iOS. */
  droid: AsyncDroidRPC | null;
  status: StatusType;
  socket: Socket<SessionClientEvents, SessionServerEvents> | null;
  /** Frida major version (16 or 17). Defaults to 17. */
  fridaMajor: number;
}

const defaultContext: SessionContextType = {
  platform: undefined,
  mode: undefined,
  device: undefined,
  bundle: undefined,
  pid: undefined,
  identifier: undefined,
  fruity: null,
  droid: null,
  status: Status.Disconnected,
  socket: null,
  fridaMajor: 17,
};

export const SessionContext = React.createContext(defaultContext);
export const useSession = () => React.useContext(SessionContext);

```

`gui/src/context/useRepl.ts`:

```ts
import { createContext, useContext } from "react";

export interface ReplContextType {
  content: string;
  setContent: (content: string) => void;
  appendCode: (code: string) => void;
  save: () => void;
  dirty: boolean;
}

const defaultContext: ReplContextType = {
  content: "",
  setContent: () => {},
  appendCode: () => {},
  save: () => {},
  dirty: false,
};

export const ReplContext = createContext<ReplContextType>(defaultContext);

export const useRepl = () => useContext(ReplContext);

```

`gui/src/hooks/useLogStream.ts`:

```ts
import { useCallback, useEffect, useMemo, useRef, useState } from "react";
import { useQuery, useMutation } from "@tanstack/react-query";
import { useSession, Status } from "@/context/SessionContext";

/** Minimal event-emitter surface for dynamic socket event binding. */
interface SocketEmitter {
  on(event: string, fn: (...args: unknown[]) => void): void;
  off(event: string, fn: (...args: unknown[]) => void): void;
}

interface UseLogStreamConfig<TEntry> {
  event: string;
  path: string;
  key: string;
  limit?: number;
  fromRecord: (record: Record<string, unknown>, id: number) => TEntry;
  fromEvent: (id: number, ...args: unknown[]) => TEntry | null;
  max?: number;
  throttle?: number;
  enabled?: boolean;
}

export function useLogStream<TEntry extends { id: number }>(
  config: UseLogStreamConfig<TEntry>,
) {
  const {
    event,
    path,
    key,
    limit = 5000,
    fromRecord,
    fromEvent,
    max = 8000,
    throttle = 100,
    enabled = true,
  } = config;

  const { socket, status, device, identifier } = useSession();

  const baseUrl = `/api/${path}/${device}/${identifier}`;

  const [entries, setEntries] = useState<TEntry[]>([]);
  const [selectedId, setSelectedId] = useState<number | null>(null);

  const idRef = useRef(1);
  const pendingRef = useRef<TEntry[]>([]);
  const timerRef = useRef<ReturnType<typeof setTimeout> | null>(null);

  // Load history
  const { data: history } = useQuery<Record<string, unknown[]>>({
    queryKey: [event + "History", device, identifier],
    queryFn: async () => {
      const res = await fetch(`${baseUrl}?limit=${limit}`);
      if (!res.ok) throw new Error(`Failed to load ${event} history`);
      return res.json();
    },
    enabled: enabled && status === Status.Ready && !!device && !!identifier,
    staleTime: Infinity,
    gcTime: 0,
  });

  // Reset on session change
  useEffect(() => {
    setEntries([]);
    setSelectedId(null);
    idRef.current = 1;
    pendingRef.current = [];
  }, [device, identifier]);

  // Load historical entries
  useEffect(() => {
    const records = history?.[key];
    if (!records?.length) return;

    const next: TEntry[] = [];
    for (const record of [...records].reverse()) {
      next.push(fromRecord(record as Record<string, unknown>, idRef.current++));
    }
    setEntries(next);
  }, [history, key, fromRecord]);

  // Flush pending entries
  const flushPending = useCallback(() => {
    timerRef.current = null;
    if (pendingRef.current.length === 0) return;

    const incoming = pendingRef.current;
    pendingRef.current = [];

    setEntries((prev) => {
      const merged = [...prev, ...incoming];
      return merged.length > max ? merged.slice(-max) : merged;
    });
  }, [max]);

  // Listen for live events
  useEffect(() => {
    if (status !== Status.Ready || !socket || !enabled) return;

    const handler = (...args: unknown[]) => {
      const entry = fromEvent(idRef.current++, ...args);
      if (entry) {
        pendingRef.current.push(entry);
        if (!timerRef.current) {
          timerRef.current = setTimeout(flushPending, throttle);
        }
      }
    };

    // Socket.IO typed events don't support dynamic event names;
    // cast to plain emitter for generic binding.
    const emitter = socket as unknown as SocketEmitter;
    emitter.on(event, handler);
    return () => {
      emitter.off(event, handler);
      if (timerRef.current) {
        clearTimeout(timerRef.current);
        timerRef.current = null;
      }
    };
  }, [status, socket, event, fromEvent, flushPending, throttle, enabled]);

  // Clear mutation
  const clearMutation = useMutation({
    mutationFn: async () => {
      if (!device || !identifier) return;
      const res = await fetch(baseUrl, { method: "DELETE" });
      if (!res.ok) throw new Error(`Failed to clear ${event}`);
    },
    onSuccess: () => {
      setEntries([]);
      setSelectedId(null);
      idRef.current = 1;
      pendingRef.current = [];
    },
  });

  const clear = useCallback(() => {
    clearMutation.mutate();
  }, [clearMutation]);

  const selectedEntry = useMemo(
    () => entries.find((e) => e.id === selectedId) ?? null,
    [entries, selectedId],
  );

  return {
    entries,
    selectedId,
    setSelectedId,
    selectedEntry,
    clear,
    clearMutation,
  };
}

```

`gui/src/i18n.ts`:

```ts
import i18n from "i18next";
import { initReactI18next } from "react-i18next";
import en from "./locales/en/translation.json";
import cn from "./locales/cn/translation.json";

const resources = {
  en: { translation: en },
  cn: { translation: cn },
};

const lng =
  localStorage.getItem("language") ||
  (navigator.language.match(/^zh-?/i) ? "cn" : "en");

i18n.use(initReactI18next).init({
  resources,
  lng,
  fallbackLng: "en",
  interpolation: {
    escapeValue: false,
  },
});

i18n.on("languageChanged", (lng) => {
  localStorage.setItem("language", lng);
});

export default i18n;

```

`gui/src/index.css`:

```css
@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

@theme inline {
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);
}

:root {
  --radius: 0.65rem;
  --background: oklch(1 0 0);
  --foreground: oklch(0.141 0.005 285.823);
  --card: oklch(1 0 0);
  --card-foreground: oklch(0.141 0.005 285.823);
  --popover: oklch(1 0 0);
  --popover-foreground: oklch(0.141 0.005 285.823);
  --primary: oklch(0.852 0.199 91.936);
  --primary-foreground: oklch(0.421 0.095 57.708);
  --secondary: oklch(0.967 0.001 286.375);
  --secondary-foreground: oklch(0.21 0.006 285.885);
  --muted: oklch(0.967 0.001 286.375);
  --muted-foreground: oklch(0.552 0.016 285.938);
  --accent: oklch(0.967 0.001 286.375);
  --accent-foreground: oklch(0.21 0.006 285.885);
  --destructive: oklch(0.577 0.245 27.325);
  --border: oklch(0.92 0.004 286.32);
  --input: oklch(0.92 0.004 286.32);
  --ring: oklch(0.852 0.199 91.936);
  --chart-1: oklch(0.905 0.182 98.111);
  --chart-2: oklch(0.795 0.184 86.047);
  --chart-3: oklch(0.681 0.162 75.834);
  --chart-4: oklch(0.554 0.135 66.442);
  --chart-5: oklch(0.476 0.114 61.907);
  --sidebar: oklch(0.985 0 0);
  --sidebar-foreground: oklch(0.141 0.005 285.823);
  --sidebar-primary: oklch(0.681 0.162 75.834);
  --sidebar-primary-foreground: oklch(0.987 0.026 102.212);
  --sidebar-accent: oklch(0.967 0.001 286.375);
  --sidebar-accent-foreground: oklch(0.21 0.006 285.885);
  --sidebar-border: oklch(0.92 0.004 286.32);
  --sidebar-ring: oklch(0.852 0.199 91.936);
}

.dark {
  --background: oklch(0.141 0.005 285.823);
  --foreground: oklch(0.985 0 0);
  --card: oklch(0.21 0.006 285.885);
  --card-foreground: oklch(0.985 0 0);
  --popover: oklch(0.21 0.006 285.885);
  --popover-foreground: oklch(0.985 0 0);
  --primary: oklch(0.795 0.184 86.047);
  --primary-foreground: oklch(0.421 0.095 57.708);
  --secondary: oklch(0.274 0.006 286.033);
  --secondary-foreground: oklch(0.985 0 0);
  --muted: oklch(0.274 0.006 286.033);
  --muted-foreground: oklch(0.705 0.015 286.067);
  --accent: oklch(0.274 0.006 286.033);
  --accent-foreground: oklch(0.985 0 0);
  --destructive: oklch(0.704 0.191 22.216);
  --border: oklch(1 0 0 / 10%);
  --input: oklch(1 0 0 / 15%);
  --ring: oklch(0.421 0.095 57.708);
  --chart-1: oklch(0.905 0.182 98.111);
  --chart-2: oklch(0.795 0.184 86.047);
  --chart-3: oklch(0.681 0.162 75.834);
  --chart-4: oklch(0.554 0.135 66.442);
  --chart-5: oklch(0.476 0.114 61.907);
  --sidebar: oklch(0.21 0.006 285.885);
  --sidebar-foreground: oklch(0.985 0 0);
  --sidebar-primary: oklch(0.795 0.184 86.047);
  --sidebar-primary-foreground: oklch(0.987 0.026 102.212);
  --sidebar-accent: oklch(0.274 0.006 286.033);
  --sidebar-accent-foreground: oklch(0.985 0 0);
  --sidebar-border: oklch(1 0 0 / 10%);
  --sidebar-ring: oklch(0.421 0.095 57.708);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
}

```

`gui/src/lib/classdump-header.ts`:

```ts
// const PROPERTY_ATTRS = "TRC&WNOD" as const;
type Property = Record<string, string>;

export interface Ivar {
  name: string;
  offset: number;
  type: string;
}

export interface Method {
  name: string;
  impl: string;
  types: string;
}

export interface ClassDumpInfo {
  name: string;
  protocols: string[];
  methods: Method[];
  ownMethods: string[]; // lookup in methods
  proto: string[]; // superclass chain
  ivars: Ivar[];
  module: string;
  properties: Record<string, Property>;
}

// Type definitions for the parser result
interface MethodSignature {
  args: string[];
  ret: string;
}

export class ObjCTypeParser {
  private encoding: string;
  private index: number;

  private static readonly BASIC_TYPES: Record<string, string> = {
    c: "char",
    i: "int",
    s: "short",
    l: "long",
    q: "long long",
    C: "unsigned char",
    I: "unsigned int",
    S: "unsigned short",
    L: "unsigned long",
    Q: "unsigned long long",
    f: "float",
    d: "double",
    B: "BOOL",
    v: "void",
    "*": "char *",
    "#": "Class",
    ":": "SEL",
    "?": "unknown",
  };

  constructor(encoding: string) {
    this.encoding = encoding;
    this.index = 0;
  }

  /**
   * Main entry point to parse a full method signature (e.g., "v24@0:8@16")
   */
  public static parse(signature: string): MethodSignature {
    const parser = new ObjCTypeParser(signature);
    return parser.parseMethod();
  }

  /**
   * Parses a single type encoding string (e.g. "^i")
   */
  public static parseType(typeEncoding: string): string {
    const parser = new ObjCTypeParser(typeEncoding);
    return parser.parseNextType();
  }

  private peek(): string {
    return this.encoding[this.index] || "";
  }

  private advance(count: number = 1): void {
    this.index += count;
  }

  private consumeNumbers(): void {
    while (/[0-9]/.test(this.peek())) {
      this.advance();
    }
  }

  private parseMethod(): MethodSignature {
    // 1. Parse Return Type
    const ret = this.parseNextType();
    this.consumeNumbers(); // Stack size

    const args: string[] = [];

    // 2. Parse Arguments
    while (this.index < this.encoding.length) {
      const argType = this.parseNextType();
      args.push(argType);
      this.consumeNumbers(); // Argument offset
    }

    return { ret, args };
  }

  private parseNextType(): string {
    const char = this.peek();
    this.advance();

    // 1. Handle Modifiers (recursive prefix)
    // r = const, n = in, N = inout, o = out, O = bycopy, R = byref, V = oneway
    if (["r", "n", "N", "o", "O", "R", "V"].includes(char)) {
      const modifierMap: Record<string, string> = { r: "const", R: "byref" }; // Simplified
      const mod = modifierMap[char] ? modifierMap[char] + " " : "";
      return mod + this.parseNextType();
    }

    // 2. Handle Basic Types
    if (ObjCTypeParser.BASIC_TYPES[char]) {
      return ObjCTypeParser.BASIC_TYPES[char];
    }

    switch (char) {
      case "^": {
        // Pointer
        // Special case: ^v is void*, ^@ is NSError** (usually)
        const inner = this.parseNextType();
        if (inner === "void") return "void *";
        return `${inner} *`;
      }

      case "@": // Object
        return this.parseObjectType();

      case "[": // Array
        return this.parseArrayType();

      case "{": // Struct
        return this.parseStructureType("{", "}");

      case "(": // Union
        return this.parseStructureType("(", ")");

      case "b": // Bitfield
        this.consumeNumbers(); // skip width
        return "int"; // Simplified for headers

      default:
        return "id"; // Fallback
    }
  }

  private parseObjectType(): string {
    // @ -> id
    // @"ClassName" -> ClassName *
    // @? -> block

    if (this.peek() === '"') {
      this.advance(); // skip "
      let className = "";
      while (this.peek() !== '"' && this.index < this.encoding.length) {
        // Handle protocols <Proto> in name
        className += this.peek();
        this.advance();
      }
      this.advance(); // skip closing "

      // Clean up protocol syntax for header if needed, strictly it's Class<Proto> *
      return `${className} *`;
    }

    if (this.peek() === "?") {
      this.advance();
      // Handle block signature if present: @?<v@?>
      if (this.peek() === "<") {
        this.skipBalanced("<", ">");
        // For simplicity in this port, returning generic block.
        // A full block parser would recurse here similar to parseMethod.
        return "void (^)(void)";
      }
      return "id /* block */";
    }

    return "id";
  }

  private parseArrayType(): string {
    // [12^f] -> float*[12]
    // Extract size
    let sizeStr = "";
    while (/[0-9]/.test(this.peek())) {
      sizeStr += this.peek();
      this.advance();
    }

    const innerType = this.parseNextType();

    // Skip closing ]
    if (this.peek() === "]") this.advance();

    return `${innerType}[${sizeStr}]`;
  }

  private parseStructureType(open: string, close: string): string {
    // {name=T...}
    // {_struct=sqQ}

    if (this.peek() !== open) return "unknown"; // Fallback

    let name = "";
    // Read name until = or close
    while (
      this.peek() !== "=" &&
      this.peek() !== close &&
      this.index < this.encoding.length
    ) {
      name += this.peek();
      this.advance();
    }

    if (this.peek() === "=") {
      this.advance(); // Skip =
      // We need to skip the internal types to advance the cursor,
      // but we don't necessarily display them in a C-style header "struct Name *"
      // unless we are defining the struct.
      while (this.peek() !== close && this.index < this.encoding.length) {
        this.parseNextType();
      }
    }

    if (this.peek() === close) this.advance();

    if (name === "?") return "struct /* anonymous */";
    return `struct ${name}`;
  }

  private skipBalanced(open: string, close: string) {
    let depth = 1;
    this.advance();
    while (depth > 0 && this.index < this.encoding.length) {
      const c = this.peek();
      if (c === open) depth++;
      else if (c === close) depth--;
      this.advance();
    }
  }
}

export function header(info: ClassDumpInfo): string {
  const lines: string[] = [];

  // 1. Interface Declaration
  const superC =
    info.properties["superclass"] && info.proto.length
      ? "NSObject"
      : info.proto[0] || "NSObject"; // Inference
  let decl = `@interface ${info.name} : ${superC}`;
  if (info.protocols && info.protocols.length > 0) {
    decl += ` <${info.protocols.join(", ")}>`;
  }
  lines.push(decl);
  lines.push("");

  // 2. Properties
  const sortedProps = Object.keys(info.properties).sort();
  for (const propName of sortedProps) {
    const attrs = info.properties[propName];
    const attrStrings: string[] = [];
    const attrLookup: Record<string, string> = {
      R: "readonly",
      C: "copy",
      "&": "strong",
      W: "weak",
      N: "nonatomic",
    };

    for (const key in attrLookup) {
      if (attrs[key]) attrStrings.push(attrLookup[key]);
    }

    if (attrs["D"]) continue; // @dynamic, usually skip generating property or mark it

    // Parse Type
    const typeStr = ObjCTypeParser.parseType(attrs.T);

    // Formatting hack: if type is "Object *", property name goes after *.
    // If type is "id", property name goes after space.

    const attrBlock =
      attrStrings.length > 0 ? `(${attrStrings.join(", ")}) ` : "";
    lines.push(`@property ${attrBlock}${typeStr} ${propName};`);
  }

  lines.push("");

  // 3. Methods
  const sortedMethods = info.methods.sort((a, b) =>
    a.name.localeCompare(b.name),
  );

  for (const meth of sortedMethods) {
    const sel = meth.name;
    const signature = meth.types;

    const cleanSel = sel.replace(/^[-+] /, "");
    const methodSymbol = sel.startsWith("+") ? "+" : "-";

    const parsed = ObjCTypeParser.parse(signature);

    // parsed.args includes [self, _cmd, arg1, arg2...]
    // We skip index 0 (self) and 1 (_cmd)
    const realArgs = parsed.args.slice(2);

    // Split selector by ':' to map arguments
    const selParts = cleanSel.split(":").filter((s) => s.length > 0);

    // Reconstruct Method definition
    let methodLine = `${methodSymbol} (${parsed.ret}) `;

    if (realArgs.length === 0) {
      methodLine += `${cleanSel}`;
    } else {
      // Interleave selector parts and arguments
      // sel: "dataWithBytes:length:" -> ["dataWithBytes", "length"]
      // args: ["const void *", "unsigned long long"]

      selParts.forEach((part, i) => {
        const argType = realArgs[i] || "id"; // Fallback
        // Standard arg naming: arg1, arg2...
        const argName = `arg${i + 1}`;
        methodLine += `${part}:(${argType})${argName} `;
      });
    }

    lines.push(methodLine.trim() + ";");
  }

  lines.push("");
  lines.push("@end");

  return lines.join("\n");
}

```

`gui/src/lib/codegen.ts`:

```ts
export interface RequestInfo {
  method: string;
  url: string;
  headers: Record<string, string>;
  body?: string;
}

export const formats = [
  { id: "curl", label: "cURL" },
  { id: "fetch-browser", label: "fetch (Web)" },
  { id: "fetch-node", label: "fetch (Node.js)" },
  { id: "powershell", label: "PowerShell" },
  { id: "url", label: "URL" },
] as const;

export type FormatId = (typeof formats)[number]["id"];

function escapeShell(s: string): string {
  return s.replace(/'/g, "'\\''");
}

function curl(req: RequestInfo): string {
  let cmd = `curl '${escapeShell(req.url)}'`;
  if (req.method !== "GET") cmd += ` -X ${req.method}`;
  for (const [k, v] of Object.entries(req.headers)) {
    cmd += ` \\\n  -H '${escapeShell(k)}: ${escapeShell(v)}'`;
  }
  if (req.body) cmd += ` \\\n  --data-raw '${escapeShell(req.body)}'`;
  return cmd;
}

function fetchBrowser(req: RequestInfo): string {
  const hasHeaders = Object.keys(req.headers).length > 0;
  const hasBody = !!req.body;
  const isSimple = req.method === "GET" && !hasHeaders && !hasBody;

  if (isSimple) return `fetch("${req.url}");`;

  const opts: string[] = [];
  if (req.method !== "GET") opts.push(`  method: "${req.method}",`);
  if (hasHeaders) {
    opts.push("  headers: {");
    for (const [k, v] of Object.entries(req.headers)) {
      opts.push(`    "${k}": "${v}",`);
    }
    opts.push("  },");
  }
  if (hasBody) {
    opts.push(`  body: ${JSON.stringify(req.body)},`);
  }

  return `fetch("${req.url}", {\n${opts.join("\n")}\n});`;
}

function fetchNode(req: RequestInfo): string {
  const browser = fetchBrowser(req);
  return `const response = await ${browser}\nconst data = await response.json();`;
}

function powershell(req: RequestInfo): string {
  const lines: string[] = [];
  const hasHeaders = Object.keys(req.headers).length > 0;

  if (hasHeaders) {
    lines.push("$headers = @{");
    for (const [k, v] of Object.entries(req.headers)) {
      lines.push(`    "${k}" = "${v}"`);
    }
    lines.push("}");
    lines.push("");
  }

  if (req.body) {
    lines.push(`$body = '${req.body.replace(/'/g, "''")}'`);
    lines.push("");
  }

  let cmd = "Invoke-RestMethod";
  cmd += ` -Uri "${req.url}"`;
  cmd += ` -Method ${req.method}`;
  if (hasHeaders) cmd += " -Headers $headers";
  if (req.body) cmd += " -Body $body";

  lines.push(cmd);
  return lines.join("\n");
}

export function generate(format: FormatId, req: RequestInfo): string {
  switch (format) {
    case "curl":
      return curl(req);
    case "fetch-browser":
      return fetchBrowser(req);
    case "fetch-node":
      return fetchNode(req);
    case "powershell":
      return powershell(req);
    case "url":
      return req.url;
  }
}

```

`gui/src/lib/file-explorer.ts`:

```ts
import type {
  MetaData,
  DirectoryListing,
} from "@agent/fruity/modules/fs";

export interface TreeNode {
  meta: MetaData;
  children: TreeNode[] | null;
  isLoading: boolean;
  isExpanded: boolean;
}

export type RootType = "!" | "~";

export interface FinderTabParams {
  path: string;
}

export interface UploadFile {
  name: string;
  progress: number;
  error?: string;
}

export interface LoadDirectoryFn {
  (path: string): Promise<DirectoryListing>;
}

export interface DirectorySelectFn {
  (path: string): void;
}

export function formatSize(size: number | null): string {
  if (size === null) return "-";
  if (size < 1024) return `${size} B`;
  if (size < 1024 * 1024) return `${(size / 1024).toFixed(1)} KB`;
  if (size < 1024 * 1024 * 1024)
    return `${(size / (1024 * 1024)).toFixed(1)} MB`;
  return `${(size / (1024 * 1024 * 1024)).toFixed(1)} GB`;
}

export function formatDate(date: Date): string {
  return new Date(date).toLocaleString();
}

export function typeFor(filename: string): string {
  const ext = filename.split(".").pop()?.toLowerCase();
  if (!ext) return "hex";
  switch (ext) {
    case "txt":
    case "md":
    case "js":
    case "css":
    case "xml":
    case "pem":
    case "json":
    case "ini":
      return "text";

    case "sqlite":
    case "db":
      return "sqlite";

    case "jpeg":
    case "jpg":
    case "png":
    case "gif":
    case "tiff":
    case "tif":
    case "webp":
      return "image";

    case "strings":
    case "loctable":
    case "xcprivacy":
    case "archiver":
    case "plist":
      return "plist";

    case "ttf":
    case "otf":
    case "woff":
    case "woff2":
      return "font";

    default:
      return "hex";
  }
}

```

`gui/src/lib/format.ts`:

```ts
export function toTime(date: Date): string {
  return date.toLocaleTimeString("en-US", {
    hour12: false,
    hour: "2-digit",
    minute: "2-digit",
    second: "2-digit",
    fractionalSecondDigits: 3,
  });
}

```

`gui/src/lib/hash.ts`:

```ts
export function fnv1a(input: string): string {
  let hash = 0x811c9dc5;
  for (let i = 0; i < input.length; i++) {
    hash ^= input.charCodeAt(i);
    hash = (hash * 0x01000193) >>> 0;
  }
  return hash.toString(16).padStart(8, "0");
}

```

`gui/src/lib/hook-template.ts`:

```ts
/**
 * Hook code generation utilities for Frida
 */

/**
 * Format an Objective-C method name in standard notation
 * e.g., cls="NSObject", sel="- release" → "-[NSObject release]"
 */
export function formatObjCMethod(cls: string, sel: string): string {
  const sign = sel.charAt(0);
  const methodName = sel.substring(2);
  return `${sign}[${cls} ${methodName}]`;
}

export interface NativeHookTarget {
  type: "native";
  module: string | null;
  name: string;
}

export interface ObjCHookTarget {
  type: "objc";
  cls: string;
  sel: string;
}

export type HookTarget = NativeHookTarget | ObjCHookTarget;

const interceptorBlock = (name: string) => `Interceptor.attach(addr, {
  onEnter(args) {
    console.log("[${name}] called");
    // console.log("  arg0:", args[0]);
  },
  onLeave(retval) {
    console.log("[${name}] returned:", retval);
  }
});`;

/**
 * Generate Frida hook code for a native function
 */
export function native(target: NativeHookTarget, fridaMajor: number = 17): string {
  const { module, name } = target;

  if (fridaMajor >= 17) {
    if (module) {
      return `// Hook ${module}!${name}
{
  const mod = Process.findModuleByName(${JSON.stringify(module)});
  if (mod) {
    const addr = mod.findExportByName(${JSON.stringify(name)});
    if (addr) {
      ${interceptorBlock(name)}
    }
  }
}
`;
    }

    return `// Hook ${name}
{
  const addr = Module.findGlobalExportByName(${JSON.stringify(name)});
  if (addr) {
    ${interceptorBlock(name)}
  }
}
`;
  }

  // Frida 16
  if (module) {
    return `// Hook ${module}!${name}
{
  const addr = Module.findExportByName(${JSON.stringify(module)}, ${JSON.stringify(name)});
  if (addr) {
    ${interceptorBlock(name)}
  }
}
`;
  }

  return `// Hook ${name}
{
  const addr = Module.findExportByName(null, ${JSON.stringify(name)});
  if (addr) {
    ${interceptorBlock(name)}
  }
}
`;
}

/**
 * Generate Frida hook code for an Objective-C method
 */
export function objc(target: ObjCHookTarget): string {
  const { cls, sel } = target;
  const methodLabel = formatObjCMethod(cls, sel);

  return `// Hook ${methodLabel}
{
  const method = ObjC.classes[${JSON.stringify(cls)}][${JSON.stringify(sel)}];
  if (method) {
    Interceptor.attach(method.implementation, {
      onEnter(args) {
        // args[0] = self, args[1] = _cmd, args[2+] = method arguments
        const self = new ObjC.Object(args[0]);
        console.log("${methodLabel} called");
      },
      onLeave(retval) {
        console.log("${methodLabel} returned:", retval);
      }
    });
  }
}
`;
}

/**
 * Generate hook code for multiple targets
 */
export function batch(targets: HookTarget[], fridaMajor: number = 17): string {
  const parts: string[] = [];

  for (const target of targets) {
    if (target.type === "native") {
      parts.push(native(target, fridaMajor));
    } else if (target.type === "objc") {
      parts.push(objc(target));
    }
  }

  return parts.join("\n");
}

```

`gui/src/lib/queries.ts`:

```ts
import { Platform, useSession } from "@/context/SessionContext";
import type { AsyncFruityRPC, AsyncDroidRPC, CommonRPC } from "@/lib/rpc";
import {
  useQuery,
  useMutation,
  useQueryClient,
  type UseQueryOptions,
  type UseMutationOptions,
} from "@tanstack/react-query";

function createRpcQuery<API>(
  platformKey: string,
  getApi: () => API | null | undefined,
) {
  return function <T>(
    key: string[],
    queryFn: (api: API) => Promise<T>,
    options?: Omit<UseQueryOptions<T, Error>, "queryKey" | "queryFn">,
  ) {
    const api = getApi();

    return useQuery({
      queryKey: [platformKey, ...key],
      queryFn: () => queryFn(api!),
      enabled: !!api && (options?.enabled ?? true),
      staleTime: 0,
      gcTime: 0,
      ...options,
    });
  };
}

function createRpcMutation<API>(
  getApi: () => API | null | undefined,
) {
  return function <TData, TVariables>(
    mutationFn: (api: API, variables: TVariables) => Promise<TData>,
    options?: Omit<UseMutationOptions<TData, Error, TVariables>, "mutationFn">,
  ) {
    const api = getApi();

    return useMutation({
      mutationFn: (variables: TVariables) => mutationFn(api!, variables),
      ...options,
    });
  };
}

export const useFruityQuery = createRpcQuery<AsyncFruityRPC>(
  "fruity",
  () => useSession().fruity,
);

export const useDroidQuery = createRpcQuery<AsyncDroidRPC>(
  "droid",
  () => useSession().droid,
);

export const useFruityMutation = createRpcMutation<AsyncFruityRPC>(
  () => useSession().fruity,
);

export const useDroidMutation = createRpcMutation<AsyncDroidRPC>(
  () => useSession().droid,
);

/**
 * Platform-aware RPC query hook. Automatically dispatches to fruity or droid
 * based on the current session platform.
 */
export function usePlatformQuery<T>(
  key: string[],
  queryFn: (api: CommonRPC) => Promise<T>,
  options?: Omit<UseQueryOptions<T, Error>, "queryKey" | "queryFn">,
) {
  const { platform } = useSession();
  const isDroid = platform === Platform.Droid;
  const callerEnabled = options?.enabled ?? true;

  const fruityResult = useFruityQuery<T>(
    key,
    queryFn,
    { ...options, enabled: callerEnabled && !isDroid },
  );

  const droidResult = useDroidQuery<T>(
    key,
    queryFn,
    { ...options, enabled: callerEnabled && isDroid },
  );

  return isDroid ? droidResult : fruityResult;
}

export { useQueryClient };

```

`gui/src/lib/rpc.ts`:

```ts
/* eslint-disable @typescript-eslint/no-explicit-any */
import type { Socket } from "socket.io-client";

import type {
  RemoteRPC,
  RPCRoute as FruityRPCRoute,
} from "@agent/fruity/registry";

import type { RPCRoute as DroidRPCRoute } from "@agent/droid/registry";

import type { BaseMessage as BaseHookMessage } from "@agent/common/hooks/context";
import type { JNIEvent } from "@agent/droid/hooks/jni";

export interface NSURLEvent {
  event: string;
  requestId: string;
  timestamp: number;
  [key: string]: unknown;
}

import type { XPCNode, XPCNodeType } from "@agent/fruity/hooks/xpc";
export type { XPCNode, XPCNodeType };

export interface NSXPCMessage {
  type: "nsxpc";
  sel: string;
  args: string[];
  description: string;
}

export function isNSXPCMessage(
  msg: XPCNode | NSXPCMessage,
): msg is NSXPCMessage {
  return (msg as NSXPCMessage).type === "nsxpc";
}

export interface XPCSocketEvent {
  event: "received" | "sent";
  dir: "<" | ">";
  name?: string;
  peer?: number;
  message: XPCNode | NSXPCMessage;
  backtrace?: string[];
}

export interface MemoryScanEvent {
  event: "match" | "progress" | "done";
  address?: string;
  size?: number;
  current?: number;
  total?: number;
  count?: number;
}

export interface SessionClientEvents {
  ready: (pid: number) => void;
  denied: () => void;
  log: (level: string, text: string) => void;
  syslog: (text: string) => void;
  invalid: () => void;
  hook: (message: BaseHookMessage) => void;
  flutter: (event: Record<string, unknown>) => void;
  crypto: (message: BaseHookMessage) => void;
  nsurl: (event: NSURLEvent) => void;
  xpc: (event: XPCSocketEvent) => void;
  jni: (event: JNIEvent) => void;
  hermes: (event: { url: string; hash: string; size: number }) => void;
  memoryScan: (event: MemoryScanEvent, data?: ArrayBuffer) => void;
  fatal: (detail: unknown) => void;
}

export interface SessionServerEvents {
  rpc: (
    mod: string,
    method: string,
    args: any[],
    ack: (err: Error, result: any) => void,
  ) => void;
  eval: (
    source: string,
    name: string,
    ack: (err: Error | null, result: any) => void,
  ) => void;
  clearLog: (
    type: "syslog" | "agent",
    ack: (err: Error | null, result: any) => void,
  ) => void;
}

export type AsyncFruityRPC = RemoteRPC<FruityRPCRoute>;
export type AsyncDroidRPC = RemoteRPC<DroidRPCRoute>;

/**
 * Shared RPC surface across both platforms.
 * Only includes namespaces backed by the same @/common/* source,
 * guaranteeing identical types on both fruity and droid.
 * (flutter and fs exist on both but have platform-specific implementations)
 */
export type CommonRPC = Pick<
  AsyncFruityRPC,
  "symbol" | "memory" | "native" | "sqlite" | "script" | "syslog" | "rn"
>;

type Platform = "fruity" | "droid";

function createExecutor(
  socket: Socket<SessionClientEvents, SessionServerEvents>,
) {
  let ready = false;
  const pending: Array<{ run: () => void; reject: (err: Error) => void }> = [];

  socket.on("ready", () => {
    ready = true;
    pending.forEach((operation) => operation.run());
    pending.length = 0;
  });

  socket.on("disconnect", () => {
    ready = false;
    const err = new Error("socket disconnected");
    pending.forEach((operation) => operation.reject(err));
    pending.length = 0;
  });

  return function executor(
    namespace: string,
    method: string,
    args: any[],
  ): Promise<any> {
    return new Promise((resolve, reject) => {
      const run = () => {
        socket.emit(
          "rpc",
          namespace,
          method,
          args,
          (err: Error, result: any) => {
            if (err) reject(err);
            else resolve(result);
          },
        );
      };

      if (ready) run();
      else pending.push({ run, reject });
    });
  };
}

function createProxy<T extends object>(
  executor: (namespace: string, method: string, args: any[]) => Promise<any>,
): T {
  return new Proxy({} as T, {
    get(_target, namespace: string) {
      return new Proxy(
        {},
        {
          get(_nsTarget, method: string) {
            return (...args: any[]) => executor(namespace, method, args);
          },
        },
      );
    },
  });
}

function createThrowingProxy<T extends object>(
  expectedPlatform: Platform,
  actualPlatform: Platform,
): T {
  const message = `Cannot use ${expectedPlatform} API when connected to ${actualPlatform} platform`;
  return new Proxy({} as T, {
    get() {
      return new Proxy(
        {},
        {
          get() {
            return () => {
              throw new Error(message);
            };
          },
        },
      );
    },
  });
}

export interface PlatformAPIs {
  fruity: AsyncFruityRPC;
  droid: AsyncDroidRPC;
}

/**
 * Create platform-specific RPC APIs.
 * Returns both fruity and droid typed endpoints.
 * Only the matching platform's API actually works - the other throws on access.
 */
export function createAPI(
  socket: Socket<SessionClientEvents, SessionServerEvents>,
  platform: Platform,
): PlatformAPIs {
  const executor = createExecutor(socket);

  if (platform === "fruity") {
    return {
      fruity: createProxy<AsyncFruityRPC>(executor),
      droid: createThrowingProxy<AsyncDroidRPC>("droid", "fruity"),
    };
  } else {
    return {
      fruity: createThrowingProxy<AsyncFruityRPC>("fruity", "droid"),
      droid: createProxy<AsyncDroidRPC>(executor),
    };
  }
}

```

`gui/src/lib/utils.ts`:

```ts
import { clsx, type ClassValue } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}

```

`gui/src/locales/cn/translation.json`:

```json
{
  "toggle_dark_mode": "切换夜间模式",
  "logo_alt": "标志",
  "devices": "设备",
  "error": "错误",
  "no_devices_found": "未找到设备",
  "language_en": "🇬🇧 English",
  "language_cn": "🇨🇳 简体中文",
  "device": "设备",
  "apps_for_device": "应用列表",
  "failed_to_fetch_apps": "获取应用失败",
  "failed_to_fetch_devices": "获取设备列表失败",
  "failed_to_fetch_device_info": "获取设备信息失败",
  "no_apps_found": "未找到应用",
  "no_processes_found": "未找到进程",
  "apps": "应用",
  "processes": "进程",
  "failed_to_fetch_processes": "获取进程列表失败",
  "please_select_device": "请选择一个设备",
  "desktop_only_warning": "Grapefruit 仅适用于桌面浏览器",
  "no_results": "未找到结果",
  "logs": "日志",
  "hooks": "钩子",
  "agent_logs": "Agent 日志",
  "new_to_grapefruit": "需要快速上手？请查阅",
  "connected": "已连接",
  "disconnected": "连接断开",
  "session_disconnected_prompt": "会话已断开，是否重新连接？",
  "disconnect": "断开连接",
  "connecting": "正在连接",
  "reload": "刷新",
  "add_device": "添加设备",
  "add_remote_device": "添加远程设备",
  "ip_address": "IP 地址",
  "confirm": "确认",
  "yes": "是",
  "dismiss": "关闭",
  "cancel": "取消",
  "delete": "删除",
  "general": "概览",
  "modules": "模块",
  "classes": "类",
  "files": "文件",
  "app_name": "应用名",
  "bundle_id": "包 ID",
  "version": "版本",
  "min_os": "最低系统要求",
  "size": "大小",
  "bundle_path": "包路径",
  "executable": "可执行文件",
  "tmp_dir": "临时目录",
  "home_dir": "主目录",
  "failed_to_fetch_app_info": "获取应用信息失败",
  "no_app_info": "无可用的应用信息",
  "connect_to_view_app_info": "请连接到目标以查看应用信息",
  "download": "下载",
  "loading": "加载中",
  "file_descriptor": "文件描述符",
  "type": "类型",
  "details": "详情",
  "never": "从不",
  "1s": "1 秒",
  "5s": "5秒",
  "10s": "10 秒",
  "1min": "1 分钟",
  "search": "搜索...",
  "dependencies": "依赖",
  "sections": "段",
  "symbols": "符号",
  "imported": "导入",
  "exported": "导出",
  "exports": "导出",
  "name": "名称",
  "address": "地址",
  "demangled": "解码名",
  "main": "主模块",
  "app": "应用",
  "global": "全局",
  "module": "模块",
  "super_classes": "继承关系",
  "protocols": "协议",
  "instance_variables": "实例变量",
  "offset": "偏移",
  "methods": "方法",
  "method": "方法",
  "show_inherited": "显示继承",
  "bundle": "应用包",
  "finder": "文件浏览",
  "empty_directory": "空目录",
  "modified": "修改时间",
  "copy": "复制",
  "open_with": "打开方式",
  "hex_view": "十六进制查看",
  "text_editor": "文本编辑器",
  "sqlite_editor": "SQLite 编辑器",
  "image_preview": "图片预览",
  "font_preview": "字体预览",
  "plist_preview": "plist 预览",
  "expand_all": "全部展开",
  "collapse_all": "全部折叠",
  "no_content": "无内容",
  "tree": "树形",
  "insights": "安全分析",
  "text": "文本",
  "confirmation": "是否确定",
  "delete_cookie_confirmation": "确定要删除 cookie {{name}} 吗？",
  "clear": "清空",
  "no_cookies": "无 Cookie",
  "cookies_cleared": "Cookie 已清空",
  "failed_to_clear_cookies": "清空 Cookie 失败",
  "cookie_removed": "Cookie 已删除",
  "failed_to_remove_cookie": "删除 Cookie 失败",
  "domain": "域名",
  "value": "值",
  "expires": "过期时间",
  "secure": "安全",
  "actions": "操作",
  "edit": "编辑",
  "remove": "移除",
  "clear_all_cookies_confirmation": "确定要清空所有 Cookie 吗？",
  "save": "保存",
  "discard": "放弃",
  "unsaved_changes": "未保存的更改",
  "acl": "访问控制列表",
  "path": "路径",
  "require_biometric_id": "显示需要生物识别 id 的项目",
  "service": "服务",
  "account": "账户",
  "label": "标签",
  "creation_time": "创建时间",
  "modification_time": "修改时间",
  "class": "类别",
  "failed_to_load_class": "加载类信息失败",
  "alias": "别名",
  "invisible": "隐藏",
  "custom_icon": "自定义图标",
  "no_keychain_items": "无钥匙串项目",
  "delete_keychain_confirmation": "确定要删除钥匙串项目吗 (服务: {{service}}, 账户: {{account}})？",
  "entitlement_group": "授权组",
  "comment": "备注",
  "creator": "创建者",
  "prot": "保护级别",
  "data": "数据",
  "raw": "原始数据",
  "filter": "过滤器",
  "ui_hierarchy": "UI 层级",
  "search_ui_elements": "搜索 UI 元素...",
  "visual_preview": "可视化预览",
  "selected_element": "已选元素",
  "no_data": "暂无数据",
  "hex_preview": "十六进制查看器",
  "inspect_ui": "检视界面",
  "invalid_utf8_file": "不是有效的文本文件",
  "invalid_utf8_description": "此文件包含无效的 UTF-8 序列，无法作为文本显示。请使用十六进制模式查看其二进制内容。",
  "open_in_hex_preview": "用十六进制预览打开",
  "geolocation_simulation": "定位模拟",
  "stop": "停止",
  "simulated_location": "模拟的位置",
  "uploading": "正在上传",
  "completed": "已完成",
  "drop_files_here": "将文件拖放到此处上传",
  "type_encoding": "类型编码",
  "failed_to_load_font_preview": "无法加载字体预览",
  "plain_text": "纯文本",
  "send": "发送",
  "enter_url_scheme": "输入 URL scheme...",
  "reset": "重置",
  "jsc_contexts": "{{count}} 个 JSContext",
  "no_jscontext_found": "未找到 JSContext",
  "handle": "句柄",
  "description": "描述",
  "code_scratch_pad": "代码草稿板",
  "globals": "全局对象",
  "execute_javascript": "执行 JavaScript",
  "loading_globals": "正在加载全局对象...",
  "failed_to_load_globals": "加载全局对象失败",
  "select_jscontext": "选择一个 JSContext 进行检查",
  "filter_by_name": "按名称过滤...",
  "no_matching_entries": "无匹配项",
  "no_global_objects": "未找到全局对象",
  "entries_count": "{{filtered}} / {{total}} 项",
  "run": "运行",
  "result": "结果",
  "enabled": "已启用",
  "disabled": "已禁用",
  "content_js": "内容 JS",
  "auto_open_windows": "自动打开窗口",
  "file_url_access": "文件 URL 访问",
  "universal_file_access": "通用文件访问",
  "webviews": "个 WebView",
  "no_webviews": "未找到 WebView",
  "title": "标题",
  "configuration": "配置",
  "current_url": "当前 URL",
  "navigate_to_url": "导航至 URL",
  "navigate": "导航",
  "select_webview": "选择一个 WebView 进行检查",
  "key": "键",
  "daemon": "守护进程",
  "mode": "模式",
  "feature_coming_soon": "此功能即将推出",
  "search_apps": "搜索应用...",
  "search_processes": "搜索进程...",
  "no_apps_matching_search": "未找到匹配的应用",
  "no_processes_matching_search": "未找到匹配的进程",
  "user": "用户",
  "hide_panel": "隐藏面板",
  "show_panel": "显示面板",
  "home": "主页",
  "home_finder_desc": "浏览应用主目录和文件",
  "home_lsof_desc": "列出打开的文件描述符和套接字",
  "home_infoplist_desc": "查看应用配置信息",
  "home_entitlements_desc": "检查应用权限和能力",
  "home_cookies_desc": "浏览和编辑 HTTP Cookies",
  "home_keychain_desc": "访问钥匙串项目和密钥",
  "home_userdefaults_desc": "查看和修改用户偏好设置",
  "home_ui_desc": "检查视图层次结构和元素",
  "home_webview_desc": "调试内嵌的 Web 内容",
  "home_jsc_desc": "探索 JavaScriptCore 上下文",
  "home_nsurl_desc": "捕获 NSURLSession 网络流量",
  "category_files": "文件与数据",
  "category_security": "安全",
  "category_ui": "界面与网页",
  "category_network": "网络与通信",
  "session_menu": "会话菜单",
  "reload_page": "刷新页面",
  "kill_process": "终止进程",
  "process_killed": "进程 {{pid}} 已终止",
  "failed_to_kill_process": "终止进程失败",
  "detach": "分离",
  "hook_builtin": "内置",
  "hook_user_defined": "用户自定义",
  "hook_sqlite": "SQLite",
  "hook_sqlite_desc": "监控数据库操作，包括打开、准备、执行和绑定语句",
  "hook_pasteboard": "剪贴板",
  "hook_pasteboard_desc": "监控剪贴板读写操作，追踪访问的剪贴板名称",
  "hook_deviceid": "随机设备 ID",
  "hook_deviceid_desc": "使用随机 UUID 伪造 IDFV 和 IDFA，防止设备指纹追踪",
  "hook_biometric": "生物识别绕过",
  "hook_biometric_desc": "通过强制 LAContext 返回成功来绕过 Touch ID 和 Face ID 认证",
  "hook_fileops": "文件操作",
  "hook_fileops_desc": "监控文件系统操作：打开、创建、删除、stat、访问、重命名、链接",
  "hook_results": "钩子结果",
  "hook_no_results": "暂无结果。启用钩子组以开始捕获。",
  "crypto_results": "加密",
  "crypto_no_results": "暂无加密结果。启用加密钩子以开始捕获。",
  "crypto_hash": "哈希",
  "crypto_detail_tab": "详情",
  "crypto_hexdump_tab": "十六进制",
  "crypto_backtrace_tab": "调用栈",
  "hook_stack_trace": "调用栈",
  "hook_direction": "方向",
  "hook_algorithm": "算法",
  "scroll_to_latest": "最新",
  "copied": "已复制",
  "items": "项",
  "no_values": "无数据",
  "rename": "重命名",
  "time": "时间",
  "imports": "导入",
  "repl_download": "下载",
  "repl_copy": "复制",
  "hook_native": "原生",
  "hook_user_no_hooks": "暂无自定义钩子",
  "hook_add": "钩取",
  "hook_remove": "移除",
  "hook_generate_code": "生成代码",
  "hook_batch_mode": "批量",
  "hook_selected_count": "已选 {{count}} 项",
  "hook_batch_hook": "钩取所选",
  "hook_batch_generate": "生成代码",
  "hook_added": "钩子已添加",
  "hook_added_count": "已添加 {{count}} 个钩子",
  "hook_failed": "添加钩子失败",
  "flutter_channels": "Flutter 平台通道",
  "flutter_channels_desc": "捕获 Dart \u2194 Native 平台通道消息",
  "flutter_channel": "通道",
  "flutter_select_event": "选择一条事件以查看 args/result JSON。",
  "args": "参数",
  "execute": "执行",
  "rows_returned": "返回 {{count}} 行",
  "query_executed_no_results": "查询执行成功（无结果）",
  "select_table_or_execute": "选择表格或执行查询",
  "file_renamed": "文件已重命名",
  "file_deleted": "文件已删除",
  "select_all": "全选",
  "selected_count": "已选 {{count}} 项",
  "batch_delete": "删除所选",
  "batch_delete_confirm": "确定要删除 {{count}} 个文件吗？",
  "batch_delete_warning": "此操作无法撤销。",
  "upload": "上传",
  "upload_files": "上传文件",
  "components": "组件",
  "activities": "活动",
  "services": "服务",
  "receivers": "广播接收器",
  "providers": "内容提供者",
  "permission": "权限",
  "start_activity": "启动活动",
  "stop_service": "停止服务",
  "send_broadcast": "发送广播",
  "package_name": "包名",
  "sdk_version": "SDK 版本",
  "android_version": "Android 版本",
  "manufacturer": "制造商",
  "security_patch": "安全补丁",
  "data_dir": "数据目录",
  "no_components": "未找到组件",
  "query_provider": "查询",
  "device_info": "设备信息",
  "no_device_info": "无设备信息",
  "brand": "品牌",
  "model": "型号",
  "start_service": "启动服务",
  "native_library_dir": "原生库目录",
  "public_source_dir": "公开源目录",
  "source_dir": "源目录",
  "shared_library_files": "共享库",
  "split_apks": "分包 APK",
  "process_name": "进程名",
  "target_sdk": "目标 SDK",
  "min_sdk": "最低 SDK",
  "directories": "目录",
  "fields": "字段",
  "return_type": "返回类型",
  "parameters": "参数列表",
  "keystore": "密钥库",
  "no_keystore_aliases": "未找到别名",
  "key_properties": "密钥属性",
  "key_size": "密钥大小",
  "entry_type": "条目类型",
  "origin": "来源",
  "purposes": "用途",
  "crypto_config": "加密配置",
  "block_modes": "分组模式",
  "digests": "摘要算法",
  "encryption_paddings": "加密填充",
  "signature_paddings": "签名填充",
  "security_properties": "安全属性",
  "inside_secure_hardware": "安全硬件",
  "user_auth_required": "需要用户认证",
  "auth_validity_seconds": "认证有效期（秒）",
  "auth_enforced_by_hardware": "硬件强制认证",
  "biometric_invalidation": "生物识别失效",
  "trusted_presence_required": "需要可信存在",
  "user_confirmation_required": "需要用户确认",
  "auth_valid_on_body": "随身有效",
  "validity": "有效期",
  "validity_start": "开始时间",
  "validity_origination_end": "生成截止",
  "validity_consumption_end": "使用截止",
  "home_keystore_desc": "检查 AndroidKeyStore 密钥及安全属性",
  "home_manifest_desc": "查看和检查 AndroidManifest.xml",
  "open_manifest": "打开 AndroidManifest.xml",
  "no_url_schemes": "此应用未声明 URL Scheme",
  "content_providers": "内容提供者",
  "no_providers": "未找到提供者",
  "read_permission": "读取权限",
  "write_permission": "写入权限",
  "grant_uri_permissions": "授予 URI 权限",
  "projection": "投影",
  "projection_placeholder": "列名（逗号分隔）",
  "selection": "筛选条件",
  "selection_placeholder": "WHERE 子句",
  "selection_args": "筛选参数",
  "selection_args_placeholder": "值（逗号分隔）",
  "sort_order": "排序",
  "sort_order_placeholder": "例如 name ASC",
  "no_query_results": "无结果。选择一个提供者或输入 URI 后点击执行。",
  "home_providers_desc": "浏览和查询内容提供者",
  "home_xpc_desc": "追踪 XPC 和 NSXPC 进程间通信",
  "home_jni_desc": "追踪原生库的 JNI 函数调用",
  "home_memory_scan_desc": "扫描进程内存中的模式和值",
  "category_runtime": "运行时",
  "memory_scanner": "内存扫描",
  "jni_trace": "JNI 追踪",
  "dump_decrypted": "导出二进制",
  "dump_decrypted_error": "此模块无法解密，可能属于系统内置库",

  "severity_high": "高危",
  "severity_medium": "中危",
  "severity_info": "提示",
  "severity_ok": "正常",

  "manifest_security_findings": "安全发现",
  "manifest_declared_permissions": "已声明权限",
  "manifest_declared_permissions_count": "已声明权限（{{count}}）",
  "manifest_no_permissions_desc": "未声明任何权限。",
  "manifest_perm_dangerous": "危险权限",
  "manifest_summary_high": "高危",
  "manifest_summary_medium": "中危",
  "manifest_summary_dangerous_perms": "危险权限",
  "manifest_summary_normal_perms": "普通权限",

  "manifest_debuggable_on_title": "调试标志已开启",
  "manifest_debuggable_on_desc": "android:debuggable=\"true\" 允许任何人在任意设备上附加调试器到应用进程。这将启用内存检查、方法 Hook 和运行时篡改。生产版本必须移除此标志或设置为 false。",
  "manifest_debuggable_off_title": "调试标志已关闭",
  "manifest_debuggable_off_desc": "未启用 android:debuggable。在未 root 的生产设备上无法附加调试器。",
  "manifest_allowbackup_on_title": "允许备份",
  "manifest_allowbackup_on_default_desc": "android:allowBackup 未设置，默认为 true。应用数据可通过 adb 备份或 Android 云备份提取，可能暴露凭证和令牌。请设置为 false 或通过 android:fullBackupContent 限制备份内容。",
  "manifest_allowbackup_on_explicit_desc": "android:allowBackup=\"true\" 已显式设置。应用数据可通过 adb 备份或云备份提取，可能暴露敏感数据。",
  "manifest_allowbackup_off_title": "备份已禁用",
  "manifest_allowbackup_off_desc": "android:allowBackup=\"false\" 可防止通过云备份或 adb 备份提取应用数据。",
  "manifest_cleartext_title": "允许明文 HTTP 流量",
  "manifest_cleartext_desc": "android:usesCleartextTraffic=\"true\" 允许应用发送未加密的 HTTP 流量。传输中的数据对任何网络观察者可见。所有流量应使用 HTTPS。",
  "manifest_nsc_title": "未定义网络安全配置",
  "manifest_nsc_desc": "未指定 android:networkSecurityConfig。将使用平台默认配置：Android 9+ 上默认禁止明文流量。建议添加配置以固定证书、限制受信任的 CA 或按域名控制明文策略。",
  "manifest_perms_excessive_title": "已声明 {{count}} 个危险权限",
  "manifest_perms_excessive_desc": "清单申请了 {{count}} 个 Android 标记为危险的权限。请逐一确认每项权限对核心功能的必要性。过多权限会扩大攻击面并降低用户信任。",
  "manifest_perms_some_title": "已声明 {{count}} 个危险权限",
  "manifest_perms_some_desc": "应用申请了 {{count}} 个危险权限。请确认每项权限是否符合用户对应用功能的合理预期。",
  "manifest_perms_none_title": "未声明危险权限",
  "manifest_perms_none_desc": "已声明 {{count}} 个普通权限，均无需运行时授权。",

  "uidevice_name": "设备名称",
  "uidevice_localized_model": "本地化型号",
  "uidevice_system": "系统",
  "uidevice_idiom": "界面类型",
  "uidevice_battery": "电池",
  "uidevice_idfv": "供应商标识符",
  "uidevice_multitasking": "多任务",

  "plist_insights_title": "快速分析",
  "home_plist_insights_desc": "分析 ATS、权限和加密配置的安全性",

  "plist_ats_arbitrary_title": "ATS 允许任意加载",
  "plist_ats_arbitrary_desc": "NSAllowsArbitraryLoads 设置为 true，禁用了所有网络连接的 App Transport Security。这允许向任何服务器发送未加密的 HTTP 流量，数据可被网络观察者截获。所有流量应使用 HTTPS。",
  "plist_ats_arbitrary_off_title": "ATS 任意加载已禁用",
  "plist_ats_arbitrary_off_desc": "NSAllowsArbitraryLoads 未启用。App Transport Security 默认对所有网络连接强制使用 HTTPS。",
  "plist_ats_media_title": "媒体加载的 ATS 已禁用",
  "plist_ats_media_desc": "NSAllowsArbitraryLoadsForMedia 为 true。通过 AVFoundation 加载的媒体内容不受 ATS 限制，允许未加密的媒体流。",
  "plist_ats_webcontent_title": "Web 内容的 ATS 已禁用",
  "plist_ats_webcontent_desc": "NSAllowsArbitraryLoadsInWebContent 为 true。来自 Web 视图 (WKWebView) 的请求不受 ATS 限制，允许未加密的 HTTP 内容。",
  "plist_ats_local_title": "允许本地网络访问",
  "plist_ats_local_desc": "NSAllowsLocalNetworking 为 true。应用可以在不受 ATS 限制的情况下从本地 IP 地址和非限定域名加载资源。",
  "plist_ats_exceptions_title": "{{count}} 个 ATS 例外域名",
  "plist_ats_exceptions_desc": "NSExceptionDomains 为以下域名定义了自定义 ATS 规则。请逐一确认例外配置的合理性。",
  "plist_ats_default_title": "ATS 使用默认配置",
  "plist_ats_default_desc": "未定义 NSAppTransportSecurity 字典。使用平台默认配置：所有网络连接要求 HTTPS。",

  "plist_encryption_yes_title": "应用使用非豁免加密",
  "plist_encryption_yes_desc": "ITSAppUsesNonExemptEncryption 为 true。应用声明使用的加密可能需要出口合规文档。",
  "plist_encryption_no_title": "应用不使用非豁免加密",
  "plist_encryption_no_desc": "ITSAppUsesNonExemptEncryption 为 false。应用声明不使用超出系统提供或豁免类别的加密。",
  "plist_encryption_missing_title": "未声明加密信息",
  "plist_encryption_missing_desc": "Info.plist 中未声明 ITSAppUsesNonExemptEncryption。App Store Connect 将在提交时提示填写。",

  "plist_perms_excessive_title": "已声明 {{count}} 个敏感权限",
  "plist_perms_excessive_desc": "应用请求了 {{count}} 个敏感权限（相机、位置、麦克风、通讯录、Face ID、健康、相册）。请逐一确认每项权限是否为核心功能所必需。",
  "plist_perms_some_title": "已声明 {{count}} 个敏感权限",
  "plist_perms_some_desc": "应用请求了 {{count}} 个敏感权限。请确认每项权限是否符合用户对应用功能的合理预期。",
  "plist_perms_none_sensitive_title": "未声明敏感权限",
  "plist_perms_none_sensitive_desc": "已声明 {{count}} 个权限，均未被标记为敏感权限。",

  "plist_summary_sensitive_perms": "敏感权限",
  "plist_declared_permissions": "已声明权限",
  "plist_declared_permissions_count": "已声明权限（{{count}}）",
  "plist_no_permissions_desc": "未声明使用描述权限。",
  "plist_perm_sensitive": "敏感",
  "plist_url_schemes_count": "URL Schemes（{{count}}）",

  "perm_desc_CAMERA": "使用摄像头拍摄照片和视频",
  "perm_desc_RECORD_AUDIO": "通过麦克风录制音频",
  "perm_desc_READ_CONTACTS": "读取用户的联系人列表",
  "perm_desc_WRITE_CONTACTS": "添加或修改联系人",
  "perm_desc_READ_CALL_LOG": "读取设备的通话记录",
  "perm_desc_WRITE_CALL_LOG": "写入设备的通话记录",
  "perm_desc_PROCESS_OUTGOING_CALLS": "拦截或重定向外拨电话",
  "perm_desc_READ_CALENDAR": "读取日历事件和详情",
  "perm_desc_WRITE_CALENDAR": "创建或修改日历事件",
  "perm_desc_ACCESS_FINE_LOCATION": "获取精确的 GPS 位置",
  "perm_desc_ACCESS_COARSE_LOCATION": "获取基于网络的大致位置",
  "perm_desc_ACCESS_BACKGROUND_LOCATION": "在应用处于后台时访问位置",
  "perm_desc_READ_PHONE_STATE": "读取设备标识符和当前通话状态",
  "perm_desc_READ_PHONE_NUMBERS": "读取设备电话号码",
  "perm_desc_CALL_PHONE": "无需用户确认即可拨打电话",
  "perm_desc_ANSWER_PHONE_CALLS": "以编程方式接听来电",
  "perm_desc_ADD_VOICEMAIL": "向设备添加语音邮件条目",
  "perm_desc_USE_SIP": "拨打和接听 SIP 通话",
  "perm_desc_SEND_SMS": "发送短信（可能产生费用）",
  "perm_desc_RECEIVE_SMS": "接收并读取短信",
  "perm_desc_READ_SMS": "读取存储在设备上的短信",
  "perm_desc_RECEIVE_WAP_PUSH": "接收 WAP 推送消息",
  "perm_desc_RECEIVE_MMS": "接收彩信",
  "perm_desc_BODY_SENSORS": "访问体征传感器数据（如心率）",
  "perm_desc_BODY_SENSORS_BACKGROUND": "在后台访问体征传感器",
  "perm_desc_READ_EXTERNAL_STORAGE": "从共享外部存储读取文件",
  "perm_desc_WRITE_EXTERNAL_STORAGE": "向共享外部存储写入文件",
  "perm_desc_MANAGE_EXTERNAL_STORAGE": "对外部存储上的所有文件进行广泛管理",
  "perm_desc_ACCESS_MEDIA_LOCATION": "读取照片和视频中嵌入的 GPS 元数据",
  "perm_desc_SYSTEM_ALERT_WINDOW": "在其他应用上方绘制悬浮窗",
  "perm_desc_REQUEST_INSTALL_PACKAGES": "无需用户确认即可安装 APK 包",
  "perm_desc_GET_ACCOUNTS": "访问设备上已注册的账户列表",
  "perm_desc_BLUETOOTH_SCAN": "扫描附近的蓝牙设备",
  "perm_desc_BLUETOOTH_CONNECT": "连接已配对的蓝牙设备",
  "perm_desc_UWB_RANGING": "与附近设备进行超宽带测距",
  "perm_desc_ACTIVITY_RECOGNITION": "检测步行、骑行等身体活动",
  "perm_desc_POST_NOTIFICATIONS": "向用户推送通知",

  "rn_instances": "实例",
  "rn_not_detected": "未检测到 React Native 运行时。",
  "rn_no_instances": "未找到实例。",
  "rn_select_instance": "选择一个实例进行检查。",
  "rn_js_bundles": "JavaScript 包",
  "rn_no_bundles": "暂无捕获的包。",
  "rn_js_expression": "JavaScript 表达式...",
  "clear_all": "清空全部"
}

```

`gui/src/locales/en/translation.json`:

```json
{
  "toggle_dark_mode": "Toggle dark mode",
  "logo_alt": "Logo",
  "devices": "Devices",
  "error": "Error",
  "no_devices_found": "No devices found",
  "language_en": "🇬🇧 English",
  "language_cn": "🇨🇳 简体中文",
  "device": "Device",
  "apps_for_device": "Apps for Device",
  "failed_to_fetch_apps": "Failed to fetch apps",
  "failed_to_fetch_devices": "Failed to fetch devices",
  "failed_to_fetch_device_info": "Failed to fetch device info",
  "no_apps_found": "No apps found",
  "no_processes_found": "No processes found",
  "apps": "Apps",
  "processes": "Processes",
  "failed_to_fetch_processes": "Failed to fetch processes",
  "please_select_device": "Please select a device",
  "desktop_only_warning": "Grapefruit is designed for desktop browsers only",
  "no_results": "No results found",
  "logs": "Logs",
  "hooks": "Hooks",
  "agent_logs": "Agent Logs",
  "new_to_grapefruit": "New to Grapefruit? Check them out",
  "connected": "Connected",
  "disconnected": "Disconnected",
  "session_disconnected_prompt": "Session is disconnected. Do you want to reconnect?",
  "disconnect": "Disconnect",
  "connecting": "Connecting",
  "reload": "Reload",
  "add_device": "Add device",
  "add_remote_device": "Add remote device",
  "ip_address": "IP address",
  "confirm": "Confirm",
  "yes": "Yes",
  "dismiss": "Dismiss",
  "cancel": "Cancel",
  "delete": "Delete",
  "general": "General",
  "modules": "Modules",
  "classes": "Classes",
  "files": "Files",
  "app_name": "App Name",
  "bundle_id": "Bundle ID",
  "version": "Version",
  "min_os": "Minimum OS",
  "size": "Size",
  "bundle_path": "Bundle path",
  "executable": "Executable",
  "tmp_dir": "Temp directory",
  "home_dir": "Home directory",
  "failed_to_fetch_app_info": "Failed to fetch application information",
  "no_app_info": "No application information available",
  "connect_to_view_app_info": "Connect to a target to view application information",
  "download": "Download",
  "loading": "Loading",
  "file_descriptor": "File Descriptor",
  "type": "Type",
  "details": "Details",
  "never": "Never",
  "1s": "1 second",
  "5s": "5 seconds",
  "10s": "10 seconds",
  "1min": "1 minute",
  "search": "Search...",
  "dependencies": "Dependencies",
  "sections": "Sections",
  "symbols": "Symbols",
  "imported": "Imported",
  "exported": "Exported",
  "exports": "Exports",
  "name": "Name",
  "address": "Address",
  "demangled": "Demangled",
  "main": "Main",
  "app": "App",
  "global": "Global",
  "module": "Module",
  "super_classes": "Super Classes",
  "protocols": "Protocols",
  "instance_variables": "Instance Variables",
  "offset": "Offset",
  "methods": "Methods",
  "method": "Method",
  "show_inherited": "Show Inherited",
  "bundle": "Bundle",
  "finder": "Finder",
  "empty_directory": "Empty directory",
  "modified": "Modified",
  "copy": "Copy",
  "open_with": "Open with",
  "hex_view": "Hex View",
  "text_editor": "Text Editor",
  "sqlite_editor": "SQLite Editor",
  "image_preview": "Image Preview",
  "font_preview": "Font Preview",
  "plist_preview": "Property List Preview",
  "expand_all": "Expand All",
  "collapse_all": "Collapse All",
  "no_content": "No content",
  "tree": "Tree",
  "insights": "Insights",
  "text": "Text",
  "confirmation": "Confirmation",
  "delete_cookie_confirmation": "Are you sure to delete cookie {{name}}?",
  "clear": "Clear",
  "no_cookies": "No cookies",
  "cookies_cleared": "Cookies cleared",
  "failed_to_clear_cookies": "Failed to clear cookies",
  "cookie_removed": "Cookie removed",
  "failed_to_remove_cookie": "Failed to remove cookie",
  "domain": "Domain",
  "value": "Value",
  "expires": "Expires",
  "secure": "Secure",
  "actions": "Actions",
  "edit": "Edit",
  "remove": "Remove",
  "clear_all_cookies_confirmation": "Are you sure to clear all cookies?",
  "save": "Save",
  "discard": "Discard",
  "unsaved_changes": "Unsaved Changes",
  "acl": "Access Control List",
  "path": "Path",
  "require_biometric_id": "Display Items That Require Biometric ID",
  "service": "Service",
  "account": "Account",
  "label": "Label",
  "class": "Class",
  "failed_to_load_class": "Failed to load class info",
  "alias": "Alias",
  "invisible": "Invisible",
  "custom_icon": "Custom Icon",
  "no_keychain_items": "No Keychain Items",
  "delete_keychain_confirmation": "Are you sure to delete keychain item (Service: {{service}}, Account: {{account}})?",
  "creation_time": "Creation",
  "modification_time": "Modification",
  "entitlement_group": "Entitlement Group",
  "comment": "Comment",
  "creator": "Creator",
  "prot": "Protection",
  "data": "Data",
  "raw": "Raw",
  "filter": "Filter",
  "ui_hierarchy": "UI Hierarchy",
  "search_ui_elements": "Search UI elements...",
  "visual_preview": "Visual Preview",
  "selected_element": "Selected Element",
  "no_data": "No data available",
  "hex_preview": "Hex Preview",
  "inspect_ui": "Inspect UI",
  "invalid_utf8_file": "Not a valid text file",
  "invalid_utf8_description": "This file contains invalid UTF-8 sequences and cannot be displayed as text. Open it in the Hex Preview for binary content.",
  "open_in_hex_preview": "Open in Hex Preview",
  "geolocation_simulation": "Geolocation Simulation",
  "stop": "Stop",
  "simulated_location": "Simulated Location",
  "uploading": "Uploading",
  "completed": "Completed",
  "drop_files_here": "Drop files here to upload",
  "type_encoding": "Type Encoding",
  "failed_to_load_font_preview": "Failed to load font preview",
  "plain_text": "Plain Text",
  "send": "Send",
  "enter_url_scheme": "Enter URL scheme...",
  "reset": "Reset",
  "jsc_contexts": "{{count}} JSContext(s)",
  "no_jscontext_found": "No JSContext found",
  "handle": "Handle",
  "description": "Description",
  "code_scratch_pad": "Code Scratch Pad",
  "globals": "Globals",
  "execute_javascript": "Execute JavaScript",
  "loading_globals": "Loading globals...",
  "failed_to_load_globals": "Failed to load globals",
  "select_jscontext": "Select a JSContext to inspect",
  "filter_by_name": "Filter by name...",
  "no_matching_entries": "No matching entries",
  "no_global_objects": "No global objects found",
  "entries_count": "{{filtered}} of {{total}} entries",
  "run": "Run",
  "result": "Result",
  "enabled": "Enabled",
  "disabled": "Disabled",
  "content_js": "Content JS",
  "auto_open_windows": "Auto-Open Windows",
  "file_url_access": "File URL Access",
  "universal_file_access": "Universal File Access",
  "webviews": "WebView(s)",
  "no_webviews": "No WebViews found",
  "title": "Title",
  "configuration": "Configuration",
  "current_url": "Current URL",
  "navigate_to_url": "Navigate to URL",
  "navigate": "Navigate",
  "select_webview": "Select a WebView to inspect",
  "key": "Key",
  "daemon": "Daemon",
  "mode": "Mode",
  "feature_coming_soon": "This feature is coming soon",
  "search_apps": "Search apps...",
  "search_processes": "Search processes...",
  "no_apps_matching_search": "No apps matching your search",
  "no_processes_matching_search": "No processes matching your search",
  "user": "User",
  "hide_panel": "Hide Panel",
  "show_panel": "Show Panel",
  "home": "Home",
  "home_finder_desc": "Browse app home directory and files",
  "home_lsof_desc": "List open file descriptors and sockets",
  "home_infoplist_desc": "View application configuration",
  "home_entitlements_desc": "Inspect app capabilities and permissions",
  "home_cookies_desc": "Browse and edit HTTP cookies",
  "home_keychain_desc": "Access keychain items and secrets",
  "home_userdefaults_desc": "View and modify user preferences",
  "home_ui_desc": "Inspect view hierarchy and elements",
  "home_webview_desc": "Debug embedded web content",
  "home_jsc_desc": "Explore JavaScriptCore contexts",
  "home_nsurl_desc": "Capture NSURLSession network traffic",
  "category_files": "Files & Data",
  "category_security": "Security",
  "category_ui": "UI & Web",
  "category_network": "Network & IPC",
  "session_menu": "Session Menu",
  "reload_page": "Reload Page",
  "kill_process": "Kill Process",
  "process_killed": "Process {{pid}} killed",
  "failed_to_kill_process": "Failed to kill process",
  "detach": "Detach",
  "hook_builtin": "Built-in",
  "hook_user_defined": "User Defined",
  "hook_sqlite": "SQLite",
  "hook_sqlite_desc": "Monitor database operations including open, prepare, execute, and bind statements",
  "hook_pasteboard": "Pasteboard",
  "hook_pasteboard_desc": "Monitor clipboard read/write operations and track which pasteboard is accessed",
  "hook_deviceid": "Random Device ID",
  "hook_deviceid_desc": "Spoof IDFV and IDFA with random UUIDs to prevent device fingerprinting",
  "hook_biometric": "Biometric Bypass",
  "hook_biometric_desc": "Bypass Touch ID and Face ID authentication by forcing success on LAContext",
  "hook_fileops": "File Operations",
  "hook_fileops_desc": "Monitor file system operations: open, create, delete, stat, access, rename, link",
  "hook_clipboard": "Clipboard",
  "hook_clipboard_desc": "Monitor clipboard read and write operations via ClipboardManager",
  "hook_broadcast": "Broadcast Receivers",
  "hook_broadcast_desc": "Monitor broadcast intents sent and received by the application",
  "hook_intent": "Intents",
  "hook_intent_desc": "Monitor intent operations including startActivity, startService, and bindService",
  "hook_sharedpref": "SharedPreferences",
  "hook_sharedpref_desc": "Monitor SharedPreferences read and write operations across all preference files",
  "hook_results": "Hook Results",
  "hook_no_results": "No hook results yet. Enable a hook group to start capturing.",
  "crypto_results": "Crypto",
  "crypto_no_results": "No crypto results yet. Enable crypto hooks to start capturing.",
  "crypto_hash": "Hash",
  "crypto_detail_tab": "Detail",
  "crypto_hexdump_tab": "Hex Dump",
  "crypto_backtrace_tab": "Backtrace",
  "hook_stack_trace": "Stack Trace",
  "hook_direction": "Direction",
  "hook_algorithm": "Algorithm",
  "scroll_to_latest": "Latest",
  "copied": "Copied",
  "items": "items",
  "no_values": "No values",
  "rename": "Rename",
  "time": "Time",
  "imports": "Imports",
  "repl_download": "Download",
  "repl_copy": "Copy",
  "hook_native": "Native",
  "hook_user_no_hooks": "No user-defined hooks",
  "hook_add": "Hook",
  "hook_remove": "Remove",
  "hook_generate_code": "Generate Code",
  "hook_batch_mode": "Batch",
  "hook_selected_count": "{{count}} selected",
  "hook_batch_hook": "Hook Selected",
  "hook_batch_generate": "Generate Code",
  "hook_added": "Hook added",
  "hook_added_count": "{{count}} hooks added",
  "hook_failed": "Failed to add hook",
  "flutter_channels": "Flutter Channels",
  "flutter_channels_desc": "Capture Dart \u2194 native platform channel traffic",
  "flutter_channel": "Channel",
  "flutter_select_event": "Select an event to inspect args/result JSON.",
  "args": "Args",
  "execute": "Execute",
  "rows_returned": "{{count}} rows returned",
  "query_executed_no_results": "Query executed successfully (no results)",
  "select_table_or_execute": "Select a table or execute a query",
  "file_renamed": "File renamed",
  "file_deleted": "File deleted",
  "select_all": "Select All",
  "selected_count": "{{count}} selected",
  "batch_delete": "Delete Selected",
  "batch_delete_confirm": "Are you sure you want to delete {{count}} files?",
  "batch_delete_warning": "This action cannot be undone.",
  "upload": "Upload",
  "upload_files": "Upload Files",
  "components": "Components",
  "activities": "Activities",
  "services": "Services",
  "receivers": "Receivers",
  "providers": "Providers",
  "permission": "Permission",
  "start_activity": "Start Activity",
  "stop_service": "Stop Service",
  "send_broadcast": "Send Broadcast",
  "package_name": "Package Name",
  "sdk_version": "SDK Version",
  "android_version": "Android Version",
  "manufacturer": "Manufacturer",
  "security_patch": "Security Patch",
  "data_dir": "Data Directory",
  "no_components": "No components found",
  "query_provider": "Query",
  "device_info": "Device Info",
  "no_device_info": "No device info available",
  "brand": "Brand",
  "model": "Model",
  "start_service": "Start Service",
  "native_library_dir": "Native Library Dir",
  "public_source_dir": "Public Source Dir",
  "source_dir": "Source Dir",
  "shared_library_files": "Shared Libraries",
  "split_apks": "Split APKs",
  "process_name": "Process Name",
  "target_sdk": "Target SDK",
  "min_sdk": "Min SDK",
  "directories": "Directories",
  "fields": "Fields",
  "return_type": "Return Type",
  "parameters": "Parameters",
  "keystore": "KeyStore",
  "no_keystore_aliases": "No aliases found",
  "key_properties": "Key Properties",
  "key_size": "Key Size",
  "entry_type": "Entry Type",
  "origin": "Origin",
  "purposes": "Purposes",
  "crypto_config": "Cryptographic Config",
  "block_modes": "Block Modes",
  "digests": "Digests",
  "encryption_paddings": "Encryption Paddings",
  "signature_paddings": "Signature Paddings",
  "security_properties": "Security",
  "inside_secure_hardware": "Secure Hardware",
  "user_auth_required": "User Auth Required",
  "auth_validity_seconds": "Auth Validity (seconds)",
  "auth_enforced_by_hardware": "Auth Enforced by Hardware",
  "biometric_invalidation": "Biometric Invalidation",
  "trusted_presence_required": "Trusted Presence Required",
  "user_confirmation_required": "Confirmation Required",
  "auth_valid_on_body": "Valid While On Body",
  "validity": "Validity",
  "validity_start": "Start",
  "validity_origination_end": "Origination End",
  "validity_consumption_end": "Consumption End",
  "home_keystore_desc": "Inspect AndroidKeyStore keys and security properties",
  "home_manifest_desc": "View and inspect AndroidManifest.xml",
  "open_manifest": "Open AndroidManifest.xml",
  "no_url_schemes": "No URL schemes found in this App",
  "content_providers": "Content Providers",
  "no_providers": "No providers found",
  "read_permission": "Read Permission",
  "write_permission": "Write Permission",
  "grant_uri_permissions": "Grant URI Permissions",
  "projection": "Projection",
  "projection_placeholder": "Column names (comma-separated)",
  "selection": "Selection",
  "selection_placeholder": "WHERE clause",
  "selection_args": "Selection Args",
  "selection_args_placeholder": "Values (comma-separated)",
  "sort_order": "Sort Order",
  "sort_order_placeholder": "e.g. name ASC",
  "no_query_results": "No results. Select a provider or enter a URI and click Execute.",
  "home_providers_desc": "Browse and query content providers",
  "home_xpc_desc": "Trace XPC and NSXPC inter-process communication",
  "home_jni_desc": "Trace JNI function calls from native libraries",
  "home_memory_scan_desc": "Scan process memory for patterns and values",
  "category_runtime": "Runtime",
  "memory_scanner": "Memory Scanner",
  "jni_trace": "JNI Trace",
  "dump_decrypted": "Dump Decrypted",
  "dump_decrypted_error": "This module cannot be decrypted, it might be part of system built-in library",

  "severity_high": "High",
  "severity_medium": "Medium",
  "severity_info": "Info",
  "severity_ok": "OK",

  "manifest_security_findings": "Security Findings",
  "manifest_declared_permissions": "Declared Permissions",
  "manifest_declared_permissions_count": "Declared Permissions ({{count}})",
  "manifest_no_permissions_desc": "No permissions declared.",
  "manifest_perm_dangerous": "dangerous",
  "manifest_summary_high": "high",
  "manifest_summary_medium": "medium",
  "manifest_summary_dangerous_perms": "dangerous permissions",
  "manifest_summary_normal_perms": "normal permissions",

  "manifest_debuggable_on_title": "Debuggable flag is ON",
  "manifest_debuggable_on_desc": "android:debuggable=\"true\" lets anyone attach a debugger to the app process on any device. This enables memory inspection, method hooking, and runtime tampering. Must be removed or set to false in production builds.",
  "manifest_debuggable_off_title": "Debuggable flag is OFF",
  "manifest_debuggable_off_desc": "android:debuggable is not enabled. A debugger cannot be attached on non-rooted production devices.",
  "manifest_allowbackup_on_title": "Backup is allowed",
  "manifest_allowbackup_on_default_desc": "android:allowBackup is not set and defaults to true. App data can be extracted via adb backup or Android cloud backup, possibly exposing credentials and tokens. Set to false or define android:fullBackupContent to limit what is backed up.",
  "manifest_allowbackup_on_explicit_desc": "android:allowBackup=\"true\" is explicitly set. App data can be extracted via adb backup or cloud backup, potentially exposing sensitive data.",
  "manifest_allowbackup_off_title": "Backup is disabled",
  "manifest_allowbackup_off_desc": "android:allowBackup=\"false\" prevents cloud and adb backups of app data.",
  "manifest_cleartext_title": "Cleartext HTTP traffic is permitted",
  "manifest_cleartext_desc": "android:usesCleartextTraffic=\"true\" allows the app to send unencrypted HTTP traffic. Data in transit is visible to any network observer. All traffic should use HTTPS.",
  "manifest_nsc_title": "No Network Security Config defined",
  "manifest_nsc_desc": "No android:networkSecurityConfig is specified. The platform default applies: cleartext is blocked on Android 9+. Consider adding a config to pin certificates, restrict trusted CAs, or explicitly allow/block cleartext per domain.",
  "manifest_perms_excessive_title": "{{count}} dangerous permissions declared",
  "manifest_perms_excessive_desc": "The manifest requests {{count}} permissions classified as dangerous by Android. Review each one to confirm it is strictly required for core functionality. Excess permissions increase the attack surface and erode user trust.",
  "manifest_perms_some_title": "{{count}} dangerous permission(s) declared",
  "manifest_perms_some_desc": "The app requests {{count}} dangerous permission(s). Confirm each is required for functionality users would reasonably expect.",
  "manifest_perms_none_title": "No dangerous permissions declared",
  "manifest_perms_none_desc": "{{count}} normal permission(s) declared, none of which require runtime grants.",

  "uidevice_name": "Device Name",
  "uidevice_localized_model": "Localized Model",
  "uidevice_system": "System",
  "uidevice_idiom": "Interface Idiom",
  "uidevice_battery": "Battery",
  "uidevice_idfv": "Identifier For Vendor",
  "uidevice_multitasking": "Multitasking",

  "plist_insights_title": "Insights",
  "home_plist_insights_desc": "Security analysis of ATS, permissions, and encryption",

  "plist_ats_arbitrary_title": "ATS allows arbitrary loads",
  "plist_ats_arbitrary_desc": "NSAllowsArbitraryLoads is set to true, disabling App Transport Security for all network connections. This allows unencrypted HTTP traffic to any server, exposing data to network observers. All traffic should use HTTPS.",
  "plist_ats_arbitrary_off_title": "ATS arbitrary loads disabled",
  "plist_ats_arbitrary_off_desc": "NSAllowsArbitraryLoads is not enabled. App Transport Security enforces HTTPS for all network connections by default.",
  "plist_ats_media_title": "ATS disabled for media loads",
  "plist_ats_media_desc": "NSAllowsArbitraryLoadsForMedia is true. ATS restrictions are disabled for media loaded via AVFoundation, allowing unencrypted media streaming.",
  "plist_ats_webcontent_title": "ATS disabled for web content",
  "plist_ats_webcontent_desc": "NSAllowsArbitraryLoadsInWebContent is true. ATS restrictions are disabled for requests made from web views (WKWebView), allowing unencrypted HTTP content.",
  "plist_ats_local_title": "Local networking allowed",
  "plist_ats_local_desc": "NSAllowsLocalNetworking is true. The app can load resources from local IP addresses and unqualified domains without ATS restrictions.",
  "plist_ats_exceptions_title": "{{count}} ATS exception domain(s)",
  "plist_ats_exceptions_desc": "NSExceptionDomains defines custom ATS rules for the following domains. Review each to confirm exceptions are justified.",
  "plist_ats_default_title": "ATS uses default configuration",
  "plist_ats_default_desc": "No NSAppTransportSecurity dictionary is defined. The platform default applies: all network connections require HTTPS.",

  "plist_encryption_yes_title": "App uses non-exempt encryption",
  "plist_encryption_yes_desc": "ITSAppUsesNonExemptEncryption is true. The app declares use of encryption that may require export compliance documentation.",
  "plist_encryption_no_title": "App does not use non-exempt encryption",
  "plist_encryption_no_desc": "ITSAppUsesNonExemptEncryption is false. The app declares it does not use encryption beyond OS-provided or exempt categories.",
  "plist_encryption_missing_title": "Encryption declaration not set",
  "plist_encryption_missing_desc": "ITSAppUsesNonExemptEncryption is not declared in Info.plist. App Store Connect will prompt for this during submission.",

  "plist_perms_excessive_title": "{{count}} sensitive permissions declared",
  "plist_perms_excessive_desc": "The app requests {{count}} sensitive permissions (camera, location, microphone, contacts, Face ID, health, photos). Review each to confirm it is required for core functionality.",
  "plist_perms_some_title": "{{count}} sensitive permission(s) declared",
  "plist_perms_some_desc": "The app requests {{count}} sensitive permission(s). Confirm each is required for functionality users would reasonably expect.",
  "plist_perms_none_sensitive_title": "No sensitive permissions declared",
  "plist_perms_none_sensitive_desc": "{{count}} permission(s) declared, none classified as sensitive.",

  "plist_summary_sensitive_perms": "sensitive permissions",
  "plist_declared_permissions": "Declared Permissions",
  "plist_declared_permissions_count": "Declared Permissions ({{count}})",
  "plist_no_permissions_desc": "No usage description permissions declared.",
  "plist_perm_sensitive": "sensitive",
  "plist_url_schemes_count": "URL Schemes ({{count}})",

  "perm_desc_CAMERA": "Capture photos and video from the camera",
  "perm_desc_RECORD_AUDIO": "Record audio from the microphone",
  "perm_desc_READ_CONTACTS": "Read the user's contact list",
  "perm_desc_WRITE_CONTACTS": "Add or modify contacts",
  "perm_desc_READ_CALL_LOG": "Read the device's call history",
  "perm_desc_WRITE_CALL_LOG": "Write to the device's call history",
  "perm_desc_PROCESS_OUTGOING_CALLS": "Intercept or redirect outgoing calls",
  "perm_desc_READ_CALENDAR": "Read calendar events and details",
  "perm_desc_WRITE_CALENDAR": "Create or modify calendar events",
  "perm_desc_ACCESS_FINE_LOCATION": "Access precise GPS location",
  "perm_desc_ACCESS_COARSE_LOCATION": "Access approximate network-based location",
  "perm_desc_ACCESS_BACKGROUND_LOCATION": "Access location while the app is in the background",
  "perm_desc_READ_PHONE_STATE": "Read device identifiers and current call state",
  "perm_desc_READ_PHONE_NUMBERS": "Read the device's phone number",
  "perm_desc_CALL_PHONE": "Initiate phone calls without user confirmation",
  "perm_desc_ANSWER_PHONE_CALLS": "Answer incoming calls programmatically",
  "perm_desc_ADD_VOICEMAIL": "Add voicemail entries to the device",
  "perm_desc_USE_SIP": "Make and receive SIP calls",
  "perm_desc_SEND_SMS": "Send SMS messages (may incur charges)",
  "perm_desc_RECEIVE_SMS": "Receive and read incoming SMS messages",
  "perm_desc_READ_SMS": "Read SMS messages stored on the device",
  "perm_desc_RECEIVE_WAP_PUSH": "Receive WAP push messages",
  "perm_desc_RECEIVE_MMS": "Receive MMS messages",
  "perm_desc_BODY_SENSORS": "Access body sensor data such as heart rate",
  "perm_desc_BODY_SENSORS_BACKGROUND": "Access body sensors while in the background",
  "perm_desc_READ_EXTERNAL_STORAGE": "Read files from shared external storage",
  "perm_desc_WRITE_EXTERNAL_STORAGE": "Write files to shared external storage",
  "perm_desc_MANAGE_EXTERNAL_STORAGE": "Broad access to manage all files on external storage",
  "perm_desc_ACCESS_MEDIA_LOCATION": "Read GPS metadata embedded in photos and videos",
  "perm_desc_SYSTEM_ALERT_WINDOW": "Draw overlay windows on top of other apps",
  "perm_desc_REQUEST_INSTALL_PACKAGES": "Install APK packages without user confirmation",
  "perm_desc_GET_ACCOUNTS": "Access the list of accounts registered on the device",
  "perm_desc_BLUETOOTH_SCAN": "Discover nearby Bluetooth devices",
  "perm_desc_BLUETOOTH_CONNECT": "Connect to paired Bluetooth devices",
  "perm_desc_UWB_RANGING": "Perform ultra-wideband ranging with nearby devices",
  "perm_desc_ACTIVITY_RECOGNITION": "Detect physical activities such as walking or cycling",
  "perm_desc_POST_NOTIFICATIONS": "Post notifications to the user",

  "rn_instances": "Instances",
  "rn_not_detected": "React Native runtime not detected.",
  "rn_no_instances": "No instances found.",
  "rn_select_instance": "Select an instance to inspect.",
  "rn_js_bundles": "JavaScript Bundles",
  "rn_no_bundles": "No bundles captured.",
  "rn_js_expression": "JavaScript expression...",
  "clear_all": "Clear all"
}

```

`gui/src/main.tsx`:

```tsx
import { StrictMode } from "react";
import { createRoot } from "react-dom/client";
import { BrowserRouter } from "react-router";
import { QueryClient, QueryClientProvider } from "@tanstack/react-query";
import { Toaster } from "sonner";
import "./index.css";
import App from "./App.tsx";
import { ThemeProvider } from "./components/providers/ThemeProvider";
import { ReplProvider } from "./context/ReplContext";
import "./i18n.ts";

const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      retry: 1,
    },
  },
});

createRoot(document.getElementById("root")!).render(
  <StrictMode>
    <QueryClientProvider client={queryClient}>
      <ThemeProvider defaultTheme="dark" storageKey="vite-ui-theme">
        <ReplProvider>
          <BrowserRouter>
            <App />
            <Toaster />
          </BrowserRouter>
        </ReplProvider>
      </ThemeProvider>
    </QueryClientProvider>
  </StrictMode>,
);

```

`gui/src/types/device.d.ts`:

```ts
export interface DeviceInfo {
  arch: string;
  os: {
    version: string;
    id: string;
    name: string;
  };
  udid: string;
  platform: string;
  name: string;
  access: string;
  interfaces?: Array<{
    type: string;
    address: string;
  }>;
}

```

`gui/tsconfig.app.json`:

```json
{
  "compilerOptions": {
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.app.tsbuildinfo",
    "target": "ES2022",
    "useDefineForClassFields": true,
    "lib": ["ES2022", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "types": ["vite/client"],
    "skipLibCheck": true,

    /* Path aliases */
    "paths": {
      "@/*": ["./src/*"],
      "@agent/*": ["../agent/types/*"],
      "@/common/*": ["../agent/types/common/*"],
      "@/fruity/*": ["../agent/types/fruity/*"],
    },

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "verbatimModuleSyntax": true,
    "moduleDetection": "force",
    "noEmit": true,
    "jsx": "react-jsx",

    /* Linting */
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "erasableSyntaxOnly": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["src"]
}

```

`gui/tsconfig.json`:

```json
{
  "files": [],
  "references": [
    { "path": "./tsconfig.app.json" },
    { "path": "./tsconfig.node.json" },
  ],
  "compilerOptions": {
    "paths": {
      "@/*": ["./src/*"],
    },
  },
}

```

`gui/tsconfig.node.json`:

```json
{
  "compilerOptions": {
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.node.tsbuildinfo",
    "target": "ES2023",
    "lib": ["ES2023"],
    "module": "ESNext",
    "types": ["node"],
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "verbatimModuleSyntax": true,
    "moduleDetection": "force",
    "noEmit": true,

    /* Linting */
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "erasableSyntaxOnly": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["vite.config.ts"]
}

```

`gui/vite.config.ts`:

```ts
import fs from "fs";
import path from "path";

import { defineConfig, type Plugin } from "vite";
import react from "@vitejs/plugin-react";
import tailwindcss from "@tailwindcss/vite";

const api = `http://localhost:${process.env.PORT || 31337}`;

const R2_WASM_PATH = path.join(
  import.meta.dirname,
  "node_modules",
  "@frida",
  "react-use-r2",
  "dist",
  "r2.wasm",
);

const r2WasmPlugin: Plugin = {
  name: "r2-wasm-plugin",
  configureServer(server) {
    server.middlewares.use((req, res, next) => {
      if (req.originalUrl?.endsWith("/r2.wasm")) {
        const data = fs.readFileSync(R2_WASM_PATH);
        res.setHeader("Content-Length", data.length);
        res.setHeader("Content-Type", "application/wasm");
        res.end(data, "binary");
        return;
      }
      next();
    });
  },
};

// https://vite.dev/config/
export default defineConfig({
  server: {
    proxy: {
      "/api": {
        target: api,
        changeOrigin: true,
        secure: false,
      },
      "/socket.io/": {
        target: api,
        changeOrigin: true,
        secure: false,
        ws: true,
      },
    },
  },
  plugins: [react(), tailwindcss(), r2WasmPlugin],
  assetsInclude: "**/*.wasm",
  resolve: {
    alias: {
      "@": path.resolve(__dirname, "./src"),
      "@agent": path.resolve(__dirname, "..", "agent", "types"),
    },
  },
});

```

`package-lock.json`:

```json
{
  "name": "igf",
  "version": "0.20.0",
  "lockfileVersion": 3,
  "requires": true,
  "packages": {
    "": {
      "name": "igf",
      "version": "0.20.0",
      "license": "MIT",
      "dependencies": {
        "@hono/node-server": "^1.19.9",
        "@types/bun": "^1.3.6",
        "drizzle-orm": "^0.45.1",
        "env-paths": "^3.0.0",
        "frida": "^17.6.2",
        "frida-remote-stream": "^6.0.3",
        "frida16": "npm:frida@^16.7.19",
        "hono": "^4.11.6",
        "socket.io": "^4.8.3"
      },
      "bin": {
        "igf": "bin/igf"
      },
      "devDependencies": {
        "@types/node": "^24.10.9",
        "drizzle-kit": "^0.31.9",
        "socket.io-client": "^4.8.3",
        "tsdown": "^0.20.1",
        "typescript": "^5.9.3"
      },
      "engines": {
        "node": ">=22.18.0"
      }
    },
    "node_modules/@babel/generator": {
      "version": "8.0.0-beta.4",
      "resolved": "https://registry.npmjs.org/@babel/generator/-/generator-8.0.0-beta.4.tgz",
      "integrity": "sha512-5xRfRZk6wx1BRu2XnTE8cTh2mx1ixrZ3/vpn7p/RCJpgctL6pexVVHE3eqtwlYvHhPAuOYCAlnsAyXpBdmfh5Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/parser": "^8.0.0-beta.4",
        "@babel/types": "^8.0.0-beta.4",
        "@jridgewell/gen-mapping": "^0.3.12",
        "@jridgewell/trace-mapping": "^0.3.28",
        "@types/jsesc": "^2.5.0",
        "jsesc": "^3.0.2"
      },
      "engines": {
        "node": "^20.19.0 || >=22.12.0"
      }
    },
    "node_modules/@babel/helper-string-parser": {
      "version": "8.0.0-beta.4",
      "resolved": "https://registry.npmjs.org/@babel/helper-string-parser/-/helper-string-parser-8.0.0-beta.4.tgz",
      "integrity": "sha512-FGwbdQ/I2nJXXfyxa7dT0Fr/zPWwgX7m+hNVj0HrIHYJtyLxSQeQY1Kd8QkAYviQJV3OWFlRLuGd5epF03bdQg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": "^20.19.0 || >=22.12.0"
      }
    },
    "node_modules/@babel/helper-validator-identifier": {
      "version": "8.0.0-beta.4",
      "resolved": "https://registry.npmjs.org/@babel/helper-validator-identifier/-/helper-validator-identifier-8.0.0-beta.4.tgz",
      "integrity": "sha512-6t0IaUEzlinbLmsGIvBZIHEJGjuchx+cMj+FbS78zL17tucYervgbwO07V5/CgBenVraontpmyMCTVyqCfxhFQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": "^20.19.0 || >=22.12.0"
      }
    },
    "node_modules/@babel/parser": {
      "version": "8.0.0-beta.4",
      "resolved": "https://registry.npmjs.org/@babel/parser/-/parser-8.0.0-beta.4.tgz",
      "integrity": "sha512-fBcUqUN3eenLyg25QFkOwY1lmV6L0RdG92g6gxyS2CVCY8kHdibkQz1+zV3bLzxcvNnfHoi3i9n5Dci+g93acg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/types": "^8.0.0-beta.4"
      },
      "bin": {
        "parser": "bin/babel-parser.js"
      },
      "engines": {
        "node": "^20.19.0 || >=22.12.0"
      }
    },
    "node_modules/@babel/types": {
      "version": "8.0.0-beta.4",
      "resolved": "https://registry.npmjs.org/@babel/types/-/types-8.0.0-beta.4.tgz",
      "integrity": "sha512-xjk2xqYp25ePzAs0I08hN2lrbUDDQFfCjwq6MIEa8HwHa0WK8NfNtdvtXod8Ku2CbE1iui7qwWojGvjQiyrQeA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-string-parser": "^8.0.0-beta.4",
        "@babel/helper-validator-identifier": "^8.0.0-beta.4"
      },
      "engines": {
        "node": "^20.19.0 || >=22.12.0"
      }
    },
    "node_modules/@drizzle-team/brocli": {
      "version": "0.10.2",
      "resolved": "https://registry.npmjs.org/@drizzle-team/brocli/-/brocli-0.10.2.tgz",
      "integrity": "sha512-z33Il7l5dKjUgGULTqBsQBQwckHh5AbIuxhdsIxDDiZAzBOrZO6q9ogcWC65kU382AfynTfgNumVcNIjuIua6w==",
      "dev": true,
      "license": "Apache-2.0"
    },
    "node_modules/@emnapi/core": {
      "version": "1.8.1",
      "resolved": "https://registry.npmjs.org/@emnapi/core/-/core-1.8.1.tgz",
      "integrity": "sha512-AvT9QFpxK0Zd8J0jopedNm+w/2fIzvtPKPjqyw9jwvBaReTTqPBk9Hixaz7KbjimP+QNz605/XnjFcDAL2pqBg==",
      "dev": true,
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "@emnapi/wasi-threads": "1.1.0",
        "tslib": "^2.4.0"
      }
    },
    "node_modules/@emnapi/runtime": {
      "version": "1.8.1",
      "resolved": "https://registry.npmjs.org/@emnapi/runtime/-/runtime-1.8.1.tgz",
      "integrity": "sha512-mehfKSMWjjNol8659Z8KxEMrdSJDDot5SXMq00dM8BN4o+CLNXQ0xH2V7EchNHV4RmbZLmmPdEaXZc5H2FXmDg==",
      "dev": true,
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "tslib": "^2.4.0"
      }
    },
    "node_modules/@emnapi/wasi-threads": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@emnapi/wasi-threads/-/wasi-threads-1.1.0.tgz",
      "integrity": "sha512-WI0DdZ8xFSbgMjR1sFsKABJ/C5OnRrjT06JXbZKexJGrDuPTzZdDYfFlsgcCXCyf+suG5QU2e/y1Wo2V/OapLQ==",
      "dev": true,
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "tslib": "^2.4.0"
      }
    },
    "node_modules/@esbuild-kit/core-utils": {
      "version": "3.3.2",
      "resolved": "https://registry.npmjs.org/@esbuild-kit/core-utils/-/core-utils-3.3.2.tgz",
      "integrity": "sha512-sPRAnw9CdSsRmEtnsl2WXWdyquogVpB3yZ3dgwJfe8zrOzTsV7cJvmwrKVa+0ma5BoiGJ+BoqkMvawbayKUsqQ==",
      "deprecated": "Merged into tsx: https://tsx.is",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "esbuild": "~0.18.20",
        "source-map-support": "^0.5.21"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/android-arm": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm/-/android-arm-0.18.20.tgz",
      "integrity": "sha512-fyi7TDI/ijKKNZTUJAQqiG5T7YjJXgnzkURqmGj13C6dCqckZBLdl4h7bkhHt/t0WP+zO9/zwroDvANaOqO5Sw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/android-arm64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm64/-/android-arm64-0.18.20.tgz",
      "integrity": "sha512-Nz4rJcchGDtENV0eMKUNa6L12zz2zBDXuhj/Vjh18zGqB44Bi7MBMSXjgunJgjRhCmKOjnPuZp4Mb6OKqtMHLQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/android-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/android-x64/-/android-x64-0.18.20.tgz",
      "integrity": "sha512-8GDdlePJA8D6zlZYJV/jnrRAi6rOiNaCC/JclcXpB+KIuvfBN4owLtgzY2bsxnx666XjJx2kDPUmnTtR8qKQUg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/darwin-arm64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-arm64/-/darwin-arm64-0.18.20.tgz",
      "integrity": "sha512-bxRHW5kHU38zS2lPTPOyuyTm+S+eobPUnTNkdJEfAddYgEcll4xkT8DB9d2008DtTbl7uJag2HuE5NZAZgnNEA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/darwin-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-x64/-/darwin-x64-0.18.20.tgz",
      "integrity": "sha512-pc5gxlMDxzm513qPGbCbDukOdsGtKhfxD1zJKXjCCcU7ju50O7MeAZ8c4krSJcOIJGFR+qx21yMMVYwiQvyTyQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/freebsd-arm64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-arm64/-/freebsd-arm64-0.18.20.tgz",
      "integrity": "sha512-yqDQHy4QHevpMAaxhhIwYPMv1NECwOvIpGCZkECn8w2WFHXjEwrBn3CeNIYsibZ/iZEUemj++M26W3cNR5h+Tw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/freebsd-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-x64/-/freebsd-x64-0.18.20.tgz",
      "integrity": "sha512-tgWRPPuQsd3RmBZwarGVHZQvtzfEBOreNuxEMKFcd5DaDn2PbBxfwLcj4+aenoh7ctXcbXmOQIn8HI6mCSw5MQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/linux-arm": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm/-/linux-arm-0.18.20.tgz",
      "integrity": "sha512-/5bHkMWnq1EgKr1V+Ybz3s1hWXok7mDFUMQ4cG10AfW3wL02PSZi5kFpYKrptDsgb2WAJIvRcDm+qIvXf/apvg==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/linux-arm64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm64/-/linux-arm64-0.18.20.tgz",
      "integrity": "sha512-2YbscF+UL7SQAVIpnWvYwM+3LskyDmPhe31pE7/aoTMFKKzIc9lLbyGUpmmb8a8AixOL61sQ/mFh3jEjHYFvdA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/linux-ia32": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ia32/-/linux-ia32-0.18.20.tgz",
      "integrity": "sha512-P4etWwq6IsReT0E1KHU40bOnzMHoH73aXp96Fs8TIT6z9Hu8G6+0SHSw9i2isWrD2nbx2qo5yUqACgdfVGx7TA==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/linux-loong64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-loong64/-/linux-loong64-0.18.20.tgz",
      "integrity": "sha512-nXW8nqBTrOpDLPgPY9uV+/1DjxoQ7DoB2N8eocyq8I9XuqJ7BiAMDMf9n1xZM9TgW0J8zrquIb/A7s3BJv7rjg==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/linux-mips64el": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-mips64el/-/linux-mips64el-0.18.20.tgz",
      "integrity": "sha512-d5NeaXZcHp8PzYy5VnXV3VSd2D328Zb+9dEq5HE6bw6+N86JVPExrA6O68OPwobntbNJ0pzCpUFZTo3w0GyetQ==",
      "cpu": [
        "mips64el"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/linux-ppc64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ppc64/-/linux-ppc64-0.18.20.tgz",
      "integrity": "sha512-WHPyeScRNcmANnLQkq6AfyXRFr5D6N2sKgkFo2FqguP44Nw2eyDlbTdZwd9GYk98DZG9QItIiTlFLHJHjxP3FA==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/linux-riscv64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-riscv64/-/linux-riscv64-0.18.20.tgz",
      "integrity": "sha512-WSxo6h5ecI5XH34KC7w5veNnKkju3zBRLEQNY7mv5mtBmrP/MjNBCAlsM2u5hDBlS3NGcTQpoBvRzqBcRtpq1A==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/linux-s390x": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-s390x/-/linux-s390x-0.18.20.tgz",
      "integrity": "sha512-+8231GMs3mAEth6Ja1iK0a1sQ3ohfcpzpRLH8uuc5/KVDFneH6jtAJLFGafpzpMRO6DzJ6AvXKze9LfFMrIHVQ==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/linux-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-x64/-/linux-x64-0.18.20.tgz",
      "integrity": "sha512-UYqiqemphJcNsFEskc73jQ7B9jgwjWrSayxawS6UVFZGWrAAtkzjxSqnoclCXxWtfwLdzU+vTpcNYhpn43uP1w==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/netbsd-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-x64/-/netbsd-x64-0.18.20.tgz",
      "integrity": "sha512-iO1c++VP6xUBUmltHZoMtCUdPlnPGdBom6IrO4gyKPFFVBKioIImVooR5I83nTew5UOYrk3gIJhbZh8X44y06A==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "netbsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/openbsd-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-x64/-/openbsd-x64-0.18.20.tgz",
      "integrity": "sha512-e5e4YSsuQfX4cxcygw/UCPIEP6wbIL+se3sxPdCiMbFLBWu0eiZOJ7WoD+ptCLrmjZBK1Wk7I6D/I3NglUGOxg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openbsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/sunos-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/sunos-x64/-/sunos-x64-0.18.20.tgz",
      "integrity": "sha512-kDbFRFp0YpTQVVrqUd5FTYmWo45zGaXe0X8E1G/LKFC0v8x0vWrhOWSLITcCn63lmZIxfOMXtCfti/RxN/0wnQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "sunos"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/win32-arm64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-arm64/-/win32-arm64-0.18.20.tgz",
      "integrity": "sha512-ddYFR6ItYgoaq4v4JmQQaAI5s7npztfV4Ag6NrhiaW0RrnOXqBkgwZLofVTlq1daVTQNhtI5oieTvkRPfZrePg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/win32-ia32": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-ia32/-/win32-ia32-0.18.20.tgz",
      "integrity": "sha512-Wv7QBi3ID/rROT08SABTS7eV4hX26sVduqDOTe1MvGMjNd3EjOz4b7zeexIR62GTIEKrfJXKL9LFxTYgkyeu7g==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/@esbuild/win32-x64": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-x64/-/win32-x64-0.18.20.tgz",
      "integrity": "sha512-kTdfRcSiDfQca/y9QIkng02avJ+NCaQvrMejlsB3RRv5sE9rRoeBPISaZpKxHELzRxZyLvNts1P27W3wV+8geQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild-kit/core-utils/node_modules/esbuild": {
      "version": "0.18.20",
      "resolved": "https://registry.npmjs.org/esbuild/-/esbuild-0.18.20.tgz",
      "integrity": "sha512-ceqxoedUrcayh7Y7ZX6NdbbDzGROiyVBgC4PriJThBKSVPWnnFHZAkfI1lJT8QFkOwH4qOS2SJkS4wvpGl8BpA==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "bin": {
        "esbuild": "bin/esbuild"
      },
      "engines": {
        "node": ">=12"
      },
      "optionalDependencies": {
        "@esbuild/android-arm": "0.18.20",
        "@esbuild/android-arm64": "0.18.20",
        "@esbuild/android-x64": "0.18.20",
        "@esbuild/darwin-arm64": "0.18.20",
        "@esbuild/darwin-x64": "0.18.20",
        "@esbuild/freebsd-arm64": "0.18.20",
        "@esbuild/freebsd-x64": "0.18.20",
        "@esbuild/linux-arm": "0.18.20",
        "@esbuild/linux-arm64": "0.18.20",
        "@esbuild/linux-ia32": "0.18.20",
        "@esbuild/linux-loong64": "0.18.20",
        "@esbuild/linux-mips64el": "0.18.20",
        "@esbuild/linux-ppc64": "0.18.20",
        "@esbuild/linux-riscv64": "0.18.20",
        "@esbuild/linux-s390x": "0.18.20",
        "@esbuild/linux-x64": "0.18.20",
        "@esbuild/netbsd-x64": "0.18.20",
        "@esbuild/openbsd-x64": "0.18.20",
        "@esbuild/sunos-x64": "0.18.20",
        "@esbuild/win32-arm64": "0.18.20",
        "@esbuild/win32-ia32": "0.18.20",
        "@esbuild/win32-x64": "0.18.20"
      }
    },
    "node_modules/@esbuild-kit/esm-loader": {
      "version": "2.6.5",
      "resolved": "https://registry.npmjs.org/@esbuild-kit/esm-loader/-/esm-loader-2.6.5.tgz",
      "integrity": "sha512-FxEMIkJKnodyA1OaCUoEvbYRkoZlLZ4d/eXFu9Fh8CbBBgP5EmZxrfTRyN0qpXZ4vOvqnE5YdRdcrmUUXuU+dA==",
      "deprecated": "Merged into tsx: https://tsx.is",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@esbuild-kit/core-utils": "^3.3.2",
        "get-tsconfig": "^4.7.0"
      }
    },
    "node_modules/@esbuild/aix-ppc64": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/aix-ppc64/-/aix-ppc64-0.25.12.tgz",
      "integrity": "sha512-Hhmwd6CInZ3dwpuGTF8fJG6yoWmsToE+vYgD4nytZVxcu1ulHpUQRAB1UJ8+N1Am3Mz4+xOByoQoSZf4D+CpkA==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "aix"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/android-arm": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm/-/android-arm-0.25.12.tgz",
      "integrity": "sha512-VJ+sKvNA/GE7Ccacc9Cha7bpS8nyzVv0jdVgwNDaR4gDMC/2TTRc33Ip8qrNYUcpkOHUT5OZ0bUcNNVZQ9RLlg==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/android-arm64": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm64/-/android-arm64-0.25.12.tgz",
      "integrity": "sha512-6AAmLG7zwD1Z159jCKPvAxZd4y/VTO0VkprYy+3N2FtJ8+BQWFXU+OxARIwA46c5tdD9SsKGZ/1ocqBS/gAKHg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/android-x64": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/android-x64/-/android-x64-0.25.12.tgz",
      "integrity": "sha512-5jbb+2hhDHx5phYR2By8GTWEzn6I9UqR11Kwf22iKbNpYrsmRB18aX/9ivc5cabcUiAT/wM+YIZ6SG9QO6a8kg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/darwin-arm64": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-arm64/-/darwin-arm64-0.25.12.tgz",
      "integrity": "sha512-N3zl+lxHCifgIlcMUP5016ESkeQjLj/959RxxNYIthIg+CQHInujFuXeWbWMgnTo4cp5XVHqFPmpyu9J65C1Yg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/darwin-x64": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-x64/-/darwin-x64-0.25.12.tgz",
      "integrity": "sha512-HQ9ka4Kx21qHXwtlTUVbKJOAnmG1ipXhdWTmNXiPzPfWKpXqASVcWdnf2bnL73wgjNrFXAa3yYvBSd9pzfEIpA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/freebsd-arm64": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-arm64/-/freebsd-arm64-0.25.12.tgz",
      "integrity": "sha512-gA0Bx759+7Jve03K1S0vkOu5Lg/85dou3EseOGUes8flVOGxbhDDh/iZaoek11Y8mtyKPGF3vP8XhnkDEAmzeg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/freebsd-x64": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-x64/-/freebsd-x64-0.25.12.tgz",
      "integrity": "sha512-TGbO26Yw2xsHzxtbVFGEXBFH0FRAP7gtcPE7P5yP7wGy7cXK2oO7RyOhL5NLiqTlBh47XhmIUXuGciXEqYFfBQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-arm": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm/-/linux-arm-0.25.12.tgz",
      "integrity": "sha512-lPDGyC1JPDou8kGcywY0YILzWlhhnRjdof3UlcoqYmS9El818LLfJJc3PXXgZHrHCAKs/Z2SeZtDJr5MrkxtOw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-arm64": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm64/-/linux-arm64-0.25.12.tgz",
      "integrity": "sha512-8bwX7a8FghIgrupcxb4aUmYDLp8pX06rGh5HqDT7bB+8Rdells6mHvrFHHW2JAOPZUbnjUpKTLg6ECyzvas2AQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-ia32": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ia32/-/linux-ia32-0.25.12.tgz",
      "integrity": "sha512-0y9KrdVnbMM2/vG8KfU0byhUN+EFCny9+8g202gYqSSVMonbsCfLjUO+rCci7pM0WBEtz+oK/PIwHkzxkyharA==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-loong64": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-loong64/-/linux-loong64-0.25.12.tgz",
      "integrity": "sha512-h///Lr5a9rib/v1GGqXVGzjL4TMvVTv+s1DPoxQdz7l/AYv6LDSxdIwzxkrPW438oUXiDtwM10o9PmwS/6Z0Ng==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-mips64el": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-mips64el/-/linux-mips64el-0.25.12.tgz",
      "integrity": "sha512-iyRrM1Pzy9GFMDLsXn1iHUm18nhKnNMWscjmp4+hpafcZjrr2WbT//d20xaGljXDBYHqRcl8HnxbX6uaA/eGVw==",
      "cpu": [
        "mips64el"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-ppc64": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ppc64/-/linux-ppc64-0.25.12.tgz",
      "integrity": "sha512-9meM/lRXxMi5PSUqEXRCtVjEZBGwB7P/D4yT8UG/mwIdze2aV4Vo6U5gD3+RsoHXKkHCfSxZKzmDssVlRj1QQA==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-riscv64": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-riscv64/-/linux-riscv64-0.25.12.tgz",
      "integrity": "sha512-Zr7KR4hgKUpWAwb1f3o5ygT04MzqVrGEGXGLnj15YQDJErYu/BGg+wmFlIDOdJp0PmB0lLvxFIOXZgFRrdjR0w==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-s390x": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-s390x/-/linux-s390x-0.25.12.tgz",
      "integrity": "sha512-MsKncOcgTNvdtiISc/jZs/Zf8d0cl/t3gYWX8J9ubBnVOwlk65UIEEvgBORTiljloIWnBzLs4qhzPkJcitIzIg==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/linux-x64": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-x64/-/linux-x64-0.25.12.tgz",
      "integrity": "sha512-uqZMTLr/zR/ed4jIGnwSLkaHmPjOjJvnm6TVVitAa08SLS9Z0VM8wIRx7gWbJB5/J54YuIMInDquWyYvQLZkgw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/netbsd-arm64": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-arm64/-/netbsd-arm64-0.25.12.tgz",
      "integrity": "sha512-xXwcTq4GhRM7J9A8Gv5boanHhRa/Q9KLVmcyXHCTaM4wKfIpWkdXiMog/KsnxzJ0A1+nD+zoecuzqPmCRyBGjg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "netbsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/netbsd-x64": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-x64/-/netbsd-x64-0.25.12.tgz",
      "integrity": "sha512-Ld5pTlzPy3YwGec4OuHh1aCVCRvOXdH8DgRjfDy/oumVovmuSzWfnSJg+VtakB9Cm0gxNO9BzWkj6mtO1FMXkQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "netbsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/openbsd-arm64": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-arm64/-/openbsd-arm64-0.25.12.tgz",
      "integrity": "sha512-fF96T6KsBo/pkQI950FARU9apGNTSlZGsv1jZBAlcLL1MLjLNIWPBkj5NlSz8aAzYKg+eNqknrUJ24QBybeR5A==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openbsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/openbsd-x64": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-x64/-/openbsd-x64-0.25.12.tgz",
      "integrity": "sha512-MZyXUkZHjQxUvzK7rN8DJ3SRmrVrke8ZyRusHlP+kuwqTcfWLyqMOE3sScPPyeIXN/mDJIfGXvcMqCgYKekoQw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openbsd"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/openharmony-arm64": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/openharmony-arm64/-/openharmony-arm64-0.25.12.tgz",
      "integrity": "sha512-rm0YWsqUSRrjncSXGA7Zv78Nbnw4XL6/dzr20cyrQf7ZmRcsovpcRBdhD43Nuk3y7XIoW2OxMVvwuRvk9XdASg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openharmony"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/sunos-x64": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/sunos-x64/-/sunos-x64-0.25.12.tgz",
      "integrity": "sha512-3wGSCDyuTHQUzt0nV7bocDy72r2lI33QL3gkDNGkod22EsYl04sMf0qLb8luNKTOmgF/eDEDP5BFNwoBKH441w==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "sunos"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/win32-arm64": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-arm64/-/win32-arm64-0.25.12.tgz",
      "integrity": "sha512-rMmLrur64A7+DKlnSuwqUdRKyd3UE7oPJZmnljqEptesKM8wx9J8gx5u0+9Pq0fQQW8vqeKebwNXdfOyP+8Bsg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/win32-ia32": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-ia32/-/win32-ia32-0.25.12.tgz",
      "integrity": "sha512-HkqnmmBoCbCwxUKKNPBixiWDGCpQGVsrQfJoVGYLPT41XWF8lHuE5N6WhVia2n4o5QK5M4tYr21827fNhi4byQ==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@esbuild/win32-x64": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-x64/-/win32-x64-0.25.12.tgz",
      "integrity": "sha512-alJC0uCZpTFrSL0CCDjcgleBXPnCrEAhTBILpeAp7M/OFgoqtAetfBzX0xM00MUsVVPpVjlPuMbREqnZCXaTnA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/@hono/node-server": {
      "version": "1.19.9",
      "resolved": "https://registry.npmjs.org/@hono/node-server/-/node-server-1.19.9.tgz",
      "integrity": "sha512-vHL6w3ecZsky+8P5MD+eFfaGTyCeOHUIFYMGpQGbrBTSmNNoxv0if69rEZ5giu36weC5saFuznL411gRX7bJDw==",
      "license": "MIT",
      "engines": {
        "node": ">=18.14.1"
      },
      "peerDependencies": {
        "hono": "^4"
      }
    },
    "node_modules/@isaacs/balanced-match": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/@isaacs/balanced-match/-/balanced-match-4.0.1.tgz",
      "integrity": "sha512-yzMTt9lEb8Gv7zRioUilSglI0c0smZ9k5D65677DLWLtWJaXIS3CqcGyUFByYKlnUj6TkjLVs54fBl6+TiGQDQ==",
      "license": "MIT",
      "engines": {
        "node": "20 || >=22"
      }
    },
    "node_modules/@isaacs/brace-expansion": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/@isaacs/brace-expansion/-/brace-expansion-5.0.0.tgz",
      "integrity": "sha512-ZT55BDLV0yv0RBm2czMiZ+SqCGO7AvmOM3G/w2xhVPH+te0aKgFjmBvGlL1dH+ql2tgGO3MVrbb3jCKyvpgnxA==",
      "license": "MIT",
      "dependencies": {
        "@isaacs/balanced-match": "^4.0.1"
      },
      "engines": {
        "node": "20 || >=22"
      }
    },
    "node_modules/@jridgewell/gen-mapping": {
      "version": "0.3.13",
      "resolved": "https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.13.tgz",
      "integrity": "sha512-2kkt/7niJ6MgEPxF0bYdQ6etZaA+fQvDcLKckhy1yIQOzaoKjBBjSj63/aLVjYE3qhRt5dvM+uUyfCg6UKCBbA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/sourcemap-codec": "^1.5.0",
        "@jridgewell/trace-mapping": "^0.3.24"
      }
    },
    "node_modules/@jridgewell/resolve-uri": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz",
      "integrity": "sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@jridgewell/sourcemap-codec": {
      "version": "1.5.5",
      "resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.5.5.tgz",
      "integrity": "sha512-cYQ9310grqxueWbl+WuIUIaiUaDcj7WOq5fVhEljNVgRfOUhY9fy2zTvfoqWsnebh8Sl70VScFbICvJnLKB0Og==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@jridgewell/trace-mapping": {
      "version": "0.3.31",
      "resolved": "https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.31.tgz",
      "integrity": "sha512-zzNR+SdQSDJzc8joaeP8QQoCQr8NuYx2dIIytl1QeBEZHJ9uW6hebsrYgbz8hJwUQao3TWCMtmfV8Nu1twOLAw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/resolve-uri": "^3.1.0",
        "@jridgewell/sourcemap-codec": "^1.4.14"
      }
    },
    "node_modules/@napi-rs/wasm-runtime": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/@napi-rs/wasm-runtime/-/wasm-runtime-1.1.1.tgz",
      "integrity": "sha512-p64ah1M1ld8xjWv3qbvFwHiFVWrq1yFvV4f7w+mzaqiR4IlSgkqhcRdHwsGgomwzBH51sRY4NEowLxnaBjcW/A==",
      "dev": true,
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "@emnapi/core": "^1.7.1",
        "@emnapi/runtime": "^1.7.1",
        "@tybys/wasm-util": "^0.10.1"
      },
      "funding": {
        "type": "github",
        "url": "https://github.com/sponsors/Brooooooklyn"
      }
    },
    "node_modules/@oxc-project/types": {
      "version": "0.110.0",
      "resolved": "https://registry.npmjs.org/@oxc-project/types/-/types-0.110.0.tgz",
      "integrity": "sha512-6Ct21OIlrEnFEJk5LT4e63pk3btsI6/TusD/GStLi7wYlGJNOl1GI9qvXAnRAxQU9zqA2Oz+UwhfTOU2rPZVow==",
      "dev": true,
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/Boshen"
      }
    },
    "node_modules/@quansync/fs": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/@quansync/fs/-/fs-1.0.0.tgz",
      "integrity": "sha512-4TJ3DFtlf1L5LDMaM6CanJ/0lckGNtJcMjQ1NAV6zDmA0tEHKZtxNKin8EgPaVX1YzljbxckyT2tJrpQKAtngQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "quansync": "^1.0.0"
      },
      "funding": {
        "url": "https://github.com/sponsors/sxzz"
      }
    },
    "node_modules/@rolldown/binding-android-arm64": {
      "version": "1.0.0-rc.1",
      "resolved": "https://registry.npmjs.org/@rolldown/binding-android-arm64/-/binding-android-arm64-1.0.0-rc.1.tgz",
      "integrity": "sha512-He6ZoCfv5D7dlRbrhNBkuMVIHd0GDnjJwbICE1OWpG7G3S2gmJ+eXkcNLJjzjNDpeI2aRy56ou39AJM9AD8YFA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": "^20.19.0 || >=22.12.0"
      }
    },
    "node_modules/@rolldown/binding-darwin-arm64": {
      "version": "1.0.0-rc.1",
      "resolved": "https://registry.npmjs.org/@rolldown/binding-darwin-arm64/-/binding-darwin-arm64-1.0.0-rc.1.tgz",
      "integrity": "sha512-YzJdn08kSOXnj85ghHauH2iHpOJ6eSmstdRTLyaziDcUxe9SyQJgGyx/5jDIhDvtOcNvMm2Ju7m19+S/Rm1jFg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": "^20.19.0 || >=22.12.0"
      }
    },
    "node_modules/@rolldown/binding-darwin-x64": {
      "version": "1.0.0-rc.1",
      "resolved": "https://registry.npmjs.org/@rolldown/binding-darwin-x64/-/binding-darwin-x64-1.0.0-rc.1.tgz",
      "integrity": "sha512-cIvAbqM+ZVV6lBSKSBtlNqH5iCiW933t1q8j0H66B3sjbe8AxIRetVqfGgcHcJtMzBIkIALlL9fcDrElWLJQcQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": "^20.19.0 || >=22.12.0"
      }
    },
    "node_modules/@rolldown/binding-freebsd-x64": {
      "version": "1.0.0-rc.1",
      "resolved": "https://registry.npmjs.org/@rolldown/binding-freebsd-x64/-/binding-freebsd-x64-1.0.0-rc.1.tgz",
      "integrity": "sha512-rVt+B1B/qmKwCl1XD02wKfgh3vQPXRXdB/TicV2w6g7RVAM1+cZcpigwhLarqiVCxDObFZ7UgXCxPC7tpDoRog==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": "^20.19.0 || >=22.12.0"
      }
    },
    "node_modules/@rolldown/binding-linux-arm-gnueabihf": {
      "version": "1.0.0-rc.1",
      "resolved": "https://registry.npmjs.org/@rolldown/binding-linux-arm-gnueabihf/-/binding-linux-arm-gnueabihf-1.0.0-rc.1.tgz",
      "integrity": "sha512-69YKwJJBOFprQa1GktPgbuBOfnn+EGxu8sBJ1TjPER+zhSpYeaU4N07uqmyBiksOLGXsMegymuecLobfz03h8Q==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^20.19.0 || >=22.12.0"
      }
    },
    "node_modules/@rolldown/binding-linux-arm64-gnu": {
      "version": "1.0.0-rc.1",
      "resolved": "https://registry.npmjs.org/@rolldown/binding-linux-arm64-gnu/-/binding-linux-arm64-gnu-1.0.0-rc.1.tgz",
      "integrity": "sha512-9JDhHUf3WcLfnViFWm+TyorqUtnSAHaCzlSNmMOq824prVuuzDOK91K0Hl8DUcEb9M5x2O+d2/jmBMsetRIn3g==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^20.19.0 || >=22.12.0"
      }
    },
    "node_modules/@rolldown/binding-linux-arm64-musl": {
      "version": "1.0.0-rc.1",
      "resolved": "https://registry.npmjs.org/@rolldown/binding-linux-arm64-musl/-/binding-linux-arm64-musl-1.0.0-rc.1.tgz",
      "integrity": "sha512-UvApLEGholmxw/HIwmUnLq3CwdydbhaHHllvWiCTNbyGom7wTwOtz5OAQbAKZYyiEOeIXZNPkM7nA4Dtng7CLw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^20.19.0 || >=22.12.0"
      }
    },
    "node_modules/@rolldown/binding-linux-x64-gnu": {
      "version": "1.0.0-rc.1",
      "resolved": "https://registry.npmjs.org/@rolldown/binding-linux-x64-gnu/-/binding-linux-x64-gnu-1.0.0-rc.1.tgz",
      "integrity": "sha512-uVctNgZHiGnJx5Fij7wHLhgw4uyZBVi6mykeWKOqE7bVy9Hcxn0fM/IuqdMwk6hXlaf9fFShDTFz2+YejP+x0A==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^20.19.0 || >=22.12.0"
      }
    },
    "node_modules/@rolldown/binding-linux-x64-musl": {
      "version": "1.0.0-rc.1",
      "resolved": "https://registry.npmjs.org/@rolldown/binding-linux-x64-musl/-/binding-linux-x64-musl-1.0.0-rc.1.tgz",
      "integrity": "sha512-T6Eg0xWwcxd/MzBcuv4Z37YVbUbJxy5cMNnbIt/Yr99wFwli30O4BPlY8hKeGyn6lWNtU0QioBS46lVzDN38bg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": "^20.19.0 || >=22.12.0"
      }
    },
    "node_modules/@rolldown/binding-openharmony-arm64": {
      "version": "1.0.0-rc.1",
      "resolved": "https://registry.npmjs.org/@rolldown/binding-openharmony-arm64/-/binding-openharmony-arm64-1.0.0-rc.1.tgz",
      "integrity": "sha512-PuGZVS2xNJyLADeh2F04b+Cz4NwvpglbtWACgrDOa5YDTEHKwmiTDjoD5eZ9/ptXtcpeFrMqD2H4Zn33KAh1Eg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openharmony"
      ],
      "engines": {
        "node": "^20.19.0 || >=22.12.0"
      }
    },
    "node_modules/@rolldown/binding-wasm32-wasi": {
      "version": "1.0.0-rc.1",
      "resolved": "https://registry.npmjs.org/@rolldown/binding-wasm32-wasi/-/binding-wasm32-wasi-1.0.0-rc.1.tgz",
      "integrity": "sha512-2mOxY562ihHlz9lEXuaGEIDCZ1vI+zyFdtsoa3M62xsEunDXQE+DVPO4S4x5MPK9tKulG/aFcA/IH5eVN257Cw==",
      "cpu": [
        "wasm32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "@napi-rs/wasm-runtime": "^1.1.1"
      },
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/@rolldown/binding-win32-arm64-msvc": {
      "version": "1.0.0-rc.1",
      "resolved": "https://registry.npmjs.org/@rolldown/binding-win32-arm64-msvc/-/binding-win32-arm64-msvc-1.0.0-rc.1.tgz",
      "integrity": "sha512-oQVOP5cfAWZwRD0Q3nGn/cA9FW3KhMMuQ0NIndALAe6obqjLhqYVYDiGGRGrxvnjJsVbpLwR14gIUYnpIcHR1g==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": "^20.19.0 || >=22.12.0"
      }
    },
    "node_modules/@rolldown/binding-win32-x64-msvc": {
      "version": "1.0.0-rc.1",
      "resolved": "https://registry.npmjs.org/@rolldown/binding-win32-x64-msvc/-/binding-win32-x64-msvc-1.0.0-rc.1.tgz",
      "integrity": "sha512-Ydsxxx++FNOuov3wCBPaYjZrEvKOOGq3k+BF4BPridhg2pENfitSRD2TEuQ8i33bp5VptuNdC9IzxRKU031z5A==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": "^20.19.0 || >=22.12.0"
      }
    },
    "node_modules/@rolldown/pluginutils": {
      "version": "1.0.0-rc.1",
      "resolved": "https://registry.npmjs.org/@rolldown/pluginutils/-/pluginutils-1.0.0-rc.1.tgz",
      "integrity": "sha512-UTBjtTxVOhodhzFVp/ayITaTETRHPUPYZPXQe0WU0wOgxghMojXxYjOiPOauKIYNWJAWS2fd7gJgGQK8GU8vDA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@socket.io/component-emitter": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/@socket.io/component-emitter/-/component-emitter-3.1.2.tgz",
      "integrity": "sha512-9BCxFwvbGg/RsZK9tjXd8s4UcwR0MWeFQ1XEKIQVVvAGJyINdrqKMcTRyLoK8Rse1GjzLV9cwjWV1olXRWEXVA==",
      "license": "MIT"
    },
    "node_modules/@tybys/wasm-util": {
      "version": "0.10.1",
      "resolved": "https://registry.npmjs.org/@tybys/wasm-util/-/wasm-util-0.10.1.tgz",
      "integrity": "sha512-9tTaPJLSiejZKx+Bmog4uSubteqTvFrVrURwkmHixBo0G4seD0zUxp98E1DzUBJxLQ3NPwXrGKDiVjwx/DpPsg==",
      "dev": true,
      "license": "MIT",
      "optional": true,
      "dependencies": {
        "tslib": "^2.4.0"
      }
    },
    "node_modules/@types/bun": {
      "version": "1.3.6",
      "resolved": "https://registry.npmjs.org/@types/bun/-/bun-1.3.6.tgz",
      "integrity": "sha512-uWCv6FO/8LcpREhenN1d1b6fcspAB+cefwD7uti8C8VffIv0Um08TKMn98FynpTiU38+y2dUO55T11NgDt8VAA==",
      "license": "MIT",
      "dependencies": {
        "bun-types": "1.3.6"
      }
    },
    "node_modules/@types/cors": {
      "version": "2.8.19",
      "resolved": "https://registry.npmjs.org/@types/cors/-/cors-2.8.19.tgz",
      "integrity": "sha512-mFNylyeyqN93lfe/9CSxOGREz8cpzAhH+E93xJ4xWQf62V8sQ/24reV2nyzUWM6H6Xji+GGHpkbLe7pVoUEskg==",
      "license": "MIT",
      "dependencies": {
        "@types/node": "*"
      }
    },
    "node_modules/@types/estree": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/@types/estree/-/estree-1.0.8.tgz",
      "integrity": "sha512-dWHzHa2WqEXI/O1E9OjrocMTKJl2mSrEolh1Iomrv6U+JuNwaHXsXx9bLu5gG7BUWFIN0skIQJQ/L1rIex4X6w==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@types/jsesc": {
      "version": "2.5.1",
      "resolved": "https://registry.npmjs.org/@types/jsesc/-/jsesc-2.5.1.tgz",
      "integrity": "sha512-9VN+6yxLOPLOav+7PwjZbxiID2bVaeq0ED4qSQmdQTdjnXJSaCVKTR58t15oqH1H5t8Ng2ZX1SabJVoN9Q34bw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@types/node": {
      "version": "24.10.9",
      "resolved": "https://registry.npmjs.org/@types/node/-/node-24.10.9.tgz",
      "integrity": "sha512-ne4A0IpG3+2ETuREInjPNhUGis1SFjv1d5asp8MzEAGtOZeTeHVDOYqOgqfhvseqg/iXty2hjBf1zAOb7RNiNw==",
      "license": "MIT",
      "dependencies": {
        "undici-types": "~7.16.0"
      }
    },
    "node_modules/accepts": {
      "version": "1.3.8",
      "resolved": "https://registry.npmjs.org/accepts/-/accepts-1.3.8.tgz",
      "integrity": "sha512-PYAthTa2m2VKxuvSD3DPC/Gy+U+sOA1LAuT8mkmRuvw+NACSaeXEQ+NHcVF7rONl6qcaxV3Uuemwawk+7+SJLw==",
      "license": "MIT",
      "dependencies": {
        "mime-types": "~2.1.34",
        "negotiator": "0.6.3"
      },
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/ansis": {
      "version": "4.2.0",
      "resolved": "https://registry.npmjs.org/ansis/-/ansis-4.2.0.tgz",
      "integrity": "sha512-HqZ5rWlFjGiV0tDm3UxxgNRqsOTniqoKZu0pIAfh7TZQMGuZK+hH0drySty0si0QXj1ieop4+SkSfPZBPPkHig==",
      "dev": true,
      "license": "ISC",
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/ast-kit": {
      "version": "3.0.0-beta.1",
      "resolved": "https://registry.npmjs.org/ast-kit/-/ast-kit-3.0.0-beta.1.tgz",
      "integrity": "sha512-trmleAnZ2PxN/loHWVhhx1qeOHSRXq4TDsBBxq3GqeJitfk3+jTQ+v/C1km/KYq9M7wKqCewMh+/NAvVH7m+bw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/parser": "^8.0.0-beta.4",
        "estree-walker": "^3.0.3",
        "pathe": "^2.0.3"
      },
      "engines": {
        "node": ">=20.19.0"
      },
      "funding": {
        "url": "https://github.com/sponsors/sxzz"
      }
    },
    "node_modules/base64-js": {
      "version": "1.5.1",
      "resolved": "https://registry.npmjs.org/base64-js/-/base64-js-1.5.1.tgz",
      "integrity": "sha512-AKpaYlHn8t4SVbOHCy+b5+KKgvR4vrsD8vbvrbiQJps7fKDTkjkDry6ji0rUJjC0kzbNePLwzxq8iypo41qeWA==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT"
    },
    "node_modules/base64id": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/base64id/-/base64id-2.0.0.tgz",
      "integrity": "sha512-lGe34o6EHj9y3Kts9R4ZYs/Gr+6N7MCaMlIFA3F1R2O5/m7K06AxfSeO5530PEERE6/WyEg3lsuyw4GHlPZHog==",
      "license": "MIT",
      "engines": {
        "node": "^4.5.0 || >= 5.9"
      }
    },
    "node_modules/bindings": {
      "version": "1.5.0",
      "resolved": "https://registry.npmjs.org/bindings/-/bindings-1.5.0.tgz",
      "integrity": "sha512-p2q/t/mhvuOj/UeLlV6566GD/guowlr0hHxClI0W9m7MWYkL1F0hLo+0Aexs9HSPCtR1SXQ0TD3MMKrXZajbiQ==",
      "license": "MIT",
      "dependencies": {
        "file-uri-to-path": "1.0.0"
      }
    },
    "node_modules/birpc": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/birpc/-/birpc-4.0.0.tgz",
      "integrity": "sha512-LShSxJP0KTmd101b6DRyGBj57LZxSDYWKitQNW/mi8GRMvZb078Uf9+pveax1DrVL89vm7mWe+TovdI/UDOuPw==",
      "dev": true,
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/antfu"
      }
    },
    "node_modules/bl": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/bl/-/bl-4.1.0.tgz",
      "integrity": "sha512-1W07cM9gS6DcLperZfFSj+bWLtaPGSOHWhPiGzXmvVJbRLdG82sH/Kn8EtW1VqWVA54AKf2h5k5BbnIbwF3h6w==",
      "license": "MIT",
      "dependencies": {
        "buffer": "^5.5.0",
        "inherits": "^2.0.4",
        "readable-stream": "^3.4.0"
      }
    },
    "node_modules/buffer": {
      "version": "5.7.1",
      "resolved": "https://registry.npmjs.org/buffer/-/buffer-5.7.1.tgz",
      "integrity": "sha512-EHcyIPBQ4BSGlvjB16k5KgAJ27CIsHY/2JBmCRReo48y9rQ3MaUzWX3KVlBa4U7MyX02HdVj0K7C3WaB3ju7FQ==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "base64-js": "^1.3.1",
        "ieee754": "^1.1.13"
      }
    },
    "node_modules/buffer-from": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/buffer-from/-/buffer-from-1.1.2.tgz",
      "integrity": "sha512-E+XQCRwSbaaiChtv6k6Dwgc+bx+Bs6vuKJHHl5kox/BaKbhiXzqQOwK4cO22yElGp2OCmjwVhT3HmxgyPGnJfQ==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/bun-types": {
      "version": "1.3.6",
      "resolved": "https://registry.npmjs.org/bun-types/-/bun-types-1.3.6.tgz",
      "integrity": "sha512-OlFwHcnNV99r//9v5IIOgQ9Uk37gZqrNMCcqEaExdkVq3Avwqok1bJFmvGMCkCE0FqzdY8VMOZpfpR3lwI+CsQ==",
      "license": "MIT",
      "dependencies": {
        "@types/node": "*"
      }
    },
    "node_modules/cac": {
      "version": "6.7.14",
      "resolved": "https://registry.npmjs.org/cac/-/cac-6.7.14.tgz",
      "integrity": "sha512-b6Ilus+c3RrdDk+JhLKUAQfzzgLEPy6wcXqS7f/xe1EETvsDP6GORG7SFuOs6cID5YkqchW/LXZbX5bc8j7ZcQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/chownr": {
      "version": "1.1.4",
      "resolved": "https://registry.npmjs.org/chownr/-/chownr-1.1.4.tgz",
      "integrity": "sha512-jJ0bqzaylmJtVnNgzTeSOs8DPavpbYgEr/b0YL8/2GO3xJEhInFmhKMUnEJQjZumK7KXGFhUy89PrsJWlakBVg==",
      "license": "ISC"
    },
    "node_modules/cookie": {
      "version": "0.7.2",
      "resolved": "https://registry.npmjs.org/cookie/-/cookie-0.7.2.tgz",
      "integrity": "sha512-yki5XnKuf750l50uGTllt6kKILY4nQ1eNIQatoXEByZ5dWgnKqbnqmTrBE5B4N7lrMJKQ2ytWMiTO2o0v6Ew/w==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/cors": {
      "version": "2.8.5",
      "resolved": "https://registry.npmjs.org/cors/-/cors-2.8.5.tgz",
      "integrity": "sha512-KIHbLJqu73RGr/hnbrO9uBeixNGuvSQjul/jdFvS/KFSIH1hWVd1ng7zOHx+YrEfInLG7q4n6GHQ9cDtxv/P6g==",
      "license": "MIT",
      "dependencies": {
        "object-assign": "^4",
        "vary": "^1"
      },
      "engines": {
        "node": ">= 0.10"
      }
    },
    "node_modules/debug": {
      "version": "4.3.7",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.3.7.tgz",
      "integrity": "sha512-Er2nc/H7RrMXZBFCEim6TCmMk02Z8vLC2Rbi1KEBggpo0fS6l0S1nnapwmIi3yW/+GOJap1Krg4w0Hg80oCqgQ==",
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/decompress-response": {
      "version": "6.0.0",
      "resolved": "https://registry.npmjs.org/decompress-response/-/decompress-response-6.0.0.tgz",
      "integrity": "sha512-aW35yZM6Bb/4oJlZncMH2LCoZtJXTRxES17vE3hoRiowU2kWHaJKFkSBDnDR+cm9J+9QhXmREyIfv0pji9ejCQ==",
      "license": "MIT",
      "dependencies": {
        "mimic-response": "^3.1.0"
      },
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/deep-extend": {
      "version": "0.6.0",
      "resolved": "https://registry.npmjs.org/deep-extend/-/deep-extend-0.6.0.tgz",
      "integrity": "sha512-LOHxIOaPYdHlJRtCQfDIVZtfw/ufM8+rVj649RIHzcm/vGwQRXFt6OPqIFWsm2XEMrNIEtWR64sY1LEKD2vAOA==",
      "license": "MIT",
      "engines": {
        "node": ">=4.0.0"
      }
    },
    "node_modules/defu": {
      "version": "6.1.4",
      "resolved": "https://registry.npmjs.org/defu/-/defu-6.1.4.tgz",
      "integrity": "sha512-mEQCMmwJu317oSz8CwdIOdwf3xMif1ttiM8LTufzc3g6kR+9Pe236twL8j3IYT1F7GfRgGcW6MWxzZjLIkuHIg==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/detect-libc": {
      "version": "2.1.2",
      "resolved": "https://registry.npmjs.org/detect-libc/-/detect-libc-2.1.2.tgz",
      "integrity": "sha512-Btj2BOOO83o3WyH59e8MgXsxEQVcarkUOpEYrubB0urwnN10yQ364rsiByU11nZlqWYZm05i/of7io4mzihBtQ==",
      "license": "Apache-2.0",
      "engines": {
        "node": ">=8"
      }
    },
    "node_modules/drizzle-kit": {
      "version": "0.31.9",
      "resolved": "https://registry.npmjs.org/drizzle-kit/-/drizzle-kit-0.31.9.tgz",
      "integrity": "sha512-GViD3IgsXn7trFyBUUHyTFBpH/FsHTxYJ66qdbVggxef4UBPHRYxQaRzYLTuekYnk9i5FIEL9pbBIwMqX/Uwrg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@drizzle-team/brocli": "^0.10.2",
        "@esbuild-kit/esm-loader": "^2.5.5",
        "esbuild": "^0.25.4",
        "esbuild-register": "^3.5.0"
      },
      "bin": {
        "drizzle-kit": "bin.cjs"
      }
    },
    "node_modules/drizzle-orm": {
      "version": "0.45.1",
      "resolved": "https://registry.npmjs.org/drizzle-orm/-/drizzle-orm-0.45.1.tgz",
      "integrity": "sha512-Te0FOdKIistGNPMq2jscdqngBRfBpC8uMFVwqjf6gtTVJHIQ/dosgV/CLBU2N4ZJBsXL5savCba9b0YJskKdcA==",
      "license": "Apache-2.0",
      "peerDependencies": {
        "@aws-sdk/client-rds-data": ">=3",
        "@cloudflare/workers-types": ">=4",
        "@electric-sql/pglite": ">=0.2.0",
        "@libsql/client": ">=0.10.0",
        "@libsql/client-wasm": ">=0.10.0",
        "@neondatabase/serverless": ">=0.10.0",
        "@op-engineering/op-sqlite": ">=2",
        "@opentelemetry/api": "^1.4.1",
        "@planetscale/database": ">=1.13",
        "@prisma/client": "*",
        "@tidbcloud/serverless": "*",
        "@types/better-sqlite3": "*",
        "@types/pg": "*",
        "@types/sql.js": "*",
        "@upstash/redis": ">=1.34.7",
        "@vercel/postgres": ">=0.8.0",
        "@xata.io/client": "*",
        "better-sqlite3": ">=7",
        "bun-types": "*",
        "expo-sqlite": ">=14.0.0",
        "gel": ">=2",
        "knex": "*",
        "kysely": "*",
        "mysql2": ">=2",
        "pg": ">=8",
        "postgres": ">=3",
        "sql.js": ">=1",
        "sqlite3": ">=5"
      },
      "peerDependenciesMeta": {
        "@aws-sdk/client-rds-data": {
          "optional": true
        },
        "@cloudflare/workers-types": {
          "optional": true
        },
        "@electric-sql/pglite": {
          "optional": true
        },
        "@libsql/client": {
          "optional": true
        },
        "@libsql/client-wasm": {
          "optional": true
        },
        "@neondatabase/serverless": {
          "optional": true
        },
        "@op-engineering/op-sqlite": {
          "optional": true
        },
        "@opentelemetry/api": {
          "optional": true
        },
        "@planetscale/database": {
          "optional": true
        },
        "@prisma/client": {
          "optional": true
        },
        "@tidbcloud/serverless": {
          "optional": true
        },
        "@types/better-sqlite3": {
          "optional": true
        },
        "@types/pg": {
          "optional": true
        },
        "@types/sql.js": {
          "optional": true
        },
        "@upstash/redis": {
          "optional": true
        },
        "@vercel/postgres": {
          "optional": true
        },
        "@xata.io/client": {
          "optional": true
        },
        "better-sqlite3": {
          "optional": true
        },
        "bun-types": {
          "optional": true
        },
        "expo-sqlite": {
          "optional": true
        },
        "gel": {
          "optional": true
        },
        "knex": {
          "optional": true
        },
        "kysely": {
          "optional": true
        },
        "mysql2": {
          "optional": true
        },
        "pg": {
          "optional": true
        },
        "postgres": {
          "optional": true
        },
        "prisma": {
          "optional": true
        },
        "sql.js": {
          "optional": true
        },
        "sqlite3": {
          "optional": true
        }
      }
    },
    "node_modules/dts-resolver": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/dts-resolver/-/dts-resolver-2.1.3.tgz",
      "integrity": "sha512-bihc7jPC90VrosXNzK0LTE2cuLP6jr0Ro8jk+kMugHReJVLIpHz/xadeq3MhuwyO4TD4OA3L1Q8pBBFRc08Tsw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=20.19.0"
      },
      "funding": {
        "url": "https://github.com/sponsors/sxzz"
      },
      "peerDependencies": {
        "oxc-resolver": ">=11.0.0"
      },
      "peerDependenciesMeta": {
        "oxc-resolver": {
          "optional": true
        }
      }
    },
    "node_modules/empathic": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/empathic/-/empathic-2.0.0.tgz",
      "integrity": "sha512-i6UzDscO/XfAcNYD75CfICkmfLedpyPDdozrLMmQc5ORaQcdMoc21OnlEylMIqI7U8eniKrPMxxtj8k0vhmJhA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/end-of-stream": {
      "version": "1.4.5",
      "resolved": "https://registry.npmjs.org/end-of-stream/-/end-of-stream-1.4.5.tgz",
      "integrity": "sha512-ooEGc6HP26xXq/N+GCGOT0JKCLDGrq2bQUZrQ7gyrJiZANJ/8YDTxTpQBXGMn+WbIQXNVpyWymm7KYVICQnyOg==",
      "license": "MIT",
      "dependencies": {
        "once": "^1.4.0"
      }
    },
    "node_modules/engine.io": {
      "version": "6.6.4",
      "resolved": "https://registry.npmjs.org/engine.io/-/engine.io-6.6.4.tgz",
      "integrity": "sha512-ZCkIjSYNDyGn0R6ewHDtXgns/Zre/NT6Agvq1/WobF7JXgFff4SeDroKiCO3fNJreU9YG429Sc81o4w5ok/W5g==",
      "license": "MIT",
      "dependencies": {
        "@types/cors": "^2.8.12",
        "@types/node": ">=10.0.0",
        "accepts": "~1.3.4",
        "base64id": "2.0.0",
        "cookie": "~0.7.2",
        "cors": "~2.8.5",
        "debug": "~4.3.1",
        "engine.io-parser": "~5.2.1",
        "ws": "~8.17.1"
      },
      "engines": {
        "node": ">=10.2.0"
      }
    },
    "node_modules/engine.io-client": {
      "version": "6.6.3",
      "resolved": "https://registry.npmjs.org/engine.io-client/-/engine.io-client-6.6.3.tgz",
      "integrity": "sha512-T0iLjnyNWahNyv/lcjS2y4oE358tVS/SYQNxYXGAJ9/GLgH4VCvOQ/mhTjqU88mLZCQgiG8RIegFHYCdVC+j5w==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@socket.io/component-emitter": "~3.1.0",
        "debug": "~4.3.1",
        "engine.io-parser": "~5.2.1",
        "ws": "~8.17.1",
        "xmlhttprequest-ssl": "~2.1.1"
      }
    },
    "node_modules/engine.io-parser": {
      "version": "5.2.3",
      "resolved": "https://registry.npmjs.org/engine.io-parser/-/engine.io-parser-5.2.3.tgz",
      "integrity": "sha512-HqD3yTBfnBxIrbnM1DoD6Pcq8NECnh8d4As1Qgh0z5Gg3jRRIqijury0CL3ghu/edArpUYiYqQiDUQBIs4np3Q==",
      "license": "MIT",
      "engines": {
        "node": ">=10.0.0"
      }
    },
    "node_modules/env-paths": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/env-paths/-/env-paths-3.0.0.tgz",
      "integrity": "sha512-dtJUTepzMW3Lm/NPxRf3wP4642UWhjL2sQxc+ym2YMj1m/H2zDNQOlezafzkHwn6sMstjHTwG6iQQsctDW/b1A==",
      "license": "MIT",
      "engines": {
        "node": "^12.20.0 || ^14.13.1 || >=16.0.0"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/esbuild": {
      "version": "0.25.12",
      "resolved": "https://registry.npmjs.org/esbuild/-/esbuild-0.25.12.tgz",
      "integrity": "sha512-bbPBYYrtZbkt6Os6FiTLCTFxvq4tt3JKall1vRwshA3fdVztsLAatFaZobhkBC8/BrPetoa0oksYoKXoG4ryJg==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "peer": true,
      "bin": {
        "esbuild": "bin/esbuild"
      },
      "engines": {
        "node": ">=18"
      },
      "optionalDependencies": {
        "@esbuild/aix-ppc64": "0.25.12",
        "@esbuild/android-arm": "0.25.12",
        "@esbuild/android-arm64": "0.25.12",
        "@esbuild/android-x64": "0.25.12",
        "@esbuild/darwin-arm64": "0.25.12",
        "@esbuild/darwin-x64": "0.25.12",
        "@esbuild/freebsd-arm64": "0.25.12",
        "@esbuild/freebsd-x64": "0.25.12",
        "@esbuild/linux-arm": "0.25.12",
        "@esbuild/linux-arm64": "0.25.12",
        "@esbuild/linux-ia32": "0.25.12",
        "@esbuild/linux-loong64": "0.25.12",
        "@esbuild/linux-mips64el": "0.25.12",
        "@esbuild/linux-ppc64": "0.25.12",
        "@esbuild/linux-riscv64": "0.25.12",
        "@esbuild/linux-s390x": "0.25.12",
        "@esbuild/linux-x64": "0.25.12",
        "@esbuild/netbsd-arm64": "0.25.12",
        "@esbuild/netbsd-x64": "0.25.12",
        "@esbuild/openbsd-arm64": "0.25.12",
        "@esbuild/openbsd-x64": "0.25.12",
        "@esbuild/openharmony-arm64": "0.25.12",
        "@esbuild/sunos-x64": "0.25.12",
        "@esbuild/win32-arm64": "0.25.12",
        "@esbuild/win32-ia32": "0.25.12",
        "@esbuild/win32-x64": "0.25.12"
      }
    },
    "node_modules/esbuild-register": {
      "version": "3.6.0",
      "resolved": "https://registry.npmjs.org/esbuild-register/-/esbuild-register-3.6.0.tgz",
      "integrity": "sha512-H2/S7Pm8a9CL1uhp9OvjwrBh5Pvx0H8qVOxNu8Wed9Y7qv56MPtq+GGM8RJpq6glYJn9Wspr8uw7l55uyinNeg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "debug": "^4.3.4"
      },
      "peerDependencies": {
        "esbuild": ">=0.12 <1"
      }
    },
    "node_modules/estree-walker": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/estree-walker/-/estree-walker-3.0.3.tgz",
      "integrity": "sha512-7RUKfXgSMMkzt6ZuXmqapOurLGPPfgj6l9uRZ7lRGolvk0y2yocc35LdcxKC5PQZdn2DMqioAQ2NoWcrTKmm6g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@types/estree": "^1.0.0"
      }
    },
    "node_modules/expand-template": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/expand-template/-/expand-template-2.0.3.tgz",
      "integrity": "sha512-XYfuKMvj4O35f/pOXLObndIRvyQ+/+6AhODh+OKWj9S9498pHHn/IMszH+gt0fBCRWMNfk1ZSp5x3AifmnI2vg==",
      "license": "(MIT OR WTFPL)",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/fdir": {
      "version": "6.5.0",
      "resolved": "https://registry.npmjs.org/fdir/-/fdir-6.5.0.tgz",
      "integrity": "sha512-tIbYtZbucOs0BRGqPJkshJUYdL+SDH7dVM8gjy+ERp3WAUjLEFJE+02kanyHtwjWOnwrKYBiwAmM0p4kLJAnXg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=12.0.0"
      },
      "peerDependencies": {
        "picomatch": "^3 || ^4"
      },
      "peerDependenciesMeta": {
        "picomatch": {
          "optional": true
        }
      }
    },
    "node_modules/file-uri-to-path": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/file-uri-to-path/-/file-uri-to-path-1.0.0.tgz",
      "integrity": "sha512-0Zt+s3L7Vf1biwWZ29aARiVYLx7iMGnEUl9x33fbB/j3jR81u/O2LbqK+Bm1CDSNDKVtJ/YjwY7TUd5SkeLQLw==",
      "license": "MIT"
    },
    "node_modules/frida": {
      "version": "17.6.2",
      "resolved": "https://registry.npmjs.org/frida/-/frida-17.6.2.tgz",
      "integrity": "sha512-RGvUbbjIKG+WcjWesD1Z591pOWjopSYZ8u1/wes4CV2lDvjKDqNDHuryal9eFiYKOp4YidPW3DMxqFkzvkeV0w==",
      "hasInstallScript": true,
      "license": "LGPL-2.0 WITH WxWindows-exception-3.1",
      "dependencies": {
        "bindings": "^1.5.0",
        "minimatch": "^10.0.1",
        "prebuild-install": "^7.1.3"
      },
      "engines": {
        "node": ">=16"
      }
    },
    "node_modules/frida-remote-stream": {
      "version": "6.0.3",
      "resolved": "https://registry.npmjs.org/frida-remote-stream/-/frida-remote-stream-6.0.3.tgz",
      "integrity": "sha512-RDWCKdKJOj/nqPMJ8r6YEd4dbLyTQBqwCR1OLy0mwFi1R/rTWS0EIs3UeG0cKIEW3OaDpgGL4IQ7ecDxpgIQ3w==",
      "license": "MIT",
      "dependencies": {
        "tiny-typed-emitter": "^2.1.0"
      }
    },
    "node_modules/frida16": {
      "name": "frida",
      "version": "16.7.19",
      "resolved": "https://registry.npmjs.org/frida/-/frida-16.7.19.tgz",
      "integrity": "sha512-OqMpRpzOzilQyIo9WpBcw8kgj11awAP/eQVDTUFQ1bg/2s9ceNnBqrRmIUlqvFeTo96b++9ijA8Ly5xkVMUyQw==",
      "hasInstallScript": true,
      "license": "LGPL-2.0 WITH WxWindows-exception-3.1",
      "dependencies": {
        "bindings": "^1.5.0",
        "minimatch": "^10.0.1",
        "prebuild-install": "^7.1.3"
      },
      "engines": {
        "node": ">=16"
      }
    },
    "node_modules/fs-constants": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/fs-constants/-/fs-constants-1.0.0.tgz",
      "integrity": "sha512-y6OAwoSIf7FyjMIv94u+b5rdheZEjzR63GTyZJm5qh4Bi+2YgwLCcI/fPFZkL5PSixOt6ZNKm+w+Hfp/Bciwow==",
      "license": "MIT"
    },
    "node_modules/get-tsconfig": {
      "version": "4.13.0",
      "resolved": "https://registry.npmjs.org/get-tsconfig/-/get-tsconfig-4.13.0.tgz",
      "integrity": "sha512-1VKTZJCwBrvbd+Wn3AOgQP/2Av+TfTCOlE4AcRJE72W1ksZXbAx8PPBR9RzgTeSPzlPMHrbANMH3LbltH73wxQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "resolve-pkg-maps": "^1.0.0"
      },
      "funding": {
        "url": "https://github.com/privatenumber/get-tsconfig?sponsor=1"
      }
    },
    "node_modules/github-from-package": {
      "version": "0.0.0",
      "resolved": "https://registry.npmjs.org/github-from-package/-/github-from-package-0.0.0.tgz",
      "integrity": "sha512-SyHy3T1v2NUXn29OsWdxmK6RwHD+vkj3v8en8AOBZ1wBQ/hCAQ5bAQTD02kW4W9tUp/3Qh6J8r9EvntiyCmOOw==",
      "license": "MIT"
    },
    "node_modules/hono": {
      "version": "4.11.6",
      "resolved": "https://registry.npmjs.org/hono/-/hono-4.11.6.tgz",
      "integrity": "sha512-ofIiiHyl34SV6AuhE3YT2mhO5HRWokce+eUYE82TsP6z0/H3JeJcjVWEMSIAiw2QkjDOEpES/lYsg8eEbsLtdw==",
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=16.9.0"
      }
    },
    "node_modules/hookable": {
      "version": "6.0.1",
      "resolved": "https://registry.npmjs.org/hookable/-/hookable-6.0.1.tgz",
      "integrity": "sha512-uKGyY8BuzN/a5gvzvA+3FVWo0+wUjgtfSdnmjtrOVwQCZPHpHDH2WRO3VZSOeluYrHoDCiXFffZXs8Dj1ULWtw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/ieee754": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/ieee754/-/ieee754-1.2.1.tgz",
      "integrity": "sha512-dcyqhDvX1C46lXZcVqCpK+FtMRQVdIMN6/Df5js2zouUsqG7I6sFxitIC+7KYK29KdXOLHdu9zL4sFnoVQnqaA==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "BSD-3-Clause"
    },
    "node_modules/import-without-cache": {
      "version": "0.2.5",
      "resolved": "https://registry.npmjs.org/import-without-cache/-/import-without-cache-0.2.5.tgz",
      "integrity": "sha512-B6Lc2s6yApwnD2/pMzFh/d5AVjdsDXjgkeJ766FmFuJELIGHNycKRj+l3A39yZPM4CchqNCB4RITEAYB1KUM6A==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=20.19.0"
      },
      "funding": {
        "url": "https://github.com/sponsors/sxzz"
      }
    },
    "node_modules/inherits": {
      "version": "2.0.4",
      "resolved": "https://registry.npmjs.org/inherits/-/inherits-2.0.4.tgz",
      "integrity": "sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ==",
      "license": "ISC"
    },
    "node_modules/ini": {
      "version": "1.3.8",
      "resolved": "https://registry.npmjs.org/ini/-/ini-1.3.8.tgz",
      "integrity": "sha512-JV/yugV2uzW5iMRSiZAyDtQd+nxtUnjeLt0acNdw98kKLrvuRVyB80tsREOE7yvGVgalhZ6RNXCmEHkUKBKxew==",
      "license": "ISC"
    },
    "node_modules/jsesc": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/jsesc/-/jsesc-3.1.0.tgz",
      "integrity": "sha512-/sM3dO2FOzXjKQhJuo0Q173wf2KOo8t4I8vHy6lF9poUp7bKT0/NHE8fPX23PwfhnykfqnC2xRxOnVw5XuGIaA==",
      "dev": true,
      "license": "MIT",
      "bin": {
        "jsesc": "bin/jsesc"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/mime-db": {
      "version": "1.52.0",
      "resolved": "https://registry.npmjs.org/mime-db/-/mime-db-1.52.0.tgz",
      "integrity": "sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/mime-types": {
      "version": "2.1.35",
      "resolved": "https://registry.npmjs.org/mime-types/-/mime-types-2.1.35.tgz",
      "integrity": "sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw==",
      "license": "MIT",
      "dependencies": {
        "mime-db": "1.52.0"
      },
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/mimic-response": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/mimic-response/-/mimic-response-3.1.0.tgz",
      "integrity": "sha512-z0yWI+4FDrrweS8Zmt4Ej5HdJmky15+L2e6Wgn3+iK5fWzb6T3fhNFq2+MeTRb064c6Wr4N/wv0DzQTjNzHNGQ==",
      "license": "MIT",
      "engines": {
        "node": ">=10"
      },
      "funding": {
        "url": "https://github.com/sponsors/sindresorhus"
      }
    },
    "node_modules/minimatch": {
      "version": "10.1.1",
      "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-10.1.1.tgz",
      "integrity": "sha512-enIvLvRAFZYXJzkCYG5RKmPfrFArdLv+R+lbQ53BmIMLIry74bjKzX6iHAm8WYamJkhSSEabrWN5D97XnKObjQ==",
      "license": "BlueOak-1.0.0",
      "dependencies": {
        "@isaacs/brace-expansion": "^5.0.0"
      },
      "engines": {
        "node": "20 || >=22"
      },
      "funding": {
        "url": "https://github.com/sponsors/isaacs"
      }
    },
    "node_modules/minimist": {
      "version": "1.2.8",
      "resolved": "https://registry.npmjs.org/minimist/-/minimist-1.2.8.tgz",
      "integrity": "sha512-2yyAR8qBkN3YuheJanUpWC5U3bb5osDywNB8RzDVlDwDHbocAJveqqj1u8+SVD7jkWT4yvsHCpWqqWqAxb0zCA==",
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/mkdirp-classic": {
      "version": "0.5.3",
      "resolved": "https://registry.npmjs.org/mkdirp-classic/-/mkdirp-classic-0.5.3.tgz",
      "integrity": "sha512-gKLcREMhtuZRwRAfqP3RFW+TK4JqApVBtOIftVgjuABpAtpxhPGaDcfvbhNvD0B8iD1oUr/txX35NjcaY6Ns/A==",
      "license": "MIT"
    },
    "node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "license": "MIT"
    },
    "node_modules/napi-build-utils": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/napi-build-utils/-/napi-build-utils-2.0.0.tgz",
      "integrity": "sha512-GEbrYkbfF7MoNaoh2iGG84Mnf/WZfB0GdGEsM8wz7Expx/LlWf5U8t9nvJKXSp3qr5IsEbK04cBGhol/KwOsWA==",
      "license": "MIT"
    },
    "node_modules/negotiator": {
      "version": "0.6.3",
      "resolved": "https://registry.npmjs.org/negotiator/-/negotiator-0.6.3.tgz",
      "integrity": "sha512-+EUsqGPLsM+j/zdChZjsnX51g4XrHFOIXwfnCVPGlQk/k5giakcKsuxCObBRu6DSm9opw/O6slWbJdghQM4bBg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/node-abi": {
      "version": "3.80.0",
      "resolved": "https://registry.npmjs.org/node-abi/-/node-abi-3.80.0.tgz",
      "integrity": "sha512-LyPuZJcI9HVwzXK1GPxWNzrr+vr8Hp/3UqlmWxxh8p54U1ZbclOqbSog9lWHaCX+dBaiGi6n/hIX+mKu74GmPA==",
      "license": "MIT",
      "dependencies": {
        "semver": "^7.3.5"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/object-assign": {
      "version": "4.1.1",
      "resolved": "https://registry.npmjs.org/object-assign/-/object-assign-4.1.1.tgz",
      "integrity": "sha512-rJgTQnkUnH1sFw8yT6VSU3zD3sWmu6sZhIseY8VX+GRu3P6F7Fu+JNDoXfklElbLJSnc3FUQHVe4cU5hj+BcUg==",
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/obug": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/obug/-/obug-2.1.1.tgz",
      "integrity": "sha512-uTqF9MuPraAQ+IsnPf366RG4cP9RtUi7MLO1N3KEc+wb0a6yKpeL0lmk2IB1jY5KHPAlTc6T/JRdC/YqxHNwkQ==",
      "dev": true,
      "funding": [
        "https://github.com/sponsors/sxzz",
        "https://opencollective.com/debug"
      ],
      "license": "MIT"
    },
    "node_modules/once": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/once/-/once-1.4.0.tgz",
      "integrity": "sha512-lNaJgI+2Q5URQBkccEKHTQOPaXdUxnZZElQTZY0MFUAuaEqe1E+Nyvgdz/aIyNi6Z9MzO5dv1H8n58/GELp3+w==",
      "license": "ISC",
      "dependencies": {
        "wrappy": "1"
      }
    },
    "node_modules/pathe": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/pathe/-/pathe-2.0.3.tgz",
      "integrity": "sha512-WUjGcAqP1gQacoQe+OBJsFA7Ld4DyXuUIjZ5cc75cLHvJ7dtNsTugphxIADwspS+AraAUePCKrSVtPLFj/F88w==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/picomatch": {
      "version": "4.0.3",
      "resolved": "https://registry.npmjs.org/picomatch/-/picomatch-4.0.3.tgz",
      "integrity": "sha512-5gTmgEY/sqK6gFXLIsQNH19lWb4ebPDLA4SdLP7dsWkIXHWlG66oPuVvXSGFPppYZz8ZDZq0dYYrbHfBCVUb1Q==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "engines": {
        "node": ">=12"
      },
      "funding": {
        "url": "https://github.com/sponsors/jonschlinkert"
      }
    },
    "node_modules/prebuild-install": {
      "version": "7.1.3",
      "resolved": "https://registry.npmjs.org/prebuild-install/-/prebuild-install-7.1.3.tgz",
      "integrity": "sha512-8Mf2cbV7x1cXPUILADGI3wuhfqWvtiLA1iclTDbFRZkgRQS0NqsPZphna9V+HyTEadheuPmjaJMsbzKQFOzLug==",
      "license": "MIT",
      "dependencies": {
        "detect-libc": "^2.0.0",
        "expand-template": "^2.0.3",
        "github-from-package": "0.0.0",
        "minimist": "^1.2.3",
        "mkdirp-classic": "^0.5.3",
        "napi-build-utils": "^2.0.0",
        "node-abi": "^3.3.0",
        "pump": "^3.0.0",
        "rc": "^1.2.7",
        "simple-get": "^4.0.0",
        "tar-fs": "^2.0.0",
        "tunnel-agent": "^0.6.0"
      },
      "bin": {
        "prebuild-install": "bin.js"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/pump": {
      "version": "3.0.3",
      "resolved": "https://registry.npmjs.org/pump/-/pump-3.0.3.tgz",
      "integrity": "sha512-todwxLMY7/heScKmntwQG8CXVkWUOdYxIvY2s0VWAAMh/nd8SoYiRaKjlr7+iCs984f2P8zvrfWcDDYVb73NfA==",
      "license": "MIT",
      "dependencies": {
        "end-of-stream": "^1.1.0",
        "once": "^1.3.1"
      }
    },
    "node_modules/quansync": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/quansync/-/quansync-1.0.0.tgz",
      "integrity": "sha512-5xZacEEufv3HSTPQuchrvV6soaiACMFnq1H8wkVioctoH3TRha9Sz66lOxRwPK/qZj7HPiSveih9yAyh98gvqA==",
      "dev": true,
      "funding": [
        {
          "type": "individual",
          "url": "https://github.com/sponsors/antfu"
        },
        {
          "type": "individual",
          "url": "https://github.com/sponsors/sxzz"
        }
      ],
      "license": "MIT"
    },
    "node_modules/rc": {
      "version": "1.2.8",
      "resolved": "https://registry.npmjs.org/rc/-/rc-1.2.8.tgz",
      "integrity": "sha512-y3bGgqKj3QBdxLbLkomlohkvsA8gdAiUQlSBJnBhfn+BPxg4bc62d8TcBW15wavDfgexCgccckhcZvywyQYPOw==",
      "license": "(BSD-2-Clause OR MIT OR Apache-2.0)",
      "dependencies": {
        "deep-extend": "^0.6.0",
        "ini": "~1.3.0",
        "minimist": "^1.2.0",
        "strip-json-comments": "~2.0.1"
      },
      "bin": {
        "rc": "cli.js"
      }
    },
    "node_modules/readable-stream": {
      "version": "3.6.2",
      "resolved": "https://registry.npmjs.org/readable-stream/-/readable-stream-3.6.2.tgz",
      "integrity": "sha512-9u/sniCrY3D5WdsERHzHE4G2YCXqoG5FTHUiCC4SIbr6XcLZBY05ya9EKjYek9O5xOAwjGq+1JdGBAS7Q9ScoA==",
      "license": "MIT",
      "dependencies": {
        "inherits": "^2.0.3",
        "string_decoder": "^1.1.1",
        "util-deprecate": "^1.0.1"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/resolve-pkg-maps": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/resolve-pkg-maps/-/resolve-pkg-maps-1.0.0.tgz",
      "integrity": "sha512-seS2Tj26TBVOC2NIc2rOe2y2ZO7efxITtLZcGSOnHHNOQ7CkiUBfw0Iw2ck6xkIhPwLhKNLS8BO+hEpngQlqzw==",
      "dev": true,
      "license": "MIT",
      "funding": {
        "url": "https://github.com/privatenumber/resolve-pkg-maps?sponsor=1"
      }
    },
    "node_modules/rolldown": {
      "version": "1.0.0-rc.1",
      "resolved": "https://registry.npmjs.org/rolldown/-/rolldown-1.0.0-rc.1.tgz",
      "integrity": "sha512-M3AeZjYE6UclblEf531Hch0WfVC/NOL43Cc+WdF3J50kk5/fvouHhDumSGTh0oRjbZ8C4faaVr5r6Nx1xMqDGg==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@oxc-project/types": "=0.110.0",
        "@rolldown/pluginutils": "1.0.0-rc.1"
      },
      "bin": {
        "rolldown": "bin/cli.mjs"
      },
      "engines": {
        "node": "^20.19.0 || >=22.12.0"
      },
      "optionalDependencies": {
        "@rolldown/binding-android-arm64": "1.0.0-rc.1",
        "@rolldown/binding-darwin-arm64": "1.0.0-rc.1",
        "@rolldown/binding-darwin-x64": "1.0.0-rc.1",
        "@rolldown/binding-freebsd-x64": "1.0.0-rc.1",
        "@rolldown/binding-linux-arm-gnueabihf": "1.0.0-rc.1",
        "@rolldown/binding-linux-arm64-gnu": "1.0.0-rc.1",
        "@rolldown/binding-linux-arm64-musl": "1.0.0-rc.1",
        "@rolldown/binding-linux-x64-gnu": "1.0.0-rc.1",
        "@rolldown/binding-linux-x64-musl": "1.0.0-rc.1",
        "@rolldown/binding-openharmony-arm64": "1.0.0-rc.1",
        "@rolldown/binding-wasm32-wasi": "1.0.0-rc.1",
        "@rolldown/binding-win32-arm64-msvc": "1.0.0-rc.1",
        "@rolldown/binding-win32-x64-msvc": "1.0.0-rc.1"
      }
    },
    "node_modules/rolldown-plugin-dts": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/rolldown-plugin-dts/-/rolldown-plugin-dts-0.21.5.tgz",
      "integrity": "sha512-tS3jz7Fq1FWx5Jqih7pZ3zH4Bsnu+VYH5aY7e9o7Joxu5hi9ApMULmM+LVIGxoGVjjMjZGFMEcbdiZ17j/5eNA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/generator": "8.0.0-beta.4",
        "@babel/parser": "8.0.0-beta.4",
        "@babel/types": "8.0.0-beta.4",
        "ast-kit": "^3.0.0-beta.1",
        "birpc": "^4.0.0",
        "dts-resolver": "^2.1.3",
        "get-tsconfig": "^4.13.0",
        "obug": "^2.1.1"
      },
      "engines": {
        "node": ">=20.19.0"
      },
      "funding": {
        "url": "https://github.com/sponsors/sxzz"
      },
      "peerDependencies": {
        "@ts-macro/tsc": "^0.3.6",
        "@typescript/native-preview": ">=7.0.0-dev.20250601.1",
        "rolldown": "^1.0.0-beta.57",
        "typescript": "^5.0.0",
        "vue-tsc": "~3.2.0"
      },
      "peerDependenciesMeta": {
        "@ts-macro/tsc": {
          "optional": true
        },
        "@typescript/native-preview": {
          "optional": true
        },
        "typescript": {
          "optional": true
        },
        "vue-tsc": {
          "optional": true
        }
      }
    },
    "node_modules/safe-buffer": {
      "version": "5.2.1",
      "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.2.1.tgz",
      "integrity": "sha512-rp3So07KcdmmKbGvgaNxQSJr7bGVSVk5S9Eq1F+ppbRo70+YeaDxkw5Dd8NPN+GD6bjnYm2VuPuCXmpuYvmCXQ==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT"
    },
    "node_modules/semver": {
      "version": "7.7.3",
      "resolved": "https://registry.npmjs.org/semver/-/semver-7.7.3.tgz",
      "integrity": "sha512-SdsKMrI9TdgjdweUSR9MweHA4EJ8YxHn8DFaDisvhVlUOe4BF1tLD7GAj0lIqWVl+dPb/rExr0Btby5loQm20Q==",
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/simple-concat": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/simple-concat/-/simple-concat-1.0.1.tgz",
      "integrity": "sha512-cSFtAPtRhljv69IK0hTVZQ+OfE9nePi/rtJmw5UjHeVyVroEqJXP1sFztKUy1qU+xvz3u/sfYJLa947b7nAN2Q==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT"
    },
    "node_modules/simple-get": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/simple-get/-/simple-get-4.0.1.tgz",
      "integrity": "sha512-brv7p5WgH0jmQJr1ZDDfKDOSeWWg+OVypG99A/5vYGPqJ6pxiaHLy8nxtFjBA7oMa01ebA9gfh1uMCFqOuXxvA==",
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "decompress-response": "^6.0.0",
        "once": "^1.3.1",
        "simple-concat": "^1.0.0"
      }
    },
    "node_modules/socket.io": {
      "version": "4.8.3",
      "resolved": "https://registry.npmjs.org/socket.io/-/socket.io-4.8.3.tgz",
      "integrity": "sha512-2Dd78bqzzjE6KPkD5fHZmDAKRNe3J15q+YHDrIsy9WEkqttc7GY+kT9OBLSMaPbQaEd0x1BjcmtMtXkfpc+T5A==",
      "license": "MIT",
      "dependencies": {
        "accepts": "~1.3.4",
        "base64id": "~2.0.0",
        "cors": "~2.8.5",
        "debug": "~4.4.1",
        "engine.io": "~6.6.0",
        "socket.io-adapter": "~2.5.2",
        "socket.io-parser": "~4.2.4"
      },
      "engines": {
        "node": ">=10.2.0"
      }
    },
    "node_modules/socket.io-adapter": {
      "version": "2.5.5",
      "resolved": "https://registry.npmjs.org/socket.io-adapter/-/socket.io-adapter-2.5.5.tgz",
      "integrity": "sha512-eLDQas5dzPgOWCk9GuuJC2lBqItuhKI4uxGgo9aIV7MYbk2h9Q6uULEh8WBzThoI7l+qU9Ast9fVUmkqPP9wYg==",
      "license": "MIT",
      "dependencies": {
        "debug": "~4.3.4",
        "ws": "~8.17.1"
      }
    },
    "node_modules/socket.io-client": {
      "version": "4.8.3",
      "resolved": "https://registry.npmjs.org/socket.io-client/-/socket.io-client-4.8.3.tgz",
      "integrity": "sha512-uP0bpjWrjQmUt5DTHq9RuoCBdFJF10cdX9X+a368j/Ft0wmaVgxlrjvK3kjvgCODOMMOz9lcaRzxmso0bTWZ/g==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@socket.io/component-emitter": "~3.1.0",
        "debug": "~4.4.1",
        "engine.io-client": "~6.6.1",
        "socket.io-parser": "~4.2.4"
      },
      "engines": {
        "node": ">=10.0.0"
      }
    },
    "node_modules/socket.io-client/node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/socket.io-parser": {
      "version": "4.2.4",
      "resolved": "https://registry.npmjs.org/socket.io-parser/-/socket.io-parser-4.2.4.tgz",
      "integrity": "sha512-/GbIKmo8ioc+NIWIhwdecY0ge+qVBSMdgxGygevmdHj24bsfgtCmcUUcQ5ZzcylGFHsN3k4HB4Cgkl96KVnuew==",
      "license": "MIT",
      "dependencies": {
        "@socket.io/component-emitter": "~3.1.0",
        "debug": "~4.3.1"
      },
      "engines": {
        "node": ">=10.0.0"
      }
    },
    "node_modules/socket.io/node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/source-map": {
      "version": "0.6.1",
      "resolved": "https://registry.npmjs.org/source-map/-/source-map-0.6.1.tgz",
      "integrity": "sha512-UjgapumWlbMhkBgzT7Ykc5YXUT46F0iKu8SGXq0bcwP5dz/h0Plj6enJqjz1Zbq2l5WaqYnrVbwWOWMyF3F47g==",
      "dev": true,
      "license": "BSD-3-Clause",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/source-map-support": {
      "version": "0.5.21",
      "resolved": "https://registry.npmjs.org/source-map-support/-/source-map-support-0.5.21.tgz",
      "integrity": "sha512-uBHU3L3czsIyYXKX88fdrGovxdSCoTGDRZ6SYXtSRxLZUzHg5P/66Ht6uoUlHu9EZod+inXhKo3qQgwXUT/y1w==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "buffer-from": "^1.0.0",
        "source-map": "^0.6.0"
      }
    },
    "node_modules/string_decoder": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/string_decoder/-/string_decoder-1.3.0.tgz",
      "integrity": "sha512-hkRX8U1WjJFd8LsDJ2yQ/wWWxaopEsABU1XfkM8A+j0+85JAGppt16cr1Whg6KIbb4okU6Mql6BOj+uup/wKeA==",
      "license": "MIT",
      "dependencies": {
        "safe-buffer": "~5.2.0"
      }
    },
    "node_modules/strip-json-comments": {
      "version": "2.0.1",
      "resolved": "https://registry.npmjs.org/strip-json-comments/-/strip-json-comments-2.0.1.tgz",
      "integrity": "sha512-4gB8na07fecVVkOI6Rs4e7T6NOTki5EmL7TUduTs6bu3EdnSycntVJ4re8kgZA+wx9IueI2Y11bfbgwtzuE0KQ==",
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/tar-fs": {
      "version": "2.1.4",
      "resolved": "https://registry.npmjs.org/tar-fs/-/tar-fs-2.1.4.tgz",
      "integrity": "sha512-mDAjwmZdh7LTT6pNleZ05Yt65HC3E+NiQzl672vQG38jIrehtJk/J3mNwIg+vShQPcLF/LV7CMnDW6vjj6sfYQ==",
      "license": "MIT",
      "dependencies": {
        "chownr": "^1.1.1",
        "mkdirp-classic": "^0.5.2",
        "pump": "^3.0.0",
        "tar-stream": "^2.1.4"
      }
    },
    "node_modules/tar-stream": {
      "version": "2.2.0",
      "resolved": "https://registry.npmjs.org/tar-stream/-/tar-stream-2.2.0.tgz",
      "integrity": "sha512-ujeqbceABgwMZxEJnk2HDY2DlnUZ+9oEcb1KzTVfYHio0UE6dG71n60d8D2I4qNvleWrrXpmjpt7vZeF1LnMZQ==",
      "license": "MIT",
      "dependencies": {
        "bl": "^4.0.3",
        "end-of-stream": "^1.4.1",
        "fs-constants": "^1.0.0",
        "inherits": "^2.0.3",
        "readable-stream": "^3.1.1"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/tiny-typed-emitter": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/tiny-typed-emitter/-/tiny-typed-emitter-2.1.0.tgz",
      "integrity": "sha512-qVtvMxeXbVej0cQWKqVSSAHmKZEHAvxdF8HEUBFWts8h+xEo5m/lEiPakuyZ3BnCBjOD8i24kzNOiOLLgsSxhA==",
      "license": "MIT"
    },
    "node_modules/tinyexec": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/tinyexec/-/tinyexec-1.0.2.tgz",
      "integrity": "sha512-W/KYk+NFhkmsYpuHq5JykngiOCnxeVL8v8dFnqxSD8qEEdRfXk1SDM6JzNqcERbcGYj9tMrDQBYV9cjgnunFIg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/tinyglobby": {
      "version": "0.2.15",
      "resolved": "https://registry.npmjs.org/tinyglobby/-/tinyglobby-0.2.15.tgz",
      "integrity": "sha512-j2Zq4NyQYG5XMST4cbs02Ak8iJUdxRM0XI5QyxXuZOzKOINmWurp3smXu3y5wDcJrptwpSjgXHzIQxR0omXljQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "fdir": "^6.5.0",
        "picomatch": "^4.0.3"
      },
      "engines": {
        "node": ">=12.0.0"
      },
      "funding": {
        "url": "https://github.com/sponsors/SuperchupuDev"
      }
    },
    "node_modules/tree-kill": {
      "version": "1.2.2",
      "resolved": "https://registry.npmjs.org/tree-kill/-/tree-kill-1.2.2.tgz",
      "integrity": "sha512-L0Orpi8qGpRG//Nd+H90vFB+3iHnue1zSSGmNOOCh1GLJ7rUKVwV2HvijphGQS2UmhUZewS9VgvxYIdgr+fG1A==",
      "dev": true,
      "license": "MIT",
      "bin": {
        "tree-kill": "cli.js"
      }
    },
    "node_modules/tsdown": {
      "version": "0.20.1",
      "resolved": "https://registry.npmjs.org/tsdown/-/tsdown-0.20.1.tgz",
      "integrity": "sha512-Wo1BzqNQVZ6SFQV8rjQBwMmNubO+yV3F+vp2WNTjEaS4S5CT1C1dHtUbeFMrCEasZpGy5w6TshpehNnfTe8QBQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "ansis": "^4.2.0",
        "cac": "^6.7.14",
        "defu": "^6.1.4",
        "empathic": "^2.0.0",
        "hookable": "^6.0.1",
        "import-without-cache": "^0.2.5",
        "obug": "^2.1.1",
        "picomatch": "^4.0.3",
        "rolldown": "1.0.0-rc.1",
        "rolldown-plugin-dts": "^0.21.5",
        "semver": "^7.7.3",
        "tinyexec": "^1.0.2",
        "tinyglobby": "^0.2.15",
        "tree-kill": "^1.2.2",
        "unconfig-core": "^7.4.2",
        "unrun": "^0.2.26"
      },
      "bin": {
        "tsdown": "dist/run.mjs"
      },
      "engines": {
        "node": ">=20.19.0"
      },
      "funding": {
        "url": "https://github.com/sponsors/sxzz"
      },
      "peerDependencies": {
        "@arethetypeswrong/core": "^0.18.1",
        "@vitejs/devtools": "*",
        "publint": "^0.3.0",
        "typescript": "^5.0.0",
        "unplugin-lightningcss": "^0.4.0",
        "unplugin-unused": "^0.5.0"
      },
      "peerDependenciesMeta": {
        "@arethetypeswrong/core": {
          "optional": true
        },
        "@vitejs/devtools": {
          "optional": true
        },
        "publint": {
          "optional": true
        },
        "typescript": {
          "optional": true
        },
        "unplugin-lightningcss": {
          "optional": true
        },
        "unplugin-unused": {
          "optional": true
        }
      }
    },
    "node_modules/tslib": {
      "version": "2.8.1",
      "resolved": "https://registry.npmjs.org/tslib/-/tslib-2.8.1.tgz",
      "integrity": "sha512-oJFu94HQb+KVduSUQL7wnpmqnfmLsOA/nAh6b6EH0wCEoK0/mPeXU6c3wKDV83MkOuHPRHtSXKKU99IBazS/2w==",
      "dev": true,
      "license": "0BSD",
      "optional": true
    },
    "node_modules/tunnel-agent": {
      "version": "0.6.0",
      "resolved": "https://registry.npmjs.org/tunnel-agent/-/tunnel-agent-0.6.0.tgz",
      "integrity": "sha512-McnNiV1l8RYeY8tBgEpuodCC1mLUdbSN+CYBL7kJsJNInOP8UjDDEwdk6Mw60vdLLrr5NHKZhMAOSrR2NZuQ+w==",
      "license": "Apache-2.0",
      "dependencies": {
        "safe-buffer": "^5.0.1"
      },
      "engines": {
        "node": "*"
      }
    },
    "node_modules/typescript": {
      "version": "5.9.3",
      "resolved": "https://registry.npmjs.org/typescript/-/typescript-5.9.3.tgz",
      "integrity": "sha512-jl1vZzPDinLr9eUt3J/t7V6FgNEw9QjvBPdysz9KfQDD41fQrC2Y4vKQdiaUpFT4bXlb1RHhLpp8wtm6M5TgSw==",
      "dev": true,
      "license": "Apache-2.0",
      "peer": true,
      "bin": {
        "tsc": "bin/tsc",
        "tsserver": "bin/tsserver"
      },
      "engines": {
        "node": ">=14.17"
      }
    },
    "node_modules/unconfig-core": {
      "version": "7.4.2",
      "resolved": "https://registry.npmjs.org/unconfig-core/-/unconfig-core-7.4.2.tgz",
      "integrity": "sha512-VgPCvLWugINbXvMQDf8Jh0mlbvNjNC6eSUziHsBCMpxR05OPrNrvDnyatdMjRgcHaaNsCqz+wjNXxNw1kRLHUg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@quansync/fs": "^1.0.0",
        "quansync": "^1.0.0"
      },
      "funding": {
        "url": "https://github.com/sponsors/antfu"
      }
    },
    "node_modules/undici-types": {
      "version": "7.16.0",
      "resolved": "https://registry.npmjs.org/undici-types/-/undici-types-7.16.0.tgz",
      "integrity": "sha512-Zz+aZWSj8LE6zoxD+xrjh4VfkIG8Ya6LvYkZqtUQGJPZjYl53ypCaUwWqo7eI0x66KBGeRo+mlBEkMSeSZ38Nw==",
      "license": "MIT"
    },
    "node_modules/unrun": {
      "version": "0.2.26",
      "resolved": "https://registry.npmjs.org/unrun/-/unrun-0.2.26.tgz",
      "integrity": "sha512-A3DQLBcDyTui4Hlaoojkldg+8x+CIR+tcSHY0wzW+CgB4X/DNyH58jJpXp1B/EkE+yG6tU8iH1mWsLtwFU3IQg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "rolldown": "1.0.0-rc.1"
      },
      "bin": {
        "unrun": "dist/cli.mjs"
      },
      "engines": {
        "node": ">=20.19.0"
      },
      "funding": {
        "url": "https://github.com/sponsors/Gugustinette"
      },
      "peerDependencies": {
        "synckit": "^0.11.11"
      },
      "peerDependenciesMeta": {
        "synckit": {
          "optional": true
        }
      }
    },
    "node_modules/util-deprecate": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/util-deprecate/-/util-deprecate-1.0.2.tgz",
      "integrity": "sha512-EPD5q1uXyFxJpCrLnCc1nHnq3gOa6DZBocAIiI2TaSCA7VCJ1UJDMagCzIkXNsUYfD1daK//LTEQ8xiIbrHtcw==",
      "license": "MIT"
    },
    "node_modules/vary": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/vary/-/vary-1.1.2.tgz",
      "integrity": "sha512-BNGbWLfd0eUPabhkXUVm0j8uuvREyTh5ovRa/dyow/BqAbZJyC+5fU+IzQOzmAKzYqYRAISoRhdQr3eIZ/PXqg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/wrappy": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/wrappy/-/wrappy-1.0.2.tgz",
      "integrity": "sha512-l4Sp/DRseor9wL6EvV2+TuQn63dMkPjZ/sp9XkghTEbV9KlPS1xUsZ3u7/IQO4wxtcFB4bgpQPRcR3QCvezPcQ==",
      "license": "ISC"
    },
    "node_modules/ws": {
      "version": "8.17.1",
      "resolved": "https://registry.npmjs.org/ws/-/ws-8.17.1.tgz",
      "integrity": "sha512-6XQFvXTkbfUOZOKKILFG1PDK2NDQs4azKQl26T0YS5CxqWLgXajbPZ+h4gZekJyRqFU8pvnbAbbs/3TgRPy+GQ==",
      "license": "MIT",
      "engines": {
        "node": ">=10.0.0"
      },
      "peerDependencies": {
        "bufferutil": "^4.0.1",
        "utf-8-validate": ">=5.0.2"
      },
      "peerDependenciesMeta": {
        "bufferutil": {
          "optional": true
        },
        "utf-8-validate": {
          "optional": true
        }
      }
    },
    "node_modules/xmlhttprequest-ssl": {
      "version": "2.1.2",
      "resolved": "https://registry.npmjs.org/xmlhttprequest-ssl/-/xmlhttprequest-ssl-2.1.2.tgz",
      "integrity": "sha512-TEU+nJVUUnA4CYJFLvK5X9AOeH4KvDvhIfm0vV1GaQRtchnG0hgK5p8hw/xjv8cunWYCsiPCSDzObPyhEwq3KQ==",
      "dev": true,
      "engines": {
        "node": ">=0.4.0"
      }
    }
  }
}

```

`package.json`:

```json
{
  "name": "igf",
  "version": "0.20.0",
  "description": "",
  "main": "dist/index.mjs",
  "bin": {
    "igf": "dist/bin.mjs"
  },
  "files": [
    "./dist",
    "./gui/dist/",
    "./agent/dist",
    "./agent/types",
    "./drizzle"
  ],
  "scripts": {
    "prepare": "bun scripts/prepare.ts",
    "dev:both": "node scripts/dev.ts",
    "dev": "bun --watch src/index.ts",
    "start": "bun src/index.ts",
    "test": "bun --test",
    "test:coverage": "bun test --coverage --coverage-reporter=lcov --coverage-dir=coverage",
    "test:coverage:text": "bun test --coverage",
    "prepack": "npm run build:npm",
    "install:gui": "cd gui && npm i",
    "install:agent": "cd agent && npm i",
    "build:npm": "node scripts/build-npm.ts && tsdown",
    "build:cli": "bun i && bun scripts/build-bun.ts",
    "build:all": "bun i && bun scripts/build-bun.ts cross",
    "build:skills": "bun scripts/skills.ts"
  },
  "keywords": [
    "mobile",
    "frida",
    "ios",
    "android",
    "reverse engineering",
    "instrumentation"
  ],
  "author": "",
  "license": "MIT",
  "type": "module",
  "engines": {
    "node": ">=22.18.0"
  },
  "dependencies": {
    "@hono/node-server": "^1.19.9",
    "@types/better-sqlite3": "^7.6.13",
    "@types/bun": "^1.3.6",
    "better-sqlite3": "^12.6.2",
    "drizzle-orm": "^0.45.1",
    "env-paths": "^3.0.0",
    "frida": "^17.6.2",
    "frida-remote-stream": "^6.0.3",
    "frida16": "npm:frida@^16.7.19",
    "hono": "^4.11.6",
    "socket.io": "^4.8.3"
  },
  "devDependencies": {
    "@types/node": "^24.10.9",
    "@typescript/native-preview": "^7.0.0-dev.20260222.1",
    "drizzle-kit": "^0.31.9",
    "socket.io-client": "^4.8.3",
    "tsdown": "^0.20.1",
    "typescript": "^5.9.3"
  },
  "patchedDependencies": {
    "frida@17.6.2": "patches/frida@17.6.2.patch",
    "frida@16.7.19": "patches/frida@16.7.19.patch"
  },
  "trustedDependencies": [
    "better-sqlite3",
    "frida",
    "frida16"
  ],
  "repository": {
    "type": "git",
    "url": "git+https://github.com/chichou/grapefruit.git"
  },
  "bugs": {
    "url": "https://github.com/chichou/grapefruit/issues"
  },
  "homepage": "https://github.com/chichou/grapefruit#readme"
}

```

`patches/frida@16.7.19.patch`:

```patch
diff --git a/build/src/frida.js b/build/src/frida.js
index c94aecabc1589e37746986d872ee2d34cb489222..08026d06877f94c9b29ba86182c90d4127586bd4 100644
--- a/build/src/frida.js
+++ b/build/src/frida.js
@@ -1,15 +1,8 @@
-import bindings from "bindings";
 import util from "util";
 import { Minimatch } from "minimatch";
 import { Duplex } from "stream";
 const { inspect } = util;
-const binding = bindings({
-    bindings: "frida_binding",
-    try: [
-        ["module_root", "build", "bindings"],
-        [process.cwd(), "bindings"],
-    ]
-});
+const binding = require('../../build/frida_binding.node');
 var MessageTypeImpl;
 (function (MessageTypeImpl) {
     MessageTypeImpl["Send"] = "send";

```

`patches/frida@17.6.2.patch`:

```patch
diff --git a/build/src/frida.js b/build/src/frida.js
index 0b047472199e9151691c52f03ffd36a85952234c..ee9395ae0a8307d8e5a9a31f8663d5d612683b0e 100644
--- a/build/src/frida.js
+++ b/build/src/frida.js
@@ -1,15 +1,8 @@
-import bindings from "bindings";
 import util from "util";
 import { Minimatch } from "minimatch";
 import { Duplex } from "stream";
 const { inspect } = util;
-const binding = bindings({
-    bindings: "frida_binding",
-    try: [
-        ["module_root", "build", "bindings"],
-        [process.cwd(), "bindings"],
-    ]
-});
+const binding = require('../../build/frida_binding.node');
 var MessageTypeImpl;
 (function (MessageTypeImpl) {
     MessageTypeImpl["Send"] = "send";

```

`scripts/build-bun.ts`:

```ts
#! /usr/bin/env bun

import path from "node:path";
import fs from "node:fs/promises";
import { $ } from "bun";

const bunTargets: Record<string, [string, string]> = {
  "bun-linux-x64": ["linux", "x64"],
  // "bun-linux-arm64": ["linux", "arm64"],
  "bun-windows-x64": ["win32", "x64"],
  "bun-darwin-x64": ["darwin", "x64"],
  "bun-darwin-arm64": ["darwin", "arm64"],
  // "bun-linux-x64-musl": ["linux", "x64"],
  // "bun-linux-arm64-musl": ["linux", "arm64"],
};

const root = path.join(import.meta.dirname, "..");

async function prebuild(
  cwd: string,
  platform: string = process.platform,
  arch: string = process.arch,
) {
  console.log("prebuild", cwd, "for", platform, arch);
  const binary = path.join(root, "node_modules", ".bin", "prebuild-install");
  await $`${process.execPath} ${binary} -r napi --arch ${arch} --platform ${platform}`.cwd(
    cwd,
  );
}

async function bunBuild(target?: string) {
  const name = target ? target.replace("bun-", "igf-") : "igf";
  const targetArgs: string[] = [];

  if (target) {
    console.log("build bun binary for:", target);
    targetArgs.push("--target");
    targetArgs.push(target);
  }

  await $`${process.execPath} build ${targetArgs} ${path.join(root, "src", "index.ts")} ${path.join(root, "assets.tgz")} --compile --outfile ${path.join(root, "build", "Release", name)}`;
}

async function main() {
  console.warn("this script is experimental and not well tested");

  const mode = process.argv[2] ?? "current";
  const cross = mode === "cross";

  if (!["current", "cross"].includes(mode)) {
    console.error("Usage: bun scripts/cross-build.ts [current|cross]");
    process.exit(1);
  }

  await $`tar cvf assets.tgz gui/dist agent/dist drizzle`;

  const fridaModules = ["frida", "frida16"];

  if (cross) {
    for (const [target, [platform, arch]] of Object.entries(bunTargets)) {
      // Prebuild BOTH frida modules for this target
      for (const name of fridaModules) {
        const cwd = path.join(root, "node_modules", name);
        await prebuild(cwd, platform, arch);
      }
      // Now build with both modules having correct prebuilds
      await bunBuild(target);
    }

    // Restore both prebuilds for host platform
    for (const name of fridaModules) {
      const cwd = path.join(root, "node_modules", name);
      await prebuild(cwd);
    }
  } else {
    // For non-cross build, just prebuild for current platform and build
    for (const name of fridaModules) {
      const cwd = path.join(root, "node_modules", name);
      await prebuild(cwd);
    }
    await bunBuild();
  }
}

main();

```

`scripts/build-npm.ts`:

```ts
#!/usr/bin/evn node

import fs from "node:fs/promises";

const resolve = (relative: string) =>
  new URL(relative, import.meta.url).pathname;

await fs.writeFile(resolve("../assets.tgz"), "");

```

`scripts/dev.ts`:

```ts
import cp from "node:child_process";
import os from "node:os";
import path from "node:path";

const isWindows = os.platform() === "win32";
const runner = process.env.npm_execpath || "bun";
const args = ["run", "dev"];

const subprojects = ["gui", "."] as const;
const subdirs = subprojects.map((name) =>
  path.join(import.meta.dirname, "..", name),
);

function tmux() {
  const argv = ["new-session"];
  for (const cwd of subdirs) {
    argv.push("-c", cwd, runner);
    argv.push(...args);
    argv.push(";", "split-window", "-h");
  }
  // last split-window
  argv.pop();
  argv.pop();
  // C-a space
  argv.push("next-layout");
  cp.spawnSync("tmux", argv, { stdio: "inherit" });
}

function wt() {
  const argv: string[] = [];
  for (const cwd of subdirs) {
    argv.push("-d", cwd, runner);
    argv.push(...args);
    argv.push(";", "new-tab");
  }
  argv.push("cmd", "/c", "echo OK");
  cp.spawn("wt", argv);
  process.exit(); // detach
}

async function main() {
  if (isWindows) {
    wt();
  } else {
    tmux();
  }
}

process.env.NDOE_ENV = "development";

main();

```

`scripts/prepare.ts`:

```ts
import { mkdir } from "node:fs/promises";
import { execSync } from "node:child_process";

await mkdir("./agent/dist", { recursive: true });

execSync(`bun i`, { cwd: "./agent", stdio: "inherit" });
execSync(`bun i`, { cwd: "./gui", stdio: "inherit" });

```

`scripts/skills.ts`:

```ts
import ts from "typescript";
import { readFileSync, writeFileSync, existsSync } from "fs";
import { resolve, dirname } from "path";

const AGENT_TYPES = resolve(import.meta.dirname!, "../agent/types");

// --- Types ---

interface ParamInfo {
  name: string;
  type: string;
}

interface FuncInfo {
  name: string;
  params: ParamInfo[];
  returnType: string;
}

interface TypeDef {
  name: string;
  text: string;
}

interface ModuleResult {
  functions: FuncInfo[];
  types: TypeDef[];
}

// --- TS AST Helpers ---

function parseFile(filePath: string): ts.SourceFile {
  const code = readFileSync(filePath, "utf-8");
  return ts.createSourceFile(filePath, code, ts.ScriptTarget.Latest, true);
}

function typeToString(
  node: ts.TypeNode | undefined,
  src: ts.SourceFile,
): string {
  if (!node) return "any";
  return node.getText(src);
}

function paramToInfo(
  param: ts.ParameterDeclaration,
  src: ts.SourceFile,
): ParamInfo {
  const name = param.name.getText(src);
  let type = typeToString(param.type, src);
  if (param.questionToken) type += " | undefined";
  if (param.initializer) type += " | undefined";
  return { name, type };
}

// --- Resolve import paths ---

function resolveImportPath(specifier: string, importerDir: string): string {
  if (specifier.startsWith("@/common/")) {
    const rel = specifier.slice("@/common/".length).replace(/\.js$/, ".d.ts");
    return resolve(AGENT_TYPES, "common", rel);
  }
  const rel = specifier.replace(/\.js$/, ".d.ts");
  return resolve(importerDir, rel);
}

// --- Extract module info ---

function extractModule(
  filePath: string,
  emittedTypes: Set<string>,
): ModuleResult {
  if (!existsSync(filePath)) return { functions: [], types: [] };

  const src = parseFile(filePath);
  const functions: FuncInfo[] = [];
  const types: TypeDef[] = [];
  const fileDir = dirname(filePath);

  // Check for `export * from` re-exports and follow them
  for (const stmt of src.statements) {
    if (
      ts.isExportDeclaration(stmt) &&
      !stmt.exportClause &&
      stmt.moduleSpecifier &&
      ts.isStringLiteral(stmt.moduleSpecifier)
    ) {
      const reExportPath = resolveImportPath(
        stmt.moduleSpecifier.text,
        fileDir,
      );
      const sub = extractModule(reExportPath, emittedTypes);
      functions.push(...sub.functions);
      types.push(...sub.types);
    }
  }

  // Extract from this file
  for (const stmt of src.statements) {
    // Function declarations: `export declare function name(...): Type;`
    if (ts.isFunctionDeclaration(stmt) && stmt.name) {
      const modifiers = ts.getModifiers(stmt);
      const isExported = modifiers?.some(
        (m) => m.kind === ts.SyntaxKind.ExportKeyword,
      );
      if (!isExported) continue;

      const params = stmt.parameters.map((p) => paramToInfo(p, src));
      let returnType = typeToString(stmt.type, src);
      functions.push({ name: stmt.name.text, params, returnType });
    }

    // Variable declarations: `declare const list: () => string[], status: () => ...;`
    // These export multiple functions via `export { list, status, ... }`
    if (ts.isVariableStatement(stmt)) {
      for (const decl of stmt.declarationList.declarations) {
        if (!decl.type || !ts.isIdentifier(decl.name)) continue;
        // Each declaration could be a comma-separated group of const with function types
        // The pattern is: `declare const list: () => string[], status: () => ...;`
        // TypeScript parser creates one VariableDeclaration per name in `const a: T, b: T`
        const name = decl.name.text;
        const typeNode = decl.type;
        if (ts.isFunctionTypeNode(typeNode)) {
          const params = typeNode.parameters.map((p) => paramToInfo(p, src));
          const returnType = typeToString(typeNode.type, src);
          functions.push({ name, params, returnType });
        }
      }
    }

    // Interfaces
    if (ts.isInterfaceDeclaration(stmt)) {
      const modifiers = ts.getModifiers(stmt);
      const isExported = modifiers?.some(
        (m) => m.kind === ts.SyntaxKind.ExportKeyword,
      );
      if (!isExported) continue;
      const name = stmt.name.text;
      if (!emittedTypes.has(name)) {
        emittedTypes.add(name);
        types.push({ name, text: stmt.getText(src) });
      }
    }

    // Type aliases
    if (ts.isTypeAliasDeclaration(stmt)) {
      const modifiers = ts.getModifiers(stmt);
      const isExported = modifiers?.some(
        (m) => m.kind === ts.SyntaxKind.ExportKeyword,
      );
      if (!isExported) continue;
      const name = stmt.name.text;
      if (!emittedTypes.has(name)) {
        emittedTypes.add(name);
        types.push({ name, text: stmt.getText(src) });
      }
    }

    // Enums
    if (ts.isEnumDeclaration(stmt)) {
      const modifiers = ts.getModifiers(stmt);
      const isExported = modifiers?.some(
        (m) => m.kind === ts.SyntaxKind.ExportKeyword,
      );
      if (!isExported) continue;
      const name = stmt.name.text;
      if (!emittedTypes.has(name)) {
        emittedTypes.add(name);
        types.push({ name, text: stmt.getText(src) });
      }
    }
  }

  // Handle the `declare const a: () => T, b: () => U;` single-statement pattern
  // The TS parser actually splits `const a: T, b: U` into one VariableStatement with
  // multiple declarations in the declarationList. Let's re-check this is handled above.
  // Actually, the parser may create a single VariableDeclaration with the entire text.
  // Let's also handle the case where `const` has multiple declarators:
  for (const stmt of src.statements) {
    if (ts.isVariableStatement(stmt)) {
      for (const decl of stmt.declarationList.declarations) {
        if (!ts.isIdentifier(decl.name)) continue;
        const name = decl.name.text;
        // Skip if already captured
        if (functions.some((f) => f.name === name)) continue;
        if (!decl.type) continue;
        if (ts.isFunctionTypeNode(decl.type)) {
          const params = decl.type.parameters.map((p) => paramToInfo(p, src));
          const returnType = typeToString(decl.type.type, src);
          functions.push({ name, params, returnType });
        }
      }
    }
  }

  // Also handle import + re-export type patterns like:
  // `import { type IntentOptions } from "../lib/intent.js";`
  // `export type { IntentOptions };`
  // We need to find the source and extract the type
  for (const stmt of src.statements) {
    if (
      ts.isExportDeclaration(stmt) &&
      stmt.exportClause &&
      ts.isNamedExports(stmt.exportClause) &&
      stmt.isTypeOnly
    ) {
      for (const el of stmt.exportClause.elements) {
        const exportedName = (el.name || el.propertyName)!.text;
        if (emittedTypes.has(exportedName)) continue;

        // Find the matching import
        let importPath: string | undefined;
        for (const s of src.statements) {
          if (
            ts.isImportDeclaration(s) &&
            s.moduleSpecifier &&
            ts.isStringLiteral(s.moduleSpecifier) &&
            s.importClause?.namedBindings &&
            ts.isNamedImports(s.importClause.namedBindings)
          ) {
            for (const binding of s.importClause.namedBindings.elements) {
              if (binding.name.text === exportedName) {
                importPath = resolveImportPath(s.moduleSpecifier.text, fileDir);
              }
            }
          }
        }

        // Also check re-export with module specifier: `export type { X } from "./y.js"`
        if (
          !importPath &&
          stmt.moduleSpecifier &&
          ts.isStringLiteral(stmt.moduleSpecifier)
        ) {
          importPath = resolveImportPath(stmt.moduleSpecifier.text, fileDir);
        }

        if (importPath && existsSync(importPath)) {
          const importedSrc = parseFile(importPath);
          for (const s of importedSrc.statements) {
            if (ts.isInterfaceDeclaration(s) && s.name.text === exportedName) {
              if (!emittedTypes.has(exportedName)) {
                emittedTypes.add(exportedName);
                types.push({
                  name: exportedName,
                  text: s.getText(importedSrc),
                });
              }
            }
            if (ts.isTypeAliasDeclaration(s) && s.name.text === exportedName) {
              if (!emittedTypes.has(exportedName)) {
                emittedTypes.add(exportedName);
                types.push({
                  name: exportedName,
                  text: s.getText(importedSrc),
                });
              }
            }
          }
        }
      }
    }
  }

  // Import type re-exports with rename: `export type { IntentOptions as BroadcastOptions };`
  for (const stmt of src.statements) {
    if (
      ts.isExportDeclaration(stmt) &&
      stmt.exportClause &&
      ts.isNamedExports(stmt.exportClause) &&
      stmt.isTypeOnly
    ) {
      for (const el of stmt.exportClause.elements) {
        if (!el.propertyName) continue; // no rename
        const originalName = el.propertyName.text;
        const exportedName = el.name.text;
        if (emittedTypes.has(exportedName)) continue;

        // Find the type under its original name in already-collected types
        const original = types.find((t) => t.name === originalName);
        if (original) {
          emittedTypes.add(exportedName);
          types.push({
            name: exportedName,
            text: original.text.replace(originalName, exportedName),
          });
        }
      }
    }
  }

  // Follow imports for types referenced in function signatures but not locally defined
  // e.g., `import type { TapInfo } from "@/common/taps.js"` used in return types
  const importMap = new Map<string, string>(); // typeName → resolved file path
  for (const stmt of src.statements) {
    if (
      ts.isImportDeclaration(stmt) &&
      stmt.moduleSpecifier &&
      ts.isStringLiteral(stmt.moduleSpecifier) &&
      stmt.importClause?.namedBindings &&
      ts.isNamedImports(stmt.importClause.namedBindings)
    ) {
      const resolvedPath = resolveImportPath(
        stmt.moduleSpecifier.text,
        fileDir,
      );
      for (const binding of stmt.importClause.namedBindings.elements) {
        const localName = binding.name.text;
        importMap.set(localName, resolvedPath);
      }
    }
  }

  // Collect all type names referenced in function signatures
  const referencedTypeNames = new Set<string>();
  for (const fn of functions) {
    const allStrings = [fn.returnType, ...fn.params.map((p) => p.type)];
    for (const s of allStrings) {
      // Extract identifiers that look like type references (PascalCase words)
      const matches = s.match(/\b[A-Z]\w+\b/g);
      if (matches) {
        for (const m of matches) referencedTypeNames.add(m);
      }
    }
  }

  // For referenced types not yet emitted, try to resolve from imports
  for (const typeName of referencedTypeNames) {
    if (emittedTypes.has(typeName)) continue;
    if (types.some((t) => t.name === typeName)) continue;

    const importFile = importMap.get(typeName);
    if (!importFile || !existsSync(importFile)) continue;

    const importedSrc = parseFile(importFile);
    for (const s of importedSrc.statements) {
      if (ts.isInterfaceDeclaration(s) && s.name.text === typeName) {
        emittedTypes.add(typeName);
        types.push({ name: typeName, text: s.getText(importedSrc) });
      }
      if (ts.isTypeAliasDeclaration(s) && s.name.text === typeName) {
        emittedTypes.add(typeName);
        types.push({ name: typeName, text: s.getText(importedSrc) });
      }
    }
  }

  return { functions, types };
}

// --- Parse router file ---

interface NamespaceInfo {
  name: string;
  importPath: string; // resolved absolute path to .d.ts
  category: "common" | "fruity" | "droid";
}

function parseRouter(
  routerPath: string,
  platform: "fruity" | "droid",
): NamespaceInfo[] {
  const src = parseFile(routerPath);
  const routerDir = dirname(routerPath);
  const namespaces: NamespaceInfo[] = [];

  for (const stmt of src.statements) {
    if (
      ts.isImportDeclaration(stmt) &&
      stmt.importClause &&
      ts.isStringLiteral(stmt.moduleSpecifier)
    ) {
      const specifier = stmt.moduleSpecifier.text;
      const name =
        stmt.importClause.name?.text ??
        (stmt.importClause.namedBindings &&
        ts.isNamespaceImport(stmt.importClause.namedBindings)
          ? stmt.importClause.namedBindings.name.text
          : undefined);

      if (!name) continue;

      const resolvedPath = resolveImportPath(specifier, routerDir);
      let category: "common" | "fruity" | "droid";
      if (specifier.startsWith("@/common/")) {
        category = "common";
      } else if (name === "taps") {
        // taps is identical on both platforms, treat as common
        category = "common";
      } else {
        category = platform;
      }

      namespaces.push({ name, importPath: resolvedPath, category });
    }
  }

  return namespaces;
}

// --- Unwrap Promise<T> for display ---

function unwrapReturn(returnType: string): string {
  const match = returnType.match(/^Promise<(.+)>$/s);
  if (match) return match[1];
  return returnType;
}

// --- Check if a return type references a named type we should show ---

function referencesType(returnType: string, typeName: string): boolean {
  // Simple heuristic: check if typeName appears as a word boundary in the return type
  const re = new RegExp(
    `\\b${typeName.replace(/[.*+?^${}()|[\]\\]/g, "\\$&")}\\b`,
  );
  return re.test(returnType);
}

// --- Generate markdown ---

function generateMarkdown(
  namespaces: Map<string, { filePath: string }>,
): string {
  const lines: string[] = [];
  const emittedTypes = new Set<string>();
  const shownTypes = new Set<string>();
  const sortedNames = [...namespaces.keys()].sort();

  for (const ns of sortedNames) {
    const { filePath } = namespaces.get(ns)!;
    const mod = extractModule(filePath, emittedTypes);

    if (mod.functions.length === 0) continue;

    lines.push(`## ${ns}`);
    lines.push("");

    for (const fn of mod.functions) {
      lines.push(`### ${ns}.${fn.name}`);
      lines.push("");

      // Invocation example
      const paramNames = fn.params.map((p) => p.name).join(", ");
      lines.push("```");
      lines.push(`invoke("${ns}", "${fn.name}", [${paramNames}])`);
      lines.push("```");
      lines.push("");

      // Parameter table
      if (fn.params.length > 0) {
        lines.push("| Param | Type |");
        lines.push("|-------|------|");
        for (const p of fn.params) {
          lines.push(`| ${p.name} | \`${p.type}\` |`);
        }
        lines.push("");
      }

      // Return type
      const rawReturn = fn.returnType;
      const displayReturn = unwrapReturn(rawReturn);
      lines.push(`Returns: \`${displayReturn}\``);
      lines.push("");

      // Show any referenced types (from return type and params), skip already shown
      const allTypeStrings = [displayReturn, ...fn.params.map((p) => p.type)];
      const referencedTypes = mod.types.filter(
        (t) =>
          !shownTypes.has(t.name) &&
          allTypeStrings.some((s) => referencesType(s, t.name)),
      );
      for (const t of referencedTypes) {
        shownTypes.add(t.name);
        lines.push("```typescript");
        lines.push(t.text);
        lines.push("```");
        lines.push("");
      }
    }
  }

  return lines.join("\n");
}

// --- Main ---

function main() {
  const fruityNs = parseRouter(
    resolve(AGENT_TYPES, "fruity/router.d.ts"),
    "fruity",
  );
  const droidNs = parseRouter(
    resolve(AGENT_TYPES, "droid/router.d.ts"),
    "droid",
  );

  // Deduplicate common namespaces (same namespace from both routers)
  const commonMap = new Map<string, { filePath: string }>();
  const fruityMap = new Map<string, { filePath: string }>();
  const droidMap = new Map<string, { filePath: string }>();

  for (const ns of fruityNs) {
    if (ns.category === "common") {
      commonMap.set(ns.name, { filePath: ns.importPath });
    } else {
      fruityMap.set(ns.name, { filePath: ns.importPath });
    }
  }

  for (const ns of droidNs) {
    if (ns.category === "common") {
      // Don't overwrite — same source files
      if (!commonMap.has(ns.name)) {
        commonMap.set(ns.name, { filePath: ns.importPath });
      }
    } else {
      droidMap.set(ns.name, { filePath: ns.importPath });
    }
  }

  const commonMd = generateMarkdown(commonMap);
  const fruityMd = generateMarkdown(fruityMap);
  const droidMd = generateMarkdown(droidMap);

  const outDir = resolve(import.meta.dirname!, "../skills");

  writeFileSync(resolve(outDir, "common.md"), commonMd);
  writeFileSync(resolve(outDir, "fruity.md"), fruityMd);
  writeFileSync(resolve(outDir, "droid.md"), droidMd);

  // Summary
  console.log(`common.md: ${commonMap.size} namespaces`);
  console.log(`fruity.md: ${fruityMap.size} namespaces`);
  console.log(`droid.md:  ${droidMap.size} namespaces`);
}

main();

```

`src/app.ts`:

```ts
import { readFile } from "node:fs/promises";

import { Hono } from "hono";
import { logger } from "hono/logger";
import { prettyJSON } from "hono/pretty-json";

import getVersion from "./lib/version.ts";
import env from "./lib/env.ts";
import { asset } from "./lib/assets.ts";

import deviceRoutes from "./routes/devices.ts";
import transferRoutes from "./routes/transfer.ts";
import dataRoutes from "./routes/data.ts";
import llmRoutes from "./routes/llm.ts";

const app = new Hono();

app.use(logger());
app.use("/api/*", prettyJSON());

const api = new Hono();

api.get("/version", async (c) => {
  const {
    default: { version },
  } = await import("../package.json", {
    with: { type: "json" },
  });

  return c.json({
    frida: await getVersion(env.frida === 16 ? "frida16" : "frida"),
    igf: version,
  });
});

api.get("/d.ts/pack", async (c) => {
  const p = await asset("agent", "dist", "types", `frida${env.frida}.json`);
  try {
    const data = await readFile(p, "utf8");
    return c.json(JSON.parse(data));
  } catch {
    return c.notFound();
  }
});

api.route("/", deviceRoutes);
api.route("/", transferRoutes);
api.route("/", dataRoutes);
api.route("/", llmRoutes);

app.route("/api", api);

export default app;

```

`src/bin.ts`:

```ts
import { parseArgs } from "node:util";
import { schema } from "./lib/cli.ts";
import { reset } from "./lib/reset.ts";

const args = parseArgs(schema);
if (args.values.help) {
  console.log(`
Usage: igf [command] [options]

Commands:
  reset              Remove all data, cache, config and log directories

Options:
  --frida <16 | 17>  Specify Frida version to use (default: 17)
  --host <host>      Host to bind the server (default: localhost)
  --port <port>      Port to bind the server (default: 31337)
  --dry-run          Preview what directories would be removed (with reset)
  --help, -h         Show this help message
  `);
  process.exit(0);
}

if (args.positionals.includes("reset")) {
  reset(Boolean(args.values["dry-run"]));
}

import("./index.ts");

```

`src/index.ts`:

```ts
import { serve } from "@hono/node-server";
import { serveStatic } from "@hono/node-server/serve-static";

import app from "./app.ts";
import attach from "./ws.ts";
import env from "./lib/env.ts";
import { asset } from "./lib/assets.ts";

{
  if (!["16", "17"].includes(String(env.frida))) {
    console.error(
      "Invalid Frida version specified. Use --frida 16 or --frida 17.",
    );
    process.exit(1);
  }
}

{
  function serveWeb(root: string) {
    app.use("/assets/*", serveStatic({ root }));
    app.use("/*", serveStatic({ root, path: "index.html" }));
  }

  // bug: when compiled by bun single-file executable, the runtime will set
  // NODE_ENV to "development". Does it make any sense?

  if (env.bunSEA || !env.dev) {
    serveWeb(await asset("gui", "dist"));
  }
}

const server = serve(
  {
    fetch: app.fetch,
    port: env.port,
    hostname: env.host,
  },
  (info) => {
    const host = info.family === "IPv6" ? `[${info.address}]` : info.address;
    console.info(`Server is running on http://${host}:${info.port}`);
    attach(server);
  },
);

for (const sig of ["SIGINT", "SIGTERM", "SIGBEAK"]) {
  process.on(sig, () => {
    console.log("received signal", sig);
    server.close();

    // force close
    process.exit();
  });
}

process
  .on("uncaughtException", (err) => {
    console.error("Uncaught Exception:", err);
  })
  .on("unhandledRejection", (reason, promise) => {
    console.error("Unhandled Rejection at:", promise, "reason:", reason);
  });

```

`src/lib/assets.ts`:

```ts
import fs from "node:fs/promises";
import path from "node:path";
import { readFile } from "node:fs/promises";

import env from "./env.ts";
import paths from "./paths.ts";

// bun does not support embedded directory as a tree
// extract assets when it's not present

async function extract(): Promise<string> {
  if (!globalThis.Bun) throw new Error("bun runtime required");

  // @ts-ignore embed file has no typing
  const tar: { default: string } = await import("../../assets.tgz", {
    with: { type: "file" },
  });

  // this name includes hash
  const name = tar.default.split("/").pop()!;
  const output = path.join(paths.cache, name);
  console.log("assets directory:", output);
  const exists = await fs
    .stat(output)
    .then((s) => s.isDirectory())
    .catch((e) => {
      if (e.code === "ENOENT") return false;
      throw e;
    });

  if (!exists) {
    const tarball = await Bun.file(tar.default).bytes();
    const archive = new Bun.Archive(tarball);
    await archive.extract(output);
  }

  return output;
}

let assetsRoot: string;

export async function asset(...components: string[]) {
  if (!assetsRoot) {
    if (env.bunSEA) {
      assetsRoot = await extract();
    } else {
      // workaround: tsdown flattens directory structure
      const basePath = env.production ? "../" : "../../";
      assetsRoot = new URL(basePath, import.meta.url).pathname;
    }
  }

  return path.join(assetsRoot, ...components);
}

export async function agent(name: string) {
  return asset("agent", "dist", name).then((p) => readFile(p + ".js", "utf8"));
}

```

`src/lib/cli.ts`:

```ts
import type { ParseArgsConfig } from "node:util";

export const schema: ParseArgsConfig = {
  args: process.argv.slice(2),
  options: {
    frida: { type: "string" },
    host: { type: "string" },
    port: { type: "string" },
    help: { type: "boolean", short: "h" },
    "dry-run": { type: "boolean" },
  },
  allowPositionals: true,
  strict: false,
};

```

`src/lib/env.ts`:

```ts
import { hostname } from "node:os";
import { parseArgs } from "node:util";

import { schema } from "./cli.ts";

const { values: argv } = parseArgs(schema);

const dev = process.env.NODE_ENV === "development";
const production = process.env.NODE_ENV === "production";

const mapping = { frida: "FRIDA_VERSION", host: "HOST", port: "PORT" } as const;
for (const [argKey, envKey] of Object.entries(mapping)) {
  if (argv[argKey as keyof typeof mapping] && process.env[envKey]) {
    console.warn(
      `Warning: Both command-line argument '--${argKey}' and environment variable
      '${envKey}' are set. The command-line argument will take precedence.`,
    );
  }
}

const defaultHost = dev ? hostname() : "localhost";
const host =
  (typeof argv.host === "string" ? argv.host : process.env.HOST) || defaultHost;
const port = parseInt(argv.port as string, 10) || 31337;
const frontend = dev ? 3000 : port;
const envAsNumber = (name: string, defaultValue: number) =>
  parseInt(process.env[name.toUpperCase()] || "0") || defaultValue;

const frida =
  parseInt(argv.frida as string, 10) || envAsNumber("FRIDA_VERSION", 17);

if (frida !== 16 && frida !== 17)
  throw new Error(`Invalid FRIDA_VERSION ${frida}, must be 16 or 17`);

const { dirname } = import.meta;
const bunSEA =
  process.platform === "win32"
    ? dirname?.includes("\\~BUN\\root")
    : dirname?.includes("/$bunfs/root");

export default {
  bunSEA,
  frida,
  dev,
  production,
  host,
  port: envAsNumber(dev ? "BACKEND_PORT" : "PORT", port),
  frontend: envAsNumber("WEB_PORT", frontend),
  timeout: envAsNumber("FRIDA_TIMEOUT", 1000),
};

```

`src/lib/har.ts`:

```ts
import fs from "node:fs";
import type { CapturedRequest } from "./store/nsurl.ts";

interface HARNameValue {
  name: string;
  value: string;
}

interface HAREntry {
  startedDateTime: string;
  time: number;
  request: {
    method: string;
    url: string;
    httpVersion: string;
    cookies: HARNameValue[];
    headers: HARNameValue[];
    queryString: HARNameValue[];
    postData?: { mimeType: string; text: string };
    headersSize: number;
    bodySize: number;
  };
  response: {
    status: number;
    statusText: string;
    httpVersion: string;
    cookies: HARNameValue[];
    headers: HARNameValue[];
    content: {
      size: number;
      mimeType: string;
      text?: string;
      encoding?: string;
    };
    redirectURL: string;
    headersSize: number;
    bodySize: number;
  };
  cache: Record<string, never>;
  timings: { send: number; wait: number; receive: number };
}

function headersToList(
  headers?: Record<string, string>,
): HARNameValue[] {
  if (!headers) return [];
  return Object.entries(headers).map(([name, value]) => ({ name, value }));
}

function parseQueryString(url: string): HARNameValue[] {
  try {
    const parsed = new URL(url);
    return Array.from(parsed.searchParams.entries()).map(([name, value]) => ({
      name,
      value,
    }));
  } catch {
    return [];
  }
}

const TEXT_MIME_PREFIXES = [
  "text/",
  "application/json",
  "application/xml",
  "application/javascript",
  "application/x-javascript",
  "application/ecmascript",
  "application/x-www-form-urlencoded",
  "application/xhtml+xml",
  "application/soap+xml",
  "application/graphql",
  "image/svg+xml",
];

function isTextMime(mimeType: string): boolean {
  const lower = mimeType.toLowerCase();
  return TEXT_MIME_PREFIXES.some((p) => lower.startsWith(p));
}

function readAttachment(
  path: string | null | undefined,
  mimeType: string,
): { text?: string; encoding?: string } {
  if (!path) return {};
  try {
    const buf = fs.readFileSync(path);
    if (buf.length === 0) return {};
    if (isTextMime(mimeType)) {
      return { text: buf.toString("utf-8") };
    }
    return { text: buf.toString("base64"), encoding: "base64" };
  } catch {
    return {};
  }
}

function statusText(code: number): string {
  const map: Record<number, string> = {
    200: "OK",
    201: "Created",
    204: "No Content",
    301: "Moved Permanently",
    302: "Found",
    304: "Not Modified",
    400: "Bad Request",
    401: "Unauthorized",
    403: "Forbidden",
    404: "Not Found",
    500: "Internal Server Error",
    502: "Bad Gateway",
    503: "Service Unavailable",
  };
  return map[code] ?? "";
}

export function toHAR(requests: CapturedRequest[]) {
  const entries: HAREntry[] = requests.map((req) => {
    const mime = req.mimeType ?? "";
    const body = readAttachment(req.attachment, mime);
    const requestBodySize = req.requestBody
      ? Buffer.byteLength(req.requestBody, "utf-8")
      : 0;

    return {
      startedDateTime: new Date(req.startTime).toISOString(),
      time: req.duration ?? 0,
      request: {
        method: req.method || "GET",
        url: req.url,
        httpVersion: "HTTP/1.1",
        cookies: [],
        headers: headersToList(req.requestHeaders),
        queryString: parseQueryString(req.url),
        ...(req.requestBody
          ? {
              postData: {
                mimeType:
                  req.requestHeaders?.["Content-Type"] ??
                  req.requestHeaders?.["content-type"] ??
                  "application/octet-stream",
                text: req.requestBody,
              },
            }
          : {}),
        headersSize: -1,
        bodySize: requestBodySize,
      },
      response: {
        status: req.statusCode ?? 0,
        statusText: statusText(req.statusCode ?? 0),
        httpVersion: "HTTP/1.1",
        cookies: [],
        headers: headersToList(req.responseHeaders),
        content: {
          size: req.size,
          mimeType: mime,
          ...body,
        },
        redirectURL: "",
        headersSize: -1,
        bodySize: req.size,
      },
      cache: {},
      timings: {
        send: 0,
        wait: req.duration ?? 0,
        receive: 0,
      },
    };
  });

  return {
    log: {
      version: "1.2",
      creator: { name: "igf", version: "1.0" },
      entries,
    },
  };
}

```

`src/lib/hash.ts`:

```ts
export function fnv1a(input: string): string {
  let hash = 0x811c9dc5;
  for (let i = 0; i < input.length; i++) {
    hash ^= input.charCodeAt(i);
    hash = (hash * 0x01000193) >>> 0;
  }
  return hash.toString(16).padStart(8, "0");
}

```

`src/lib/log-writer.ts`:

```ts
import fs from "node:fs/promises";
import path from "node:path";

import paths from "./paths.ts";

export class LogWriter {
  private syslog: fs.FileHandle;
  private agentLog: fs.FileHandle;

  private constructor(syslog: fs.FileHandle, agentLog: fs.FileHandle) {
    this.syslog = syslog;
    this.agentLog = agentLog;
  }

  static async open(deviceId: string, identifier: string): Promise<LogWriter> {
    const logsDir = path.join(paths.data, "logs", deviceId, identifier);
    await fs.mkdir(logsDir, { recursive: true });
    const [syslog, agentLog] = await Promise.all([
      fs.open(path.join(logsDir, "syslog.log"), "a"),
      fs.open(path.join(logsDir, "agent.log"), "a"),
    ]);
    return new LogWriter(syslog, agentLog);
  }

  appendSyslog(text: string) {
    this.syslog.appendFile(text + "\n");
  }

  appendAgentLog(level: string, text: string) {
    this.agentLog.appendFile(`[${level}] ${text}\n`);
  }

  async empty(type: "syslog" | "agent") {
    const handle = type === "syslog" ? this.syslog : this.agentLog;
    await handle.truncate(0);
  }

  async close() {
    await Promise.all([this.syslog.close(), this.agentLog.close()]).catch(
      () => {},
    );
  }
}

```

`src/lib/middleware.ts`:

```ts
import { createMiddleware } from "hono/factory";
import frida, { type Device } from "./xvii.ts";

export const getDeviceMiddleware = createMiddleware<{
  Variables: {
    device: Device;
    bundle?: string;
  };
}>(async (c, next) => {
  const deviceId = c.req.param("device");
  if (!deviceId) {
    return c.json({ error: "device not found" }, 404);
  }

  c.set("device", await frida.getDevice(deviceId));
  await next();
});

```

`src/lib/paths.ts`:

```ts
import fs from "node:fs";
import envPaths from "env-paths";

const paths = envPaths("ist.codecolor.grapefruit", { suffix: "" });

const keys = new Set(Object.keys(paths));
const proxy = new Proxy(paths, {
  get(target, prop, receiver) {
    const original = Reflect.get(target, prop, receiver);
    if (
      typeof prop === "string" &&
      keys.has(prop) &&
      !fs.existsSync(original)
    ) {
      fs.mkdirSync(original, { recursive: true });
    }

    return original;
  },
});

export default proxy;

```

`src/lib/regulation.ts`:

```ts
export function check(bundle: string): boolean {
  const rules = process.env.SKIP_BUNDLES?.split(",") || [
    "com.alibaba.",
    "com.alipay.",
    "com.antgroup",
    "com.taobao.",
    "com.alicloud.",
    "com.aliyun.",
    "com.tencent.",
    "com.ss.",
    "com.bytedance",
  ];

  for (const rule of rules)
    if (rule.length && bundle.startsWith(rule)) return true;

  return false;
}

```

`src/lib/reset.ts`:

```ts
import fs from "node:fs";
import { styleText } from "node:util";
import envPaths from "env-paths";

const paths = envPaths("ist.codecolor.grapefruit", { suffix: "" });

export function reset(dryRun: boolean) {
  const dirs = [paths.data, paths.cache, paths.config, paths.log];

  console.log("This command is going to reset your data, use it when you want to reset the settings or uninstall.");
  console.log(styleText("dim", "It's not going to remove your browser data related to Web UI."));

  if (dryRun) {
    console.log(styleText("yellow", "Dry run — the following directories would be removed:"));
  } else {
    console.log(styleText("red", "Resetting igf — removing all data:"));
  }

  console.log();
  let found = false;
  for (const dir of dirs) {
    if (fs.existsSync(dir)) {
      found = true;
      if (dryRun) {
        console.log(`  ${styleText("yellow", "would remove")}  ${dir}`);
      } else {
        console.log(`  ${styleText("red", "removing")}      ${dir}`);
        fs.rmSync(dir, { recursive: true, force: true });
      }
    }
  }

  console.log();
  if (!found) {
    console.log(styleText("green", "Nothing to clean up — already clean."));
  } else if (dryRun) {
    console.log(styleText("dim", "No files were deleted. Run without --dry-run to remove them."));
  } else {
    console.log(styleText("green", "Done."));
  }

  process.exit(0);
}

```

`src/lib/schema.ts`:

```ts
import { sql } from "drizzle-orm";
import {
  sqliteTable,
  text,
  integer,
  blob,
  index,
  uniqueIndex,
} from "drizzle-orm/sqlite-core";

export const preferences = sqliteTable("preferences", {
  key: text("key").primaryKey(),
  value: text("value"),
});

export const nsurlRequests = sqliteTable(
  "nsurl_requests",
  {
    id: integer("id").primaryKey({ autoIncrement: true }),
    deviceId: text("device_id").notNull(),
    identifier: text("identifier").notNull(),
    requestId: text("request_id").notNull(),
    data: text("data").notNull(),
    attachment: text("attachment"),
    mime: text("mime"),
    createdAt: text("created_at").default(sql`CURRENT_TIMESTAMP`),
    updatedAt: text("updated_at").default(sql`CURRENT_TIMESTAMP`),
  },
  (table) => [
    index("idx_nsurl_requests_device_identifier").on(
      table.deviceId,
      table.identifier,
    ),
    uniqueIndex("idx_nsurl_requests_request_id").on(
      table.deviceId,
      table.identifier,
      table.requestId,
    ),
  ],
);

export const hooks = sqliteTable(
  "hooks",
  {
    id: integer("id").primaryKey({ autoIncrement: true }),
    deviceId: text("device_id").notNull(),
    identifier: text("identifier").notNull(),
    timestamp: text("timestamp").notNull(),
    category: text("category").notNull(),
    symbol: text("symbol").notNull(),
    direction: text("direction").notNull(),
    line: text("line"),
    extra: text("extra"),
    createdAt: text("created_at").default(sql`CURRENT_TIMESTAMP`),
  },
  (table) => [
    index("idx_hooks_device_identifier").on(table.deviceId, table.identifier),
    index("idx_hooks_timestamp").on(table.timestamp),
    index("idx_hooks_category").on(table.category),
  ],
);

export const flutter = sqliteTable(
  "flutter",
  {
    id: integer("id").primaryKey({ autoIncrement: true }),
    deviceId: text("device_id").notNull(),
    identifier: text("identifier").notNull(),
    timestamp: text("timestamp").notNull(),
    type: text("type").notNull(),
    direction: text("direction").notNull(),
    channel: text("channel").notNull(),
    data: text("data"),
    createdAt: text("created_at").default(sql`CURRENT_TIMESTAMP`),
  },
  (table) => [
    index("idx_flutter_device_identifier").on(
      table.deviceId,
      table.identifier,
    ),
    index("idx_flutter_timestamp").on(table.timestamp),
  ],
);

export const jni = sqliteTable(
  "jni",
  {
    id: integer("id").primaryKey({ autoIncrement: true }),
    deviceId: text("device_id").notNull(),
    identifier: text("identifier").notNull(),
    timestamp: text("timestamp").notNull(),
    type: text("type").notNull(),
    method: text("method").notNull(),
    callType: text("call_type").notNull(),
    threadId: integer("thread_id"),
    args: text("args"),
    ret: text("ret"),
    backtrace: text("backtrace"),
    library: text("library"),
    createdAt: text("created_at").default(sql`CURRENT_TIMESTAMP`),
  },
  (table) => [
    index("idx_jni_device_identifier").on(
      table.deviceId,
      table.identifier,
    ),
    index("idx_jni_method").on(table.method),
    index("idx_jni_timestamp").on(table.timestamp),
  ],
);

export const xpcLogs = sqliteTable(
  "xpc_logs",
  {
    id: integer("id").primaryKey({ autoIncrement: true }),
    deviceId: text("device_id").notNull(),
    identifier: text("identifier").notNull(),
    timestamp: text("timestamp").notNull(),
    protocol: text("protocol").notNull(), // "xpc" | "nsxpc"
    event: text("event").notNull(), // "received" | "sent"
    direction: text("direction").notNull(), // "<" | ">"
    service: text("service"),
    peer: integer("peer"),
    message: text("message").notNull(), // JSON-serialized message
    backtrace: text("backtrace"),
    createdAt: text("created_at").default(sql`CURRENT_TIMESTAMP`),
  },
  (table) => [
    index("idx_xpc_logs_device_identifier").on(
      table.deviceId,
      table.identifier,
    ),
    index("idx_xpc_logs_timestamp").on(table.timestamp),
    index("idx_xpc_logs_protocol").on(table.protocol),
  ],
);

export const hermes = sqliteTable(
  "hbc",
  {
    id: integer("id").primaryKey({ autoIncrement: true }),
    deviceId: text("device_id").notNull(),
    identifier: text("identifier").notNull(),
    url: text("url").notNull(),
    hash: text("hash").notNull(),
    size: integer("size").notNull(),
    data: blob("data", { mode: "buffer" }).notNull(),
    createdAt: text("created_at").default(sql`CURRENT_TIMESTAMP`),
  },
  (table) => [
    index("idx_hbc_device_identifier").on(table.deviceId, table.identifier),
    uniqueIndex("idx_hbc_hash").on(table.hash),
    index("idx_hbc_created_at").on(table.createdAt),
  ],
);

export const crypto = sqliteTable(
  "crypto",
  {
    id: integer("id").primaryKey({ autoIncrement: true }),
    deviceId: text("device_id").notNull(),
    identifier: text("identifier").notNull(),
    timestamp: text("timestamp").notNull(),
    symbol: text("symbol").notNull(),
    direction: text("direction").notNull(),
    line: text("line"),
    extra: text("extra"),
    backtrace: text("backtrace"),
    data: blob("data", { mode: "buffer" }),
    createdAt: text("created_at").default(sql`CURRENT_TIMESTAMP`),
  },
  (table) => [
    index("idx_crypto_device_identifier").on(
      table.deviceId,
      table.identifier,
    ),
    index("idx_crypto_timestamp").on(table.timestamp),
  ],
);

```

`src/lib/serializer.ts`:

```ts
import frida, { type Device, type Application, type Process } from "./xvii.ts";

interface SerializedDevice {
  id: string;
  type: "usb" | "local" | "remote";
  removable: boolean;
  name: string;
}

interface SerializedApp {
  name: string;
  identifier: string;
  pid: number;
}

interface SerializedProcess {
  name: string;
  pid: number;
  path?: string;
  user?: string;
  ppid?: number;
  started?: string;
}

function isRemovable(dev: Device): boolean {
  return dev.type === frida.DeviceType.Remote && dev.name !== "Local Socket";
}

export function device(dev: Device): SerializedDevice {
  const { name, id, type } = dev;
  return {
    name,
    id,
    type,
    removable: isRemovable(dev),
  };
}

export function app(app: Application): SerializedApp {
  const { name, identifier, pid } = app;
  return {
    name,
    identifier,
    pid,
  };
}

export function process(proc: Process): SerializedProcess {
  const { name, pid, parameters } = proc;
  const params = parameters as {
    path?: string;
    user?: string;
    ppid?: number;
    started?: string;
  };
  return {
    name,
    pid,
    path: params.path,
    user: params.user,
    ppid: params.ppid,
    started: params.started,
  };
}

```

`src/lib/store/base.ts`:

```ts
import { eq, and, gt, desc, count as countFn, type SQL } from "drizzle-orm";
import type { SQLiteColumn, SQLiteTableWithColumns } from "drizzle-orm/sqlite-core";
import { db } from "./db.ts";

type LogTable = SQLiteTableWithColumns<{
  name: string;
  columns: {
    id: SQLiteColumn;
    deviceId: SQLiteColumn;
    identifier: SQLiteColumn;
    timestamp: SQLiteColumn;
  };
  schema: string | undefined;
  dialect: "sqlite";
}>;

export interface ExtraFilter {
  column: SQLiteColumn;
  queryParam: string;
}

export class BaseLogStore<TTable extends LogTable> {
  constructor(
    protected table: TTable,
    protected deviceId: string,
    protected identifier: string,
    protected extraFilters: ExtraFilter[] = [],
  ) {}

  query(
    options: {
      limit?: number;
      offset?: number;
      since?: string;
      [key: string]: unknown;
    } = {},
    defaultLimit = 1000,
  ): TTable["$inferSelect"][] {
    const { limit = defaultLimit, offset = 0, since, ...rest } = options;

    const conditions: SQL[] = [
      eq(this.table.deviceId, this.deviceId),
      eq(this.table.identifier, this.identifier),
    ];

    if (since) {
      conditions.push(gt(this.table.timestamp, since));
    }

    for (const filter of this.extraFilters) {
      const value = rest[filter.queryParam];
      if (value !== undefined && value !== null) {
        conditions.push(eq(filter.column, value));
      }
    }

    return db
      .select()
      .from(this.table)
      .where(and(...conditions))
      .orderBy(desc(this.table.id))
      .limit(limit)
      .offset(offset)
      .all() as TTable["$inferSelect"][];
  }

  count(filterValues?: Record<string, unknown>): number {
    const conditions: SQL[] = [
      eq(this.table.deviceId, this.deviceId),
      eq(this.table.identifier, this.identifier),
    ];

    if (filterValues) {
      for (const filter of this.extraFilters) {
        const value = filterValues[filter.queryParam];
        if (value !== undefined && value !== null) {
          conditions.push(eq(filter.column, value));
        }
      }
    }

    const result = db
      .select({ count: countFn() })
      .from(this.table)
      .where(and(...conditions))
      .get();

    return result?.count ?? 0;
  }

  rm(): void {
    db.delete(this.table)
      .where(
        and(
          eq(this.table.deviceId, this.deviceId),
          eq(this.table.identifier, this.identifier),
        ),
      )
      .run();
  }
}

```

`src/lib/store/crypto.ts`:

```ts
import { crypto } from "../schema.ts";
import { db } from "./db.ts";
import { BaseLogStore } from "./base.ts";

export type CryptoRecord = typeof crypto.$inferSelect;

export class CryptoStore extends BaseLogStore<typeof crypto> {
  constructor(deviceId: string, identifier: string) {
    super(crypto, deviceId, identifier);
  }

  append(message: Record<string, unknown>, data?: Buffer | null): void {
    const extra = message.extra as Record<string, unknown> | undefined;
    const btrace = message.backtrace as string[] | undefined;
    db.insert(crypto)
      .values({
        deviceId: this.deviceId,
        identifier: this.identifier,
        timestamp: new Date().toISOString(),
        symbol: (message.symbol as string) || "unknown",
        direction: (message.dir as string) || "unknown",
        line: (message.line as string) || null,
        extra: extra ? JSON.stringify(extra) : null,
        backtrace: btrace?.length ? JSON.stringify(btrace) : null,
        data: data ?? null,
      })
      .run();
  }
}

```

`src/lib/store/db.ts`:

```ts
import path from "node:path";

import type { BaseSQLiteDatabase } from "drizzle-orm/sqlite-core";
import * as schema from "../schema.ts";
import paths from "../paths.ts";
import { asset } from "../assets.ts";

const dbPath = path.join(paths.data, "data.db");
const migrationsFolder = await asset("drizzle");

// workaround to support both bun and node.js runtime
export const db: BaseSQLiteDatabase<"sync", any, typeof schema> =
  await (async () => {
    if (typeof globalThis.Bun === "undefined") {
      const { default: Database } = (await import("better-sqlite3")) as any;
      const { drizzle } = await import("drizzle-orm/better-sqlite3");
      const { migrate } = await import("drizzle-orm/better-sqlite3/migrator");
      const db = drizzle(new Database(dbPath), { schema });
      migrate(db, { migrationsFolder });
      return db;
    }

    const { drizzle } = await import("drizzle-orm/bun-sqlite");
    const { migrate } = await import("drizzle-orm/bun-sqlite/migrator");
    const db = drizzle(dbPath, { schema });
    migrate(db, { migrationsFolder });
    return db;
  })();

```

`src/lib/store/flutter.ts`:

```ts
import { flutter } from "../schema.ts";
import { db } from "./db.ts";
import { BaseLogStore } from "./base.ts";

export type FlutterRecord = typeof flutter.$inferSelect;

export class FlutterStore extends BaseLogStore<typeof flutter> {
  constructor(deviceId: string, identifier: string) {
    super(flutter, deviceId, identifier);
  }

  append(event: Record<string, unknown>): void {
    const { type, dir, channel, ...rest } = event;
    db.insert(flutter)
      .values({
        deviceId: this.deviceId,
        identifier: this.identifier,
        timestamp: new Date().toISOString(),
        type: (type as string) || "unknown",
        direction: (dir as string) || "unknown",
        channel: (channel as string) || "unknown",
        data: Object.keys(rest).length > 0 ? JSON.stringify(rest) : null,
      })
      .run();
  }
}

```

`src/lib/store/hermes.ts`:

```ts
import { eq, and, desc, count as countFn } from "drizzle-orm";
import { hermes } from "../schema.ts";
import { db } from "./db.ts";

export type HermesRecord = typeof hermes.$inferSelect;

export class HermesStore {
  constructor(
    private deviceId: string,
    private identifier: string,
  ) {}

  append(
    message: { url: string; hash: string; size: number },
    data: Buffer,
  ): void {
    db.insert(hermes)
      .values({
        deviceId: this.deviceId,
        identifier: this.identifier,
        url: message.url,
        hash: message.hash,
        size: message.size,
        data,
      })
      .onConflictDoNothing()
      .run();
  }

  query(options: {
    limit?: number;
    offset?: number;
  } = {}): HermesRecord[] {
    const { limit = 100, offset = 0 } = options;

    return db
      .select()
      .from(hermes)
      .where(
        and(
          eq(hermes.deviceId, this.deviceId),
          eq(hermes.identifier, this.identifier),
        ),
      )
      .orderBy(desc(hermes.id))
      .limit(limit)
      .offset(offset)
      .all() as HermesRecord[];
  }

  count(): number {
    const result = db
      .select({ count: countFn() })
      .from(hermes)
      .where(
        and(
          eq(hermes.deviceId, this.deviceId),
          eq(hermes.identifier, this.identifier),
        ),
      )
      .get();

    return result?.count ?? 0;
  }

  getBlob(id: number): { data: Buffer; url: string } | null {
    const row = db
      .select({ data: hermes.data, url: hermes.url })
      .from(hermes)
      .where(
        and(
          eq(hermes.id, id),
          eq(hermes.deviceId, this.deviceId),
          eq(hermes.identifier, this.identifier),
        ),
      )
      .get();

    if (!row) return null;
    return { data: Buffer.from(row.data), url: row.url };
  }

  rmOne(id: number): void {
    db.delete(hermes)
      .where(
        and(
          eq(hermes.id, id),
          eq(hermes.deviceId, this.deviceId),
          eq(hermes.identifier, this.identifier),
        ),
      )
      .run();
  }

  rm(): void {
    db.delete(hermes)
      .where(
        and(
          eq(hermes.deviceId, this.deviceId),
          eq(hermes.identifier, this.identifier),
        ),
      )
      .run();
  }
}

```

`src/lib/store/hooks.ts`:

```ts
import { hooks } from "../schema.ts";
import { db } from "./db.ts";
import { BaseLogStore } from "./base.ts";

export type HookRecord = typeof hooks.$inferSelect;

export class HookStore extends BaseLogStore<typeof hooks> {
  constructor(deviceId: string, identifier: string) {
    super(hooks, deviceId, identifier, [
      { column: hooks.category, queryParam: "category" },
    ]);
  }

  append(message: Record<string, unknown>): void {
    const extra = message.extra as Record<string, unknown> | undefined;
    db.insert(hooks)
      .values({
        deviceId: this.deviceId,
        identifier: this.identifier,
        timestamp: new Date().toISOString(),
        category: (message.category as string) || "unknown",
        symbol: (message.symbol as string) || "unknown",
        direction: (message.dir as string) || "unknown",
        line: (message.line as string) || null,
        extra: extra ? JSON.stringify(extra) : null,
      })
      .run();
  }
}

```

`src/lib/store/jni.ts`:

```ts
import { jni } from "../schema.ts";
import { db } from "./db.ts";
import { BaseLogStore } from "./base.ts";
import type { JNIEvent } from "@agent/droid/hooks/jni";

export type JNIRecord = typeof jni.$inferSelect;

export class JNIStore extends BaseLogStore<typeof jni> {
  constructor(deviceId: string, identifier: string) {
    super(jni, deviceId, identifier, [
      { column: jni.method, queryParam: "method" },
    ]);
  }

  append(event: JNIEvent): void {
    const { subject: _, ...rest } = event;
    db.insert(jni)
      .values({
        deviceId: this.deviceId,
        identifier: this.identifier,
        timestamp: new Date().toISOString(),
        type: rest.type,
        method: rest.method,
        callType: rest.callType,
        threadId: rest.threadId,
        args: Array.isArray(rest.args) ? JSON.stringify(rest.args) : null,
        ret: rest.ret,
        backtrace: null,
        library: rest.library ?? null,
      })
      .run();
  }
}

```

`src/lib/store/nsurl.ts`:

```ts
import { randomUUID } from "node:crypto";
import fs from "node:fs";
import nodePath from "node:path";
import { eq, and, desc, count as countFn } from "drizzle-orm";

import { nsurlRequests } from "../schema.ts";
import { db } from "./db.ts";
import paths from "../paths.ts";

interface WebSocketMessage {
  direction: "send" | "receive";
  messageType: "data" | "string";
  message?: string;
  dataLength?: number;
  error?: string;
  timestamp: number;
}

export interface CapturedRequest {
  id: string;
  method: string;
  url: string;
  statusCode?: number;
  mimeType?: string;
  size: number;
  startTime: number;
  endTime?: number;
  duration?: number;
  requestHeaders: Record<string, string>;
  responseHeaders?: Record<string, string>;
  requestBody?: string;
  error?: string;
  mechanism?: string;
  isWebSocket?: boolean;
  wsMessages?: WebSocketMessage[];
  attachment?: string | null;
}

export interface NSURLEvent {
  event: string;
  requestId: string;
  timestamp: number;
  [key: string]: unknown;
}

function merge(req: CapturedRequest, event: NSURLEvent): void {
  switch (event.event) {
    case "requestWillBeSent": {
      const r = event.request as
        | {
            method: string;
            url: string;
            headers: Record<string, string>;
            body?: string;
          }
        | undefined;
      if (!r) break;
      req.method = r.method;
      req.url = r.url;
      req.requestHeaders = r.headers || {};
      req.requestBody = r.body;
      break;
    }
    case "responseReceived": {
      const r = event.response as
        | {
            url?: string;
            mimeType?: string;
            statusCode?: number;
            headers?: Record<string, string>;
          }
        | undefined;
      if (!r) break;
      req.statusCode = r.statusCode;
      req.mimeType = r.mimeType;
      req.responseHeaders = r.headers;
      if (r.url && !req.url) req.url = r.url;
      break;
    }
    case "dataReceived": {
      try {
        req.size += Number(event.dataLength);
      } catch {
        /* ignore */
      }
      break;
    }
    case "loadingFinished": {
      req.endTime = event.timestamp;
      req.duration = event.timestamp - req.startTime;
      break;
    }
    case "loadingFailed": {
      req.error = event.error as string | undefined;
      req.endTime = event.timestamp;
      req.duration = event.timestamp - req.startTime;
      break;
    }
    case "mechanism": {
      req.mechanism = event.mechanism as string | undefined;
      break;
    }
    case "webSocketSend":
    case "webSocketReceive": {
      req.isWebSocket = true;
      if (!req.method) req.method = "WS";
      if (!req.wsMessages) req.wsMessages = [];
      req.wsMessages.push({
        direction: event.event === "webSocketSend" ? "send" : "receive",
        messageType: (event.messageType as "data" | "string") ?? "data",
        message: event.message as string | undefined,
        dataLength: event.dataLength ? Number(event.dataLength) : undefined,
        error: event.error as string | undefined,
        timestamp: event.timestamp,
      });
      break;
    }
  }
}

export class NSURLStore {
  constructor(
    private deviceId: string,
    private identifier: string,
  ) {}

  get attachmentsDir(): string {
    return nodePath.join(paths.cache, this.deviceId, this.identifier);
  }

  upsert(event: NSURLEvent): string | null {
    const requestId = event.requestId || "unknown";

    const existing = db
      .select({
        data: nsurlRequests.data,
        attachment: nsurlRequests.attachment,
      })
      .from(nsurlRequests)
      .where(
        and(
          eq(nsurlRequests.deviceId, this.deviceId),
          eq(nsurlRequests.identifier, this.identifier),
          eq(nsurlRequests.requestId, requestId),
        ),
      )
      .get();

    let req: CapturedRequest;
    let attachment: string | null;

    if (existing) {
      req = JSON.parse(existing.data);
      attachment = existing.attachment;
    } else {
      req = {
        id: requestId,
        method: "",
        url: "",
        requestHeaders: {},
        size: 0,
        startTime: event.timestamp,
      };
      attachment = nodePath.join(this.attachmentsDir, randomUUID());
    }

    merge(req, event);
    req.attachment = attachment;

    db.insert(nsurlRequests)
      .values({
        deviceId: this.deviceId,
        identifier: this.identifier,
        requestId,
        data: JSON.stringify(req),
        attachment,
        mime: req.mimeType ?? null,
      })
      .onConflictDoUpdate({
        target: [
          nsurlRequests.deviceId,
          nsurlRequests.identifier,
          nsurlRequests.requestId,
        ],
        set: {
          data: JSON.stringify(req),
          mime: req.mimeType ?? null,
          updatedAt: new Date().toISOString(),
        },
      })
      .run();

    return attachment;
  }

  query(options: { limit?: number; offset?: number } = {}): CapturedRequest[] {
    const { limit = 5000, offset = 0 } = options;

    const rows = db
      .select({
        data: nsurlRequests.data,
        attachment: nsurlRequests.attachment,
      })
      .from(nsurlRequests)
      .where(
        and(
          eq(nsurlRequests.deviceId, this.deviceId),
          eq(nsurlRequests.identifier, this.identifier),
        ),
      )
      .orderBy(desc(nsurlRequests.id))
      .limit(limit)
      .offset(offset)
      .all();

    return rows.map((r) => {
      const req = JSON.parse(r.data) as CapturedRequest;
      req.attachment = r.attachment ?? null;
      return req;
    });
  }

  getAttachment(requestId: string): {
    path: string;
    mimeType?: string;
  } | null {
    const row = db
      .select({ attachment: nsurlRequests.attachment, mime: nsurlRequests.mime })
      .from(nsurlRequests)
      .where(
        and(
          eq(nsurlRequests.deviceId, this.deviceId),
          eq(nsurlRequests.identifier, this.identifier),
          eq(nsurlRequests.requestId, requestId),
        ),
      )
      .get();

    if (!row?.attachment) return null;

    return { path: row.attachment, mimeType: row.mime ?? undefined };
  }

  count(): number {
    const result = db
      .select({ count: countFn() })
      .from(nsurlRequests)
      .where(
        and(
          eq(nsurlRequests.deviceId, this.deviceId),
          eq(nsurlRequests.identifier, this.identifier),
        ),
      )
      .get();

    return result?.count ?? 0;
  }

  rm(): void {
    const rows = db
      .select({ attachment: nsurlRequests.attachment })
      .from(nsurlRequests)
      .where(
        and(
          eq(nsurlRequests.deviceId, this.deviceId),
          eq(nsurlRequests.identifier, this.identifier),
        ),
      )
      .all();

    rows.forEach((row) => {
      if (!row.attachment) return;
      fs.promises.unlink(row.attachment).catch(() => {});
    });

    db.delete(nsurlRequests)
      .where(
        and(
          eq(nsurlRequests.deviceId, this.deviceId),
          eq(nsurlRequests.identifier, this.identifier),
        ),
      )
      .run();
  }
}

```

`src/lib/store/preferences.ts`:

```ts
import { eq } from "drizzle-orm";
import { preferences } from "../schema.ts";
import { db } from "./db.ts";

export function set(key: string, value: any): void {
  db.insert(preferences)
    .values({ key, value: JSON.stringify(value) })
    .onConflictDoUpdate({
      target: preferences.key,
      set: { value: JSON.stringify(value) },
    })
    .run();
}

export function get(key: string): any {
  const row = db
    .select({ value: preferences.value })
    .from(preferences)
    .where(eq(preferences.key, key))
    .get();
  if (row?.value) {
    return JSON.parse(row.value);
  }
  return null;
}

export function rm(key: string): void {
  db.delete(preferences).where(eq(preferences.key, key)).run();
}

export function purge(): void {
  db.delete(preferences).run();
}

```

`src/lib/store/taps.ts`:

```ts
import * as preferences from "./preferences.ts";
import type { TapRule } from "@agent/common/taps";

export function createTapStore(deviceId: string, identifier: string) {
  const key = `taps:${deviceId}|${identifier}`;
  return {
    save(rules: TapRule[]): void {
      preferences.set(key, rules);
    },
    load(): TapRule[] | null {
      return preferences.get(key) as TapRule[] | null;
    },
    clear(): void {
      preferences.rm(key);
    },
  };
}

```

`src/lib/store/xpc.ts`:

```ts
import { xpcLogs } from "../schema.ts";
import { db } from "./db.ts";
import { BaseLogStore } from "./base.ts";

export type XPCRecord = typeof xpcLogs.$inferSelect;

export class XPCStore extends BaseLogStore<typeof xpcLogs> {
  constructor(deviceId: string, identifier: string) {
    super(xpcLogs, deviceId, identifier, [
      { column: xpcLogs.protocol, queryParam: "protocol" },
    ]);
  }

  append(payload: Record<string, unknown>): void {
    const message = payload.message as Record<string, unknown> | undefined;
    const isNsxpc = message?.type === "nsxpc";
    const backtrace = payload.backtrace as string[] | undefined;

    db.insert(xpcLogs)
      .values({
        deviceId: this.deviceId,
        identifier: this.identifier,
        timestamp: new Date().toISOString(),
        protocol: isNsxpc ? "nsxpc" : "xpc",
        event: (payload.event as string) || "unknown",
        direction: (payload.dir as string) || "unknown",
        service: (payload.name as string) || null,
        peer: (payload.peer as number) || null,
        message: message ? JSON.stringify(message) : "{}",
        backtrace: backtrace?.length ? JSON.stringify(backtrace) : null,
      })
      .run();
  }
}

```

`src/lib/transport.ts`:

```ts
import RemoteStreamController from "frida-remote-stream";
import type { Device, ScriptExports, ScriptMessageHandler } from "./xvii.ts";
import { agent } from "./assets.ts";

export class Transport {
  constructor(
    public readonly script: {
      exports: ScriptExports;
      unload: () => Promise<void>;
      message: { connect: (handler: ScriptMessageHandler) => void };
      post: (message: object, data?: Buffer | null) => void;
    },
    public readonly session: { detach: () => Promise<void> },
    public readonly controller: RemoteStreamController,
  ) {}

  async close(): Promise<void> {
    await this.script.unload();
    await this.session.detach();
  }
}

export async function create(device: Device, pid: number): Promise<Transport> {
  const agentSource = await agent("transport");
  const session = await device.attach(pid);
  const script = await session.createScript(agentSource);
  await script.load();

  const controller = new RemoteStreamController();
  controller.events.on("send", ({ stanza, data }) => {
    script.post(
      {
        type: "+stream",
        payload: stanza,
      },
      data,
    );
  });

  script.message.connect((message, data) => {
    if (message.type === "send") {
      const stanza = message.payload as {
        payload: { [key: string]: any };
        name: string;
      };
      if (stanza.name === "+stream") {
        controller.receive({
          stanza: stanza.payload,
          data,
        });
      }
    }
  });

  return new Transport(script, session, controller);
}

```

`src/lib/version.ts`:

```ts
import path from "path";
import { fileURLToPath, pathToFileURL } from "url";

export default async function get(pkg: string) {
  const {
    default: { version },
  } = await pkgJSON(pkg);
  return version;
}

async function pkgJSON(pkg: string): Promise<{ default: { version: string } }> {
  return import(path.join(pkg, "package.json")).catch((_) => {
    const abs = fileURLToPath(import.meta.resolve(pkg));
    const needle = "node_modules" + path.sep;
    const index = abs.lastIndexOf(needle);
    const prefix = abs.substring(0, index + needle.length);
    const url = pathToFileURL(path.join(prefix, pkg, "package.json")).href;
    return import(url, {
      with: { type: "json" },
    });
  });
}

```

`src/lib/xvii.ts`:

```ts
/**
 * compatibility layer for frida v16 and v17
 */

import env from "./env.ts";

type FridaModule = typeof import("frida");

const m: FridaModule =
  env.frida === 16
    ? ((await import("frida16")) as unknown as FridaModule)
    : await import("frida");

export type * from "frida";
export default m;

```

`src/relay.ts`:

```ts
import { createHash } from "node:crypto";
import fs from "node:fs";
import { styleText } from "node:util";

import { asset } from "./lib/assets.ts";
import type { LogWriter } from "./lib/log-writer.ts";
import type { NSURLEvent } from "./lib/store/nsurl.ts";
import type { SessionSocket, SessionStores } from "./types.ts";

async function loadBridge(name: string) {
  const valid = ["objc", "java", "swift"];
  const lower = name.toLowerCase();

  if (!valid.includes(lower)) throw new Error(`Invalid bridge name: ${name}`);

  const p = await asset("agent", "dist", "bridges", `${lower}.js`);
  const source = await fs.promises.readFile(p, "utf8");
  return { filename: `${name}.js`, source };
}

export function setup(
  socket: SessionSocket,
  script: Awaited<
    ReturnType<typeof import("frida").Session.prototype.createScript>
  >,
  logger: LogWriter,
  stores: SessionStores,
) {
  const requestsWithBody = new Set<string>();

  script.destroyed.connect(() => {
    console.error("script is destroyed");
    socket.disconnect(true);
  });

  script.message.connect((message, data) => {
    if (message.type === "error") {
      console.error("script error:", message);
      return;
    }

    if (message.type !== "send") return;

    const { payload } = message;
    const { subject } = payload as { subject: string };

    switch (subject) {
      case "frida:load-bridge":
        loadBridge(payload.name)
          .then((result) =>
            script.post({ type: "frida:bridge-loaded", ...result }),
          )
          .catch((err) =>
            console.error(`Failed to load bridge ${payload.name}:`, err),
          );
        break;

      case "syslog":
        if (data) {
          const text = data.toString();
          console.log(`[syslog]`, text);
          socket.emit("syslog", text);
          logger.appendSyslog(text);
        }
        break;

      case "nsurl": {
        const event = payload as NSURLEvent;

        if (event.event === "dataReceived" && data) {
          requestsWithBody.add(event.requestId);
        }

        if (
          event.event === "loadingFinished" &&
          requestsWithBody.has(event.requestId)
        ) {
          event.hasBody = true;
          requestsWithBody.delete(event.requestId);
        }

        if (event.event === "loadingFailed") {
          requestsWithBody.delete(event.requestId);
        }

        socket.emit("nsurl", event);
        try {
          const attachment = stores.nsurl.upsert(event);
          if (attachment && data) {
            fs.promises
              .mkdir(stores.nsurl.attachmentsDir, { recursive: true })
              .then(() => fs.promises.appendFile(attachment, Buffer.from(data)))
              .catch((e) => console.error("Failed to write attachment:", e));
          }
        } catch (e) {
          console.error("Failed to persist NSURL event:", e);
        }
        break;
      }

      case "flutter": {
        const { subject: _, ...event } = payload;
        socket.emit("flutter", event);
        stores.flutter.append(event);
        break;
      }

      case "xpc": {
        const { subject: _, ...event } = payload;
        socket.emit("xpc", event);
        stores.xpc.append(payload);
        break;
      }

      case "jni": {
        const { subject: _, ...event } = payload;
        socket.emit("jni", event);
        stores.jni.append(payload);
        break;
      }

      case "hermes": {
        const buf = data ? Buffer.from(data) : Buffer.alloc(0);
        const hash = createHash("sha256").update(buf).digest("hex");
        const hermesEvent = { url: payload.url as string, hash, size: buf.length };
        socket.emit("hermes", hermesEvent);
        stores.hermes.append(hermesEvent, buf);
        break;
      }

      case "hook":
        socket.emit("hook", payload);
        stores.hooks.append(payload);
        break;

      case "memoryScan":
        socket.emit(
          "memoryScan",
          payload,
          data ? new Uint8Array(data).buffer : undefined,
        );
        break;

      case "crypto":
        socket.emit(
          "crypto",
          payload,
          data ? new Uint8Array(data).buffer : undefined,
        );
        stores.crypto.append(payload, data ?? null);
        break;

      case "fatal":
        console.error(
          styleText("redBright", "fatal error from agent:"),
          payload.detail,
        );
        socket.emit("fatal", payload.detail);
        break;

      case "lifecycle":
        socket.emit(subject, payload.event);
        break;

      default:
        console.debug("send", payload);
    }
  });

  script.logHandler = (level, text) => {
    console.log(`[agent][${level}] ${text}`);
    socket.emit("log", level, text);
    logger.appendAgentLog(level, text);
  };
}

```

`src/routes/data.ts`:

```ts
import { Hono } from "hono";

import fs from "node:fs/promises";
import { createReadStream } from "node:fs";
import { Readable } from "node:stream";
import nodePath from "node:path";

import paths from "../lib/paths.ts";
import { HookStore } from "../lib/store/hooks.ts";
import { CryptoStore } from "../lib/store/crypto.ts";
import { NSURLStore } from "../lib/store/nsurl.ts";
import { FlutterStore } from "../lib/store/flutter.ts";
import { JNIStore } from "../lib/store/jni.ts";
import { XPCStore } from "../lib/store/xpc.ts";
import { HermesStore } from "../lib/store/hermes.ts";
import { createTapStore } from "../lib/store/taps.ts";
import { toHAR } from "../lib/har.ts";
const LOG_TAIL_BYTES = 1024 * 1024; // 1MB

interface LogStore<TRecord> {
  query(options: Record<string, unknown>, defaultLimit: number): TRecord[];
  count(filterValues?: Record<string, unknown>): number;
  rm(): void;
}

/**
 * Factory to create GET + DELETE route pair for a DB-backed log store.
 */
function createHistoryRoutes<TRecord>(config: {
  path: string;
  createStore: (deviceId: string, identifier: string) => LogStore<TRecord>;
  responseKey: string;
  defaultLimit: number;
  mapRecord: (record: TRecord) => unknown;
  extraQueryParams?: string[];
}) {
  const app = new Hono();

  app.get(`/${config.path}/:device/:identifier`, (c) => {
    const deviceId = c.req.param("device");
    const identifier = c.req.param("identifier");

    const limit = parseInt(
      c.req.query("limit") || String(config.defaultLimit),
      10,
    );
    const offset = parseInt(c.req.query("offset") || "0", 10);
    const since = c.req.query("since");

    const extraParams: Record<string, string | undefined> = {};
    for (const param of config.extraQueryParams ?? []) {
      extraParams[param] = c.req.query(param);
    }

    try {
      const store = config.createStore(deviceId, identifier);

      const records = store.query(
        { limit, offset, since, ...extraParams },
        config.defaultLimit,
      );
      const mapped = records.map(config.mapRecord);

      // Build count filter from extra params
      const countFilter: Record<string, unknown> = {};
      for (const param of config.extraQueryParams ?? []) {
        if (extraParams[param]) countFilter[param] = extraParams[param];
      }
      const total = store.count(
        Object.keys(countFilter).length > 0 ? countFilter : undefined,
      );

      return c.json({ [config.responseKey]: mapped, total, limit, offset });
    } catch (e) {
      console.error(`Failed to query ${config.path}:`, e);
      return c.json({ [config.responseKey]: [], total: 0, limit, offset });
    }
  });

  app.delete(`/${config.path}/:device/:identifier`, (c) => {
    const deviceId = c.req.param("device");
    const identifier = c.req.param("identifier");

    try {
      config.createStore(deviceId, identifier).rm();
      return c.body(null, 204);
    } catch (e) {
      console.error(`Failed to clear ${config.path}:`, e);
      return c.text(`Failed to clear ${config.path}`, 500);
    }
  });

  return app;
}

const hookRoutes = createHistoryRoutes({
  path: "hooks",
  createStore: (d, i) => new HookStore(d, i),
  responseKey: "hooks",
  defaultLimit: 1000,
  extraQueryParams: ["category"],
  mapRecord: (r) => ({
    id: r.id,
    timestamp: r.timestamp,
    category: r.category,
    symbol: r.symbol,
    direction: r.direction,
    line: r.line,
    extra: r.extra ? JSON.parse(r.extra) : undefined,
    createdAt: r.createdAt,
  }),
});

const cryptoRoutes = createHistoryRoutes({
  path: "history/crypto",
  createStore: (d, i) => new CryptoStore(d, i),
  responseKey: "logs",
  defaultLimit: 1000,
  mapRecord: (r) => ({
    id: r.id,
    timestamp: r.timestamp,
    symbol: r.symbol,
    direction: r.direction,
    line: r.line,
    extra: r.extra ? JSON.parse(r.extra) : undefined,
    backtrace: r.backtrace ? JSON.parse(r.backtrace) : undefined,
    data: r.data ? Buffer.from(r.data).toString("base64") : undefined,
    createdAt: r.createdAt,
  }),
});

const jniRoutes = createHistoryRoutes({
  path: "history/jni",
  createStore: (d, i) => new JNIStore(d, i),
  responseKey: "logs",
  defaultLimit: 5000,
  extraQueryParams: ["method"],
  mapRecord: (r) => ({
    id: r.id,
    timestamp: r.timestamp,
    type: r.type,
    method: r.method,
    callType: r.callType,
    threadId: r.threadId,
    args: r.args ? JSON.parse(r.args) : undefined,
    ret: r.ret,
    backtrace: r.backtrace ? JSON.parse(r.backtrace) : undefined,
    library: r.library,
    createdAt: r.createdAt,
  }),
});

const flutterRoutes = createHistoryRoutes({
  path: "history/flutter",
  createStore: (d, i) => new FlutterStore(d, i),
  responseKey: "logs",
  defaultLimit: 5000,
  mapRecord: (r) => ({
    id: r.id,
    timestamp: r.timestamp,
    type: r.type,
    direction: r.direction,
    channel: r.channel,
    data: r.data ? JSON.parse(r.data) : undefined,
    createdAt: r.createdAt,
  }),
});

const xpcRoutes = createHistoryRoutes({
  path: "history/xpc",
  createStore: (d, i) => new XPCStore(d, i),
  responseKey: "logs",
  defaultLimit: 5000,
  extraQueryParams: ["protocol"],
  mapRecord: (r) => ({
    id: r.id,
    timestamp: r.timestamp,
    protocol: r.protocol,
    event: r.event,
    direction: r.direction,
    service: r.service,
    peer: r.peer,
    message: r.message ? JSON.parse(r.message) : undefined,
    backtrace: r.backtrace ? JSON.parse(r.backtrace) : undefined,
    createdAt: r.createdAt,
  }),
});

const routes = new Hono()
  .get("/logs/:device/:identifier/:type", async (c) => {
    const deviceId = c.req.param("device");
    const identifier = c.req.param("identifier");
    const type = c.req.param("type");

    if (!["syslog", "agent"].includes(type)) {
      return c.text("invalid log type", 400);
    }

    const filename = `${type}.log`;
    const logPath = nodePath.join(
      paths.data,
      "logs",
      deviceId,
      identifier,
      filename,
    );

    const stat = await fs.stat(logPath).catch(() => null);
    if (!stat) return c.text("");

    const { size } = stat;

    if (c.req.query("download")) {
      c.header(
        "Content-Disposition",
        `attachment; filename="${identifier}-${filename}"`,
      );
      c.header("Content-Type", "text/plain");
      c.header("Content-Length", size.toString());
      return c.body(
        Readable.toWeb(createReadStream(logPath)) as unknown as ReadableStream,
      );
    }

    if (size <= LOG_TAIL_BYTES)
      return c.text(await fs.readFile(logPath, "utf-8"));

    const handle = await fs.open(logPath, "r");
    const buf = Buffer.alloc(LOG_TAIL_BYTES);

    try {
      await handle.read(buf, 0, LOG_TAIL_BYTES, size - LOG_TAIL_BYTES);
      const chunk = buf.toString("utf-8");
      const idx = chunk.indexOf("\n");
      return c.text(idx === -1 ? chunk : chunk.slice(idx + 1));
    } finally {
      await handle.close();
    }
  })
  .delete("/logs/:device/:identifier", async (c) => {
    const deviceId = c.req.param("device");
    const identifier = c.req.param("identifier");

    const logsDir = nodePath.join(paths.data, "logs", deviceId, identifier);
    await fs.rm(logsDir, { recursive: true, force: true });

    return c.body(null, 204);
  })
  // DB-backed log stores
  .route("/", hookRoutes)
  .route("/", cryptoRoutes)
  .route("/", jniRoutes)
  .route("/", flutterRoutes)
  // NSURL endpoints (not factored — different pattern)
  .get("/history/nsurl/:device/:identifier/har", (c) => {
    const deviceId = c.req.param("device");
    const identifier = c.req.param("identifier");

    try {
      const nsurlStore = new NSURLStore(deviceId, identifier);
      const requests = nsurlStore.query({ limit: 10000, offset: 0 });
      const har = toHAR(requests);

      c.header(
        "Content-Disposition",
        `attachment; filename="${identifier}.har"`,
      );
      return c.json(har);
    } catch (e) {
      console.error("Failed to export HAR:", e);
      return c.text("Failed to export HAR", 500);
    }
  })
  .get("/history/nsurl/:device/:identifier", (c) => {
    const deviceId = c.req.param("device");
    const identifier = c.req.param("identifier");

    const limit = parseInt(c.req.query("limit") || "5000", 10);
    const offset = parseInt(c.req.query("offset") || "0", 10);

    try {
      const nsurlStore = new NSURLStore(deviceId, identifier);

      const requests = nsurlStore.query({ limit, offset });
      const total = nsurlStore.count();

      return c.json({ requests, total, limit, offset });
    } catch (e) {
      console.error("Failed to query NSURL records:", e);
      return c.json({ requests: [], total: 0, limit, offset });
    }
  })
  .delete("/history/nsurl/:device/:identifier", (c) => {
    const deviceId = c.req.param("device");
    const identifier = c.req.param("identifier");

    try {
      new NSURLStore(deviceId, identifier).rm();
      return c.body(null, 204);
    } catch (e) {
      console.error("Failed to clear NSURL records:", e);
      return c.text("Failed to clear NSURL records", 500);
    }
  })
  .get(
    "/history/nsurl/:device/:identifier/attachment/:requestId",
    async (c) => {
      const deviceId = c.req.param("device");
      const identifier = c.req.param("identifier");
      const requestId = c.req.param("requestId");

      try {
        const nsurlStore = new NSURLStore(deviceId, identifier);

        const attachment = nsurlStore.getAttachment(requestId);

        if (!attachment) {
          return c.text("No attachment found", 404);
        }

        const stat = await fs.stat(attachment.path).catch(() => null);
        if (!stat) {
          return c.text("Attachment file not found", 404);
        }

        c.header(
          "Content-Type",
          attachment.mimeType || "application/octet-stream",
        );
        c.header("Content-Length", stat.size.toString());
        return c.body(
          Readable.toWeb(
            createReadStream(attachment.path),
          ) as unknown as ReadableStream,
        );
      } catch (e) {
        console.error("Failed to serve attachment:", e);
        return c.text("Failed to serve attachment", 500);
      }
    },
  )
  .route("/", xpcRoutes)
  // Hermes capture endpoints
  .get("/hermes/:device/:identifier", (c) => {
    const deviceId = c.req.param("device");
    const identifier = c.req.param("identifier");
    const limit = parseInt(c.req.query("limit") || "100", 10);
    const offset = parseInt(c.req.query("offset") || "0", 10);

    try {
      const store = new HermesStore(deviceId, identifier);
      const records = store.query({ limit, offset });
      const total = store.count();

      return c.json({
        logs: records.map((r) => ({
          id: r.id,
          url: r.url,
          hash: r.hash,
          size: r.size,
          createdAt: r.createdAt,
        })),
        total,
        limit,
        offset,
      });
    } catch (e) {
      console.error("Failed to query Hermes records:", e);
      return c.json({ logs: [], total: 0, limit, offset });
    }
  })
  .get("/hermes/:device/:identifier/download/:id", (c) => {
    const deviceId = c.req.param("device");
    const identifier = c.req.param("identifier");
    const id = parseInt(c.req.param("id"), 10);

    try {
      const store = new HermesStore(deviceId, identifier);
      const blob = store.getBlob(id);
      if (!blob) return c.text("Not found", 404);

      const filename = blob.url.split("/").pop() || `hermes-${id}.bin`;
      c.header("Content-Disposition", `attachment; filename="${filename}"`);
      c.header("Content-Type", "application/octet-stream");
      c.header("Content-Length", blob.data.length.toString());
      return c.body(new Uint8Array(blob.data).buffer as ArrayBuffer);
    } catch (e) {
      console.error("Failed to serve Hermes blob:", e);
      return c.text("Failed to serve Hermes blob", 500);
    }
  })
  .delete("/hermes/:device/:identifier/:id", (c) => {
    const deviceId = c.req.param("device");
    const identifier = c.req.param("identifier");
    const id = Number(c.req.param("id"));

    try {
      new HermesStore(deviceId, identifier).rmOne(id);
      return c.body(null, 204);
    } catch (e) {
      console.error("Failed to delete Hermes record:", e);
      return c.text("Failed to delete Hermes record", 500);
    }
  })
  .delete("/hermes/:device/:identifier", (c) => {
    const deviceId = c.req.param("device");
    const identifier = c.req.param("identifier");

    try {
      new HermesStore(deviceId, identifier).rm();
      return c.body(null, 204);
    } catch (e) {
      console.error("Failed to clear Hermes records:", e);
      return c.text("Failed to clear Hermes records", 500);
    }
  })
  // Taps snapshot endpoints
  .get("/taps/:device/:identifier", (c) => {
    const deviceId = c.req.param("device");
    const identifier = c.req.param("identifier");

    const store = createTapStore(deviceId, identifier);
    const snapshot = store.load();
    if (!snapshot) {
      return c.json(null);
    }
    return c.json(snapshot);
  })
  .delete("/taps/:device/:identifier", (c) => {
    const deviceId = c.req.param("device");
    const identifier = c.req.param("identifier");

    createTapStore(deviceId, identifier).clear();
    return c.body(null, 204);
  });

export default routes;

```

`src/routes/devices.ts`:

```ts
import { Hono } from "hono";
import frida from "../lib/xvii.ts";
import {
  app as serializeApp,
  device as serializeDevice,
  process as serializeProcess,
} from "../lib/serializer.ts";
import { getDeviceMiddleware } from "../lib/middleware.ts";
import env from "../lib/env.ts";

const manager = frida.getDeviceManager();

const routes = new Hono()
  .get("/devices", async (c) => {
    const skip = new Set(["local", "socket", "barebone"]);
    const devices = await frida.enumerateDevices();
    return c.json(
      devices.filter((dev) => !skip.has(dev.id)).map(serializeDevice),
    );
  })
  .get("/device/:device/apps", getDeviceMiddleware, async (c) => {
    const device = c.get("device");
    const apps = await device.enumerateApplications();
    return c.json(apps.map(serializeApp));
  })
  .get("/device/:device/processes", getDeviceMiddleware, async (c) => {
    const device = c.get("device");
    const processes = await device.enumerateProcesses({
      scope: frida.Scope.Metadata,
    });
    // filter out launchd for safety
    return c.json(
      processes
        .filter((proc) => proc.pid !== 1 && proc.name !== "launchd")
        .map(serializeProcess),
    );
  })
  .get("/device/:device/icon/:bundle", async (c) => {
    const deviceId = c.req.param("device");
    const bundle = c.req.param("bundle");

    if (!deviceId) {
      return c.text("device not found", 404);
    }

    const device = await frida.getDevice(deviceId);
    const apps = await device
      .enumerateApplications({
        identifiers: [bundle],
        scope: frida.Scope.Full,
      })
      .catch(() => []);

    const app = apps.at(0);
    if (!app) {
      return c.text("application not found", 404);
    }

    const { icons } = app.parameters as {
      icons?: { format: string; image: Buffer }[];
    };

    if (icons && icons.length) {
      const ico = icons.find((i) => i.format === "png");
      if (ico && ico.image) {
        c.header("Content-Type", "image/png");
        c.header("Cache-Control", "public, max-age=604800"); // 7 days
        return c.body(new Uint8Array(ico.image));
      }
    }

    return c.text("icon not found", 404);
  })
  .get("/device/:device/info", getDeviceMiddleware, async (c) => {
    const device = c.get("device");
    return c.json(await device.querySystemParameters());
  })
  .post("/device/:device/kill/:pid", getDeviceMiddleware, async (c) => {
    const device = c.get("device");
    const pid = parseInt(c.req.param("pid"), 10);
    if (isNaN(pid)) {
      return c.json({ error: "invalid pid" }, 400);
    }
    try {
      await device.kill(pid);
      return c.body(null, 204);
    } catch (e) {
      console.error("Failed to kill process:", e);
      return c.json({ error: "failed to kill process" }, 500);
    }
  })
  .put("/devices/remote/:hostname", async (c) => {
    const hostname = c.req.param("hostname");
    await manager.addRemoteDevice(hostname);
    return c.body(null, 204);
  })
  .delete("/devices/remote/:hostname", async (c) => {
    const hostname = c.req.param("hostname");
    const deviceExists = await manager
      .getDeviceById(hostname, env.timeout)
      .then((dev) => dev.type === "remote")
      .catch(() => false);

    if (deviceExists) {
      const prefix = "socket@";
      const host = hostname.substring(prefix.length);
      await manager.removeRemoteDevice(host);
      return c.body(null, 204);
    } else {
      return c.json({ error: "remote device not found" }, 404);
    }
  });

export default routes;

```

`src/routes/llm.ts`:

```ts
import { styleText } from "node:util";
import { Hono } from "hono";

const provider = (process.env.LLM_PROVIDER || "") as Provider;
const apiKey = process.env.LLM_API_KEY || "";
const model = process.env.LLM_MODEL || "";

const endpoints = {
  anthropic: "https://api.anthropic.com",
  openai: "https://api.openai.com",
  gemini: "https://generativelanguage.googleapis.com",
  openrouter: "https://openrouter.ai/api",
} as const;

type Provider = keyof typeof endpoints;

if (provider) {
  if (!(provider in endpoints)) {
    console.warn(
      "LLM provider not configured or unknown. Set LLM_PROVIDER environment variable to one of: " +
        Object.keys(endpoints).join(", "),
    );
  } else {
    console.debug(styleText("dim", "llm configuration:"));
    console.debug(styleText("yellow", `  provider: ${provider}`));
    console.debug(styleText("yellow", `  model: ${model}`));
  }
}

function buildRequest(input: string) {
  const endpoint = endpoints[provider];
  const headers: Record<string, string> = {
    "Content-Type": "application/json",
  };

  if (provider === "anthropic") {
    headers["x-api-key"] = apiKey;
    headers["anthropic-version"] = "2023-06-01";
    return {
      url: `${endpoint}/v1/messages`,
      headers,
      body: JSON.stringify({
        model,
        max_tokens: 4096,
        messages: [{ role: "user", content: input }],
      }),
    };
  }

  if (provider === "gemini") {
    return {
      url: `${endpoint}/v1beta/models/${model}:generateContent?key=${apiKey}`,
      headers,
      body: JSON.stringify({
        contents: [{ parts: [{ text: input }] }],
      }),
    };
  }

  // openai & openrouter share the same chat completions format
  headers["Authorization"] = `Bearer ${apiKey}`;
  return {
    url: `${endpoint}/v1/chat/completions`,
    headers,
    body: JSON.stringify({
      model,
      messages: [{ role: "user", content: input }],
    }),
  };
}

function extractText(json: unknown): string {
  const data = json as Record<string, unknown>;

  if (provider === "anthropic") {
    const content = (
      data.content as Array<{ type: string; text: string }>
    )?.[0];
    return content?.text ?? "";
  }

  if (provider === "gemini") {
    const candidates = data.candidates as Array<{
      content: { parts: Array<{ text: string }> };
    }>;
    return candidates?.[0]?.content?.parts?.[0]?.text ?? "";
  }

  // openai / openrouter
  const choices = data.choices as Array<{
    message: { content: string };
  }>;
  return choices?.[0]?.message?.content ?? "";
}

async function llm(input: string): Promise<string> {
  if (!provider || !apiKey || !model) {
    throw new Error(
      "LLM not configured. Set LLM_PROVIDER, LLM_API_KEY, and LLM_MODEL environment variables.",
    );
  }

  if (!(provider in endpoints)) {
    throw new Error(
      `Unknown LLM provider: ${provider}. Supported: ${Object.keys(endpoints).join(", ")}`,
    );
  }

  const { url, headers, body } = buildRequest(input);

  const res = await fetch(url, { method: "POST", headers, body });
  if (!res.ok) {
    const text = await res.text().catch(() => "");
    throw new Error(`LLM request failed (${res.status}): ${text}`);
  }

  const json = await res.json();
  return extractText(json);
}

const routes = new Hono().post("/llm", async (c) => {
  const input = await c.req.text();
  if (!input.trim()) return c.text("", 400);

  try {
    return c.text(await llm(input));
  } catch (e) {
    console.error("failed to get LLM response:", e);
    return c.text(e instanceof Error ? e.message : "unknown error", 500);
  }
});

export default routes;

```

`src/routes/transfer.ts`:

```ts
import { Hono } from "hono";
import { stream } from "hono/streaming";
import { Readable } from "node:stream";
import { create as createTransport } from "../lib/transport.ts";
import { getDeviceMiddleware } from "../lib/middleware.ts";

const routes = new Hono()
  .get("/download/:device/:pid", getDeviceMiddleware, async (c) => {
    const path = c.req.query("path");
    if (typeof path !== "string") return c.text("invalid path", 400);

    // need upstream frida-fs to support { start, end } in fs.createReadStream
    if (c.req.header("Range")) {
      return c.text("range download not implemented", 501);
    }

    const device = c.get("device");
    const pid = parseInt(c.req.param("pid"), 10);
    const transport = await createTransport(device, pid);
    const { script, controller } = transport;

    let size: number;
    try {
      size = await script.exports.len(path);
    } catch (e) {
      console.error(e);
      return c.text("file not found", 404);
    }

    c.header("Content-Length", size.toString());
    c.header(
      "Content-Disposition",
      `attachment; filename="${path.split("/").pop()}"`,
    );

    return stream(c, async (streamer) => {
      await Promise.all([
        new Promise<void>((resolve) => {
          controller.events.on("stream", async (incomingStream: Readable) => {
            for await (const chunk of incomingStream) {
              await streamer.write(chunk);
            }
            await transport.close();
            resolve();
          });
        }),
        script.exports.pull(path),
      ]);
    });
  })
  .on(["HEAD", "GET"], "/dump/:device/:pid", getDeviceMiddleware, async (c) => {
    const path = c.req.query("path");
    if (typeof path !== "string") return c.text("invalid path", 400);

    const device = c.get("device");
    const pid = parseInt(c.req.param("pid"), 10);
    const transport = await createTransport(device, pid);
    const { script } = transport;

    let size: number;
    try {
      size = await script.exports.len(path);
    } catch (e) {
      console.error(e);
      await transport.close();
      return c.text("file not found", 404);
    }

    c.header("Content-Length", size.toString());
    c.header(
      "Content-Disposition",
      `attachment; filename="${path.split("/").pop()}"`,
    );

    if (c.req.method === "HEAD") {
      await transport.close();
      return c.body(null);
    }

    return stream(c, (streamer) => {
      return new Promise<void>((resolve, reject) => {
        script.message.connect((message, data) => {
          if (message.type !== "send") return;
          const event = message.payload as { event: string; message?: string; size?: number };

          switch (event.event) {
            case "info":
              script.post({ type: "ack" });
              break;
            case "data":
              if (data) streamer.write(new Uint8Array(data));
              script.post({ type: "ack" });
              break;
            case "end":
              resolve();
              break;
            case "error":
              reject(new Error(event.message ?? "dump failed"));
              break;
          }
        });

        // no need to await this, the real resolve happens
        // in the message handler once the process is complete
        script.exports.dump(path).catch(reject);
      }).finally(() => transport.close());
    });
  })
  .post("/upload/:device/:pid", getDeviceMiddleware, async (c) => {
    const formBody = await c.req.parseBody();
    const path = formBody["path"];
    if (typeof path !== "string") return c.text("invalid path", 400);

    const device = c.get("device");
    const pid = parseInt(c.req.param("pid"), 10);
    const transport = await createTransport(device, pid);
    const { script, controller } = transport;

    const file = formBody["file"];
    if (!(file instanceof File)) return c.text("invalid request", 400);

    // Set up agent recv() handler before sending any stream messages
    await script.exports.push(path);

    await new Promise<void>((resolve, reject) => {
      const writable = controller.open(`${pid}:${path}`, {
        meta: { type: "data" },
      });

      writable.on("error", reject);
      writable.on("finish", () => resolve());

      const reader = file.stream().getReader();
      const pump = () => {
        reader.read().then(({ done, value }) => {
          if (done) {
            writable.end();
            return;
          }
          if (!writable.write(value)) {
            writable.once("drain", pump);
          } else {
            pump();
          }
        }, reject);
      };
      pump();
    });

    await transport.close();

    return c.text("upload complete");
  });

export default routes;

```

`src/session.ts`:

```ts
import { SessionDetachReason, type SpawnOptions, type Device } from "frida";

import frida from "./lib/xvii.ts";
import env from "./lib/env.ts";
import { agent } from "./lib/assets.ts";
import { check as isRestrictedBundle } from "./lib/regulation.ts";
import { LogWriter } from "./lib/log-writer.ts";
import { fnv1a } from "./lib/hash.ts";
import { NSURLStore } from "./lib/store/nsurl.ts";
import { HookStore } from "./lib/store/hooks.ts";
import { CryptoStore } from "./lib/store/crypto.ts";
import { FlutterStore } from "./lib/store/flutter.ts";
import { JNIStore } from "./lib/store/jni.ts";
import { XPCStore } from "./lib/store/xpc.ts";
import { HermesStore } from "./lib/store/hermes.ts";
import { createTapStore } from "./lib/store/taps.ts";
import { setup as setupRelay } from "./relay.ts";
import type {
  Platform,
  SessionParams,
  SessionSocket,
  SessionStores,
} from "./types.ts";

const manager = frida.getDeviceManager();

export { manager };

async function resolveAppPid(
  device: Device,
  bundleId: string,
  platform: Platform,
): Promise<number> {
  const match = await device.enumerateApplications({
    identifiers: [bundleId],
    scope: frida.Scope.Full,
  });

  const app = match.at(0);
  if (!app) throw new Error(`Application ${bundleId} not found on device`);

  const frontmost = await device.getFrontmostApplication();
  if (frontmost?.pid === app.pid) return app.pid;

  const devParams = await device.querySystemParameters();
  const opt: SpawnOptions = {};

  if (platform === "fruity") {
    if (devParams.access === "full" && devParams.os.id === "ios") {
      opt.env = {
        DISABLE_TWEAKS: "1", // workaround for ellekit crash
      };
    }
  }

  return device.spawn(bundleId, opt);
}

function setupSocketHandlers(
  socket: SessionSocket,
  script: Awaited<
    ReturnType<typeof import("frida").Session.prototype.createScript>
  >,
  session: Awaited<ReturnType<typeof import("frida").Device.prototype.attach>>,
  logger: LogWriter,
  tapStore: ReturnType<typeof createTapStore>,
) {
  session.detached.connect((reason, crash) => {
    console.error("session detached:", reason, crash);
    switch (reason) {
      case SessionDetachReason.ApplicationRequested:
        break;
      case SessionDetachReason.DeviceLost:
        console.error("device lost");
        break;
      case SessionDetachReason.ProcessTerminated:
      case SessionDetachReason.ProcessReplaced:
        console.error("process was terminated or replaced");
    }
    socket.emit("detached", reason as string);
    socket.disconnect(true);
  });

  socket
    .on("rpc", (ns, method, args, ack) => {
      if (
        typeof ns !== "string" ||
        typeof method !== "string" ||
        !Array.isArray(args)
      ) {
        console.warn(`invalid RPC call ${ns}.${method}, dropping`, args);
        return;
      }

      console.info(`RPC method: ${ns}.${method}`, ...args);
      script.exports
        .invoke(ns, method, args)
        .then(
          (result) => ack(null, result),
          (err: Error) => {
            console.error(`RPC method ${method} failed:`, err);
            ack(err, null);
          },
        )
        .then(() => {
          // Auto-persist after tap toggles (runs on success OR failure,
          // because start() may partially succeed before throwing)
          if (ns === "taps" && (method === "start" || method === "stop")) {
            script.exports
              .snapshot()
              .then((snap: any) => tapStore.save(snap))
              .catch((e: unknown) =>
                console.warn("Failed to persist tap snapshot:", e),
              );
          }
        })
        .catch((err: Error) => {
          console.error(`RPC method ${method} failed:`, err);
          ack(err, null);
        });
    })
    .on("eval", (source, name, ack) => {
      console.info(`evaluating script: ${name}`);
      script.exports
        .invoke("script", "evaluate", [source, name])
        .then((result: unknown) => ack(null, result))
        .catch((err: Error) => ack(err, null));
    })
    .on("clearLog", (type, ack) => {
      logger
        .empty(type)
        .then(() => ack(null, true))
        .catch((err) => ack(err, null));
    })
    .on("disconnect", () => {
      console.info("socket disconnected");
      script
        .unload()
        .finally(() => session.detach())
        .finally(() => logger.close());
    });
}

export function parse(query: Record<string, unknown>): SessionParams | null {
  const { device, platform, mode, bundle, pid, name } = query;

  if (typeof device !== "string") return null;
  if (platform !== "fruity" && platform !== "droid") return null;
  if (mode !== "app" && mode !== "daemon") return null;

  if (mode === "app" && typeof bundle !== "string") return null;
  if (mode === "daemon" && typeof pid !== "string") return null;

  return {
    deviceId: device,
    platform: platform as Platform,
    mode: mode as "app" | "daemon",
    bundle: mode === "app" ? (bundle as string) : undefined,
    pid: mode === "daemon" ? parseInt(pid as string, 10) : undefined,
    name: typeof name === "string" ? name : undefined,
  };
}

export async function connect(socket: SessionSocket, params: SessionParams) {
  const {
    platform,
    mode,
    deviceId,
    bundle,
    pid: targetPid,
    name: processName,
  } = params;
  const device = await manager.getDeviceById(deviceId, env.timeout);

  let pid: number;
  if (mode === "app") {
    if (!bundle) throw new Error("bundle is required for app mode");

    if (isRestrictedBundle(bundle)) {
      socket.emit("denied");
      setTimeout(() => socket.disconnect(true), 100);
      return;
    }

    pid = await resolveAppPid(device, bundle, platform);
  } else {
    if (!targetPid) throw new Error("pid is required for daemon mode");
    pid = targetPid;
  }

  const session = await device.attach(pid);

  if (mode === "app") {
    await device.resume(pid).catch(() => {});
  }

  // Compute project identifier
  let identifier: string;
  if (mode === "app") {
    identifier = bundle!;
  } else {
    const pname = processName || `pid`;
    identifier = `${pname}-${fnv1a(pname + pid)}`;
  }

  // Create store instances
  const stores: SessionStores = {
    nsurl: new NSURLStore(deviceId, identifier),
    hooks: new HookStore(deviceId, identifier),
    crypto: new CryptoStore(deviceId, identifier),
    flutter: new FlutterStore(deviceId, identifier),
    jni: new JNIStore(deviceId, identifier),
    xpc: new XPCStore(deviceId, identifier),
    hermes: new HermesStore(deviceId, identifier),
  };

  const logHandles = await LogWriter.open(deviceId, identifier);
  const tapStore = createTapStore(deviceId, identifier);
  const script = await session.createScript(await agent(platform));

  setupRelay(socket, script, logHandles, stores);
  setupSocketHandlers(socket, script, session, logHandles, tapStore);

  await script.load();

  // Restore saved taps before emitting ready
  const saved = tapStore.load();
  if (saved) {
    try {
      await script.exports.restore(saved);
    } catch (e) {
      console.warn("Failed to restore taps:", e);
    }
  }

  socket.emit("ready", session.pid);
}

```

`src/tests/agent.test.ts`:

```ts
import frida from "frida";
import { describe, it } from "node:test";
import assert from "node:assert";
import { agent } from "../lib/assets.ts";

describe("load agent", () => {
  ["fruity", "droid", "transport"].forEach((variant) => {
    it(`should load ${variant} agent source`, async () => {
      const source = await agent(variant);
      assert(typeof source === "string", "Agent source should be a string");
      assert(source.length > 0, "Agent source should not be empty");
    });
  });

  it("should spawn app", async () => {
    const deviceId = process.env.UDID;
    if (!deviceId) {
      console.warn("Skipping test: UDID environment variable not set");
      return;
    }

    const source = await agent("fruity");

    try {
      const dev = await frida.getUsbDevice();
      const pid = await dev.spawn("com.apple.mobilesafari", {
        env: { DISABLE_TWEAKS: "1" },
      });
      console.log("pid:", pid);
      const session = await dev.attach(pid);
      await dev.resume(pid);
      console.log("session", session);
      const script = await session.createScript(source);

      script.logHandler = (level, text) => {
        console.log(`[agent][${level}] ${text}`);
      };

      await script.load();
      console.log("interfaces:", await script.exports.interfaces());
      console.log("ok");

      await script.unload();
      await session.detach();

      await dev.kill(pid);
    } catch (ex) {
      console.error(ex);
      throw ex;
    }
  });
});

```

`src/tests/app.test.ts`:

```ts
import { describe, it, afterEach } from "node:test";
import assert from "node:assert";
import fs from "node:fs/promises";
import nodePath from "node:path";

import app from "../app.ts";
import paths from "../lib/paths.ts";
import { HookStore } from "../lib/store/hooks.ts";
import { CryptoStore } from "../lib/store/crypto.ts";
import { NSURLStore } from "../lib/store/nsurl.ts";
import { FlutterStore } from "../lib/store/flutter.ts";
import { JNIStore } from "../lib/store/jni.ts";
import { XPCStore } from "../lib/store/xpc.ts";
import { createTapStore } from "../lib/store/taps.ts";

const device = "test-device";
const identifier = "com.test.app";

function getStores() {
  return {
    hooks: new HookStore(device, identifier),
    crypto: new CryptoStore(device, identifier),
    nsurl: new NSURLStore(device, identifier),
    flutter: new FlutterStore(device, identifier),
    jni: new JNIStore(device, identifier),
    xpc: new XPCStore(device, identifier),
  };
}

describe("API tests", () => {
  it("should start http server", async () => {
    const r0 = await app.request("/api/version");
    const version = await r0.json();
    console.debug("version", version);
    assert("frida" in version);
    assert("igf" in version);

    const r1 = await app.request("/api/devices");
    const devices = await r1.json();
    console.debug("devices", devices);
    assert(Array.isArray(devices), "Devices should be an array");

    const udid = process.env.UDID;
    if (typeof udid !== "string") {
      console.warn("!! UDID env not set, skipping devices related tests");
      return;
    }

    const r2 = await app.request(`/api/device/${udid}/info`);
    const deviceInfo = (await r2.json()) as object;
    console.debug("deviceInfo", deviceInfo);
    assert("name" in deviceInfo);
    assert("platform" in deviceInfo);
    assert("arch" in deviceInfo);

    const r3 = await app.request(`/api/device/${udid}/apps`);
    const apps = await r3.json();
    console.debug("apps", apps.slice(0, 10));
    assert(Array.isArray(apps), "Apps should be an array");

    const r4 = await app.request(`/api/device/${udid}/processes`);
    const processes = (await r4.json()) as { name: string; pid: number }[];
    console.debug("processes", processes.slice(0, 10));
    assert(Array.isArray(processes), "Processes should be an array");
    if (processes.length > 0) {
      assert("name" in processes[0], "Process should have name");
      assert("pid" in processes[0], "Process should have pid");
    }
  });

  it("should return error for non-existent device", async () => {
    const r = await app.request("/api/device/nonexistent-device/apps");
    // Note: getDeviceMiddleware throws when device is not found, resulting in 500
    assert(
      r.status === 404 || r.status === 500,
      "Should return 404 or 500 for non-existent device",
    );
  });

  it("should return 404 for missing device param", async () => {
    const r = await app.request("/api/device//apps");
    assert.strictEqual(r.status, 404);
  });

  it("should handle remote device management", async () => {
    // Test adding a remote device
    const r1 = await app.request("/api/devices/remote/invalid-hostname", {
      method: "PUT",
    });
    // PUT returns 204 on success
    assert(
      r1.status === 204 || r1.status === 200 || r1.status >= 400,
      "PUT should return appropriate status",
    );

    // Test removing a non-existent remote device
    const r2 = await app.request("/api/devices/remote/nonexistent", {
      method: "DELETE",
    });
    assert.strictEqual(
      r2.status,
      404,
      "DELETE should return 404 for non-existent device",
    );
  });

  it("should return 404 for non-existent app icon", async () => {
    const udid = process.env.UDID;
    if (!udid) {
      console.warn("Skipping icon test: UDID environment variable not set");
      return;
    }

    const r = await app.request(
      `/api/device/${udid}/icon/com.nonexistent.bundle`,
    );
    assert.strictEqual(r.status, 404, "Should return 404 for non-existent app");
  });

  it("should handle download request validation", async () => {
    const udid = process.env.UDID;
    if (!udid) {
      console.warn("Skipping download test: UDID environment variable not set");
      return;
    }

    // Test missing path parameter
    const r1 = await app.request(`/api/download/${udid}/1234`);
    assert.strictEqual(r1.status, 400, "Should return 400 for missing path");

    // Test range request not implemented
    const r2 = await app.request(`/api/download/${udid}/1234?path=/test`, {
      headers: { Range: "bytes=0-100" },
    });
    assert.strictEqual(r2.status, 501, "Should return 501 for range requests");
  });

  it("should handle upload request validation", async () => {
    const udid = process.env.UDID;
    if (!udid) {
      console.warn("Skipping upload test: UDID environment variable not set");
      return;
    }

    // Test missing path parameter
    const r1 = await app.request(`/api/upload/${udid}/1234`, {
      method: "POST",
    });
    assert.strictEqual(r1.status, 400, "Should return 400 for missing path");
  });
});

describe("Logs API", () => {
  const logsDir = nodePath.join(paths.data, "logs", device, identifier);

  afterEach(async () => {
    await fs.rm(logsDir, { recursive: true, force: true });
  });

  it("should reject invalid log type", async () => {
    const r = await app.request(`/api/logs/${device}/${identifier}/invalid`);
    assert.strictEqual(r.status, 400);
    assert.strictEqual(await r.text(), "invalid log type");
  });

  it("should return empty string for missing log file", async () => {
    const r = await app.request(`/api/logs/${device}/${identifier}/syslog`);
    assert.strictEqual(r.status, 200);
    assert.strictEqual(await r.text(), "");
  });

  it("should return syslog content", async () => {
    await fs.mkdir(logsDir, { recursive: true });
    await fs.writeFile(
      nodePath.join(logsDir, "syslog.log"),
      "line1\nline2\nline3\n",
    );

    const r = await app.request(`/api/logs/${device}/${identifier}/syslog`);
    assert.strictEqual(r.status, 200);
    const text = await r.text();
    assert(text.includes("line1"));
    assert(text.includes("line3"));
  });

  it("should return agent log content", async () => {
    await fs.mkdir(logsDir, { recursive: true });
    await fs.writeFile(nodePath.join(logsDir, "agent.log"), "[info] hello\n");

    const r = await app.request(`/api/logs/${device}/${identifier}/agent`);
    assert.strictEqual(r.status, 200);
    assert(await r.text(), "[info] hello");
  });

  it("should return full content for small files", async () => {
    await fs.mkdir(logsDir, { recursive: true });
    const lines =
      Array.from({ length: 10 }, (_, i) => `line${i}`).join("\n") + "\n";
    await fs.writeFile(nodePath.join(logsDir, "syslog.log"), lines);

    const r = await app.request(`/api/logs/${device}/${identifier}/syslog`);
    const text = await r.text();
    const returned = text.split("\n").filter(Boolean);
    assert.strictEqual(returned.length, 10);
    assert.strictEqual(returned[0], "line0");
  });

  it("should delete logs directory", async () => {
    await fs.mkdir(logsDir, { recursive: true });
    await fs.writeFile(nodePath.join(logsDir, "syslog.log"), "data\n");

    const r = await app.request(`/api/logs/${device}/${identifier}`, {
      method: "DELETE",
    });
    assert.strictEqual(r.status, 204);

    const exists = await fs.access(logsDir).then(
      () => true,
      () => false,
    );
    assert.strictEqual(exists, false);
  });
});

describe("Hooks API", () => {
  afterEach(() => {
    getStores().hooks.rm();
  });

  it("should return empty hooks list", async () => {
    const r = await app.request(`/api/hooks/${device}/${identifier}`);
    assert.strictEqual(r.status, 200);
    const body = (await r.json()) as {
      hooks: unknown[];
      total: number;
      limit: number;
      offset: number;
    };
    assert.deepStrictEqual(body.hooks, []);
    assert.strictEqual(body.total, 0);
    assert.strictEqual(body.limit, 1000);
    assert.strictEqual(body.offset, 0);
  });

  it("should return inserted hooks", async () => {
    const { hooks: hookStore } = getStores();
    hookStore.append({
      category: "network",
      symbol: "send",
      dir: "out",
    });
    hookStore.append({
      category: "crypto",
      symbol: "encrypt",
      dir: "in",
    });

    const r = await app.request(`/api/hooks/${device}/${identifier}`);
    const body = (await r.json()) as { hooks: any[]; total: number };
    assert.strictEqual(body.total, 2);
    assert.strictEqual(body.hooks.length, 2);
    // newest first
    assert.strictEqual(body.hooks[0].category, "crypto");
    assert.strictEqual(body.hooks[1].category, "network");
    assert.strictEqual(body.hooks[0].symbol, "encrypt");
    assert.strictEqual(body.hooks[0].direction, "in");
  });

  it("should return extra as parsed object", async () => {
    const { hooks: hookStore } = getStores();
    hookStore.append({
      category: "c",
      symbol: "s",
      dir: "out",
      extra: { key: "value", num: 42 },
    });

    const r = await app.request(`/api/hooks/${device}/${identifier}`);
    const body = (await r.json()) as { hooks: any[] };
    assert.strictEqual(typeof body.hooks[0].extra, "object");
    assert.strictEqual(body.hooks[0].extra.key, "value");
    assert.strictEqual(body.hooks[0].extra.num, 42);
  });

  it("should filter by category", async () => {
    const { hooks: hookStore } = getStores();
    hookStore.append({
      category: "network",
      symbol: "send",
      dir: "out",
    });
    hookStore.append({
      category: "crypto",
      symbol: "enc",
      dir: "in",
    });

    const r = await app.request(
      `/api/hooks/${device}/${identifier}?category=crypto`,
    );
    const body = (await r.json()) as { hooks: any[]; total: number };
    assert.strictEqual(body.total, 1);
    assert.strictEqual(body.hooks.length, 1);
    assert.strictEqual(body.hooks[0].category, "crypto");
  });

  it("should store and query flutter.channel hooks", async () => {
    const { hooks: hookStore } = getStores();
    hookStore.append({
      category: "flutter.channel",
      symbol: "flutter.method",
      dir: "leave",
      line: "plugins.flutter.io/share",
      extra: {
        type: "method",
        dir: "native",
        channel: "plugins.flutter.io/share",
        method: "share",
        args: { text: "hello" },
      },
    });

    const r = await app.request(
      `/api/hooks/${device}/${identifier}?category=flutter.channel`,
    );
    assert.strictEqual(r.status, 200);

    const body = (await r.json()) as { hooks: any[]; total: number };
    assert.strictEqual(body.total, 1);
    assert.strictEqual(body.hooks.length, 1);
    assert.strictEqual(body.hooks[0].category, "flutter.channel");
    assert.strictEqual(body.hooks[0].extra.channel, "plugins.flutter.io/share");
    assert.strictEqual(body.hooks[0].extra.method, "share");
  });

  it("should paginate with limit and offset", async () => {
    const { hooks: hookStore } = getStores();
    for (let i = 0; i < 5; i++) {
      hookStore.append({
        category: "c",
        symbol: `s${i}`,
        dir: "out",
      });
    }

    const r = await app.request(
      `/api/hooks/${device}/${identifier}?limit=2&offset=1`,
    );
    const body = (await r.json()) as {
      hooks: any[];
      total: number;
      limit: number;
      offset: number;
    };
    assert.strictEqual(body.hooks.length, 2);
    assert.strictEqual(body.limit, 2);
    assert.strictEqual(body.offset, 1);
    assert.strictEqual(body.total, 5);
  });

  it("should clear hooks", async () => {
    const { hooks: hookStore } = getStores();
    hookStore.append({
      category: "c",
      symbol: "s",
      dir: "out",
    });

    const r = await app.request(`/api/hooks/${device}/${identifier}`, {
      method: "DELETE",
    });
    assert.strictEqual(r.status, 204);

    const r2 = await app.request(`/api/hooks/${device}/${identifier}`);
    const body = (await r2.json()) as { total: number };
    assert.strictEqual(body.total, 0);
  });

  it("should isolate hooks by device/identifier", async () => {
    const { hooks: hookStore } = getStores();
    hookStore.append({
      category: "c",
      symbol: "s",
      dir: "out",
    });

    const otherHooks = new HookStore(device, "com.other.app");
    otherHooks.append({
      category: "c",
      symbol: "s",
      dir: "out",
    });

    const r = await app.request(`/api/hooks/${device}/${identifier}`);
    const body = (await r.json()) as { total: number };
    assert.strictEqual(body.total, 1);

    // cleanup other
    otherHooks.rm();
  });
});

describe("Crypto Logs API", () => {
  afterEach(() => {
    getStores().crypto.rm();
  });

  it("should return empty crypto logs", async () => {
    const r = await app.request(`/api/history/crypto/${device}/${identifier}`);
    assert.strictEqual(r.status, 200);
    const body = (await r.json()) as { logs: unknown[]; total: number };
    assert.deepStrictEqual(body.logs, []);
    assert.strictEqual(body.total, 0);
  });

  it("should return inserted crypto logs", async () => {
    const { crypto: cryptoStore } = getStores();
    cryptoStore.append({
      symbol: "CCCrypt",
      dir: "encrypt",
    });
    cryptoStore.append({
      symbol: "SecKeyEncrypt",
      dir: "decrypt",
    });

    const r = await app.request(`/api/history/crypto/${device}/${identifier}`);
    const body = (await r.json()) as { logs: any[]; total: number };
    assert.strictEqual(body.total, 2);
    assert.strictEqual(body.logs.length, 2);
    // newest first
    assert.strictEqual(body.logs[0].symbol, "SecKeyEncrypt");
    assert.strictEqual(body.logs[1].symbol, "CCCrypt");
  });

  it("should return extra and backtrace as parsed objects", async () => {
    const { crypto: cryptoStore } = getStores();
    cryptoStore.append({
      symbol: "CCCrypt",
      dir: "encrypt",
      extra: { algo: "AES" },
      backtrace: ["0x1000", "0x2000"],
    });

    const r = await app.request(`/api/history/crypto/${device}/${identifier}`);
    const body = (await r.json()) as { logs: any[] };
    assert.strictEqual(typeof body.logs[0].extra, "object");
    assert.strictEqual(body.logs[0].extra.algo, "AES");
    assert(Array.isArray(body.logs[0].backtrace));
    assert.strictEqual(body.logs[0].backtrace[0], "0x1000");
  });

  it("should paginate crypto logs", async () => {
    const { crypto: cryptoStore } = getStores();
    for (let i = 0; i < 5; i++) {
      cryptoStore.append({ symbol: `sym${i}`, dir: "enc" });
    }

    const r = await app.request(
      `/api/history/crypto/${device}/${identifier}?limit=2&offset=1`,
    );
    const body = (await r.json()) as {
      logs: any[];
      total: number;
      limit: number;
      offset: number;
    };
    assert.strictEqual(body.logs.length, 2);
    assert.strictEqual(body.total, 5);
  });

  it("should clear crypto logs", async () => {
    const { crypto: cryptoStore } = getStores();
    cryptoStore.append({ symbol: "s", dir: "enc" });

    const r = await app.request(`/api/history/crypto/${device}/${identifier}`, {
      method: "DELETE",
    });
    assert.strictEqual(r.status, 204);

    const r2 = await app.request(`/api/history/crypto/${device}/${identifier}`);
    const body = (await r2.json()) as { total: number };
    assert.strictEqual(body.total, 0);
  });
});

describe("NSURL API", () => {
  afterEach(() => {
    getStores().nsurl.rm();
  });

  it("should return empty NSURL records", async () => {
    const r = await app.request(`/api/history/nsurl/${device}/${identifier}`);
    assert.strictEqual(r.status, 200);
    const body = (await r.json()) as { requests: unknown[]; total: number };
    assert.deepStrictEqual(body.requests, []);
    assert.strictEqual(body.total, 0);
  });

  it("should return upserted NSURL requests", async () => {
    const { nsurl: nsurlStore } = getStores();
    nsurlStore.upsert({
      event: "requestWillBeSent",
      requestId: "req-1",
      timestamp: 1000,
      request: { method: "GET", url: "https://example.com/api", headers: {} },
    });
    nsurlStore.upsert({
      event: "responseReceived",
      requestId: "req-1",
      timestamp: 1100,
      response: { statusCode: 200, mimeType: "application/json", headers: {} },
    });

    const r = await app.request(`/api/history/nsurl/${device}/${identifier}`);
    const body = (await r.json()) as { requests: any[]; total: number };
    assert.strictEqual(body.total, 1);
    assert.strictEqual(body.requests[0].method, "GET");
    assert.strictEqual(body.requests[0].url, "https://example.com/api");
    assert.strictEqual(body.requests[0].statusCode, 200);
  });

  it("should clear NSURL records", async () => {
    const { nsurl: nsurlStore } = getStores();
    nsurlStore.upsert({
      event: "requestWillBeSent",
      requestId: "req-1",
      timestamp: 1000,
      request: { method: "POST", url: "https://example.com", headers: {} },
    });

    const r = await app.request(`/api/history/nsurl/${device}/${identifier}`, {
      method: "DELETE",
    });
    assert.strictEqual(r.status, 204);

    const r2 = await app.request(`/api/history/nsurl/${device}/${identifier}`);
    const body = (await r2.json()) as { total: number };
    assert.strictEqual(body.total, 0);
  });

  it("should isolate NSURL records by device/identifier", async () => {
    const { nsurl: nsurlStore } = getStores();
    nsurlStore.upsert({
      event: "requestWillBeSent",
      requestId: "req-1",
      timestamp: 1000,
      request: { method: "GET", url: "https://a.com", headers: {} },
    });

    const otherNsurl = new NSURLStore(device, "com.other.app");
    otherNsurl.upsert({
      event: "requestWillBeSent",
      requestId: "req-2",
      timestamp: 1000,
      request: { method: "GET", url: "https://b.com", headers: {} },
    });

    const r = await app.request(`/api/history/nsurl/${device}/${identifier}`);
    const body = (await r.json()) as { total: number };
    assert.strictEqual(body.total, 1);

    // cleanup other
    otherNsurl.rm();
  });
});

describe("Flutter Logs API", () => {
  afterEach(() => {
    getStores().flutter.rm();
  });

  it("should return empty flutter logs", async () => {
    const r = await app.request(`/api/history/flutter/${device}/${identifier}`);
    assert.strictEqual(r.status, 200);
    const body = (await r.json()) as { logs: unknown[]; total: number };
    assert.deepStrictEqual(body.logs, []);
    assert.strictEqual(body.total, 0);
  });

  it("should return inserted flutter logs", async () => {
    const { flutter: store } = getStores();
    store.append({
      type: "method",
      dir: "native",
      channel: "plugins.flutter.io/share",
      method: "share",
      args: { text: "hello" },
    });
    store.append({
      type: "event",
      dir: "dart",
      channel: "flutter/lifecycle",
    });

    const r = await app.request(`/api/history/flutter/${device}/${identifier}`);
    const body = (await r.json()) as { logs: any[]; total: number };
    assert.strictEqual(body.total, 2);
    assert.strictEqual(body.logs.length, 2);
    // newest first
    assert.strictEqual(body.logs[0].channel, "flutter/lifecycle");
    assert.strictEqual(body.logs[0].type, "event");
    assert.strictEqual(body.logs[1].channel, "plugins.flutter.io/share");
    assert.strictEqual(body.logs[1].data.method, "share");
    assert.strictEqual(body.logs[1].data.args.text, "hello");
  });

  it("should clear flutter logs", async () => {
    const { flutter: store } = getStores();
    store.append({
      type: "method",
      dir: "native",
      channel: "test/channel",
    });

    const r = await app.request(
      `/api/history/flutter/${device}/${identifier}`,
      {
        method: "DELETE",
      },
    );
    assert.strictEqual(r.status, 204);

    const r2 = await app.request(
      `/api/history/flutter/${device}/${identifier}`,
    );
    const body = (await r2.json()) as { total: number };
    assert.strictEqual(body.total, 0);
  });
});

describe("JNI Logs API", () => {
  afterEach(() => {
    getStores().jni.rm();
  });

  it("should return empty jni logs", async () => {
    const r = await app.request(`/api/history/jni/${device}/${identifier}`);
    assert.strictEqual(r.status, 200);
    const body = (await r.json()) as { logs: unknown[]; total: number };
    assert.deepStrictEqual(body.logs, []);
    assert.strictEqual(body.total, 0);
  });

  it("should return inserted jni logs", async () => {
    const { jni: store } = getStores();
    store.append({
      subject: "jni",
      type: "call",
      method: "GetStringUTFChars",
      callType: "JNIEnv",
      threadId: 1,
      args: ["0x1234"],
      ret: "hello",
      library: "libnative.so",
    });
    store.append({
      subject: "jni",
      type: "call",
      method: "FindClass",
      callType: "JNIEnv",
      threadId: 2,
      args: ["com/example/Test"],
      ret: "0x5678",
    });

    const r = await app.request(`/api/history/jni/${device}/${identifier}`);
    const body = (await r.json()) as { logs: any[]; total: number };
    assert.strictEqual(body.total, 2);
    assert.strictEqual(body.logs.length, 2);
    // newest first
    assert.strictEqual(body.logs[0].method, "FindClass");
    assert.strictEqual(body.logs[1].method, "GetStringUTFChars");
    assert.strictEqual(body.logs[1].library, "libnative.so");
  });

  it("should filter by method", async () => {
    const { jni: store } = getStores();
    store.append({
      subject: "jni",
      type: "call",
      method: "GetStringUTFChars",
      callType: "JNIEnv",
      threadId: 1,
      args: [],
      ret: "",
    });
    store.append({
      subject: "jni",
      type: "call",
      method: "FindClass",
      callType: "JNIEnv",
      threadId: 1,
      args: [],
      ret: "",
    });

    const r = await app.request(
      `/api/history/jni/${device}/${identifier}?method=FindClass`,
    );
    const body = (await r.json()) as { logs: any[]; total: number };
    assert.strictEqual(body.total, 1);
    assert.strictEqual(body.logs[0].method, "FindClass");
  });

  it("should clear jni logs", async () => {
    const { jni: store } = getStores();
    store.append({
      subject: "jni",
      type: "call",
      method: "FindClass",
      callType: "JNIEnv",
      threadId: 1,
      args: [],
      ret: "",
    });

    const r = await app.request(`/api/history/jni/${device}/${identifier}`, {
      method: "DELETE",
    });
    assert.strictEqual(r.status, 204);

    const r2 = await app.request(`/api/history/jni/${device}/${identifier}`);
    const body = (await r2.json()) as { total: number };
    assert.strictEqual(body.total, 0);
  });
});

describe("XPC Logs API", () => {
  afterEach(() => {
    getStores().xpc.rm();
  });

  it("should return empty xpc logs", async () => {
    const r = await app.request(`/api/history/xpc/${device}/${identifier}`);
    assert.strictEqual(r.status, 200);
    const body = (await r.json()) as { logs: unknown[]; total: number };
    assert.deepStrictEqual(body.logs, []);
    assert.strictEqual(body.total, 0);
  });

  it("should return inserted xpc logs", async () => {
    const { xpc: store } = getStores();
    store.append({
      event: "send",
      dir: "out",
      name: "com.apple.springboard",
      peer: 42,
      message: { type: "xpc", key: "value" },
    });
    store.append({
      event: "receive",
      dir: "in",
      name: "com.apple.cfprefsd",
      message: { type: "nsxpc", method: "getPrefs" },
    });

    const r = await app.request(`/api/history/xpc/${device}/${identifier}`);
    const body = (await r.json()) as { logs: any[]; total: number };
    assert.strictEqual(body.total, 2);
    assert.strictEqual(body.logs.length, 2);
    // newest first
    assert.strictEqual(body.logs[0].protocol, "nsxpc");
    assert.strictEqual(body.logs[0].service, "com.apple.cfprefsd");
    assert.strictEqual(body.logs[1].protocol, "xpc");
    assert.strictEqual(body.logs[1].peer, 42);
  });

  it("should filter by protocol", async () => {
    const { xpc: store } = getStores();
    store.append({
      event: "send",
      dir: "out",
      message: { type: "xpc" },
    });
    store.append({
      event: "send",
      dir: "out",
      message: { type: "nsxpc" },
    });

    const r = await app.request(
      `/api/history/xpc/${device}/${identifier}?protocol=nsxpc`,
    );
    const body = (await r.json()) as { logs: any[]; total: number };
    assert.strictEqual(body.total, 1);
    assert.strictEqual(body.logs[0].protocol, "nsxpc");
  });

  it("should clear xpc logs", async () => {
    const { xpc: store } = getStores();
    store.append({
      event: "send",
      dir: "out",
      message: { type: "xpc" },
    });

    const r = await app.request(`/api/history/xpc/${device}/${identifier}`, {
      method: "DELETE",
    });
    assert.strictEqual(r.status, 204);

    const r2 = await app.request(`/api/history/xpc/${device}/${identifier}`);
    const body = (await r2.json()) as { total: number };
    assert.strictEqual(body.total, 0);
  });
});

describe("Taps API", () => {
  afterEach(() => {
    createTapStore(device, identifier).clear();
  });

  it("should return null for empty taps", async () => {
    const r = await app.request(`/api/taps/${device}/${identifier}`);
    assert.strictEqual(r.status, 200);
    const body = await r.json();
    assert.strictEqual(body, null);
  });

  it("should return saved taps", async () => {
    const store = createTapStore(device, identifier);
    const rules = [
      { type: "builtin" as const, id: "crypto" },
      {
        type: "objc" as const,
        cls: "NSURLSession",
        sel: "dataTaskWithRequest:",
      },
    ];
    store.save(rules);

    const r = await app.request(`/api/taps/${device}/${identifier}`);
    assert.strictEqual(r.status, 200);
    const body = await r.json();
    assert.strictEqual(body.length, 2);
    assert.strictEqual(body[0].type, "builtin");
    assert.strictEqual(body[0].id, "crypto");
    assert.strictEqual(body[1].type, "objc");
    assert.strictEqual(body[1].cls, "NSURLSession");
  });

  it("should clear taps", async () => {
    const store = createTapStore(device, identifier);
    store.save([{ type: "builtin" as const, id: "crypto" }]);

    const r = await app.request(`/api/taps/${device}/${identifier}`, {
      method: "DELETE",
    });
    assert.strictEqual(r.status, 204);

    const r2 = await app.request(`/api/taps/${device}/${identifier}`);
    const body = await r2.json();
    assert.strictEqual(body, null);
  });
});

```

`src/tests/ws.test.ts`:

```ts
import { type AddressInfo } from "node:net";
import { createServer } from "node:http";
import { describe, it, expect } from "bun:test";

import frida from "frida";
import ioc from "socket.io-client";
import type { Server } from "socket.io";

import attach from "../ws.ts";

function createTestServer() {
  const server = createServer();
  const io = attach(server) as Server;
  return { server, io };
}

async function closeTestServer(
  server: ReturnType<typeof createServer>,
  io: Server,
) {
  io.close();
  await new Promise<void>((resolve) => server.close(() => resolve()));
}

describe("socket.io tests", () => {
  it(
    "should notify clients on device change",
    async () => {
      const { server, io } = createTestServer();
      await new Promise<void>((resolve) => server.listen(() => resolve()));

      const mgr = frida.getDeviceManager();
      const { port } = server.address() as AddressInfo;
      const socket = ioc(`http://localhost:${port}/devices`);

      try {
        let receivedChange = false;
        let connected = false;

        socket.on("change", () => {
          receivedChange = true;
          console.debug("Received device change event");
          socket.disconnect();
        });

        socket.on("connect", () => {
          connected = true;
          expect(socket.connected).toBe(true);
          mgr.addRemoteDevice("127.0.0.1");
        });

        // Wait for events
        await new Promise((resolve) => setTimeout(resolve, 500));

        expect(connected).toBe(true);
        expect(receivedChange).toBe(true);
      } finally {
        socket.disconnect();
        await closeTestServer(server, io);
      }
    },
    { timeout: 5000 },
  );

  it(
    "should run rpc tests",
    async () => {
      const deviceId = process.env.UDID;
      if (!deviceId) {
        console.warn(
          "Skipping /session test: UDID environment variable not set",
        );
        return;
      }

      const { server, io } = createTestServer();
      await new Promise<void>((resolve) => server.listen(() => resolve()));

      const { port } = server.address() as AddressInfo;
      const query = new URLSearchParams({
        device: deviceId,
        bundle: "com.apple.mobilesafari",
      });
      const socket = ioc(
        `http://localhost:${port}/session?${query.toString()}`,
      );

      try {
        let receivedReady = false;

        socket.on("ready", () => {
          receivedReady = true;
          console.debug("Session ready, connection established");
          socket.emit("rpc", "invalid");
          socket.emit(
            "rpc",
            "fs",
            "ls",
            ["bundle"],
            (err: Error | null, result: any) => {
              console.log("rpc result:", result);
              socket.disconnect();
            },
          );
        });

        // Wait for events
        await new Promise((resolve) => setTimeout(resolve, 8000));

        expect(receivedReady).toBe(true);
      } finally {
        socket.disconnect();
        await closeTestServer(server, io);
      }
    },
    { timeout: 15000 },
  );
});

```

`src/types.ts`:

```ts
import type { Socket } from "socket.io";

import type { NSURLStore } from "./lib/store/nsurl.ts";
import type { HookStore } from "./lib/store/hooks.ts";
import type { CryptoStore } from "./lib/store/crypto.ts";
import type { FlutterStore } from "./lib/store/flutter.ts";
import type { JNIStore } from "./lib/store/jni.ts";
import type { XPCStore } from "./lib/store/xpc.ts";
import type { HermesStore } from "./lib/store/hermes.ts";

import type { NSURLEvent } from "./lib/store/nsurl.ts";
import type { BaseMessage as BaseHookMessage } from "@agent/common/hooks/context";
import type { JNIEvent } from "@agent/droid/hooks/jni";

export type Platform = "fruity" | "droid";
export type Mode = "app" | "daemon";

export interface SessionParams {
  platform: Platform;
  mode: Mode;
  deviceId: string;
  bundle?: string;
  pid?: number;
  name?: string;
}

export interface ServerToClientEvents {
  ready: (pid: number) => void;
  change: () => void;
  denied: () => void;
  detached: (reason: string) => void;
  log: (level: string, text: string) => void;
  syslog: (text: string) => void;
  invalid: () => void;
  lifecycle: (
    event: "inactive" | "active" | "forerground" | "background",
  ) => void;
  hook: (msg: BaseHookMessage) => void;
  flutter: (event: Record<string, unknown>) => void;
  crypto: (msg: BaseHookMessage, data?: ArrayBuffer) => void;
  nsurl: (event: NSURLEvent) => void;
  xpc: (event: Record<string, unknown>) => void;
  jni: (event: JNIEvent) => void;
  hermes: (event: { url: string; hash: string; size: number }) => void;
  memoryScan: (
    event: { event: string; [key: string]: unknown },
    data?: ArrayBuffer,
  ) => void;
  fatal: (detail: unknown) => void;
}

export type ClientCallback = (err: Error | null, result: any) => void;

export interface ClientToServerEvents {
  rpc: (mod: string, method: string, args: any[], ack: ClientCallback) => void;
  eval: (source: string, name: string, ack: ClientCallback) => void;
  clearLog: (type: "syslog" | "agent", ack: ClientCallback) => void;
}

export interface SessionStores {
  nsurl: NSURLStore;
  hooks: HookStore;
  crypto: CryptoStore;
  flutter: FlutterStore;
  jni: JNIStore;
  xpc: XPCStore;
  hermes: HermesStore;
}

export type SessionSocket = Socket<ClientToServerEvents, ServerToClientEvents>;

```

`src/ws.ts`:

```ts
import { type ServerType } from "@hono/node-server";
import { Server } from "socket.io";

import { manager, parse, connect } from "./session.ts";
import type { ClientToServerEvents, ServerToClientEvents } from "./types.ts";

export default function attach(server: ServerType) {
  const io = new Server<ClientToServerEvents, ServerToClientEvents>(server);

  function onDeviceChange() {
    console.debug("Device manager changed, notifying clients");
    io.of("/devices").emit("change");
  }

  manager.changed.connect(onDeviceChange);
  server.on("close", () => {
    manager.changed.disconnect(onDeviceChange);
  });

  io.of("/devices");
  io.of("/session").on("connection", (socket) => {
    const params = parse(socket.handshake.query);
    if (params) {
      connect(socket, params).catch((ex) => {
        console.error("failed to establish session, ", ex);
        socket.disconnect(true);
      });
    } else {
      console.error("invalid params:", socket.handshake.query);
      // there is a weird bug that first time calling socket.io
      // the query params are empty
      socket.emit("invalid");
      // Give client time to receive the event before disconnecting
      setTimeout(() => socket.disconnect(true), 100);
    }
  });

  return io;
}

```

`tsconfig.json`:

```json
{
  "compilerOptions": {
    "target": "ESNext",
    "module": "ESNext",
    "moduleResolution": "node",
    "esModuleInterop": true,
    "strict": true,
    "skipLibCheck": true,
    "resolveJsonModule": true,
    "rootDir": "./src",
    "noEmit": true,
    "allowImportingTsExtensions": true,
    "outDir": "dist",
    "paths": {
      "@agent/*": ["./agent/types/*"],
    },
  },
  "include": ["src/**/*", "src/index.ts"],
  "exclude": ["node_modules", "gui"],
}

```

`tsdown.config.ts`:

```ts
import { defineConfig } from "tsdown";

const env = {
  NODE_ENV: "production",
  SQLITE: "better-sqlite3",
};

export default defineConfig([
  {
    entry: { index: "src/index.ts" },
    format: "esm",
    env,
  },
  {
    entry: { bin: "src/bin.ts" },
    format: "esm",
    banner: { js: "#!/usr/bin/env node" },
    env,
  },
]);

```