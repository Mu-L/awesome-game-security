Project Path: arc_ChiChou_vscode-frida_ti1dyz1c

Source Tree:

```txt
arc_ChiChou_vscode-frida_ti1dyz1c
├── CHANGELOG.md
├── LICENSE
├── README.md
├── agent
│   ├── README.md
│   ├── package-lock.json
│   ├── package.json
│   ├── src
│   │   ├── index.ts
│   │   └── log.ts
│   └── tsconfig.json
├── backend
│   ├── __init__.py
│   ├── android
│   │   └── get-frida.py
│   ├── core.py
│   ├── driver.py
│   ├── fruit
│   │   └── __init__.py
│   ├── pause.py
│   ├── pyproject.toml
│   ├── rpc.py
│   ├── syslog.py
│   ├── test
│   │   ├── __init__.py
│   │   └── test_device.py
│   ├── uv.lock
│   └── venv.py
├── i10n
│   └── bundle.l10n.zh-cn.json
├── icon.png
├── package-lock.json
├── package.json
├── package.nls.json
├── package.nls.zh-cn.json
├── resources
│   ├── dark
│   │   ├── add.svg
│   │   ├── apps.svg
│   │   ├── attach.svg
│   │   ├── del.svg
│   │   ├── error.svg
│   │   ├── local.svg
│   │   ├── refresh.svg
│   │   ├── remote.svg
│   │   ├── statusRun.svg
│   │   ├── statusStop.svg
│   │   └── usb.svg
│   ├── debugger.preload.js
│   ├── doc
│   │   ├── demo.gif
│   │   ├── list.png
│   │   ├── syslog.gif
│   │   └── typing.gif
│   ├── icon.svg
│   ├── light
│   │   ├── add.svg
│   │   ├── apps.svg
│   │   ├── attach.svg
│   │   ├── del.svg
│   │   ├── error.svg
│   │   ├── local.svg
│   │   ├── refresh.svg
│   │   ├── remote.svg
│   │   ├── statusRun.svg
│   │   ├── statusStop.svg
│   │   └── usb.svg
│   ├── run.svg
│   ├── templates
│   │   ├── launch.json
│   │   └── tasks.json
│   └── terminal.png
├── src
│   ├── commands
│   │   ├── android.ts
│   │   ├── boilerplate.ts
│   │   ├── clipboard.ts
│   │   ├── dump.ts
│   │   ├── objection.ts
│   │   ├── print.ts
│   │   ├── repl.ts
│   │   ├── ssh.ts
│   │   ├── syslog.ts
│   │   └── typing.ts
│   ├── driver
│   │   ├── adb.ts
│   │   ├── backend.ts
│   │   ├── frida.ts
│   │   └── remote.ts
│   ├── extension.ts
│   ├── logger.ts
│   ├── providers
│   │   └── devices.ts
│   ├── shebang.ts
│   ├── term.ts
│   ├── types.ts
│   └── utils.ts
├── tsconfig.json
├── tslint.json
└── types.d.ts

```

`CHANGELOG.md`:

```md
# Change Log

### v0.9.0 - 10 Sep, 2024

* Support frida-tools installed from virtualenv, pipx, etc.

### v0.8.3 - 9 Sep, 2024

* **Remove** lldb shortcut because it's impossible to adapt to different jailbreaks

### v0.7.3 - 25 Jun, 2023

* Bring back `bagbak`

### v0.7.0 - 14 Jun, 2023

* Use `fruity-frida` to support iOS debugging and SSH
* Temporary disable bagbak for compatibility issue

### v0.4.11 - 07 Apr, 2023

* Remove Fouldecrypt

### v0.4.6 - 13 Aug, 2022

* add idevicesyslog

### v0.4.2 - 07 Aug, 2022

* Bugfix: Debug config only works for local device
* Bugfix: Debug config does not handle attaching to app properly
* Bugfix: Context menu for USB devices is missing

### v0.4.0 - 07 Aug, 2022

* Supports frida js debug!

### v0.3.19 - 06 Aug, 2022

* Supports connecting / disconnecting remote devices

### v0.3.17 - 05 Aug, 2022

* Bring back `execute` command

### v0.3.16 - 29 Mar, 2022

* Ask to install frida-tools when not found
* Fix issue #26 when multiple python interpreters are present

### v0.3.14 - 25 Jan, 2022

* Fix `iproxy` command

### v0.3.12 - 27 Nov, 2021

* Replace FlexDecrypt with Fouldecrypt
* Bugfix: Shutdown iproxy when ref count is 0
* Bugfix: Decryptor failes when App path has spaces

### v0.0.8 - 8 Aug, 2020

* Bugfix: Attaching objection to a running application
* Do not close terminal immediatly when exit code is not 0
* More error logs

### v0.0.6 - 4 Aug, 2020

Bugfix: `iproxy` fallback
New: show ipa in folder

### v0.0.4 - 3 Aug, 2020

* Add experimental lldb shortcut

### v0.0.3 - 2 Aug, 2020

Added

* Shell for both iOS (requires libimobiledevice) and Androd (requires adb)
* Install public SSH key to iOS (like `ssh-copy-id`, but also supports Windows)
* FlexDecrypt support. Requires `flexdecrypt` and `zip` on iOS, `ssh` and `iproxy` on desktop
* FlexDecrypt installer

Deprecation

* [bagbak](https://github.com/ChiChou/bagbak) has been removed, in favor of [FlexDecrypt](https://github.com/JohnCoates/flexdecrypt)

### v0.0.2 - 22 Jul, 2020

* support logcat for Android
* pull `frida-gum.d.ts` from github

### v0.0.1 - 19 Jul, 2020

* first release

```

`LICENSE`:

```
Copyright (c) 2012-2022 Zhi and others

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
```

`README.md`:

```md
# vscode-frida

**Unofficial** frida workbench for VSCode [![](https://img.shields.io/visual-studio-marketplace/v/CodeColorist.vscode-frida?color=%230af&label=install&logo=visual-studio-code&logoColor=%230ac&style=plastic)](https://marketplace.visualstudio.com/items?itemName=CodeColorist.vscode-frida)

## Prerequisites

* libimobiledevices (for `inetcat` command)
* Python >= 3.7
* frida-tools python package
* iTunes on Windows

If you are on Windows, you need to keep iTunes open in order to interact with iOS devices via USB.

### Install frida-tools

Because of [PEP0668](https://peps.python.org/pep-0668/), you might encounter error when `pip3 install frida-tools` globally.

The recommended way is to open a folder (workspace) in VSCode, then create and activate a virtual environment using python extension. In this case, the extension will pick your current active python venv to load frida commands.

Or you can use package manager like [pipx](https://github.com/pypa/pipx) or [UV](https://docs.astral.sh/uv/guides/tools/) to install it to $PATH, meanwhile keeping it isolated.

## Features

![demo](resources/doc/demo.gif)

### Target Selector

User friendly UI

### Debug Log

Now supports both iOS syslog and Android logcat!

![Debug Log](resources/doc/syslog.gif)

### Download and Apply frida-gum Typing Info

![Typing](resources/doc/typing.gif)

### Objection

* [Objection](https://github.com/sensepost/objection) Runtime Mobile Exploration

### Javascript REPL shortcut

Open and activate an REPL at the bottom. Use the "frida" button at the top of any active `js` / `typescript` document, it will send the code to the active REPL.

### Shell

For Android devices, **Open Shell** is simply a wrapper for `adb shell`. 

For iOS it gives a SSH shell. It might ask for credentials depending on your setup.

## Todo

* More Android features
* More mobile security terminal tools intergration

## [CHANGELOG](CHANGELOG.md)

## Contributors

![](https://contrib.rocks/image?repo=chichou/vscode-frida)

```

`agent/README.md`:

```md
### How to compile & load

```sh
$ git clone git://github.com/oleavr/frida-agent-example.git
$ cd frida-agent-example/
$ npm install
$ frida -U -f com.example.android --no-pause -l _agent.js
```

### Development workflow

To continuously recompile on change, keep this running in a terminal:

```sh
$ npm run watch
```

And use an editor like Visual Studio Code for code completion and instant
type-checking feedback.

```

`agent/package-lock.json`:

```json
{
  "name": "vscode-frida-agent",
  "version": "1.0.0",
  "lockfileVersion": 2,
  "requires": true,
  "packages": {
    "": {
      "name": "vscode-frida-agent",
      "version": "1.0.0",
      "devDependencies": {
        "@types/frida-gum": "^18.1.0",
        "@types/node": "^18.6.4",
        "frida-compile": "^15.1.0"
      }
    },
    "node_modules/@frida/assert": {
      "version": "3.0.2",
      "resolved": "https://registry.npmjs.org/@frida/assert/-/assert-3.0.2.tgz",
      "integrity": "sha512-JXJq5SbXGrM5EkjrZKfRmB29zOoEOix02NC6A5TSJ+C1GE/X051EinJJsuOO2pEOx7KZwpvAHvS0WXW0+levKg==",
      "dev": true
    },
    "node_modules/@frida/base64-js": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/@frida/base64-js/-/base64-js-2.0.3.tgz",
      "integrity": "sha512-2w0F+1TynOTCZ/v7du9LdHPWwq0lJhazjo2fF9upMyQmA1zHetT14fLuQ1v/6T0qPgyeEGkiSrybstU8EsgeUA==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ]
    },
    "node_modules/@frida/buffer": {
      "version": "7.0.4",
      "resolved": "https://registry.npmjs.org/@frida/buffer/-/buffer-7.0.4.tgz",
      "integrity": "sha512-RxQ1lZRRiCJj7nhcCiD8xeJx0NsLpGGnjqsmTg7jShGmbnVFMN5W7+J+3gqdPSQhc/IxNBIWc6zRXVp4+qnYHg==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ],
      "dependencies": {
        "base64-js": "^1.5.1",
        "ieee754": "^1.2.1"
      }
    },
    "node_modules/@frida/crosspath": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/@frida/crosspath/-/crosspath-3.0.0.tgz",
      "integrity": "sha512-bNdO1spIPD2P40XtK89N49oZpJhstdlnkJZcD4yJ17jrdkm9Ctu0sd9MIEX6Z8Tm8ydhVJBAOMEKl9/R27onAQ==",
      "dev": true,
      "dependencies": {
        "@types/node": "^17.0.36"
      },
      "engines": {
        "node": ">=14.9.0"
      }
    },
    "node_modules/@frida/crosspath/node_modules/@types/node": {
      "version": "17.0.45",
      "resolved": "https://registry.npmjs.org/@types/node/-/node-17.0.45.tgz",
      "integrity": "sha512-w+tIMs3rq2afQdsPJlODhoUEKzFP1ayaoyl1CcnwtIlsVe7K7bA1NGm4s3PraqTLlXnbIN84zuBlxBWo1u9BLw==",
      "dev": true
    },
    "node_modules/@frida/diagnostics_channel": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/@frida/diagnostics_channel/-/diagnostics_channel-1.0.0.tgz",
      "integrity": "sha512-mYX1jp/5Bpk24tHArJNx65iCk7qSuV8YJkdU0gFNVtJUXxfV8BG5WuPa4mL+ynxsbWWpsg/cwKZbLAepYKTdQQ==",
      "dev": true
    },
    "node_modules/@frida/events": {
      "version": "4.0.4",
      "resolved": "https://registry.npmjs.org/@frida/events/-/events-4.0.4.tgz",
      "integrity": "sha512-qJVQ6VWHf9sjUKuiJzoCAC00frbpcwxeYfvQ+PP9LU/d70j+QvjWgYe98Qa3ekLaBU6r/AvWm8ThKCDUCLWrQQ==",
      "dev": true,
      "engines": {
        "node": ">=0.8.x"
      }
    },
    "node_modules/@frida/http": {
      "version": "4.0.2",
      "resolved": "https://registry.npmjs.org/@frida/http/-/http-4.0.2.tgz",
      "integrity": "sha512-cvkc7ex7GmVXVOWqtjXKBWUUbYEBgpNRKZbEEoMeI8KiIs8zejKwg+N7rx7296Ao+EP3+xcUr4wBVr3xLaUVfQ==",
      "dev": true,
      "dependencies": {
        "http-parser-js": "^0.5.3"
      }
    },
    "node_modules/@frida/http-parser-js": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/@frida/http-parser-js/-/http-parser-js-1.0.0.tgz",
      "integrity": "sha512-2nMrNXt/OeTlWbqnE8AH4Sfz4I2+BGoN206dzKEyC/g2svtn83Xu+zuv/V3TkwrA27s26Mcy84ZwsXeNlqNxUQ==",
      "dev": true
    },
    "node_modules/@frida/https": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/@frida/https/-/https-1.0.0.tgz",
      "integrity": "sha512-OiqQ6qsALcWOktRLq07oJ0i6sH8eX6MXb/MdZS1qVKDRf6wchH4Pjn6fiLB+pt/OlYbggk+DOfpHwSdjTwuHMQ==",
      "dev": true
    },
    "node_modules/@frida/ieee754": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/@frida/ieee754/-/ieee754-2.0.2.tgz",
      "integrity": "sha512-wlcUebnne4ENN7GDr5pTH598ZDLMVOsh0FjenxeVOe6u7ewZkz9gGRnLnZKJAm9kl5G6XhdxhI0cSXVQK/rQUw==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ]
    },
    "node_modules/@frida/net": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/@frida/net/-/net-4.0.1.tgz",
      "integrity": "sha512-lmzg7LMjjWluu2RqE4PSe5QpgYEbCWjL08twsOLcYnhMz95jWmxY35A0PBySrEw1ulaflsMvXwsONnhl5bk6AQ==",
      "dev": true
    },
    "node_modules/@frida/os": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/@frida/os/-/os-1.0.2.tgz",
      "integrity": "sha512-3ISAiGNiyIya3QN2EHBCz1wqP0enTdSxP99wUeroeh8+AQRmgoOr/5TRnrVry8pe378anay3fmV/tdUMMSkehQ==",
      "dev": true
    },
    "node_modules/@frida/path": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/@frida/path/-/path-2.0.3.tgz",
      "integrity": "sha512-2RQy36QatoC846fzBhBhV8sXMsSOBGoYvwTHeaE1zUdz7F4RNScP4QEekTTooBYWYX/XjiF36KQpYAzc9OYFtg==",
      "dev": true
    },
    "node_modules/@frida/process": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/@frida/process/-/process-1.2.1.tgz",
      "integrity": "sha512-nvCu22DstFW2ttGFtOKekHM7vnjbZm+XgtvavOt427GNT6uV7k0JYK9tnMbcLMRWv57DG6udAmuJlWs8Paq1ag==",
      "dev": true
    },
    "node_modules/@frida/punycode": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/@frida/punycode/-/punycode-3.0.0.tgz",
      "integrity": "sha512-XVSDY2KamDs1D5/fTVgHcOSNxdU4kTboxzqJMBbTjcQC7XScIT9c0EfbwKCq7Kci6gWQdsHSCr7lU+9Oc4KAdg==",
      "dev": true
    },
    "node_modules/@frida/querystring": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/@frida/querystring/-/querystring-1.0.0.tgz",
      "integrity": "sha512-15m1fOZPmoO/vWlgPJrG/J9/BJDz6a2/JpVGpS8ynNzo+fBhTznaStX5nHxUs24mVTqh/OqLo0EiYJM5WWHXxg==",
      "dev": true
    },
    "node_modules/@frida/readable-stream": {
      "version": "4.1.3",
      "resolved": "https://registry.npmjs.org/@frida/readable-stream/-/readable-stream-4.1.3.tgz",
      "integrity": "sha512-ntGUFmi+CryRGRJIK13a/VST2Ad19uivbln8Xd92vKPAARq+6vMIASDyZIqyl5BLRccfiyCHdYgrgQ6RI5rUig==",
      "dev": true
    },
    "node_modules/@frida/reserved-words": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/@frida/reserved-words/-/reserved-words-1.0.0.tgz",
      "integrity": "sha512-2yG/XxJlsGlk/mm6eZTb4OAaQEhkTI2qaFfZFtAsrA/XuCpuMWkS4y/guyBlsRu4hAuhK2HPmNM8+OLLK1zM9Q==",
      "dev": true
    },
    "node_modules/@frida/stream": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/@frida/stream/-/stream-1.0.2.tgz",
      "integrity": "sha512-4OuaC1ztmEKgTq3WeBhsy8Oq+AwW9n9cYnvLklcC9jwD93AEwgbWpecLlxJCVuALvTMdhKPg0nQVfyGYP/i9Bw==",
      "dev": true,
      "dependencies": {
        "@frida/readable-stream": "^4.1.3"
      }
    },
    "node_modules/@frida/string_decoder": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/@frida/string_decoder/-/string_decoder-2.0.0.tgz",
      "integrity": "sha512-in371tYZMHQiW9HF5MS3JDw6Ao6tyBoq34UWy2rzOswYyMG1rpizh85ofi/yVkxDiaqybEZefxzkVittpPGT6g==",
      "dev": true
    },
    "node_modules/@frida/timers": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/@frida/timers/-/timers-3.0.0.tgz",
      "integrity": "sha512-3b+0igv10aT8TMxefrTAd06rActqbxJLY2Xkkq9vYcPBffB/yHszl0NYIp/5ko8WC3ecDYPU6bQiY6fjs72zTA==",
      "dev": true
    },
    "node_modules/@frida/tty": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/@frida/tty/-/tty-1.0.0.tgz",
      "integrity": "sha512-p/kjLnKYxEAB1MdYP8+5rKv9CsHzyA+0jg9BcGETzjQVKHHcroHDULRxDYUh+DC7qs6cpX8QdDQh9E+a6ydgsQ==",
      "dev": true
    },
    "node_modules/@frida/url": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/@frida/url/-/url-1.0.2.tgz",
      "integrity": "sha512-ZKunbKJHMr8w2Eb/5K1avy0MzK1B998S17wYXNv3RmzBGxMm8S5T0F3qEpRxkU7/72P8m4izyQU87fWl+FjQsQ==",
      "dev": true,
      "dependencies": {
        "@frida/punycode": "^3.0.0",
        "@frida/querystring": "^1.0.0"
      }
    },
    "node_modules/@frida/util": {
      "version": "1.0.3",
      "resolved": "https://registry.npmjs.org/@frida/util/-/util-1.0.3.tgz",
      "integrity": "sha512-htcG3uDiRXv89ERVNNYhfase39kJ2X75ZARfrYcYEtJLFEsSk0nemM1YnEIR4CjrHvdvkWHrwgKkS+acOyoNEg==",
      "dev": true
    },
    "node_modules/@frida/vm": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/@frida/vm/-/vm-2.0.0.tgz",
      "integrity": "sha512-7fsjLWscZT5odNIBtg6qbLNI+vAk1xmii6H5W2kaYkMYt0vRohQEcDSUWacA+eaWlu5SvMjZI82Yibj/3G9pJw==",
      "dev": true
    },
    "node_modules/@jridgewell/gen-mapping": {
      "version": "0.3.2",
      "resolved": "https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.2.tgz",
      "integrity": "sha512-mh65xKQAzI6iBcFzwv28KVWSmCkdRBWoOh+bYQGW3+6OZvbbN3TqMGo5hqYxQniRcH9F2VZIoJCm4pa3BPDK/A==",
      "dev": true,
      "dependencies": {
        "@jridgewell/set-array": "^1.0.1",
        "@jridgewell/sourcemap-codec": "^1.4.10",
        "@jridgewell/trace-mapping": "^0.3.9"
      },
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@jridgewell/resolve-uri": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.0.tgz",
      "integrity": "sha512-F2msla3tad+Mfht5cJq7LSXcdudKTWCVYUgw6pLFOOHSTtZlj6SWNYAp+AhuqLmWdBO2X5hPrLcu8cVP8fy28w==",
      "dev": true,
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@jridgewell/set-array": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/@jridgewell/set-array/-/set-array-1.1.2.tgz",
      "integrity": "sha512-xnkseuNADM0gt2bs+BvhO0p78Mk762YnZdsuzFV018NoG1Sj1SCQvpSqa7XUaTam5vAGasABV9qXASMKnFMwMw==",
      "dev": true,
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@jridgewell/source-map": {
      "version": "0.3.2",
      "resolved": "https://registry.npmjs.org/@jridgewell/source-map/-/source-map-0.3.2.tgz",
      "integrity": "sha512-m7O9o2uR8k2ObDysZYzdfhb08VuEml5oWGiosa1VdaPZ/A6QyPkAJuwN0Q1lhULOf6B7MtQmHENS743hWtCrgw==",
      "dev": true,
      "dependencies": {
        "@jridgewell/gen-mapping": "^0.3.0",
        "@jridgewell/trace-mapping": "^0.3.9"
      }
    },
    "node_modules/@jridgewell/sourcemap-codec": {
      "version": "1.4.14",
      "resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.4.14.tgz",
      "integrity": "sha512-XPSJHWmi394fuUuzDnGz1wiKqWfo1yXecHQMRf2l6hztTO+nPru658AyDngaBe7isIxEkRsPR3FZh+s7iVa4Uw==",
      "dev": true
    },
    "node_modules/@jridgewell/trace-mapping": {
      "version": "0.3.17",
      "resolved": "https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.17.tgz",
      "integrity": "sha512-MCNzAp77qzKca9+W/+I0+sEpaUnZoeasnghNeVc41VZCEKaCH73Vq3BZZ/SzWIgrqE4H4ceI+p+b6C0mHf9T4g==",
      "dev": true,
      "dependencies": {
        "@jridgewell/resolve-uri": "3.1.0",
        "@jridgewell/sourcemap-codec": "1.4.14"
      }
    },
    "node_modules/@types/frida-gum": {
      "version": "18.3.1",
      "resolved": "https://registry.npmjs.org/@types/frida-gum/-/frida-gum-18.3.1.tgz",
      "integrity": "sha512-8lD4UQZa7V9+eQ9wfBAf+iLk/bq+u998podeXYTeWQu03sacSF70XL+WcYmhvAkNMF3OS9nkb4VtfRd8Ly7a3A==",
      "dev": true
    },
    "node_modules/@types/node": {
      "version": "18.15.9",
      "resolved": "https://registry.npmjs.org/@types/node/-/node-18.15.9.tgz",
      "integrity": "sha512-dUxhiNzBLr6IqlZXz6e/rN2YQXlFgOei/Dxy+e3cyXTJ4txSUbGT2/fmnD6zd/75jDMeW5bDee+YXxlFKHoV0A==",
      "dev": true
    },
    "node_modules/acorn": {
      "version": "8.8.2",
      "resolved": "https://registry.npmjs.org/acorn/-/acorn-8.8.2.tgz",
      "integrity": "sha512-xjIYgE8HBrkpd/sJqOGNspf8uHG+NOHGOw6a/Urj8taM2EXfdNAH2oFcPeIFfsv3+kz/mJrS5VuMqbNLjCa2vw==",
      "dev": true,
      "bin": {
        "acorn": "bin/acorn"
      },
      "engines": {
        "node": ">=0.4.0"
      }
    },
    "node_modules/base64-js": {
      "version": "1.5.1",
      "resolved": "https://registry.npmjs.org/base64-js/-/base64-js-1.5.1.tgz",
      "integrity": "sha512-AKpaYlHn8t4SVbOHCy+b5+KKgvR4vrsD8vbvrbiQJps7fKDTkjkDry6ji0rUJjC0kzbNePLwzxq8iypo41qeWA==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ]
    },
    "node_modules/buffer-from": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/buffer-from/-/buffer-from-1.1.2.tgz",
      "integrity": "sha512-E+XQCRwSbaaiChtv6k6Dwgc+bx+Bs6vuKJHHl5kox/BaKbhiXzqQOwK4cO22yElGp2OCmjwVhT3HmxgyPGnJfQ==",
      "dev": true
    },
    "node_modules/commander": {
      "version": "9.5.0",
      "resolved": "https://registry.npmjs.org/commander/-/commander-9.5.0.tgz",
      "integrity": "sha512-KRs7WVDKg86PWiuAqhDrAQnTXZKraVcCc6vFdL14qrZ/DcWwuRo7VoiYXalXO7S5GKpqYiVEwCbgFDfxNHKJBQ==",
      "dev": true,
      "engines": {
        "node": "^12.20.0 || >=14"
      }
    },
    "node_modules/frida-compile": {
      "version": "15.1.1",
      "resolved": "https://registry.npmjs.org/frida-compile/-/frida-compile-15.1.1.tgz",
      "integrity": "sha512-cSmFwgazxIWi5lyPRntqZI+VUhfh6EwxTPDIA1PQOUoupv5B0MMri8g7wZ8/FpFxcGUsy6YtoQ9FEh22oq6pBQ==",
      "dev": true,
      "dependencies": {
        "@frida/assert": "^3.0.1",
        "@frida/base64-js": "^2.0.3",
        "@frida/buffer": "^7.0.4",
        "@frida/crosspath": "^3.0.0",
        "@frida/diagnostics_channel": "^1.0.0",
        "@frida/events": "^4.0.4",
        "@frida/http": "^4.0.1",
        "@frida/http-parser-js": "^1.0.0",
        "@frida/https": "^1.0.0",
        "@frida/ieee754": "^2.0.2",
        "@frida/net": "^4.0.0",
        "@frida/os": "^1.0.0",
        "@frida/path": "^2.0.2",
        "@frida/process": "^1.2.0",
        "@frida/punycode": "^3.0.0",
        "@frida/querystring": "^1.0.0",
        "@frida/readable-stream": "^4.1.3",
        "@frida/reserved-words": "^1.0.0",
        "@frida/stream": "^1.0.1",
        "@frida/string_decoder": "^2.0.0",
        "@frida/timers": "^3.0.0",
        "@frida/tty": "^1.0.0",
        "@frida/url": "^1.0.1",
        "@frida/util": "^1.0.3",
        "@frida/vm": "^2.0.0",
        "commander": "^9.3.0",
        "frida-fs": "^5.2.0",
        "terser": "^5.14.1",
        "typed-emitter": "^2.1.0"
      },
      "bin": {
        "frida-compile": "dist/cli.js"
      }
    },
    "node_modules/frida-fs": {
      "version": "5.2.2",
      "resolved": "https://registry.npmjs.org/frida-fs/-/frida-fs-5.2.2.tgz",
      "integrity": "sha512-AMOuNtYC76z/b13PnRMyWC+JPHr134SU+erBsZLyCAFaRGOkaDVRQLT2vfXcXqJTLdoIdiUeIUREF78Js18NLA==",
      "dev": true
    },
    "node_modules/http-parser-js": {
      "version": "0.5.8",
      "resolved": "https://registry.npmjs.org/http-parser-js/-/http-parser-js-0.5.8.tgz",
      "integrity": "sha512-SGeBX54F94Wgu5RH3X5jsDtf4eHyRogWX1XGT3b4HuW3tQPM4AaBzoUji/4AAJNXCEOWZ5O0DgZmJw1947gD5Q==",
      "dev": true
    },
    "node_modules/ieee754": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/ieee754/-/ieee754-1.2.1.tgz",
      "integrity": "sha512-dcyqhDvX1C46lXZcVqCpK+FtMRQVdIMN6/Df5js2zouUsqG7I6sFxitIC+7KYK29KdXOLHdu9zL4sFnoVQnqaA==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/feross"
        },
        {
          "type": "patreon",
          "url": "https://www.patreon.com/feross"
        },
        {
          "type": "consulting",
          "url": "https://feross.org/support"
        }
      ]
    },
    "node_modules/source-map": {
      "version": "0.6.1",
      "resolved": "https://registry.npmjs.org/source-map/-/source-map-0.6.1.tgz",
      "integrity": "sha512-UjgapumWlbMhkBgzT7Ykc5YXUT46F0iKu8SGXq0bcwP5dz/h0Plj6enJqjz1Zbq2l5WaqYnrVbwWOWMyF3F47g==",
      "dev": true,
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/source-map-support": {
      "version": "0.5.21",
      "resolved": "https://registry.npmjs.org/source-map-support/-/source-map-support-0.5.21.tgz",
      "integrity": "sha512-uBHU3L3czsIyYXKX88fdrGovxdSCoTGDRZ6SYXtSRxLZUzHg5P/66Ht6uoUlHu9EZod+inXhKo3qQgwXUT/y1w==",
      "dev": true,
      "dependencies": {
        "buffer-from": "^1.0.0",
        "source-map": "^0.6.0"
      }
    },
    "node_modules/terser": {
      "version": "5.16.8",
      "resolved": "https://registry.npmjs.org/terser/-/terser-5.16.8.tgz",
      "integrity": "sha512-QI5g1E/ef7d+PsDifb+a6nnVgC4F22Bg6T0xrBrz6iloVB4PUkkunp6V8nzoOOZJIzjWVdAGqCdlKlhLq/TbIA==",
      "dev": true,
      "dependencies": {
        "@jridgewell/source-map": "^0.3.2",
        "acorn": "^8.5.0",
        "commander": "^2.20.0",
        "source-map-support": "~0.5.20"
      },
      "bin": {
        "terser": "bin/terser"
      },
      "engines": {
        "node": ">=10"
      }
    },
    "node_modules/terser/node_modules/commander": {
      "version": "2.20.3",
      "resolved": "https://registry.npmjs.org/commander/-/commander-2.20.3.tgz",
      "integrity": "sha512-GpVkmM8vF2vQUkj2LvZmD35JxeJOLCwJ9cUkugyk2nuhbv3+mJvpLYYt+0+USMxE+oj+ey/lJEnhZw75x/OMcQ==",
      "dev": true
    },
    "node_modules/typed-emitter": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/typed-emitter/-/typed-emitter-2.1.0.tgz",
      "integrity": "sha512-g/KzbYKbH5C2vPkaXGu8DJlHrGKHLsM25Zg9WuC9pMGfuvT+X25tZQWo5fK1BjBm8+UrVE9LDCvaY0CQk+fXDA==",
      "dev": true,
      "optionalDependencies": {
        "rxjs": "*"
      }
    }
  },
  "dependencies": {
    "@frida/assert": {
      "version": "3.0.2",
      "resolved": "https://registry.npmjs.org/@frida/assert/-/assert-3.0.2.tgz",
      "integrity": "sha512-JXJq5SbXGrM5EkjrZKfRmB29zOoEOix02NC6A5TSJ+C1GE/X051EinJJsuOO2pEOx7KZwpvAHvS0WXW0+levKg==",
      "dev": true
    },
    "@frida/base64-js": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/@frida/base64-js/-/base64-js-2.0.3.tgz",
      "integrity": "sha512-2w0F+1TynOTCZ/v7du9LdHPWwq0lJhazjo2fF9upMyQmA1zHetT14fLuQ1v/6T0qPgyeEGkiSrybstU8EsgeUA==",
      "dev": true
    },
    "@frida/buffer": {
      "version": "7.0.4",
      "resolved": "https://registry.npmjs.org/@frida/buffer/-/buffer-7.0.4.tgz",
      "integrity": "sha512-RxQ1lZRRiCJj7nhcCiD8xeJx0NsLpGGnjqsmTg7jShGmbnVFMN5W7+J+3gqdPSQhc/IxNBIWc6zRXVp4+qnYHg==",
      "dev": true,
      "requires": {
        "base64-js": "^1.5.1",
        "ieee754": "^1.2.1"
      }
    },
    "@frida/crosspath": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/@frida/crosspath/-/crosspath-3.0.0.tgz",
      "integrity": "sha512-bNdO1spIPD2P40XtK89N49oZpJhstdlnkJZcD4yJ17jrdkm9Ctu0sd9MIEX6Z8Tm8ydhVJBAOMEKl9/R27onAQ==",
      "dev": true,
      "requires": {
        "@types/node": "^17.0.36"
      },
      "dependencies": {
        "@types/node": {
          "version": "17.0.45",
          "resolved": "https://registry.npmjs.org/@types/node/-/node-17.0.45.tgz",
          "integrity": "sha512-w+tIMs3rq2afQdsPJlODhoUEKzFP1ayaoyl1CcnwtIlsVe7K7bA1NGm4s3PraqTLlXnbIN84zuBlxBWo1u9BLw==",
          "dev": true
        }
      }
    },
    "@frida/diagnostics_channel": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/@frida/diagnostics_channel/-/diagnostics_channel-1.0.0.tgz",
      "integrity": "sha512-mYX1jp/5Bpk24tHArJNx65iCk7qSuV8YJkdU0gFNVtJUXxfV8BG5WuPa4mL+ynxsbWWpsg/cwKZbLAepYKTdQQ==",
      "dev": true
    },
    "@frida/events": {
      "version": "4.0.4",
      "resolved": "https://registry.npmjs.org/@frida/events/-/events-4.0.4.tgz",
      "integrity": "sha512-qJVQ6VWHf9sjUKuiJzoCAC00frbpcwxeYfvQ+PP9LU/d70j+QvjWgYe98Qa3ekLaBU6r/AvWm8ThKCDUCLWrQQ==",
      "dev": true
    },
    "@frida/http": {
      "version": "4.0.2",
      "resolved": "https://registry.npmjs.org/@frida/http/-/http-4.0.2.tgz",
      "integrity": "sha512-cvkc7ex7GmVXVOWqtjXKBWUUbYEBgpNRKZbEEoMeI8KiIs8zejKwg+N7rx7296Ao+EP3+xcUr4wBVr3xLaUVfQ==",
      "dev": true,
      "requires": {
        "http-parser-js": "^0.5.3"
      }
    },
    "@frida/http-parser-js": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/@frida/http-parser-js/-/http-parser-js-1.0.0.tgz",
      "integrity": "sha512-2nMrNXt/OeTlWbqnE8AH4Sfz4I2+BGoN206dzKEyC/g2svtn83Xu+zuv/V3TkwrA27s26Mcy84ZwsXeNlqNxUQ==",
      "dev": true
    },
    "@frida/https": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/@frida/https/-/https-1.0.0.tgz",
      "integrity": "sha512-OiqQ6qsALcWOktRLq07oJ0i6sH8eX6MXb/MdZS1qVKDRf6wchH4Pjn6fiLB+pt/OlYbggk+DOfpHwSdjTwuHMQ==",
      "dev": true
    },
    "@frida/ieee754": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/@frida/ieee754/-/ieee754-2.0.2.tgz",
      "integrity": "sha512-wlcUebnne4ENN7GDr5pTH598ZDLMVOsh0FjenxeVOe6u7ewZkz9gGRnLnZKJAm9kl5G6XhdxhI0cSXVQK/rQUw==",
      "dev": true
    },
    "@frida/net": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/@frida/net/-/net-4.0.1.tgz",
      "integrity": "sha512-lmzg7LMjjWluu2RqE4PSe5QpgYEbCWjL08twsOLcYnhMz95jWmxY35A0PBySrEw1ulaflsMvXwsONnhl5bk6AQ==",
      "dev": true
    },
    "@frida/os": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/@frida/os/-/os-1.0.2.tgz",
      "integrity": "sha512-3ISAiGNiyIya3QN2EHBCz1wqP0enTdSxP99wUeroeh8+AQRmgoOr/5TRnrVry8pe378anay3fmV/tdUMMSkehQ==",
      "dev": true
    },
    "@frida/path": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/@frida/path/-/path-2.0.3.tgz",
      "integrity": "sha512-2RQy36QatoC846fzBhBhV8sXMsSOBGoYvwTHeaE1zUdz7F4RNScP4QEekTTooBYWYX/XjiF36KQpYAzc9OYFtg==",
      "dev": true
    },
    "@frida/process": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/@frida/process/-/process-1.2.1.tgz",
      "integrity": "sha512-nvCu22DstFW2ttGFtOKekHM7vnjbZm+XgtvavOt427GNT6uV7k0JYK9tnMbcLMRWv57DG6udAmuJlWs8Paq1ag==",
      "dev": true
    },
    "@frida/punycode": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/@frida/punycode/-/punycode-3.0.0.tgz",
      "integrity": "sha512-XVSDY2KamDs1D5/fTVgHcOSNxdU4kTboxzqJMBbTjcQC7XScIT9c0EfbwKCq7Kci6gWQdsHSCr7lU+9Oc4KAdg==",
      "dev": true
    },
    "@frida/querystring": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/@frida/querystring/-/querystring-1.0.0.tgz",
      "integrity": "sha512-15m1fOZPmoO/vWlgPJrG/J9/BJDz6a2/JpVGpS8ynNzo+fBhTznaStX5nHxUs24mVTqh/OqLo0EiYJM5WWHXxg==",
      "dev": true
    },
    "@frida/readable-stream": {
      "version": "4.1.3",
      "resolved": "https://registry.npmjs.org/@frida/readable-stream/-/readable-stream-4.1.3.tgz",
      "integrity": "sha512-ntGUFmi+CryRGRJIK13a/VST2Ad19uivbln8Xd92vKPAARq+6vMIASDyZIqyl5BLRccfiyCHdYgrgQ6RI5rUig==",
      "dev": true
    },
    "@frida/reserved-words": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/@frida/reserved-words/-/reserved-words-1.0.0.tgz",
      "integrity": "sha512-2yG/XxJlsGlk/mm6eZTb4OAaQEhkTI2qaFfZFtAsrA/XuCpuMWkS4y/guyBlsRu4hAuhK2HPmNM8+OLLK1zM9Q==",
      "dev": true
    },
    "@frida/stream": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/@frida/stream/-/stream-1.0.2.tgz",
      "integrity": "sha512-4OuaC1ztmEKgTq3WeBhsy8Oq+AwW9n9cYnvLklcC9jwD93AEwgbWpecLlxJCVuALvTMdhKPg0nQVfyGYP/i9Bw==",
      "dev": true,
      "requires": {
        "@frida/readable-stream": "^4.1.3"
      }
    },
    "@frida/string_decoder": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/@frida/string_decoder/-/string_decoder-2.0.0.tgz",
      "integrity": "sha512-in371tYZMHQiW9HF5MS3JDw6Ao6tyBoq34UWy2rzOswYyMG1rpizh85ofi/yVkxDiaqybEZefxzkVittpPGT6g==",
      "dev": true
    },
    "@frida/timers": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/@frida/timers/-/timers-3.0.0.tgz",
      "integrity": "sha512-3b+0igv10aT8TMxefrTAd06rActqbxJLY2Xkkq9vYcPBffB/yHszl0NYIp/5ko8WC3ecDYPU6bQiY6fjs72zTA==",
      "dev": true
    },
    "@frida/tty": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/@frida/tty/-/tty-1.0.0.tgz",
      "integrity": "sha512-p/kjLnKYxEAB1MdYP8+5rKv9CsHzyA+0jg9BcGETzjQVKHHcroHDULRxDYUh+DC7qs6cpX8QdDQh9E+a6ydgsQ==",
      "dev": true
    },
    "@frida/url": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/@frida/url/-/url-1.0.2.tgz",
      "integrity": "sha512-ZKunbKJHMr8w2Eb/5K1avy0MzK1B998S17wYXNv3RmzBGxMm8S5T0F3qEpRxkU7/72P8m4izyQU87fWl+FjQsQ==",
      "dev": true,
      "requires": {
        "@frida/punycode": "^3.0.0",
        "@frida/querystring": "^1.0.0"
      }
    },
    "@frida/util": {
      "version": "1.0.3",
      "resolved": "https://registry.npmjs.org/@frida/util/-/util-1.0.3.tgz",
      "integrity": "sha512-htcG3uDiRXv89ERVNNYhfase39kJ2X75ZARfrYcYEtJLFEsSk0nemM1YnEIR4CjrHvdvkWHrwgKkS+acOyoNEg==",
      "dev": true
    },
    "@frida/vm": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/@frida/vm/-/vm-2.0.0.tgz",
      "integrity": "sha512-7fsjLWscZT5odNIBtg6qbLNI+vAk1xmii6H5W2kaYkMYt0vRohQEcDSUWacA+eaWlu5SvMjZI82Yibj/3G9pJw==",
      "dev": true
    },
    "@jridgewell/gen-mapping": {
      "version": "0.3.2",
      "resolved": "https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.2.tgz",
      "integrity": "sha512-mh65xKQAzI6iBcFzwv28KVWSmCkdRBWoOh+bYQGW3+6OZvbbN3TqMGo5hqYxQniRcH9F2VZIoJCm4pa3BPDK/A==",
      "dev": true,
      "requires": {
        "@jridgewell/set-array": "^1.0.1",
        "@jridgewell/sourcemap-codec": "^1.4.10",
        "@jridgewell/trace-mapping": "^0.3.9"
      }
    },
    "@jridgewell/resolve-uri": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.0.tgz",
      "integrity": "sha512-F2msla3tad+Mfht5cJq7LSXcdudKTWCVYUgw6pLFOOHSTtZlj6SWNYAp+AhuqLmWdBO2X5hPrLcu8cVP8fy28w==",
      "dev": true
    },
    "@jridgewell/set-array": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/@jridgewell/set-array/-/set-array-1.1.2.tgz",
      "integrity": "sha512-xnkseuNADM0gt2bs+BvhO0p78Mk762YnZdsuzFV018NoG1Sj1SCQvpSqa7XUaTam5vAGasABV9qXASMKnFMwMw==",
      "dev": true
    },
    "@jridgewell/source-map": {
      "version": "0.3.2",
      "resolved": "https://registry.npmjs.org/@jridgewell/source-map/-/source-map-0.3.2.tgz",
      "integrity": "sha512-m7O9o2uR8k2ObDysZYzdfhb08VuEml5oWGiosa1VdaPZ/A6QyPkAJuwN0Q1lhULOf6B7MtQmHENS743hWtCrgw==",
      "dev": true,
      "requires": {
        "@jridgewell/gen-mapping": "^0.3.0",
        "@jridgewell/trace-mapping": "^0.3.9"
      }
    },
    "@jridgewell/sourcemap-codec": {
      "version": "1.4.14",
      "resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.4.14.tgz",
      "integrity": "sha512-XPSJHWmi394fuUuzDnGz1wiKqWfo1yXecHQMRf2l6hztTO+nPru658AyDngaBe7isIxEkRsPR3FZh+s7iVa4Uw==",
      "dev": true
    },
    "@jridgewell/trace-mapping": {
      "version": "0.3.17",
      "resolved": "https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.17.tgz",
      "integrity": "sha512-MCNzAp77qzKca9+W/+I0+sEpaUnZoeasnghNeVc41VZCEKaCH73Vq3BZZ/SzWIgrqE4H4ceI+p+b6C0mHf9T4g==",
      "dev": true,
      "requires": {
        "@jridgewell/resolve-uri": "3.1.0",
        "@jridgewell/sourcemap-codec": "1.4.14"
      }
    },
    "@types/frida-gum": {
      "version": "18.3.1",
      "resolved": "https://registry.npmjs.org/@types/frida-gum/-/frida-gum-18.3.1.tgz",
      "integrity": "sha512-8lD4UQZa7V9+eQ9wfBAf+iLk/bq+u998podeXYTeWQu03sacSF70XL+WcYmhvAkNMF3OS9nkb4VtfRd8Ly7a3A==",
      "dev": true
    },
    "@types/node": {
      "version": "18.15.9",
      "resolved": "https://registry.npmjs.org/@types/node/-/node-18.15.9.tgz",
      "integrity": "sha512-dUxhiNzBLr6IqlZXz6e/rN2YQXlFgOei/Dxy+e3cyXTJ4txSUbGT2/fmnD6zd/75jDMeW5bDee+YXxlFKHoV0A==",
      "dev": true
    },
    "acorn": {
      "version": "8.8.2",
      "resolved": "https://registry.npmjs.org/acorn/-/acorn-8.8.2.tgz",
      "integrity": "sha512-xjIYgE8HBrkpd/sJqOGNspf8uHG+NOHGOw6a/Urj8taM2EXfdNAH2oFcPeIFfsv3+kz/mJrS5VuMqbNLjCa2vw==",
      "dev": true
    },
    "base64-js": {
      "version": "1.5.1",
      "resolved": "https://registry.npmjs.org/base64-js/-/base64-js-1.5.1.tgz",
      "integrity": "sha512-AKpaYlHn8t4SVbOHCy+b5+KKgvR4vrsD8vbvrbiQJps7fKDTkjkDry6ji0rUJjC0kzbNePLwzxq8iypo41qeWA==",
      "dev": true
    },
    "buffer-from": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/buffer-from/-/buffer-from-1.1.2.tgz",
      "integrity": "sha512-E+XQCRwSbaaiChtv6k6Dwgc+bx+Bs6vuKJHHl5kox/BaKbhiXzqQOwK4cO22yElGp2OCmjwVhT3HmxgyPGnJfQ==",
      "dev": true
    },
    "commander": {
      "version": "9.5.0",
      "resolved": "https://registry.npmjs.org/commander/-/commander-9.5.0.tgz",
      "integrity": "sha512-KRs7WVDKg86PWiuAqhDrAQnTXZKraVcCc6vFdL14qrZ/DcWwuRo7VoiYXalXO7S5GKpqYiVEwCbgFDfxNHKJBQ==",
      "dev": true
    },
    "frida-compile": {
      "version": "15.1.1",
      "resolved": "https://registry.npmjs.org/frida-compile/-/frida-compile-15.1.1.tgz",
      "integrity": "sha512-cSmFwgazxIWi5lyPRntqZI+VUhfh6EwxTPDIA1PQOUoupv5B0MMri8g7wZ8/FpFxcGUsy6YtoQ9FEh22oq6pBQ==",
      "dev": true,
      "requires": {
        "@frida/assert": "^3.0.1",
        "@frida/base64-js": "^2.0.3",
        "@frida/buffer": "^7.0.4",
        "@frida/crosspath": "^3.0.0",
        "@frida/diagnostics_channel": "^1.0.0",
        "@frida/events": "^4.0.4",
        "@frida/http": "^4.0.1",
        "@frida/http-parser-js": "^1.0.0",
        "@frida/https": "^1.0.0",
        "@frida/ieee754": "^2.0.2",
        "@frida/net": "^4.0.0",
        "@frida/os": "^1.0.0",
        "@frida/path": "^2.0.2",
        "@frida/process": "^1.2.0",
        "@frida/punycode": "^3.0.0",
        "@frida/querystring": "^1.0.0",
        "@frida/readable-stream": "^4.1.3",
        "@frida/reserved-words": "^1.0.0",
        "@frida/stream": "^1.0.1",
        "@frida/string_decoder": "^2.0.0",
        "@frida/timers": "^3.0.0",
        "@frida/tty": "^1.0.0",
        "@frida/url": "^1.0.1",
        "@frida/util": "^1.0.3",
        "@frida/vm": "^2.0.0",
        "commander": "^9.3.0",
        "frida-fs": "^5.2.0",
        "terser": "^5.14.1",
        "typed-emitter": "^2.1.0"
      }
    },
    "frida-fs": {
      "version": "5.2.2",
      "resolved": "https://registry.npmjs.org/frida-fs/-/frida-fs-5.2.2.tgz",
      "integrity": "sha512-AMOuNtYC76z/b13PnRMyWC+JPHr134SU+erBsZLyCAFaRGOkaDVRQLT2vfXcXqJTLdoIdiUeIUREF78Js18NLA==",
      "dev": true
    },
    "http-parser-js": {
      "version": "0.5.8",
      "resolved": "https://registry.npmjs.org/http-parser-js/-/http-parser-js-0.5.8.tgz",
      "integrity": "sha512-SGeBX54F94Wgu5RH3X5jsDtf4eHyRogWX1XGT3b4HuW3tQPM4AaBzoUji/4AAJNXCEOWZ5O0DgZmJw1947gD5Q==",
      "dev": true
    },
    "ieee754": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/ieee754/-/ieee754-1.2.1.tgz",
      "integrity": "sha512-dcyqhDvX1C46lXZcVqCpK+FtMRQVdIMN6/Df5js2zouUsqG7I6sFxitIC+7KYK29KdXOLHdu9zL4sFnoVQnqaA==",
      "dev": true
    },
    "source-map": {
      "version": "0.6.1",
      "resolved": "https://registry.npmjs.org/source-map/-/source-map-0.6.1.tgz",
      "integrity": "sha512-UjgapumWlbMhkBgzT7Ykc5YXUT46F0iKu8SGXq0bcwP5dz/h0Plj6enJqjz1Zbq2l5WaqYnrVbwWOWMyF3F47g==",
      "dev": true
    },
    "source-map-support": {
      "version": "0.5.21",
      "resolved": "https://registry.npmjs.org/source-map-support/-/source-map-support-0.5.21.tgz",
      "integrity": "sha512-uBHU3L3czsIyYXKX88fdrGovxdSCoTGDRZ6SYXtSRxLZUzHg5P/66Ht6uoUlHu9EZod+inXhKo3qQgwXUT/y1w==",
      "dev": true,
      "requires": {
        "buffer-from": "^1.0.0",
        "source-map": "^0.6.0"
      }
    },
    "terser": {
      "version": "5.16.8",
      "resolved": "https://registry.npmjs.org/terser/-/terser-5.16.8.tgz",
      "integrity": "sha512-QI5g1E/ef7d+PsDifb+a6nnVgC4F22Bg6T0xrBrz6iloVB4PUkkunp6V8nzoOOZJIzjWVdAGqCdlKlhLq/TbIA==",
      "dev": true,
      "requires": {
        "@jridgewell/source-map": "^0.3.2",
        "acorn": "^8.5.0",
        "commander": "^2.20.0",
        "source-map-support": "~0.5.20"
      },
      "dependencies": {
        "commander": {
          "version": "2.20.3",
          "resolved": "https://registry.npmjs.org/commander/-/commander-2.20.3.tgz",
          "integrity": "sha512-GpVkmM8vF2vQUkj2LvZmD35JxeJOLCwJ9cUkugyk2nuhbv3+mJvpLYYt+0+USMxE+oj+ey/lJEnhZw75x/OMcQ==",
          "dev": true
        }
      }
    },
    "typed-emitter": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/typed-emitter/-/typed-emitter-2.1.0.tgz",
      "integrity": "sha512-g/KzbYKbH5C2vPkaXGu8DJlHrGKHLsM25Zg9WuC9pMGfuvT+X25tZQWo5fK1BjBm8+UrVE9LDCvaY0CQk+fXDA==",
      "dev": true,
      "requires": {
        "rxjs": "*"
      }
    }
  }
}

```

`agent/package.json`:

```json
{
  "name": "vscode-frida-agent",
  "version": "1.0.0",
  "description": "",
  "private": true,
  "main": "src/index.ts",
  "scripts": {
    "prepare": "npm run build",
    "build": "frida-compile src/index.ts -o _agent.js",
    "watch": "npm run build -- -w"
  },
  "devDependencies": {
    "@types/frida-gum": "^18.1.0",
    "@types/node": "^18.6.4",
    "frida-compile": "^15.1.0"
  }
}

```

`agent/src/index.ts`:

```ts
/* eslint-disable curly */
/* eslint-disable @typescript-eslint/naming-convention */

import { start, stop } from './log.js';

enum Runtime {
  Java = 'Java',
  ObjectiveC = 'ObjectiveC',
  Generic = 'Generic',
};

rpc.exports = {
  start,
  stop,

  runtime() {
    if (Java.available) return Runtime.Java;
    if (ObjC.available) return Runtime.ObjectiveC;
    return Runtime.Generic;
  },

  ping: () => Process.id,

  classes: async () => [] as string[],
  protocols: async () => [] as string[],

  methodsOf: async (_name: string) => [] as string[],
  ownMethodsOf: async (_name: string) => [] as string[],
  superClass: async (_name: string) => { throw new Error('Not implemented'); },

  modules: () => Process.enumerateModules(),
  exports: (name: string) => Process.findModuleByName(name)?.enumerateExports(),
  imports: (name: string) => Process.findModuleByName(name)?.enumerateImports(),
  symbols: (name: string) => Process.findModuleByName(name)?.enumerateSymbols(),
};

if (Java.available) {
  function perform<T>(fn: () => T): Promise<T> {
    return new Promise<T>((resolve) => {
      Java.perform(() => {
        resolve(fn());
      });
    });
  };

  rpc.exports.classes = async () => perform(() => Java.enumerateLoadedClassesSync());
  rpc.exports.ownMethodsOf =
    rpc.exports.methodsOf =
    async (name: string) => perform(() => Java.use(name).class.getMethods());
  rpc.exports.fieldsOf = async (name: string) => perform(() => Java.use(name).class.getDeclaredFields());
  rpc.exports.superClass = async (name: string) => perform(() => Java.use(name).class.getSuperclass()?.getName());

} else if (ObjC.available) {
  rpc.exports.classes = async () => Object.keys(ObjC.classes);
  rpc.exports.protocols = async () => Object.keys(ObjC.protocols);

  function getClass(name: string) {
    if (ObjC.classes.hasOwnProperty(name)) return ObjC.classes[name];
    throw new Error(`Class ${name} not found`);
  }

  rpc.exports.ownMethodsOf = async (name: string) => getClass(name).$ownMethods;
  rpc.exports.methodsOf = async (name: string) => getClass(name).$methods;
  rpc.exports.fieldsOf = async (name: string) => getClass(name).$ivars;
  rpc.exports.superClass = async (name: string) => getClass(name).$superClass?.name;
}

```

`agent/src/log.ts`:

```ts
// sys/fcntl.h
const F_SETFL = 4;
const O_NONBLOCK = 0x0004;

const stderr = 2;
const SIZEOF_INT = 4; // for mac & iOS

const subject = 'syslog';
const fildes: NativePointer = Memory.alloc(SIZEOF_INT * 2);

let stream: UnixInputStream;

export function start() {
  stop();

  const resolve = (name: string): NativePointer => {
    const p = Module.findExportByName(null, name);
    if (!p) {
      throw new Error(`Platform not supported. Is your target on ${name}?`);
    }
    return p;
  }

  const pipe = new NativeFunction(resolve('pipe'), 'int', ['pointer']);
  const dup2 = new NativeFunction(resolve('dup2'), 'int', ['int', 'int']);
  const close = new NativeFunction(resolve('close'), 'int', ['int']);
  const fcntl = new NativeFunction(resolve('fcntl'), 'int', ['int', 'int', 'int']);

  pipe(fildes);

  const input = fildes.readInt();
  const output = fildes.add(SIZEOF_INT).readInt();

  dup2(output, stderr);
  close(output);
  fcntl(input, F_SETFL, O_NONBLOCK);

  stream = new UnixInputStream(input);

  function read() {
    stream.read(4096).then((buf) => {
      if (buf.byteLength) {
        send({ subject }, buf);
      }

      setImmediate(read);
    });
  }

  setImmediate(read);
}

export function stop() {
  if (stream) {
    stream.close();
  }
}

```

`agent/tsconfig.json`:

```json
{
  "compilerOptions": {
    "experimentalDecorators": true,
    "target": "es2020",
    "lib": ["es2020"],
    "allowJs": true,
    "noEmit": true,
    "strict": true,
    "esModuleInterop": true,
  },
  "exclude": ["node_modules", "dist", "_agent.js"]
}
```

`backend/android/get-frida.py`:

```py
#!/usr/bin/env python3

import logging
import urllib.request
import json
import lzma
import shutil
from pathlib import Path

MAPPING = {
    'x86': 'x86',
    'x86_64': 'x86_64',
    'arm64-v8a': 'arm64',
    'armeabi-v7a': 'arm',
}

RELEASE_URL = 'https://api.github.com/repos/frida/frida/releases/latest'


def download(abi: str, path: Path):
    try:
        arch = MAPPING[abi]
    except KeyError:
        raise RuntimeError('Unknown ABI: %s' % abi)

    suffix = '-android-%s.xz' % arch
    with urllib.request.urlopen(RELEASE_URL) as response:
        info = json.loads(response.read())

    for asset in info['assets']:
        name = asset['name']
        logging.debug('asset: %s', name)
        if name.startswith('frida-server') and name.endswith(suffix):
            url = asset['browser_download_url']
            break
    else:
        raise RuntimeError('Unable to find frida-server for %s' % arch)

    logging.debug('downloading %s to %s', url, path)
    with urllib.request.urlopen(url) as response:
        with lzma.LZMAFile(response) as archive:
            with path.open('wb') as fp:
                shutil.copyfileobj(archive, fp)


if __name__ == "__main__":
    import sys

    if len(sys.argv) != 3:
        print('usage: %s <abi> <path>' % sys.argv[0])
        sys.exit(1)

    abi = sys.argv[1]
    path = sys.argv[2]

    download(abi, Path(path))

```

`backend/core.py`:

```py
from pathlib import Path
import time
import tempfile
import base64

try:
    import frida
except ImportError:
    import sys
    sys.stderr.write(
        'Unable to import frida. Please ensure you have installed frida-tools via pip\n')
    sys.exit(-1)


def devices() -> list:
    props = ['id', 'name', 'type']

    def wrap(dev: frida.core.Device):
        obj = {prop: getattr(dev, prop) for prop in props}
        try:
            obj['os'] = dev.query_system_parameters()['os']['id']
        except (frida.ServerNotRunningError, KeyError, frida.TransportError, frida.NotSupportedError):
            obj['os'] = 'unknown'
        return obj

    # workaround
    try:
        frida.get_usb_device(1)
    except:
        pass

    return [wrap(dev) for dev in frida.enumerate_devices()]


def get_device(device_id: str) -> frida.core.Device:
    if device_id == 'usb':
        return frida.get_usb_device(1)
    elif device_id == 'local':
        return frida.get_local_device()
    else:
        return frida.get_device(device_id, timeout=1)


def info_wrap(props, fmt):
    def wrap(target):
        obj = {prop: getattr(target, prop) for prop in props}

        icons = target.parameters.get('icons', [])
        try:
            icon = next(icon for icon in icons if icon.get('format') == 'png')
            data = icon['image']
            obj['icon'] = 'data:image/png;base64,' + \
                base64.b64encode(data).decode('ascii')
        except StopIteration:
            pass

        return obj

    return wrap


def apps(device: frida.core.Device) -> list:
    props = ['identifier', 'name', 'pid']

    def fmt(app):
        return '%s-%s' % (device.id, app.pid or app.identifier)
    wrap = info_wrap(props, fmt)
    try:
        apps = device.enumerate_applications(scope='full')
    except frida.TransportError:
        apps = device.enumerate_applications()
    return [wrap(app) for app in apps]


def ps(device: frida.core.Device) -> list:
    props = ['name', 'pid']

    def fmt(p):
        return '%s-%s' % (device.id, p.name or p.pid)
    wrap = info_wrap(props, fmt)

    try:
        ps = device.enumerate_processes(scope='full')
    except frida.TransportError:
        ps = device.enumerate_processes()
    return [wrap(p) for p in ps]


def device_info(device: frida.core.Device) -> dict:
    return device.query_system_parameters()


def find_app(device: frida.core.Device, bundle: str):
    try:
        app = next(app for app in device.enumerate_applications()
                   if app.identifier == bundle)
    except StopIteration:
        raise ValueError('app "%s" not found' % bundle)

    return app


def spawn_or_attach(device: frida.core.Device, bundle: str) -> frida.core.Session:
    app = find_app(device, bundle)

    if app.pid > 0:
        frontmost = device.get_frontmost_application()
        if frontmost and frontmost.identifier == bundle:
            return device.attach(app.pid)

        device.kill(app.pid)

    pid = device.spawn(bundle)
    session = device.attach(pid)
    device.resume(pid)
    return session


def read_agent():
    agent_path = Path(__file__).parent.parent / 'agent' / '_agent.js'
    with agent_path.open('r', encoding='utf8', newline='\n') as fp:
        return fp.read()

```

`backend/driver.py`:

```py
#!/usr/bin/env python3

import sys
import os
from pathlib import Path

sys.path.insert(0, str(Path(__file__).parent.parent))


def main(args):
    from backend import core, rpc, syslog

    if args.remote:
        import frida
        remote_list = args.remote.split(',')
        mgr = frida.get_device_manager()
        for host in remote_list:
            mgr.add_remote_device(host)

    if args.action == 'devices':
        return core.devices()

    if not args.device:
        raise RuntimeError('NOTREACHED')

    device = core.get_device(args.device)
    if args.action == 'ps':
        return core.ps(device)

    if args.action == 'apps':
        return core.apps(device)

    if args.action == 'info':
        return core.device_info(device)

    if args.action == 'location':
        for app in device.enumerate_applications(identifiers=[args.bundle], scope='metadata'):
            return app.parameters.get('path')
        raise RuntimeError('app with bundle %s does not exist' % args.bundle)

    if args.action == 'syslog2':
        return syslog.start(device, pid=args.pid, bundle=args.app)

    target = args.pid or args.name
    agent = rpc.ProcessAgent(device, target) if target else \
        rpc.AppAgent(device, args.app)
    agent.load()

    if args.action == 'rpc':
        return agent.invoke(args.method, *args.args)

    if args.action == 'syslog':
        syslog.pipe(agent)
        return


if __name__ == '__main__':
    import argparse

    requires_device = argparse.ArgumentParser(add_help=False)
    requires_device.add_argument('device')

    requires_path = argparse.ArgumentParser(add_help=False)
    requires_path.add_argument('path')

    requires_app = argparse.ArgumentParser(add_help=False)
    requires_app.add_argument('--device', required=True)
    group = requires_app.add_mutually_exclusive_group()
    group.add_argument('--app')
    group.add_argument('--pid', type=int)
    group.add_argument('--name')
    group.required = True

    parser = argparse.ArgumentParser(description='frida driver')
    parser.add_argument('--remote', type=str)
    subparsers = parser.add_subparsers(dest='action', required=True)
    subparsers.add_parser('devices')
    subparsers.add_parser('apps', parents=[requires_device])
    subparsers.add_parser('ps', parents=[requires_device])
    subparsers.add_parser('info', parents=[requires_device])
    subparsers.add_parser('type', parents=[requires_device])
    subparsers.add_parser('ssh-copy-id', parents=[requires_device])
    subparsers.add_parser('sign-debugserver', parents=[requires_device])
    location_parser = subparsers.add_parser(
        'location', parents=[requires_device])
    location_parser.add_argument('bundle')

    rpc_parser = subparsers.add_parser('rpc', parents=[requires_app])
    rpc_parser.add_argument('method')
    rpc_parser.add_argument('args', metavar='N', nargs='*', default=[])

    subparsers.add_parser('syslog', parents=[requires_app])
    subparsers.add_parser('syslog2', parents=[requires_app])

    args = parser.parse_args()

    if 'DEBUG' in os.environ or args.action == 'syslog2':
        result = main(args)
    else:
        try:
            result = main(args)
        except Exception as e:
            sys.stderr.write('%s\n' % e)
            sys.exit(-1)

    import json
    if args.action not in ['syslog', 'download', 'upload']:
        print(json.dumps(result))

```

`backend/pause.py`:

```py
import subprocess
import sys


if len(sys.argv) > 1:
    try:
        subprocess.check_call(sys.argv[1:])
    except (subprocess.SubprocessError, FileNotFoundError) as e:
        sys.stdout.write(repr(e) + '\n')
    finally:
        input('Press Enter to continue...')

```

`backend/pyproject.toml`:

```toml
[project]
name = "backend"
version = "0.1.0"
description = "Add your description here"
readme = "README.md"
requires-python = ">=3.13"
dependencies = [
    "frida>=17.4.0",
]

```

`backend/rpc.py`:

```py
import frida
import sys
import backend.core
from typing import List, Union


class BaseAgent(object):
    def __init__(self, device: frida.core.Device):
        self.device = device
        self.session = None  # type: frida.core.Session
        self.script = None  # type: frida.core.Script

    def invoke(self, method: str, *args: List[str]):
        if not self.session:
            raise RuntimeError('invalid state')

        if not self.script:
            self.load()

        invocation = getattr(self.script.exports, method)
        return invocation(*args)

    def load(self):
        if not self.session:
            raise RuntimeError('invalid state')

        session = self.session

        def on_detach(reason):
            if reason == 'application-requested':
                sys.exit(0)
            sys.stderr.write('[FATAL Error] target disconnected\n')
            sys.exit(-1)
        session.on('detached', on_detach)

        source = backend.core.read_agent()
        script = session.create_script(source)
        script.load()
        self.script = script

    def unload(self):
        if self.session:
            self.session.detach()


class AppAgent(BaseAgent):
    def __init__(self, device: frida.core.Device, bundle: str):
        super().__init__(device)
        self.session = backend.core.spawn_or_attach(self.device, bundle)


class ProcessAgent(BaseAgent):
    def __init__(self, device, target: Union[int, str]):
        super().__init__(device)
        self.session = self.device.attach(target)

```

`backend/syslog.py`:

```py
#!/usr/bin/env python3

from typing import Callable
from enum import Enum

import frida
import sys

from backend.rpc import BaseAgent


def pipe(agent: BaseAgent):
    agent.invoke('start')

    def on_message(message, data):
        sys.stdout.buffer.write(data)
        sys.stdout.flush()

    agent.script.on('message', on_message)

    try:
        sys.stdin.read()
    except KeyboardInterrupt:
        pass
    finally:
        agent.invoke('stop')
        agent.unload()


class SyslogService(object):
    def __init__(self, device: frida.core.Device):
        self.dev = device
        self.pipe = None

    def __enter__(self):
        self.pipe = self.dev.open_channel(
            'lockdown:com.apple.syslog_relay')
        return self

    def __exit__(self, exc_type, exc_value, traceback):
        self.pipe.close()

    def close(self):
        self.pipe.close()


CHUNK_SIZE = 4096
TIME_FORMAT = '%H:%M:%S'
SYSLOG_LINE_SPLITTER = b'\n\x00'


class Level(Enum):
    Unknown = 0
    Notice = 1
    Warning = 2
    Error = 3


def parse_level(level_text: str) -> Level:
    if level_text == b'<Notice>':
        return Level.Notice

    if level_text == b'<Warning>':
        return Level.Warning

    if level_text == b'<Error>':
        return Level.Error

    return Level.Unknown


def parse_line(line: bytes):
    pid_start = line.find(b'[')
    pid_end = line.find(b']', pid_start + 1)

    assert pid_start > -1 and pid_end > -1
    pid = int(line[pid_start + 1:pid_end], 10)

    colon_index = line.find(b':', pid_end + 1)
    level_text = line[pid_end + 2:colon_index]

    name_start = line.rfind(b' ', 0, pid_start) + 1
    name_and_module = line[name_start:pid_start]

    device_name_end = line.rfind(b' ', 0, name_start)
    device_name_start = line.rfind(b' ', 0, device_name_end)
    ts = line[0:device_name_start]

    if b'(' in name_and_module:
        name_end = name_and_module.find(b'(')
        name = name_and_module[0:name_end]
        module_end = name_and_module.find(b')')
        module = name_and_module[name_end + 1:module_end]
    else:
        name, module = name_and_module, None

    body = line[colon_index + 2:]
    return ts, pid, level_text, name, module, body


class bcolors:
    HEADER = b'\033[95m'
    OKBLUE = b'\033[94m'
    OKCYAN = b'\033[96m'
    OKGREEN = b'\033[92m'
    WARNING = b'\033[93m'
    FAIL = b'\033[91m'
    ENDC = b'\033[0m'
    BOLD = b'\033[1m'
    UNDERLINE = b'\033[4m'


def color(level: Level):
    mapping = {
        # Level.Unknown: b'',
        Level.Notice: bcolors.OKGREEN,
        Level.Warning: bcolors.WARNING,
        Level.Error: bcolors.FAIL
    }

    return mapping.get(level, b'')


def get_proc_name(device: frida.core.Device, bundle: str):
    try:
        info = next(app for app in device.enumerate_applications(
            scope='metadata') if app.identifier == bundle)
    except StopIteration:
        raise RuntimeError('app with bundle %s does not exist' % bundle)

    if info.pid == 0:
        device.resume(device.spawn(bundle))

    return info.parameters.get('path')


def stream(device: frida.core.Device, filter_cb: Callable[[int, str], bool]):
    with SyslogService(device) as channel:
        buf = b''
        while True:
            chunk: bytes = channel.pipe.read_all(CHUNK_SIZE)
            buf += chunk

            # SYSLOG_LINE_SPLITTER is used to split each syslog line
            if SYSLOG_LINE_SPLITTER not in buf:
                continue

            lines = buf.split(SYSLOG_LINE_SPLITTER)

            # handle partial last lines
            if not buf.endswith(SYSLOG_LINE_SPLITTER):
                buf = lines[-1]
                lines = lines[:-1]

            for line in lines:
                if len(line) == 0:
                    continue

                ts, pid, level_text, name, module, body = parse_line(line)
                if not filter_cb(pid, name):
                    continue

                # timestamp
                yield ts
                yield b' '

                # process
                yield bcolors.OKCYAN
                yield name
                yield bcolors.ENDC

                # module
                yield bcolors.OKBLUE
                if module:
                    yield b'('
                    yield module
                    yield b')'

                yield b'[%d]' % pid
                yield bcolors.ENDC
                yield b' '

                # level
                level = parse_level(level_text)
                yield color(level)
                yield level_text
                yield bcolors.ENDC
                yield b': '

                # body
                yield body
                yield b'\n'


def start(device: frida.core.Device, pid: int = None, bundle: str = None):
    if type(pid) is int and pid > 0:
        def filter_cb(target_pid, target_name):
            return pid == target_pid

    elif type(bundle) is str:
        name = get_proc_name(device, bundle).encode('utf-8')

        def filter_cb(target_pid, target_name):
            return name == target_name

    else:
        raise ValueError(
            f'invalid parameter combination: pid={pid} bundle={bundle}')

    try:
        for buf in stream(device, filter_cb):
            sys.stdout.buffer.write(buf)
            if buf == b'\n':
                sys.stdout.flush()

    except KeyboardInterrupt:
        pass

```

`backend/test/test_device.py`:

```py
import unittest
import frida

from backend import core


class TestDeviceOperations(unittest.TestCase):
    def setUp(self):
        self.local = frida.get_local_device()
        self.usb = frida.get_usb_device()

    def test_info(self):
        usb = self.usb
        local = self.local

        self.assertIsInstance(core.devices(), list)
        self.assertIsInstance(core.ps(local), list)
        self.assertIsInstance(core.apps(usb), list)

    def test_attach(self):
        usb = self.usb
        local = self.local

        # make safari a background app
        usb.resume(usb.spawn('com.apple.mobilesafari'))
        usb.resume(usb.spawn('com.apple.Preferences'))

        with self.assertRaises(RuntimeError):
            core.spawn_or_attach(usb, 'com.apple.mobilesafari')
        session = core.spawn_or_attach(usb, 'com.apple.Preferences')
        self.assertIsInstance(session, frida.core.Session)

        usb.kill('Settings')
        usb.kill('Safari')

        session.detach()


if __name__ == '__main__':
    unittest.main()

```

`backend/uv.lock`:

```lock
version = 1
revision = 3
requires-python = ">=3.13"

[[package]]
name = "backend"
version = "0.1.0"
source = { virtual = "." }
dependencies = [
    { name = "frida" },
]

[package.metadata]
requires-dist = [{ name = "frida", specifier = ">=17.4.0" }]

[[package]]
name = "frida"
version = "17.4.0"
source = { registry = "https://pypi.org/simple" }
sdist = { url = "https://files.pythonhosted.org/packages/2f/16/4292e921321089978d99f6b72f847670cff4dcffdfad82d0fdbc708714cc/frida-17.4.0.tar.gz", hash = "sha256:973c03125fdfbbf8ba43fdfe5ab2447efea9400b0432d43d68db8f29ac3e1091", size = 924743, upload-time = "2025-10-12T08:09:44.067Z" }
wheels = [
    { url = "https://files.pythonhosted.org/packages/a1/ed/408391c798ca112b03b1934633e8364791eddd20c7f6ae6827aa958e9345/frida-17.4.0-cp37-abi3-macosx_10_13_x86_64.whl", hash = "sha256:84911a541b8425d03e63a77db3349302938307add2b417ad64269391b31aa013", size = 23009998, upload-time = "2025-10-12T08:09:04.985Z" },
    { url = "https://files.pythonhosted.org/packages/4c/c0/bf0f5062bcdee3701fa56342413c8149877ecdea6bad2c3dab59848fe866/frida-17.4.0-cp37-abi3-macosx_11_0_arm64.whl", hash = "sha256:c8600b9f6c5c95b1183f5ee35ff925c1c5681b7b6259ae2bf9ab229a5ce0caad", size = 32366114, upload-time = "2025-10-12T08:09:08.982Z" },
    { url = "https://files.pythonhosted.org/packages/56/e9/fb907879f08ee36349e7ef7d7c10771914ac1d445ea257c662a0b2f0d97d/frida-17.4.0-cp37-abi3-manylinux1_i686.whl", hash = "sha256:71c3cd9ca553be3bbb36e9fd20da8b98371c1346eb7cb0d198d68f216258493a", size = 20437955, upload-time = "2025-10-12T08:09:11.279Z" },
    { url = "https://files.pythonhosted.org/packages/71/53/1764e2984f7a22e0a11dd026e372f5c3d9540a694e167e1f2b94850be694/frida-17.4.0-cp37-abi3-manylinux1_x86_64.whl", hash = "sha256:aa84584d6768e225ec308283a9e8f386c360302e4e1d934fd650e82dfb5f4387", size = 32485152, upload-time = "2025-10-12T08:09:14.476Z" },
    { url = "https://files.pythonhosted.org/packages/fe/f7/e06dad79c518653c209081419a0760640b7368fb4ee35e0b7635fcf1c1f3/frida-17.4.0-cp37-abi3-manylinux2014_aarch64.whl", hash = "sha256:d03c9c1ae84e80bd779663545d6f51dee3f2a179edb8ded2ec1d69b879fbf4ca", size = 21154181, upload-time = "2025-10-12T08:09:16.977Z" },
    { url = "https://files.pythonhosted.org/packages/c7/d4/5feb510412cf71a39c0e54fdf18110677b256965310faa354c48c9078fcf/frida-17.4.0-cp37-abi3-manylinux2014_armv7l.whl", hash = "sha256:f461fbd35354275f50e80cbf79c8ce58246491213715ab07b4c716b87408b6a0", size = 19116731, upload-time = "2025-10-12T08:09:19.076Z" },
    { url = "https://files.pythonhosted.org/packages/20/95/6bbccba9a5acd094d57f047dc3c58c6c63cdd1434209ef85c914b870f640/frida-17.4.0-cp37-abi3-manylinux_2_17_aarch64.whl", hash = "sha256:7df1e1f05349c4675dcae279e2c41d86ba6889c6700f24255ca639552fdf4e15", size = 21154182, upload-time = "2025-10-12T08:09:21.598Z" },
    { url = "https://files.pythonhosted.org/packages/93/ed/c004bf24f2cd87891cc7479727dd24fdfe969e7cc90bdc00f628e879db07/frida-17.4.0-cp37-abi3-manylinux_2_17_armv7l.whl", hash = "sha256:ef96fa1f3e3742097b1697fd9f835202f8d924f91390221b9dd5ab7e457aee95", size = 19116732, upload-time = "2025-10-12T08:09:23.982Z" },
    { url = "https://files.pythonhosted.org/packages/f7/f2/7a7c73ccf794f01786dda20f4b626d734f2bc499a13931be13055b96ec97/frida-17.4.0-cp37-abi3-manylinux_2_5_i686.whl", hash = "sha256:dc0cabb044749e53487c9bd435d05179060dcd55542c83796ec9e277df1d1e36", size = 20437957, upload-time = "2025-10-12T08:09:26.084Z" },
    { url = "https://files.pythonhosted.org/packages/4d/9c/22751d4b7ec0fc00f4b8535d16bbfe0e0744165e7f6b95724f44cf96b202/frida-17.4.0-cp37-abi3-manylinux_2_5_x86_64.whl", hash = "sha256:02164d413625bff857ceb787556975540080d441804ba715421e6418aa8d67d5", size = 32485155, upload-time = "2025-10-12T08:09:28.637Z" },
    { url = "https://files.pythonhosted.org/packages/45/57/b6ee538144c41b8f9e44ad9c46a96515a62f37f140210e5d45cb334ccc73/frida-17.4.0-cp37-abi3-win32.whl", hash = "sha256:7cd4629050e0258cffd6fbff2a6e596453253ccf4e55eac5ad2f4d3f537a1a8b", size = 26671405, upload-time = "2025-10-12T08:09:31.217Z" },
    { url = "https://files.pythonhosted.org/packages/be/55/3c9ac2d4adcebc583b2068729ba7c002372f77e1a01bcb8dea6bb4724e1a/frida-17.4.0-cp37-abi3-win_amd64.whl", hash = "sha256:dad5b93723ec4c68881553d040c2f48d8e22a05d2c8aaf8d2ea54a378fba45dd", size = 41798603, upload-time = "2025-10-12T08:09:33.633Z" },
    { url = "https://files.pythonhosted.org/packages/2a/76/3adfbb89ae80c2bdfa4b9d6d2619c7bf4c3c0b531656398f8e60abae2123/frida-17.4.0-cp37-abi3-win_arm64.whl", hash = "sha256:ff07c4b8c56b49176755fa107dbc34044fabc2f505519948531e45fb042e7f82", size = 51680524, upload-time = "2025-10-12T08:09:36.854Z" },
]

```

`backend/venv.py`:

```py
import sys

print('true' if sys.prefix == sys.base_prefix else 'false')

```

`i10n/bundle.l10n.zh-cn.json`:

```json
{
    "This command is only expected to be used in the context menu": "此命令仅在上下文菜单中使用",
    "This command only supports iOS or Android": "此命令仅支持 iOS 或 Android",
    "Select destination folder": "选择目标文件夹",
    "frida-server not found on device, downloading...": "设备上未找到 frida-server，正在下载...",
    "Downloading frida-server": "正在下载 frida-server",
    "Done": "完成",
    "Open": "打开",
    "Dismiss": "关闭",
    "frida-server deployed to {0} successfully": "frida-server 已成功部署到 {0}",
    "sanity check: frida-server version on device {0}": "完整性检查：设备上的 frida-server 版本 {0}",
    "failed to dump application:\n{0}": "应用导出失败：\n{0}",
    "Successfully pulled package {0}": "成功导出软件包 {0}",
    "Failed to get package path: {0}": "获取软件包路径失败：{0}",
    "Unsupported device type": "不支持的设备类型",
    "Unsupported item type": "不支持的项目类型",
    "Target is not running": "目标未运行",
    "App \"{0}\" must be running before attaching to it": "必须先运行应用 \"{0}\" 才能附加到它",
    "Host or IP of the remote device": "远程设备的主机名或IP地址",
    "Frida - {0}": "Frida - {0}",
    "Install typescript typings": "安装 TypeScript 类型提示",
    "@types/frida-gum has been successfully installed": "@types/frida-gum 已成功安装",
    "Downloading typing info for frida-gum": "正在下载 frida-gum 的类型提示",
    "Failed to download typing info for frida-gum: {0}": "下载 frida-gum 的类型提示失败：{0}",
    "The command requires a workspace or an active document": "此命令需要工作区或活动文档",
    "This document is not Javascript or TypeScript": "此文档不是 JavaScript 或 TypeScript",
    "The current document is unsaved": "当前文档未保存",
    "This command is not applicable to the selected item": "此命令不适用于所选项目",
    "This command is not applicable to the local device": "此命令不适用于本地设备",
    "Warning: failed to launch App {0}\n{1}": "警告：启动应用 {0} 失败\n{1}",
    "You must select a folder to create the project": "您必须选择一个文件夹来创建项目",
    "This command only works in a workspace. Please open a workspace first": "此命令仅在工作区中有效。请先打开一个工作区",
    "{0} already exists. Do you want to overwrite it?": "{0} 已存在。您要覆盖它吗？",
    "Yes": "是",
    "No": "否",
    "Debug Command": "调试命令",
    "Debug configuration created. You can now start debugging by pressing F5": "调试配置已创建。您现在可以按 F5 开始调试",
    "inetcat not found": "未找到 inetcat",
    "inetcat exited with code {0}": "inetcat 以代码 {0} 退出",
    "Invalid protocol": "无效的协议",
    "No valid SSH port found": "未找到有效的 SSH 端口",
    "SSH: {0}": "安全外壳协议：{0}",
    "This feature is not enabled on Windows due to lack of inetcat": "由于缺少 inetcat，此功能在 Windows 上未启用",
    "inetcat command not present in $PATH": "inetcat 命令不在 $PATH 中",
    "OS type {0} is not supported": "操作系统类型 {0} 不受支持",
    "Could not find command {0} in $PATH, have you installed it or activated the correct venv?": "在 $PATH 中找不到命令 {0}，您是否安装了它或激活了正确的虚拟环境？",
    "Frida Extension": "Frida 扩展",
    "Python extension not activated": "Python 扩展未激活",
    "Python extension not found": "未找到 Python 扩展",
    "Could not find command adb in $PATH": "在 $PATH 中找不到命令 adb",
    "Create Here": "在此处创建",
    "Create Project": "创建项目",
    "Close Console": "关闭控制台",
    "Ignore": "忽略",
    "Console {0} is already open, do you want to close it?": "控制台 {0} 已经打开，您要关闭它吗？",
    "Invalid target {0}": "无效的目标 {0}",
    "Output: {0} ({1})": "输出：{0} ({1})",
    "{0} ({1}) is not running": "{0} ({1}) 未运行",
    "Not Running": "未运行"
}
```

`package-lock.json`:

```json
{
    "name": "vscode-frida",
    "version": "0.10.4",
    "lockfileVersion": 3,
    "requires": true,
    "packages": {
        "": {
            "name": "vscode-frida",
            "version": "0.10.4",
            "dependencies": {
                "which": "^5.0.0"
            },
            "devDependencies": {
                "@types/node": "^22.8.1",
                "@types/vscode": "^1.94.0",
                "@types/which": "^3.0.4",
                "@typescript-eslint/eslint-plugin": "^8.11.0",
                "@typescript-eslint/parser": "^8.11.0",
                "eslint": "^9.13.0",
                "typescript": "^5.6.3"
            },
            "engines": {
                "vscode": "^1.94.0"
            }
        },
        "node_modules/@aashutoshrathi/word-wrap": {
            "version": "1.2.6",
            "resolved": "https://registry.npmjs.org/@aashutoshrathi/word-wrap/-/word-wrap-1.2.6.tgz",
            "integrity": "sha512-1Yjs2SvM8TflER/OD3cOjhWWOZb58A2t7wpE2S9XfBYTiIl+XFhQG2bjy4Pu1I+EAlCNUzRDYDdFwFYUKvXcIA==",
            "dev": true,
            "engines": {
                "node": ">=0.10.0"
            }
        },
        "node_modules/@eslint-community/eslint-utils": {
            "version": "4.4.0",
            "resolved": "https://registry.npmjs.org/@eslint-community/eslint-utils/-/eslint-utils-4.4.0.tgz",
            "integrity": "sha512-1/sA4dwrzBAyeUoQ6oxahHKmrZvsnLCg4RfxW3ZFGGmQkSNQPFNLV9CUEFQP1x9EYXHTo5p6xdhZM1Ne9p/AfA==",
            "dev": true,
            "dependencies": {
                "eslint-visitor-keys": "^3.3.0"
            },
            "engines": {
                "node": "^12.22.0 || ^14.17.0 || >=16.0.0"
            },
            "peerDependencies": {
                "eslint": "^6.0.0 || ^7.0.0 || >=8.0.0"
            }
        },
        "node_modules/@eslint-community/regexpp": {
            "version": "4.11.2",
            "resolved": "https://registry.npmjs.org/@eslint-community/regexpp/-/regexpp-4.11.2.tgz",
            "integrity": "sha512-2WwyTYNVaMNUWPZTOJdkax9iqTdirrApgTbk+Qoq5EPX6myqZvG8QGFRgdKmkjKVG6/G/a565vpPauHk0+hpBA==",
            "dev": true,
            "license": "MIT",
            "engines": {
                "node": "^12.0.0 || ^14.0.0 || >=16.0.0"
            }
        },
        "node_modules/@eslint/config-array": {
            "version": "0.18.0",
            "resolved": "https://registry.npmjs.org/@eslint/config-array/-/config-array-0.18.0.tgz",
            "integrity": "sha512-fTxvnS1sRMu3+JjXwJG0j/i4RT9u4qJ+lqS/yCGap4lH4zZGzQ7tu+xZqQmcMZq5OBZDL4QRxQzRjkWcGt8IVw==",
            "dev": true,
            "license": "Apache-2.0",
            "dependencies": {
                "@eslint/object-schema": "^2.1.4",
                "debug": "^4.3.1",
                "minimatch": "^3.1.2"
            },
            "engines": {
                "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
            }
        },
        "node_modules/@eslint/core": {
            "version": "0.7.0",
            "resolved": "https://registry.npmjs.org/@eslint/core/-/core-0.7.0.tgz",
            "integrity": "sha512-xp5Jirz5DyPYlPiKat8jaq0EmYvDXKKpzTbxXMpT9eqlRJkRKIz9AGMdlvYjih+im+QlhWrpvVjl8IPC/lHlUw==",
            "dev": true,
            "license": "Apache-2.0",
            "engines": {
                "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
            }
        },
        "node_modules/@eslint/eslintrc": {
            "version": "3.1.0",
            "resolved": "https://registry.npmjs.org/@eslint/eslintrc/-/eslintrc-3.1.0.tgz",
            "integrity": "sha512-4Bfj15dVJdoy3RfZmmo86RK1Fwzn6SstsvK9JS+BaVKqC6QQQQyXekNaC+g+LKNgkQ+2VhGAzm6hO40AhMR3zQ==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "ajv": "^6.12.4",
                "debug": "^4.3.2",
                "espree": "^10.0.1",
                "globals": "^14.0.0",
                "ignore": "^5.2.0",
                "import-fresh": "^3.2.1",
                "js-yaml": "^4.1.0",
                "minimatch": "^3.1.2",
                "strip-json-comments": "^3.1.1"
            },
            "engines": {
                "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
            },
            "funding": {
                "url": "https://opencollective.com/eslint"
            }
        },
        "node_modules/@eslint/js": {
            "version": "9.13.0",
            "resolved": "https://registry.npmjs.org/@eslint/js/-/js-9.13.0.tgz",
            "integrity": "sha512-IFLyoY4d72Z5y/6o/BazFBezupzI/taV8sGumxTAVw3lXG9A6md1Dc34T9s1FoD/an9pJH8RHbAxsaEbBed9lA==",
            "dev": true,
            "license": "MIT",
            "engines": {
                "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
            }
        },
        "node_modules/@eslint/object-schema": {
            "version": "2.1.4",
            "resolved": "https://registry.npmjs.org/@eslint/object-schema/-/object-schema-2.1.4.tgz",
            "integrity": "sha512-BsWiH1yFGjXXS2yvrf5LyuoSIIbPrGUWob917o+BTKuZ7qJdxX8aJLRxs1fS9n6r7vESrq1OUqb68dANcFXuQQ==",
            "dev": true,
            "license": "Apache-2.0",
            "engines": {
                "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
            }
        },
        "node_modules/@eslint/plugin-kit": {
            "version": "0.2.8",
            "resolved": "https://registry.npmjs.org/@eslint/plugin-kit/-/plugin-kit-0.2.8.tgz",
            "integrity": "sha512-ZAoA40rNMPwSm+AeHpCq8STiNAwzWLJuP8Xv4CHIc9wv/PSuExjMrmjfYNj682vW0OOiZ1HKxzvjQr9XZIisQA==",
            "dev": true,
            "license": "Apache-2.0",
            "dependencies": {
                "@eslint/core": "^0.13.0",
                "levn": "^0.4.1"
            },
            "engines": {
                "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
            }
        },
        "node_modules/@eslint/plugin-kit/node_modules/@eslint/core": {
            "version": "0.13.0",
            "resolved": "https://registry.npmjs.org/@eslint/core/-/core-0.13.0.tgz",
            "integrity": "sha512-yfkgDw1KR66rkT5A8ci4irzDysN7FRpq3ttJolR88OqQikAWqwA8j5VZyas+vjyBNFIJ7MfybJ9plMILI2UrCw==",
            "dev": true,
            "license": "Apache-2.0",
            "dependencies": {
                "@types/json-schema": "^7.0.15"
            },
            "engines": {
                "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
            }
        },
        "node_modules/@humanfs/core": {
            "version": "0.19.0",
            "resolved": "https://registry.npmjs.org/@humanfs/core/-/core-0.19.0.tgz",
            "integrity": "sha512-2cbWIHbZVEweE853g8jymffCA+NCMiuqeECeBBLm8dg2oFdjuGJhgN4UAbI+6v0CKbbhvtXA4qV8YR5Ji86nmw==",
            "dev": true,
            "license": "Apache-2.0",
            "engines": {
                "node": ">=18.18.0"
            }
        },
        "node_modules/@humanfs/node": {
            "version": "0.16.5",
            "resolved": "https://registry.npmjs.org/@humanfs/node/-/node-0.16.5.tgz",
            "integrity": "sha512-KSPA4umqSG4LHYRodq31VDwKAvaTF4xmVlzM8Aeh4PlU1JQ3IG0wiA8C25d3RQ9nJyM3mBHyI53K06VVL/oFFg==",
            "dev": true,
            "license": "Apache-2.0",
            "dependencies": {
                "@humanfs/core": "^0.19.0",
                "@humanwhocodes/retry": "^0.3.0"
            },
            "engines": {
                "node": ">=18.18.0"
            }
        },
        "node_modules/@humanwhocodes/module-importer": {
            "version": "1.0.1",
            "resolved": "https://registry.npmjs.org/@humanwhocodes/module-importer/-/module-importer-1.0.1.tgz",
            "integrity": "sha512-bxveV4V8v5Yb4ncFTT3rPSgZBOpCkjfK0y4oVVVJwIuDVBRMDXrPyXRL988i5ap9m9bnyEEjWfm5WkBmtffLfA==",
            "dev": true,
            "engines": {
                "node": ">=12.22"
            },
            "funding": {
                "type": "github",
                "url": "https://github.com/sponsors/nzakas"
            }
        },
        "node_modules/@humanwhocodes/retry": {
            "version": "0.3.1",
            "resolved": "https://registry.npmjs.org/@humanwhocodes/retry/-/retry-0.3.1.tgz",
            "integrity": "sha512-JBxkERygn7Bv/GbN5Rv8Ul6LVknS+5Bp6RgDC/O8gEBU/yeH5Ui5C/OlWrTb6qct7LjjfT6Re2NxB0ln0yYybA==",
            "dev": true,
            "license": "Apache-2.0",
            "engines": {
                "node": ">=18.18"
            },
            "funding": {
                "type": "github",
                "url": "https://github.com/sponsors/nzakas"
            }
        },
        "node_modules/@nodelib/fs.scandir": {
            "version": "2.1.5",
            "resolved": "https://registry.npmjs.org/@nodelib/fs.scandir/-/fs.scandir-2.1.5.tgz",
            "integrity": "sha512-vq24Bq3ym5HEQm2NKCr3yXDwjc7vTsEThRDnkp2DK9p1uqLR+DHurm/NOTo0KG7HYHU7eppKZj3MyqYuMBf62g==",
            "dev": true,
            "dependencies": {
                "@nodelib/fs.stat": "2.0.5",
                "run-parallel": "^1.1.9"
            },
            "engines": {
                "node": ">= 8"
            }
        },
        "node_modules/@nodelib/fs.stat": {
            "version": "2.0.5",
            "resolved": "https://registry.npmjs.org/@nodelib/fs.stat/-/fs.stat-2.0.5.tgz",
            "integrity": "sha512-RkhPPp2zrqDAQA/2jNhnztcPAlv64XdhIp7a7454A5ovI7Bukxgt7MX7udwAu3zg1DcpPU0rz3VV1SeaqvY4+A==",
            "dev": true,
            "engines": {
                "node": ">= 8"
            }
        },
        "node_modules/@nodelib/fs.walk": {
            "version": "1.2.8",
            "resolved": "https://registry.npmjs.org/@nodelib/fs.walk/-/fs.walk-1.2.8.tgz",
            "integrity": "sha512-oGB+UxlgWcgQkgwo8GcEGwemoTFt3FIO9ababBmaGwXIoBKZ+GTy0pP185beGg7Llih/NSHSV2XAs1lnznocSg==",
            "dev": true,
            "dependencies": {
                "@nodelib/fs.scandir": "2.1.5",
                "fastq": "^1.6.0"
            },
            "engines": {
                "node": ">= 8"
            }
        },
        "node_modules/@types/estree": {
            "version": "1.0.6",
            "resolved": "https://registry.npmjs.org/@types/estree/-/estree-1.0.6.tgz",
            "integrity": "sha512-AYnb1nQyY49te+VRAVgmzfcgjYS91mY5P0TKUDCLEM+gNnA+3T6rWITXRLYCpahpqSQbN5cE+gHpnPyXjHWxcw==",
            "dev": true,
            "license": "MIT"
        },
        "node_modules/@types/json-schema": {
            "version": "7.0.15",
            "resolved": "https://registry.npmjs.org/@types/json-schema/-/json-schema-7.0.15.tgz",
            "integrity": "sha512-5+fP8P8MFNC+AyZCDxrB2pkZFPGzqQWUzpSeuuVLvm8VMcorNYavBqoFcxK8bQz4Qsbn4oUEEem4wDLfcysGHA==",
            "dev": true,
            "license": "MIT"
        },
        "node_modules/@types/node": {
            "version": "22.8.1",
            "resolved": "https://registry.npmjs.org/@types/node/-/node-22.8.1.tgz",
            "integrity": "sha512-k6Gi8Yyo8EtrNtkHXutUu2corfDf9su95VYVP10aGYMMROM6SAItZi0w1XszA6RtWTHSVp5OeFof37w0IEqCQg==",
            "dev": true,
            "dependencies": {
                "undici-types": "~6.19.8"
            }
        },
        "node_modules/@types/vscode": {
            "version": "1.99.1",
            "resolved": "https://registry.npmjs.org/@types/vscode/-/vscode-1.99.1.tgz",
            "integrity": "sha512-cQlqxHZ040ta6ovZXnXRxs3fJiTmlurkIWOfZVcLSZPcm9J4ikFpXuB7gihofGn5ng+kDVma5EmJIclfk0trPQ==",
            "dev": true,
            "license": "MIT"
        },
        "node_modules/@types/which": {
            "version": "3.0.4",
            "resolved": "https://registry.npmjs.org/@types/which/-/which-3.0.4.tgz",
            "integrity": "sha512-liyfuo/106JdlgSchJzXEQCVArk0CvevqPote8F8HgWgJ3dRCcTHgJIsLDuee0kxk/mhbInzIZk3QWSZJ8R+2w==",
            "dev": true,
            "license": "MIT"
        },
        "node_modules/@typescript-eslint/eslint-plugin": {
            "version": "8.11.0",
            "resolved": "https://registry.npmjs.org/@typescript-eslint/eslint-plugin/-/eslint-plugin-8.11.0.tgz",
            "integrity": "sha512-KhGn2LjW1PJT2A/GfDpiyOfS4a8xHQv2myUagTM5+zsormOmBlYsnQ6pobJ8XxJmh6hnHwa2Mbe3fPrDJoDhbA==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "@eslint-community/regexpp": "^4.10.0",
                "@typescript-eslint/scope-manager": "8.11.0",
                "@typescript-eslint/type-utils": "8.11.0",
                "@typescript-eslint/utils": "8.11.0",
                "@typescript-eslint/visitor-keys": "8.11.0",
                "graphemer": "^1.4.0",
                "ignore": "^5.3.1",
                "natural-compare": "^1.4.0",
                "ts-api-utils": "^1.3.0"
            },
            "engines": {
                "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
            },
            "funding": {
                "type": "opencollective",
                "url": "https://opencollective.com/typescript-eslint"
            },
            "peerDependencies": {
                "@typescript-eslint/parser": "^8.0.0 || ^8.0.0-alpha.0",
                "eslint": "^8.57.0 || ^9.0.0"
            },
            "peerDependenciesMeta": {
                "typescript": {
                    "optional": true
                }
            }
        },
        "node_modules/@typescript-eslint/parser": {
            "version": "8.11.0",
            "resolved": "https://registry.npmjs.org/@typescript-eslint/parser/-/parser-8.11.0.tgz",
            "integrity": "sha512-lmt73NeHdy1Q/2ul295Qy3uninSqi6wQI18XwSpm8w0ZbQXUpjCAWP1Vlv/obudoBiIjJVjlztjQ+d/Md98Yxg==",
            "dev": true,
            "license": "BSD-2-Clause",
            "dependencies": {
                "@typescript-eslint/scope-manager": "8.11.0",
                "@typescript-eslint/types": "8.11.0",
                "@typescript-eslint/typescript-estree": "8.11.0",
                "@typescript-eslint/visitor-keys": "8.11.0",
                "debug": "^4.3.4"
            },
            "engines": {
                "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
            },
            "funding": {
                "type": "opencollective",
                "url": "https://opencollective.com/typescript-eslint"
            },
            "peerDependencies": {
                "eslint": "^8.57.0 || ^9.0.0"
            },
            "peerDependenciesMeta": {
                "typescript": {
                    "optional": true
                }
            }
        },
        "node_modules/@typescript-eslint/scope-manager": {
            "version": "8.11.0",
            "resolved": "https://registry.npmjs.org/@typescript-eslint/scope-manager/-/scope-manager-8.11.0.tgz",
            "integrity": "sha512-Uholz7tWhXmA4r6epo+vaeV7yjdKy5QFCERMjs1kMVsLRKIrSdM6o21W2He9ftp5PP6aWOVpD5zvrvuHZC0bMQ==",
            "dev": true,
            "dependencies": {
                "@typescript-eslint/types": "8.11.0",
                "@typescript-eslint/visitor-keys": "8.11.0"
            },
            "engines": {
                "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
            },
            "funding": {
                "type": "opencollective",
                "url": "https://opencollective.com/typescript-eslint"
            }
        },
        "node_modules/@typescript-eslint/type-utils": {
            "version": "8.11.0",
            "resolved": "https://registry.npmjs.org/@typescript-eslint/type-utils/-/type-utils-8.11.0.tgz",
            "integrity": "sha512-ItiMfJS6pQU0NIKAaybBKkuVzo6IdnAhPFZA/2Mba/uBjuPQPet/8+zh5GtLHwmuFRShZx+8lhIs7/QeDHflOg==",
            "dev": true,
            "dependencies": {
                "@typescript-eslint/typescript-estree": "8.11.0",
                "@typescript-eslint/utils": "8.11.0",
                "debug": "^4.3.4",
                "ts-api-utils": "^1.3.0"
            },
            "engines": {
                "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
            },
            "funding": {
                "type": "opencollective",
                "url": "https://opencollective.com/typescript-eslint"
            },
            "peerDependenciesMeta": {
                "typescript": {
                    "optional": true
                }
            }
        },
        "node_modules/@typescript-eslint/types": {
            "version": "8.11.0",
            "resolved": "https://registry.npmjs.org/@typescript-eslint/types/-/types-8.11.0.tgz",
            "integrity": "sha512-tn6sNMHf6EBAYMvmPUaKaVeYvhUsrE6x+bXQTxjQRp360h1giATU0WvgeEys1spbvb5R+VpNOZ+XJmjD8wOUHw==",
            "dev": true,
            "engines": {
                "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
            },
            "funding": {
                "type": "opencollective",
                "url": "https://opencollective.com/typescript-eslint"
            }
        },
        "node_modules/@typescript-eslint/typescript-estree": {
            "version": "8.11.0",
            "resolved": "https://registry.npmjs.org/@typescript-eslint/typescript-estree/-/typescript-estree-8.11.0.tgz",
            "integrity": "sha512-yHC3s1z1RCHoCz5t06gf7jH24rr3vns08XXhfEqzYpd6Hll3z/3g23JRi0jM8A47UFKNc3u/y5KIMx8Ynbjohg==",
            "dev": true,
            "dependencies": {
                "@typescript-eslint/types": "8.11.0",
                "@typescript-eslint/visitor-keys": "8.11.0",
                "debug": "^4.3.4",
                "fast-glob": "^3.3.2",
                "is-glob": "^4.0.3",
                "minimatch": "^9.0.4",
                "semver": "^7.6.0",
                "ts-api-utils": "^1.3.0"
            },
            "engines": {
                "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
            },
            "funding": {
                "type": "opencollective",
                "url": "https://opencollective.com/typescript-eslint"
            },
            "peerDependenciesMeta": {
                "typescript": {
                    "optional": true
                }
            }
        },
        "node_modules/@typescript-eslint/typescript-estree/node_modules/brace-expansion": {
            "version": "2.0.1",
            "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-2.0.1.tgz",
            "integrity": "sha512-XnAIvQ8eM+kC6aULx6wuQiwVsnzsi9d3WxzV3FpWTGA19F621kwdbsAcFKXgKUHZWsy+mY6iL1sHTxWEFCytDA==",
            "dev": true,
            "dependencies": {
                "balanced-match": "^1.0.0"
            }
        },
        "node_modules/@typescript-eslint/typescript-estree/node_modules/minimatch": {
            "version": "9.0.5",
            "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-9.0.5.tgz",
            "integrity": "sha512-G6T0ZX48xgozx7587koeX9Ys2NYy6Gmv//P89sEte9V9whIapMNF4idKxnW2QtCcLiTWlb/wfCabAtAFWhhBow==",
            "dev": true,
            "dependencies": {
                "brace-expansion": "^2.0.1"
            },
            "engines": {
                "node": ">=16 || 14 >=14.17"
            },
            "funding": {
                "url": "https://github.com/sponsors/isaacs"
            }
        },
        "node_modules/@typescript-eslint/utils": {
            "version": "8.11.0",
            "resolved": "https://registry.npmjs.org/@typescript-eslint/utils/-/utils-8.11.0.tgz",
            "integrity": "sha512-CYiX6WZcbXNJV7UNB4PLDIBtSdRmRI/nb0FMyqHPTQD1rMjA0foPLaPUV39C/MxkTd/QKSeX+Gb34PPsDVC35g==",
            "dev": true,
            "dependencies": {
                "@eslint-community/eslint-utils": "^4.4.0",
                "@typescript-eslint/scope-manager": "8.11.0",
                "@typescript-eslint/types": "8.11.0",
                "@typescript-eslint/typescript-estree": "8.11.0"
            },
            "engines": {
                "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
            },
            "funding": {
                "type": "opencollective",
                "url": "https://opencollective.com/typescript-eslint"
            },
            "peerDependencies": {
                "eslint": "^8.57.0 || ^9.0.0"
            }
        },
        "node_modules/@typescript-eslint/visitor-keys": {
            "version": "8.11.0",
            "resolved": "https://registry.npmjs.org/@typescript-eslint/visitor-keys/-/visitor-keys-8.11.0.tgz",
            "integrity": "sha512-EaewX6lxSjRJnc+99+dqzTeoDZUfyrA52d2/HRrkI830kgovWsmIiTfmr0NZorzqic7ga+1bS60lRBUgR3n/Bw==",
            "dev": true,
            "dependencies": {
                "@typescript-eslint/types": "8.11.0",
                "eslint-visitor-keys": "^3.4.3"
            },
            "engines": {
                "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
            },
            "funding": {
                "type": "opencollective",
                "url": "https://opencollective.com/typescript-eslint"
            }
        },
        "node_modules/acorn": {
            "version": "8.13.0",
            "resolved": "https://registry.npmjs.org/acorn/-/acorn-8.13.0.tgz",
            "integrity": "sha512-8zSiw54Oxrdym50NlZ9sUusyO1Z1ZchgRLWRaK6c86XJFClyCgFKetdowBg5bKxyp/u+CDBJG4Mpp0m3HLZl9w==",
            "dev": true,
            "license": "MIT",
            "bin": {
                "acorn": "bin/acorn"
            },
            "engines": {
                "node": ">=0.4.0"
            }
        },
        "node_modules/acorn-jsx": {
            "version": "5.3.2",
            "resolved": "https://registry.npmjs.org/acorn-jsx/-/acorn-jsx-5.3.2.tgz",
            "integrity": "sha512-rq9s+JNhf0IChjtDXxllJ7g41oZk5SlXtp0LHwyA5cejwn7vKmKp4pPri6YEePv2PU65sAsegbXtIinmDFDXgQ==",
            "dev": true,
            "license": "MIT",
            "peerDependencies": {
                "acorn": "^6.0.0 || ^7.0.0 || ^8.0.0"
            }
        },
        "node_modules/ajv": {
            "version": "6.12.6",
            "resolved": "https://registry.npmjs.org/ajv/-/ajv-6.12.6.tgz",
            "integrity": "sha512-j3fVLgvTo527anyYyJOGTYJbG+vnnQYvE0m5mmkc1TK+nxAppkCLMIL0aZ4dblVCNoGShhm+kzE4ZUykBoMg4g==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "fast-deep-equal": "^3.1.1",
                "fast-json-stable-stringify": "^2.0.0",
                "json-schema-traverse": "^0.4.1",
                "uri-js": "^4.2.2"
            },
            "funding": {
                "type": "github",
                "url": "https://github.com/sponsors/epoberezkin"
            }
        },
        "node_modules/ansi-styles": {
            "version": "4.3.0",
            "resolved": "https://registry.npmjs.org/ansi-styles/-/ansi-styles-4.3.0.tgz",
            "integrity": "sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg==",
            "dev": true,
            "dependencies": {
                "color-convert": "^2.0.1"
            },
            "engines": {
                "node": ">=8"
            },
            "funding": {
                "url": "https://github.com/chalk/ansi-styles?sponsor=1"
            }
        },
        "node_modules/argparse": {
            "version": "2.0.1",
            "resolved": "https://registry.npmjs.org/argparse/-/argparse-2.0.1.tgz",
            "integrity": "sha512-8+9WqebbFzpX9OR+Wa6O29asIogeRMzcGtAINdpMHHyAg10f05aSFVBbcEqGf/PXw1EjAZ+q2/bEBg3DvurK3Q==",
            "dev": true,
            "license": "Python-2.0"
        },
        "node_modules/balanced-match": {
            "version": "1.0.0",
            "resolved": "https://registry.npmjs.org/balanced-match/-/balanced-match-1.0.0.tgz",
            "integrity": "sha1-ibTRmasr7kneFk6gK4nORi1xt2c=",
            "dev": true
        },
        "node_modules/brace-expansion": {
            "version": "1.1.11",
            "resolved": "https://registry.npmjs.org/brace-expansion/-/brace-expansion-1.1.11.tgz",
            "integrity": "sha512-iCuPHDFgrHX7H2vEI/5xpz07zSHB00TpugqhmYtVmMO6518mCuRMoOYFldEBl0g187ufozdaHgWKcYFb61qGiA==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "balanced-match": "^1.0.0",
                "concat-map": "0.0.1"
            }
        },
        "node_modules/braces": {
            "version": "3.0.3",
            "resolved": "https://registry.npmjs.org/braces/-/braces-3.0.3.tgz",
            "integrity": "sha512-yQbXgO/OSZVD2IsiLlro+7Hf6Q18EJrKSEsdoMzKePKXct3gvD8oLcOQdIzGupr5Fj+EDe8gO/lxc1BzfMpxvA==",
            "dev": true,
            "dependencies": {
                "fill-range": "^7.1.1"
            },
            "engines": {
                "node": ">=8"
            }
        },
        "node_modules/callsites": {
            "version": "3.1.0",
            "resolved": "https://registry.npmjs.org/callsites/-/callsites-3.1.0.tgz",
            "integrity": "sha512-P8BjAsXvZS+VIDUI11hHCQEv74YT67YUi5JJFNWIqL235sBmjX4+qx9Muvls5ivyNENctx46xQLQ3aTuE7ssaQ==",
            "dev": true,
            "license": "MIT",
            "engines": {
                "node": ">=6"
            }
        },
        "node_modules/chalk": {
            "version": "4.1.2",
            "resolved": "https://registry.npmjs.org/chalk/-/chalk-4.1.2.tgz",
            "integrity": "sha512-oKnbhFyRIXpUuez8iBMmyEa4nbj4IOQyuhc/wy9kY7/WVPcwIO9VA668Pu8RkO7+0G76SLROeyw9CpQ061i4mA==",
            "dev": true,
            "dependencies": {
                "ansi-styles": "^4.1.0",
                "supports-color": "^7.1.0"
            },
            "engines": {
                "node": ">=10"
            },
            "funding": {
                "url": "https://github.com/chalk/chalk?sponsor=1"
            }
        },
        "node_modules/chalk/node_modules/supports-color": {
            "version": "7.2.0",
            "resolved": "https://registry.npmjs.org/supports-color/-/supports-color-7.2.0.tgz",
            "integrity": "sha512-qpCAvRl9stuOHveKsn7HncJRvv501qIacKzQlO/+Lwxc9+0q2wLyv4Dfvt80/DPn2pqOBsJdDiogXGR9+OvwRw==",
            "dev": true,
            "dependencies": {
                "has-flag": "^4.0.0"
            },
            "engines": {
                "node": ">=8"
            }
        },
        "node_modules/color-convert": {
            "version": "2.0.1",
            "resolved": "https://registry.npmjs.org/color-convert/-/color-convert-2.0.1.tgz",
            "integrity": "sha512-RRECPsj7iu/xb5oKYcsFHSppFNnsj/52OVTRKb4zP5onXwVF3zVmmToNcOfGC+CRDpfK/U584fMg38ZHCaElKQ==",
            "dev": true,
            "dependencies": {
                "color-name": "~1.1.4"
            },
            "engines": {
                "node": ">=7.0.0"
            }
        },
        "node_modules/color-name": {
            "version": "1.1.4",
            "resolved": "https://registry.npmjs.org/color-name/-/color-name-1.1.4.tgz",
            "integrity": "sha512-dOy+3AuW3a2wNbZHIuMZpTcgjGuLU/uBL/ubcZF9OXbDo8ff4O8yVp5Bf0efS8uEoYo5q4Fx7dY9OgQGXgAsQA==",
            "dev": true
        },
        "node_modules/concat-map": {
            "version": "0.0.1",
            "resolved": "https://registry.npmjs.org/concat-map/-/concat-map-0.0.1.tgz",
            "integrity": "sha512-/Srv4dswyQNBfohGpz9o6Yb3Gz3SrUDqBH5rTuhGR7ahtlbYKnVxw2bCFMRljaA7EXHaXZ8wsHdodFvbkhKmqg==",
            "dev": true,
            "license": "MIT"
        },
        "node_modules/cross-spawn": {
            "version": "7.0.6",
            "resolved": "https://registry.npmjs.org/cross-spawn/-/cross-spawn-7.0.6.tgz",
            "integrity": "sha512-uV2QOWP2nWzsy2aMp8aRibhi9dlzF5Hgh5SHaB9OiTGEyDTiJJyx0uy51QXdyWbtAHNua4XJzUKca3OzKUd3vA==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "path-key": "^3.1.0",
                "shebang-command": "^2.0.0",
                "which": "^2.0.1"
            },
            "engines": {
                "node": ">= 8"
            }
        },
        "node_modules/cross-spawn/node_modules/isexe": {
            "version": "2.0.0",
            "resolved": "https://registry.npmjs.org/isexe/-/isexe-2.0.0.tgz",
            "integrity": "sha512-RHxMLp9lnKHGHRng9QFhRCMbYAcVpn69smSGcq3f36xjgVVWThj4qqLbTLlq7Ssj8B+fIQ1EuCEGI2lKsyQeIw==",
            "dev": true,
            "license": "ISC"
        },
        "node_modules/cross-spawn/node_modules/which": {
            "version": "2.0.2",
            "resolved": "https://registry.npmjs.org/which/-/which-2.0.2.tgz",
            "integrity": "sha512-BLI3Tl1TW3Pvl70l3yq3Y64i+awpwXqsGBYWkkqMtnbXgrMD+yj7rhW0kuEDxzJaYXGjEW5ogapKNMEKNMjibA==",
            "dev": true,
            "license": "ISC",
            "dependencies": {
                "isexe": "^2.0.0"
            },
            "bin": {
                "node-which": "bin/node-which"
            },
            "engines": {
                "node": ">= 8"
            }
        },
        "node_modules/debug": {
            "version": "4.3.7",
            "resolved": "https://registry.npmjs.org/debug/-/debug-4.3.7.tgz",
            "integrity": "sha512-Er2nc/H7RrMXZBFCEim6TCmMk02Z8vLC2Rbi1KEBggpo0fS6l0S1nnapwmIi3yW/+GOJap1Krg4w0Hg80oCqgQ==",
            "dev": true,
            "dependencies": {
                "ms": "^2.1.3"
            },
            "engines": {
                "node": ">=6.0"
            },
            "peerDependenciesMeta": {
                "supports-color": {
                    "optional": true
                }
            }
        },
        "node_modules/deep-is": {
            "version": "0.1.4",
            "resolved": "https://registry.npmjs.org/deep-is/-/deep-is-0.1.4.tgz",
            "integrity": "sha512-oIPzksmTg4/MriiaYGO+okXDT7ztn/w3Eptv/+gSIdMdKsJo0u4CfYNFJPy+4SKMuCqGw2wxnA+URMg3t8a/bQ==",
            "dev": true
        },
        "node_modules/escape-string-regexp": {
            "version": "4.0.0",
            "resolved": "https://registry.npmjs.org/escape-string-regexp/-/escape-string-regexp-4.0.0.tgz",
            "integrity": "sha512-TtpcNJ3XAzx3Gq8sWRzJaVajRs0uVxA2YAkdb1jm2YkPz4G6egUFAyA3n5vtEIZefPk5Wa4UXbKuS5fKkJWdgA==",
            "dev": true,
            "engines": {
                "node": ">=10"
            },
            "funding": {
                "url": "https://github.com/sponsors/sindresorhus"
            }
        },
        "node_modules/eslint": {
            "version": "9.13.0",
            "resolved": "https://registry.npmjs.org/eslint/-/eslint-9.13.0.tgz",
            "integrity": "sha512-EYZK6SX6zjFHST/HRytOdA/zE72Cq/bfw45LSyuwrdvcclb/gqV8RRQxywOBEWO2+WDpva6UZa4CcDeJKzUCFA==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "@eslint-community/eslint-utils": "^4.2.0",
                "@eslint-community/regexpp": "^4.11.0",
                "@eslint/config-array": "^0.18.0",
                "@eslint/core": "^0.7.0",
                "@eslint/eslintrc": "^3.1.0",
                "@eslint/js": "9.13.0",
                "@eslint/plugin-kit": "^0.2.0",
                "@humanfs/node": "^0.16.5",
                "@humanwhocodes/module-importer": "^1.0.1",
                "@humanwhocodes/retry": "^0.3.1",
                "@types/estree": "^1.0.6",
                "@types/json-schema": "^7.0.15",
                "ajv": "^6.12.4",
                "chalk": "^4.0.0",
                "cross-spawn": "^7.0.2",
                "debug": "^4.3.2",
                "escape-string-regexp": "^4.0.0",
                "eslint-scope": "^8.1.0",
                "eslint-visitor-keys": "^4.1.0",
                "espree": "^10.2.0",
                "esquery": "^1.5.0",
                "esutils": "^2.0.2",
                "fast-deep-equal": "^3.1.3",
                "file-entry-cache": "^8.0.0",
                "find-up": "^5.0.0",
                "glob-parent": "^6.0.2",
                "ignore": "^5.2.0",
                "imurmurhash": "^0.1.4",
                "is-glob": "^4.0.0",
                "json-stable-stringify-without-jsonify": "^1.0.1",
                "lodash.merge": "^4.6.2",
                "minimatch": "^3.1.2",
                "natural-compare": "^1.4.0",
                "optionator": "^0.9.3",
                "text-table": "^0.2.0"
            },
            "bin": {
                "eslint": "bin/eslint.js"
            },
            "engines": {
                "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
            },
            "funding": {
                "url": "https://eslint.org/donate"
            },
            "peerDependencies": {
                "jiti": "*"
            },
            "peerDependenciesMeta": {
                "jiti": {
                    "optional": true
                }
            }
        },
        "node_modules/eslint-scope": {
            "version": "8.1.0",
            "resolved": "https://registry.npmjs.org/eslint-scope/-/eslint-scope-8.1.0.tgz",
            "integrity": "sha512-14dSvlhaVhKKsa9Fx1l8A17s7ah7Ef7wCakJ10LYk6+GYmP9yDti2oq2SEwcyndt6knfcZyhyxwY3i9yL78EQw==",
            "dev": true,
            "license": "BSD-2-Clause",
            "dependencies": {
                "esrecurse": "^4.3.0",
                "estraverse": "^5.2.0"
            },
            "engines": {
                "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
            },
            "funding": {
                "url": "https://opencollective.com/eslint"
            }
        },
        "node_modules/eslint-visitor-keys": {
            "version": "3.4.3",
            "resolved": "https://registry.npmjs.org/eslint-visitor-keys/-/eslint-visitor-keys-3.4.3.tgz",
            "integrity": "sha512-wpc+LXeiyiisxPlEkUzU6svyS1frIO3Mgxj1fdy7Pm8Ygzguax2N3Fa/D/ag1WqbOprdI+uY6wMUl8/a2G+iag==",
            "dev": true,
            "engines": {
                "node": "^12.22.0 || ^14.17.0 || >=16.0.0"
            },
            "funding": {
                "url": "https://opencollective.com/eslint"
            }
        },
        "node_modules/eslint/node_modules/eslint-visitor-keys": {
            "version": "4.1.0",
            "resolved": "https://registry.npmjs.org/eslint-visitor-keys/-/eslint-visitor-keys-4.1.0.tgz",
            "integrity": "sha512-Q7lok0mqMUSf5a/AdAZkA5a/gHcO6snwQClVNNvFKCAVlxXucdU8pKydU5ZVZjBx5xr37vGbFFWtLQYreLzrZg==",
            "dev": true,
            "license": "Apache-2.0",
            "engines": {
                "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
            },
            "funding": {
                "url": "https://opencollective.com/eslint"
            }
        },
        "node_modules/eslint/node_modules/glob-parent": {
            "version": "6.0.2",
            "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-6.0.2.tgz",
            "integrity": "sha512-XxwI8EOhVQgWp6iDL+3b0r86f4d6AX6zSU55HfB4ydCEuXLXc5FcYeOu+nnGftS4TEju/11rt4KJPTMgbfmv4A==",
            "dev": true,
            "dependencies": {
                "is-glob": "^4.0.3"
            },
            "engines": {
                "node": ">=10.13.0"
            }
        },
        "node_modules/espree": {
            "version": "10.2.0",
            "resolved": "https://registry.npmjs.org/espree/-/espree-10.2.0.tgz",
            "integrity": "sha512-upbkBJbckcCNBDBDXEbuhjbP68n+scUd3k/U2EkyM9nw+I/jPiL4cLF/Al06CF96wRltFda16sxDFrxsI1v0/g==",
            "dev": true,
            "license": "BSD-2-Clause",
            "dependencies": {
                "acorn": "^8.12.0",
                "acorn-jsx": "^5.3.2",
                "eslint-visitor-keys": "^4.1.0"
            },
            "engines": {
                "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
            },
            "funding": {
                "url": "https://opencollective.com/eslint"
            }
        },
        "node_modules/espree/node_modules/eslint-visitor-keys": {
            "version": "4.1.0",
            "resolved": "https://registry.npmjs.org/eslint-visitor-keys/-/eslint-visitor-keys-4.1.0.tgz",
            "integrity": "sha512-Q7lok0mqMUSf5a/AdAZkA5a/gHcO6snwQClVNNvFKCAVlxXucdU8pKydU5ZVZjBx5xr37vGbFFWtLQYreLzrZg==",
            "dev": true,
            "license": "Apache-2.0",
            "engines": {
                "node": "^18.18.0 || ^20.9.0 || >=21.1.0"
            },
            "funding": {
                "url": "https://opencollective.com/eslint"
            }
        },
        "node_modules/esquery": {
            "version": "1.5.0",
            "resolved": "https://registry.npmjs.org/esquery/-/esquery-1.5.0.tgz",
            "integrity": "sha512-YQLXUplAwJgCydQ78IMJywZCceoqk1oH01OERdSAJc/7U2AylwjhSCLDEtqwg811idIS/9fIU5GjG73IgjKMVg==",
            "dev": true,
            "dependencies": {
                "estraverse": "^5.1.0"
            },
            "engines": {
                "node": ">=0.10"
            }
        },
        "node_modules/esrecurse": {
            "version": "4.3.0",
            "resolved": "https://registry.npmjs.org/esrecurse/-/esrecurse-4.3.0.tgz",
            "integrity": "sha512-KmfKL3b6G+RXvP8N1vr3Tq1kL/oCFgn2NYXEtqP8/L3pKapUA4G8cFVaoF3SU323CD4XypR/ffioHmkti6/Tag==",
            "dev": true,
            "license": "BSD-2-Clause",
            "dependencies": {
                "estraverse": "^5.2.0"
            },
            "engines": {
                "node": ">=4.0"
            }
        },
        "node_modules/estraverse": {
            "version": "5.3.0",
            "resolved": "https://registry.npmjs.org/estraverse/-/estraverse-5.3.0.tgz",
            "integrity": "sha512-MMdARuVEQziNTeJD8DgMqmhwR11BRQ/cBP+pLtYdSTnf3MIO8fFeiINEbX36ZdNlfU/7A9f3gUw49B3oQsvwBA==",
            "dev": true,
            "engines": {
                "node": ">=4.0"
            }
        },
        "node_modules/esutils": {
            "version": "2.0.3",
            "resolved": "https://registry.npmjs.org/esutils/-/esutils-2.0.3.tgz",
            "integrity": "sha512-kVscqXk4OCp68SZ0dkgEKVi6/8ij300KBWTJq32P/dYeWTSwK41WyTxalN1eRmA5Z9UU/LX9D7FWSmV9SAYx6g==",
            "dev": true,
            "license": "BSD-2-Clause",
            "engines": {
                "node": ">=0.10.0"
            }
        },
        "node_modules/fast-deep-equal": {
            "version": "3.1.3",
            "resolved": "https://registry.npmjs.org/fast-deep-equal/-/fast-deep-equal-3.1.3.tgz",
            "integrity": "sha512-f3qQ9oQy9j2AhBe/H9VC91wLmKBCCU/gDOnKNAYG5hswO7BLKj09Hc5HYNz9cGI++xlpDCIgDaitVs03ATR84Q==",
            "dev": true,
            "license": "MIT"
        },
        "node_modules/fast-glob": {
            "version": "3.3.2",
            "resolved": "https://registry.npmjs.org/fast-glob/-/fast-glob-3.3.2.tgz",
            "integrity": "sha512-oX2ruAFQwf/Orj8m737Y5adxDQO0LAB7/S5MnxCdTNDd4p6BsyIVsv9JQsATbTSq8KHRpLwIHbVlUNatxd+1Ow==",
            "dev": true,
            "dependencies": {
                "@nodelib/fs.stat": "^2.0.2",
                "@nodelib/fs.walk": "^1.2.3",
                "glob-parent": "^5.1.2",
                "merge2": "^1.3.0",
                "micromatch": "^4.0.4"
            },
            "engines": {
                "node": ">=8.6.0"
            }
        },
        "node_modules/fast-json-stable-stringify": {
            "version": "2.1.0",
            "resolved": "https://registry.npmjs.org/fast-json-stable-stringify/-/fast-json-stable-stringify-2.1.0.tgz",
            "integrity": "sha512-lhd/wF+Lk98HZoTCtlVraHtfh5XYijIjalXck7saUtuanSDyLMxnHhSXEDJqHxD7msR8D0uCmqlkwjCV8xvwHw==",
            "dev": true,
            "license": "MIT"
        },
        "node_modules/fast-levenshtein": {
            "version": "2.0.6",
            "resolved": "https://registry.npmjs.org/fast-levenshtein/-/fast-levenshtein-2.0.6.tgz",
            "integrity": "sha512-DCXu6Ifhqcks7TZKY3Hxp3y6qphY5SJZmrWMDrKcERSOXWQdMhU9Ig/PYrzyw/ul9jOIyh0N4M0tbC5hodg8dw==",
            "dev": true
        },
        "node_modules/fastq": {
            "version": "1.15.0",
            "resolved": "https://registry.npmjs.org/fastq/-/fastq-1.15.0.tgz",
            "integrity": "sha512-wBrocU2LCXXa+lWBt8RoIRD89Fi8OdABODa/kEnyeyjS5aZO5/GNvI5sEINADqP/h8M29UHTHUb53sUu5Ihqdw==",
            "dev": true,
            "dependencies": {
                "reusify": "^1.0.4"
            }
        },
        "node_modules/file-entry-cache": {
            "version": "8.0.0",
            "resolved": "https://registry.npmjs.org/file-entry-cache/-/file-entry-cache-8.0.0.tgz",
            "integrity": "sha512-XXTUwCvisa5oacNGRP9SfNtYBNAMi+RPwBFmblZEF7N7swHYQS6/Zfk7SRwx4D5j3CH211YNRco1DEMNVfZCnQ==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "flat-cache": "^4.0.0"
            },
            "engines": {
                "node": ">=16.0.0"
            }
        },
        "node_modules/fill-range": {
            "version": "7.1.1",
            "resolved": "https://registry.npmjs.org/fill-range/-/fill-range-7.1.1.tgz",
            "integrity": "sha512-YsGpe3WHLK8ZYi4tWDg2Jy3ebRz2rXowDxnld4bkQB00cc/1Zw9AWnC0i9ztDJitivtQvaI9KaLyKrc+hBW0yg==",
            "dev": true,
            "dependencies": {
                "to-regex-range": "^5.0.1"
            },
            "engines": {
                "node": ">=8"
            }
        },
        "node_modules/find-up": {
            "version": "5.0.0",
            "resolved": "https://registry.npmjs.org/find-up/-/find-up-5.0.0.tgz",
            "integrity": "sha512-78/PXT1wlLLDgTzDs7sjq9hzz0vXD+zn+7wypEe4fXQxCmdmqfGsEPQxmiCSQI3ajFV91bVSsvNtrJRiW6nGng==",
            "dev": true,
            "dependencies": {
                "locate-path": "^6.0.0",
                "path-exists": "^4.0.0"
            },
            "engines": {
                "node": ">=10"
            },
            "funding": {
                "url": "https://github.com/sponsors/sindresorhus"
            }
        },
        "node_modules/flat-cache": {
            "version": "4.0.1",
            "resolved": "https://registry.npmjs.org/flat-cache/-/flat-cache-4.0.1.tgz",
            "integrity": "sha512-f7ccFPK3SXFHpx15UIGyRJ/FJQctuKZ0zVuN3frBo4HnK3cay9VEW0R6yPYFHC0AgqhukPzKjq22t5DmAyqGyw==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "flatted": "^3.2.9",
                "keyv": "^4.5.4"
            },
            "engines": {
                "node": ">=16"
            }
        },
        "node_modules/flatted": {
            "version": "3.3.1",
            "resolved": "https://registry.npmjs.org/flatted/-/flatted-3.3.1.tgz",
            "integrity": "sha512-X8cqMLLie7KsNUDSdzeN8FYK9rEt4Dt67OsG/DNGnYTSDBG4uFAJFBnUeiV+zCVAvwFy56IjM9sH51jVaEhNxw==",
            "dev": true,
            "license": "ISC"
        },
        "node_modules/glob-parent": {
            "version": "5.1.2",
            "resolved": "https://registry.npmjs.org/glob-parent/-/glob-parent-5.1.2.tgz",
            "integrity": "sha512-AOIgSQCepiJYwP3ARnGx+5VnTu2HBYdzbGP45eLw1vr3zB3vZLeyed1sC9hnbcOc9/SrMyM5RPQrkGz4aS9Zow==",
            "dev": true,
            "dependencies": {
                "is-glob": "^4.0.1"
            },
            "engines": {
                "node": ">= 6"
            }
        },
        "node_modules/globals": {
            "version": "14.0.0",
            "resolved": "https://registry.npmjs.org/globals/-/globals-14.0.0.tgz",
            "integrity": "sha512-oahGvuMGQlPw/ivIYBjVSrWAfWLBeku5tpPE2fOPLi+WHffIWbuh2tCjhyQhTBPMf5E9jDEH4FOmTYgYwbKwtQ==",
            "dev": true,
            "license": "MIT",
            "engines": {
                "node": ">=18"
            },
            "funding": {
                "url": "https://github.com/sponsors/sindresorhus"
            }
        },
        "node_modules/graphemer": {
            "version": "1.4.0",
            "resolved": "https://registry.npmjs.org/graphemer/-/graphemer-1.4.0.tgz",
            "integrity": "sha512-EtKwoO6kxCL9WO5xipiHTZlSzBm7WLT627TqC/uVRd0HKmq8NXyebnNYxDoBi7wt8eTWrUrKXCOVaFq9x1kgag==",
            "dev": true
        },
        "node_modules/has-flag": {
            "version": "4.0.0",
            "resolved": "https://registry.npmjs.org/has-flag/-/has-flag-4.0.0.tgz",
            "integrity": "sha512-EykJT/Q1KjTWctppgIAgfSO0tKVuZUjhgMr17kqTumMl6Afv3EISleU7qZUzoXDFTAHTDC4NOoG/ZxU3EvlMPQ==",
            "dev": true,
            "engines": {
                "node": ">=8"
            }
        },
        "node_modules/ignore": {
            "version": "5.3.2",
            "resolved": "https://registry.npmjs.org/ignore/-/ignore-5.3.2.tgz",
            "integrity": "sha512-hsBTNUqQTDwkWtcdYI2i06Y/nUBEsNEDJKjWdigLvegy8kDuJAS8uRlpkkcQpyEXL0Z/pjDy5HBmMjRCJ2gq+g==",
            "dev": true,
            "engines": {
                "node": ">= 4"
            }
        },
        "node_modules/import-fresh": {
            "version": "3.3.0",
            "resolved": "https://registry.npmjs.org/import-fresh/-/import-fresh-3.3.0.tgz",
            "integrity": "sha512-veYYhQa+D1QBKznvhUHxb8faxlrwUnxseDAbAp457E0wLNio2bOSKnjYDhMj+YiAq61xrMGhQk9iXVk5FzgQMw==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "parent-module": "^1.0.0",
                "resolve-from": "^4.0.0"
            },
            "engines": {
                "node": ">=6"
            },
            "funding": {
                "url": "https://github.com/sponsors/sindresorhus"
            }
        },
        "node_modules/imurmurhash": {
            "version": "0.1.4",
            "resolved": "https://registry.npmjs.org/imurmurhash/-/imurmurhash-0.1.4.tgz",
            "integrity": "sha512-JmXMZ6wuvDmLiHEml9ykzqO6lwFbof0GG4IkcGaENdCRDDmMVnny7s5HsIgHCbaq0w2MyPhDqkhTUgS2LU2PHA==",
            "dev": true,
            "engines": {
                "node": ">=0.8.19"
            }
        },
        "node_modules/is-extglob": {
            "version": "2.1.1",
            "resolved": "https://registry.npmjs.org/is-extglob/-/is-extglob-2.1.1.tgz",
            "integrity": "sha512-SbKbANkN603Vi4jEZv49LeVJMn4yGwsbzZworEoyEiutsN3nJYdbO36zfhGJ6QEDpOZIFkDtnq5JRxmvl3jsoQ==",
            "dev": true,
            "engines": {
                "node": ">=0.10.0"
            }
        },
        "node_modules/is-glob": {
            "version": "4.0.3",
            "resolved": "https://registry.npmjs.org/is-glob/-/is-glob-4.0.3.tgz",
            "integrity": "sha512-xelSayHH36ZgE7ZWhli7pW34hNbNl8Ojv5KVmkJD4hBdD3th8Tfk9vYasLM+mXWOZhFkgZfxhLSnrwRr4elSSg==",
            "dev": true,
            "dependencies": {
                "is-extglob": "^2.1.1"
            },
            "engines": {
                "node": ">=0.10.0"
            }
        },
        "node_modules/is-number": {
            "version": "7.0.0",
            "resolved": "https://registry.npmjs.org/is-number/-/is-number-7.0.0.tgz",
            "integrity": "sha512-41Cifkg6e8TylSpdtTpeLVMqvSBEVzTttHvERD741+pnZ8ANv0004MRL43QKPDlK9cGvNp6NZWZUBlbGXYxxng==",
            "dev": true,
            "engines": {
                "node": ">=0.12.0"
            }
        },
        "node_modules/isexe": {
            "version": "3.1.1",
            "resolved": "https://registry.npmjs.org/isexe/-/isexe-3.1.1.tgz",
            "integrity": "sha512-LpB/54B+/2J5hqQ7imZHfdU31OlgQqx7ZicVlkm9kzg9/w8GKLEcFfJl/t7DCEDueOyBAD6zCCwTO6Fzs0NoEQ==",
            "license": "ISC",
            "engines": {
                "node": ">=16"
            }
        },
        "node_modules/js-yaml": {
            "version": "4.1.1",
            "resolved": "https://registry.npmjs.org/js-yaml/-/js-yaml-4.1.1.tgz",
            "integrity": "sha512-qQKT4zQxXl8lLwBtHMWwaTcGfFOZviOJet3Oy/xmGk2gZH677CJM9EvtfdSkgWcATZhj/55JZ0rmy3myCT5lsA==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "argparse": "^2.0.1"
            },
            "bin": {
                "js-yaml": "bin/js-yaml.js"
            }
        },
        "node_modules/json-buffer": {
            "version": "3.0.1",
            "resolved": "https://registry.npmjs.org/json-buffer/-/json-buffer-3.0.1.tgz",
            "integrity": "sha512-4bV5BfR2mqfQTJm+V5tPPdf+ZpuhiIvTuAB5g8kcrXOZpTT/QwwVRWBywX1ozr6lEuPdbHxwaJlm9G6mI2sfSQ==",
            "dev": true,
            "license": "MIT"
        },
        "node_modules/json-schema-traverse": {
            "version": "0.4.1",
            "resolved": "https://registry.npmjs.org/json-schema-traverse/-/json-schema-traverse-0.4.1.tgz",
            "integrity": "sha512-xbbCH5dCYU5T8LcEhhuh7HJ88HXuW3qsI3Y0zOZFKfZEHcpWiHU/Jxzk629Brsab/mMiHQti9wMP+845RPe3Vg==",
            "dev": true,
            "license": "MIT"
        },
        "node_modules/json-stable-stringify-without-jsonify": {
            "version": "1.0.1",
            "resolved": "https://registry.npmjs.org/json-stable-stringify-without-jsonify/-/json-stable-stringify-without-jsonify-1.0.1.tgz",
            "integrity": "sha512-Bdboy+l7tA3OGW6FjyFHWkP5LuByj1Tk33Ljyq0axyzdk9//JSi2u3fP1QSmd1KNwq6VOKYGlAu87CisVir6Pw==",
            "dev": true
        },
        "node_modules/keyv": {
            "version": "4.5.4",
            "resolved": "https://registry.npmjs.org/keyv/-/keyv-4.5.4.tgz",
            "integrity": "sha512-oxVHkHR/EJf2CNXnWxRLW6mg7JyCCUcG0DtEGmL2ctUo1PNTin1PUil+r/+4r5MpVgC/fn1kjsx7mjSujKqIpw==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "json-buffer": "3.0.1"
            }
        },
        "node_modules/levn": {
            "version": "0.4.1",
            "resolved": "https://registry.npmjs.org/levn/-/levn-0.4.1.tgz",
            "integrity": "sha512-+bT2uH4E5LGE7h/n3evcS/sQlJXCpIp6ym8OWJ5eV6+67Dsql/LaaT7qJBAt2rzfoa/5QBGBhxDix1dMt2kQKQ==",
            "dev": true,
            "dependencies": {
                "prelude-ls": "^1.2.1",
                "type-check": "~0.4.0"
            },
            "engines": {
                "node": ">= 0.8.0"
            }
        },
        "node_modules/locate-path": {
            "version": "6.0.0",
            "resolved": "https://registry.npmjs.org/locate-path/-/locate-path-6.0.0.tgz",
            "integrity": "sha512-iPZK6eYjbxRu3uB4/WZ3EsEIMJFMqAoopl3R+zuq0UjcAm/MO6KCweDgPfP3elTztoKP3KtnVHxTn2NHBSDVUw==",
            "dev": true,
            "dependencies": {
                "p-locate": "^5.0.0"
            },
            "engines": {
                "node": ">=10"
            },
            "funding": {
                "url": "https://github.com/sponsors/sindresorhus"
            }
        },
        "node_modules/lodash.merge": {
            "version": "4.6.2",
            "resolved": "https://registry.npmjs.org/lodash.merge/-/lodash.merge-4.6.2.tgz",
            "integrity": "sha512-0KpjqXRVvrYyCsX1swR/XTK0va6VQkQM6MNo7PqW77ByjAhoARA8EfrP1N4+KlKj8YS0ZUCtRT/YUuhyYDujIQ==",
            "dev": true
        },
        "node_modules/merge2": {
            "version": "1.4.1",
            "resolved": "https://registry.npmjs.org/merge2/-/merge2-1.4.1.tgz",
            "integrity": "sha512-8q7VEgMJW4J8tcfVPy8g09NcQwZdbwFEqhe/WZkoIzjn/3TGDwtOCYtXGxA3O8tPzpczCCDgv+P2P5y00ZJOOg==",
            "dev": true,
            "engines": {
                "node": ">= 8"
            }
        },
        "node_modules/micromatch": {
            "version": "4.0.8",
            "resolved": "https://registry.npmjs.org/micromatch/-/micromatch-4.0.8.tgz",
            "integrity": "sha512-PXwfBhYu0hBCPw8Dn0E+WDYb7af3dSLVWKi3HGv84IdF4TyFoC0ysxFd0Goxw7nSv4T/PzEJQxsYsEiFCKo2BA==",
            "dev": true,
            "dependencies": {
                "braces": "^3.0.3",
                "picomatch": "^2.3.1"
            },
            "engines": {
                "node": ">=8.6"
            }
        },
        "node_modules/minimatch": {
            "version": "3.1.2",
            "resolved": "https://registry.npmjs.org/minimatch/-/minimatch-3.1.2.tgz",
            "integrity": "sha512-J7p63hRiAjw1NDEww1W7i37+ByIrOWO5XQQAzZ3VOcL0PNybwpfmV/N05zFAzwQ9USyEcX6t3UO+K5aqBQOIHw==",
            "dev": true,
            "license": "ISC",
            "dependencies": {
                "brace-expansion": "^1.1.7"
            },
            "engines": {
                "node": "*"
            }
        },
        "node_modules/ms": {
            "version": "2.1.3",
            "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
            "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
            "dev": true
        },
        "node_modules/natural-compare": {
            "version": "1.4.0",
            "resolved": "https://registry.npmjs.org/natural-compare/-/natural-compare-1.4.0.tgz",
            "integrity": "sha512-OWND8ei3VtNC9h7V60qff3SVobHr996CTwgxubgyQYEpg290h9J0buyECNNJexkFm5sOajh5G116RYA1c8ZMSw==",
            "dev": true
        },
        "node_modules/optionator": {
            "version": "0.9.3",
            "resolved": "https://registry.npmjs.org/optionator/-/optionator-0.9.3.tgz",
            "integrity": "sha512-JjCoypp+jKn1ttEFExxhetCKeJt9zhAgAve5FXHixTvFDW/5aEktX9bufBKLRRMdU7bNtpLfcGu94B3cdEJgjg==",
            "dev": true,
            "dependencies": {
                "@aashutoshrathi/word-wrap": "^1.2.3",
                "deep-is": "^0.1.3",
                "fast-levenshtein": "^2.0.6",
                "levn": "^0.4.1",
                "prelude-ls": "^1.2.1",
                "type-check": "^0.4.0"
            },
            "engines": {
                "node": ">= 0.8.0"
            }
        },
        "node_modules/p-limit": {
            "version": "3.1.0",
            "resolved": "https://registry.npmjs.org/p-limit/-/p-limit-3.1.0.tgz",
            "integrity": "sha512-TYOanM3wGwNGsZN2cVTYPArw454xnXj5qmWF1bEoAc4+cU/ol7GVh7odevjp1FNHduHc3KZMcFduxU5Xc6uJRQ==",
            "dev": true,
            "dependencies": {
                "yocto-queue": "^0.1.0"
            },
            "engines": {
                "node": ">=10"
            },
            "funding": {
                "url": "https://github.com/sponsors/sindresorhus"
            }
        },
        "node_modules/p-locate": {
            "version": "5.0.0",
            "resolved": "https://registry.npmjs.org/p-locate/-/p-locate-5.0.0.tgz",
            "integrity": "sha512-LaNjtRWUBY++zB5nE/NwcaoMylSPk+S+ZHNB1TzdbMJMny6dynpAGt7X/tl/QYq3TIeE6nxHppbo2LGymrG5Pw==",
            "dev": true,
            "dependencies": {
                "p-limit": "^3.0.2"
            },
            "engines": {
                "node": ">=10"
            },
            "funding": {
                "url": "https://github.com/sponsors/sindresorhus"
            }
        },
        "node_modules/parent-module": {
            "version": "1.0.1",
            "resolved": "https://registry.npmjs.org/parent-module/-/parent-module-1.0.1.tgz",
            "integrity": "sha512-GQ2EWRpQV8/o+Aw8YqtfZZPfNRWZYkbidE9k5rpl/hC3vtHHBfGm2Ifi6qWV+coDGkrUKZAxE3Lot5kcsRlh+g==",
            "dev": true,
            "license": "MIT",
            "dependencies": {
                "callsites": "^3.0.0"
            },
            "engines": {
                "node": ">=6"
            }
        },
        "node_modules/path-exists": {
            "version": "4.0.0",
            "resolved": "https://registry.npmjs.org/path-exists/-/path-exists-4.0.0.tgz",
            "integrity": "sha512-ak9Qy5Q7jYb2Wwcey5Fpvg2KoAc/ZIhLSLOSBmRmygPsGwkVVt0fZa0qrtMz+m6tJTAHfZQ8FnmB4MG4LWy7/w==",
            "dev": true,
            "engines": {
                "node": ">=8"
            }
        },
        "node_modules/path-key": {
            "version": "3.1.1",
            "resolved": "https://registry.npmjs.org/path-key/-/path-key-3.1.1.tgz",
            "integrity": "sha512-ojmeN0qd+y0jszEtoY48r0Peq5dwMEkIlCOu6Q5f41lfkswXuKtYrhgoTpLnyIcHm24Uhqx+5Tqm2InSwLhE6Q==",
            "dev": true,
            "engines": {
                "node": ">=8"
            }
        },
        "node_modules/picomatch": {
            "version": "2.3.1",
            "resolved": "https://registry.npmjs.org/picomatch/-/picomatch-2.3.1.tgz",
            "integrity": "sha512-JU3teHTNjmE2VCGFzuY8EXzCDVwEqB2a8fsIvwaStHhAWJEeVd1o1QD80CU6+ZdEXXSLbSsuLwJjkCBWqRQUVA==",
            "dev": true,
            "engines": {
                "node": ">=8.6"
            },
            "funding": {
                "url": "https://github.com/sponsors/jonschlinkert"
            }
        },
        "node_modules/prelude-ls": {
            "version": "1.2.1",
            "resolved": "https://registry.npmjs.org/prelude-ls/-/prelude-ls-1.2.1.tgz",
            "integrity": "sha512-vkcDPrRZo1QZLbn5RLGPpg/WmIQ65qoWWhcGKf/b5eplkkarX0m9z8ppCat4mlOqUsWpyNuYgO3VRyrYHSzX5g==",
            "dev": true,
            "engines": {
                "node": ">= 0.8.0"
            }
        },
        "node_modules/punycode": {
            "version": "2.3.1",
            "resolved": "https://registry.npmjs.org/punycode/-/punycode-2.3.1.tgz",
            "integrity": "sha512-vYt7UD1U9Wg6138shLtLOvdAu+8DsC/ilFtEVHcH+wydcSpNE20AfSOduf6MkRFahL5FY7X1oU7nKVZFtfq8Fg==",
            "dev": true,
            "license": "MIT",
            "engines": {
                "node": ">=6"
            }
        },
        "node_modules/queue-microtask": {
            "version": "1.2.3",
            "resolved": "https://registry.npmjs.org/queue-microtask/-/queue-microtask-1.2.3.tgz",
            "integrity": "sha512-NuaNSa6flKT5JaSYQzJok04JzTL1CA6aGhv5rfLW3PgqA+M2ChpZQnAC8h8i4ZFkBS8X5RqkDBHA7r4hej3K9A==",
            "dev": true,
            "funding": [
                {
                    "type": "github",
                    "url": "https://github.com/sponsors/feross"
                },
                {
                    "type": "patreon",
                    "url": "https://www.patreon.com/feross"
                },
                {
                    "type": "consulting",
                    "url": "https://feross.org/support"
                }
            ]
        },
        "node_modules/resolve-from": {
            "version": "4.0.0",
            "resolved": "https://registry.npmjs.org/resolve-from/-/resolve-from-4.0.0.tgz",
            "integrity": "sha512-pb/MYmXstAkysRFx8piNI1tGFNQIFA3vkE3Gq4EuA1dF6gHp/+vgZqsCGJapvy8N3Q+4o7FwvquPJcnZ7RYy4g==",
            "dev": true,
            "license": "MIT",
            "engines": {
                "node": ">=4"
            }
        },
        "node_modules/reusify": {
            "version": "1.0.4",
            "resolved": "https://registry.npmjs.org/reusify/-/reusify-1.0.4.tgz",
            "integrity": "sha512-U9nH88a3fc/ekCF1l0/UP1IosiuIjyTh7hBvXVMHYgVcfGvt897Xguj2UOLDeI5BG2m7/uwyaLVT6fbtCwTyzw==",
            "dev": true,
            "engines": {
                "iojs": ">=1.0.0",
                "node": ">=0.10.0"
            }
        },
        "node_modules/run-parallel": {
            "version": "1.2.0",
            "resolved": "https://registry.npmjs.org/run-parallel/-/run-parallel-1.2.0.tgz",
            "integrity": "sha512-5l4VyZR86LZ/lDxZTR6jqL8AFE2S0IFLMP26AbjsLVADxHdhB/c0GUsH+y39UfCi3dzz8OlQuPmnaJOMoDHQBA==",
            "dev": true,
            "funding": [
                {
                    "type": "github",
                    "url": "https://github.com/sponsors/feross"
                },
                {
                    "type": "patreon",
                    "url": "https://www.patreon.com/feross"
                },
                {
                    "type": "consulting",
                    "url": "https://feross.org/support"
                }
            ],
            "dependencies": {
                "queue-microtask": "^1.2.2"
            }
        },
        "node_modules/semver": {
            "version": "7.6.3",
            "resolved": "https://registry.npmjs.org/semver/-/semver-7.6.3.tgz",
            "integrity": "sha512-oVekP1cKtI+CTDvHWYFUcMtsK/00wmAEfyqKfNdARm8u1wNVhSgaX7A8d4UuIlUI5e84iEwOhs7ZPYRmzU9U6A==",
            "dev": true,
            "bin": {
                "semver": "bin/semver.js"
            },
            "engines": {
                "node": ">=10"
            }
        },
        "node_modules/shebang-command": {
            "version": "2.0.0",
            "resolved": "https://registry.npmjs.org/shebang-command/-/shebang-command-2.0.0.tgz",
            "integrity": "sha512-kHxr2zZpYtdmrN1qDjrrX/Z1rR1kG8Dx+gkpK1G4eXmvXswmcE1hTWBWYUzlraYw1/yZp6YuDY77YtvbN0dmDA==",
            "dev": true,
            "dependencies": {
                "shebang-regex": "^3.0.0"
            },
            "engines": {
                "node": ">=8"
            }
        },
        "node_modules/shebang-regex": {
            "version": "3.0.0",
            "resolved": "https://registry.npmjs.org/shebang-regex/-/shebang-regex-3.0.0.tgz",
            "integrity": "sha512-7++dFhtcx3353uBaq8DDR4NuxBetBzC7ZQOhmTQInHEd6bSrXdiEyzCvG07Z44UYdLShWUyXt5M/yhz8ekcb1A==",
            "dev": true,
            "engines": {
                "node": ">=8"
            }
        },
        "node_modules/strip-json-comments": {
            "version": "3.1.1",
            "resolved": "https://registry.npmjs.org/strip-json-comments/-/strip-json-comments-3.1.1.tgz",
            "integrity": "sha512-6fPc+R4ihwqP6N/aIv2f1gMH8lOVtWQHoqC4yK6oSDVVocumAsfCqjkXnqiYMhmMwS/mEHLp7Vehlt3ql6lEig==",
            "dev": true,
            "license": "MIT",
            "engines": {
                "node": ">=8"
            },
            "funding": {
                "url": "https://github.com/sponsors/sindresorhus"
            }
        },
        "node_modules/text-table": {
            "version": "0.2.0",
            "resolved": "https://registry.npmjs.org/text-table/-/text-table-0.2.0.tgz",
            "integrity": "sha512-N+8UisAXDGk8PFXP4HAzVR9nbfmVJ3zYLAWiTIoqC5v5isinhr+r5uaO8+7r3BMfuNIufIsA7RdpVgacC2cSpw==",
            "dev": true
        },
        "node_modules/to-regex-range": {
            "version": "5.0.1",
            "resolved": "https://registry.npmjs.org/to-regex-range/-/to-regex-range-5.0.1.tgz",
            "integrity": "sha512-65P7iz6X5yEr1cwcgvQxbbIw7Uk3gOy5dIdtZ4rDveLqhrdJP+Li/Hx6tyK0NEb+2GCyneCMJiGqrADCSNk8sQ==",
            "dev": true,
            "dependencies": {
                "is-number": "^7.0.0"
            },
            "engines": {
                "node": ">=8.0"
            }
        },
        "node_modules/ts-api-utils": {
            "version": "1.3.0",
            "resolved": "https://registry.npmjs.org/ts-api-utils/-/ts-api-utils-1.3.0.tgz",
            "integrity": "sha512-UQMIo7pb8WRomKR1/+MFVLTroIvDVtMX3K6OUir8ynLyzB8Jeriont2bTAtmNPa1ekAgN7YPDyf6V+ygrdU+eQ==",
            "dev": true,
            "engines": {
                "node": ">=16"
            },
            "peerDependencies": {
                "typescript": ">=4.2.0"
            }
        },
        "node_modules/type-check": {
            "version": "0.4.0",
            "resolved": "https://registry.npmjs.org/type-check/-/type-check-0.4.0.tgz",
            "integrity": "sha512-XleUoc9uwGXqjWwXaUTZAmzMcFZ5858QA2vvx1Ur5xIcixXIP+8LnFDgRplU30us6teqdlskFfu+ae4K79Ooew==",
            "dev": true,
            "dependencies": {
                "prelude-ls": "^1.2.1"
            },
            "engines": {
                "node": ">= 0.8.0"
            }
        },
        "node_modules/typescript": {
            "version": "5.6.3",
            "resolved": "https://registry.npmjs.org/typescript/-/typescript-5.6.3.tgz",
            "integrity": "sha512-hjcS1mhfuyi4WW8IWtjP7brDrG2cuDZukyrYrSauoXGNgx0S7zceP07adYkJycEr56BOUTNPzbInooiN3fn1qw==",
            "dev": true,
            "license": "Apache-2.0",
            "bin": {
                "tsc": "bin/tsc",
                "tsserver": "bin/tsserver"
            },
            "engines": {
                "node": ">=14.17"
            }
        },
        "node_modules/undici-types": {
            "version": "6.19.8",
            "resolved": "https://registry.npmjs.org/undici-types/-/undici-types-6.19.8.tgz",
            "integrity": "sha512-ve2KP6f/JnbPBFyobGHuerC9g1FYGn/F8n1LWTwNxCEzd6IfqTwUQcNXgEtmmQ6DlRrC1hrSrBnCZPokRrDHjw==",
            "dev": true
        },
        "node_modules/uri-js": {
            "version": "4.4.1",
            "resolved": "https://registry.npmjs.org/uri-js/-/uri-js-4.4.1.tgz",
            "integrity": "sha512-7rKUyy33Q1yc98pQ1DAmLtwX109F7TIfWlW1Ydo8Wl1ii1SeHieeh0HHfPeL2fMXK6z0s8ecKs9frCuLJvndBg==",
            "dev": true,
            "license": "BSD-2-Clause",
            "dependencies": {
                "punycode": "^2.1.0"
            }
        },
        "node_modules/which": {
            "version": "5.0.0",
            "resolved": "https://registry.npmjs.org/which/-/which-5.0.0.tgz",
            "integrity": "sha512-JEdGzHwwkrbWoGOlIHqQ5gtprKGOenpDHpxE9zVR1bWbOtYRyPPHMe9FaP6x61CmNaTThSkb0DAJte5jD+DmzQ==",
            "license": "ISC",
            "dependencies": {
                "isexe": "^3.1.1"
            },
            "bin": {
                "node-which": "bin/which.js"
            },
            "engines": {
                "node": "^18.17.0 || >=20.5.0"
            }
        },
        "node_modules/yocto-queue": {
            "version": "0.1.0",
            "resolved": "https://registry.npmjs.org/yocto-queue/-/yocto-queue-0.1.0.tgz",
            "integrity": "sha512-rVksvsnNCdJ/ohGc6xgPwyN8eheCxsiLM8mxuE/t/mOVqJewPuO1miLpTHQiRgTKCLexL4MeAFVagts7HmNZ2Q==",
            "dev": true,
            "engines": {
                "node": ">=10"
            },
            "funding": {
                "url": "https://github.com/sponsors/sindresorhus"
            }
        }
    }
}

```

`package.json`:

```json
{
    "name": "vscode-frida",
    "icon": "icon.png",
    "publisher": "codecolorist",
    "repository": {
        "type": "git",
        "url": "https://github.com/ChiChou/vscode-frida"
    },
    "displayName": "frida Workbench",
    "description": "%extension.description%",
    "version": "0.10.4",
    "engines": {
        "vscode": "^1.94.0"
    },
    "categories": [
        "Other"
    ],
    "activationEvents": [
        "onLanguage:javascript"
    ],
    "main": "./out/extension.js",
    "l10n": "./l10n",
    "contributes": {
        "configuration": {
            "title": "Frida",
            "properties": {
                "frida.decryptOutput": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "default": null,
                    "description": "%frida.decryptOutput%"
                },
                "frida.androidServerPath": {
                    "type": [
                        "string",
                        "null"
                    ],
                    "default": "/data/local/tmp/frida-server",
                    "description": "%frida.androidServerPath%"
                }
            }
        },
        "commands": [
            {
                "command": "frida.ps.refresh",
                "title": "%frida.ps.refresh%",
                "icon": {
                    "light": "resources/light/refresh.svg",
                    "dark": "resources/dark/refresh.svg"
                },
                "category": "Frida"
            },
            {
                "command": "frida.apps.refresh",
                "title": "%frida.apps.refresh%",
                "icon": {
                    "light": "resources/light/refresh.svg",
                    "dark": "resources/dark/refresh.svg"
                },
                "category": "Frida"
            },
            {
                "command": "frida.remote.add",
                "title": "%frida.remote.add%",
                "icon": {
                    "light": "resources/light/add.svg",
                    "dark": "resources/dark/add.svg"
                },
                "category": "Frida"
            },
            {
                "command": "frida.remote.remove",
                "title": "%frida.remote.remove%",
                "icon": {
                    "light": "resources/light/del.svg",
                    "dark": "resources/dark/del.svg"
                },
                "category": "Frida"
            },
            {
                "command": "frida.attach",
                "title": "%frida.attach%",
                "icon": {
                    "light": "resources/light/attach.svg",
                    "dark": "resources/dark/attach.svg"
                },
                "category": "Frida"
            },
            {
                "command": "frida.device.copy",
                "title": "%frida.device.copy%"
            },
            {
                "command": "frida.bundle.copy",
                "title": "%frida.bundle.copy%"
            },
            {
                "command": "frida.name.copy",
                "title": "%frida.name.copy%"
            },
            {
                "command": "frida.pid.copy",
                "title": "%frida.pid.copy%"
            },
            {
                "command": "frida.spawn",
                "title": "%frida.spawn%",
                "icon": {
                    "light": "resources/light/statusRun.svg",
                    "dark": "resources/dark/statusRun.svg"
                },
                "category": "Frida"
            },
            {
                "command": "frida.spawn.suspended",
                "title": "%frida.spawn.suspended%",
                "category": "Frida"
            },
            {
                "command": "frida.kill",
                "title": "%frida.kill%",
                "category": "Frida"
            },
            {
                "command": "frida.debug.setup",
                "title": "%frida.debug.setup%",
                "category": "Frida"
            },
            {
                "command": "frida.syslog",
                "title": "%frida.syslog%",
                "category": "Frida"
            },
            {
                "command": "frida.syslog.vacuum",
                "title": "%frida.syslog.vacuum%",
                "category": "Frida"
            },
            {
                "command": "frida.print.modules",
                "title": "%frida.print.modules%",
                "category": "Frida"
            },
            {
                "command": "frida.print.classes",
                "title": "%frida.print.classes%",
                "category": "Frida"
            },
            {
                "command": "frida.external.objection",
                "title": "%frida.external.objection%",
                "category": "Frida"
            },
            {
                "command": "frida.external.apk",
                "title": "%frida.external.apk%",
                "category": "Frida"
            },
            {
                "command": "frida.external.dump",
                "title": "%frida.external.dump%",
                "category": "Frida"
            },
            {
                "command": "frida.device.androidserver",
                "title": "%frida.device.androidserver%",
                "category": "Android"
            },
            {
                "command": "frida.external.shell",
                "title": "%frida.external.shell%",
                "category": "SSH over USB"
            },
            {
                "command": "frida.boilerplate.agent",
                "title": "%frida.boilerplate.agent%",
                "category": "Frida Boilerplate"
            },
            {
                "command": "frida.boilerplate.module",
                "title": "%frida.boilerplate.module%",
                "category": "Frida Boilerplate"
            },
            {
                "command": "frida.typing.init",
                "title": "%frida.typing.init%",
                "category": "Frida"
            }
        ],
        "viewsContainers": {
            "activitybar": [
                {
                    "id": "frida-sidebar",
                    "title": "%panel.title%",
                    "icon": "resources/icon.svg"
                }
            ]
        },
        "views": {
            "frida-sidebar": [
                {
                    "id": "fridaApps",
                    "name": "%frida.apps%"
                },
                {
                    "id": "fridaPs",
                    "name": "%frida.ps%"
                }
            ]
        },
        "menus": {
            "commandPalette": [
                {
                    "command": "frida.boilerplate.agent"
                },
                {
                    "command": "frida.boilerplate.module"
                },
                {
                    "command": "frida.ps.refresh"
                },
                {
                    "command": "frida.apps.refresh"
                },
                {
                    "command": "frida.remote.add"
                },
                {
                    "command": "frida.remote.remove"
                },
                {
                    "command": "frida.typing.init"
                },
                {
                    "command": "frida.external.objection",
                    "when": "false"
                },
                {
                    "command": "frida.external.dump",
                    "when": "false"
                },
                {
                    "command": "frida.external.apk",
                    "when": "false"
                },
                {
                    "command": "frida.device.androidserver",
                    "when": "false"
                },
                {
                    "command": "frida.external.shell",
                    "when": "false"
                },
                {
                    "command": "frida.syslog",
                    "when": "false"
                },
                {
                    "command": "frida.print.modules",
                    "when": "false"
                },
                {
                    "command": "frida.print.classes",
                    "when": "false"
                },
                {
                    "command": "frida.attach",
                    "when": "false"
                },
                {
                    "command": "frida.kill",
                    "when": "false"
                },
                {
                    "command": "frida.spawn",
                    "when": "false"
                },
                {
                    "command": "frida.debug.setup",
                    "when": "false"
                },
                {
                    "command": "frida.spawn.suspended",
                    "when": "false"
                },
                {
                    "command": "frida.bundle.copy",
                    "when": "false"
                },
                {
                    "command": "frida.name.copy",
                    "when": "false"
                },
                {
                    "command": "frida.device.copy",
                    "when": "false"
                }
            ],
            "view/title": [
                {
                    "command": "frida.remote.add",
                    "when": "view == fridaApps",
                    "group": "navigation@1"
                },
                {
                    "command": "frida.apps.refresh",
                    "when": "view == fridaApps",
                    "group": "navigation@2"
                },
                {
                    "command": "frida.remote.add",
                    "when": "view == fridaPs",
                    "group": "navigation@1"
                },
                {
                    "command": "frida.ps.refresh",
                    "when": "view == fridaPs",
                    "group": "navigation@2"
                }
            ],
            "view/item/context": [
                {
                    "command": "frida.remote.remove",
                    "when": "view == fridaApps && viewItem =~ /^device\\|socket@/",
                    "group": "inline"
                },
                {
                    "command": "frida.remote.remove",
                    "when": "view == fridaPs && viewItem =~ /^device\\|socket@/",
                    "group": "inline"
                },
                {
                    "command": "frida.attach",
                    "when": "view == fridaApps && viewItem == 'app|running'",
                    "group": "inline"
                },
                {
                    "command": "frida.attach",
                    "when": "view == fridaPs && viewItem =~ /^process\\|/",
                    "group": "inline"
                },
                {
                    "command": "frida.spawn",
                    "when": "view == fridaApps && viewItem =~ /^app\\|/",
                    "group": "inline"
                },
                {
                    "command": "frida.debug.setup",
                    "when": "view == fridaApps && viewItem =~ /^app\\|/",
                    "group": "1_frida_info@1"
                },
                {
                    "command": "frida.debug.setup",
                    "when": "view == fridaPs && viewItem =~ /^process\\|/",
                    "group": "1_frida_info@1"
                },
                {
                    "command": "frida.bundle.copy",
                    "when": "view == fridaApps && viewItem =~ /^app\\|/",
                    "group": "1_frida_info@1"
                },
                {
                    "command": "frida.name.copy",
                    "when": "view == fridaPs && viewItem =~ /^process\\|/",
                    "group": "1_frida_info@1"
                },
                {
                    "command": "frida.pid.copy",
                    "when": "view == fridaPs && viewItem =~ /^process\\|/",
                    "group": "1_frida_info@1"
                },
                {
                    "command": "frida.kill",
                    "when": "viewItem =~ /\\|running$/",
                    "group": "2_frida_process@2"
                },
                {
                    "command": "frida.spawn.suspended",
                    "when": "view == fridaApps && viewItem =~ /^app\\|/",
                    "group": "2_frida_process@1"
                },
                {
                    "command": "frida.syslog",
                    "when": "view == fridaApps && viewItem =~ /^app\\|/",
                    "group": "3_frida_logger@1"
                },
                {
                    "command": "frida.syslog",
                    "when": "view == fridaPs && viewItem =~ /^process\\|/",
                    "group": "3_frida_logger@1"
                },
                {
                    "command": "frida.print.modules",
                    "when": "view == fridaApps && viewItem =~ /^app\\|/",
                    "group": "3_frida_logger@2"
                },
                {
                    "command": "frida.print.modules",
                    "when": "view == fridaPs && viewItem =~ /^process\\|/",
                    "group": "3_frida_logger@2"
                },
                {
                    "command": "frida.print.classes",
                    "when": "view == fridaApps && viewItem =~ /^app\\|/",
                    "group": "3_frida_logger@3"
                },
                {
                    "command": "frida.print.classes",
                    "when": "view == fridaPs && viewItem =~ /^process\\|/",
                    "group": "3_frida_logger@3"
                },
                {
                    "command": "frida.external.objection",
                    "when": "view == fridaApps && viewItem =~ /^app\\|/",
                    "group": "4_frida_external@2"
                },
                {
                    "command": "frida.external.dump",
                    "when": "view == fridaApps && viewItem =~ /^app\\|/ && viewItem =~ /\\|ios$/",
                    "group": "4_frida_external@3"
                },
                {
                    "command": "frida.external.apk",
                    "when": "view == fridaApps && viewItem =~ /^app\\|/ && viewItem =~ /\\|android$/",
                    "group": "4_frida_external@3"
                },
                {
                    "command": "frida.external.shell",
                    "when": "viewItem =~ /^device\\|\\w+\\|(android|ios)$/ || viewItem =~ /^device\\|\\local/",
                    "group": "1_frida_dev_external@1"
                },
                {
                    "command": "frida.device.copy",
                    "when": "viewItem =~ /^device\\|/",
                    "group": "1_frida_dev_setup@1"
                },
                {
                    "command": "frida.device.androidserver",
                    "when": "viewItem =~ /^device\\|\\w+\\|android$/",
                    "group": "2_frida_dev_setup@2"
                }
            ]
        }
    },
    "scripts": {
        "vscode:prepublish": "npm run compile",
        "compile": "tsc -p ./",
        "watch": "tsc -watch -p ./",
        "pretest": "npm run compile",
        "deploy": "vsce publish"
    },
    "devDependencies": {
        "@types/node": "^22.8.1",
        "@types/vscode": "^1.94.0",
        "@types/which": "^3.0.4",
        "@typescript-eslint/eslint-plugin": "^8.11.0",
        "@typescript-eslint/parser": "^8.11.0",
        "eslint": "^9.13.0",
        "typescript": "^5.6.3"
    },
    "dependencies": {
        "which": "^5.0.0"
    },
    "extensionDependencies": [
        "ms-python.python"
    ]
}

```

`package.nls.json`:

```json
{
    "panel.title": "Frida Utilities",
    "extension.description": "Unofficial frida workbench for VSCode",
    "frida.decryptOutput": "Preferred directory to save ipa or apk",
    "frida.androidServerPath": "Path to frida-server on Android",
    "frida.ps.refresh": "Reload process list",
    "frida.apps.refresh": "Reload application list",
    "frida.remote.add": "Connect Remote Device...",
    "frida.remote.remove": "Disconnect Remote Device...",
    "frida.attach": "Attach to",
    "frida.device.copy": "Copy Device ID",
    "frida.bundle.copy": "Copy Bundle ID",
    "frida.name.copy": "Copy Process Name",
    "frida.pid.copy": "Copy Process ID",
    "frida.spawn": "Spawn",
    "frida.spawn.suspended": "Spawn Suspended",
    "frida.kill": "End Process",
    "frida.debug.setup": "Create Debugger Configuration",
    "frida.syslog": "View Debug Logs",
    "frida.syslog.vacuum": "Close All Console",
    "frida.print.modules": "Export All Modules To Editor",
    "frida.print.classes": "Export All Classes To Editor",
    "frida.external.objection": "Objection",
    "frida.external.apk": "Pull APK from Device",
    "frida.external.dump": "Dump App Package",
    "frida.device.androidserver": "Start frida-server",
    "frida.external.shell": "Open Shell",
    "frida.boilerplate.agent": "Create Frida Agent",
    "frida.boilerplate.module": "Create Frida CModule",
    "frida.typing.init": "Get type hint for frida",
    "frida.apps": "Application List",
    "frida.ps": "Process List"
}
```

`package.nls.zh-cn.json`:

```json
{
    "panel.title": "Frida 集成面板",
    "extension.description": "将 Frida 集成到 VSCode 的非官方插件",
    "frida.decryptOutput": "保存 ipa 或 apk 的首选目录",
    "frida.androidServerPath": "Android 上 frida-server 的路径",
    "frida.ps.refresh": "刷新进程列表",
    "frida.apps.refresh": "刷新应用列表",
    "frida.remote.add": "连接远程设备...",
    "frida.remote.remove": "断开远程设备...",
    "frida.attach": "附加到",
    "frida.device.copy": "复制设备 ID",
    "frida.bundle.copy": "复制包 ID",
    "frida.name.copy": "复制进程名称",
    "frida.pid.copy": "复制进程 ID",
    "frida.spawn": "启动",
    "frida.spawn.suspended": "启动并暂停",
    "frida.kill": "结束进程",
    "frida.debug.setup": "创建调试配置",
    "frida.syslog": "查看调试日志",
    "frida.syslog.vacuum": "关闭所有控制台",
    "frida.print.modules": "导出所有模块到编辑器",
    "frida.print.classes": "导出所有类到编辑器",
    "frida.external.objection": "Objection",
    "frida.external.apk": "从设备提取 APK",
    "frida.external.dump": "导出应用包",
    "frida.device.androidserver": "启动 frida-server",
    "frida.external.shell": "打开终端",
    "frida.boilerplate.agent": "创建 Frida Agent",
    "frida.boilerplate.module": "创建 Frida CModule",
    "frida.typing.init": "获取 frida 类型提示",
    "frida.apps": "应用列表",
    "frida.ps": "进程列表"
}
```

`resources/dark/add.svg`:

```svg
<?xml version="1.0"?>
<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" version="1.1" xml:space="preserve">
  <g class="layer">
    <polygon fill="#efefef" points="15,7.5 8.5,7.5 8.5,1 7.5,1 7.5,7.5 1,7.5 1,8.5 7.5,8.5 7.5,15 8.5,15 8.5,8.5 15,8.5 "/>
  </g>
</svg>
```

`resources/dark/apps.svg`:

```svg
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#efefef" d="M4 8h4V4H4v4zm6 12h4v-4h-4v4zm-6 0h4v-4H4v4zm0-6h4v-4H4v4zm6 0h4v-4h-4v4zm6-10v4h4V4h-4zm-6 4h4V4h-4v4zm6 6h4v-4h-4v4zm0 6h4v-4h-4v4z"/><path d="M0 0h24v24H0z" fill="none"/></svg>
```

`resources/dark/attach.svg`:

```svg
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path fill="#efefef" d="M5 2c0-.55-.45-1-1-1s-1 .45-1 1v4H1v6h6V6H5V2zm4 14c0 1.3.84 2.4 2 2.82V23h2v-4.18c1.16-.41 2-1.51 2-2.82v-2H9v2zm-8 0c0 1.3.84 2.4 2 2.82V23h2v-4.18C6.16 18.4 7 17.3 7 16v-2H1v2zM21 6V2c0-.55-.45-1-1-1s-1 .45-1 1v4h-2v6h6V6h-2zm-8-4c0-.55-.45-1-1-1s-1 .45-1 1v4H9v6h6V6h-2V2zm4 14c0 1.3.84 2.4 2 2.82V23h2v-4.18c1.16-.41 2-1.51 2-2.82v-2h-6v2z"/></svg>
```

`resources/dark/del.svg`:

```svg
<svg fill="#000000" xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="24px" height="24px"><path fill="#efefef" d="M 10.806641 2 C 10.289641 2 9.7956875 2.2043125 9.4296875 2.5703125 L 9 3 L 4 3 A 1.0001 1.0001 0 1 0 4 5 L 20 5 A 1.0001 1.0001 0 1 0 20 3 L 15 3 L 14.570312 2.5703125 C 14.205312 2.2043125 13.710359 2 13.193359 2 L 10.806641 2 z M 4.3652344 7 L 5.8925781 20.263672 C 6.0245781 21.253672 6.877 22 7.875 22 L 16.123047 22 C 17.121047 22 17.974422 21.254859 18.107422 20.255859 L 19.634766 7 L 4.3652344 7 z"/></svg>
```

`resources/dark/error.svg`:

```svg
<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M8.58318 2.02842C9.96435 2.16331 11.2561 2.77279 12.2383 3.75307C13.3643 4.87923 13.9978 6.40584 14 7.99829C14.0004 9.38617 13.5196 10.7313 12.6396 11.8045C11.7595 12.8778 10.5345 13.6127 9.17333 13.8841C7.81215 14.1556 6.39895 13.9467 5.1745 13.2931C3.95005 12.6394 2.99008 11.5815 2.45814 10.2995C1.92619 9.0175 1.85517 7.59072 2.25717 6.26222C2.65917 4.93373 3.50933 3.7857 4.66282 3.0137C5.8163 2.24171 7.20177 1.89351 8.58318 2.02842ZM8.68038 1.03316C10.292 1.19055 11.7993 1.90184 12.9453 3.04585C14.2587 4.35938 14.9976 6.14013 15 7.99764C15.0005 9.61695 14.4396 11.1864 13.4129 12.4385C12.3861 13.6907 10.9569 14.5482 9.36889 14.8648C7.78084 15.1815 6.13211 14.9378 4.70359 14.1752C3.27506 13.4127 2.1551 12.1784 1.53449 10.6828C0.913887 9.18708 0.831027 7.52251 1.30003 5.97259C1.76903 4.42268 2.76089 3.08331 4.10662 2.18265C5.45236 1.28199 7.06873 0.875761 8.68038 1.03316ZM5.52498 5L8.00004 7.47506L10.4751 5L11.1822 5.70711L8.70714 8.18217L11.1818 10.6569L10.4747 11.364L8.00004 8.88927L5.52535 11.364L4.81824 10.6569L7.29293 8.18217L4.81787 5.70711L5.52498 5Z" fill="#F48771"/>
</svg>

```

`resources/dark/local.svg`:

```svg
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="#efefef" d="M23 2H1v16h9v2H8v2h8v-2h-2v-2h9V2zm-2 14H3V4h18v12z"/></svg>
```

`resources/dark/refresh.svg`:

```svg
<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M5.56253 2.51577C3.46348 3.4501 2 5.55414 2 7.99999C2 11.3137 4.68629 14 8 14C11.3137 14 14 11.3137 14 7.99999C14 5.32519 12.2497 3.05919 9.83199 2.28482L9.52968 3.23832C11.5429 3.88454 13 5.7721 13 7.99999C13 10.7614 10.7614 13 8 13C5.23858 13 3 10.7614 3 7.99999C3 6.31104 3.83742 4.81767 5.11969 3.91245L5.56253 2.51577Z" fill="#C5C5C5"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M5 3H2V2H5.5L6 2.5V6H5V3Z" fill="#C5C5C5"/>
</svg>

```

`resources/dark/remote.svg`:

```svg
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="#efefef" d="M12.01 21.49L23.64 7c-.45-.34-4.93-4-11.64-4C5.28 3 .81 6.66.36 7l11.63 14.49.01.01.01-.01z"/></svg>
```

`resources/dark/statusRun.svg`:

```svg
<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M4 2V14.4805L12.9146 8.24024L4 2ZM11.1809 8.24024L4.995 12.5684V3.91209L11.1809 8.24024Z" fill="#89D185"/>
</svg>

```

`resources/dark/statusStop.svg`:

```svg
<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<rect x="3.5" y="3.5" width="9" height="9" stroke="#F48771"/>
</svg>

```

`resources/dark/usb.svg`:

```svg
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="#efefef" d="M15 7v4h1v2h-3V5h2l-3-4-3 4h2v8H8v-2.07c.7-.37 1.2-1.08 1.2-1.93 0-1.21-.99-2.2-2.2-2.2S4.8 7.79 4.8 9c0 .85.5 1.56 1.2 1.93V13c0 1.11.89 2 2 2h3v3.05c-.71.37-1.2 1.1-1.2 1.95 0 1.22.99 2.2 2.2 2.2s2.2-.98 2.2-2.2c0-.85-.49-1.58-1.2-1.95V15h3c1.11 0 2-.89 2-2v-2h1V7h-4z"/></svg>
```

`resources/debugger.preload.js`:

```js
global.process = { pid: Process.id, version: Frida.version, arch: Process.arch };
```

`resources/icon.svg`:

```svg
<?xml version="1.0" encoding="UTF-8"?>
<svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <!-- Generator: Sketch 48.2 (47327) - http://www.bohemiancoding.com/sketch -->
    <title>Slice</title>
    <desc>Created with Sketch.</desc>
    <defs></defs>
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <path d="M8.9481268,21.1066282 L4,21.1066282 L8.11527378,14.7867435 C5.76368876,13.6599424 4.48991354,11.6023055 4.48991354,8.61383285 C4.48991354,4.35158501 7.38040346,2 12.426513,2 L21,2 L21,21.1066282 L16.5907781,21.1066282 L16.5907781,15.7175793 L12.426513,15.7175793 L12.0345821,15.7175793 L8.9481268,21.1066282 Z M16.5907781,11.7982709 L16.5907781,5.42939481 L12.426513,5.42939481 C10.0259366,5.42939481 8.65417867,6.4092219 8.65417867,8.5648415 C8.65417867,10.7694524 10.0259366,11.7982709 12.426513,11.7982709 L16.5907781,11.7982709 Z" id="Shape" fill="#FFFFFF" fill-rule="nonzero"></path>
    </g>
</svg>
```

`resources/light/add.svg`:

```svg
<?xml version="1.0"?>
<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" version="1.1" xml:space="preserve">
  <g class="layer">
    <polygon fill="null" points="15,7.5 8.5,7.5 8.5,1 7.5,1 7.5,7.5 1,7.5 1,8.5 7.5,8.5 7.5,15 8.5,15 8.5,8.5 15,8.5 "/>
  </g>
</svg>
```

`resources/light/apps.svg`:

```svg
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#333" d="M4 8h4V4H4v4zm6 12h4v-4h-4v4zm-6 0h4v-4H4v4zm0-6h4v-4H4v4zm6 0h4v-4h-4v4zm6-10v4h4V4h-4zm-6 4h4V4h-4v4zm6 6h4v-4h-4v4zm0 6h4v-4h-4v4z"/><path d="M0 0h24v24H0z" fill="none"/></svg>
```

`resources/light/attach.svg`:

```svg
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M5 2c0-.55-.45-1-1-1s-1 .45-1 1v4H1v6h6V6H5V2zm4 14c0 1.3.84 2.4 2 2.82V23h2v-4.18c1.16-.41 2-1.51 2-2.82v-2H9v2zm-8 0c0 1.3.84 2.4 2 2.82V23h2v-4.18C6.16 18.4 7 17.3 7 16v-2H1v2zM21 6V2c0-.55-.45-1-1-1s-1 .45-1 1v4h-2v6h6V6h-2zm-8-4c0-.55-.45-1-1-1s-1 .45-1 1v4H9v6h6V6h-2V2zm4 14c0 1.3.84 2.4 2 2.82V23h2v-4.18c1.16-.41 2-1.51 2-2.82v-2h-6v2z"/></svg>
```

`resources/light/del.svg`:

```svg
<svg fill="#000000" xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="24px" height="24px"><path fill="null" d="M 10.806641 2 C 10.289641 2 9.7956875 2.2043125 9.4296875 2.5703125 L 9 3 L 4 3 A 1.0001 1.0001 0 1 0 4 5 L 20 5 A 1.0001 1.0001 0 1 0 20 3 L 15 3 L 14.570312 2.5703125 C 14.205312 2.2043125 13.710359 2 13.193359 2 L 10.806641 2 z M 4.3652344 7 L 5.8925781 20.263672 C 6.0245781 21.253672 6.877 22 7.875 22 L 16.123047 22 C 17.121047 22 17.974422 21.254859 18.107422 20.255859 L 19.634766 7 L 4.3652344 7 z"/></svg>
```

`resources/light/error.svg`:

```svg
<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M8.45337 2.02828C9.80698 2.16246 11.0755 2.76898 12.042 3.74809C13.15 4.87311 13.776 6.4012 13.7782 7.99826C13.7786 9.39013 13.3035 10.7372 12.4367 11.8101C11.5701 12.8828 10.3662 13.6147 9.03197 13.8847C7.69789 14.1547 6.31229 13.9472 5.1104 13.296C3.90817 12.6446 2.96232 11.5884 2.4374 10.3044C1.91238 9.02005 1.84212 7.58981 2.23908 6.25829C2.63599 4.92697 3.47438 3.77978 4.60779 3.00985C5.74086 2.24014 7.09976 1.8941 8.45337 2.02828ZM8.55201 1.03316C10.1398 1.19055 11.6248 1.90184 12.7539 3.04585C14.0479 4.35938 14.7758 6.14013 14.7782 7.99764C14.7787 9.61695 14.2261 11.1864 13.2145 12.4385C12.2029 13.6907 10.7949 14.5482 9.23035 14.8648C7.66577 15.1815 6.04142 14.9378 4.63401 14.1752C3.2266 13.4127 2.12319 12.1784 1.51176 10.6828C0.900328 9.18708 0.818694 7.52251 1.28076 5.97259C1.74283 4.42268 2.72002 3.08331 4.04587 2.18265C5.37171 1.28199 6.96419 0.875761 8.55201 1.03316ZM5.44326 5L7.88173 7.47506L10.3202 5L11.0169 5.70711L8.57839 8.18217L11.0165 10.6569L10.3198 11.364L7.88173 8.88927L5.44362 11.364L4.74697 10.6569L7.18508 8.18217L4.7466 5.70711L5.44326 5Z" fill="#A1260D"/>
</svg>

```

`resources/light/local.svg`:

```svg
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="#333" d="M23 2H1v16h9v2H8v2h8v-2h-2v-2h9V2zm-2 14H3V4h18v12z"/></svg>
```

`resources/light/refresh.svg`:

```svg
<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M5.56253 2.51577C3.46348 3.4501 2 5.55414 2 7.99999C2 11.3137 4.68629 14 8 14C11.3137 14 14 11.3137 14 7.99999C14 5.32519 12.2497 3.05919 9.83199 2.28482L9.52968 3.23832C11.5429 3.88454 13 5.7721 13 7.99999C13 10.7614 10.7614 13 8 13C5.23858 13 3 10.7614 3 7.99999C3 6.31104 3.83742 4.81767 5.11969 3.91245L5.56253 2.51577Z" fill="#424242"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M5 3H2V2H5.5L6 2.5V6H5V3Z" fill="#424242"/>
</svg>

```

`resources/light/remote.svg`:

```svg
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="#333" d="M12.01 21.49L23.64 7c-.45-.34-4.93-4-11.64-4C5.28 3 .81 6.66.36 7l11.63 14.49.01.01.01-.01z"/></svg>
```

`resources/light/statusRun.svg`:

```svg
<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M4 2V14.4805L12.9146 8.24024L4 2ZM11.1809 8.24024L4.995 12.5684V3.91209L11.1809 8.24024Z" fill="#388A34"/>
</svg>

```

`resources/light/statusStop.svg`:

```svg
<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<rect x="3.5" y="3.5" width="9" height="9" stroke="#A1260D"/>
</svg>

```

`resources/light/usb.svg`:

```svg
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="#333" d="M15 7v4h1v2h-3V5h2l-3-4-3 4h2v8H8v-2.07c.7-.37 1.2-1.08 1.2-1.93 0-1.21-.99-2.2-2.2-2.2S4.8 7.79 4.8 9c0 .85.5 1.56 1.2 1.93V13c0 1.11.89 2 2 2h3v3.05c-.71.37-1.2 1.1-1.2 1.95 0 1.22.99 2.2 2.2 2.2s2.2-.98 2.2-2.2c0-.85-.49-1.58-1.2-1.95V15h3c1.11 0 2-.89 2-2v-2h1V7h-4z"/></svg>
```

`resources/run.svg`:

```svg
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><defs><style>.a{fill:none;}.b{fill:#ef6456;}</style></defs><title>run2</title><path class="a" d="M0,0H24V24H0Z"/><path class="b" d="M9,20.37H4.76L8.26,15A5.38,5.38,0,0,1,5.17,9.73c0-3.63,2.47-5.64,6.77-5.64h7.3V20.37H15.49V15.78H11.6Zm6.52-7.93V7H11.94c-2,0-3.22.84-3.22,2.68s1.17,2.75,3.22,2.75Z"/></svg>
```

`resources/templates/launch.json`:

```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "preLaunchTask": "frida",
      "name": "Attach",
      "port": 9229,
      "request": "attach",
      "skipFiles": [
        "<node_internals>/**"
      ],
      "type": "node"
    }
  ]
}
```

`resources/templates/tasks.json`:

```json
{
  "version": "2.0.0",
  "tasks": [
    {
      "isBackground": true,
      "label": "frida",
      "command": "frida",
      "args": [
        "explorer.exe",
        "-l",
        "pid.js",
        "--debug",
        "--runtime=v8"
      ],
      "type": "shell",
      "problemMatcher": [
        {
          "pattern": [
            {
              "regexp": ".",
              "file": 1,
              "location": 2,
              "message": 3
            }
          ],
          "background": {
            "activeOnStart": true,
            "beginsPattern": "Chrome Inspector server listening on port",
            "endsPattern": "\\d+"
          }
        }
      ]
    }
  ]
}
```

`src/commands/android.ts`:

```ts
/* eslint-disable @typescript-eslint/naming-convention */
import * as vscode from 'vscode';
import { join } from 'path';
import { tmpdir } from 'os';

import ADB from '../driver/adb';
import { DeviceItem, TargetItem } from '../providers/devices';
import { logger } from '../logger';
import { interpreter, sleep } from '../utils';
import { run } from '../term';

function getServerPath() {
  return vscode.workspace.getConfiguration('frida')
    .get('androidServerPath', '/data/local/tmp/frida-server');
}

export async function startServer(target: TargetItem) {
  if (!(target instanceof DeviceItem)) {
    vscode.window.showErrorMessage(vscode.l10n.t('This command is only expected to be used in the context menu'));
    return;
  }

  const server = getServerPath();
  const adb = new ADB(target.data.id);
  const installed = await adb.shell(server, '--version').then((ver: string) => {
    logger.appendLine(vscode.l10n.t('sanity check: frida-server version on device {0}', ver));
    return true;
  }).catch(() => {
    logger.appendLine(vscode.l10n.t('frida-server not found on device, downloading...'));
    return false;
  });

  if (!installed) {
    const abi = (await adb.shell('getprop', 'ro.product.cpu.abi')).trimEnd();
    const py = join(__dirname, '..', '..', 'backend', 'android', 'get-frida.py');
    const tmp = join(tmpdir(), `frida-server-${abi}`);

    const shellPath = await interpreter();
    await vscode.window.withProgress({
      location: vscode.ProgressLocation.Notification,
      title: vscode.l10n.t('Downloading frida-server'),
      cancellable: false
    }, async (progress) => {
      await run({
        name: `Download frida-server`,
        shellPath,
        shellArgs: [py, abi, tmp]
      });
      progress.report({ message: vscode.l10n.t('Done') });
    });

    const uri = vscode.Uri.file(tmp);
    await adb.push(uri, server);

    vscode.window.showInformationMessage(vscode.l10n.t('frida-server deployed to {0} successfully', server));
    await adb.shell('chmod', '755', server);
  }

  const term = adb.interactive();
  await sleep(1000);
  term.sendText('su', true);
  await sleep(500);
  term.sendText(server, true);
}

```

`src/commands/boilerplate.ts`:

```ts
import { createReadStream, createWriteStream, promises as fsp } from 'fs';
import { join as joinPath } from 'path';
import * as vscode from 'vscode';

import { AppItem, ProcessItem } from '../providers/devices';
import { run } from '../term';
import { cmd, expandDevParam, interpreter, resource } from '../utils';


async function create(template: string) {
  let dest: vscode.Uri;

  const { workspaceFolders } = vscode.workspace;
  {
    if (workspaceFolders?.length) { dest = workspaceFolders[0].uri; }

    const fileUri = await vscode.window.showOpenDialog({
      canSelectFolders: true,
      canSelectMany: false,
      openLabel: vscode.l10n.t('Create Here')
    });

    if (fileUri?.length) {
      dest = fileUri[0];
    } else {
      vscode.window.showInformationMessage(
        vscode.l10n.t('You must select a folder to create the project'));
      return;
    }
  }

  const args = ['-m', 'frida_tools.creator', '-t', template];
  const shellPath = await interpreter();
  await run({
    cwd: dest,
    name: vscode.l10n.t('Create Project'),
    shellPath,
    shellArgs: args
  });

  if (!(workspaceFolders?.length)) {
    vscode.commands.executeCommand('vscode.openFolder', dest);
  }

  await run({
    cwd: dest.path,
    name: `npm install`,
    shellPath: cmd('npm'),
    shellArgs: ['install']
  });
}

export function agent() {
  return create('agent');
}

export function module() {
  return create('module');
}

function* tokenize(cmd: string) {
  let inQuote = false;
  let buf = [];
  for (const c of cmd) {
    if (c === '\"') {
      inQuote = !inQuote;
    } else if (c === ' ' && !inQuote) {
      yield buf.join('');
      buf.length = 0;
    } else {
      buf.push(c);
    }
  }

  yield buf.join('');
}

export async function debug(node?: AppItem | ProcessItem) {
  if (!node) { return; }

  const { activeTextEditor, showInformationMessage, showInputBox } = vscode.window;
  const { workspaceFolders } = vscode.workspace;

  if (!workspaceFolders?.length) {
    showInformationMessage(
      vscode.l10n.t('This command only works in a workspace. Please open a workspace first'));
    return;
  }

  const FILE_LAUNCH = 'launch.json';
  const FILE_TASKS = 'tasks.json';

  const dest = workspaceFolders[0].uri;

  const folder = joinPath(dest.fsPath, '.vscode');
  const launchJSON = joinPath(folder, FILE_LAUNCH);
  const tasksJSON = joinPath(folder, FILE_TASKS);

  const isDir = (path: string) =>
    fsp.stat(path).then(stat => stat.isDirectory()).catch(() => false);

  const isFile = (path: string) =>
    fsp.stat(path).then(stat => stat.isFile()).catch(() => false);

  if (await isDir(folder)) {
    // check if launch.json exists    
    for (const file of [launchJSON, tasksJSON]) {
      if (await isFile(file)) {
        const msg = vscode.l10n.t('{0} already exists. Do you want to overwrite it?', file);
        const y = vscode.l10n.t('Yes');
        const n = vscode.l10n.t('No');
        const answer = await showInformationMessage(msg, y, n);
        if (answer === n) { return; }
        if (answer === y) { break; } // only have to answer yes once
      }
    }
  } else {
    await fsp.mkdir(folder);
  }

  const quote = (s: string) => s.includes(' ') ? `"${s}"` : s;

  let cmd: string[] = [];
  // create debug command line
  cmd.push(...expandDevParam(node));

  if (node instanceof AppItem) {
    if (node.data.pid) {
      cmd.push(quote(node.data.name)); // attach to app
    } else {
      cmd.push('-f', quote(node.data.identifier)); // spawn
    }
  } else if (node instanceof ProcessItem) {
    cmd.push(node.data.pid.toString()); // attach to pid
  }

  // attach current document to the target
  if (activeTextEditor && !activeTextEditor.document.isDirty) {
    cmd.push('-l', quote(activeTextEditor.document.uri.fsPath));
  }

  // enable v8 debug
  cmd.push('--runtime=v8', '--debug');

  const placeHolder = cmd.join(' ');
  const userInput = await showInputBox({
    placeHolder,
    prompt: vscode.l10n.t('Debug Command'),
    value: placeHolder,
  });

  // user cancelled
  if (!userInput) { return; }

  // copy launch.json to workspace
  await new Promise<boolean>((resolve, reject) => {
    createReadStream(resource('templates', FILE_LAUNCH).fsPath)
      .pipe(createWriteStream(launchJSON))
      .on('finish', () => resolve(true))
      .on('error', (err) => reject(err));
  });

  const tasksTemplatePath = resource('templates', FILE_TASKS).fsPath;
  const content = JSON.parse(await fsp.readFile(tasksTemplatePath, 'utf8'));
  // replace the command line in tasks.json
  content.tasks[0].args = [...tokenize(userInput)];
  await fsp.writeFile(tasksJSON, JSON.stringify(content, null, 2));

  showInformationMessage(
    vscode.l10n.t('Debug configuration created. You can now start debugging by pressing F5')
  );
}

```

`src/commands/clipboard.ts`:

```ts
import { env, l10n } from 'vscode';
import { TargetItem, AppItem, ProcessItem, DeviceItem } from "../providers/devices";

export function copy(item: TargetItem) {
  const getText = (item: TargetItem) => {
    if (item instanceof AppItem) {
      return item.data.identifier;
    } else if (item instanceof ProcessItem) {
      return item.data.name;
    } else if (item instanceof DeviceItem) {
      return item.data.id;
    }

    throw new Error(l10n.t('Unsupported item type'));
  }

  env.clipboard.writeText(getText(item));  
}

export function copyPid(item: AppItem | ProcessItem) {
  if (item instanceof AppItem || item instanceof ProcessItem) {
    env.clipboard.writeText(item.data.pid.toString());
    return;
  }

  throw new Error(l10n.t('Unsupported item type'));
}
```

`src/commands/dump.ts`:

```ts
import { homedir } from 'os';
import * as vscode from 'vscode';

import ADB from '../driver/adb';
import { AppItem, TargetItem } from "../providers/devices";
import { DeviceType } from '../types';
import { cmd } from '../utils';

export default async function dump(target: TargetItem) {
  if (!(target instanceof AppItem)) {
    vscode.window.showErrorMessage(vscode.l10n.t('This command is only expected to be used in the context menu'));
    return;
  }

  if (target.device.os !== 'ios' && target.device.os !== 'android') {
    vscode.window.showErrorMessage(vscode.l10n.t('This command only supports iOS or Android'));
    return;
  }

  const preferred = vscode.workspace.getConfiguration('frida').get('decryptOutput', homedir());
  const defaultUri = vscode.Uri.file(preferred);
  const destinations = await vscode.window.showOpenDialog({
    defaultUri,
    canSelectFiles: false,
    canSelectFolders: true,
    canSelectMany: false,
    openLabel: 'Select',
    title: vscode.l10n.t('Select destination folder')
  });

  if (!destinations?.length) { return; }

  const destURI = destinations[0];
  const output = destURI.fsPath;

  // save preferred path
  vscode.workspace.getConfiguration('frida').update('decryptOutput', output, true);

  let artifact: vscode.Uri;

  try {
    if (target.device.os === 'ios') {
      artifact = vscode.Uri.joinPath(destURI, `${target.data.identifier}.ipa`);
      await bagbak(target, artifact);
    } else if (target.device.os === 'android') {
      artifact = vscode.Uri.joinPath(destURI, `${target.data.identifier}.apk`);
      await pull(target, artifact);
    } else {
      vscode.window.showErrorMessage(vscode.l10n.t('This command only supports iOS or Android'));
      return;
    }
  } catch (e) {
    vscode.window.showInformationMessage(
      vscode.l10n.t('failed to dump application:\n{0}', (e as Error).message));
    return;
  }

  const actionOpen = vscode.l10n.t('Open');
  const option = await vscode.window.showInformationMessage(
    vscode.l10n.t('Successfully pulled package {0}', target.data.identifier),
    actionOpen,
    vscode.l10n.t('Dismiss'));

  if (option === actionOpen) {
    vscode.commands.executeCommand('revealFileInOS', artifact);
  }
}

async function pull(target: AppItem, output: vscode.Uri) {
  const adb = new ADB(target.device.id);
  const path = await adb.shell('pm', 'path', target.data.identifier);

  if (path.startsWith('package:')) {
    await adb.pull(path.substring(8).trimEnd(), output);
  } else {
    vscode.window.showErrorMessage(vscode.l10n.t('Failed to get package path: {0}', path));
  }
}

async function bagbak(target: AppItem, output: vscode.Uri) {
  const shellArgs: string[] = [];
  switch (target.device.type) {
    case DeviceType.Remote:
      shellArgs.push.apply(shellArgs, ['-H', target.device.id]);
      break;
    case DeviceType.USB:
      if (target.device.id !== 'usb') { shellArgs.push.apply(shellArgs, ['-D', target.device.id]); }
      break;
    default:
      vscode.window.showErrorMessage(vscode.l10n.t('Unsupported device type'));
      return;
  }

  shellArgs.push.apply(shellArgs, [target.data.identifier, '-o', output.fsPath]);

  const term = vscode.window.createTerminal({
    name: 'bagbak',
    shellPath: cmd('bagbak'),
    shellArgs,
  });

  return new Promise<void>((resolve, reject) => {
    vscode.window.onDidCloseTerminal((e) => {
      if (e === term) {
        if (term.exitStatus?.code === 0) {
          resolve();
        } else {
          reject(new Error(`bagbak exited with code ${term.exitStatus?.code}`));
        }
      }
    });

    term.show();
  });

}

```

`src/commands/objection.ts`:

```ts
import * as vscode from 'vscode';
import { l10n } from 'vscode';

import { launch } from '../driver/frida';
import { AppItem, ProcessItem, TargetItem } from "../providers/devices";
import { run } from '../term';
import { DeviceType } from '../types';
import { interpreter } from '../utils';

export async function explore(target: TargetItem) : Promise<void> {
  if (!target) {
    vscode.window.showErrorMessage(l10n.t('This command is only expected to be used in the context menu'));
    return;
  }

  if (!(target instanceof AppItem || target instanceof ProcessItem)) {
    vscode.window.showErrorMessage(l10n.t('This command is not applicable to the selected item'));
    return;
  }

  const name = `Objection - ${target.label}`;

  let device: string[];
  switch (target.device.type) {
    case DeviceType.TCP:
    case DeviceType.Remote:
      // todo: support remote connection
      device = ['-N', '-h', target.device.id];
      break;
    case DeviceType.Local:
      device = [];
      vscode.window.showErrorMessage(l10n.t('This command is not applicable to the local device'));
      return;
    case DeviceType.USB:
    default:
      device = [];
  }

  let { pid } = target.data;
  let gadget = pid.toString();
  if (target instanceof AppItem && !pid) {
    try {
      gadget = (await launch(target.device.id, target.data.identifier)).toString();
    } catch (e) {
      vscode.window.showWarningMessage(
        l10n.t('Warning: failed to launch App {0}\n{1}', target.data.identifier, `${e}`));
      gadget = target.data.name;
    }
  }

  const shellArgs = ['-m', 'objection.console.cli', '-g', gadget, ...device, 'explore'];
  const shellPath = await interpreter('objection');
  run({
    name,
    shellArgs,
    shellPath,
  });
}
```

`src/commands/print.ts`:

```ts
import { Uri, window } from "vscode";
import { rpc } from "../driver/backend";
import { TargetItem } from "../providers/devices";

interface Module {
  name: string;
  base: string;
  size: number;
  path: string;
};

type ClassesResult = string[];
type ModulesResult = Module[];

function create(name: string, content: string) {
  window.showTextDocument(Uri.parse(`untitled:${encodeURIComponent(name)}`)).then((editor) => {
    editor.edit((editBuilder) => {
      editBuilder.insert(editor.selection.active, content);
    });
  });
}

export function classes(target: TargetItem) {
  rpc(target, 'classes')
    .then((result: ClassesResult) => {
      const text = result.join('\n');
      create(`classes - ${target.label}.txt`, text);
    })
    .catch(err => window.showErrorMessage(err.message));
}

export function modules(target: TargetItem) {
  rpc(target, 'modules')
    .then((modules: ModulesResult) => {
      const text = modules.map(m => `${m.base} ${m.name} ${m.size} ${m.path}`).join('\n');
      create(`modules - ${target.label}.txt`, text);
    })
    .catch(err => window.showErrorMessage(err.message));
}

```

`src/commands/repl.ts`:

```ts
import * as path from 'path';
import * as vscode from 'vscode';

import { terminate } from '../driver/frida';
import { all, connect, disconnect } from '../driver/remote';
import { AppItem, DeviceItem, ProcessItem, TargetItem } from '../providers/devices';
import { DeviceType } from '../types';
import { expandDevParam, interpreter, refresh } from '../utils';

const terminals = new Set<vscode.Terminal>();

async function repl(args: string[], id: string) {
  const name = vscode.l10n.t('Frida - {0}', id);
  const shellPath = await interpreter();
  const py = path.join(__dirname, '..', '..', 'backend', 'pause.py');
  const shellArgs = [py, shellPath, '-m', 'frida_tools.repl', ...args];
  const term = vscode.window.createTerminal({
    name,
    shellPath,
    shellArgs,
    hideFromUser: true
  });
  term.show();
  terminals.add(term);
}

vscode.window.onDidCloseTerminal(t => terminals.delete(t));

export function spawn(node?: AppItem) {
  if (!node) { return; }

  repl(['-f', node.data.identifier, ...expandDevParam(node)], node.data.name);
  refresh();
}

export function spawnSuspended(node?: AppItem) {
  if (!node) { return; }

  repl(['-f', node.data.identifier, ...expandDevParam(node), '--pause'], node.data.name);
  refresh();
}

export function kill(node?: TargetItem) {
  if (!node) { return; }

  if ((node instanceof AppItem && node.data.pid) || node instanceof ProcessItem) {
    terminate(node.device.id, node.data.pid.toString());
    refresh();
  } else {
    vscode.window.showWarningMessage(vscode.l10n.t('Target is not running'));
  }
}

export function attach(node?: TargetItem) {
  if (!node) { return; }

  if (node instanceof AppItem || node instanceof ProcessItem) {
    if (!node.data.pid) {
      vscode.window.showErrorMessage(
        vscode.l10n.t('App "{0}" must be running before attaching to it', node.data.name));
    }

    repl([node.data.pid.toString(), ...expandDevParam(node)], node.data.pid.toString());
  }
}

export async function addRemote() {
  const host = await vscode.window.showInputBox({
    placeHolder: '192.168.1.2:27042',
    prompt: vscode.l10n.t('Host or IP of the remote device'),
    value: ''
  });

  if (typeof host !== 'string' || host.length === 0) {
    return;
  }

  connect(host);
  refresh();
}

export async function delRemote(node?: TargetItem) {
  if (!node) {
    const selected = await vscode.window.showQuickPick(all());
    if (typeof selected === 'string') {
      disconnect(selected);
    }
  } else if (node instanceof DeviceItem && node.data.type === DeviceType.Remote) {
    disconnect(node.data.id.substring('socket@'.length));
  }
  refresh();
}

```

`src/commands/ssh.ts`:

```ts
import { spawn } from 'child_process';
import { commands, window, l10n } from 'vscode';

import { os } from '../driver/backend';
import { DeviceItem, TargetItem } from '../providers/devices';
import { run } from '../term';
import { DeviceType } from '../types';
import { executable } from '../utils';


class PortNotFoundError extends Error { }
class ToolNotFoundError extends Error { }
class InvalidProtocolError extends Error { }

const nc = executable('inetcat');

async function findSSHPort(device: DeviceItem) {
  function validate(port: number, ...args: string[]): Promise<boolean> {
    const magic = Buffer.from('SSH-2.0-');
    return new Promise((resolve, reject) => {
      const inetcat = spawn(nc, [port.toString(), ...args]);
      inetcat
        .on('error', (err) => {
          if ((err as NodeJS.ErrnoException).code === 'ENOENT') {
            reject(new ToolNotFoundError(l10n.t('inetcat not found')));
          } else {
            reject(err);
          }
        })
        .on('close', (code) => {
          if (code !== 0) {
            reject(new InvalidProtocolError(l10n.t('inetcat exited with code {0}', `${code}`)));
          }
        });

      inetcat.stdout.once('data', (data) => {
        if (data.slice(0, magic.length).equals(magic)) {
          resolve(true);
        } else {
          reject(new InvalidProtocolError(l10n.t('Invalid protocol')));
        }
        inetcat.stdin.end();
      });
    });
  }

  const candidates = [22, 44];
  const args = ['-u', device.data.id];
  if (device.data.type === DeviceType.Remote) {
    args.push('-n');
  }

  for (const port of candidates) {
    try {
      if (await validate(port, ...args)) {
        return port;
      }
    } catch (err) {
      if (err instanceof ToolNotFoundError) { throw err; }
      console.error((err as Error).message);
    }
  }

  throw new PortNotFoundError(l10n.t('No valid SSH port found'));
}

export async function shell(node: TargetItem) {
  if (!(node instanceof DeviceItem)) {
    window.showErrorMessage(
      l10n.t('This command is only expected to be used in the context menu'));
    return;
  }

  if (node.data.id === 'local') {
    // execute command to open a new terminal
    commands.executeCommand('workbench.action.terminal.new');
    return;
  }

  const system = await os(node.data.id);
  const name = l10n.t('SSH: {0}', node.data.name);
  let shellPath, shellArgs;

  if (system === 'ios') {
    if (process.platform === 'win32') {
      window.showErrorMessage(
        l10n.t('This feature is not enabled on Windows due to lack of inetcat'));
      return
    }

    try {
      const port = await findSSHPort(node);
      shellPath = executable('ssh');
      shellArgs = [
        '-o', 'StrictHostKeyChecking=no',
        '-o', 'UserKnownHostsFile=/dev/null',
        '-o', `ProxyCommand='${nc}' 22`,
        `mobile@localhost`,  // todo: customize username
        '-p', port.toString()
      ];
    } catch (err) {
      if (err instanceof ToolNotFoundError) {
        window.showErrorMessage(l10n.t('inetcat command not present in $PATH'));
        return;
      } else if (err instanceof PortNotFoundError) {
        window.showErrorMessage(l10n.t('No valid SSH port found for device {0}', node.data.name));
        return;
      }
    }
  } else if (system === 'android') {
    // todo: use adb.ts
    shellPath = executable('adb');
    shellArgs = ['-s', node.data.id, 'shell'];
  } else {
    window.showErrorMessage(l10n.t("OS type {0} is not supported", system));
    return;
  }

  return run({
    name,
    shellArgs,
    shellPath,
    hideFromUser: true,
  });
}
```

`src/commands/syslog.ts`:

```ts
import * as cp from 'child_process';
import { l10n, OutputChannel, window } from 'vscode';

import { driverScript, lockdownSyslog, os } from '../driver/backend';
import { AppItem, ProcessItem, TargetItem } from "../providers/devices";
import { DeviceType } from '../types';
import { interpreter, refresh } from '../utils';

const active: { [key: string]: OutputChannel } = {};

export function vacuum() {
  for (const channel of Object.values(active)) {
    channel.dispose();
  }
}

export async function show(node: TargetItem) {
  function cmdChannel(name: string, bin: string, args: string[]) {
    if (name in active) {
      return active[name];
    }

    const channel = window.createOutputChannel(name);
    const child = cp.spawn(bin, args);
    const write = (data: Buffer) => channel.append(data.toString());
    child.stdout.on('data', write);
    child.stderr.on('data', write);

    const actionClose = l10n.t('Close Console');
    const actionIgnore = l10n.t('Dismiss');
    const question = l10n.t('Console {0} is already open, do you want to close it?', name);

    child.on('close', () =>
      window.showWarningMessage(
        question, actionClose, actionIgnore).then(option => {
          if (option === actionClose) {
            channel.dispose();
          }
          refresh();
        }));
    return channel;
  }

  let bundleOrPid: string[];
  if (node instanceof AppItem) {
    bundleOrPid = ['--app', node.data.identifier];
  } else if (node instanceof ProcessItem) {
    bundleOrPid = ['--pid', node.data.pid.toString()];
  } else {
    window.showErrorMessage(l10n.t('Invalid target {0}', `${node.label}`));
    return;
  }

  const type = await os(node.device.id);
  if (type === 'ios' && node.device.type === DeviceType.USB) {
    lockdownSyslog(node.device.id, bundleOrPid);
  } else if (type === 'linux' || type === 'macos') {
    const args = [driverScript(), 'syslog', '--device', node.device.id, ...bundleOrPid];
    const python3 = await interpreter();
    const title = l10n.t('Output: {0} ({1})', node.data.name, node.device.name);
    cmdChannel(title, python3, args).show();
  } else if (type === 'android') {
    if (node.data.pid > 0) {
      const args = ['-s', node.device.id, 'logcat', `--pid=${node.data.pid}`];
      const title = l10n.t('Output: {0} ({1})', node.data.name, node.device.name);
      cmdChannel(title, 'adb', args).show();
    } else {
      // todo: 
      // adb shell monkey -p BUNDLE 1
      // adb shell pidof BUNDLE
      window.showErrorMessage(l10n.t('{0} ({1}) is not running', node.data.name, node.device.name));
    }
  } else {
    window.showErrorMessage(l10n.t('Unsupported device type {0}', node.device.type));
  }
}
```

`src/commands/typing.ts`:

```ts
import { createWriteStream, promises as fsp } from 'fs';
import { get as httpGet } from 'https';
import { join } from 'path';
import { Position, ProgressLocation, window, workspace, l10n } from 'vscode';
import { cmd } from '../utils';

function npmInstall() {
  const name = l10n.t('Install typescript typings');
  const shellPath = cmd('npm');
  const shellArgs = ['install', '@types/frida-gum', '--save'];
  const term = window.createTerminal({
    name,
    shellPath,
    shellArgs,
  });
  window.onDidCloseTerminal(t => {
    if (t === term && t.exitStatus?.code === 0) {
      window.showInformationMessage(
        l10n.t('@types/frida-gum has been successfully installed'));
    }
  })
  term.show();
}

async function downloadTypeHint(cwd: string) {
  const URL = 'https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/frida-gum/index.d.ts';
  const NAME = 'frida-gum.d.ts';

  // will override existing one
  const dest = join(cwd, NAME);
  const stream = createWriteStream(dest);

  await window.withProgress({
    location: ProgressLocation.Notification,
    title: l10n.t("Downloading typing info for frida-gum"),
    cancellable: false,
  }, (progress, token) => {
    return new Promise<string>(resolve => {
      const req = httpGet(URL, resp => {
        const rawLen = resp.headers['content-length'];
        const len = rawLen ? parseInt(rawLen, 10) : NaN;
        resp.pipe(stream);

        if (rawLen) {
          resp.on('data', chunk =>
            progress.report({
              increment: chunk.length / len * 100
            })
          );
        }
      });

      req
        .on('finish', async () => {
          resolve(NAME);
        })
        .on('error', (err) => {
          stream.close();
          window.showErrorMessage(
            l10n.t('Failed to download typing info for frida-gum: {0}', err.message));
          fsp.unlink(dest);
        });
    });
  });

  return dest;
}


export async function init() {
  if (workspace.workspaceFolders?.length) {
    npmInstall();
    return;
  }

  const editor = window.activeTextEditor;
  if (!editor) {
    window.showErrorMessage(l10n.t('The command requires a workspace or an active document'));
    return;
  }

  const doc = editor.document;
  if (!['javascript', 'typescript'].includes(doc.languageId)) {
    window.showErrorMessage(l10n.t('This document is not Javascript or TypeScript'));
    return;
  }

  const fileUri = doc.uri;
  if (!fileUri) {
    window.showErrorMessage(l10n.t('The current document is unsaved'));
    return;
  }

  const folder = workspace.getWorkspaceFolder(fileUri);
  const cwd = folder ? folder.uri.fsPath : join(fileUri.fsPath, '..');
  const name = await downloadTypeHint(cwd);
  await editor.edit(e => {
    e.insert(new Position(0, 0), `/// <reference path="${name}" />\n`);
  });
  editor.document.save();
}

```

`src/driver/adb.ts`:

```ts
import * as cp from 'child_process';
import * as vscode from 'vscode';
import { run } from '../term';
import { executable } from "../utils";

export default class ADB {
  path: string;

  constructor(private device: string) {
    this.path = executable('adb');

    if (!this.path) {
      const msg = vscode.l10n.t('Could not find command adb in $PATH');
      vscode.window.showErrorMessage(msg);
      throw new Error(msg);
    }
  }

  async cmd(action: string, ...args: string[]) {
    const shellPath = this.path;
    const shellArgs = ['-s', this.device, action, ...args];
    return run({
      shellPath,
      shellArgs
    });
  }

  async push(local: vscode.Uri, remote: string) {
    return this.cmd('push', local.fsPath, remote);
  }

  async pull(remote: string, local: vscode.Uri) {
    return this.cmd('pull', remote, local.fsPath);
  }

  interactive(...cmd: string[]) {
    const name = 'adb';
    const shellPath = this.path;
    const shellArgs = ['-s', this.device, 'shell', ...cmd];
    const term = vscode.window.createTerminal({
      name,
      shellPath,
      shellArgs
    });
    term.show();
    return term;
  }

  async shell(...cmd: string[]) {
    const shellPath = this.path;
    const shellArgs = ['-s', this.device, 'shell', ...cmd];

    return new Promise<string>((resolve, reject) => {
      cp.execFile(shellPath, shellArgs, (err, stdout, stderr) => {
        if (err) {
          reject(err);
        } else {
          resolve(stdout);
        }
      });
    });
  }
}
```

`src/driver/backend.ts`:

```ts
import { l10n } from 'vscode';
import { join } from 'path';
import { execFile } from 'child_process';

import { asParam } from './remote';
import { logger } from '../logger';
import { run } from '../term';
import { interpreter } from '../utils';
import { App, Device, Process } from '../types';
import { AppItem, ProcessItem, TargetItem } from '../providers/devices';

const base = join(__dirname, '..', '..', 'backend');
const py = join(base, 'driver.py');

export const driverScript = () => py;

export function exec(...args: string[]): Promise<any> {
  const remoteDevices = asParam();

  return interpreter().then(path => new Promise((resolve, reject) => {
    execFile(path, [py, ...remoteDevices, ...args], { maxBuffer: 1024 * 1024 * 20 }, (err, stdout, stderr) => {
      if (err) {
        logger.appendLine(`Error: Failed to execute driver, arguments: ${args.join(' ')}`);
        logger.appendLine(stderr);
        logger.appendLine(`Exited with ${err.code}`);
        reject(new Error(stderr));
      } else {
        resolve(JSON.parse(stdout));
      }
    });
  }));
}

export function devices() {
  return exec('devices') as Promise<Device[]>;
}

export function apps(id: string) {
  return exec('apps', id) as Promise<App[]>;
}

export function ps(id: string) {
  return exec('ps', id) as Promise<Process[]>;
}

export async function os(id: string) {
  interface Result {
    os: {
      version: string;
      id: 'ios' | 'macos' | 'windows' | 'linux' | 'android';
      name: string;
    };
  };

  const result = await exec('info', id) as Result;
  return result.os.id;
}

export function location(id: string, bundle: string) {
  return exec('location', id, bundle);
}

export function rpc(target: TargetItem, method: string, ...args: string[]) {
  let bundleOrPid: string[];
  if (target instanceof AppItem) {
    bundleOrPid = ['--app', target.data.identifier];
  } else if (target instanceof ProcessItem) {
    bundleOrPid = ['--pid', target.data.pid.toString()];
  } else {
    throw new Error(l10n.t('Invalid target {0}', target));
  }

  return exec('rpc', '--device', target.device.id, ...bundleOrPid, method, ...args);
}

export async function lockdownSyslog(id: string, bundleOrPid: string[]) {
  const shellPath = await interpreter();
  return run({
    name: `Syslog: ${bundleOrPid}`,
    shellPath,
    shellArgs: [py, 'syslog2', '--device', id, ...bundleOrPid]
  });
}

```

`src/driver/frida.ts`:

```ts
import { l10n } from 'vscode';
import { execFile } from 'child_process';
import { interpreter } from '../utils';


function deviceParam(device: string) {
  const prefix = 'socket@';
  return device.startsWith(prefix) ?
    ['-H', device.substring(prefix.length)] :
    ['--device', device];
}

export async function launch(device: string, bundle: string): Promise<Number> {
  const params = ['-f', bundle, ...deviceParam(device), bundle, '-q', '-e', 'Process.id'];
  const py3 = await interpreter();
  const args = ['-m', 'frida_tools.repl', ...params];

  return new Promise((resolve, reject) => {
    execFile(py3, args, {}, (err, stdout) => {
      if (err) {
        reject(err);
      } else {
        const lines = stdout.split('\n');
        if (lines.length <= 2) {
            reject(new Error(l10n.t('Unknown output: {0}', stdout)));
        }
        resolve(parseInt(lines[1], 10));
      }
    });
  });
}

export async function terminate(device: string, target: string) {
  const py3 = await interpreter('frida-kill');
  const args = ['-m', 'frida_tools.kill', ...deviceParam(device), target];
  return new Promise((resolve, reject) => {
    execFile(py3, args, {}, (err, stdout) => {
      if (err) {
        reject(err);
      } else {
        resolve(stdout);
      }
    });
  });
}


```

`src/driver/remote.ts`:

```ts
import { workspace } from "vscode";

const remoteHosts = new Set<string>();
function loadRemoteHosts() {
  const hosts = workspace.getConfiguration('frida').get<Array<string>>('remoteHosts');
  if (Array.isArray(hosts)) {
    hosts.forEach(host => {
      if (typeof host === 'string') {
        remoteHosts.add(host);
      }
    });
  }
}

loadRemoteHosts();

function saveRemoteHosts() {
  workspace.getConfiguration('frida').update('remoteHosts', Array.from(remoteHosts), true);
}

export function connect(remote: string) {
  remoteHosts.add(remote);
  saveRemoteHosts();
}

export function disconnect(remote: string) {
  remoteHosts.delete(remote);
  saveRemoteHosts();
}

export function all() {
  return Array.from(remoteHosts);
}

export function asParam() {
  return remoteHosts.size > 0 ? ['--remote', Array.from(remoteHosts).join(',')] : []
}
```

`src/extension.ts`:

```ts
// The module 'vscode' contains the VS Code extensibility API
// Import the module and reference it with the alias vscode in your code below
import * as vscode from 'vscode';

import { DevicesProvider } from './providers/devices';
import { ProviderType } from './types';

import * as android from './commands/android';
import * as boilerplate from './commands/boilerplate';
import * as clipboard from './commands/clipboard';
import dump from './commands/dump';
import * as objection from './commands/objection';
import * as repl from './commands/repl';
import * as ssh from './commands/ssh';
import * as syslog from './commands/syslog';
import * as typing from './commands/typing';
import * as print from './commands/print';

export function activate(context: vscode.ExtensionContext) {
	const register = (cmd: string, cb: (...args: any[]) => any) => vscode.commands.registerCommand(cmd, cb);
	const push = (item: vscode.Disposable) => context.subscriptions.push(item);

	const appsProvider = new DevicesProvider(ProviderType.Apps);
	vscode.window.registerTreeDataProvider('fridaApps', appsProvider);

	push(register('frida.apps.refresh', () => appsProvider.refresh()));

	const psProvider = new DevicesProvider(ProviderType.Processes);
	vscode.window.registerTreeDataProvider('fridaPs', psProvider);

	push(register('frida.ps.refresh', () => psProvider.refresh()));
	push(register('frida.spawn', repl.spawn));
	push(register('frida.spawn.suspended', repl.spawnSuspended));
	push(register('frida.attach', repl.attach));
	push(register('frida.kill', repl.kill));
	push(register('frida.remote.add', repl.addRemote));
	push(register('frida.remote.remove', repl.delRemote));

	push(register('frida.syslog', syslog.show));
	push(register('frida.syslog.vacuum', syslog.vacuum));

	push(register('frida.bundle.copy', clipboard.copy));
	push(register('frida.name.copy', clipboard.copy));
	push(register('frida.pid.copy', clipboard.copyPid));
	push(register('frida.device.copy', clipboard.copy));
	
	push(register('frida.device.androidserver', android.startServer));
	push(register('frida.external.objection', objection.explore));
	push(register('frida.external.dump', dump));
	push(register('frida.external.apk', dump));

	push(register('frida.external.shell', ssh.shell));

	push(register('frida.boilerplate.agent', boilerplate.agent));
	push(register('frida.boilerplate.module', boilerplate.module));
	push(register('frida.debug.setup', boilerplate.debug));

	push(register('frida.typing.init', typing.init));

	push(register('frida.print.classes', print.classes));
	push(register('frida.print.modules', print.modules));
}

// this method is called when your extension is deactivated
export function deactivate() {

}

```

`src/logger.ts`:

```ts
import { window, l10n } from 'vscode';

export const logger = window.createOutputChannel(l10n.t('Frida Extension'));

```

`src/providers/devices.ts`:

```ts
import * as vscode from 'vscode';

import * as ipc from '../driver/backend';

import { resource } from '../utils';
import { ProviderType, App, Process, Device, DeviceType } from '../types';

export class DevicesProvider implements vscode.TreeDataProvider<TargetItem> {

  private _onDidChangeTreeData: vscode.EventEmitter<TargetItem | undefined> = new vscode.EventEmitter<TargetItem | undefined>();
  readonly onDidChangeTreeData: vscode.Event<TargetItem | undefined> = this._onDidChangeTreeData.event;

  constructor(
    public readonly type: ProviderType
  ) {

  }

  refresh(): void {
    this._onDidChangeTreeData.fire(undefined);
  }

  getTreeItem(element: TargetItem): vscode.TreeItem {
    return element;
  }

  getChildren(element?: TargetItem): Thenable<TargetItem[]> {
    if (element) {
      return element.children();
    } else {
      return ipc.devices().then(devices => devices.map(device => new DeviceItem(device, this.type)));
    }
  }
}

export abstract class TargetItem extends vscode.TreeItem {
  abstract children(): Thenable<TargetItem[]>;
  abstract tooltip?: string;
  abstract description?: string;
  abstract iconPath?: string | vscode.IconPath | undefined;
  abstract contextValue?: string | undefined;
}

export class DeviceItem extends TargetItem {
  constructor(
    public readonly data: Device,
    public readonly type: ProviderType,
  ) {
    super(data.name, vscode.TreeItemCollapsibleState.Collapsed);
  }

  get tooltip(): string {
    return `${this.data.id} (${this.data.type})`;
  }

  get description(): string {
    return this.data.id;
  }

  get iconPath() {
    return {
      light: resource('light', `${this.data.type}.svg`),
      dark: resource('dark', `${this.data.type}.svg`),
    };
  }

  children(): Thenable<TargetItem[]> {
    const device = this.data;
    if (this.type === ProviderType.Apps) {
      return ipc.apps(device.id)
        .then(apps => apps.map(app => new AppItem(app, device)))
        .catch(e => [new NotFound(e, device)]);
    } else if (this.type === ProviderType.Processes) {
      return ipc.ps(device.id)
        .then(ps => ps.map(p => new ProcessItem(p, device)))
        .catch(e => [new NotFound(e, device)]);
    }
    return Promise.resolve([]);
  }

  get contextValue() {
    const { type, os } = this.data;
    return `device|${type}|${os}`;
  }

}

enum AppState {
  Running = 'running',
  Dead = 'dead',
};

export class NotFound extends TargetItem {
  constructor(
    public readonly reason: Error,
    public readonly device: Device,
  ) {
    super(reason.message, vscode.TreeItemCollapsibleState.None);
  }

  children(): Thenable<TargetItem[]> {
    return Promise.resolve([]);
  }

  get tooltip() { return this.reason.message; }

  iconPath = {
    dark: resource('dark', 'error.svg'),
    light: resource('light', 'error.svg')
  };

  contextValue = 'empty';

  description = '';
}

export class AppItem extends TargetItem {
  constructor(
    public readonly data: App,
    public readonly device: Device,
  ) {
    super(data.name, vscode.TreeItemCollapsibleState.None);
  }

  get tooltip(): string {
    return `${this.label} (${this.data.pid || vscode.l10n.t('Not Running')})`;
  }

  get description(): string {
    return this.data.identifier;
  }

  children(): Thenable<TargetItem[]> {
    return Promise.resolve([]);
  }

  get iconPath() {
    return this.data.icon ? vscode.Uri.parse(this.data.icon) : resource('terminal.png');
  }

  get contextValue() {
    return `app|${this.data.pid ? AppState.Running : AppState.Dead}|${this.device.os}`;
  }
}

export class ProcessItem extends TargetItem {
  constructor(
    public readonly data: Process,
    public readonly device: Device,
  ) {
    super(data.name, vscode.TreeItemCollapsibleState.None);
  }

  get tooltip(): string {
    return `${this.label} (${this.data.pid})`;
  }

  get description(): string {
    return this.data.pid.toString();
  }

  children(): Thenable<TargetItem[]> {
    return Promise.resolve([]);
  }

  get iconPath() {
    return this.data.icon ? vscode.Uri.parse(this.data.icon) : resource('terminal.png');
  }

  get contextValue() {
    return `process|${this.data.pid ? AppState.Running : AppState.Dead}|${this.device.os}`;
  }
}
```

`src/shebang.ts`:

```ts
import { promises as fs } from 'node:fs';

const SHEBANG_UNIX = '#!';
const BUF_SHEBANG_UNIX = Buffer.from(SHEBANG_UNIX);
const PE_MAGIC = Buffer.from('MZ');

// const ZIP_SIGNATURE = Buffer.from([0x50, 0x4B, 0x05, 0x06]);

// typedef struct {
//   DWORD sig;
//   DWORD unused_disk_nos;
//   DWORD unused_numrecs;
//   DWORD cdsize;
//   DWORD cdoffset;
// } ENDCDR;

// https://github.com/pypa/distlib/blob/32301789a7815de0e74f57fe013ae52af717a3da/PC/launcher.c#L177
//
// the implementation is so cursed that we might as well simply search for #!

function parseWindowsLauncher(buffer: Buffer) {
  let subarray = buffer;

  while (true) {
    let p = subarray.lastIndexOf(BUF_SHEBANG_UNIX);
    if (p === -1) { throw new Error('Invalid shebang'); }

    const end = subarray.indexOf('\n', p);
    if (end === -1) { throw new Error('Invalid shebang'); }

    const line = subarray.subarray(p, end).toString().trim();
    if (line.endsWith('.exe')) {
      return interpreter(line);
    }

    subarray = subarray.subarray(end + 1);
  }
}

function interpreter(line: string) {
  if (!line.startsWith(SHEBANG_UNIX)) { throw new Error('Invalid shebang'); }
  return line.substring(SHEBANG_UNIX.length);
}

export default async function shebang(path: string) {
  const buffer = await fs.readFile(path);
  const magic = buffer.subarray(0, SHEBANG_UNIX.length);

  if (magic.compare(BUF_SHEBANG_UNIX) === 0) {
    const lineEnd = buffer.indexOf('\n');
    return interpreter(buffer.subarray(0, lineEnd).toString());
  } else if (magic.compare(PE_MAGIC) === 0) {
    return parseWindowsLauncher(buffer);
  }

  throw new Error('Invalid file format');
}


```

`src/term.ts`:

```ts
import { TerminalOptions, window } from "vscode";

export class CommandNotFoundError extends Error {
  constructor(cmd: string) {
    super(`Command not found: ${cmd}`);
  }
}

export function run(opt: TerminalOptions) {
  const ext: TerminalOptions = { hideFromUser: true };
  return new Promise<void>((resolve, reject) => {
    const term = window.createTerminal(Object.assign(opt, ext));

    const disposable = window.onDidCloseTerminal(terminal => {
      if (terminal !== term) { return; }

      if (term.exitStatus?.code === undefined && opt.shellPath) {
        reject(new CommandNotFoundError(opt.shellPath));
      } else if (term.exitStatus?.code !== 0) {
        reject(new Error(`Terminal exited with status ${term.exitStatus?.code}`));
      } else {
        resolve();
      }
      disposable.dispose();
    });
    term.show();
  });
}
```

`src/types.ts`:

```ts

export enum ProviderType {
  Apps = 'apps',
  Processes = 'ps',
}

export enum DeviceType {
  Local = 'local',
  Remote = 'remote',
  USB = 'usb',
  TCP = 'tcp', // legacy
}

export class Device {
  id: string = '';
  name: string = '';
  os: 'ios' | 'macos' | 'windows' | 'linux' | 'android' | 'n/a' = 'n/a';
  type: DeviceType = DeviceType.Local;
  icon: string = '';
}

export class App {
  identifier: string = '';
  name: string = '';
  pid: number = 0;
  icon: string = '';
}

export class Process {
  name: string = '';
  pid: number = 0;
  icon: string = '';
}
```

`src/utils.ts`:

```ts
import which from 'which';
import * as vscode from 'vscode';
import * as cp from 'child_process';
import { join } from 'path';
import { platform } from 'os';
import { DeviceType } from './types';
import { AppItem, ProcessItem } from './providers/devices';

import shebang from './shebang';

export function resource(...paths: string[]): vscode.Uri {
  const file = join(__dirname, '..', 'resources', ...paths);
  return vscode.Uri.file(file);
}

export function sleep(ms: number) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

export function refresh() {
  vscode.commands.executeCommand('frida.ps.refresh');
  vscode.commands.executeCommand('frida.apps.refresh');
}

export function cmd(name: string) {
  return name + (platform() === 'win32' ? '.cmd' : '');
}

export function executable(name: string) {
  return name + (platform() === 'win32' ? '.exe' : '');
}

interface PythonExtensionApi {
  settings: {
    getExecutionDetails(): { execCommand: string[] };
    get onDidChangeExecutionDetails(): vscode.Event<vscode.Uri | undefined>;
  };
}

async function virtualenv(): Promise<string> {
  const pyext = vscode.extensions.getExtension('ms-python.python');
  if (!pyext) {
    throw new Error(vscode.l10n.t('Python extension not found'));
  }

  const api = pyext.exports as PythonExtensionApi;
  const { execCommand } = api.settings.getExecutionDetails();
  if (!execCommand) {
    throw new Error(vscode.l10n.t('Python extension not activated'));
  }

  api.settings.onDidChangeExecutionDetails(() => {
    cache.clear();
  });

  const cmd = [...execCommand, '-c', 'import frida_tools;import sys;print(sys.executable)'];

  return new Promise((resolve, reject) => {
    cp.execFile(cmd[0], cmd.slice(1), {}, (err, stdout) => {
      if (err) {
        reject(err);
      } else {
        resolve(stdout.trim());
      }
    });
  });
}

const cache = new Map<string, string>();

export async function interpreter(cli = 'frida'): Promise<string> {
  if (cache.has(cli)) { return Promise.resolve(cache.get(cli) as string); }

  try {
    return await virtualenv();
  } catch (_) {
    // fallback to global package
  }

  const where = await which(cli, { all: false, nothrow: true });
  if (!where) {
    const msg = vscode.l10n.t('Could not find command {0} in $PATH, have you installed it or activated the correct venv?', cli);
    throw new Error(msg);
  }

  const path = await shebang(where);
  cache.set(cli, path);
  return path;
}

export function expandDevParam(node: AppItem | ProcessItem) {
  switch (node.device.type) {
    case DeviceType.Local:
      return [];
    case DeviceType.Remote:
      return ['-H', node.device.id.substring('socket@'.length)];
    case DeviceType.USB:
    // return ['-U'];
    default:
      return ['--device', node.device.id];
  }
}

```

`tsconfig.json`:

```json
{
	"compilerOptions": {
	"esModuleInterop": true,
    "experimentalDecorators": true,
		"module": "commonjs",
		"target": "es6",
		"outDir": "out",
		"lib": [
			"es6"
		],
		"sourceMap": true,
		"rootDir": "src",
		"strict": true   /* enable all strict type-checking options */
		/* Additional Checks */
		// "noImplicitReturns": true, /* Report error when not all code paths in function return a value. */
		// "noFallthroughCasesInSwitch": true, /* Report errors for fallthrough cases in switch statement. */
		// "noUnusedParameters": true,  /* Report errors on unused parameters. */
	},
	"exclude": [
		"node_modules",
		".vscode-test",
		"server",
		"agent"
	]
}

```

`tslint.json`:

```json
{
	"rules": {
		"no-string-throw": true,
		"no-unused-expression": true,
		"no-duplicate-variable": true,
		"curly": true,
		"class-name": true,
		"semicolon": [
			true,
			"always"
		],
		"triple-equals": true
	},
	"defaultSeverity": "warning"
}

```