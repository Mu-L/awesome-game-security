Directory structure:
└── gmh5225-gameengine-cryengine/
    ├── CMakeLists.txt
    ├── CMakeSettings.json
    └── Code/
        ├── CryEngine/
        │   ├── wscript
        │   ├── Cry3DEngine/
        │   │   ├── 3dEngine.cpp
        │   │   ├── 3dEngine.h
        │   │   ├── 3DEngineLight.cpp
        │   │   ├── 3dEngineLoad.cpp
        │   │   ├── 3dEngineLoad.h
        │   │   ├── 3DEngineMemory.cpp
        │   │   ├── 3DEngineMemory.h
        │   │   ├── 3DEngineRender.cpp
        │   │   ├── Array2d.h
        │   │   ├── BasicArea.cpp
        │   │   ├── BasicArea.h
        │   │   ├── BreakableGlassRenderNode.cpp
        │   │   ├── BreakableGlassRenderNode.h
        │   │   ├── BreezeGenerator.cpp
        │   │   ├── BreezeGenerator.h
        │   │   ├── Brush.cpp
        │   │   ├── Brush.h
        │   │   ├── CCullRenderer.cpp
        │   │   ├── CCullRenderer.h
        │   │   ├── CCullThread.cpp
        │   │   ├── CCullThread.h
        │   │   ├── ClipVolume.cpp
        │   │   ├── ClipVolume.h
        │   │   ├── ClipVolumeManager.cpp
        │   │   ├── ClipVolumeManager.h
        │   │   ├── CloudBlockerRenderNode.cpp
        │   │   ├── CloudBlockerRenderNode.h
        │   │   ├── CMakeLists.txt
        │   │   ├── ColorGradingCtrl.cpp
        │   │   ├── ColorGradingCtrl.h
        │   │   ├── Cry3DEngine.cpp
        │   │   ├── Cry3DEngine.rc
        │   │   ├── cry3dengine.waf_files
        │   │   ├── Cry3DEngineBase.h
        │   │   ├── cvars.cpp
        │   │   ├── cvars.h
        │   │   ├── Decal.cpp
        │   │   ├── DecalManager.cpp
        │   │   ├── DecalManager.h
        │   │   ├── DecalRenderNode.cpp
        │   │   ├── DecalRenderNode.h
        │   │   ├── DeferredCollisionEvent.cpp
        │   │   ├── DeferredCollisionEvent.h
        │   │   ├── DeformableNode.h
        │   │   ├── DistanceCloudRenderNode.cpp
        │   │   ├── DistanceCloudRenderNode.h
        │   │   ├── EnvironmentPreset.cpp
        │   │   ├── EnvironmentPreset.h
        │   │   ├── FogVolumeRenderNode.cpp
        │   │   ├── FogVolumeRenderNode.h
        │   │   ├── GeomCache.cpp
        │   │   ├── GeomCache.h
        │   │   ├── GeomCacheDecoder.cpp
        │   │   ├── GeomCacheDecoder.h
        │   │   ├── GeomCacheManager.cpp
        │   │   ├── GeomCacheManager.h
        │   │   ├── GeomCacheMeshManager.cpp
        │   │   ├── GeomCacheMeshManager.h
        │   │   ├── GeomCachePredictors.h
        │   │   ├── GeomCacheRenderNode.cpp
        │   │   ├── GeomCacheRenderNode.h
        │   │   ├── IndexedMesh.cpp
        │   │   ├── IndexedMesh.h
        │   │   ├── LightEntity.cpp
        │   │   ├── LightEntity.h
        │   │   ├── LightVolumeManager.cpp
        │   │   ├── LightVolumeManager.h
        │   │   ├── Material.cpp
        │   │   ├── Material.h
        │   │   ├── MaterialHelpers.cpp
        │   │   ├── MaterialHelpers.h
        │   │   ├── MatMan.cpp
        │   │   ├── MatMan.h
        │   │   ├── MergedMeshGeometry.cpp
        │   │   ├── MergedMeshGeometry.h
        │   │   ├── MergedMeshRenderNode.cpp
        │   │   ├── MergedMeshRenderNode.h
        │   │   ├── ObjectsTree.cpp
        │   │   ├── ObjectsTree.h
        │   │   ├── ObjectsTree_MT.cpp
        │   │   ├── ObjectsTree_Serialize.cpp
        │   │   ├── ObjectsTree_Serialize_info.h
        │   │   ├── ObjMan.cpp
        │   │   ├── ObjMan.h
        │   │   ├── ObjManDraw.cpp
        │   │   ├── ObjManDrawEntity.cpp
        │   │   ├── ObjManFar.cpp
        │   │   ├── ObjManShadows.cpp
        │   │   ├── ObjManStreaming.cpp
        │   │   ├── OpticsManager.cpp
        │   │   ├── OpticsManager.h
        │   │   ├── Particle.cpp
        │   │   ├── Particle.h
        │   │   ├── ParticleContainer.cpp
        │   │   ├── ParticleContainer.h
        │   │   ├── ParticleEffect.cpp
        │   │   ├── ParticleEffect.h
        │   │   ├── ParticleEmitter.cpp
        │   │   ├── ParticleEmitter.h
        │   │   ├── ParticleEnviron.cpp
        │   │   ├── ParticleEnviron.h
        │   │   ├── ParticleList.h
        │   │   ├── ParticleManager.cpp
        │   │   ├── ParticleManager.h
        │   │   ├── ParticleMemory.h
        │   │   ├── ParticleRender.cpp
        │   │   ├── ParticleSubEmitter.cpp
        │   │   ├── ParticleSubEmitter.h
        │   │   ├── ParticleUtils.h
        │   │   ├── PhysCallbacks.cpp
        │   │   ├── PhysCallbacks.h
        │   │   ├── PolygonClipContext.cpp
        │   │   ├── PolygonClipContext.h
        │   │   ├── PostProcessEffects.cpp
        │   │   ├── RenderMeshMerger.cpp
        │   │   ├── RenderMeshMerger.h
        │   │   ├── RenderMeshUtils.cpp
        │   │   ├── RenderMeshUtils.h
        │   │   ├── resource.h
        │   │   ├── RoadRenderNode.cpp
        │   │   ├── RoadRenderNode.h
        │   │   ├── RopeRenderNode.cpp
        │   │   ├── RopeRenderNode.h
        │   │   ├── ShadowCache.cpp
        │   │   ├── ShadowCache.h
        │   │   ├── SkyLightManager.cpp
        │   │   ├── SkyLightManager.h
        │   │   ├── SkyLightNishita.cpp
        │   │   ├── SkyLightNishita.h
        │   │   ├── SkyLightNishita_info.h
        │   │   ├── StatObj.h
        │   │   ├── StatObjConstr.cpp
        │   │   ├── StatObjFar.cpp
        │   │   ├── StatObjFoliage.cpp
        │   │   ├── StatObjFoliage.h
        │   │   ├── StatObjLoad.cpp
        │   │   ├── StatObjPhys.cpp
        │   │   ├── StatObjRend.cpp
        │   │   ├── StatObjStream.cpp
        │   │   ├── StdAfx.cpp
        │   │   ├── StdAfx.h
        │   │   ├── SurfaceTypeManager.cpp
        │   │   ├── SurfaceTypeManager.h
        │   │   ├── terrain.cpp
        │   │   ├── terrain.h
        │   │   ├── terrain_compile.cpp
        │   │   ├── terrain_compile_info.h
        │   │   ├── terrain_damage.cpp
        │   │   ├── terrain_det_tex.cpp
        │   │   ├── terrain_hmap.cpp
        │   │   ├── terrain_hmap_occlusion.cpp
        │   │   ├── terrain_init.cpp
        │   │   ├── terrain_light.cpp
        │   │   ├── terrain_load.cpp
        │   │   ├── terrain_node.cpp
        │   │   ├── terrain_node_compile.cpp
        │   │   ├── terrain_render.cpp
        │   │   ├── terrain_sector.cpp
        │   │   ├── terrain_sector.h
        │   │   ├── terrain_sector_beach.cpp
        │   │   ├── terrain_sector_info.h
        │   │   ├── terrain_sector_render.cpp
        │   │   ├── terrain_sector_tex.cpp
        │   │   ├── terrain_water.h
        │   │   ├── terrain_water_quad.cpp
        │   │   ├── TerrainModifications.cpp
        │   │   ├── TerrainModifications.h
        │   │   ├── TerrainTextureCache.cpp
        │   │   ├── terran_edit.cpp
        │   │   ├── TimeOfDay.cpp
        │   │   ├── TimeOfDay.h
        │   │   ├── TimeOfDayConstants.cpp
        │   │   ├── TimeOfDayConstants.h
        │   │   ├── Vegetation.cpp
        │   │   ├── Vegetation.h
        │   │   ├── VisAreaCompile.cpp
        │   │   ├── VisAreaCompile_info.h
        │   │   ├── VisAreaMan.cpp
        │   │   ├── VisAreaManCompile.cpp
        │   │   ├── VisAreas.cpp
        │   │   ├── VisAreas.h
        │   │   ├── VisibleRenderNodeManager.cpp
        │   │   ├── VisibleRenderNodeManager.h
        │   │   ├── VMath.hpp
        │   │   ├── VMath_C.hpp
        │   │   ├── VMath_NEON.hpp
        │   │   ├── VMath_Prototypes.hpp
        │   │   ├── VMath_SSE.hpp
        │   │   ├── WaterRippleManager.cpp
        │   │   ├── WaterRippleManager.h
        │   │   ├── WaterVolumeRenderNode.cpp
        │   │   ├── WaterVolumeRenderNode.h
        │   │   ├── WaterWaveRenderNode.cpp
        │   │   ├── WaterWaveRenderNode.h
        │   │   ├── wscript
        │   │   ├── CGF/
        │   │   │   ├── CGFLoader.cpp
        │   │   │   ├── CGFLoader.h
        │   │   │   ├── CGFSaver.cpp
        │   │   │   ├── CGFSaver.h
        │   │   │   ├── ChunkData.h
        │   │   │   ├── ChunkFile.cpp
        │   │   │   ├── ChunkFile.h
        │   │   │   ├── ChunkFileComponents.h
        │   │   │   ├── ChunkFileReaders.cpp
        │   │   │   ├── ChunkFileReaders.h
        │   │   │   ├── ChunkFileWriters.cpp
        │   │   │   ├── ChunkFileWriters.h
        │   │   │   ├── ReadOnlyChunkFile.cpp
        │   │   │   ├── ReadOnlyChunkFile.h
        │   │   │   ├── VClothSaver.cpp
        │   │   │   └── VClothSaver.h
        │   │   ├── MeshCompiler/
        │   │   │   ├── ForsythFaceReorderer.cpp
        │   │   │   ├── ForsythFaceReorderer.h
        │   │   │   ├── MeshCompiler.cpp
        │   │   │   ├── MeshCompiler.h
        │   │   │   ├── TangentSpaceCalculation.cpp
        │   │   │   ├── TangentSpaceCalculation.h
        │   │   │   └── TransformHelpers.h
        │   │   ├── ParticleSystem/
        │   │   │   ├── ParticleAttributes.cpp
        │   │   │   ├── ParticleAttributes.h
        │   │   │   ├── ParticleCommon.h
        │   │   │   ├── ParticleComponent.cpp
        │   │   │   ├── ParticleComponent.h
        │   │   │   ├── ParticleComponentRuntime.cpp
        │   │   │   ├── ParticleComponentRuntime.h
        │   │   │   ├── ParticleContainer.cpp
        │   │   │   ├── ParticleContainer.h
        │   │   │   ├── ParticleContainerImpl.h
        │   │   │   ├── ParticleConvert.cpp
        │   │   │   ├── ParticleDataStreams.h
        │   │   │   ├── ParticleDataStreamsImpl.h
        │   │   │   ├── ParticleDataStreamsImplSSE.h
        │   │   │   ├── ParticleDataTypes.h
        │   │   │   ├── ParticleDataTypesImpl.h
        │   │   │   ├── ParticleDebug.cpp
        │   │   │   ├── ParticleDebug.h
        │   │   │   ├── ParticleEffect.cpp
        │   │   │   ├── ParticleEffect.h
        │   │   │   ├── ParticleEmitter.cpp
        │   │   │   ├── ParticleEmitter.h
        │   │   │   ├── ParticleFeature.cpp
        │   │   │   ├── ParticleFeature.h
        │   │   │   ├── ParticleJobManager.cpp
        │   │   │   ├── ParticleJobManager.h
        │   │   │   ├── ParticleMath.h
        │   │   │   ├── ParticleMathImpl.h
        │   │   │   ├── ParticleMathImplSSE.h
        │   │   │   ├── ParticleProfiler.cpp
        │   │   │   ├── ParticleProfiler.h
        │   │   │   ├── ParticleProfilerImpl.h
        │   │   │   ├── ParticleRender.cpp
        │   │   │   ├── ParticleRender.h
        │   │   │   ├── ParticleRenderImpl.h
        │   │   │   ├── ParticleSpline.cpp
        │   │   │   ├── ParticleSpline.h
        │   │   │   ├── ParticleSplineImpl.h
        │   │   │   ├── ParticleSystem.cpp
        │   │   │   ├── ParticleSystem.h
        │   │   │   ├── ParticleSystemUnit.cpp
        │   │   │   └── Features/
        │   │   │       ├── Domain.cpp
        │   │   │       ├── Domain.h
        │   │   │       ├── DomainImpl.h
        │   │   │       ├── FeatureAngles.cpp
        │   │   │       ├── FeatureAngles.h
        │   │   │       ├── FeatureAnglesImpl.h
        │   │   │       ├── FeatureAppearance.cpp
        │   │   │       ├── FeatureAudio.cpp
        │   │   │       ├── FeatureChild.cpp
        │   │   │       ├── FeatureCollision.cpp
        │   │   │       ├── FeatureCollision.h
        │   │   │       ├── FeatureColor.cpp
        │   │   │       ├── FeatureColor.h
        │   │   │       ├── FeatureCommon.h
        │   │   │       ├── FeatureComponent.cpp
        │   │   │       ├── FeatureField.cpp
        │   │   │       ├── FeatureFluidDynamics.cpp
        │   │   │       ├── FeatureLife.cpp
        │   │   │       ├── FeatureLightSource.cpp
        │   │   │       ├── FeatureLocation.cpp
        │   │   │       ├── FeatureMotion.cpp
        │   │   │       ├── FeatureMotion.h
        │   │   │       ├── FeatureProject.cpp
        │   │   │       ├── FeatureRenderDecal.cpp
        │   │   │       ├── FeatureRenderGpuSprites.cpp
        │   │   │       ├── FeatureRenderMeshes.cpp
        │   │   │       ├── FeatureRenderRibbon.cpp
        │   │   │       ├── FeatureRenderSprites.cpp
        │   │   │       ├── FeatureSecondGen.cpp
        │   │   │       ├── FeatureSpawn.cpp
        │   │   │       ├── FeatureVelocity.cpp
        │   │   │       ├── Modifiers.cpp
        │   │   │       ├── MotionAffectors.cpp
        │   │   │       ├── ParamMod.h
        │   │   │       ├── ParamModImpl.h
        │   │   │       ├── ParamTraits.h
        │   │   │       ├── ParamTraitsImpl.h
        │   │   │       ├── Target.cpp
        │   │   │       ├── Target.h
        │   │   │       └── TargetImpl.h
        │   │   ├── RenderNodes/
        │   │   │   ├── CharacterRenderNode.cpp
        │   │   │   └── CharacterRenderNode.h
        │   │   └── SVO/
        │   │       ├── BlockPacker.cpp
        │   │       ├── BlockPacker.h
        │   │       ├── SceneTree.cpp
        │   │       ├── SceneTree.h
        │   │       ├── SceneTreeCVars.inl
        │   │       ├── SceneTreeManager.cpp
        │   │       ├── SceneTreeManager.h
        │   │       ├── VoxelSegment.cpp
        │   │       └── VoxelSegment.h
        │   ├── CryAction/
        │   │   ├── ActionFilter.cpp
        │   │   ├── ActionFilter.h
        │   │   ├── ActionGame.cpp
        │   │   ├── ActionGame.h
        │   │   ├── ActionMap.cpp
        │   │   ├── ActionMap.h
        │   │   ├── ActionMapManager.cpp
        │   │   ├── ActionMapManager.h
        │   │   ├── ActorSystem.cpp
        │   │   ├── ActorSystem.h
        │   │   ├── AIDebugRenderer.cpp
        │   │   ├── AIDebugRenderer.h
        │   │   ├── Analyst.cpp
        │   │   ├── Analyst.h
        │   │   ├── BreakableGlassSystem.cpp
        │   │   ├── BreakableGlassSystem.h
        │   │   ├── CallbackTimer.cpp
        │   │   ├── CallbackTimer.h
        │   │   ├── CMakeLists.txt
        │   │   ├── ColorGradientManager.cpp
        │   │   ├── ColorGradientManager_Test.cpp
        │   │   ├── CompositeData.h
        │   │   ├── CryAction.cpp
        │   │   ├── CryAction.h
        │   │   ├── CryAction.rc
        │   │   ├── cryaction.waf_files
        │   │   ├── CryAction_RMI.cpp
        │   │   ├── CryActionCVars.cpp
        │   │   ├── CryActionCVars.h
        │   │   ├── CryActionPhysicQueues.h
        │   │   ├── DelayedPlaneBreak.cpp
        │   │   ├── DelayedPlaneBreak.h
        │   │   ├── DevMode.cpp
        │   │   ├── DevMode.h
        │   │   ├── EntityTags.cpp
        │   │   ├── EquipmentManager.cpp
        │   │   ├── EquipmentManager.h
        │   │   ├── GameRulesSystem.cpp
        │   │   ├── GameRulesSystem.h
        │   │   ├── GameXmlParamReader.h
        │   │   ├── IActionMapManager.h
        │   │   ├── IActorSystem.h
        │   │   ├── IAnimatedCharacter.h
        │   │   ├── IAnimationGraph.h
        │   │   ├── ICheckPointSystem.h
        │   │   ├── ICooperativeAnimationManager.h
        │   │   ├── ICryMannequin.h
        │   │   ├── ICryMannequinDefs.h
        │   │   ├── ICryMannequinEditor.h
        │   │   ├── ICryMannequinProceduralClipFactory.h
        │   │   ├── ICryMannequinTagDefs.h
        │   │   ├── ICryMannequinUserParams.h
        │   │   ├── IEffectSystem.h
        │   │   ├── IForceFeedbackSystem.h
        │   │   ├── IGameObject.h
        │   │   ├── IGameObjectSystem.h
        │   │   ├── IGameplayRecorder.h
        │   │   ├── IGameRulesSystem.h
        │   │   ├── IGameSessionHandler.h
        │   │   ├── IInteractor.h
        │   │   ├── IItem.h
        │   │   ├── IItemSystem.h
        │   │   ├── ILevelSystem.h
        │   │   ├── ILoadGame.h
        │   │   ├── IMetadataRecorder.h
        │   │   ├── IMovementController.h
        │   │   ├── Inventory.cpp
        │   │   ├── Inventory.h
        │   │   ├── IPlayerProfiles.h
        │   │   ├── IRangeSignaling.h
        │   │   ├── ISaveGame.h
        │   │   ├── ISharedParamsManager.h
        │   │   ├── ISubtitleManager.h
        │   │   ├── ItemParams.cpp
        │   │   ├── ItemParams.h
        │   │   ├── ItemSystem.cpp
        │   │   ├── ItemSystem.h
        │   │   ├── IUIDraw.h
        │   │   ├── IVehicleSystem.h
        │   │   ├── IViewSystem.h
        │   │   ├── IWeapon.h
        │   │   ├── IWorldQuery.h
        │   │   ├── LevelSystem.cpp
        │   │   ├── LevelSystem.h
        │   │   ├── Main.cpp
        │   │   ├── PersistantDebug.cpp
        │   │   ├── PersistantDebug.h
        │   │   ├── resource.h
        │   │   ├── RuntimeAreas.cpp
        │   │   ├── RuntimeAreas.h
        │   │   ├── ScriptBind_Action.cpp
        │   │   ├── ScriptBind_Action.h
        │   │   ├── ScriptBind_ActionMapManager.cpp
        │   │   ├── ScriptBind_ActionMapManager.h
        │   │   ├── ScriptBind_ActorSystem.cpp
        │   │   ├── ScriptBind_ActorSystem.h
        │   │   ├── ScriptBind_Inventory.cpp
        │   │   ├── ScriptBind_Inventory.h
        │   │   ├── ScriptBind_ItemSystem.cpp
        │   │   ├── ScriptBind_ItemSystem.h
        │   │   ├── ScriptBind_VehicleSystem.cpp
        │   │   ├── ScriptBind_VehicleSystem.h
        │   │   ├── StdAfx.cpp
        │   │   ├── StdAfx.h
        │   │   ├── TimeOfDayScheduler.cpp
        │   │   ├── TimeOfDayScheduler.h
        │   │   ├── VehicleSystem.cpp
        │   │   ├── VehicleSystem.h
        │   │   ├── WrinkleMapRenderProxyCallback.cpp
        │   │   ├── WrinkleMapRenderProxyCallback.h
        │   │   ├── wscript
        │   │   ├── AI/
        │   │   │   ├── BehaviorTreeNodes_Action.cpp
        │   │   │   └── BehaviorTreeNodes_Action.h
        │   │   ├── Animation/
        │   │   │   ├── PoseAligner/
        │   │   │   │   ├── PoseAligner.cpp
        │   │   │   │   ├── PoseAligner.h
        │   │   │   │   └── PoseAlignerC3.cpp
        │   │   │   └── PoseModifier/
        │   │   │       ├── IKTorsoAim.cpp
        │   │   │       ├── IKTorsoAim.h
        │   │   │       ├── LookAtSimple.cpp
        │   │   │       └── LookAtSimple.h
        │   │   ├── AnimationGraph/
        │   │   │   ├── AnimatedCharacter.cpp
        │   │   │   ├── AnimatedCharacter.h
        │   │   │   ├── AnimatedCharacterEventProxies.cpp
        │   │   │   ├── AnimatedCharacterEventProxies.h
        │   │   │   ├── AnimatedCharacterPPS.cpp
        │   │   │   ├── AnimatedCharacterPPS_Common.cpp
        │   │   │   ├── AnimatedCharacterPPS_Debug.cpp
        │   │   │   ├── AnimatedCharacterPPS_ParamCalculation.cpp
        │   │   │   ├── AnimationGraphCVars.cpp
        │   │   │   ├── AnimationGraphCVars.h
        │   │   │   ├── AnimationTrigger.cpp
        │   │   │   ├── AnimationTrigger.h
        │   │   │   ├── DebugHistory.cpp
        │   │   │   └── DebugHistory.h
        │   │   ├── CheckPoint/
        │   │   │   ├── CheckPointSystem.cpp
        │   │   │   └── CheckPointSystem.h
        │   │   ├── CooperativeAnimationManager/
        │   │   │   ├── CooperativeAnimation.cpp
        │   │   │   ├── CooperativeAnimation.h
        │   │   │   ├── CooperativeAnimationManager.cpp
        │   │   │   └── CooperativeAnimationManager.h
        │   │   ├── CustomActions/
        │   │   │   ├── CustomAction.cpp
        │   │   │   ├── CustomAction.h
        │   │   │   ├── CustomActionManager.cpp
        │   │   │   └── CustomActionManager.h
        │   │   ├── CustomEvents/
        │   │   │   ├── CustomEventsManager.cpp
        │   │   │   └── CustomEventsManager.h
        │   │   ├── EffectSystem/
        │   │   │   ├── BloodSplats.cpp
        │   │   │   ├── BloodSplats.h
        │   │   │   ├── Effect.cpp
        │   │   │   ├── Effect.h
        │   │   │   ├── EffectSystem.cpp
        │   │   │   ├── EffectSystem.h
        │   │   │   ├── GroundEffect.cpp
        │   │   │   └── GroundEffect.h
        │   │   ├── EntityContainers/
        │   │   │   ├── EntityContainer.cpp
        │   │   │   ├── EntityContainer.h
        │   │   │   ├── EntityContainerMgr.cpp
        │   │   │   ├── EntityContainerMgr.h
        │   │   │   ├── EntityContainerObject.cpp
        │   │   │   ├── EntityContainerObject.h
        │   │   │   ├── FlowEntityContainerNodes.cpp
        │   │   │   └── IEntityContainerListener.h
        │   │   ├── FlashUI/
        │   │   │   ├── FlashUI.cpp
        │   │   │   ├── FlashUI.h
        │   │   │   ├── FlashUIAction.cpp
        │   │   │   ├── FlashUIAction.h
        │   │   │   ├── FlashUIActionEvents.cpp
        │   │   │   ├── FlashUIActionEvents.h
        │   │   │   ├── FlashUIActionNodes.cpp
        │   │   │   ├── FlashUIActionNodes.h
        │   │   │   ├── FlashUIArrayNodes.cpp
        │   │   │   ├── FlashUIArrayNodes.h
        │   │   │   ├── FlashUIBaseNode.cpp
        │   │   │   ├── FlashUIBaseNode.h
        │   │   │   ├── FlashUIDisplayNodes.cpp
        │   │   │   ├── FlashUIDisplayNodes.h
        │   │   │   ├── FlashUIElement.cpp
        │   │   │   ├── FlashUIElement.h
        │   │   │   ├── FlashUIElementNodes.cpp
        │   │   │   ├── FlashUIElementNodes.h
        │   │   │   ├── FlashUIEventNodes.cpp
        │   │   │   ├── FlashUIEventNodes.h
        │   │   │   ├── FlashUIEventSystem.cpp
        │   │   │   ├── FlashUIEventSystem.h
        │   │   │   ├── FlashUIFlowNodeFactory.h
        │   │   │   ├── FlashUIUtilNodes.cpp
        │   │   │   ├── FlashUIUtilNodes.h
        │   │   │   ├── ScriptBind_UIAction.cpp
        │   │   │   └── ScriptBind_UIAction.h
        │   │   ├── FlowSystem/
        │   │   │   └── Nodes/
        │   │   │       ├── FlowEngineCustomNodes.cpp
        │   │   │       ├── FlowEntityCustomNodes.cpp
        │   │   │       ├── FlowEntityCustomNodes.h
        │   │   │       ├── FlowGameNodes.cpp
        │   │   │       ├── FlowInventoryNodes.cpp
        │   │   │       ├── FlowOnlineStatsNodes.cpp
        │   │   │       └── FlowWeaponNodes.cpp
        │   │   ├── ForceFeedbackSystem/
        │   │   │   ├── ForceFeedbackSystem.cpp
        │   │   │   └── ForceFeedbackSystem.h
        │   │   ├── GameObjects/
        │   │   │   ├── GameObject.cpp
        │   │   │   ├── GameObject.h
        │   │   │   ├── GameObjectDispatch.cpp
        │   │   │   ├── GameObjectDispatch.h
        │   │   │   ├── GameObjectSystem.cpp
        │   │   │   ├── GameObjectSystem.h
        │   │   │   ├── GameObjectSystem_FactoryRegistration.cpp
        │   │   │   ├── Interactor.cpp
        │   │   │   ├── Interactor.h
        │   │   │   ├── MannequinObject.cpp
        │   │   │   ├── MannequinObject.h
        │   │   │   ├── RuntimeAreaObject.cpp
        │   │   │   ├── RuntimeAreaObject.h
        │   │   │   ├── WorldQuery.cpp
        │   │   │   └── WorldQuery.h
        │   │   ├── GameplayRecorder/
        │   │   │   ├── GameplayRecorder.cpp
        │   │   │   └── GameplayRecorder.h
        │   │   ├── GameSession/
        │   │   │   ├── GameSessionHandler.cpp
        │   │   │   └── GameSessionHandler.h
        │   │   ├── GameVolumes/
        │   │   │   ├── GameVolume_Water.cpp
        │   │   │   ├── GameVolume_Water.h
        │   │   │   ├── GameVolumesManager.cpp
        │   │   │   └── GameVolumesManager.h
        │   │   ├── LipSync/
        │   │   │   ├── LipSync_FacialInstance.cpp
        │   │   │   ├── LipSync_FacialInstance.h
        │   │   │   ├── LipSync_TransitionQueue.cpp
        │   │   │   └── LipSync_TransitionQueue.h
        │   │   ├── LivePreview/
        │   │   │   ├── RealtimeRemoteUpdate.cpp
        │   │   │   └── RealtimeRemoteUpdate.h
        │   │   ├── Mannequin/
        │   │   │   ├── ActionController.cpp
        │   │   │   ├── ActionController.h
        │   │   │   ├── ActionScope.cpp
        │   │   │   ├── ActionScope.h
        │   │   │   ├── AnimActionTriState.cpp
        │   │   │   ├── AnimActionTriState.h
        │   │   │   ├── AnimationDatabase.cpp
        │   │   │   ├── AnimationDatabase.h
        │   │   │   ├── AnimationDatabaseManager.cpp
        │   │   │   ├── AnimationDatabaseManager.h
        │   │   │   ├── FirstPersonHandIKContext.cpp
        │   │   │   ├── FirstPersonHandIKContext.h
        │   │   │   ├── FlowMannequinNodes.cpp
        │   │   │   ├── MannequinAGDefs.h
        │   │   │   ├── MannequinAGExistanceQuery.cpp
        │   │   │   ├── MannequinAGExistanceQuery.h
        │   │   │   ├── MannequinAGState.cpp
        │   │   │   ├── MannequinAGState.h
        │   │   │   ├── MannequinDebug.cpp
        │   │   │   ├── MannequinDebug.h
        │   │   │   ├── MannequinInterface.cpp
        │   │   │   ├── MannequinInterface.h
        │   │   │   ├── MannequinUtils.cpp
        │   │   │   ├── MannequinUtils.h
        │   │   │   ├── ProceduralClipAimAround.cpp
        │   │   │   ├── ProceduralClipAimPose.cpp
        │   │   │   ├── ProceduralClipAISignal.cpp
        │   │   │   ├── ProceduralClipAnimManipulation.cpp
        │   │   │   ├── ProceduralClipConversion.cpp
        │   │   │   ├── ProceduralClipConversion.h
        │   │   │   ├── ProceduralClipEvent.cpp
        │   │   │   ├── ProceduralClipFactory.cpp
        │   │   │   ├── ProceduralClipFactory.h
        │   │   │   ├── ProceduralClipForceFeedback.cpp
        │   │   │   ├── ProceduralClipLookAround.cpp
        │   │   │   ├── ProceduralClipLookPose.cpp
        │   │   │   ├── ProceduralClipParams.cpp
        │   │   │   ├── ProceduralClipParticleEffect.cpp
        │   │   │   ├── ProceduralClipPlaySound.cpp
        │   │   │   ├── ProceduralClipProps.cpp
        │   │   │   ├── ProceduralClipsPositioning.cpp
        │   │   │   ├── ProceduralClipsPositioning.h
        │   │   │   ├── ProceduralParamsComparer.cpp
        │   │   │   ├── Serialization.h
        │   │   │   ├── Tests/
        │   │   │   │   ├── Test_CRCRef.cpp
        │   │   │   │   └── Test_ProceduralParams.cpp
        │   │   │   └── Xml/
        │   │   │       ├── TagDefinitionXml.cpp
        │   │   │       └── TagDefinitionXml.h
        │   │   ├── MaterialEffects/
        │   │   │   ├── IMFXEffect.h
        │   │   │   ├── MaterialEffects.cpp
        │   │   │   ├── MaterialEffects.h
        │   │   │   ├── MaterialEffectsCVars.cpp
        │   │   │   ├── MaterialEffectsCVars.h
        │   │   │   ├── MaterialEffectsDebug.cpp
        │   │   │   ├── MaterialEffectsDebug.h
        │   │   │   ├── MaterialFGManager.cpp
        │   │   │   ├── MaterialFGManager.h
        │   │   │   ├── MaterialHUDFXNodes.cpp
        │   │   │   ├── MFXAudioEffect.cpp
        │   │   │   ├── MFXAudioEffect.h
        │   │   │   ├── MFXContainer.cpp
        │   │   │   ├── MFXContainer.h
        │   │   │   ├── MFXDecalEffect.cpp
        │   │   │   ├── MFXDecalEffect.h
        │   │   │   ├── MFXEffectBase.cpp
        │   │   │   ├── MFXEffectBase.h
        │   │   │   ├── MFXFlowGraphEffect.cpp
        │   │   │   ├── MFXFlowGraphEffect.h
        │   │   │   ├── MFXForceFeedbackFX.cpp
        │   │   │   ├── MFXForceFeedbackFX.h
        │   │   │   ├── MFXLibrary.cpp
        │   │   │   ├── MFXLibrary.h
        │   │   │   ├── MFXParticleEffect.cpp
        │   │   │   ├── MFXParticleEffect.h
        │   │   │   ├── MFXRandomEffect.cpp
        │   │   │   ├── MFXRandomEffect.h
        │   │   │   ├── ScriptBind_MaterialEffects.cpp
        │   │   │   ├── ScriptBind_MaterialEffects.h
        │   │   │   └── SurfacesLookupTable.h
        │   │   ├── MetadataRecorder/
        │   │   │   └── MetadataRecorder.cpp
        │   │   ├── Network/
        │   │   │   ├── BreakReplicator.cpp
        │   │   │   ├── BreakReplicator.h
        │   │   │   ├── BreakReplicator_Simple.cpp
        │   │   │   ├── BreakReplicator_Simple.h
        │   │   │   ├── BreakReplicatorGameObject.h
        │   │   │   ├── CET_ClassRegistry.cpp
        │   │   │   ├── CET_ClassRegistry.h
        │   │   │   ├── CET_ClientConnections.cpp
        │   │   │   ├── CET_ClientConnections.h
        │   │   │   ├── CET_CVars.cpp
        │   │   │   ├── CET_CVars.h
        │   │   │   ├── CET_EntitySystem.cpp
        │   │   │   ├── CET_EntitySystem.h
        │   │   │   ├── CET_GameRules.cpp
        │   │   │   ├── CET_GameRules.h
        │   │   │   ├── CET_LevelLoading.cpp
        │   │   │   ├── CET_LevelLoading.h
        │   │   │   ├── CET_NetConfig.cpp
        │   │   │   ├── CET_NetConfig.h
        │   │   │   ├── ClassRegistryReplicator.cpp
        │   │   │   ├── ClassRegistryReplicator.h
        │   │   │   ├── CVarListProcessor.cpp
        │   │   │   ├── CVarListProcessor.h
        │   │   │   ├── DebugBreakage.h
        │   │   │   ├── DeformingBreak.cpp
        │   │   │   ├── DeformingBreak.h
        │   │   │   ├── ExplosiveObjectState.cpp
        │   │   │   ├── ExplosiveObjectState.h
        │   │   │   ├── FlowNetMsgNodes.cpp
        │   │   │   ├── GameChannel.cpp
        │   │   │   ├── GameChannel.h
        │   │   │   ├── GameClientChannel.cpp
        │   │   │   ├── GameClientChannel.h
        │   │   │   ├── GameClientNub.cpp
        │   │   │   ├── GameClientNub.h
        │   │   │   ├── GameContext.cpp
        │   │   │   ├── GameContext.h
        │   │   │   ├── GameContext_RegisterExtensions.cpp
        │   │   │   ├── GameQueryListener.cpp
        │   │   │   ├── GameQueryListener.h
        │   │   │   ├── GameServerChannel.cpp
        │   │   │   ├── GameServerChannel.h
        │   │   │   ├── GameServerNub.cpp
        │   │   │   ├── GameServerNub.h
        │   │   │   ├── GameStats.cpp
        │   │   │   ├── GameStats.h
        │   │   │   ├── GameStatsConfig.cpp
        │   │   │   ├── GameStatsConfig.h
        │   │   │   ├── GenericPlaybackListener.cpp
        │   │   │   ├── GenericPlaybackListener.h
        │   │   │   ├── GenericRecordingListener.cpp
        │   │   │   ├── GenericRecordingListener.h
        │   │   │   ├── IBreakPlaybackStream.h
        │   │   │   ├── IBreakReplicatorListener.h
        │   │   │   ├── IContextEstablishTask.h
        │   │   │   ├── IProceduralBreakType.h
        │   │   │   ├── JointBreak.cpp
        │   │   │   ├── JointBreak.h
        │   │   │   ├── NetActionSync.h
        │   │   │   ├── NetDebug.cpp
        │   │   │   ├── NetDebug.h
        │   │   │   ├── NetMsgDispatcher.cpp
        │   │   │   ├── NetMsgDispatcher.h
        │   │   │   ├── NetworkCVars.cpp
        │   │   │   ├── NetworkCVars.h
        │   │   │   ├── NetworkStallTicker.cpp
        │   │   │   ├── NetworkStallTicker.h
        │   │   │   ├── NullListener.h
        │   │   │   ├── NullStream.h
        │   │   │   ├── ObjectSelector.cpp
        │   │   │   ├── ObjectSelector.h
        │   │   │   ├── PhysicsSync.cpp
        │   │   │   ├── PhysicsSync.h
        │   │   │   ├── PlaneBreak.cpp
        │   │   │   ├── PlaneBreak.h
        │   │   │   ├── ProceduralBreak.cpp
        │   │   │   ├── ProceduralBreak.h
        │   │   │   ├── ProceduralBreakingBaseListener.cpp
        │   │   │   ├── ProceduralBreakingBaseListener.h
        │   │   │   ├── ProceduralBreakingPlaybackListener.cpp
        │   │   │   ├── ProceduralBreakingPlaybackListener.h
        │   │   │   ├── ProceduralBreakingRecordingListener.cpp
        │   │   │   ├── ProceduralBreakingRecordingListener.h
        │   │   │   ├── ScriptBind_Network.cpp
        │   │   │   ├── ScriptBind_Network.h
        │   │   │   ├── ScriptRMI.cpp
        │   │   │   ├── ScriptRMI.h
        │   │   │   ├── ScriptSerialize.cpp
        │   │   │   ├── ScriptSerialize.h
        │   │   │   ├── SensedInclusionSet.h
        │   │   │   ├── SerializeBits.h
        │   │   │   ├── SerializeDirHelper.h
        │   │   │   ├── ServerTimer.cpp
        │   │   │   ├── ServerTimer.h
        │   │   │   ├── SimulateCreateEntityPart.h
        │   │   │   ├── SimulateRemoveEntityParts.cpp
        │   │   │   ├── SimulateRemoveEntityParts.h
        │   │   │   ├── VoiceController.cpp
        │   │   │   ├── VoiceController.h
        │   │   │   ├── VoiceListener.cpp
        │   │   │   └── VoiceListener.h
        │   │   ├── PlayerProfiles/
        │   │   │   ├── BMPHelper.cpp
        │   │   │   ├── BMPHelper.h
        │   │   │   ├── PlayerProfile.cpp
        │   │   │   ├── PlayerProfile.h
        │   │   │   ├── PlayerProfileImplConsole.cpp
        │   │   │   ├── PlayerProfileImplConsole.h
        │   │   │   ├── PlayerProfileImplFS.cpp
        │   │   │   ├── PlayerProfileImplFS.h
        │   │   │   ├── PlayerProfileImplNoSave.h
        │   │   │   ├── PlayerProfileImplRSFHelper.cpp
        │   │   │   ├── PlayerProfileImplRSFHelper.h
        │   │   │   ├── PlayerProfileManager.cpp
        │   │   │   ├── PlayerProfileManager.h
        │   │   │   ├── RichSaveGameTypes.h
        │   │   │   └── RichSaveGameTypes_info.h
        │   │   ├── RemoteControl/
        │   │   │   ├── RConClientListener.cpp
        │   │   │   ├── RConClientListener.h
        │   │   │   ├── RConServerListener.cpp
        │   │   │   └── RConServerListener.h
        │   │   ├── Serialization/
        │   │   │   ├── GameSerialize.cpp
        │   │   │   ├── GameSerialize.h
        │   │   │   ├── GameSerialize_FactoryRegistration.cpp
        │   │   │   ├── GameSerializeHelpers.h
        │   │   │   ├── SerializeReaderXMLCPBin.cpp
        │   │   │   ├── SerializeReaderXMLCPBin.h
        │   │   │   ├── SerializeScriptTableReader.cpp
        │   │   │   ├── SerializeScriptTableReader.h
        │   │   │   ├── SerializeScriptTableWriter.cpp
        │   │   │   ├── SerializeScriptTableWriter.h
        │   │   │   ├── SerializeWriterXMLCPBin.cpp
        │   │   │   ├── SerializeWriterXMLCPBin.h
        │   │   │   ├── XmlLoadGame.cpp
        │   │   │   ├── XmlLoadGame.h
        │   │   │   ├── XmlSaveGame.cpp
        │   │   │   ├── XmlSaveGame.h
        │   │   │   ├── XMLScriptLoader.cpp
        │   │   │   ├── XMLScriptLoader.h
        │   │   │   ├── XmlSerializeHelper.cpp
        │   │   │   ├── XmlSerializeHelper.h
        │   │   │   └── XMLCPBin/
        │   │   │       ├── BinarySerializeHelper.cpp
        │   │   │       ├── BinarySerializeHelper.h
        │   │   │       ├── XMLCPB_Common.cpp
        │   │   │       ├── XMLCPB_Common.h
        │   │   │       ├── XMLCPB_Utils.cpp
        │   │   │       ├── XMLCPB_Utils.h
        │   │   │       ├── Reader/
        │   │   │       │   ├── XMLCPB_AttrReader.cpp
        │   │   │       │   ├── XMLCPB_AttrReader.h
        │   │   │       │   ├── XMLCPB_AttrSetTableReader.cpp
        │   │   │       │   ├── XMLCPB_AttrSetTableReader.h
        │   │   │       │   ├── XMLCPB_BufferReader.cpp
        │   │   │       │   ├── XMLCPB_BufferReader.h
        │   │   │       │   ├── XMLCPB_NodeLiveReader.cpp
        │   │   │       │   ├── XMLCPB_NodeLiveReader.h
        │   │   │       │   ├── XMLCPB_Reader.cpp
        │   │   │       │   ├── XMLCPB_Reader.h
        │   │   │       │   ├── XMLCPB_ReaderInterface.h
        │   │   │       │   ├── XMLCPB_StringTableReader.cpp
        │   │   │       │   └── XMLCPB_StringTableReader.h
        │   │   │       └── Writer/
        │   │   │           ├── XMLCPB_AttrSetTableWriter.cpp
        │   │   │           ├── XMLCPB_AttrSetTableWriter.h
        │   │   │           ├── XMLCPB_AttrWriter.cpp
        │   │   │           ├── XMLCPB_AttrWriter.h
        │   │   │           ├── XMLCPB_BufferWriter.cpp
        │   │   │           ├── XMLCPB_BufferWriter.h
        │   │   │           ├── XMLCPB_NodeLiveWriter.cpp
        │   │   │           ├── XMLCPB_NodeLiveWriter.h
        │   │   │           ├── XMLCPB_StringTableWriter.cpp
        │   │   │           ├── XMLCPB_StringTableWriter.h
        │   │   │           ├── XMLCPB_Writer.cpp
        │   │   │           ├── XMLCPB_Writer.h
        │   │   │           ├── XMLCPB_WriterInterface.h
        │   │   │           ├── XMLCPB_ZLibCompressor.cpp
        │   │   │           └── XMLCPB_ZLibCompressor.h
        │   │   ├── SharedParams/
        │   │   │   ├── ISharedParams.h
        │   │   │   ├── SharedParamsManager.cpp
        │   │   │   ├── SharedParamsManager.h
        │   │   │   └── SharedParamsTypeInfo.h
        │   │   ├── SimpleHttpServer/
        │   │   │   ├── SimpleHttpServerListener.cpp
        │   │   │   ├── SimpleHttpServerListener.h
        │   │   │   ├── SimpleHttpServerWebsocketEchoListener.cpp
        │   │   │   └── SimpleHttpServerWebsocketEchoListener.h
        │   │   ├── Statistics/
        │   │   │   ├── GameStatistics.cpp
        │   │   │   ├── GameStatistics.h
        │   │   │   ├── ScriptBind_GameStatistics.cpp
        │   │   │   ├── ScriptBind_GameStatistics.h
        │   │   │   ├── StatisticsHelpers.cpp
        │   │   │   ├── StatisticsHelpers.h
        │   │   │   ├── StatsSizer.cpp
        │   │   │   └── StatsSizer.h
        │   │   ├── TestSystem/
        │   │   │   ├── IGameStateRecorder.h
        │   │   │   ├── ITestModule.h
        │   │   │   ├── TimeDemoRecorder.cpp
        │   │   │   └── TimeDemoRecorder.h
        │   │   ├── UIDraw/
        │   │   │   ├── UIDraw.cpp
        │   │   │   └── UIDraw.h
        │   │   ├── VehicleSystem/
        │   │   │   ├── ScriptBind_Vehicle.cpp
        │   │   │   ├── ScriptBind_Vehicle.h
        │   │   │   ├── ScriptBind_VehicleSeat.cpp
        │   │   │   ├── ScriptBind_VehicleSeat.h
        │   │   │   ├── Vehicle.cpp
        │   │   │   ├── Vehicle.h
        │   │   │   ├── VehicleAnimation.cpp
        │   │   │   ├── VehicleAnimation.h
        │   │   │   ├── VehicleComponent.cpp
        │   │   │   ├── VehicleComponent.h
        │   │   │   ├── VehicleCVars.cpp
        │   │   │   ├── VehicleCVars.h
        │   │   │   ├── VehicleDamageBehaviorAISignal.cpp
        │   │   │   ├── VehicleDamageBehaviorAISignal.h
        │   │   │   ├── VehicleDamageBehaviorDestroy.cpp
        │   │   │   ├── VehicleDamageBehaviorDestroy.h
        │   │   │   ├── VehicleDamageBehaviorDetachPart.cpp
        │   │   │   ├── VehicleDamageBehaviorDetachPart.h
        │   │   │   ├── VehicleDamageBehaviorDisableSeatAction.cpp
        │   │   │   ├── VehicleDamageBehaviorDisableSeatAction.h
        │   │   │   ├── VehicleDamageBehaviorEffect.cpp
        │   │   │   ├── VehicleDamageBehaviorEffect.h
        │   │   │   ├── VehicleDamageBehaviorGroup.cpp
        │   │   │   ├── VehicleDamageBehaviorGroup.h
        │   │   │   ├── VehicleDamageBehaviorHitPassenger.cpp
        │   │   │   ├── VehicleDamageBehaviorHitPassenger.h
        │   │   │   ├── VehicleDamageBehaviorImpulse.cpp
        │   │   │   ├── VehicleDamageBehaviorImpulse.h
        │   │   │   ├── VehicleDamageBehaviorIndicator.cpp
        │   │   │   ├── VehicleDamageBehaviorIndicator.h
        │   │   │   ├── VehicleDamageBehaviorMovementNotification.cpp
        │   │   │   ├── VehicleDamageBehaviorMovementNotification.h
        │   │   │   ├── VehicleDamageBehaviorSink.cpp
        │   │   │   ├── VehicleDamageBehaviorSink.h
        │   │   │   ├── VehicleDamageBehaviorSpawnDebris.cpp
        │   │   │   ├── VehicleDamageBehaviorSpawnDebris.h
        │   │   │   ├── VehicleDamages.cpp
        │   │   │   ├── VehicleDamages.h
        │   │   │   ├── VehicleDamagesGroup.cpp
        │   │   │   ├── VehicleDamagesGroup.h
        │   │   │   ├── VehicleDamagesTemplateRegistry.cpp
        │   │   │   ├── VehicleDamagesTemplateRegistry.h
        │   │   │   ├── VehicleHelper.cpp
        │   │   │   ├── VehicleHelper.h
        │   │   │   ├── VehicleModificationParams.cpp
        │   │   │   ├── VehicleModificationParams.h
        │   │   │   ├── VehicleNoiseGenerator.h
        │   │   │   ├── VehicleParams.h
        │   │   │   ├── VehiclePartAnimated.cpp
        │   │   │   ├── VehiclePartAnimated.h
        │   │   │   ├── VehiclePartAnimatedChar.cpp
        │   │   │   ├── VehiclePartAnimatedChar.h
        │   │   │   ├── VehiclePartAnimatedJoint.cpp
        │   │   │   ├── VehiclePartAnimatedJoint.h
        │   │   │   ├── VehiclePartAttachment.cpp
        │   │   │   ├── VehiclePartAttachment.h
        │   │   │   ├── VehiclePartBase.cpp
        │   │   │   ├── VehiclePartBase.h
        │   │   │   ├── VehiclePartDetachedEntity.cpp
        │   │   │   ├── VehiclePartDetachedEntity.h
        │   │   │   ├── VehiclePartEntity.cpp
        │   │   │   ├── VehiclePartEntity.h
        │   │   │   ├── VehiclePartEntityDelayedDetach.cpp
        │   │   │   ├── VehiclePartEntityDelayedDetach.h
        │   │   │   ├── VehiclePartLight.cpp
        │   │   │   ├── VehiclePartLight.h
        │   │   │   ├── VehiclePartMassBox.cpp
        │   │   │   ├── VehiclePartMassBox.h
        │   │   │   ├── VehiclePartParticleEffect.cpp
        │   │   │   ├── VehiclePartParticleEffect.h
        │   │   │   ├── VehiclePartPulsingLight.cpp
        │   │   │   ├── VehiclePartPulsingLight.h
        │   │   │   ├── VehiclePartStatic.cpp
        │   │   │   ├── VehiclePartStatic.h
        │   │   │   ├── VehiclePartSubPart.cpp
        │   │   │   ├── VehiclePartSubPart.h
        │   │   │   ├── VehiclePartSubPartWheel.cpp
        │   │   │   ├── VehiclePartSubPartWheel.h
        │   │   │   ├── VehiclePartSuspensionPart.cpp
        │   │   │   ├── VehiclePartSuspensionPart.h
        │   │   │   ├── VehiclePartTread.cpp
        │   │   │   ├── VehiclePartTread.h
        │   │   │   ├── VehiclePartWaterRipplesGenerator.cpp
        │   │   │   ├── VehiclePartWaterRipplesGenerator.h
        │   │   │   ├── VehicleSeat.cpp
        │   │   │   ├── VehicleSeat.h
        │   │   │   ├── VehicleSeatActionAnimation.cpp
        │   │   │   ├── VehicleSeatActionAnimation.h
        │   │   │   ├── VehicleSeatActionLights.cpp
        │   │   │   ├── VehicleSeatActionLights.h
        │   │   │   ├── VehicleSeatActionMovement.cpp
        │   │   │   ├── VehicleSeatActionMovement.h
        │   │   │   ├── VehicleSeatActionOrientateBoneToView.cpp
        │   │   │   ├── VehicleSeatActionOrientateBoneToView.h
        │   │   │   ├── VehicleSeatActionOrientatePartToView.cpp
        │   │   │   ├── VehicleSeatActionOrientatePartToView.h
        │   │   │   ├── VehicleSeatActionPassengerIK.cpp
        │   │   │   ├── VehicleSeatActionPassengerIK.h
        │   │   │   ├── VehicleSeatActionPassiveAnimation.cpp
        │   │   │   ├── VehicleSeatActionPassiveAnimation.h
        │   │   │   ├── VehicleSeatActionRotateBone.cpp
        │   │   │   ├── VehicleSeatActionRotateBone.h
        │   │   │   ├── VehicleSeatActionRotateTurret.cpp
        │   │   │   ├── VehicleSeatActionRotateTurret.h
        │   │   │   ├── VehicleSeatActionShakeParts.cpp
        │   │   │   ├── VehicleSeatActionShakeParts.h
        │   │   │   ├── VehicleSeatActionSteeringWheel.cpp
        │   │   │   ├── VehicleSeatActionSteeringWheel.h
        │   │   │   ├── VehicleSeatActionWeapons.cpp
        │   │   │   ├── VehicleSeatActionWeapons.h
        │   │   │   ├── VehicleSeatActionWeaponsBone.cpp
        │   │   │   ├── VehicleSeatActionWeaponsBone.h
        │   │   │   ├── VehicleSeatGroup.cpp
        │   │   │   ├── VehicleSeatGroup.h
        │   │   │   ├── VehicleSeatSerializer.cpp
        │   │   │   ├── VehicleSeatSerializer.h
        │   │   │   ├── VehicleSystem_FactoryRegistration.cpp
        │   │   │   ├── VehicleUsableActionEnter.cpp
        │   │   │   ├── VehicleUsableActionEnter.h
        │   │   │   ├── VehicleUsableActionFlip.cpp
        │   │   │   ├── VehicleUsableActionFlip.h
        │   │   │   ├── VehicleUtils.cpp
        │   │   │   ├── VehicleUtils.h
        │   │   │   ├── VehicleViewActionThirdPerson.cpp
        │   │   │   ├── VehicleViewActionThirdPerson.h
        │   │   │   ├── VehicleViewBase.cpp
        │   │   │   ├── VehicleViewBase.h
        │   │   │   ├── VehicleViewFirstPerson.cpp
        │   │   │   ├── VehicleViewFirstPerson.h
        │   │   │   ├── VehicleViewSteer.cpp
        │   │   │   ├── VehicleViewSteer.h
        │   │   │   ├── VehicleViewThirdPerson.cpp
        │   │   │   ├── VehicleViewThirdPerson.h
        │   │   │   ├── VehicleViewThirdPerson_Bone.cpp
        │   │   │   ├── VehicleViewThirdPerson_Bone.h
        │   │   │   ├── Animation/
        │   │   │   │   ├── VehicleAnimationComponent.cpp
        │   │   │   │   ├── VehicleAnimationComponent.h
        │   │   │   │   ├── VehicleSeatAnimActions.cpp
        │   │   │   │   └── VehicleSeatAnimActions.h
        │   │   │   └── FlowNodes/
        │   │   │       ├── FlowNodeAIHelicopter.cpp
        │   │   │       ├── FlowNodesAIActionSequence.cpp
        │   │   │       ├── FlowVehicleAI.cpp
        │   │   │       ├── FlowVehicleAttachment.cpp
        │   │   │       ├── FlowVehicleAttachment.h
        │   │   │       ├── FlowVehicleBase.cpp
        │   │   │       ├── FlowVehicleBase.h
        │   │   │       ├── FlowVehicleCamera.cpp
        │   │   │       ├── FlowVehicleDamage.cpp
        │   │   │       ├── FlowVehicleDamage.h
        │   │   │       ├── FlowVehicleHandbrake.cpp
        │   │   │       ├── FlowVehicleHandbrake.h
        │   │   │       ├── FlowVehicleHorn.cpp
        │   │   │       ├── FlowVehicleLights.cpp
        │   │   │       ├── FlowVehicleLights.h
        │   │   │       ├── FlowVehicleMoveActionMult.cpp
        │   │   │       ├── FlowVehicleMoveActionMult.h
        │   │   │       ├── FlowVehicleMovement.cpp
        │   │   │       ├── FlowVehicleMovement.h
        │   │   │       ├── FlowVehiclePassenger.cpp
        │   │   │       ├── FlowVehiclePassenger.h
        │   │   │       ├── FlowVehicleSeat.cpp
        │   │   │       ├── FlowVehicleSeat.h
        │   │   │       ├── FlowVehicleTurret.cpp
        │   │   │       └── FlowVehicleTurret.h
        │   │   └── ViewSystem/
        │   │       ├── View.cpp
        │   │       ├── View.h
        │   │       ├── ViewSystem.cpp
        │   │       └── ViewSystem.h
        │   ├── CryAISystem/
        │   │   ├── ActorLookUp.h
        │   │   ├── Adapters.cpp
        │   │   ├── Adapters.h
        │   │   ├── AIActions.cpp
        │   │   ├── AIActions.h
        │   │   ├── AIActor.cpp
        │   │   ├── AIActor.h
        │   │   ├── AICollision.cpp
        │   │   ├── AICollision.h
        │   │   ├── AIConsoleVariables.cpp
        │   │   ├── AIConsoleVariables.h
        │   │   ├── AIDbgRecorder.cpp
        │   │   ├── AIDbgRecorder.h
        │   │   ├── AIDebugDrawHelpers.cpp
        │   │   ├── AIDebugDrawHelpers.h
        │   │   ├── AIEntityComponent.cpp
        │   │   ├── AIEntityComponent.h
        │   │   ├── AIFlyingVehicle.cpp
        │   │   ├── AIFlyingVehicle.h
        │   │   ├── AIGroup.cpp
        │   │   ├── AIGroup.h
        │   │   ├── AIGroupConsoleVariables.cpp
        │   │   ├── AIGroupConsoleVariables.h
        │   │   ├── AIHash.h
        │   │   ├── AILegacyConsoleVariables.cpp
        │   │   ├── AILegacyConsoleVariables.h
        │   │   ├── AILightManager.cpp
        │   │   ├── AILightManager.h
        │   │   ├── AILog.cpp
        │   │   ├── AILog.h
        │   │   ├── AIMemStats.cpp
        │   │   ├── AIObject.cpp
        │   │   ├── AIObject.h
        │   │   ├── AIObjectIterators.h
        │   │   ├── AIObjectManager.cpp
        │   │   ├── AIObjectManager.h
        │   │   ├── AIPlayer.cpp
        │   │   ├── AIPlayer.h
        │   │   ├── AIQuadTree.h
        │   │   ├── AIQuadTree.inl
        │   │   ├── AIRadialOcclusion.cpp
        │   │   ├── AIRadialOcclusion.h
        │   │   ├── AIRecorder.cpp
        │   │   ├── AIRecorder.h
        │   │   ├── AISignal.cpp
        │   │   ├── AISignal.h
        │   │   ├── AIVehicle.cpp
        │   │   ├── AIVehicle.h
        │   │   ├── BlackBoard.cpp
        │   │   ├── BlackBoard.h
        │   │   ├── CAISystem.cpp
        │   │   ├── CAISystem.h
        │   │   ├── CAISystemPhys.cpp
        │   │   ├── CAISystemUpdate.cpp
        │   │   ├── CentralInterestManager.cpp
        │   │   ├── CentralInterestManager.h
        │   │   ├── ClusterDetector.cpp
        │   │   ├── ClusterDetector.h
        │   │   ├── ClusterRequest.cpp
        │   │   ├── CMakeLists.txt
        │   │   ├── Configuration.h
        │   │   ├── CryAISystem.cpp
        │   │   ├── CryAISystem.h
        │   │   ├── CryAISystem.rc
        │   │   ├── cryaisystem.waf_files
        │   │   ├── CSignal.cpp
        │   │   ├── CSignal.h
        │   │   ├── DebugDraw.cpp
        │   │   ├── DebugDrawConsoleVariables.cpp
        │   │   ├── DebugDrawConsoleVariables.h
        │   │   ├── DebugDrawContext.h
        │   │   ├── EnterLeaveUpdateGoalOp.h
        │   │   ├── Environment.cpp
        │   │   ├── Environment.h
        │   │   ├── FireCommand.cpp
        │   │   ├── FireCommand.h
        │   │   ├── GenericAStarSolver.h
        │   │   ├── GlobalPerceptionScaleHandler.cpp
        │   │   ├── GlobalPerceptionScaleHandler.h
        │   │   ├── GoalOp.cpp
        │   │   ├── GoalOp.h
        │   │   ├── GoalOpFactory.cpp
        │   │   ├── GoalOpFactory.h
        │   │   ├── GoalOpStick.cpp
        │   │   ├── GoalOpStick.h
        │   │   ├── GoalOpTrace.cpp
        │   │   ├── GoalOpTrace.h
        │   │   ├── GoalPipe.cpp
        │   │   ├── GoalPipe.h
        │   │   ├── GoalPipeXMLReader.cpp
        │   │   ├── GoalPipeXMLReader.h
        │   │   ├── GraphUtility.cpp
        │   │   ├── HashSpace.h
        │   │   ├── Leader.cpp
        │   │   ├── Leader.h
        │   │   ├── LeaderAction.cpp
        │   │   ├── LeaderAction.h
        │   │   ├── MissLocationSensor.cpp
        │   │   ├── MissLocationSensor.h
        │   │   ├── MNMPathfinder.cpp
        │   │   ├── MNMPathfinder.h
        │   │   ├── MNMPathfinderConsoleVariables.cpp
        │   │   ├── MNMPathfinderConsoleVariables.h
        │   │   ├── Navigation.cpp
        │   │   ├── Navigation.h
        │   │   ├── NavPath.cpp
        │   │   ├── NavPath.h
        │   │   ├── NullAIDebugRenderer.h
        │   │   ├── ObjectContainer.cpp
        │   │   ├── ObjectContainer.h
        │   │   ├── PathfinderNavigationSystemUser.h
        │   │   ├── PathFollower.cpp
        │   │   ├── PathFollower.h
        │   │   ├── PathFollowerConsoleVariables.cpp
        │   │   ├── PathFollowerConsoleVariables.h
        │   │   ├── PathMarker.cpp
        │   │   ├── PathMarker.h
        │   │   ├── PathObstacles.cpp
        │   │   ├── PathObstacles.h
        │   │   ├── PersonalInterestManager.cpp
        │   │   ├── PersonalInterestManager.h
        │   │   ├── PersonalLog.cpp
        │   │   ├── PersonalLog.h
        │   │   ├── PipeManager.cpp
        │   │   ├── PipeManager.h
        │   │   ├── PipeUser.cpp
        │   │   ├── PipeUser.h
        │   │   ├── PipeUserMovementActorAdapter.cpp
        │   │   ├── PipeUserMovementActorAdapter.h
        │   │   ├── PostureManager.cpp
        │   │   ├── PostureManager.h
        │   │   ├── Puppet.cpp
        │   │   ├── Puppet.h
        │   │   ├── PuppetConsoleVariables.cpp
        │   │   ├── PuppetConsoleVariables.h
        │   │   ├── PuppetPhys.cpp
        │   │   ├── PuppetRateOfDeath.cpp
        │   │   ├── PuppetRateOfDeathConsoleVariables.cpp
        │   │   ├── PuppetRateOfDeathConsoleVariables.h
        │   │   ├── Reference.h
        │   │   ├── Reference.inl
        │   │   ├── resource.h
        │   │   ├── ScriptBind_AI.h
        │   │   ├── Shape.cpp
        │   │   ├── Shape.h
        │   │   ├── Shape2.cpp
        │   │   ├── Shape2.h
        │   │   ├── ShapeContainer.h
        │   │   ├── SmartObjectOffMeshNavigation.cpp
        │   │   ├── SmartObjectOffMeshNavigation.h
        │   │   ├── SmartObjects.cpp
        │   │   ├── SmartObjects.h
        │   │   ├── SmartObjectsConsoleVariables.cpp
        │   │   ├── SmartObjectsConsoleVariables.h
        │   │   ├── SmartPathFollower.cpp
        │   │   ├── SmartPathFollower.h
        │   │   ├── StatsManager.cpp
        │   │   ├── StatsManager.h
        │   │   ├── StdAfx.cpp
        │   │   ├── StdAfx.h
        │   │   ├── UnitAction.cpp
        │   │   ├── UnitAction.h
        │   │   ├── UnitImg.cpp
        │   │   ├── UnitImg.h
        │   │   ├── VisionMap.cpp
        │   │   ├── VisionMap.h
        │   │   ├── VisionMapConsoleVariables.cpp
        │   │   ├── VisionMapConsoleVariables.h
        │   │   ├── WorldOctree.h
        │   │   ├── wscript
        │   │   ├── XMLUtils.h
        │   │   ├── AIBubblesSystem/
        │   │   │   ├── AIBubblesSystem.h
        │   │   │   ├── AIBubblesSystemConsoleVariables.cpp
        │   │   │   ├── AIBubblesSystemConsoleVariables.h
        │   │   │   ├── AIBubblesSystemImpl.cpp
        │   │   │   └── AIBubblesSystemImpl.h
        │   │   ├── AIObject/
        │   │   │   └── PipeUserMovement/
        │   │   │       ├── MovementBlock_InstallPipeUserInCover.h
        │   │   │       ├── MovementBlock_SetupPipeUserCoverInformation.cpp
        │   │   │       ├── MovementBlock_SetupPipeUserCoverInformation.h
        │   │   │       └── MovementBlock_UninstallPipeUserFromCover.h
        │   │   ├── AuditionMap/
        │   │   │   ├── AuditionMap.cpp
        │   │   │   ├── AuditionMap.h
        │   │   │   ├── AuditionMapDefinitions.h
        │   │   │   ├── AuditionMapItemPool.h
        │   │   │   ├── AuditionMapRayCastManager.cpp
        │   │   │   └── AuditionMapRayCastManager.h
        │   │   ├── BehaviorTree/
        │   │   │   ├── BehaviorTreeConsoleVariables.cpp
        │   │   │   ├── BehaviorTreeConsoleVariables.h
        │   │   │   ├── BehaviorTreeManager.cpp
        │   │   │   ├── BehaviorTreeManager.h
        │   │   │   ├── BehaviorTreeMetaExtensions.cpp
        │   │   │   ├── BehaviorTreeMetaExtensions.h
        │   │   │   ├── BehaviorTreeNodeRegistration.cpp
        │   │   │   ├── BehaviorTreeNodeRegistration.h
        │   │   │   ├── BehaviorTreeNodes_AI.cpp
        │   │   │   ├── BehaviorTreeNodes_AI.h
        │   │   │   ├── BehaviorTreeNodes_Core.cpp
        │   │   │   ├── BehaviorTreeNodes_Core.h
        │   │   │   ├── ExecutionStackFileLogger.cpp
        │   │   │   ├── ExecutionStackFileLogger.h
        │   │   │   ├── TreeVisualizer.cpp
        │   │   │   └── TreeVisualizer.h
        │   │   ├── CollisionAvoidance/
        │   │   │   ├── CollisionAvoidanceConsoleVariables.cpp
        │   │   │   ├── CollisionAvoidanceConsoleVariables.h
        │   │   │   ├── CollisionAvoidanceSystem.cpp
        │   │   │   └── CollisionAvoidanceSystem.h
        │   │   ├── Communication/
        │   │   │   ├── Communication.h
        │   │   │   ├── CommunicationChannel.cpp
        │   │   │   ├── CommunicationChannel.h
        │   │   │   ├── CommunicationChannelManager.cpp
        │   │   │   ├── CommunicationChannelManager.h
        │   │   │   ├── CommunicationConsoleVariables.cpp
        │   │   │   ├── CommunicationConsoleVariables.h
        │   │   │   ├── CommunicationManager.cpp
        │   │   │   ├── CommunicationManager.h
        │   │   │   ├── CommunicationPlayer.cpp
        │   │   │   ├── CommunicationPlayer.h
        │   │   │   ├── CommunicationTestManager.cpp
        │   │   │   └── CommunicationTestManager.h
        │   │   ├── Components/
        │   │   │   ├── BehaviorTree/
        │   │   │   │   ├── BehaviorTreeComponent.cpp
        │   │   │   │   ├── BehaviorTreeComponent.h
        │   │   │   │   ├── BehaviorTreeNodes_Basic.cpp
        │   │   │   │   └── BehaviorTreeNodes_Basic.h
        │   │   │   ├── Cover/
        │   │   │   │   ├── CoverMovementBlocks.cpp
        │   │   │   │   ├── CoverMovementBlocks.h
        │   │   │   │   ├── CoverUserComponent.cpp
        │   │   │   │   └── CoverUserComponent.h
        │   │   │   ├── Factions/
        │   │   │   │   ├── FactionComponent.cpp
        │   │   │   │   └── FactionComponent.h
        │   │   │   ├── Navigation/
        │   │   │   │   ├── CollisionAvoidanceAgent.cpp
        │   │   │   │   ├── CollisionAvoidanceAgent.h
        │   │   │   │   ├── MovementActorAdapter.cpp
        │   │   │   │   ├── MovementActorAdapter.h
        │   │   │   │   ├── NavigationComponent.cpp
        │   │   │   │   ├── NavigationComponent.h
        │   │   │   │   ├── NavigationMarkupShapeComponent.cpp
        │   │   │   │   └── NavigationMarkupShapeComponent.h
        │   │   │   └── Perception/
        │   │   │       ├── ListenerComponent.cpp
        │   │   │       ├── ListenerComponent.h
        │   │   │       ├── ObservableComponent.cpp
        │   │   │       ├── ObservableComponent.h
        │   │   │       ├── ObserverComponent.cpp
        │   │   │       ├── ObserverComponent.h
        │   │   │       ├── PerceptionComponentHelpers.cpp
        │   │   │       └── PerceptionComponentHelpers.h
        │   │   ├── Cover/
        │   │   │   ├── Cover.h
        │   │   │   ├── CoverPath.cpp
        │   │   │   ├── CoverPath.h
        │   │   │   ├── CoverSampler.cpp
        │   │   │   ├── CoverSampler.h
        │   │   │   ├── CoverScorer.cpp
        │   │   │   ├── CoverScorer.h
        │   │   │   ├── CoverSurface.cpp
        │   │   │   ├── CoverSurface.h
        │   │   │   ├── CoverSystem.cpp
        │   │   │   ├── CoverSystem.h
        │   │   │   ├── CoverSystemConsoleVariables.cpp
        │   │   │   ├── CoverSystemConsoleVariables.h
        │   │   │   ├── CoverSystemSchematyc.cpp
        │   │   │   ├── CoverSystemSchematyc.h
        │   │   │   ├── CoverUser.cpp
        │   │   │   ├── CoverUser.h
        │   │   │   ├── DynamicCoverManager.cpp
        │   │   │   ├── DynamicCoverManager.h
        │   │   │   ├── EntityCoverSampler.cpp
        │   │   │   └── EntityCoverSampler.h
        │   │   ├── Factions/
        │   │   │   ├── FactionMap.cpp
        │   │   │   ├── FactionMap.h
        │   │   │   ├── FactionSystem.cpp
        │   │   │   ├── FactionSystem.h
        │   │   │   ├── FactionSystemSchematyc.cpp
        │   │   │   └── FactionSystemSchematyc.h
        │   │   ├── Formation/
        │   │   │   ├── AIFormationDescriptor.h
        │   │   │   ├── Formation.cpp
        │   │   │   ├── Formation.h
        │   │   │   ├── FormationConsoleVariables.cpp
        │   │   │   ├── FormationConsoleVariables.h
        │   │   │   ├── FormationManager.cpp
        │   │   │   └── FormationManager.h
        │   │   ├── GameSpecific/
        │   │   │   ├── GoalOp_Crysis2.cpp
        │   │   │   ├── GoalOp_Crysis2.h
        │   │   │   ├── GoalOp_G02.cpp
        │   │   │   ├── GoalOp_G02.h
        │   │   │   ├── GoalOp_G04.cpp
        │   │   │   └── GoalOp_G04.h
        │   │   ├── GoalOps/
        │   │   │   ├── ShootOp.cpp
        │   │   │   ├── ShootOp.h
        │   │   │   ├── TeleportOp.cpp
        │   │   │   └── TeleportOp.h
        │   │   ├── Group/
        │   │   │   ├── Group.cpp
        │   │   │   ├── Group.h
        │   │   │   ├── GroupManager.cpp
        │   │   │   └── GroupManager.h
        │   │   ├── Mannequin/
        │   │   │   ├── MannequinGoalOp.cpp
        │   │   │   └── MannequinGoalOp.h
        │   │   ├── Movement/
        │   │   │   ├── Readme.txt
        │   │   │   ├── MovementActor.cpp
        │   │   │   ├── MovementActor.h
        │   │   │   ├── MovementBlock_DefaultEmpty.h
        │   │   │   ├── MovementBlock_FollowPath.cpp
        │   │   │   ├── MovementBlock_FollowPath.h
        │   │   │   ├── MovementBlock_HarshStop.cpp
        │   │   │   ├── MovementBlock_HarshStop.h
        │   │   │   ├── MovementBlock_TurnTowardsPosition.cpp
        │   │   │   ├── MovementBlock_TurnTowardsPosition.h
        │   │   │   ├── MovementBlock_UseExactPositioning.cpp
        │   │   │   ├── MovementBlock_UseExactPositioning.h
        │   │   │   ├── MovementBlock_UseExactPositioningBase.cpp
        │   │   │   ├── MovementBlock_UseExactPositioningBase.h
        │   │   │   ├── MovementBlock_UseSmartObject.cpp
        │   │   │   ├── MovementBlock_UseSmartObject.h
        │   │   │   ├── MovementConsoleVariables.cpp
        │   │   │   ├── MovementConsoleVariables.h
        │   │   │   ├── MovementHelpers.cpp
        │   │   │   ├── MovementHelpers.h
        │   │   │   ├── MovementPlan.cpp
        │   │   │   ├── MovementPlan.h
        │   │   │   ├── MovementPlanner.cpp
        │   │   │   ├── MovementPlanner.h
        │   │   │   ├── MovementSystem.cpp
        │   │   │   ├── MovementSystem.h
        │   │   │   ├── MovementSystemCreator.cpp
        │   │   │   ├── MovementSystemCreator.h
        │   │   │   ├── MoveOp.cpp
        │   │   │   └── MoveOp.h
        │   │   ├── Navigation/
        │   │   │   ├── NavigationSystemSchematyc.cpp
        │   │   │   ├── NavigationSystemSchematyc.h
        │   │   │   ├── PathHolder.h
        │   │   │   ├── MNM/
        │   │   │   │   ├── AgentSettings.h
        │   │   │   │   ├── BoundingVolume.cpp
        │   │   │   │   ├── BoundingVolume.h
        │   │   │   │   ├── CompactSpanGrid.cpp
        │   │   │   │   ├── CompactSpanGrid.h
        │   │   │   │   ├── DangerousAreas.h
        │   │   │   │   ├── DynamicSpanGrid.cpp
        │   │   │   │   ├── DynamicSpanGrid.h
        │   │   │   │   ├── HashComputer.h
        │   │   │   │   ├── IslandConnections.cpp
        │   │   │   │   ├── IslandConnections.h
        │   │   │   │   ├── Islands.cpp
        │   │   │   │   ├── Islands.h
        │   │   │   │   ├── MarkupVolume.cpp
        │   │   │   │   ├── MarkupVolume.h
        │   │   │   │   ├── MNM_Type_info.h
        │   │   │   │   ├── MNMDebugDefines.h
        │   │   │   │   ├── MNMProfiler.h
        │   │   │   │   ├── MNMUtils.h
        │   │   │   │   ├── NavMesh.cpp
        │   │   │   │   ├── NavMesh.h
        │   │   │   │   ├── NavMeshQuery.cpp
        │   │   │   │   ├── NavMeshQuery.h
        │   │   │   │   ├── NavMeshQueryDebug.h
        │   │   │   │   ├── NavMeshQueryManager.cpp
        │   │   │   │   ├── NavMeshQueryManager.h
        │   │   │   │   ├── NavMeshQueryProcessing.cpp
        │   │   │   │   ├── NavMeshQueryProcessing.h
        │   │   │   │   ├── OffGridLinks.cpp
        │   │   │   │   ├── OffGridLinks.h
        │   │   │   │   ├── OpenList.h
        │   │   │   │   ├── Tile.cpp
        │   │   │   │   ├── Tile.h
        │   │   │   │   ├── TileConnectivity.cpp
        │   │   │   │   ├── TileConnectivity.h
        │   │   │   │   ├── TileGenerator.cpp
        │   │   │   │   ├── TileGenerator.h
        │   │   │   │   ├── TileGeneratorDraw.cpp
        │   │   │   │   ├── Voxelizer.cpp
        │   │   │   │   ├── Voxelizer.h
        │   │   │   │   ├── WayQuery.h
        │   │   │   │   └── WayTriangleData.h
        │   │   │   └── NavigationSystem/
        │   │   │       ├── AnnotationsLibrary.cpp
        │   │   │       ├── AnnotationsLibrary.h
        │   │   │       ├── IslandConnectionsManager.cpp
        │   │   │       ├── IslandConnectionsManager.h
        │   │   │       ├── NavigationConsoleVariables.cpp
        │   │   │       ├── NavigationConsoleVariables.h
        │   │   │       ├── NavigationSystem.cpp
        │   │   │       ├── NavigationSystem.h
        │   │   │       ├── NavigationUpdatesManager.cpp
        │   │   │       ├── NavigationUpdatesManager.h
        │   │   │       ├── OffMeshNavigationManager.cpp
        │   │   │       ├── OffMeshNavigationManager.h
        │   │   │       ├── VolumesManager.cpp
        │   │   │       ├── VolumesManager.h
        │   │   │       ├── WorldMonitor.cpp
        │   │   │       └── WorldMonitor.h
        │   │   ├── Perception/
        │   │   │   ├── PerceptionSystemSchematyc.cpp
        │   │   │   └── PerceptionSystemSchematyc.h
        │   │   ├── PolygonSetOps/
        │   │   │   ├── BiDirMap.h
        │   │   │   ├── LineSeg.h
        │   │   │   ├── Polygon2d.h
        │   │   │   └── Utils.h
        │   │   ├── Sequence/
        │   │   │   ├── Sequence.cpp
        │   │   │   ├── Sequence.h
        │   │   │   ├── SequenceAgentAdapter.h
        │   │   │   ├── SequenceFlowNodes.cpp
        │   │   │   ├── SequenceFlowNodes.h
        │   │   │   ├── SequenceManager.cpp
        │   │   │   └── SequenceManager.h
        │   │   ├── TacticalPointSystem/
        │   │   │   ├── TacticalPointQuery.cpp
        │   │   │   ├── TacticalPointQuery.h
        │   │   │   ├── TacticalPointQueryEnum.h
        │   │   │   ├── TacticalPointSystem.cpp
        │   │   │   ├── TacticalPointSystem.h
        │   │   │   ├── TacticalPointSystemConsoleVariables.cpp
        │   │   │   └── TacticalPointSystemConsoleVariables.h
        │   │   └── TargetSelection/
        │   │       ├── TargetTrack.cpp
        │   │       ├── TargetTrack.h
        │   │       ├── TargetTrackCommon.cpp
        │   │       ├── TargetTrackCommon.h
        │   │       ├── TargetTrackConsoleVariables.cpp
        │   │       ├── TargetTrackConsoleVariables.h
        │   │       ├── TargetTrackGroup.cpp
        │   │       ├── TargetTrackGroup.h
        │   │       ├── TargetTrackManager.cpp
        │   │       ├── TargetTrackManager.h
        │   │       ├── TargetTrackModifiers.cpp
        │   │       └── TargetTrackModifiers.h
        │   ├── CryAnimation/
        │   │   ├── AnimationBase.cpp
        │   │   ├── AnimationBase.h
        │   │   ├── AnimationManager.cpp
        │   │   ├── AnimationManager.h
        │   │   ├── AnimEventList.cpp
        │   │   ├── AnimEventList.h
        │   │   ├── AnimEventLoader.cpp
        │   │   ├── AnimEventLoader.h
        │   │   ├── AttachmentBase.cpp
        │   │   ├── AttachmentBase.h
        │   │   ├── AttachmentBone.cpp
        │   │   ├── AttachmentBone.h
        │   │   ├── AttachmentFace.cpp
        │   │   ├── AttachmentFace.h
        │   │   ├── AttachmentManager.cpp
        │   │   ├── AttachmentManager.h
        │   │   ├── AttachmentPRow.cpp
        │   │   ├── AttachmentPRow.h
        │   │   ├── AttachmentProxy.cpp
        │   │   ├── AttachmentProxy.h
        │   │   ├── AttachmentSkin.cpp
        │   │   ├── AttachmentSkin.h
        │   │   ├── AttachmentVCloth.cpp
        │   │   ├── AttachmentVCloth.h
        │   │   ├── AttachmentVClothPreProcess.cpp
        │   │   ├── AttachmentVClothPreProcess.h
        │   │   ├── AttachmentVClothPreProcessDijkstra.h
        │   │   ├── CharacterInstance.cpp
        │   │   ├── CharacterInstance.h
        │   │   ├── CharacterInstance_Render.cpp
        │   │   ├── CharacterInstanceProcessing.cpp
        │   │   ├── CharacterInstanceProcessing.h
        │   │   ├── CharacterManager.cpp
        │   │   ├── CharacterManager.h
        │   │   ├── ChrParamLoader.cpp
        │   │   ├── ChrParamLoader.h
        │   │   ├── CMakeLists.txt
        │   │   ├── Command_Buffer.cpp
        │   │   ├── Command_Buffer.h
        │   │   ├── Command_Commands.cpp
        │   │   ├── Command_Commands.h
        │   │   ├── Controller.h
        │   │   ├── ControllerDefragHeap.cpp
        │   │   ├── ControllerDefragHeap.h
        │   │   ├── ControllerOpt.h
        │   │   ├── ControllerPQ.cpp
        │   │   ├── ControllerPQ.h
        │   │   ├── ControllerPQLog.cpp
        │   │   ├── ControllerPQLog.h
        │   │   ├── ControllerTCB.cpp
        │   │   ├── ControllerTCB.h
        │   │   ├── CryAnimation.rc
        │   │   ├── cryanimation.waf_files
        │   │   ├── CryModEffMorph.cpp
        │   │   ├── CryModEffMorph.h
        │   │   ├── cvars.cpp
        │   │   ├── cvars.h
        │   │   ├── DrawHelper.cpp
        │   │   ├── DrawHelper.h
        │   │   ├── GlobalAnimationHeader.h
        │   │   ├── GlobalAnimationHeaderAIM.cpp
        │   │   ├── GlobalAnimationHeaderAIM.h
        │   │   ├── GlobalAnimationHeaderCAF.cpp
        │   │   ├── GlobalAnimationHeaderCAF.h
        │   │   ├── GlobalAnimationHeaderLMG.cpp
        │   │   ├── GlobalAnimationHeaderLMG.h
        │   │   ├── Helper.h
        │   │   ├── LoaderCGA.cpp
        │   │   ├── LoaderCGA.h
        │   │   ├── LoaderCHR.cpp
        │   │   ├── LoaderCHR.h
        │   │   ├── LoaderDBA.cpp
        │   │   ├── LoaderDBA.h
        │   │   ├── LoaderSKIN.cpp
        │   │   ├── LoaderTCB.cpp
        │   │   ├── LoaderTCB.h
        │   │   ├── Model.cpp
        │   │   ├── Model.h
        │   │   ├── ModelAnimationSet.cpp
        │   │   ├── ModelAnimationSet.h
        │   │   ├── ModelMesh.cpp
        │   │   ├── ModelMesh.h
        │   │   ├── ModelMesh_DebugPC.cpp
        │   │   ├── ModelSkin.cpp
        │   │   ├── ModelSkin.h
        │   │   ├── ParametricSampler.cpp
        │   │   ├── ParametricSampler.h
        │   │   ├── PathExpansion.cpp
        │   │   ├── PathExpansion.h
        │   │   ├── QuatQuantization.h
        │   │   ├── resource.h
        │   │   ├── Skeleton.cpp
        │   │   ├── Skeleton.h
        │   │   ├── SkeletonAnim.cpp
        │   │   ├── SkeletonAnim.h
        │   │   ├── SkeletonAnim_BlendMan.cpp
        │   │   ├── SkeletonAnim_Commands.cpp
        │   │   ├── SkeletonAnim_Locator.cpp
        │   │   ├── SkeletonAnim_Params.cpp
        │   │   ├── SkeletonAnim_Queue.cpp
        │   │   ├── SkeletonEffectManager.cpp
        │   │   ├── SkeletonEffectManager.h
        │   │   ├── SkeletonPhysics.cpp
        │   │   ├── SkeletonPhysics.h
        │   │   ├── SkeletonPhysics_Jobs.cpp
        │   │   ├── SkeletonPose.cpp
        │   │   ├── SkeletonPose.h
        │   │   ├── SkeletonPose_Debug.cpp
        │   │   ├── SkeletonPose_Process.cpp
        │   │   ├── SocketSimulation.cpp
        │   │   ├── SocketSimulation.h
        │   │   ├── stdafx.cpp
        │   │   ├── stdafx.h
        │   │   ├── TransitionQueue.cpp
        │   │   ├── TransitionQueue.h
        │   │   ├── wscript
        │   │   ├── FacialAnimation/
        │   │   │   ├── EyeMovementFaceAnim.cpp
        │   │   │   ├── EyeMovementFaceAnim.h
        │   │   │   ├── FaceAnimation.cpp
        │   │   │   ├── FaceAnimation.h
        │   │   │   ├── FaceAnimSequence.cpp
        │   │   │   ├── FaceAnimSequence.h
        │   │   │   ├── FaceChannelKeyCleanup.cpp
        │   │   │   ├── FaceChannelKeyCleanup.h
        │   │   │   ├── FaceChannelSmoothing.cpp
        │   │   │   ├── FaceChannelSmoothing.h
        │   │   │   ├── FaceEffector.cpp
        │   │   │   ├── FaceEffector.h
        │   │   │   ├── FaceEffectorLibrary.cpp
        │   │   │   ├── FaceEffectorLibrary.h
        │   │   │   ├── FaceJoystick.cpp
        │   │   │   ├── FaceJoystick.h
        │   │   │   ├── FaceState.cpp
        │   │   │   ├── FaceState.h
        │   │   │   ├── FacialInstance.cpp
        │   │   │   ├── FacialInstance.h
        │   │   │   ├── FacialModel.cpp
        │   │   │   ├── FacialModel.h
        │   │   │   ├── LipSync.cpp
        │   │   │   └── LipSync.h
        │   │   ├── Memory/
        │   │   │   ├── AlignedAllocator.h
        │   │   │   ├── IAllocator.h
        │   │   │   ├── Memory.cpp
        │   │   │   ├── Memory.h
        │   │   │   ├── MultiBuffer.h
        │   │   │   ├── PolymorphicAllocator.cpp
        │   │   │   ├── PolymorphicAllocator.h
        │   │   │   ├── Pool.cpp
        │   │   │   ├── Pool.h
        │   │   │   ├── PoolAllocator.cpp
        │   │   │   └── PoolAllocator.h
        │   │   ├── PoseModifier/
        │   │   │   ├── ApplyOffsetRotation.cpp
        │   │   │   ├── CopyTransform.cpp
        │   │   │   ├── DirectionalBlender.cpp
        │   │   │   ├── DirectionalBlender.h
        │   │   │   ├── FeetLock.cpp
        │   │   │   ├── FeetLock.h
        │   │   │   ├── LimbIk.cpp
        │   │   │   ├── LimbIk.h
        │   │   │   ├── LookIk.cpp
        │   │   │   ├── OperatorQueue.cpp
        │   │   │   ├── OperatorQueue.h
        │   │   │   ├── PoseAlignerChain.cpp
        │   │   │   ├── PoseAlignerChain.h
        │   │   │   ├── PoseBlenderAim.cpp
        │   │   │   ├── PoseBlenderAim.h
        │   │   │   ├── PoseBlenderLook.cpp
        │   │   │   ├── PoseBlenderLook.h
        │   │   │   ├── PoseMatching.cpp
        │   │   │   ├── PoseMatching.h
        │   │   │   ├── PoseModifier.cpp
        │   │   │   ├── PoseModifier.h
        │   │   │   ├── PoseModifierDesc.cpp
        │   │   │   ├── PoseModifierDesc.h
        │   │   │   ├── PoseModifierHelper.cpp
        │   │   │   ├── PoseModifierHelper.h
        │   │   │   ├── Recoil.cpp
        │   │   │   └── Recoil.h
        │   │   ├── Serialization/
        │   │   │   └── SerializationCommon.h
        │   │   └── Vertex/
        │   │       ├── VertexAnimation.cpp
        │   │       ├── VertexAnimation.h
        │   │       ├── VertexCommand.cpp
        │   │       ├── VertexCommand.h
        │   │       ├── VertexCommandBuffer.cpp
        │   │       ├── VertexCommandBuffer.h
        │   │       ├── VertexData.cpp
        │   │       └── VertexData.h
        │   ├── CryAudioSystem/
        │   │   ├── CallbackRequestData.h
        │   │   ├── CMakeLists.txt
        │   │   ├── Common.cpp
        │   │   ├── Common.h
        │   │   ├── CryAudioSystem.cpp
        │   │   ├── CryAudioSystem.rc
        │   │   ├── cryaudiosystem.waf_files
        │   │   ├── CVars.cpp
        │   │   ├── CVars.h
        │   │   ├── Debug.h
        │   │   ├── Entity.h
        │   │   ├── Environment.cpp
        │   │   ├── Environment.h
        │   │   ├── EventListenerManager.cpp
        │   │   ├── EventListenerManager.h
        │   │   ├── File.h
        │   │   ├── FileCacheManager.cpp
        │   │   ├── FileCacheManager.h
        │   │   ├── GetFocusTrigger.cpp
        │   │   ├── GetFocusTrigger.h
        │   │   ├── Impl.cpp
        │   │   ├── Impl.h
        │   │   ├── Listener.cpp
        │   │   ├── Listener.h
        │   │   ├── ListenerManager.cpp
        │   │   ├── ListenerManager.h
        │   │   ├── ListenerRequestData.h
        │   │   ├── LoseFocusTrigger.cpp
        │   │   ├── LoseFocusTrigger.h
        │   │   ├── MainThread.cpp
        │   │   ├── MainThread.h
        │   │   ├── Managers.cpp
        │   │   ├── Managers.h
        │   │   ├── MuteAllTrigger.cpp
        │   │   ├── MuteAllTrigger.h
        │   │   ├── Object.cpp
        │   │   ├── Object.h
        │   │   ├── ObjectRequestData.h
        │   │   ├── OcclusionInfo.h
        │   │   ├── Parameter.cpp
        │   │   ├── Parameter.h
        │   │   ├── PauseAllTrigger.cpp
        │   │   ├── PauseAllTrigger.h
        │   │   ├── PreloadRequest.cpp
        │   │   ├── PreloadRequest.h
        │   │   ├── PreviewTrigger.cpp
        │   │   ├── PreviewTrigger.h
        │   │   ├── PropagationProcessor.cpp
        │   │   ├── PropagationProcessor.h
        │   │   ├── RayInfo.h
        │   │   ├── Request.h
        │   │   ├── RequestData.cpp
        │   │   ├── RequestData.h
        │   │   ├── resource.h
        │   │   ├── ResumeAllTrigger.cpp
        │   │   ├── ResumeAllTrigger.h
        │   │   ├── Setting.cpp
        │   │   ├── Setting.h
        │   │   ├── stdafx.cpp
        │   │   ├── stdafx.h
        │   │   ├── Switch.cpp
        │   │   ├── Switch.h
        │   │   ├── SwitchState.cpp
        │   │   ├── SwitchState.h
        │   │   ├── System.cpp
        │   │   ├── System.h
        │   │   ├── SystemRequestData.h
        │   │   ├── Trigger.cpp
        │   │   ├── Trigger.h
        │   │   ├── TriggerInstance.cpp
        │   │   ├── TriggerInstance.h
        │   │   ├── TriggerUtils.cpp
        │   │   ├── TriggerUtils.h
        │   │   ├── UnmuteAllTrigger.cpp
        │   │   ├── UnmuteAllTrigger.h
        │   │   ├── wscript
        │   │   ├── XMLProcessor.cpp
        │   │   ├── XMLProcessor.h
        │   │   ├── Common/
        │   │   │   ├── audiocommon.waf_files
        │   │   │   ├── CMakeLists.txt
        │   │   │   ├── DebugStyle.h
        │   │   │   ├── FileInfo.h
        │   │   │   ├── IEnvironmentConnection.h
        │   │   │   ├── IFile.h
        │   │   │   ├── IImpl.h
        │   │   │   ├── IListener.h
        │   │   │   ├── IObject.h
        │   │   │   ├── IParameterConnection.h
        │   │   │   ├── ISettingConnection.h
        │   │   │   ├── ISwitchStateConnection.h
        │   │   │   ├── ITriggerConnection.h
        │   │   │   ├── ITriggerInfo.h
        │   │   │   ├── Logger.h
        │   │   │   ├── PluginPlatform.h
        │   │   │   ├── PoolObject.h
        │   │   │   ├── PoolObject_impl.h
        │   │   │   └── wscript
        │   │   └── implementations/
        │   │       ├── wscript
        │   │       ├── CryAudioImplAdx2/
        │   │       │   ├── AisacControl.cpp
        │   │       │   ├── AisacControl.h
        │   │       │   ├── AisacControlAdvanced.cpp
        │   │       │   ├── AisacControlAdvanced.h
        │   │       │   ├── AisacEnvironment.cpp
        │   │       │   ├── AisacEnvironment.h
        │   │       │   ├── AisacEnvironmentAdvanced.cpp
        │   │       │   ├── AisacEnvironmentAdvanced.h
        │   │       │   ├── AisacState.cpp
        │   │       │   ├── AisacState.h
        │   │       │   ├── BaseTriggerConnection.h
        │   │       │   ├── Binary.h
        │   │       │   ├── Category.cpp
        │   │       │   ├── Category.h
        │   │       │   ├── CategoryAdvanced.cpp
        │   │       │   ├── CategoryAdvanced.h
        │   │       │   ├── CategoryState.cpp
        │   │       │   ├── CategoryState.h
        │   │       │   ├── CMakeLists.txt
        │   │       │   ├── Common.cpp
        │   │       │   ├── Common.h
        │   │       │   ├── CryAudioImpl.cpp
        │   │       │   ├── cryaudioimpl.waf_files
        │   │       │   ├── Cue.cpp
        │   │       │   ├── Cue.h
        │   │       │   ├── CueInstance.cpp
        │   │       │   ├── CueInstance.h
        │   │       │   ├── CVars.cpp
        │   │       │   ├── CVars.h
        │   │       │   ├── DspBus.cpp
        │   │       │   ├── DspBus.h
        │   │       │   ├── DspBusSetting.cpp
        │   │       │   ├── DspBusSetting.h
        │   │       │   ├── GameVariable.cpp
        │   │       │   ├── GameVariable.h
        │   │       │   ├── GameVariableAdvanced.cpp
        │   │       │   ├── GameVariableAdvanced.h
        │   │       │   ├── GameVariableState.cpp
        │   │       │   ├── GameVariableState.h
        │   │       │   ├── GlobalData.h
        │   │       │   ├── Impl.cpp
        │   │       │   ├── Impl.h
        │   │       │   ├── IoInterface.cpp
        │   │       │   ├── IoInterface.h
        │   │       │   ├── Listener.cpp
        │   │       │   ├── Listener.h
        │   │       │   ├── Object.cpp
        │   │       │   ├── Object.h
        │   │       │   ├── resource.h
        │   │       │   ├── SelectorLabel.cpp
        │   │       │   ├── SelectorLabel.h
        │   │       │   ├── Snapshot.cpp
        │   │       │   ├── Snapshot.h
        │   │       │   ├── stdafx.cpp
        │   │       │   ├── stdafx.h
        │   │       │   └── wscript
        │   │       ├── CryAudioImplFmod/
        │   │       │   ├── Bank.h
        │   │       │   ├── BaseTriggerConnection.h
        │   │       │   ├── CMakeLists.txt
        │   │       │   ├── Common.cpp
        │   │       │   ├── Common.h
        │   │       │   ├── CryAudioImpl.cpp
        │   │       │   ├── cryaudioimpl.waf_files
        │   │       │   ├── CVars.cpp
        │   │       │   ├── CVars.h
        │   │       │   ├── Event.cpp
        │   │       │   ├── Event.h
        │   │       │   ├── EventInstance.cpp
        │   │       │   ├── EventInstance.h
        │   │       │   ├── GlobalData.h
        │   │       │   ├── Impl.cpp
        │   │       │   ├── Impl.h
        │   │       │   ├── Listener.cpp
        │   │       │   ├── Listener.h
        │   │       │   ├── MasterBank.h
        │   │       │   ├── Object.cpp
        │   │       │   ├── Object.h
        │   │       │   ├── Parameter.cpp
        │   │       │   ├── Parameter.h
        │   │       │   ├── ParameterAdvanced.cpp
        │   │       │   ├── ParameterAdvanced.h
        │   │       │   ├── ParameterEnvironment.cpp
        │   │       │   ├── ParameterEnvironment.h
        │   │       │   ├── ParameterEnvironmentAdvanced.cpp
        │   │       │   ├── ParameterEnvironmentAdvanced.h
        │   │       │   ├── ParameterInfo.h
        │   │       │   ├── ParameterState.cpp
        │   │       │   ├── ParameterState.h
        │   │       │   ├── resource.h
        │   │       │   ├── Return.cpp
        │   │       │   ├── Return.h
        │   │       │   ├── Snapshot.cpp
        │   │       │   ├── Snapshot.h
        │   │       │   ├── stdafx.cpp
        │   │       │   ├── stdafx.h
        │   │       │   ├── Vca.cpp
        │   │       │   ├── Vca.h
        │   │       │   ├── VcaState.cpp
        │   │       │   ├── VcaState.h
        │   │       │   ├── wscript
        │   │       │   ├── platforms/
        │   │       │   │   └── null/
        │   │       │   │       └── Functions.h
        │   │       │   └── plugins/
        │   │       │       └── CrySpatial/
        │   │       │           ├── BiquadIIFilter.cpp
        │   │       │           ├── BiquadIIFilter.h
        │   │       │           ├── BiquadIIFilterBank.h
        │   │       │           ├── CMakeLists.txt
        │   │       │           ├── CrySpatial.cpp
        │   │       │           ├── CrySpatial.h
        │   │       │           ├── CrySpatialMath.h
        │   │       │           ├── resource.h
        │   │       │           ├── stdafx.cpp
        │   │       │           └── stdafx.h
        │   │       ├── CryAudioImplPortAudio/
        │   │       │   ├── CMakeLists.txt
        │   │       │   ├── Common.cpp
        │   │       │   ├── Common.h
        │   │       │   ├── CryAudioImpl.cpp
        │   │       │   ├── cryaudioimpl.waf_files
        │   │       │   ├── CVars.cpp
        │   │       │   ├── CVars.h
        │   │       │   ├── Event.cpp
        │   │       │   ├── Event.h
        │   │       │   ├── EventInstance.cpp
        │   │       │   ├── EventInstance.h
        │   │       │   ├── GlobalData.h
        │   │       │   ├── Impl.cpp
        │   │       │   ├── Impl.h
        │   │       │   ├── Listener.cpp
        │   │       │   ├── Listener.h
        │   │       │   ├── Object.cpp
        │   │       │   ├── Object.h
        │   │       │   ├── resource.h
        │   │       │   ├── stdafx.cpp
        │   │       │   ├── stdafx.h
        │   │       │   └── wscript
        │   │       ├── CryAudioImplSDLMixer/
        │   │       │   ├── CMakeLists.txt
        │   │       │   ├── Common.cpp
        │   │       │   ├── Common.h
        │   │       │   ├── CryAudioImpl.cpp
        │   │       │   ├── cryaudioimpl.waf_files
        │   │       │   ├── CVars.cpp
        │   │       │   ├── CVars.h
        │   │       │   ├── Event.cpp
        │   │       │   ├── Event.h
        │   │       │   ├── EventInstance.cpp
        │   │       │   ├── EventInstance.h
        │   │       │   ├── File.h
        │   │       │   ├── GlobalData.h
        │   │       │   ├── Impl.cpp
        │   │       │   ├── Impl.h
        │   │       │   ├── Listener.cpp
        │   │       │   ├── Listener.h
        │   │       │   ├── Object.cpp
        │   │       │   ├── Object.h
        │   │       │   ├── resource.h
        │   │       │   ├── stdafx.cpp
        │   │       │   ├── stdafx.h
        │   │       │   ├── VolumeParameter.cpp
        │   │       │   ├── VolumeParameter.h
        │   │       │   ├── VolumeParameterAdvanced.cpp
        │   │       │   ├── VolumeParameterAdvanced.h
        │   │       │   ├── VolumeState.cpp
        │   │       │   ├── VolumeState.h
        │   │       │   └── wscript
        │   │       └── CryAudioImplWwise/
        │   │           ├── AuxBus.cpp
        │   │           ├── AuxBus.h
        │   │           ├── AuxThread.cpp
        │   │           ├── AuxThread.h
        │   │           ├── CMakeLists.txt
        │   │           ├── Common.cpp
        │   │           ├── Common.h
        │   │           ├── CryAudioImpl.cpp
        │   │           ├── cryaudioimpl.waf_files
        │   │           ├── CVars.cpp
        │   │           ├── CVars.h
        │   │           ├── Event.cpp
        │   │           ├── Event.h
        │   │           ├── EventInstance.cpp
        │   │           ├── EventInstance.h
        │   │           ├── FileIOHandler.cpp
        │   │           ├── FileIOHandler.h
        │   │           ├── GlobalData.h
        │   │           ├── Impl.cpp
        │   │           ├── Impl.h
        │   │           ├── Listener.cpp
        │   │           ├── Listener.h
        │   │           ├── ListenerInfo.h
        │   │           ├── Object.cpp
        │   │           ├── Object.h
        │   │           ├── Parameter.cpp
        │   │           ├── Parameter.h
        │   │           ├── ParameterAdvanced.cpp
        │   │           ├── ParameterAdvanced.h
        │   │           ├── ParameterEnvironment.cpp
        │   │           ├── ParameterEnvironment.h
        │   │           ├── ParameterEnvironmentAdvanced.cpp
        │   │           ├── ParameterEnvironmentAdvanced.h
        │   │           ├── ParameterState.cpp
        │   │           ├── ParameterState.h
        │   │           ├── resource.h
        │   │           ├── SoundBank.h
        │   │           ├── State.cpp
        │   │           ├── State.h
        │   │           ├── stdafx.cpp
        │   │           ├── stdafx.h
        │   │           ├── Switch.cpp
        │   │           ├── Switch.h
        │   │           ├── wscript
        │   │           └── Plugins/
        │   │               └── CrySpatial/
        │   │                   ├── SoundEnginePlugin/
        │   │                   │   ├── AkUserData.h
        │   │                   │   ├── BiquadIIFilter.cpp
        │   │                   │   ├── BiquadIIFilter.h
        │   │                   │   ├── BiquadIIFilterBank.h
        │   │                   │   ├── CMakeLists.txt
        │   │                   │   ├── CrySpatialConfig.h
        │   │                   │   ├── CrySpatialFX.cpp
        │   │                   │   ├── CrySpatialFX.h
        │   │                   │   ├── CrySpatialFXAttachmentParams.cpp
        │   │                   │   ├── CrySpatialFXAttachmentParams.h
        │   │                   │   ├── CrySpatialFXFactory.h
        │   │                   │   ├── CrySpatialFXParams.cpp
        │   │                   │   ├── CrySpatialFXParams.h
        │   │                   │   ├── CrySpatialMath.h
        │   │                   │   ├── resource.h
        │   │                   │   ├── stdafx.cpp
        │   │                   │   └── stdafx.h
        │   │                   └── WwisePlugin/
        │   │                       ├── CMakeLists.txt
        │   │                       ├── CrySpatial.cpp
        │   │                       ├── CrySpatial.def
        │   │                       ├── CrySpatial.h
        │   │                       ├── CrySpatialAttachmentPlugin.cpp
        │   │                       ├── CrySpatialAttachmentPlugin.h
        │   │                       ├── CrySpatialFXFactory.h
        │   │                       ├── CrySpatialFXShared.cpp
        │   │                       ├── CrySpatialPlugin.cpp
        │   │                       ├── CrySpatialPlugin.h
        │   │                       ├── CrySpatialWwise.xml
        │   │                       ├── resource.h
        │   │                       ├── stdafx.cpp
        │   │                       └── stdafx.h
        │   ├── CryCommon/
        │   │   ├── CMakeLists.txt
        │   │   ├── crycommon.waf_files
        │   │   ├── crycommon_android.waf_files
        │   │   ├── crycommon_darwin.waf_files
        │   │   ├── crycommon_examples.waf_files
        │   │   ├── crycommon_linux.waf_files
        │   │   ├── crycommon_posix.waf_files
        │   │   ├── crycommon_win32.waf_files
        │   │   ├── crycommon_windows.waf_files
        │   │   ├── CryEngine.natvis
        │   │   ├── InterfuscatorSeed.txt
        │   │   ├── wscript
        │   │   ├── 3rdParty/
        │   │   │   ├── concqueue/
        │   │   │   │   ├── concqueue-mpmc-bounded.hpp
        │   │   │   │   ├── concqueue-mpsc.hpp
        │   │   │   │   ├── concqueue-spsc-bounded.hpp
        │   │   │   │   ├── concqueue-spsc.hpp
        │   │   │   │   ├── concqueue.hpp
        │   │   │   │   └── concqueue.waf_files
        │   │   │   └── fasthash/
        │   │   │       ├── fasthash.h
        │   │   │       ├── fasthash.inl
        │   │   │       └── fasthash.waf_files
        │   │   ├── Cry3DEngine/
        │   │   │   ├── CREGeomCache.h
        │   │   │   ├── CryEngineDecalInfo.h
        │   │   │   ├── CryPodArray.h
        │   │   │   ├── GeomCacheFileFormat.h
        │   │   │   ├── GeomRef.h
        │   │   │   ├── GeomRef.inl
        │   │   │   ├── I3DEngine.h
        │   │   │   ├── I3DEngine_info.h
        │   │   │   ├── IBreezeGenerator.h
        │   │   │   ├── IColorGradingCtrl.h
        │   │   │   ├── IGeomCache.h
        │   │   │   ├── IIndexedMesh.h
        │   │   │   ├── IIndexedMesh_info.h
        │   │   │   ├── ImageExtensionHelper.h
        │   │   │   ├── ImageExtensionHelper_info.h
        │   │   │   ├── IMaterial.h
        │   │   │   ├── IMeshObj.h
        │   │   │   ├── IRenderNode.h
        │   │   │   ├── IRenderNode_info.h
        │   │   │   ├── IStatObj.h
        │   │   │   ├── ISurfaceType.h
        │   │   │   ├── ITimeOfDay.h
        │   │   │   └── CGF/
        │   │   │       ├── CGFContent.h
        │   │   │       ├── CGFContent_info.h
        │   │   │       ├── CryHeaders.h
        │   │   │       ├── CryHeaders_info.h
        │   │   │       └── IChunkFile.h
        │   │   ├── CryAction/
        │   │   │   ├── IActionMapManager.h
        │   │   │   ├── ICustomActions.h
        │   │   │   ├── ICustomEvents.h
        │   │   │   ├── IDebugHistory.h
        │   │   │   ├── ILipSync.h
        │   │   │   ├── ILipSyncProvider.h
        │   │   │   ├── IMaterialEffects.h
        │   │   │   ├── InterpolationHelpers.h
        │   │   │   ├── ITimeDemoRecorder.h
        │   │   │   └── Examples/
        │   │   │       ├── ActionListener.cpp
        │   │   │       └── ReBindActionInput.cpp
        │   │   ├── CryAISystem/
        │   │   │   ├── AgentParams.h
        │   │   │   ├── AIRayCastQueue.h
        │   │   │   ├── HashGrid.h
        │   │   │   ├── IActorLookUp.h
        │   │   │   ├── IAgent.h
        │   │   │   ├── IAIAction.h
        │   │   │   ├── IAIActionSequence.h
        │   │   │   ├── IAIActor.h
        │   │   │   ├── IAIActorProxy.h
        │   │   │   ├── IAIBubblesSystem.h
        │   │   │   ├── IAIDebugRenderer.h
        │   │   │   ├── IAIGroup.h
        │   │   │   ├── IAIGroupProxy.h
        │   │   │   ├── IAIMannequin.h
        │   │   │   ├── IAIObject.h
        │   │   │   ├── IAIObjectManager.h
        │   │   │   ├── IAIRateOfDeathHandler.h
        │   │   │   ├── IAIRecorder.h
        │   │   │   ├── IAISystem.h
        │   │   │   ├── IAISystemComponent.h
        │   │   │   ├── IAuditionMap.h
        │   │   │   ├── IBlackBoard.h
        │   │   │   ├── IClusterDetector.h
        │   │   │   ├── ICollisionAvoidance.h
        │   │   │   ├── ICommunicationManager.h
        │   │   │   ├── ICoverSystem.h
        │   │   │   ├── IFactionMap.h
        │   │   │   ├── IGoalPipe.h
        │   │   │   ├── IInterestSystem.h
        │   │   │   ├── IMovementActor.h
        │   │   │   ├── IMovementPlan.h
        │   │   │   ├── IMovementPlanner.h
        │   │   │   ├── IMovementSystem.h
        │   │   │   ├── INavigation.h
        │   │   │   ├── INavigationSystem.h
        │   │   │   ├── IOffMeshNavigationManager.h
        │   │   │   ├── IPathfinder.h
        │   │   │   ├── IPerceptionHandler.h
        │   │   │   ├── IPerceptionHandlerModifier.h
        │   │   │   ├── ISignal.h
        │   │   │   ├── ITacticalPointSystem.h
        │   │   │   ├── ITargetTrackManager.h
        │   │   │   ├── IVisionMap.h
        │   │   │   ├── MovementBlock.h
        │   │   │   ├── MovementRequest.h
        │   │   │   ├── MovementRequestID.h
        │   │   │   ├── MovementStyle.h
        │   │   │   ├── MovementUpdateContext.h
        │   │   │   ├── ValueHistory.h
        │   │   │   ├── VisionMapTypes.h
        │   │   │   ├── BehaviorTree/
        │   │   │   │   ├── Readme.txt
        │   │   │   │   ├── Action.h
        │   │   │   │   ├── BehaviorTreeDefines.h
        │   │   │   │   ├── Composite.h
        │   │   │   │   ├── Decorator.h
        │   │   │   │   ├── IBehaviorTree.h
        │   │   │   │   ├── Node.h
        │   │   │   │   ├── NodeFactory.h
        │   │   │   │   ├── SerializationSupport.h
        │   │   │   │   ├── TimestampCollection.h
        │   │   │   │   └── XmlLoader.h
        │   │   │   ├── Components/
        │   │   │   │   ├── IEntityBehaviorTreeComponent.h
        │   │   │   │   ├── IEntityCoverUserComponent.h
        │   │   │   │   ├── IEntityFactionComponent.h
        │   │   │   │   ├── IEntityListenerComponent.h
        │   │   │   │   ├── IEntityMarkupShapeComponent.h
        │   │   │   │   ├── IEntityNavigationComponent.h
        │   │   │   │   ├── IEntityObservableComponent.h
        │   │   │   │   └── IEntityObserverComponent.h
        │   │   │   ├── NavigationSystem/
        │   │   │   │   ├── Annotation.h
        │   │   │   │   ├── INavigationUpdatesManager.h
        │   │   │   │   ├── INavMeshQuery.h
        │   │   │   │   ├── INavMeshQueryDebug.h
        │   │   │   │   ├── INavMeshQueryFilter.h
        │   │   │   │   ├── INavMeshQueryManager.h
        │   │   │   │   ├── INavMeshQueryProcessing.h
        │   │   │   │   ├── MNMBaseTypes.h
        │   │   │   │   ├── MNMBoundingVolume.h
        │   │   │   │   ├── MNMFixedAABB.h
        │   │   │   │   ├── MNMFixedVec2.h
        │   │   │   │   ├── MNMFixedVec3.h
        │   │   │   │   ├── MNMNavMesh.h
        │   │   │   │   ├── MNMTile.h
        │   │   │   │   ├── MNMTileGenerator.h
        │   │   │   │   ├── NavigationIdTypes.h
        │   │   │   │   ├── NavMeshQueryFilterDefault.h
        │   │   │   │   └── OffMeshLink.h
        │   │   │   └── Serialization/
        │   │   │       ├── NavigationSerialize.h
        │   │   │       └── NavigationSerialize.inl
        │   │   ├── CryAnimation/
        │   │   │   ├── CryCharAnimationParams.h
        │   │   │   ├── CryCharMorphParams.h
        │   │   │   ├── IAnimationPoseModifier.h
        │   │   │   ├── IAnimEventPlayer.h
        │   │   │   ├── IAttachment.h
        │   │   │   ├── ICryAnimation.h
        │   │   │   ├── ICryMannequin.h
        │   │   │   ├── ICryMannequinDefs.h
        │   │   │   ├── ICryMannequinEditor.h
        │   │   │   ├── ICryMannequinProceduralClipFactory.h
        │   │   │   ├── ICryMannequinTagDefs.h
        │   │   │   ├── ICryMannequinUserParams.h
        │   │   │   ├── IFacialAnimation.h
        │   │   │   ├── IVertexAnimation.h
        │   │   │   └── Examples/
        │   │   │       ├── AimIK.cpp
        │   │   │       ├── ControllerAnimationEvents.cpp
        │   │   │       ├── CreateActionController.cpp
        │   │   │       ├── LookIK.cpp
        │   │   │       ├── OperatorQueue.cpp
        │   │   │       ├── QueueFragment.cpp
        │   │   │       ├── SetDesiredMotionParam.cpp
        │   │   │       ├── SetTag.cpp
        │   │   │       └── StartAnimation.cpp
        │   │   ├── CryAssert/
        │   │   │   ├── CryAssert_Android.h
        │   │   │   ├── CryAssert_iOS.h
        │   │   │   ├── CryAssert_Linux.h
        │   │   │   ├── CryAssert_Mac.h
        │   │   │   └── CryAssert_Windows.h
        │   │   ├── CryAudio/
        │   │   │   ├── IAudioInterfacesCommonData.h
        │   │   │   ├── IAudioSystem.h
        │   │   │   ├── IListener.h
        │   │   │   ├── IObject.h
        │   │   │   └── Dialog/
        │   │   │       └── IDialogSystem.h
        │   │   ├── CryCore/
        │   │   │   ├── AlignmentTools.h
        │   │   │   ├── Base64.h
        │   │   │   ├── BaseTypes.h
        │   │   │   ├── BitFiddling.h
        │   │   │   ├── BitmapDilation.h
        │   │   │   ├── BitMask.h
        │   │   │   ├── BoostHelpers.h
        │   │   │   ├── Common_TypeInfo.h
        │   │   │   ├── Common_TypeInfo2.h
        │   │   │   ├── CountedValue.h
        │   │   │   ├── CrtDebugStats.h
        │   │   │   ├── CryCrc32.h
        │   │   │   ├── CryCustomTypes.h
        │   │   │   ├── CryEndian.h
        │   │   │   ├── CryEnumMacro.h
        │   │   │   ├── CryFlags.h
        │   │   │   ├── CryTypeInfo.h
        │   │   │   ├── CryTypeInfo.inl
        │   │   │   ├── CryVariant.h
        │   │   │   ├── Dispatcher.h
        │   │   │   ├── DynamicEnum.h
        │   │   │   ├── FindZeroRanges.h
        │   │   │   ├── FixedPoint.h
        │   │   │   ├── functor.h
        │   │   │   ├── Octree.h
        │   │   │   ├── OctreeDebug.h
        │   │   │   ├── optional.h
        │   │   │   ├── RingBuffer.h
        │   │   │   ├── ScopeGuard.h
        │   │   │   ├── SmallFunction.h
        │   │   │   ├── smartptr.h
        │   │   │   ├── StaticInstanceList.h
        │   │   │   ├── StlUtils.h
        │   │   │   ├── stridedptr.h
        │   │   │   ├── TypeInfo_decl.h
        │   │   │   ├── TypeInfo_impl.h
        │   │   │   ├── Typelist.h
        │   │   │   ├── TypelistUtils.h
        │   │   │   ├── Wrapper.h
        │   │   │   ├── xmodule_ptr.h
        │   │   │   ├── Assert/
        │   │   │   │   ├── CryAssert.h
        │   │   │   │   └── CryAssert_impl.h
        │   │   │   ├── Compiler/
        │   │   │   │   ├── Clangspecific.h
        │   │   │   │   ├── GCCspecific.h
        │   │   │   │   └── MSVCspecific.h
        │   │   │   ├── Containers/
        │   │   │   │   ├── CryArray.h
        │   │   │   │   ├── CryFixedArray.h
        │   │   │   │   ├── CryListenerSet.h
        │   │   │   │   ├── CryPtrArray.h
        │   │   │   │   ├── IDMap.h
        │   │   │   │   ├── intrusive_list.hpp
        │   │   │   │   ├── MiniQueue.h
        │   │   │   │   ├── VariableCollection.h
        │   │   │   │   ├── VectorMap.h
        │   │   │   │   └── VectorSet.h
        │   │   │   ├── Platform/
        │   │   │   │   ├── Android64Specific.h
        │   │   │   │   ├── AndroidJNI.h
        │   │   │   │   ├── AndroidJNI.inl
        │   │   │   │   ├── AndroidSpecific.h
        │   │   │   │   ├── AppleSpecific.h
        │   │   │   │   ├── CryAtlMfc.h
        │   │   │   │   ├── CryDLMalloc.h
        │   │   │   │   ├── CryLibrary.h
        │   │   │   │   ├── CryPlatform.Darwin.h
        │   │   │   │   ├── CryPlatform.h
        │   │   │   │   ├── CryPlatform.Linux.h
        │   │   │   │   ├── CryPlatform.Win64.h
        │   │   │   │   ├── CryPlatformDefines.h
        │   │   │   │   ├── CryStlConfig.h
        │   │   │   │   ├── CryWindows.h
        │   │   │   │   ├── iOSSpecific.h
        │   │   │   │   ├── IPlatformOS.h
        │   │   │   │   ├── Linux64Specific.h
        │   │   │   │   ├── Linux_Win32Wrapper.h
        │   │   │   │   ├── LinuxSpecific.h
        │   │   │   │   ├── MacSpecific.h
        │   │   │   │   ├── platform.h
        │   │   │   │   ├── platform_impl.inl
        │   │   │   │   ├── platform_impl_android.inl
        │   │   │   │   ├── platform_impl_mac.inl
        │   │   │   │   ├── platform_impl_posix.inl
        │   │   │   │   ├── platform_impl_winapi.inl
        │   │   │   │   ├── WinBase.inl
        │   │   │   │   ├── WinBase_posix.inl
        │   │   │   │   ├── WindowsSpecific.h
        │   │   │   │   └── WindowsUtils.h
        │   │   │   ├── Project/
        │   │   │   │   ├── CryModuleDefs.h
        │   │   │   │   ├── ProjectDefines.h
        │   │   │   │   ├── Version.h
        │   │   │   │   └── Version_override.h
        │   │   │   └── ToolsHelpers/
        │   │   │       ├── EngineSettingsManager.h
        │   │   │       ├── EngineSettingsManager.inl
        │   │   │       ├── GuidUtil.h
        │   │   │       ├── ResourceCompilerHelper.h
        │   │   │       ├── ResourceCompilerHelper.inl
        │   │   │       ├── SettingsManagerHelpers.h
        │   │   │       └── SettingsManagerHelpers.inl
        │   │   ├── CryDynamicResponseSystem/
        │   │   │   ├── IDynamicResponseAction.h
        │   │   │   ├── IDynamicResponseCondition.h
        │   │   │   └── IDynamicResponseSystem.h
        │   │   ├── CryEntitySystem/
        │   │   │   ├── EntityDesc.h
        │   │   │   ├── IBitStream.h
        │   │   │   ├── IBreakableGlassSystem.h
        │   │   │   ├── IBreakableManager.h
        │   │   │   ├── IEntity.h
        │   │   │   ├── IEntityBasicTypes.h
        │   │   │   ├── IEntityClass.h
        │   │   │   ├── IEntityComponent.h
        │   │   │   ├── IEntityLayer.h
        │   │   │   ├── IEntitySerialize.h
        │   │   │   ├── IEntitySystem.h
        │   │   │   └── Examples/
        │   │   │       ├── AspectDelegation.cpp
        │   │   │       ├── ComponentEvents.cpp
        │   │   │       ├── ComponentNetReplicate.cpp
        │   │   │       ├── ComponentNetSerialize.cpp
        │   │   │       ├── ComponentRemoteMethodInvocation.cpp
        │   │   │       ├── FindEntityByName.cpp
        │   │   │       ├── GetEntity.cpp
        │   │   │       ├── LoadCharacter.cpp
        │   │   │       ├── LoadFogVolume.cpp
        │   │   │       ├── LoadGeomCache.cpp
        │   │   │       ├── LoadGeometry.cpp
        │   │   │       ├── LoadLight.cpp
        │   │   │       ├── LoadParticleEmitter.cpp
        │   │   │       ├── MinimalEntityComponent.cpp
        │   │   │       ├── MonitorCollisions.cpp
        │   │   │       ├── PhysicalizeEntity.cpp
        │   │   │       ├── PhysicalizeEntitySlot.cpp
        │   │   │       ├── PhysicalizeLiving.cpp
        │   │   │       ├── PreviewComponent.cpp
        │   │   │       ├── RopeComponent.cpp
        │   │   │       ├── SpawnEntity.cpp
        │   │   │       ├── TraverseEntities.cpp
        │   │   │       ├── TriggerComponent.cpp
        │   │   │       └── Audio/
        │   │   │           ├── ExecuteTrigger.cpp
        │   │   │           ├── SetParameterValue.cpp
        │   │   │           └── SetSwitchState.cpp
        │   │   ├── CryExtension/
        │   │   │   ├── ClassWeaver.h
        │   │   │   ├── Conversion.h
        │   │   │   ├── CryCreateClassInstance.h
        │   │   │   ├── CryGUID.h
        │   │   │   ├── CryTypeID.h
        │   │   │   ├── ICryFactory.h
        │   │   │   ├── ICryFactoryRegistry.h
        │   │   │   ├── ICryFactoryRegistryImpl.h
        │   │   │   ├── ICryUnknown.h
        │   │   │   ├── RegFactoryNode.h
        │   │   │   └── TypeList.h
        │   │   ├── CryFlowGraph/
        │   │   │   ├── IFlowBaseNode.h
        │   │   │   ├── IFlowGraphDebugger.h
        │   │   │   ├── IFlowGraphModuleManager.h
        │   │   │   └── IFlowSystem.h
        │   │   ├── CryFont/
        │   │   │   └── IFont.h
        │   │   ├── CryGame/
        │   │   │   ├── CoherentValue.h
        │   │   │   ├── ExtensionDefines.h
        │   │   │   ├── GameUtils.h
        │   │   │   ├── IGame.h
        │   │   │   ├── IGameFramework.h
        │   │   │   ├── IGameFrameworkExtension.h
        │   │   │   ├── IGameRef.h
        │   │   │   ├── IGameStartup.h
        │   │   │   ├── IGameStatistics.h
        │   │   │   ├── IGameTokens.h
        │   │   │   ├── IGameVolumes.h
        │   │   │   └── IGameWebDebug.h
        │   │   ├── CryInput/
        │   │   │   ├── IHardwareMouse.h
        │   │   │   ├── IInput.h
        │   │   │   └── IJoystick.h
        │   │   ├── CryLiveCreate/
        │   │   │   ├── ILiveCreateCommon.h
        │   │   │   ├── ILiveCreateHost.h
        │   │   │   ├── ILiveCreateManager.h
        │   │   │   ├── ILiveCreatePlatform.h
        │   │   │   └── IRealtimeRemoteUpdate.h
        │   │   ├── CryLobby/
        │   │   │   ├── CommonICryLobby.h
        │   │   │   ├── CommonICryMatchMaking.h
        │   │   │   ├── CryLobbyEventCallback.h
        │   │   │   └── ICryStats.h
        │   │   ├── CryMath/
        │   │   │   ├── AABBSV.h
        │   │   │   ├── Angle.h
        │   │   │   ├── Bezier.h
        │   │   │   ├── Bezier_impl.h
        │   │   │   ├── Cry_Camera.h
        │   │   │   ├── Cry_Color.h
        │   │   │   ├── Cry_Geo.h
        │   │   │   ├── Cry_GeoDistance.h
        │   │   │   ├── Cry_GeoIntersect.h
        │   │   │   ├── Cry_GeoOverlap.h
        │   │   │   ├── Cry_GeoProjection.h
        │   │   │   ├── Cry_Math.h
        │   │   │   ├── Cry_Math_SSE.h
        │   │   │   ├── Cry_Matrix33.h
        │   │   │   ├── Cry_Matrix34.h
        │   │   │   ├── Cry_Matrix34H.h
        │   │   │   ├── Cry_Matrix44.h
        │   │   │   ├── Cry_Matrix44H.h
        │   │   │   ├── Cry_MatrixDiag.h
        │   │   │   ├── Cry_Quat.h
        │   │   │   ├── Cry_ValidNumber.h
        │   │   │   ├── Cry_Vector2.h
        │   │   │   ├── Cry_Vector3.h
        │   │   │   ├── Cry_Vector4.h
        │   │   │   ├── Cry_Vector4H.h
        │   │   │   ├── Cry_XOptimise.h
        │   │   │   ├── CryHalf.inl
        │   │   │   ├── CryHalf_info.h
        │   │   │   ├── CryRandomInternal.h
        │   │   │   ├── FinalizingSpline.h
        │   │   │   ├── GeomQuery.h
        │   │   │   ├── GeomQuery.inl
        │   │   │   ├── ISplines.h
        │   │   │   ├── ISplineSerialization_impl.h
        │   │   │   ├── LCGRandom.h
        │   │   │   ├── MTPseudoRandom.h
        │   │   │   ├── NumberVector.h
        │   │   │   ├── PNoise3.h
        │   │   │   ├── QTangent.h
        │   │   │   ├── RadixSort.h
        │   │   │   ├── RadixSortImpl.h
        │   │   │   ├── Random.h
        │   │   │   ├── Range.h
        │   │   │   ├── Rotation.h
        │   │   │   ├── SimpleHashLookUp.h
        │   │   │   ├── SNoise.h
        │   │   │   ├── TCBSpline.h
        │   │   │   └── Transform.h
        │   │   ├── CryMemory/
        │   │   │   ├── AddressHelpers.h
        │   │   │   ├── Allocator.h
        │   │   │   ├── BucketAllocator.h
        │   │   │   ├── BucketAllocatorImpl.h
        │   │   │   ├── BucketAllocatorPolicy.h
        │   │   │   ├── CryMemBlock.h
        │   │   │   ├── CryMemoryAllocator.h
        │   │   │   ├── CryMemoryManager.h
        │   │   │   ├── CryMemoryManager_impl.h
        │   │   │   ├── CrySizer.h
        │   │   │   ├── FixedAllocator.h
        │   │   │   ├── HeapAllocator.h
        │   │   │   ├── IDefragAllocator.h
        │   │   │   ├── IGeneralMemoryHeap.h
        │   │   │   ├── ILocalMemoryUsage.h
        │   │   │   ├── IMemory.h
        │   │   │   ├── MemoryAccess.h
        │   │   │   ├── PoolAllocator.h
        │   │   │   ├── STLAlignedAlloc.h
        │   │   │   ├── StlDbgAlloc.h
        │   │   │   ├── STLGlobalAllocator.h
        │   │   │   ├── STLPoolAllocator.h
        │   │   │   ├── STLPoolAllocator_ManyElems.h
        │   │   │   ├── VirtualMemory.h
        │   │   │   ├── VirtualMemory_impl.h
        │   │   │   ├── VirtualMemory_impl_sce.h
        │   │   │   └── CryPool/
        │   │   │       ├── Allocator.h
        │   │   │       ├── Container.h
        │   │   │       ├── Defrag.h
        │   │   │       ├── example.h
        │   │   │       ├── Fallback.h
        │   │   │       ├── Inspector.h
        │   │   │       ├── List.h
        │   │   │       ├── Memory.h
        │   │   │       ├── PAUnitTest.cpp
        │   │   │       ├── PoolAlloc.h
        │   │   │       ├── STLWrapper.h
        │   │   │       └── ThreadSafe.h
        │   │   ├── CryMono/
        │   │   │   └── IMonoRuntime.h
        │   │   ├── CryMovie/
        │   │   │   ├── AnimKey.h
        │   │   │   ├── AnimKey_impl.h
        │   │   │   ├── AnimTime.h
        │   │   │   └── IMovieSystem.h
        │   │   ├── CryNetwork/
        │   │   │   ├── CrySocketError.h
        │   │   │   ├── CrySocks.h
        │   │   │   ├── CrySocks_posix.h
        │   │   │   ├── CrySocks_win32.h
        │   │   │   ├── ICryOnlineStorage.h
        │   │   │   ├── INetEntity.h
        │   │   │   ├── INetwork.h
        │   │   │   ├── INetworkService.h
        │   │   │   ├── INotificationNetwork.h
        │   │   │   ├── IRemoteCommand.h
        │   │   │   ├── IRemoteControl.h
        │   │   │   ├── ISerialize.h
        │   │   │   ├── ISerialize_info.h
        │   │   │   ├── ISerializeHelper.h
        │   │   │   ├── IServiceNetwork.h
        │   │   │   ├── ISimpleHttpServer.h
        │   │   │   ├── NetAddress.h
        │   │   │   ├── NetHelpers.h
        │   │   │   ├── Rmi.h
        │   │   │   ├── SerializationTypes.h
        │   │   │   ├── SerializeBuffer.h
        │   │   │   ├── SerializeFwd.h
        │   │   │   ├── SimpleSerialize.h
        │   │   │   └── Examples/
        │   │   │       └── NetworkedClientListener.cpp
        │   │   ├── CryParticleSystem/
        │   │   │   ├── IParticles.h
        │   │   │   ├── IParticlesPfx2.h
        │   │   │   ├── Options.h
        │   │   │   ├── ParticleParams.h
        │   │   │   ├── ParticleParams_info.h
        │   │   │   └── ParticleParams_TypeInfo.h
        │   │   ├── CryPhysics/
        │   │   │   ├── AgePriorityQueue.h
        │   │   │   ├── DeferredActionQueue.h
        │   │   │   ├── IDeferredCollisionEvent.h
        │   │   │   ├── IntersectionTestQueue.h
        │   │   │   ├── IPhysics.h
        │   │   │   ├── IPhysicsDebugRenderer.h
        │   │   │   ├── physinterface.h
        │   │   │   ├── polynomial.h
        │   │   │   ├── primitives.h
        │   │   │   ├── primitives_info.h
        │   │   │   ├── RayCastQueue.h
        │   │   │   └── Examples/
        │   │   │       ├── ActionImpulse.cpp
        │   │   │       ├── AddConstraint.cpp
        │   │   │       ├── GetDynamicsStatus.cpp
        │   │   │       ├── GetPhysicalEntityPosition.cpp
        │   │   │       ├── GetSimulationParams.cpp
        │   │   │       ├── RayWorldIntersection.cpp
        │   │   │       ├── SetPhysicalEntityPosition.cpp
        │   │   │       └── SimulateExplosion.cpp
        │   │   ├── CryRenderer/
        │   │   │   ├── branchmask.h
        │   │   │   ├── IComputeSkinning.h
        │   │   │   ├── IFlares.h
        │   │   │   ├── IGpuParticles.h
        │   │   │   ├── IGpuPhysics.h
        │   │   │   ├── IImage.h
        │   │   │   ├── IMeshBaking.h
        │   │   │   ├── IRenderAuxGeom.h
        │   │   │   ├── IRenderer.h
        │   │   │   ├── IRenderMesh.h
        │   │   │   ├── IRenderView.h
        │   │   │   ├── IScaleform.h
        │   │   │   ├── IShader.h
        │   │   │   ├── IShader_info.h
        │   │   │   ├── IShaderParamCallback.h
        │   │   │   ├── IStereoRenderer.h
        │   │   │   ├── ITexture.h
        │   │   │   ├── RenderObject.h
        │   │   │   ├── Tarray.h
        │   │   │   ├── VertexFormats.h
        │   │   │   └── RenderElements/
        │   │   │       ├── CREBreakableGlass.h
        │   │   │       ├── CREBreakableGlassConfig.h
        │   │   │       ├── CREBreakableGlassHelpers.h
        │   │   │       ├── CREFarTreeSprites.h
        │   │   │       ├── CREFogVolume.h
        │   │   │       ├── CREGameEffect.h
        │   │   │       ├── CREMesh.h
        │   │   │       ├── CREOcclusionQuery.h
        │   │   │       ├── CREParticle.h
        │   │   │       ├── CREWaterOcean.h
        │   │   │       ├── CREWaterVolume.h
        │   │   │       └── RendElement.h
        │   │   ├── CrySandbox/
        │   │   │   ├── CryFunction.h
        │   │   │   ├── CryInterop.h
        │   │   │   ├── CrySignal.h
        │   │   │   ├── IEditorGame.h
        │   │   │   ├── IFuncVariable.h
        │   │   │   └── ScopedVariableSetter.h
        │   │   ├── CrySchematyc/
        │   │   │   ├── Action.h
        │   │   │   ├── Component.h
        │   │   │   ├── CoreAPI.h
        │   │   │   ├── FundamentalTypes.h
        │   │   │   ├── ICore.h
        │   │   │   ├── IObject.h
        │   │   │   ├── IObjectProperties.h
        │   │   │   ├── MathTypes.h
        │   │   │   ├── ResourceTypes.h
        │   │   │   ├── Compiler/
        │   │   │   │   ├── CompilerContext.h
        │   │   │   │   ├── ICompiler.h
        │   │   │   │   └── IGraphNodeCompiler.h
        │   │   │   ├── Editor/
        │   │   │   │   └── IQuickSearchOptions.h
        │   │   │   ├── Env/
        │   │   │   │   ├── EnvContext.h
        │   │   │   │   ├── EnvElementBase.h
        │   │   │   │   ├── EnvPackage.h
        │   │   │   │   ├── EnvUtils.h
        │   │   │   │   ├── IEnvContext.h
        │   │   │   │   ├── IEnvElement.h
        │   │   │   │   ├── IEnvPackage.h
        │   │   │   │   ├── IEnvRegistrar.h
        │   │   │   │   ├── IEnvRegistry.h
        │   │   │   │   └── Elements/
        │   │   │   │       ├── EnvAction.h
        │   │   │   │       ├── EnvClass.h
        │   │   │   │       ├── EnvComponent.h
        │   │   │   │       ├── EnvDataType.h
        │   │   │   │       ├── EnvFunction.h
        │   │   │   │       ├── EnvInterface.h
        │   │   │   │       ├── EnvModule.h
        │   │   │   │       ├── EnvSignal.h
        │   │   │   │       ├── IEnvAction.h
        │   │   │   │       ├── IEnvClass.h
        │   │   │   │       ├── IEnvComponent.h
        │   │   │   │       ├── IEnvDataType.h
        │   │   │   │       ├── IEnvFunction.h
        │   │   │   │       ├── IEnvInterface.h
        │   │   │   │       ├── IEnvModule.h
        │   │   │   │       └── IEnvSignal.h
        │   │   │   ├── Network/
        │   │   │   │   ├── INetworkObject.h
        │   │   │   │   └── INetworkSpawnParams.h
        │   │   │   ├── Reflection/
        │   │   │   │   ├── ActionDesc.h
        │   │   │   │   ├── ComponentDesc.h
        │   │   │   │   ├── DefaultTypeReflection.inl
        │   │   │   │   ├── FunctionDesc.h
        │   │   │   │   ├── ReflectionUtils.h
        │   │   │   │   ├── TypeDesc.h
        │   │   │   │   ├── TypeDesc.inl
        │   │   │   │   ├── TypeOperators.h
        │   │   │   │   └── TypeOperators.inl
        │   │   │   ├── Runtime/
        │   │   │   │   ├── IRuntimeClass.h
        │   │   │   │   ├── IRuntimeRegistry.h
        │   │   │   │   ├── RuntimeGraph.h
        │   │   │   │   ├── RuntimeParamMap.h
        │   │   │   │   ├── RuntimeParamMap.inl
        │   │   │   │   ├── RuntimeParams.h
        │   │   │   │   └── RuntimeParams.inl
        │   │   │   ├── Script/
        │   │   │   │   ├── IScript.h
        │   │   │   │   ├── IScriptElement.h
        │   │   │   │   ├── IScriptExtension.h
        │   │   │   │   ├── IScriptGraph.h
        │   │   │   │   ├── IScriptRegistry.h
        │   │   │   │   ├── IScriptView.h
        │   │   │   │   ├── ScriptDependencyEnumerator.h
        │   │   │   │   ├── ScriptUtils.h
        │   │   │   │   └── Elements/
        │   │   │   │       ├── IScriptActionInstance.h
        │   │   │   │       ├── IScriptBase.h
        │   │   │   │       ├── IScriptClass.h
        │   │   │   │       ├── IScriptComponentInstance.h
        │   │   │   │       ├── IScriptConstructor.h
        │   │   │   │       ├── IScriptDestructor.h
        │   │   │   │       ├── IScriptEnum.h
        │   │   │   │       ├── IScriptFunction.h
        │   │   │   │       ├── IScriptImport.h
        │   │   │   │       ├── IScriptInterface.h
        │   │   │   │       ├── IScriptInterfaceFunction.h
        │   │   │   │       ├── IScriptInterfaceImpl.h
        │   │   │   │       ├── IScriptInterfaceTask.h
        │   │   │   │       ├── IScriptModule.h
        │   │   │   │       ├── IScriptRoot.h
        │   │   │   │       ├── IScriptSignal.h
        │   │   │   │       ├── IScriptSignalReceiver.h
        │   │   │   │       ├── IScriptState.h
        │   │   │   │       ├── IScriptStateMachine.h
        │   │   │   │       ├── IScriptStruct.h
        │   │   │   │       ├── IScriptTimer.h
        │   │   │   │       └── IScriptVariable.h
        │   │   │   ├── SerializationUtils/
        │   │   │   │   ├── ContainerSerializationUtils.h
        │   │   │   │   ├── ISerializationContext.h
        │   │   │   │   ├── IValidatorArchive.h
        │   │   │   │   ├── MultiPassSerializer.h
        │   │   │   │   ├── SerializationEnums.inl
        │   │   │   │   ├── SerializationQuickSearch.h
        │   │   │   │   ├── SerializationToString.h
        │   │   │   │   └── SerializationUtils.h
        │   │   │   ├── Services/
        │   │   │   │   ├── ILog.h
        │   │   │   │   ├── ILogRecorder.h
        │   │   │   │   ├── ISettingsManager.h
        │   │   │   │   ├── ITimerSystem.h
        │   │   │   │   ├── IUpdateScheduler.h
        │   │   │   │   ├── LogMetaData.h
        │   │   │   │   └── LogStreamName.h
        │   │   │   └── Utils/
        │   │   │       ├── Any.h
        │   │   │       ├── AnyArray.h
        │   │   │       ├── Array.h
        │   │   │       ├── Assert.h
        │   │   │       ├── ClassProperties.h
        │   │   │       ├── CryLinkUtils.h
        │   │   │       ├── Delegate.h
        │   │   │       ├── EnumFlags.h
        │   │   │       ├── GUID.h
        │   │   │       ├── HybridArray.h
        │   │   │       ├── IGUIDRemapper.h
        │   │   │       ├── IInterfaceMap.h
        │   │   │       ├── IString.h
        │   │   │       ├── PreprocessorUtils.h
        │   │   │       ├── RingBuffer.h
        │   │   │       ├── Rotation.h
        │   │   │       ├── ScopedConnection.h
        │   │   │       ├── Scratchpad.h
        │   │   │       ├── SharedString.h
        │   │   │       ├── Signal.h
        │   │   │       ├── StackString.h
        │   │   │       ├── STLUtils.h
        │   │   │       ├── StringHashWrapper.h
        │   │   │       ├── StringUtils.h
        │   │   │       ├── Transform.h
        │   │   │       ├── TypeName.h
        │   │   │       ├── TypeUtils.h
        │   │   │       ├── UniqueId.h
        │   │   │       └── Validator.h
        │   │   ├── CrySchematyc2/
        │   │   │   ├── AbstractInterfaceUtils.h
        │   │   │   ├── ActionFactory.h
        │   │   │   ├── AggregateTypeId.h
        │   │   │   ├── Any.h
        │   │   │   ├── BasicTypes.h
        │   │   │   ├── ComponentFactory.h
        │   │   │   ├── EnvTypeDesc.h
        │   │   │   ├── GUID.h
        │   │   │   ├── GUIDRemapper.h
        │   │   │   ├── IAbstractInterface.h
        │   │   │   ├── IActionFactory.h
        │   │   │   ├── IAny.h
        │   │   │   ├── IBaseEnv.h
        │   │   │   ├── ICompiler.h
        │   │   │   ├── IComponentFactory.h
        │   │   │   ├── IDomainContext.h
        │   │   │   ├── IEntityAttributesProxy.h
        │   │   │   ├── IEnvTypeDesc.h
        │   │   │   ├── IFoundation.h
        │   │   │   ├── IFramework.h
        │   │   │   ├── ILib.h
        │   │   │   ├── ILibRegistry.h
        │   │   │   ├── INetworkObject.h
        │   │   │   ├── INetworkSpawnParams.h
        │   │   │   ├── IObject.h
        │   │   │   ├── IObjectManager.h
        │   │   │   ├── IProperties.h
        │   │   │   ├── IQuickSearchOptions.h
        │   │   │   ├── ISignal.h
        │   │   │   ├── LibUtils.h
        │   │   │   ├── Prerequisites.h
        │   │   │   ├── Properties.h
        │   │   │   ├── TypeInfo.h
        │   │   │   ├── Deprecated/
        │   │   │   │   ├── ActionMemberFunction.h
        │   │   │   │   ├── ComponentMemberFunction.h
        │   │   │   │   ├── DocUtils.h
        │   │   │   │   ├── GlobalFunction.h
        │   │   │   │   ├── IGlobalFunction.h
        │   │   │   │   ├── IStringPool.h
        │   │   │   │   ├── Stack.h
        │   │   │   │   ├── StackIArchive.h
        │   │   │   │   ├── StackOArchive.h
        │   │   │   │   ├── Variant.h
        │   │   │   │   └── VariantStack.h
        │   │   │   ├── Env/
        │   │   │   │   ├── EnvFunctionDescriptor.h
        │   │   │   │   ├── EnvTypeId.h
        │   │   │   │   ├── IEnvElement.h
        │   │   │   │   ├── IEnvFunctionDescriptor.h
        │   │   │   │   └── IEnvRegistry.h
        │   │   │   ├── Runtime/
        │   │   │   │   ├── IRuntime.h
        │   │   │   │   ├── RuntimeParams.h
        │   │   │   │   └── ScratchPad.h
        │   │   │   ├── Script/
        │   │   │   │   ├── IScriptElement.h
        │   │   │   │   ├── IScriptExtension.h
        │   │   │   │   ├── IScriptFile.h
        │   │   │   │   ├── IScriptGraph.h
        │   │   │   │   ├── IScriptGraphNodeCompiler.h
        │   │   │   │   ├── IScriptGraphNodeCreationMenu.h
        │   │   │   │   ├── IScriptRegistry.h
        │   │   │   │   └── Elements/
        │   │   │   │       ├── IScriptFunction.h
        │   │   │   │       └── IScriptModule.h
        │   │   │   ├── Serialization/
        │   │   │   │   ├── ISerializationContext.h
        │   │   │   │   ├── IValidatorArchive.h
        │   │   │   │   ├── SerializationEnums.inl
        │   │   │   │   ├── SerializationUtils.h
        │   │   │   │   ├── StringOArchive.h
        │   │   │   │   └── Resources/
        │   │   │   │       ├── GameResources.h
        │   │   │   │       ├── IGameResourceList.h
        │   │   │   │       └── IResourceCollectorArchive.h
        │   │   │   ├── Services/
        │   │   │   │   ├── ILog.h
        │   │   │   │   ├── ITimerSystem.h
        │   │   │   │   └── IUpdateScheduler.h
        │   │   │   ├── TemplateUtils/
        │   │   │   │   ├── TemplateUtils_ArrayView.h
        │   │   │   │   ├── TemplateUtils_Delegate.h
        │   │   │   │   ├── TemplateUtils_DelegateImpl.h
        │   │   │   │   ├── TemplateUtils_IntrusiveList.h
        │   │   │   │   ├── TemplateUtils_PreprocessorUtils.h
        │   │   │   │   ├── TemplateUtils_RingBuffer.h
        │   │   │   │   ├── TemplateUtils_ScopedConnection.h
        │   │   │   │   ├── TemplateUtils_Signal.h
        │   │   │   │   ├── TemplateUtils_SignalImpl.h
        │   │   │   │   ├── TemplateUtils_SignalImplv2.h
        │   │   │   │   ├── TemplateUtils_Signalv2.h
        │   │   │   │   ├── TemplateUtils_StringHashWrapper.h
        │   │   │   │   ├── TemplateUtils_TypeUtils.h
        │   │   │   │   └── TemplateUtils_TypeWrapper.h
        │   │   │   └── Utils/
        │   │   │       ├── CryLinkUtils.h
        │   │   │       ├── DefaultInit.h
        │   │   │       ├── IString.h
        │   │   │       ├── SharedArray.h
        │   │   │       ├── SharedString.h
        │   │   │       ├── StackString.h
        │   │   │       ├── StringUtils.h
        │   │   │       └── ToString.h
        │   │   ├── CryScriptSystem/
        │   │   │   └── IScriptSystem.h
        │   │   ├── CrySerialization/
        │   │   │   ├── BlackBox.h
        │   │   │   ├── Callback.h
        │   │   │   ├── ClassFactory.h
        │   │   │   ├── Color.h
        │   │   │   ├── ColorImpl.h
        │   │   │   ├── CRCRef.h
        │   │   │   ├── CRCRefImpl.h
        │   │   │   ├── CryExtension.h
        │   │   │   ├── CryExtensionImpl.h
        │   │   │   ├── CryName.h
        │   │   │   ├── CryNameImpl.h
        │   │   │   ├── CryStrings.h
        │   │   │   ├── CryStringsImpl.h
        │   │   │   ├── DynArray.h
        │   │   │   ├── Enum.h
        │   │   │   ├── Forward.h
        │   │   │   ├── Gap.h
        │   │   │   ├── IArchive.h
        │   │   │   ├── IArchiveHost.h
        │   │   │   ├── IClassFactory.h
        │   │   │   ├── IntrusiveFactory.h
        │   │   │   ├── Math.h
        │   │   │   ├── MathImpl.h
        │   │   │   ├── NameGeneration.h
        │   │   │   ├── SerializationUtils.h
        │   │   │   ├── Serializer.h
        │   │   │   ├── SmartPtr.h
        │   │   │   ├── SmartPtrImpl.h
        │   │   │   ├── STL.h
        │   │   │   ├── StringList.h
        │   │   │   ├── TypeID.h
        │   │   │   ├── TypeInfo.h
        │   │   │   ├── TypeInfoImpl.h
        │   │   │   ├── Decorators/
        │   │   │   │   ├── ActionButton.h
        │   │   │   │   ├── BitFlags.h
        │   │   │   │   ├── BitFlagsImpl.h
        │   │   │   │   ├── JointName.h
        │   │   │   │   ├── JointNameImpl.h
        │   │   │   │   ├── LocalFrame.h
        │   │   │   │   ├── LocalFrameImpl.h
        │   │   │   │   ├── OutputFilePath.h
        │   │   │   │   ├── OutputFilePathImpl.h
        │   │   │   │   ├── Range.h
        │   │   │   │   ├── ResourceFilePath.h
        │   │   │   │   ├── ResourceFilePathImpl.h
        │   │   │   │   ├── ResourceFolderPath.h
        │   │   │   │   ├── ResourceFolderPathImpl.h
        │   │   │   │   ├── Resources.h
        │   │   │   │   ├── ResourcesAudio.h
        │   │   │   │   ├── ResourceSelector.h
        │   │   │   │   ├── TagList.h
        │   │   │   │   └── TagListImpl.h
        │   │   │   └── yasli/
        │   │   │       ├── Archive.h
        │   │   │       ├── Assert.h
        │   │   │       ├── BinArchive.h
        │   │   │       ├── BinArchiveImpl.h
        │   │   │       ├── BitVector.h
        │   │   │       ├── BitVectorImpl.h
        │   │   │       ├── BlackBox.h
        │   │   │       ├── Callback.h
        │   │   │       ├── ClassFactory.h
        │   │   │       ├── ClassFactoryBase.h
        │   │   │       ├── ClassFactoryImpl.h
        │   │   │       ├── Config.h
        │   │   │       ├── ConfigLocal.h
        │   │   │       ├── Enum.h
        │   │   │       ├── EnumImpl.h
        │   │   │       ├── Helpers.h
        │   │   │       ├── JSONIArchive.h
        │   │   │       ├── JSONIArchiveImpl.h
        │   │   │       ├── JSONOArchive.h
        │   │   │       ├── JSONOArchiveImpl.h
        │   │   │       ├── KeyValue.h
        │   │   │       ├── KeyValueDictionary.h
        │   │   │       ├── MemoryReader.h
        │   │   │       ├── MemoryReaderImpl.h
        │   │   │       ├── MemoryWriter.h
        │   │   │       ├── MemoryWriterImpl.h
        │   │   │       ├── Object.h
        │   │   │       ├── Pointers.h
        │   │   │       ├── PointersImpl.h
        │   │   │       ├── Serializer.h
        │   │   │       ├── SerializerImpl.h
        │   │   │       ├── STL.h
        │   │   │       ├── STLImpl.h
        │   │   │       ├── StringList.h
        │   │   │       ├── StringListImpl.h
        │   │   │       ├── TextIArchive.h
        │   │   │       ├── TextIArchiveImpl.h
        │   │   │       ├── TextOArchive.h
        │   │   │       ├── TextOArchiveImpl.h
        │   │   │       ├── Token.h
        │   │   │       ├── TypeID.h
        │   │   │       └── decorators/
        │   │   │           ├── BitFlags.h
        │   │   │           ├── BitFlagsImpl.h
        │   │   │           ├── Button.h
        │   │   │           ├── FileOpen.h
        │   │   │           ├── FileOpenImpl.h
        │   │   │           ├── FileSave.h
        │   │   │           ├── FileSaveImpl.h
        │   │   │           ├── HorizontalLine.h
        │   │   │           ├── IconXPM.h
        │   │   │           └── Range.h
        │   │   ├── CrySTL/
        │   │   │   ├── type_traits.h
        │   │   │   └── utility.h
        │   │   ├── CryString/
        │   │   │   ├── CompileTimeString.h
        │   │   │   ├── CryFixedString.h
        │   │   │   ├── CryName.h
        │   │   │   ├── CryPath.h
        │   │   │   ├── CryString.h
        │   │   │   ├── CryStringUtils.h
        │   │   │   ├── CryWinStringUtils.h
        │   │   │   ├── HashedString.h
        │   │   │   ├── Name_TypeInfo.h
        │   │   │   ├── NameCRCHelper.h
        │   │   │   ├── StringUtils.h
        │   │   │   ├── UnicodeBinding.h
        │   │   │   ├── UnicodeEncoding.h
        │   │   │   ├── UnicodeFunctions.h
        │   │   │   └── UnicodeIterator.h
        │   │   ├── CrySystem/
        │   │   │   ├── ConsoleRegistration.h
        │   │   │   ├── CryUtils.h
        │   │   │   ├── CryVersion.h
        │   │   │   ├── CVarOverride.h
        │   │   │   ├── IBudgetingSystem.h
        │   │   │   ├── ICmdLine.h
        │   │   │   ├── ICodeCheckpointMgr.h
        │   │   │   ├── IConsole.h
        │   │   │   ├── ICryLink.h
        │   │   │   ├── ICryMiniGUI.h
        │   │   │   ├── ICryPlugin.h
        │   │   │   ├── ICryPluginManager.h
        │   │   │   ├── IEngineModule.h
        │   │   │   ├── IImeManager.h
        │   │   │   ├── ILocalizationManager.h
        │   │   │   ├── ILog.h
        │   │   │   ├── IManualFrameStepController.h
        │   │   │   ├── IMiniLog.h
        │   │   │   ├── IOverloadSceneManager.h
        │   │   │   ├── IProcess.h
        │   │   │   ├── IProjectManager.h
        │   │   │   ├── IResourceCollector.h
        │   │   │   ├── IStreamEngine.h
        │   │   │   ├── IStreamEngineDefs.h
        │   │   │   ├── ISystem.h
        │   │   │   ├── ISystemScheduler.h
        │   │   │   ├── ITextModeConsole.h
        │   │   │   ├── ITimer.h
        │   │   │   ├── IValidator.h
        │   │   │   ├── IWindowMessageHandler.h
        │   │   │   ├── Pipe.h
        │   │   │   ├── SystemInitParams.h
        │   │   │   ├── Timer.h
        │   │   │   ├── TimeValue.h
        │   │   │   ├── TimeValue_info.h
        │   │   │   ├── Examples/
        │   │   │   │   ├── AsyncHMDCameraCallback.cpp
        │   │   │   │   ├── ConsoleCommand.cpp
        │   │   │   │   ├── ConsoleVariable.cpp
        │   │   │   │   ├── JsonSerialization.cpp
        │   │   │   │   ├── MinimalPlugin.cpp
        │   │   │   │   ├── XmlParsing.cpp
        │   │   │   │   └── XmlWriting.cpp
        │   │   │   ├── File/
        │   │   │   │   ├── CryBufferedFileReader.h
        │   │   │   │   ├── CryFile.h
        │   │   │   │   ├── IAVI_Reader.h
        │   │   │   │   ├── ICryPak.h
        │   │   │   │   ├── IFileChangeMonitor.h
        │   │   │   │   ├── IResourceManager.h
        │   │   │   │   └── LineStreamBuffer.h
        │   │   │   ├── Profilers/
        │   │   │   │   ├── CryMemReplay.h
        │   │   │   │   ├── CryMemReplayTrackedPtr.h
        │   │   │   │   ├── ICryProfilingSystem.h
        │   │   │   │   ├── IDiskProfiler.h
        │   │   │   │   ├── ILegacyProfiler.h
        │   │   │   │   ├── IPerfHud.h
        │   │   │   │   ├── IStatoscope.h
        │   │   │   │   ├── SamplerStats.h
        │   │   │   │   └── SamplesHistory.h
        │   │   │   ├── Scaleform/
        │   │   │   │   ├── ConfigScaleform.h
        │   │   │   │   ├── ConfigScaleform_impl.h
        │   │   │   │   ├── GMemorySTLAlloc.h
        │   │   │   │   ├── IFlashPlayer.h
        │   │   │   │   ├── IFlashUI.h
        │   │   │   │   ├── IScaleformHelper.h
        │   │   │   │   └── IUIFramework.h
        │   │   │   ├── Testing/
        │   │   │   │   ├── Command.h
        │   │   │   │   ├── CryTest.h
        │   │   │   │   ├── CryTestCommands.h
        │   │   │   │   ├── ITestReporter.h
        │   │   │   │   ├── ITestSystem.h
        │   │   │   │   └── TestInfo.h
        │   │   │   ├── VR/
        │   │   │   │   ├── IHMDDevice.h
        │   │   │   │   └── IHMDManager.h
        │   │   │   ├── XML/
        │   │   │   │   ├── IReadWriteXMLSink.h
        │   │   │   │   ├── IXml.h
        │   │   │   │   ├── XMLAttrReader.h
        │   │   │   │   └── XMLBinaryHeaders.h
        │   │   │   └── ZLib/
        │   │   │       ├── ILZ4Decompressor.h
        │   │   │       ├── IZLibCompressor.h
        │   │   │       └── IZlibDecompressor.h
        │   │   ├── CryThreading/
        │   │   │   ├── CryAtomics.h
        │   │   │   ├── CryAtomics_impl_win32.h
        │   │   │   ├── CryAtomics_posix.h
        │   │   │   ├── CryAtomics_win32.h
        │   │   │   ├── CryThread.h
        │   │   │   ├── CryThread_dummy.h
        │   │   │   ├── CryThread_posix.h
        │   │   │   ├── CryThread_win32.h
        │   │   │   ├── CryThreadImpl.h
        │   │   │   ├── CryThreadImpl_posix.h
        │   │   │   ├── CryThreadImpl_win32.h
        │   │   │   ├── CryThreadSafePushContainer.h
        │   │   │   ├── Debug.h
        │   │   │   ├── IJobManager.h
        │   │   │   ├── IJobManager_JobDelegator.h
        │   │   │   ├── IThreadConfigManager.h
        │   │   │   ├── IThreadManager.h
        │   │   │   ├── MultiThread_Containers.h
        │   │   │   └── Synchronization.h
        │   │   ├── CryType/
        │   │   │   ├── Type.h
        │   │   │   ├── TypeFunctions.h
        │   │   │   ├── TypeOperators.h
        │   │   │   ├── TypeTraits.h
        │   │   │   └── TypeUtils.h
        │   │   ├── CryUDR/
        │   │   │   ├── InterfaceIncludes.h
        │   │   │   ├── IUDR.h
        │   │   │   ├── IUDRSystem.h
        │   │   │   ├── Prerequisites.h
        │   │   │   ├── client/
        │   │   │   │   └── Scope.h
        │   │   │   ├── core/
        │   │   │   │   ├── ILogMessageCollection.h
        │   │   │   │   ├── INode.h
        │   │   │   │   ├── INodeStack.h
        │   │   │   │   ├── IRecursiveSyncObject.h
        │   │   │   │   ├── IRenderPrimitiveCollection.h
        │   │   │   │   ├── ITree.h
        │   │   │   │   ├── ITreeListener.h
        │   │   │   │   └── ITreeManager.h
        │   │   │   ├── Examples/
        │   │   │   │   └── SpidersExample.cpp
        │   │   │   └── shared/
        │   │   │       ├── IString.h
        │   │   │       ├── ITimeMetadata.h
        │   │   │       ├── RecursiveSyncObjectAutoLock.h
        │   │   │       └── String.h
        │   │   └── CryUtils/
        │   │       ├── CompileTime.h
        │   │       ├── Debug.h
        │   │       ├── Flags.h
        │   │       └── Index.h
        │   ├── CryDynamicResponseSystem/
        │   │   ├── ActionCancelSignal.cpp
        │   │   ├── ActionCancelSignal.h
        │   │   ├── ActionCopyVariable.cpp
        │   │   ├── ActionCopyVariable.h
        │   │   ├── ActionExecuteResponse.cpp
        │   │   ├── ActionExecuteResponse.h
        │   │   ├── ActionResetTimer.cpp
        │   │   ├── ActionResetTimer.h
        │   │   ├── ActionSendSignal.cpp
        │   │   ├── ActionSendSignal.h
        │   │   ├── ActionSetActor.cpp
        │   │   ├── ActionSetActor.h
        │   │   ├── ActionSetGameToken.cpp
        │   │   ├── ActionSetGameToken.h
        │   │   ├── ActionSetVariable.cpp
        │   │   ├── ActionSetVariable.h
        │   │   ├── ActionSpeakLine.cpp
        │   │   ├── ActionSpeakLine.h
        │   │   ├── ActionWait.cpp
        │   │   ├── ActionWait.h
        │   │   ├── CMakeLists.txt
        │   │   ├── ConditionImpl.cpp
        │   │   ├── ConditionImpl.h
        │   │   ├── ConditionsCollection.cpp
        │   │   ├── ConditionsCollection.h
        │   │   ├── CryDynamicResponseSystem.cpp
        │   │   ├── CryDynamicResponseSystem.rc
        │   │   ├── crydynamicresponsesystem.waf_files
        │   │   ├── DelayActionAction.cpp
        │   │   ├── DelayActionAction.h
        │   │   ├── DialogLineDatabase.cpp
        │   │   ├── DialogLineDatabase.h
        │   │   ├── resource.h
        │   │   ├── Response.cpp
        │   │   ├── Response.h
        │   │   ├── ResponseInstance.cpp
        │   │   ├── ResponseInstance.h
        │   │   ├── ResponseManager.cpp
        │   │   ├── ResponseManager.h
        │   │   ├── ResponseSegment.cpp
        │   │   ├── ResponseSegment.h
        │   │   ├── ResponseSystem.cpp
        │   │   ├── ResponseSystem.h
        │   │   ├── ResponseSystemDataImportHelper.cpp
        │   │   ├── ResponseSystemDataImportHelper.h
        │   │   ├── ResponseSystemDebugDataProvider.cpp
        │   │   ├── ResponseSystemDebugDataProvider.h
        │   │   ├── SchematycEntityDrsComponent.cpp
        │   │   ├── SchematycEntityDrsComponent.h
        │   │   ├── SpeakerManager.cpp
        │   │   ├── SpeakerManager.h
        │   │   ├── SpecialConditionsImpl.cpp
        │   │   ├── SpecialConditionsImpl.h
        │   │   ├── stdafx.cpp
        │   │   ├── stdafx.h
        │   │   ├── Variable.cpp
        │   │   ├── Variable.h
        │   │   ├── VariableCollection.cpp
        │   │   ├── VariableCollection.h
        │   │   ├── VariableValue.cpp
        │   │   ├── VariableValue.h
        │   │   └── wscript
        │   ├── CryEntitySystem/
        │   │   ├── AffineParts.cpp
        │   │   ├── AffineParts.h
        │   │   ├── Area.cpp
        │   │   ├── Area.h
        │   │   ├── AreaGrid.cpp
        │   │   ├── AreaGrid.h
        │   │   ├── AreaManager.cpp
        │   │   ├── AreaManager.h
        │   │   ├── AreaProxy.cpp
        │   │   ├── AreaProxy.h
        │   │   ├── AreaSolid.cpp
        │   │   ├── AreaSolid.h
        │   │   ├── AreaUtil.h
        │   │   ├── BreakableManager.cpp
        │   │   ├── BreakableManager.h
        │   │   ├── BreakablePlane.cpp
        │   │   ├── BreakablePlane.h
        │   │   ├── BSPTree3D.cpp
        │   │   ├── BSPTree3D.h
        │   │   ├── CameraProxy.cpp
        │   │   ├── CameraProxy.h
        │   │   ├── CharacterBoneAttachmentManager.cpp
        │   │   ├── CharacterBoneAttachmentManager.h
        │   │   ├── ClipVolumeProxy.cpp
        │   │   ├── ClipVolumeProxy.h
        │   │   ├── CMakeLists.txt
        │   │   ├── CryEntityDLL.cpp
        │   │   ├── CryEntitySystem.rc
        │   │   ├── cryentitysystem.waf_files
        │   │   ├── DynamicResponseProxy.cpp
        │   │   ├── DynamicResponseProxy.h
        │   │   ├── Entity.cpp
        │   │   ├── Entity.h
        │   │   ├── EntityArchetype.cpp
        │   │   ├── EntityArchetype.h
        │   │   ├── EntityAudioProxy.cpp
        │   │   ├── EntityAudioProxy.h
        │   │   ├── EntityClass.cpp
        │   │   ├── EntityClass.h
        │   │   ├── EntityClassRegistry.cpp
        │   │   ├── EntityClassRegistry.h
        │   │   ├── EntityComponentsCache.cpp
        │   │   ├── EntityComponentsCache.h
        │   │   ├── EntityComponentsVector.cpp
        │   │   ├── EntityComponentsVector.h
        │   │   ├── EntityCVars.cpp
        │   │   ├── EntityCVars.h
        │   │   ├── EntityIt.h
        │   │   ├── EntityLayer.cpp
        │   │   ├── EntityLayer.h
        │   │   ├── EntityLoadManager.cpp
        │   │   ├── EntityLoadManager.h
        │   │   ├── EntityNodeProxy.cpp
        │   │   ├── EntityNodeProxy.h
        │   │   ├── EntityScript.cpp
        │   │   ├── EntityScript.h
        │   │   ├── EntitySlot.cpp
        │   │   ├── EntitySlot.h
        │   │   ├── EntitySystem.cpp
        │   │   ├── EntitySystem.h
        │   │   ├── EntityUnitTests.cpp
        │   │   ├── EntityUnitTests.h
        │   │   ├── FlowGraphComponent.cpp
        │   │   ├── FlowGraphComponent.h
        │   │   ├── FlowGraphProxy.cpp
        │   │   ├── FlowGraphProxy.h
        │   │   ├── GeomCacheAttachmentManager.cpp
        │   │   ├── GeomCacheAttachmentManager.h
        │   │   ├── NetEntity.cpp
        │   │   ├── NetEntity.h
        │   │   ├── PartitionGrid.cpp
        │   │   ├── PartitionGrid.h
        │   │   ├── PhysicsEventListener.cpp
        │   │   ├── PhysicsEventListener.h
        │   │   ├── PhysicsProxy.cpp
        │   │   ├── PhysicsProxy.h
        │   │   ├── ProximityTriggerSystem.cpp
        │   │   ├── ProximityTriggerSystem.h
        │   │   ├── RadixSort.cpp
        │   │   ├── RadixSort.h
        │   │   ├── RenderProxy.cpp
        │   │   ├── RenderProxy.h
        │   │   ├── resource.h
        │   │   ├── RopeProxy.cpp
        │   │   ├── RopeProxy.h
        │   │   ├── SaltBufferArray.h
        │   │   ├── ScriptBind_Entity.h
        │   │   ├── ScriptProperties.cpp
        │   │   ├── ScriptProperties.h
        │   │   ├── ScriptProxy.cpp
        │   │   ├── ScriptProxy.h
        │   │   ├── stdafx.cpp
        │   │   ├── stdafx.h
        │   │   ├── SubstitutionProxy.cpp
        │   │   ├── SubstitutionProxy.h
        │   │   ├── TriggerProxy.cpp
        │   │   ├── TriggerProxy.h
        │   │   ├── wscript
        │   │   └── Schematyc/
        │   │       ├── EntityObjectDebugger.cpp
        │   │       ├── EntityObjectDebugger.h
        │   │       ├── EntitySchematycActions.h
        │   │       ├── EntitySchematycUtilFunctions.h
        │   │       ├── EntityUtilsComponent.cpp
        │   │       └── EntityUtilsComponent.h
        │   ├── CryFlowGraph/
        │   │   ├── CMakeLists.txt
        │   │   ├── cryflowgraph.waf_files
        │   │   ├── FlowGraphModule.cpp
        │   │   ├── HelperFunctions.h
        │   │   ├── resource.h
        │   │   ├── StdAfx.cpp
        │   │   ├── StdAfx.h
        │   │   ├── wscript
        │   │   ├── FlowSystem/
        │   │   │   ├── FlowData.cpp
        │   │   │   ├── FlowData.h
        │   │   │   ├── FlowGraph.cpp
        │   │   │   ├── FlowGraph.h
        │   │   │   ├── FlowGraphDebugger.cpp
        │   │   │   ├── FlowGraphDebugger.h
        │   │   │   ├── FlowSerialize.cpp
        │   │   │   ├── FlowSerialize.h
        │   │   │   ├── FlowSystem.cpp
        │   │   │   ├── FlowSystem.h
        │   │   │   ├── FlowSystemCVars.cpp
        │   │   │   ├── FlowSystemCVars.h
        │   │   │   ├── Inspectors/
        │   │   │   │   ├── FlowFilters.cpp
        │   │   │   │   ├── FlowFilters.h
        │   │   │   │   ├── FlowInspectorDefault.cpp
        │   │   │   │   └── FlowInspectorDefault.h
        │   │   │   ├── Modules/
        │   │   │   │   ├── FlowModuleNodes.cpp
        │   │   │   │   ├── FlowModuleNodes.h
        │   │   │   │   ├── Module.cpp
        │   │   │   │   ├── Module.h
        │   │   │   │   ├── ModuleManager.cpp
        │   │   │   │   └── ModuleManager.h
        │   │   │   ├── Nodes/
        │   │   │   │   ├── AnimationEventListenerNode.cpp
        │   │   │   │   ├── ColorGradientNode_Test.cpp
        │   │   │   │   ├── ComputeLightingNode.cpp
        │   │   │   │   ├── EntitiesInRangeNode.cpp
        │   │   │   │   ├── FlowActionMapNodes.cpp
        │   │   │   │   ├── FlowAttachmentNodes.cpp
        │   │   │   │   ├── FlowAudioDefaultTriggerNode.cpp
        │   │   │   │   ├── FlowAudioParameter.cpp
        │   │   │   │   ├── FlowAudioPreload.cpp
        │   │   │   │   ├── FlowAudioPreloadData.cpp
        │   │   │   │   ├── FlowAudioRtpcNode.cpp
        │   │   │   │   ├── FlowAudioSettingNode.cpp
        │   │   │   │   ├── FlowAudioSwitchNode.cpp
        │   │   │   │   ├── FlowAudioSwitchStateNode.cpp
        │   │   │   │   ├── FlowAudioTriggerNode.cpp
        │   │   │   │   ├── FlowAudioTriggerWithCallbacksNode.cpp
        │   │   │   │   ├── FlowAutoNoiseNodes.cpp
        │   │   │   │   ├── FlowBaseXmlNode.cpp
        │   │   │   │   ├── FlowBaseXmlNode.h
        │   │   │   │   ├── FlowCameraNodes.cpp
        │   │   │   │   ├── FlowClipCaptureNodes.cpp
        │   │   │   │   ├── FlowCompositeNode.cpp
        │   │   │   │   ├── FlowCompositeNode.h
        │   │   │   │   ├── FlowConditionNode.cpp
        │   │   │   │   ├── FlowContainerNode.cpp
        │   │   │   │   ├── FlowCustomActionNodes.cpp
        │   │   │   │   ├── FlowCustomActionNodes.h
        │   │   │   │   ├── FlowCVarsNode.cpp
        │   │   │   │   ├── FlowDebugNodes.cpp
        │   │   │   │   ├── FlowDelayNode.cpp
        │   │   │   │   ├── FlowDelayNode.h
        │   │   │   │   ├── FlowDynamicResponseSignal.cpp
        │   │   │   │   ├── FlowDynamicResponseVariable.cpp
        │   │   │   │   ├── FlowEngineEffectsNodes.cpp
        │   │   │   │   ├── FlowEngineNodes.cpp
        │   │   │   │   ├── FlowEntityIterator.cpp
        │   │   │   │   ├── FlowEntityNode.cpp
        │   │   │   │   ├── FlowEntityNode.h
        │   │   │   │   ├── FlowEnvironmentNodes.cpp
        │   │   │   │   ├── FlowExecuteStringNode.cpp
        │   │   │   │   ├── FlowFlashInvokeNode.cpp
        │   │   │   │   ├── FlowFrameworkBaseNode.h
        │   │   │   │   ├── FlowGameNodes.cpp
        │   │   │   │   ├── FlowGameVolumesNodes.cpp
        │   │   │   │   ├── FlowGeometryNodes.cpp
        │   │   │   │   ├── FlowHUDNodes.cpp
        │   │   │   │   ├── FlowInputNode.cpp
        │   │   │   │   ├── FlowInterpolNodes.cpp
        │   │   │   │   ├── FlowInventoryNodes.cpp
        │   │   │   │   ├── FlowKinectNodesDurango.cpp
        │   │   │   │   ├── FlowLogicNodes.cpp
        │   │   │   │   ├── FlowLogNode.cpp
        │   │   │   │   ├── FlowLogNode.h
        │   │   │   │   ├── FlowMaterialNodes.cpp
        │   │   │   │   ├── FlowMathNodes.cpp
        │   │   │   │   ├── FlowMissionNodes.cpp
        │   │   │   │   ├── FlowMouseInfo.cpp
        │   │   │   │   ├── FlowMovieNodes.cpp
        │   │   │   │   ├── FlowNodeAI.cpp
        │   │   │   │   ├── FlowNodeAIAction.cpp
        │   │   │   │   ├── FlowNodeAIAction.h
        │   │   │   │   ├── FlowNodeStereoparameters.cpp
        │   │   │   │   ├── FlowNoiseNodes.cpp
        │   │   │   │   ├── FlowNoiseNodes.h
        │   │   │   │   ├── FlowOnlineStatsNodes.cpp
        │   │   │   │   ├── FlowParticle.cpp
        │   │   │   │   ├── FlowPhysicsNodes.cpp
        │   │   │   │   ├── FlowPlatformNode.cpp
        │   │   │   │   ├── FlowPrefabNodes.cpp
        │   │   │   │   ├── FlowPrefabNodes.h
        │   │   │   │   ├── FlowScriptedNode.cpp
        │   │   │   │   ├── FlowScriptedNode.h
        │   │   │   │   ├── FlowStartNode.cpp
        │   │   │   │   ├── FlowStartNode.h
        │   │   │   │   ├── FlowStatsNodes.cpp
        │   │   │   │   ├── FlowStringNodes.cpp
        │   │   │   │   ├── FlowTimeNode.cpp
        │   │   │   │   ├── FlowTrackEventNode.cpp
        │   │   │   │   ├── FlowTrackEventNode.h
        │   │   │   │   ├── FlowVRNodes.cpp
        │   │   │   │   ├── FlowWeaponNodes.cpp
        │   │   │   │   ├── FlowXmlDataNodes.cpp
        │   │   │   │   ├── FlowXmlFileNodes.cpp
        │   │   │   │   ├── FlowXmlNavNodes.cpp
        │   │   │   │   ├── GameTokenNode.cpp
        │   │   │   │   ├── IndexerNode.cpp
        │   │   │   │   ├── MultiplexerNode.cpp
        │   │   │   │   ├── OwnerAngularInterpolatorNode.cpp
        │   │   │   │   ├── OwnerAngularRotationNode.cpp
        │   │   │   │   ├── OwnerLinearInterpolatorNode.cpp
        │   │   │   │   ├── PlayCGANode.cpp
        │   │   │   │   └── PlaySequenceNode.cpp
        │   │   │   └── UnitTests/
        │   │   │       └── FlowGraphDebuggerUnitTests.cpp
        │   │   └── GameTokens/
        │   │       ├── GameToken.cpp
        │   │       ├── GameToken.h
        │   │       ├── GameTokenSystem.cpp
        │   │       ├── GameTokenSystem.h
        │   │       ├── ScriptBind_GameToken.cpp
        │   │       └── ScriptBind_GameToken.h
        │   ├── CryFont/
        │   │   ├── CMakeLists.txt
        │   │   ├── CryFont.cpp
        │   │   ├── CryFont.h
        │   │   ├── CryFont.rc
        │   │   ├── cryfont.waf_files
        │   │   ├── FBitmap.h
        │   │   ├── FFont.cpp
        │   │   ├── FFont.h
        │   │   ├── FFontXML.cpp
        │   │   ├── FontRenderer.cpp
        │   │   ├── FontRenderer.h
        │   │   ├── FontTexture.cpp
        │   │   ├── FontTexture.h
        │   │   ├── GlyphBitmap.cpp
        │   │   ├── GlyphBitmap.h
        │   │   ├── GlyphCache.cpp
        │   │   ├── GlyphCache.h
        │   │   ├── ICryFont.cpp
        │   │   ├── NullFont.cpp
        │   │   ├── NullFont.h
        │   │   ├── resource.h
        │   │   ├── StdAfx.cpp
        │   │   ├── StdAfx.h
        │   │   └── wscript
        │   ├── CryInput/
        │   │   ├── BaseInput.cpp
        │   │   ├── BaseInput.h
        │   │   ├── CMakeLists.txt
        │   │   ├── CryInput.cpp
        │   │   ├── CryInput.h
        │   │   ├── CryInput.rc
        │   │   ├── cryinput.waf_files
        │   │   ├── cryinput_dx.waf_files
        │   │   ├── cryinput_sdl.waf_files
        │   │   ├── cryinput_synergy.waf_files
        │   │   ├── DXInput.cpp
        │   │   ├── DXInput.h
        │   │   ├── DXInputDevice.cpp
        │   │   ├── DXInputDevice.h
        │   │   ├── EyeTrackerInput.cpp
        │   │   ├── EyeTrackerInput.h
        │   │   ├── InputCVars.cpp
        │   │   ├── InputCVars.h
        │   │   ├── InputDevice.cpp
        │   │   ├── InputDevice.h
        │   │   ├── Keyboard.cpp
        │   │   ├── Keyboard.h
        │   │   ├── KinectInputNULL.h
        │   │   ├── LinuxInput.cpp
        │   │   ├── LinuxInput.h
        │   │   ├── Mouse.cpp
        │   │   ├── Mouse.h
        │   │   ├── NaturalPointInputNULL.h
        │   │   ├── OrbisPadWin.h
        │   │   ├── resource.h
        │   │   ├── SDLKeyboard.cpp
        │   │   ├── SDLKeyboard.h
        │   │   ├── SDLMouse.cpp
        │   │   ├── SDLMouse.h
        │   │   ├── SDLPad.cpp
        │   │   ├── SDLPad.h
        │   │   ├── StdAfx.cpp
        │   │   ├── StdAfx.h
        │   │   ├── wscript
        │   │   ├── XInputDevice.cpp
        │   │   ├── XInputDevice.h
        │   │   ├── HeadmountedDevice/
        │   │   │   ├── HeadMountedDevice.cpp
        │   │   │   └── HeadMountedDevice.h
        │   │   └── Synergy/
        │   │       ├── SynergyContext.cpp
        │   │       ├── SynergyContext.h
        │   │       ├── SynergyKeyboard.cpp
        │   │       ├── SynergyKeyboard.h
        │   │       ├── SynergyMouse.cpp
        │   │       └── SynergyMouse.h
        │   ├── CryLiveCreate/
        │   │   ├── CMakeLists.txt
        │   │   ├── CryLiveCreate.cpp
        │   │   ├── CryLiveCreate.h
        │   │   ├── crylivecreate.waf_files
        │   │   ├── LiveCreate_Objects.cpp
        │   │   ├── LiveCreate_Objects.h
        │   │   ├── LiveCreate_System.cpp
        │   │   ├── LiveCreate_System.h
        │   │   ├── LiveCreateBuilds.h
        │   │   ├── LiveCreateCommands.h
        │   │   ├── LiveCreateHost.cpp
        │   │   ├── LiveCreateHost.h
        │   │   ├── LiveCreateManager.cpp
        │   │   ├── LiveCreateManager.h
        │   │   ├── LiveCreateNativeFile.cpp
        │   │   ├── LiveCreateNativeFile.h
        │   │   ├── LiveCreatePlatforms.sln
        │   │   ├── PlatformHandler_Any.cpp
        │   │   ├── PlatformHandler_Any.h
        │   │   ├── PlatformHandler_GamePC.cpp
        │   │   ├── PlatformHandler_GamePC.h
        │   │   ├── StdAfx.cpp
        │   │   ├── StdAfx.h
        │   │   ├── wscript
        │   │   └── Platform_Common/
        │   │       ├── PlatformHandlerBase.cpp
        │   │       └── PlatformHandlerBase.h
        │   ├── CryMovie/
        │   │   ├── AnimCameraNode.cpp
        │   │   ├── AnimCameraNode.h
        │   │   ├── AnimEnvironmentNode.cpp
        │   │   ├── AnimEnvironmentNode.h
        │   │   ├── AnimGeomCacheNode.cpp
        │   │   ├── AnimGeomCacheNode.h
        │   │   ├── AnimLightNode.cpp
        │   │   ├── AnimLightNode.h
        │   │   ├── AnimNode.cpp
        │   │   ├── AnimNode.h
        │   │   ├── AnimPostFXNode.cpp
        │   │   ├── AnimPostFXNode.h
        │   │   ├── AnimScreenFaderNode.cpp
        │   │   ├── AnimScreenFaderNode.h
        │   │   ├── AnimSequence.cpp
        │   │   ├── AnimSequence.h
        │   │   ├── AnimSplineTrack.cpp
        │   │   ├── AnimSplineTrack.h
        │   │   ├── AnimTrack.h
        │   │   ├── AudioNode.cpp
        │   │   ├── AudioNode.h
        │   │   ├── BoolTrack.cpp
        │   │   ├── BoolTrack.h
        │   │   ├── CharacterTrack.cpp
        │   │   ├── CharacterTrack.h
        │   │   ├── CMakeLists.txt
        │   │   ├── CommentNode.cpp
        │   │   ├── CommentNode.h
        │   │   ├── CompoundSplineTrack.cpp
        │   │   ├── CompoundSplineTrack.h
        │   │   ├── CryMovie.cpp
        │   │   ├── CryMovie.h
        │   │   ├── CryMovie.rc
        │   │   ├── crymovie.waf_files
        │   │   ├── CVarNode.cpp
        │   │   ├── CVarNode.h
        │   │   ├── EntityNode.cpp
        │   │   ├── EntityNode.h
        │   │   ├── EventNode.cpp
        │   │   ├── EventNode.h
        │   │   ├── GotoTrack.cpp
        │   │   ├── GotoTrack.h
        │   │   ├── LayerNode.cpp
        │   │   ├── LayerNode.h
        │   │   ├── LookAtTrack.cpp
        │   │   ├── LookAtTrack.h
        │   │   ├── MaterialNode.cpp
        │   │   ├── MaterialNode.h
        │   │   ├── Movie.cpp
        │   │   ├── Movie.h
        │   │   ├── resource.h
        │   │   ├── SceneNode.cpp
        │   │   ├── SceneNode.h
        │   │   ├── ScreenFaderTrack.cpp
        │   │   ├── ScreenFaderTrack.h
        │   │   ├── ScriptVarNode.cpp
        │   │   ├── ScriptVarNode.h
        │   │   ├── ShadowsSetupNode.cpp
        │   │   ├── ShadowsSetupNode.h
        │   │   ├── StdAfx.cpp
        │   │   ├── StdAfx.h
        │   │   ├── TCBSplineEx.h
        │   │   ├── TimeRangesTrack.cpp
        │   │   ├── TimeRangesTrack.h
        │   │   ├── Tracks.h
        │   │   └── wscript
        │   ├── CryNetwork/
        │   │   ├── AutoFreeHandle.h
        │   │   ├── CMakeLists.txt
        │   │   ├── Config.h
        │   │   ├── CryNetwork.cpp
        │   │   ├── CryNetwork.rc
        │   │   ├── crynetwork.waf_files
        │   │   ├── DistributedLogger.cpp
        │   │   ├── DistributedLogger.h
        │   │   ├── Errors.h
        │   │   ├── FixedSizeArena.h
        │   │   ├── INetworkMember.h
        │   │   ├── INetworkPrivate.h
        │   │   ├── MementoMemoryManager.cpp
        │   │   ├── MementoMemoryManager.h
        │   │   ├── NetCVars.cpp
        │   │   ├── NetCVars.h
        │   │   ├── NetDebugChannelViewer.cpp
        │   │   ├── NetDebugChannelViewer.h
        │   │   ├── NetDebugInfo.cpp
        │   │   ├── NetDebugInfo.h
        │   │   ├── NetDebugInternetSimulator.cpp
        │   │   ├── NetDebugInternetSimulator.h
        │   │   ├── NetDebugProfileViewer.cpp
        │   │   ├── NetDebugProfileViewer.h
        │   │   ├── NetDebugServerInfo.cpp
        │   │   ├── NetDebugServerInfo.h
        │   │   ├── NetDebugTrafficBandwidth.cpp
        │   │   ├── NetDebugTrafficBandwidth.h
        │   │   ├── NetLog.cpp
        │   │   ├── NetLog.h
        │   │   ├── NetProfile.cpp
        │   │   ├── NetProfile.h
        │   │   ├── NetTimer.cpp
        │   │   ├── NetTimer.h
        │   │   ├── Network.cpp
        │   │   ├── Network.h
        │   │   ├── objcnt.h
        │   │   ├── objcnt_defs.h
        │   │   ├── PolymorphicQueue.h
        │   │   ├── resource.h
        │   │   ├── StdAfx.cpp
        │   │   ├── StdAfx.h
        │   │   ├── STLMementoAllocator.h
        │   │   ├── Utils.cpp
        │   │   ├── Utils.h
        │   │   ├── WorkQueue.cpp
        │   │   ├── WorkQueue.h
        │   │   ├── wscript
        │   │   ├── Compression/
        │   │   │   ├── AdaptiveBoolPolicy.cpp
        │   │   │   ├── AdaptiveBoolPolicy2.cpp
        │   │   │   ├── AdaptiveFloat.cpp
        │   │   │   ├── AdaptiveFloat.h
        │   │   │   ├── AdaptiveFloatPolicy.cpp
        │   │   │   ├── AdaptiveOrientationPolicy.cpp
        │   │   │   ├── AdaptiveUnitVec3Policy.cpp
        │   │   │   ├── AdaptiveVec3Policy.cpp
        │   │   │   ├── AdaptiveVelocity.cpp
        │   │   │   ├── AdaptiveVelocity.h
        │   │   │   ├── AdaptiveVelocityPolicy.cpp
        │   │   │   ├── ArithAlphabet.cpp
        │   │   │   ├── ArithAlphabet.h
        │   │   │   ├── ArithModel.cpp
        │   │   │   ├── ArithModel.h
        │   │   │   ├── ArithPrimitives.cpp
        │   │   │   ├── ArithPrimitives.h
        │   │   │   ├── BiggerOrSmallerPolicy.cpp
        │   │   │   ├── BoolCompress.cpp
        │   │   │   ├── BoolCompress.h
        │   │   │   ├── BoolCompress2.cpp
        │   │   │   ├── BoolCompress2.h
        │   │   │   ├── CompressionManager.cpp
        │   │   │   ├── CompressionManager.h
        │   │   │   ├── CompressionPolicyTime.h
        │   │   │   ├── DefaultPolicy.cpp
        │   │   │   ├── EntityIdPolicy.cpp
        │   │   │   ├── ErrorDistributionEncoding.cpp
        │   │   │   ├── ErrorDistributionEncoding.h
        │   │   │   ├── FloatAsIntPolicy.cpp
        │   │   │   ├── GaussianEncoding.cpp
        │   │   │   ├── GaussianEncoding.h
        │   │   │   ├── GaussianEncoding_SlotData.h
        │   │   │   ├── ICompressionPolicy.h
        │   │   │   ├── ICompressionPolicy2.h
        │   │   │   ├── Int64Policy.cpp
        │   │   │   ├── IntegerValuePredictor.cpp
        │   │   │   ├── IntegerValuePredictor.h
        │   │   │   ├── JumpyPolicy.cpp
        │   │   │   ├── NoSendPolicy.cpp
        │   │   │   ├── OwnChannelCompressionPolicy.cpp
        │   │   │   ├── OwnChannelCompressionPolicy.h
        │   │   │   ├── PredictiveBase.h
        │   │   │   ├── PredictiveFloat.cpp
        │   │   │   ├── PredictiveFloat.h
        │   │   │   ├── PredictiveFloatTracker.cpp
        │   │   │   ├── PredictiveFloatTracker.h
        │   │   │   ├── QuantizedVec3.cpp
        │   │   │   ├── Quantizer.cpp
        │   │   │   ├── Quantizer.h
        │   │   │   ├── RangedIntPolicy.cpp
        │   │   │   ├── RangedIntPolicy.h
        │   │   │   ├── RangedUnsignedIntPolicy.cpp
        │   │   │   ├── RangedUnsignedIntPolicy.h
        │   │   │   ├── SegmentedCompressionSpace.cpp
        │   │   │   ├── SegmentedCompressionSpace.h
        │   │   │   ├── SerializationChunk.cpp
        │   │   │   ├── SerializationChunk.h
        │   │   │   ├── StationaryInteger.cpp
        │   │   │   ├── StationaryInteger.h
        │   │   │   ├── StationaryUnsignedInteger.cpp
        │   │   │   ├── StationaryUnsignedInteger.h
        │   │   │   ├── StringTable.cpp
        │   │   │   ├── StringTable.h
        │   │   │   ├── StringTablePolicy.cpp
        │   │   │   ├── TimePolicy.cpp
        │   │   │   ├── TimePolicy.h
        │   │   │   ├── TimePolicyWithDistribution.cpp
        │   │   │   ├── TimePolicyWithDistribution.h
        │   │   │   └── Vec3TableCompressor.cpp
        │   │   ├── Context/
        │   │   │   ├── Authentication.cpp
        │   │   │   ├── Authentication.h
        │   │   │   ├── BreakagePlayback.cpp
        │   │   │   ├── BreakagePlayback.h
        │   │   │   ├── CET_Server.cpp
        │   │   │   ├── CET_Server.h
        │   │   │   ├── ChangeList.h
        │   │   │   ├── ClientContextView.cpp
        │   │   │   ├── ClientContextView.h
        │   │   │   ├── ContextEstablisher.cpp
        │   │   │   ├── ContextEstablisher.h
        │   │   │   ├── ContextView.cpp
        │   │   │   ├── ContextView.h
        │   │   │   ├── ContextViewStateManager.cpp
        │   │   │   ├── ContextViewStateManager.h
        │   │   │   ├── DemoDefinitions.h
        │   │   │   ├── DemoPlaybackListener.cpp
        │   │   │   ├── DemoPlaybackListener.h
        │   │   │   ├── DemoRecordListener.cpp
        │   │   │   ├── DemoRecordListener.h
        │   │   │   ├── IContextViewExtension.h
        │   │   │   ├── INetContextListener.h
        │   │   │   ├── INetContextState.h
        │   │   │   ├── NetContext.cpp
        │   │   │   ├── NetContext.h
        │   │   │   ├── NetContextState.cpp
        │   │   │   ├── NetContextState.h
        │   │   │   ├── PerformBreakage.cpp
        │   │   │   ├── PerformBreakage.h
        │   │   │   ├── RMILogger.h
        │   │   │   ├── ServerContextView.cpp
        │   │   │   ├── ServerContextView.h
        │   │   │   ├── SessionID.cpp
        │   │   │   ├── SessionID.h
        │   │   │   ├── SyncContext.h
        │   │   │   ├── SyncedFile.cpp
        │   │   │   ├── SyncedFile.h
        │   │   │   ├── SyncedFilePak.cpp
        │   │   │   ├── SyncedFilePak.h
        │   │   │   ├── SyncedFileSet.cpp
        │   │   │   ├── SyncedFileSet.h
        │   │   │   ├── UpdateAspectDataContext.cpp
        │   │   │   ├── UpdateAspectDataContext.h
        │   │   │   ├── UpdateMessage.cpp
        │   │   │   ├── UpdateMessage.h
        │   │   │   ├── VoiceContext.cpp
        │   │   │   ├── VoiceContext.h
        │   │   │   └── History/
        │   │   │       ├── AuthorityHistory.cpp
        │   │   │       ├── AuthorityHistory.h
        │   │   │       ├── ConfigurationHistory.cpp
        │   │   │       ├── ConfigurationHistory.h
        │   │   │       ├── History.cpp
        │   │   │       ├── History.h
        │   │   │       ├── MementoHistory.cpp
        │   │   │       ├── MementoHistory.h
        │   │   │       ├── ProfileHistory.cpp
        │   │   │       ├── ProfileHistory.h
        │   │   │       ├── RegularlySyncedItem.cpp
        │   │   │       └── RegularlySyncedItem.h
        │   │   ├── Cryptography/
        │   │   │   ├── CngCrypto.cpp
        │   │   │   ├── CngCrypto.h
        │   │   │   ├── rijndael.cpp
        │   │   │   ├── rijndael.h
        │   │   │   ├── StreamCipher.cpp
        │   │   │   ├── StreamCipher.h
        │   │   │   ├── TomCryptCrypto.cpp
        │   │   │   ├── TomCryptCrypto.h
        │   │   │   ├── Whirlpool.cpp
        │   │   │   └── Whirlpool.h
        │   │   ├── DebugKit/
        │   │   │   ├── DebugKit.cpp
        │   │   │   ├── DebugKit.h
        │   │   │   ├── DebugOutput.cpp
        │   │   │   ├── DebugOutput.h
        │   │   │   ├── Encoding.cpp
        │   │   │   ├── Encoding.h
        │   │   │   ├── NetVis.cpp
        │   │   │   ├── NetVis.h
        │   │   │   ├── NetworkInspector.cpp
        │   │   │   └── NetworkInspector.h
        │   │   ├── Http/
        │   │   │   ├── AutoConfigDownloader.cpp
        │   │   │   ├── AutoConfigDownloader.h
        │   │   │   ├── cry_sha1.cpp
        │   │   │   ├── cry_sha1.h
        │   │   │   ├── SimpleHttpServer.cpp
        │   │   │   └── SimpleHttpServer.h
        │   │   ├── Protocol/
        │   │   │   ├── BandwidthCalculator.cpp
        │   │   │   ├── BandwidthCalculator.h
        │   │   │   ├── CTPEndpoint.cpp
        │   │   │   ├── CTPEndpoint.h
        │   │   │   ├── ExponentialKeyExchange.cpp
        │   │   │   ├── ExponentialKeyExchange.h
        │   │   │   ├── FrameTypes.cpp
        │   │   │   ├── FrameTypes.h
        │   │   │   ├── ICTPEndpointListener.h
        │   │   │   ├── INubMember.h
        │   │   │   ├── MessageMapper.cpp
        │   │   │   ├── MessageMapper.h
        │   │   │   ├── MessageQueue.cpp
        │   │   │   ├── MessageQueue.h
        │   │   │   ├── NetChannel.cpp
        │   │   │   ├── NetChannel.h
        │   │   │   ├── NetChannelSecurity.cpp
        │   │   │   ├── NetChannelSecurity.h
        │   │   │   ├── NetNub.cpp
        │   │   │   ├── NetNub.h
        │   │   │   ├── NewMessageQueue.cpp
        │   │   │   ├── NewMessageQueue.h
        │   │   │   ├── NullSendable.cpp
        │   │   │   ├── NullSendable.h
        │   │   │   ├── PacketRateCalculator.cpp
        │   │   │   ├── PacketRateCalculator.h
        │   │   │   ├── PMTUDiscovery.cpp
        │   │   │   ├── PMTUDiscovery.h
        │   │   │   ├── Serialize.cpp
        │   │   │   ├── Serialize.h
        │   │   │   ├── StatsCollector.cpp
        │   │   │   └── StatsCollector.h
        │   │   ├── RemoteControl/
        │   │   │   ├── Protocol.h
        │   │   │   ├── RemoteControl.cpp
        │   │   │   └── RemoteControl.h
        │   │   ├── Services/
        │   │   │   ├── ServiceManager.cpp
        │   │   │   ├── ServiceManager.h
        │   │   │   ├── CryLAN/
        │   │   │   │   ├── LanQueryListener.cpp
        │   │   │   │   └── LanQueryListener.h
        │   │   │   └── NetworkACL/
        │   │   │       ├── NetProfileTokens.cpp
        │   │   │       └── NetProfileTokens.h
        │   │   ├── Socket/
        │   │   │   ├── CompositeDatagramSocket.cpp
        │   │   │   ├── CompositeDatagramSocket.h
        │   │   │   ├── IDatagramSocket.cpp
        │   │   │   ├── IDatagramSocket.h
        │   │   │   ├── InternetSimulatorSocket.cpp
        │   │   │   ├── InternetSimulatorSocket.h
        │   │   │   ├── ISocketIOManager.cpp
        │   │   │   ├── ISocketIOManager.h
        │   │   │   ├── IStreamSocket.cpp
        │   │   │   ├── IStreamSocket.h
        │   │   │   ├── LocalDatagramSocket.cpp
        │   │   │   ├── LocalDatagramSocket.h
        │   │   │   ├── NetResolver.cpp
        │   │   │   ├── NetResolver.h
        │   │   │   ├── SocketError.cpp
        │   │   │   ├── SocketError.h
        │   │   │   ├── SocketIOManagerIOCP.cpp
        │   │   │   ├── SocketIOManagerIOCP.h
        │   │   │   ├── SocketIOManagerLobbyIDAddr.cpp
        │   │   │   ├── SocketIOManagerLobbyIDAddr.h
        │   │   │   ├── SocketIOManagerNull.h
        │   │   │   ├── SocketIOManagerSelect.cpp
        │   │   │   ├── SocketIOManagerSelect.h
        │   │   │   ├── TCPStreamSocket.cpp
        │   │   │   ├── TCPStreamSocket.h
        │   │   │   ├── UDPDatagramSocket.cpp
        │   │   │   ├── UDPDatagramSocket.h
        │   │   │   ├── WatchdogTimer.cpp
        │   │   │   └── WatchdogTimer.h
        │   │   ├── Streams/
        │   │   │   ├── ArithStream.h
        │   │   │   ├── ByteStream.cpp
        │   │   │   ├── ByteStream.h
        │   │   │   ├── CommStream.h
        │   │   │   ├── CompressingStream.cpp
        │   │   │   ├── CompressingStream.h
        │   │   │   ├── SimpleInputStream.cpp
        │   │   │   ├── SimpleInputStream.h
        │   │   │   ├── SimpleOutputStream.cpp
        │   │   │   ├── SimpleOutputStream.h
        │   │   │   └── SimpleStreamDefs.h
        │   │   └── VOIP/
        │   │       ├── IVoiceDecoder.cpp
        │   │       ├── IVoiceDecoder.h
        │   │       ├── IVoiceEncoder.cpp
        │   │       ├── IVoiceEncoder.h
        │   │       ├── IVoicePacketListener.h
        │   │       ├── SpeexCodec.cpp
        │   │       ├── VoiceManager.cpp
        │   │       ├── VoiceManager.h
        │   │       ├── VoicePacket.cpp
        │   │       └── VoicePacket.h
        │   ├── CryPhysics/
        │   │   ├── aabbtree.cpp
        │   │   ├── aabbtree.h
        │   │   ├── aabbtree_info.h
        │   │   ├── articulatedentity.cpp
        │   │   ├── articulatedentity.h
        │   │   ├── boolean2d.cpp
        │   │   ├── boolean3d.cpp
        │   │   ├── boxgeom.cpp
        │   │   ├── boxgeom.h
        │   │   ├── bvtree.h
        │   │   ├── capsulegeom.cpp
        │   │   ├── capsulegeom.h
        │   │   ├── CMakeLists.txt
        │   │   ├── CryPhysics.cpp
        │   │   ├── CryPhysics.rc
        │   │   ├── cryphysics.waf_files
        │   │   ├── cvars.cpp
        │   │   ├── cvars.h
        │   │   ├── cylindergeom.cpp
        │   │   ├── cylindergeom.h
        │   │   ├── geoman.cpp
        │   │   ├── geoman.h
        │   │   ├── geoman_info.h
        │   │   ├── geometries.h
        │   │   ├── geometry.cpp
        │   │   ├── geometry.h
        │   │   ├── heightfieldbv.cpp
        │   │   ├── heightfieldbv.h
        │   │   ├── heightfieldgeom.cpp
        │   │   ├── heightfieldgeom.h
        │   │   ├── intersectionchecks.cpp
        │   │   ├── intersectionchecks.h
        │   │   ├── linunprojectionchecks.cpp
        │   │   ├── livingentity.cpp
        │   │   ├── livingentity.h
        │   │   ├── matrixnm.cpp
        │   │   ├── matrixnm.h
        │   │   ├── obbtree.cpp
        │   │   ├── obbtree.h
        │   │   ├── obbtree_info.h
        │   │   ├── overlapchecks.cpp
        │   │   ├── overlapchecks.h
        │   │   ├── particleentity.cpp
        │   │   ├── particleentity.h
        │   │   ├── physarea.cpp
        │   │   ├── physicalentity.cpp
        │   │   ├── physicalentity.h
        │   │   ├── physicalplaceholder.cpp
        │   │   ├── physicalplaceholder.h
        │   │   ├── physicalworld.cpp
        │   │   ├── physicalworld.h
        │   │   ├── qhull.cpp
        │   │   ├── quotient.h
        │   │   ├── raybv.cpp
        │   │   ├── raybv.h
        │   │   ├── raygeom.cpp
        │   │   ├── raygeom.h
        │   │   ├── resource.h
        │   │   ├── rigidbody.cpp
        │   │   ├── rigidbody.h
        │   │   ├── rigidentity.cpp
        │   │   ├── rigidentity.h
        │   │   ├── ropeentity.cpp
        │   │   ├── ropeentity.h
        │   │   ├── rotunprojectionchecks.cpp
        │   │   ├── rwi.cpp
        │   │   ├── singleboxtree.cpp
        │   │   ├── singleboxtree.h
        │   │   ├── softentity.cpp
        │   │   ├── softentity.h
        │   │   ├── spheregeom.cpp
        │   │   ├── spheregeom.h
        │   │   ├── StdAfx.cpp
        │   │   ├── StdAfx.h
        │   │   ├── tetrlattice.cpp
        │   │   ├── tetrlattice.h
        │   │   ├── trimesh.cpp
        │   │   ├── trimesh.h
        │   │   ├── unprojectionchecks.h
        │   │   ├── utils.cpp
        │   │   ├── utils.h
        │   │   ├── vectorn.h
        │   │   ├── voxelbv.cpp
        │   │   ├── voxelbv.h
        │   │   ├── voxelgeom.cpp
        │   │   ├── voxelgeom.h
        │   │   ├── walkingrigidentity.cpp
        │   │   ├── walkingrigidentity.h
        │   │   ├── waterman.cpp
        │   │   ├── waterman.h
        │   │   ├── wheeledvehicleentity.cpp
        │   │   ├── wheeledvehicleentity.h
        │   │   ├── worldump.cpp
        │   │   └── wscript
        │   ├── CryPhysicsSystem/
        │   │   ├── wscript
        │   │   └── CryPhysX/
        │   │       ├── articulatedent.cpp
        │   │       ├── baseent.cpp
        │   │       ├── clothent.cpp
        │   │       ├── CMakeLists.txt
        │   │       ├── CryPhysics.cpp
        │   │       ├── cryphysics.waf_files
        │   │       ├── CryPhysX.cpp
        │   │       ├── CryPhysX.h
        │   │       ├── entities.h
        │   │       ├── geometries.cpp
        │   │       ├── geometries.h
        │   │       ├── livingent.cpp
        │   │       ├── projectileent.cpp
        │   │       ├── resource.h
        │   │       ├── ropeent.cpp
        │   │       ├── StdAfx.cpp
        │   │       ├── StdAfx.h
        │   │       ├── vehicleent.cpp
        │   │       ├── world.cpp
        │   │       ├── world.h
        │   │       └── wscript
        │   ├── CrySchematyc/
        │   │   ├── Readme.txt
        │   │   ├── CMakeLists.txt
        │   │   ├── wscript
        │   │   └── Core/
        │   │       ├── wscript
        │   │       └── Impl/
        │   │           ├── CMakeLists.txt
        │   │           ├── Core.cpp
        │   │           ├── Core.h
        │   │           ├── core.waf_files
        │   │           ├── CVars.cpp
        │   │           ├── CVars.h
        │   │           ├── Object.cpp
        │   │           ├── Object.h
        │   │           ├── ObjectPool.cpp
        │   │           ├── ObjectPool.h
        │   │           ├── ObjectProperties.cpp
        │   │           ├── ObjectProperties.h
        │   │           ├── resource.h
        │   │           ├── StdAfx.cpp
        │   │           ├── StdAfx.h
        │   │           ├── wscript
        │   │           ├── Compiler/
        │   │           │   ├── Compiler.cpp
        │   │           │   ├── Compiler.h
        │   │           │   ├── CompilerTaskList.cpp
        │   │           │   └── CompilerTaskList.h
        │   │           ├── CoreEnv/
        │   │           │   ├── CoreEnv.cpp
        │   │           │   ├── CoreEnv.h
        │   │           │   ├── CoreEnvSignals.cpp
        │   │           │   ├── CoreEnvSignals.h
        │   │           │   ├── Functions/
        │   │           │   │   ├── BasicFunctions.cpp
        │   │           │   │   ├── CameraFunctions.cpp
        │   │           │   │   ├── LogFunctions.cpp
        │   │           │   │   └── MathFunctions.cpp
        │   │           │   └── Types/
        │   │           │       ├── BasicTypes.cpp
        │   │           │       ├── MathTypes.cpp
        │   │           │       └── ResourceTypes.cpp
        │   │           ├── Env/
        │   │           │   ├── EnvRegistry.cpp
        │   │           │   └── EnvRegistry.h
        │   │           ├── Runtime/
        │   │           │   ├── RuntimeClass.cpp
        │   │           │   ├── RuntimeClass.h
        │   │           │   ├── RuntimeRegistry.cpp
        │   │           │   └── RuntimeRegistry.h
        │   │           ├── Script/
        │   │           │   ├── Script.cpp
        │   │           │   ├── Script.h
        │   │           │   ├── ScriptElementBase.h
        │   │           │   ├── ScriptElementFactory.cpp
        │   │           │   ├── ScriptElementFactory.h
        │   │           │   ├── ScriptEnumValue.cpp
        │   │           │   ├── ScriptEnumValue.h
        │   │           │   ├── ScriptExtensionMap.cpp
        │   │           │   ├── ScriptExtensionMap.h
        │   │           │   ├── ScriptParam.cpp
        │   │           │   ├── ScriptParam.h
        │   │           │   ├── ScriptRegistry.cpp
        │   │           │   ├── ScriptRegistry.h
        │   │           │   ├── ScriptSerializers.cpp
        │   │           │   ├── ScriptSerializers.h
        │   │           │   ├── ScriptStructValue.cpp
        │   │           │   ├── ScriptStructValue.h
        │   │           │   ├── ScriptUserDocumentation.cpp
        │   │           │   ├── ScriptUserDocumentation.h
        │   │           │   ├── ScriptVariableData.cpp
        │   │           │   ├── ScriptVariableData.h
        │   │           │   ├── ScriptView.cpp
        │   │           │   ├── ScriptView.h
        │   │           │   ├── Elements/
        │   │           │   │   ├── ScriptActionInstance.cpp
        │   │           │   │   ├── ScriptActionInstance.h
        │   │           │   │   ├── ScriptBase.cpp
        │   │           │   │   ├── ScriptBase.h
        │   │           │   │   ├── ScriptClass.cpp
        │   │           │   │   ├── ScriptClass.h
        │   │           │   │   ├── ScriptComponentInstance.cpp
        │   │           │   │   ├── ScriptComponentInstance.h
        │   │           │   │   ├── ScriptConstructor.cpp
        │   │           │   │   ├── ScriptConstructor.h
        │   │           │   │   ├── ScriptEnum.cpp
        │   │           │   │   ├── ScriptEnum.h
        │   │           │   │   ├── ScriptFunction.cpp
        │   │           │   │   ├── ScriptFunction.h
        │   │           │   │   ├── ScriptInterface.cpp
        │   │           │   │   ├── ScriptInterface.h
        │   │           │   │   ├── ScriptInterfaceFunction.cpp
        │   │           │   │   ├── ScriptInterfaceFunction.h
        │   │           │   │   ├── ScriptInterfaceImpl.cpp
        │   │           │   │   ├── ScriptInterfaceImpl.h
        │   │           │   │   ├── ScriptInterfaceTask.cpp
        │   │           │   │   ├── ScriptInterfaceTask.h
        │   │           │   │   ├── ScriptModule.cpp
        │   │           │   │   ├── ScriptModule.h
        │   │           │   │   ├── ScriptRoot.cpp
        │   │           │   │   ├── ScriptRoot.h
        │   │           │   │   ├── ScriptSignal.cpp
        │   │           │   │   ├── ScriptSignal.h
        │   │           │   │   ├── ScriptSignalReceiver.cpp
        │   │           │   │   ├── ScriptSignalReceiver.h
        │   │           │   │   ├── ScriptState.cpp
        │   │           │   │   ├── ScriptState.h
        │   │           │   │   ├── ScriptStateMachine.cpp
        │   │           │   │   ├── ScriptStateMachine.h
        │   │           │   │   ├── ScriptStruct.cpp
        │   │           │   │   ├── ScriptStruct.h
        │   │           │   │   ├── ScriptTimer.cpp
        │   │           │   │   ├── ScriptTimer.h
        │   │           │   │   ├── ScriptVariable.cpp
        │   │           │   │   └── ScriptVariable.h
        │   │           │   └── Graph/
        │   │           │       ├── ScriptGraph.cpp
        │   │           │       ├── ScriptGraph.h
        │   │           │       ├── ScriptGraphNode.cpp
        │   │           │       ├── ScriptGraphNode.h
        │   │           │       ├── ScriptGraphNodeFactory.cpp
        │   │           │       ├── ScriptGraphNodeFactory.h
        │   │           │       ├── ScriptGraphNodeModel.cpp
        │   │           │       ├── ScriptGraphNodeModel.h
        │   │           │       └── Nodes/
        │   │           │           ├── ScriptGraphActionNode.cpp
        │   │           │           ├── ScriptGraphActionNode.h
        │   │           │           ├── ScriptGraphArrayAddNode.cpp
        │   │           │           ├── ScriptGraphArrayAddNode.h
        │   │           │           ├── ScriptGraphArrayForEachNode.cpp
        │   │           │           ├── ScriptGraphArrayForEachNode.h
        │   │           │           ├── ScriptGraphArrayRemoveByValueNode.cpp
        │   │           │           ├── ScriptGraphArrayRemoveByValueNode.h
        │   │           │           ├── ScriptGraphBeginNode.cpp
        │   │           │           ├── ScriptGraphBeginNode.h
        │   │           │           ├── ScriptGraphBranchNode.cpp
        │   │           │           ├── ScriptGraphBranchNode.h
        │   │           │           ├── ScriptGraphExpandSignalNode.cpp
        │   │           │           ├── ScriptGraphExpandSignalNode.h
        │   │           │           ├── ScriptGraphFormatStringNode.cpp
        │   │           │           ├── ScriptGraphFormatStringNode.h
        │   │           │           ├── ScriptGraphForNode.cpp
        │   │           │           ├── ScriptGraphForNode.h
        │   │           │           ├── ScriptGraphFunctionNode.cpp
        │   │           │           ├── ScriptGraphFunctionNode.h
        │   │           │           ├── ScriptGraphGetEntityIdNode.cpp
        │   │           │           ├── ScriptGraphGetEntityIdNode.h
        │   │           │           ├── ScriptGraphGetNode.cpp
        │   │           │           ├── ScriptGraphGetNode.h
        │   │           │           ├── ScriptGraphGetObjectIdNode.cpp
        │   │           │           ├── ScriptGraphGetObjectIdNode.h
        │   │           │           ├── ScriptGraphReceiveSignalNode.cpp
        │   │           │           ├── ScriptGraphReceiveSignalNode.h
        │   │           │           ├── ScriptGraphReturnNode.cpp
        │   │           │           ├── ScriptGraphReturnNode.h
        │   │           │           ├── ScriptGraphSendSignalNode.cpp
        │   │           │           ├── ScriptGraphSendSignalNode.h
        │   │           │           ├── ScriptGraphSequenceNode.cpp
        │   │           │           ├── ScriptGraphSequenceNode.h
        │   │           │           ├── ScriptGraphSetNode.cpp
        │   │           │           ├── ScriptGraphSetNode.h
        │   │           │           ├── ScriptGraphStateNode.cpp
        │   │           │           ├── ScriptGraphStateNode.h
        │   │           │           ├── ScriptGraphSwitchNode.cpp
        │   │           │           └── ScriptGraphSwitchNode.h
        │   │           ├── SerializationUtils/
        │   │           │   ├── SerializationContext.cpp
        │   │           │   ├── SerializationContext.h
        │   │           │   ├── ValidatorArchive.cpp
        │   │           │   └── ValidatorArchive.h
        │   │           ├── Services/
        │   │           │   ├── Log.cpp
        │   │           │   ├── Log.h
        │   │           │   ├── LogRecorder.cpp
        │   │           │   ├── LogRecorder.h
        │   │           │   ├── SettingsManager.cpp
        │   │           │   ├── SettingsManager.h
        │   │           │   ├── TimerSystem.cpp
        │   │           │   ├── TimerSystem.h
        │   │           │   ├── UpdateScheduler.cpp
        │   │           │   └── UpdateScheduler.h
        │   │           ├── UnitTests/
        │   │           │   ├── ReflectionUnitTests.cpp
        │   │           │   ├── RuntimeUnitTests.cpp
        │   │           │   ├── StringUnitTests.cpp
        │   │           │   ├── UnitTestRegistrar.cpp
        │   │           │   └── UnitTestRegistrar.h
        │   │           └── Utils/
        │   │               ├── FileUtils.cpp
        │   │               ├── FileUtils.h
        │   │               ├── GUIDRemapper.cpp
        │   │               ├── GUIDRemapper.h
        │   │               └── InterfaceMap.h
        │   ├── CryScriptSystem/
        │   │   ├── BucketAllocator.h
        │   │   ├── CMakeLists.txt
        │   │   ├── CryScriptSystem.cpp
        │   │   ├── CryScriptSystem.rc
        │   │   ├── cryscriptsystem.waf_files
        │   │   ├── FunctionHandler.cpp
        │   │   ├── FunctionHandler.h
        │   │   ├── LuaDebugger.rc
        │   │   ├── LuaDebuggerResource.h
        │   │   ├── resource.h
        │   │   ├── ScriptSystem.cpp
        │   │   ├── ScriptSystem.h
        │   │   ├── ScriptTable.cpp
        │   │   ├── ScriptTable.h
        │   │   ├── ScriptTimerMgr.cpp
        │   │   ├── ScriptTimerMgr.h
        │   │   ├── StackGuard.h
        │   │   ├── StdAfx.cpp
        │   │   ├── StdAfx.h
        │   │   ├── vectorlib.c
        │   │   ├── wscript
        │   │   ├── LuaDebugger/
        │   │   │   ├── _TinyBrowseFolder.h
        │   │   │   ├── _TinyCaptionWindow.h
        │   │   │   ├── _TinyCoolEdit.h
        │   │   │   ├── _TinyFileEnum.h
        │   │   │   ├── _TinyImageList.h
        │   │   │   ├── _TinyMain.h
        │   │   │   ├── _TinyRegistry.h
        │   │   │   ├── _TinySplitter.h
        │   │   │   ├── _TinyStatusBar.h
        │   │   │   ├── _TinyTreeList.h
        │   │   │   ├── _TinyWindow.h
        │   │   │   ├── AboutWnd.h
        │   │   │   ├── Coverage.cpp
        │   │   │   ├── Coverage.h
        │   │   │   ├── FileTree.cpp
        │   │   │   ├── FileTree.h
        │   │   │   ├── GoToFuncWnd.h
        │   │   │   ├── GoToWnd.h
        │   │   │   ├── LUADBG.cpp
        │   │   │   └── LUADBG.h
        │   │   ├── LuaRemoteDebug/
        │   │   │   ├── LuaRemoteDebug.cpp
        │   │   │   ├── LuaRemoteDebug.h
        │   │   │   └── SerializationHelper.h
        │   │   └── ScriptBindings/
        │   │       ├── ScriptBind_Movie.cpp
        │   │       ├── ScriptBind_Movie.h
        │   │       ├── ScriptBind_Particle.cpp
        │   │       ├── ScriptBind_Particle.h
        │   │       ├── ScriptBind_Physics.cpp
        │   │       ├── ScriptBind_Physics.h
        │   │       ├── ScriptBind_Script.cpp
        │   │       ├── ScriptBind_Script.h
        │   │       ├── ScriptBind_Sound.cpp
        │   │       ├── ScriptBind_Sound.h
        │   │       ├── ScriptBind_System.cpp
        │   │       ├── ScriptBind_System.h
        │   │       ├── ScriptBinding.cpp
        │   │       ├── ScriptBinding.h
        │   │       ├── SurfaceTypes.cpp
        │   │       └── SurfaceTypes.h
        │   ├── CrySystem/
        │   │   ├── AndroidConsole.cpp
        │   │   ├── AndroidConsole.h
        │   │   ├── AsyncPakManager.cpp
        │   │   ├── AsyncPakManager.h
        │   │   ├── AutoDetectCPUTestSuit.cpp
        │   │   ├── AutoDetectCPUTestSuit.h
        │   │   ├── AutoDetectSpec.cpp
        │   │   ├── AutoDetectSpec.h
        │   │   ├── AVI_Reader.cpp
        │   │   ├── AVI_Reader.h
        │   │   ├── BootProfiler.cpp
        │   │   ├── BootProfiler.h
        │   │   ├── BudgetingSystem.cpp
        │   │   ├── BudgetingSystem.h
        │   │   ├── ClientHandler.cpp
        │   │   ├── ClientHandler.h
        │   │   ├── CMakeLists.txt
        │   │   ├── CmdLine.cpp
        │   │   ├── CmdLine.h
        │   │   ├── CmdLineArg.cpp
        │   │   ├── CmdLineArg.h
        │   │   ├── CompressedFile.cpp
        │   │   ├── ConsoleBatchFile.cpp
        │   │   ├── ConsoleBatchFile.h
        │   │   ├── ConsoleHelpGen.cpp
        │   │   ├── ConsoleHelpGen.h
        │   │   ├── CPUDetect.cpp
        │   │   ├── CPUDetect.h
        │   │   ├── CrashHandler.rc
        │   │   ├── CryArchive.cpp
        │   │   ├── CryArchive.h
        │   │   ├── CryAsyncMemcpy.cpp
        │   │   ├── CryDLMalloc.c
        │   │   ├── CryMemoryManager.cpp
        │   │   ├── CryPak.cpp
        │   │   ├── CryPak.h
        │   │   ├── CryPakHandleCache.h
        │   │   ├── CrySizerImpl.cpp
        │   │   ├── CrySizerImpl.h
        │   │   ├── CrySizerStats.cpp
        │   │   ├── CrySizerStats.h
        │   │   ├── CrySystem.rc
        │   │   ├── crysystem.waf_files
        │   │   ├── crysystem_posix.waf_files
        │   │   ├── crysystem_win32.waf_files
        │   │   ├── CryThreadUtil_posix.h
        │   │   ├── CryThreadUtil_win32.h
        │   │   ├── CryWaterMark.h
        │   │   ├── CustomMemoryHeap.cpp
        │   │   ├── CustomMemoryHeap.h
        │   │   ├── DebugCallStack.cpp
        │   │   ├── DebugCallStack.h
        │   │   ├── DefragAllocator.cpp
        │   │   ├── DefragAllocator.h
        │   │   ├── DiskProfiler.cpp
        │   │   ├── DiskProfiler.h
        │   │   ├── DiskProfilerWindowsSpecific.cpp
        │   │   ├── DiskProfilerWindowsSpecific.h
        │   │   ├── DllMain.cpp
        │   │   ├── DownloadManager.cpp
        │   │   ├── DownloadManager.h
        │   │   ├── DxDiag.h
        │   │   ├── ExcelExport.cpp
        │   │   ├── ExcelExport.h
        │   │   ├── FileIOWrapper.cpp
        │   │   ├── FileIOWrapper.h
        │   │   ├── GeneralMemoryHeap.cpp
        │   │   ├── GeneralMemoryHeap.h
        │   │   ├── HandlerBase.cpp
        │   │   ├── HandlerBase.h
        │   │   ├── HardwareMouse.cpp
        │   │   ├── HardwareMouse.h
        │   │   ├── HMDCVars.cpp
        │   │   ├── HMDCVars.h
        │   │   ├── HMDManager.cpp
        │   │   ├── HMDManager.h
        │   │   ├── HotUpdate.h
        │   │   ├── HTTPDownloader.cpp
        │   │   ├── HTTPDownloader.h
        │   │   ├── Huffman.cpp
        │   │   ├── Huffman.h
        │   │   ├── IDebugCallStack.cpp
        │   │   ├── IDebugCallStack.h
        │   │   ├── ImeManager.cpp
        │   │   ├── ImeManager.h
        │   │   ├── IOSConsole.h
        │   │   ├── IOSConsole.mm
        │   │   ├── JiraClient.cpp
        │   │   ├── JiraClient.h
        │   │   ├── LocalizedStringManager.cpp
        │   │   ├── LocalizedStringManager.h
        │   │   ├── Log.cpp
        │   │   ├── Log.h
        │   │   ├── LZ4Decompressor.cpp
        │   │   ├── LZ4Decompressor.h
        │   │   ├── ManualFrameStep.cpp
        │   │   ├── ManualFrameStep.h
        │   │   ├── MemoryAddressRange.cpp
        │   │   ├── MemoryAddressRange.h
        │   │   ├── MemoryManager.cpp
        │   │   ├── MemoryManager.h
        │   │   ├── MemReplay.cpp
        │   │   ├── MemReplay.h
        │   │   ├── MTSafeAllocator.cpp
        │   │   ├── MTSafeAllocator.h
        │   │   ├── NotificationNetwork.cpp
        │   │   ├── NotificationNetwork.h
        │   │   ├── PageMappingHeap.cpp
        │   │   ├── PageMappingHeap.h
        │   │   ├── PakVars.h
        │   │   ├── PerfHUD.cpp
        │   │   ├── PerfHUD.h
        │   │   ├── PhysRenderer.cpp
        │   │   ├── PhysRenderer.h
        │   │   ├── platformos.waf_files
        │   │   ├── platformos_durango.waf_files
        │   │   ├── RemoteCommand.cpp
        │   │   ├── RemoteCommand.h
        │   │   ├── RemoteCommandClient.cpp
        │   │   ├── RemoteCommandHelpers.cpp
        │   │   ├── RemoteCommandHelpers.h
        │   │   ├── RemoteCommandServer.cpp
        │   │   ├── resource.h
        │   │   ├── ResourceManager.cpp
        │   │   ├── ResourceManager.h
        │   │   ├── ServerHandler.cpp
        │   │   ├── ServerHandler.h
        │   │   ├── ServerThrottle.cpp
        │   │   ├── ServerThrottle.h
        │   │   ├── ServiceNetwork.cpp
        │   │   ├── ServiceNetwork.h
        │   │   ├── SimpleStringPool.cpp
        │   │   ├── SimpleStringPool.h
        │   │   ├── Statistics.cpp
        │   │   ├── Statistics.h
        │   │   ├── Statoscope.cpp
        │   │   ├── Statoscope.h
        │   │   ├── StatoscopeStreamingIntervalGroup.cpp
        │   │   ├── StatoscopeStreamingIntervalGroup.h
        │   │   ├── StatoscopeTextureStreamingIntervalGroup.cpp
        │   │   ├── StatoscopeTextureStreamingIntervalGroup.h
        │   │   ├── StdAfx.cpp
        │   │   ├── StdAfx.h
        │   │   ├── SyncLock.cpp
        │   │   ├── SyncLock.h
        │   │   ├── System.cpp
        │   │   ├── System.h
        │   │   ├── SystemCFG.cpp
        │   │   ├── SystemCFG.h
        │   │   ├── SystemEventDispatcher.cpp
        │   │   ├── SystemEventDispatcher.h
        │   │   ├── SystemInit.cpp
        │   │   ├── SystemInit.h
        │   │   ├── SystemRender.cpp
        │   │   ├── SystemScheduler.cpp
        │   │   ├── SystemScheduler.h
        │   │   ├── SystemThreading.cpp
        │   │   ├── SystemUtilsApple.h
        │   │   ├── SystemUtilsApple.mm
        │   │   ├── SystemWin32.cpp
        │   │   ├── TestSystem.cpp
        │   │   ├── TestSystem.h
        │   │   ├── ThreadConfigManager.cpp
        │   │   ├── ThreadConfigManager.h
        │   │   ├── ThreadInfo.cpp
        │   │   ├── ThreadInfo.h
        │   │   ├── Timer.cpp
        │   │   ├── Timer.h
        │   │   ├── UnitTestExcelReporter.cpp
        │   │   ├── UnitTestExcelReporter.h
        │   │   ├── UnixConsole.cpp
        │   │   ├── UnixConsole.h
        │   │   ├── Validator.h
        │   │   ├── VisRegTest.cpp
        │   │   ├── VisRegTest.h
        │   │   ├── Watchdog.cpp
        │   │   ├── Watchdog.h
        │   │   ├── WindowsConsole.cpp
        │   │   ├── WindowsConsole.h
        │   │   ├── WindowsErrorReporting.cpp
        │   │   ├── wscript
        │   │   ├── XConsole.cpp
        │   │   ├── XConsole.h
        │   │   ├── XConsoleVariable.cpp
        │   │   ├── XConsoleVariable.h
        │   │   ├── ZipDir.h
        │   │   ├── ZipDirCache.cpp
        │   │   ├── ZipDirCache.h
        │   │   ├── ZipDirCacheFactory.cpp
        │   │   ├── ZipDirCacheFactory.h
        │   │   ├── ZipDirCacheRW.cpp
        │   │   ├── ZipDirCacheRW.h
        │   │   ├── ZipDirFind.cpp
        │   │   ├── ZipDirFind.h
        │   │   ├── ZipDirFindRW.cpp
        │   │   ├── ZipDirFindRW.h
        │   │   ├── ZipDirList.cpp
        │   │   ├── ZipDirList.h
        │   │   ├── ZipDirStructures.cpp
        │   │   ├── ZipDirStructures.h
        │   │   ├── ZipDirTree.cpp
        │   │   ├── ZipDirTree.h
        │   │   ├── ZipEncrypt.cpp
        │   │   ├── ZipEncrypt.h
        │   │   ├── ZipFileFormat.h
        │   │   ├── ZipFileFormat_info.h
        │   │   ├── ZLibCompressor.cpp
        │   │   ├── ZLibCompressor.h
        │   │   ├── ZLibDecompressor.cpp
        │   │   ├── ZLibDecompressor.h
        │   │   ├── CodeCoverage/
        │   │   │   ├── CodeCheckpointMgr.cpp
        │   │   │   └── CodeCheckpointMgr.h
        │   │   ├── ExtensionSystem/
        │   │   │   ├── CryFactoryRegistryImpl.cpp
        │   │   │   ├── CryFactoryRegistryImpl.h
        │   │   │   ├── CryPluginManager.cpp
        │   │   │   ├── CryPluginManager.h
        │   │   │   └── TestCases/
        │   │   │       ├── TestExtensions.cpp
        │   │   │       └── TestExtensions.h
        │   │   ├── Interprocess/
        │   │   │   ├── StatsAgent.cpp
        │   │   │   ├── StatsAgent.h
        │   │   │   ├── StatsAgentPipe.cpp
        │   │   │   └── StatsAgentPipe.h
        │   │   ├── JobManager/
        │   │   │   ├── JobManager.cpp
        │   │   │   ├── JobManager.h
        │   │   │   ├── JobStructs.h
        │   │   │   ├── JobSystemTests.cpp
        │   │   │   ├── BlockingBackend/
        │   │   │   │   ├── BlockingBackEnd.cpp
        │   │   │   │   └── BlockingBackEnd.h
        │   │   │   └── PCBackEnd/
        │   │   │       ├── ThreadBackEnd.cpp
        │   │   │       └── ThreadBackEnd.h
        │   │   ├── MiniGUI/
        │   │   │   ├── DrawContext.cpp
        │   │   │   ├── DrawContext.h
        │   │   │   ├── MiniButton.cpp
        │   │   │   ├── MiniButton.h
        │   │   │   ├── MiniGUI.cpp
        │   │   │   ├── MiniGUI.h
        │   │   │   ├── MiniInfoBox.cpp
        │   │   │   ├── MiniInfoBox.h
        │   │   │   ├── MiniMenu.cpp
        │   │   │   ├── MiniMenu.h
        │   │   │   ├── MiniTable.cpp
        │   │   │   └── MiniTable.h
        │   │   ├── NullImplementation/
        │   │   │   ├── NULLAudioSystems.h
        │   │   │   ├── NullInput.h
        │   │   │   ├── NullLiveCreate.h
        │   │   │   ├── NULLRenderAuxGeom.cpp
        │   │   │   ├── NULLRenderAuxGeom.h
        │   │   │   └── NullResponseSystem.h
        │   │   ├── OverloadSceneManager/
        │   │   │   ├── OverloadSceneManager.cpp
        │   │   │   └── OverloadSceneManager.h
        │   │   ├── PlatformOS/
        │   │   │   ├── PatternMatcher.h
        │   │   │   ├── PlatformOS_PC.cpp
        │   │   │   ├── PlatformOS_PC.h
        │   │   │   ├── SaveReaderWriter_CryPak.cpp
        │   │   │   ├── SaveReaderWriter_CryPak.h
        │   │   │   ├── SaveReaderWriter_Memory.cpp
        │   │   │   └── SaveReaderWriter_Memory.h
        │   │   ├── Profiling/
        │   │   │   ├── CryBrofiler.cpp
        │   │   │   ├── CryBrofiler.h
        │   │   │   ├── CryProfilingSystem.cpp
        │   │   │   ├── CryProfilingSystem.h
        │   │   │   ├── CryProfilingSystemSharedImpl.cpp
        │   │   │   ├── CryProfilingSystemSharedImpl.h
        │   │   │   ├── NullProfiler.cpp
        │   │   │   ├── NullProfiler.h
        │   │   │   ├── PixForWindows.cpp
        │   │   │   ├── PixForWindows.h
        │   │   │   ├── PlatformProfiler.h
        │   │   │   ├── PlatformProfiler_win.cpp
        │   │   │   ├── ProfilingRenderer.cpp
        │   │   │   └── ProfilingRenderer.h
        │   │   ├── ProjectManager/
        │   │   │   ├── ProjectManager.cpp
        │   │   │   └── ProjectManager.h
        │   │   ├── RemoteConsole/
        │   │   │   ├── RemoteConsole.cpp
        │   │   │   └── RemoteConsole.h
        │   │   ├── Scaleform/
        │   │   │   ├── CMakeLists.txt
        │   │   │   ├── FlashPlayerInstance.cpp
        │   │   │   ├── FlashPlayerInstance.h
        │   │   │   ├── GAllocatorCryMem.cpp
        │   │   │   ├── GAllocatorCryMem.h
        │   │   │   ├── GFileCryPak.cpp
        │   │   │   ├── GFileCryPak.h
        │   │   │   ├── GFxVideoSoundCrySound.cpp
        │   │   │   ├── GFxVideoSoundCrySound.h
        │   │   │   ├── GFxVideoWrapper.cpp
        │   │   │   ├── GFxVideoWrapper.h
        │   │   │   ├── GImageInfo_Impl.cpp
        │   │   │   ├── GImageInfo_Impl.h
        │   │   │   ├── GImeHelper.cpp
        │   │   │   ├── GImeHelper.h
        │   │   │   ├── GTexture_Impl.cpp
        │   │   │   ├── GTexture_Impl.h
        │   │   │   ├── scaleform.waf_files
        │   │   │   ├── scaleform_helper.waf_files
        │   │   │   ├── ScaleformHelper.cpp
        │   │   │   ├── ScaleformHelper.h
        │   │   │   ├── ScaleformRecording.cpp
        │   │   │   ├── ScaleformRecording.h
        │   │   │   ├── SharedResources.cpp
        │   │   │   ├── SharedResources.h
        │   │   │   ├── SharedStates.cpp
        │   │   │   ├── SharedStates.h
        │   │   │   ├── StdAfx.h
        │   │   │   └── wscript
        │   │   ├── Serialization/
        │   │   │   ├── ArchiveHost.cpp
        │   │   │   ├── ArchiveHost.h
        │   │   │   ├── Token.h
        │   │   │   ├── XmlIArchive.cpp
        │   │   │   ├── XmlIArchive.h
        │   │   │   ├── XmlOArchive.cpp
        │   │   │   └── XmlOArchive.h
        │   │   ├── Statistics/
        │   │   │   ├── LocalMemoryUsage.cpp
        │   │   │   └── LocalMemoryUsage.h
        │   │   ├── StreamEngine/
        │   │   │   ├── StreamAsyncFileRequest.cpp
        │   │   │   ├── StreamAsyncFileRequest.h
        │   │   │   ├── StreamAsyncFileRequest_Jobs.cpp
        │   │   │   ├── StreamEngine.cpp
        │   │   │   ├── StreamEngine.h
        │   │   │   ├── StreamIOThread.cpp
        │   │   │   ├── StreamIOThread.h
        │   │   │   ├── StreamReadStream.cpp
        │   │   │   └── StreamReadStream.h
        │   │   ├── Stroboscope/
        │   │   │   ├── Stroboscope.cpp
        │   │   │   └── Stroboscope.h
        │   │   └── XML/
        │   │       ├── ReadWriteXMLSink.h
        │   │       ├── ReadXMLSink.cpp
        │   │       ├── SerializeXMLReader.cpp
        │   │       ├── SerializeXMLReader.h
        │   │       ├── SerializeXMLWriter.cpp
        │   │       ├── SerializeXMLWriter.h
        │   │       ├── WriteXMLSource.cpp
        │   │       ├── xml.cpp
        │   │       ├── xml.h
        │   │       ├── xml_string.h
        │   │       ├── XMLBinaryNode.cpp
        │   │       ├── XMLBinaryNode.h
        │   │       ├── XMLBinaryReader.cpp
        │   │       ├── XMLBinaryReader.h
        │   │       ├── XMLBinaryWriter.cpp
        │   │       ├── XMLBinaryWriter.h
        │   │       ├── XMLPatcher.cpp
        │   │       ├── XMLPatcher.h
        │   │       ├── XmlUtils.cpp
        │   │       └── XmlUtils.h
        │   ├── CryUDR/
        │   │   ├── CMakeLists.txt
        │   │   ├── cry_udr_core.waf_files
        │   │   ├── CryUDR.cpp
        │   │   ├── CVars.cpp
        │   │   ├── CVars.h
        │   │   ├── LogMessageCollection.cpp
        │   │   ├── LogMessageCollection.h
        │   │   ├── Node.cpp
        │   │   ├── Node.h
        │   │   ├── NodeStack.cpp
        │   │   ├── NodeStack.h
        │   │   ├── RecursiveSyncObject.cpp
        │   │   ├── RecursiveSyncObject.h
        │   │   ├── RenderPrimitiveCollection.cpp
        │   │   ├── RenderPrimitiveCollection.h
        │   │   ├── RenderPrimitives.cpp
        │   │   ├── RenderPrimitives.h
        │   │   ├── resource.h
        │   │   ├── StdAfx.cpp
        │   │   ├── StdAfx.h
        │   │   ├── TimeMetadata.cpp
        │   │   ├── TimeMetadata.h
        │   │   ├── Tree.cpp
        │   │   ├── Tree.h
        │   │   ├── TreeManager.cpp
        │   │   ├── TreeManager.h
        │   │   ├── UDRSystem.cpp
        │   │   ├── UDRSystem.h
        │   │   └── wscript
        │   ├── RenderDll/
        │   │   ├── StdAfx.cpp
        │   │   ├── StdAfx.h
        │   │   ├── wscript
        │   │   ├── Common/
        │   │   │   ├── CommonRender.cpp
        │   │   │   ├── CommonRender.h
        │   │   │   ├── ComputeSkinningStorage.h
        │   │   │   ├── CryNameR.h
        │   │   │   ├── DeferredRenderUtils.cpp
        │   │   │   ├── DeferredRenderUtils.h
        │   │   │   ├── Defs.h
        │   │   │   ├── DevBuffer.h
        │   │   │   ├── ElementPool.h
        │   │   │   ├── Include_HLSL_CPP_Shared.h
        │   │   │   ├── IntroMovieRenderer.cpp
        │   │   │   ├── IntroMovieRenderer.h
        │   │   │   ├── ISmartGlassContext.h
        │   │   │   ├── LightVolumeBuffer.cpp
        │   │   │   ├── LightVolumeBuffer.h
        │   │   │   ├── LockFreeAddVector.h
        │   │   │   ├── lzss.cpp
        │   │   │   ├── LZSS.H
        │   │   │   ├── MatrixStack.cpp
        │   │   │   ├── NvidiaFastGeometryShaderTest.h
        │   │   │   ├── NvidiaFastGeometryShaderTest.hlsl
        │   │   │   ├── OcclQuery.h
        │   │   │   ├── OptimizeTransparentRenderItemsResolves.cpp
        │   │   │   ├── ParticleBuffer.cpp
        │   │   │   ├── ParticleBuffer.h
        │   │   │   ├── RenderAuxGeom.cpp
        │   │   │   ├── RenderAuxGeom.h
        │   │   │   ├── RenderDisplayContext.cpp
        │   │   │   ├── RenderDisplayContext.h
        │   │   │   ├── Renderer.cpp
        │   │   │   ├── Renderer.h
        │   │   │   ├── Renderer_Jobs.cpp
        │   │   │   ├── RendererCVars.cpp
        │   │   │   ├── RendererCVars.h
        │   │   │   ├── RendererResources.cpp
        │   │   │   ├── RendererResources.h
        │   │   │   ├── RenderFrameProfiler.h
        │   │   │   ├── RenderItemDrawer.cpp
        │   │   │   ├── RenderItemDrawer.h
        │   │   │   ├── RenderMesh.cpp
        │   │   │   ├── RenderMesh.h
        │   │   │   ├── RenderMesh_Render.cpp
        │   │   │   ├── RenderMesh_SetMesh.cpp
        │   │   │   ├── RenderOutput.cpp
        │   │   │   ├── RenderOutput.h
        │   │   │   ├── RenderPipeline.cpp
        │   │   │   ├── RenderPipeline.h
        │   │   │   ├── RenderThread.cpp
        │   │   │   ├── RenderThread.h
        │   │   │   ├── RenderView.cpp
        │   │   │   ├── RenderView.h
        │   │   │   ├── ResFile.cpp
        │   │   │   ├── ResFile.h
        │   │   │   ├── ResFile_info.h
        │   │   │   ├── ResFileLookupDataMan.cpp
        │   │   │   ├── ResFileLookupDataMan.h
        │   │   │   ├── ReverseDepth.h
        │   │   │   ├── Shadow_Renderer.cpp
        │   │   │   ├── Shadow_Renderer.h
        │   │   │   ├── ShadowUtils.cpp
        │   │   │   ├── ShadowUtils.h
        │   │   │   ├── SmartGlassContext.h
        │   │   │   ├── SwapChain.cpp
        │   │   │   ├── SwapChain.h
        │   │   │   ├── TextMessages.cpp
        │   │   │   ├── TextMessages.h
        │   │   │   ├── TypedConstantBuffer.h
        │   │   │   ├── WaterUtils.cpp
        │   │   │   ├── WaterUtils.h
        │   │   │   ├── PostProcess/
        │   │   │   │   ├── PostEffects.cpp
        │   │   │   │   ├── PostEffects.h
        │   │   │   │   ├── PostProcess.cpp
        │   │   │   │   ├── PostProcess.h
        │   │   │   │   ├── PostProcessUtils.cpp
        │   │   │   │   └── PostProcessUtils.h
        │   │   │   ├── RendElements/
        │   │   │   │   ├── AbstractMeshElement.cpp
        │   │   │   │   ├── AbstractMeshElement.h
        │   │   │   │   ├── CameraOrbs.cpp
        │   │   │   │   ├── CameraOrbs.h
        │   │   │   │   ├── ChromaticRing.cpp
        │   │   │   │   ├── ChromaticRing.h
        │   │   │   │   ├── CREBreakableGlass.cpp
        │   │   │   │   ├── CREClientPoly.cpp
        │   │   │   │   ├── CREClientPoly.h
        │   │   │   │   ├── CREFarTreeSprites.cpp
        │   │   │   │   ├── CREFogVolume.cpp
        │   │   │   │   ├── CREGameEffect.cpp
        │   │   │   │   ├── CREGeomCache.cpp
        │   │   │   │   ├── CRELensOptics.h
        │   │   │   │   ├── CREMesh.cpp
        │   │   │   │   ├── CREMeshImpl.h
        │   │   │   │   ├── CREOclusionQuery.cpp
        │   │   │   │   ├── CREParticle.cpp
        │   │   │   │   ├── CREWaterOcean.cpp
        │   │   │   │   ├── CREWaterVolume.cpp
        │   │   │   │   ├── FlareSoftOcclusionQuery.cpp
        │   │   │   │   ├── FlareSoftOcclusionQuery.h
        │   │   │   │   ├── Ghost.cpp
        │   │   │   │   ├── Ghost.h
        │   │   │   │   ├── Glow.cpp
        │   │   │   │   ├── Glow.h
        │   │   │   │   ├── ImageSpaceShafts.cpp
        │   │   │   │   ├── ImageSpaceShafts.h
        │   │   │   │   ├── Interpolator.h
        │   │   │   │   ├── IrisShafts.cpp
        │   │   │   │   ├── IrisShafts.h
        │   │   │   │   ├── MeshUtil.cpp
        │   │   │   │   ├── MeshUtil.h
        │   │   │   │   ├── OpticsElement.cpp
        │   │   │   │   ├── OpticsElement.h
        │   │   │   │   ├── OpticsFactory.cpp
        │   │   │   │   ├── OpticsFactory.h
        │   │   │   │   ├── OpticsGroup.cpp
        │   │   │   │   ├── OpticsGroup.h
        │   │   │   │   ├── OpticsPredef.hpp
        │   │   │   │   ├── OpticsProxy.cpp
        │   │   │   │   ├── OpticsProxy.h
        │   │   │   │   ├── OpticsReference.cpp
        │   │   │   │   ├── OpticsReference.h
        │   │   │   │   ├── RendElement.cpp
        │   │   │   │   ├── RootOpticsElement.cpp
        │   │   │   │   ├── RootOpticsElement.h
        │   │   │   │   ├── Stars.h
        │   │   │   │   ├── Streaks.cpp
        │   │   │   │   ├── Streaks.h
        │   │   │   │   ├── Timeline.h
        │   │   │   │   └── Utils/
        │   │   │   │       ├── PolygonMath2D.cpp
        │   │   │   │       ├── PolygonMath2D.h
        │   │   │   │       └── SpatialHashGrid.h
        │   │   │   ├── Shaders/
        │   │   │   │   ├── CShader.h
        │   │   │   │   ├── CShaderBin.h
        │   │   │   │   ├── Parser.cpp
        │   │   │   │   ├── Parser.h
        │   │   │   │   ├── ParserBin.cpp
        │   │   │   │   ├── ParserBin.h
        │   │   │   │   ├── RemoteCompiler.cpp
        │   │   │   │   ├── RemoteCompiler.h
        │   │   │   │   ├── Shader.h
        │   │   │   │   ├── ShaderAllocator.h
        │   │   │   │   ├── ShaderCache.cpp
        │   │   │   │   ├── ShaderCache.h
        │   │   │   │   ├── ShaderComponents.cpp
        │   │   │   │   ├── ShaderComponents.h
        │   │   │   │   ├── ShaderCore.cpp
        │   │   │   │   ├── ShaderFXParseBin.cpp
        │   │   │   │   ├── ShaderParse.cpp
        │   │   │   │   ├── ShaderPublicParams.cpp
        │   │   │   │   ├── ShaderPublicParams.h
        │   │   │   │   ├── ShaderRenderResources.cpp
        │   │   │   │   ├── ShaderResources.cpp
        │   │   │   │   ├── ShaderResources.h
        │   │   │   │   ├── ShaderScript.cpp
        │   │   │   │   ├── ShaderSerialize.cpp
        │   │   │   │   ├── ShaderSerialize.h
        │   │   │   │   └── ShaderTemplate.cpp
        │   │   │   └── Textures/
        │   │   │       ├── DynTexture.cpp
        │   │   │       ├── ITextureStreamer.cpp
        │   │   │       ├── ITextureStreamer.h
        │   │   │       ├── PlanningTextureStreamer.cpp
        │   │   │       ├── PlanningTextureStreamer.h
        │   │   │       ├── PlanningTextureStreamer_Jobs.cpp
        │   │   │       ├── PowerOf2BlockPacker.cpp
        │   │   │       ├── PowerOf2BlockPacker.h
        │   │   │       ├── StatoscopeTextureStreaming.cpp
        │   │   │       ├── StatoscopeTextureStreaming.h
        │   │   │       ├── Texture.cpp
        │   │   │       ├── Texture.h
        │   │   │       ├── TextureArrayAlloc.h
        │   │   │       ├── TextureCompiler.cpp
        │   │   │       ├── TextureCompiler.h
        │   │   │       ├── TextureHelpers.cpp
        │   │   │       ├── TextureHelpers.h
        │   │   │       ├── TextureManager.cpp
        │   │   │       ├── TextureManager.h
        │   │   │       ├── TextureStreaming.cpp
        │   │   │       ├── TextureStreamPool.h
        │   │   │       └── Image/
        │   │   │           ├── CImage.cpp
        │   │   │           ├── CImage.h
        │   │   │           ├── DDSImage.cpp
        │   │   │           ├── DDSImage.h
        │   │   │           ├── JpgImage.cpp
        │   │   │           ├── PngImage.cpp
        │   │   │           ├── TgaImage.cpp
        │   │   │           └── TifImage.cpp
        │   │   ├── Scaleform/
        │   │   │   ├── Scaleform.cpp
        │   │   │   ├── ScaleformPlayback.cpp
        │   │   │   ├── ScaleformPlayback.h
        │   │   │   ├── ScaleformRender.cpp
        │   │   │   └── ScaleformRender.h
        │   │   └── XRenderD3D9/
        │   │       ├── CMakeLists.txt
        │   │       ├── CompiledRenderObject.cpp
        │   │       ├── CompiledRenderObject.h
        │   │       ├── core_renderer.waf_files
        │   │       ├── CRELensOpticsD3D.cpp
        │   │       ├── CryRenderD3D11.rc
        │   │       ├── CryRenderGL.props
        │   │       ├── CryRenderGL.rc
        │   │       ├── D3D_SVO.cpp
        │   │       ├── D3D_SVO.h
        │   │       ├── D3DAmbientOcclusion.cpp
        │   │       ├── D3DDebug.cpp
        │   │       ├── D3DDebug.h
        │   │       ├── D3DDeferredRender.cpp
        │   │       ├── D3DDeferredShading.cpp
        │   │       ├── D3DDeferredShading.h
        │   │       ├── D3DFont.cpp
        │   │       ├── D3DFXPipeline.cpp
        │   │       ├── D3DHDRRender.cpp
        │   │       ├── D3DHmdEmulator.cpp
        │   │       ├── D3DHmdEmulator.h
        │   │       ├── D3DHWShader.cpp
        │   │       ├── D3DHWShader.h
        │   │       ├── D3DHWShaderCompiling.cpp
        │   │       ├── D3DMeshBaker.cpp
        │   │       ├── D3DMultiResRendering.cpp
        │   │       ├── D3DMultiResRendering.h
        │   │       ├── D3DOcclQuery.cpp
        │   │       ├── D3DOculus.cpp
        │   │       ├── D3DOculus.h
        │   │       ├── D3DOpenVR.cpp
        │   │       ├── D3DOpenVR.h
        │   │       ├── D3DOsvr.cpp
        │   │       ├── D3DOsvr.h
        │   │       ├── D3DPostProcess.cpp
        │   │       ├── D3DPostProcess.h
        │   │       ├── D3DREBreakableGlass.cpp
        │   │       ├── D3DREBreakableGlassBuffer.cpp
        │   │       ├── D3DREBreakableGlassBuffer.h
        │   │       ├── D3DRenderAuxGeom.cpp
        │   │       ├── D3DRenderAuxGeom.h
        │   │       ├── D3DRenderPipeline.cpp
        │   │       ├── D3DRenderPipeline.h
        │   │       ├── D3DRenderThread.cpp
        │   │       ├── D3DRendPipeline.cpp
        │   │       ├── D3DRendPipeline_Jobs.cpp
        │   │       ├── D3DShaders.cpp
        │   │       ├── D3DShadows.cpp
        │   │       ├── D3DSprites.cpp
        │   │       ├── D3DStereo.cpp
        │   │       ├── D3DStereo.h
        │   │       ├── D3DSystem.cpp
        │   │       ├── D3DTexture.cpp
        │   │       ├── D3DTexturesStreaming.cpp
        │   │       ├── D3DTextureStreamPool.cpp
        │   │       ├── DevBuffer.cpp
        │   │       ├── DeviceInfo.h
        │   │       ├── DeviceInfo.inl
        │   │       ├── DriverD3D.cpp
        │   │       ├── DriverD3D.h
        │   │       ├── GpuHeap.cpp
        │   │       ├── GpuHeap.h
        │   │       ├── GpuHeap.natvis
        │   │       ├── mesh_baker.waf_files
        │   │       ├── NullD3D11Device.h
        │   │       ├── PipelineProfiler.cpp
        │   │       ├── PipelineProfiler.h
        │   │       ├── PostProcessDOF.cpp
        │   │       ├── PostProcessFilters.cpp
        │   │       ├── PostProcessGame.cpp
        │   │       ├── PostProcessHud3D.cpp
        │   │       ├── PostProcessMisc.cpp
        │   │       ├── PostProcessMotionBlur.cpp
        │   │       ├── PostProcessRenderModes.cpp
        │   │       ├── PostProcessSunShafts.cpp
        │   │       ├── PostProcessWater.cpp
        │   │       ├── resource.h
        │   │       ├── ResourceCompilerHelpers.cpp
        │   │       ├── SmartGlassContext.cpp
        │   │       ├── SmartGlassManager.cpp
        │   │       ├── SmartGlassManager.h
        │   │       ├── StatoscopeRenderStats.cpp
        │   │       ├── StatoscopeRenderStats.h
        │   │       ├── wscript
        │   │       ├── BenchmarkCustom/
        │   │       │   ├── BenchmarkRendererSensor.cpp
        │   │       │   └── BenchmarkRendererSensor.h
        │   │       ├── DeviceManager/
        │   │       │   ├── DeviceCommandList.inl
        │   │       │   ├── DeviceCommandListCommon.cpp
        │   │       │   ├── DeviceCommandListCommon.h
        │   │       │   ├── DeviceFormats.cpp
        │   │       │   ├── DeviceFormats.h
        │   │       │   ├── DeviceObjectHelpers.cpp
        │   │       │   ├── DeviceObjectHelpers.h
        │   │       │   ├── DeviceObjects.cpp
        │   │       │   ├── DeviceObjects.h
        │   │       │   ├── DeviceObjects.inl
        │   │       │   ├── DeviceObjectValidation.cpp
        │   │       │   ├── DeviceObjectValidation.h
        │   │       │   ├── DevicePSO.cpp
        │   │       │   ├── DevicePSO.h
        │   │       │   ├── DeviceRenderPass.cpp
        │   │       │   ├── DeviceRenderPass.h
        │   │       │   ├── DeviceResources.cpp
        │   │       │   ├── DeviceResources.h
        │   │       │   ├── DeviceResourceSet.cpp
        │   │       │   ├── DeviceResourceSet.h
        │   │       │   ├── D3D11/
        │   │       │   │   ├── DeviceCommandList_D3D11.h
        │   │       │   │   ├── DeviceCommandListCommon_D3D11.cpp
        │   │       │   │   ├── DeviceCommandListCommon_D3D11.h
        │   │       │   │   ├── DeviceObjects_D3D11.cpp
        │   │       │   │   ├── DeviceObjects_D3D11.h
        │   │       │   │   ├── DeviceObjects_D3D11.inl
        │   │       │   │   ├── DeviceObjects_D3D11_Durango.cpp
        │   │       │   │   ├── DeviceObjects_D3D11_Durango.h
        │   │       │   │   ├── DeviceObjects_D3D11_Durango.inl
        │   │       │   │   ├── DevicePSO_D3D11.cpp
        │   │       │   │   ├── DevicePSO_D3D11.h
        │   │       │   │   ├── DeviceRenderPass_D3D11.cpp
        │   │       │   │   ├── DeviceRenderPass_D3D11.h
        │   │       │   │   ├── DeviceResources_D3D11.inl
        │   │       │   │   ├── DeviceResources_D3D11_Durango.inl
        │   │       │   │   ├── DeviceResources_D3D11_NVAPI.h
        │   │       │   │   ├── DeviceResources_D3D11_NVAPI.inl
        │   │       │   │   ├── DeviceResourceSet_D3D11.cpp
        │   │       │   │   ├── DeviceResourceSet_D3D11.h
        │   │       │   │   └── DeviceResourceSet_D3D11.inl
        │   │       │   ├── D3D12/
        │   │       │   │   ├── DeviceCommandList_D3D12.h
        │   │       │   │   ├── DeviceCommandListCommon_D3D12.cpp
        │   │       │   │   ├── DeviceCommandListCommon_D3D12.h
        │   │       │   │   ├── DeviceObjects_D3D12.cpp
        │   │       │   │   ├── DeviceObjects_D3D12.inl
        │   │       │   │   ├── DeviceObjects_D3D12_Durango.inl
        │   │       │   │   ├── DevicePSO_D3D12.cpp
        │   │       │   │   ├── DevicePSO_D3D12.h
        │   │       │   │   ├── DeviceRenderPass_D3D12.cpp
        │   │       │   │   ├── DeviceRenderPass_D3D12.h
        │   │       │   │   ├── DeviceResources_D3D12.inl
        │   │       │   │   ├── DeviceResources_D3D12_Durango.inl
        │   │       │   │   ├── DeviceResourceSet_D3D12.cpp
        │   │       │   │   └── DeviceResourceSet_D3D12.h
        │   │       │   └── Vulkan/
        │   │       │       ├── DeviceCommandList_Vulkan.h
        │   │       │       ├── DeviceCommandListCommon_Vulkan.cpp
        │   │       │       ├── DeviceCommandListCommon_Vulkan.h
        │   │       │       ├── DeviceObjects_Vulkan.cpp
        │   │       │       ├── DeviceObjects_Vulkan.inl
        │   │       │       ├── DevicePSO_Vulkan.cpp
        │   │       │       ├── DevicePSO_Vulkan.h
        │   │       │       ├── DeviceRenderPass_Vulkan.cpp
        │   │       │       ├── DeviceRenderPass_Vulkan.h
        │   │       │       ├── DeviceResources_Vulkan.inl
        │   │       │       ├── DeviceResourceSet_Vulkan.cpp
        │   │       │       └── DeviceResourceSet_Vulkan.h
        │   │       ├── DX11/
        │   │       │   ├── CryDX11.cpp
        │   │       │   ├── CryDX11.hpp
        │   │       │   ├── durango_renderer.waf_files
        │   │       │   ├── dx11_renderer.waf_files
        │   │       │   └── API/
        │   │       │       ├── DX11Base.cpp
        │   │       │       ├── DX11Base.hpp
        │   │       │       ├── DX11CommandList.cpp
        │   │       │       ├── DX11CommandList.hpp
        │   │       │       ├── DX11CommandListFence.cpp
        │   │       │       ├── DX11CommandListFence.hpp
        │   │       │       ├── DX11CommandListPool.cpp
        │   │       │       ├── DX11CommandListPool.hpp
        │   │       │       ├── DX11CommandScheduler.cpp
        │   │       │       ├── DX11CommandScheduler.hpp
        │   │       │       ├── DX11Device.cpp
        │   │       │       └── DX11Device.hpp
        │   │       ├── DX12/
        │   │       │   ├── CCryDX12Object.cpp
        │   │       │   ├── CCryDX12Object.hpp
        │   │       │   ├── CryDX12.cpp
        │   │       │   ├── CryDX12.hpp
        │   │       │   ├── CryDX12Guid.hpp
        │   │       │   ├── dx12_renderer.waf_files
        │   │       │   ├── API/
        │   │       │   │   ├── DX12AsyncCommandQueue.cpp
        │   │       │   │   ├── DX12AsyncCommandQueue.hpp
        │   │       │   │   ├── DX12Base.cpp
        │   │       │   │   ├── DX12Base.hpp
        │   │       │   │   ├── DX12CommandList.cpp
        │   │       │   │   ├── DX12CommandList.hpp
        │   │       │   │   ├── DX12CommandListFence.cpp
        │   │       │   │   ├── DX12CommandListFence.hpp
        │   │       │   │   ├── DX12CommandScheduler.cpp
        │   │       │   │   ├── DX12CommandScheduler.hpp
        │   │       │   │   ├── DX12DescriptorHeap.cpp
        │   │       │   │   ├── DX12DescriptorHeap.hpp
        │   │       │   │   ├── DX12Device.cpp
        │   │       │   │   ├── DX12Device.hpp
        │   │       │   │   ├── DX12PSO.cpp
        │   │       │   │   ├── DX12PSO.hpp
        │   │       │   │   ├── DX12QueryHeap.cpp
        │   │       │   │   ├── DX12QueryHeap.hpp
        │   │       │   │   ├── DX12Resource.cpp
        │   │       │   │   ├── DX12Resource.hpp
        │   │       │   │   ├── DX12RootSignature.cpp
        │   │       │   │   ├── DX12RootSignature.hpp
        │   │       │   │   ├── DX12SamplerState.cpp
        │   │       │   │   ├── DX12SamplerState.hpp
        │   │       │   │   ├── DX12Shader.cpp
        │   │       │   │   ├── DX12Shader.hpp
        │   │       │   │   ├── DX12SwapChain.cpp
        │   │       │   │   ├── DX12SwapChain.hpp
        │   │       │   │   ├── DX12View.cpp
        │   │       │   │   ├── DX12View.hpp
        │   │       │   │   ├── Redirections/
        │   │       │   │   │   ├── D3D12CommandAllocator.inl
        │   │       │   │   │   ├── D3D12CommandQueue.inl
        │   │       │   │   │   ├── D3D12DescriptorHeap.inl
        │   │       │   │   │   ├── D3D12Device.inl
        │   │       │   │   │   ├── D3D12Fence.inl
        │   │       │   │   │   ├── D3D12GraphicsCommandList.inl
        │   │       │   │   │   ├── D3D12Heap.inl
        │   │       │   │   │   ├── D3D12QueryHeap.inl
        │   │       │   │   │   └── D3D12Resource.inl
        │   │       │   │   └── Workarounds/
        │   │       │   │       └── OculusMultiGPU.inl
        │   │       │   ├── Device/
        │   │       │   │   ├── CCryDX12Device.cpp
        │   │       │   │   ├── CCryDX12Device.hpp
        │   │       │   │   ├── CCryDX12DeviceChild.cpp
        │   │       │   │   ├── CCryDX12DeviceChild.hpp
        │   │       │   │   ├── CCryDX12DeviceContext.cpp
        │   │       │   │   └── CCryDX12DeviceContext.hpp
        │   │       │   ├── GI/
        │   │       │   │   ├── CCryDX12GIAdapter.cpp
        │   │       │   │   ├── CCryDX12GIAdapter.hpp
        │   │       │   │   ├── CCryDX12GIDevice.cpp
        │   │       │   │   ├── CCryDX12GIDevice.hpp
        │   │       │   │   ├── CCryDX12GIFactory.cpp
        │   │       │   │   ├── CCryDX12GIFactory.hpp
        │   │       │   │   ├── CCryDX12GIOutput.cpp
        │   │       │   │   ├── CCryDX12GIOutput.hpp
        │   │       │   │   ├── CCryDX12SwapChain.cpp
        │   │       │   │   └── CCryDX12SwapChain.hpp
        │   │       │   ├── Includes/
        │   │       │   │   ├── d3d11_empty.h
        │   │       │   │   ├── d3d11_structs.h
        │   │       │   │   ├── d3d11TokenizedProgramFormat.hpp
        │   │       │   │   ├── d3dx12.h
        │   │       │   │   └── Unknwn_empty.h
        │   │       │   ├── Misc/
        │   │       │   │   ├── SCryDX11PipelineState.cpp
        │   │       │   │   └── SCryDX11PipelineState.hpp
        │   │       │   └── Resource/
        │   │       │       ├── CCryDX12Asynchronous.cpp
        │   │       │       ├── CCryDX12Asynchronous.hpp
        │   │       │       ├── CCryDX12Resource.cpp
        │   │       │       ├── CCryDX12Resource.hpp
        │   │       │       ├── CCryDX12View.cpp
        │   │       │       ├── CCryDX12View.hpp
        │   │       │       ├── Misc/
        │   │       │       │   ├── CCryDX12Buffer.cpp
        │   │       │       │   ├── CCryDX12Buffer.hpp
        │   │       │       │   ├── CCryDX12InputLayout.cpp
        │   │       │       │   ├── CCryDX12InputLayout.hpp
        │   │       │       │   ├── CCryDX12Query.cpp
        │   │       │       │   ├── CCryDX12Query.hpp
        │   │       │       │   ├── CCryDX12Shader.cpp
        │   │       │       │   └── CCryDX12Shader.hpp
        │   │       │       ├── State/
        │   │       │       │   ├── CCryDX12BlendState.cpp
        │   │       │       │   ├── CCryDX12BlendState.hpp
        │   │       │       │   ├── CCryDX12DepthStencilState.cpp
        │   │       │       │   ├── CCryDX12DepthStencilState.hpp
        │   │       │       │   ├── CCryDX12RasterizerState.cpp
        │   │       │       │   ├── CCryDX12RasterizerState.hpp
        │   │       │       │   ├── CCryDX12SamplerState.cpp
        │   │       │       │   └── CCryDX12SamplerState.hpp
        │   │       │       ├── Texture/
        │   │       │       │   ├── CCryDX12Texture1D.cpp
        │   │       │       │   ├── CCryDX12Texture1D.hpp
        │   │       │       │   ├── CCryDX12Texture2D.cpp
        │   │       │       │   ├── CCryDX12Texture2D.hpp
        │   │       │       │   ├── CCryDX12Texture3D.cpp
        │   │       │       │   ├── CCryDX12Texture3D.hpp
        │   │       │       │   ├── CCryDX12TextureBase.cpp
        │   │       │       │   └── CCryDX12TextureBase.hpp
        │   │       │       └── View/
        │   │       │           ├── CCryDX12DepthStencilView.cpp
        │   │       │           ├── CCryDX12DepthStencilView.hpp
        │   │       │           ├── CCryDX12RenderTargetView.cpp
        │   │       │           ├── CCryDX12RenderTargetView.hpp
        │   │       │           ├── CCryDX12ShaderResourceView.cpp
        │   │       │           ├── CCryDX12ShaderResourceView.hpp
        │   │       │           ├── CCryDX12UnorderedAccessView.cpp
        │   │       │           └── CCryDX12UnorderedAccessView.hpp
        │   │       ├── Gpu/
        │   │       │   ├── GpuBitonicSort.cpp
        │   │       │   ├── GpuBitonicSort.h
        │   │       │   ├── GpuComputeBackend.cpp
        │   │       │   ├── GpuComputeBackend.h
        │   │       │   ├── GpuMergeSort.cpp
        │   │       │   ├── GpuMergeSort.h
        │   │       │   ├── Particles/
        │   │       │   │   ├── GpuParticleComponentRuntime.cpp
        │   │       │   │   ├── GpuParticleComponentRuntime.h
        │   │       │   │   ├── GpuParticleContainer.cpp
        │   │       │   │   ├── GpuParticleContainer.h
        │   │       │   │   ├── GpuParticleFeatureBase.h
        │   │       │   │   ├── GpuParticleFeatureCollision.cpp
        │   │       │   │   ├── GpuParticleFeatureCollision.h
        │   │       │   │   ├── GpuParticleFeatureColor.cpp
        │   │       │   │   ├── GpuParticleFeatureColor.h
        │   │       │   │   ├── GpuParticleFeatureFactory.cpp
        │   │       │   │   ├── GpuParticleFeatureFactory.h
        │   │       │   │   ├── GpuParticleFeatureField.cpp
        │   │       │   │   ├── GpuParticleFeatureField.h
        │   │       │   │   ├── GpuParticleFeatureFluidDynamics.cpp
        │   │       │   │   ├── GpuParticleFeatureFluidDynamics.h
        │   │       │   │   ├── GpuParticleFeatureMotion.cpp
        │   │       │   │   ├── GpuParticleFeatureMotion.h
        │   │       │   │   ├── GpuParticleManager.cpp
        │   │       │   │   └── GpuParticleManager.h
        │   │       │   └── Physics/
        │   │       │       ├── GpuPhysicsParticleFluid.cpp
        │   │       │       └── GpuPhysicsParticleFluid.h
        │   │       ├── GraphicsPipeline/
        │   │       │   ├── AutoExposure.cpp
        │   │       │   ├── AutoExposure.h
        │   │       │   ├── BillboardGraphicsPipeline.cpp
        │   │       │   ├── BillboardGraphicsPipeline.h
        │   │       │   ├── Bloom.cpp
        │   │       │   ├── Bloom.h
        │   │       │   ├── CharacterToolGraphicsPipeline.cpp
        │   │       │   ├── CharacterToolGraphicsPipeline.h
        │   │       │   ├── ClipVolumes.cpp
        │   │       │   ├── ClipVolumes.h
        │   │       │   ├── ColorGrading.cpp
        │   │       │   ├── ColorGrading.h
        │   │       │   ├── ComputeSkinning.cpp
        │   │       │   ├── ComputeSkinning.h
        │   │       │   ├── DebuggerGraphicsPipeline.cpp
        │   │       │   ├── DebuggerGraphicsPipeline.h
        │   │       │   ├── DebugRenderTargets.cpp
        │   │       │   ├── DebugRenderTargets.h
        │   │       │   ├── DeferredDecals.cpp
        │   │       │   ├── DeferredDecals.h
        │   │       │   ├── DepthOfField.cpp
        │   │       │   ├── DepthOfField.h
        │   │       │   ├── Fog.cpp
        │   │       │   ├── Fog.h
        │   │       │   ├── GpuParticles.cpp
        │   │       │   ├── GpuParticles.h
        │   │       │   ├── HeightMapAO.cpp
        │   │       │   ├── HeightMapAO.h
        │   │       │   ├── LensOptics.cpp
        │   │       │   ├── LensOptics.h
        │   │       │   ├── MinimumGraphicsPipeline.cpp
        │   │       │   ├── MinimumGraphicsPipeline.h
        │   │       │   ├── MobileComposition.cpp
        │   │       │   ├── MobileComposition.h
        │   │       │   ├── MobileGraphicsPipeline.cpp
        │   │       │   ├── MobileGraphicsPipeline.h
        │   │       │   ├── MotionBlur.cpp
        │   │       │   ├── MotionBlur.h
        │   │       │   ├── OmniCamera.cpp
        │   │       │   ├── OmniCamera.h
        │   │       │   ├── PostAA.cpp
        │   │       │   ├── PostAA.h
        │   │       │   ├── PostEffects.cpp
        │   │       │   ├── PostEffects.h
        │   │       │   ├── Rain.cpp
        │   │       │   ├── Rain.h
        │   │       │   ├── SceneCustom.cpp
        │   │       │   ├── SceneCustom.h
        │   │       │   ├── SceneDepth.cpp
        │   │       │   ├── SceneDepth.h
        │   │       │   ├── SceneForward.cpp
        │   │       │   ├── SceneForward.h
        │   │       │   ├── SceneGBuffer.cpp
        │   │       │   ├── SceneGBuffer.h
        │   │       │   ├── ScreenSpaceObscurance.cpp
        │   │       │   ├── ScreenSpaceObscurance.h
        │   │       │   ├── ScreenSpaceReflections.cpp
        │   │       │   ├── ScreenSpaceReflections.h
        │   │       │   ├── ScreenSpaceSSS.cpp
        │   │       │   ├── ScreenSpaceSSS.h
        │   │       │   ├── ShadowMap.cpp
        │   │       │   ├── ShadowMap.h
        │   │       │   ├── ShadowMask.cpp
        │   │       │   ├── ShadowMask.h
        │   │       │   ├── Sky.cpp
        │   │       │   ├── Sky.h
        │   │       │   ├── Snow.cpp
        │   │       │   ├── Snow.h
        │   │       │   ├── StandardGraphicsPipeline.cpp
        │   │       │   ├── StandardGraphicsPipeline.h
        │   │       │   ├── SunShafts.cpp
        │   │       │   ├── SunShafts.h
        │   │       │   ├── TiledLightVolumes.cpp
        │   │       │   ├── TiledLightVolumes.h
        │   │       │   ├── TiledShading.cpp
        │   │       │   ├── TiledShading.h
        │   │       │   ├── ToneMapping.cpp
        │   │       │   ├── ToneMapping.h
        │   │       │   ├── VolumetricClouds.cpp
        │   │       │   ├── VolumetricClouds.h
        │   │       │   ├── VolumetricFog.cpp
        │   │       │   ├── VolumetricFog.h
        │   │       │   ├── Water.cpp
        │   │       │   ├── Water.h
        │   │       │   ├── WaterRipples.cpp
        │   │       │   ├── WaterRipples.h
        │   │       │   └── Common/
        │   │       │       ├── ComputeRenderPass.cpp
        │   │       │       ├── ComputeRenderPass.h
        │   │       │       ├── FullscreenPass.cpp
        │   │       │       ├── FullscreenPass.h
        │   │       │       ├── GraphicsHelpers.h
        │   │       │       ├── GraphicsPipeline.cpp
        │   │       │       ├── GraphicsPipeline.h
        │   │       │       ├── GraphicsPipelineStage.cpp
        │   │       │       ├── GraphicsPipelineStage.h
        │   │       │       ├── GraphicsPipelineStateSet.cpp
        │   │       │       ├── GraphicsPipelineStateSet.h
        │   │       │       ├── PrimitiveRenderPass.cpp
        │   │       │       ├── PrimitiveRenderPass.h
        │   │       │       ├── RenderPassBase.h
        │   │       │       ├── RenderPassScheduler.cpp
        │   │       │       ├── RenderPassScheduler.h
        │   │       │       ├── SceneRenderPass.cpp
        │   │       │       ├── SceneRenderPass.h
        │   │       │       ├── UtilityPasses.cpp
        │   │       │       └── UtilityPasses.h
        │   │       └── Vulkan/
        │   │           ├── CryVulkan.cpp
        │   │           ├── CryVulkan.hpp
        │   │           ├── D3DVKConversionUtility.hpp
        │   │           ├── vulkan_renderer.waf_files
        │   │           ├── vulkan_win.waf_files
        │   │           ├── API/
        │   │           │   ├── VKAsyncCommandQueue.cpp
        │   │           │   ├── VKAsyncCommandQueue.hpp
        │   │           │   ├── VKBase.cpp
        │   │           │   ├── VKBase.hpp
        │   │           │   ├── VKBufferResource.cpp
        │   │           │   ├── VKBufferResource.hpp
        │   │           │   ├── VKCommandList.cpp
        │   │           │   ├── VKCommandList.hpp
        │   │           │   ├── VKCommandListFence.cpp
        │   │           │   ├── VKCommandListFence.hpp
        │   │           │   ├── VKCommandScheduler.cpp
        │   │           │   ├── VKCommandScheduler.hpp
        │   │           │   ├── VKDescriptorSet.cpp
        │   │           │   ├── VKDevice.cpp
        │   │           │   ├── VKDevice.hpp
        │   │           │   ├── VKExtensions.cpp
        │   │           │   ├── VKExtensions.hpp
        │   │           │   ├── VKHeap.cpp
        │   │           │   ├── VKHeap.hpp
        │   │           │   ├── VKImageResource.cpp
        │   │           │   ├── VKImageResource.hpp
        │   │           │   ├── VKInstance.cpp
        │   │           │   ├── VKInstance.hpp
        │   │           │   ├── VKLegacyToBeRemoved.cpp
        │   │           │   ├── VKMemoryResource.cpp
        │   │           │   ├── VKMemoryResource.hpp
        │   │           │   ├── VKOcclusionQueryManager.cpp
        │   │           │   ├── VKOcclusionQueryManager.hpp
        │   │           │   ├── VKResourceView.cpp
        │   │           │   ├── VKResourceView.hpp
        │   │           │   ├── VKSampler.cpp
        │   │           │   ├── VKSampler.hpp
        │   │           │   ├── VKShader.cpp
        │   │           │   ├── VKShader.hpp
        │   │           │   ├── VkSpirvHelper.hpp
        │   │           │   ├── VKSwapChain.cpp
        │   │           │   └── VKSwapChain.hpp
        │   │           └── CryVulkanWrappers/
        │   │               ├── GI/
        │   │               │   ├── CCryVKGIAdapter.cpp
        │   │               │   ├── CCryVKGIAdapter.hpp
        │   │               │   ├── CCryVKGIFactory.cpp
        │   │               │   ├── CCryVKGIFactory.hpp
        │   │               │   ├── CCryVKGIObject.hpp
        │   │               │   ├── CCryVKGIOutput.cpp
        │   │               │   ├── CCryVKGIOutput.hpp
        │   │               │   ├── CCryVKGuid.hpp
        │   │               │   ├── CCryVKMisc.hpp
        │   │               │   ├── CCryVKSwapChain.cpp
        │   │               │   ├── CCryVKSwapChain.hpp
        │   │               │   └── DXGI/
        │   │               │       ├── CCryVKGIAdapter_DXGI.cpp
        │   │               │       ├── CCryVKGIAdapter_DXGI.hpp
        │   │               │       ├── CCryVKGIFactory_DXGI.cpp
        │   │               │       ├── CCryVKGIFactory_DXGI.hpp
        │   │               │       ├── CCryVKGIOutput_DXGI.cpp
        │   │               │       └── CCryVKGIOutput_DXGI.hpp
        │   │               └── Resources/
        │   │                   ├── CCryVKShaderReflection.cpp
        │   │                   └── CCryVKShaderReflection.hpp
        │   └── UnitTests/
        │       ├── Common/
        │       │   ├── Main.cpp
        │       │   ├── Printer.cpp
        │       │   └── UnitTest.h
        │       ├── Cry3DEngineUnitTest/
        │       │   ├── CMakeLists.txt
        │       │   ├── cry3dengineunittest.waf_files
        │       │   └── ParticleSystemUnitTests.cpp
        │       ├── CryAISystemUnitTest/
        │       │   ├── CMakeLists.txt
        │       │   ├── cryaisystemunittest.waf_files
        │       │   └── Navigation/
        │       │       ├── FixedAABBTests.cpp
        │       │       └── NavMeshTests.cpp
        │       ├── CryAnimationUnitTest/
        │       │   ├── AnimListPatternMatchingTests.cpp
        │       │   ├── CMakeLists.txt
        │       │   ├── GraphDijkstraTests.cpp
        │       │   └── MergeParametricExamplesTests.cpp
        │       ├── CryAudioSystemUnitTest/
        │       │   ├── AudioSystemTests.cpp
        │       │   └── CMakeLists.txt
        │       ├── CryCommonUnitTest/
        │       │   ├── AlignedVectorTests.cpp
        │       │   ├── ArrayTests.cpp
        │       │   ├── CMakeLists.txt
        │       │   ├── CryTestTests.cpp
        │       │   ├── FileVersionTests.cpp
        │       │   ├── GUIDTests.cpp
        │       │   ├── HeapAllocatorTests.cpp
        │       │   ├── MathTests.cpp
        │       │   ├── PathTests.cpp
        │       │   ├── RingBufferTests.cpp
        │       │   ├── SmallFunctionTests.cpp
        │       │   ├── SmartPtrTests.cpp
        │       │   ├── StringTests.cpp
        │       │   ├── StringUtilsTests.cpp
        │       │   ├── TestFrameworkTest.cpp
        │       │   ├── ThreadSafePushContainerTest.cpp
        │       │   ├── TypeTraitsTests.cpp
        │       │   ├── Utils.cpp
        │       │   ├── Utils.h
        │       │   └── VariantTests.cpp
        │       ├── CryEntitySystemUnitTest/
        │       │   ├── CMakeLists.txt
        │       │   └── Entity.cpp
        │       └── CrySystemUnitTest/
        │           ├── ArchiveHostTests.cpp
        │           ├── CMakeLists.txt
        │           ├── JobTests.cpp
        │           └── xml.cpp
        ├── CryExtensions/
        │   ├── CMakeLists.txt
        │   ├── wscript
        │   └── CryLink/
        │       ├── Readme.txt
        │       ├── CMakeLists.txt
        │       ├── wscript
        │       ├── EditorPlugin/
        │       │   ├── CMakeLists.txt
        │       │   ├── editorplugin.waf_files
        │       │   ├── main.cpp
        │       │   ├── StdAfx.cpp
        │       │   ├── StdAfx.h
        │       │   └── wscript
        │       ├── Interface/
        │       │   └── CryLink/
        │       │       ├── CryLink.h
        │       │       └── IFramework.h
        │       ├── Module/
        │       │   ├── CMakeLists.txt
        │       │   ├── crylink.waf_files
        │       │   ├── CryLinkCVars.cpp
        │       │   ├── CryLinkCVars.h
        │       │   ├── CryLinkFramework.cpp
        │       │   ├── CryLinkFramework.h
        │       │   ├── CryLinkService.cpp
        │       │   ├── CryLinkService.h
        │       │   ├── StdAfx.cpp
        │       │   ├── StdAfx.h
        │       │   ├── wscript
        │       │   └── Utils/
        │       │       └── HttpRPC.h
        │       └── Tools/
        │           └── CryLinkHelper/
        │               ├── App.config
        │               ├── Command.cs
        │               ├── CryLinkHelper.csproj
        │               ├── CryLinkHelper.sln
        │               ├── CryLinkService.cs
        │               ├── HttpXmlRPC.cs
        │               ├── Install.cs
        │               ├── Program.cs
        │               ├── Settings.cs
        │               └── Properties/
        │                   └── AssemblyInfo.cs
        ├── CryManaged/
        │   ├── CMakeLists.txt
        │   ├── wscript
        │   ├── CESharp/
        │   │   ├── CMakeLists.txt
        │   │   ├── CryManaged.sln
        │   │   ├── _Docs/
        │   │   │   └── Doxyfile
        │   │   ├── Core/
        │   │   │   ├── Camera.cs
        │   │   │   ├── CMakeLists.txt
        │   │   │   ├── Core.csproj
        │   │   │   ├── Engine.cs
        │   │   │   ├── Extensions.cs
        │   │   │   ├── GameFramework.cs
        │   │   │   ├── ICryEnginePlugin.cs
        │   │   │   ├── LevelSystem.cs
        │   │   │   ├── Random.cs
        │   │   │   ├── SystemEventHandler.cs
        │   │   │   ├── Timer.cs
        │   │   │   ├── AI/
        │   │   │   │   ├── Attributes.cs
        │   │   │   │   ├── BehaviorTreeNode.cs
        │   │   │   │   ├── BehaviorTreeNodeFactory.cs
        │   │   │   │   └── LastingMovementRequest.cs
        │   │   │   ├── Animations/
        │   │   │   │   ├── ActionController.cs
        │   │   │   │   ├── AnimationContext.cs
        │   │   │   │   ├── AnimationContextAction.cs
        │   │   │   │   ├── AnimationDatabase.cs
        │   │   │   │   ├── AnimationDatabaseManager.cs
        │   │   │   │   ├── AnimationEvent.cs
        │   │   │   │   ├── AnimationTag.cs
        │   │   │   │   ├── Character.cs
        │   │   │   │   ├── CharacterAttachment.cs
        │   │   │   │   ├── ControllerDefinition.cs
        │   │   │   │   ├── Mannequin.cs
        │   │   │   │   ├── MotionParameterID.cs
        │   │   │   │   └── TagState.cs
        │   │   │   ├── Audio/
        │   │   │   │   ├── Audio.cs
        │   │   │   │   ├── AudioFile.cs
        │   │   │   │   ├── AudioListener.cs
        │   │   │   │   ├── AudioManager.cs
        │   │   │   │   ├── AudioObject.cs
        │   │   │   │   ├── AudioObjectTransformation.cs
        │   │   │   │   ├── AudioRequestInfo.cs
        │   │   │   │   └── Native/
        │   │   │   │       └── NativeAudioMethods.cs
        │   │   │   ├── Compilation/
        │   │   │   │   ├── CompilationFailedException.cs
        │   │   │   │   └── Compiler.cs
        │   │   │   ├── Console/
        │   │   │   │   ├── Attributes.cs
        │   │   │   │   ├── ConsoleCommand.cs
        │   │   │   │   ├── ConsoleVariable.cs
        │   │   │   │   └── Native/
        │   │   │   │       └── NativeConsoleMethods.cs
        │   │   │   ├── Debugging/
        │   │   │   │   ├── DebugDraw.cs
        │   │   │   │   ├── ExceptionHandler.cs
        │   │   │   │   ├── ExceptionMessage.cs
        │   │   │   │   ├── ExceptionMessage.Designer.cs
        │   │   │   │   ├── ExceptionMessage.resources
        │   │   │   │   ├── ExceptionMessage.resx
        │   │   │   │   └── Log.cs
        │   │   │   ├── EntitySystem/
        │   │   │   │   ├── Entity.cs
        │   │   │   │   ├── EntityComponent.cs
        │   │   │   │   ├── EntityId.cs
        │   │   │   │   ├── EntityProperty.cs
        │   │   │   │   ├── EntitySlotFlags.cs
        │   │   │   │   ├── EntityStatics.cs
        │   │   │   │   ├── PhysicsEntity.cs
        │   │   │   │   ├── Attributes/
        │   │   │   │   │   ├── EntityClassAttribute.cs
        │   │   │   │   │   ├── EntityComponentAttribute.cs
        │   │   │   │   │   ├── SchematycMethodAttribute.cs
        │   │   │   │   │   └── SchematycSignalAttribute.cs
        │   │   │   │   ├── Enums/
        │   │   │   │   │   ├── EntityFlags.cs
        │   │   │   │   │   └── Primitives.cs
        │   │   │   │   └── Native/
        │   │   │   │       └── NativeEntityMethods.cs
        │   │   │   ├── FileSystem/
        │   │   │   │   ├── CryPakFile.cs
        │   │   │   │   ├── Directory.cs
        │   │   │   │   ├── File.cs
        │   │   │   │   ├── FileMode.cs
        │   │   │   │   └── Path.cs
        │   │   │   ├── Input/
        │   │   │   │   ├── ActionHandler.cs
        │   │   │   │   ├── Input.cs
        │   │   │   │   ├── InputEvent.cs
        │   │   │   │   ├── Mouse.cs
        │   │   │   │   └── Enums/
        │   │   │   │       ├── InputDeviceType.cs
        │   │   │   │       ├── InputModifierFlags.cs
        │   │   │   │       ├── InputState.cs
        │   │   │   │       └── KeyId.cs
        │   │   │   ├── Lights/
        │   │   │   │   ├── DynamicLight.cs
        │   │   │   │   └── RenderLight.cs
        │   │   │   ├── Math/
        │   │   │   │   ├── Angles3.cs
        │   │   │   │   ├── Color.cs
        │   │   │   │   ├── MathHelpers.cs
        │   │   │   │   ├── Matrix3x3.cs
        │   │   │   │   ├── Matrix3x4.cs
        │   │   │   │   ├── Matrix4x4.cs
        │   │   │   │   ├── Primitives.cs
        │   │   │   │   ├── Quaternion.cs
        │   │   │   │   ├── Vector2.cs
        │   │   │   │   ├── Vector3.cs
        │   │   │   │   └── Vector4.cs
        │   │   │   ├── Particles/
        │   │   │   │   ├── ParticleAttributes.cs
        │   │   │   │   ├── ParticleEffect.cs
        │   │   │   │   ├── ParticleEffectListener.cs
        │   │   │   │   ├── ParticleEmitter.cs
        │   │   │   │   ├── ParticleLocation.cs
        │   │   │   │   ├── ParticleManager.cs
        │   │   │   │   └── SpawnParameters.cs
        │   │   │   ├── Physics/
        │   │   │   │   ├── Physics.cs
        │   │   │   │   ├── Ray.cs
        │   │   │   │   ├── RaycastHit.cs
        │   │   │   │   ├── Enums/
        │   │   │   │   │   ├── AreaType.cs
        │   │   │   │   │   ├── EntityRaycastFlags.cs
        │   │   │   │   │   ├── PhysicalizationType.cs
        │   │   │   │   │   └── PhysicsEntityFlags.cs
        │   │   │   │   ├── Parameters/
        │   │   │   │   │   ├── AreaParameters.cs
        │   │   │   │   │   ├── BasePhysicsParameters.cs
        │   │   │   │   │   ├── BuoyancyParameters.cs
        │   │   │   │   │   ├── CarParameters.cs
        │   │   │   │   │   ├── ParticleParameters.cs
        │   │   │   │   │   ├── PlayerDimensionsParameters.cs
        │   │   │   │   │   └── PlayerDynamicsParameters.cs
        │   │   │   │   ├── PhysicalizeParameters/
        │   │   │   │   │   ├── AreaPhysicalizeParams.cs
        │   │   │   │   │   ├── ArticulatedPhysicalizeParams.cs
        │   │   │   │   │   ├── EntityPhysicalizeParams.cs
        │   │   │   │   │   ├── LivingPhysicalizeParams.cs
        │   │   │   │   │   ├── ParticlePhysicalizeParams.cs
        │   │   │   │   │   ├── RigidPhysicalizeParams.cs
        │   │   │   │   │   ├── RopePhysicalizeParams.cs
        │   │   │   │   │   ├── SoftPhysicalizeParams.cs
        │   │   │   │   │   ├── StaticPhysicalizeParams.cs
        │   │   │   │   │   └── WheeledVehiclePhysicalizeParams.cs
        │   │   │   │   └── PhysicsStatus/
        │   │   │   │       ├── BasePhysicsStatus.cs
        │   │   │   │       ├── DynamicsStatus.cs
        │   │   │   │       ├── LivingStatus.cs
        │   │   │   │       └── VehicleStatus.cs
        │   │   │   ├── Properties/
        │   │   │   │   └── AssemblyInfo.cs
        │   │   │   ├── Rendering/
        │   │   │   │   └── Renderer.cs
        │   │   │   ├── Resources/
        │   │   │   │   └── Texture.cs
        │   │   │   ├── Serialization/
        │   │   │   │   ├── CachedTypeInfo.cs
        │   │   │   │   ├── DomainSerializer.cs
        │   │   │   │   ├── ISerializedObject.cs
        │   │   │   │   ├── ObjectReader.cs
        │   │   │   │   ├── ObjectWriter.cs
        │   │   │   │   └── SerializeValueAttribute.cs
        │   │   │   └── Util/
        │   │   │       ├── Attribute.cs
        │   │   │       ├── AutoPinner.cs
        │   │   │       ├── Event.cs
        │   │   │       ├── IconType.cs
        │   │   │       ├── ReflectionHelper.cs
        │   │   │       ├── Tools.cs
        │   │   │       └── View.cs
        │   │   ├── Core.Tests/
        │   │   │   ├── CMakeLists.txt
        │   │   │   ├── Core.Tests.csproj
        │   │   │   ├── packages.config
        │   │   │   ├── Entity/
        │   │   │   │   └── IconsTest.cs
        │   │   │   ├── Math/
        │   │   │   │   ├── MathHelpersTest.cs
        │   │   │   │   ├── Matrix3x3Test.cs
        │   │   │   │   ├── Matrix3x4Test.cs
        │   │   │   │   ├── Matrix4x4Test.cs
        │   │   │   │   ├── QuaternionTest.cs
        │   │   │   │   ├── Vector2Test.cs
        │   │   │   │   ├── Vector3Test.cs
        │   │   │   │   └── Vector4Test.cs
        │   │   │   ├── Properties/
        │   │   │   │   └── AssemblyInfo.cs
        │   │   │   └── Serialization/
        │   │   │       └── DomainSerializerTests.cs
        │   │   └── Core.UI/
        │   │       ├── Button.cs
        │   │       ├── Canvas.cs
        │   │       ├── CheckBox.cs
        │   │       ├── CMakeLists.txt
        │   │       ├── ComboBox.cs
        │   │       ├── Core.UI.csproj
        │   │       ├── HorizontalLayoutGroup.cs
        │   │       ├── IUIComponent.cs
        │   │       ├── LayoutGroup.cs
        │   │       ├── Panel.cs
        │   │       ├── SceneManager.cs
        │   │       ├── SceneObject.cs
        │   │       ├── ScrollPanel.cs
        │   │       ├── Splitter.cs
        │   │       ├── TextElement.cs
        │   │       ├── TextInput.cs
        │   │       ├── Transform.cs
        │   │       ├── UIElement.cs
        │   │       ├── VerticalLayoutGroup.cs
        │   │       ├── Window.cs
        │   │       ├── Components/
        │   │       │   ├── ButtonCtrl.cs
        │   │       │   ├── CheckBoxCtrl.cs
        │   │       │   ├── CollapseCtrl.cs
        │   │       │   ├── ComboBoxCtrl.cs
        │   │       │   ├── Image.cs
        │   │       │   ├── RectTransform.cs
        │   │       │   ├── ScrollBarCtrl.cs
        │   │       │   ├── SplitBarCtrl.cs
        │   │       │   ├── Text.cs
        │   │       │   ├── TextCtrl.cs
        │   │       │   └── UIComponent.cs
        │   │       ├── Properties/
        │   │       │   └── AssemblyInfo.cs
        │   │       └── Resources/
        │   │           ├── Graphic.cs
        │   │           ├── ImageSource.cs
        │   │           └── Resource.cs
        │   └── CryMonoBridge/
        │       ├── CMakeLists.txt
        │       ├── CryMonoBridge.rc
        │       ├── crymonobridge.waf_files
        │       ├── ManagedPlugin.cpp
        │       ├── ManagedPlugin.h
        │       ├── MonoRuntime.cpp
        │       ├── MonoRuntime.h
        │       ├── resource.h
        │       ├── StdAfx.cpp
        │       ├── StdAfx.h
        │       ├── wscript
        │       ├── NativeComponents/
        │       │   ├── EntityComponentFactory.cpp
        │       │   ├── EntityComponentFactory.h
        │       │   ├── GameRules.cpp
        │       │   ├── ManagedEntityComponent.cpp
        │       │   └── ManagedEntityComponent.h
        │       ├── NativeToManagedInterfaces/
        │       │   ├── Audio.cpp
        │       │   ├── Audio.h
        │       │   ├── Console.cpp
        │       │   ├── Console.h
        │       │   ├── Entity.cpp
        │       │   ├── Entity.h
        │       │   └── IMonoNativeToManagedInterface.h
        │       ├── SWIG/
        │       │   ├── CMakeLists.txt
        │       │   ├── Cry3DEngine.i
        │       │   ├── CryAction.i
        │       │   ├── CryAISystem.i
        │       │   ├── CryAnimation.i
        │       │   ├── CryAudio.i
        │       │   ├── CryCommon.i
        │       │   ├── CryDynamicResponseSystem.i
        │       │   ├── CryEngine.swig
        │       │   ├── CryEntitySystem.i
        │       │   ├── CryFont.i
        │       │   ├── CryInput.i
        │       │   ├── CryLiveCreate.i
        │       │   ├── CryLobby.i
        │       │   ├── CryMonoBridge.i
        │       │   ├── CryMovie.i
        │       │   ├── CryNetwork.i
        │       │   ├── CryPhysics.i
        │       │   ├── CryRender.i
        │       │   ├── CryScriptSystem.i
        │       │   ├── CrySystem.i
        │       │   └── ForwardDeclarations.i
        │       └── Wrappers/
        │           ├── AppDomain.cpp
        │           ├── AppDomain.h
        │           ├── CompiledMonoLibrary.cpp
        │           ├── CompiledMonoLibrary.h
        │           ├── MonoClass.cpp
        │           ├── MonoClass.h
        │           ├── MonoDomain.cpp
        │           ├── MonoDomain.h
        │           ├── MonoException.cpp
        │           ├── MonoException.h
        │           ├── MonoLibrary.cpp
        │           ├── MonoLibrary.h
        │           ├── MonoMethod.cpp
        │           ├── MonoMethod.h
        │           ├── MonoObject.cpp
        │           ├── MonoObject.h
        │           ├── MonoProperty.cpp
        │           ├── MonoProperty.h
        │           ├── MonoString.cpp
        │           ├── MonoString.h
        │           ├── RootMonoDomain.cpp
        │           └── RootMonoDomain.h
        ├── CryPlugins/
        │   ├── CMakeLists.txt
        │   ├── wscript
        │   ├── CryDefaultEntities/
        │   │   ├── wscript
        │   │   └── Module/
        │   │       ├── CMakeLists.txt
        │   │       ├── IDefaultComponentsPlugin.h
        │   │       ├── plugin.waf_files
        │   │       ├── PluginDll.cpp
        │   │       ├── PluginDll.h
        │   │       ├── resource.h
        │   │       ├── StdAfx.cpp
        │   │       ├── StdAfx.h
        │   │       ├── wscript
        │   │       ├── DefaultComponents/
        │   │       │   ├── Audio/
        │   │       │   │   ├── AreaComponent.cpp
        │   │       │   │   ├── AreaComponent.h
        │   │       │   │   ├── DefaultTriggerComponent.cpp
        │   │       │   │   ├── DefaultTriggerComponent.h
        │   │       │   │   ├── EnvironmentComponent.cpp
        │   │       │   │   ├── EnvironmentComponent.h
        │   │       │   │   ├── ListenerComponent.cpp
        │   │       │   │   ├── ListenerComponent.h
        │   │       │   │   ├── MultiListenerComponent.cpp
        │   │       │   │   ├── MultiListenerComponent.h
        │   │       │   │   ├── OcclusionComponent.cpp
        │   │       │   │   ├── OcclusionComponent.h
        │   │       │   │   ├── ParameterComponent.cpp
        │   │       │   │   ├── ParameterComponent.h
        │   │       │   │   ├── PreloadComponent.cpp
        │   │       │   │   ├── PreloadComponent.h
        │   │       │   │   ├── SettingComponent.cpp
        │   │       │   │   ├── SettingComponent.h
        │   │       │   │   ├── SwitchStateComponent.cpp
        │   │       │   │   ├── SwitchStateComponent.h
        │   │       │   │   ├── TriggerComponent.cpp
        │   │       │   │   ├── TriggerComponent.h
        │   │       │   │   ├── VelocityComponent.cpp
        │   │       │   │   └── VelocityComponent.h
        │   │       │   ├── Cameras/
        │   │       │   │   ├── CameraComponent.cpp
        │   │       │   │   ├── CameraComponent.h
        │   │       │   │   ├── CameraManager.h
        │   │       │   │   ├── ICameraManager.h
        │   │       │   │   └── VirtualReality/
        │   │       │   │       ├── RoomscaleCamera.cpp
        │   │       │   │       └── RoomscaleCamera.h
        │   │       │   ├── ComponentHelpers/
        │   │       │   │   └── PhysicsParameters.h
        │   │       │   ├── Constraints/
        │   │       │   │   ├── BreakableJoint.cpp
        │   │       │   │   ├── BreakableJoint.h
        │   │       │   │   ├── LineConstraint.cpp
        │   │       │   │   ├── LineConstraint.h
        │   │       │   │   ├── PlaneConstraint.cpp
        │   │       │   │   ├── PlaneConstraint.h
        │   │       │   │   ├── PointConstraint.cpp
        │   │       │   │   └── PointConstraint.h
        │   │       │   ├── Debug/
        │   │       │   │   ├── DebugDrawComponent.cpp
        │   │       │   │   └── DebugDrawComponent.h
        │   │       │   ├── Effects/
        │   │       │   │   ├── DecalComponent.cpp
        │   │       │   │   ├── DecalComponent.h
        │   │       │   │   ├── FogComponent.cpp
        │   │       │   │   ├── FogComponent.h
        │   │       │   │   ├── ParticleComponent.cpp
        │   │       │   │   ├── ParticleComponent.h
        │   │       │   │   ├── RainComponent.cpp
        │   │       │   │   ├── RainComponent.h
        │   │       │   │   ├── WaterRippleComponent.cpp
        │   │       │   │   └── WaterRippleComponent.h
        │   │       │   ├── Geometry/
        │   │       │   │   ├── AdvancedAnimationComponent.cpp
        │   │       │   │   ├── AdvancedAnimationComponent.h
        │   │       │   │   ├── AlembicComponent.cpp
        │   │       │   │   ├── AlembicComponent.h
        │   │       │   │   ├── AnimatedMeshComponent.cpp
        │   │       │   │   ├── AnimatedMeshComponent.h
        │   │       │   │   ├── BaseMeshComponent.cpp
        │   │       │   │   ├── BaseMeshComponent.h
        │   │       │   │   ├── StaticMeshComponent.cpp
        │   │       │   │   └── StaticMeshComponent.h
        │   │       │   ├── Input/
        │   │       │   │   ├── InputComponent.cpp
        │   │       │   │   └── InputComponent.h
        │   │       │   ├── Lights/
        │   │       │   │   ├── EnvironmentProbeComponent.cpp
        │   │       │   │   ├── EnvironmentProbeComponent.h
        │   │       │   │   ├── ILightComponent.h
        │   │       │   │   ├── PointLightComponent.cpp
        │   │       │   │   ├── PointLightComponent.h
        │   │       │   │   ├── ProjectorLightComponent.cpp
        │   │       │   │   └── ProjectorLightComponent.h
        │   │       │   ├── Physics/
        │   │       │   │   ├── AreaComponent.cpp
        │   │       │   │   ├── AreaComponent.h
        │   │       │   │   ├── BoxPrimitiveComponent.cpp
        │   │       │   │   ├── BoxPrimitiveComponent.h
        │   │       │   │   ├── CapsulePrimitiveComponent.cpp
        │   │       │   │   ├── CapsulePrimitiveComponent.h
        │   │       │   │   ├── CharacterControllerComponent.cpp
        │   │       │   │   ├── CharacterControllerComponent.h
        │   │       │   │   ├── ClothComponent.cpp
        │   │       │   │   ├── ClothComponent.h
        │   │       │   │   ├── CylinderPrimitiveComponent.cpp
        │   │       │   │   ├── CylinderPrimitiveComponent.h
        │   │       │   │   ├── LocalGridComponent.cpp
        │   │       │   │   ├── LocalGridComponent.h
        │   │       │   │   ├── ParticleComponent.cpp
        │   │       │   │   ├── ParticleComponent.h
        │   │       │   │   ├── PhysicsPrimitiveComponent.cpp
        │   │       │   │   ├── PhysicsPrimitiveComponent.h
        │   │       │   │   ├── RagdollComponent.cpp
        │   │       │   │   ├── RagdollComponent.h
        │   │       │   │   ├── RigidBodyComponent.cpp
        │   │       │   │   ├── RigidBodyComponent.h
        │   │       │   │   ├── SampleRigidbodyActorComponent.cpp
        │   │       │   │   ├── SampleRigidbodyActorComponent.h
        │   │       │   │   ├── SpherePrimitiveComponent.cpp
        │   │       │   │   ├── SpherePrimitiveComponent.h
        │   │       │   │   ├── ThrusterComponent.cpp
        │   │       │   │   ├── ThrusterComponent.h
        │   │       │   │   ├── WaterVolumeComponent.cpp
        │   │       │   │   ├── WaterVolumeComponent.h
        │   │       │   │   ├── Vehicles/
        │   │       │   │   │   ├── VehicleComponent.cpp
        │   │       │   │   │   ├── VehicleComponent.h
        │   │       │   │   │   ├── WheelComponent.cpp
        │   │       │   │   │   └── WheelComponent.h
        │   │       │   │   └── VirtualReality/
        │   │       │   │       ├── VirtualRealityInteractionComponent.cpp
        │   │       │   │       └── VirtualRealityInteractionComponent.h
        │   │       │   └── Utilities/
        │   │       │       ├── ChildEntityComponent.cpp
        │   │       │       └── ChildEntityComponent.h
        │   │       └── Legacy/
        │   │           ├── AI/
        │   │           │   ├── TagPoint.cpp
        │   │           │   └── TagPoint.h
        │   │           ├── Audio/
        │   │           │   ├── AudioAreaAmbienceEntity.cpp
        │   │           │   ├── AudioAreaAmbienceEntity.h
        │   │           │   ├── AudioAreaEntity.cpp
        │   │           │   ├── AudioAreaEntity.h
        │   │           │   ├── AudioAreaRandom.cpp
        │   │           │   ├── AudioAreaRandom.h
        │   │           │   ├── AudioEntitiesUtils.cpp
        │   │           │   ├── AudioEntitiesUtils.h
        │   │           │   ├── AudioTriggerSpotEntity.cpp
        │   │           │   └── AudioTriggerSpotEntity.h
        │   │           ├── Cameras/
        │   │           │   ├── CameraSource.cpp
        │   │           │   └── CameraSource.h
        │   │           ├── Debug/
        │   │           │   ├── Comment.cpp
        │   │           │   └── Comment.h
        │   │           ├── Geometry/
        │   │           │   ├── GeomEntity.cpp
        │   │           │   └── GeomEntity.h
        │   │           ├── Helpers/
        │   │           │   ├── DesignerEntityComponent.cpp
        │   │           │   ├── DesignerEntityComponent.h
        │   │           │   ├── EntityFlowNode.cpp
        │   │           │   └── EntityFlowNode.h
        │   │           ├── Lights/
        │   │           │   ├── EnvironmentProbe.cpp
        │   │           │   ├── EnvironmentProbe.h
        │   │           │   ├── LightEntity.cpp
        │   │           │   └── LightEntity.h
        │   │           ├── Particles/
        │   │           │   ├── ParticleEntity.cpp
        │   │           │   └── ParticleEntity.h
        │   │           ├── Physics/
        │   │           │   ├── LocalGrid.cpp
        │   │           │   ├── LocalGrid.h
        │   │           │   └── RopeEntity.cpp
        │   │           └── Triggers/
        │   │               ├── TriggerEntity.cpp
        │   │               └── TriggerEntity.h
        │   ├── CryGamePlatform/
        │   │   ├── CMakeLists.txt
        │   │   ├── wscript
        │   │   ├── Interface/
        │   │   │   ├── IGamePlatform.h
        │   │   │   ├── IPlatformAccount.h
        │   │   │   ├── IPlatformAchievement.h
        │   │   │   ├── IPlatformBase.h
        │   │   │   ├── IPlatformLeaderboards.h
        │   │   │   ├── IPlatformLobby.h
        │   │   │   ├── IPlatformMatchmaking.h
        │   │   │   ├── IPlatformNetworking.h
        │   │   │   ├── IPlatformRemoteStorage.h
        │   │   │   ├── IPlatformServer.h
        │   │   │   ├── IPlatformService.h
        │   │   │   ├── IPlatformStatistics.h
        │   │   │   ├── IPlatformUser.h
        │   │   │   ├── IPlatformUserGeneratedContent.h
        │   │   │   ├── PlatformIdentifier.h
        │   │   │   ├── PlatformTypes.h
        │   │   │   └── PlatformUserIdentifier.h
        │   │   └── Module/
        │   │       ├── StdAfx.h
        │   │       ├── wscript
        │   │       ├── Core/
        │   │       │   ├── CMakeLists.txt
        │   │       │   ├── crygameplatform.waf_files
        │   │       │   ├── GamePlatform.cpp
        │   │       │   ├── GamePlatform.h
        │   │       │   ├── resource.h
        │   │       │   ├── StdAfx.cpp
        │   │       │   ├── StdAfx.h
        │   │       │   ├── User.cpp
        │   │       │   ├── User.h
        │   │       │   └── wscript
        │   │       ├── Discord/
        │   │       │   ├── CMakeLists.txt
        │   │       │   ├── discord.waf_files
        │   │       │   ├── DiscordAccount.cpp
        │   │       │   ├── DiscordAccount.h
        │   │       │   ├── DiscordService.cpp
        │   │       │   ├── DiscordService.h
        │   │       │   ├── DiscordTypes.h
        │   │       │   ├── DiscordUserIdentifier.h
        │   │       │   ├── resource.h
        │   │       │   ├── StdAfx.cpp
        │   │       │   └── StdAfx.h
        │   │       ├── Rail/
        │   │       │   ├── CMakeLists.txt
        │   │       │   ├── RailAccount.cpp
        │   │       │   ├── RailAccount.h
        │   │       │   ├── RailHelper.cpp
        │   │       │   ├── RailHelper.h
        │   │       │   ├── RailMatchmaking.cpp
        │   │       │   ├── RailMatchmaking.h
        │   │       │   ├── RailNetworking.cpp
        │   │       │   ├── RailNetworking.h
        │   │       │   ├── RailService.cpp
        │   │       │   ├── RailService.h
        │   │       │   ├── RailTypes.h
        │   │       │   ├── RailUserLobby.cpp
        │   │       │   ├── RailUserLobby.h
        │   │       │   ├── resource.h
        │   │       │   ├── StdAfx.cpp
        │   │       │   └── StdAfx.h
        │   │       └── Steam/
        │   │           ├── CMakeLists.txt
        │   │           ├── CryGamePlatform_Steam.waf_files
        │   │           ├── resource.h
        │   │           ├── StdAfx.cpp
        │   │           ├── StdAfx.h
        │   │           ├── SteamAccount.cpp
        │   │           ├── SteamAccount.h
        │   │           ├── SteamAchievement.cpp
        │   │           ├── SteamAchievement.h
        │   │           ├── SteamLeaderboards.cpp
        │   │           ├── SteamLeaderboards.h
        │   │           ├── SteamMatchmaking.cpp
        │   │           ├── SteamMatchmaking.h
        │   │           ├── SteamNetworking.cpp
        │   │           ├── SteamNetworking.h
        │   │           ├── SteamRemoteFile.cpp
        │   │           ├── SteamRemoteFile.h
        │   │           ├── SteamRemoteStorage.cpp
        │   │           ├── SteamRemoteStorage.h
        │   │           ├── SteamServer.cpp
        │   │           ├── SteamServer.h
        │   │           ├── SteamService.cpp
        │   │           ├── SteamService.h
        │   │           ├── SteamSharedRemoteFile.cpp
        │   │           ├── SteamSharedRemoteFile.h
        │   │           ├── SteamStatistics.cpp
        │   │           ├── SteamStatistics.h
        │   │           ├── SteamTypes.h
        │   │           ├── SteamUserIdentifier.h
        │   │           ├── SteamUserLobby.cpp
        │   │           ├── SteamUserLobby.h
        │   │           ├── UserGeneratedContent.cpp
        │   │           ├── UserGeneratedContent.h
        │   │           ├── UserGeneratedContentManager.cpp
        │   │           ├── UserGeneratedContentManager.h
        │   │           └── wscript
        │   ├── CryHTTP/
        │   │   ├── wscript
        │   │   ├── Interface/
        │   │   │   └── IHttpPlugin.h
        │   │   └── Module/
        │   │       ├── CMakeLists.txt
        │   │       ├── cryhttp.waf_files
        │   │       ├── HttpImplementation_cURL.cpp
        │   │       ├── HttpImplementation_cURL.h
        │   │       ├── resource.h
        │   │       ├── StdAfx.cpp
        │   │       ├── StdAfx.h
        │   │       └── wscript
        │   ├── CryLobby/
        │   │   ├── CMakeLists.txt
        │   │   ├── wscript
        │   │   ├── Interface/
        │   │   │   └── CryLobby/
        │   │   │       ├── CryLobbyPacket.h
        │   │   │       ├── ICryFriends.h
        │   │   │       ├── ICryFriendsManagement.h
        │   │   │       ├── ICryLobby.h
        │   │   │       ├── ICryLobbyEvent.h
        │   │   │       ├── ICryLobbyPrivate.h
        │   │   │       ├── ICryLobbyUI.h
        │   │   │       ├── ICryMatchMaking.h
        │   │   │       ├── ICryReward.h
        │   │   │       ├── ICrySignIn.h
        │   │   │       ├── ICryTCPService.h
        │   │   │       └── ICryVoice.h
        │   │   └── Module/
        │   │       ├── CMakeLists.txt
        │   │       ├── CryDedicatedServer.cpp
        │   │       ├── CryDedicatedServer.h
        │   │       ├── CryDedicatedServerArbitrator.cpp
        │   │       ├── CryDedicatedServerArbitrator.h
        │   │       ├── CryFriends.cpp
        │   │       ├── CryFriends.h
        │   │       ├── CryFriendsManagement.cpp
        │   │       ├── CryFriendsManagement.h
        │   │       ├── CryHostMigration.cpp
        │   │       ├── CryHostMigration.h
        │   │       ├── CryLobby.cpp
        │   │       ├── CryLobby.h
        │   │       ├── CryLobby.rc
        │   │       ├── crylobby_core.waf_files
        │   │       ├── CryLobbyUI.cpp
        │   │       ├── CryLobbyUI.h
        │   │       ├── CryMatchMaking.cpp
        │   │       ├── CryMatchMaking.h
        │   │       ├── CryReward.cpp
        │   │       ├── CryReward.h
        │   │       ├── CrySharedLobbyPacket.h
        │   │       ├── CrySignIn.cpp
        │   │       ├── CrySignIn.h
        │   │       ├── CryStats.cpp
        │   │       ├── CryStats.h
        │   │       ├── CryTCPService.cpp
        │   │       ├── CryTCPService.h
        │   │       ├── CryTCPServiceFactory.cpp
        │   │       ├── CryTCPServiceFactory.h
        │   │       ├── CryVoice.cpp
        │   │       ├── CryVoice.h
        │   │       ├── durango_lobby.waf_files
        │   │       ├── LobbyCVars.cpp
        │   │       ├── LobbyCVars.h
        │   │       ├── orbis_lobby.waf_files
        │   │       ├── resource.h
        │   │       ├── StdAfx.cpp
        │   │       ├── StdAfx.h
        │   │       ├── steam_lobby.waf_files
        │   │       ├── wscript
        │   │       ├── LAN/
        │   │       │   ├── CryLANLobby.cpp
        │   │       │   ├── CryLANLobby.h
        │   │       │   ├── CryLANMatchMaking.cpp
        │   │       │   └── CryLANMatchMaking.h
        │   │       └── Steam/
        │   │           ├── CrySteamFriends.cpp
        │   │           ├── CrySteamFriends.h
        │   │           ├── CrySteamFriendsManagement.cpp
        │   │           ├── CrySteamFriendsManagement.h
        │   │           ├── CrySteamLobby.cpp
        │   │           ├── CrySteamLobby.h
        │   │           ├── CrySteamMatchMaking.cpp
        │   │           ├── CrySteamMatchMaking.h
        │   │           ├── CrySteamReward.cpp
        │   │           ├── CrySteamReward.h
        │   │           ├── CrySteamStats.cpp
        │   │           ├── CrySteamStats.h
        │   │           └── CrySteamVoice.h
        │   ├── CryPerceptionSystem/
        │   │   ├── CMakeLists.txt
        │   │   ├── wscript
        │   │   ├── Interface/
        │   │   │   ├── ICryPerceptionSystemPlugin.h
        │   │   │   └── IPerceptionManager.h
        │   │   └── Module/
        │   │       ├── CMakeLists.txt
        │   │       ├── CryPerceptionSystem.waf_files
        │   │       ├── CryPerceptionSystemPluginDLL.cpp
        │   │       ├── PerceptionActor.cpp
        │   │       ├── PerceptionActor.h
        │   │       ├── PerceptionFlowNodes.cpp
        │   │       ├── PerceptionFlowNodes.h
        │   │       ├── PerceptionManager.cpp
        │   │       ├── PerceptionManager.h
        │   │       ├── resource.h
        │   │       ├── ScriptBind_PerceptionManager.cpp
        │   │       ├── ScriptBind_PerceptionManager.h
        │   │       ├── StdAfx.cpp
        │   │       ├── StdAfx.h
        │   │       └── wscript
        │   ├── CrySensorSystem/
        │   │   ├── wscript
        │   │   ├── Interface/
        │   │   │   ├── ICrySensorSystemPlugin.h
        │   │   │   ├── ISensorMap.h
        │   │   │   ├── ISensorSystem.h
        │   │   │   ├── ISensorTagLibrary.h
        │   │   │   └── SensorBounds.h
        │   │   └── Module/
        │   │       ├── CMakeLists.txt
        │   │       ├── crysensorsystem.waf_files
        │   │       ├── CrySensorSystemPluginDLL.cpp
        │   │       ├── CrySensorSystemPluginDLL.h
        │   │       ├── OctreePlotter.h
        │   │       ├── OctreePlotter.inl
        │   │       ├── resource.h
        │   │       ├── SchematycEntitySensorVolumeComponent.cpp
        │   │       ├── SchematycEntitySensorVolumeComponent.h
        │   │       ├── SensorMap.cpp
        │   │       ├── SensorMap.h
        │   │       ├── SensorSystem.cpp
        │   │       ├── SensorSystem.h
        │   │       ├── SensorTagLibrary.cpp
        │   │       ├── SensorTagLibrary.h
        │   │       ├── StdAfx.cpp
        │   │       ├── StdAfx.h
        │   │       └── wscript
        │   ├── CryUQS/
        │   │   ├── CMakeLists.txt
        │   │   ├── wscript
        │   │   ├── Client/
        │   │   │   ├── ClientIncludes.h
        │   │   │   ├── CMakeLists.txt
        │   │   │   ├── uqs_client.waf_files
        │   │   │   ├── wscript
        │   │   │   └── client/
        │   │   │       ├── ContainedTypeRetriever.h
        │   │   │       ├── DeferredEvaluatorBase.h
        │   │   │       ├── DeferredEvaluatorFactory.h
        │   │   │       ├── FactoryRegistrationHelper.h
        │   │   │       ├── Func_GlobalParam.h
        │   │   │       ├── Func_IteratedItem.h
        │   │   │       ├── Func_Literal.h
        │   │   │       ├── Func_ShuttledItems.h
        │   │   │       ├── FunctionBase.h
        │   │   │       ├── FunctionFactory.h
        │   │   │       ├── Gen_PropagateShuttledItems.h
        │   │   │       ├── GeneratorBase.h
        │   │   │       ├── GeneratorFactory.h
        │   │   │       ├── InputParameterRegistry.h
        │   │   │       ├── InstantEvaluatorBase.h
        │   │   │       ├── InstantEvaluatorFactory.h
        │   │   │       ├── ItemConverter.h
        │   │   │       ├── ItemFactory.h
        │   │   │       ├── ItemListProxy.h
        │   │   │       ├── ParamsHolder.h
        │   │   │       ├── QueryHost.h
        │   │   │       └── TypeWrapper.h
        │   │   ├── Core/
        │   │   │   ├── CMakeLists.txt
        │   │   │   ├── resource.h
        │   │   │   ├── uqs_core.waf_files
        │   │   │   ├── wscript
        │   │   │   └── core/
        │   │   │       ├── BlueprintWithInputs.cpp
        │   │   │       ├── BlueprintWithInputs.h
        │   │   │       ├── Cvars.cpp
        │   │   │       ├── Cvars.h
        │   │   │       ├── DebugMessageCollection.cpp
        │   │   │       ├── DebugMessageCollection.h
        │   │   │       ├── DebugRenderPrimitives.cpp
        │   │   │       ├── DebugRenderPrimitives.h
        │   │   │       ├── DebugRenderWorld.cpp
        │   │   │       ├── DebugRenderWorld.h
        │   │   │       ├── DeferredEvaluatorBlueprint.cpp
        │   │   │       ├── DeferredEvaluatorBlueprint.h
        │   │   │       ├── DeferredEvaluatorFactoryDatabase.h
        │   │   │       ├── DrawUtil2d.cpp
        │   │   │       ├── DrawUtil2d.h
        │   │   │       ├── EditorService.cpp
        │   │   │       ├── EditorService.h
        │   │   │       ├── EvaluationResultTransform.cpp
        │   │   │       ├── EvaluationResultTransform.h
        │   │   │       ├── EvaluatorBlueprintBase.cpp
        │   │   │       ├── EvaluatorBlueprintBase.h
        │   │   │       ├── FactoryDatabase.h
        │   │   │       ├── FunctionBlueprint.cpp
        │   │   │       ├── FunctionBlueprint.h
        │   │   │       ├── FunctionCallHierarchy.cpp
        │   │   │       ├── FunctionCallHierarchy.h
        │   │   │       ├── FunctionFactoryDatabase.h
        │   │   │       ├── GeneratorBlueprint.cpp
        │   │   │       ├── GeneratorBlueprint.h
        │   │   │       ├── GeneratorFactoryDatabase.h
        │   │   │       ├── GeomUtil.cpp
        │   │   │       ├── GeomUtil.h
        │   │   │       ├── GlobalConstantParamsBlueprint.cpp
        │   │   │       ├── GlobalConstantParamsBlueprint.h
        │   │   │       ├── GlobalRuntimeParamsBlueprint.cpp
        │   │   │       ├── GlobalRuntimeParamsBlueprint.h
        │   │   │       ├── Hub.cpp
        │   │   │       ├── Hub.h
        │   │   │       ├── HubPlugin.cpp
        │   │   │       ├── InputBlueprint.cpp
        │   │   │       ├── InputBlueprint.h
        │   │   │       ├── InstantEvaluatorBlueprint.cpp
        │   │   │       ├── InstantEvaluatorBlueprint.h
        │   │   │       ├── InstantEvaluatorFactoryDatabase.h
        │   │   │       ├── ItemDebugProxies.cpp
        │   │   │       ├── ItemDebugProxies.h
        │   │   │       ├── ItemDebugProxyFactory.cpp
        │   │   │       ├── ItemDebugProxyFactory.h
        │   │   │       ├── ItemFactoryDatabase.h
        │   │   │       ├── ItemList.cpp
        │   │   │       ├── ItemList.h
        │   │   │       ├── ItemSerializationSupport.cpp
        │   │   │       ├── ItemSerializationSupport.h
        │   │   │       ├── LeafFunctionReturnValue.cpp
        │   │   │       ├── LeafFunctionReturnValue.h
        │   │   │       ├── Logger.cpp
        │   │   │       ├── Logger.h
        │   │   │       ├── Query_Chained.cpp
        │   │   │       ├── Query_Chained.h
        │   │   │       ├── Query_Fallbacks.cpp
        │   │   │       ├── Query_Fallbacks.h
        │   │   │       ├── Query_Regular.cpp
        │   │   │       ├── Query_Regular.h
        │   │   │       ├── Query_SequentialBase.cpp
        │   │   │       ├── Query_SequentialBase.h
        │   │   │       ├── QueryBase.cpp
        │   │   │       ├── QueryBase.h
        │   │   │       ├── QueryBlueprint.cpp
        │   │   │       ├── QueryBlueprint.h
        │   │   │       ├── QueryBlueprintLibrary.cpp
        │   │   │       ├── QueryBlueprintLibrary.h
        │   │   │       ├── QueryFactory.cpp
        │   │   │       ├── QueryFactory.h
        │   │   │       ├── QueryHistory.cpp
        │   │   │       ├── QueryHistory.h
        │   │   │       ├── QueryHistoryInGameGUI.cpp
        │   │   │       ├── QueryHistoryInGameGUI.h
        │   │   │       ├── QueryHistoryManager.cpp
        │   │   │       ├── QueryHistoryManager.h
        │   │   │       ├── QueryManager.cpp
        │   │   │       ├── QueryManager.h
        │   │   │       ├── QueryResultSet.cpp
        │   │   │       ├── QueryResultSet.h
        │   │   │       ├── SchematycSupport.cpp
        │   │   │       ├── SchematycSupport.h
        │   │   │       ├── ScoreTransformFactory.cpp
        │   │   │       ├── ScoreTransformFactory.h
        │   │   │       ├── Serialize.cpp
        │   │   │       ├── Serialize.h
        │   │   │       ├── SettingsManager.cpp
        │   │   │       ├── SettingsManager.h
        │   │   │       ├── StartupConsistencyChecker.cpp
        │   │   │       ├── StartupConsistencyChecker.h
        │   │   │       ├── StdAfx.cpp
        │   │   │       ├── StdAfx.h
        │   │   │       ├── TextualEvaluatorBlueprint.h
        │   │   │       ├── TimeBudget.cpp
        │   │   │       ├── TimeBudget.h
        │   │   │       ├── Utils.cpp
        │   │   │       └── Utils.h
        │   │   ├── DataSource_XML/
        │   │   │   ├── CMakeLists.txt
        │   │   │   ├── DataSource_XML_Includes.h
        │   │   │   ├── uqs_datasource_xml.waf_files
        │   │   │   ├── wscript
        │   │   │   └── datasource_xml/
        │   │   │       ├── QueryBlueprintFileLibrary.cpp
        │   │   │       ├── QueryBlueprintFileLibrary.h
        │   │   │       ├── QueryBlueprintLoader_XML.cpp
        │   │   │       ├── QueryBlueprintLoader_XML.h
        │   │   │       ├── QueryBlueprintSaver_XML.cpp
        │   │   │       ├── QueryBlueprintSaver_XML.h
        │   │   │       ├── StdAfx.cpp
        │   │   │       ├── StdAfx.h
        │   │   │       ├── SyntaxErrorCollector_XML.cpp
        │   │   │       ├── SyntaxErrorCollector_XML.h
        │   │   │       ├── XMLDatasource.cpp
        │   │   │       └── XMLDatasource.h
        │   │   ├── EditorPlugin/
        │   │   │   ├── CMakeLists.txt
        │   │   │   ├── DLLMain.cpp
        │   │   │   ├── editorplugin.waf_files
        │   │   │   ├── StdAfx.cpp
        │   │   │   ├── StdAfx.h
        │   │   │   ├── wscript
        │   │   │   └── Editor/
        │   │   │       ├── Blueprints.cpp
        │   │   │       ├── Blueprints.h
        │   │   │       ├── CentralEventManager.cpp
        │   │   │       ├── CentralEventManager.h
        │   │   │       ├── DocSerializationContext.cpp
        │   │   │       ├── DocSerializationContext.h
        │   │   │       ├── Document.cpp
        │   │   │       ├── Document.h
        │   │   │       ├── EditorContext.cpp
        │   │   │       ├── EditorContext.h
        │   │   │       ├── ItemTypeName.cpp
        │   │   │       ├── ItemTypeName.h
        │   │   │       ├── MainEditorWindow.cpp
        │   │   │       ├── MainEditorWindow.h
        │   │   │       ├── QueryListProvider.cpp
        │   │   │       ├── QueryListProvider.h
        │   │   │       ├── QuerySimulator.cpp
        │   │   │       ├── QuerySimulator.h
        │   │   │       ├── SerializationHelpers.cpp
        │   │   │       ├── SerializationHelpers.h
        │   │   │       ├── Settings.cpp
        │   │   │       └── Settings.h
        │   │   ├── EditorPlugin_HistoryInspector/
        │   │   │   ├── CMakeLists.txt
        │   │   │   ├── DLLMain.cpp
        │   │   │   ├── editorplugin_historyinspector.waf_files
        │   │   │   ├── StdAfx.cpp
        │   │   │   ├── StdAfx.h
        │   │   │   ├── wscript
        │   │   │   └── Editor/
        │   │   │       ├── MainEditorWindow.cpp
        │   │   │       └── MainEditorWindow.h
        │   │   ├── Interfaces/
        │   │   │   ├── CMakeLists.txt
        │   │   │   ├── InterfacesIncludes.h
        │   │   │   ├── Prerequisites.h
        │   │   │   ├── uqs_interfaces.waf_files
        │   │   │   ├── wscript
        │   │   │   ├── client/
        │   │   │   │   ├── IDeferredEvaluator.h
        │   │   │   │   ├── IDeferredEvaluatorFactory.h
        │   │   │   │   ├── IFunction.h
        │   │   │   │   ├── IFunctionFactory.h
        │   │   │   │   ├── IGenerator.h
        │   │   │   │   ├── IGeneratorFactory.h
        │   │   │   │   ├── IInputParameterRegistry.h
        │   │   │   │   ├── IInstantEvaluator.h
        │   │   │   │   ├── IInstantEvaluatorFactory.h
        │   │   │   │   ├── IItemConverter.h
        │   │   │   │   ├── IItemFactory.h
        │   │   │   │   ├── IItemMonitor.h
        │   │   │   │   ├── IParamsHolder.h
        │   │   │   │   ├── IQueryBlueprintRuntimeParamVisitor.h
        │   │   │   │   ├── IQueryFinishedListener.h
        │   │   │   │   ├── IQueryVisitor.h
        │   │   │   │   ├── IQueryWarningListener.h
        │   │   │   │   └── QueryRequest.h
        │   │   │   ├── core/
        │   │   │   │   ├── IDebugMessageCollection.h
        │   │   │   │   ├── IDebugRenderWorld.h
        │   │   │   │   ├── IDeferredEvaluatorFactoryDatabase.h
        │   │   │   │   ├── IEditorService.h
        │   │   │   │   ├── IFactoryDatabase.h
        │   │   │   │   ├── IFunctionFactoryDatabase.h
        │   │   │   │   ├── IGeneratorBlueprint.h
        │   │   │   │   ├── IGeneratorFactoryDatabase.h
        │   │   │   │   ├── IGlobalConstantParamsBlueprint.h
        │   │   │   │   ├── IGlobalRuntimeParamsBlueprint.h
        │   │   │   │   ├── IHub.h
        │   │   │   │   ├── IHubPlugin.h
        │   │   │   │   ├── IInputBlueprint.h
        │   │   │   │   ├── IInstantEvaluatorFactoryDatabase.h
        │   │   │   │   ├── IItemDebugProxies.h
        │   │   │   │   ├── IItemDebugProxyFactory.h
        │   │   │   │   ├── IItemFactoryDatabase.h
        │   │   │   │   ├── IItemList.h
        │   │   │   │   ├── IItemSerializationSupport.h
        │   │   │   │   ├── ILeafFunctionReturnValue.h
        │   │   │   │   ├── IQueryBlueprint.h
        │   │   │   │   ├── IQueryBlueprintLibrary.h
        │   │   │   │   ├── IQueryFactory.h
        │   │   │   │   ├── IQueryHistoryConsumer.h
        │   │   │   │   ├── IQueryHistoryListener.h
        │   │   │   │   ├── IQueryHistoryManager.h
        │   │   │   │   ├── IQueryManager.h
        │   │   │   │   ├── IQueryResultSet.h
        │   │   │   │   ├── IScoreTransformFactory.h
        │   │   │   │   ├── ISettingsManager.h
        │   │   │   │   ├── ItemEvaluationResult.h
        │   │   │   │   ├── ItemIterationContext.h
        │   │   │   │   ├── ITextualEvaluatorBlueprint.h
        │   │   │   │   ├── ITimeBudget.h
        │   │   │   │   ├── IUtils.h
        │   │   │   │   ├── QueryBlueprintID.h
        │   │   │   │   ├── QueryContext.h
        │   │   │   │   ├── QueryID.h
        │   │   │   │   └── QueryResult.h
        │   │   │   ├── datasource/
        │   │   │   │   ├── IEditorLibraryProvider.h
        │   │   │   │   ├── IQueryBlueprintLoader.h
        │   │   │   │   ├── IQueryBlueprintSaver.h
        │   │   │   │   └── ISyntaxErrorCollector.h
        │   │   │   ├── editor/
        │   │   │   │   └── IEditorServiceConsumer.h
        │   │   │   └── shared/
        │   │   │       ├── DataTypeHelper.h
        │   │   │       ├── GUIDHelper.h
        │   │   │       ├── IUqsString.h
        │   │   │       ├── IVariantDict.h
        │   │   │       └── TypeInfo.h
        │   │   ├── Shared/
        │   │   │   ├── CMakeLists.txt
        │   │   │   ├── SharedIncludes.h
        │   │   │   ├── uqs_shared.waf_files
        │   │   │   ├── wscript
        │   │   │   └── shared/
        │   │   │       ├── FactoryBase.h
        │   │   │       ├── UqsString.h
        │   │   │       └── VariantDict.h
        │   │   └── StdLib/
        │   │       ├── CMakeLists.txt
        │   │       ├── StdLibRegistration.cpp
        │   │       ├── StdLibRegistration.h
        │   │       ├── uqs_stdlib.waf_files
        │   │       ├── wscript
        │   │       └── stdlib/
        │   │           ├── DeferredEvaluators.cpp
        │   │           ├── DeferredEvaluators.h
        │   │           ├── Functions.cpp
        │   │           ├── Functions.h
        │   │           ├── Generators.cpp
        │   │           ├── Generators.h
        │   │           ├── InstantEvaluators.cpp
        │   │           ├── InstantEvaluators.h
        │   │           ├── ItemDebugProxies.cpp
        │   │           ├── ItemDebugProxies.h
        │   │           ├── ItemDebugRendering.cpp
        │   │           ├── ItemDebugRendering.h
        │   │           ├── ItemMonitors.cpp
        │   │           ├── ItemMonitors.h
        │   │           ├── Items.cpp
        │   │           ├── StdAfx.cpp
        │   │           └── StdAfx.h
        │   └── VR/
        │       ├── wscript
        │       ├── CryEmulatorVR/
        │       │   └── Module/
        │       │       ├── CMakeLists.txt
        │       │       ├── HMDDeviceEmulator.cpp
        │       │       ├── HMDDeviceEmulator.h
        │       │       ├── PluginDll.cpp
        │       │       ├── PluginDll.h
        │       │       ├── resource.h
        │       │       ├── StdAfx.cpp
        │       │       └── StdAfx.h
        │       ├── CryOculusVR/
        │       │   ├── wscript
        │       │   ├── Interface/
        │       │   │   ├── IHmdOculusRiftDevice.h
        │       │   │   └── IOculusVRPlugin.h
        │       │   └── Module/
        │       │       ├── CMakeLists.txt
        │       │       ├── cryoculusvr.waf_files
        │       │       ├── OculusDevice.cpp
        │       │       ├── OculusDevice.h
        │       │       ├── OculusResources.cpp
        │       │       ├── OculusResources.h
        │       │       ├── OculusTouchController.cpp
        │       │       ├── OculusTouchController.h
        │       │       ├── PluginDll.cpp
        │       │       ├── PluginDll.h
        │       │       ├── resource.h
        │       │       ├── StdAfx.cpp
        │       │       ├── StdAfx.h
        │       │       └── wscript
        │       ├── CryOpenVR/
        │       │   ├── wscript
        │       │   ├── Interface/
        │       │   │   ├── IHmdOpenVRDevice.h
        │       │   │   └── IOpenVRPlugin.h
        │       │   └── Module/
        │       │       ├── CMakeLists.txt
        │       │       ├── cryopenvr.waf_files
        │       │       ├── OpenVRController.cpp
        │       │       ├── OpenVRController.h
        │       │       ├── OpenVRDevice.cpp
        │       │       ├── OpenVRDevice.h
        │       │       ├── OpenVRResources.cpp
        │       │       ├── OpenVRResources.h
        │       │       ├── PluginDll.cpp
        │       │       ├── PluginDll.h
        │       │       ├── resource.h
        │       │       ├── StdAfx.cpp
        │       │       ├── StdAfx.h
        │       │       └── wscript
        │       └── CryOSVR/
        │           ├── wscript
        │           ├── Interface/
        │           │   ├── IHmdOSVRDevice.h
        │           │   └── IOSVRPlugin.h
        │           └── Module/
        │               ├── CMakeLists.txt
        │               ├── cryosvr.waf_files
        │               ├── OsvrDevice.cpp
        │               ├── OsvrDevice.h
        │               ├── OsvrResources.cpp
        │               ├── OsvrResources.h
        │               ├── PluginDll.cpp
        │               ├── PluginDll.h
        │               ├── resource.h
        │               ├── StdAfx.cpp
        │               ├── StdAfx.h
        │               └── wscript
        ├── GameSDK/
        │   ├── CMakeLists.txt
        │   ├── wscript
        │   └── GameDll/
        │       ├── Accessory.cpp
        │       ├── Accessory.h
        │       ├── ActionCoopAnim.cpp
        │       ├── ActionCoopAnim.h
        │       ├── ActionMultiCoopAnim.cpp
        │       ├── ActionMultiCoopAnim.h
        │       ├── Actor.cpp
        │       ├── Actor.h
        │       ├── ActorDamageEffectController.cpp
        │       ├── ActorDamageEffectController.h
        │       ├── ActorDefinitions.h
        │       ├── ActorImpulseHandler.cpp
        │       ├── ActorImpulseHandler.h
        │       ├── ActorLuaCache.cpp
        │       ├── ActorLuaCache.h
        │       ├── ActorManager.cpp
        │       ├── ActorManager.h
        │       ├── ActorTelemetry.cpp
        │       ├── ActorTelemetry.h
        │       ├── AdaptiveCompressor.cpp
        │       ├── AdaptiveCompressor.h
        │       ├── AfterMatchAwards.cpp
        │       ├── AfterMatchAwards.h
        │       ├── AIDemoInput.cpp
        │       ├── AIDemoInput.h
        │       ├── AIGrenade.cpp
        │       ├── AIGrenade.h
        │       ├── AmmoParams.cpp
        │       ├── AmmoParams.h
        │       ├── AnimActionAIAiming.cpp
        │       ├── AnimActionAIAiming.h
        │       ├── AnimActionAIAimPose.cpp
        │       ├── AnimActionAIAimPose.h
        │       ├── AnimActionAICoverAction.cpp
        │       ├── AnimActionAICoverAction.h
        │       ├── AnimActionAIDetail.cpp
        │       ├── AnimActionAIDetail.h
        │       ├── AnimActionAILooking.cpp
        │       ├── AnimActionAILooking.h
        │       ├── AnimActionAILookPose.cpp
        │       ├── AnimActionAILookPose.h
        │       ├── AnimActionAIMovement.cpp
        │       ├── AnimActionAIMovement.h
        │       ├── AnimActionAIStance.cpp
        │       ├── AnimActionAIStance.h
        │       ├── AnimActionBlendFromRagdoll.cpp
        │       ├── AnimActionBlendFromRagdoll.h
        │       ├── AnimEventPlayer.cpp
        │       ├── AnimEventPlayer.h
        │       ├── AutoAimManager.cpp
        │       ├── AutoAimManager.h
        │       ├── AutoEnum.cpp
        │       ├── AutoEnum.h
        │       ├── Automatic.cpp
        │       ├── Automatic.h
        │       ├── AutomaticShotgun.cpp
        │       ├── AutomaticShotgun.h
        │       ├── Battlechatter.cpp
        │       ├── Battlechatter.h
        │       ├── Binocular.cpp
        │       ├── Binocular.h
        │       ├── BlendedEffect.cpp
        │       ├── BlendedEffect.h
        │       ├── BlendNode.cpp
        │       ├── BlendNode.h
        │       ├── BlendTypes.h
        │       ├── BodyDamage.cpp
        │       ├── BodyDamage.h
        │       ├── BodyDefinitions.cpp
        │       ├── BodyDefinitions.h
        │       ├── BodyDestruction.cpp
        │       ├── BodyDestruction.h
        │       ├── BodyManager.cpp
        │       ├── BodyManager.h
        │       ├── BodyManagerCVars.cpp
        │       ├── BodyManagerCVars.h
        │       ├── Bullet.cpp
        │       ├── Bullet.h
        │       ├── Burst.cpp
        │       ├── Burst.h
        │       ├── C4.cpp
        │       ├── C4.h
        │       ├── C4Projectile.cpp
        │       ├── C4Projectile.h
        │       ├── CameraModes.cpp
        │       ├── CameraModes.h
        │       ├── Chaff.cpp
        │       ├── Chaff.h
        │       ├── Charge.cpp
        │       ├── Charge.h
        │       ├── CheckpointGame.cpp
        │       ├── CheckpointGame.h
        │       ├── CinematicInput.cpp
        │       ├── CinematicInput.h
        │       ├── CinematicWeapon.cpp
        │       ├── CinematicWeapon.h
        │       ├── CircularStatsStorage.cpp
        │       ├── CircularStatsStorage.h
        │       ├── ClientHitEffectsMP.cpp
        │       ├── ClientHitEffectsMP.h
        │       ├── CMakeLists.txt
        │       ├── CodeCheckpointDebugMgr.cpp
        │       ├── CodeCheckpointDebugMgr.h
        │       ├── CornerSmoother.cpp
        │       ├── CornerSmoother.h
        │       ├── CorpseManager.cpp
        │       ├── CorpseManager.h
        │       ├── CryMacros.h
        │       ├── CustomReactionFunctions.cpp
        │       ├── CustomReactionFunctions.h
        │       ├── CVarOverrides.h
        │       ├── CVarWhitelist.h
        │       ├── DataPatchDownloader.cpp
        │       ├── DataPatchDownloader.h
        │       ├── DebugGun.cpp
        │       ├── DebugGun.h
        │       ├── Detonate.cpp
        │       ├── Detonate.h
        │       ├── DLCManager.cpp
        │       ├── DLCManager.h
        │       ├── DoubleMagazine.cpp
        │       ├── DoubleMagazine.h
        │       ├── DownloadMgr.cpp
        │       ├── DownloadMgr.h
        │       ├── DualCharacterProxy.cpp
        │       ├── DualCharacterProxy.h
        │       ├── DummyPlayer.cpp
        │       ├── DummyPlayer.h
        │       ├── EditorGame.cpp
        │       ├── EditorGame.h
        │       ├── EMPGrenade.cpp
        │       ├── EMPGrenade.h
        │       ├── EnvironmentalWeapon.cpp
        │       ├── EnvironmentalWeapon.h
        │       ├── EquipmentLoadout.cpp
        │       ├── EquipmentLoadout.h
        │       ├── EquipmentSystemInterface.cpp
        │       ├── EquipmentSystemInterface.h
        │       ├── EventDistributor.h
        │       ├── ExactPositioning.cpp
        │       ├── ExactPositioning.h
        │       ├── ExactPositioningTrigger.cpp
        │       ├── ExactPositioningTrigger.h
        │       ├── FireMode.cpp
        │       ├── FireMode.h
        │       ├── FireModeParams.cpp
        │       ├── FireModeParams.h
        │       ├── FireModePlugin.cpp
        │       ├── FireModePlugin.h
        │       ├── FireModePluginParams.cpp
        │       ├── FireModePluginParams.h
        │       ├── flashlight.cpp
        │       ├── flashlight.h
        │       ├── FlowItemAnimation.cpp
        │       ├── FlowItemAnimation.h
        │       ├── FlowVehicleNodes.cpp
        │       ├── FlowWeaponCustomizationNodes.cpp
        │       ├── FlowWeaponCustomizationNodes.h
        │       ├── FragmentVariationHelper.cpp
        │       ├── FragmentVariationHelper.h
        │       ├── Game.cpp
        │       ├── Game.h
        │       ├── GameActions.actions
        │       ├── GameActions.cpp
        │       ├── GameActions.h
        │       ├── GameCache.cpp
        │       ├── GameCache.h
        │       ├── GameConstantCVars.cpp
        │       ├── GameConstantCVars.h
        │       ├── GameCVars.h
        │       ├── GameDll.cpp
        │       ├── GameDll.rc
        │       ├── gamedllsdk.waf_files
        │       ├── gamedllsdk_durango.waf_files
        │       ├── GameFactory.cpp
        │       ├── GameFactory.h
        │       ├── GameInputActionHandlers.h
        │       ├── GameJobSystem.cpp
        │       ├── GameLocalizationManager.cpp
        │       ├── GameLocalizationManager.h
        │       ├── GameParameters.cpp
        │       ├── GameParameters.h
        │       ├── GamePhysicsSettings.cpp
        │       ├── GamePhysicsSettings.h
        │       ├── GameRules.h
        │       ├── GameRules_Test.cpp
        │       ├── GameRulesClientServer.cpp
        │       ├── GameRulesTypes.h
        │       ├── GameStartup.cpp
        │       ├── GameStartup.h
        │       ├── GameStateRecorder.cpp
        │       ├── GameStateRecorder.h
        │       ├── GameTypeInfo.cpp
        │       ├── GameTypeInfo.h
        │       ├── GodMode.cpp
        │       ├── GodMode.h
        │       ├── Grenade.cpp
        │       ├── Grenade.h
        │       ├── GunTurret.cpp
        │       ├── GunTurret.h
        │       ├── HackBullet.cpp
        │       ├── HackBullet.h
        │       ├── HandGrenades.cpp
        │       ├── HandGrenades.h
        │       ├── Health.h
        │       ├── HeavyMountedWeapon.cpp
        │       ├── HeavyMountedWeapon.h
        │       ├── HeavyWeapon.cpp
        │       ├── HeavyWeapon.h
        │       ├── HitDeathReactions.cpp
        │       ├── HitDeathReactions.h
        │       ├── HitDeathReactionsDefs.cpp
        │       ├── HitDeathReactionsDefs.h
        │       ├── HitDeathReactionsSystem.cpp
        │       ├── HitDeathReactionsSystem.h
        │       ├── HomingMissile.cpp
        │       ├── HomingMissile.h
        │       ├── HommingSwarmProjectile.cpp
        │       ├── HommingSwarmProjectile.h
        │       ├── HUD_Impl.h
        │       ├── ICameraMode.cpp
        │       ├── ICameraMode.h
        │       ├── IKTorsoAim_Helper.cpp
        │       ├── IKTorsoAim_Helper.h
        │       ├── InteractiveActionController.cpp
        │       ├── InteractiveActionController.h
        │       ├── IntersectionAssistanceUnit.cpp
        │       ├── IntersectionAssistanceUnit.h
        │       ├── IPatchPakManagerListener.h
        │       ├── IPlayerEventListener.h
        │       ├── IPlayerInput.h
        │       ├── IPlayerUpdateListener.h
        │       ├── IronSight.cpp
        │       ├── IronSight.h
        │       ├── ITelemetryCollector.h
        │       ├── Item.cpp
        │       ├── Item.h
        │       ├── ItemAccessory.cpp
        │       ├── ItemAnimation.cpp
        │       ├── ItemAnimation.h
        │       ├── ItemClientServer.cpp
        │       ├── ItemDefinitions.h
        │       ├── ItemEffect.cpp
        │       ├── ItemEvents.cpp
        │       ├── ItemPackages.cpp
        │       ├── ItemPackages.h
        │       ├── ItemParams.cpp
        │       ├── ItemParamsRegistration.h
        │       ├── ItemParamsRegistrationOperators.h
        │       ├── ItemResource.cpp
        │       ├── ItemResourceCache.cpp
        │       ├── ItemResourceCache.h
        │       ├── ItemScheduler.cpp
        │       ├── ItemScheduler.h
        │       ├── ItemSharedParams.cpp
        │       ├── ItemSharedParams.h
        │       ├── ItemString.h
        │       ├── ItemView.cpp
        │       ├── ITransformationPinning.h
        │       ├── JAW.cpp
        │       ├── JAW.h
        │       ├── KVoltBullet.cpp
        │       ├── KVoltBullet.h
        │       ├── LagOMeter.cpp
        │       ├── LagOMeter.h
        │       ├── LargeObjectInteraction.cpp
        │       ├── LargeObjectInteraction.h
        │       ├── Laser.cpp
        │       ├── Laser.h
        │       ├── LightningBolt.cpp
        │       ├── LightningBolt.h
        │       ├── LocalPlayerComponent.cpp
        │       ├── LocalPlayerComponent.h
        │       ├── LookAim_Helper.cpp
        │       ├── LookAim_Helper.h
        │       ├── LTAG.cpp
        │       ├── LTAG.h
        │       ├── LTAGGrenade.cpp
        │       ├── LTAGGrenade.h
        │       ├── LTagSingle.cpp
        │       ├── LTagSingle.h
        │       ├── Melee.cpp
        │       ├── Melee.h
        │       ├── MeleeCollisionHelper.cpp
        │       ├── MeleeCollisionHelper.h
        │       ├── MikeBullet.cpp
        │       ├── MikeBullet.h
        │       ├── MountedGunController.cpp
        │       ├── MountedGunController.h
        │       ├── MovementAction.cpp
        │       ├── MovementAction.h
        │       ├── MovementTransitions.cpp
        │       ├── MovementTransitions.h
        │       ├── MovementTransitionsController.cpp
        │       ├── MovementTransitionsController.h
        │       ├── MovementTransitionsSystem.cpp
        │       ├── MovementTransitionsSystem.h
        │       ├── MovementTransitionsUtil.h
        │       ├── MPPath.cpp
        │       ├── MPPath.h
        │       ├── MPPathFollowingManager.cpp
        │       ├── MPPathFollowingManager.h
        │       ├── MPTrackViewManager.cpp
        │       ├── MPTrackViewManager.h
        │       ├── MuzzleEffect.cpp
        │       ├── MuzzleEffect.h
        │       ├── NetInputChainDebug.cpp
        │       ├── NetInputChainDebug.h
        │       ├── NetPlayerInput.cpp
        │       ├── NetPlayerInput.h
        │       ├── NoWeapon.cpp
        │       ├── NoWeapon.h
        │       ├── PatchPakManager.cpp
        │       ├── PatchPakManager.h
        │       ├── PersistantStats.cpp
        │       ├── PersistantStats.h
        │       ├── PickAndThrowProxy.cpp
        │       ├── PickAndThrowProxy.h
        │       ├── PickAndThrowUtilities.cpp
        │       ├── PickAndThrowUtilities.h
        │       ├── PickAndThrowWeapon.cpp
        │       ├── PickAndThrowWeapon.h
        │       ├── Plant.cpp
        │       ├── Plant.h
        │       ├── Player.h
        │       ├── PlayerAI.cpp
        │       ├── PlayerAI.h
        │       ├── PlayerAnimation.cpp
        │       ├── PlayerAnimation.h
        │       ├── PlayerCamera.cpp
        │       ├── PlayerCamera.h
        │       ├── PlayerEntityInteraction.cpp
        │       ├── PlayerEntityInteraction.h
        │       ├── PlayerInput.cpp
        │       ├── PlayerInput.h
        │       ├── PlayerModifiableValues.cpp
        │       ├── PlayerModifiableValues.h
        │       ├── PlayerMovementController.cpp
        │       ├── PlayerMovementController.h
        │       ├── PlayerMovementDebug.cpp
        │       ├── PlayerMovementDebug.h
        │       ├── PlayerPlugin.cpp
        │       ├── PlayerPlugin.h
        │       ├── PlayerPlugin_CurrentlyTargetting.cpp
        │       ├── PlayerPlugin_CurrentlyTargetting.h
        │       ├── PlayerPlugin_Interaction.cpp
        │       ├── PlayerPlugin_Interaction.h
        │       ├── PlayerPlugin_InteractiveEntityMonitor.cpp
        │       ├── PlayerPlugin_InteractiveEntityMonitor.h
        │       ├── PlayerPluginEventDistributor.h
        │       ├── PlayerProgression.cpp
        │       ├── PlayerProgression.h
        │       ├── PlayerProgressionTypes.h
        │       ├── PlayerRotation.cpp
        │       ├── PlayerRotation.h
        │       ├── PlayerStateAIMovement.cpp
        │       ├── PlayerStateAnimationControlled.cpp
        │       ├── PlayerStateDead.cpp
        │       ├── PlayerStateDead.h
        │       ├── PlayerStateEntry.cpp
        │       ├── PlayerStateEvents.cpp
        │       ├── PlayerStateEvents.h
        │       ├── PlayerStateFly.cpp
        │       ├── PlayerStateFly.h
        │       ├── PlayerStateGround.cpp
        │       ├── PlayerStateGround.h
        │       ├── PlayerStateJump.cpp
        │       ├── PlayerStateJump.h
        │       ├── PlayerStateLadder.cpp
        │       ├── PlayerStateLadder.h
        │       ├── PlayerStateLedge.cpp
        │       ├── PlayerStateLedge.h
        │       ├── PlayerStateLinked.cpp
        │       ├── PlayerStateMovement.cpp
        │       ├── PlayerStateSwim.cpp
        │       ├── PlayerStateSwim.h
        │       ├── PlayerStateSwim_WaterTestProxy.cpp
        │       ├── PlayerStateSwim_WaterTestProxy.h
        │       ├── PlayerStateUtil.cpp
        │       ├── PlayerStateUtil.h
        │       ├── PlayerStumble.cpp
        │       ├── PlayerStumble.h
        │       ├── PlayerVisTable.cpp
        │       ├── PlayerVisTable.h
        │       ├── PlaylistManager.cpp
        │       ├── PlaylistManager.h
        │       ├── PrefabManager.cpp
        │       ├── PrefabManager.h
        │       ├── ProceduralClipAiming.cpp
        │       ├── ProceduralClipAimSmoothing.cpp
        │       ├── ProceduralClipColliderMode.cpp
        │       ├── ProceduralClipCompromiseCover.cpp
        │       ├── ProceduralClipCopyNormalizedTime.cpp
        │       ├── ProceduralClipFacialSequence.cpp
        │       ├── ProceduralClipLooking.cpp
        │       ├── ProceduralClipMovementControlMethod.cpp
        │       ├── ProceduralClipRagdoll.cpp
        │       ├── ProceduralClipSetStance.cpp
        │       ├── ProceduralContextAim.cpp
        │       ├── ProceduralContextAim.h
        │       ├── ProceduralContextColliderMode.cpp
        │       ├── ProceduralContextColliderMode.h
        │       ├── ProceduralContextHelpers.h
        │       ├── ProceduralContextLook.cpp
        │       ├── ProceduralContextLook.h
        │       ├── ProceduralContextMovementControlMethod.cpp
        │       ├── ProceduralContextMovementControlMethod.h
        │       ├── ProceduralContextRagdoll.cpp
        │       ├── ProceduralContextRagdoll.h
        │       ├── ProceduralWeaponAnimation.cpp
        │       ├── ProceduralWeaponAnimation.h
        │       ├── ProceduralWeaponClip.cpp
        │       ├── ProceduralWeaponContext.cpp
        │       ├── ProceduralWeaponContext.h
        │       ├── ProgressBar.cpp
        │       ├── ProgressBar.h
        │       ├── ProgressBar3D.cpp
        │       ├── ProgressBar3D.h
        │       ├── ProgressionUnlocks.cpp
        │       ├── ProgressionUnlocks.h
        │       ├── Projectile.cpp
        │       ├── Projectile.h
        │       ├── ProjectileAutoAimHelper.cpp
        │       ├── ProjectileAutoAimHelper.h
        │       ├── QuatTBlender.cpp
        │       ├── QuatTBlender.h
        │       ├── Radio.cpp
        │       ├── Radio.h
        │       ├── RandomDeck.cpp
        │       ├── RandomDeck.h
        │       ├── Rapid.cpp
        │       ├── Rapid.h
        │       ├── Recoil.cpp
        │       ├── Recoil.h
        │       ├── RecordingBuffer.cpp
        │       ├── RecordingBuffer.h
        │       ├── RecordingSystem.h
        │       ├── RecordingSystemCircularBuffer.h
        │       ├── RecordingSystemClientSender.cpp
        │       ├── RecordingSystemClientSender.h
        │       ├── RecordingSystemCompressor.cpp
        │       ├── RecordingSystemCompressor.h
        │       ├── RecordingSystemDebug.cpp
        │       ├── RecordingSystemDebug.h
        │       ├── RecordingSystemDefines.h
        │       ├── RecordingSystemPackets.cpp
        │       ├── RecordingSystemPackets.h
        │       ├── RecordingSystemServerForwarder.cpp
        │       ├── RecordingSystemServerForwarder.h
        │       ├── RecordingSystemStreamer.cpp
        │       ├── ReplayActor.cpp
        │       ├── ReplayActor.h
        │       ├── ReplayObject.cpp
        │       ├── ReplayObject.h
        │       ├── RevertibleConfigLoader.cpp
        │       ├── RevertibleConfigLoader.h
        │       ├── RichPresence.cpp
        │       ├── RichPresence.h
        │       ├── Rocket.cpp
        │       ├── Rocket.h
        │       ├── RuntimePrefab.cpp
        │       ├── RuntimePrefab.h
        │       ├── Scope.cpp
        │       ├── Scope.h
        │       ├── ScopeReticule.cpp
        │       ├── ScopeReticule.h
        │       ├── ScreenEffects.cpp
        │       ├── ScreenEffects.h
        │       ├── ScreenEffects_Game.cpp
        │       ├── ScreenResolution.cpp
        │       ├── ScreenResolution.h
        │       ├── ScriptBind_Actor.cpp
        │       ├── ScriptBind_Actor.h
        │       ├── ScriptBind_Game.cpp
        │       ├── ScriptBind_Game.h
        │       ├── ScriptBind_GameRules.cpp
        │       ├── ScriptBind_GameRules.h
        │       ├── ScriptBind_HitDeathReactions.cpp
        │       ├── ScriptBind_HitDeathReactions.h
        │       ├── ScriptBind_Item.cpp
        │       ├── ScriptBind_Item.h
        │       ├── ScriptBind_ProtectedBinds.cpp
        │       ├── ScriptBind_ProtectedBinds.h
        │       ├── ScriptBind_Weapon.cpp
        │       ├── ScriptBind_Weapon.h
        │       ├── ScriptControlledPhysics.cpp
        │       ├── ScriptControlledPhysics.h
        │       ├── ShotDebug.cpp
        │       ├── ShotDebug.h
        │       ├── Shotgun.cpp
        │       ├── Shotgun.h
        │       ├── Single.cpp
        │       ├── Single.h
        │       ├── SkillKill.cpp
        │       ├── SkillKill.h
        │       ├── SkillRanking.cpp
        │       ├── SkillRanking.h
        │       ├── SlideController.cpp
        │       ├── SlideController.h
        │       ├── SmokeManager.cpp
        │       ├── SmokeManager.h
        │       ├── Spammer.cpp
        │       ├── Spammer.h
        │       ├── SpectacularKill.cpp
        │       ├── SpectacularKill.h
        │       ├── SprintStamina.cpp
        │       ├── SprintStamina.h
        │       ├── SShootHelper.cpp
        │       ├── SShootHelper.h
        │       ├── State.h
        │       ├── StatHelpers.cpp
        │       ├── StatHelpers.h
        │       ├── StatsEntityIdRegistry.cpp
        │       ├── StatsEntityIdRegistry.h
        │       ├── StatsRecordingMgr.cpp
        │       ├── StatsRecordingMgr.h
        │       ├── StatsStructures.cpp
        │       ├── StatsStructures.h
        │       ├── StdAfx.cpp
        │       ├── StdAfx.h
        │       ├── StealthKill.cpp
        │       ├── StealthKill.h
        │       ├── StickyProjectile.cpp
        │       ├── StickyProjectile.h
        │       ├── SubtitleManager.cpp
        │       ├── SubtitleManager.h
        │       ├── TacticalManager.cpp
        │       ├── TacticalManager.h
        │       ├── TeamVisualizationManager.cpp
        │       ├── TeamVisualizationManager.h
        │       ├── TelemetryCollector.cpp
        │       ├── TelemetryCollector.h
        │       ├── Throw.cpp
        │       ├── Throw.h
        │       ├── ThrowIndicator.cpp
        │       ├── ThrowIndicator.h
        │       ├── TracerManager.cpp
        │       ├── TracerManager.h
        │       ├── TransformationPinning.cpp
        │       ├── TransformationPinning.h
        │       ├── UseableTurret.cpp
        │       ├── UseableTurret.h
        │       ├── VehicleActionAutomaticDoor.cpp
        │       ├── VehicleActionAutomaticDoor.h
        │       ├── VehicleActionAutoTarget.cpp
        │       ├── VehicleActionAutoTarget.h
        │       ├── VehicleActionDeployRope.cpp
        │       ├── VehicleActionDeployRope.h
        │       ├── VehicleActionEntityAttachment.cpp
        │       ├── VehicleActionEntityAttachment.h
        │       ├── VehicleActionLandingGears.cpp
        │       ├── VehicleActionLandingGears.h
        │       ├── VehicleClient.cpp
        │       ├── VehicleClient.h
        │       ├── VehicleDamageBehaviorAudioFeedback.cpp
        │       ├── VehicleDamageBehaviorAudioFeedback.h
        │       ├── VehicleDamageBehaviorBurn.cpp
        │       ├── VehicleDamageBehaviorBurn.h
        │       ├── VehicleDamageBehaviorCameraShake.cpp
        │       ├── VehicleDamageBehaviorCameraShake.h
        │       ├── VehicleDamageBehaviorExplosion.cpp
        │       ├── VehicleDamageBehaviorExplosion.h
        │       ├── VehicleDamageBehaviorTire.cpp
        │       ├── VehicleDamageBehaviorTire.h
        │       ├── VehicleMountedWeapon.cpp
        │       ├── VehicleMountedWeapon.h
        │       ├── VehicleMovementArcadeWheeled.cpp
        │       ├── VehicleMovementArcadeWheeled.h
        │       ├── VehicleMovementBase.cpp
        │       ├── VehicleMovementBase.h
        │       ├── VehicleMovementHelicopter.cpp
        │       ├── VehicleMovementHelicopter.h
        │       ├── VehicleMovementHelicopterArcade.cpp
        │       ├── VehicleMovementHelicopterArcade.h
        │       ├── VehicleMovementMPVTOL.cpp
        │       ├── VehicleMovementMPVTOL.h
        │       ├── VehicleMovementStdBoat.cpp
        │       ├── VehicleMovementStdBoat.h
        │       ├── VehicleMovementStdTank.cpp
        │       ├── VehicleMovementStdTank.h
        │       ├── VehicleMovementStdWheeled.cpp
        │       ├── VehicleMovementStdWheeled.h
        │       ├── VehicleMovementTank.cpp
        │       ├── VehicleMovementTank.h
        │       ├── VehicleMovementTweaks.cpp
        │       ├── VehicleSeatActionSound.cpp
        │       ├── VehicleSeatActionSound.h
        │       ├── VehicleWeapon.cpp
        │       ├── VehicleWeapon.h
        │       ├── VehicleWeaponControlled.cpp
        │       ├── VehicleWeaponControlled.h
        │       ├── VehicleWeaponGuided.cpp
        │       ├── VehicleWeaponGuided.h
        │       ├── Voting.cpp
        │       ├── Voting.h
        │       ├── WaypointPath.cpp
        │       ├── WaypointPath.h
        │       ├── Weapon.cpp
        │       ├── Weapon.h
        │       ├── WeaponAlias.cpp
        │       ├── WeaponAlias.h
        │       ├── WeaponBumpOffset.cpp
        │       ├── WeaponBumpOffset.h
        │       ├── WeaponClientServer.cpp
        │       ├── WeaponEvent.cpp
        │       ├── WeaponFPAiming.cpp
        │       ├── WeaponFPAiming.h
        │       ├── WeaponInput.cpp
        │       ├── WeaponLookOffset.cpp
        │       ├── WeaponLookOffset.h
        │       ├── WeaponMelee.cpp
        │       ├── WeaponMelee.h
        │       ├── WeaponOffset.cpp
        │       ├── WeaponOffset.h
        │       ├── WeaponOffsetInput.cpp
        │       ├── WeaponOffsetInput.h
        │       ├── WeaponRecoilOffset.cpp
        │       ├── WeaponRecoilOffset.h
        │       ├── WeaponSharedParams.cpp
        │       ├── WeaponSharedParams.h
        │       ├── WeaponStats.cpp
        │       ├── WeaponStats.h
        │       ├── WeaponStrafeOffset.cpp
        │       ├── WeaponStrafeOffset.h
        │       ├── WeaponSystem.cpp
        │       ├── WeaponSystem.h
        │       ├── WeaponZoomOffset.cpp
        │       ├── WeaponZoomOffset.h
        │       ├── WorldBuilder.cpp
        │       ├── WorldBuilder.h
        │       ├── wscript
        │       ├── XMLStatsSerializer.cpp
        │       ├── XMLStatsSerializer.h
        │       ├── AI/
        │       │   ├── AdvantagePointOccupancyControl.cpp
        │       │   ├── AdvantagePointOccupancyControl.h
        │       │   ├── Agent.h
        │       │   ├── Agent.inl
        │       │   ├── AIAwarenessToPlayerHelper.cpp
        │       │   ├── AIAwarenessToPlayerHelper.h
        │       │   ├── AIBattleFront.cpp
        │       │   ├── AIBattleFront.h
        │       │   ├── AICorpse.cpp
        │       │   ├── AICorpse.h
        │       │   ├── AICounters.cpp
        │       │   ├── AICounters.h
        │       │   ├── AISquadManager.cpp
        │       │   ├── AISquadManager.h
        │       │   ├── AloneDetectorModule.cpp
        │       │   ├── AloneDetectorModule.h
        │       │   ├── ArmorModule.cpp
        │       │   ├── ArmorModule.h
        │       │   ├── Assignment.h
        │       │   ├── DeathManager.cpp
        │       │   ├── DeathManager.h
        │       │   ├── EnvironmentDisturbanceManager.cpp
        │       │   ├── EnvironmentDisturbanceManager.h
        │       │   ├── GameAIEnv.cpp
        │       │   ├── GameAIEnv.h
        │       │   ├── GameAIHelpers.cpp
        │       │   ├── GameAIHelpers.h
        │       │   ├── GameAIRecorder.cpp
        │       │   ├── GameAIRecorder.h
        │       │   ├── GameAISystem.cpp
        │       │   ├── GameAISystem.h
        │       │   ├── IGameAIModule.h
        │       │   ├── RangeModule.cpp
        │       │   ├── RangeModule.h
        │       │   ├── ScriptBind_GameAI.cpp
        │       │   ├── ScriptBind_GameAI.h
        │       │   ├── SearchModule.cpp
        │       │   ├── SearchModule.h
        │       │   ├── StalkerModule.cpp
        │       │   ├── StalkerModule.h
        │       │   ├── TacticalPointLanguageExtender.cpp
        │       │   ├── TacticalPointLanguageExtender.h
        │       │   ├── TargetTrackThreatModifier.cpp
        │       │   ├── TargetTrackThreatModifier.h
        │       │   ├── VisibleObjectsHelper.cpp
        │       │   ├── VisibleObjectsHelper.h
        │       │   ├── Action/
        │       │   │   ├── AIFaceManager.cpp
        │       │   │   ├── AIFaceManager.h
        │       │   │   ├── AIGroupProxy.cpp
        │       │   │   ├── AIGroupProxy.h
        │       │   │   ├── AIHandler.cpp
        │       │   │   ├── AIHandler.h
        │       │   │   ├── AIProxy.cpp
        │       │   │   ├── AIProxy.h
        │       │   │   ├── AIProxyManager.cpp
        │       │   │   ├── AIProxyManager.h
        │       │   │   ├── CommunicationHandler.cpp
        │       │   │   ├── CommunicationHandler.h
        │       │   │   ├── ScriptBind_AIAction.cpp
        │       │   │   ├── ScriptBind_AIAction.h
        │       │   │   ├── Mannequin/
        │       │   │   │   ├── AnimActionTriStateSDK.cpp
        │       │   │   │   └── AnimActionTriStateSDK.h
        │       │   │   ├── RangeSignalingSystem/
        │       │   │   │   ├── AngleAlert.cpp
        │       │   │   │   ├── AngleAlert.h
        │       │   │   │   ├── PersonalRangeSignaling.cpp
        │       │   │   │   ├── PersonalRangeSignaling.h
        │       │   │   │   ├── Range.cpp
        │       │   │   │   ├── Range.h
        │       │   │   │   ├── RangeSignaling.cpp
        │       │   │   │   └── RangeSignaling.h
        │       │   │   └── SignalTimers/
        │       │   │       ├── PersonalSignalTimer.cpp
        │       │   │       ├── PersonalSignalTimer.h
        │       │   │       ├── SignalTimers.cpp
        │       │   │       └── SignalTimers.h
        │       │   ├── BehaviorTree/
        │       │   │   ├── BehaviorTreeNodes_Game.cpp
        │       │   │   └── BehaviorTreeNodes_Game.h
        │       │   ├── HazardModule/
        │       │   │   ├── Hazard.cpp
        │       │   │   ├── Hazard.h
        │       │   │   ├── HazardModule.cpp
        │       │   │   ├── HazardModule.h
        │       │   │   ├── HazardProjectile.cpp
        │       │   │   ├── HazardProjectile.h
        │       │   │   ├── HazardRayCast.cpp
        │       │   │   ├── HazardRayCast.h
        │       │   │   ├── HazardShared.cpp
        │       │   │   ├── HazardShared.h
        │       │   │   ├── HazardSphere.cpp
        │       │   │   └── HazardSphere.h
        │       │   ├── RadioChatter/
        │       │   │   ├── RadioChatterFlowNode.cpp
        │       │   │   ├── RadioChatterModule.cpp
        │       │   │   └── RadioChatterModule.h
        │       │   └── RateOfDeath/
        │       │       ├── RateOfDeathHelper.cpp
        │       │       ├── RateOfDeathHelper.h
        │       │       ├── RateOfDeathSimple.cpp
        │       │       └── RateOfDeathSimple.h
        │       ├── Audio/
        │       │   ├── Announcer.cpp
        │       │   ├── Announcer.h
        │       │   ├── AreaAnnouncer.cpp
        │       │   ├── AreaAnnouncer.h
        │       │   ├── AudioSignalPlayer.cpp
        │       │   ├── AudioSignalPlayer.h
        │       │   ├── AudioTypes.h
        │       │   ├── GameAudio.cpp
        │       │   ├── GameAudio.h
        │       │   ├── GameAudioUtils.cpp
        │       │   ├── GameAudioUtils.h
        │       │   ├── MiscAnnouncer.cpp
        │       │   ├── MiscAnnouncer.h
        │       │   ├── Scriptbind_GameAudio.cpp
        │       │   └── Scriptbind_GameAudio.h
        │       ├── Boids/
        │       │   ├── BirdEnum.h
        │       │   ├── BirdsFlock.cpp
        │       │   ├── BirdsFlock.h
        │       │   ├── BoidBird.cpp
        │       │   ├── BoidBird.h
        │       │   ├── BoidCollision.cpp
        │       │   ├── BoidCollision.h
        │       │   ├── BoidFish.cpp
        │       │   ├── BoidFish.h
        │       │   ├── BoidObject.cpp
        │       │   ├── BoidObject.h
        │       │   ├── BoidsProxy.cpp
        │       │   ├── BoidsProxy.h
        │       │   ├── BugsFlock.cpp
        │       │   ├── BugsFlock.h
        │       │   ├── ChickenBoids.cpp
        │       │   ├── ChickenBoids.h
        │       │   ├── FishFlock.cpp
        │       │   ├── FishFlock.h
        │       │   ├── Flock.cpp
        │       │   ├── Flock.h
        │       │   ├── FrogBoids.cpp
        │       │   ├── FrogBoids.h
        │       │   ├── ScriptBind_Boids.cpp
        │       │   └── ScriptBind_Boids.h
        │       ├── DialogSystem/
        │       │   ├── DialogActorContext.cpp
        │       │   ├── DialogActorContext.h
        │       │   ├── DialogCommon.h
        │       │   ├── DialogLoader.cpp
        │       │   ├── DialogLoader.h
        │       │   ├── DialogLoaderMK2.cpp
        │       │   ├── DialogLoaderMK2.h
        │       │   ├── DialogQueuesManager.cpp
        │       │   ├── DialogQueuesManager.h
        │       │   ├── DialogScript.cpp
        │       │   ├── DialogScript.h
        │       │   ├── DialogSession.cpp
        │       │   ├── DialogSession.h
        │       │   ├── DialogSystem.cpp
        │       │   ├── DialogSystem.h
        │       │   ├── FlowDialogNode.cpp
        │       │   ├── ScriptBind_DialogSystem.cpp
        │       │   └── ScriptBind_DialogSystem.h
        │       ├── DynamicResponseSystem/
        │       │   ├── ActionExecuteAudioTrigger.cpp
        │       │   ├── ActionExecuteAudioTrigger.h
        │       │   ├── ConditionDistanceToEntity.cpp
        │       │   ├── ConditionDistanceToEntity.h
        │       │   ├── GameTokenToDrsTranslator.cpp
        │       │   └── GameTokenToDrsTranslator.h
        │       ├── Editor/
        │       │   ├── GameRealtimeRemoteUpdate.cpp
        │       │   ├── GameRealtimeRemoteUpdate.h
        │       │   └── RealtimeRemoteUpdate.h
        │       ├── Effects/
        │       │   ├── GameEffectsSystem.cpp
        │       │   ├── GameEffectsSystem.h
        │       │   ├── GameEffectsSystemDefines.h
        │       │   ├── GameEffects/
        │       │   │   ├── ExplosionGameEffect.cpp
        │       │   │   ├── ExplosionGameEffect.h
        │       │   │   ├── GameEffect.cpp
        │       │   │   ├── GameEffect.h
        │       │   │   ├── HitRecoilGameEffect.cpp
        │       │   │   ├── HitRecoilGameEffect.h
        │       │   │   ├── HudInterferenceGameEffect.cpp
        │       │   │   ├── HudInterferenceGameEffect.h
        │       │   │   ├── KillCamGameEffect.cpp
        │       │   │   ├── KillCamGameEffect.h
        │       │   │   ├── LightningGameEffect.cpp
        │       │   │   ├── LightningGameEffect.h
        │       │   │   ├── ParameterGameEffect.cpp
        │       │   │   ├── ParameterGameEffect.h
        │       │   │   ├── PlayerHealthEffect.cpp
        │       │   │   ├── PlayerHealthEffect.h
        │       │   │   ├── PlayerMindGameBeamEffect.cpp
        │       │   │   ├── PlayerMindGameBeamEffect.h
        │       │   │   ├── SceneBlurGameEffect.cpp
        │       │   │   ├── SceneBlurGameEffect.h
        │       │   │   ├── WaterEffects.cpp
        │       │   │   └── WaterEffects.h
        │       │   ├── HUDEventListeners/
        │       │   │   ├── LetterBoxHudEventListener.cpp
        │       │   │   └── LetterBoxHudEventListener.h
        │       │   ├── RenderElements/
        │       │   │   ├── GameRenderElement.cpp
        │       │   │   └── GameRenderElement.h
        │       │   ├── RenderNodes/
        │       │   │   ├── IGameRenderNode.h
        │       │   │   ├── LightningNode.cpp
        │       │   │   └── LightningNode.h
        │       │   └── Tools/
        │       │       ├── CVarActivationSystem.cpp
        │       │       ├── CVarActivationSystem.h
        │       │       ├── LerpParam.h
        │       │       ├── PostEffectActivationSystem.cpp
        │       │       └── PostEffectActivationSystem.h
        │       ├── EntityUtility/
        │       │   ├── EntityEffects.cpp
        │       │   ├── EntityEffects.h
        │       │   ├── EntityEffectsCloak.cpp
        │       │   ├── EntityEffectsCloak.h
        │       │   ├── EntityEffectsHeat.cpp
        │       │   ├── EntityEffectsHeat.h
        │       │   ├── EntityScriptCalls.cpp
        │       │   └── EntityScriptCalls.h
        │       ├── Environment/
        │       │   ├── DangerousRigidBody.cpp
        │       │   ├── DangerousRigidBody.h
        │       │   ├── DeflectorShield.cpp
        │       │   ├── DeflectorShield.h
        │       │   ├── DoorPanel.cpp
        │       │   ├── DoorPanel.h
        │       │   ├── DoorPanelBehavior.cpp
        │       │   ├── InteractiveObject.cpp
        │       │   ├── InteractiveObject.h
        │       │   ├── InteractiveObjectEnums.h
        │       │   ├── InteractiveObjectRegistry.cpp
        │       │   ├── InteractiveObjectRegistry.h
        │       │   ├── Ledge.cpp
        │       │   ├── Ledge.h
        │       │   ├── LedgeManager.cpp
        │       │   ├── LedgeManager.h
        │       │   ├── LightningArc.cpp
        │       │   ├── LightningArc.h
        │       │   ├── MineField.cpp
        │       │   ├── MineField.h
        │       │   ├── Rain.cpp
        │       │   ├── Rain.h
        │       │   ├── ScriptBind_InteractiveObject.cpp
        │       │   ├── ScriptBind_InteractiveObject.h
        │       │   ├── ScriptBind_LightningArc.cpp
        │       │   ├── ScriptBind_LightningArc.h
        │       │   ├── Shake.cpp
        │       │   ├── Shake.h
        │       │   ├── SmartMine.cpp
        │       │   ├── SmartMine.h
        │       │   ├── SmartMineBehavior.cpp
        │       │   ├── Snow.cpp
        │       │   ├── Snow.h
        │       │   ├── Tornado.cpp
        │       │   ├── Tornado.h
        │       │   ├── VicinityDependentObjectMover.cpp
        │       │   ├── VicinityDependentObjectMover.h
        │       │   ├── WaterPuddle.cpp
        │       │   ├── WaterPuddle.h
        │       │   ├── WaterRipplesGenerator.cpp
        │       │   └── WaterRipplesGenerator.h
        │       ├── GameCodeCoverage/
        │       │   ├── GameCodeCoverageEnabled.h
        │       │   ├── GameCodeCoverageGUI.cpp
        │       │   ├── GameCodeCoverageGUI.h
        │       │   ├── GameCodeCoverageManager.cpp
        │       │   ├── GameCodeCoverageManager.h
        │       │   ├── GameCodeCoverageTracker.cpp
        │       │   ├── GameCodeCoverageTracker.h
        │       │   ├── IGameCodeCoverageListener.cpp
        │       │   └── IGameCodeCoverageListener.h
        │       ├── GameMechanismManager/
        │       │   ├── GameMechanismBase.cpp
        │       │   ├── GameMechanismBase.h
        │       │   ├── GameMechanismEvents.h
        │       │   ├── GameMechanismManager.cpp
        │       │   └── GameMechanismManager.h
        │       ├── GameRulesModules/
        │       │   ├── GameRulesAssistScoring.cpp
        │       │   ├── GameRulesAssistScoring.h
        │       │   ├── GameRulesCombiCaptureObjective.cpp
        │       │   ├── GameRulesCombiCaptureObjective.h
        │       │   ├── GameRulesCommonDamageHandling.cpp
        │       │   ├── GameRulesCommonDamageHandling.h
        │       │   ├── GameRulesExtractionVictoryConditions.cpp
        │       │   ├── GameRulesExtractionVictoryConditions.h
        │       │   ├── GameRulesGladiatorTeams.h
        │       │   ├── GameRulesHoldObjectiveBase.cpp
        │       │   ├── GameRulesHoldObjectiveBase.h
        │       │   ├── GameRulesKingOfTheHillObjective.cpp
        │       │   ├── GameRulesKingOfTheHillObjective.h
        │       │   ├── GameRulesModulesManager.cpp
        │       │   ├── GameRulesModulesManager.h
        │       │   ├── GameRulesModulesRegistration.h
        │       │   ├── GameRulesMPActorAction.cpp
        │       │   ├── GameRulesMPActorAction.h
        │       │   ├── GameRulesMPDamageHandling.cpp
        │       │   ├── GameRulesMPDamageHandling.h
        │       │   ├── GameRulesMPSimpleSpawning.cpp
        │       │   ├── GameRulesMPSimpleSpawning.h
        │       │   ├── GameRulesMPSpawning.cpp
        │       │   ├── GameRulesMPSpawning.h
        │       │   ├── GameRulesMPSpawningWithLives.cpp
        │       │   ├── GameRulesMPSpawningWithLives.h
        │       │   ├── GameRulesMPSpectator.cpp
        │       │   ├── GameRulesMPSpectator.h
        │       │   ├── GameRulesMPWaveSpawning.cpp
        │       │   ├── GameRulesMPWaveSpawning.h
        │       │   ├── GameRulesObjective_CTF.cpp
        │       │   ├── GameRulesObjective_CTF.h
        │       │   ├── GameRulesObjective_Extraction.cpp
        │       │   ├── GameRulesObjective_Extraction.h
        │       │   ├── GameRulesObjective_PowerStruggle.cpp
        │       │   ├── GameRulesObjective_PowerStruggle.h
        │       │   ├── GameRulesObjective_Predator.cpp
        │       │   ├── GameRulesObjective_Predator.h
        │       │   ├── GameRulesObjectiveVictoryConditionsIndividualScore.cpp
        │       │   ├── GameRulesObjectiveVictoryConditionsIndividualScore.h
        │       │   ├── GameRulesObjectiveVictoryConditionsTeam.cpp
        │       │   ├── GameRulesObjectiveVictoryConditionsTeam.h
        │       │   ├── GameRulesSimpleEntityBasedObjective.cpp
        │       │   ├── GameRulesSimpleEntityBasedObjective.h
        │       │   ├── GameRulesSpawningBase.cpp
        │       │   ├── GameRulesSpawningBase.h
        │       │   ├── GameRulesSPDamageHandling.cpp
        │       │   ├── GameRulesSPDamageHandling.h
        │       │   ├── GameRulesStandardPlayerStats.cpp
        │       │   ├── GameRulesStandardPlayerStats.h
        │       │   ├── GameRulesStandardRounds.cpp
        │       │   ├── GameRulesStandardRounds.h
        │       │   ├── GameRulesStandardScoring.cpp
        │       │   ├── GameRulesStandardScoring.h
        │       │   ├── GameRulesStandardSetup.cpp
        │       │   ├── GameRulesStandardSetup.h
        │       │   ├── GameRulesStandardState.cpp
        │       │   ├── GameRulesStandardState.h
        │       │   ├── GameRulesStandardTwoTeams.cpp
        │       │   ├── GameRulesStandardTwoTeams.h
        │       │   ├── GameRulesStandardVictoryConditionsPlayer.cpp
        │       │   ├── GameRulesStandardVictoryConditionsPlayer.h
        │       │   ├── GameRulesStandardVictoryConditionsTeam.cpp
        │       │   ├── GameRulesStandardVictoryConditionsTeam.h
        │       │   ├── GameRulesStatsRecording.cpp
        │       │   ├── GameRulesStatsRecording.h
        │       │   ├── GameRulesSurvivorOneVictoryConditions.cpp
        │       │   ├── GameRulesSurvivorOneVictoryConditions.h
        │       │   ├── IGameRulesActorActionListener.h
        │       │   ├── IGameRulesActorActionModule.h
        │       │   ├── IGameRulesAssistScoringModule.h
        │       │   ├── IGameRulesClientConnectionListener.h
        │       │   ├── IGameRulesClientScoreListener.h
        │       │   ├── IGameRulesDamageHandlingModule.h
        │       │   ├── IGameRulesEntityObjective.h
        │       │   ├── IGameRulesKillListener.h
        │       │   ├── IGameRulesModuleRMIListener.h
        │       │   ├── IGameRulesModulesManager.h
        │       │   ├── IGameRulesObjective.h
        │       │   ├── IGameRulesObjectivesModule.h
        │       │   ├── IGameRulesPickupListener.h
        │       │   ├── IGameRulesPlayerSetupModule.h
        │       │   ├── IGameRulesPlayerStatsListener.h
        │       │   ├── IGameRulesPlayerStatsModule.h
        │       │   ├── IGameRulesPrematchListener.h
        │       │   ├── IGameRulesRevivedListener.h
        │       │   ├── IGameRulesRoundsListener.h
        │       │   ├── IGameRulesRoundsModule.h
        │       │   ├── IGameRulesScoringModule.h
        │       │   ├── IGameRulesSpawningModule.h
        │       │   ├── IGameRulesSpectatorModule.h
        │       │   ├── IGameRulesStateModule.h
        │       │   ├── IGameRulesStatsRecording.h
        │       │   ├── IGameRulesSurvivorCountListener.h
        │       │   ├── IGameRulesTeamChangedListener.h
        │       │   ├── IGameRulesTeamsModule.h
        │       │   ├── IGameRulesVictoryConditionsModule.h
        │       │   ├── SpawningVisTable.cpp
        │       │   └── SpawningVisTable.h
        │       ├── Graphics/
        │       │   ├── 2DRenderUtils.cpp
        │       │   ├── 2DRenderUtils.h
        │       │   ├── PostEffectBlender.cpp
        │       │   ├── PostEffectBlender.h
        │       │   ├── PostEffectBlender_Test.cpp
        │       │   ├── ScreenFader.cpp
        │       │   ├── ScreenFader.h
        │       │   └── ScreenFader_Test.cpp
        │       ├── MovingPlatforms/
        │       │   ├── MovingPlatformMgr.cpp
        │       │   └── MovingPlatformMgr.h
        │       ├── MultiplayerEntities/
        │       │   ├── CarryEntity.cpp
        │       │   ├── CarryEntity.h
        │       │   ├── NetworkedPhysicsEntity.cpp
        │       │   └── NetworkedPhysicsEntity.h
        │       ├── Network/
        │       │   ├── GameNetworkDefines.h
        │       │   ├── GameNetworkUtils.cpp
        │       │   ├── GameNetworkUtils.h
        │       │   ├── LobbyTaskQueue.h
        │       │   ├── Lobby/
        │       │   │   ├── AutoLockData.h
        │       │   │   ├── CryGameSpyVoiceCodec.cpp
        │       │   │   ├── CryGameSpyVoiceCodec.h
        │       │   │   ├── CryLobbySessionHandler.cpp
        │       │   │   ├── CryLobbySessionHandler.h
        │       │   │   ├── GameAchievements.cpp
        │       │   │   ├── GameAchievements.h
        │       │   │   ├── GameBrowser.cpp
        │       │   │   ├── GameBrowser.h
        │       │   │   ├── GameLobby.h
        │       │   │   ├── GameLobbyCVars.cpp
        │       │   │   ├── GameLobbyCVars.h
        │       │   │   ├── GameLobbyData.cpp
        │       │   │   ├── GameLobbyData.h
        │       │   │   ├── GameLobbyManager.cpp
        │       │   │   ├── GameLobbyManager.h
        │       │   │   ├── GameServerLists.cpp
        │       │   │   ├── GameServerLists.h
        │       │   │   ├── GameUserPackets.h
        │       │   │   ├── IGameLobbyEventListener.h
        │       │   │   ├── MatchmakingEvents.cpp
        │       │   │   ├── MatchMakingEvents.h
        │       │   │   ├── MatchmakingHandler.cpp
        │       │   │   ├── MatchMakingHandler.h
        │       │   │   ├── MatchmakingTelemetry.cpp
        │       │   │   ├── MatchMakingTelemetry.h
        │       │   │   ├── PlaylistActivityTracker.cpp
        │       │   │   ├── PlaylistActivityTracker.h
        │       │   │   ├── ScriptBind_MatchMaking.cpp
        │       │   │   ├── ScriptBind_MatchMaking.h
        │       │   │   ├── SessionNames.cpp
        │       │   │   ├── SessionNames.h
        │       │   │   ├── SessionSearchSimulator.cpp
        │       │   │   ├── SessionSearchSimulator.h
        │       │   │   ├── TeamBalancing.cpp
        │       │   │   └── TeamBalancing.h
        │       │   ├── LoginManager/
        │       │   │   ├── LoginManager.cpp
        │       │   │   └── LoginManager.h
        │       │   ├── RecentPlayers/
        │       │   │   ├── RecentPlayersMgr.cpp
        │       │   │   └── RecentPlayersMgr.h
        │       │   └── Squad/
        │       │       ├── ISquadEventListener.h
        │       │       ├── SquadManager.cpp
        │       │       └── SquadManager.h
        │       ├── Nodes/
        │       │   ├── AchievementNode.cpp
        │       │   ├── AIAssignmentNodes.cpp
        │       │   ├── AIAssignmentNodes.h
        │       │   ├── AINodes.cpp
        │       │   ├── AINodes.h
        │       │   ├── FeatureTestNode.cpp
        │       │   ├── FeatureTestNode.h
        │       │   ├── FlowActorNodes.cpp
        │       │   ├── FlowActorSensor.cpp
        │       │   ├── FlowCheckAreaNode.cpp
        │       │   ├── FlowFadeNode.cpp
        │       │   ├── FlowFadeNode.h
        │       │   ├── FlowGameSDKBaseNode.h
        │       │   ├── FlowHitInfoNode.cpp
        │       │   ├── FlowHudEventsNodes.cpp
        │       │   ├── FlowLockPlayerNode.cpp
        │       │   ├── FlowMinimapNodes.cpp
        │       │   ├── FlowNodesAIActionSequence.cpp
        │       │   ├── FlowNodesInput.cpp
        │       │   ├── FlowPlayerStagingNode.cpp
        │       │   ├── FlowPlayerStumble.cpp
        │       │   ├── FlowPostFXNodes.cpp
        │       │   ├── FlowSmartObjectNodes.cpp
        │       │   ├── FlowVideoPlayerNodes.cpp
        │       │   ├── G2FlowEntityElectricConnector.cpp
        │       │   ├── G2FlowEntityVelocity.cpp
        │       │   ├── GameFlowBaseNode.cpp
        │       │   ├── GameFlowBaseNode.h
        │       │   ├── GameFlowBaseNode_Test.cpp
        │       │   ├── GameNodes.cpp
        │       │   ├── ModelToHudFlowNodes.cpp
        │       │   ├── ModelToHudFlowNodes.h
        │       │   ├── MPNodes.cpp
        │       │   ├── PressureWaveNode.cpp
        │       │   ├── ScreenFaderNode.cpp
        │       │   ├── ScreenFaderNode.h
        │       │   ├── ScreenFaderNode_Test.cpp
        │       │   ├── TacticalScanNode.cpp
        │       │   └── WeaponNodes.cpp
        │       ├── PlayerControl/
        │       │   ├── PlayerEnslavement.cpp
        │       │   └── PlayerEnslavement.h
        │       ├── Stereo3D/
        │       │   ├── StereoFramework.cpp
        │       │   ├── StereoFramework.h
        │       │   ├── StereoZoom.cpp
        │       │   └── StereoZoom.h
        │       ├── Testing/
        │       │   ├── AutoTester.cpp
        │       │   ├── AutoTester.h
        │       │   ├── EditorSmokeTestFixture.cpp
        │       │   ├── EditorSmokeTestFixture.h
        │       │   ├── FeatureTester.cpp
        │       │   ├── FeatureTester.h
        │       │   ├── FeatureTestMgr.cpp
        │       │   ├── FeatureTestMgr.h
        │       │   ├── FlowGraphTesting.cpp
        │       │   ├── FlowGraphTesting.h
        │       │   ├── MockColorGradingController.cpp
        │       │   ├── MockColorGradingController.h
        │       │   ├── MockEngineSound.cpp
        │       │   ├── MockEngineSound.h
        │       │   ├── MockEntitySystem.cpp
        │       │   ├── MockEntitySystem.h
        │       │   ├── MockSoundSystemWrapper.cpp
        │       │   └── MockSoundSystemWrapper.h
        │       ├── Turret/
        │       │   └── Turret/
        │       │       ├── AnimationActionTurret.h
        │       │       ├── FlowNodesTurret.cpp
        │       │       ├── ProceduralClipTurretAimPose.cpp
        │       │       ├── ProceduralContextTurretAimPose.cpp
        │       │       ├── ProceduralContextTurretAimPose.h
        │       │       ├── ScriptBind_Turret.cpp
        │       │       ├── ScriptBind_Turret.h
        │       │       ├── Turret.cpp
        │       │       ├── Turret.h
        │       │       ├── TurretBehavior.cpp
        │       │       ├── TurretBehaviorEvents.h
        │       │       ├── TurretBehaviorParams.cpp
        │       │       ├── TurretBehaviorParams.h
        │       │       ├── TurretHelpers.h
        │       │       └── TurretSoundManager.h
        │       ├── UI/
        │       │   ├── IUIGameEventSystem.h
        │       │   ├── Option.cpp
        │       │   ├── Option.h
        │       │   ├── ProfileOptions.cpp
        │       │   ├── ProfileOptions.h
        │       │   ├── UICVars.cpp
        │       │   ├── UICVars.h
        │       │   ├── UIDialogs.cpp
        │       │   ├── UIDialogs.h
        │       │   ├── UIEntityDynTexTag.cpp
        │       │   ├── UIEntityDynTexTag.h
        │       │   ├── UIEntityTag.cpp
        │       │   ├── UIEntityTag.h
        │       │   ├── UIGameEvents.cpp
        │       │   ├── UIGameEvents.h
        │       │   ├── UIHUD3D.cpp
        │       │   ├── UIHUD3D.h
        │       │   ├── UIInput.cpp
        │       │   ├── UIInput.h
        │       │   ├── UILobbyMP.cpp
        │       │   ├── UILobbyMP.h
        │       │   ├── UIManager.cpp
        │       │   ├── UIManager.h
        │       │   ├── UIMenuEvents.cpp
        │       │   ├── UIMenuEvents.h
        │       │   ├── UIMultiPlayer.cpp
        │       │   ├── UIMultiPlayer.h
        │       │   ├── UISettings.cpp
        │       │   ├── UISettings.h
        │       │   ├── UITypes.h
        │       │   ├── WarningsManager.cpp
        │       │   ├── WarningsManager.h
        │       │   ├── HUD/
        │       │   │   ├── ErrorHandling.cpp
        │       │   │   ├── ErrorHandling.h
        │       │   │   ├── HUDControllerInputIcons.cpp
        │       │   │   ├── HUDControllerInputIcons.h
        │       │   │   ├── HUDEventDispatcher.cpp
        │       │   │   ├── HUDEventDispatcher.h
        │       │   │   ├── HUDEventTranslator.cpp
        │       │   │   ├── HUDEventTranslator.h
        │       │   │   ├── HUDEventWrapper.cpp
        │       │   │   ├── HUDEventWrapper.h
        │       │   │   ├── HUDMissionObjectiveSystem.cpp
        │       │   │   ├── HUDMissionObjectiveSystem.h
        │       │   │   ├── HUDOnScreenMessageDef.cpp
        │       │   │   ├── HUDOnScreenMessageDef.h
        │       │   │   ├── HUDSilhouettes.cpp
        │       │   │   ├── HUDSilhouettes.h
        │       │   │   ├── HUDUtils.cpp
        │       │   │   ├── HUDUtils.h
        │       │   │   ├── ScriptBind_HUD.cpp
        │       │   │   ├── ScriptBind_HUD.h
        │       │   │   ├── TacticalOverrideEntity.cpp
        │       │   │   └── TacticalOverrideEntity.h
        │       │   ├── Menu3dModels/
        │       │   │   ├── FrontEndModelCache.cpp
        │       │   │   ├── FrontEndModelCache.h
        │       │   │   ├── MenuRender3DModelMgr.cpp
        │       │   │   └── MenuRender3DModelMgr.h
        │       │   └── Utils/
        │       │       ├── ILoadingMessageProvider.cpp
        │       │       ├── ILoadingMessageProvider.h
        │       │       ├── LocalizedStringManager.cpp
        │       │       ├── LocalizedStringManager.h
        │       │       ├── ScreenLayoutManager.cpp
        │       │       ├── ScreenLayoutManager.h
        │       │       ├── ScreenLayoutUtils.cpp
        │       │       └── ScreenLayoutUtils.h
        │       ├── Utility/
        │       │   ├── AttachmentUtils.cpp
        │       │   ├── AttachmentUtils.h
        │       │   ├── BufferUtil.h
        │       │   ├── CryDebugLog.h
        │       │   ├── CryHash.cpp
        │       │   ├── CryHash.h
        │       │   ├── CryWatch.cpp
        │       │   ├── CryWatch.h
        │       │   ├── DesignerWarning.cpp
        │       │   ├── DesignerWarning.h
        │       │   ├── DoubleLinkedList.h
        │       │   ├── Hermite.h
        │       │   ├── MaskedVar.h
        │       │   ├── SingleAllocTextBlock.cpp
        │       │   ├── SingleAllocTextBlock.h
        │       │   ├── StringUtils.cpp
        │       │   ├── StringUtils.h
        │       │   ├── Wiggle.cpp
        │       │   └── Wiggle.h
        │       ├── Vehicle/
        │       │   ├── VehicleMovementDummy.cpp
        │       │   ├── VehicleMovementDummy.h
        │       │   ├── VehiclePhysicsHelicopter.cpp
        │       │   ├── VehiclePhysicsHelicopter.h
        │       │   └── VehicleUtils.h
        │       └── VTOLVehicleManager/
        │           ├── VTOLVehicleManager.cpp
        │           └── VTOLVehicleManager.h
        ├── GameTemplates/
        │   ├── cpp/
        │   │   ├── Blank/
        │   │   │   ├── Game.cryproject
        │   │   │   └── Code/
        │   │   │       ├── GamePlugin.cpp
        │   │   │       ├── GamePlugin.h
        │   │   │       ├── StdAfx.cpp
        │   │   │       ├── StdAfx.h
        │   │   │       └── Components/
        │   │   │           ├── Player.cpp
        │   │   │           └── Player.h
        │   │   ├── FirstPersonShooter/
        │   │   │   ├── Game.cryproject
        │   │   │   └── Code/
        │   │   │       ├── GamePlugin.cpp
        │   │   │       ├── GamePlugin.h
        │   │   │       ├── StdAfx.cpp
        │   │   │       ├── StdAfx.h
        │   │   │       └── Components/
        │   │   │           ├── Bullet.h
        │   │   │           ├── Player.cpp
        │   │   │           ├── Player.h
        │   │   │           ├── SpawnPoint.cpp
        │   │   │           └── SpawnPoint.h
        │   │   ├── IsometricPathfinding/
        │   │   │   ├── Game.cryproject
        │   │   │   └── Code/
        │   │   │       ├── GamePlugin.cpp
        │   │   │       ├── GamePlugin.h
        │   │   │       ├── StdAfx.cpp
        │   │   │       ├── StdAfx.h
        │   │   │       └── Components/
        │   │   │           ├── Bullet.h
        │   │   │           ├── Player.cpp
        │   │   │           ├── Player.h
        │   │   │           ├── SpawnPoint.cpp
        │   │   │           └── SpawnPoint.h
        │   │   ├── Plugin/
        │   │   │   ├── Plugin.cryproject
        │   │   │   └── Code/
        │   │   │       ├── Plugin.cpp
        │   │   │       ├── Plugin.h
        │   │   │       ├── StdAfx.cpp
        │   │   │       └── StdAfx.h
        │   │   ├── RollingBall/
        │   │   │   ├── Game.cryproject
        │   │   │   └── Code/
        │   │   │       ├── GamePlugin.cpp
        │   │   │       ├── GamePlugin.h
        │   │   │       ├── StdAfx.cpp
        │   │   │       ├── StdAfx.h
        │   │   │       └── Components/
        │   │   │           ├── Player.cpp
        │   │   │           ├── Player.h
        │   │   │           ├── SpawnPoint.cpp
        │   │   │           └── SpawnPoint.h
        │   │   ├── Sidescroller/
        │   │   │   ├── Game.cryproject
        │   │   │   └── Code/
        │   │   │       ├── GamePlugin.cpp
        │   │   │       ├── GamePlugin.h
        │   │   │       ├── StdAfx.cpp
        │   │   │       ├── StdAfx.h
        │   │   │       └── Components/
        │   │   │           ├── Bullet.h
        │   │   │           ├── Player.cpp
        │   │   │           ├── Player.h
        │   │   │           ├── SpawnPoint.cpp
        │   │   │           └── SpawnPoint.h
        │   │   ├── ThirdPersonShooter/
        │   │   │   ├── Game.cryproject
        │   │   │   └── Code/
        │   │   │       ├── GamePlugin.cpp
        │   │   │       ├── GamePlugin.h
        │   │   │       ├── StdAfx.cpp
        │   │   │       ├── StdAfx.h
        │   │   │       └── Components/
        │   │   │           ├── Bullet.h
        │   │   │           ├── Player.cpp
        │   │   │           ├── Player.h
        │   │   │           ├── SpawnPoint.cpp
        │   │   │           └── SpawnPoint.h
        │   │   └── TopDownShooter/
        │   │       ├── Game.cryproject
        │   │       └── Code/
        │   │           ├── GamePlugin.cpp
        │   │           ├── GamePlugin.h
        │   │           ├── StdAfx.cpp
        │   │           ├── StdAfx.h
        │   │           └── Components/
        │   │               ├── Bullet.h
        │   │               ├── Player.cpp
        │   │               ├── Player.h
        │   │               ├── SpawnPoint.cpp
        │   │               └── SpawnPoint.h
        │   └── cs/
        │       ├── Blank/
        │       │   ├── Game.cryproject
        │       │   └── Code/
        │       │       └── Game/
        │       │           ├── Game.cs
        │       │           └── Program.cs
        │       ├── Plugin/
        │       │   ├── Plugin.cryproject
        │       │   └── Code/
        │       │       └── Plugin/
        │       │           └── Program.cs
        │       ├── RollingBall/
        │       │   ├── Game.cryproject
        │       │   └── Code/
        │       │       └── Game/
        │       │           ├── Game.cs
        │       │           └── Program.cs
        │       └── ThirdPersonShooter/
        │           ├── Game.cryproject
        │           └── Code/
        │               └── Game/
        │                   ├── Game.cs
        │                   ├── Program.cs
        │                   └── EntityComponents/
        │                       ├── Animations/
        │                       │   └── CharacterAnimator.cs
        │                       └── Camera/
        │                           └── ViewCamera.cs
        ├── Launcher/
        │   ├── wscript
        │   ├── AndroidLauncher/
        │   │   ├── androidlauncher.waf_files
        │   │   ├── AndroidManifest.xml
        │   │   ├── CMakeLists.txt
        │   │   ├── CryEngineActivity.java
        │   │   ├── custom_rules.xml
        │   │   ├── Main.cpp
        │   │   ├── SDL.java
        │   │   ├── SDLActivity.java
        │   │   ├── SDLAudioManager.java
        │   │   ├── SDLControllerManager.java
        │   │   ├── StdAfx.cpp
        │   │   ├── StdAfx.h
        │   │   ├── strings.xml
        │   │   ├── wscript
        │   │   └── GooglePlay/
        │   │       ├── AndroidManifest.xml
        │   │       ├── CryAlarmReceiver.java
        │   │       ├── CryDownloaderActivity.java
        │   │       ├── CryDownloaderService.java
        │   │       ├── main.xml
        │   │       └── strings.xml
        │   ├── DedicatedLauncher/
        │   │   ├── CMakeLists.txt
        │   │   ├── launcher.rc
        │   │   ├── launcher.waf_files
        │   │   ├── LinkReorderSeed.txt
        │   │   ├── Main.cpp
        │   │   ├── resource.h
        │   │   ├── StdAfx.cpp
        │   │   ├── StdAfx.h
        │   │   ├── TrustData.manifest
        │   │   └── wscript
        │   ├── LinuxLauncher/
        │   │   ├── Assert.cpp
        │   │   ├── assert.h
        │   │   ├── assert_term.c
        │   │   ├── assert_term.waf_files
        │   │   ├── CMakeLists.txt
        │   │   ├── linuxlauncher.waf_files
        │   │   ├── Main.cpp
        │   │   ├── Makefile
        │   │   ├── Project.mk
        │   │   ├── StdAfx.cpp
        │   │   ├── StdAfx.h
        │   │   └── wscript
        │   ├── MacLauncher/
        │   │   ├── AppKitWrapper.h
        │   │   ├── AppKitWrapper.mm
        │   │   ├── assert_term.c
        │   │   ├── AssertDialog.xib
        │   │   ├── AssertDialogController.h
        │   │   ├── AssertDialogController.mm
        │   │   ├── CryEngine.sh
        │   │   ├── GameSDK.icns
        │   │   ├── Main.cpp
        │   │   ├── Project.mk
        │   │   ├── StdAfx.cpp
        │   │   └── StdAfx.h
        │   └── WindowsLauncher/
        │       ├── CMakeLists.txt
        │       ├── DPIAware.xml
        │       ├── launcher.rc
        │       ├── launcher.waf_files
        │       ├── LinkReorderSeed.txt
        │       ├── Main.cpp
        │       ├── resource.h
        │       ├── StdAfx.cpp
        │       ├── StdAfx.h
        │       ├── TrustInfo.manifest
        │       └── wscript
        ├── Libs/
        │   ├── wscript
        │   ├── alembic/
        │   │   ├── alembic.waf_files
        │   │   ├── CMakeLists.txt
        │   │   └── wscript
        │   ├── astc/
        │   │   ├── astc.h
        │   │   ├── astc.waf_files
        │   │   └── wscript
        │   ├── bigdigits/
        │   │   ├── bigdigits.waf_files
        │   │   ├── CMakeLists.txt
        │   │   └── wscript
        │   ├── cpprest/
        │   │   ├── CMakeLists.txt
        │   │   ├── cpprest.waf_files
        │   │   ├── cpprest_posix.waf_files
        │   │   ├── cpprest_win.waf_files
        │   │   └── wscript
        │   ├── crashrpt/
        │   │   ├── CMakeLists.txt
        │   │   ├── crashrpt.waf_files
        │   │   └── wscript
        │   ├── curl/
        │   │   ├── CMakeLists.txt
        │   │   ├── curl.waf_files
        │   │   ├── curl_config.h.in
        │   │   └── wscript
        │   ├── Detours/
        │   │   └── CMakeLists.txt
        │   ├── detours/
        │   │   ├── detours_win_x64.waf_files
        │   │   └── wscript
        │   ├── expat/
        │   │   ├── CMakeLists.txt
        │   │   ├── expat.waf_files
        │   │   └── wscript
        │   ├── freetype/
        │   │   ├── CMakeLists.txt
        │   │   ├── cry_ftmodule.h
        │   │   ├── cry_ftoption.h
        │   │   ├── freetype.waf_files
        │   │   └── wscript
        │   ├── hdf5/
        │   │   ├── CMakeLists.txt
        │   │   ├── h5build.bat
        │   │   ├── h5detect.waf_files
        │   │   ├── h5libsettings.waf_files
        │   │   ├── hdf5.waf_files
        │   │   ├── wscript
        │   │   ├── linux/
        │   │   │   ├── H5lib_settings.c
        │   │   │   ├── H5pubconf.h
        │   │   │   └── H5Tinit.c
        │   │   └── windows/
        │   │       ├── H5lib_settings.c
        │   │       ├── H5pubconf.h
        │   │       └── H5Tinit.c
        │   ├── ilmbase/
        │   │   ├── CMakeLists.txt
        │   │   ├── eLut.h
        │   │   ├── eLut.waf_files
        │   │   ├── ilmbase.waf_files
        │   │   ├── ilmbuild.bat
        │   │   ├── toFloat.waf_files
        │   │   └── wscript
        │   ├── jpeg/
        │   │   ├── CMakeLists.txt
        │   │   ├── jconfig.h
        │   │   ├── jpeg.waf_files
        │   │   └── wscript
        │   ├── jsmn/
        │   │   ├── CMakeLists.txt
        │   │   ├── jsmn.waf_files
        │   │   ├── jsmnutil.c
        │   │   ├── jsmnutil.h
        │   │   └── wscript
        │   ├── libHttpClient/
        │   │   └── CMakeLists.txt
        │   ├── lua/
        │   │   ├── CMakeLists.txt
        │   │   ├── lua.waf_files
        │   │   ├── luac.waf_files
        │   │   └── wscript
        │   ├── lz4/
        │   │   ├── CMakeLists.txt
        │   │   ├── lz4.waf_files
        │   │   └── wscript
        │   ├── lzma/
        │   │   ├── CMakeLists.txt
        │   │   ├── lzma.waf_files
        │   │   └── wscript
        │   ├── lzss/
        │   │   ├── CMakeLists.txt
        │   │   ├── lzss.waf_files
        │   │   └── wscript
        │   ├── md5/
        │   │   ├── CMakeLists.txt
        │   │   ├── md5.waf_files
        │   │   └── wscript
        │   ├── mikkelsen/
        │   │   ├── CMakeLists.txt
        │   │   ├── mikkelsen.waf_files
        │   │   └── wscript
        │   ├── oculus/
        │   │   ├── CMakeLists.txt
        │   │   ├── oculus.waf_files
        │   │   └── wscript
        │   ├── png16/
        │   │   ├── CMakeLists.txt
        │   │   ├── png16.waf_files
        │   │   ├── pnglibconf.h
        │   │   └── wscript
        │   ├── prt/
        │   │   ├── CMakeLists.txt
        │   │   ├── prt.waf_files
        │   │   └── wscript
        │   ├── qpOASES/
        │   │   └── CMakeLists.txt
        │   ├── SDL_mixer/
        │   │   ├── CMakeLists.txt
        │   │   ├── SDL_mixer.waf_files
        │   │   └── wscript
        │   ├── spirv-cross/
        │   │   ├── CMakeLists.txt
        │   │   ├── spirv-cross.waf_files
        │   │   └── wscript
        │   ├── strophe/
        │   │   ├── CMakeLists.txt
        │   │   ├── strophe.waf_files
        │   │   └── wscript
        │   ├── szip/
        │   │   ├── CMakeLists.txt
        │   │   ├── SZconfig.h
        │   │   ├── szip.waf_files
        │   │   └── wscript
        │   ├── tiff/
        │   │   ├── CMakeLists.txt
        │   │   ├── tiff.waf_files
        │   │   ├── wscript
        │   │   ├── include_linux/
        │   │   │   ├── tif_config.h
        │   │   │   └── tiffconf.h
        │   │   └── include_win/
        │   │       ├── tif_config.h
        │   │       └── tiffconf.h
        │   ├── tomcrypt/
        │   │   ├── CMakeLists.txt
        │   │   ├── mp_rand_custom.c
        │   │   ├── tomcrypt.waf_files
        │   │   └── wscript
        │   ├── vco/
        │   │   ├── CMakeLists.txt
        │   │   ├── vco.cpp
        │   │   ├── vco.h
        │   │   ├── vco.waf_files
        │   │   └── wscript
        │   └── zlib/
        │       ├── CMakeLists.txt
        │       ├── wscript
        │       └── zlib.waf_files
        └── Sandbox/
            ├── EditorInterface/
            │   ├── CMakeLists.txt
            │   ├── editorinterface.waf_files
            │   ├── IAIManager.h
            │   ├── IEditor.h
            │   ├── IEditorMaterial.h
            │   ├── ILevelEditor.h
            │   ├── IUndoManager.h
            │   ├── IUndoObject.h
            │   ├── IViewportManager.h
            │   └── wscript
            ├── EditorQt/
            │   ├── 2DViewport.cpp
            │   ├── 2DViewport.h
            │   ├── AboutDialog.cpp
            │   ├── AboutDialog.h
            │   ├── AlignTool.cpp
            │   ├── AlignTool.h
            │   ├── AnimationSerializer.cpp
            │   ├── AnimationSerializer.h
            │   ├── BackgroundScheduleManager.cpp
            │   ├── BackgroundScheduleManager.h
            │   ├── BackgroundTaskManager.cpp
            │   ├── BackgroundTaskManager.h
            │   ├── BaseLibrary.cpp
            │   ├── BaseLibrary.h
            │   ├── BaseLibraryDialog.cpp
            │   ├── BaseLibraryDialog.h
            │   ├── BaseLibraryItem.cpp
            │   ├── BaseLibraryItem.h
            │   ├── BaseLibraryManager.cpp
            │   ├── BaseLibraryManager.h
            │   ├── BaseObjectCreateTool.cpp
            │   ├── BaseObjectCreateTool.h
            │   ├── ClassFactory.cpp
            │   ├── ClassFactory.h
            │   ├── CMakeLists.txt
            │   ├── CryEdit.cpp
            │   ├── CryEdit.h
            │   ├── CryEditDoc.cpp
            │   ├── CryEditDoc.h
            │   ├── CryEditLiveCreate.rc
            │   ├── CustomResolutionDlg.cpp
            │   ├── CustomResolutionDlg.h
            │   ├── DataBaseDialog.cpp
            │   ├── DataBaseDialog.h
            │   ├── DatabaseFrameWnd.cpp
            │   ├── DatabaseFrameWnd.h
            │   ├── DocMultiArchive.h
            │   ├── DPIAware.xml
            │   ├── editor.waf_files
            │   ├── editor_manifest.xml
            │   ├── EditorCommands_Tools.cpp
            │   ├── EditorDefs.h
            │   ├── EditorFileMonitor.cpp
            │   ├── EditorFileMonitor.h
            │   ├── EditorVersion.rc
            │   ├── EditToolPanel.cpp
            │   ├── EditToolPanel.h
            │   ├── EntityProtLibDialog.cpp
            │   ├── EntityProtLibDialog.h
            │   ├── EntityPrototype.cpp
            │   ├── EntityPrototype.h
            │   ├── EntityPrototypeLibrary.cpp
            │   ├── EntityPrototypeLibrary.h
            │   ├── EntityPrototypeManager.cpp
            │   ├── EntityPrototypeManager.h
            │   ├── EntityScriptDialog.cpp
            │   ├── EntityScriptDialog.h
            │   ├── EnvironmentTool.cpp
            │   ├── FBXExporterDialog.cpp
            │   ├── FBXExporterDialog.h
            │   ├── GameEngine.cpp
            │   ├── GameEngine.h
            │   ├── GameExporter.cpp
            │   ├── GameExporter.h
            │   ├── GameResourcesExporter.cpp
            │   ├── GameResourcesExporter.h
            │   ├── GotoPositionDlg.cpp
            │   ├── GotoPositionDlg.h
            │   ├── IconManager.cpp
            │   ├── IconManager.h
            │   ├── IEditorImpl.cpp
            │   ├── IEditorImpl.h
            │   ├── LevelIndependentFileMan.cpp
            │   ├── LevelIndependentFileMan.h
            │   ├── LinkTool.cpp
            │   ├── LinkTool.h
            │   ├── LogFile.cpp
            │   ├── LogFile.h
            │   ├── LuaCommentParser.cpp
            │   ├── LuaCommentParser.h
            │   ├── MainThreadWorker.cpp
            │   ├── MainThreadWorker.h
            │   ├── ManipScene.cpp
            │   ├── ManipScene.h
            │   ├── MatEditPreviewDlg.cpp
            │   ├── MatEditPreviewDlg.h
            │   ├── MaterialSender.h
            │   ├── MinimapPanel.cpp
            │   ├── MinimapPanel.h
            │   ├── Mission.cpp
            │   ├── Mission.h
            │   ├── MissionProps.cpp
            │   ├── MissionProps.h
            │   ├── MissionScript.cpp
            │   ├── MissionScript.h
            │   ├── MissionSelectDialog.cpp
            │   ├── MissionSelectDialog.h
            │   ├── ObjectCloneTool.cpp
            │   ├── ObjectCloneTool.h
            │   ├── ObjectCreateTool.cpp
            │   ├── ObjectCreateTool.h
            │   ├── PanelDisplayRender.cpp
            │   ├── PanelDisplayRender.h
            │   ├── ParticleExporter.cpp
            │   ├── ParticleExporter.h
            │   ├── PhysTool.cpp
            │   ├── PhysTool.h
            │   ├── PlaygroundDockable.cpp
            │   ├── PlaygroundDockable.h
            │   ├── PluginManager.cpp
            │   ├── PluginManager.h
            │   ├── ProcessInfo.cpp
            │   ├── ProcessInfo.h
            │   ├── PythonEditorFuncs.cpp
            │   ├── ResizeResolutionDialog.cpp
            │   ├── ResizeResolutionDialog.h
            │   ├── ResourceCompilerHelpers.cpp
            │   ├── ResourceCompilerHelpers.h
            │   ├── ResourceSelectorHost.cpp
            │   ├── ResourceSelectorHost.h
            │   ├── SelectEntityClsDialog.cpp
            │   ├── SelectEntityClsDialog.h
            │   ├── Serialization.h
            │   ├── SessionData.cpp
            │   ├── SessionData.h
            │   ├── ShaderCache.cpp
            │   ├── ShaderCache.h
            │   ├── SHAllocator.cpp
            │   ├── SplashScreen.cpp
            │   ├── SplashScreen.h
            │   ├── StdAfx.cpp
            │   ├── StdAfx.h
            │   ├── SurfaceInfoPicker.cpp
            │   ├── SurfaceInfoPicker.h
            │   ├── SurfaceTypeValidator.cpp
            │   ├── SurfaceTypeValidator.h
            │   ├── TerrainDialog.cpp
            │   ├── TerrainDialog.h
            │   ├── TerrainFormulaDlg.cpp
            │   ├── TerrainFormulaDlg.h
            │   ├── TerrainLighting.h
            │   ├── TerrainMiniMapTool.cpp
            │   ├── TerrainMiniMapTool.h
            │   ├── TerrainMoveTool.cpp
            │   ├── TerrainMoveTool.h
            │   ├── TerrainTextureExport.cpp
            │   ├── TerrainTextureExport.h
            │   ├── TerrainTexturePainter.cpp
            │   ├── TerrainTexturePainter.h
            │   ├── TopRendererWnd.cpp
            │   ├── TopRendererWnd.h
            │   ├── TrackViewExportKeyTimeDlg.cpp
            │   ├── TrackViewExportKeyTimeDlg.h
            │   ├── TrackViewFBXImportPreviewDialog.cpp
            │   ├── TrackViewFBXImportPreviewDialog.h
            │   ├── TrustInfo.manifest
            │   ├── Version.h
            │   ├── ViewManager.cpp
            │   ├── ViewManager.h
            │   ├── wscript
            │   ├── AI/
            │   │   ├── AiBehavior.cpp
            │   │   ├── AiBehavior.h
            │   │   ├── AiBehaviorLibrary.cpp
            │   │   ├── AiBehaviorLibrary.h
            │   │   ├── AIManager.cpp
            │   │   ├── AIManager.h
            │   │   ├── AIMoveSimulation.cpp
            │   │   ├── AIMoveSimulation.h
            │   │   ├── CoverSurfaceManager.cpp
            │   │   ├── CoverSurfaceManager.h
            │   │   ├── EditorCommands_AI.cpp
            │   │   └── NavDataGeneration/
            │   │       ├── AICollision.h
            │   │       ├── AILog.cpp
            │   │       ├── AILog.h
            │   │       ├── CAISystem.h
            │   │       ├── Navigation.cpp
            │   │       ├── Navigation.h
            │   │       └── StdAfx.cpp
            │   ├── Alembic/
            │   │   ├── AlembicCompileDialog.cpp
            │   │   ├── AlembicCompileDialog.h
            │   │   ├── AlembicCompiler.cpp
            │   │   └── AlembicCompiler.h
            │   ├── AssetSystem/
            │   │   ├── AnimationType.cpp
            │   │   ├── AnimationType.h
            │   │   ├── CharacterDefinitionType.cpp
            │   │   ├── CharacterDefinitionType.h
            │   │   ├── GeometryCacheAssetType.cpp
            │   │   ├── GeometryCacheAssetType.h
            │   │   ├── LegacyAssetTypes.cpp
            │   │   ├── LegacyAssetTypes.h
            │   │   ├── MaterialType.cpp
            │   │   ├── MaterialType.h
            │   │   ├── MeshType.cpp
            │   │   ├── MeshType.h
            │   │   ├── SkeletonType.cpp
            │   │   ├── SkeletonType.h
            │   │   ├── SkinnedMeshType.cpp
            │   │   ├── SkinnedMeshType.h
            │   │   ├── SoundAssetType.cpp
            │   │   ├── SoundAssetType.h
            │   │   ├── TextureAssetType.cpp
            │   │   └── TextureAssetType.h
            │   ├── Commands/
            │   │   ├── CommandListDockable.cpp
            │   │   ├── CommandListDockable.h
            │   │   ├── CommandManager.cpp
            │   │   ├── CommandManager.h
            │   │   ├── EditorCommands_General.cpp
            │   │   ├── EditorCommands_Physics.cpp
            │   │   ├── KeybindEditor.cpp
            │   │   ├── KeybindEditor.h
            │   │   ├── PolledKeyManager.cpp
            │   │   ├── PolledKeyManager.h
            │   │   ├── PythonManager.cpp
            │   │   ├── PythonManager.h
            │   │   ├── QPythonAction.cpp
            │   │   └── QPythonAction.h
            │   ├── Controls/
            │   │   ├── ClampedSplitterWnd.cpp
            │   │   ├── ClampedSplitterWnd.h
            │   │   ├── FolderTreeCtrl.cpp
            │   │   ├── FolderTreeCtrl.h
            │   │   ├── ImageButton.cpp
            │   │   └── ImageButton.h
            │   ├── CustomActions/
            │   │   ├── CustomActionDialog.cpp
            │   │   ├── CustomActionDialog.h
            │   │   ├── CustomActionsEditorManager.cpp
            │   │   └── CustomActionsEditorManager.h
            │   ├── Dialogs/
            │   │   ├── DuplicatedObjectsHandlerDlg.cpp
            │   │   ├── DuplicatedObjectsHandlerDlg.h
            │   │   ├── PythonScriptsPanel.cpp
            │   │   ├── PythonScriptsPanel.h
            │   │   ├── ResourceCompilerDialog.cpp
            │   │   └── ResourceCompilerDialog.h
            │   ├── EditMode/
            │   │   ├── VertexSnappingModeTool.cpp
            │   │   └── VertexSnappingModeTool.h
            │   ├── Export/
            │   │   ├── ExportManager.cpp
            │   │   ├── ExportManager.h
            │   │   ├── OBJExporter.cpp
            │   │   ├── OBJExporter.h
            │   │   ├── OCMExporter.cpp
            │   │   ├── OCMExporter.h
            │   │   └── ScreenshotExporter.cpp
            │   ├── GameTokens/
            │   │   ├── GameTokenDialog.cpp
            │   │   ├── GameTokenDialog.h
            │   │   ├── GameTokenItem.cpp
            │   │   ├── GameTokenItem.h
            │   │   ├── GameTokenLibrary.cpp
            │   │   ├── GameTokenLibrary.h
            │   │   ├── GameTokenManager.cpp
            │   │   └── GameTokenManager.h
            │   ├── Geometry/
            │   │   ├── EdGeometry.cpp
            │   │   ├── EdGeometry.h
            │   │   ├── EdMesh.cpp
            │   │   ├── EdMesh.h
            │   │   ├── TriMesh.cpp
            │   │   └── TriMesh.h
            │   ├── HyperGraph/
            │   │   ├── FlowFilters.cpp
            │   │   ├── FlowFilters.h
            │   │   ├── FlowGraph.cpp
            │   │   ├── FlowGraph.h
            │   │   ├── FlowGraphHelpers.cpp
            │   │   ├── FlowGraphHelpers.h
            │   │   ├── FlowGraphManager.cpp
            │   │   ├── FlowGraphManager.h
            │   │   ├── FlowGraphMigrationHelper.cpp
            │   │   ├── FlowGraphMigrationHelper.h
            │   │   ├── FlowGraphModuleManager.cpp
            │   │   ├── FlowGraphModuleManager.h
            │   │   ├── FlowGraphNode.cpp
            │   │   ├── FlowGraphNode.h
            │   │   ├── FlowGraphPreferences.cpp
            │   │   ├── FlowGraphPreferences.h
            │   │   ├── FlowGraphVariables.cpp
            │   │   ├── FlowGraphVariables.h
            │   │   ├── HyperGraph.cpp
            │   │   ├── HyperGraph.h
            │   │   ├── HyperGraphManager.cpp
            │   │   ├── HyperGraphManager.h
            │   │   ├── HyperGraphNode.cpp
            │   │   ├── HyperGraphNode.h
            │   │   ├── IHyperGraph.h
            │   │   ├── Controls/
            │   │   │   ├── BreakPointsCtrl.cpp
            │   │   │   ├── BreakPointsCtrl.h
            │   │   │   ├── DragNDropListBox.cpp
            │   │   │   ├── DragNDropListBox.h
            │   │   │   ├── FlowGraphDebuggerEditor.cpp
            │   │   │   ├── FlowGraphDebuggerEditor.h
            │   │   │   ├── FlowGraphModuleDialogs.cpp
            │   │   │   ├── FlowGraphModuleDialogs.h
            │   │   │   ├── FlowGraphProperties.cpp
            │   │   │   ├── FlowGraphProperties.h
            │   │   │   ├── FlowGraphSearchCtrl.cpp
            │   │   │   ├── FlowGraphSearchCtrl.h
            │   │   │   ├── FlowGraphTokensDialogs.cpp
            │   │   │   ├── FlowGraphTokensDialogs.h
            │   │   │   ├── HyperGraphEditorNodeList.cpp
            │   │   │   ├── HyperGraphEditorNodeList.h
            │   │   │   ├── HyperGraphEditorTree.cpp
            │   │   │   ├── HyperGraphEditorTree.h
            │   │   │   ├── HyperGraphEditorWnd.cpp
            │   │   │   ├── HyperGraphEditorWnd.h
            │   │   │   ├── HyperGraphView.cpp
            │   │   │   ├── HyperGraphView.h
            │   │   │   ├── SelectGameTokenDialog.cpp
            │   │   │   └── SelectGameTokenDialog.h
            │   │   ├── NodePainter/
            │   │   │   ├── DisplayList.h
            │   │   │   ├── HyperNodePainter_BlackBox.cpp
            │   │   │   ├── HyperNodePainter_BlackBox.h
            │   │   │   ├── HyperNodePainter_Comment.cpp
            │   │   │   ├── HyperNodePainter_Comment.h
            │   │   │   ├── HyperNodePainter_CommentBox.cpp
            │   │   │   ├── HyperNodePainter_CommentBox.h
            │   │   │   ├── HyperNodePainter_Default.cpp
            │   │   │   ├── HyperNodePainter_Default.h
            │   │   │   ├── HyperNodePainter_QuickSearch.cpp
            │   │   │   ├── HyperNodePainter_QuickSearch.h
            │   │   │   └── IHyperNodePainter.h
            │   │   └── Nodes/
            │   │       ├── BlackBoxNode.cpp
            │   │       ├── BlackBoxNode.h
            │   │       ├── CommentBoxNode.cpp
            │   │       ├── CommentBoxNode.h
            │   │       ├── CommentNode.cpp
            │   │       ├── CommentNode.h
            │   │       ├── MissingNode.cpp
            │   │       ├── MissingNode.h
            │   │       ├── QuickSearchNode.cpp
            │   │       ├── QuickSearchNode.h
            │   │       ├── TrackEventNode.cpp
            │   │       └── TrackEventNode.h
            │   ├── Include/
            │   │   ├── IAnimationCompressionManager.h
            │   │   ├── IBackgroundScheduleManager.h
            │   │   ├── IDevManager.h
            │   │   ├── IRenderListener.h
            │   │   ├── RecursionLoopGuard.h
            │   │   ├── SandboxAPI.h
            │   │   └── Serialization/
            │   │       ├── GUID.h
            │   │       └── Decorators/
            │   │           └── EntityLink.h
            │   ├── IndirectLighting/
            │   │   ├── Raster.cpp
            │   │   ├── Raster.h
            │   │   ├── RasterMPMan.cpp
            │   │   ├── RasterMPMan.h
            │   │   ├── SHHeightmapAccessibility.cpp
            │   │   ├── SHHeightmapAccessibility.h
            │   │   ├── TerrainGIGen.cpp
            │   │   ├── TerrainGIGen.h
            │   │   ├── TerrainObjectMan.cpp
            │   │   ├── TerrainObjectMan.h
            │   │   └── Quadtree/
            │   │       ├── Quadtree.h
            │   │       ├── Quadtree.inl
            │   │       ├── QuadtreeHelper.h
            │   │       ├── QuadtreeNodeLeaf.inl
            │   │       └── QuadtreeUtilities.inl
            │   ├── LensFlareEditor/
            │   │   ├── ILensFlareListener.h
            │   │   ├── LensFlareAtomicList.cpp
            │   │   ├── LensFlareAtomicList.h
            │   │   ├── LensFlareEditor.cpp
            │   │   ├── LensFlareEditor.h
            │   │   ├── LensFlareElement.cpp
            │   │   ├── LensFlareElement.h
            │   │   ├── LensFlareElementTree.cpp
            │   │   ├── LensFlareElementTree.h
            │   │   ├── LensFlareItem.cpp
            │   │   ├── LensFlareItem.h
            │   │   ├── LensFlareItemTree.cpp
            │   │   ├── LensFlareItemTree.h
            │   │   ├── LensFlareLibrary.cpp
            │   │   ├── LensFlareLibrary.h
            │   │   ├── LensFlareLightEntityTree.cpp
            │   │   ├── LensFlareLightEntityTree.h
            │   │   ├── LensFlareManager.cpp
            │   │   ├── LensFlareManager.h
            │   │   ├── LensFlareReferenceTree.cpp
            │   │   ├── LensFlareReferenceTree.h
            │   │   ├── LensFlareUndo.cpp
            │   │   ├── LensFlareUndo.h
            │   │   ├── LensFlareUtil.cpp
            │   │   ├── LensFlareUtil.h
            │   │   ├── LensFlareView.cpp
            │   │   └── LensFlareView.h
            │   ├── LevelEditor/
            │   │   ├── EditorCommands_Level.cpp
            │   │   ├── EnvironmentPresetsWidget.cpp
            │   │   ├── EnvironmentPresetsWidget.h
            │   │   ├── LayerPicker.cpp
            │   │   ├── LayerPicker.h
            │   │   ├── LevelAssetType.cpp
            │   │   ├── LevelAssetType.h
            │   │   ├── LevelEditor.cpp
            │   │   ├── LevelEditor.h
            │   │   ├── LevelEditorViewport.cpp
            │   │   ├── LevelEditorViewport.h
            │   │   ├── LevelExplorer.cpp
            │   │   ├── LevelExplorer.h
            │   │   ├── LevelExplorerCommandHelper.cpp
            │   │   ├── LevelExplorerCommandHelper.h
            │   │   ├── LevelExplorerCommands.cpp
            │   │   ├── LevelFileUtils.cpp
            │   │   ├── LevelFileUtils.h
            │   │   ├── LevelFilterModel.cpp
            │   │   ├── LevelFilterModel.h
            │   │   ├── LevelLayerModel.cpp
            │   │   ├── LevelLayerModel.h
            │   │   ├── LevelModel.cpp
            │   │   ├── LevelModel.h
            │   │   ├── LevelModelsManager.cpp
            │   │   ├── LevelModelsManager.h
            │   │   ├── LevelSettings.cpp
            │   │   ├── LevelSettings.h
            │   │   ├── NewLevelDialog.cpp
            │   │   ├── NewLevelDialog.h
            │   │   ├── ObjectToPrefabAssetConverter.cpp
            │   │   ├── ObjectToPrefabAssetConverter.h
            │   │   ├── TagLocations.cpp
            │   │   └── TagLocations.h
            │   ├── LightmapCompiler/
            │   │   ├── SimpleTriangleRasterizer.cpp
            │   │   └── SimpleTriangleRasterizer.h
            │   ├── Mannequin/
            │   │   ├── FragmentEditor.cpp
            │   │   ├── FragmentEditor.h
            │   │   ├── FragmentEditorNodes.cpp
            │   │   ├── FragmentEditorNodes.h
            │   │   ├── FragmentSplitter.cpp
            │   │   ├── FragmentSplitter.h
            │   │   ├── FragmentTrack.cpp
            │   │   ├── FragmentTrack.h
            │   │   ├── ISequencerSystem.h
            │   │   ├── MannAdvancedPasteDialog.cpp
            │   │   ├── MannAdvancedPasteDialog.h
            │   │   ├── MannAnimDBEditorDialog.cpp
            │   │   ├── MannAnimDBEditorDialog.h
            │   │   ├── MannContextEditorDialog.cpp
            │   │   ├── MannContextEditorDialog.h
            │   │   ├── MannDebugOptionsDialog.cpp
            │   │   ├── MannDebugOptionsDialog.h
            │   │   ├── MannequinBase.cpp
            │   │   ├── MannequinBase.h
            │   │   ├── MannequinChangeMonitor.cpp
            │   │   ├── MannequinChangeMonitor.h
            │   │   ├── MannequinDialog.cpp
            │   │   ├── MannequinDialog.h
            │   │   ├── MannequinModelViewport.cpp
            │   │   ├── MannequinModelViewport.h
            │   │   ├── MannequinNodes.cpp
            │   │   ├── MannequinNodes.h
            │   │   ├── MannequinPlayback.cpp
            │   │   ├── MannequinPlayback.h
            │   │   ├── MannequinUtil.h
            │   │   ├── MannErrorReportDialog.cpp
            │   │   ├── MannErrorReportDialog.h
            │   │   ├── MannFileManager.cpp
            │   │   ├── MannFileManager.h
            │   │   ├── MannKeyPropertiesDlgFE.cpp
            │   │   ├── MannKeyPropertiesDlgFE.h
            │   │   ├── MannNewContextDialog.cpp
            │   │   ├── MannNewContextDialog.h
            │   │   ├── MannNewSubADBFilterDialog.cpp
            │   │   ├── MannNewSubADBFilterDialog.h
            │   │   ├── MannPreferences.cpp
            │   │   ├── MannPreferences.h
            │   │   ├── MannTagDefEditorDialog.cpp
            │   │   ├── MannTagDefEditorDialog.h
            │   │   ├── MannTagEditorDialog.cpp
            │   │   ├── MannTagEditorDialog.h
            │   │   ├── MannTransitionPicker.cpp
            │   │   ├── MannTransitionPicker.h
            │   │   ├── MannTransitionSettings.cpp
            │   │   ├── MannTransitionSettings.h
            │   │   ├── SequenceAnalyzerNodes.cpp
            │   │   ├── SequenceAnalyzerNodes.h
            │   │   ├── SequencerDopeSheet.cpp
            │   │   ├── SequencerDopeSheet.h
            │   │   ├── SequencerDopeSheetBase.cpp
            │   │   ├── SequencerDopeSheetBase.h
            │   │   ├── SequencerDopeSheetToolbar.cpp
            │   │   ├── SequencerDopeSheetToolbar.h
            │   │   ├── SequencerKeyPropertiesDlg.cpp
            │   │   ├── SequencerKeyPropertiesDlg.h
            │   │   ├── SequencerNode.cpp
            │   │   ├── SequencerNode.h
            │   │   ├── SequencerSequence.cpp
            │   │   ├── SequencerSequence.h
            │   │   ├── SequencerSplitter.cpp
            │   │   ├── SequencerSplitter.h
            │   │   ├── SequencerTrack.h
            │   │   ├── SequencerUndo.cpp
            │   │   ├── SequencerUndo.h
            │   │   ├── SequencerUtils.cpp
            │   │   ├── SequencerUtils.h
            │   │   ├── Controls/
            │   │   │   ├── FragmentBrowser.cpp
            │   │   │   ├── FragmentBrowser.h
            │   │   │   ├── FragmentEditorPage.cpp
            │   │   │   ├── FragmentEditorPage.h
            │   │   │   ├── MannDopeSheet.cpp
            │   │   │   ├── MannDopeSheet.h
            │   │   │   ├── MannequinEditorPage.cpp
            │   │   │   ├── MannequinEditorPage.h
            │   │   │   ├── MannImportBackgroundDialog.cpp
            │   │   │   ├── MannImportBackgroundDialog.h
            │   │   │   ├── PreviewerPage.cpp
            │   │   │   ├── PreviewerPage.h
            │   │   │   ├── SequenceBrowser.cpp
            │   │   │   ├── SequenceBrowser.h
            │   │   │   ├── TagSelectionControl.cpp
            │   │   │   ├── TagSelectionControl.h
            │   │   │   ├── TransitionBrowser.cpp
            │   │   │   ├── TransitionBrowser.h
            │   │   │   ├── TransitionEditorPage.cpp
            │   │   │   └── TransitionEditorPage.h
            │   │   └── Helper/
            │   │       ├── MannequinFileChangeWriter.cpp
            │   │       └── MannequinFileChangeWriter.h
            │   ├── Material/
            │   │   ├── Material.cpp
            │   │   ├── Material.h
            │   │   ├── MaterialBrowser.cpp
            │   │   ├── MaterialBrowser.h
            │   │   ├── MaterialDialog.cpp
            │   │   ├── MaterialDialog.h
            │   │   ├── MaterialFXGraphMan.cpp
            │   │   ├── MaterialFXGraphMan.h
            │   │   ├── MaterialHelpers.cpp
            │   │   ├── MaterialHelpers.h
            │   │   ├── MaterialImageListCtrl.cpp
            │   │   ├── MaterialImageListCtrl.h
            │   │   ├── MaterialLibrary.cpp
            │   │   ├── MaterialLibrary.h
            │   │   ├── MaterialManager.cpp
            │   │   ├── MaterialManager.h
            │   │   ├── MaterialPickTool.cpp
            │   │   ├── MaterialPickTool.h
            │   │   └── MaterialPythonFuncs.cpp
            │   ├── Objects/
            │   │   ├── AIAnchor.cpp
            │   │   ├── AIAnchor.h
            │   │   ├── AICoverSurface.cpp
            │   │   ├── AICoverSurface.h
            │   │   ├── AIReinforcementSpot.cpp
            │   │   ├── AIReinforcementSpot.h
            │   │   ├── AIWave.cpp
            │   │   ├── AIWave.h
            │   │   ├── AreaBox.cpp
            │   │   ├── AreaBox.h
            │   │   ├── AreaSphere.cpp
            │   │   ├── AreaSphere.h
            │   │   ├── BrushObject.cpp
            │   │   ├── BrushObject.h
            │   │   ├── CameraObject.cpp
            │   │   ├── CameraObject.h
            │   │   ├── CharAttachHelper.cpp
            │   │   ├── CharAttachHelper.h
            │   │   ├── CloudObject.cpp
            │   │   ├── CloudObject.h
            │   │   ├── CollisionFilteringProperties.cpp
            │   │   ├── CollisionFilteringProperties.h
            │   │   ├── DecalObject.cpp
            │   │   ├── DecalObject.h
            │   │   ├── DistanceCloudObject.cpp
            │   │   ├── DistanceCloudObject.h
            │   │   ├── EditorCommands_BaseObject.cpp
            │   │   ├── EditorCommands_Entity.cpp
            │   │   ├── EditorCommands_Group.cpp
            │   │   ├── EditorCommands_Layer.cpp
            │   │   ├── EditorCommands_PrefabObject.cpp
            │   │   ├── EditorCommands_Selection.cpp
            │   │   ├── EntityObject.cpp
            │   │   ├── EntityObject.h
            │   │   ├── EntityObjectUndo.h
            │   │   ├── EntityObjectWithAnimatedMeshComponent.cpp
            │   │   ├── EntityObjectWithAnimatedMeshComponent.h
            │   │   ├── EntityObjectWithComponent.cpp
            │   │   ├── EntityObjectWithComponent.h
            │   │   ├── EntityObjectWithStaticMeshComponent.cpp
            │   │   ├── EntityObjectWithStaticMeshComponent.h
            │   │   ├── EntityScript.cpp
            │   │   ├── EntityScript.h
            │   │   ├── EnvironmentProbeObject.cpp
            │   │   ├── EnvironmentProbeObject.h
            │   │   ├── GeomEntity.cpp
            │   │   ├── GeomEntity.h
            │   │   ├── GravityVolumeObject.cpp
            │   │   ├── GravityVolumeObject.h
            │   │   ├── Group.cpp
            │   │   ├── Group.h
            │   │   ├── GuidCollisionResolver.cpp
            │   │   ├── GuidCollisionResolver.h
            │   │   ├── MiscEntities.cpp
            │   │   ├── MiscEntities.h
            │   │   ├── ObjectLayer.cpp
            │   │   ├── ObjectLayer.h
            │   │   ├── ObjectLayerManager.cpp
            │   │   ├── ObjectLayerManager.h
            │   │   ├── ObjectManager.cpp
            │   │   ├── ObjectManager.h
            │   │   ├── ObjectPhysicsManager.cpp
            │   │   ├── ObjectPhysicsManager.h
            │   │   ├── ParticleEffectObject.cpp
            │   │   ├── ParticleEffectObject.h
            │   │   ├── PrefabObject.cpp
            │   │   ├── PrefabObject.h
            │   │   ├── PrefabPicker.cpp
            │   │   ├── PrefabPicker.h
            │   │   ├── ProtEntityObject.cpp
            │   │   ├── ProtEntityObject.h
            │   │   ├── ProximityTriggerObject.cpp
            │   │   ├── ProximityTriggerObject.h
            │   │   ├── RefPicture.cpp
            │   │   ├── RefPicture.h
            │   │   ├── RiverObject.cpp
            │   │   ├── RiverObject.h
            │   │   ├── RoadObject.cpp
            │   │   ├── RoadObject.h
            │   │   ├── RopeObject.cpp
            │   │   ├── RopeObject.h
            │   │   ├── SafeObjectsArray.cpp
            │   │   ├── SafeObjectsArray.h
            │   │   ├── SelectionGroup.cpp
            │   │   ├── SelectionGroup.h
            │   │   ├── ShapeObject.cpp
            │   │   ├── ShapeObject.h
            │   │   ├── SimpleEntity.cpp
            │   │   ├── SimpleEntity.h
            │   │   ├── SplineDistributor.cpp
            │   │   ├── SplineDistributor.h
            │   │   ├── SplineObject.cpp
            │   │   ├── SplineObject.h
            │   │   ├── SubObjSelection.cpp
            │   │   ├── SubObjSelection.h
            │   │   ├── TagComment.cpp
            │   │   ├── TagComment.h
            │   │   ├── TagPoint.cpp
            │   │   ├── TagPoint.h
            │   │   ├── UndoEntityParam.cpp
            │   │   ├── UndoEntityParam.h
            │   │   ├── UndoEntityProperty.cpp
            │   │   ├── UndoEntityProperty.h
            │   │   ├── VisAreaShapeObject.cpp
            │   │   ├── VisAreaShapeObject.h
            │   │   ├── WaterShapeObject.cpp
            │   │   ├── WaterShapeObject.h
            │   │   ├── WaterWaveObject.cpp
            │   │   └── WaterWaveObject.h
            │   ├── Panels/
            │   │   ├── ObjectBrowser.cpp
            │   │   ├── ObjectBrowser.h
            │   │   ├── ObjectCreateToolPanel.cpp
            │   │   ├── ObjectCreateToolPanel.h
            │   │   ├── ObjectCreateTreeWidget.cpp
            │   │   └── ObjectCreateTreeWidget.h
            │   ├── Particles/
            │   │   ├── ParticleDialog.cpp
            │   │   ├── ParticleDialog.h
            │   │   ├── ParticleItem.cpp
            │   │   ├── ParticleItem.h
            │   │   ├── ParticleLibrary.cpp
            │   │   ├── ParticleLibrary.h
            │   │   ├── ParticleManager.cpp
            │   │   └── ParticleManager.h
            │   ├── Prefabs/
            │   │   ├── PrefabEvents.cpp
            │   │   ├── PrefabEvents.h
            │   │   ├── PrefabItem.cpp
            │   │   ├── PrefabItem.h
            │   │   ├── PrefabLibrary.cpp
            │   │   ├── PrefabLibrary.h
            │   │   ├── PrefabManager.cpp
            │   │   └── PrefabManager.h
            │   ├── ProjectManagement/
            │   │   ├── EditorCommands_Project.cpp
            │   │   ├── Utils.cpp
            │   │   ├── Utils.h
            │   │   ├── Data/
            │   │   │   ├── ProjectManager.cpp
            │   │   │   ├── ProjectManager.h
            │   │   │   ├── TemplateManager.cpp
            │   │   │   └── TemplateManager.h
            │   │   ├── Model/
            │   │   │   ├── ProjectsModel.cpp
            │   │   │   ├── ProjectsModel.h
            │   │   │   ├── SubIconContainer.cpp
            │   │   │   ├── SubIconContainer.h
            │   │   │   ├── TemplatesModel.cpp
            │   │   │   └── TemplatesModel.h
            │   │   └── UI/
            │   │       ├── CreateProjectPanel.cpp
            │   │       ├── CreateProjectPanel.h
            │   │       ├── OpenProjectPanel.cpp
            │   │       ├── OpenProjectPanel.h
            │   │       ├── SelectProjectDialog.cpp
            │   │       └── SelectProjectDialog.h
            │   ├── QT/
            │   │   ├── PythonUIActionBinds.cpp
            │   │   ├── QMainFrameMenuBar.cpp
            │   │   ├── QMainFrameMenuBar.h
            │   │   ├── QtMain.cpp
            │   │   ├── QtMainFrame.cpp
            │   │   ├── QtMainFrame.h
            │   │   ├── QtMainFrameWidgets.h
            │   │   ├── QToolTabManager.cpp
            │   │   ├── QToolTabManager.h
            │   │   ├── TraySearchBox.cpp
            │   │   ├── TraySearchBox.h
            │   │   └── Widgets/
            │   │       ├── QEditToolButton.cpp
            │   │       ├── QEditToolButton.h
            │   │       ├── QPreviewWidget.cpp
            │   │       ├── QPreviewWidget.h
            │   │       ├── QViewportHeader.cpp
            │   │       └── QViewportHeader.h
            │   ├── res/
            │   │   ├── 4WAY01.CUR
            │   │   ├── arr_addkey.cur
            │   │   ├── arrow.cur
            │   │   ├── arrow_down.cur
            │   │   ├── arrow_downright.cur
            │   │   ├── arrow_up.cur
            │   │   ├── arrow_upright.cur
            │   │   ├── arrowcop.cur
            │   │   ├── CryEdit.rc2
            │   │   ├── cur00001.cur
            │   │   ├── cur00002.cur
            │   │   ├── cur00003.cur
            │   │   ├── cur00004.cur
            │   │   ├── cur00005.cur
            │   │   ├── cursor1.cur
            │   │   ├── cursor2.cur
            │   │   ├── Cursor_2.cur
            │   │   ├── Editor.qrc
            │   │   ├── EulaDialog.rtf
            │   │   ├── handDrag.cur
            │   │   ├── hit.cur
            │   │   ├── leftright.cur
            │   │   ├── Mouse.cur
            │   │   ├── nodrop.cur
            │   │   ├── object_move.cur
            │   │   ├── object_rotate.cur
            │   │   ├── object_scale.cur
            │   │   ├── phys_fork.cur
            │   │   ├── phys_hit.cur
            │   │   ├── phys_pin.cur
            │   │   ├── phys_pinch.cur
            │   │   ├── phys_pull.cur
            │   │   ├── pick_cursor.cur
            │   │   ├── pointer_.cur
            │   │   ├── pointer_flatten.cur
            │   │   ├── pointer_getheight.cur
            │   │   ├── pointer_link.cur
            │   │   ├── pointer_linknow.cur
            │   │   ├── pointer_minus.cur
            │   │   ├── pointer_plus.cur
            │   │   ├── pointer_smooth.cur
            │   │   ├── pointer_so_sel_plus.cur
            │   │   ├── pointer_so_select.cur
            │   │   ├── pointerDragItem.cur
            │   │   ├── pointerHit.cur
            │   │   └── scissors.cur
            │   ├── Script/
            │   │   ├── ScriptEnvironment.cpp
            │   │   └── ScriptEnvironment.h
            │   ├── Serialization/
            │   │   ├── PropertyRowEntityLink.cpp
            │   │   ├── PropertyRowEntityLink.h
            │   │   ├── PropertyRowPrefabLink.cpp
            │   │   ├── PropertyRowPrefabLink.h
            │   │   ├── VariableIArchive.cpp
            │   │   ├── VariableIArchive.h
            │   │   ├── VariableOArchive.cpp
            │   │   └── VariableOArchive.h
            │   ├── Terrain/
            │   │   ├── GenerationParam.cpp
            │   │   ├── GenerationParam.h
            │   │   ├── Heightmap.cpp
            │   │   ├── Heightmap.h
            │   │   ├── Layer.cpp
            │   │   ├── Layer.h
            │   │   ├── Noise.cpp
            │   │   ├── Noise.h
            │   │   ├── RGBLayer.cpp
            │   │   ├── RGBLayer.h
            │   │   ├── SurfaceType.cpp
            │   │   ├── SurfaceType.h
            │   │   ├── TerrainBeachGen.cpp
            │   │   ├── TerrainBeachGen.h
            │   │   ├── TerrainBrushTool.cpp
            │   │   ├── TerrainBrushTool.h
            │   │   ├── TerrainCommands.cpp
            │   │   ├── TerrainCommon.h
            │   │   ├── TerrainDebugger.cpp
            │   │   ├── TerrainEditor.cpp
            │   │   ├── TerrainEditor.h
            │   │   ├── TerrainGrid.cpp
            │   │   ├── TerrainGrid.h
            │   │   ├── TerrainLayerModel.cpp
            │   │   ├── TerrainLayerModel.h
            │   │   ├── TerrainLayerPanel.cpp
            │   │   ├── TerrainLayerPanel.h
            │   │   ├── TerrainLayerTexGen.cpp
            │   │   ├── TerrainLayerTexGen.h
            │   │   ├── TerrainLayerUndoObject.cpp
            │   │   ├── TerrainLayerUndoObject.h
            │   │   ├── TerrainLayerView.cpp
            │   │   ├── TerrainLayerView.h
            │   │   ├── TerrainLightGen.cpp
            │   │   ├── TerrainLightGen.h
            │   │   ├── TerrainManager.cpp
            │   │   ├── TerrainManager.h
            │   │   ├── TerrainSculptPanel.cpp
            │   │   ├── TerrainSculptPanel.h
            │   │   ├── TerrainTexGen.cpp
            │   │   ├── TerrainTexGen.h
            │   │   ├── TextureCompression.cpp
            │   │   ├── TextureCompression.h
            │   │   ├── Dialogs/
            │   │   │   ├── ResizeTerrainDialog.cpp
            │   │   │   ├── ResizeTerrainDialog.h
            │   │   │   ├── ResizeTerrainTextureDialog.cpp
            │   │   │   └── ResizeTerrainTextureDialog.h
            │   │   ├── Sky Accessibility/
            │   │   │   ├── HeightmapAccessibility.h
            │   │   │   └── HorizonTracker.h
            │   │   └── Ui/
            │   │       ├── GenerateHeightmapUi.cpp
            │   │       ├── GenerateHeightmapUi.h
            │   │       ├── GenerateTerrainTextureUi.cpp
            │   │       ├── GenerateTerrainTextureUi.h
            │   │       ├── TerrainTextureDimensionsUi.cpp
            │   │       └── TerrainTextureDimensionsUi.h
            │   ├── Test/
            │   │   └── PythonTest.cpp
            │   ├── UI/
            │   │   ├── UIManager.cpp
            │   │   └── UIManager.h
            │   ├── Undo/
            │   │   ├── CommandHistory.cpp
            │   │   ├── CommandHistory.h
            │   │   ├── Undo.cpp
            │   │   └── Undo.h
            │   ├── Util/
            │   │   ├── ArcBall.cpp
            │   │   ├── ArcBall.h
            │   │   ├── AutoLogTime.cpp
            │   │   ├── AutoLogTime.h
            │   │   ├── bitarray.h
            │   │   ├── BoostPythonHelpers.cpp
            │   │   ├── BoostPythonHelpers.h
            │   │   ├── CubemapUtils.cpp
            │   │   ├── CubemapUtils.h
            │   │   ├── DynamicArray2D.cpp
            │   │   ├── DynamicArray2D.h
            │   │   ├── EditorAutoLevelLoadTest.cpp
            │   │   ├── EditorAutoLevelLoadTest.h
            │   │   ├── FileChangeMonitor.cpp
            │   │   ├── FileChangeMonitor.h
            │   │   ├── FileEnum.cpp
            │   │   ├── FileEnum.h
            │   │   ├── ImagePainter.cpp
            │   │   ├── ImagePainter.h
            │   │   ├── KDTree.cpp
            │   │   ├── KDTree.h
            │   │   ├── Mailer.cpp
            │   │   ├── Mailer.h
            │   │   ├── Observable.h
            │   │   ├── Ruler.cpp
            │   │   ├── Ruler.h
            │   │   ├── RulerPoint.cpp
            │   │   ├── RulerPoint.h
            │   │   ├── Triangulate.cpp
            │   │   ├── Triangulate.h
            │   │   ├── VariableTypeInfo.h
            │   │   ├── XmlTemplate.cpp
            │   │   └── XmlTemplate.h
            │   └── Vegetation/
            │       ├── VegetationDragDropData.cpp
            │       ├── VegetationDragDropData.h
            │       ├── VegetationEditor.cpp
            │       ├── VegetationEditor.h
            │       ├── VegetationEraseTool.cpp
            │       ├── VegetationEraseTool.h
            │       ├── VegetationMap.cpp
            │       ├── VegetationMap.h
            │       ├── VegetationModel.cpp
            │       ├── VegetationModel.h
            │       ├── VegetationObject.cpp
            │       ├── VegetationObject.h
            │       ├── VegetationPaintTool.cpp
            │       ├── VegetationPaintTool.h
            │       ├── VegetationPlaceTool.cpp
            │       ├── VegetationPlaceTool.h
            │       ├── VegetationSelectTool.cpp
            │       ├── VegetationSelectTool.h
            │       ├── VegetationTreeView.cpp
            │       └── VegetationTreeView.h
            ├── Libs/
            │   ├── wscript
            │   ├── CryQt/
            │   │   ├── CMakeLists.txt
            │   │   ├── CryIcon.cpp
            │   │   ├── CryIcon.h
            │   │   ├── cryqt.waf_files
            │   │   ├── CryQtAPI.h
            │   │   ├── QCollapsibleFrame.cpp
            │   │   ├── QCollapsibleFrame.h
            │   │   ├── QRollupBar.cpp
            │   │   ├── QRollupBar.h
            │   │   ├── QScrollableBox.cpp
            │   │   ├── QScrollableBox.h
            │   │   ├── stdafx.cpp
            │   │   ├── stdafx.h
            │   │   ├── wscript
            │   │   ├── QToolWindowManager/
            │   │   │   ├── IToolWindowArea.h
            │   │   │   ├── IToolWindowDragHandler.h
            │   │   │   ├── IToolWindowWrapper.h
            │   │   │   ├── QCustomWindowFrame.cpp
            │   │   │   ├── QCustomWindowFrame.h
            │   │   │   ├── QToolWindowArea.cpp
            │   │   │   ├── QToolWindowArea.h
            │   │   │   ├── QToolWindowCustomWrapper.cpp
            │   │   │   ├── QToolWindowCustomWrapper.h
            │   │   │   ├── QToolWindowDragHandlerDropTargets.cpp
            │   │   │   ├── QToolWindowDragHandlerDropTargets.h
            │   │   │   ├── QToolWindowDragHandlerNinePatch.cpp
            │   │   │   ├── QToolWindowDragHandlerNinePatch.h
            │   │   │   ├── QToolWindowManager.cpp
            │   │   │   ├── QToolWindowManager.h
            │   │   │   ├── QToolWindowManager.qrc
            │   │   │   ├── QToolWindowManagerCommon.cpp
            │   │   │   ├── QToolWindowManagerCommon.h
            │   │   │   ├── QToolWindowRollupBarArea.cpp
            │   │   │   ├── QToolWindowRollupBarArea.h
            │   │   │   ├── QToolWindowTabBar.cpp
            │   │   │   ├── QToolWindowTabBar.h
            │   │   │   ├── QToolWindowWrapper.cpp
            │   │   │   └── QToolWindowWrapper.h
            │   │   └── ShibokenWrapper/
            │   │       ├── CMakeLists.txt
            │   │       ├── CryQt.py
            │   │       ├── global.h
            │   │       ├── typesystem_cryqt.xml
            │   │       └── glue/
            │   │           └── itoolwindowarea_glue.cpp
            │   ├── CrySubstance/
            │   │   ├── CMakeLists.txt
            │   │   ├── crysubstance.waf_files
            │   │   ├── CrySubstanceAPI.h
            │   │   ├── ISubstanceInstanceRenderer.h
            │   │   ├── ISubstanceManager.h
            │   │   ├── RCConfigParser.inl
            │   │   ├── SerializationSubstanceEnums.inl
            │   │   ├── StdAfx.cpp
            │   │   ├── StdAfx.h
            │   │   ├── SubstanceCommon.cpp
            │   │   ├── SubstanceCommon.h
            │   │   ├── SubstanceManager.cpp
            │   │   ├── SubstanceManager.h
            │   │   ├── SubstancePreset.cpp
            │   │   ├── SubstancePreset.h
            │   │   └── wscript
            │   └── SandboxPython/
            │       ├── CMakeLists.txt
            │       └── main.cpp
            └── Plugins/
                ├── 3DConnexionPlugin/
                │   ├── 3dconnexion.waf_files
                │   ├── 3DConnexionDriver.cpp
                │   ├── 3DConnexionDriver.h
                │   ├── CMakeLists.txt
                │   ├── main.cpp
                │   ├── StdAfx.cpp
                │   ├── StdAfx.h
                │   └── wscript
                ├── CryDesigner/
                │   ├── CMakeLists.txt
                │   ├── CryDesigner.rc
                │   ├── crydesigner.waf_files
                │   ├── DesignerEditor.cpp
                │   ├── DesignerEditor.h
                │   ├── DesignerSession.cpp
                │   ├── DesignerSession.h
                │   ├── main.cpp
                │   ├── Resource.h
                │   ├── StdAfx.cpp
                │   ├── StdAfx.h
                │   ├── ToolFactory.h
                │   ├── wscript
                │   ├── Core/
                │   │   ├── Boolean3D.cpp
                │   │   ├── BSPTree2D.cpp
                │   │   ├── BSPTree2D.h
                │   │   ├── BSPTree3D.cpp
                │   │   ├── BSPTree3D.h
                │   │   ├── Common.cpp
                │   │   ├── Common.h
                │   │   ├── Convexes.h
                │   │   ├── Declaration.h
                │   │   ├── EdgesSharpnessManager.cpp
                │   │   ├── EdgesSharpnessManager.h
                │   │   ├── FlexibleMesh.cpp
                │   │   ├── FlexibleMesh.h
                │   │   ├── HalfEdgeMesh.cpp
                │   │   ├── HalfEdgeMesh.h
                │   │   ├── Helper.cpp
                │   │   ├── Helper.h
                │   │   ├── Line.h
                │   │   ├── LoopPolygons.cpp
                │   │   ├── LoopPolygons.h
                │   │   ├── Model.cpp
                │   │   ├── Model.h
                │   │   ├── ModelCompiler.cpp
                │   │   ├── ModelCompiler.h
                │   │   ├── ModelDB.cpp
                │   │   ├── ModelDB.h
                │   │   ├── Plane.h
                │   │   ├── Polygon.cpp
                │   │   ├── Polygon.h
                │   │   ├── PolygonDecomposer.cpp
                │   │   ├── PolygonDecomposer.h
                │   │   ├── PolygonMesh.cpp
                │   │   ├── PolygonMesh.h
                │   │   ├── SmoothingGroup.cpp
                │   │   ├── SmoothingGroup.h
                │   │   ├── SmoothingGroupManager.cpp
                │   │   ├── SmoothingGroupManager.h
                │   │   ├── Subdivision.cpp
                │   │   ├── Subdivision.h
                │   │   ├── UVIsland.cpp
                │   │   ├── UVIsland.h
                │   │   ├── UVIslandManager.cpp
                │   │   └── UVIslandManager.h
                │   ├── Objects/
                │   │   ├── AreaSolidObject.cpp
                │   │   ├── AreaSolidObject.h
                │   │   ├── ClipVolumeObject.cpp
                │   │   ├── ClipVolumeObject.h
                │   │   ├── DesignerBaseObject.h
                │   │   ├── DesignerBaseObject_Impl.h
                │   │   ├── DesignerObject.cpp
                │   │   └── DesignerObject.h
                │   ├── Scripts/
                │   │   ├── BasicScripts.cpp
                │   │   ├── BasicScripts.h
                │   │   ├── EditScripts.cpp
                │   │   ├── ModifyScripts.cpp
                │   │   ├── SelectionScripts.cpp
                │   │   └── ShapeScripts.cpp
                │   ├── Tools/
                │   │   ├── AreaSolidTool.cpp
                │   │   ├── AreaSolidTool.h
                │   │   ├── BaseTool.cpp
                │   │   ├── BaseTool.h
                │   │   ├── ClipVolumeTool.cpp
                │   │   ├── ClipVolumeTool.h
                │   │   ├── ToolCommon.cpp
                │   │   ├── ToolCommon.h
                │   │   ├── Edit/
                │   │   │   ├── CollapseTool.cpp
                │   │   │   ├── CollapseTool.h
                │   │   │   ├── CopyTool.cpp
                │   │   │   ├── CopyTool.h
                │   │   │   ├── ExtrudeEdgeTool.cpp
                │   │   │   ├── ExtrudeEdgeTool.h
                │   │   │   ├── ExtrudeMultipleTool.cpp
                │   │   │   ├── ExtrudeMultipleTool.h
                │   │   │   ├── ExtrudeTool.cpp
                │   │   │   ├── ExtrudeTool.h
                │   │   │   ├── FillTool.cpp
                │   │   │   ├── FillTool.h
                │   │   │   ├── FlipTool.cpp
                │   │   │   ├── FlipTool.h
                │   │   │   ├── MergeTool.cpp
                │   │   │   ├── MergeTool.h
                │   │   │   ├── OffsetTool.cpp
                │   │   │   ├── OffsetTool.h
                │   │   │   ├── RemoveDoublesTool.cpp
                │   │   │   ├── RemoveDoublesTool.h
                │   │   │   ├── RemoveTool.cpp
                │   │   │   ├── RemoveTool.h
                │   │   │   ├── SeparateTool.cpp
                │   │   │   ├── SeparateTool.h
                │   │   │   ├── WeldTool.cpp
                │   │   │   └── WeldTool.h
                │   │   ├── Misc/
                │   │   │   ├── ExportTool.cpp
                │   │   │   ├── ExportTool.h
                │   │   │   ├── HidePolygonTool.cpp
                │   │   │   ├── HidePolygonTool.h
                │   │   │   ├── Pivot2BottomTool.cpp
                │   │   │   ├── Pivot2BottomTool.h
                │   │   │   ├── ResetXFormTool.cpp
                │   │   │   ├── ResetXFormTool.h
                │   │   │   ├── SnapToGridTool.cpp
                │   │   │   └── SnapToGridTool.h
                │   │   ├── Modify/
                │   │   │   ├── BevelTool.cpp
                │   │   │   ├── BevelTool.h
                │   │   │   ├── BooleanTool.cpp
                │   │   │   ├── BooleanTool.h
                │   │   │   ├── CloneTool.cpp
                │   │   │   ├── CloneTool.h
                │   │   │   ├── LatheTool.cpp
                │   │   │   ├── LatheTool.h
                │   │   │   ├── LoopCutTool.cpp
                │   │   │   ├── LoopCutTool.h
                │   │   │   ├── MagnetTool.cpp
                │   │   │   ├── MagnetTool.h
                │   │   │   ├── MirrorTool.cpp
                │   │   │   ├── MirrorTool.h
                │   │   │   ├── SliceTool.cpp
                │   │   │   ├── SliceTool.h
                │   │   │   ├── SubdivisionTool.cpp
                │   │   │   └── SubdivisionTool.h
                │   │   ├── Select/
                │   │   │   ├── InvertSelectionTool.cpp
                │   │   │   ├── InvertSelectionTool.h
                │   │   │   ├── LoopSelectionTool.cpp
                │   │   │   ├── LoopSelectionTool.h
                │   │   │   ├── MovePipeline.cpp
                │   │   │   ├── MovePipeline.h
                │   │   │   ├── MoveTool.cpp
                │   │   │   ├── MoveTool.h
                │   │   │   ├── PivotTool.cpp
                │   │   │   ├── PivotTool.h
                │   │   │   ├── RingSelectionTool.cpp
                │   │   │   ├── RingSelectionTool.h
                │   │   │   ├── SelectAllNoneTool.cpp
                │   │   │   ├── SelectAllNoneTool.h
                │   │   │   ├── SelectConnectedTool.cpp
                │   │   │   ├── SelectConnectedTool.h
                │   │   │   ├── SelectGrowTool.cpp
                │   │   │   ├── SelectGrowTool.h
                │   │   │   ├── SelectTool.cpp
                │   │   │   └── SelectTool.h
                │   │   ├── Shape/
                │   │   │   ├── BoxTool.cpp
                │   │   │   ├── BoxTool.h
                │   │   │   ├── ConeTool.cpp
                │   │   │   ├── ConeTool.h
                │   │   │   ├── CubeEditor.cpp
                │   │   │   ├── CubeEditor.h
                │   │   │   ├── CurveTool.cpp
                │   │   │   ├── CurveTool.h
                │   │   │   ├── CylinderTool.cpp
                │   │   │   ├── CylinderTool.h
                │   │   │   ├── DiscTool.cpp
                │   │   │   ├── DiscTool.h
                │   │   │   ├── PolylineTool.cpp
                │   │   │   ├── PolylineTool.h
                │   │   │   ├── RectangleTool.cpp
                │   │   │   ├── RectangleTool.h
                │   │   │   ├── ShapeTool.cpp
                │   │   │   ├── ShapeTool.h
                │   │   │   ├── SphereTool.cpp
                │   │   │   ├── SphereTool.h
                │   │   │   ├── StairProfileTool.cpp
                │   │   │   ├── StairProfileTool.h
                │   │   │   ├── StairTool.cpp
                │   │   │   └── StairTool.h
                │   │   └── Surface/
                │   │       ├── SmoothingGroupTool.cpp
                │   │       ├── SmoothingGroupTool.h
                │   │       ├── UVMappingTool.cpp
                │   │       └── UVMappingTool.h
                │   ├── UIs/
                │   │   ├── CubeEditorPanel.cpp
                │   │   ├── CubeEditorPanel.h
                │   │   ├── DesignerDockable.cpp
                │   │   ├── DesignerDockable.h
                │   │   ├── DesignerPanel.cpp
                │   │   ├── DesignerPanel.h
                │   │   ├── DesignerSubPanel.cpp
                │   │   ├── DesignerSubPanel.h
                │   │   ├── PropertyTreePanel.h
                │   │   ├── SmoothingGroupPanel.cpp
                │   │   ├── SmoothingGroupPanel.h
                │   │   ├── SubdivisionPanel.cpp
                │   │   ├── SubdivisionPanel.h
                │   │   ├── UICommon.cpp
                │   │   └── UICommon.h
                │   ├── Util/
                │   │   ├── ArgumentModel.cpp
                │   │   ├── ArgumentModel.h
                │   │   ├── Converter.cpp
                │   │   ├── Converter.h
                │   │   ├── DesignerSettings.cpp
                │   │   ├── DesignerSettings.h
                │   │   ├── Display.cpp
                │   │   ├── Display.h
                │   │   ├── ElementSet.cpp
                │   │   ├── ElementSet.h
                │   │   ├── ExcludedEdgeManager.cpp
                │   │   ├── ExcludedEdgeManager.h
                │   │   ├── Exporter.cpp
                │   │   ├── Exporter.h
                │   │   ├── ExtrusionSnappingHelper.cpp
                │   │   ├── ExtrusionSnappingHelper.h
                │   │   ├── HeightManipulator.cpp
                │   │   ├── HeightManipulator.h
                │   │   ├── OffsetManipulator.cpp
                │   │   ├── OffsetManipulator.h
                │   │   ├── PrimitiveShape.cpp
                │   │   ├── PrimitiveShape.h
                │   │   ├── SpotManager.cpp
                │   │   ├── SpotManager.h
                │   │   ├── Undo.cpp
                │   │   ├── Undo.h
                │   │   ├── UVUnwrapUtil.cpp
                │   │   └── UVUnwrapUtil.h
                │   └── UVMappingEditor/
                │       ├── BaseTool.cpp
                │       ├── BaseTool.h
                │       ├── UVCluster.cpp
                │       ├── UVCluster.h
                │       ├── UVCursor.cpp
                │       ├── UVCursor.h
                │       ├── UVElement.cpp
                │       ├── UVElement.h
                │       ├── UVGizmo.cpp
                │       ├── UVGizmo.h
                │       ├── UVMappingEditor.cpp
                │       ├── UVMappingEditor.h
                │       ├── UVMappingEditorCommon.cpp
                │       ├── UVMappingEditorCommon.h
                │       ├── UVUndo.cpp
                │       ├── UVUndo.h
                │       ├── ManipulationTools/
                │       │   ├── AlignTool.cpp
                │       │   ├── AlignTool.h
                │       │   ├── FlipTool.cpp
                │       │   ├── FlipTool.h
                │       │   ├── LoopSelectionTool.cpp
                │       │   ├── LoopSelectionTool.h
                │       │   ├── MoveTool.cpp
                │       │   ├── MoveTool.h
                │       │   ├── SelectSharedTool.cpp
                │       │   ├── SelectSharedTool.h
                │       │   ├── SelectTool.cpp
                │       │   ├── SelectTool.h
                │       │   ├── SeparateTool.cpp
                │       │   ├── SeparateTool.h
                │       │   ├── SewTool.cpp
                │       │   ├── SewTool.h
                │       │   ├── UnmapTool.cpp
                │       │   └── UnmapTool.h
                │       └── UnwrappingTools/
                │           ├── CubeUnwrappingTool.cpp
                │           ├── CubeUnwrappingTool.h
                │           ├── CylinderUnwrappingTool.cpp
                │           ├── CylinderUnwrappingTool.h
                │           ├── PlaneUnwrappingTool.cpp
                │           ├── PlaneUnwrappingTool.h
                │           ├── SphereUnwrappingTool.cpp
                │           ├── SphereUnwrappingTool.h
                │           ├── ViewUnwrappingTool.cpp
                │           └── ViewUnwrappingTool.h
                ├── CryTestRunnerPlugin/
                │   ├── CMakeLists.txt
                │   ├── CryTestNode.h
                │   ├── CryTestRunnerPlugin.cpp
                │   ├── CryTestRunnerPlugin.h
                │   ├── CryTestRunnerSystem.cpp
                │   ├── CryTestRunnerSystem.h
                │   ├── StdAfx.cpp
                │   └── StdAfx.h
                ├── DependencyGraph/
                │   ├── CMakeLists.txt
                │   ├── DependencyGraph.waf_files
                │   ├── DialogEditorPlugin.waf_files
                │   ├── GraphView.cpp
                │   ├── GraphView.h
                │   ├── GraphViewModel.cpp
                │   ├── GraphViewModel.h
                │   ├── MainWindow.cpp
                │   ├── MainWindow.h
                │   ├── Model.cpp
                │   ├── Model.h
                │   ├── Plugin.cpp
                │   ├── Plugin.h
                │   ├── StdAfx.cpp
                │   ├── StdAfx.h
                │   └── wscript
                ├── DialogEditor/
                │   ├── CMakeLists.txt
                │   ├── DialogEditor.rc
                │   ├── DialogEditorDialog.cpp
                │   ├── DialogEditorDialog.h
                │   ├── DialogEditorPlugin.cpp
                │   ├── DialogEditorPlugin.h
                │   ├── DialogEditorPlugin.waf_files
                │   ├── DialogManager.cpp
                │   ├── DialogManager.h
                │   ├── DialogScriptRecord.cpp
                │   ├── DialogScriptRecord.h
                │   ├── DialogScriptView.cpp
                │   ├── DialogScriptView.h
                │   ├── main.cpp
                │   ├── StdAfx.cpp
                │   ├── StdAfx.h
                │   └── wscript
                ├── EditorAnimation/
                │   ├── AnimationCompressionManager.cpp
                │   ├── AnimationCompressionManager.h
                │   ├── CMakeLists.txt
                │   ├── editoranimation.waf_files
                │   ├── main.cpp
                │   ├── ResourceCompilerHelpers.cpp
                │   ├── Serialization.cpp
                │   ├── Serialization.h
                │   ├── stdafx.cpp
                │   ├── stdafx.h
                │   ├── wscript
                │   ├── CharacterTool/
                │   │   ├── AnimationContent.cpp
                │   │   ├── AnimationContent.h
                │   │   ├── AnimationList.cpp
                │   │   ├── AnimationList.h
                │   │   ├── AnimationReference.h
                │   │   ├── AnimationTagList.cpp
                │   │   ├── AnimationTagList.h
                │   │   ├── AnimEvent.cpp
                │   │   ├── AnimEvent.h
                │   │   ├── AnimEventFootstepGenerator.cpp
                │   │   ├── AnimEventFootstepGenerator.h
                │   │   ├── AnimEventPlayers.cpp
                │   │   ├── AnimEventPresetPanel.cpp
                │   │   ├── AnimEventPresetPanel.h
                │   │   ├── BlendSpace.cpp
                │   │   ├── BlendSpace.h
                │   │   ├── BlendSpacePreview.cpp
                │   │   ├── BlendSpacePreview.h
                │   │   ├── BlockPalette.cpp
                │   │   ├── BlockPalette.h
                │   │   ├── BlockPaletteContent.h
                │   │   ├── CafCompressionHelper.cpp
                │   │   ├── CafCompressionHelper.h
                │   │   ├── CharacterDefinition.cpp
                │   │   ├── CharacterDefinition.h
                │   │   ├── CharacterDocument.cpp
                │   │   ├── CharacterDocument.h
                │   │   ├── CharacterGizmoManager.cpp
                │   │   ├── CharacterGizmoManager.h
                │   │   ├── CharacterList.cpp
                │   │   ├── CharacterList.h
                │   │   ├── CharacterPhysics.cpp
                │   │   ├── CharacterPhysics.h
                │   │   ├── CharacterRig.cpp
                │   │   ├── CharacterRig.h
                │   │   ├── CharacterToolForm.cpp
                │   │   ├── CharacterToolForm.h
                │   │   ├── CharacterToolSystem.cpp
                │   │   ├── CharacterToolSystem.h
                │   │   ├── CleanCompiledAnimationsTool.cpp
                │   │   ├── CleanCompiledAnimationsTool.h
                │   │   ├── CompressionMachine.cpp
                │   │   ├── CompressionMachine.h
                │   │   ├── DisplayParameters.cpp
                │   │   ├── DisplayParameters.h
                │   │   ├── DisplayParametersPanel.cpp
                │   │   ├── DisplayParametersPanel.h
                │   │   ├── EditorCompressionPresetTable.cpp
                │   │   ├── EditorCompressionPresetTable.h
                │   │   ├── EditorDBATable.cpp
                │   │   ├── EditorDBATable.h
                │   │   ├── EffectPlayer.cpp
                │   │   ├── EffectPlayer.h
                │   │   ├── ExplorerNavigationProvider.cpp
                │   │   ├── ExplorerNavigationProvider.h
                │   │   ├── FeatureTest.h
                │   │   ├── FeatureTestWeaponSwitch.cpp
                │   │   ├── FilterAnimationList.cpp
                │   │   ├── FilterAnimationList.h
                │   │   ├── GizmoSink.cpp
                │   │   ├── GizmoSink.h
                │   │   ├── JointNameSelector.cpp
                │   │   ├── JointNameSelector.h
                │   │   ├── ModeCharacter.cpp
                │   │   ├── ModeCharacter.h
                │   │   ├── PlaybackLayers.h
                │   │   ├── PlaybackPanel.cpp
                │   │   ├── PlaybackPanel.h
                │   │   ├── Pointers.h
                │   │   ├── PropertiesPanel.cpp
                │   │   ├── PropertiesPanel.h
                │   │   ├── ResaveAnimSettingsTool.cpp
                │   │   ├── ResaveAnimSettingsTool.h
                │   │   ├── SceneContent.cpp
                │   │   ├── SceneContent.h
                │   │   ├── SceneParametersPanel.cpp
                │   │   ├── SceneParametersPanel.h
                │   │   ├── SkeletonContent.cpp
                │   │   ├── SkeletonContent.h
                │   │   ├── SkeletonList.cpp
                │   │   ├── SkeletonList.h
                │   │   ├── SkeletonParameters.cpp
                │   │   ├── SkeletonParameters.h
                │   │   ├── SourceAssetContent.cpp
                │   │   ├── SourceAssetContent.h
                │   │   ├── SplitViewport.cpp
                │   │   ├── SplitViewport.h
                │   │   ├── TransformPanel.cpp
                │   │   ├── TransformPanel.h
                │   │   └── ViewportMode.h
                │   └── Shared/
                │       ├── AnimationFilter.cpp
                │       ├── AnimationFilter.h
                │       ├── AnimSettings.cpp
                │       ├── AnimSettings.h
                │       ├── CompressionPresetTable.cpp
                │       ├── CompressionPresetTable.h
                │       ├── DBATable.cpp
                │       ├── DBATable.h
                │       ├── Serialization.cpp
                │       ├── Serialization.h
                │       ├── SourceAssetScene.h
                │       └── SourceAssetSettings.h
                ├── EditorAudioControlsEditor/
                │   ├── Asset.cpp
                │   ├── Asset.h
                │   ├── AssetIcons.h
                │   ├── AssetsManager.cpp
                │   ├── AssetsManager.h
                │   ├── AssetUtils.cpp
                │   ├── AssetUtils.h
                │   ├── AudioControlsEditorPlugin.cpp
                │   ├── AudioControlsEditorPlugin.h
                │   ├── AudioControlsEditorUI.qrc
                │   ├── AudioControlsLoader.cpp
                │   ├── AudioControlsLoader.h
                │   ├── CMakeLists.txt
                │   ├── Common.cpp
                │   ├── Common.h
                │   ├── ConnectionsModel.cpp
                │   ├── ConnectionsModel.h
                │   ├── ConnectionsWidget.cpp
                │   ├── ConnectionsWidget.h
                │   ├── Context.cpp
                │   ├── Context.h
                │   ├── ContextManager.cpp
                │   ├── ContextManager.h
                │   ├── ContextModel.cpp
                │   ├── ContextModel.h
                │   ├── ContextWidget.cpp
                │   ├── ContextWidget.h
                │   ├── Control.cpp
                │   ├── Control.h
                │   ├── CreateFolderDialog.cpp
                │   ├── CreateFolderDialog.h
                │   ├── editoraudiocontrolseditor.waf_files
                │   ├── FileImporterDialog.cpp
                │   ├── FileImporterDialog.h
                │   ├── FileImporterModel.cpp
                │   ├── FileImporterModel.h
                │   ├── FileImporterUtils.cpp
                │   ├── FileImporterUtils.h
                │   ├── FileLoader.cpp
                │   ├── FileLoader.h
                │   ├── FileMonitorBase.cpp
                │   ├── FileMonitorBase.h
                │   ├── FileMonitorMiddleware.cpp
                │   ├── FileMonitorMiddleware.h
                │   ├── FileMonitorSystem.cpp
                │   ├── FileMonitorSystem.h
                │   ├── FileWriter.cpp
                │   ├── FileWriter.h
                │   ├── Folder.h
                │   ├── FolderSelectorDialog.cpp
                │   ├── FolderSelectorDialog.h
                │   ├── FolderSelectorFilterModel.cpp
                │   ├── FolderSelectorFilterModel.h
                │   ├── ImplManager.cpp
                │   ├── ImplManager.h
                │   ├── Library.cpp
                │   ├── Library.h
                │   ├── LibraryScope.h
                │   ├── ListenerManager.cpp
                │   ├── ListenerManager.h
                │   ├── ListenerSelectorDialog.cpp
                │   ├── ListenerSelectorDialog.h
                │   ├── ListenerSelectorModel.cpp
                │   ├── ListenerSelectorModel.h
                │   ├── MainWindow.cpp
                │   ├── MainWindow.h
                │   ├── MiddlewareDataWidget.cpp
                │   ├── MiddlewareDataWidget.h
                │   ├── NameValidator.cpp
                │   ├── NameValidator.h
                │   ├── PreferencesDialog.cpp
                │   ├── PreferencesDialog.h
                │   ├── PropertiesWidget.cpp
                │   ├── PropertiesWidget.h
                │   ├── ResourceFilterProxyModel.cpp
                │   ├── ResourceFilterProxyModel.h
                │   ├── ResourceLibraryModel.cpp
                │   ├── ResourceLibraryModel.h
                │   ├── ResourceSelectorDialog.cpp
                │   ├── ResourceSelectorDialog.h
                │   ├── ResourceSelectors.cpp
                │   ├── ResourceSourceModel.cpp
                │   ├── ResourceSourceModel.h
                │   ├── StdAfx.cpp
                │   ├── StdAfx.h
                │   ├── SystemControlsWidget.cpp
                │   ├── SystemControlsWidget.h
                │   ├── SystemFilterProxyModel.cpp
                │   ├── SystemFilterProxyModel.h
                │   ├── SystemLibraryModel.cpp
                │   ├── SystemLibraryModel.h
                │   ├── SystemSourceModel.cpp
                │   ├── SystemSourceModel.h
                │   ├── TreeView.cpp
                │   ├── TreeView.h
                │   ├── wscript
                │   ├── common/
                │   │   ├── CMakeLists.txt
                │   │   ├── ControlInfo.h
                │   │   ├── editoraudiocontrolseditorcommon.waf_files
                │   │   ├── FileImportInfo.h
                │   │   ├── IConnection.h
                │   │   ├── IImpl.h
                │   │   ├── IItem.h
                │   │   ├── ModelUtils.h
                │   │   ├── SharedData.h
                │   │   └── wscript
                │   ├── EditorAdx2/
                │   │   ├── CMakeLists.txt
                │   │   ├── Common.cpp
                │   │   ├── Common.h
                │   │   ├── CueConnection.cpp
                │   │   ├── CueConnection.h
                │   │   ├── DataPanel.cpp
                │   │   ├── DataPanel.h
                │   │   ├── editoradx2.waf_files
                │   │   ├── EditorAdx2UI.qrc
                │   │   ├── FilterProxyModel.cpp
                │   │   ├── FilterProxyModel.h
                │   │   ├── GenericConnection.h
                │   │   ├── Impl.cpp
                │   │   ├── Impl.h
                │   │   ├── Item.cpp
                │   │   ├── Item.h
                │   │   ├── ItemModel.cpp
                │   │   ├── ItemModel.h
                │   │   ├── main.cpp
                │   │   ├── ParameterConnection.cpp
                │   │   ├── ParameterConnection.h
                │   │   ├── ParameterToStateConnection.cpp
                │   │   ├── ParameterToStateConnection.h
                │   │   ├── ProjectLoader.cpp
                │   │   ├── ProjectLoader.h
                │   │   ├── SnapshotConnection.cpp
                │   │   ├── SnapshotConnection.h
                │   │   ├── StdAfx.cpp
                │   │   ├── StdAfx.h
                │   │   ├── TreeView.cpp
                │   │   ├── TreeView.h
                │   │   ├── Utils.cpp
                │   │   ├── Utils.h
                │   │   └── wscript
                │   ├── EditorFmod/
                │   │   ├── AudioTableInfo.h
                │   │   ├── CMakeLists.txt
                │   │   ├── Common.cpp
                │   │   ├── Common.h
                │   │   ├── DataPanel.cpp
                │   │   ├── DataPanel.h
                │   │   ├── editorfmod.waf_files
                │   │   ├── EditorFmodUI.qrc
                │   │   ├── EventConnection.cpp
                │   │   ├── EventConnection.h
                │   │   ├── FilterProxyModel.cpp
                │   │   ├── FilterProxyModel.h
                │   │   ├── GenericConnection.h
                │   │   ├── Impl.cpp
                │   │   ├── Impl.h
                │   │   ├── Item.cpp
                │   │   ├── Item.h
                │   │   ├── ItemModel.cpp
                │   │   ├── ItemModel.h
                │   │   ├── KeyConnection.cpp
                │   │   ├── KeyConnection.h
                │   │   ├── main.cpp
                │   │   ├── ParameterConnection.cpp
                │   │   ├── ParameterConnection.h
                │   │   ├── ParameterToStateConnection.cpp
                │   │   ├── ParameterToStateConnection.h
                │   │   ├── ProjectLoader.cpp
                │   │   ├── ProjectLoader.h
                │   │   ├── SnapshotConnection.cpp
                │   │   ├── SnapshotConnection.h
                │   │   ├── StdAfx.cpp
                │   │   ├── StdAfx.h
                │   │   ├── TreeView.cpp
                │   │   ├── TreeView.h
                │   │   ├── Utils.cpp
                │   │   ├── Utils.h
                │   │   └── wscript
                │   ├── EditorPortAudio/
                │   │   ├── CMakeLists.txt
                │   │   ├── Common.cpp
                │   │   ├── Common.h
                │   │   ├── DataPanel.cpp
                │   │   ├── DataPanel.h
                │   │   ├── editorportaudio.waf_files
                │   │   ├── EditorPortAudioUI.qrc
                │   │   ├── EventConnection.cpp
                │   │   ├── EventConnection.h
                │   │   ├── FilterProxyModel.cpp
                │   │   ├── FilterProxyModel.h
                │   │   ├── Impl.cpp
                │   │   ├── Impl.h
                │   │   ├── Item.cpp
                │   │   ├── Item.h
                │   │   ├── ItemModel.cpp
                │   │   ├── ItemModel.h
                │   │   ├── main.cpp
                │   │   ├── ProjectLoader.cpp
                │   │   ├── ProjectLoader.h
                │   │   ├── StdAfx.cpp
                │   │   ├── StdAfx.h
                │   │   ├── TreeView.cpp
                │   │   ├── TreeView.h
                │   │   ├── Utils.cpp
                │   │   ├── Utils.h
                │   │   └── wscript
                │   ├── EditorSDLMixer/
                │   │   ├── CMakeLists.txt
                │   │   ├── Common.cpp
                │   │   ├── Common.h
                │   │   ├── DataPanel.cpp
                │   │   ├── DataPanel.h
                │   │   ├── editorsdlmixer.waf_files
                │   │   ├── EditorSDLMixerUI.qrc
                │   │   ├── EventConnection.cpp
                │   │   ├── EventConnection.h
                │   │   ├── FilterProxyModel.cpp
                │   │   ├── FilterProxyModel.h
                │   │   ├── Impl.cpp
                │   │   ├── Impl.h
                │   │   ├── Item.cpp
                │   │   ├── Item.h
                │   │   ├── ItemModel.cpp
                │   │   ├── ItemModel.h
                │   │   ├── main.cpp
                │   │   ├── ParameterConnection.cpp
                │   │   ├── ParameterConnection.h
                │   │   ├── PreloadConnection.h
                │   │   ├── ProjectLoader.cpp
                │   │   ├── ProjectLoader.h
                │   │   ├── StateConnection.cpp
                │   │   ├── StateConnection.h
                │   │   ├── StdAfx.cpp
                │   │   ├── StdAfx.h
                │   │   ├── TreeView.cpp
                │   │   ├── TreeView.h
                │   │   ├── Utils.cpp
                │   │   ├── Utils.h
                │   │   └── wscript
                │   └── EditorWwise/
                │       ├── CMakeLists.txt
                │       ├── Common.cpp
                │       ├── Common.h
                │       ├── DataPanel.cpp
                │       ├── DataPanel.h
                │       ├── editorwwise.waf_files
                │       ├── EditorWwiseUI.qrc
                │       ├── FilterProxyModel.cpp
                │       ├── FilterProxyModel.h
                │       ├── GenericConnection.h
                │       ├── Impl.cpp
                │       ├── Impl.h
                │       ├── Item.cpp
                │       ├── Item.h
                │       ├── ItemModel.cpp
                │       ├── ItemModel.h
                │       ├── main.cpp
                │       ├── ParameterConnection.cpp
                │       ├── ParameterConnection.h
                │       ├── ParameterToStateConnection.cpp
                │       ├── ParameterToStateConnection.h
                │       ├── ProjectLoader.cpp
                │       ├── ProjectLoader.h
                │       ├── StdAfx.cpp
                │       ├── StdAfx.h
                │       ├── TreeView.cpp
                │       ├── TreeView.h
                │       └── wscript
                ├── EditorBehaviorTree/
                │   ├── BehaviorTreeDocument.cpp
                │   ├── BehaviorTreeDocument.h
                │   ├── CMakeLists.txt
                │   ├── editorbehaviortree.waf_files
                │   ├── main.cpp
                │   ├── MainWindow.cpp
                │   ├── MainWindow.h
                │   ├── StdAfx.cpp
                │   ├── StdAfx.h
                │   ├── TreePanel.cpp
                │   ├── TreePanel.h
                │   └── wscript
                ├── EditorCommon/
                │   ├── AutoRegister.cpp
                │   ├── AutoRegister.h
                │   ├── BatchFileDialog.cpp
                │   ├── BatchFileDialog.h
                │   ├── BoostPythonMacros.cpp
                │   ├── BoostPythonMacros.h
                │   ├── CMakeLists.txt
                │   ├── ConfigurationManager.cpp
                │   ├── ConfigurationManager.h
                │   ├── CurveEditor.cpp
                │   ├── CurveEditor.h
                │   ├── CurveEditorContent.h
                │   ├── DependencyManager.cpp
                │   ├── DependencyManager.h
                │   ├── DisplayViewportAdapter.cpp
                │   ├── DisplayViewportAdapter.h
                │   ├── DockedWidget.h
                │   ├── DockTitleBarWidget.cpp
                │   ├── DockTitleBarWidget.h
                │   ├── DockWidgetManager.cpp
                │   ├── DockWidgetManager.h
                │   ├── DragDrop.cpp
                │   ├── DragDrop.h
                │   ├── EditorCommands_PathUtils.cpp
                │   ├── EditorCommon.def
                │   ├── EditorCommon.h
                │   ├── EditorCommon.qrc
                │   ├── EditorCommon.rc
                │   ├── EditorCommonAPI.h
                │   ├── EditorCommonInit.cpp
                │   ├── EditorCommonInit.h
                │   ├── EditorStyleHelper.cpp
                │   ├── EditorStyleHelper.h
                │   ├── Expected.h
                │   ├── FileUtils.cpp
                │   ├── FileUtils.h
                │   ├── HitContext.h
                │   ├── IBackgroundTaskManager.h
                │   ├── IDataBaseItem.h
                │   ├── IDataBaseLibrary.h
                │   ├── IDataBaseManager.h
                │   ├── IDisplayViewport.h
                │   ├── IEditorClassFactory.h
                │   ├── IExportManager.h
                │   ├── IIconManager.h
                │   ├── IObjectEnumerator.h
                │   ├── IObjectManager.h
                │   ├── IPlugin.h
                │   ├── IPostRenderer.h
                │   ├── IResourceSelectorHost.h
                │   ├── ISourceControl.h
                │   ├── KeyboardShortcut.cpp
                │   ├── KeyboardShortcut.h
                │   ├── ListSelectionDialog.cpp
                │   ├── ListSelectionDialog.h
                │   ├── MenuHelpers.h
                │   ├── ModelViewport.cpp
                │   ├── ModelViewport.h
                │   ├── ObjectEvent.h
                │   ├── PathUtils.cpp
                │   ├── PathUtils.h
                │   ├── PreviewToolTip.cpp
                │   ├── PreviewToolTip.h
                │   ├── QAdvancedItemDelegate.cpp
                │   ├── QAdvancedItemDelegate.h
                │   ├── QAdvancedPropertyTreeLegacy.cpp
                │   ├── QAdvancedPropertyTreeLegacy.h
                │   ├── QAdvancedTreeView.cpp
                │   ├── QAdvancedTreeView.h
                │   ├── QControls.cpp
                │   ├── QControls.h
                │   ├── QFilteringPanel.cpp
                │   ├── QFilteringPanel.h
                │   ├── QFullScreenWidget.cpp
                │   ├── QFullScreenWidget.h
                │   ├── QSearchBox.cpp
                │   ├── QSearchBox.h
                │   ├── QThumbnailView.cpp
                │   ├── QThumbnailView.h
                │   ├── QTrackingTooltip.cpp
                │   ├── QTrackingTooltip.h
                │   ├── QtUtil.cpp
                │   ├── QtUtil.h
                │   ├── QtViewPane.cpp
                │   ├── QtViewPane.h
                │   ├── QViewport.cpp
                │   ├── QViewport.h
                │   ├── QViewportConsumer.h
                │   ├── QViewportEvents.h
                │   ├── QViewportPane.cpp
                │   ├── QViewportPane.h
                │   ├── QViewportSettings.h
                │   ├── RenderLock.cpp
                │   ├── RenderLock.h
                │   ├── RenderViewport.cpp
                │   ├── RenderViewport.h
                │   ├── Resource.h
                │   ├── ResourceSelectorHost.cpp
                │   ├── Serialization.cpp
                │   ├── Serialization.h
                │   ├── AssetSystem/
                │   │   ├── Asset.cpp
                │   │   ├── Asset.h
                │   │   ├── AssetConverter.cpp
                │   │   ├── AssetConverter.h
                │   │   ├── AssetEditor.cpp
                │   │   ├── AssetEditor.h
                │   │   ├── AssetFileMonitor.cpp
                │   │   ├── AssetFileMonitor.h
                │   │   ├── AssetFilesGroupController.cpp
                │   │   ├── AssetFilesGroupController.h
                │   │   ├── AssetGenerator.cpp
                │   │   ├── AssetGenerator.h
                │   │   ├── AssetImportContext.cpp
                │   │   ├── AssetImportContext.h
                │   │   ├── AssetImporter.cpp
                │   │   ├── AssetImporter.h
                │   │   ├── AssetManager.cpp
                │   │   ├── AssetManager.h
                │   │   ├── AssetManagerHelpers.cpp
                │   │   ├── AssetManagerHelpers.h
                │   │   ├── AssetResourceSelector.cpp
                │   │   ├── AssetResourceSelector.h
                │   │   ├── AssetType.cpp
                │   │   ├── AssetType.h
                │   │   ├── DependencyTracker.cpp
                │   │   ├── DependencyTracker.h
                │   │   ├── EditableAsset.cpp
                │   │   ├── EditableAsset.h
                │   │   ├── EditorCommands_Assets.cpp
                │   │   ├── FileOperationsExecutor.cpp
                │   │   ├── FileOperationsExecutor.h
                │   │   ├── IFileOperationsExecutor.cpp
                │   │   ├── IFileOperationsExecutor.h
                │   │   ├── IFilesGroupController.h
                │   │   ├── ObjectIndexContainer.h
                │   │   ├── PakImporter.cpp
                │   │   ├── PakImporter.h
                │   │   ├── Browser/
                │   │   │   ├── AssetBrowser.cpp
                │   │   │   ├── AssetBrowser.h
                │   │   │   ├── AssetBrowserDialog.cpp
                │   │   │   ├── AssetBrowserDialog.h
                │   │   │   ├── AssetBrowserWidget.cpp
                │   │   │   ├── AssetBrowserWidget.h
                │   │   │   ├── AssetDropHandler.cpp
                │   │   │   ├── AssetDropHandler.h
                │   │   │   ├── AssetFolderFilterModel.cpp
                │   │   │   ├── AssetFolderFilterModel.h
                │   │   │   ├── AssetFoldersModel.cpp
                │   │   │   ├── AssetFoldersModel.h
                │   │   │   ├── AssetFoldersView.cpp
                │   │   │   ├── AssetFoldersView.h
                │   │   │   ├── AssetImportDialog.cpp
                │   │   │   ├── AssetImportDialog.h
                │   │   │   ├── AssetModel.cpp
                │   │   │   ├── AssetModel.h
                │   │   │   ├── AssetReverseDependenciesDialog.cpp
                │   │   │   ├── AssetReverseDependenciesDialog.h
                │   │   │   ├── AssetThumbnailsGenerator.cpp
                │   │   │   ├── AssetThumbnailsGenerator.h
                │   │   │   ├── AssetThumbnailsLoader.cpp
                │   │   │   ├── AssetThumbnailsLoader.h
                │   │   │   ├── AssetTooltip.cpp
                │   │   │   ├── AssetTooltip.h
                │   │   │   ├── DependenciesAttribute.cpp
                │   │   │   ├── DependenciesAttribute.h
                │   │   │   ├── FilteredFolders.cpp
                │   │   │   ├── FilteredFolders.h
                │   │   │   ├── IAssetBrowserContext.h
                │   │   │   ├── LineEditDelegate.cpp
                │   │   │   ├── LineEditDelegate.h
                │   │   │   ├── ManageWorkFilesDialog.cpp
                │   │   │   ├── ManageWorkFilesDialog.h
                │   │   │   ├── NewAssetModel.cpp
                │   │   │   ├── NewAssetModel.h
                │   │   │   ├── SortFilterProxyModel.cpp
                │   │   │   └── SortFilterProxyModel.h
                │   │   └── Loader/
                │   │       ├── AssetCache.cpp
                │   │       ├── AssetCache.h
                │   │       ├── AssetLoader.cpp
                │   │       ├── AssetLoader.h
                │   │       ├── AssetLoaderBackgroundTask.cpp
                │   │       ├── AssetLoaderBackgroundTask.h
                │   │       ├── AssetLoaderHelpers.cpp
                │   │       ├── AssetLoaderHelpers.h
                │   │       ├── CompletionPortFileReader.cpp
                │   │       ├── CompletionPortFileReader.h
                │   │       ├── FileReader.cpp
                │   │       ├── FileReader.h
                │   │       ├── Metadata.cpp
                │   │       └── Metadata.h
                │   ├── Commands/
                │   │   ├── Command.cpp
                │   │   ├── Command.h
                │   │   ├── CommandModel.cpp
                │   │   ├── CommandModel.h
                │   │   ├── CommandModuleDescription.h
                │   │   ├── CustomCommand.cpp
                │   │   ├── CustomCommand.h
                │   │   ├── CVarListDockable.cpp
                │   │   ├── CVarListDockable.h
                │   │   ├── ICommandManager.h
                │   │   ├── PolledKey.h
                │   │   ├── QCommandAction.cpp
                │   │   └── QCommandAction.h
                │   ├── Controls/
                │   │   ├── BreadcrumbsBar.cpp
                │   │   ├── BreadcrumbsBar.h
                │   │   ├── ColorButton.cpp
                │   │   ├── ColorButton.h
                │   │   ├── CurveEditorPanel.cpp
                │   │   ├── CurveEditorPanel.h
                │   │   ├── DictionaryWidget.cpp
                │   │   ├── DictionaryWidget.h
                │   │   ├── DynamicPopupMenu.cpp
                │   │   ├── DynamicPopupMenu.h
                │   │   ├── EditorDialog.cpp
                │   │   ├── EditorDialog.h
                │   │   ├── LongLongSpinBox.cpp
                │   │   ├── LongLongSpinBox.h
                │   │   ├── QEditableComboBox.cpp
                │   │   ├── QEditableComboBox.h
                │   │   ├── QMenuComboBox.cpp
                │   │   ├── QMenuComboBox.h
                │   │   ├── QNumericBox.cpp
                │   │   ├── QNumericBox.h
                │   │   ├── QObjectTreeWidget.cpp
                │   │   ├── QObjectTreeWidget.h
                │   │   ├── QPopupWidget.cpp
                │   │   ├── QPopupWidget.h
                │   │   ├── QResourceBrowserDialog.cpp
                │   │   ├── QResourceBrowserDialog.h
                │   │   ├── QtFlowLayout.cpp
                │   │   ├── QtFlowLayout.h
                │   │   ├── QuestionDialog.cpp
                │   │   ├── QuestionDialog.h
                │   │   ├── QuestionTimeoutDialog.cpp
                │   │   ├── QuestionTimeoutDialog.h
                │   │   ├── SandboxWindowing.cpp
                │   │   ├── SandboxWindowing.h
                │   │   ├── SaveChangesDialog.cpp
                │   │   ├── SaveChangesDialog.h
                │   │   ├── SingleSelectionDialog.cpp
                │   │   ├── SingleSelectionDialog.h
                │   │   ├── Vec3Widget.cpp
                │   │   └── Vec3Widget.h
                │   ├── Dialogs/
                │   │   ├── QGroupDialog.cpp
                │   │   ├── QGroupDialog.h
                │   │   ├── QNumericBoxDialog.cpp
                │   │   ├── QNumericBoxDialog.h
                │   │   ├── QStringDialog.cpp
                │   │   ├── QStringDialog.h
                │   │   ├── TreeViewDialog.cpp
                │   │   └── TreeViewDialog.h
                │   ├── DockingSystem/
                │   │   ├── DockableContainer.cpp
                │   │   └── DockableContainer.h
                │   ├── DrawingPrimitives/
                │   │   ├── Ruler.cpp
                │   │   ├── Ruler.h
                │   │   ├── TimeSlider.cpp
                │   │   └── TimeSlider.h
                │   ├── EditorFramework/
                │   │   ├── BroadcastManager.cpp
                │   │   ├── BroadcastManager.h
                │   │   ├── CommandRegistry.h
                │   │   ├── Editor.cpp
                │   │   ├── Editor.h
                │   │   ├── EditorContent.cpp
                │   │   ├── EditorContent.h
                │   │   ├── EditorWidget.cpp
                │   │   ├── EditorWidget.h
                │   │   ├── EventLoopHandler.cpp
                │   │   ├── EventLoopHandler.h
                │   │   ├── Events.cpp
                │   │   ├── Events.h
                │   │   ├── Inspector.cpp
                │   │   ├── Inspector.h
                │   │   ├── InspectorLegacy.cpp
                │   │   ├── InspectorLegacy.h
                │   │   ├── PersonalizationManager.cpp
                │   │   ├── PersonalizationManager.h
                │   │   ├── Preferences.cpp
                │   │   ├── Preferences.h
                │   │   ├── PreferencesDialog.cpp
                │   │   ├── PreferencesDialog.h
                │   │   ├── PriorityCommandRegistry.h
                │   │   ├── StateSerializable.h
                │   │   ├── TrayArea.cpp
                │   │   ├── TrayArea.h
                │   │   ├── WidgetActionRegistry.cpp
                │   │   ├── WidgetActionRegistry.h
                │   │   ├── WidgetsGlobalActionRegistry.cpp
                │   │   ├── WidgetsGlobalActionRegistry.h
                │   │   └── ToolBar/
                │   │       ├── ToolBarArea.cpp
                │   │       ├── ToolBarArea.h
                │   │       ├── ToolBarAreaItem.cpp
                │   │       ├── ToolBarAreaItem.h
                │   │       ├── ToolBarAreaManager.cpp
                │   │       ├── ToolBarAreaManager.h
                │   │       ├── ToolBarCustomizeDialog.cpp
                │   │       ├── ToolBarCustomizeDialog.h
                │   │       ├── ToolBarService.cpp
                │   │       └── ToolBarService.h
                │   ├── Explorer/
                │   │   ├── EntryList.cpp
                │   │   ├── EntryList.h
                │   │   ├── Explorer.cpp
                │   │   ├── Explorer.h
                │   │   ├── ExplorerDataProvider.h
                │   │   ├── ExplorerFileList.cpp
                │   │   ├── ExplorerFileList.h
                │   │   ├── ExplorerModel.cpp
                │   │   ├── ExplorerModel.h
                │   │   ├── ExplorerPanel.cpp
                │   │   ├── ExplorerPanel.h
                │   │   ├── ScanAndLoadFilesTask.cpp
                │   │   └── ScanAndLoadFilesTask.h
                │   ├── Export/
                │   │   ├── ExportDataTypes.cpp
                │   │   └── ExportDataTypes.h
                │   ├── FileDialogs/
                │   │   ├── EngineFileDialog.cpp
                │   │   ├── EngineFileDialog.h
                │   │   ├── ExtensionFilter.cpp
                │   │   ├── ExtensionFilter.h
                │   │   ├── FileDialogsCommon.cpp
                │   │   ├── FileDialogsCommon.h
                │   │   ├── FileNameLineEdit.cpp
                │   │   ├── FileNameLineEdit.h
                │   │   ├── FilePopupMenu.cpp
                │   │   ├── FilePopupMenu.h
                │   │   ├── SystemFileDialog.cpp
                │   │   ├── SystemFileDialog.h
                │   │   └── Internal/
                │   │       ├── FilePreviewContainer.cpp
                │   │       ├── FilePreviewContainer.h
                │   │       ├── SelectExtensionDialog.cpp
                │   │       └── SelectExtensionDialog.h
                │   ├── FileSystem/
                │   │   ├── FileListModel.cpp
                │   │   ├── FileListModel.h
                │   │   ├── FileSortProxyModel.cpp
                │   │   ├── FileSortProxyModel.h
                │   │   ├── FileSystem_Directory.h
                │   │   ├── FileSystem_DirectoryFilter.cpp
                │   │   ├── FileSystem_DirectoryFilter.h
                │   │   ├── FileSystem_EnginePath.cpp
                │   │   ├── FileSystem_EnginePath.h
                │   │   ├── FileSystem_Enumerator.cpp
                │   │   ├── FileSystem_Enumerator.h
                │   │   ├── FileSystem_File.h
                │   │   ├── FileSystem_FileFilter.cpp
                │   │   ├── FileSystem_FileFilter.h
                │   │   ├── FileSystem_FileMonitor.h
                │   │   ├── FileSystem_Snapshot.cpp
                │   │   ├── FileSystem_Snapshot.h
                │   │   ├── FileSystem_SubTree.h
                │   │   ├── FileSystem_SubTreeMonitor.h
                │   │   ├── FileTreeModel.cpp
                │   │   ├── FileTreeModel.h
                │   │   ├── FileType.cpp
                │   │   ├── FileType.h
                │   │   ├── FileTypeStore.cpp
                │   │   ├── FileTypeStore.h
                │   │   ├── Internal/
                │   │   │   ├── FileSystem_Internal_Data.h
                │   │   │   ├── FileSystem_Internal_FileMonitors.cpp
                │   │   │   ├── FileSystem_Internal_FileMonitors.h
                │   │   │   ├── FileSystem_Internal_FilterUtils.h
                │   │   │   ├── FileSystem_Internal_IndexedDirectory.h
                │   │   │   ├── FileSystem_Internal_InflightUpdate.cpp
                │   │   │   ├── FileSystem_Internal_InflightUpdate.h
                │   │   │   ├── FileSystem_Internal_Mounts.cpp
                │   │   │   ├── FileSystem_Internal_Mounts.h
                │   │   │   ├── FileSystem_Internal_PakFiles.cpp
                │   │   │   ├── FileSystem_Internal_PakFiles.h
                │   │   │   ├── FileSystem_Internal_PathUtils.h
                │   │   │   ├── FileSystem_Internal_SnapshotUpdate.h
                │   │   │   ├── FileSystem_Internal_SubTreeMonitors.cpp
                │   │   │   ├── FileSystem_Internal_SubTreeMonitors.h
                │   │   │   ├── FileSystem_Internal_UpdateSequence.cpp
                │   │   │   ├── FileSystem_Internal_UpdateSequence.h
                │   │   │   ├── FileSystem_Internal_Worker.cpp
                │   │   │   ├── FileSystem_Internal_Worker.h
                │   │   │   ├── FileSystem_Internal_WorkerApi.cpp
                │   │   │   ├── FileSystem_Internal_WorkerApi.h
                │   │   │   └── Win32/
                │   │   │       ├── FileSystem_Internal_Win32_ActionMonitor.cpp
                │   │   │       ├── FileSystem_Internal_Win32_ActionMonitor.h
                │   │   │       ├── FileSystem_Internal_Win32_ActionSequence.h
                │   │   │       ├── FileSystem_Internal_Win32_Monitor.cpp
                │   │   │       ├── FileSystem_Internal_Win32_Monitor.h
                │   │   │       ├── FileSystem_Internal_Win32_MonitorAdapter.cpp
                │   │   │       ├── FileSystem_Internal_Win32_MonitorAdapter.h
                │   │   │       ├── FileSystem_Internal_Win32_Scanner.cpp
                │   │   │       ├── FileSystem_Internal_Win32_Scanner.h
                │   │   │       ├── FileSystem_Internal_Win32_UniqueFind.cpp
                │   │   │       ├── FileSystem_Internal_Win32_UniqueFind.h
                │   │   │       ├── FileSystem_Internal_Win32_UniqueHandle.h
                │   │   │       ├── FileSystem_Internal_Win32_Utils.cpp
                │   │   │       └── FileSystem_Internal_Win32_Utils.h
                │   │   └── OsFileSystemModels/
                │   │       ├── AdvancedFileSystemModel.cpp
                │   │       ├── AdvancedFileSystemModel.h
                │   │       ├── DirectoryModel.cpp
                │   │       ├── DirectoryModel.h
                │   │       ├── FileCollectionModel.cpp
                │   │       └── FileCollectionModel.h
                │   ├── Gizmos/
                │   │   ├── AxisHelper.cpp
                │   │   ├── AxisHelper.h
                │   │   ├── AxisHelperExtended.cpp
                │   │   ├── AxisHelperExtended.h
                │   │   ├── AxisRotateGizmo.cpp
                │   │   ├── AxisRotateGizmo.h
                │   │   ├── AxisScaleGizmo.cpp
                │   │   ├── AxisScaleGizmo.h
                │   │   ├── AxisTranslateGizmo.cpp
                │   │   ├── AxisTranslateGizmo.h
                │   │   ├── Gizmo.cpp
                │   │   ├── Gizmo.h
                │   │   ├── GizmoManager.cpp
                │   │   ├── GizmoManager.h
                │   │   ├── IGizmoManager.h
                │   │   ├── ITransformManipulator.h
                │   │   ├── PlaneScaleGizmo.cpp
                │   │   ├── PlaneScaleGizmo.h
                │   │   ├── PlaneTranslateGizmo.cpp
                │   │   ├── PlaneTranslateGizmo.h
                │   │   ├── TrackballGizmo.cpp
                │   │   ├── TrackballGizmo.h
                │   │   ├── TransformManipulator.cpp
                │   │   ├── TransformManipulator.h
                │   │   ├── UniformScaleGizmo.cpp
                │   │   ├── UniformScaleGizmo.h
                │   │   ├── ViewTranslateGizmo.cpp
                │   │   └── ViewTranslateGizmo.h
                │   ├── LevelEditor/
                │   │   ├── ILevelExplorerContext.h
                │   │   ├── LayerFileGroupController.cpp
                │   │   ├── LayerFileGroupController.h
                │   │   ├── LevelEditorSharedState.cpp
                │   │   ├── LevelEditorSharedState.h
                │   │   └── Tools/
                │   │       ├── DeepSelection.cpp
                │   │       ├── DeepSelection.h
                │   │       ├── EditTool.cpp
                │   │       ├── EditTool.h
                │   │       ├── ObjectMode.cpp
                │   │       ├── ObjectMode.h
                │   │       ├── PickObjectTool.cpp
                │   │       ├── PickObjectTool.h
                │   │       ├── SubObjectSelectionReferenceFrameCalculator.cpp
                │   │       └── SubObjectSelectionReferenceFrameCalculator.h
                │   ├── Menu/
                │   │   ├── AbstractMenu.cpp
                │   │   ├── AbstractMenu.h
                │   │   ├── MenuBarUpdater.cpp
                │   │   ├── MenuBarUpdater.h
                │   │   ├── MenuDesc.h
                │   │   ├── MenuWidgetBuilders.cpp
                │   │   └── MenuWidgetBuilders.h
                │   ├── Models/
                │   │   ├── CharacterAnimationsModel.cpp
                │   │   ├── CharacterAnimationsModel.h
                │   │   ├── EntityEventsModel.cpp
                │   │   ├── EntityEventsModel.h
                │   │   ├── SequenceCamerasModel.cpp
                │   │   ├── SequenceCamerasModel.h
                │   │   ├── SequenceEventsModel.cpp
                │   │   └── SequenceEventsModel.h
                │   ├── NodeGraph/
                │   │   ├── AbstractCommentItem.cpp
                │   │   ├── AbstractCommentItem.h
                │   │   ├── AbstractConnectionItem.cpp
                │   │   ├── AbstractConnectionItem.h
                │   │   ├── AbstractEditorData.cpp
                │   │   ├── AbstractEditorData.h
                │   │   ├── AbstractGroupItem.cpp
                │   │   ├── AbstractGroupItem.h
                │   │   ├── AbstractNodeContentWidget.cpp
                │   │   ├── AbstractNodeContentWidget.h
                │   │   ├── AbstractNodeGraphViewModel.cpp
                │   │   ├── AbstractNodeGraphViewModel.h
                │   │   ├── AbstractNodeGraphViewModelItem.cpp
                │   │   ├── AbstractNodeGraphViewModelItem.h
                │   │   ├── AbstractNodeItem.cpp
                │   │   ├── AbstractNodeItem.h
                │   │   ├── AbstractPinItem.cpp
                │   │   ├── AbstractPinItem.h
                │   │   ├── ClipboardItemCollection.cpp
                │   │   ├── ClipboardItemCollection.h
                │   │   ├── CommentEditorData.cpp
                │   │   ├── CommentEditorData.h
                │   │   ├── CommentWidget.cpp
                │   │   ├── CommentWidget.h
                │   │   ├── CommentWidgetStyle.cpp
                │   │   ├── CommentWidgetStyle.h
                │   │   ├── ConnectionWidget.cpp
                │   │   ├── ConnectionWidget.h
                │   │   ├── ConnectionWidgetStyle.cpp
                │   │   ├── ConnectionWidgetStyle.h
                │   │   ├── GraphEditorData.cpp
                │   │   ├── GraphEditorData.h
                │   │   ├── GraphicsSceneIcon.cpp
                │   │   ├── GraphicsSceneIcon.h
                │   │   ├── GroupEditorData.cpp
                │   │   ├── GroupEditorData.h
                │   │   ├── GroupWidget.cpp
                │   │   ├── GroupWidget.h
                │   │   ├── GroupWidgetStyle.cpp
                │   │   ├── GroupWidgetStyle.h
                │   │   ├── HeaderIconWidget.cpp
                │   │   ├── HeaderIconWidget.h
                │   │   ├── HeaderWidget.cpp
                │   │   ├── HeaderWidget.h
                │   │   ├── HeaderWidgetStyle.cpp
                │   │   ├── HeaderWidgetStyle.h
                │   │   ├── ICryGraph.h
                │   │   ├── ICryGraphEditor.h
                │   │   ├── ItemCollection.cpp
                │   │   ├── ItemCollection.h
                │   │   ├── NodeContentWidgetStyle.cpp
                │   │   ├── NodeContentWidgetStyle.h
                │   │   ├── NodeEditorData.cpp
                │   │   ├── NodeEditorData.h
                │   │   ├── NodeGraphItemPropertiesWidget.cpp
                │   │   ├── NodeGraphItemPropertiesWidget.h
                │   │   ├── NodeGraphStyleItem.cpp
                │   │   ├── NodeGraphStyleItem.h
                │   │   ├── NodeGraphStyleUtils.cpp
                │   │   ├── NodeGraphStyleUtils.h
                │   │   ├── NodeGraphUndo.cpp
                │   │   ├── NodeGraphUndo.h
                │   │   ├── NodeGraphView.cpp
                │   │   ├── NodeGraphView.h
                │   │   ├── NodeGraphViewBackground.cpp
                │   │   ├── NodeGraphViewBackground.h
                │   │   ├── NodeGraphViewGraphicsWidget.cpp
                │   │   ├── NodeGraphViewGraphicsWidget.h
                │   │   ├── NodeGraphViewPreferences.cpp
                │   │   ├── NodeGraphViewPreferences.h
                │   │   ├── NodeGraphViewStyle.cpp
                │   │   ├── NodeGraphViewStyle.h
                │   │   ├── NodeHeaderIconWidget.cpp
                │   │   ├── NodeHeaderIconWidget.h
                │   │   ├── NodeHeaderWidget.cpp
                │   │   ├── NodeHeaderWidget.h
                │   │   ├── NodeHeaderWidgetStyle.cpp
                │   │   ├── NodeHeaderWidgetStyle.h
                │   │   ├── NodeInfoWidget.cpp
                │   │   ├── NodeInfoWidget.h
                │   │   ├── NodeInfoWidgetStyle.cpp
                │   │   ├── NodeInfoWidgetStyle.h
                │   │   ├── NodeNameWidget.cpp
                │   │   ├── NodeNameWidget.h
                │   │   ├── NodePinWidgetStyle.cpp
                │   │   ├── NodePinWidgetStyle.h
                │   │   ├── NodeWidget.cpp
                │   │   ├── NodeWidget.h
                │   │   ├── NodeWidgetStyle.cpp
                │   │   ├── NodeWidgetStyle.h
                │   │   ├── PinGridNodeContentWidget.cpp
                │   │   ├── PinGridNodeContentWidget.h
                │   │   ├── PinWidget.cpp
                │   │   ├── PinWidget.h
                │   │   ├── TextWidget.cpp
                │   │   ├── TextWidget.h
                │   │   ├── TextWidgetStyle.cpp
                │   │   └── TextWidgetStyle.h
                │   ├── Notifications/
                │   │   ├── NotificationCenter.cpp
                │   │   ├── NotificationCenter.h
                │   │   ├── NotificationCenterImpl.cpp
                │   │   ├── NotificationCenterImpl.h
                │   │   ├── NotificationCenterTrayWidget.cpp
                │   │   ├── NotificationCenterTrayWidget.h
                │   │   ├── NotificationHistory.cpp
                │   │   ├── NotificationHistory.h
                │   │   ├── NotificationList.cpp
                │   │   ├── NotificationList.h
                │   │   ├── NotificationWidget.cpp
                │   │   ├── NotificationWidget.h
                │   │   └── Internal/
                │   │       ├── NotificationModel_Internal.cpp
                │   │       ├── NotificationModel_Internal.h
                │   │       └── Notifications_Internal.h
                │   ├── Objects/
                │   │   ├── BaseObject.cpp
                │   │   ├── BaseObject.h
                │   │   ├── ClassDesc.cpp
                │   │   ├── ClassDesc.h
                │   │   ├── DisplayContext.cpp
                │   │   ├── DisplayContext.h
                │   │   ├── EntityComponentCollapsibleFrame.cpp
                │   │   ├── EntityComponentCollapsibleFrame.h
                │   │   ├── InspectorWidgetCreator.h
                │   │   ├── IObjectLayer.h
                │   │   ├── IObjectLayerManager.h
                │   │   ├── ISelectionGroup.h
                │   │   ├── ObjectLoader.cpp
                │   │   ├── ObjectLoader.h
                │   │   ├── ObjectPropertyWidget.cpp
                │   │   └── ObjectPropertyWidget.h
                │   ├── Preferences/
                │   │   ├── GeneralPreferences.cpp
                │   │   ├── GeneralPreferences.h
                │   │   ├── GlobalHelperPreferences.cpp
                │   │   ├── GlobalHelperPreferences.h
                │   │   ├── SnappingPreferences.cpp
                │   │   ├── SnappingPreferences.h
                │   │   ├── ViewportPreferences.cpp
                │   │   └── ViewportPreferences.h
                │   ├── ProxyModels/
                │   │   ├── AttributeFilterProxyModel.cpp
                │   │   ├── AttributeFilterProxyModel.h
                │   │   ├── DeepFilterProxyModel.cpp
                │   │   ├── DeepFilterProxyModel.h
                │   │   ├── FavoritesHelper.cpp
                │   │   ├── FavoritesHelper.h
                │   │   ├── ItemModelAttribute.cpp
                │   │   ├── ItemModelAttribute.h
                │   │   ├── MergingProxyModel.cpp
                │   │   ├── MergingProxyModel.h
                │   │   ├── MountingProxyModel.cpp
                │   │   ├── MountingProxyModel.h
                │   │   └── Details/
                │   │       ├── ColumnSort.h
                │   │       ├── MergeColumnMapping.h
                │   │       ├── MultiProxyColumnMapping.cpp
                │   │       ├── MultiProxyColumnMapping.h
                │   │       ├── MultiProxyModelHelper.cpp
                │   │       └── MultiProxyModelHelper.h
                │   ├── QPropertyTreeLegacy/
                │   │   ├── CharacterAnimationSelector.cpp
                │   │   ├── ContextList.h
                │   │   ├── EntityEventSelector.cpp
                │   │   ├── PropertyRowActionButton.cpp
                │   │   ├── PropertyRowCryColor.cpp
                │   │   ├── PropertyRowCryColor.h
                │   │   ├── PropertyRowCurve.cpp
                │   │   ├── PropertyRowCurve.h
                │   │   ├── PropertyRowFlags.cpp
                │   │   ├── PropertyRowGap.cpp
                │   │   ├── PropertyRowLocalFrame.cpp
                │   │   ├── PropertyRowLocalFrame.h
                │   │   ├── PropertyRowMenuCombobox.cpp
                │   │   ├── PropertyRowOutputFilePath.cpp
                │   │   ├── PropertyRowOutputFilePath.h
                │   │   ├── PropertyRowResourceFilePath.cpp
                │   │   ├── PropertyRowResourceFilePath.h
                │   │   ├── PropertyRowResourceFolderPath.cpp
                │   │   ├── PropertyRowResourceFolderPath.h
                │   │   ├── PropertyRowResourceSelector.cpp
                │   │   ├── PropertyRowResourceSelector.h
                │   │   ├── PropertyRowTagList.cpp
                │   │   ├── PropertyRowTagList.h
                │   │   ├── PropertyRowToggleButton.cpp
                │   │   ├── PropertyRowToolButton.cpp
                │   │   ├── PropertyRowUniformScale.cpp
                │   │   ├── QPropertyDialog.cpp
                │   │   ├── QPropertyDialog.h
                │   │   ├── SequenceCameraSelector.cpp
                │   │   └── SequenceEventSelector.cpp
                │   ├── QT/
                │   │   └── Widgets/
                │   │       ├── QWaitProgress.cpp
                │   │       └── QWaitProgress.h
                │   └── Serialization/
                │       ├── Decorators/
                │       │   ├── EditorActionButton.h
                │       │   ├── EditToolButton.h
                │       │   ├── IconXPM.h
                │       │   ├── IGizmoSink.h
                │       │   ├── INavigationProvider.h
                │       │   ├── PythonActionButton.h
                │       │   ├── ToggleButton.h
                │       │   └── ToggleButtonImpl.h
                │       ├── PropertyTreeLegacy/
                │       │   ├── Color.cpp
                │       │   ├── Color.h
                │       │   ├── ConstStringList.cpp
                │       │   ├── ConstStringList.h
                │       │   ├── Factory.h
                │       │   ├── file_open.xpm
                │       │   ├── file_save.xpm
                │       │   ├── IDrawContext.h
                │       │   ├── IMenu.h
                │       │   ├── IUIFacade.h
                │       │   ├── MathUtils.h
                │       │   ├── PropertyIArchive.cpp
                │       │   ├── PropertyIArchive.h
                │       │   ├── PropertyOArchive.cpp
                │       │   ├── PropertyOArchive.h
                │       │   ├── PropertyRow.cpp
                │       │   ├── PropertyRow.h
                │       │   ├── PropertyRowBool.cpp
                │       │   ├── PropertyRowBool.h
                │       │   ├── PropertyRowButton.cpp
                │       │   ├── PropertyRowColor.cpp
                │       │   ├── PropertyRowColor.h
                │       │   ├── PropertyRowContainer.cpp
                │       │   ├── PropertyRowContainer.h
                │       │   ├── PropertyRowField.cpp
                │       │   ├── PropertyRowField.h
                │       │   ├── PropertyRowHorizontalLine.cpp
                │       │   ├── PropertyRowIconXPM.cpp
                │       │   ├── PropertyRowImpl.h
                │       │   ├── PropertyRowNumber.cpp
                │       │   ├── PropertyRowNumber.h
                │       │   ├── PropertyRowNumberField.cpp
                │       │   ├── PropertyRowNumberField.h
                │       │   ├── PropertyRowObject.cpp
                │       │   ├── PropertyRowObject.h
                │       │   ├── PropertyRowPointer.cpp
                │       │   ├── PropertyRowPointer.h
                │       │   ├── PropertyRowString.cpp
                │       │   ├── PropertyRowString.h
                │       │   ├── PropertyTreeLegacy.cpp
                │       │   ├── PropertyTreeLegacy.h
                │       │   ├── PropertyTreeMenuHandler.h
                │       │   ├── PropertyTreeModel.cpp
                │       │   ├── PropertyTreeModel.h
                │       │   ├── PropertyTreeOperator.cpp
                │       │   ├── PropertyTreeOperator.h
                │       │   ├── PropertyTreeStyle.h
                │       │   ├── Rect.h
                │       │   ├── Serialization.h
                │       │   ├── sigslot.h
                │       │   ├── TreeConfig.h
                │       │   ├── Unicode.cpp
                │       │   ├── Unicode.h
                │       │   └── ValidatorBlock.h
                │       └── QPropertyTree/
                │           ├── AssetDragDropLineEdit.cpp
                │           ├── AssetDragDropLineEdit.h
                │           ├── IPropertyTreeWidget.cpp
                │           ├── IPropertyTreeWidget.h
                │           ├── PropertyTree.cpp
                │           ├── PropertyTree.h
                │           ├── PropertyTreeFormWidget.cpp
                │           ├── PropertyTreeFormWidget.h
                │           ├── PropertyTreeIArchive.cpp
                │           ├── PropertyTreeIArchive.h
                │           ├── PropertyTreeModel.cpp
                │           ├── PropertyTreeModel.h
                │           ├── PropertyTreeOArchive.cpp
                │           ├── PropertyTreeOArchive.h
                │           ├── PropertyTreeTest.cpp
                │           ├── PropertyTreeTest.h
                │           └── PropertyTreeWidgets.cpp
                └── EditorCSharp/
                    ├── CMakeLists.txt
                    ├── CSharpAssetType.cpp
                    ├── CSharpAssetType.h
                    ├── csharpeditor.waf_files
                    ├── CSharpEditorPlugin.cpp
                    ├── CSharpEditorPlugin.h
                    ├── CSharpOutputModel.cpp
                    ├── CSharpOutputModel.h
                    ├── CSharpOutputWindow.cpp
                    ├── CSharpOutputWindow.h
                    ├── EditorCSharp.qrc
                    ├── StdAfx.cpp
                    ├── StdAfx.h
                    └── wscript


(Files content cropped to 300k characters, download full ingest to see more)
================================================
FILE: CMakeLists.txt
================================================
cmake_minimum_required(VERSION 3.14)

if(NOT DEFINED CRYENGINE_DIR)
	set(CRYENGINE_DIR "${CMAKE_CURRENT_SOURCE_DIR}")
endif()

# Part of the setup is split into the InitialSetup file so projects created by cryrun can include it.
# This needs to be re-visited after the toolchain files are cleaned up.
include(Tools/CMake/InitialSetup.cmake)

# Setting the project version
if (NOT VERSION)
	if (METADATA_VERSION)
		set(VERSION ${METADATA_VERSION})
	else()
		set(VERSION "1.0.0.0")
	endif()
endif()
set(METADATA_VERSION ${VERSION} CACHE STRING "Version number for executable metadata" FORCE)

# Declare the project.
set(METADATA_PROJECT_NAME "CRYENGINE" CACHE STRING "Name of the solution project")
project("${METADATA_PROJECT_NAME}_${BUILD_PLATFORM}"
		VERSION "${METADATA_VERSION}"
		LANGUAGES C CXX)

include(Tools/CMake/Configure.cmake)



================================================
FILE: CMakeSettings.json
================================================
{
  "configurations": [
   {
    "name": "Windows x64 Debug",
	"configurationType": "Debug",
    "generator": "Visual Studio 15 2017 Win64",
    "buildRoot": "${projectDir}\\Solutions\\Win64_Debug",
	"cmakeCommandArgs": "-D CMAKE_TOOLCHAIN_FILE=Tools\\CMake\\toolchain\\windows\\WindowsPC-MSVC.cmake"
   },
   {
    "name": "Windows x64 Profile",
	"configurationType": "Profile",
    "generator": "Visual Studio 15 2017 Win64",
    "buildRoot": "${projectDir}\\Solutions\\Win64_Profile",
	"cmakeCommandArgs": "-D CMAKE_TOOLCHAIN_FILE=Tools\\CMake\\toolchain\\windows\\WindowsPC-MSVC.cmake"
   },
   {
    "name": "Windows x64 Release",
	"configurationType": "Release",
    "generator": "Visual Studio 15 2017 Win64",
    "buildRoot": "${projectDir}\\Solutions\\Win64_Release",
	"cmakeCommandArgs": "-D CMAKE_TOOLCHAIN_FILE=Tools\\CMake\\toolchain\\windows\\WindowsPC-MSVC.cmake"
   }
 ]
}


================================================
FILE: Code/CryEngine/wscript
================================================
# Copyright 2001-2019 Crytek GmbH / Crytek Group. All rights reserved.

def build(bld):
	bld.recurse_subdirs(mandatory=False)



================================================
FILE: Code/CryEngine/Cry3DEngine/3dEngine.cpp
================================================
// Copyright 2001-2019 Crytek GmbH / Crytek Group. All rights reserved.

#include "StdAfx.h"
#include <CryAnimation/ICryAnimation.h>
#include <CryGame/IGameFramework.h>
#include <CryAudio/IAudioSystem.h>
#include <CryParticleSystem/IParticlesPfx2.h>
#include <CryRenderer/IStereoRenderer.h>

#include "3dEngine.h"
#include "3dEngineLoad.h"
#include "terrain.h"
#include "VisAreas.h"
#include "ObjMan.h"
#include "terrain_water.h"

#include "DecalManager.h"
#include "Vegetation.h"
#include "IndexedMesh.h"

#include "MatMan.h"

#include "Brush.h"
#include "PolygonClipContext.h"
#include "CGF/CGFLoader.h"
#include "CGF/ChunkFileWriters.h"
#include "CGF/ReadOnlyChunkFile.h"

#include "SkyLightManager.h"
#include "FogVolumeRenderNode.h"
#include "RoadRenderNode.h"
#include "DecalRenderNode.h"
#include "TimeOfDay.h"
#include "LightEntity.h"
#include "FogVolumeRenderNode.h"
#include "ObjectsTree.h"
#include "WaterVolumeRenderNode.h"
#include "WaterWaveRenderNode.h"
#include "DistanceCloudRenderNode.h"
#include "WaterWaveRenderNode.h"
#include "RopeRenderNode.h"
#include "RenderMeshMerger.h"
#include "PhysCallbacks.h"
#include "DeferredCollisionEvent.h"
#include "MergedMeshRenderNode.h"
#include "BreakableGlassRenderNode.h"
#include "BreezeGenerator.h"
#include "OpticsManager.h"
#include "GeomCacheRenderNode.h"
#include "GeomCacheManager.h"
#include "ClipVolumeManager.h"
#include "RenderNodes/CharacterRenderNode.h"
#include <CryNetwork/IRemoteCommand.h>
#include "CloudBlockerRenderNode.h"
#include "WaterRippleManager.h"
#include "ShadowCache.h"
#include "StatObjFoliage.h"

#if defined(FEATURE_SVO_GI)
	#include "SVO/SceneTreeManager.h"
#endif

#include <CryThreading/IJobManager_JobDelegator.h>

threadID Cry3DEngineBase::m_nMainThreadId = 0;
bool Cry3DEngineBase::m_bRenderTypeEnabled[eERType_TypesNum];
ISystem* Cry3DEngineBase::m_pSystem = 0;
#if !defined(DEDICATED_SERVER)
IRenderer* Cry3DEngineBase::m_pRenderer = 0;
#else
IRenderer* const Cry3DEngineBase::m_pRenderer = 0;
#endif
ITimer* Cry3DEngineBase::m_pTimer = 0;
ILog* Cry3DEngineBase::m_pLog = 0;
IPhysicalWorld* Cry3DEngineBase::m_pPhysicalWorld = 0;
CTerrain* Cry3DEngineBase::m_pTerrain = 0;
CObjManager* Cry3DEngineBase::m_pObjManager = 0;
IConsole* Cry3DEngineBase::m_pConsole = 0;
C3DEngine* Cry3DEngineBase::m_p3DEngine = 0;
CVars* Cry3DEngineBase::m_pCVars = 0;
ICryPak* Cry3DEngineBase::m_pCryPak = 0;
IParticleManager* Cry3DEngineBase::m_pPartManager = 0;
IOpticsManager* Cry3DEngineBase::m_pOpticsManager = 0;
CDecalManager* Cry3DEngineBase::m_pDecalManager = 0;
CSkyLightManager* Cry3DEngineBase::m_pSkyLightManager = 0;
CVisAreaManager* Cry3DEngineBase::m_pVisAreaManager = 0;
CClipVolumeManager* Cry3DEngineBase::m_pClipVolumeManager = 0;
CWaterWaveManager* Cry3DEngineBase::m_pWaterWaveManager = 0;
CRenderMeshMerger* Cry3DEngineBase::m_pRenderMeshMerger = 0;
CMatMan* Cry3DEngineBase::m_pMatMan = 0;
CMergedMeshesManager* Cry3DEngineBase::m_pMergedMeshesManager = 0;
CBreezeGenerator* Cry3DEngineBase::m_pBreezeGenerator = 0;
IStreamedObjectListener* Cry3DEngineBase::m_pStreamListener = 0;
#if defined(USE_GEOM_CACHES)
CGeomCacheManager* Cry3DEngineBase::m_pGeomCacheManager = 0;
#endif

bool Cry3DEngineBase::m_bLevelLoadingInProgress = false;
bool Cry3DEngineBase::m_bIsInRenderScene = false;
int Cry3DEngineBase::m_mergedMeshesPoolSize = 0;

#if CRY_PLATFORM_DESKTOP
bool Cry3DEngineBase::m_bEditor = false;
#endif
ESystemConfigSpec Cry3DEngineBase::m_LightConfigSpec = CONFIG_VERYHIGH_SPEC;
int Cry3DEngineBase::m_arrInstancesCounter[eERType_TypesNum];
IEditorHeightmap* C3DEngine::m_pEditorHeightmap = 0;

// The only direct particle function needed by 3DEngine, implemented in the same DLL.
extern IParticleManager* CreateParticleManager(bool bEnable);
extern void              DestroyParticleManager(IParticleManager* pParticleManager);

namespace
{
class CLoadLogListener : public ILoaderCGFListener
{
public:
	virtual ~CLoadLogListener(){}
	virtual void Warning(const char* format) { Cry3DEngineBase::Warning("%s", format); }
	virtual void Error(const char* format)   { Cry3DEngineBase::Error("%s", format); }
	virtual bool IsValidationEnabled()       { return Cry3DEngineBase::GetCVars()->e_StatObjValidate != 0; }
};
}

///////////////////////////////////////////////////////////////////////////////
C3DEngine::C3DEngine(ISystem* pSystem)
	: m_nStreamingFramesSinceLevelStart(0)
	, m_bPreCacheEndEventSent(false)
{
	m_renderNodeStatusListenersArray.resize(EERType::eERType_TypesNum, TRenderNodeStatusListeners(0));

	//#if defined(_DEBUG) && CRY_PLATFORM_WINDOWS
	//	_CrtSetDbgFlag(_CRTDBG_ALLOC_MEM_DF | _CRTDBG_LEAK_CHECK_DF);
	//#endif

	// Level info
	m_fSunSpecMult = 1.f;
	m_bAreaActivationInUse = false;
	m_objectLayersModificationId = 0;

	CVegetation::InitVegDecomprTable();

	Cry3DEngineBase::m_nMainThreadId = CryGetCurrentThreadId();
	Cry3DEngineBase::m_pSystem = pSystem;
#if !defined(DEDICATED_SERVER)
	Cry3DEngineBase::m_pRenderer = gEnv->pRenderer;
#endif
	Cry3DEngineBase::m_pTimer = gEnv->pTimer;
	Cry3DEngineBase::m_pLog = gEnv->pLog;
	Cry3DEngineBase::m_pPhysicalWorld = gEnv->pPhysicalWorld;
	Cry3DEngineBase::m_pConsole = gEnv->pConsole;
	Cry3DEngineBase::m_p3DEngine = this;
	Cry3DEngineBase::m_pCryPak = gEnv->pCryPak;
	Cry3DEngineBase::m_pCVars = 0;
	Cry3DEngineBase::m_pRenderMeshMerger = new CRenderMeshMerger;
	Cry3DEngineBase::m_pMergedMeshesManager = new CMergedMeshesManager;
	Cry3DEngineBase::m_pMatMan = new CMatMan;
	Cry3DEngineBase::m_pBreezeGenerator = new CBreezeGenerator;
	Cry3DEngineBase::m_pStreamListener = NULL;

	memset(Cry3DEngineBase::m_arrInstancesCounter, 0, sizeof(Cry3DEngineBase::m_arrInstancesCounter));

#if CRY_PLATFORM_DESKTOP
	m_bEditor = gEnv->IsEditor();
#endif

	m_pCVars = new CVars();

	m_pTimeOfDay = NULL;

	m_szLevelFolder[0] = 0;

	m_pSun = 0;
	m_nFlags = 0;
	m_pTerrainWaterMat = 0;
	m_nWaterBottomTexId = 0;
	m_vSunDir = Vec3(5.f, 5.f, DISTANCE_TO_THE_SUN);
	m_vSunDirRealtime = Vec3(5.f, 5.f, DISTANCE_TO_THE_SUN).GetNormalized();

	m_pTerrain = 0;

	m_nBlackTexID = 0;

	m_nCurWind = 0;
	m_bWindJobRun = false;
	m_pWindField = NULL;

	// create components
	m_pObjManager = CryAlignedNew<CObjManager>();

	m_pDecalManager = 0;    //new CDecalManager   (m_pSystem, this);
	m_pPartManager = 0;
	m_pOpticsManager = 0;
	m_pVisAreaManager = 0;
	m_pClipVolumeManager = new CClipVolumeManager();
	m_pSkyLightManager = CryAlignedNew<CSkyLightManager>();
	m_pWaterWaveManager = 0;
	m_pWaterRippleManager.reset(new CWaterRippleManager());

	m_pPhysMaterialEnumerator = 0;

	m_fMaxViewDistHighSpec = 8000;
	m_fMaxViewDistLowSpec = 1000;
	m_fTerrainDetailMaterialsViewDistRatio = 1.f;

	for (int skyTypeIdx = 0; skyTypeIdx < eSkySpec_NumSkySpecs; ++skyTypeIdx)
		m_pSkyMat[skyTypeIdx] = nullptr;

	m_pGlobalWind = 0;
	m_vWindSpeed(1, 0, 0);

	m_bOcean = true;
	m_nOceanRenderFlags = 0;

	m_bSunShadows = m_bShowTerrainSurface = true;
	m_bSunShadowsFromTerrain = false;
	m_nSunAdditionalCascades = 0;
	m_nGsmCache = 0;
	m_CachedShadowsBounds.Reset();
	m_nCachedShadowsUpdateStrategy = ShadowMapFrustum::ShadowCacheData::eFullUpdate;

	m_fSunClipPlaneRange = 256.0f;
	m_fSunClipPlaneRangeShift = 0.0f;

	m_nRealLightsNum = m_nDeferredLightsNum = m_nDeferredProbesNum = 0;

	union
	{
		CStatObjFoliage* CStatObjFoliage::* next;
		INT_PTR                             inext;
	} tmp;
	tmp.inext = 0;
	tmp.next = &CStatObjFoliage::m_next;
	m_pFirstFoliage = m_pLastFoliage = (CStatObjFoliage*)((INT_PTR)&m_pFirstFoliage - tmp.inext);

	m_fLightsHDRDynamicPowerFactor = 0.0f;

	m_vHDRFilmCurveParams = Vec4(1.0f, 1.0f, 1.0f, 1.0f);
	m_vHDREyeAdaptation = Vec3(0.05f, 0.8f, 0.9f);
	m_fHDRBloomAmount = 0.0f;
	m_vColorBalance = Vec3(1.0f, 1.0f, 1.0f);
	m_fHDRSaturation = 1.0f;

	m_vSkyHightlightPos.Set(0, 0, 0);
	m_vSkyHightlightCol.Set(0, 0, 0);
	m_fSkyHighlightSize = 0;

	m_volFogGlobalDensity = 0.02f;
	m_volFogGlobalDensityMultiplierLDR = 1.0f;
	m_volFogFinalDensityClamp = 1.0f;

	m_idMatLeaves = -1;

	/* // structures should not grow too much - commented out as in 64bit they do
	   assert(sizeof(CVegetation)-sizeof(IRenderNode)<=52);
	   assert(sizeof(CBrush)-sizeof(IRenderNode)<=120);
	   assert(sizeof(IRenderNode)<=96);
	 */
	m_oceanFogColor = 0.2f * Vec3(29.0f, 102.0f, 141.0f) / 255.0f;
	m_oceanFogColorShallow = Vec3(0, 0, 0); //0.5f * Vec3( 206.0f, 249.0f, 253.0f ) / 255.0f;
	m_oceanFogDensity = 0;                  //0.2f;

	m_oceanCausticsDistanceAtten = 100.0f;
	m_oceanCausticsMultiplier = 1.0f;
	m_oceanCausticsDarkeningMultiplier = 1.0f;

	m_oceanCausticHeight = 2.5f;
	m_oceanCausticDepth = 8.0f;
	m_oceanCausticIntensity = 1.0f;

	m_oceanWindDirection = 1;
	m_oceanWindSpeed = 4.0f;
	m_oceanWavesAmount = 1.5f;
	m_oceanWavesSize = 0.75f;

	m_fRefreshSceneDataCVarsSumm = -1;
	m_nRenderTypeEnableCVarSum = -1;

	/*
	   CTerrainNode::SetProcObjChunkPool(new SProcObjChunkPool);
	   CTerrainNode::SetProcObjPoolMan(new CProcVegetPoolMan);
	 */
	m_bResetRNTmpDataPool = false;

	m_fSunDirUpdateTime = 0;
	m_vSunDirNormalized.zero();

	m_volFogRamp = Vec3(0, 100.0f, 0);
	m_volFogShadowRange = Vec3(0.1f, 0, 0);
	m_volFogShadowDarkening = Vec3(0.25f, 1, 1);
	m_volFogShadowEnable = Vec3(0, 0, 0);
	m_volFog2CtrlParams = Vec3(64.0f, 0.0f, 1.0f);
	m_volFog2ScatteringParams = Vec3(1.0f, 0.3f, 0.6f);
	m_volFog2Ramp = Vec3(0.0f, 0.0f, 0.0f);
	m_volFog2Color = Vec3(1.0f, 1.0f, 1.0f);
	m_volFog2GlobalDensity = Vec3(0.1f, 1.0f, 0.4f);
	m_volFog2HeightDensity = Vec3(0.0f, 1.0f, 0.1f);
	m_volFog2HeightDensity2 = Vec3(4000.0f, 0.0001f, 0.95f);
	m_volFog2Color1 = Vec3(1.0f, 1.0f, 1.0f);
	m_volFog2Color2 = Vec3(1.0f, 1.0f, 1.0f);
	m_nightSkyHorizonCol = Vec3(0, 0, 0);
	m_nightSkyZenithCol = Vec3(0, 0, 0);
	m_nightSkyZenithColShift = 0;
	m_nightSkyStarIntensity = 0;
	m_moonDirection = Vec3(0, 0, 0);
	m_nightMoonCol = Vec3(0, 0, 0);
	m_nightMoonSize = 0;
	m_nightMoonInnerCoronaCol = Vec3(0, 0, 0);
	m_nightMoonInnerCoronaScale = 1.0f;
	m_nightMoonOuterCoronaCol = Vec3(0, 0, 0);
	m_nightMoonOuterCoronaScale = 1.0f;
	m_moonRotationLatitude = 0;
	m_moonRotationLongitude = 0;
	m_skyboxMultiplier = 1.0f;
	m_dayNightIndicator = 1.0f;
	m_fogColor2 = Vec3(0, 0, 0);
	m_fogColorRadial = Vec3(0, 0, 0);
	m_volFogHeightDensity = Vec3(0, 1, 0);
	m_volFogHeightDensity2 = Vec3(4000.0f, 0, 0);
	m_volFogGradientCtrl = Vec3(1, 1, 1);

	m_fogColorSkylightRayleighInScatter = Vec3(0, 0, 0);

	m_vFogColor = Vec3(1.0f, 1.0f, 1.0f);
	m_vAmbGroundCol = Vec3(0.0f, 0.0f, 0.0f);

	m_dawnStart = 350.0f / 60.0f;
	m_dawnEnd = 360.0f / 60.0f;
	m_duskStart = 12.0f + 360.0f / 60.0f;
	m_duskEnd = 12.0f + 370.0f / 60.0f;

	m_fCloudShadingSunLightMultiplier = 0;
	m_fCloudShadingSkyLightMultiplier = 0;
	m_vCloudShadingCustomSunColor = Vec3(0, 0, 0);
	m_vCloudShadingCustomSkyColor = Vec3(0, 0, 0);

	m_vVolCloudAtmosphericScattering = Vec3(0, 0, 0);
	m_vVolCloudGenParams = Vec3(0, 0, 0);
	m_vVolCloudScatteringLow = Vec3(0, 0, 0);
	m_vVolCloudScatteringHigh = Vec3(0, 0, 0);
	m_vVolCloudGroundColor = Vec3(0, 0, 0);
	m_vVolCloudScatteringMulti = Vec3(0, 0, 0);
	m_vVolCloudWindAtmospheric = Vec3(0, 0, 0);
	m_vVolCloudTurbulence = Vec3(0, 0, 0);
	m_vVolCloudEnvParams = Vec3(0, 0, 0);
	m_vVolCloudGlobalNoiseScale = Vec3(0, 0, 0);
	m_vVolCloudRenderParams = Vec3(0, 0, 0);
	m_vVolCloudTurbulenceNoiseScale = Vec3(0, 0, 0);
	m_vVolCloudTurbulenceNoiseParams = Vec3(0, 0, 0);
	m_vVolCloudDensityParams = Vec3(0, 0, 0);
	m_vVolCloudMiscParams = Vec3(0, 0, 0);
	m_vVolCloudTilingSize = Vec3(0, 0, 0);
	m_vVolCloudTilingOffset = Vec3(0, 0, 0);

	m_vPrevMainFrameCamPos.Set(-1000000.f, -1000000.f, -1000000.f);
	m_fAverageCameraSpeed = 0;
	m_vAverageCameraMoveDir = Vec3(0);
	m_bContentPrecacheRequested = false;
	m_bTerrainTextureStreamingInProgress = false;
	m_bLayersActivated = false;
	m_eShadowMode = ESM_NORMAL;

	ClearDebugFPSInfo();

	m_fMaxViewDistScale = 1.f;

	m_ptexIconLowMemoryUsage = NULL;
	m_ptexIconAverageMemoryUsage = NULL;
	m_ptexIconHighMemoryUsage = NULL;
	m_ptexIconEditorConnectedToConsole = NULL;
	m_pScreenshotCallback = 0;
	m_bInShutDown = false;
	m_bInUnload = false;
	m_bInLoad = false;

	m_pDeferredPhysicsEventManager = new CDeferredPhysicsEventManager();

#if defined(USE_GEOM_CACHES)
	if (m_pCVars->e_GeomCacheEnabled)
	{
		m_pGeomCacheManager = new CGeomCacheManager();
	}
#endif

	m_LightVolumesMgr.Init();

	m_pBreakableBrushHeap = NULL;

	m_fZoomFactor = 0.0f;
	m_fPrevZoomFactor = 0.0f;
	m_bZoomInProgress = false;
	m_nZoomMode = 0;

	m_fAmbMaxHeight = 0.0f;
	m_fAmbMinHeight = 0.0f;

	m_pLightQuality = NULL;
	m_fSaturation = 0.0f;

	m_fGsmRange = 0.0f;
	m_fGsmRangeStep = 0.0f;
	m_fShadowsConstBias = 0.0f;
	m_fShadowsSlopeBias = 0.0f;
	m_nCustomShadowFrustumCount = 0;
	m_bHeightMapAoEnabled = false;
	m_bIntegrateObjectsIntoTerrain = false;

	m_nCurrentWindAreaList = 0;
	m_pLevelStatObjTable = NULL;
	m_pLevelMaterialsTable = NULL;
	m_bLevelFilesEndian = false;

	ClearPrecacheInfo();
}

//////////////////////////////////////////////////////////////////////
C3DEngine::~C3DEngine()
{
	m_bInShutDown = true;
	m_bInUnload = true;
	m_bInLoad = false;

	assert(IsHeapValid());

	delete m_pTimeOfDay;
	delete m_pDecalManager;
	delete m_pVisAreaManager;
	SAFE_DELETE(m_pClipVolumeManager);

	CryAlignedDelete(m_pSkyLightManager);
	m_pSkyLightManager = 0;
	SAFE_DELETE(m_pObjectsTree);
	delete m_pRenderMeshMerger;
	delete m_pMatMan;
	m_pMatMan = 0;

	delete m_pCVars;

	delete m_pDeferredPhysicsEventManager;
}

//////////////////////////////////////////////////////////////////////

void C3DEngine::RemoveEntInFoliage(int i, IPhysicalEntity* pent)
{
	IPhysicalEntity* pent1 = m_pPhysicalWorld->GetPhysicalEntityById(m_arrEntsInFoliage[i].id);
	pe_params_foreign_data pfd;
	if (!pent)
		pent = pent1;
	else if (pent != pent1)
	{
		// probably someone overwrote foreign flags
		for (i = m_arrEntsInFoliage.size() - 1; i >= 0 && pent != m_pPhysicalWorld->GetPhysicalEntityById(m_arrEntsInFoliage[i].id); i--)
			;
		if (i < 0)
			return;
	}
	if (pent && pent->GetParams(&pfd) && (pfd.iForeignFlags >> 8 & 255) == i + 1)
	{
		MARK_UNUSED pfd.pForeignData, pfd.iForeignData, pfd.iForeignFlags;
		pfd.iForeignFlagsAND = 255;
		pent->SetParams(&pfd, 1);
	}
	int j = m_arrEntsInFoliage.size() - 1;
	if (i < j)
	{
		m_arrEntsInFoliage[i] = m_arrEntsInFoliage[j];
		if ((pent = m_pPhysicalWorld->GetPhysicalEntityById(m_arrEntsInFoliage[i].id)) && pent->GetParams(&pfd) &&
		    (pfd.iForeignFlags >> 8 & 255) == j + 1)
		{
			MARK_UNUSED pfd.pForeignData, pfd.iForeignData;
			pfd.iForeignFlags = pfd.iForeignFlags & 255 | (i + 1) << 8;
			pent->SetParams(&pfd, 1);
		}
	}
	m_arrEntsInFoliage.DeleteLast();
}

bool C3DEngine::Init()
{
	m_pPartManager = CreateParticleManager(!gEnv->IsDedicated());
	m_pSystem->SetIParticleManager(m_pPartManager);

	m_pOpticsManager = new COpticsManager;
	m_pSystem->SetIOpticsManager(m_pOpticsManager);

	CRY_ASSERT(m_pWaterRippleManager);
	m_pWaterRippleManager->Initialize();

	for (int i = 0; i < eERType_TypesNum; i++)
	{
		m_bRenderTypeEnabled[i] = true;
	}

	UpdateRenderTypeEnableLookup();

	// Allocate the temporary pool used for allocations during streaming and loading
	const size_t tempPoolSize = static_cast<size_t>(GetCVars()->e_3dEngineTempPoolSize) << 10;
	CRY_ASSERT(tempPoolSize != 0, "C3DEngine::Init() temp pool size is set to 0");

	{
		MEMSTAT_CONTEXT(EMemStatContextType::Other, "3Engine Temp Pool");

		if (!CTemporaryPool::Initialize(tempPoolSize))
		{
			CryFatalError("C3DEngine::Init() could not initialize temporary pool");
			return false;
		}
	}

	SFrameLodInfo frameLodInfo;
	frameLodInfo.fLodRatio = GetCVars()->e_LodRatio;

	frameLodInfo.fTargetSize = GetCVars()->e_LodFaceAreaTargetSize;
	CRY_ASSERT(frameLodInfo.fTargetSize > 0.f);
	if (frameLodInfo.fTargetSize <= 0.f)
	{
		frameLodInfo.fTargetSize = 1.f;
	}

	frameLodInfo.nMinLod = GetCVars()->e_LodMin;
	frameLodInfo.nMaxLod = GetCVars()->e_LodMax;
	if (GetCVars()->e_Lods == 0)
	{
		frameLodInfo.nMinLod = 0;
		frameLodInfo.nMaxLod = 0;
	}
	SetFrameLodInfo(frameLodInfo);

	m_colorGradingCtrl.Init();

	return  (true);
}

bool C3DEngine::IsCameraAnd3DEngineInvalid(const SRenderingPassInfo& passInfo, const char* szCaller)
{
	if (!m_pObjManager)
	{
		return (true);
	}

	const CCamera& rCamera = passInfo.GetCamera();
	const float MAX_M23_REPORTED = 3000000.f; // MAT => upped from 100,000 which spammed this message on spear and cityhall. Really should stop editor generating
	// water levels that trigger this message.

	if (!_finite(rCamera.GetMatrix().m03) || !_finite(rCamera.GetMatrix().m13) || !_finite(rCamera.GetMatrix().m23) || GetMaxViewDistance() <= 0 ||
	    rCamera.GetMatrix().m23 < -MAX_M23_REPORTED || rCamera.GetMatrix().m23 > MAX_M23_REPORTED || rCamera.GetFov() < 0.0001f || rCamera.GetFov() > gf_PI)
	{
		Error("Bad camera passed to 3DEngine from %s: Pos=(%.1f, %.1f, %.1f), Fov=%.1f, MaxViewDist=%.1f. Maybe the water level is too extreme.",
		      szCaller,
		      rCamera.GetMatrix().m03, rCamera.GetMatrix().m13, rCamera.GetMatrix().m23,
		      rCamera.GetFov(), _finite(rCamera.GetMatrix().m03) ? GetMaxViewDistance() : 0);
		return true;
	}

	return false;

}

void C3DEngine::OnFrameStart()
{
	FUNCTION_PROFILER_3DENGINE;
	MEMSTAT_FUNCTION_CONTEXT(EMemStatContextType::Other);

	if (m_pPartManager)
		m_pPartManager->OnFrameStart();

	m_nRenderWorldUSecs = 0;
	m_pDeferredPhysicsEventManager->Update();

#if defined(USE_GEOM_CACHES)
	if (m_pGeomCacheManager && !m_bLevelLoadingInProgress)
	{
		m_pGeomCacheManager->StreamingUpdate();
	}
#endif

	UpdateWindAreas();

	if (m_pWaterRippleManager)
	{
		m_pWaterRippleManager->OnFrameStart();
	}
}

float g_oceanLevel, g_oceanStep;
float GetOceanLevelCallback(int ix, int iy)
{
	return gEnv->p3DEngine->GetAccurateOceanHeight(Vec3(ix * g_oceanStep, iy * g_oceanStep, g_oceanLevel));
	/*pe_status_waterman psw;
	   gEnv->pPhysicalWorld->GetWatermanStatus(&psw);
	   Vec2 pos = Vec2((float)ix,(float)iy)*GetFloatCVar(e_PhysOceanCell)-Vec2(psw.origin);
	   Vec2i itile(FtoI(pos.x*0.25f-0.5f), FtoI(pos.y*0.25f-0.5f));
	   if ((itile.x|itile.y)<0 || max(itile.x,itile.y)>6)
	   return g_oceanLevel;
	   SWaterTileBase *pTile = psw.pTiles[itile.x+itile.y*7];
	   if (!pTile || !pTile->bActive)
	   return g_oceanLevel;
	   Vec2i ipos(FtoI((pos.x-itile.x*4)*10.0f-0.5f), FtoI((pos.y-itile.y*4)*10.0f-0.5f));
	   return psw.origin.z+pTile->ph[itile.x+itile.y*40];*/
}
unsigned char GetOceanSurfTypeCallback(int ix, int iy)
{
	return 0;
}

void C3DEngine::Update()
{
	MEMSTAT_FUNCTION_CONTEXT(EMemStatContextType::Other);
	FUNCTION_PROFILER_3DENGINE;

	m_LightConfigSpec = (ESystemConfigSpec)GetCurrentLightSpec();

	///	if(m_pVisAreaManager)
	//	m_pVisAreaManager->Preceche(m_pObjManager);

	if (GetObjManager())
		GetObjManager()->ClearStatObjGarbage();

	if (m_pTerrain)
	{
		m_pTerrain->Recompile_Modified_Incrementaly_RoadRenderNodes();
	}

	if (m_bEditor)
		CRoadRenderNode::FreeStaticMemoryUsage();

	if (m_pDecalManager)
		m_pDecalManager->Update(GetTimer()->GetFrameTime());

	if (GetCVars()->e_PrecacheLevel == 3)
		PrecacheLevel(true, 0, 0);

	DebugDraw_Draw();

	ProcessCVarsChange();

	pe_params_area pa;
	IPhysicalEntity* pArea;
	if ((pArea = gEnv->pPhysicalWorld->AddGlobalArea())->GetParams(&pa))
	{
		g_oceanLevel = GetWaterLevel();
		bool bOceanEnabled = GetFloatCVar(e_PhysOceanCell) > 0 && g_oceanLevel > 0;

		if (bOceanEnabled && (!pa.pGeom || g_oceanStep != GetFloatCVar(e_PhysOceanCell)))
		{
			new(&pa)pe_params_area;
			primitives::heightfield hf;
			hf.origin.zero().z = g_oceanLevel;
			g_oceanStep = GetFloatCVar(e_PhysOceanCell);
			hf.size.set((int)(8192 / g_oceanStep), (int)(8192 / g_oceanStep));
			hf.step.set(g_oceanStep, g_oceanStep);
			hf.fpGetHeightCallback = GetOceanLevelCallback;
			hf.fpGetSurfTypeCallback = GetOceanSurfTypeCallback;
			hf.Basis.SetIdentity();
			hf.bOriented = 0;
			hf.typemask = 255;
			hf.typehole = 255;
			hf.heightscale = 1.0f;
			pa.pGeom = gEnv->pPhysicalWorld->GetGeomManager()->CreatePrimitive(primitives::heightfield::type, &hf);
			pArea->SetParams(&pa);

			Vec4 par0, par1;
			GetOceanAnimationParams(par0, par1);
			pe_params_buoyancy pb;
			pb.waterFlow = Vec3(par1.z, par1.y, 0) * (par0.z * 0.25f); // tone down the speed
			//pArea->SetParams(&pb);
		}
		else if (!bOceanEnabled && pa.pGeom)
		{
			new(&pa)pe_params_area;
			pa.pGeom = 0;
			pArea->SetParams(&pa);
			pe_params_buoyancy pb;
			pb.waterFlow.zero();
			pArea->SetParams(&pb);
		}
	}

	CRenderMeshUtils::ClearHitCache();

	CleanUpOldDecals();

	CDecalRenderNode::ResetDecalUpdatesCounter();

	if (m_pBreezeGenerator)
		m_pBreezeGenerator->Update();

	if (m_pBreakableBrushHeap)
		m_pBreakableBrushHeap->Cleanup();

	m_bTerrainTextureStreamingInProgress = false;
	if (CTerrain* const pTerrain = GetTerrain())
	{
		if (pTerrain->GetNotReadyTextureNodesCount() > 0)
		{
			m_bTerrainTextureStreamingInProgress = true;
		}
	}
}

void C3DEngine::Tick()
{
	MEMSTAT_FUNCTION_CONTEXT(EMemStatContextType::Other);
	threadID nThreadID = 0;

	if (GetRenderer())
	{
		GetRenderer()->EF_Query(EFQ_RenderThreadList, nThreadID);
	}

	GetMatMan()->DelayedMaterialDeletion();

	TickDelayedRenderNodeDeletion();

	// clear stored cameras from last frame
	m_RenderingPassCameras[nThreadID].clear();
}

void C3DEngine::ProcessCVarsChange()
{
	static int nObjectLayersActivation = -1;

	if (nObjectLayersActivation != GetCVars()->e_ObjectLayersActivation)
	{
		if (GetCVars()->e_ObjectLayersActivation == 2)
			ActivateObjectsLayer(~0, true, true, true, true, "ALL_OBJECTS");
		if (GetCVars()->e_ObjectLayersActivation == 3)
			ActivateObjectsLayer(~0, false, true, true, true, "ALL_OBJECTS");

		nObjectLayersActivation = GetCVars()->e_ObjectLayersActivation;
	}

	float fNewCVarsSumm =
		GetCVars()->e_ShadowsCastViewDistRatio +
		GetCVars()->e_LodTransitionSpriteDistRatio +
		GetCVars()->e_LodTransitionSpriteMinDist +
		GetCVars()->e_VegetationUseTerrainColor +
		GetCVars()->e_TerrainDetailMaterials +
		GetCVars()->e_ObjectsTreeNodeMinSize +
		GetCVars()->e_ObjectsTreeNodeSizeRatio +
		GetCVars()->e_ViewDistRatio +
		GetCVars()->e_ViewDistMin +
		GetCVars()->e_ViewDistRatioDetail +
		GetCVars()->e_ViewDistRatioVegetation +
		GetCVars()->e_ViewDistRatioLights +
		GetCVars()->e_DefaultMaterial +
		GetCVars()->e_VegetationSpritesDistanceRatio +
		GetCVars()->e_VegetationSpritesDistanceCustomRatioMin +
		GetCVars()->e_VegetationSpritesMinDistance +
		GetGeomDetailScreenRes() +
		GetCVars()->e_Portals +
		GetCVars()->e_DebugDraw +
		GetFloatCVar(e_ViewDistCompMaxSize) +
		GetCVars()->e_DecalsDeferredStatic +
		GetCVars()->e_TerrainBlendingDebug +
		GetCVars()->e_TerrainDetailMaterialsWeightedBlending;

	if (m_fRefreshSceneDataCVarsSumm != -1 && m_fRefreshSceneDataCVarsSumm != fNewCVarsSumm)
	{
		UpdateStatInstGroups();

		// re-register every instance in level
		GetObjManager()->ReregisterEntitiesInArea(nullptr, true);

		// force recreation of terrain meshes
		if (CTerrain* const pTerrain = GetTerrain())
		{
			pTerrain->ResetTerrainVertBuffers(NULL);
		}

		// refresh vegetation properties
		UpdateStatInstGroups();

		// force refresh of temporary data associated with visible objects
		MarkRNTmpDataPoolForReset();
	}

	m_fRefreshSceneDataCVarsSumm = fNewCVarsSumm;

	int nRenderTypeEnableCVarSum = (GetCVars()->e_Vegetation << 0)
	                               + (GetCVars()->e_Brushes << 1)
	                               + (GetCVars()->e_Entities << 2);

	if (m_nRenderTypeEnableCVarSum != nRenderTypeEnableCVarSum)
	{
		m_nRenderTypeEnableCVarSum = nRenderTypeEnableCVarSum;

		UpdateRenderTypeEnableLookup();
	}

	{
		float fNewCVarsSumm2 = GetCVars()->e_LodRatio + GetCVars()->e_LodFaceAreaTargetSize +
		                       GetCVars()->e_PermanentRenderObjects;

		if (m_bEditor)
		{
			fNewCVarsSumm2 += float(int(GetSkyColor().GetLength() * 10) / 10);
		}

		static float fCVarsSumm2 = fNewCVarsSumm2;

		if (fCVarsSumm2 != fNewCVarsSumm2)
		{
			MarkRNTmpDataPoolForReset();

			fCVarsSumm2 = fNewCVarsSumm2;
		}
	}

	SFrameLodInfo frameLodInfo;
	frameLodInfo.fLodRatio = GetCVars()->e_LodRatio;

	frameLodInfo.fTargetSize = GetCVars()->e_LodFaceAreaTargetSize;
	CRY_ASSERT(frameLodInfo.fTargetSize > 0.f);
	if (frameLodInfo.fTargetSize <= 0.f)
	{
		frameLodInfo.fTargetSize = 1.f;
	}

	frameLodInfo.nMinLod = GetCVars()->e_LodMin;
	frameLodInfo.nMaxLod = GetCVars()->e_LodMax;
	if (GetCVars()->e_Lods == 0)
	{
		frameLodInfo.nMinLod = 0;
		frameLodInfo.nMaxLod = 0;
	}
	SetFrameLodInfo(frameLodInfo);
}

//////////////////////////////////////////////////////////////////////
void C3DEngine::UpdateScene(const SRenderingPassInfo& passInfo)
{
	if (GetCVars()->e_Sun)
		UpdateSunLightSource(passInfo);

	FindPotentialLightSources(passInfo);

	// Set traceable fog volume areas
	CFogVolumeRenderNode::SetTraceableArea(AABB(passInfo.GetCamera().GetPosition(), 1024.0f), passInfo);
}

//////////////////////////////////////////////////////////////////////
void C3DEngine::ShutDown()
{
	if (GetRenderer() != GetSystem()->GetIRenderer())
		CryFatalError("Renderer was deallocated before I3DEngine::ShutDown() call");

	UnlockCGFResources();

	UnloadLevel();

#if defined(USE_GEOM_CACHES)
	SAFE_DELETE(m_pGeomCacheManager);
#endif

	DestroyParticleManager(m_pPartManager);
	m_pPartManager = nullptr;
	m_pSystem->SetIParticleManager(0);

	if (m_pOpticsManager)
	{
		delete m_pOpticsManager;
		m_pOpticsManager = 0;
		m_pSystem->SetIOpticsManager(m_pOpticsManager);
	}

	CRY_ASSERT(m_pWaterRippleManager);
	m_pWaterRippleManager->Finalize();
	m_pWaterRippleManager.reset();

	CryAlignedDelete(m_pObjManager);
	m_pObjManager = 0;

	if (GetPhysicalWorld())
	{
		CPhysCallbacks::Done();
	}

	// Free the temporary pool's underlying storage
	// and reset the pool
	if (!CTemporaryPool::Shutdown())
	{
		CryFatalError("C3DEngine::Shutdown() could not shutdown temporary pool");
	}
}

#if CRY_PLATFORM_WINDOWS
	#pragma warning( push )               //AMD Port
	#pragma warning( disable : 4311 )
#endif

#ifndef _RELEASE
void C3DEngine::ProcessStreamingLatencyTest(const CCamera& camIn, CCamera& camOut, const SRenderingPassInfo& passInfo)
{
	static float fSQTestOffset = 0;
	static PodArray<ITexture*> arrTestTextures;
	static ITexture* pTestTexture = 0;
	static ITexture* pLastNotReadyTexture = 0;
	static float fStartTime = 0;
	static float fDelayStartTime = 0;
	static size_t nMaxTexUsage = 0;

	static int nOpenRequestCount = 0;
	SStreamEngineOpenStats stats;
	gEnv->pSystem->GetStreamEngine()->GetStreamingOpenStatistics(stats);
	if (stats.nOpenRequestCount > nOpenRequestCount)
		nOpenRequestCount = stats.nOpenRequestCount;
	else
		nOpenRequestCount = max(0, nOpenRequestCount + stats.nOpenRequestCount) / 2;

	ICVar* pTSFlush = GetConsole()->GetCVar("r_TexturesStreamingDebug");

	if (GetCVars()->e_SQTestBegin == 1)
	{
		// Init waiting few seconds until streaming is stabilized and all required textures are loaded
		PrintMessage("======== Starting streaming latency test ========");
		fDelayStartTime = GetCurTimeSec();
		nMaxTexUsage = 0;
		GetCVars()->e_SQTestBegin = 2;
		PrintMessage("Waiting %.1f seconds and zero requests and no camera movement", GetCVars()->e_SQTestDelay);

		if (ICVar* pPart = GetConsole()->GetCVar("e_Particles"))
			pPart->Set(0);
		if (ICVar* pAI = GetConsole()->GetCVar("sys_AI"))
			pAI->Set(0);
	}
	else if (GetCVars()->e_SQTestBegin == 2)
	{
		// Perform waiting
		if (GetCurTimeSec() - fDelayStartTime > GetCVars()->e_SQTestDelay && !nOpenRequestCount && m_fAverageCameraSpeed < .01f)
		{
			pTSFlush->Set(0);
			GetCVars()->e_SQTestBegin = 3;
		}
		else
			pTSFlush->Set(3);
	}
	else if (GetCVars()->e_SQTestBegin == 3)
	{
		// Build a list of all important loaded textures
		PrintMessage("Collect information about loaded textures");

		fSQTestOffset = (float)GetCVars()->e_SQTestDistance;

		arrTestTextures.Clear();
		SRendererQueryGetAllTexturesParam param;

		GetRenderer()->EF_Query(EFQ_GetAllTextures, param);
		if (param.pTextures)
		{
			for (uint32 i = 0; i < param.numTextures; i++)
			{
				ITexture* pTexture = param.pTextures[i];
				if (pTexture->GetAccessFrameId() > (int)(passInfo.GetMainFrameID() - 4))
					if (pTexture->GetMinLoadedMip() <= GetCVars()->e_SQTestMip)
						if (pTexture->IsStreamable())
							if (pTexture->GetWidth() * pTexture->GetHeight() >= 256 * 256)
							{
								arrTestTextures.Add(pTexture);

								if (strstr(pTexture->GetName(), GetCVars()->e_SQTestTextureName->GetString()))
								{
									pTestTexture = pTexture;
									PrintMessage("Test texture name: %s", pTexture->GetName());
								}
							}
			}

		}

		GetRenderer()->EF_Query(EFQ_GetAllTexturesRelease, param);

		PrintMessage("%d test textures found", arrTestTextures.Count());

		PrintMessage("Teleporting camera to offset position");

		GetCVars()->e_SQTestBegin = 4;
	}
	else if (GetCVars()->e_SQTestBegin == 4)
	{
		// Init waiting few seconds until streaming is stabilized and all required textures are loaded
		fDelayStartTime = GetCurTimeSec();
		GetCVars()->e_SQTestBegin = 5;
		PrintMessage("Waiting %.1f seconds and zero requests and no camera movement", GetCVars()->e_SQTestDelay);
	}
	else if (GetCVars()->e_SQTestBegin == 5)
	{
		// Move camera to offset position and perform waiting
		Matrix34 mat = camIn.GetMatrix();
		Vec3 vPos = camIn.GetPosition() - camIn.GetViewdir() * fSQTestOffset;
		mat.SetTranslation(vPos);
		camOut.SetMatrix(mat);

		if (GetCurTimeSec() - fDelayStartTime > GetCVars()->e_SQTestDelay && !nOpenRequestCount && m_fAverageCameraSpeed < .01f)
		{
			PrintMessage("Begin camera movement");
			GetCVars()->e_SQTestBegin = 6;
			pTSFlush->Set(0);
		}
		else
			pTSFlush->Set(3);
	}
	else if (GetCVars()->e_SQTestBegin == 6)
	{
		// Process camera movement from offset position to test point
		Matrix34 mat = camIn.GetMatrix();
		Vec3 vPos = camIn.GetPosition() - camIn.GetViewdir() * fSQTestOffset;
		mat.SetTranslation(vPos);
		camOut.SetMatrix(mat);

		fSQTestOffset -= GetTimer()->GetFrameTime() * (float)GetCVars()->e_SQTestMoveSpeed;

		STextureStreamingStats statsTex(true);
		m_pRenderer->EF_Query(EFQ_GetTexStreamingInfo, statsTex);
		nMaxTexUsage = max(nMaxTexUsage, statsTex.nRequiredStreamedTexturesSize);

		if (fSQTestOffset <= 0)
		{
			PrintMessage("Finished camera movement");
			fStartTime = GetCurTimeSec();
			PrintMessage("Waiting for %d textures to stream in ...", arrTestTextures.Count());

			GetCVars()->e_SQTestBegin = 7;
			pLastNotReadyTexture = 0;
		}
	}
	else if (GetCVars()->e_SQTestBegin == 7)
	{
		// Wait until test all needed textures are loaded again

		STextureStreamingStats statsTex(true);
		m_pRenderer->EF_Query(EFQ_GetTexStreamingInfo, statsTex);
		nMaxTexUsage = max(nMaxTexUsage, statsTex.nRequiredStreamedTexturesSize);

		if (pTestTexture)
		{
			if (pTestTexture->GetMinLoadedMip() <= GetCVars()->e_SQTestMip)
			{
				PrintMessage("BINGO: Selected test texture loaded in %.1f sec", GetCurTimeSec() - fStartTime);
				pTestTexture = NULL;
				if (!arrTestTextures.Count())
				{
					GetCVars()->e_SQTestBegin = 0;
					GetConsole()->GetCVar("e_SQTestBegin")->Set(0);
				}
			}
		}

		if (arrTestTextures.Count())
		{
			int nFinishedNum = 0;
			for (int i = 0; i < arrTestTextures.Count(); i++)
			{
				if (arrTestTextures[i]->GetMinLoadedMip() <= GetCVars()->e_SQTestMip)
					nFinishedNum++;
				else
					pLastNotReadyTexture = arrTestTextures[i];
			}

			if (nFinishedNum == arrTestTextures.Count())
			{
				PrintMessage("BINGO: %d of %d test texture loaded in %.1f sec", nFinishedNum, arrTestTextures.Count(), GetCurTimeSec() - fStartTime);
				if (pLastNotReadyTexture)
					PrintMessage("LastNotReadyTexture: %s [%d x %d]", pLastNotReadyTexture->GetName(), pLastNotReadyTexture->GetWidth(), pLastNotReadyTexture->GetHeight());
				PrintMessage("MaxTexUsage: %" PRISIZE_T " MB", nMaxTexUsage / 1024 / 1024);
				arrTestTextures.Clear();

				GetCVars()->e_SQTestBegin = 0;
				GetConsole()->GetCVar("e_SQTestBegin")->Set(0);

				m_arrProcessStreamingLatencyTestResults.Add(GetCurTimeSec() - fStartTime);
				m_arrProcessStreamingLatencyTexNum.Add(nFinishedNum);

				if (GetCVars()->e_SQTestCount == 0)
				{
					gEnv->pCryPak->MakeDir("%USER%/TestResults");
					CryPathString path;
					gEnv->pCryPak->AdjustFileName("%USER%/TestResults/Streaming_Latency_Test.xml", path, ICryPak::FLAGS_PATH_REAL | ICryPak::FLAGS_FOR_WRITING);

					if (FILE* f = ::fopen(path, "wb"))
					{
						float fAverTime = 0;
						for (int i = 0; i < m_arrProcessStreamingLatencyTestResults.Count(); i++)
							fAverTime += m_arrProcessStreamingLatencyTestResults[i];
						fAverTime /= m_arrProcessStreamingLatencyTestResults.Count();

						int nAverTexNum = 0;
						for (int i = 0; i < m_arrProcessStreamingLatencyTexNum.Count(); i++)
							nAverTexNum += m_arrProcessStreamingLatencyTexNum[i];
						nAverTexNum /= m_arrProcessStreamingLatencyTexNum.Count();

						fprintf(f,
						        "<phase name=\"Streaming_Latency_Test\">\n"
						        "<metrics name=\"Streaming\">\n"
						        "<metric name=\"AvrLatency\" value=\"%.1f\"/>\n"
						        "<metric name=\"AvrTexNum\" value=\"%d\"/>\n"
						        "</metrics>\n"
						        "</phase>\n",
						        fAverTime,
						        nAverTexNum);

						::fclose(f);
					}

					if (GetCVars()->e_SQTestExitOnFinish)
						GetSystem()->Quit();
				}
			}
			else if ((passInfo.GetMainFrameID() & 31) == 0)
			{
				PrintMessage("Waiting: %d of %d test texture loaded in %.1f sec", nFinishedNum, arrTestTextures.Count(), GetCurTimeSec() - fStartTime);
			}
		}
	}
}
#endif

//////////////////////////////////////////////////////////////////////
void C3DEngine::UpdateRenderingCamera(const char* szCallerName, const SRenderingPassInfo& passInfo)
{
	CCamera newCam = passInfo.GetCamera();

#if defined(FEATURE_SVO_GI)
	if (passInfo.IsGeneralPass())
		CSvoManager::Update(passInfo, newCam);
#endif

	if (GetFloatCVar(e_CameraRotationSpeed))
	{
		Matrix34 mat = passInfo.GetCamera().GetMatrix();
		Matrix33 matRot;
		matRot.SetRotationZ(-GetCurTimeSec() * GetFloatCVar(e_CameraRotationSpeed));
		newCam.SetMatrix(mat * matRot);
	}

#if !defined(_RELEASE)

	{
		//this feature move the camera along with the player to a certain position and sets the angle accordingly
		//	(does not work via goto)
		//u can switch it off again via e_CameraGoto 0
		const char* const pCamGoto = GetCVars()->e_CameraGoto->GetString();
		assert(pCamGoto);
		if (strlen(pCamGoto) > 1)
		{
			Ang3 aAngDeg;
			Vec3 vPos;
			int args = sscanf(pCamGoto, "%f %f %f %f %f %f", &vPos.x, &vPos.y, &vPos.z, &aAngDeg.x, &aAngDeg.y, &aAngDeg.z);
			if (args >= 3)
			{
				Vec3 curPos = newCam.GetPosition();
				if (fabs(vPos.x - curPos.x) > 10.f || fabs(vPos.y - curPos.y) > 10.f || fabs(vPos.z - curPos.z) > 10.f)
				{
					char buf[128];
					cry_sprintf(buf, "goto %f %f %f", vPos.x, vPos.y, vPos.z);
					gEnv->pConsole->ExecuteString(buf);
				}
				if (args >= 6)
				{
					Matrix34 mat = passInfo.GetCamera().GetMatrix();
					mat.SetTranslation(vPos);
					mat.SetRotation33(Matrix33::CreateRotationXYZ(DEG2RAD(aAngDeg)));
					newCam.SetMatrix(mat);
				}
			}
		}
	}

	// Streaming latency test
	if (GetCVars()->e_SQTestCount && !GetCVars()->e_SQTestBegin)
	{
		GetConsole()->GetCVar("e_SQTestBegin")->Set(1);
		GetConsole()->GetCVar("e_SQTestCount")->Set(GetCVars()->e_SQTestCount - 1);
	}
	if (GetCVars()->e_SQTestBegin)
		ProcessStreamingLatencyTest(passInfo.GetCamera(), newCam, passInfo);

#endif

	const CCamera* pAuxCamera = nullptr;
	// set the camera if e_cameraFreeze is not set
	if (GetCVars()->e_CameraFreeze || GetCVars()->e_CoverageBufferDebugFreeze)
	{
		DrawSphere(GetRenderingCamera().GetPosition(), .05f);

		// always set camera to request position for the renderer, allows debugging with e_cameraFreeze
		const CCamera& currentCamera = gEnv->pSystem->GetViewCamera();
		pAuxCamera = &currentCamera;

		if (GetRenderer())
		{
			static CCamera previousCamera = gEnv->pSystem->GetViewCamera();

			if (auto pRenderView = passInfo.GetIRenderView())
			{
				pRenderView->SetCameras(&currentCamera, 1);
				pRenderView->SetPreviousFrameCameras(&previousCamera, 1);
			}

			previousCamera = currentCamera;
		}
	}
	else
	{
		CCamera previousCam = m_RenderingCamera;
		m_RenderingCamera = newCam;

		pAuxCamera = &m_RenderingCamera;

		// always set camera to request position for the renderer, allows debugging with e_camerafreeze
		if (GetRenderer())
		{
			if (auto pRenderView = passInfo.GetIRenderView())
			{
				pRenderView->SetCameras(&newCam, 1);
				pRenderView->SetPreviousFrameCameras(&previousCam, 1);
			}
		}
	}

	// update zoom state to be queried by client code
	m_fZoomFactor = passInfo.GetZoomFactor();
	m_bZoomInProgress = passInfo.IsZoomInProgress();

	// now we have a valid camera, we can start generation of the occlusion buffer
	// only needed for editor here, ingame we spawn the job more early
	if (passInfo.IsGeneralPass() && IsStatObjBufferRenderTasksAllowed())
	{
		if (gEnv->IsEditor())
		{
			if (gEnv->IsEditorGameMode())
			{
				GetObjManager()->PrepareCullbufferAsync(passInfo.GetCamera(), SGraphicsPipelineKey::BaseGraphicsPipelineKey);
			}
			else
			{
				GetObjManager()->PrepareCullbufferAsync(passInfo.GetCamera(), passInfo.GetGraphicsPipelineKey());
			}
		}
		else
		{
			assert(IsEquivalent(passInfo.GetCamera().GetViewdir(), GetObjManager()->m_CullThread.GetViewDir())); // early set camera differs from current main camera - will cause occlusion errors
		}
	}

	/////////////////////////////////////////////////////////////////////////////
	// Update Foliage
	float dt = GetTimer()->GetFrameTime();
	CStatObjFoliage* pFoliage, * pFoliageNext;
	for (pFoliage = m_pFirstFoliage; &pFoliage->m_next != &m_pFirstFoliage; pFoliage = pFoliageNext)
	{
		pFoliageNext = pFoliage->m_next;
		pFoliage->Update(dt, GetRenderingCamera());
	}
	for (int i = m_arrEntsInFoliage.size() - 1; i >= 0; i--)
		if ((m_arrEntsInFoliage[i].timeIdle += dt) > 0.3f)
			RemoveEntInFoliage(i);

	/////////////////////////////////////////////////////////////////////////////
	// update streaming priority of newly seen CRenderProxies (fix for streaming system issue)
	for (int i = 0, nSize = m_deferredRenderProxyStreamingPriorityUpdates.size(); i < nSize; ++i)
	{
		IRenderNode* pRenderNode = m_deferredRenderProxyStreamingPriorityUpdates[i];

		// Might have been hidden directly after registration
		if (pRenderNode->IsHidden())
			continue;

		AABB aabb = pRenderNode->GetBBox();
		const Vec3& vCamPos = GetRenderingCamera().GetPosition();
		float fEntDistance = sqrt_tpl(Distance::Point_AABBSq(vCamPos, aabb)) * passInfo.GetZoomFactor();

		GetObjManager()->UpdateRenderNodeStreamingPriority(pRenderNode, fEntDistance, 1.0f, false, passInfo);
		if (GetCVars()->e_StreamCgfDebug == 2)
			PrintMessage("C3DEngine::RegisterEntity__GetObjManager()->UpdateRenderNodeStreamingPriority %s", pRenderNode->GetName());
	}
	m_deferredRenderProxyStreamingPriorityUpdates.resize(0);

	if (!gEnv->pRenderer->GetIStereoRenderer() || !gEnv->pRenderer->GetIStereoRenderer()->GetStereoEnabled())
	{
		gEnv->pRenderer->UpdateAuxDefaultCamera(*pAuxCamera);
	}
}

void C3DEngine::PrepareOcclusion(const CCamera& rCamera, const SGraphicsPipelineKey& cullGraphicsContextKey)
{
	MEMSTAT_CONTEXT(EMemStatContextType::Other, "C3DEngine::PrepareOcclusion");

	const bool bInEditor = gEnv->IsEditor();
	const bool bStatObjBufferRenderTasks = IsStatObjBufferRenderTasksAllowed() != 0;
	const bool bIsFMVPlaying = gEnv->IsFMVPlaying();
	const bool bCameraAtZero = IsEquivalent(rCamera.GetPosition(), Vec3(0, 0, 0), VEC_EPSILON);
	const bool bPost3dEnabled = GetRenderer() && GetRenderer()->IsPost3DRendererEnabled();
	if (!bInEditor && bStatObjBufferRenderTasks && !bIsFMVPlaying && (!bCameraAtZero || bPost3dEnabled))
		GetObjManager()->PrepareCullbufferAsync(rCamera, cullGraphicsContextKey);
}

void C3DEngine::EndOcclusion()
{
	GetObjManager()->EndOcclusionCulling();
}

#if CRY_PLATFORM_WINDOWS
	#pragma warning( pop )                //AMD Port
#endif

IStatObj* C3DEngine::LoadStatObj(const char* szFileName, const char* szGeomName, IStatObj::SSubObject** ppSubObject, bool bUseStreaming, unsigned long nLoadingFlags)
{
	if (!szFileName || !szFileName[0])
	{
		m_pSystem->Warning(VALIDATOR_MODULE_3DENGINE, VALIDATOR_ERROR, 0, 0, "I3DEngine::LoadStatObj: filename is not specified");
		return 0;
	}

	if (!m_pObjManager)
		m_pObjManager = CryAlignedNew<CObjManager>();

	return m_pObjManager->LoadStatObj(szFileName, szGeomName, ppSubObject, bUseStreaming, nLoadingFlags);
}

IStatObj* C3DEngine::FindStatObjectByFilename(const char* filename)
{
	if (filename == NULL)
		return NULL;

	if (filename[0] == 0)
		return NULL;

	return m_pObjManager->FindStaticObjectByFilename(filename);
}

void C3DEngine::RegisterEntity(IRenderNode* pEnt)
{
	FUNCTION_PROFILER_3DENGINE;
	uint32 nFrameID = gEnv->nMainFrameID;
	AsyncOctreeUpdate(pEnt, nFrameID, false);
}

void C3DEngine::UnRegisterEntityDirect(IRenderNode* pEnt)
{
	UnRegisterEntityImpl(pEnt);
}

void C3DEngine::UnRegisterEntityAsJob(IRenderNode* pEnt)
{
	AsyncOctreeUpdate(pEnt, (int)0, true);
}

bool C3DEngine::CreateDecalInstance(const CryEngineDecalInfo& decal, CDecal* pCallerManagedDecal)
{
	if (!GetCVars()->e_Decals && !pCallerManagedDecal)
		return false;

	return m_pDecalManager->Spawn(decal, pCallerManagedDecal);
}

void C3DEngine::SelectEntity(IRenderNode* pEntity)
{
	static IRenderNode* pSelectedNode;
	static float fLastTime;
	if (pEntity && GetCVars()->e_Decals == 3)
	{
		float fCurTime = gEnv->pTimer->GetAsyncCurTime();
		if (fCurTime - fLastTime < 1.0f)
			return;
		fLastTime = fCurTime;
		if (pSelectedNode)
			pSelectedNode->SetRndFlags(ERF_SELECTED, false);
		pEntity->SetRndFlags(ERF_SELECTED, true);
		pSelectedNode = pEntity;
	}
}

void C3DEngine::CreateDecal(const struct CryEngineDecalInfo& decal)
{
	IF (!GetCVars()->e_DecalsAllowGameDecals, 0)
		return;

	if (GetCVars()->e_Decals == 2)
	{
		IRenderNode* pRN = decal.ownerInfo.pRenderNode;
		PrintMessage("Debug: C3DEngine::CreateDecal: Pos=(%.1f,%.1f,%.1f) Size=%.2f DecalMaterial=%s HitObjectName=%s(%s)",
		             decal.vPos.x, decal.vPos.y, decal.vPos.z, decal.fSize, decal.szMaterialName,
		             pRN ? pRN->GetName() : "NULL", pRN ? pRN->GetEntityClassName() : "NULL");
	}

	assert(!decal.pExplicitRightUpFront); // only game-play decals come here

	static uint32 nGroupId = 0;
	nGroupId++;

	if ((GetCVars()->e_DecalsDeferredStatic == 1 && decal.pExplicitRightUpFront) ||
	    (GetCVars()->e_DecalsDeferredDynamic == 1 && !decal.pExplicitRightUpFront &&
	     (!decal.ownerInfo.pRenderNode || decal.ownerInfo.pRenderNode->GetRenderNodeType() == eERType_Brush || decal.fGrowTimeAlpha || decal.fSize > GetFloatCVar(e_DecalsDeferredDynamicMinSize)))
	    && !decal.bForceSingleOwner)
	{
		CryEngineDecalInfo decal_adjusted = decal;
		decal_adjusted.nGroupId = nGroupId;
		decal_adjusted.bDeferred = true;
		m_pDecalManager->SpawnHierarchical(decal_adjusted, NULL);
		return;
	}

	if (decal.ownerInfo.pRenderNode && decal.fSize > 0.5f && !decal.bForceSingleOwner)
	{
		PodArray<SRNInfo> lstEntities;
		Vec3 vRadius(decal.fSize, decal.fSize, decal.fSize);
		const AABB cExplosionBox(decal.vPos - vRadius, decal.vPos + vRadius);

		if (CVisArea* pArea = (CVisArea*)decal.ownerInfo.pRenderNode->GetEntityVisArea())
		{
			if (pArea->IsObjectsTreeValid())
			{
				pArea->GetObjectsTree()->MoveObjectsIntoList(&lstEntities, &cExplosionBox, false, true, true, true);
			}
		}
		else
			Get3DEngine()->MoveObjectsIntoListGlobal(&lstEntities, &cExplosionBox, false, true, true, true);

		for (int i = 0; i < lstEntities.Count(); i++)
		{
			// decals on statobj's of render node
			CryEngineDecalInfo decalOnRenderNode = decal;
			decalOnRenderNode.ownerInfo.pRenderNode = lstEntities[i].pNode;
			decalOnRenderNode.nGroupId = nGroupId;

			//      if(decalOnRenderNode.ownerInfo.pRenderNode->GetRenderNodeType() != decal.ownerInfo.pRenderNode->GetRenderNodeType())
			//      continue;

			if (decalOnRenderNode.ownerInfo.pRenderNode->IsHidden())
				continue;

			m_pDecalManager->SpawnHierarchical(decalOnRenderNode, NULL);
		}
	}
	else
	{
		CryEngineDecalInfo decalStatic = decal;
		decalStatic.nGroupId = nGroupId;
		m_pDecalManager->SpawnHierarchical(decalStatic, NULL);
	}
}

/*
   float C3DEngine::GetDayTime(float fPrevDayTime)
   {
   if(fPrevDayTime)
   {
    float fDayTimeDiff = (GetCVars()->e_day_time - fPrevDayTime);
    while(fDayTimeDiff>12)
      fDayTimeDiff-=12;
    while(fDayTimeDiff<-12)
      fDayTimeDiff+=12;
    fDayTimeDiff = (float)fabs(fDayTimeDiff);
    return fDayTimeDiff;
   }

   return GetCVars()->e_day_time;
   } */

namespace
{
inline const float GetSunSkyRel(const Vec3& crSkyColor, const Vec3& crSunColor)
{
	const float cSunMax = max(0.1f, max(crSunColor.x, max(crSunColor.y, crSunColor.z)));
	const float cSkyMax = max(0.1f, max(crSkyColor.x, max(crSkyColor.y, crSkyColor.z)));
	return cSunMax / (cSkyMax + cSunMax);
}
}

//////////////////////////////////////////////////////////////////////////
void C3DEngine::SetSkyColor(Vec3 vColor)
{
	if (m_pObjManager)
	{
		m_pObjManager->m_vSkyColor = vColor;
		m_pObjManager->m_fSunSkyRel = GetSunSkyRel(m_pObjManager->m_vSkyColor, m_pObjManager->m_vSunColor);
	}
}

//////////////////////////////////////////////////////////////////////////
void C3DEngine::SetSunColor(Vec3 vColor)
{
	if (m_pObjManager)
	{
		m_pObjManager->m_vSunColor = vColor;
		m_pObjManager->m_fSunSkyRel = GetSunSkyRel(m_pObjManager->m_vSkyColor, m_pObjManager->m_vSunColor);
	}
}

void C3DEngine::SetSkyBrightness(float fMul)
{
	if (m_pObjManager)
		m_pObjManager->m_fSkyBrightMul = fMul;
}

void C3DEngine::SetSSAOAmount(float fMul)
{
	if (m_pObjManager)
		m_pObjManager->m_fSSAOAmount = fMul;
}

void C3DEngine::SetSSAOContrast(float fMul)
{
	if (m_pObjManager)
		m_pObjManager->m_fSSAOContrast = fMul;
}

void C3DEngine::SetGIAmount(float fMul)
{
	if (m_pObjManager)
		m_pObjManager->m_fGIAmount = fMul;
}

float C3DEngine::GetTerrainElevation(float x, float y)
{
	float fZ = 0;

	if (m_pTerrain)
		fZ = m_pTerrain->GetZApr(x, y);

	return fZ;
}

float C3DEngine::GetTerrainElevation3D(Vec3 vPos)
{
	float fZ = 0;

	if (m_pTerrain)
		fZ = m_pTerrain->GetZApr(vPos.x, vPos.y);

	return fZ;
}

float C3DEngine::GetTerrainZ(float x, float y)
{
	if (x < 0 || y < 0 || x >= CTerrain::GetTerrainSize() || y >= CTerrain::GetTerrainSize())
		return TERRAIN_BOTTOM_LEVEL;
	return m_pTerrain ? m_pTerrain->GetZ(x, y) : 0;
}

bool C3DEngine::GetTerrainHole(float x, float y)
{
	return m_pTerrain ? m_pTerrain->GetHole(x, y) : false;
}

float C3DEngine::GetHeightMapUnitSize()
{
	return CTerrain::GetHeightMapUnitSize();
}

void C3DEngine::RemoveAllStaticObjects()
{
	if (m_pTerrain)
		m_pTerrain->RemoveAllStaticObjects();
}

void C3DEngine::SetTerrainSurfaceType(int x, int y, int nType)
{
	assert(0);
}

void C3DEngine::SetTerrainSectorTexture(const int nTexSectorX, const int nTexSectorY, unsigned int textureId)
{
	if (m_pTerrain)
	{
		m_pTerrain->SetTerrainSectorTexture(nTexSectorX, nTexSectorY, textureId, true);
	}
}

void C3DEngine::OnExplosion(Vec3 vPos, float fRadius, bool bDeformTerrain)
{
	if (GetCVars()->e_Decals == 2)
		PrintMessage("Debug: C3DEngine::OnExplosion: Pos=(%.1f,%.1f,%.1f) fRadius=%.2f", vPos.x, vPos.y, vPos.z, fRadius);

	if (vPos.x < 0 || vPos.x >= CTerrain::GetTerrainSize() || vPos.y < 0 || vPos.y >= CTerrain::GetTerrainSize() || fRadius <= 0)
		return; // out of terrain

	// do not create decals near the terrain holes
	{
		float unitSize = GetHeightMapUnitSize();

		for (float x = vPos.x - fRadius; x <= vPos.x + fRadius + unitSize; x += unitSize)
		{
			for (float y = vPos.y - fRadius; y <= vPos.y + fRadius + unitSize; y += unitSize)
			{
				if (m_pTerrain->GetHole(x, y))
				{
					return;
				}
			}
		}
	}

	// try to remove objects around
	bool bGroundDeformationAllowed = m_pTerrain->RemoveObjectsInArea(vPos, fRadius) && bDeformTerrain && GetCVars()->e_TerrainDeformations;

	// reduce ground decals size depending on distance to the ground
	float fExploHeight = vPos.z - m_pTerrain->GetZApr(vPos.x, vPos.y);

	if (bGroundDeformationAllowed && (fExploHeight > -0.1f) && fExploHeight < fRadius && fRadius > 0.125f)
	{
		m_pTerrain->MakeCrater(vPos, fRadius);

		// update roads
		{
			PodArray<IRenderNode*> lstRoads;
			AABB bbox(vPos - Vec3(fRadius, fRadius, fRadius), vPos + Vec3(fRadius, fRadius, fRadius));
			Get3DEngine()->GetObjectsByTypeGlobal(lstRoads, eERType_Road, &bbox);
			for (int i = 0; i < lstRoads.Count(); i++)
			{
				CRoadRenderNode* pRoad = (CRoadRenderNode*)lstRoads[i];
				pRoad->OnTerrainChanged();
			}
		}
	}

	// delete decals what can not be correctly updated
	Vec3 vRadius(fRadius, fRadius, fRadius);
	AABB areaBox(vPos - vRadius, vPos + vRadius);
	Get3DEngine()->DeleteDecalsInRange(&areaBox, NULL);
}

float C3DEngine::GetMaxViewDistance(bool bScaled)
{
	double fMaxViewDist = static_cast<double>(GetFloatCVar(e_MaxViewDistance));

	if (fMaxViewDist < 0)
	{
		// spec lerp factor
		double lerpSpec = static_cast<double>(clamp_tpl(GetCVars()->e_MaxViewDistSpecLerp, 0.0f, 1.0f));

		// camera height lerp factor
		double lerpHeight = static_cast<double>(clamp_tpl(max(0.f, GetSystem()->GetViewCamera().GetPosition().z - GetWaterLevel()) / GetFloatCVar(e_MaxViewDistFullDistCamHeight), 0.0f, 1.0f));

		// lerp between specs
		fMaxViewDist = m_fMaxViewDistLowSpec * (1.0 - lerpSpec) + m_fMaxViewDistHighSpec * lerpSpec;

		// lerp between prev result and high spec
		fMaxViewDist = fMaxViewDist * (1.0 - lerpHeight) + m_fMaxViewDistHighSpec * lerpHeight;

		if (bScaled)
			fMaxViewDist *= m_fMaxViewDistScale;
	}

	return static_cast<float>(max(fMaxViewDist, 0.100001));
}

void C3DEngine::SetFrameLodInfo(const SFrameLodInfo& frameLodInfo)
{
	if (frameLodInfo.fLodRatio != m_frameLodInfo.fLodRatio || frameLodInfo.fTargetSize != m_frameLodInfo.fTargetSize)
	{
		++m_frameLodInfo.nID;
		m_frameLodInfo.fLodRatio = frameLodInfo.fLodRatio;
		m_frameLodInfo.fTargetSize = frameLodInfo.fTargetSize;
	}
	m_frameLodInfo.nMinLod = frameLodInfo.nMinLod;
	m_frameLodInfo.nMaxLod = frameLodInfo.nMaxLod;
}

void C3DEngine::SetFogColor(const Vec3& vFogColor)
{
	m_vFogColor = vFogColor;
}

Vec3 C3DEngine::GetFogColor()
{
	return m_vFogColor;
}

void C3DEngine::GetSkyLightParameters(Vec3& sunDir, Vec3& sunIntensity, float& Km, float& Kr, float& g, Vec3& rgbWaveLengths)
{
	CSkyLightManager::SSkyDomeCondition skyCond;
	m_pSkyLightManager->GetCurSkyDomeCondition(skyCond);

	g = skyCond.m_g;
	Km = skyCond.m_Km;
	Kr = skyCond.m_Kr;
	sunIntensity = skyCond.m_sunIntensity;
	rgbWaveLengths = skyCond.m_rgbWaveLengths;
	sunDir = skyCond.m_sunDirection;
}

void C3DEngine::SetSkyLightParameters(const Vec3& sunDir, const Vec3& sunIntensity, float Km, float Kr, float g, const Vec3& rgbWaveLengths, bool forceImmediateUpdate)
{
	CSkyLightManager::SSkyDomeCondition skyCond;

	skyCond.m_g = g;
	skyCond.m_Km = Km;
	skyCond.m_Kr = Kr;
	skyCond.m_sunIntensity = sunIntensity;
	skyCond.m_rgbWaveLengths = rgbWaveLengths;
	skyCond.m_sunDirection = sunDir;

	m_pSkyLightManager->SetSkyDomeCondition(skyCond);
	if (forceImmediateUpdate)
		m_pSkyLightManager->FullUpdate();
}

void C3DEngine::SetLightsHDRDynamicPowerFactor(const float value)
{
	m_fLightsHDRDynamicPowerFactor = value;
}

float C3DEngine::GetLightsHDRDynamicPowerFactor() const
{
	return m_fLightsHDRDynamicPowerFactor;
}

bool C3DEngine::IsTessellationAllowedForShadowMap(const SRenderingPassInfo& passInfo) const
{
#ifdef MESH_TESSELLATION_ENGINE
	SRenderingPassInfo::EShadowMapType shadowType = passInfo.GetShadowMapType();
	switch (shadowType)
	{
	case SRenderingPassInfo::SHADOW_MAP_GSM:
		return passInfo.ShadowFrustumLod() < GetCVars()->e_ShadowsTessellateCascades;
	case SRenderingPassInfo::SHADOW_MAP_LOCAL:
		return GetCVars()->e_ShadowsTessellateDLights != 0;
	case SRenderingPassInfo::SHADOW_MAP_NONE:
	default:
		return false;
	}
#endif //#ifdef MESH_TESSELLATION_ENGINE

	return false;
}

void C3DEngine::SetPhysMaterialEnumerator(IPhysMaterialEnumerator* pPhysMaterialEnumerator)
{
	m_pPhysMaterialEnumerator = pPhysMaterialEnumerator;
}

IPhysMaterialEnumerator* C3DEngine::GetPhysMaterialEnumerator()
{
	return m_pPhysMaterialEnumerator;
}

void C3DEngine::ApplyForceToEnvironment(Vec3 vPos, float fRadius, float fAmountOfForce)
{
	if (m_pTerrain)
		m_pTerrain->ApplyForceToEnvironment(vPos, fRadius, fAmountOfForce);
}

float C3DEngine::GetDistanceToSectorWithWater()
{
	if (!m_pTerrain || !m_pTerrain->GetParentNode())
		return 100000.f;

	Vec3 camPostion = GetRenderingCamera().GetPosition();
	bool bCameraInTerrainBounds = Overlap::Point_AABB2D(camPostion, m_pTerrain->GetParentNode()->GetBBox());

	return (bCameraInTerrainBounds && (m_pTerrain && m_pTerrain->GetDistanceToSectorWithWater() > 0.1f))
	       ? m_pTerrain->GetDistanceToSectorWithWater() : max(camPostion.z - GetWaterLevel(), 0.1f);
}

Vec3 C3DEngine::GetSunColor() const
{
	return m_pObjManager ? m_pObjManager->m_vSunColor : Vec3(0, 0, 0);
}

float C3DEngine::GetSkyBrightness() const
{
	return m_pObjManager ? m_pObjManager->m_fSkyBrightMul : 1.0f;
}

float C3DEngine::GetSSAOAmount() const
{
	return m_pObjManager ? m_pObjManager->m_fSSAOAmount : 1.0f;
}

float C3DEngine::GetSSAOContrast() const
{
	return m_pObjManager ? m_pObjManager->m_fSSAOContrast : 1.0f;
}

float C3DEngine::GetGIAmount() const
{
	return m_pObjManager ? m_pObjManager->m_fGIAmount : 1.0f;
}

float C3DEngine::GetSunRel() const
{
	return m_pObjManager->m_fSunSkyRel;
}

void C3DEngine::SetRainParams(const SRainParams& rainParams)
{
	if (m_pObjManager)
	{
		m_pObjManager->m_rainParams.bIgnoreVisareas = rainParams.bIgnoreVisareas;
		m_pObjManager->m_rainParams.bDisableOcclusion = rainParams.bDisableOcclusion;
		m_pObjManager->m_rainParams.qRainRotation = rainParams.qRainRotation;
		m_pObjManager->m_rainParams.vWorldPos = rainParams.vWorldPos;
		m_pObjManager->m_rainParams.vColor = rainParams.vColor;
		m_pObjManager->m_rainParams.fAmount = rainParams.fAmount;
		m_pObjManager->m_rainParams.fCurrentAmount = rainParams.fCurrentAmount;
		m_pObjManager->m_rainParams.fRadius = rainParams.fRadius;
		m_pObjManager->m_rainParams.fFakeGlossiness = rainParams.fFakeGlossiness;
		m_pObjManager->m_rainParams.fFakeReflectionAmount = rainParams.fFakeReflectionAmount;
		m_pObjManager->m_rainParams.fDiffuseDarkening = rainParams.fDiffuseDarkening;
		m_pObjManager->m_rainParams.fRainDropsAmount = rainParams.fRainDropsAmount;
		m_pObjManager->m_rainParams.fRainDropsSpeed = rainParams.fRainDropsSpeed;
		m_pObjManager->m_rainParams.fRainDropsLighting = rainParams.fRainDropsLighting;
		m_pObjManager->m_rainParams.fMistAmount = rainParams.fMistAmount;
		m_pObjManager->m_rainParams.fMistHeight = rainParams.fMistHeight;
		m_pObjManager->m_rainParams.fPuddlesAmount = rainParams.fPuddlesAmount;
		m_pObjManager->m_rainParams.fPuddlesMaskAmount = rainParams.fPuddlesMaskAmount;
		m_pObjManager->m_rainParams.fPuddlesRippleAmount = rainParams.fPuddlesRippleAmount;
		m_pObjManager->m_rainParams.fSplashesAmount = rainParams.fSplashesAmount;

		m_pObjManager->m_rainParams.nUpdateFrameID = gEnv->nMainFrameID;
	}
}

bool C3DEngine::GetRainParams(SRainParams& rainParams)
{
	bool bRet = false;
	const int nFrmID = gEnv->nMainFrameID;
	if (m_pObjManager)
	{
		// Copy shared rain data only
		rainParams.bIgnoreVisareas = m_pObjManager->m_rainParams.bIgnoreVisareas;
		rainParams.bDisableOcclusion = m_pObjManager->m_rainParams.bDisableOcclusion;
		rainParams.qRainRotation = m_pObjManager->m_rainParams.qRainRotation;
		rainParams.vWorldPos = m_pObjManager->m_rainParams.vWorldPos;
		rainParams.vColor = m_pObjManager->m_rainParams.vColor;
		rainParams.fAmount = m_pObjManager->m_rainParams.fAmount;
		rainParams.fCurrentAmount = m_pObjManager->m_rainParams.fCurrentAmount;
		rainParams.fRadius = m_pObjManager->m_rainParams.fRadius;
		rainParams.fFakeGlossiness = m_pObjManager->m_rainParams.fFakeGlossiness;
		rainParams.fFakeReflectionAmount = m_pObjManager->m_rainParams.fFakeReflectionAmount;
		rainParams.fDiffuseDarkening = m_pObjManager->m_rainParams.fDiffuseDarkening;
		rainParams.fRainDropsAmount = m_pObjManager->m_rainParams.fRainDropsAmount;
		rainParams.fRainDropsSpeed = m_pObjManager->m_rainParams.fRainDropsSpeed;
		rainParams.fRainDropsLighting = m_pObjManager->m_rainParams.fRainDropsLighting;
		rainParams.fMistAmount = m_pObjManager->m_rainParams.fMistAmount;
		rainParams.fMistHeight = m_pObjManager->m_rainParams.fMistHeight;
		rainParams.fPuddlesAmount = m_pObjManager->m_rainParams.fPuddlesAmount;
		rainParams.fPuddlesMaskAmount = m_pObjManager->m_rainParams.fPuddlesMaskAmount;
		rainParams.fPuddlesRippleAmount = m_pObjManager->m_rainParams.fPuddlesRippleAmount;
		rainParams.fSplashesAmount = m_pObjManager->m_rainParams.fSplashesAmount;

		if (!IsOutdoorVisible() && !rainParams.bIgnoreVisareas)
		{
			rainParams.fAmount = 0.f;
		}

		bRet = m_pObjManager->m_rainParams.nUpdateFrameID == nFrmID;
	}
	return bRet;
}

void C3DEngine::SetSnowSurfaceParams(const Vec3& vCenter, float fRadius, float fSnowAmount, float fFrostAmount, float fSurfaceFreezing)
{
	if (m_pObjManager)
	{
		m_pObjManager->m_snowParams.m_vWorldPos = vCenter;
		m_pObjManager->m_snowParams.m_fRadius = fRadius;
		m_pObjManager->m_snowParams.m_fSnowAmount = fSnowAmount;
		m_pObjManager->m_snowParams.m_fFrostAmount = fFrostAmount;
		m_pObjManager->m_snowParams.m_fSurfaceFreezing = fSurfaceFreezing;
	}
}

bool C3DEngine::GetSnowSurfaceParams(Vec3& vCenter, float& fRadius, float& fSnowAmount, float& fFrostAmount, float& fSurfaceFreezing)
{
	bool bRet = false;
	if (m_pObjManager)
	{
		vCenter = m_pObjManager->m_snowParams.m_vWorldPos;
		fRadius = m_pObjManager->m_snowParams.m_fRadius;
		fSnowAmount = 0.f;
		fFrostAmount = 0.f;
		fSurfaceFreezing = 0.f;
		if (IsOutdoorVisible())
		{
			fSnowAmount = m_pObjManager->m_snowParams.m_fSnowAmount;
			fFrostAmount = m_pObjManager->m_snowParams.m_fFrostAmount;
			fSurfaceFreezing = m_pObjManager->m_snowParams.m_fSurfaceFreezing;
		}
		bRet = true;
	}
	return bRet;
}

void C3DEngine::SetSnowFallParams(int nSnowFlakeCount, float fSnowFlakeSize, float fSnowFallBrightness, float fSnowFallGravityScale, float fSnowFallWindScale, float fSnowFallTurbulence, float fSnowFallTurbulenceFreq)
{
	if (m_pObjManager)
	{
		m_pObjManager->m_snowParams.m_nSnowFlakeCount = nSnowFlakeCount;
		m_pObjManager->m_snowParams.m_fSnowFlakeSize = fSnowFlakeSize;
		m_pObjManager->m_snowParams.m_fSnowFallBrightness = fSnowFallBrightness;
		m_pObjManager->m_snowParams.m_fSnowFallGravityScale = fSnowFallGravityScale;
		m_pObjManager->m_snowParams.m_fSnowFallWindScale = fSnowFallWindScale;
		m_pObjManager->m_snowParams.m_fSnowFallTurbulence = fSnowFallTurbulence;
		m_pObjManager->m_snowParams.m_fSnowFallTurbulenceFreq = fSnowFallTurbulenceFreq;
	}
}

bool C3DEngine::GetSnowFallParams(int& nSnowFlakeCount, float& fSnowFlakeSize, float& fSnowFallBrightness, float& fSnowFallGravityScale, float& fSnowFallWindScale, float& fSnowFallTurbulence, float& fSnowFallTurbulenceFreq)
{
	bool bRet = false;
	if (m_pObjManager)
	{
		nSnowFlakeCount = 0;
		fSnowFlakeSize = 0.f;
		fSnowFallBrightness = 0.f;
		fSnowFallGravityScale = 0.f;
		fSnowFallWindScale = 0.f;
		fSnowFallTurbulence = 0.f;
		fSnowFallTurbulenceFreq = 0.f;
		if (IsOutdoorVisible())
		{
			nSnowFlakeCount = m_pObjManager->m_snowParams.m_nSnowFlakeCount;
			fSnowFlakeSize = m_pObjManager->m_snowParams.m_fSnowFlakeSize;
			fSnowFallBrightness = m_pObjManager->m_snowParams.m_fSnowFallBrightness;
			fSnowFallGravityScale = m_pObjManager->m_snowParams.m_fSnowFallGravityScale;
			fSnowFallWindScale = m_pObjManager->m_snowParams.m_fSnowFallWindScale;
			fSnowFallTurbulence = m_pObjManager->m_snowParams.m_fSnowFallTurbulence;
			fSnowFallTurbulenceFreq = m_pObjManager->m_snowParams.m_fSnowFallTurbulenceFreq;
		}
		bRet = true;
	}
	return bRet;
}

float C3DEngine::GetTerrainTextureMultiplier() const
{
	if (!m_pTerrain || m_bInUnload)
		return 0;

	return m_pTerrain->GetTerrainTextureMultiplier();
}

void C3DEngine::SetSunDir(const Vec3& newSunDir)
{
	Vec3 vSunDirNormalized = newSunDir.normalized();
	m_vSunDirRealtime = vSunDirNormalized;
	if (vSunDirNormalized.Dot(m_vSunDirNormalized) < GetFloatCVar(e_SunAngleSnapDot) ||
	    GetCurTimeSec() - m_fSunDirUpdateTime > GetFloatCVar(e_SunAngleSnapSec))
	{
		m_vSunDirNormalized = vSunDirNormalized;
		m_vSunDir = m_vSunDirNormalized * DISTANCE_TO_THE_SUN;

		m_fSunDirUpdateTime = GetCurTimeSec();
	}
}

Vec3 C3DEngine::GetSunDir()  const
{
	return m_vSunDir;
}

Vec3 C3DEngine::GetRealtimeSunDirNormalized() const
{
	return m_vSunDirRealtime;
}

Vec3 C3DEngine::GetAmbientColorFromPosition(const Vec3& vPos, float fRadius)
{
	Vec3 ret(0, 0, 0);

	if (m_pObjManager)
	{
		if (CVisArea* pVisArea = (CVisArea*)m_pVisAreaManager->GetVisAreaFromPos(vPos))
			ret = pVisArea->GetFinalAmbientColor();
		else
			ret = Get3DEngine()->GetSkyColor();

		assert(ret.x >= 0 && ret.y >= 0 && ret.z >= 0);
	}

	return ret;
}

void C3DEngine::FreeRenderNodeState(IRenderNode* pEnt)
{
	FUNCTION_PROFILER_3DENGINE;

	// make sure we don't try to update the streaming priority if an object
	// was added and removed in the same frame
	int nElementID = m_deferredRenderProxyStreamingPriorityUpdates.Find(pEnt);
	if (nElementID != -1)
		m_deferredRenderProxyStreamingPriorityUpdates.DeleteFastUnsorted(nElementID);

	m_pObjManager->RemoveFromRenderAllObjectDebugInfo(pEnt);

#if !defined(_RELEASE)
	if (gEnv->pRenderer)
	{
		//As render nodes can be deleted in many places, it's possible that the map of render nodes used by stats gathering (r_stats 6, perfHUD, debug gun, Statoscope) could get aliased.
		//Ensure that this node is removed from the map to prevent a dereference after deletion.
		gEnv->pRenderer->ForceRemoveNodeFromDrawCallsMap(pEnt);
	}
#endif

	m_lstAlwaysVisible.Delete(pEnt);

	const EERType type = pEnt->GetRenderNodeType();

	if (m_pDecalManager && (pEnt->m_nInternalFlags & IRenderNode::DECAL_OWNER))
		m_pDecalManager->OnEntityDeleted(pEnt);

	if (type == eERType_Light && GetRenderer())
		GetRenderer()->OnEntityDeleted(pEnt);

	if (pEnt->GetRndFlags() & (ERF_CASTSHADOWMAPS | ERF_HAS_CASTSHADOWMAPS))
	{
		// make sure pointer to object will not be used somewhere in the renderer
#if !defined(_RELEASE)
		if (!(pEnt->GetRndFlags() & ERF_HAS_CASTSHADOWMAPS))
			Warning("IRenderNode has ERF_CASTSHADOWMAPS set but not ERF_HAS_CASTSHADOWMAPS, name: '%s', class: '%s'.", pEnt->GetName(), pEnt->GetEntityClassName());
#endif
		Get3DEngine()->OnCasterDeleted(pEnt);
	}

	TRenderNodeStatusListeners& listeners = m_renderNodeStatusListenersArray[type];
	if (!listeners.Empty())
	{
		for (TRenderNodeStatusListeners::Notifier notifier(listeners); notifier.IsValid(); notifier.Next())
		{
			notifier->OnEntityDeleted(pEnt);
		}
	}

	UnRegisterEntityImpl(pEnt);

	m_visibleNodesManager.OnRenderNodeDeleted(pEnt);
}

const char* C3DEngine::GetLevelFilePath(const char* szFileName)
{
	cry_strcpy(m_sGetLevelFilePathTmpBuff, m_szLevelFolder);
	if (*szFileName && (*szFileName == '/' || *szFileName == '\\'))
		cry_strcat(m_sGetLevelFilePathTmpBuff, szFileName + 1);
	else
		cry_strcat(m_sGetLevelFilePathTmpBuff, szFileName);
	return m_sGetLevelFilePathTmpBuff;
}

void C3DEngine::SetTerrainBurnedOut(int x, int y, bool bBurnedOut)
{
	assert(!"not supported");
}

bool C3DEngine::IsTerrainBurnedOut(int x, int y)
{
	assert(!"not supported");
	return 0;//m_pTerrain ? m_pTerrain->IsBurnedOut(x, y) : 0;
}

int C3DEngine::GetTerrainSectorSize()
{
	return m_pTerrain ? m_pTerrain->GetSectorSize() : 0;
}

void C3DEngine::ActivatePortal(const Vec3& vPos, bool bActivate, const char* szEntityName)
{
	if (m_pVisAreaManager)
		m_pVisAreaManager->ActivatePortal(vPos, bActivate, szEntityName);
}

void C3DEngine::ActivateOcclusionAreas(IVisAreaTestCallback* pTest, bool bActivate)
{
	if (m_pVisAreaManager)
		m_pVisAreaManager->ActivateOcclusionAreas(pTest, bActivate);
}

bool C3DEngine::SetStatInstGroup(int nGroupId, const IStatInstGroup& siGroup)
{
	m_fRefreshSceneDataCVarsSumm = -100;

	m_pObjManager->m_lstStaticTypes.resize(max(nGroupId + 1, m_pObjManager->m_lstStaticTypes.Count()));

	if (nGroupId < 0 || nGroupId >= m_pObjManager->m_lstStaticTypes.Count())
		return false;

	StatInstGroup& rGroup = m_pObjManager->m_lstStaticTypes[nGroupId];

	rGroup.pStatObj = siGroup.pStatObj;

	if (rGroup.pStatObj)
		cry_strcpy(rGroup.szFileName, siGroup.pStatObj->GetFilePath());
	else
		rGroup.szFileName[0] = 0;

	rGroup.bHideability = siGroup.bHideability;
	rGroup.bHideabilitySecondary = siGroup.bHideabilitySecondary;
	rGroup.nPlayerHideable = siGroup.nPlayerHideable;
	rGroup.bPickable = siGroup.bPickable;
	rGroup.fBending = siGroup.fBending;
	rGroup.nCastShadowMinSpec = siGroup.nCastShadowMinSpec;
	rGroup.bDynamicDistanceShadows = siGroup.bDynamicDistanceShadows;
	rGroup.bGIMode = siGroup.bGIMode;
	rGroup.offlineProcedural = siGroup.offlineProcedural;
	rGroup.bInstancing = siGroup.bInstancing;
	rGroup.fSpriteDistRatio = siGroup.fSpriteDistRatio;
	rGroup.fLodDistRatio = siGroup.fLodDistRatio;
	rGroup.fShadowDistRatio = siGroup.fShadowDistRatio;
	rGroup.fMaxViewDistRatio = siGroup.fMaxViewDistRatio;

	rGroup.fBrightness = siGroup.fBrightness;

	_smart_ptr<IMaterial> pMaterial = rGroup.pMaterial;
	rGroup.pMaterial = siGroup.pMaterial;

	rGroup.bUseSprites = siGroup.bUseSprites;

	rGroup.fDensity = siGroup.fDensity;
	rGroup.fElevationMax = siGroup.fElevationMax;
	rGroup.fElevationMin = siGroup.fElevationMin;
	rGroup.fSize = siGroup.fSize;
	rGroup.fSizeVar = siGroup.fSizeVar;
	rGroup.fSlopeMax = siGroup.fSlopeMax;
	rGroup.fSlopeMin = siGroup.fSlopeMin;
	rGroup.fStiffness = siGroup.fStiffness;
	rGroup.fDamping = siGroup.fDamping;
	rGroup.bIgnoreTerrainLayerBlend = siGroup.bIgnoreTerrainLayerBlend;
	rGroup.fVariance = siGroup.fVariance;
	rGroup.fAirResistance = siGroup.fAirResistance;

	rGroup.bRandomRotation = siGroup.bRandomRotation;
	rGroup.nRotationRangeToTerrainNormal = siGroup.nRotationRangeToTerrainNormal;
	rGroup.nMaterialLayers = siGroup.nMaterialLayers;

	rGroup.bUseTerrainColor = siGroup.bUseTerrainColor && Get3DEngine()->m_bShowTerrainSurface;
	rGroup.bAllowIndoor = siGroup.bAllowIndoor;
	rGroup.fAlignToTerrainCoefficient = Get3DEngine()->m_bShowTerrainSurface ? siGroup.fAlignToTerrainCoefficient : 0.f;
	rGroup.bAutoMerged = siGroup.bAutoMerged;
	rGroup.minConfigSpec = siGroup.minConfigSpec;

	rGroup.nID = siGroup.nID;

	rGroup.Update(GetCVars(), Get3DEngine()->GetGeomDetailScreenRes());

	if (CTerrain* const pTerrain = GetTerrain())
	{
		pTerrain->MarkAllSectorsAsUncompiled();
	}

	if (gEnv->IsEditor() && pMaterial != rGroup.pMaterial)
		m_pMergedMeshesManager->ResetActiveNodes();

	MarkRNTmpDataPoolForReset();

	return true;
}

bool C3DEngine::GetStatInstGroup(int nGroupId, IStatInstGroup& siGroup)
{
	if (nGroupId < 0 || nGroupId >= m_pObjManager->m_lstStaticTypes.Count())
		return false;

	StatInstGroup& rGroup = m_pObjManager->m_lstStaticTypes[nGroupId];

	siGroup.pStatObj = rGroup.pStatObj;
	if (siGroup.pStatObj)
		cry_strcpy(siGroup.szFileName, rGroup.pStatObj->GetFilePath());

	siGroup.bHideability = rGroup.bHideability;
	siGroup.bHideabilitySecondary = rGroup.bHideabilitySecondary;
	siGroup.nPlayerHideable = rGroup.nPlayerHideable;
	siGroup.bPickable = rGroup.bPickable;
	siGroup.fBending = rGroup.fBending;
	siGroup.nCastShadowMinSpec = rGroup.nCastShadowMinSpec;
	siGroup.bDynamicDistanceShadows = rGroup.bDynamicDistanceShadows;
	siGroup.bGIMode = rGroup.bGIMode;
	siGroup.offlineProcedural = rGroup.offlineProcedural;
	siGroup.bInstancing = rGroup.bInstancing;
	siGroup.fSpriteDistRatio = rGroup.fSpriteDistRatio;
	siGroup.fLodDistRatio = rGroup.fLodDistRatio;
	siGroup.fShadowDistRatio = rGroup.fShadowDistRatio;
	siGroup.fMaxViewDistRatio = rGroup.fMaxViewDistRatio;

	siGroup.fBrightness = rGroup.fBrightness;
	siGroup.pMaterial = rGroup.pMaterial;
	siGroup.bUseSprites = rGroup.bUseSprites;

	siGroup.fDensity = rGroup.fDensity;
	siGroup.fElevationMax = rGroup.fElevationMax;
	siGroup.fElevationMin = rGroup.fElevationMin;
	siGroup.fSize = rGroup.fSize;
	siGroup.fSizeVar = rGroup.fSizeVar;
	siGroup.fSlopeMax = rGroup.fSlopeMax;
	siGroup.fSlopeMin = rGroup.fSlopeMin;
	siGroup.bAutoMerged = rGroup.bAutoMerged;

	siGroup.fStiffness = rGroup.fStiffness;
	siGroup.fDamping = rGroup.fDamping;
	siGroup.bIgnoreTerrainLayerBlend = rGroup.bIgnoreTerrainLayerBlend;
	siGroup.fVariance = rGroup.fVariance;
	siGroup.fAirResistance = rGroup.fAirResistance;

	siGroup.nID = rGroup.nID;

	return true;
}

void C3DEngine::UpdateStatInstGroups()
{
	if (!m_pObjManager)
		return;

	PodArray<StatInstGroup>& rGroupTable = m_pObjManager->m_lstStaticTypes;

	for (uint32 nGroupId = 0; nGroupId < rGroupTable.size(); nGroupId++)
	{
		StatInstGroup& rGroup = rGroupTable[nGroupId];
		rGroup.Update(GetCVars(), Get3DEngine()->GetGeomDetailScreenRes());
	}
}

void C3DEngine::GetMemoryUsage(class ICrySizer* pSizer) const
{

#if !defined(_LIB) // Only when compiling as dynamic library
	//	{
	//SIZER_COMPONENT_NAME(pSizer,"Strings");
	//pSizer->AddObject( (this+1),string::_usedMemory(0) );
	//	}
	{
		SIZER_COMPONENT_NAME(pSizer, "STL Allocator Waste");
		CryModuleMemoryInfo meminfo;
		ZeroStruct(meminfo);
		CryGetMemoryInfoForModule(&meminfo);
		pSizer->AddObject((this + 2), (size_t)meminfo.STL_wasted);
	}
#endif

	pSizer->AddObject(this, sizeof(*this) + (GetCVars()->e_StreamCgfDebug ? 100 * 1024 * 1024 : 0));
	pSizer->AddObject(m_pCVars);

	pSizer->AddObject(m_lstDynLights);
	pSizer->AddObject(m_lstDynLightsNoLight);
	pSizer->AddObject(m_lstStaticLights);
	pSizer->AddObject(m_arrEntsInFoliage);

	pSizer->AddObject(m_lstRoadRenderNodesForUpdate);

	pSizer->AddObject(m_lstKilledVegetations);
	pSizer->AddObject(arrFPSforSaveLevelStats);
	pSizer->AddObject(m_lstAlwaysVisible);

	if (CTemporaryPool* pPool = CTemporaryPool::Get())
	{
		SIZER_COMPONENT_NAME(pSizer, "Temporary Pool");
		pPool->GetMemoryUsage(pSizer);
	}

	{
		SIZER_COMPONENT_NAME(pSizer, "RenderMeshMerger");
		m_pRenderMeshMerger->GetMemoryUsage(pSizer);
	}

	CRoadRenderNode::GetMemoryUsageStatic(pSizer);

	{
		SIZER_COMPONENT_NAME(pSizer, "Particles");
		pSizer->AddObject(m_pPartManager);
	}

	{
		SIZER_COMPONENT_NAME(pSizer, "ParticleSystem");
		pSizer->AddObject(pfx2::GetIParticleSystem());
	}

	{
		SIZER_COMPONENT_NAME(pSizer, "Optics");
		pSizer->AddObject(m_pOpticsManager);
	}

	{
		SIZER_COMPONENT_NAME(pSizer, "SkyLightManager");
		pSizer->AddObject(m_pSkyLightManager);
	}

	{
		SIZER_COMPONENT_NAME(pSizer, "DecalManager");
		pSizer->AddObject(m_pDecalManager);
	}

	{
		SIZER_COMPONENT_NAME(pSizer, "OutdoorObjectsTree");
		pSizer->AddObject(m_pObjectsTree);
	}

	{
		SIZER_COMPONENT_NAME(pSizer, "ObjManager");
		pSizer->AddObject(m_pObjManager);
	}

	{
		SIZER_COMPONENT_NAME(pSizer, "Terrain");
		pSizer->AddObject(m_pTerrain);
	}

	{
		SIZER_COMPONENT_NAME(pSizer, "VisAreas");
		pSizer->AddObject(m_pVisAreaManager);
	}

	{
		SIZER_COMPONENT_NAME(pSizer, "ClipVolumes");
		pSizer->AddObject(m_pClipVolumeManager);
	}

	CVegetation::GetStaticMemoryUsage(pSizer);

	{
		SIZER_COMPONENT_NAME(pSizer, "LayersBaseTextureData");
		pSizer->AddObject(m_arrBaseTextureData);
	}

	{
		SIZER_COMPONENT_NAME(pSizer, "WaterRipples");
		pSizer->AddObject(m_pWaterRippleManager.get());
	}
}

void C3DEngine::GetResourceMemoryUsage(ICrySizer* pSizer, const AABB& cstAABB)
{
	//////////////////////////////////////////////////////////////////////////
	std::vector<IRenderNode*> cFoundRenderNodes;
	unsigned int nFoundObjects(0);

	nFoundObjects = GetObjectsInBox(cstAABB);
	cFoundRenderNodes.resize(nFoundObjects, NULL);
	GetObjectsInBox(cstAABB, &cFoundRenderNodes.front());

	size_t nCurrentRenderNode(0);
	size_t nTotalNumberOfRenderNodes(0);

	nTotalNumberOfRenderNodes = cFoundRenderNodes.size();
	for (nCurrentRenderNode = 0; nCurrentRenderNode < nTotalNumberOfRenderNodes; ++nCurrentRenderNode)
	{
		IRenderNode*& piRenderNode = cFoundRenderNodes[nCurrentRenderNode];

		IMaterial* piMaterial(piRenderNode->GetMaterialOverride());
		if (!piMaterial)
		{
			piMaterial = piRenderNode->GetMaterial();
		}

		if (piMaterial)
		{
			piMaterial->GetResourceMemoryUsage(pSizer);
		}

		{
			IRenderMesh* piMesh(NULL);
			size_t nCount(0);

			piMesh = piRenderNode->GetRenderMesh(nCount);
			for (; piMesh; ++nCount, piMesh = piRenderNode->GetRenderMesh(nCount))
			{
				// Timur, RenderMesh may not be loaded due to streaming!
				piMesh->GetMemoryUsage(pSizer, IRenderMesh::MEM_USAGE_COMBINED);
			}
		}
	}
	//////////////////////////////////////////////////////////////////////////

	if (m_pTerrain)
	{
		CTerrainNode* poTerrainNode = m_pTerrain->FindMinNodeContainingBox(cstAABB);
		if (poTerrainNode)
		{
			poTerrainNode->GetResourceMemoryUsage(pSizer, cstAABB);
		}
	}
}

void C3DEngine::AddWaterRipple(const Vec3& vPos, float scale, float strength)
{
	if (m_pWaterRippleManager)
	{
		m_pWaterRippleManager->AddWaterRipple(vPos, scale, strength);
	}
}

bool C3DEngine::IsUnderWater(const Vec3& vPos) const
{
	bool bUnderWater = false;
	for (IPhysicalEntity* pArea = 0; pArea = GetPhysicalWorld()->GetNextArea(pArea);)
	{
		if (bUnderWater)
			// Must finish iteration to unlock areas.
			continue;

		pe_params_buoyancy buoy;
		if (pArea->GetParams(&buoy) && buoy.iMedium == 0)
		{
			if (!is_unused(buoy.waterPlane.n))
			{
				if (buoy.waterPlane.n * vPos < buoy.waterPlane.n * buoy.waterPlane.origin)
				{
					pe_status_contains_point st;
					st.pt = vPos;
					if (pArea->GetStatus(&st))
						bUnderWater = true;
				}
			}
		}
	}
	return bUnderWater;
}

void C3DEngine::SetOceanRenderFlags(uint8 nFlags)
{
	m_nOceanRenderFlags = nFlags;
}

uint32 C3DEngine::GetOceanVisiblePixelsCount() const
{
	return COcean::GetVisiblePixelsCount();
}

float C3DEngine::GetBottomLevel(const Vec3& referencePos, float maxRelevantDepth, int objflags)
{
	FUNCTION_PROFILER_3DENGINE;

	const float terrainWorldZ = GetTerrainElevation(referencePos.x, referencePos.y);

	const float padding = 0.2f;
	float rayLength;

	// NOTE: Terrain is above referencePos, so referencePos is probably inside a voxel or something.
	if (terrainWorldZ <= referencePos.z)
		rayLength = min(maxRelevantDepth, (referencePos.z - terrainWorldZ));
	else
		rayLength = maxRelevantDepth;

	rayLength += padding * 2.0f;

	ray_hit hit;
	int rayFlags = geom_colltype_player << rwi_colltype_bit | rwi_stop_at_pierceable;
	if (m_pPhysicalWorld->RayWorldIntersection(referencePos + Vec3(0, 0, padding), Vec3(0, 0, -rayLength),
	                                           ent_terrain | ent_static | ent_sleeping_rigid | ent_rigid, rayFlags, &hit, 1))
	{
		return hit.pt.z;
	}

	// Terrain was above or too far below referencePos, and no solid object was close enough.
	return BOTTOM_LEVEL_UNKNOWN;
}

float C3DEngine::GetBottomLevel(const Vec3& referencePos, float maxRelevantDepth /* = 10.0f */)
{
	return GetBottomLevel(referencePos, maxRelevantDepth, ent_terrain | ent_static | ent_sleeping_rigid | ent_rigid);
}

float C3DEngine::GetBottomLevel(const Vec3& referencePos, int objflags)
{
	return GetBottomLevel(referencePos, 10.0f, objflags);
}

#if defined(USE_GEOM_CACHES)
IGeomCache* C3DEngine::LoadGeomCache(const char* szFileName)
{
	if (!m_pGeomCacheManager)
	{
		return nullptr;
	}

	if (!szFileName || !szFileName[0])
	{
		m_pSystem->Warning(VALIDATOR_MODULE_3DENGINE, VALIDATOR_ERROR, 0, 0, "I3DEngine::LoadGeomCache: filename is not specified");
		return nullptr;
	}

	return m_pGeomCacheManager->LoadGeomCache(szFileName);
}

IGeomCache* C3DEngine::FindGeomCacheByFilename(const char* szFileName)
{
	if (!m_pGeomCacheManager || !szFileName || szFileName[0] == 0)
	{
		return nullptr;
	}

	return m_pGeomCacheManager->FindGeomCacheByFilename(szFileName);
}
#endif

namespace
{
// The return value is the next position of the source buffer.
int ReadFromBuffer(const char* pSource, int nSourceSize, int nSourcePos, void* pDest, int nDestSize)
{
	if (pDest == 0 || nDestSize == 0)
		return 0;

	if (nSourcePos < 0 || nSourcePos >= nSourceSize)
		return 0;

	memcpy(pDest, &pSource[nSourcePos], nDestSize);

	return nSourcePos + nDestSize;
}
}

//! Load an IStatObj for the engine based on the saved version. Save function is in
//! Code\Sandbox\Plugins\CryDesigner\Core\ModelCompiler.cpp, function ModelCompiler::SaveMesh
IStatObj* C3DEngine::LoadDesignerObject(int nVersion, const char* szBinaryStream, int size)
{
	if (nVersion < 0 || nVersion > 2)
		return NULL;

	int nBufferPos = 0;
	int32 nSubObjectCount = 0;
	nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, &nSubObjectCount, sizeof(int32));

	IStatObj* pStatObj = gEnv->p3DEngine->CreateStatObj();
	if (!pStatObj)
		return NULL;

	std::vector<IStatObj*> statObjList;
	if (nSubObjectCount > 0)
	{
		for (int i = 0; i < nSubObjectCount; ++i)
		{
			pStatObj->AddSubObject(gEnv->p3DEngine->CreateStatObj());
			statObjList.push_back(pStatObj->GetSubObject(i)->pStatObj);
		}
		pStatObj->GetIndexedMesh()->FreeStreams();
	}
	else
	{
		statObjList.push_back(pStatObj);
	}

	if (nVersion == 2)
	{
		int32 nStaticObjFlags = 0;
		nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, &nStaticObjFlags, sizeof(int32));
		pStatObj->SetFlags(nStaticObjFlags);
	}

	AABB statObj_bbox(AABB::RESET);

	for (int k = 0, iCount(statObjList.size()); k < iCount; ++k)
	{
		int32 nPositionCount = 0;
		int32 nTexCoordCount = 0;
		int32 nFaceCount = 0;
		int32 nIndexCount = 0;
		int32 nTangentCount = 0;
		int32 nSubsetCount = 0;

		nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, &nPositionCount, sizeof(int32));
		nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, &nTexCoordCount, sizeof(int32));
		if (nPositionCount <= 0 || nTexCoordCount <= 0)
			return NULL;

		if (nVersion == 0)
		{
			nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, &nFaceCount, sizeof(int32));
			if (nFaceCount <= 0)
				return NULL;
		}
		else if (nVersion >= 1)
		{
			nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, &nIndexCount, sizeof(int32));
			if (nIndexCount <= 0)
				return NULL;
			nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, &nTangentCount, sizeof(int32));
		}
		nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, &nSubsetCount, sizeof(int32));
		IIndexedMesh* pMesh = statObjList[k]->GetIndexedMesh();
		if (!pMesh)
			return NULL;

		pMesh->FreeStreams();
		pMesh->SetVertexCount((int)nPositionCount);
		pMesh->SetFaceCount((int)nFaceCount);
		pMesh->SetIndexCount((int)nIndexCount);
		pMesh->SetTexCoordCount((int)nTexCoordCount);

		Vec3* const positions = pMesh->GetMesh()->GetStreamPtr<Vec3>(CMesh::POSITIONS);
		Vec3* const normals = pMesh->GetMesh()->GetStreamPtr<Vec3>(CMesh::NORMALS);
		SMeshTexCoord* const texcoords = pMesh->GetMesh()->GetStreamPtr<SMeshTexCoord>(CMesh::TEXCOORDS);

		nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, positions, sizeof(Vec3) * nPositionCount);
		nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, normals, sizeof(Vec3) * nPositionCount);
		nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, texcoords, sizeof(SMeshTexCoord) * nTexCoordCount);
		if (nVersion == 0)
		{
			SMeshFace* const faces = pMesh->GetMesh()->GetStreamPtr<SMeshFace>(CMesh::FACES);
			nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, faces, sizeof(SMeshFace) * nFaceCount);
		}
		else if (nVersion >= 1)
		{
			vtx_idx* const indices = pMesh->GetMesh()->GetStreamPtr<vtx_idx>(CMesh::INDICES);
			if (sizeof(vtx_idx) == sizeof(uint16))
			{
				nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, indices, sizeof(uint16) * nIndexCount);
			}
			else
			{
				uint16* indices16 = new uint16[nIndexCount];
				nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, indices16, sizeof(uint16) * nIndexCount);
				for (int32 i = 0; i < nIndexCount; ++i)
					indices[i] = (vtx_idx)indices16[i];
				delete[] indices16;
			}
			pMesh->SetTangentCount((int)nTangentCount);
			if (nTangentCount > 0)
			{
				SMeshTangents* const tangents = pMesh->GetMesh()->GetStreamPtr<SMeshTangents>(CMesh::TANGENTS);
				nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, tangents, sizeof(SMeshTangents) * nTangentCount);
			}
		}

		// AABB calculation
#if 0
		if (nVersion < 3)
#endif
		{
			// No BB saved for this version, so we need to recalculate manually
			pMesh->CalcBBox();

			statObjList[k]->SetBBoxMin(pMesh->GetBBox().min);
			statObjList[k]->SetBBoxMax(pMesh->GetBBox().max);
		}
		// optimization for AABB loading - keep ifdef temporarily to keep volatile changes for after GDC16
#if 0
		else
		{
			// for version 3 we saved the result in the file, so we can load it directly instead of iterating through the mesh
			Vec3 minBB, maxBB;
			nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, &minBB, sizeof(Vec3));
			nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, &maxBB, sizeof(Vec3));

			statObjList[k]->SetBBoxMin(minBB);
			statObjList[k]->SetBBoxMax(maxBB);
		}
#endif

		statObj_bbox.Add(statObjList[k]->GetAABB());

		// subset loading
		pMesh->SetSubSetCount(nSubsetCount);

		for (int i = 0; i < nSubsetCount; ++i)
		{
			SMeshSubset subset;
			nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, &subset.vCenter, sizeof(Vec3));
			nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, &subset.fRadius, sizeof(float));
			nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, &subset.fTexelDensity, sizeof(float));

			int32 nFirstIndexId = 0;
			int32 nNumIndices = 0;
			int32 nFirstVertId = 0;
			int32 nNumVerts = 0;
			int32 nMatID = 0;
			int32 nMatFlags = 0;
			int32 nPhysicalizeType = 0;

			nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, &nFirstIndexId, sizeof(int32));
			nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, &nNumIndices, sizeof(int32));
			nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, &nFirstVertId, sizeof(int32));
			nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, &nNumVerts, sizeof(int32));
			nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, &nMatID, sizeof(int32));
			nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, &nMatFlags, sizeof(int32));
			nBufferPos = ReadFromBuffer(szBinaryStream, size, nBufferPos, &nPhysicalizeType, sizeof(int32));

			pMesh->SetSubsetBounds(i, subset.vCenter, subset.fRadius);
			pMesh->SetSubsetIndexVertexRanges(i, (int)nFirstIndexId, (int)nNumIndices, (int)nFirstVertId, (int)nNumVerts);
			pMesh->SetSubsetMaterialId(i, nMatID == -1 ? 0 : (int)nMatID);
			pMesh->SetSubsetMaterialProperties(i, (int)nMatFlags, (int)nPhysicalizeType);
		}

		if (nVersion == 0)
		{
#if CRY_PLATFORM_WINDOWS
			pMesh->Optimize();
#endif
		}

		statObjList[k]->Invalidate(true);
	}
	pStatObj->SetBBoxMin(statObj_bbox.min);
	pStatObj->SetBBoxMax(statObj_bbox.max);

	return pStatObj;
}

float C3DEngine::GetWaterLevel(const Vec3* pvPos, IPhysicalEntity* pent, bool bAccurate)
{
	FUNCTION_PROFILER_3DENGINE;

	bool bInVisarea = m_pVisAreaManager && m_pVisAreaManager->GetVisAreaFromPos(*pvPos) != 0;

	Vec3 gravity;
	pe_params_buoyancy pb[4];
	int i, nBuoys = m_pPhysicalWorld->CheckAreas(*pvPos, gravity, pb, 4, -1, ZERO, pent);

	float max_level = (!bInVisarea) ? (bAccurate ? GetAccurateOceanHeight(*pvPos) : GetWaterLevel()) : WATER_LEVEL_UNKNOWN;

	for (i = 0; i < nBuoys; i++)
	{
		if (pb[i].iMedium == 0 && (!bInVisarea || fabs_tpl(pb[i].waterPlane.origin.x) + fabs_tpl(pb[i].waterPlane.origin.y) > 0))
		{
			float fVolumeLevel = pvPos->z - pb[i].waterPlane.n.z * (pb[i].waterPlane.n * (*pvPos - pb[i].waterPlane.origin));

			// it's not ocean
			if (pb[i].waterPlane.origin.y + pb[i].waterPlane.origin.x != 0.0f)
				max_level = max(max_level, fVolumeLevel);
		}
	}

	return max(WATER_LEVEL_UNKNOWN, max_level);
}

void C3DEngine::SetShadowsGSMCache(bool bCache)
{
	if (bCache)
		m_nGsmCache = m_pConsole->GetCVar("r_ShadowsCache")->GetIVal();
	else
		m_nGsmCache = 0;
}

float C3DEngine::GetAccurateOceanHeight(const Vec3& pCurrPos) const
{
	FUNCTION_PROFILER_3DENGINE;

	static int nFrameID = -1;
	const int nEngineFrameID = gEnv->nMainFrameID;
	static float fWaterLevel = 0;
	if (nFrameID != nEngineFrameID && m_pTerrain)
	{
		fWaterLevel = m_pTerrain->GetWaterLevel();
		nFrameID = nEngineFrameID;
	}

	const float waterLevel = fWaterLevel + COcean::GetWave(pCurrPos, gEnv->nMainFrameID);
	return waterLevel;
}

Vec4 C3DEngine::GetCausticsParams() const
{
	return Vec4(m_oceanCausticsTilling, m_oceanCausticsDistanceAtten, m_oceanCausticsMultiplier, 1.0);
}

Vec4 C3DEngine::GetOceanAnimationCausticsParams() const
{
	return Vec4(1, m_oceanCausticHeight, m_oceanCausticDepth, m_oceanCausticIntensity);
}

void C3DEngine::GetHDRSetupParams(Vec4 pParams[5]) const
{
	pParams[0] = m_vHDRFilmCurveParams;
	pParams[1] = Vec4(m_fHDRBloomAmount * 0.3f, m_fHDRBloomAmount * 0.3f, m_fHDRBloomAmount * 0.3f, m_fGrainAmount);
	pParams[2] = Vec4(m_vColorBalance, m_fHDRSaturation);
	pParams[3] = Vec4(m_vHDREyeAdaptation, 1.0f);
	pParams[4] = Vec4(m_vHDREyeAdaptationLegacy, 1.0f);
}

void C3DEngine::GetOceanAnimationParams(Vec4& pParams0, Vec4& pParams1) const
{
	static int nFrameID = -1;
	int nCurrFrameID = gEnv->nMainFrameID;

	static Vec4 s_pParams0 = Vec4(0, 0, 0, 0);
	static Vec4 s_pParams1 = Vec4(0, 0, 0, 0);

	if (nFrameID != nCurrFrameID && m_pTerrain)
	{
		sincos_tpl(m_oceanWindDirection, &s_pParams1.y, &s_pParams1.z);

		s_pParams0 = Vec4(m_oceanWindDirection, m_oceanWindSpeed, 0.0f, m_oceanWavesAmount);
		s_pParams1.x = m_oceanWavesSize;
		s_pParams1.w = m_pTerrain->GetWaterLevel();

		nFrameID = nCurrFrameID;
	}

	pParams0 = s_pParams0;
	pParams1 = s_pParams1;
};

IVisArea* C3DEngine::CreateVisArea(uint64 visGUID)
{
	return m_pObjManager ? m_pVisAreaManager->CreateVisArea(visGUID) : 0;
}

void C3DEngine::DeleteVisArea(IVisArea* pVisArea)
{

	if (!m_pVisAreaManager->IsValidVisAreaPointer((CVisArea*)pVisArea))
	{
		Warning("I3DEngine::DeleteVisArea: Invalid VisArea pointer");
		return;
	}
	if (m_pObjManager)
	{
		CVisArea* pArea = (CVisArea*)pVisArea;

		//		if(pArea->IsObjectsTreeValid())
		//		pArea->GetObjectsTree()->FreeAreaBrushes(true);

		PodArray<SRNInfo> lstEntitiesInArea;
		if (pArea->IsObjectsTreeValid())
			pArea->GetObjectsTree()->MoveObjectsIntoList(&lstEntitiesInArea, NULL);

		// unregister from indoor
		for (int i = 0; i < lstEntitiesInArea.Count(); i++)
			Get3DEngine()->UnRegisterEntityDirect(lstEntitiesInArea[i].pNode);

		if (pArea->IsObjectsTreeValid())
			assert(pArea->GetObjectsTree()->GetObjectsCount(eMain) == 0);

		m_pVisAreaManager->DeleteVisArea((CVisArea*)pVisArea);

		for (int i = 0; i < lstEntitiesInArea.Count(); i++)
			Get3DEngine()->RegisterEntity(lstEntitiesInArea[i].pNode);
	}
}

void C3DEngine::UpdateVisArea(IVisArea* pVisArea, const Vec3* pPoints, int nCount, const char* szName,
                              const SVisAreaInfo& info, bool bReregisterObjects)
{
	if (!m_pObjManager || !m_pVisAreaManager)
		return;

	CVisArea* pArea = (CVisArea*)pVisArea;

	//	PrintMessage("C3DEngine::UpdateVisArea: %s", szName);

	Vec3 vTotalBoxMin = pArea->m_boxArea.min;
	Vec3 vTotalBoxMax = pArea->m_boxArea.max;

	m_pVisAreaManager->UpdateVisArea((CVisArea*)pVisArea, pPoints, nCount, szName, info);

	if (((CVisArea*)pVisArea)->IsObjectsTreeValid() && ((CVisArea*)pVisArea)->GetObjectsTree()->GetObjectsCount(eMain))
	{
		// merge old and new bboxes
		vTotalBoxMin.CheckMin(pArea->m_boxArea.min);
		vTotalBoxMax.CheckMax(pArea->m_boxArea.max);
	}
	else
	{
		vTotalBoxMin = pArea->m_boxArea.min;
		vTotalBoxMax = pArea->m_boxArea.max;
	}

	if (bReregisterObjects)
	{
		AABB aabb(vTotalBoxMin - Vec3(8, 8, 8), vTotalBoxMax + Vec3(8, 8, 8));
		m_pObjManager->ReregisterEntitiesInArea(&aabb);
	}
}

IClipVolume* C3DEngine::CreateClipVolume()
{
	MarkRNTmpDataPoolForReset();
	return m_pClipVolumeManager->CreateClipVolume();
}

void C3DEngine::DeleteClipVolume(IClipVolume* pClipVolume)
{
	MarkRNTmpDataPoolForReset();
	m_pClipVolumeManager->DeleteClipVolume(pClipVolume);
}

void C3DEngine::UpdateClipVolume(IClipVolume* pClipVolume, _smart_ptr<IRenderMesh> pRenderMesh, IBSPTree3D* pBspTree, const Matrix34& worldTM, uint8 viewDistRatio, bool bActive, uint32 flags, const char* szName)
{
	MarkRNTmpDataPoolForReset();
	m_pClipVolumeManager->UpdateClipVolume(pClipVolume, pRenderMesh, pBspTree, worldTM, viewDistRatio, bActive, flags, szName);
}

void C3DEngine::ResetParticlesAndDecals()
{
	if (m_pPartManager)
		m_pPartManager->Reset();

	if (m_pDecalManager)
		m_pDecalManager->Reset();

	CStatObjFoliage* pFoliage, * pFoliageNext;
	for (pFoliage = m_pFirstFoliage; &pFoliage->m_next != &m_pFirstFoliage; pFoliage = pFoliageNext)
	{
		pFoliageNext = pFoliage->m_next;
		delete pFoliage;
	}

	ReRegisterKilledVegetationInstances();
}

void C3DEngine::ResetTemporalCaches()
{
	if (m_nGsmCache > 0)
	{
		m_CachedShadowsBounds.Reset();
		SetRecomputeCachedShadows(m_nCachedShadowsUpdateStrategy = ShadowMapFrustum::ShadowCacheData::eFullUpdate);
	}
}

IRenderNode* C3DEngine::CreateRenderNode(EERType type)
{
	switch (type)
	{
	case eERType_Brush:
		{
			CBrush* pBrush = new CBrush();
			return pBrush;
		}
	case eERType_MovableBrush:
		{
			CMovableBrush* pEntityBrush = new CMovableBrush();
			return pEntityBrush;
		}
	case eERType_Vegetation:
		{
			CVegetation* pVeget = new CVegetation();
			return pVeget;
		}
	case eERType_FogVolume:
		{
			CFogVolumeRenderNode* pFogVolume = new CFogVolumeRenderNode();
			return pFogVolume;
		}
	case eERType_Road:
		{
			CRoadRenderNode* pRoad = new CRoadRenderNode();
			return pRoad;
		}
	case eERType_Decal:
		{
			CDecalRenderNode* pDecal = new CDecalRenderNode();
			return pDecal;
		}
	case eERType_WaterVolume:
		{
			CWaterVolumeRenderNode* pWaterVolume = new CWaterVolumeRenderNode();
			return pWaterVolume;
		}
	case eERType_WaterWave:
		{
			CWaterWaveRenderNode* pRenderNode = new CWaterWaveRenderNode();
			return pRenderNode;
		}
	case eERType_DistanceCloud:
		{
			CDistanceCloudRenderNode* pRenderNode = new CDistanceCloudRenderNode();
			return pRenderNode;
		}
	case eERType_Rope:
		{
			IRopeRenderNode* pRenderNode = new CRopeRenderNode();
			return pRenderNode;
		}
	case eERType_BreakableGlass:
		{
			IBreakableGlassRenderNode* pRenderNode = new CBreakableGlassRenderNode();
			return pRenderNode;
		}

	case eERType_CloudBlocker:
		{
			IRenderNode* pRenderNode = new CCloudBlockerRenderNode();
			return pRenderNode;
		}

	case eERType_MergedMesh:
		{
			IRenderNode* pRenderNode = new CMergedMeshRenderNode();
			return pRenderNode;
		}
	case eERType_Character:
		{
			IRenderNode* pRenderNode = new CCharacterRenderNode();
			return pRenderNode;
		}

#if defined(USE_GEOM_CACHES)
	case eERType_GeomCache:
		{
			IRenderNode* pRenderNode = new CGeomCacheRenderNode();
			return pRenderNode;
		}
#endif
	}
	assert(!"C3DEngine::CreateRenderNode: Specified node type is not supported.");
	return 0;
}

void C3DEngine::DeleteRenderNode(IRenderNode* pRenderNode)
{
	CRY_PROFILE_FUNCTION(PROFILE_LOADING_ONLY);

	UnRegisterEntityDirect(pRenderNode);

	// No need to defer rendernode deletion on unload and shutdown as the renderthread
	// has already finished all rendering tasks at this point.
	if (m_bInUnload || m_bInShutDown)
	{
		CRY_ASSERT((pRenderNode->GetRndFlags() & ERF_PENDING_DELETE) == 0);
		pRenderNode->ReleaseNode(true);
	}
	else
	{
		pRenderNode->SetRndFlags(ERF_PENDING_DELETE, true);
		m_renderNodesToDelete[m_renderNodesToDeleteID].push_back(pRenderNode);
	}
}

void C3DEngine::TickDelayedRenderNodeDeletion()
{
	m_renderNodesToDeleteID = (m_renderNodesToDeleteID + 1) % CRY_ARRAY_COUNT(m_renderNodesToDelete);

	while (m_renderNodesToDelete[m_renderNodesToDeleteID].size())
	{
		auto snapshot = std::move(m_renderNodesToDelete[m_renderNodesToDeleteID]);
		m_renderNodesToDelete[m_renderNodesToDeleteID] = std::vector<IRenderNode*> {};

		for (auto pRenderNode : snapshot)
		{
			pRenderNode->SetRndFlags(ERF_PENDING_DELETE, false);
			pRenderNode->ReleaseNode(true);
		}
	}
}

void C3DEngine::SetWind(const Vec3& vWind)
{
	m_vWindSpeed = vWind;

	if (m_pBreezeGenerator)
	{
		m_pBreezeGenerator->m_params.windVector = vWind;
	}

	if (!m_vWindSpeed.IsZero())
	{
		// Maintain a large physics area for global wind.
		if (!m_pGlobalWind)
		{
			primitives::sphere geomSphere;
			geomSphere.center = Vec3(0);
			geomSphere.r = 1e7f;
			IGeometry* pGeom = m_pPhysicalWorld->GetGeomManager()->CreatePrimitive(primitives::sphere::type, &geomSphere);
			m_pGlobalWind = GetPhysicalWorld()->AddArea(pGeom, Vec3(ZERO), Quat(IDENTITY), 1.0f);

			pe_params_foreign_data fd;
			fd.iForeignFlags = PFF_OUTDOOR_AREA;
			m_pGlobalWind->SetParams(&fd);
		}

		// Set medium half-plane above water level. Set standard air density.
		pe_params_buoyancy pb;
		pb.iMedium = 1;
		pb.waterPlane.n.Set(0, 0, -1);
		pb.waterPlane.origin.Set(0, 0, GetWaterLevel());
		pb.waterFlow = m_vWindSpeed;
		pb.waterResistance = 1;
		pb.waterDensity = 1;
		m_pGlobalWind->SetParams(&pb);
	}
	else if (m_pGlobalWind)
	{
		GetPhysicalWorld()->DestroyPhysicalEntity(m_pGlobalWind);
		m_pGlobalWind = 0;
	}
}

Vec3 C3DEngine::GetWind(const AABB& box, bool bIndoors) const
{
	FUNCTION_PROFILER_3DENGINE;

	if (!m_pCVars->e_Wind)
		return Vec3(ZERO);

	Vec3 wind(0, 0, 0);
	SampleWind(&wind, 1, box, bIndoors);
	return wind;
}

Vec3 C3DEngine::GetGlobalWind(bool bIndoors) const
{
	// We assume indoor wind is zero.
	return (!m_pCVars->e_Wind || bIndoors) ? Vec3Constants<f32>::fVec3_Zero : m_vWindSpeed;
}

// Compute barycentric coordinates (u, v, w) for
// point p with respect to triangle (a, b, c)
inline void ComputerBarycentric2d(Vec2& p, Vec2& a, Vec2& b, Vec2& c, float& u, float& v, float& w)
{
	Vec2 v0 = b - a, v1 = c - a, v2 = p - a;
	float d00 = v0.Dot(v0);
	float d01 = v0.Dot(v1);
	float d11 = v1.Dot(v1);
	float d20 = v2.Dot(v0);
	float d21 = v2.Dot(v1);
	float invDenom = 1.0f / (d00 * d11 - d01 * d01);
	v = (d11 * d20 - d01 * d21) * invDenom;
	w = (d00 * d21 - d01 * d20) * invDenom;
	u = 1.0f - v - w;
}

bool C3DEngine::SampleWind(Vec3* pSamples, int nSamples, const AABB& volume, bool bIndoors) const
{
	if (!m_pCVars->e_Wind || nSamples == 0)
		return false;

	FUNCTION_PROFILER_3DENGINE;

	// Start with global wind.
	Vec3 vWind = GetGlobalWind(bIndoors);

	auto* pWindAreas = &m_outdoorWindAreas[m_nCurrentWindAreaList];
	if (bIndoors)
		pWindAreas = &m_indoorWindAreas[m_nCurrentWindAreaList];

	for (int i = 0; i < nSamples; ++i)
	{
		Vec3 pos = pSamples[i]; // Take position out of sample point,

		// Add global wind to sample point
		pSamples[i] = vWind;

		if (!m_pCVars->e_WindAreas)
			continue;

		int px = (int)pos.x;
		int py = (int)pos.y;
		// Iterate all areas, looking for wind areas. Skip first (global) area, and global wind.
		for (const auto& windArea : *pWindAreas)
		{
			if (
				px >= windArea.x0 &&
				px <= windArea.x1 &&
				py >= windArea.y0 &&
				py <= windArea.y1)
			{
				// TODO: Interpolate wind position between corner points.
				//float u, v, w;
				//ComputerBarycentric2d(pos, windArea.pos[0], windArea.pos[1], windArea.pos[2], u, v, w);
				pSamples[i] += windArea.windSpeed[4];

				//pe_status_area area;
				//area.ctr = pos;
				//if (windArea.pArea->GetStatus(&area))
				//pSamples[i] += area.pb.waterFlow;

			}
		}
	}

	return true;
}

IBreezeGenerator* C3DEngine::GetBreezeGenerator() const
{
	return Cry3DEngineBase::GetBreezeGenerator();
}

//==============================================================================================================================================
// From "MergedMeshGeometry.cpp"
#if CRY_PLATFORM_SSE2 && !CRY_PLATFORM_F16C
static inline __m128i float_to_half_SSE2(__m128 f, __m128i& s)
{
	#define DECL_CONST4(name, val) static const CRY_ALIGN(16) uint name[4] = { (val), (val), (val), (val) }
	#define GET_CONSTI(name)       *(const __m128i*)&name
	#define GET_CONSTF(name)       *(const __m128*)&name

	DECL_CONST4(mask_sign, 0x80000000u);
	DECL_CONST4(mask_round, ~0xfffu);
	//DECL_CONST4(c_f32infty, 255 << 23);
	DECL_CONST4(c_magic, 15 << 23);
	//DECL_CONST4(c_nanbit, 0x200);
	//DECL_CONST4(c_infty_as_fp16, 0x7c00);
	DECL_CONST4(c_clamp, (31 << 23) - 0x1000);

	__m128 msign = GET_CONSTF(mask_sign);
	__m128 justsign = _mm_and_ps(msign, f);
	//__m128i f32infty = GET_CONSTI(c_f32infty);
	__m128 absf = _mm_xor_ps(f, justsign);
	__m128 mround = GET_CONSTF(mask_round);
	//__m128i absf_int = _mm_castps_si128(absf); // pseudo-op, but val needs to be copied once so count as mov
	//__m128i b_isnan = _mm_cmpgt_epi32(absf_int, f32infty);
	//__m128i b_isnormal = _mm_cmpgt_epi32(f32infty, _mm_castps_si128(absf));
	//__m128i nanbit = _mm_and_si128(b_isnan, GET_CONSTI(c_nanbit));
	//__m128i inf_or_nan = _mm_or_si128(nanbit, GET_CONSTI(c_infty_as_fp16));

	__m128 fnosticky = _mm_and_ps(absf, mround);
	__m128 scaled = _mm_mul_ps(fnosticky, GET_CONSTF(c_magic));
	__m128 clamped = _mm_min_ps(scaled, GET_CONSTF(c_clamp)); // logically, we want PMINSD on "biased", but this should gen better code
	__m128i biased = _mm_sub_epi32(_mm_castps_si128(clamped), _mm_castps_si128(mround));
	__m128i shifted = _mm_srli_epi32(biased, 13);
	//__m128i normal = _mm_and_si128(shifted, b_isnormal);
	//__m128i not_normal = _mm_andnot_si128(b_isnormal, inf_or_nan);
	//__m128i joined = _mm_or_si128(normal, not_normal);

	//	__m128i sign_shift = _mm_srli_epi32(_mm_castps_si128(justsign), 16);
	//	__m128i final = _mm_or_si128(joined, sign_shift);
	s = _mm_castps_si128(justsign);

	// ~20 SSE2 ops
	return shifted;

	#undef DECL_CONST4
	#undef GET_CONSTI
	#undef GET_CONSTF
}

static inline __m128i approx_float_to_half_SSE2(__m128 f, __m128i& s)
{
	#if defined(CRY_COMPILER_GCC) || defined(CRY_COMPILER_CLANG)
		#define DECL_CONST4(name, val) static const uint __attribute__((aligned(16))) name[4] = { (val), (val), (val), (val) }
	#else
		#define DECL_CONST4(name, val) static const __declspec(align(16)) uint name[4] = { (val), (val), (val), (val) }
	#endif
	#define GET_CONSTF(name)         *(const __m128*)&name

	DECL_CONST4(mask_fabs, 0x7fffffffu);
	DECL_CONST4(c_f32infty, (255 << 23));
	DECL_CONST4(c_expinf, (255 ^ 31) << 23);
	DECL_CONST4(c_f16max, (127 + 16) << 23);
	DECL_CONST4(c_magic, 15 << 23);

	__m128 mabs = GET_CONSTF(mask_fabs);
	__m128 fabs = _mm_and_ps(mabs, f);
	__m128 justsign = _mm_xor_ps(f, fabs);

	__m128 f16max = GET_CONSTF(c_f16max);
	__m128 expinf = GET_CONSTF(c_expinf);
	__m128 infnancase = _mm_xor_ps(expinf, fabs);
	__m128 clamped = _mm_min_ps(f16max, fabs);
	__m128 b_notnormal = _mm_cmpnlt_ps(fabs, GET_CONSTF(c_f32infty));
	__m128 scaled = _mm_mul_ps(clamped, GET_CONSTF(c_magic));

	__m128 merge1 = _mm_and_ps(infnancase, b_notnormal);
	__m128 merge2 = _mm_andnot_ps(b_notnormal, scaled);
	__m128 merged = _mm_or_ps(merge1, merge2);

	__m128i shifted = _mm_srli_epi32(_mm_castps_si128(merged), 13);

	//	__m128i signshifted = _mm_srli_epi32(_mm_castps_si128(justsign), 16);
	//	__m128i final = _mm_or_si128(shifted, signshifted);
	s = _mm_castps_si128(justsign);

	// ~15 SSE2 ops
	return shifted;

	#undef DECL_CONST4
	#undef GET_CONSTF
}
#endif

void C3DEngine::AddForcedWindArea(const Vec3& vPos, float fAmountOfForce, float fRadius)
{
	SOptimizedOutdoorWindArea area;
	area.point[4].x = vPos.x;
	area.point[4].y = vPos.y;

	Vec3 vSpeed = cry_random(Vec3(-1, -1, -1), Vec3(1, 1, 1));
	vSpeed.Normalize();
	area.windSpeed[4] = vSpeed * fAmountOfForce;

	area.point[0].x = vPos.x - fRadius;
	area.point[0].y = vPos.y - fRadius;
	area.windSpeed[0] = Vec3(-0.01f, -0.01f, 0);

	area.point[1].x = vPos.x + fRadius;
	area.point[1].y = vPos.y - fRadius;
	area.windSpeed[1] = Vec3(0.01f, -0.01f, 0);

	area.point[2].x = vPos.x + fRadius;
	area.point[2].y = vPos.y + fRadius;
	area.windSpeed[2] = Vec3(0.01f, 0.01f, 0);

	area.point[3].x = vPos.x - fRadius;
	area.point[3].y = vPos.y + fRadius;
	area.windSpeed[3] = Vec3(-0.01f, 0.01f, 0);

	m_forcedWindAreas.push_back(area);
}

void C3DEngine::UpdateWindGridJobEntry(Vec3 vPos)
{
	FUNCTION_PROFILER_3DENGINE

	bool bIndoors = false;

	auto* pWindAreas = &m_outdoorWindAreas[m_nCurrentWindAreaList];
	if (bIndoors)
		pWindAreas = &m_indoorWindAreas[m_nCurrentWindAreaList];
	Vec3 vGlobalWind = GetGlobalWind(bIndoors);

	float fCurTime = gEnv->pTimer->GetCurrTime();
	float fElapsedTime = fCurTime - m_fLastWindProcessedTime;
	m_fLastWindProcessedTime = fCurTime;

	bool bReset = false;
	if (fElapsedTime >= 2.0f)
		bReset = true;

	if (!bReset)
	{
		RasterWindAreas(pWindAreas, fElapsedTime);

		pWindAreas = &m_forcedWindAreas;
		RasterWindAreas(pWindAreas, fElapsedTime);
	}
	RasterGlobalWind(vGlobalWind, fElapsedTime, bReset);

	// Fade forced wind out
	for (size_t i = 0; i < pWindAreas->size(); i++)
	{
		SOptimizedOutdoorWindArea& WA = (*pWindAreas)[i];
		WA.windSpeed[4].x *= 1.0f - fElapsedTime;
		if (WA.windSpeed->IsZero(0.001f))
		{
			pWindAreas->erase(pWindAreas->begin() + i);
			i--;
		}
	}
}

void C3DEngine::RasterWindAreas(std::vector<SOptimizedOutdoorWindArea>* pWindAreas, float fElapsedTime)
{
	// Don't update anything if there are no areas with wind
	if (pWindAreas->size() == 0)
		return;

	SWindGrid& rWindGrid = m_WindGrid[m_nCurWind];

	rWindGrid.m_vCentr = m_vWindFieldCamera;
	rWindGrid.m_vCentr.z = 0;

	float fSize = (float)rWindGrid.m_nWidth * rWindGrid.m_fCellSize;
	Vec3 vHalfSize = Vec3(fSize * 0.5f, fSize * 0.5f, 0.0f);
	AABB windBox(rWindGrid.m_vCentr - vHalfSize, rWindGrid.m_vCentr + vHalfSize);

	// 1 Step: Rasterize wind areas
	for (const auto& windArea : *pWindAreas)
	{
		SOptimizedOutdoorWindArea WA = windArea;
		WA.point[1].x = (WA.point[0].x + WA.point[1].x) * 0.5f;
		WA.point[2] = WA.point[4];
		WA.windSpeed[2] = WA.windSpeed[4];
		WA.point[3].y = (WA.point[0].y + WA.point[3].y) * 0.5f;
		UpdateWindGridArea(rWindGrid, WA, windBox);

		WA = windArea;
		WA.point[0].x = (WA.point[0].x + WA.point[1].x) * 0.5f;
		WA.point[3] = WA.point[4];
		WA.windSpeed[3] = WA.windSpeed[4];
		WA.point[2].y = (WA.point[1].y + WA.point[2].y) * 0.5f;
		UpdateWindGridArea(rWindGrid, WA, windBox);

		WA = windArea;
		WA.point[3].x = (WA.point[3].x + WA.point[2].x) * 0.5f;
		WA.point[0] = WA.point[4];
		WA.windSpeed[0] = WA.windSpeed[4];
		WA.point[1].y = (WA.point[1].y + WA.point[2].y) * 0.5f;
		UpdateWindGridArea(rWindGrid, WA, windBox);

		WA = windArea;
		WA.point[2].x = (WA.point[3].x + WA.point[2].x) * 0.5f;
		WA.point[1] = WA.point[4];
		WA.windSpeed[1] = WA.windSpeed[4];
		WA.point[0].y = (WA.point[0].y + WA.point[3].y) * 0.5f;
		UpdateWindGridArea(rWindGrid, WA, windBox);
	}
}

void C3DEngine::RasterGlobalWind(const Vec3& vGlobalWind, float fElapsedTime, bool bReset)
{
	const float fBEND_RESPONSE = 0.25f;
	const float fMAX_BENDING = 2.f;

	// Don't update anything if there are no areas with wind
	if (vGlobalWind.IsZero())
		return;

	SWindGrid& rWindGrid = m_WindGrid[m_nCurWind];

	int x;
	rWindGrid.m_vCentr = m_vWindFieldCamera;
	rWindGrid.m_vCentr.z = 0;

	float fInterp = min(fElapsedTime * 0.8f, 1.f);

	int nFrame = gEnv->nMainFrameID;

	// 2 Step: Initialize the rest of the field by global wind value
	const int nSize = rWindGrid.m_nWidth * rWindGrid.m_nHeight;
	Vec2 vWindCur = Vec2(vGlobalWind.x, vGlobalWind.y) * GetCVars()->e_WindBendingStrength;

	if (bReset)
	{
#if CRY_PLATFORM_SSE2
		__m128i* pData = (__m128i*)&rWindGrid.m_pData[0];
		__m128i* pFrames = (__m128i*)&m_pWindAreaFrames[0];
		__m128* pField = (__m128*)&m_pWindField[0];

		Vec2 vBend = vWindCur * fBEND_RESPONSE;
		vBend *= fMAX_BENDING / (fMAX_BENDING + vBend.GetLength());

		__m128 vBends = _mm_set_ps(vBend.y, vBend.x, vBend.y, vBend.x);

	#if CRY_PLATFORM_F16C
		__m128i hData = _mm_cvtps_ph(vBends, 0);
		hData = _mm_unpacklo_epi64(hData, hData);
	#else
		__m128i hSign, hData = approx_float_to_half_SSE2(vBends, hSign);
		hSign = _mm_packs_epi32(hSign, hSign);
		hData = _mm_packs_epi32(hData, hData);
		hData = _mm_or_si128(hSign, hData);
	#endif

		__m128i nFrames = _mm_set1_epi32(nFrame);
		__m128 vWindCurs = _mm_set_ps(vWindCur.y, vWindCur.x, vWindCur.y, vWindCur.x);
		for (x = 0; x < ((nSize + 3) / 4); ++x)
		{
			_mm_storeu_si128(pFrames + x, nFrames);

			_mm_storeu_ps((float*)(pField + x * 2 + 0), vWindCurs);
			_mm_storeu_ps((float*)(pField + x * 2 + 1), vWindCurs);

			_mm_storeu_si128(pData + x, hData);
		}
#else
		CryHalf2* pData = &rWindGrid.m_pData[0];
		int* pFrames = &m_pWindAreaFrames[0];
		Vec2* pField = &m_pWindField[0];

		Vec2 vBend = vWindCur * fBEND_RESPONSE;
		vBend *= fMAX_BENDING / (fMAX_BENDING + vBend.GetLength());
		CryHalf2 vData = CryHalf2(vBend.x, vBend.y);

		for (x = 0; x < nSize; x++)
		{
			// Test and update or skip
			pFrames[x] = nFrame;
			pField[x] = vWindCur;
			pData[x] = vData;
		}
#endif
		return;
	}

#if CRY_PLATFORM_SSE2
	__m128i nFrames = _mm_set1_epi32(nFrame);
	__m128i* pData = (__m128i*)&rWindGrid.m_pData[0];
	__m128i* pFrames = (__m128i*)&m_pWindAreaFrames[0];
	__m128* pField = (__m128*)&m_pWindField[0];
	__m128 vWindCurs = _mm_set_ps(vWindCur.y, vWindCur.x, vWindCur.y, vWindCur.x);
	__m128 fInterps = _mm_set1_ps(fInterp);
	__m128 fBendRps = _mm_set1_ps(fBEND_RESPONSE);
	__m128 fBendMax = _mm_set1_ps(fMAX_BENDING);

	for (x = 0; x < ((nSize + 3) / 4); ++x)
	{
		// Test and update or skip
		__m128i cFrame = _mm_loadu_si128(pFrames + x);
		__m128i bMask = _mm_cmpgt_epi32(nFrames, cFrame);
		if (_mm_movemask_ps(_mm_castsi128_ps(bMask)) == 0x0)
			continue;

		cFrame = _mm_or_si128(_mm_and_si128(bMask, nFrames), _mm_andnot_si128(bMask, cFrame));
		_mm_storeu_si128(pFrames + x, cFrame);

		// Interpolate
		{
			__m128 loField = _mm_loadu_ps((float*)(pField + x * 2 + 0));
			__m128 hiField = _mm_loadu_ps((float*)(pField + x * 2 + 1));
			__m128 ipField = _mm_and_ps(fInterps, _mm_castsi128_ps(bMask));

			__m128 loFieldInterps = _mm_unpacklo_ps(ipField, ipField);
			__m128 hiFieldInterps = _mm_unpackhi_ps(ipField, ipField);

			loField = _mm_add_ps(loField, _mm_mul_ps(_mm_sub_ps(vWindCurs, loField), loFieldInterps));
			hiField = _mm_add_ps(hiField, _mm_mul_ps(_mm_sub_ps(vWindCurs, hiField), hiFieldInterps));

			_mm_storeu_ps((float*)(pField + x * 2 + 0), loField);
			_mm_storeu_ps((float*)(pField + x * 2 + 1), hiField);

			loField = _mm_mul_ps(loField, fBendRps);
			hiField = _mm_mul_ps(hiField, fBendRps);

			__m128 loFieldLength = _mm_mul_ps(loField, loField);
			__m128 hiFieldLength = _mm_mul_ps(hiField, hiField);

	#if CRY_PLATFORM_SSE4
			loFieldLength = _mm_add_ps(_mm_sqrt_ps(_mm_hadd_ps(hiFieldLength, loFieldLength)), fBendMax);

			loField = _mm_div_ps(_mm_mul_ps(loField, fBendMax), _mm_unpacklo_ps(loFieldLength, loFieldLength));
			hiField = _mm_div_ps(_mm_mul_ps(hiField, fBendMax), _mm_unpackhi_ps(loFieldLength, loFieldLength));
	#else
			loFieldLength = _mm_sqrt_ps(_mm_add_ps(loFieldLength, _mm_shuffle_ps(loFieldLength, loFieldLength, _MM_SHUFFLE(2, 3, 0, 1))));
			hiFieldLength = _mm_sqrt_ps(_mm_add_ps(hiFieldLength, _mm_shuffle_ps(hiFieldLength, hiFieldLength, _MM_SHUFFLE(2, 3, 0, 1))));

			loField = _mm_div_ps(_mm_mul_ps(loField, fBendMax), _mm_add_ps(loFieldLength, fBendMax));
			hiField = _mm_div_ps(_mm_mul_ps(hiField, fBendMax), _mm_add_ps(hiFieldLength, fBendMax));
	#endif

	#if CRY_PLATFORM_F16C
			__m128i loData = _mm_cvtps_ph(loField, 0);
			__m128i hiData = _mm_cvtps_ph(hiField, 0);

			_mm_storeu_si128(pData + x, _mm_unpacklo_epi64(loData, hiData));
	#else
			__m128i loSign, loData = approx_float_to_half_SSE2(loField, loSign);
			__m128i hiSign, hiData = approx_float_to_half_SSE2(hiField, hiSign);

			loSign = _mm_packs_epi32(loSign, hiSign);
			loData = _mm_packs_epi32(loData, hiData);

			_mm_storeu_si128(pData + x, _mm_or_si128(loSign, loData));
	#endif
		}
	}
#else
	CryHalf2* pData = &rWindGrid.m_pData[0];
	int* pFrames = &m_pWindAreaFrames[0];
	Vec2* pField = &m_pWindField[0];

	for (x = 0; x < nSize; x++)
	{
		// Test and update or skip
		if (pFrames[x] == nFrame)
			continue;
		pFrames[x] = nFrame;

		// Interpolate
		{
			Vec2 vWindInt = pField[x];
			vWindInt += (vWindCur - vWindInt) * fInterp;
			pField[x] = vWindInt;

			Vec2 vBend = vWindInt * fBEND_RESPONSE;
			vBend *= fMAX_BENDING / (fMAX_BENDING + vBend.GetLength());
			pData[x] = CryHalf2(vBend.x, vBend.y);
		}
	}
#endif
}

//static int g_nWindError;
void C3DEngine::UpdateWindGridArea(SWindGrid& rWindGrid, const SOptimizedOutdoorWindArea& windArea, const AABB& windBox)
{
	//FUNCTION_PROFILER_3DENGINE
	int x, y;

	const int tl = 0, tr = 1, br = 2, bl = 3;

	AABB areaBox(windArea.point[tl], windArea.point[br]);
	if (!windBox.ContainsBox2D(areaBox))
		return;

	Vec3 vGlobalWind = GetGlobalWind(false) * GetCVars()->e_WindBendingStrength;

	float fInterp = min(gEnv->pTimer->GetFrameTime() * 0.8f, 1.f);

	int nFrame = gEnv->nMainFrameID;

	static const float fBEND_RESPONSE = 0.25f;
	static const float fMAX_BENDING = 2.f;

	// Rasterized box
	AABB windBoxC = windBox;
	windBoxC.ClipToBox(areaBox);
	int nX1 = (int)windBoxC.min.x;
	int nY1 = (int)windBoxC.min.y;
	int nX2 = (int)windBoxC.max.x;
	int nY2 = (int)windBoxC.max.y;

	float fInvAreaX = 1.0f / (areaBox.max.x - areaBox.min.x);
	float fInvAreaY = 1.0f / (areaBox.max.y - areaBox.min.y);

	float fInvX = 1.0f / (windBoxC.max.x - windBoxC.min.x);

	Vec3 windTopX1, windBottomX1;
	Vec3 windTopX2, windBottomX2;
	float fLerpX1 = (windBoxC.min.x - areaBox.min.x) * fInvAreaX;     // 0..1
	float fLerpX2 = (windBoxC.max.x - areaBox.min.x) * fInvAreaX;     // 0..1
	windTopX1.SetLerp(windArea.windSpeed[tl], windArea.windSpeed[tr], fLerpX1);
	windBottomX1.SetLerp(windArea.windSpeed[bl], windArea.windSpeed[br], fLerpX1);
	windTopX2.SetLerp(windArea.windSpeed[tl], windArea.windSpeed[tr], fLerpX2);
	windBottomX2.SetLerp(windArea.windSpeed[bl], windArea.windSpeed[br], fLerpX2);

	float fAreaStrength = GetCVars()->e_WindBendingAreaStrength;

	Vec3 vGridStart = windBoxC.min - windBox.min;
	int nXGrid = (int)vGridStart.x;
	int nYGrid = (int)vGridStart.y;
	assert(nXGrid >= 0 && nXGrid + (nX2 - nX1) <= rWindGrid.m_nWidth);
	assert(nYGrid >= 0 && nYGrid + (nY2 - nY1) <= rWindGrid.m_nHeight);
	for (y = nY1; y < nY2; y++)
	{
		// Setup scanline gradients
		float fLerpY = ((float)y - areaBox.min.y) * fInvAreaY;      // 0..1
		Vec3 windStart, windEnd;
		windStart.SetLerp(windTopX1, windBottomX1, fLerpY);
		windEnd.SetLerp(windTopX2, windBottomX2, fLerpY);
		Vec3 windDelta = (windEnd - windStart) * fInvX;

		windStart *= fAreaStrength;
		windDelta *= fAreaStrength;

		const int nSize = nX2 - nX1;
		Vec2 vWindCur = Vec2(windStart.x, windStart.y) + Vec2(vGlobalWind.x, vGlobalWind.y);

#if CRY_PLATFORM_SSE2
		__m128i xs;
		__m128i nFrames = _mm_set1_epi32(nFrame);
		__m128i nSizes = _mm_set_epi32(nSize - 3, nSize - 2, nSize - 1, nSize - 0);
		__m128i* pData = (__m128i*)&rWindGrid.m_pData[nYGrid * rWindGrid.m_nWidth + nXGrid];
		__m128i* pFrames = (__m128i*)&m_pWindAreaFrames[nYGrid * rWindGrid.m_nWidth + nXGrid];
		__m128* pField = (__m128*)&m_pWindField[nYGrid * rWindGrid.m_nWidth + nXGrid];
		__m128 vWindCurs = _mm_set_ps(vWindCur.y, vWindCur.x, vWindCur.y, vWindCur.x);
		__m128 vWindDeltas = _mm_set_ps(windDelta.y, windDelta.x, windDelta.y, windDelta.x);
		__m128 fInterps = _mm_set1_ps(fInterp);
		__m128 fBendRps = _mm_set1_ps(fBEND_RESPONSE);
		__m128 fBendMax = _mm_set1_ps(fMAX_BENDING);

		// Alignment doesn't matter currently, no memory loads requiring alignment are used below
		{
			x = 0;
			xs = _mm_set1_epi32(x * 4);
		}

		for (; x < ((nSize + 3) / 4); ++x, xs = _mm_set1_epi32(x * 4))
		{
			// manage end alignment
			__m128i cFrame = _mm_loadu_si128(pFrames + x);
			__m128i bMask = _mm_cmpgt_epi32(nSizes, xs);

			// Loop range ensures we either have a somewhat filled head, fully filled nodes, or somewhat filled tail, but never a empty iteration
			if (false && _mm_movemask_ps(_mm_castsi128_ps(bMask)) == 0x0)
				continue;

			cFrame = _mm_or_si128(_mm_and_si128(bMask, nFrames), _mm_andnot_si128(bMask, cFrame));
			_mm_storeu_si128(pFrames + x, cFrame);

			// Interpolate
			{
				__m128 loField = _mm_loadu_ps((float*)(pField + x * 2 + 0));
				__m128 hiField = _mm_loadu_ps((float*)(pField + x * 2 + 1));
				__m128 ipField = _mm_and_ps(fInterps, _mm_castsi128_ps(bMask));

				__m128 loFieldInterps = _mm_unpacklo_ps(ipField, ipField);
				__m128 hiFieldInterps = _mm_unpackhi_ps(ipField, ipField);

				loField = _mm_add_ps(loField, _mm_mul_ps(_mm_sub_ps(vWindCurs, loField), loFieldInterps));
				hiField = _mm_add_ps(hiField, _mm_mul_ps(_mm_sub_ps(vWindCurs, hiField), hiFieldInterps));

				_mm_storeu_ps((float*)(pField + x * 2 + 0), loField);
				_mm_storeu_ps((float*)(pField + x * 2 + 1), hiField);

				loField = _mm_mul_ps(loField, fBendRps);
				hiField = _mm_mul_ps(hiField, fBendRps);

				__m128 loFieldLength = _mm_mul_ps(loField, loField);
				__m128 hiFieldLength = _mm_mul_ps(hiField, hiField);

	#if CRY_PLATFORM_SSE4
				loFieldLength = _mm_add_ps(_mm_sqrt_ps(_mm_hadd_ps(hiFieldLength, loFieldLength)), fBendMax);

				loField = _mm_div_ps(_mm_mul_ps(loField, fBendMax), _mm_unpacklo_ps(loFieldLength, loFieldLength));
				hiField = _mm_div_ps(_mm_mul_ps(hiField, fBendMax), _mm_unpackhi_ps(loFieldLength, loFieldLength));
	#else
				loFieldLength = _mm_sqrt_ps(_mm_add_ps(loFieldLength, _mm_shuffle_ps(loFieldLength, loFieldLength, _MM_SHUFFLE(2, 3, 0, 1))));
				hiFieldLength = _mm_sqrt_ps(_mm_add_ps(hiFieldLength, _mm_shuffle_ps(hiFieldLength, hiFieldLength, _MM_SHUFFLE(2, 3, 0, 1))));

				loField = _mm_div_ps(_mm_mul_ps(loField, fBendMax), _mm_add_ps(loFieldLength, fBendMax));
				hiField = _mm_div_ps(_mm_mul_ps(hiField, fBendMax), _mm_add_ps(hiFieldLength, fBendMax));
	#endif

	#if CRY_PLATFORM_F16C
				__m128i loData = _mm_cvtps_ph(loField, 0);
				__m128i hiData = _mm_cvtps_ph(hiField, 0);

				_mm_storeu_si128(pData + x, _mm_unpacklo_epi64(loData, hiData));
	#else
				__m128i loSign, loData = approx_float_to_half_SSE2(loField, loSign);
				__m128i hiSign, hiData = approx_float_to_half_SSE2(hiField, hiSign);

				loSign = _mm_packs_epi32(loSign, hiSign);
				loData = _mm_packs_epi32(loData, hiData);

				_mm_storeu_si128(pData + x, _mm_or_si128(loSign, loData));
	#endif
			}

			vWindCurs = _mm_add_ps(vWindCurs, vWindDeltas);
		}
#else
		CryHalf2* pData = &rWindGrid.m_pData[nYGrid * rWindGrid.m_nWidth + nXGrid];
		int* pFrames = &m_pWindAreaFrames[nYGrid * rWindGrid.m_nWidth + nXGrid];
		Vec2* pField = &m_pWindField[nYGrid * rWindGrid.m_nWidth + nXGrid];

		for (x = 0; x < nSize; x++)
		{
			pFrames[x] = nFrame;

			// Interpolate
			{
				Vec2 vWindInt = pField[x];
				vWindInt += (vWindCur - vWindInt) * fInterp;
				pField[x] = vWindInt;

				Vec2 vBend = vWindInt * fBEND_RESPONSE;
				vBend *= fMAX_BENDING / (fMAX_BENDING + vBend.GetLength());
				pData[x] = CryHalf2(vBend.x, vBend.y);
			}

			vWindCur += Vec2(windDelta.x, windDelta.y);
		}
#endif

		nYGrid++;
	}
}

DECLARE_JOB("C3DEngine::UpdateWindGridJobEntry", TUpdateWindJob, C3DEngine::UpdateWindGridJobEntry);

void C3DEngine::StartWindGridJob(const Vec3& vPos)
{
	if (GetCVars()->e_VegetationBending != 2)
	{
		m_bWindJobRun = false;
		return;
	}
	MEMSTAT_CONTEXT(EMemStatContextType::Other, "Start Wind Grid Job");

	SWindGrid& rWindGrid = m_WindGrid[m_nCurWind];
	if (!rWindGrid.m_pData)
	{
		rWindGrid.m_fCellSize = 1.0f;
		rWindGrid.m_nWidth = 256;
		rWindGrid.m_nHeight = 256;
		rWindGrid.m_pData = reinterpret_cast<CryHalf2*>(CryModuleMemalign(rWindGrid.m_nWidth * rWindGrid.m_nHeight * sizeof(CryHalf2), CRY_PLATFORM_ALIGNMENT));
		memset(rWindGrid.m_pData, 0, rWindGrid.m_nWidth * rWindGrid.m_nHeight * sizeof(CryHalf2));

		if (!m_pWindField)
		{
			m_pWindField = reinterpret_cast<Vec2*>(CryModuleMemalign(rWindGrid.m_nWidth * rWindGrid.m_nHeight * sizeof(Vec2), CRY_PLATFORM_ALIGNMENT));
			memset(m_pWindField, 0, rWindGrid.m_nWidth * rWindGrid.m_nHeight * sizeof(Vec2));

			m_pWindAreaFrames = reinterpret_cast<int*>(CryModuleMemalign(rWindGrid.m_nWidth * rWindGrid.m_nHeight * sizeof(int), CRY_PLATFORM_ALIGNMENT));
			memset(m_pWindAreaFrames, 0, rWindGrid.m_nWidth * rWindGrid.m_nHeight * sizeof(int));
		}
	}
	m_vWindFieldCamera = m_RenderingCamera.GetPosition();

	/*auto* pWindAreas = &m_outdoorWindAreas[m_nCurrentWindAreaList];
	   if (pWindAreas->size())
	   {
	   static FILE *fp = NULL;
	   if (!fp)
	    fp = gEnv->pCryPak->FOpen("Wind.txt", "w");

	   if (fp)
	   {
	    gEnv->pCryPak->FPrintf(fp, "\n\n%d Wind Areas:\n", pWindAreas->size());
	   }

	   // 2 Step: Rasterize wind areas
	   for (const auto &windArea : *pWindAreas)
	   {
	    if (fp)
	    {
	      gEnv->pCryPak->FPrintf(fp, "[%.3f, %.3f] | [%.3f, %.3f] | [%.3f, %.3f] | [%.3f, %.3f] || [%.3f, %.3f]\n",
	        windArea.windSpeed[0].x, windArea.windSpeed[0].y,
	        windArea.windSpeed[1].x, windArea.windSpeed[1].y,
	        windArea.windSpeed[2].x, windArea.windSpeed[2].y,
	        windArea.windSpeed[3].x, windArea.windSpeed[3].y,
	        windArea.windSpeed[4].x, windArea.windSpeed[4].y
	        );
	    }
	   }
	   if (fp)
	   {
	    gEnv->pCryPak->FPrintf(fp, "{230, 270} = [%.3f, %.3f]\n", m_pWindField[270*512+230].x, m_pWindField[270*512+230].y);
	    gEnv->pCryPak->FFlush(fp);
	   }
	   }*/

	JobManager::SJobState* pJobState = &m_WindJobState;

	TUpdateWindJob job(vPos);
	job.RegisterJobState(pJobState);
	job.SetClassInstance(this);
	job.SetPriorityLevel(JobManager::eLowPriority);
	job.Run();

	m_bWindJobRun = true;

	//UpdateWindGridJobEntry(vPos);
	//m_bWindJobRun = false;
}
void C3DEngine::FinishWindGridJob()
{
	FUNCTION_PROFILER_3DENGINE
	if (m_bWindJobRun)
	{
		gEnv->GetJobManager()->WaitForJob(m_WindJobState);

		GetRenderer()->EF_SubmitWind(&m_WindGrid[m_nCurWind]);
		m_nCurWind = 1 - m_nCurWind;

		m_bWindJobRun = false;
	}
}

IVisArea* C3DEngine::GetVisAreaFromPos(const Vec3& vPos) const
{
	if (m_pObjManager && m_pVisAreaManager)
		return m_pVisAreaManager->GetVisAreaFromPos(vPos);

	return 0;
}

bool C3DEngine::IntersectsVisAreas(const AABB& box, void** pNodeCache) const
{
	if (m_pObjManager && m_pVisAreaManager)
		return m_pVisAreaManager->IntersectsVisAreas(box, pNodeCache);
	return false;
}

bool C3DEngine::ClipToVisAreas(IVisArea* pInside, Sphere& sphere, Vec3 const& vNormal, void* pNodeCache)
{
	if (pInside)
		return pInside->ClipToVisArea(true, sphere, vNormal);
	else if (m_pVisAreaManager)
		return m_pVisAreaManager->ClipOutsideVisAreas(sphere, vNormal, pNodeCache);
	return false;
}

bool C3DEngine::IsVisAreasConnected(IVisArea* pArea1, IVisArea* pArea2, int nMaxRecursion, bool bSkipDisabledPortals)
{
	if (pArea1 == pArea2)
		return (true);  // includes the case when both pArea1 & pArea2 are NULL (totally outside)
	                  // not considered by the other checks
	if (!pArea1 || !pArea2)
		return (false);  // avoid a crash - better to put this check only
	                   // here in one place than in all the places where this function is called

	nMaxRecursion *= 2; // include portals since portals are the areas

	if (m_pObjManager && m_pVisAreaManager)
		return ((CVisArea*)pArea1)->FindVisArea((CVisArea*)pArea2, nMaxRecursion, bSkipDisabledPortals);

	return false;
}

bool C3DEngine::IsOutdoorVisible() const
{
	if (m_pObjManager && m_pVisAreaManager)
		return m_pVisAreaManager->IsOutdoorAreasVisible();

	return false;
}

void C3DEngine::EnableOceanRendering(bool bOcean)
{
	m_bOcean = bOcean;
}

//////////////////////////////////////////////////////////////////////////
IMaterialHelpers& C3DEngine::GetMaterialHelpers()
{
	return Cry3DEngineBase::GetMatMan()->s_materialHelpers;
}

IMaterialManager* C3DEngine::GetMaterialManager()
{
	return Cry3DEngineBase::GetMatMan();
}

//////////////////////////////////////////////////////////////////////////

bool C3DEngine::IsTerrainHightMapModifiedByGame()
{
	return m_pTerrain && m_pTerrain->IsHeightMapModified();
}

void C3DEngine::CheckPhysicalized(const Vec3& vBoxMin, const Vec3& vBoxMax)
{
	/*  if(!GetCVars()->e_stream_areas)
	    return;

	   CVisArea * pVisArea = (CVisArea *)GetVisAreaFromPos((vBoxMin+vBoxMax)*0.5f);
	   if(pVisArea)
	   { // indoor
	    pVisArea->CheckPhysicalized();
	    IVisArea * arrConnections[16];
	    int nConections = pVisArea->GetRealConnections(arrConnections,16);
	    for(int i=0; i<nConections; i++)
	      ((CVisArea*)arrConnections[i])->CheckPhysicalized();
	   }
	   else
	   { // outdoor
	    CTerrainNode * arrSecInfo[] =
	    {
	      m_pTerrain->GetSecInfo(int(vBoxMin.x), int(vBoxMin.y)),
	      m_pTerrain->GetSecInfo(int(vBoxMax.x), int(vBoxMin.y)),
	      m_pTerrain->GetSecInfo(int(vBoxMin.x), int(vBoxMax.y)),
	      m_pTerrain->GetSecInfo(int(vBoxMax.x), int(vBoxMax.y))
	    };

	    for(int i=0; i<4; i++)
	      if(arrSecInfo[i])
	        arrSecInfo[i]->CheckPhysicalized();
	   }*/
}

//////////////////////////////////////////////////////////////////////////
void C3DEngine::UpdateWindAreas()
{
	FUNCTION_PROFILER_3DENGINE;

	if (!m_pCVars->e_Wind)
		return;

	// Update each second frame
	int nRendFrame = gEnv->nMainFrameID;
	if (m_nFrameWindAreas + 1 >= nRendFrame)
		return;
	m_nFrameWindAreas = nRendFrame;

	m_nCurrentWindAreaList = (m_nCurrentWindAreaList + 1) % 2;
	int nextWindAreaList = (m_nCurrentWindAreaList + 1) % 2;

	m_outdoorWindAreas[nextWindAreaList].clear();
	m_indoorWindAreas[nextWindAreaList].clear();

	if (m_pCVars->e_WindAreas)
	{
		// Iterate all areas, looking for wind areas. Skip first (global) area, and global wind.
		pe_params_buoyancy pb;
		IPhysicalEntity* pArea = 0;
		while (pArea = GetPhysicalWorld()->GetNextArea(pArea))
		{
			if (!pArea->GetParams(&pb))
				continue;
			if (pb.iMedium != pe_params_buoyancy::eAir)
				continue;
			if (pArea == m_pGlobalWind)
				continue;

			// Skip indoor areas.
			bool bIndoor = false;
			pe_params_foreign_data fd;
			if (pArea->GetParams(&fd) && (fd.iForeignFlags & PFF_OUTDOOR_AREA))
				bIndoor = false;

			pe_params_bbox area_bbox;
			if (!pArea->GetParams(&area_bbox))
				continue;

			Vec3 b0 = area_bbox.BBox[0];
			Vec3 b1 = area_bbox.BBox[1];

			SOptimizedOutdoorWindArea windArea;
			windArea.pArea = pArea;

			windArea.x0 = int(floorf(b0.x));
			windArea.x1 = int(ceilf(b1.x));
			windArea.y0 = int(floorf(b0.y));
			windArea.y1 = int(ceilf(b1.y));

			float z = (b0.z + b1.z) / 2.0f; // Middle of the area in z
			windArea.z = z;

			// Sample wind at the corners of the area
			pe_status_area area;
			Vec3 c = (b1 + b0) * 0.5f, sz = (b1 - b0) * 0.45f;
			Vec2i idir(0);
			area.pb.waterFlow.zero();
			for (int i = 4; i >= 0; idir = idir.rot90cw() + Vec2i(-(i >> 2), i >> 2), --i)
			{
				windArea.point[i].set(sz.x * idir.x, sz.y * idir.y);
				area.ctr = c + Vec3(windArea.point[i]);
				pArea->GetStatus(&area);
				windArea.windSpeed[i] = area.pb.waterFlow;
			}
			if (bIndoor)
				m_indoorWindAreas[nextWindAreaList].push_back(windArea);
			else
				m_outdoorWindAreas[nextWindAreaList].push_back(windArea);
		}
		// Sort wind areas by bounding box min x.
		std::sort(m_outdoorWindAreas[nextWindAreaList].begin(), m_outdoorWindAreas[nextWindAreaList].end(), [](const SOptimizedOutdoorWindArea& a, const SOptimizedOutdoorWindArea& b) { return a.x0 < b.x0; });
		std::sort(m_indoorWindAreas[nextWindAreaList].begin(), m_indoorWindAreas[nextWindAreaList].end(), [](const SOptimizedOutdoorWindArea& a, const SOptimizedOutdoorWindArea& b) { return a.x0 < b.x0; });
	}

	// Don't update if: No areas and global wind is constant
	Vec3 vGlobalWind = GetGlobalWind(false) * GetCVars()->e_WindBendingStrength;
	int nCurAreas = m_outdoorWindAreas[m_nCurrentWindAreaList].size() + m_forcedWindAreas.size();
	if (m_nProcessedWindAreas || nCurAreas || m_vProcessedGlobalWind != vGlobalWind)
	{
		m_nProcessedWindAreas = nCurAreas;
		m_vProcessedGlobalWind = vGlobalWind;
		StartWindGridJob(m_RenderingCamera.GetPosition());
	}
}

void C3DEngine::CheckMemoryHeap()
{
	assert(IsHeapValid());
}

void C3DEngine::CloseTerrainTextureFile()
{
	if (m_pTerrain)
		m_pTerrain->CloseTerrainTextureFile();
}

//////////////////////////////////////////////////////////////////////////
int C3DEngine::GetLoadedObjectCount()
{
	int nObjectsLoaded = m_pObjManager ? m_pObjManager->GetLoadedObjectCount() : 0;

	if (gEnv->pCharacterManager)
	{
		ICharacterManager::Statistics AnimStats;
		gEnv->pCharacterManager->GetStatistics(AnimStats);
		nObjectsLoaded += AnimStats.numAnimObjectModels + AnimStats.numCharModels;
	}

	return nObjectsLoaded;
}

//////////////////////////////////////////////////////////////////////////
void C3DEngine::GetLoadedStatObjArray(IStatObj** pObjectsArray, int& nCount)
{
	if (m_pObjManager)
		m_pObjManager->GetLoadedStatObjArray(pObjectsArray, nCount);
	else
		nCount = 0;
}

//////////////////////////////////////////////////////////////////////////
void C3DEngine::GetObjectsStreamingStatus(SObjectsStreamingStatus& outStatus)
{
	if (m_pObjManager)
	{
		m_pObjManager->GetObjectsStreamingStatus(outStatus);
	}
	else
	{
		memset(&outStatus, 0, sizeof(outStatus));
	}
}

//////////////////////////////////////////////////////////////////////////
void C3DEngine::GetStreamingSubsystemData(int subsystem, SStremaingBandwidthData& outData)
{
	switch (subsystem)
	{
	case eStreamTaskTypeSound:
		REINST(Audio bandwidth stats)
		//REINST: C3DEngine::GetStreamingSubsystemData(subsystem, outData)
		//gEnv->pAudioSystem->GetIAudioDevice()->GetBandwidthStats(&outData.fBandwidthRequested);
		break;
	case eStreamTaskTypeGeometry:
		m_pObjManager->GetBandwidthStats(&outData.fBandwidthRequested);
		break;
	case eStreamTaskTypeTexture:
		gEnv->pRenderer->GetBandwidthStats(&outData.fBandwidthRequested);
		break;
	}

#if defined(STREAMENGINE_ENABLE_STATS)
	gEnv->pSystem->GetStreamEngine()->GetBandwidthStats((EStreamTaskType)subsystem, &outData.fBandwidthActual);
#endif
}

//////////////////////////////////////////////////////////////////////////
void C3DEngine::DeleteEntityDecals(IRenderNode* pEntity)
{
	if (m_pDecalManager && pEntity && (pEntity->m_nInternalFlags & IRenderNode::DECAL_OWNER))
		m_pDecalManager->OnEntityDeleted(pEntity);
}

void C3DEngine::CompleteObjectsGeometry()
{
	while (m_pTerrain && m_pTerrain->Recompile_Modified_Incrementaly_RoadRenderNodes())
		;

	CRoadRenderNode::FreeStaticMemoryUsage();
}

void C3DEngine::DeleteDecalsInRange(AABB* pAreaBox, IRenderNode* pEntity)
{
	if (m_pDecalManager)
		m_pDecalManager->DeleteDecalsInRange(pAreaBox, pEntity);
}

void C3DEngine::LockCGFResources()
{
	if (m_pObjManager)
		m_pObjManager->m_bLockCGFResources = 1;
}

void C3DEngine::UnlockCGFResources()
{
	if (m_pObjManager)
	{
		bool bNeedToFreeCGFs = m_pObjManager->m_bLockCGFResources != 0;
		m_pObjManager->m_bLockCGFResources = 0;
		if (bNeedToFreeCGFs)
		{
			m_pObjManager->FreeNotUsedCGFs();
		}
	}
}

Vec3 C3DEngine::GetTerrainSurfaceNormal(Vec3 vPos)
{
	return m_pTerrain ? m_pTerrain->GetTerrainSurfaceNormal(vPos, 0.5f * GetHeightMapUnitSize()) : Vec3(0.f, 0.f, 1.f);
}

//////////////////////////////////////////////////////////////////////////
IIndexedMesh* C3DEngine::CreateIndexedMesh()
{
	return new CIndexedMesh();
}

void C3DEngine::SerializeState(TSerialize ser)
{
	if (ser.IsReading())
	{
		CStatObjFoliage* pFoliage, * pFoliageNext;
		for (pFoliage = m_pFirstFoliage; &pFoliage->m_next != &m_pFirstFoliage; pFoliage = pFoliageNext)
		{
			pFoliageNext = pFoliage->m_next;
			delete pFoliage;
		}
	}

	ser.Value("m_bOcean", m_bOcean);
	ser.Value("m_moonRotationLatitude", m_moonRotationLatitude);
	ser.Value("m_moonRotationLongitude", m_moonRotationLongitude);
	ser.Value("m_eShadowMode", *(alias_cast<int*>(&m_eShadowMode)));
	if (ser.IsReading())
		UpdateMoonDirection();

	if (m_pTerrain)
		m_pTerrain->SerializeTerrainState(ser);

	if (m_pDecalManager)
		m_pDecalManager->Serialize(ser);

	m_pPartManager->Serialize(ser);
	m_pTimeOfDay->Serialize(ser);
	m_colorGradingCtrl.Serialize(ser);
}

void C3DEngine::PostSerialize(bool bReading)
{
	m_pPartManager->PostSerialize(bReading);
}

void C3DEngine::InitMaterialDefautMappingAxis(IMaterial* pMat)
{
	uint8 arrProj[3] = { 'X', 'Y', 'Z' };
	pMat->m_ucDefautMappingAxis = 'Z';
	pMat->m_fDefautMappingScale = 1.f;
	for (int c = 0; c < 3 && c < pMat->GetSubMtlCount(); c++)
	{
		IMaterial* pSubMat = (IMaterial*)pMat->GetSubMtl(c);
		pSubMat->m_ucDefautMappingAxis = arrProj[c];
		pSubMat->m_fDefautMappingScale = pMat->m_fDefautMappingScale;
	}
}

//////////////////////////////////////////////////////////////////////////
CContentCGF* C3DEngine::CreateChunkfileContent(const char* filename)
{
	return new CContentCGF(filename);
}
void C3DEngine::ReleaseChunkfileContent(CContentCGF* pCGF)
{
	delete pCGF;
}

bool C3DEngine::LoadChunkFileContent(CContentCGF* pCGF, const char* filename, bool bNoWarningMode, bool bCopyChunkFile)
{
	CLoadLogListener listener;

	if (!pCGF)
	{
		FileWarning(0, filename, "CGF Loading Failed: no content instance passed");
	}
	else
	{
		CLoaderCGF cgf;

		CReadOnlyChunkFile* pChunkFile = new CReadOnlyChunkFile(bCopyChunkFile, bNoWarningMode);

		if (cgf.LoadCGF(pCGF, filename, *pChunkFile, &listener))
		{
			pCGF->SetChunkFile(pChunkFile);
			return true;
		}

		CryWarning(VALIDATOR_MODULE_3DENGINE, VALIDATOR_WARNING, "%s: Failed to load chunk file: '%s'", __FUNCTION__, cgf.GetLastError());
		delete pChunkFile;
	}

	return false;
}

bool C3DEngine::LoadChunkFileContentFromMem(CContentCGF* pCGF, const void* pData, size_t nDataLen, uint32 nLoadingFlags, bool bNoWarningMode, bool bCopyChunkFile)
{
	if (!pCGF)
	{
		FileWarning(0, "<memory>", "CGF Loading Failed: no content instance passed");
	}
	else
	{
		CLoadLogListener listener;

		CLoaderCGF cgf;
		CReadOnlyChunkFile* pChunkFile = new CReadOnlyChunkFile(bCopyChunkFile, bNoWarningMode);

		if (cgf.LoadCGFFromMem(pCGF, pData, nDataLen, *pChunkFile, &listener, nLoadingFlags))
		{
			pCGF->SetChunkFile(pChunkFile);
			return true;
		}

		CryWarning(VALIDATOR_MODULE_3DENGINE, VALIDATOR_WARNING, "%s: Failed to load chunk file: '%s'", __FUNCTION__, cgf.GetLastError());
		delete pChunkFile;
	}

	return false;
}

IChunkFile* C3DEngine::CreateChunkFile(bool bReadOnly)
{
	if (bReadOnly)
		return new CReadOnlyChunkFile(false);
	else
		return new CChunkFile;
}

//////////////////////////////////////////////////////////////////////////

ChunkFile::IChunkFileWriter* C3DEngine::CreateChunkFileWriter(EChunkFileFormat eFormat, ICryPak* pPak, const char* filename) const
{
	ChunkFile::CryPakFileWriter* const p = new ChunkFile::CryPakFileWriter();

	if (!p)
	{
		return 0;
	}

	if (!p->Create(pPak, filename))
	{
		delete p;
		return 0;
	}

	const ChunkFile::MemorylessChunkFileWriter::EChunkFileFormat fmt =
		(eFormat == I3DEngine::eChunkFileFormat_0x745)
		? ChunkFile::MemorylessChunkFileWriter::eChunkFileFormat_0x745
		: ChunkFile::MemorylessChunkFileWriter::eChunkFileFormat_0x746;

	return new ChunkFile::MemorylessChunkFileWriter(fmt, p);
}

void C3DEngine::ReleaseChunkFileWriter(ChunkFile::IChunkFileWriter* p) const
{
	if (p)
	{
		delete p->GetWriter();
		delete p;
	}
}

//////////////////////////////////////////////////////////////////////////

int C3DEngine::GetTerrainTextureNodeSizeMeters()
{
	if (m_pTerrain)
		return m_pTerrain->GetTerrainTextureNodeSizeMeters();
	return 0;
}

int C3DEngine::GetTerrainTextureNodeSizePixels(int nLayer)
{
	if (m_pTerrain)
		return m_pTerrain->GetTerrainTextureNodeSizePixels(nLayer);
	return 0;
}

void C3DEngine::SetHeightMapMaxHeight(float fMaxHeight)
{
	if (m_pTerrain)
		m_pTerrain->SetHeightMapMaxHeight(fMaxHeight);
}

ITerrain* C3DEngine::CreateTerrain(const STerrainInfo& TerrainInfo)
{
	DeleteTerrain();
	m_pTerrain = new CTerrain(TerrainInfo);
	return (ITerrain*)m_pTerrain;
}

void C3DEngine::DeleteTerrain()
{
	SAFE_DELETE(m_pTerrain);
}

void C3DEngine::SetStreamableListener(IStreamedObjectListener* pListener)
{
	m_pStreamListener = pListener;
}

void C3DEngine::PrecacheLevel(bool bPrecacheAllVisAreas, Vec3* pPrecachePoints, int nPrecachePointsNum)
{
	CRY_PROFILE_FUNCTION(PROFILE_LOADING_ONLY);

	if (GetVisAreaManager())
		GetVisAreaManager()->PrecacheLevel(bPrecacheAllVisAreas, pPrecachePoints, nPrecachePointsNum);
}

//////////////////////////////////////////////////////////////////////////
void C3DEngine::SetGlobalParameter(E3DEngineParameter param, const Vec3& v)
{
	float fValue = v.x;
	switch (param)
	{
	case E3DPARAM_SKY_COLOR:
		SetSkyColor(v);
		break;
	case E3DPARAM_SUN_COLOR:
		SetSunColor(v);
		break;

	case E3DPARAM_SUN_SPECULAR_MULTIPLIER:
		m_fSunSpecMult = v.x;
		break;

	case E3DPARAM_AMBIENT_GROUND_COLOR:
		m_vAmbGroundCol = v;
		break;
	case E3DPARAM_AMBIENT_MIN_HEIGHT:
		m_fAmbMaxHeight = v.x;
		break;
	case E3DPARAM_AMBIENT_MAX_HEIGHT:
		m_fAmbMinHeight = v.x;
		break;

	case E3DPARAM_SKY_HIGHLIGHT_POS:
		m_vSkyHightlightPos = v;
		break;
	case E3DPARAM_SKY_HIGHLIGHT_COLOR:
		m_vSkyHightlightCol = v;
		break;
	case E3DPARAM_SKY_HIGHLIGHT_SIZE:
		m_fSkyHighlightSize = fValue > 0.0f ? fValue : 0.0f;
		break;
	case E3DPARAM_VOLFOG_RAMP:
		m_volFogRamp = v;
		break;
	case E3DPARAM_VOLFOG_SHADOW_RANGE:
		m_volFogShadowRange = v;
		break;
	case E3DPARAM_VOLFOG_SHADOW_DARKENING:
		m_volFogShadowDarkening = v;
		break;
	case E3DPARAM_VOLFOG_SHADOW_ENABLE:
		m_volFogShadowEnable = v;
		break;
	case E3DPARAM_VOLFOG2_CTRL_PARAMS:
		m_volFog2CtrlParams = v;
		break;
	case E3DPARAM_VOLFOG2_SCATTERING_PARAMS:
		m_volFog2ScatteringParams = v;
		break;
	case E3DPARAM_VOLFOG2_RAMP:
		m_volFog2Ramp = v;
		break;
	case E3DPARAM_VOLFOG2_COLOR:
		m_volFog2Color = v;
		break;
	case E3DPARAM_VOLFOG2_GLOBAL_DENSITY:
		m_volFog2GlobalDensity = v;
		break;
	case E3DPARAM_VOLFOG2_HEIGHT_DENSITY:
		m_volFog2HeightDensity = v;
		break;
	case E3DPARAM_VOLFOG2_HEIGHT_DENSITY2:
		m_volFog2HeightDensity2 = v;
		break;
	case E3DPARAM_VOLFOG2_COLOR1:
		m_volFog2Color1 = v;
		break;
	case E3DPARAM_VOLFOG2_COLOR2:
		m_volFog2Color2 = v;
		break;
	case E3DPARAM_SKYLIGHT_RAYLEIGH_INSCATTER:
		m_fogColorSkylightRayleighInScatter = v;
		break;
	case E3DPARAM_NIGHSKY_HORIZON_COLOR:
		m_nightSkyHorizonCol = v;
		break;
	case E3DPARAM_NIGHSKY_ZENITH_COLOR:
		m_nightSkyZenithCol = v;
		break;
	case E3DPARAM_NIGHSKY_ZENITH_SHIFT:
		m_nightSkyZenithColShift = v.x;
		break;
	case E3DPARAM_NIGHSKY_STAR_INTENSITY:
		m_nightSkyStarIntensity = v.x;
		break;
	case E3DPARAM_NIGHSKY_MOON_COLOR:
		m_nightMoonCol = v;
		break;
	case E3DPARAM_NIGHSKY_MOON_SIZE:
		m_nightMoonSize = v.x;
		break;
	case E3DPARAM_NIGHSKY_MOON_INNERCORONA_COLOR:
		m_nightMoonInnerCoronaCol = v;
		break;
	case E3DPARAM_NIGHSKY_MOON_INNERCORONA_SCALE:
		m_nightMoonInnerCoronaScale = v.x;
		break;
	case E3DPARAM_NIGHSKY_MOON_OUTERCORONA_COLOR:
		m_nightMoonOuterCoronaCol = v;
		break;
	case E3DPARAM_NIGHSKY_MOON_OUTERCORONA_SCALE:
		m_nightMoonOuterCoronaScale = v.x;
		break;
	case E3DPARAM_OCEANFOG_COLOR:
		m_oceanFogColor = v;
		break;
	case E3DPARAM_OCEANFOG_DENSITY:
		m_oceanFogDensity = v.x;
		break;
	case E3DPARAM_SKY_MOONROTATION:
		m_moonRotationLatitude = v.x;
		m_moonRotationLongitude = v.y;
		UpdateMoonDirection();
		break;
	case E3DPARAM_SKYBOX_MULTIPLIER:
		m_skyboxMultiplier = v.x;
		break;
	case E3DPARAM_DAY_NIGHT_INDICATOR:
		m_dayNightIndicator = v.x;
		REINST(Set daylight parameter)
		//gEnv->pSoundSystem->SetGlobalParameter("daylight", m_dayNightIndicator);
		break;
	case E3DPARAM_FOG_COLOR2:
		m_fogColor2 = v;
		break;
	case E3DPARAM_FOG_RADIAL_COLOR:
		m_fogColorRadial = v;
		break;
	case E3DPARAM_VOLFOG_HEIGHT_DENSITY:
		m_volFogHeightDensity = Vec3(v.x, v.y, 0);
		break;
	case E3DPARAM_VOLFOG_HEIGHT_DENSITY2:
		m_volFogHeightDensity2 = Vec3(v.x, v.y, 0);
		break;
	case E3DPARAM_VOLFOG_GRADIENT_CTRL:
		m_volFogGradientCtrl = v;
		break;
	case E3DPARAM_VOLFOG_GLOBAL_DENSITY:
		m_volFogGlobalDensity = v.x;
		m_volFogFinalDensityClamp = v.z;
		break;
	case E3DPARAM_COLORGRADING_FILTERS_PHOTOFILTER_COLOR:
		m_pPhotoFilterColor = Vec4(v.x, v.y, v.z, 1);
		SetPostEffectParamVec4("clr_ColorGrading_PhotoFilterColor", m_pPhotoFilterColor);
		break;
	case E3DPARAM_COLORGRADING_FILTERS_PHOTOFILTER_DENSITY:
		m_fPhotoFilterColorDensity = fValue;
		SetPostEffectParam("ColorGrading_PhotoFilterColorDensity", m_fPhotoFilterColorDensity);
		break;
	case E3DPARAM_COLORGRADING_FILTERS_GRAIN:
		m_fGrainAmount = fValue;
		SetPostEffectParam("ColorGrading_GrainAmount", m_fGrainAmount);
		break;
	case E3DPARAM_SKY_SKYBOX_ANGLE: // sky box rotation
		m_fSkyBoxAngle = fValue;
		break;
	case E3DPARAM_SKY_SKYBOX_STRETCHING: // sky box stretching
		m_fSkyBoxStretching = fValue;
		break;
	case E3DPARAM_SKY_SKYBOX_EMITTANCE:
		m_vSkyBoxExposure = v;
		break;
	case E3DPARAM_SKY_SKYBOX_FILTER:
		m_vSkyBoxOpacity = v;
		break;
	case E3DPARAM_HDR_FILMCURVE_SHOULDER_SCALE:
		m_vHDRFilmCurveParams.x = v.x;
		break;
	case E3DPARAM_HDR_FILMCURVE_LINEAR_SCALE:
		m_vHDRFilmCurveParams.y = v.x;
		break;
	case E3DPARAM_HDR_FILMCURVE_TOE_SCALE:
		m_vHDRFilmCurveParams.z = v.x;
		break;
	case E3DPARAM_HDR_FILMCURVE_WHITEPOINT:
		m_vHDRFilmCurveParams.w = v.x;
		break;
	case E3DPARAM_HDR_EYEADAPTATION_PARAMS:
		m_vHDREyeAdaptation = v;
		break;
	case E3DPARAM_HDR_EYEADAPTATION_PARAMS_LEGACY:
		m_vHDREyeAdaptationLegacy = v;
		break;
	case E3DPARAM_HDR_BLOOM_AMOUNT:
		m_fHDRBloomAmount = v.x;
		break;
	case E3DPARAM_HDR_COLORGRADING_COLOR_SATURATION:
		m_fHDRSaturation = v.x;
		break;
	case E3DPARAM_HDR_COLORGRADING_COLOR_BALANCE:
		m_vColorBalance = v;
		break;
	case E3DPARAM_CLOUDSHADING_MULTIPLIERS:
		m_fCloudShadingSunLightMultiplier = (v.x >= 0) ? v.x : 0;
		m_fCloudShadingSkyLightMultiplier = (v.y >= 0) ? v.y : 0;
		break;
	case E3DPARAM_CLOUDSHADING_SUNCOLOR:
		m_vCloudShadingCustomSunColor = v;
		break;
	case E3DPARAM_CLOUDSHADING_SKYCOLOR:
		m_vCloudShadingCustomSkyColor = v;
		break;
	case E3DPARAM_VOLCLOUD_ATMOSPHERIC_SCATTERING:
		m_vVolCloudAtmosphericScattering = v;
		break;
	case E3DPARAM_VOLCLOUD_GEN_PARAMS:
		m_vVolCloudGenParams = v;
		break;
	case E3DPARAM_VOLCLOUD_SCATTERING_LOW:
		m_vVolCloudScatteringLow = v;
		break;
	case E3DPARAM_VOLCLOUD_SCATTERING_HIGH:
		m_vVolCloudScatteringHigh = v;
		break;
	case E3DPARAM_VOLCLOUD_GROUND_COLOR:
		m_vVolCloudGroundColor = v;
		break;
	case E3DPARAM_VOLCLOUD_SCATTERING_MULTI:
		m_vVolCloudScatteringMulti = v;
		break;
	case E3DPARAM_VOLCLOUD_WIND_ATMOSPHERIC:
		m_vVolCloudWindAtmospheric = v;
		break;
	case E3DPARAM_VOLCLOUD_TURBULENCE:
		m_vVolCloudTurbulence = v;
		break;
	case E3DPARAM_VOLCLOUD_ENV_PARAMS:
		m_vVolCloudEnvParams = v;
		break;
	case E3DPARAM_VOLCLOUD_GLOBAL_NOISE_SCALE:
		m_vVolCloudGlobalNoiseScale = v;
		break;
	case E3DPARAM_VOLCLOUD_RENDER_PARAMS:
		m_vVolCloudRenderParams = v;
		break;
	case E3DPARAM_VOLCLOUD_TURBULENCE_NOISE_SCALE:
		m_vVolCloudTurbulenceNoiseScale = v;
		break;
	case E3DPARAM_VOLCLOUD_TURBULENCE_NOISE_PARAMS:
		m_vVolCloudTurbulenceNoiseParams = v;
		break;
	case E3DPARAM_VOLCLOUD_DENSITY_PARAMS:
		m_vVolCloudDensityParams = v;
		break;
	case E3DPARAM_VOLCLOUD_MISC_PARAM:
		m_vVolCloudMiscParams = v;
		break;
	case E3DPARAM_VOLCLOUD_TILING_SIZE:
		m_vVolCloudTilingSize = v;
		break;
	case E3DPARAM_VOLCLOUD_TILING_OFFSET:
		m_vVolCloudTilingOffset = v;
		break;
	case E3DPARAM_NIGHSKY_MOON_DIRECTION: // moon direction is fixed per level or updated via FG node (E3DPARAM_SKY_MOONROTATION)
	default:
		assert(0);
		break;
	}
}

//////////////////////////////////////////////////////////////////////////
void C3DEngine::GetGlobalParameter(E3DEngineParameter param, Vec3& v)
{
	switch (param)
	{
	case E3DPARAM_SKY_COLOR:
		v = GetSkyColor();
		break;
	case E3DPARAM_SUN_COLOR:
		v = GetSunColor();
		break;

	case E3DPARAM_SUN_SPECULAR_MULTIPLIER:
		v = Vec3(m_fSunSpecMult, 0, 0);
		break;

	case E3DPARAM_AMBIENT_GROUND_COLOR:
		v = m_vAmbGroundCol;
		break;
	case E3DPARAM_AMBIENT_MIN_HEIGHT:
		v = Vec3(m_fAmbMaxHeight, 0, 0);
		break;
	case E3DPARAM_AMBIENT_MAX_HEIGHT:
		v = Vec3(m_fAmbMinHeight, 0, 0);
		break;
	case E3DPARAM_SKY_HIGHLIGHT_POS:
		v = m_vSkyHightlightPos;
		break;
	case E3DPARAM_SKY_HIGHLIGHT_COLOR:
		v = m_vSkyHightlightCol;
		break;
	case E3DPARAM_SKY_HIGHLIGHT_SIZE:
		v = Vec3(m_fSkyHighlightSize, 0, 0);
		break;
	case E3DPARAM_VOLFOG_RAMP:
		v = m_volFogRamp;
		break;
	case E3DPARAM_VOLFOG_SHADOW_RANGE:
		v = m_volFogShadowRange;
		break;
	case E3DPARAM_VOLFOG_SHADOW_DARKENING:
		v = m_volFogShadowDarkening;
		break;
	case E3DPARAM_VOLFOG_SHADOW_ENABLE:
		v = m_volFogShadowEnable;
		break;
	case E3DPARAM_VOLFOG2_CTRL_PARAMS:
		v = m_volFog2CtrlParams;
		break;
	case E3DPARAM_VOLFOG2_SCATTERING_PARAMS:
		v = m_volFog2ScatteringParams;
		break;
	case E3DPARAM_VOLFOG2_RAMP:
		v = m_volFog2Ramp;
		break;
	case E3DPARAM_VOLFOG2_COLOR:
		v = m_volFog2Color;
		break;
	case E3DPARAM_VOLFOG2_GLOBAL_DENSITY:
		v = m_volFog2GlobalDensity;
		break;
	case E3DPARAM_VOLFOG2_HEIGHT_DENSITY:
		v = m_volFog2HeightDensity;
		break;
	case E3DPARAM_VOLFOG2_HEIGHT_DENSITY2:
		v = m_volFog2HeightDensity2;
		break;
	case E3DPARAM_VOLFOG2_COLOR1:
		v = m_volFog2Color1;
		break;
	case E3DPARAM_VOLFOG2_COLOR2:
		v = m_volFog2Color2;
		break;
	case E3DPARAM_SKYLIGHT_RAYLEIGH_INSCATTER:
		v = m_fogColorSkylightRayleighInScatter;
		break;
	case E3DPARAM_NIGHSKY_HORIZON_COLOR:
		v = m_nightSkyHorizonCol;
		break;
	case E3DPARAM_NIGHSKY_ZENITH_COLOR:
		v = m_nightSkyZenithCol;
		break;
	case E3DPARAM_NIGHSKY_ZENITH_SHIFT:
		v = Vec3(m_nightSkyZenithColShift, 0, 0);
		break;
	case E3DPARAM_NIGHSKY_STAR_INTENSITY:
		v = Vec3(m_nightSkyStarIntensity, 0, 0);
		break;
	case E3DPARAM_NIGHSKY_MOON_DIRECTION:
		v = m_moonDirection;
		break;
	case E3DPARAM_NIGHSKY_MOON_COLOR:
		v = m_nightMoonCol;
		break;
	case E3DPARAM_NIGHSKY_MOON_SIZE:
		v = Vec3(m_nightMoonSize, 0, 0);
		break;
	case E3DPARAM_NIGHSKY_MOON_INNERCORONA_COLOR:
		v = m_nightMoonInnerCoronaCol;
		break;
	case E3DPARAM_NIGHSKY_MOON_INNERCORONA_SCALE:
		v = Vec3(m_nightMoonInnerCoronaScale, 0, 0);
		break;
	case E3DPARAM_NIGHSKY_MOON_OUTERCORONA_COLOR:
		v = m_nightMoonOuterCoronaCol;
		break;
	case E3DPARAM_NIGHSKY_MOON_OUTERCORONA_SCALE:
		v = Vec3(m_nightMoonOuterCoronaScale, 0, 0);
		break;
	case E3DPARAM_SKY_MOONROTATION:
		v = Vec3(m_moonRotationLatitude, m_moonRotationLongitude, 0);
		break;
	case E3DPARAM_SKY_SKYBOX_ANGLE:
		v = Vec3(m_fSkyBoxAngle, 0, 0);
		break;
	case E3DPARAM_SKY_SKYBOX_STRETCHING:
		v = Vec3(m_fSkyBoxStretching, 0, 0);
		break;
	case E3DPARAM_SKY_SKYBOX_EMITTANCE:
		v = m_vSkyBoxExposure;
		break;
	case E3DPARAM_SKY_SKYBOX_FILTER:
		v = m_vSkyBoxOpacity;
		break;
	case E3DPARAM_OCEANFOG_COLOR:
		v = m_oceanFogColor;
		break;
	case E3DPARAM_OCEANFOG_DENSITY:
		v = Vec3(m_oceanFogDensity, 0, 0);
		break;
	case E3DPARAM_SKYBOX_MULTIPLIER:
		v = Vec3(m_skyboxMultiplier, 0, 0);
		break;
	case E3DPARAM_DAY_NIGHT_INDICATOR:
		v = Vec3(m_dayNightIndicator, 0, 0);
		break;
	case E3DPARAM_FOG_COLOR2:
		v = m_fogColor2;
		break;
	case E3DPARAM_FOG_RADIAL_COLOR:
		v = m_fogColorRadial;
		break;
	case E3DPARAM_VOLFOG_HEIGHT_DENSITY:
		v = m_volFogHeightDensity;
		break;
	case E3DPARAM_VOLFOG_HEIGHT_DENSITY2:
		v = m_volFogHeightDensity2;
		break;
	case E3DPARAM_VOLFOG_GRADIENT_CTRL:
		v = m_volFogGradientCtrl;
		break;
	case E3DPARAM_VOLFOG_GLOBAL_DENSITY:
		v = Vec3(m_volFogGlobalDensity, m_volFogGlobalDensityMultiplierLDR, m_volFogFinalDensityClamp);
		break;
	case E3DPARAM_COLORGRADING_FILTERS_PHOTOFILTER_COLOR:
		v = Vec3(m_pPhotoFilterColor.x, m_pPhotoFilterColor.y, m_pPhotoFilterColor.z);
		break;
	case E3DPARAM_COLORGRADING_FILTERS_PHOTOFILTER_DENSITY:
		v = Vec3(m_fPhotoFilterColorDensity, 0, 0);
		break;
	case E3DPARAM_COLORGRADING_FILTERS_GRAIN:
		v = Vec3(m_fGrainAmount, 0, 0);
		break;
	case E3DPARAM_HDR_FILMCURVE_SHOULDER_SCALE:
		v = Vec3(m_vHDRFilmCurveParams.x, 0, 0);
		break;
	case E3DPARAM_HDR_FILMCURVE_LINEAR_SCALE:
		v = Vec3(m_vHDRFilmCurveParams.y, 0, 0);
		break;
	case E3DPARAM_HDR_FILMCURVE_TOE_SCALE:
		v = Vec3(m_vHDRFilmCurveParams.z, 0, 0);
		break;
	case E3DPARAM_HDR_FILMCURVE_WHITEPOINT:
		v = Vec3(m_vHDRFilmCurveParams.w, 0, 0);
		break;
	case E3DPARAM_HDR_EYEADAPTATION_PARAMS:
		v = m_vHDREyeAdaptation;
		break;
	case E3DPARAM_HDR_EYEADAPTATION_PARAMS_LEGACY:
		v = m_vHDREyeAdaptationLegacy;
		break;
	case E3DPARAM_HDR_BLOOM_AMOUNT:
		v = Vec3(m_fHDRBloomAmount, 0, 0);
		break;
	case E3DPARAM_HDR_COLORGRADING_COLOR_SATURATION:
		v = Vec3(m_fHDRSaturation, 0, 0);
		break;
	case E3DPARAM_HDR_COLORGRADING_COLOR_BALANCE:
		v = m_vColorBalance;
		break;
	case E3DPARAM_CLOUDSHADING_MULTIPLIERS:
		v = Vec3(m_fCloudShadingSunLightMultiplier, m_fCloudShadingSkyLightMultiplier, 0);
		break;
	case E3DPARAM_CLOUDSHADING_SUNCOLOR:
		v = m_vCloudShadingCustomSunColor;
		break;
	case E3DPARAM_CLOUDSHADING_SKYCOLOR:
		v = m_vCloudShadingCustomSkyColor;
		break;
	case E3DPARAM_VOLCLOUD_ATMOSPHERIC_SCATTERING:
		v = m_vVolCloudAtmosphericScattering;
		break;
	case E3DPARAM_VOLCLOUD_GEN_PARAMS:
		v = m_vVolCloudGenParams;
		break;
	case E3DPARAM_VOLCLOUD_SCATTERING_LOW:
		v = m_vVolCloudScatteringLow;
		break;
	case E3DPARAM_VOLCLOUD_SCATTERING_HIGH:
		v = m_vVolCloudScatteringHigh;
		break;
	case E3DPARAM_VOLCLOUD_GROUND_COLOR:
		v = m_vVolCloudGroundColor;
		break;
	case E3DPARAM_VOLCLOUD_SCATTERING_MULTI:
		v = m_vVolCloudScatteringMulti;
		break;
	case E3DPARAM_VOLCLOUD_WIND_ATMOSPHERIC:
		v = m_vVolCloudWindAtmospheric;
		break;
	case E3DPARAM_VOLCLOUD_TURBULENCE:
		v = m_vVolCloudTurbulence;
		break;
	case E3DPARAM_VOLCLOUD_ENV_PARAMS:
		v = m_vVolCloudEnvParams;
		break;
	case E3DPARAM_VOLCLOUD_GLOBAL_NOISE_SCALE:
		v = m_vVolCloudGlobalNoiseScale;
		break;
	case E3DPARAM_VOLCLOUD_RENDER_PARAMS:
		v = m_vVolCloudRenderParams;
		break;
	case E3DPARAM_VOLCLOUD_TURBULENCE_NOISE_SCALE:
		v = m_vVolCloudTurbulenceNoiseScale;
		break;
	case E3DPARAM_VOLCLOUD_TURBULENCE_NOISE_PARAMS:
		v = m_vVolCloudTurbulenceNoiseParams;
		break;
	case E3DPARAM_VOLCLOUD_DENSITY_PARAMS:
		v = m_vVolCloudDensityParams;
		break;
	case E3DPARAM_VOLCLOUD_MISC_PARAM:
		v = m_vVolCloudMiscParams;
		break;
	case E3DPARAM_VOLCLOUD_TILING_SIZE:
		v = m_vVolCloudTilingSize;
		break;
	case E3DPARAM_VOLCLOUD_TILING_OFFSET:
		v = m_vVolCloudTilingOffset;
		break;
	default:
		assert(0);
		break;
	}
}

//////////////////////////////////////////////////////////////////////////

void C3DEngine::SetCachedShadowBounds(const AABB& shadowBounds, float fAdditionalCascadesScale)
{
	const Vec3 boxSize = shadowBounds.GetSize();
	const bool isValid = boxSize.x > 0 && boxSize.y > 0 && boxSize.z > 0;

	m_CachedShadowsBounds = isValid ? shadowBounds : AABB(AABB::RESET);
	m_fCachedShadowsCascadeScale = fAdditionalCascadesScale;

	m_nCachedShadowsUpdateStrategy = ShadowMapFrustum::ShadowCacheData::eFullUpdate;
}

//////////////////////////////////////////////////////////////////////////
void C3DEngine::SetRecomputeCachedShadows(uint nUpdateStrategy)
{
	CRY_PROFILE_FUNCTION(PROFILE_LOADING_ONLY);
	m_nCachedShadowsUpdateStrategy = nUpdateStrategy;

	if (IRenderer* const pRenderer = GetRenderer())
	{
		// refresh cached shadow casters
		if (GetCVars()->e_DynamicDistanceShadows != 0 && m_pObjectsTree)
		{
			static int lastFrameId = 0;

			int newFrameId = pRenderer->GetFrameID();

			if (lastFrameId != newFrameId)
			{
				m_pObjectsTree->MarkAsUncompiled();

				lastFrameId = newFrameId;
			}
		}
	}
}

//////////////////////////////////////////////////////////////////////////
void C3DEngine::SetRecomputeCachedShadows(IRenderNode* pNode, uint updateStrategy)
{
	m_nCachedShadowsUpdateStrategy = updateStrategy;

	if (IRenderer* const pRenderer = GetRenderer())
	{
		if (GetCVars()->e_DynamicDistanceShadows != 0 && pNode)
		{
			pNode->MarkAsUncompiled();
		}
	}
}

void C3DEngine::ReleasePermanentObjectsRenderResources()
{
	gEnv->pRenderer->FlushRTCommands(true, true, true);
	MarkRNTmpDataPoolForReset();
	gEnv->pRenderer->ClearShaderPipelineStateCache();
}

void C3DEngine::InvalidateShadowCacheData()
{
	ShadowCacheGenerator::ResetGenerationID();

	if (m_pObjectsTree)
	{
		m_pObjectsTree->InvalidateCachedShadowData();
	}

	if (m_pTerrain)
	{
		m_pTerrain->GetParentNode()->InvalidateCachedShadowData();
	}
}

//////////////////////////////////////////////////////////////////////////
void C3DEngine::SetShadowsCascadesBias(const float* pCascadeConstBias, const float* pCascadeSlopeBias)
{
	memcpy(m_pShadowCascadeConstBias, pCascadeConstBias, sizeof(float) * MAX_SHADOW_CASCADES_NUM);
	memcpy(m_pShadowCascadeSlopeBias, pCascadeSlopeBias, sizeof(float) * MAX_SHADOW_CASCADES_NUM);
}

int C3DEngine::GetShadowsCascadeCount(const SRenderLight* pLight) const
{
	int nCascadeCount = m_eShadowMode == ESM_HIGHQUALITY ? MAX_GSM_LODS_NUM : GetCVars()->e_GsmLodsNum;
	return clamp_tpl(nCascadeCount, 0, MAX_GSM_LODS_NUM);
}

void C3DEngine::OnRenderMeshDeleted(IRenderMesh* pRenderMesh)
{
	if (m_pDecalManager)
		m_pDecalManager->OnRenderMeshDeleted(pRenderMesh);
}

bool C3DEngine::RenderMeshRayIntersection(IRenderMesh* pRenderMesh, SRayHitInfo& hitInfo, IMaterial* pCustomMtl)
{
	return CRenderMeshUtils::RayIntersection(pRenderMesh, hitInfo, pCustomMtl);
}

///////////////////////////////////////////////////////////////////////////////
SRenderNodeTempData* C3DEngine::CreateRenderNodeTempData(IRenderNode* pRNode, const SRenderingPassInfo& passInfo)
{
	SRenderNodeTempData* pNewTempData = m_visibleNodesManager.AllocateTempData(passInfo.GetFrameID());
	pNewTempData->userData.pOwnerNode = pRNode;

	pRNode->OnRenderNodeBecomeVisibleAsync(pNewTempData, passInfo);

	if (IVisArea* pVisArea = pRNode->GetEntityVisArea())
		pNewTempData->userData.m_pClipVolume = pVisArea;
	else if (GetClipVolumeManager()->IsClipVolumeRequired(pRNode))
		GetClipVolumeManager()->UpdateEntityClipVolume(pRNode->GetPos(), pRNode);

	return pNewTempData;
}

//////////////////////////////////////////////////////////////////////////
SRenderNodeTempData* C3DEngine::CheckAndCreateRenderNodeTempData(IRenderNode* pRNode, const SRenderingPassInfo& passInfo)
{
	FUNCTION_PROFILER_3DENGINE;
	CRY_ASSERT(pRNode);
	if (!pRNode)
		return nullptr;

	DBG_LOCK_TO_THREAD(pRNode);

	const int currentFrame = passInfo.GetFrameID();
	SRenderNodeTempData* pTempData = pRNode->m_pTempData;

	if (pRNode->m_manipulationFrame != currentFrame)
	{
		// No TempData seen yet
		if (!pTempData)
		{
			pRNode->m_pTempData = (pTempData = CreateRenderNodeTempData(pRNode, passInfo));
			CRY_ASSERT(pTempData && "CreateRenderNodeTempData() failed!");
		}
		// Manual invalidation of TempData occurred
		else if (pTempData->invalidRenderObjects)
		{
			pTempData->FreeRenderObjects();
		}
		// Automatic invalidation check
		else if (pTempData->hasValidRenderObjects)
		{
			// detect render resources modification (for example because of mesh streaming or material editing)
			if (auto nStatObjLastModificationId = pTempData->userData.nStatObjLastModificationId)
			{
				if (nStatObjLastModificationId != GetObjManager()->GetResourcesModificationChecksum(pRNode))
				{
					pTempData->FreeRenderObjects();
				}
			}
		}

		pRNode->m_manipulationFrame = currentFrame;
	}

	CRY_ASSERT(pTempData);
	if (!pTempData)
		return nullptr;

	if (!m_visibleNodesManager.SetLastSeenFrame(pTempData, passInfo))
		pTempData = nullptr;

	return pTempData;
}

void C3DEngine::CopyObjectsByType(EERType objType, const AABB* pBox, PodArray<IRenderNode*>* plstObjects, uint64 dwFlags)
{
	GetObjectsByTypeGlobal(*plstObjects, objType, pBox, 0, dwFlags);

	if (GetVisAreaManager())
		GetVisAreaManager()->GetObjectsByType(*plstObjects, objType, pBox, 0, dwFlags);
}

void C3DEngine::CopyObjects(const AABB* pBox, PodArray<IRenderNode*>* plstObjects)
{
	m_pObjectsTree->GetObjects(*plstObjects, pBox);

	if (GetVisAreaManager())
		GetVisAreaManager()->GetObjects(*plstObjects, pBox);
}

uint32 C3DEngine::GetObjectsByType(EERType objType, IRenderNode** pObjects)
{
	PodArray<IRenderNode*> lstObjects;
	CopyObjectsByType(objType, NULL, &lstObjects);
	if (pObjects && !lstObjects.IsEmpty())
		memcpy(pObjects, &lstObjects[0], lstObjects.GetDataSize());
	return lstObjects.Count();
}

uint32 C3DEngine::GetObjectsByTypeInBox(EERType objType, const AABB& bbox, IRenderNode** pObjects, uint64 dwFlags)
{
	PodArray<IRenderNode*> lstObjects;
	CopyObjectsByType(objType, &bbox, &lstObjects, dwFlags);
	if (pObjects && !lstObjects.IsEmpty())
		memcpy(pObjects, &lstObjects[0], lstObjects.GetDataSize());
	return lstObjects.Count();
}

uint32 C3DEngine::GetObjectsInBox(const AABB& bbox, IRenderNode** pObjects)
{
	PodArray<IRenderNode*> lstObjects;
	CopyObjects(&bbox, &lstObjects);
	if (pObjects && !lstObjects.IsEmpty())
		memcpy(pObjects, &lstObjects[0], lstObjects.GetDataSize());
	return lstObjects.Count();
}

uint32 C3DEngine::GetObjectsByFlags(uint dwFlags, IRenderNode** pObjects /* =0 */)
{
	PodArray<IRenderNode*> lstObjects;

	if (Get3DEngine()->m_pObjectsTree)
		Get3DEngine()->m_pObjectsTree->GetObjectsByFlags(dwFlags, lstObjects);

	if (GetVisAreaManager())
		GetVisAreaManager()->GetObjectsByFlags(dwFlags, lstObjects);

	if (pObjects && !lstObjects.IsEmpty())
		memcpy(pObjects, &lstObjects[0], lstObjects.GetDataSize());
	return lstObjects.Count();
}

void C3DEngine::OnObjectModified(IRenderNode* pRenderNode, IRenderNode::RenderFlagsType dwFlags)
{
	bool bSkipCharacters = !GetCVars()->e_ShadowsCacheRenderCharacters || (dwFlags & ERF_DYNAMIC_DISTANCESHADOWS);

	if ((dwFlags & (ERF_CASTSHADOWMAPS | ERF_HAS_CASTSHADOWMAPS)) != 0 && (!pRenderNode || (pRenderNode->GetRenderNodeType() != eERType_Character || !bSkipCharacters)))
	{
		SetRecomputeCachedShadows(pRenderNode, ShadowMapFrustum::ShadowCacheData::eFullUpdateTimesliced);
	}

	if (pRenderNode)
	{
		pRenderNode->InvalidatePermanentRenderObject();
	}
}

int SImageInfo::GetMemoryUsage()
{
	int nSize = 0;
	if (detailInfo.pImgMips[0])
		nSize += (int)((float)(detailInfo.nDim * detailInfo.nDim * sizeof(ColorB)) * 1.3f);
	if (baseInfo.pImgMips[0])
		nSize += (int)((float)(baseInfo.nDim * baseInfo.nDim * sizeof(ColorB)) * 1.3f);
	return nSize;
}

byte** C3DEngine::AllocateMips(byte* pImage, int nDim, byte** pImageMips)
{
	memset(pImageMips, 0, SImageSubInfo::nMipsNum * sizeof(pImageMips[0]));

	pImageMips[0] = new byte[nDim * nDim * sizeof(ColorB)];
	memcpy(pImageMips[0], pImage, nDim * nDim * sizeof(ColorB));

	ColorB* pMipMain = (ColorB*)pImageMips[0];

	for (int nMip = 1; (nDim >> nMip) && nMip < SImageSubInfo::nMipsNum; nMip++)
	{
		int nDimMip = nDim >> nMip;

		int nSubSize = 1 << nMip;

		pImageMips[nMip] = new byte[nDimMip * nDimMip * sizeof(ColorB)];

		ColorB* pMipThis = (ColorB*)pImageMips[nMip];

		for (int x = 0; x < nDimMip; x++)
		{
			for (int y = 0; y < nDimMip; y++)
			{
				ColorF colSumm(0, 0, 0, 0);
				float fCount = 0;
				for (int _x = x * nSubSize - nSubSize / 2; _x < x * nSubSize + nSubSize + nSubSize / 2; _x++)
				{
					for (int _y = y * nSubSize - nSubSize / 2; _y < y * nSubSize + nSubSize + nSubSize / 2; _y++)
					{
						int nMask = nDim - 1;
						int id = (_x & nMask) * nDim + (_y & nMask);
						colSumm.r += 1.f / 255.f * pMipMain[id].r;
						colSumm.g += 1.f / 255.f * pMipMain[id].g;
						colSumm.b += 1.f / 255.f * pMipMain[id].b;
						colSumm.a += 1.f / 255.f * pMipMain[id].a;
						fCount++;
					}
				}

				colSumm /= fCount;

				colSumm.Clamp(0, 1);

				pMipThis[x * nDimMip + y] = colSumm;
			}
		}
	}

	return pImageMips;
}

SImageInfo* C3DEngine::GetBaseTextureData(int nLayerId)
{
	if (nLayerId < 0 || nLayerId >= m_arrBaseTextureData.Count())//|| !m_arrBaseTextureData[nLayerId].baseInfo.nDim)
	{
		return NULL;
	}

	return &m_arrBaseTextureData[nLayerId];
}

SImageInfo* C3DEngine::GetBaseTextureDataFromSurfType(int nLayerId)
{
	assert(nLayerId >= 0 && nLayerId < SRangeInfo::e_max_surface_types);

	if (nLayerId < 0 || nLayerId >= m_arrBaseTextureData.Count() || !m_arrBaseTextureData[nLayerId].baseInfo.nDim)
		return NULL;

	return &m_arrBaseTextureData[nLayerId];
}

void C3DEngine::RegisterForStreaming(IStreamable* pObj)
{
	if (GetObjManager())
		GetObjManager()->RegisterForStreaming(pObj);
}

void C3DEngine::UnregisterForStreaming(IStreamable* pObj)
{
	if (GetObjManager())
		GetObjManager()->UnregisterForStreaming(pObj);
}

SImageSubInfo* C3DEngine::GetImageInfo(const char* pName)
{
	if (m_imageInfos.find(string(pName)) != m_imageInfos.end())
		return m_imageInfos[string(pName)];

	return NULL;
}

SImageSubInfo* C3DEngine::RegisterImageInfo(byte** pMips, int nDim, const char* pName)
{
	if (m_imageInfos.find(string(pName)) != m_imageInfos.end())
		return m_imageInfos[string(pName)];

	assert(pMips && pMips[0]);

	SImageSubInfo* pImgSubInfo = new SImageSubInfo;

	pImgSubInfo->nDim = nDim;

	int nMipDim = pImgSubInfo->nDim;

	for (int m = 0; m < SImageSubInfo::nMipsNum && nMipDim; m++)
	{
		pImgSubInfo->pImgMips[m] = new byte[nMipDim * nMipDim * 4];

		memcpy(pImgSubInfo->pImgMips[m], pMips[m], nMipDim * nMipDim * 4);

		nMipDim /= 2;
	}

	const string strFileName = pName;

	pImgSubInfo->nReady = 1;

	m_imageInfos[strFileName] = pImgSubInfo;

	return pImgSubInfo;
}

#if CRY_PLATFORM_WINDOWS || CRY_PLATFORM_LINUX || CRY_PLATFORM_ANDROID || CRY_PLATFORM_APPLE
const char* gVoxelEditOperationNames[eveoLast] =
{
	"None",
	"Soft Create",
	"Soft Substract",
	"Hard Create",
	"Hard Substract",
	"Material",
	"Soft Base Color",
	"Blur Positive",
	"Blur Negative",
	"Copy Terrain Pos",
	"Copy Terrain Neg",
	"Pick Height",
	"Integrate Pos",
	"Integrate Neg",
	"Force LOD",
	"Limit LOD",
};
#endif

const char* C3DEngine::GetVoxelEditOperationName(EVoxelEditOperation eOperation)
{
#if CRY_PLATFORM_WINDOWS || CRY_PLATFORM_LINUX || CRY_PLATFORM_ANDROID || CRY_PLATFORM_APPLE
	return gVoxelEditOperationNames[eOperation];
#else
	return 0;
#endif
}

void C3DEngine::SyncProcessStreamingUpdate()
{
	if (m_pObjManager)
		m_pObjManager->ProcessObjectsStreaming_Finish();
}

void C3DEngine::SetScreenshotCallback(IScreenshotCallback* pCallback)
{
	m_pScreenshotCallback = pCallback;
}

void C3DEngine::RegisterRenderNodeStatusListener(IRenderNodeStatusListener* pListener, EERType renderNodeType)
{
	m_renderNodeStatusListenersArray[renderNodeType].Add(pListener);
}

void C3DEngine::UnregisterRenderNodeStatusListener(IRenderNodeStatusListener* pListener, EERType renderNodeType)
{
	m_renderNodeStatusListenersArray[renderNodeType].Remove(pListener);
}

void C3DEngine::ActivateObjectsLayer(uint16 nLayerId, bool bActivate, bool bPhys, bool bObjects, bool bStaticLights, const char* pLayerName, IGeneralMemoryHeap* pHeap, bool bCheckLayerActivation /*=true*/)
{
	if (bCheckLayerActivation && !IsAreaActivationInUse())
		return;

	if (bActivate)
		m_bLayersActivated = true;

	// keep track of active layers
	m_arrObjectLayersActivity.CheckAllocated(nLayerId + 1);
	m_arrObjectLayersActivity[nLayerId].bActive = bActivate;

	m_objectLayersModificationId++;

	if (bActivate && m_nFramesSinceLevelStart <= 1)
		m_vPrevMainFrameCamPos.Set(-1000000.f, -1000000.f, -1000000.f);

	FUNCTION_PROFILER_3DENGINE;

	PrintMessage("%s object layer %s (Id = %d) (LevelFrameId = %d)", bActivate ? "Activating" : "Deactivating", pLayerName, nLayerId, m_nFramesSinceLevelStart);
	INDENT_LOG_DURING_SCOPE();

	if (bObjects)
	{
		if (m_pObjectsTree)
			m_pObjectsTree->ActivateObjectsLayer(nLayerId, bActivate, bPhys, pHeap, m_arrObjectLayersActivity[nLayerId].objectsBox);

		if (m_pVisAreaManager)
			m_pVisAreaManager->ActivateObjectsLayer(nLayerId, bActivate, bPhys, pHeap, m_arrObjectLayersActivity[nLayerId].objectsBox);
	}

	if (bStaticLights)
	{
		for (size_t i = 0; i < m_lstStaticLights.size(); ++i)
		{
			ILightSource* pLight = m_lstStaticLights[i];

			if (pLight->GetLayerId() == nLayerId || nLayerId == uint16(~0))
				if (pLight != m_pSun) // TODO: e_Sun is the CVar controlling visibility of the sun
					pLight->SetRndFlags(ERF_HIDDEN, !bActivate);
		}
	}
}

bool C3DEngine::IsObjectsLayerHidden(uint16 nLayerId, const AABB& objBox)
{
	if (IsAreaActivationInUse() && nLayerId && nLayerId < uint16(~0))
	{
		m_arrObjectLayersActivity.CheckAllocated(nLayerId + 1);

		if (m_arrObjectLayersActivity[nLayerId].objectsBox.GetVolume())
			m_arrObjectLayersActivity[nLayerId].objectsBox.Add(objBox);
		else
			m_arrObjectLayersActivity[nLayerId].objectsBox = objBox;

		m_objectLayersModificationId++;

		return !m_arrObjectLayersActivity[nLayerId].bActive;
	}

	return false;
}

void C3DEngine::GetLayerMemoryUsage(uint16 nLayerId, ICrySizer* pSizer, int* pNumBrushes, int* pNumDecals) const
{
	if (pNumBrushes)
		*pNumBrushes = 0;
	if (pNumDecals)
		*pNumDecals = 0;

	if (m_pObjectsTree)
		m_pObjectsTree->GetLayerMemoryUsage(nLayerId, pSizer, pNumBrushes, pNumDecals);
}

void C3DEngine::SkipLayerLoading(uint16 nLayerId, bool bClearList)
{
	if (bClearList)
		m_skipedLayers.clear();
	m_skipedLayers.insert(nLayerId);
}

bool C3DEngine::IsLayerSkipped(uint16 nLayerId)
{
	return m_skipedLayers.find(nLayerId) != m_skipedLayers.end() ? true : false;
}

void C3DEngine::PrecacheCharacter(IRenderNode* pObj, const float fImportance, ICharacterInstance* pCharacter, IMaterial* pSlotMat, const Matrix34& matParent, const float fEntDistance, const float fScale, int nMaxDepth, bool bForceStreamingSystemUpdate, const SRenderingPassInfo& passInfo)
{
	if (m_pObjManager)
	{
		CCharacterRenderNode::PrecacheCharacter(fImportance, pCharacter, pSlotMat, matParent, fEntDistance, fScale, nMaxDepth, false, true, 0);
		if (bForceStreamingSystemUpdate)
		{
			m_pObjManager->ProcessObjectsStreaming(passInfo);
		}
	}
}

void C3DEngine::PrecacheRenderNode(IRenderNode* pObj, float fEntDistanceReal)
{
	FUNCTION_PROFILER_3DENGINE;

	//	PrintMessage("==== PrecacheRenderNodePrecacheRenderNode: %s ====", pObj->GetName());

	if (m_pObjManager)
	{
		auto dwOldRndFlags = pObj->GetRndFlags();
		pObj->SetRndFlags(ERF_HIDDEN, false);

		SRenderingPassInfo passInfo = SRenderingPassInfo::CreateGeneralPassRenderingInfo(SGraphicsPipelineKey::BaseGraphicsPipelineKey, gEnv->pSystem->GetViewCamera());
		m_pObjManager->UpdateRenderNodeStreamingPriority(pObj, fEntDistanceReal, 1.0f, fEntDistanceReal < GetFloatCVar(e_StreamCgfFastUpdateMaxDistance), passInfo, true);

		pObj->SetRndFlags(dwOldRndFlags);
	}
}

void C3DEngine::CleanUpOldDecals()
{
	FUNCTION_PROFILER_3DENGINE;
	static uint32 nLastIndex = 0;
	const uint32 nDECALS_PER_FRAME = 50;

	if (uint32 nNumDecalRenderNodes = m_decalRenderNodes.size())
	{
		for (uint32 i = 0, end = __min(nDECALS_PER_FRAME, nNumDecalRenderNodes); i < end; ++i, ++nLastIndex)
		{
			// wrap around at the end to restart at the beginning
			if (nLastIndex >= nNumDecalRenderNodes)
			{
				nLastIndex = 0;
			}

			m_decalRenderNodes[nLastIndex]->CleanUpOldDecals();
		}
	}
}

void C3DEngine::UpdateRenderTypeEnableLookup()
{
	SetRenderNodeTypeEnabled(eERType_MovableBrush, (GetCVars()->e_Entities != 0));
	SetRenderNodeTypeEnabled(eERType_Character, (GetCVars()->e_Entities != 0));
	SetRenderNodeTypeEnabled(eERType_Brush, (GetCVars()->e_Brushes != 0));
	SetRenderNodeTypeEnabled(eERType_Vegetation, (GetCVars()->e_Vegetation != 0));
}

void C3DEngine::SetRenderNodeMaterialAtPosition(EERType eNodeType, const Vec3& vPos, IMaterial* pMat)
{
	PodArray<IRenderNode*> lstObjects;

	AABB aabbPos(vPos - Vec3(.1f, .1f, .1f), vPos + Vec3(.1f, .1f, .1f));

	GetObjectsByTypeGlobal(lstObjects, eNodeType, &aabbPos);

	if (GetVisAreaManager())
		GetVisAreaManager()->GetObjectsByType(lstObjects, eNodeType, &aabbPos);

	for (int i = 0; i < lstObjects.Count(); i++)
	{
		PrintMessage("Game changed render node material: %s EERType:%d pos: (%d,%d,%d)",
		             pMat ? pMat->GetName() : "NULL",
		             (int)eNodeType,
		             (int)vPos.x, (int)vPos.y, (int)vPos.z);

		lstObjects[i]->SetMaterial(pMat);
	}
}

void C3DEngine::OverrideCameraPrecachePoint(const Vec3& vPos)
{
	if (m_pObjManager)
	{
		m_pObjManager->m_vStreamPreCacheCameras[0].vPosition = vPos;
		m_pObjManager->m_bCameraPrecacheOverridden = true;
	}
}

int C3DEngine::AddPrecachePoint(const Vec3& vPos, const Vec3& vDir, float fTimeOut, float fImportanceFactor)
{
	if (m_pObjManager)
	{
		if (m_pObjManager->m_vStreamPreCachePointDefs.size() >= CObjManager::MaxPrecachePoints)
		{
			size_t nOldestIdx = 0;
			int nOldestId = INT_MAX;
			for (size_t i = 1, c = m_pObjManager->m_vStreamPreCachePointDefs.size(); i < c; ++i)
			{
				if (m_pObjManager->m_vStreamPreCachePointDefs[i].nId < nOldestId)
				{
					nOldestIdx = i;
					nOldestId = m_pObjManager->m_vStreamPreCachePointDefs[i].nId;
				}
			}

			assert(nOldestIdx > 0);

			CryWarning(VALIDATOR_MODULE_3DENGINE, VALIDATOR_WARNING, "Precache points full - evicting oldest (%f, %f, %f)",
			           m_pObjManager->m_vStreamPreCacheCameras[nOldestIdx].vPosition.x,
			           m_pObjManager->m_vStreamPreCacheCameras[nOldestIdx].vPosition.y,
			           m_pObjManager->m_vStreamPreCacheCameras[nOldestIdx].vPosition.z);

			m_pObjManager->m_vStreamPreCachePointDefs.DeleteFastUnsorted((int)nOldestIdx);
			m_pObjManager->m_vStreamPreCacheCameras.DeleteFastUnsorted((int)nOldestIdx);
		}

		SObjManPrecachePoint pp;
		pp.nId = m_pObjManager->m_nNextPrecachePointId++;
		pp.expireTime = gEnv->pTimer->GetAsyncTime() + CTimeValue(fTimeOut);
		SObjManPrecacheCamera pc;
		pc.vPosition = vPos;
		pc.bbox = AABB(vPos, GetCVars()->e_StreamPredictionBoxRadius);
		pc.vDirection = vDir;
		pc.fImportanceFactor = fImportanceFactor;
		m_pObjManager->m_vStreamPreCachePointDefs.Add(pp);
		m_pObjManager->m_vStreamPreCacheCameras.Add(pc);
		//m_pObjManager->m_bCameraPrecacheOverridden = true;

		return pp.nId;
	}

	return -1;
}

void C3DEngine::ClearPrecachePoint(int id)
{
	if (m_pObjManager)
	{
		for (size_t i = 1, c = m_pObjManager->m_vStreamPreCachePointDefs.size(); i < c; ++i)
		{
			if (m_pObjManager->m_vStreamPreCachePointDefs[i].nId == id)
			{
				m_pObjManager->m_vStreamPreCachePointDefs.DeleteFastUnsorted((int)i);
				m_pObjManager->m_vStreamPreCacheCameras.DeleteFastUnsorted((int)i);
				break;
			}
		}
	}
}

void C3DEngine::ClearAllPrecachePoints()
{
	if (m_pObjManager)
	{
		m_pObjManager->m_vStreamPreCachePointDefs.resize(1);
		m_pObjManager->m_vStreamPreCacheCameras.resize(1);
	}
}

void C3DEngine::GetPrecacheRoundIds(int pRoundIds[MAX_STREAM_PREDICTION_ZONES])
{
	if (m_pObjManager)
	{
		pRoundIds[0] = m_pObjManager->m_nUpdateStreamingPrioriryRoundIdFast;
		pRoundIds[1] = m_pObjManager->m_nUpdateStreamingPrioriryRoundId;
	}
}

void static DrawMeter(float scale, float& x, float& y, int nWidth, int nHeight, IRenderAuxGeom* pAuxRenderer)
{
	vtx_idx indLines[8] =
	{
		0, 1, 1, 2,
		2, 3, 3, 0
	};

	const int c_yStepSizeTextMeter(8);

	const float barWidth = 0.2f; //normalized screen size
	const float yellowStart = 0.5f * barWidth;
	const float redStart = 0.75f * barWidth;

	Vec3 frame[4] =
	{
		Vec3((x - 1) / (float) nWidth,      (y - 1) / (float) nHeight,                        0),
		Vec3(x / (float) nWidth + barWidth, (y - 1) / (float) nHeight,                        0),
		Vec3(x / (float) nWidth + barWidth, (y + c_yStepSizeTextMeter + 1) / (float) nHeight, 0),
		Vec3((x - 1) / (float) nWidth,      (y + c_yStepSizeTextMeter + 1) / (float) nHeight, 0)
	};

	pAuxRenderer->DrawLines(frame, 4, indLines, 8, ColorB(255, 255, 255, 255));

	// draw meter itself
	vtx_idx indTri[6] =
	{
		0, 1, 2,
		0, 2, 3
	};

	// green part (0.0 <= scale <= 0.5)
	{
		float lScale(max(min(scale, 0.5f), 0.0f));

		Vec3 bar[4] =
		{
			Vec3(x / (float) nWidth,                     y / (float) nHeight,                          0),
			Vec3(x / (float) nWidth + lScale * barWidth, y / (float) nHeight,                          0),
			Vec3(x / (float) nWidth + lScale * barWidth, (y + c_yStepSizeTextMeter) / (float) nHeight, 0),
			Vec3(x / (float) nWidth,                     (y + c_yStepSizeTextMeter) / (float) nHeight, 0)
		};
		pAuxRenderer->DrawTriangles(bar, 4, indTri, 6, ColorB(0, 255, 0, 255));
	}

	// green to yellow part (0.5 < scale <= 0.75)
	if (scale > 0.5f)
	{
		float lScale(min(scale, 0.75f));

		Vec3 bar[4] =
		{
			Vec3(x / (float) nWidth + yellowStart,       y / (float) nHeight,                          0),
			Vec3(x / (float) nWidth + lScale * barWidth, y / (float) nHeight,                          0),
			Vec3(x / (float) nWidth + lScale * barWidth, (y + c_yStepSizeTextMeter) / (float) nHeight, 0),
			Vec3(x / (float) nWidth + yellowStart,       (y + c_yStepSizeTextMeter) / (float) nHeight, 0)
		};

		float color[4];
		// get right color
		if (lScale <= 0.5f)
		{
			color[0] = 0;
			color[1] = 1;
			color[2] = 0;
			color[3] = 1;
		}
		else if (lScale <= 0.75f)
		{
			color[0] = (lScale - 0.5f) * 4.0f;
			color[1] = 1;
			color[2] = 0;
			color[3] = 1;
		}
		else if (lScale <= 1.0f)
		{
			color[0] = 1;
			color[1] = 1 - (lScale - 0.75f) * 4.0f;
			color[2] = 0;
			color[3] = 1;
		}
		else
		{
			float time(gEnv->pTimer->GetAsyncCurTime());
			float blink(sinf(time * 6.28f) * 0.5f + 0.5f);
			color[0] = 1;
			color[1] = blink;
			color[2] = blink;
			color[3] = 1;
		}

		ColorB colSegStart(0, 255, 0, 255);
		ColorB colSegEnd((uint8) (color[0] * 255), (uint8) (color[1] * 255), (uint8) (color[2] * 255), (uint8) (color[3] * 255));

		ColorB col[4] =
		{
			colSegStart,
			colSegEnd,
			colSegEnd,
			colSegStart
		};

		pAuxRenderer->DrawTriangles(bar, 4, indTri, 6, col);
	}

	// yellow to red part (0.75 < scale <= 1.0)
	if (scale > 0.75f)
	{
		float lScale(min(scale, 1.0f));

		Vec3 bar[4] =
		{
			Vec3(x / (float) nWidth + redStart,          y / (float) nHeight,                          0),
			Vec3(x / (float) nWidth + lScale * barWidth, y / (float) nHeight,                          0),
			Vec3(x / (float) nWidth + lScale * barWidth, (y + c_yStepSizeTextMeter) / (float) nHeight, 0),
			Vec3(x / (float) nWidth + redStart,          (y + c_yStepSizeTextMeter) / (float) nHeight, 0)
		};

		float color[4];
		if (lScale <= 0.5f)
		{
			color[0] = 0;
			color[1] = 1;
			color[2] = 0;
			color[3] = 1;
		}
		else if (lScale <= 0.75f)
		{
			color[0] = (lScale - 0.5f) * 4.0f;
			color[1] = 1;
			color[2] = 0;
			color[3] = 1;
		}
		else if (lScale <= 1.0f)
		{
			color[0] = 1;
			color[1] = 1 - (lScale - 0.75f) * 4.0f;
			color[2] = 0;
			color[3] = 1;
		}
		else
		{
			float time(gEnv->pTimer->GetAsyncCurTime());
			float blink(sinf(time * 6.28f) * 0.5f + 0.5f);
			color[0] = 1;
			color[1] = blink;
			color[2] = blink;
			color[3] = 1;
		}

		ColorB colSegStart(255, 255, 0, 255);
		ColorB colSegEnd((uint8) (color[0] * 255), (uint8) (color[1] * 255), (uint8) (color[2] * 255), (uint8) (color[3] * 255));

		ColorB col[4] =
		{
			colSegStart,
			colSegEnd,
			colSegEnd,
			colSegStart
		};

		pAuxRenderer->DrawTriangles(bar, 4, indTri, 6, col);

	}
}

///////////////////////////////////////////////////////////////////////////////
CCamera* C3DEngine::GetRenderingPassCamera(const CCamera& rCamera)
{
	threadID nThreadID = 0;
	gEnv->pRenderer->EF_Query(EFQ_RenderThreadList, nThreadID);
	CCamera* pCamera = m_RenderingPassCameras[nThreadID].push_back_new(rCamera);
	return pCamera;
}

///////////////////////////////////////////////////////////////////////////////
int C3DEngine::GetZoomMode() const
{
	return m_nZoomMode;
}

///////////////////////////////////////////////////////////////////////////////
float C3DEngine::GetPrevZoomFactor()
{
	return m_fPrevZoomFactor;
}

///////////////////////////////////////////////////////////////////////////////
void C3DEngine::SetZoomMode(int nZoomMode)
{
	m_nZoomMode = nZoomMode;
}

///////////////////////////////////////////////////////////////////////////////
void C3DEngine::SetPrevZoomFactor(float fZoomFactor)
{
	m_fPrevZoomFactor = fZoomFactor;
}

void C3DEngine::GetCollisionClass(SCollisionClass& collclass, int tableIndex)
{
	if ((unsigned)tableIndex < m_collisionClasses.size())
		collclass = m_collisionClasses[tableIndex];
	else
		collclass = SCollisionClass(0, 0);
}

void C3DEngine::UpdateShaderItems()
{
	if (GetMatMan())
		GetMatMan()->UpdateShaderItems();
}
///////////////////////////////////////////////////////////////////////////////
void C3DEngine::SaveInternalState(struct IDataWriteStream& writer, const AABB& filterArea, const bool bTerrain, const uint32 objectMask)
{
	ITerrain* pTerrain = GetITerrain();
	IVisAreaManager* pVisAreaManager = GetIVisAreaManager();
	if ((NULL != pTerrain) && (NULL != pVisAreaManager))
	{
		const uint8 terrainMask = bTerrain ? 1 : 0;

		// set export parameters
		SHotUpdateInfo info;
		info.nHeigtmap = bTerrain ? 1 : 0;
		info.nObjTypeMask = objectMask;
		info.areaBox = filterArea;
		info.pVisibleLayerMask = NULL; // not used during saving
		int objectCompiledDataSize = 0;
		int terrainCompiledDataSize = pTerrain->GetCompiledDataSize(&info);
		if (terrainCompiledDataSize > 0)
		{
			std::vector<uint8> outputData;
			outputData.resize(terrainCompiledDataSize);

			std::vector<struct IStatObj*>* pTempBrushTable = NULL;
			std::vector<struct IMaterial*>* pTempMatsTable = NULL;
			std::vector<struct IStatInstGroup*>* pTempVegGroupTable = NULL;

			pTerrain->GetCompiledData(
				&outputData[0],
				terrainCompiledDataSize,
				&pTempBrushTable,
				&pTempMatsTable,
				&pTempVegGroupTable,
				eLittleEndian,
				&info);

			if (pTempBrushTable && pTempMatsTable && (objectMask != 0))
			{
				// VisAreas: we need this here for things depending on pTempBrushTable and pTempMatsTable
				objectCompiledDataSize = pVisAreaManager->GetCompiledDataSize(&info);
				if (objectCompiledDataSize > 0)
				{
					outputData.resize(objectCompiledDataSize + terrainCompiledDataSize);

					pVisAreaManager->GetCompiledData(
						&outputData[terrainCompiledDataSize],
						objectCompiledDataSize,
						&pTempBrushTable,
						&pTempMatsTable,
						&pTempVegGroupTable,
						eLittleEndian,
						&info);
				}
			}

			// store the data
			writer << terrainMask;
			writer << objectMask;
			writer << info.areaBox.min.x;
			writer << info.areaBox.min.y;
			writer << info.areaBox.min.z;
			writer << info.areaBox.max.x;
			writer << info.areaBox.max.y;
			writer << info.areaBox.max.z;
			writer << terrainCompiledDataSize;
			writer << objectCompiledDataSize;
			writer << outputData;
		}
	}
}

///////////////////////////////////////////////////////////////////////////////
void C3DEngine::LoadInternalState(struct IDataReadStream& reader, const uint8* pVisibleLayersMask, const uint16* pLayerIdTranslation)
{
	SHotUpdateInfo info;
	info.nHeigtmap = reader.ReadUint8();
	info.nObjTypeMask = reader.ReadUint32();
	info.areaBox.min.x = reader.ReadFloat();
	info.areaBox.min.y = reader.ReadFloat();
	info.areaBox.min.z = reader.ReadFloat();
	info.areaBox.max.x = reader.ReadFloat();
	info.areaBox.max.y = reader.ReadFloat();
	info.areaBox.max.z = reader.ReadFloat();
	info.pVisibleLayerMask = pVisibleLayersMask;
	info.pLayerIdTranslation = pLayerIdTranslation;

	const uint32 terrainDataSize = reader.ReadUint32();
	const uint32 objectDataSize = reader.ReadUint32();

	// keep the CGF resident for the duration of the update
	gEnv->p3DEngine->LockCGFResources();

	// Flush rendering thread :( another length stuff that is unfortunately needed here because it crashes without it
	gEnv->pRenderer->FlushRTCommands(true, true, true);

	std::vector<struct IStatObj*>* pStatObjTable = NULL;
	std::vector<struct IMaterial*>* pMatTable = NULL;

	// load data
	std::vector<uint8> binaryData;
	reader << binaryData;

	ITerrain* pTerrain = gEnv->p3DEngine->GetITerrain();
	if (NULL != pTerrain)
	{
		pStatObjTable = NULL;
		pMatTable = NULL;

		pTerrain->SetCompiledData(
			&binaryData[0],
			terrainDataSize,
			&pStatObjTable, &pMatTable,
			true,
			&info);
	}

	if (objectDataSize > 0)
	{
		IVisAreaManager* pVisAreaManager = gEnv->p3DEngine->GetIVisAreaManager();
		if (NULL != pVisAreaManager)
		{
			pVisAreaManager->SetCompiledData(
				&binaryData[terrainDataSize], // object data is stored after terrain data
				objectDataSize,
				&pStatObjTable,
				&pMatTable,
				true,
				&info);
		}
	}

	// release the lock on the resources
	// this will also release all unused CGF resources
	gEnv->p3DEngine->UnlockCGFResources();
}

void C3DEngine::OnCameraTeleport()
{
	//MarkRNTmpDataPoolForReset();
}

#ifndef _RELEASE

//////////////////////////////////////////////////////////////////////////
// onscreen infodebug code for e_debugDraw >= 100

//////////////////////////////////////////////////////////////////////////
void C3DEngine::AddObjToDebugDrawList(SObjectInfoToAddToDebugDrawList& objInfo)
{
	m_DebugDrawListMgr.AddObject(objInfo);
}

bool CDebugDrawListMgr::m_dumpLogRequested = false;
bool CDebugDrawListMgr::m_freezeRequested = false;
bool CDebugDrawListMgr::m_unfreezeRequested = false;
uint32 CDebugDrawListMgr::m_filter = I3DEngine::DLOT_ALL;

//////////////////////////////////////////////////////////////////////////
CDebugDrawListMgr::CDebugDrawListMgr()
{
	m_isFrozen = false;
	ClearFrameData();
	ClearConsoleCommandRequestVars();
	m_assets.reserve(32);     // just a reasonable value
	m_drawBoxes.reserve(256); // just a reasonable value
}

//////////////////////////////////////////////////////////////////////////
void CDebugDrawListMgr::ClearFrameData()
{
	m_counter = 0;
	m_assetCounter = 0;
	m_assets.clear();
	m_drawBoxes.clear();
	m_indexLeastValueAsset = 0;
	CheckFilterCVar();
}

//////////////////////////////////////////////////////////////////////////
void CDebugDrawListMgr::ClearConsoleCommandRequestVars()
{
	m_dumpLogRequested = false;
	m_freezeRequested = false;
	m_unfreezeRequested = false;
}

//////////////////////////////////////////////////////////////////////////
void CDebugDrawListMgr::AddObject(I3DEngine::SObjectInfoToAddToDebugDrawList& newObjInfo)
{
	if (m_isFrozen)
		return;

	m_lock.Lock();

	m_counter++;

	// type is not always totally determined before this point
	if (newObjInfo.pClassName)
	{
		if (strcmp(newObjInfo.pClassName, "Brush") == 0) // TODO: could not find a better way of checking if it is a brush
			newObjInfo.type = I3DEngine::DLOT_BRUSH;
		else if (strcmp(newObjInfo.pClassName, "Vegetation") == 0) // TODO: could not find a better way of checking if it is vegetation
			newObjInfo.type = I3DEngine::DLOT_VEGETATION;
	}

	if (!ShouldFilterOutObject(newObjInfo))
	{
		TAssetInfo newAsset(newObjInfo);
		TObjectDrawBoxInfo newDrawBox(newObjInfo);

		TAssetInfo* pAssetDuplicated = FindDuplicate(newAsset);
		if (pAssetDuplicated)
		{
			pAssetDuplicated->numInstances++;
			newDrawBox.assetID = pAssetDuplicated->ID;
			m_drawBoxes.push_back(newDrawBox);
			pAssetDuplicated->drawCalls = max(pAssetDuplicated->drawCalls, newAsset.drawCalls);
		}
		else
		{
			newAsset.ID = m_assetCounter;
			newDrawBox.assetID = newAsset.ID;
			bool used = false;

			// list not full, so we add
			if (m_assets.size() < uint(Cry3DEngineBase::GetCVars()->e_DebugDrawListSize))
			{
				used = true;
				m_assets.push_back(newAsset);
			}
			else // if is full, only use it if value is greater than the current minimum, and then it substitutes the lowest slot
			{
				const TAssetInfo& leastValueAsset = m_assets[m_indexLeastValueAsset];
				if (leastValueAsset < newAsset)
				{
					used = true;
					m_assets[m_indexLeastValueAsset] = newAsset;
				}
			}
			if (used)
			{
				m_assetCounter++;
				m_drawBoxes.push_back(newDrawBox);
				FindNewLeastValueAsset();
			}
		}
	}

	m_lock.Unlock();
}

//////////////////////////////////////////////////////////////////////////
CDebugDrawListMgr::TAssetInfo* CDebugDrawListMgr::FindDuplicate(const TAssetInfo& asset)
{
	std::vector<TAssetInfo>::iterator iter = m_assets.begin();
	std::vector<TAssetInfo>::const_iterator endArray = m_assets.end();

	while (iter != endArray)
	{
		TAssetInfo& currAsset = *iter;
		if (currAsset.fileName == asset.fileName)
		{
			return &currAsset;
		}
		++iter;
	}
	return NULL;
}

//////////////////////////////////////////////////////////////////////////
bool CDebugDrawListMgr::ShouldFilterOutObject(const I3DEngine::SObjectInfoToAddToDebugDrawList& object)
{
	if (m_filter == I3DEngine::DLOT_ALL)
		return false;

	return (m_filter & object.type) == 0;
}

//////////////////////////////////////////////////////////////////////////
void CDebugDrawListMgr::FindNewLeastValueAsset()
{
	uint32 size = m_assets.size();
	for (uint32 i = 0; i < size; ++i)
	{
		const TAssetInfo& currAsset = m_assets[i];
		const TAssetInfo& leastValueAsset = m_assets[m_indexLeastValueAsset];

		if (currAsset < leastValueAsset)
			m_indexLeastValueAsset = i;
	}
}

//////////////////////////////////////////////////////////////////////////
void CDebugDrawListMgr::Update()
{
	m_lock.Lock();
	if (!m_isFrozen)
		std::sort(m_assets.begin(), m_assets.end(), CDebugDrawListMgr::SortComparison);
	gEnv->pRenderer->CollectDrawCallsInfoPerNode(true);
	// it displays values from the previous frame. This mean that if it is disabled, and then enabled again later on, it will display bogus values for 1 frame...but i dont care (yet)
	float X = 10.f;
	float Y = 100.f;
	if (m_isFrozen)
		PrintText(X, Y, Col_Red, "FROZEN DEBUGINFO");
	Y += 20.f;
	PrintText(X, Y, Col_White, "total assets: %d     Ordered by:                 Showing:", m_counter);
	PrintText(X + 240, Y, Col_Yellow, GetStrCurrMode());
	TMyStandardString filterStr;
	GetStrCurrFilter(filterStr);
	PrintText(X + 420, Y, Col_Yellow, filterStr.c_str());
	Y += 20.f;
	float XName = 270;

	const char* pHeaderStr = "";
	switch (Cry3DEngineBase::GetCVars()->e_DebugDraw)
	{
	case LM_TRI_COUNT:
		pHeaderStr = "   tris  " " meshMem  " "rep  " " type        ";
		break;
	case LM_VERT_COUNT:
		pHeaderStr = "  verts  " " meshMem  " "rep  " " type        ";
		break;
	case LM_DRAWCALLS:
		pHeaderStr = "draw Calls  " "   tris  " "rep  " " type        ";
		break;
	case LM_TEXTMEM:
		pHeaderStr = "  texMem  " " meshMem  " "rep  " " type        ";
		break;
	case LM_MESHMEM:
		pHeaderStr = " meshMem  " "  texMem  " "rep  " " type        ";
		break;
	}

	PrintText(X, Y, Col_White, pHeaderStr);
	const int standardNameSize = 48;
	PrintText(XName, Y, Col_White, "Entity (class)");
	PrintText(XName + (standardNameSize + 2) * 7, Y, Col_White, "File name");

	Y += 20.f;
	for (uint32 i = 0; i < m_assets.size(); ++i)
	{
		ColorF colorLine = Col_Cyan;
		if (Cry3DEngineBase::GetCVars()->e_DebugDrawListBBoxIndex - 1 == i)
			colorLine = Col_Blue;
		const TAssetInfo& currAsset = m_assets[i];
		TMyStandardString texMemoryStr;
		TMyStandardString meshMemoryStr;
		MemToString(currAsset.texMemory, texMemoryStr);
		MemToString(currAsset.meshMemory, meshMemoryStr);

		switch (Cry3DEngineBase::GetCVars()->e_DebugDraw)
		{
		case LM_TRI_COUNT:
			PrintText(X, Y + 20.f * i, colorLine, "%7d  " "%s  " "%3d  " "%s",
			          currAsset.numTris, meshMemoryStr.c_str(), currAsset.numInstances, GetAssetTypeName(currAsset.type));
			break;
		case LM_VERT_COUNT:
			PrintText(X, Y + 20.f * i, colorLine, "%7d  " "%s  " "%3d  " "%s",
			          currAsset.numVerts, meshMemoryStr.c_str(), currAsset.numInstances, GetAssetTypeName(currAsset.type));
			break;
		case LM_DRAWCALLS:
			{
				PrintText(X, Y + 20.f * i, colorLine, "  %5d     " "%7d  " "%3d  " "%s",
				          currAsset.drawCalls, currAsset.numTris, currAsset.numInstances, GetAssetTypeName(currAsset.type));
			}
			break;
		case LM_TEXTMEM:
			PrintText(X, Y + 20.f * i, colorLine, "%s  " "%s  " "%3d  " "%s",
			          texMemoryStr.c_str(), meshMemoryStr.c_str(), currAsset.numInstances, GetAssetTypeName(currAsset.type));
			break;
		case LM_MESHMEM:
			PrintText(X, Y + 20.f * i, colorLine, "%s  " "%s  " "%3d  " "%s",
			          meshMemoryStr.c_str(), texMemoryStr.c_str(), currAsset.numInstances, GetAssetTypeName(currAsset.type));
			break;
		}

		int filenameSep = 7 * (max(standardNameSize, int(currAsset.name.length())) + 2);
		float XFileName = XName + filenameSep;

		PrintText(XName, Y + 20.f * i, colorLine, currAsset.name.c_str());
		PrintText(XFileName, Y + 20.f * i, colorLine, currAsset.fileName.c_str());
	}

	if (Cry3DEngineBase::GetCVars()->e_DebugDrawListBBoxIndex > 0 && uint(Cry3DEngineBase::GetCVars()->e_DebugDrawListBBoxIndex - 1) < m_assets.size())
	{
		const TAssetInfo& assetInfo = m_assets[Cry3DEngineBase::GetCVars()->e_DebugDrawListBBoxIndex - 1];
		uint32 numBoxesDrawn = 0;
		for (uint32 i = 0; i < m_drawBoxes.size(); ++i)
		{
			const TObjectDrawBoxInfo& drawBox = m_drawBoxes[i];
			if (drawBox.assetID == assetInfo.ID)
			{
				gEnv->pRenderer->GetIRenderAuxGeom()->DrawAABB(drawBox.bbox, drawBox.mat, true, ColorB(0, 0, 255, 100), eBBD_Faceted);
				numBoxesDrawn++;
				if (numBoxesDrawn >= assetInfo.numInstances)
					break;
			}
		}
	}

	if (m_freezeRequested)
		m_isFrozen = true;
	if (m_unfreezeRequested)
		m_isFrozen = false;
	if (m_dumpLogRequested)
		DumpLog();

	ClearConsoleCommandRequestVars();

	if (!m_isFrozen)
	{
		ClearFrameData();
		m_assets.reserve(Cry3DEngineBase::GetCVars()->e_DebugDrawListSize);
	}
	m_lock.Unlock();
}

//////////////////////////////////////////////////////////////////////////
void CDebugDrawListMgr::PrintText(float x, float y, const ColorF& fColor, const char* label_text, ...)
{
	va_list args;
	va_start(args, label_text);
	IRenderAuxText::DrawText(Vec3(x, y, 0.5f), 1.2f, fColor, eDrawText_2D | eDrawText_FixedSize | eDrawText_Monospace, label_text, args);
	va_end(args);
}

//////////////////////////////////////////////////////////////////////////
void CDebugDrawListMgr::MemToString(uint32 memVal, TMyStandardString& outStr)
{
	if (memVal < 1024 * 1024)
		outStr.Format("%5.1f kb", memVal / (1024.f));
	else
		outStr.Format("%5.1f MB", memVal / (1024.f * 1024.f));
}

//////////////////////////////////////////////////////////////////////////
bool CDebugDrawListMgr::TAssetInfo::operator<(const TAssetInfo& other) const
{
	switch (Cry3DEngineBase::GetCVars()->e_DebugDraw)
	{
	case LM_TRI_COUNT:
		return (numTris < other.numTris);

	case LM_VERT_COUNT:
		return (numVerts < other.numVerts);

	case LM_DRAWCALLS:
		return (drawCalls < other.drawCalls);

	case LM_TEXTMEM:
		return (texMemory < other.texMemory);

	case LM_MESHMEM:
		return (meshMemory < other.meshMemory);

	default:
		assert(false);
		return false;
	}
}

//////////////////////////////////////////////////////////////////////////
CDebugDrawListMgr::TAssetInfo::TAssetInfo(const I3DEngine::SObjectInfoToAddToDebugDrawList& objInfo)
{
	type = objInfo.type;
	if (!objInfo.pClassName)
	{
		// custom functions to avoid any heap allocation
		MyString_Assign(name, objInfo.pName);
		MyStandardString_Concatenate(name, "(");
		MyStandardString_Concatenate(name, objInfo.pClassName);
		MyStandardString_Concatenate(name, ")");
	}

	MyFileNameString_Assign(fileName, objInfo.pFileName);

	numTris = objInfo.numTris;
	numVerts = objInfo.numVerts;
	texMemory = objInfo.texMemory;
	meshMemory = objInfo.meshMemory;
	drawCalls = gEnv->pRenderer->GetDrawCallsPerNode(objInfo.pRenderNode);
	numInstances = 1;
	ID = UNDEFINED_ASSET_ID;
}

//////////////////////////////////////////////////////////////////////////
CDebugDrawListMgr::TObjectDrawBoxInfo::TObjectDrawBoxInfo(const I3DEngine::SObjectInfoToAddToDebugDrawList& objInfo)
{
	mat.SetIdentity();
	bbox.Reset();
	if (objInfo.pMat)
		mat = *objInfo.pMat;
	if (objInfo.pBox)
		bbox = *objInfo.pBox;
	assetID = UNDEFINED_ASSET_ID;
}

//////////////////////////////////////////////////////////////////////////
void CDebugDrawListMgr::MyStandardString_Concatenate(TMyStandardString& outStr, const char* pStr)
{
	if (pStr && outStr.length() < outStr.capacity())
	{
		outStr._ConcatenateInPlace(pStr, min(strlen(pStr), outStr.capacity() - outStr.length()));
	}
}

//////////////////////////////////////////////////////////////////////////
void CDebugDrawListMgr::MyFileNameString_Assign(TFilenameString& outStr, const char* pStr)
{
	char tempBuf[outStr.MAX_SIZE + 1];

	uint32 outInd = 0;
	if (pStr)
	{
		while (*pStr != 0 && outInd < outStr.MAX_SIZE)
		{
			tempBuf[outInd] = *pStr;
			outInd++;
			if (*pStr == '%' && outInd < outStr.MAX_SIZE)
			{
				tempBuf[outInd] = '%';
				outInd++;
			}
			pStr++;
		}
	}
	tempBuf[outInd] = 0;
	outStr = tempBuf;
}

//////////////////////////////////////////////////////////////////////////
void CDebugDrawListMgr::ConsoleCommand(IConsoleCmdArgs* args)
{
	if (args->GetArgCount() > 1 && args->GetArg(1))
	{
		switch (toupper(args->GetArg(1)[0]))
		{
		case 'F':
			m_freezeRequested = true;
			break;
		case 'C':
			m_unfreezeRequested = true;
			break;
		case 'D':
			m_dumpLogRequested = true;
			break;
		}
	}
}

//////////////////////////////////////////////////////////////////////////
void CDebugDrawListMgr::CheckFilterCVar()
{
	ICVar* pCVar = gEnv->pConsole->GetCVar("e_debugdrawlistfilter");

	if (!pCVar)
		return;

	const char* pVal = pCVar->GetString();

	if (pVal && strcmpi(pVal, "all") == 0)
	{
		m_filter = I3DEngine::DLOT_ALL;
		return;
	}

	m_filter = 0;
	while (pVal && pVal[0])
	{
		switch (toupper(pVal[0]))
		{
		case 'B':
			m_filter |= I3DEngine::DLOT_BRUSH;
			break;
		case 'V':
			m_filter |= I3DEngine::DLOT_VEGETATION;
			break;
		case 'C':
			m_filter |= I3DEngine::DLOT_CHARACTER;
			break;
		case 'S':
			m_filter |= I3DEngine::DLOT_STATOBJ;
			break;
		}
		++pVal;
	}
}

//////////////////////////////////////////////////////////////////////////
void CDebugDrawListMgr::DumpLog()
{
	TMyStandardString filterStr;
	GetStrCurrFilter(filterStr);
	CryLog("--------------------------------------------------------------------------------");
	CryLog("                           DebugDrawList infodebug");
	CryLog("--------------------------------------------------------------------------------");
	CryLog(" total objects: %d    Ordered by: %s     Showing: %s", m_counter, GetStrCurrMode(), filterStr.c_str());
	CryLog("");
	CryLog("   tris      verts   draw Calls   texMem     meshMem    type");
	CryLog(" -------   --------  ----------  --------   --------  ----------");
	for (uint32 i = 0; i < m_assets.size(); ++i)
	{
		const TAssetInfo& currAsset = m_assets[i];
		TMyStandardString texMemoryStr;
		TMyStandardString meshMemoryStr;
		MemToString(currAsset.texMemory, texMemoryStr);
		MemToString(currAsset.meshMemory, meshMemoryStr);
		CryLog("%8d  %8d     %5d     %s   %s  %s      %s    %s", currAsset.numTris, currAsset.numVerts, currAsset.drawCalls,
		       texMemoryStr.c_str(), meshMemoryStr.c_str(), GetAssetTypeName(currAsset.type), currAsset.name.c_str(), currAsset.fileName.c_str());
	}
	CryLog("--------------------------------------------------------------------------------");
}

//////////////////////////////////////////////////////////////////////////
const char* CDebugDrawListMgr::GetStrCurrMode()
{
	const char* pModesNames[] =
	{
		"Tri count",
		"Vert count",
		"Draw calls",
		"Texture memory",
		"Mesh memory"
	};

	uint32 index = Cry3DEngineBase::GetCVars()->e_DebugDraw - LM_BASENUMBER;
	uint32 numElems = sizeof(pModesNames) / sizeof *(pModesNames);
	if (index < numElems)
		return pModesNames[index];
	else
		return "<UNKNOWN>";
}

//////////////////////////////////////////////////////////////////////////
void CDebugDrawListMgr::GetStrCurrFilter(TMyStandardString& strOut)
{
	const char* pFilterNames[] =
	{
		"",
		"Brushes",
		"Vegetation",
		"Characters",
		"StatObjs"
	};

	uint32 numElems = sizeof(pFilterNames) / sizeof *(pFilterNames);
	for (uint32 i = 1, bitVal = 1; i < numElems; ++i)
	{
		if ((bitVal & m_filter) != 0)
		{
			if (strOut.size() > 0)
				strOut += "+";
			strOut += pFilterNames[i];
		}
		bitVal *= 2;
	}

	if (strOut.size() == 0)
		strOut = "ALL";
}

//////////////////////////////////////////////////////////////////////////
const char* CDebugDrawListMgr::GetAssetTypeName(I3DEngine::EDebugDrawListAssetTypes type)
{
	const char* pNames[] =
	{
		"",
		"Brush     ",
		"Vegetation",
		"Character ",
		"StatObj   "
	};

	uint32 numElems = sizeof(pNames) / sizeof *(pNames);
	for (uint32 i = 1, bitVal = 1; i < numElems; ++i)
	{
		if (bitVal == type)
			return pNames[i];
		bitVal *= 2;
	}

	return "<UNKNOWN>";
}

#endif //RELEASE

///////////////////////////////////////////////////////////////////////////////
float C3DEngine::GetWaterLevel()
{
	return m_pTerrain ? m_pTerrain->CTerrain::GetWaterLevel() : WATER_LEVEL_UNKNOWN;
}

///////////////////////////////////////////////////////////////////////////////
Vec3 C3DEngine::GetSkyColor() const
{
	return m_pObjManager ? m_pObjManager->m_vSkyColor : Vec3(0, 0, 0);
}

///////////////////////////////////////////////////////////////////////////////
bool C3DEngine::IsTessellationAllowed(const CRenderObject* pObj, const SRenderingPassInfo& passInfo, bool bIgnoreShadowPass) const
{
#ifdef MESH_TESSELLATION_ENGINE
	assert(pObj && GetCVars());
	bool rendererTessellation;
	GetRenderer()->EF_Query(EFQ_MeshTessellation, rendererTessellation);
	if (pObj->m_fDistance < GetCVars()->e_TessellationMaxDistance
	    && GetCVars()->e_Tessellation
	    && rendererTessellation)
	{
		bool bAllowTessellation = true;

		// Check if rendering into shadow map and enable tessellation only if allowed
		if (!bIgnoreShadowPass && passInfo.IsShadowPass())
		{
			if (IsTessellationAllowedForShadowMap(passInfo))
			{
				// NOTE: This might be useful for game projects
				// Use tessellation only for objects visible in main view
				// Shadows will switch to non-tessellated when caster gets out of view
				IRenderNode* pRN = (IRenderNode*)pObj->m_pRenderNode;
				if (pRN)
					bAllowTessellation = ((pRN->GetRenderNodeType() != eERType_TerrainSector) && (pRN->GetDrawFrame() > passInfo.GetFrameID() - 10));
			}
			else
				bAllowTessellation = false;
		}

		return bAllowTessellation;
	}
#endif   //#ifdef MESH_TESSELLATION_ENGINE

	return false;
}

bool C3DEngine::IsStatObjBufferRenderTasksAllowed() const
{
	return !!GetCVars()->e_StatObjBufferRenderTasks;
}

///////////////////////////////////////////////////////////////////////////////
void C3DEngine::RenderRenderNode_ShadowPass(IShadowCaster* pShadowCaster, const SRenderingPassInfo& passInfo)
{
	CRY_ASSERT(passInfo.IsShadowPass());

	IRenderNode* pRenderNode = static_cast<IRenderNode*>(pShadowCaster);

	int nStaticObjectLod = -1;
	if (passInfo.GetShadowMapType() == SRenderingPassInfo::SHADOW_MAP_CACHED)
		nStaticObjectLod = GetCVars()->e_ShadowsCacheObjectLod;
	else if (passInfo.GetShadowMapType() == SRenderingPassInfo::SHADOW_MAP_CACHED_MGPU_COPY)
	{
		CRY_ASSERT(passInfo.ShadowCacheLod() < MAX_GSM_CACHED_LODS_NUM);
		nStaticObjectLod = pRenderNode->m_shadowCacheLod[passInfo.ShadowCacheLod()];
	}
	SRenderNodeTempData* pTempData = Get3DEngine()->CheckAndCreateRenderNodeTempData(pRenderNode, passInfo);
	if (!pTempData)
		return;

	int wantedLod = pTempData->userData.nWantedLod;
	if (pRenderNode->GetShadowLodBias() != IRenderNode::SHADOW_LODBIAS_DISABLE)
	{
		if (passInfo.IsShadowPass() && (pRenderNode->GetDrawFrame(0) < (passInfo.GetFrameID() - 10)))
			wantedLod += GetCVars()->e_ShadowsLodBiasInvis;
		wantedLod += GetCVars()->e_ShadowsLodBiasFixed;
		wantedLod += pRenderNode->GetShadowLodBias();
	}

	if (nStaticObjectLod >= 0)
		wantedLod = nStaticObjectLod;

	switch (pRenderNode->GetRenderNodeType())
	{
	case eERType_Vegetation:
		{
			CVegetation* pVegetation = static_cast<CVegetation*>(pRenderNode);
			const CLodValue lodValue = pVegetation->ComputeLod(wantedLod, passInfo);
			pVegetation->Render(passInfo, lodValue, NULL);
		}
		break;
	case eERType_Brush:
	case eERType_MovableBrush:
		{
			CBrush* pBrush = static_cast<CBrush*>(pRenderNode);
			const CLodValue lodValue = pBrush->ComputeLod(wantedLod, passInfo);
			pBrush->Render(lodValue, passInfo, NULL);
		}
		break;
	default:
		{
			const Vec3 vCamPos = passInfo.GetCamera().GetPosition();
			const AABB objBox = pRenderNode->GetBBox();
			SRendParams rParams;
			rParams.fDistance = sqrt_tpl(Distance::Point_AABBSq(vCamPos, objBox)) * passInfo.GetZoomFactor();
			rParams.lodValue = pRenderNode->ComputeLod(wantedLod, passInfo);

			pRenderNode->Render(rParams, passInfo);
		}
		break;
	}
}

///////////////////////////////////////////////////////////////////////////////
ITimeOfDay* C3DEngine::GetTimeOfDay()
{
	CTimeOfDay* tod = m_pTimeOfDay;

	if (!tod)
	{
		tod = new CTimeOfDay;
		m_pTimeOfDay = tod;
	}

	return tod;
}

///////////////////////////////////////////////////////////////////////////////
void C3DEngine::TraceFogVolumes(const Vec3& worldPos, ColorF& fogVolumeContrib, const SRenderingPassInfo& passInfo)
{
	CFogVolumeRenderNode::TraceFogVolumes(worldPos, fogVolumeContrib, passInfo);
}

///////////////////////////////////////////////////////////////////////////////
int C3DEngine::GetTerrainSize()
{
	return CTerrain::GetTerrainSize();
}
#include "ParticleEmitter.h"

///////////////////////////////////////////////////////////////////////////////
void C3DEngine::AsyncOctreeUpdate(IRenderNode* pEnt, uint32 nFrameID, bool bUnRegisterOnly)
{
	FUNCTION_PROFILER_3DENGINE;

#ifdef _DEBUG   // crash test basically
	const char* szClass = pEnt->GetEntityClassName();
	const char* szName = pEnt->GetName();
	if (!szName[0] && !szClass[0])
		Warning("I3DEngine::RegisterEntity: Entity undefined"); // do not register undefined objects
#endif

	IF (bUnRegisterOnly, 0)
	{
		UnRegisterEntityImpl(pEnt);
		return;
	}

	const AABB aabb = pEnt->GetBBox();
	float fObjRadiusSqr = aabb.GetRadiusSqr();
	EERType eERType = pEnt->GetRenderNodeType();

#ifdef SUPP_HMAP_OCCL
	if (SRenderNodeTempData* pTempData = pEnt->m_pTempData)
		pTempData->userData.m_OcclState.vLastVisPoint.Set(0, 0, 0);
#endif

	UpdateObjectsLayerAABB(pEnt);

	auto dwRndFlags = pEnt->GetRndFlags();

	if (m_bIntegrateObjectsIntoTerrain && eERType == eERType_MovableBrush && pEnt->GetGIMode() == IRenderNode::eGM_IntegrateIntoTerrain)
	{
		// update meshes integrated into terrain
		GetTerrain()->ResetTerrainVertBuffers(&aabb);
	}

	if (!(dwRndFlags & ERF_RENDER_ALWAYS) && !(dwRndFlags & ERF_CASTSHADOWMAPS))
		if (GetCVars()->e_ObjFastRegister && pEnt->GetParent() && ((COctreeNode*)pEnt->GetParent())->IsRightNode(aabb, fObjRadiusSqr, pEnt->m_fWSMaxViewDist))
		{
			// same octree node
			Vec3 vEntCenter = GetEntityRegisterPoint(pEnt);

			IVisArea* pVisArea = pEnt->GetEntityVisArea();
			if (pVisArea && pVisArea->IsPointInsideVisArea(vEntCenter))
				return; // same visarea

			IVisArea* pVisAreaFromPos = (!m_pVisAreaManager || dwRndFlags & ERF_OUTDOORONLY) ? NULL : GetVisAreaManager()->GetVisAreaFromPos(vEntCenter);
			if (pVisAreaFromPos == pVisArea)
			{
				// NOTE: can only get here when pVisArea==NULL due to 'same visarea' check above. So check for changed clip volume
				if (GetClipVolumeManager()->IsClipVolumeRequired(pEnt))
					GetClipVolumeManager()->UpdateEntityClipVolume(vEntCenter, pEnt);

				return; // same visarea or same outdoor
			}
		}

	if (pEnt->GetParent())
	{
		UnRegisterEntityImpl(pEnt);
	}
	else if (GetCVars()->e_StreamCgf && pEnt->IsAllocatedOutsideOf3DEngineDLL())
	{
		//  Temporary solution: Force streaming priority update for objects that was not registered before
		//  and was not visible before since usual prediction system was not able to detect them

		if (!pEnt->IsHidden() && (uint32)pEnt->GetDrawFrame(0) < nFrameID - 16)
		{
			// defer the render node streaming priority update still we have a correct 3D Engine camera
			int nElementID = m_deferredRenderProxyStreamingPriorityUpdates.Find(pEnt);
			if (nElementID == -1)  // only add elements once
				m_deferredRenderProxyStreamingPriorityUpdates.push_back(pEnt);
		}

	}

	if (eERType == eERType_Vegetation)
	{
		CVegetation* pInst = (CVegetation*)pEnt;
		pInst->UpdateRndFlags();
	}
	else if (eERType == eERType_Decal)
	{
		// register decals, to clean up longer not renders decals and their render meshes
		m_decalRenderNodes.push_back((IDecalRenderNode*)pEnt);
	}

	pEnt->m_fWSMaxViewDist = pEnt->GetMaxViewDist();

	//////////////////////////////////////////////////////////////////////////
	// Check for occlusion proxy.
	{
		CStatObj* pStatObj = (CStatObj*)pEnt->GetEntityStatObj();
		if (pStatObj)
		{
			if (pStatObj->m_bHaveOcclusionProxy)
			{
				pEnt->SetRndFlags(ERF_GOOD_OCCLUDER, true);
				pEnt->m_nInternalFlags |= IRenderNode::HAS_OCCLUSION_PROXY;
			}
		}
	}

	if (eERType != eERType_Light)
	{
		if (fObjRadiusSqr > sqr(MAX_VALID_OBJECT_VOLUME) || !_finite(fObjRadiusSqr))
		{
			Warning("I3DEngine::RegisterEntity: Object has invalid bbox: name: %s, class name: %s, GetRadius() = %.2f",
			        pEnt->GetName(), pEnt->GetEntityClassName(), fObjRadiusSqr);
			return; // skip invalid objects - usually only objects with invalid very big scale will reach this point
		}

		if (dwRndFlags & ERF_RENDER_ALWAYS)
		{
			if (m_lstAlwaysVisible.Find(pEnt) < 0)
				m_lstAlwaysVisible.Add(pEnt);

			return;
		}
	}
	else
	{
		CLightEntity* pLight = (CLightEntity*)pEnt;
		if ((pLight->GetLightProperties().m_Flags & (DLF_IGNORES_VISAREAS | DLF_DEFERRED_LIGHT | DLF_THIS_AREA_ONLY)) == (DLF_IGNORES_VISAREAS | DLF_DEFERRED_LIGHT))
		{
			if (m_lstAlwaysVisible.Find(pEnt) < 0)
				m_lstAlwaysVisible.Add(pEnt);

			return;
		}
	}

	//////////////////////////////////////////////////////////////////////////
	if (pEnt->GetRndFlags() & ERF_OUTDOORONLY || !(m_pVisAreaManager && m_pVisAreaManager->SetEntityArea(pEnt, aabb, fObjRadiusSqr)))
	{
		if (m_pObjectsTree)
		{
			m_pObjectsTree->InsertObject(pEnt, aabb, fObjRadiusSqr, aabb.GetCenter());
		}
	}
}

///////////////////////////////////////////////////////////////////////////////
void C3DEngine::UpdateObjectsLayerAABB(IRenderNode* pEnt)
{
	uint16 nLayerId = pEnt->GetLayerId();
	if (nLayerId && nLayerId < 0xFFFF)
	{
		m_arrObjectLayersActivity.CheckAllocated(nLayerId + 1);

		if (m_arrObjectLayersActivity[nLayerId].objectsBox.GetVolume())
			m_arrObjectLayersActivity[nLayerId].objectsBox.Add(pEnt->GetBBox());
		else
			m_arrObjectLayersActivity[nLayerId].objectsBox = pEnt->GetBBox();

		m_objectLayersModificationId++;
	}
}

///////////////////////////////////////////////////////////////////////////////
bool C3DEngine::UnRegisterEntityImpl(IRenderNode* pEnt)
{
	// make sure we don't try to update the streaming priority if an object
	// was added and removed in the same frame
	int nElementID = m_deferredRenderProxyStreamingPriorityUpdates.Find(pEnt);
	if (nElementID != -1)
		m_deferredRenderProxyStreamingPriorityUpdates.DeleteFastUnsorted(nElementID);

	FUNCTION_PROFILER_3DENGINE;

#ifdef _DEBUG   // crash test basically
	const char* szClass = pEnt->GetEntityClassName();
	const char* szName = pEnt->GetName();
	if (!szName[0] && !szClass[0])
		Warning("C3DEngine::RegisterEntity: Entity undefined");
#endif

	EERType eRenderNodeType = pEnt->GetRenderNodeType();

	bool bFound = false;
	//pEnt->PhysicalizeFoliage(false);

	if (pEnt->GetParent())
		bFound = ((COctreeNode*)pEnt->GetParent())->DeleteObject(pEnt);

	if (pEnt->GetRndFlags() & ERF_RENDER_ALWAYS || (eRenderNodeType == eERType_Light) || (eRenderNodeType == eERType_FogVolume))
	{
		m_lstAlwaysVisible.Delete(pEnt);
	}

	if (eRenderNodeType == eERType_Decal)
	{
		std::vector<IDecalRenderNode*>::iterator it = std::find(m_decalRenderNodes.begin(), m_decalRenderNodes.end(), (IDecalRenderNode*)pEnt);
		if (it != m_decalRenderNodes.end())
		{
			m_decalRenderNodes.erase(it);
		}
	}

	if (pEnt->m_pTempData)
		pEnt->m_pTempData->ResetClipVolume();

	if (m_bIntegrateObjectsIntoTerrain && eRenderNodeType == eERType_MovableBrush && pEnt->GetGIMode() == IRenderNode::eGM_IntegrateIntoTerrain)
	{
		// update meshes integrated into terrain
		AABB nodeBox = pEnt->GetBBox();
		GetTerrain()->ResetTerrainVertBuffers(&nodeBox);
	}

	return bFound;
}

///////////////////////////////////////////////////////////////////////////////
Vec3 C3DEngine::GetEntityRegisterPoint(IRenderNode* pEnt)
{
	const AABB aabb = pEnt->GetBBox();

	Vec3 vPoint;

	if (pEnt->GetRndFlags() & ERF_REGISTER_BY_POSITION)
	{
		vPoint = pEnt->GetPos();
		vPoint.z += 0.25f;

		if (pEnt->GetRenderNodeType() != eERType_Light)
		{
			// check for valid position
			if (aabb.GetDistanceSqr(vPoint) > sqr(128.f))
			{
				Warning("I3DEngine::RegisterEntity: invalid entity position: Name: %s, Class: %s, Pos=(%.1f,%.1f,%.1f), BoxMin=(%.1f,%.1f,%.1f), BoxMax=(%.1f,%.1f,%.1f)",
				        pEnt->GetName(), pEnt->GetEntityClassName(),
				        pEnt->GetPos().x, pEnt->GetPos().y, pEnt->GetPos().z,
				        pEnt->GetBBox().min.x, pEnt->GetBBox().min.y, pEnt->GetBBox().min.z,
				        pEnt->GetBBox().max.x, pEnt->GetBBox().max.y, pEnt->GetBBox().max.z
				        );
			}
			// clamp by bbox
			vPoint.CheckMin(aabb.max);
			vPoint.CheckMax(aabb.min + Vec3(0, 0, .5f));
		}
	}
	else
		vPoint = aabb.GetCenter();

	return vPoint;
}

///////////////////////////////////////////////////////////////////////////////
Vec3 C3DEngine::GetSunDirNormalized() const
{
	return m_vSunDirNormalized;
}

///////////////////////////////////////////////////////////////////////////////
void C3DEngine::OnEntityDeleted(IEntity* pEntity)
{
}



================================================
FILE: Code/CryEngine/Cry3DEngine/3dEngine.h
================================================
// Copyright 2001-2019 Crytek GmbH / Crytek Group. All rights reserved.

#pragma once

#include "ColorGradingCtrl.h"
#include "LightVolumeManager.h"
#include "VisibleRenderNodeManager.h"

#include <CryCore/Containers/CryListenerSet.h>
#include <CryMemory/IMemory.h>
#include <CryThreading/IJobManager.h>
#include <CryCore/Containers/CryListenerSet.h>
#include <CryThreading/CryThreadSafePushContainer.h>

#ifdef DrawText
	#undef DrawText
#endif //DrawText

struct SNodeInfo;
struct SRNInfo;
class C3DEngineLevelLoadTimeslicer;
class CStitchedImage;
class CTimeOfDay;
class CWaterRippleManager;

struct SEntInFoliage
{
	int   id;
	float timeIdle;

	void  GetMemoryUsage(ICrySizer* pSizer) const { /*nothing*/ }
};

class CMemoryBlock : public IMemoryBlock
{
public:
	virtual void* GetData() { return m_pData; }
	virtual int   GetSize() { return m_nSize; }
	virtual ~CMemoryBlock() { delete[] m_pData; }

	CMemoryBlock() { m_pData = 0; m_nSize = 0; }
	CMemoryBlock(const void* pData, int nSize)
	{
		m_pData = 0;
		m_nSize = 0;
		SetData(pData, nSize);
	}
	void SetData(const void* pData, int nSize)
	{
		delete[] m_pData;
		m_pData = new uint8[nSize];
		memcpy(m_pData, pData, nSize);
		m_nSize = nSize;
	}
	void Free()
	{
		delete[] m_pData;
		m_pData = NULL;
		m_nSize = 0;
	}
	void Allocate(int nSize)
	{
		delete[] m_pData;
		m_pData = new uint8[nSize];
		memset(m_pData, 0, nSize);
		m_nSize = nSize;
	}

	static CMemoryBlock* CompressToMemBlock(void* pData, int nSize, ISystem* pSystem)
	{
		CMemoryBlock* pMemBlock = NULL;
		uint8* pTmp = new uint8[nSize + 4];
		size_t nComprSize = nSize;
		*(uint32*)pTmp = nSize;
		if (pSystem->CompressDataBlock(pData, nSize, pTmp + 4, nComprSize))
		{
			pMemBlock = new CMemoryBlock(pTmp, nComprSize + 4);
		}

		delete[] pTmp;
		return pMemBlock;
	}

	static CMemoryBlock* DecompressFromMemBlock(CMemoryBlock* pMemBlock, ISystem* pSystem)
	{
		size_t nUncompSize = *(uint32*)pMemBlock->GetData();
		SwapEndian(nUncompSize);
		CMemoryBlock* pResult = new CMemoryBlock;
		pResult->Allocate(nUncompSize);
		if (!pSystem->DecompressDataBlock((byte*)pMemBlock->GetData() + 4, pMemBlock->GetSize() - 4, pResult->GetData(), nUncompSize))
		{
			assert(!"CMemoryBlock::DecompressFromMemBlock failed");
			delete pResult;
			pResult = NULL;
		}

		return pResult;
	}

	uint8* m_pData;
	int    m_nSize;
};

struct SOptimizedOutdoorWindArea
{
	int              x0, x1, y0, y1; // 2d rectangle extents for the wind area
	Vec2             point[5];       // Extent points of the wind area (index 4 is center)
	Vec3             windSpeed[5];   // Wind speed at every corner and center.
	float            z;
	IPhysicalEntity* pArea;// Physical area
};

struct DLightAmount
{
	SRenderLight* pLight;
	float         fAmount;
};

struct SImageSubInfo
{
	SImageSubInfo() { memset(this, 0, sizeof(*this)); fTiling = fTilingIn = 1.f; }

	static const int nMipsNum = 4;

	union
	{
		byte* pImgMips[nMipsNum];
		int   pImgMipsSizeKeeper[8];
	};

	float fAmount;
	int   nReady;
	int   nDummy[4];

	union
	{
		IMaterial* pMat;
		int        pMatSizeKeeper[2];
	};

	int   nDim;
	float fTilingIn;
	float fTiling;
	float fSpecularAmount;
	int   nSortOrder;
	int   nAlignFix;

	AUTO_STRUCT_INFO;
};

struct SImageInfo : public Cry3DEngineBase
{
	SImageInfo()
	{
		szDetMatName[0] = szBaseTexName[0] = nPhysSurfaceType = 0;
		nLayerId = 0;
		fUseRemeshing = 0;
		fBr = 1.f;
		layerFilterColor = Col_White;
		nDetailSurfTypeId = 0;
		ZeroStruct(arrTextureId);
	}

	void GetMemoryUsage(ICrySizer* pSizer) const { /*nothing*/ }

	SImageSubInfo baseInfo;
	SImageSubInfo detailInfo;

	char          szDetMatName[128 - 20];

	int           arrTextureId[4];
	int           nPhysSurfaceType;

	char          szBaseTexName[128];

	float         fUseRemeshing;
	ColorF        layerFilterColor;
	int           nLayerId;
	float         fBr;
	int           nDetailSurfTypeId;

	int GetMemoryUsage();

	AUTO_STRUCT_INFO;
};

struct SSceneFrustum
{
	uint32*      pRgbImage;
	uint32       nRgbWidth, nRgbHeight;

	float*       pDepthImage;
	uint32       nDepthWidth, nDepthHeight;

	CCamera      camera;

	IRenderMesh* pRM;
	IMaterial*   pMaterial;

	float        fDistance;
	int          nId;

	static int   Compare(const void* v1, const void* v2)
	{
		SSceneFrustum* p[2] = { (SSceneFrustum*)v1, (SSceneFrustum*)v2 };

		if (p[0]->fDistance > p[1]->fDistance)
			return 1;
		if (p[0]->fDistance < p[1]->fDistance)
			return -1;

		if (p[0]->nId > p[1]->nId)
			return 1;
		if (p[0]->nId < p[1]->nId)
			return -1;

		return 0;
	}
};

struct SPerObjectShadow
{
	IShadowCaster* pCaster;
	float          fConstBias;
	float          fSlopeBias;
	float          fJitter;
	Vec3           vBBoxScale;
	uint           nTexSize;
};
//////////////////////////////////////////////////////////////////////

// onscreen infodebug for e_debugDraw >= 100
#ifndef _RELEASE
class CDebugDrawListMgr
{
	typedef CryFixedStringT<64>  TMyStandardString;
	typedef CryFixedStringT<128> TFilenameString;

public:

	CDebugDrawListMgr();
	void        Update();
	void        AddObject(I3DEngine::SObjectInfoToAddToDebugDrawList& objInfo);
	void        DumpLog();
	bool        IsEnabled() const { return Cry3DEngineBase::GetCVars()->e_DebugDraw >= LM_BASENUMBER; }
	static void ConsoleCommand(IConsoleCmdArgs* args);

private:

	enum { UNDEFINED_ASSET_ID = 0xffffffff };

	struct TAssetInfo
	{
		TMyStandardString                   name;
		TFilenameString                     fileName;
		uint32                              numTris;
		uint32                              numVerts;
		uint32                              texMemory;
		uint32                              meshMemory;
		uint32                              drawCalls;
		uint32                              numInstances;
		I3DEngine::EDebugDrawListAssetTypes type;
		uint32                              ID; // to identify which drawBoxes belong to this asset

		TAssetInfo(const I3DEngine::SObjectInfoToAddToDebugDrawList& objInfo);
		bool operator<(const TAssetInfo& other) const;
	};

	struct TObjectDrawBoxInfo
	{
		Matrix34 mat;
		AABB     bbox;
		uint32   assetID;

		TObjectDrawBoxInfo(const I3DEngine::SObjectInfoToAddToDebugDrawList& objInfo);
	};

	void        FindNewLeastValueAsset();
	void        ClearFrameData();
	void        ClearConsoleCommandRequestVars();
	static bool SortComparison(const TAssetInfo& A, const TAssetInfo& B) { return B < A; }
	const char* GetStrCurrMode();
	void        GetStrCurrFilter(TMyStandardString& strOut);
	bool        ShouldFilterOutObject(const I3DEngine::SObjectInfoToAddToDebugDrawList& newObject);
	void        MemToString(uint32 memVal, TMyStandardString& outStr);
	static void PrintText(float x, float y, const ColorF& fColor, const char* label_text, ...);
	const char* GetAssetTypeName(I3DEngine::EDebugDrawListAssetTypes type);
	TAssetInfo* FindDuplicate(const TAssetInfo& object);
	void        CheckFilterCVar();

	// to avoid any heap allocation
	static void                   MyStandardString_Concatenate(TMyStandardString& outStr, const char* str);
	static void                   MyFileNameString_Assign(TFilenameString& outStr, const char* pStr);

	template<class T> static void MyString_Assign(T& outStr, const char* pStr)
	{
		if (pStr)
			outStr._Assign(pStr, min(strlen(pStr), outStr.capacity()));
		else
			outStr = "";
	}

	enum EListModes
	{
		LM_BASENUMBER = 100,
		LM_TRI_COUNT  = LM_BASENUMBER,
		LM_VERT_COUNT,
		LM_DRAWCALLS,
		LM_TEXTMEM,
		LM_MESHMEM
	};

	bool                            m_isFrozen;
	uint32                          m_counter;
	uint32                          m_assetCounter;
	uint32                          m_indexLeastValueAsset;
	std::vector<TAssetInfo>         m_assets;
	std::vector<TObjectDrawBoxInfo> m_drawBoxes;
	CryCriticalSection              m_lock;

	static bool                     m_dumpLogRequested;
	static bool                     m_freezeRequested;
	static bool                     m_unfreezeRequested;
	static uint32                   m_filter;
};
#endif //_RELEASE

//////////////////////////////////////////////////////////////////////
class C3DEngine : public I3DEngine, public Cry3DEngineBase
{
	// IProcess Implementation
	void SetFlags(int flags) { m_nFlags = flags; }
	int  GetFlags(void)      { return m_nFlags; }
	int m_nFlags;

public:

	// I3DEngine interface implementation
	virtual bool             Init();
	virtual void             OnFrameStart();
	virtual void             Update();
	virtual void             RenderWorld(const int nRenderFlags, const SRenderingPassInfo& passInfo, const char* szDebugName);
	virtual void             PreWorldStreamUpdate(const CCamera& cam);
	virtual void             WorldStreamUpdate();
	virtual void             ShutDown();
	virtual void             Release() { CryAlignedDelete(this); }
	virtual void             SetLevelPath(const char* szFolderName);
	virtual bool             LoadLevel(const char* szFolderName, XmlNodeRef missionXml);
	virtual bool             StartLoadLevel(const char* szFolderName, XmlNodeRef missionXml);
	virtual bool             LoadLevel(const char* szFolderName, const char* szMissionName);
	virtual ELevelLoadStatus UpdateLoadLevelStatus();
	virtual void             UnloadLevel();
	virtual void             PostLoadLevel();
	virtual bool             InitLevelForEditor(const char* szFolderName, const char* szMissionName);
	virtual void             DisplayInfo(float& fTextPosX, float& fTextPosY, float& fTextStepY, const bool bEnhanced);
	virtual IStatObj*        LoadStatObj(const char* szFileName, const char* szGeomName = NULL, /*[Out]*/ IStatObj::SSubObject** ppSubObject = NULL, bool bUseStreaming = true, unsigned long nLoadingFlags = 0);
	virtual IStatObj*        FindStatObjectByFilename(const char* filename);
	virtual void             RegisterEntity(IRenderNode* pEnt);
	virtual void             SelectEntity(IRenderNode* pEnt);

#ifndef _RELEASE
	virtual void AddObjToDebugDrawList(SObjectInfoToAddToDebugDrawList& objInfo);
	virtual bool IsDebugDrawListEnabled() const { return m_DebugDrawListMgr.IsEnabled(); }
#endif

	virtual void   UnRegisterEntityDirect(IRenderNode* pEnt);
	virtual void   UnRegisterEntityAsJob(IRenderNode* pEnt);

	virtual void   AddWaterRipple(const Vec3& vPos, float scale, float strength);

	virtual bool   IsUnderWater(const Vec3& vPos) const;
	virtual void   SetOceanRenderFlags(uint8 nFlags);
	virtual uint8  GetOceanRenderFlags() const { return m_nOceanRenderFlags; }
	virtual uint32 GetOceanVisiblePixelsCount() const;
	virtual float  GetBottomLevel(const Vec3& referencePos, float maxRelevantDepth, int objtypes);
	virtual float  GetBottomLevel(const Vec3& referencePos, float maxRelevantDepth /* = 10.0f*/);
	virtual float  GetBottomLevel(const Vec3& referencePos, int objflags);

#if defined(USE_GEOM_CACHES)
	virtual IGeomCache* LoadGeomCache(const char* szFileName);
	virtual IGeomCache* FindGeomCacheByFilename(const char* szFileName);
#endif

	virtual IStatObj* LoadDesignerObject(int nVersion, const char* szBinaryStream, int size);

	void              AsyncOctreeUpdate(IRenderNode* pEnt, uint32 nFrameID, bool bUnRegisterOnly);
	bool              UnRegisterEntityImpl(IRenderNode* pEnt);
	virtual void      UpdateObjectsLayerAABB(IRenderNode* pEnt);

	// Fast option - use if just ocean height required
	virtual float                    GetWaterLevel();
	// This will return ocean height or water volume height, optional for accurate water height query
	virtual float                    GetWaterLevel(const Vec3* pvPos, IPhysicalEntity* pent = NULL, bool bAccurate = false);
	// Only use for Accurate query - this will return exact ocean height
	virtual float                    GetAccurateOceanHeight(const Vec3& pCurrPos) const;

	virtual Vec4                     GetCausticsParams() const;
	virtual Vec4                     GetOceanAnimationCausticsParams() const;
	virtual void                     GetOceanAnimationParams(Vec4& pParams0, Vec4& pParams1) const;
	virtual void                     GetHDRSetupParams(Vec4 pParams[5]) const;
	virtual void                     CreateDecal(const CryEngineDecalInfo& Decal);
	virtual void                     DrawFarTrees(const SRenderingPassInfo& passInfo);
	virtual void                     GenerateFarTrees(const SRenderingPassInfo& passInfo);
	virtual float                    GetTerrainElevation(float x, float y);
	virtual float                    GetTerrainElevation3D(Vec3 vPos);
	virtual float                    GetTerrainZ(float x, float y);
	virtual bool                     GetTerrainHole(float x, float y);
	virtual float                    GetHeightMapUnitSize();
	virtual int                      GetTerrainSize();
	virtual void                     SetSunDir(const Vec3& newSunOffset);
	virtual Vec3                     GetSunDir() const;
	virtual Vec3                     GetSunDirNormalized() const;
	virtual Vec3                     GetRealtimeSunDirNormalized() const;
	virtual void                     SetSkyColor(Vec3 vColor);
	virtual void                     SetSunColor(Vec3 vColor);
	virtual void                     SetSkyBrightness(float fMul);
	virtual void                     SetSSAOAmount(float fMul);
	virtual void                     SetSSAOContrast(float fMul);
	virtual void                     SetGIAmount(float fMul);
	virtual float                    GetSunRel() const;
	virtual void                     SetRainParams(const SRainParams& rainParams);
	virtual bool                     GetRainParams(SRainParams& rainParams);
	virtual void                     SetSnowSurfaceParams(const Vec3& vCenter, float fRadius, float fSnowAmount, float fFrostAmount, float fSurfaceFreezing);
	virtual bool                     GetSnowSurfaceParams(Vec3& vCenter, float& fRadius, float& fSnowAmount, float& fFrostAmount, float& fSurfaceFreezing);
	virtual void                     SetSnowFallParams(int nSnowFlakeCount, float fSnowFlakeSize, float fSnowFallBrightness, float fSnowFallGravityScale, float fSnowFallWindScale, float fSnowFallTurbulence, float fSnowFallTurbulenceFreq);
	virtual bool                     GetSnowFallParams(int& nSnowFlakeCount, float& fSnowFlakeSize, float& fSnowFallBrightness, float& fSnowFallGravityScale, float& fSnowFallWindScale, float& fSnowFallTurbulence, float& fSnowFallTurbulenceFreq);
	virtual void                     OnExplosion(Vec3 vPos, float fRadius, bool bDeformTerrain = true);
	//! For editor
	virtual void                     RemoveAllStaticObjects();
	virtual void                     SetTerrainSurfaceType(int x, int y, int nType);
	virtual void                     SetTerrainSectorTexture(const int nTexSectorX, const int nTexSectorY, unsigned int textureId);
	virtual void                     SetPhysMaterialEnumerator(IPhysMaterialEnumerator* pPhysMaterialEnumerator);
	virtual IPhysMaterialEnumerator* GetPhysMaterialEnumerator();
	virtual void                     LoadMissionDataFromXMLNode(const char* szMissionName);

	void                             AddDynamicLightSource(const SRenderLight& LSource, ILightSource* pEnt, int nEntityLightId, float fFadeout, const SRenderingPassInfo& passInfo);

	inline void                      AddLightToRenderer(const SRenderLight& light, float fMult, const SRenderingPassInfo& passInfo)
	{
		const uint32 nLightID = passInfo.GetIRenderView()->GetLightsCount(eDLT_DeferredLight);
		//passInfo.GetIRenderView()->AddLight(eDLT_DeferredLight,light);
		GetRenderer()->EF_AddDeferredLight(light, fMult, passInfo);
		Get3DEngine()->m_LightVolumesMgr.RegisterLight(light, nLightID, passInfo);

		if (light.m_Flags & DLF_DEFERRED_CUBEMAPS)
			m_nDeferredProbesNum++;
		else
			m_nDeferredLightsNum++;
	}

	virtual void                 ApplyForceToEnvironment(Vec3 vPos, float fRadius, float fAmountOfForce);
	virtual void                 SetMaxViewDistanceScale(float fScale) { m_fMaxViewDistScale = fScale; }
	virtual float                GetMaxViewDistance(bool bScaled = true);
	virtual const SFrameLodInfo& GetFrameLodInfo() const               { return m_frameLodInfo; }
	virtual void                 SetFrameLodInfo(const SFrameLodInfo& frameLodInfo);
	virtual void                 SetFogColor(const Vec3& vFogColor);
	virtual Vec3                 GetFogColor();
	virtual float                GetDistanceToSectorWithWater();

	virtual void                 GetSkyLightParameters(Vec3& sunDir, Vec3& sunIntensity, float& Km, float& Kr, float& g, Vec3& rgbWaveLengths);
	virtual void                 SetSkyLightParameters(const Vec3& sunDir, const Vec3& sunIntensity, float Km, float Kr, float g, const Vec3& rgbWaveLengths, bool forceImmediateUpdate = false);

	void                         SetLightsHDRDynamicPowerFactor(const float value);
	virtual float                GetLightsHDRDynamicPowerFactor() const;

	// Return true if tessellation is allowed (by cvars) into currently set shadow map LOD
	bool                                   IsTessellationAllowedForShadowMap(const SRenderingPassInfo& passInfo) const;
	// Return true if tessellation is allowed for given render object
	virtual bool                           IsTessellationAllowed(const CRenderObject* pObj, const SRenderingPassInfo& passInfo, bool bIgnoreShadowPass = false) const;

	virtual bool                           IsStatObjBufferRenderTasksAllowed() const;

	virtual void                           SetRenderNodeMaterialAtPosition(EERType eNodeType, const Vec3& vPos, IMaterial* pMat);
	virtual void                           OverrideCameraPrecachePoint(const Vec3& vPos);
	virtual int                            AddPrecachePoint(const Vec3& vPos, const Vec3& vDir, float fTimeOut = 3.f, float fImportanceFactor = 1.0f);
	virtual void                           ClearPrecachePoint(int id);
	virtual void                           ClearAllPrecachePoints();
	virtual void                           GetPrecacheRoundIds(int pRoundIds[MAX_STREAM_PREDICTION_ZONES]);

	virtual void                           TraceFogVolumes(const Vec3& worldPos, ColorF& fogVolumeContrib, const SRenderingPassInfo& passInfo);

	virtual Vec3                           GetSkyColor() const;
	virtual Vec3                           GetSunColor() const;
	virtual float                          GetSkyBrightness() const;
	virtual float                          GetSSAOAmount() const;
	virtual float                          GetSSAOContrast() const;
	virtual float                          GetGIAmount() const;
	virtual float                          GetTerrainTextureMultiplier() const;

	virtual Vec3                           GetAmbientColorFromPosition(const Vec3& vPos, float fRadius = 1.f);
	virtual void                           FreeRenderNodeState(IRenderNode* pEnt);
	virtual const char*                    GetLevelFilePath(const char* szFileName);
	virtual void                           SetTerrainBurnedOut(int x, int y, bool bBurnedOut);
	virtual bool                           IsTerrainBurnedOut(int x, int y);
	virtual int                            GetTerrainSectorSize();
	virtual void                           LoadTerrainSurfacesFromXML(XmlNodeRef pDoc, bool bUpdateTerrain);
	virtual bool                           SetStatInstGroup(int nGroupId, const IStatInstGroup& siGroup);
	virtual bool                           GetStatInstGroup(int nGroupId, IStatInstGroup& siGroup);
	virtual void                           ActivatePortal(const Vec3& vPos, bool bActivate, const char* szEntityName);
	virtual void                           ActivateOcclusionAreas(IVisAreaTestCallback* pTest, bool bActivate);
	virtual void                           GetMemoryUsage(ICrySizer* pSizer) const;
	virtual void                           GetResourceMemoryUsage(ICrySizer* pSizer, const AABB& cstAABB);
	virtual IVisArea*                      CreateVisArea(uint64 visGUID);
	virtual void                           DeleteVisArea(IVisArea* pVisArea);
	virtual void                           UpdateVisArea(IVisArea* pArea, const Vec3* pPoints, int nCount, const char* szName,
	                                                     const SVisAreaInfo& info, bool bReregisterObjects);
	virtual IClipVolume*                   CreateClipVolume();
	virtual void                           DeleteClipVolume(IClipVolume* pClipVolume);
	virtual void                           UpdateClipVolume(IClipVolume* pClipVolume, _smart_ptr<IRenderMesh> pRenderMesh, IBSPTree3D* pBspTree, const Matrix34& worldTM, uint8 viewDistRatio, bool bActive, uint32 flags, const char* szName);
	virtual void                           ResetParticlesAndDecals();
	virtual void                           ResetTemporalCaches();
	virtual IRenderNode*                   CreateRenderNode(EERType type);
	virtual void                           DeleteRenderNode(IRenderNode* pRenderNode);
	void                                   TickDelayedRenderNodeDeletion();
	virtual void                           SetWind(const Vec3& vWind);
	virtual Vec3                           GetWind(const AABB& box, bool bIndoors) const;
	virtual void                           AddForcedWindArea(const Vec3& vPos, float fAmountOfForce, float fRadius);

	void                                   StartWindGridJob(const Vec3& vPos);
	void                                   FinishWindGridJob();
	void                                   UpdateWindGridJobEntry(Vec3 vPos);
	void                                   UpdateWindGridArea(SWindGrid& rWindGrid, const SOptimizedOutdoorWindArea& windArea, const AABB& windBox);
	void                                   RasterWindAreas(std::vector<SOptimizedOutdoorWindArea>* pWindAreas, float fElapsedTime);
	void                                   RasterGlobalWind(const Vec3& vGlobalWind, float fElapsedTime, bool bReset);

	virtual Vec3                           GetGlobalWind(bool bIndoors) const;
	virtual bool                           SampleWind(Vec3* pSamples, int nSamples, const AABB& volume, bool bIndoors) const;
	virtual IBreezeGenerator*              GetBreezeGenerator() const;
	virtual IVisArea*                      GetVisAreaFromPos(const Vec3& vPos) const;
	virtual bool                           IntersectsVisAreas(const AABB& box, void** pNodeCache = 0) const;
	virtual bool                           ClipToVisAreas(IVisArea* pInside, Sphere& sphere, Vec3 const& vNormal, void* pNodeCache = 0);
	virtual bool                           IsVisAreasConnected(IVisArea* pArea1, IVisArea* pArea2, int nMaxReqursion, bool bSkipDisabledPortals);
	void                                   EnableOceanRendering(bool bOcean); // todo: remove

	virtual struct ILightSource*           CreateLightSource();
	virtual void                           DeleteLightSource(ILightSource* pLightSource);
	virtual bool                           IsTerrainHightMapModifiedByGame();
	virtual bool                           RestoreTerrainFromDisk();
	virtual void                           CheckMemoryHeap();
	virtual void                           CloseTerrainTextureFile();
	virtual int                            GetLoadedObjectCount();
	virtual void                           GetLoadedStatObjArray(IStatObj** pObjectsArray, int& nCount);
	virtual void                           GetObjectsStreamingStatus(SObjectsStreamingStatus& outStatus);
	virtual void                           GetStreamingSubsystemData(int subsystem, SStremaingBandwidthData& outData);
	virtual void                           DeleteEntityDecals(IRenderNode* pEntity);
	virtual void                           DeleteDecalsInRange(AABB* pAreaBox, IRenderNode* pEntity);
	virtual void                           CompleteObjectsGeometry();
	virtual void                           LockCGFResources();
	virtual void                           UnlockCGFResources();

	virtual void                           SerializeState(TSerialize ser);
	virtual void                           PostSerialize(bool bReading);

	virtual void                           SetHeightMapMaxHeight(float fMaxHeight);

	virtual void                           SetStreamableListener(IStreamedObjectListener* pListener);

	//////////////////////////////////////////////////////////////////////////
	// Materials access.
	virtual IMaterialHelpers& GetMaterialHelpers();
	virtual IMaterialManager* GetMaterialManager();
	//////////////////////////////////////////////////////////////////////////

	//////////////////////////////////////////////////////////////////////////
	// CGF Loader.
	//////////////////////////////////////////////////////////////////////////
	virtual CContentCGF* CreateChunkfileContent(const char* filename);
	virtual void         ReleaseChunkfileContent(CContentCGF*);
	virtual bool         LoadChunkFileContent(CContentCGF* pCGF, const char* filename, bool bNoWarningMode = false, bool bCopyChunkFile = true);
	virtual bool         LoadChunkFileContentFromMem(CContentCGF* pCGF, const void* pData, size_t nDataLen, uint32 nLoadingFlags, bool bNoWarningMode = false, bool bCopyChunkFile = true);
	//////////////////////////////////////////////////////////////////////////
	virtual IChunkFile*  CreateChunkFile(bool bReadOnly = false);

	//////////////////////////////////////////////////////////////////////////
	// Chunk file writer.
	//////////////////////////////////////////////////////////////////////////
	virtual ChunkFile::IChunkFileWriter* CreateChunkFileWriter(EChunkFileFormat eFormat, ICryPak* pPak, const char* filename) const;
	virtual void                         ReleaseChunkFileWriter(ChunkFile::IChunkFileWriter* p) const;

	//////////////////////////////////////////////////////////////////////////
	// Post processing effects interfaces

	virtual void   SetPostEffectParam(const char* pParam, float fValue, bool bForceValue = false) const;
	virtual void   SetPostEffectParamVec4(const char* pParam, const Vec4& pValue, bool bForceValue = false) const;
	virtual void   SetPostEffectParamString(const char* pParam, const char* pszArg) const;

	virtual void   GetPostEffectParam(const char* pParam, float& fValue) const;
	virtual void   GetPostEffectParamVec4(const char* pParam, Vec4& pValue) const;
	virtual void   GetPostEffectParamString(const char* pParam, const char*& pszArg) const;

	virtual int32  GetPostEffectID(const char* pPostEffectName);

	virtual void   ResetPostEffects(bool bOnSpecChange = false) const;

	virtual void   SetShadowsGSMCache(bool bCache);
	virtual void   SetCachedShadowBounds(const AABB& shadowBounds, float fAdditionalCascadesScale);
	virtual void   SetRecomputeCachedShadows(uint nUpdateStrategy = 0);
	virtual void   InvalidateShadowCacheData();
	void           SetShadowsCascadesBias(const float* pCascadeConstBias, const float* pCascadeSlopeBias);
	const float*   GetShadowsCascadesConstBias() const { return m_pShadowCascadeConstBias; }
	const float*   GetShadowsCascadesSlopeBias() const { return m_pShadowCascadeSlopeBias; }
	int            GetShadowsCascadeCount(const SRenderLight* pLight) const;

	virtual uint32 GetObjectsByType(EERType objType, IRenderNode** pObjects);
	virtual uint32 GetObjectsByTypeInBox(EERType objType, const AABB& bbox, IRenderNode** pObjects, uint64 dwFlags = ~0);
	virtual uint32 GetObjectsInBox(const AABB& bbox, IRenderNode** pObjects = 0);
	virtual uint32 GetObjectsByFlags(uint dwFlags, IRenderNode** pObjects = 0);
	virtual void   OnObjectModified(IRenderNode* pRenderNode, IRenderNode::RenderFlagsType dwFlags);

	virtual void   ActivateObjectsLayer(uint16 nLayerId, bool bActivate, bool bPhys, bool bObjects, bool bStaticLights, const char* pLayerName, IGeneralMemoryHeap* pHeap = NULL, bool bCheckLayerActivation = true);
	bool           IsObjectsLayerHidden(uint16 nLayerId, const AABB& objBox);
	virtual void   GetLayerMemoryUsage(uint16 nLayerId, ICrySizer* pSizer, int* pNumBrushes, int* pNumDecals) const;
	virtual void   SkipLayerLoading(uint16 nLayerId, bool bClearList);
	bool           IsLayerSkipped(uint16 nLayerId);

	//////////////////////////////////////////////////////////////////////////

	virtual int  GetTerrainTextureNodeSizeMeters();
	virtual int  GetTerrainTextureNodeSizePixels(int nLayer);

	SImageInfo*  GetBaseTextureData(int nLayerId);
	SImageInfo*  GetBaseTextureDataFromSurfType(int nSurfTypeId);

	const char*  GetLevelFolder()        { return m_szLevelFolder; }

	virtual bool IsAreaActivationInUse() { return m_bAreaActivationInUse && GetCVars()->e_ObjectLayersActivation; }

	int          GetCurrentLightSpec()
	{
		return CONFIG_VERYHIGH_SPEC; // very high spec.
	}

	void         UpdateRenderingCamera(const char* szCallerName, const SRenderingPassInfo& passInfo);
	virtual void PrepareOcclusion(const CCamera& rCamera, const SGraphicsPipelineKey& cullGraphicsContextKey);
	virtual void EndOcclusion();
#ifndef _RELEASE
	void         ProcessStreamingLatencyTest(const CCamera& camIn, CCamera& camOut, const SRenderingPassInfo& passInfo);
#endif

	void ScreenShotHighRes(CStitchedImage* pStitchedImage, const int nRenderFlags, const SRenderingPassInfo& passInfo, uint32 SliceCount, f32 fTransitionSize);

	// cylindrical mapping made by multiple slices rendered and distorted
	// Returns:
	//   true=mode is active, stop normal rendering, false=mode is not active
	bool         ScreenShotPanorama(CStitchedImage* pStitchedImage, const int nRenderFlags, const SRenderingPassInfo& passInfo, uint32 SliceCount, f32 fTransitionSize);
	// Render simple top-down screenshot for map overviews
	bool         ScreenShotMap(CStitchedImage* pStitchedImage, const int nRenderFlags, const SRenderingPassInfo& passInfo, uint32 SliceCount, f32 fTransitionSize);

	void         ScreenshotDispatcher(const int nRenderFlags, const SRenderingPassInfo& passInfo);

	virtual void FillDebugFPSInfo(SDebugFPSInfo& info);

	void         ClearDebugFPSInfo(bool bUnload = false)
	{
		m_fAverageFPS = 0.0f;
		m_fMinFPS = m_fMinFPSDecay = 999.f;
		m_fMaxFPS = m_fMaxFPSDecay = 0.0f;
		if (bUnload)
			stl::free_container(arrFPSforSaveLevelStats);
		else
			arrFPSforSaveLevelStats.clear();
	}

	void ClearPrecacheInfo()
	{
		m_nFramesSinceLevelStart = 0;
		m_nStreamingFramesSinceLevelStart = 0;
		m_bPreCacheEndEventSent = false;
		m_fTimeStateStarted = 0.0f;
	}

	virtual const CCamera& GetRenderingCamera() const { return m_RenderingCamera; }
	virtual float          GetZoomFactor() const      { return m_fZoomFactor; }
	virtual float          IsZoomInProgress()  const  { return m_bZoomInProgress; }
	virtual void           Tick();

	virtual void           UpdateShaderItems();
	void                   GetCollisionClass(SCollisionClass& collclass, int tableIndex);

	void                   SetRecomputeCachedShadows(IRenderNode* pNode, uint updateStrategy);

	virtual void           ReleasePermanentObjectsRenderResources();

public:
	C3DEngine(ISystem* pSystem);
	~C3DEngine();

	virtual void RenderScene(const int nRenderFlags, const SRenderingPassInfo& passInfo);
	virtual void DebugDraw_UpdateDebugNode();

	void         DebugDraw_Draw();
	bool         IsOutdoorVisible() const;
	void         ProcessSky(const SRenderingPassInfo& passInfo);
	int          GetStreamingFramesSinceLevelStart() { return m_nStreamingFramesSinceLevelStart; }
	int          GetRenderFramesSinceLevelStart()    { return m_nFramesSinceLevelStart; }

	bool CreateDecalInstance(const CryEngineDecalInfo &DecalInfo, class CDecal* pCallerManagedDecal);
	//void CreateDecalOnCharacterComponents(ICharacterInstance * pChar, const struct CryEngineDecalInfo & decal);
	Vec3 GetTerrainSurfaceNormal(Vec3 vPos);
	void LoadEnvironmentSettingsFromXML(XmlNodeRef pInputNode);
	void UpdateMoonParams();
	void UpdateSkyParams();
	void UpdateWindParams();
	void UpdateCloudShadows();
#if defined(FEATURE_SVO_GI)
	void UpdateTISettings();
#endif
	void LoadDefaultAssets();

	// access to components
	ILINE static CVars*            GetCVars()              { return m_pCVars; }
	ILINE CVisAreaManager*         GetVisAreaManager()     { return m_pVisAreaManager; }
	ILINE CClipVolumeManager*      GetClipVolumeManager()  { return m_pClipVolumeManager; }
	ILINE PodArray<ILightSource*>* GetLightEntities()      { return &m_lstStaticLights; }

	ILINE IGeneralMemoryHeap*      GetBreakableBrushHeap() { return m_pBreakableBrushHeap; }

	virtual void                   OnCameraTeleport();

	// this data is stored in memory for instances streaming
	std::vector<struct IStatObj*>* m_pLevelStatObjTable;
	std::vector<IMaterial*>*       m_pLevelMaterialsTable;
	bool                           m_bLevelFilesEndian;
	struct SLayerActivityInfo
	{
		SLayerActivityInfo() { objectsBox.Reset(); bActive = false; }
		AABB objectsBox;
		bool bActive;
	};
	PodArray<SLayerActivityInfo> m_arrObjectLayersActivity;
	uint                         m_objectLayersModificationId;
	bool                         m_bAreaActivationInUse;

	// Level info
	float                 m_fSkyBoxStretching;
	float                 m_fSkyBoxAngle;
	Vec3                  m_vSkyBoxExposure;
	Vec3                  m_vSkyBoxOpacity;

	float                 m_fMaxViewDistScale;
	float                 m_fMaxViewDistHighSpec;
	float                 m_fMaxViewDistLowSpec;
	float                 m_fTerrainDetailMaterialsViewDistRatio;

	float                 m_volFogGlobalDensity;
	float                 m_volFogGlobalDensityMultiplierLDR;
	float                 m_volFogFinalDensityClamp;

	int                   m_nCurWind;         // Current wind-field buffer Id
	SWindGrid             m_WindGrid[2];      // Wind field double-buffered
	Vec2*                 m_pWindField;       // Old wind speed values for interpolation
	int*                  m_pWindAreaFrames;  // Area frames for rest updates
	Vec3                  m_vWindFieldCamera; // Wind field camera for interpolation
	JobManager::SJobState m_WindJobState;
	bool                  m_bWindJobRun;

	float                 m_fCloudShadingSunLightMultiplier;
	float                 m_fCloudShadingSkyLightMultiplier;
	Vec3                  m_vCloudShadingCustomSunColor;
	Vec3                  m_vCloudShadingCustomSkyColor;

	Vec3                  m_vVolCloudAtmosphericScattering;
	Vec3                  m_vVolCloudGenParams;
	Vec3                  m_vVolCloudScatteringLow;
	Vec3                  m_vVolCloudScatteringHigh;
	Vec3                  m_vVolCloudGroundColor;
	Vec3                  m_vVolCloudScatteringMulti;
	Vec3                  m_vVolCloudWindAtmospheric;
	Vec3                  m_vVolCloudTurbulence;
	Vec3                  m_vVolCloudEnvParams;
	Vec3                  m_vVolCloudGlobalNoiseScale;
	Vec3                  m_vVolCloudRenderParams;
	Vec3                  m_vVolCloudTurbulenceNoiseScale;
	Vec3                  m_vVolCloudTurbulenceNoiseParams;
	Vec3                  m_vVolCloudDensityParams;
	Vec3                  m_vVolCloudMiscParams;
	Vec3                  m_vVolCloudTilingSize;
	Vec3                  m_vVolCloudTilingOffset;

	Vec3                  m_vFogColor;
	Vec3                  m_vDefFogColor;
	Vec3                  m_vSunDir;
	Vec3                  m_vSunDirNormalized;
	float                 m_fSunDirUpdateTime;
	Vec3                  m_vSunDirRealtime;
	Vec3                  m_vWindSpeed;

	Vec3                  m_volFogRamp;
	Vec3                  m_volFogShadowRange;
	Vec3                  m_volFogShadowDarkening;
	Vec3                  m_volFogShadowEnable;

	Vec3                  m_volFog2CtrlParams;
	Vec3                  m_volFog2ScatteringParams;
	Vec3                  m_volFog2Ramp;
	Vec3                  m_volFog2Color;
	Vec3                  m_volFog2GlobalDensity;
	Vec3                  m_volFog2HeightDensity;
	Vec3                  m_volFog2HeightDensity2;
	Vec3                  m_volFog2Color1;
	Vec3                  m_volFog2Color2;

	Vec3                  m_nightSkyHorizonCol;
	Vec3                  m_nightSkyZenithCol;
	float                 m_nightSkyZenithColShift;
	float                 m_nightSkyStarIntensity;
	Vec3                  m_nightMoonCol;
	float                 m_nightMoonSize;
	Vec3                  m_nightMoonInnerCoronaCol;
	float                 m_nightMoonInnerCoronaScale;
	Vec3                  m_nightMoonOuterCoronaCol;
	float                 m_nightMoonOuterCoronaScale;

	float                 m_moonRotationLatitude;
	float                 m_moonRotationLongitude;
	Vec3                  m_moonDirection;
	int                   m_nWaterBottomTexId;
	string                m_MoonTextureName;
	bool                  m_bShowTerrainSurface;
	float                 m_fSunClipPlaneRange;
	float                 m_fSunClipPlaneRangeShift;
	bool                  m_bSunShadows;
	bool                  m_bSunShadowsFromTerrain;

	_smart_ptr<ITexture>  m_pCloudShadowTex;

	float                 m_fGsmRange;
	float                 m_fGsmRangeStep;
	float                 m_fShadowsConstBias;
	float                 m_fShadowsSlopeBias;

	int                   m_nSunAdditionalCascades;
	int                   m_nGsmCache;
	Vec3                  m_oceanFogColor;
	Vec3                  m_oceanFogColorShallow;
	float                 m_oceanFogDensity;
	float                 m_skyboxMultiplier;
	float                 m_dayNightIndicator;
	bool                  m_bHeightMapAoEnabled;
	bool                  m_bIntegrateObjectsIntoTerrain;
	bool                  m_supportOfflineProceduralVegetation = false;

	Vec3                  m_fogColor2;
	Vec3                  m_fogColorRadial;
	Vec3                  m_volFogHeightDensity;
	Vec3                  m_volFogHeightDensity2;
	Vec3                  m_volFogGradientCtrl;

	Vec3                  m_fogColorSkylightRayleighInScatter;

	float                 m_oceanCausticsDistanceAtten;
	float                 m_oceanCausticsMultiplier;
	float                 m_oceanCausticsDarkeningMultiplier;
	float                 m_oceanCausticsTilling;
	float                 m_oceanCausticHeight;
	float                 m_oceanCausticDepth;
	float                 m_oceanCausticIntensity;

	float                 m_oceanWindDirection;
	float                 m_oceanWindSpeed;
	float                 m_oceanWavesAmount;
	float                 m_oceanWavesSize;

	float                 m_dawnStart;
	float                 m_dawnEnd;
	float                 m_duskStart;
	float                 m_duskEnd;

	// film characteristic curve tweakables
	Vec4  m_vHDRFilmCurveParams;
	Vec3  m_vHDREyeAdaptation;
	Vec3  m_vHDREyeAdaptationLegacy;
	float m_fHDRBloomAmount;

	// hdr color grading
	Vec3  m_vColorBalance;
	float m_fHDRSaturation;

#ifndef _RELEASE
	CDebugDrawListMgr m_DebugDrawListMgr;
#endif

#define MAX_SHADOW_CASCADES_NUM 20
	float m_pShadowCascadeConstBias[MAX_SHADOW_CASCADES_NUM];
	float m_pShadowCascadeSlopeBias[MAX_SHADOW_CASCADES_NUM];

	AABB  m_CachedShadowsBounds;
	uint  m_nCachedShadowsUpdateStrategy;
	float m_fCachedShadowsCascadeScale;

	// special case for combat mode adjustments
	float m_fSaturation;
	Vec4  m_pPhotoFilterColor;
	float m_fPhotoFilterColorDensity;
	float m_fGrainAmount;
	float m_fSunSpecMult;

	// Level shaders
	_smart_ptr<IMaterial> m_pTerrainWaterMat;
	_smart_ptr<IMaterial> m_pSkyMat[eSkySpec_NumSkySpecs];
	_smart_ptr<IMaterial> m_pSunMat;

	// Fog Materials
	_smart_ptr<IMaterial> m_pMatFogVolEllipsoid;
	_smart_ptr<IMaterial> m_pMatFogVolBox;

	void CleanLevelShaders()
	{
		m_pTerrainWaterMat = 0;

		m_pSunMat = nullptr;
		for (int skyTypeIdx = 0; skyTypeIdx < eSkySpec_NumSkySpecs; ++skyTypeIdx)
			m_pSkyMat[skyTypeIdx] = nullptr;

		m_pMatFogVolEllipsoid = 0;
		m_pMatFogVolBox = 0;
	}

	int m_nDeferredLightsNum;
	int m_nDeferredProbesNum;

private:
	// not sorted

	void       SetDefaultValuesForLoadMissionDataFromXML();
	XmlNodeRef OpenMissionDataXML(const char* szMissionName);
	void       LoadMissionDataFromXML(XmlNodeRef missionXml);
	void       LoadTimeOfDaySettingsFromXML(XmlNodeRef node);
	char*      GetXMLAttribText(XmlNodeRef pInputNode, const char* szLevel1, const char* szLevel2, const char* szDefaultValue);
	char*      GetXMLAttribText(XmlNodeRef pInputNode, const char* szLevel1, const char* szLevel2, const char* szLevel3, const char* szDefaultValue);
	bool       GetXMLAttribBool(XmlNodeRef pInputNode, const char* szLevel1, const char* szLevel2, bool bDefaultValue);

	// without calling high level functions like panorama screenshot
	void RenderInternal(const int nRenderFlags, const SRenderingPassInfo& passInfo, const char* szDebugName);

	bool IsCameraAnd3DEngineInvalid(const SRenderingPassInfo& passInfo, const char* szCaller);

	void DebugDrawStreaming(const SRenderingPassInfo& passInfo);
	//////////////////////////////////////////////////////////////////////////
	//////////////////////////////////////////////////////////////////////////

	void ResetCasterCombinationsCache();

	void FindPotentialLightSources(const SRenderingPassInfo& passInfo);
	void LoadParticleEffects(const char* szFolderName);

	void UpdateSunLightSource(const SRenderingPassInfo& passInfo);

	// Query physics for physical air affecting area and create an optimized query structure for 3d engine
	void UpdateWindAreas();

	void UpdateMoonDirection();

	// Copy objects from tree
	void CopyObjectsByType(EERType objType, const AABB* pBox, PodArray<IRenderNode*>* plistObjects, uint64 dwFlags = ~0);
	void CopyObjects(const AABB* pBox, PodArray<IRenderNode*>* plistObjects);

	void CleanUpOldDecals();
public:
	// functions SRenderingPass
	virtual CCamera* GetRenderingPassCamera(const CCamera& rCamera);
	virtual int      GetZoomMode() const;
	virtual float    GetPrevZoomFactor();
	virtual void     SetZoomMode(int nZoomMode);
	virtual void     SetPrevZoomFactor(float fZoomFactor);

#if defined(FEATURE_SVO_GI)
	virtual bool GetSvoStaticTextures(I3DEngine::SSvoStaticTexInfo& svoInfo, PodArray<I3DEngine::SLightTI>* pLightsTI_S, PodArray<I3DEngine::SLightTI>* pLightsTI_D);
	virtual void GetSvoBricksForUpdate(PodArray<SSvoNodeInfo>& arrNodeInfo, float fNodeSize, PodArray<SVF_P3F_C4B_T2F>* pVertsOut);
	virtual bool IsSvoReady(bool testPostponed) const;
	virtual int  GetSvoCompiledData(ICryArchive* pArchive);
#endif
	// LiveCreate
	virtual void SaveInternalState(struct IDataWriteStream& writer, const AABB& filterArea, const bool bTerrain, const uint32 objectMask);
	virtual void LoadInternalState(struct IDataReadStream& reader, const uint8* pVisibleLayersMask, const uint16* pLayerIdTranslation);

	void         SetupLightScissors(SRenderLight* pLight, const SRenderingPassInfo& passInfo) const;
	bool         IsTerrainTextureStreamingInProgress() { return m_bTerrainTextureStreamingInProgress; }

	bool         IsTerrainSyncLoad()                   { return m_bContentPrecacheRequested && GetCVars()->e_AutoPrecacheTerrainAndProcVeget; }
	bool         IsShadersSyncLoad()                   { return m_bContentPrecacheRequested && GetCVars()->e_AutoPrecacheTexturesAndShaders; }
	bool         IsStatObjSyncLoad()                   { return m_bContentPrecacheRequested && GetCVars()->e_AutoPrecacheCgf; }
	float        GetAverageCameraSpeed()               { return m_fAverageCameraSpeed; }
	Vec3         GetAverageCameraMoveDir()             { return m_vAverageCameraMoveDir; }

	typedef std::map<uint64, int> ShadowFrustumListsCacheUsers;
	ShadowFrustumListsCacheUsers m_FrustumsCacheUsers[2];

	class CStatObjFoliage*       m_pFirstFoliage, * m_pLastFoliage;
	PodArray<SEntInFoliage>      m_arrEntsInFoliage;
	void RemoveEntInFoliage(int i, IPhysicalEntity* pent = 0);

	PodArray<class CRoadRenderNode*> m_lstRoadRenderNodesForUpdate;

	struct ILightSource*            GetSunEntity();
	void                            OnCasterDeleted(IShadowCaster* pCaster);

	void                            UpdateScene(const SRenderingPassInfo& passInfo);
	void                            UpdateLightSources(const SRenderingPassInfo& passInfo);
	void                            PrepareLightSourcesForRendering_0(const SRenderingPassInfo& passInfo);
	void                            PrepareLightSourcesForRendering_1(const SRenderingPassInfo& passInfo);
	void                            InitShadowFrustums(const SRenderingPassInfo& passInfo);
	void                            PrepareShadowPasses(const SRenderingPassInfo& passInfo, uint32& nTimeSlicedShadowsUpdatedThisFrame, std::vector<std::pair<ShadowMapFrustum*, const class CLightEntity*>>& shadowFrustums, std::vector<SRenderingPassInfo>& shadowPassInfo);
	void                            FinalizePrepareShadowPasses(const SRenderingPassInfo& passInfo, const std::vector<std::pair<ShadowMapFrustum*, const class CLightEntity*>>& shadowFrustums, std::vector<SRenderingPassInfo>& shadowPassInfo);

	///////////////////////////////////////////////////////////////////////////////

	virtual void            GetLightVolumes(threadID nThreadID, SLightVolume*& pLightVols, uint32& nNumVols);
	const CLightVolumesMgr& GetLightVolumeManager() const { return m_LightVolumesMgr; }
	CLightVolumesMgr&       GetLightVolumeManager()       { return m_LightVolumesMgr; }

	///////////////////////////////////////////////////////////////////////////////

	void                             FreeLightSourceComponents(SRenderLight* pLight, bool bDeleteLight = true);
	void                             RemoveEntityLightSources(IRenderNode* pEntity);

	void                             CheckPhysicalized(const Vec3& vBoxMin, const Vec3& vBoxMax);

	virtual PodArray<SRenderLight*>* GetDynamicLightSources() { return &m_lstDynLights; }

	int                              GetRealLightsNum()       { return m_nRealLightsNum; }
	void                             SetupClearColor(const SRenderingPassInfo& passInfo);
	void                             CheckAddLight(SRenderLight* pLight, const SRenderingPassInfo& passInfo);

	void                             DrawTextRightAligned(const float x, const float y, const char* format, ...) PRINTF_PARAMS(4, 5);
	void                             DrawTextRightAligned(const float x, const float y, const float scale, const ColorF& color, const char* format, ...) PRINTF_PARAMS(6, 7);
	void                             DrawTextLeftAligned(const float x, const float y, const float scale, const ColorF& color, const char* format, ...) PRINTF_PARAMS(6, 7);
	void                             DrawTextAligned(int flags, const float x, const float y, const float scale, const ColorF& color, const char* format, ...) PRINTF_PARAMS(7, 8);

	float                            GetLightAmount(SRenderLight* pLight, const AABB& objBox);

	IStatObj*                        CreateStatObj();
	virtual IStatObj*                CreateStatObjOptionalIndexedMesh(bool createIndexedMesh);

	IStatObj*                        UpdateDeformableStatObj(IGeometry* pPhysGeom, bop_meshupdate* pLastUpdate = 0, IFoliage* pSrcFoliage = 0, IMaterial* pMtlOverride = nullptr);

	// Creates a new indexed mesh.
	IIndexedMesh*                 CreateIndexedMesh();

	void                          InitMaterialDefautMappingAxis(IMaterial* pMat);

	virtual ITerrain*             GetITerrain()             { return (ITerrain*)m_pTerrain; }
	virtual IVisAreaManager*      GetIVisAreaManager()      { return (IVisAreaManager*)m_pVisAreaManager; }
	virtual IMergedMeshesManager* GetIMergedMeshesManager() { return (IMergedMeshesManager*)m_pMergedMeshesManager; }

	virtual ITerrain*             CreateTerrain(const STerrainInfo& TerrainInfo);
	void                          DeleteTerrain();
	bool                          LoadTerrain(XmlNodeRef pDoc, std::vector<struct IStatObj*>** ppStatObjTable, std::vector<IMaterial*>** ppMatTable);
	bool                          LoadVisAreas(std::vector<struct IStatObj*>** ppStatObjTable, std::vector<IMaterial*>** ppMatTable);
	bool                          LoadUsedShadersList();
	bool                          PrecreateDecals();
	void                          LoadPhysicsData();
	void                          ResetWindSystem();
	void                          UnloadPhysicsData();
	void                          LoadFlaresData();
	void                          FreeFoliages();

	void                          LoadCollisionClasses(XmlNodeRef node);

	virtual float                 GetLightAmountInRange(const Vec3& pPos, float fRange, bool bAccurate = 0);

	virtual void                  PrecacheLevel(bool bPrecacheAllVisAreas, Vec3* pPrecachePoints, int nPrecachePointsNum);
	virtual void                  ProposeContentPrecache()     { m_bContentPrecacheRequested = true; }
	bool                          IsContentPrecacheRequested() { return m_bContentPrecacheRequested; }

	virtual ITimeOfDay*           GetTimeOfDay();

	virtual IColorGradingCtrl*    GetColorGradingCtrl() { return &m_colorGradingCtrl; }

	//////////////////////////////////////////////////////////////////////////
	// Sky
	virtual bool                         IsSkyVisible() const final;
	virtual eSkyType                     GetSkyType() const final { return (eSkyType)GetCVars()->e_SkyType; }
	virtual IMaterial*                   GetSkyMaterial() const;
	virtual void                         SetSkyMaterial(IMaterial* pSkyMat, eSkyType type); 

	virtual const SSkyLightRenderParams* GetSkyLightRenderParams() const final;

	virtual string                       GetMoonTextureName() const final         { return m_MoonTextureName; }
	virtual void                         SetMoonTextureName(string name) final    { m_MoonTextureName = name; }

	using I3DEngine::SetGlobalParameter;
	virtual void                     SetGlobalParameter(E3DEngineParameter param, const Vec3& v);
	using I3DEngine::GetGlobalParameter;
	virtual void                     GetGlobalParameter(E3DEngineParameter param, Vec3& v);
	virtual void                     SetShadowMode(EShadowMode shadowMode) { m_eShadowMode = shadowMode; }
	virtual EShadowMode              GetShadowMode() const                 { return m_eShadowMode; }
	virtual void                     AddPerObjectShadow(IShadowCaster* pCaster, float fConstBias, float fSlopeBias, float fJitter, const Vec3& vBBoxScale, uint nTexSize);
	virtual void                     RemovePerObjectShadow(IShadowCaster* pCaster);
	virtual struct SPerObjectShadow* GetPerObjectShadow(IShadowCaster* pCaster);
	virtual void                     GetCustomShadowMapFrustums(ShadowMapFrustum**& arrFrustums, int& nFrustumCount);
	virtual int                      SaveStatObj(IStatObj* pStatObj, TSerialize ser);
	virtual IStatObj*                LoadStatObj(TSerialize ser);

	virtual void                     OnRenderMeshDeleted(IRenderMesh* pRenderMesh);
	virtual bool                     RenderMeshRayIntersection(IRenderMesh* pRenderMesh, SRayHitInfo& hitInfo, IMaterial* pCustomMtl = 0);
	virtual void                     OnEntityDeleted(struct IEntity* pEntity);
	virtual const char*              GetVoxelEditOperationName(EVoxelEditOperation eOperation);

	virtual void                     SetEditorHeightmapCallback(IEditorHeightmap* pCallBack) { m_pEditorHeightmap = pCallBack; }
	static IEditorHeightmap* m_pEditorHeightmap;

	virtual IParticleManager* GetParticleManager() { return m_pPartManager; }
	virtual IOpticsManager*   GetOpticsManager()   { return m_pOpticsManager; }

	virtual void              RegisterForStreaming(IStreamable* pObj);
	virtual void              UnregisterForStreaming(IStreamable* pObj);

	virtual void              PrecacheCharacter(IRenderNode* pObj, const float fImportance, ICharacterInstance* pCharacter, IMaterial* pSlotMat, const Matrix34& matParent, const float fEntDistance, const float fScale, int nMaxDepth, bool bForceStreamingSystemUpdate, const SRenderingPassInfo& passInfo);
	virtual void              PrecacheRenderNode(IRenderNode* pObj, float fEntDistanceReal);

	void                      MarkRNTmpDataPoolForReset() { m_bResetRNTmpDataPool = true; }

	bool                      IsObjectsTreeValid()        { return m_pObjectsTree != nullptr; }
	class COctreeNode*   GetObjectsTree()            { return m_pObjectsTree; }

	static void          GetObjectsByTypeGlobal(PodArray<IRenderNode*>& lstObjects, EERType objType, const AABB* pBBox, bool* pInstStreamReady = NULL, uint64 dwFlags = ~0);
	static void          MoveObjectsIntoListGlobal(PodArray<SRNInfo>* plstResultEntities, const AABB* pAreaBox, bool bRemoveObjects = false, bool bSkipDecals = false, bool bSkip_ERF_NO_DECALNODE_DECALS = false, bool bSkipDynamicObjects = false, EERType eRNType = eERType_TypesNum);

	SRenderNodeTempData* CreateRenderNodeTempData(IRenderNode* pRNode, const SRenderingPassInfo& passInfo);
	SRenderNodeTempData* CheckAndCreateRenderNodeTempData(IRenderNode* pRNode, const SRenderingPassInfo& passInfo);

	void                 UpdateStatInstGroups();
	void                 UpdateRenderTypeEnableLookup();
	void                 ProcessOcean(const SRenderingPassInfo& passInfo);
	void                 ReRegisterKilledVegetationInstances();
	Vec3                 GetEntityRegisterPoint(IRenderNode* pEnt);

	void                 RenderRenderNode_ShadowPass(IShadowCaster* pRNode, const SRenderingPassInfo& passInfo);
	void                 ProcessCVarsChange();
	ILINE int            GetGeomDetailScreenRes()
	{
		if (GetCVars()->e_ForceDetailLevelForScreenRes)
		{
			return GetCVars()->e_ForceDetailLevelForScreenRes;
		}
		else if (GetRenderer())
		{
			return std::max(GetRenderer()->GetOverlayWidth(), GetRenderer()->GetOverlayHeight());
		}
		return 1;
	}

	int                                   GetBlackTexID()   { return m_nBlackTexID; }
	int                                   GetBlackCMTexID() { return m_nBlackCMTexID; }
	int                                   GetWhiteTexID()   { return m_nWhiteTexID; }

	virtual void                          SyncProcessStreamingUpdate();

	virtual void                          SetScreenshotCallback(IScreenshotCallback* pCallback);

	virtual void                          RegisterRenderNodeStatusListener(IRenderNodeStatusListener* pListener, EERType renderNodeType);
	virtual void                          UnregisterRenderNodeStatusListener(IRenderNodeStatusListener* pListener, EERType renderNodeType);

	virtual IDeferredPhysicsEventManager* GetDeferredPhysicsEventManager() { return m_pDeferredPhysicsEventManager; }

	void                                  PrintDebugInfo(const SRenderingPassInfo& passInfo);

public:
	//////////////////////////////////////////////////////////////////////////
	// PUBLIC DATA
	//////////////////////////////////////////////////////////////////////////
	class COctreeNode*             m_pObjectsTree = nullptr;

	int                            m_idMatLeaves; // for shooting foliages
	bool                           m_bResetRNTmpDataPool;

	float                          m_fRefreshSceneDataCVarsSumm;
	int                            m_nRenderTypeEnableCVarSum;

	PodArray<IRenderNode*>         m_lstAlwaysVisible;
	PodArray<IRenderNode*>         m_lstKilledVegetations;
	PodArray<SPerObjectShadow>     m_lstPerObjectShadows;
	std::vector<ShadowMapFrustum*> m_lstCustomShadowFrustums;
	int                            m_nCustomShadowFrustumCount;
	uint32                         m_onePassShadowTraversalCount = 0;

	PodArray<SImageInfo>           m_arrBaseTextureData;

	bool                           m_bInShutDown;
	bool                           m_bInUnload;
	bool                           m_bInLoad;

private:
	//////////////////////////////////////////////////////////////////////////
	// PRIVATE DATA
	//////////////////////////////////////////////////////////////////////////
	class CLightEntity* m_pSun;

	std::vector<byte>   arrFPSforSaveLevelStats;
	PodArray<float>     m_arrProcessStreamingLatencyTestResults;
	PodArray<int>       m_arrProcessStreamingLatencyTexNum;

	// fields which are used by SRenderingPass to store over frame information
	CryMT::CThreadSafePushContainer<CCamera> m_RenderingPassCameras[2];  // camera storage for SRenderingPass, the cameras cannot be stored on stack to allow job execution

	float m_fZoomFactor;                                // zoom factor of m_RenderingCamera
	float m_fPrevZoomFactor;                            // zoom factor of m_RenderingCamera from last frame
	bool  m_bZoomInProgress;                            // indicates if the RenderingCamera is currently zooming
	int   m_nZoomMode;                                  // the zoom level of the camera (0-4) 0: no zoom, 4: full zoom

	// cameras used by 3DEngine
	CCamera                m_RenderingCamera;           // Camera used for Rendering on 3DEngine Side, normally equal to the viewcamera, except if frozen with e_camerafreeze

	PodArray<IRenderNode*> m_deferredRenderProxyStreamingPriorityUpdates;     // deferred streaming priority updates for newly seen CRenderProxies

	float                  m_fLightsHDRDynamicPowerFactor; // lights hdr exponent/exposure

	int                    m_nBlackTexID;
	int                    m_nBlackCMTexID;
	int                    m_nWhiteTexID;

	char                   m_sGetLevelFilePathTmpBuff[MAX_PATH_LENGTH];
	char                   m_szLevelFolder[_MAX_PATH];

	bool                   m_bOcean; // todo: remove

	Vec3                   m_vSkyHightlightPos;
	Vec3                   m_vSkyHightlightCol;
	float                  m_fSkyHighlightSize;
	Vec3                   m_vAmbGroundCol;
	float                  m_fAmbMaxHeight;
	float                  m_fAmbMinHeight;
	IPhysicalEntity*       m_pGlobalWind;
	uint8                  m_nOceanRenderFlags;
	Vec3                   m_vPrevMainFrameCamPos;
	float                  m_fAverageCameraSpeed;
	Vec3                   m_vAverageCameraMoveDir;
	EShadowMode            m_eShadowMode;
	bool                   m_bLayersActivated;
	bool                   m_bContentPrecacheRequested;
	bool                   m_bTerrainTextureStreamingInProgress;

	// interfaces
	IPhysMaterialEnumerator* m_pPhysMaterialEnumerator;

	// data containers
	PodArray<SRenderLight*>                   m_lstDynLights;
	PodArray<SRenderLight*>                   m_lstDynLightsNoLight;
	int                                       m_nRealLightsNum;

	PodArray<ILightSource*>                   m_lstStaticLights;

	PodArray<SCollisionClass>                 m_collisionClasses;

#define MAX_LIGHTS_NUM 32
	CTimeOfDay*       m_pTimeOfDay;

	ICVar*            m_pLightQuality;

	// FPS for savelevelstats

	float                          m_fAverageFPS;
	float                          m_fMinFPS, m_fMinFPSDecay;
	float                          m_fMaxFPS, m_fMaxFPSDecay;
	int                            m_nFramesSinceLevelStart;
	int                            m_nStreamingFramesSinceLevelStart;
	bool                           m_bPreCacheEndEventSent;
	float                          m_fTimeStateStarted;
	uint32                         m_nRenderWorldUSecs;
	SFrameLodInfo                  m_frameLodInfo;

	ITexture*                      m_ptexIconLowMemoryUsage;
	ITexture*                      m_ptexIconAverageMemoryUsage;
	ITexture*                      m_ptexIconHighMemoryUsage;
	ITexture*                      m_ptexIconEditorConnectedToConsole;

	std::vector<IDecalRenderNode*> m_decalRenderNodes;          // list of registered decal render nodes, used to clean up longer not drawn decals
	std::vector<IRenderNode*>      m_renderNodesToDelete[2];    // delay deletion of rendernodes by few frames to make sure
	uint32                         m_renderNodesToDeleteID = 0; // they can be safely used on render and voxelization threads

	SImageSubInfo* RegisterImageInfo(byte** pMips, int nDim, const char* pName);
	SImageSubInfo* GetImageInfo(const char* pName);
	std::map<string, SImageSubInfo*> m_imageInfos;
	byte**         AllocateMips(byte* pImage, int nDim, byte** pImageMips);
	IScreenshotCallback*             m_pScreenshotCallback;

	typedef CListenerSet<IRenderNodeStatusListener*> TRenderNodeStatusListeners;
	typedef std::vector<TRenderNodeStatusListeners>  TRenderNodeStatusListenersArray;
	TRenderNodeStatusListenersArray               m_renderNodeStatusListenersArray;

	OcclusionTestClient                           m_OceanOcclTestVar;

	IDeferredPhysicsEventManager*                 m_pDeferredPhysicsEventManager;

	std::set<uint16>                              m_skipedLayers;

	IGeneralMemoryHeap*                           m_pBreakableBrushHeap;

	CVisibleRenderNodesManager                    m_visibleNodesManager;

	float                                         m_fLastWindProcessedTime = 0.0f;
	Vec3                                          m_vProcessedGlobalWind = Vec3(0, 0, 0);
	int                                           m_nProcessedWindAreas = -1;
	int                                           m_nFrameWindAreas = 0;
	int                                           m_nCurrentWindAreaList;
	std::vector<SOptimizedOutdoorWindArea>        m_outdoorWindAreas[2];
	std::vector<SOptimizedOutdoorWindArea>        m_indoorWindAreas[2];
	std::vector<SOptimizedOutdoorWindArea>        m_forcedWindAreas;

	CLightVolumesMgr                              m_LightVolumesMgr;

	std::unique_ptr<CWaterRippleManager>          m_pWaterRippleManager;

	std::unique_ptr<C3DEngineLevelLoadTimeslicer> m_pLevelLoadTimeslicer;

	CColorGradingCtrl                             m_colorGradingCtrl;

	friend struct SRenderNodeTempData;
	friend class C3DEngineLevelLoadTimeslicer;
};



================================================
FILE: Code/CryEngine/Cry3DEngine/3DEngineLight.cpp
================================================
// Copyright 2001-2019 Crytek GmbH / Crytek Group. All rights reserved.

// -------------------------------------------------------------------------
//  File name:   3denginelight.cpp
//  Version:     v1.00
//  Created:     28/5/2001 by Vladimir Kajalin
//  Compilers:   Visual Studio.NET
//  Description: Light sources manager
// -------------------------------------------------------------------------
//  History:
//
////////////////////////////////////////////////////////////////////////////

#include "StdAfx.h"

#include "3dEngine.h"
#include "ObjMan.h"
#include "VisAreas.h"
#include <CryMath/AABBSV.h>
#include "terrain.h"
#include "LightEntity.h"
#include "ObjectsTree.h"
#include "Brush.h"
#include "ClipVolumeManager.h"

ILightSource* C3DEngine::CreateLightSource()
{
	// construct new object
	CLightEntity* pLightEntity = new CLightEntity();

	m_lstStaticLights.Add(pLightEntity);

	return pLightEntity;
}

void C3DEngine::DeleteLightSource(ILightSource* pLightSource)
{
	if (m_lstStaticLights.Delete((CLightEntity*)pLightSource) || pLightSource == m_pSun)
	{
		if (pLightSource == m_pSun)
			m_pSun = NULL;

		delete pLightSource;
	}
	else
		assert(!"Light object not found");
}

void CLightEntity::Release(bool)
{
	Get3DEngine()->UnRegisterEntityDirect(this);
	Get3DEngine()->DeleteLightSource(this);
}

void CLightEntity::SetLightProperties(const SRenderLight& light)
{
	C3DEngine* engine = Get3DEngine();

	m_light = light;

	m_bShadowCaster = (m_light.m_Flags & DLF_CASTSHADOW_MAPS) != 0;

	m_light.m_fLightFrustumAngle = CLAMP(m_light.m_fLightFrustumAngle, 0.f, (LIGHT_PROJECTOR_MAX_FOV / 2.f));

	if (!(m_light.m_Flags & DLF_PROJECT))
		m_light.m_fLightFrustumAngle = 90.f / 2.f;

	m_light.m_pOwner = this;

	if (m_light.m_Flags & DLF_ATTACH_TO_SUN)
	{
		m_dwRndFlags |= ERF_RENDER_ALWAYS | ERF_HUD;
	}

	engine->GetLightEntities()->Delete((ILightSource*)this);

	PodArray<ILightSource*>& lightEntities = *engine->GetLightEntities();

	//on consoles we force all lights (except sun) to be deferred
	if (GetCVars()->e_DynamicLightsForceDeferred && !(m_light.m_Flags & (DLF_SUN | DLF_POST_3D_RENDERER)))
		m_light.m_Flags |= DLF_DEFERRED_LIGHT;

	if (light.m_Flags & DLF_DEFERRED_LIGHT)
		lightEntities.Add((ILightSource*)this);
	else
		lightEntities.InsertBefore((ILightSource*)this, 0);
}

void C3DEngine::FindPotentialLightSources(const SRenderingPassInfo& passInfo)
{
	FUNCTION_PROFILER_3DENGINE;
#ifndef _RELEASE
	static ICVar* pCV_r_wireframe = GetConsole()->GetCVar("r_wireframe");
	if (pCV_r_wireframe && pCV_r_wireframe->GetIVal() == R_WIREFRAME_MODE)
		return;
#endif
	const Vec3 vCamPos = passInfo.GetCamera().GetPosition();

	for (int i = 0; i < m_lstStaticLights.Count(); i++)
	{
		CLightEntity* pLightEntity = (CLightEntity*)m_lstStaticLights[i];
		SRenderLight* pLight = &pLightEntity->GetLightProperties();

		if (pLight->m_Flags & DLF_DEFERRED_LIGHT)
			break; // process deferred lights in CLightEntity::Render(), deferred lights are stored in the end of this array

		int nRenderNodeMinSpec = (pLightEntity->GetRndFlags() & ERF_SPEC_BITS_MASK) >> ERF_SPEC_BITS_SHIFT;
		if (!CheckMinSpec(nRenderNodeMinSpec))
			continue;

		const bool bIsPost3dRendererLight = (pLight->m_Flags & DLF_POST_3D_RENDERER) ? true : false;
		const Vec3 vFinalCamPos = (!bIsPost3dRendererLight) ? vCamPos : ZERO; // Post 3d renderer camera is at origin
		float fEntDistance = sqrt(Distance::Point_AABBSq(vFinalCamPos, pLightEntity->GetBBox())) * passInfo.GetZoomFactor();
		if (fEntDistance > pLightEntity->m_fWSMaxViewDist && !bIsPost3dRendererLight)
			continue;

		IMaterial* pMat = pLightEntity->GetMaterial();
		if (pMat)
			pLight->m_Shader = pMat->GetShaderItem();

		bool bIsVisible = false;
		if (pLight->m_Flags & DLF_DEFERRED_CUBEMAPS)
		{
			OBB obb(OBB::CreateOBBfromAABB(Matrix33(pLight->m_ObjMatrix), AABB(-pLight->m_ProbeExtents, pLight->m_ProbeExtents)));
			bIsVisible = passInfo.GetCamera().IsOBBVisible_F(pLight->m_Origin, obb);
		}
		else
		{
			if (!bIsPost3dRendererLight)
			{
				bIsVisible = passInfo.GetCamera().IsSphereVisible_F(Sphere(pLight->m_Origin, pLight->m_fRadius));
			}
			else
			{
				bIsVisible = true;
			}
		}

		if (bIsVisible)
		{
			if ((pLight->m_Flags & DLF_PROJECT) && (pLight->m_fLightFrustumAngle < 90.f) && (pLight->m_pLightImage || pLight->m_pLightDynTexSource))
			{
				CCamera lightCam = passInfo.GetCamera();
				lightCam.SetPositionNoUpdate(pLight->m_Origin);
				Matrix34 entMat = ((ILightSource*)(pLight->m_pOwner))->GetMatrix();
				Matrix33 matRot = Matrix33::CreateRotationVDir(entMat.GetColumn(0));
				lightCam.SetMatrixNoUpdate(Matrix34(matRot, pLight->m_Origin));
				lightCam.SetFrustum(1, 1, (pLight->m_fLightFrustumAngle * 2) / 180.0f * gf_PI, 0.1f, pLight->m_fRadius);
				if (!CLightEntity::FrustumIntersection(passInfo.GetCamera(), lightCam) && !bIsPost3dRendererLight)
					continue;
			}

			if (pLight->m_pOwner)
				((CLightEntity*)pLight->m_pOwner)->UpdateCastShadowFlag(fEntDistance, passInfo);

			AddDynamicLightSource(*pLight, pLight->m_pOwner, 1, pLightEntity->m_fWSMaxViewDist > 0.f ? fEntDistance / pLightEntity->m_fWSMaxViewDist : 0.f, passInfo);
		}
	}
}

void C3DEngine::ResetCasterCombinationsCache()
{
	for (int nSunInUse = 0; nSunInUse < 2; nSunInUse++)
	{
		// clear user counters
		for (ShadowFrustumListsCacheUsers::iterator it = m_FrustumsCacheUsers[nSunInUse].begin(); it != m_FrustumsCacheUsers[nSunInUse].end(); ++it)
			it->second = 0;
	}
}

void C3DEngine::AddDynamicLightSource(const SRenderLight& LSource, ILightSource* pEnt, int nEntityLightId, float fFadeout, const SRenderingPassInfo& passInfo)
{
	assert(pEnt && _finite(LSource.m_Origin.x) && _finite(LSource.m_Origin.y) && _finite(LSource.m_fRadius));
	assert(LSource.IsOk());

	if ((LSource.m_Flags & DLF_DISABLED) || (!GetCVars()->e_DynamicLights))
	{
		for (int i = 0; i < m_lstDynLights.Count(); i++)
		{
			if (m_lstDynLights[i]->m_pOwner == pEnt)
			{
				FreeLightSourceComponents(m_lstDynLights[i]);
				m_lstDynLights.Delete(i);
			}
		}

		return;
	}

	if (m_lstDynLights.Count() == GetCVars()->e_DynamicLightsMaxCount)
		Warning("C3DEngine::AddDynamicLightSource: more than %d dynamic light sources created", GetCVars()->e_DynamicLightsMaxCount);
	else if (m_lstDynLights.Count() > GetCVars()->e_DynamicLightsMaxCount)
		return;

	if (!(LSource.m_Flags & DLF_POST_3D_RENDERER))
	{
		if (LSource.m_Flags & DLF_SUN && !(GetCVars()->e_CoverageBuffer == 2))
		{
			// sun
			IF (LSource.m_Color.Max() <= 0.0f || !GetCVars()->e_Sun, 0)
				return; // sun disabled
		}
		else if (GetCVars()->e_DynamicLightsFrameIdVisTest > 1 && (GetCVars()->e_CoverageBuffer != 2))
		{
			if (GetCVars()->e_DynamicLightsConsistentSortOrder)
				if (passInfo.GetFrameID() - pEnt->GetDrawFrame(0) > MAX_FRAME_ID_STEP_PER_FRAME)
					return;
		}

		if (GetCVars()->e_DynamicLightsFrameIdVisTest)
		{
			int nMaxReqursion = (LSource.m_Flags & DLF_THIS_AREA_ONLY) ? 2 : 3;
			if (!m_pObjManager || !m_pVisAreaManager || !m_pVisAreaManager->IsEntityVisAreaVisible(pEnt, nMaxReqursion, &LSource, passInfo))
			{
				if (LSource.m_Flags & DLF_SUN && m_pVisAreaManager && m_pVisAreaManager->m_bSunIsNeeded)
				{
					// sun may be used in indoor even if outdoor is not visible
				}
				else
					return;
			}
		}
	}

	// distance fading
	const float fFadingRange = 0.25f;
	fFadeout -= (1.f - fFadingRange);
	fFadeout = fFadeout < 0.f ? 0.f : fFadeout;
	fFadeout = 1.f - fFadeout / fFadingRange;
	assert(fFadeout > 0); // should be culled earlier

	////////////////////////////////////////////////////////////////////////////////////////////////
	// Try to update present lsource
	////////////////////////////////////////////////////////////////////////////////////////////////

	for (int i = 0; i < m_lstDynLights.Count(); i++)
	{
		SRenderLight* pRenderLight = m_lstDynLights[i];
		if (pRenderLight->m_pOwner == pEnt)
		{
			// Keep the referenced objects
			pRenderLight->CopyFrom(LSource, false);

			//reset DLF_CASTSHADOW_MAPS
			if (!passInfo.RenderShadows())
				pRenderLight->m_Flags &= ~DLF_CASTSHADOW_MAPS;

			// !HACK: Needs to decrement reference counter of shader because m_lstDynLights never release light sources
			if (pRenderLight->m_Shader.m_pShader)
				pRenderLight->m_Shader.m_pShader->Release();

			// set base params
			//pRenderLight->m_BaseOrigin = pRenderLight->m_Origin;

			ColorF cNewColor;
			IF_LIKELY ((pRenderLight->m_Flags & DLF_DEFERRED_CUBEMAPS) == 0)
				cNewColor = ColorF(pRenderLight->m_Color.r * fFadeout, pRenderLight->m_Color.g * fFadeout, pRenderLight->m_Color.b * fFadeout, pRenderLight->m_Color.a);
			else
				cNewColor = ColorF(pRenderLight->m_Color.r, pRenderLight->m_Color.g, pRenderLight->m_Color.b, clamp_tpl(fFadeout, 0.f, 1.f)); // use separate

			pRenderLight->m_pOwner = pEnt;
			pRenderLight->SetLightColor(cNewColor);
			pRenderLight->m_n3DEngineUpdateFrameID = passInfo.GetMainFrameID();

			return;
		}
	}

	////////////////////////////////////////////////////////////////////////////////////////////////
	// Add new lsource into list and set some parameters
	////////////////////////////////////////////////////////////////////////////////////////////////

	SRenderLight* pRenderLight = new SRenderLight(LSource);

	// add ref to avoid shader deleting
	if (pRenderLight->m_Shader.m_pShader)
		pRenderLight->m_Shader.m_pShader->AddRef();

	pRenderLight->m_pOwner = pEnt;
	pRenderLight->SetLightColor(ColorF(pRenderLight->m_Color.r * fFadeout, pRenderLight->m_Color.g * fFadeout, pRenderLight->m_Color.b * fFadeout, pRenderLight->m_Color.a));
	pRenderLight->m_n3DEngineUpdateFrameID = passInfo.GetMainFrameID();

	m_lstDynLights.Add(pRenderLight);
}

void C3DEngine::PrepareLightSourcesForRendering_0(const SRenderingPassInfo& passInfo)
{
	FUNCTION_PROFILER_3DENGINE;

	m_lstDynLightsNoLight.Clear();

	bool bWarningPrinted = false;

	// update lmasks in terrain sectors
	if (passInfo.IsRecursivePass())
	{
		// do not delete lsources during recursion, becasue hmap lpasses are shared between levels
		for (int i = 0; i < m_nRealLightsNum && i < m_lstDynLights.Count(); i++)
		{
			m_lstDynLights[i]->m_Id = -1;
		}
	}
	else
	{
		for (int i = 0; i < m_lstDynLights.Count(); i++)
		{
			SRenderLight* pLight = m_lstDynLights[i];
			CLightEntity* pLightEntity = (CLightEntity*)pLight->m_pOwner;

			pLight->m_Id = -1;

			if (!pLightEntity->IsVisible(AABB(), 0.0f, passInfo))
			{
				FreeLightSourceComponents(pLight);
				m_lstDynLights.Delete(i);
				i--;
				continue; // invisible
			}

			if (pLight->m_Flags & DLF_DEFERRED_LIGHT)
			{
				if (passInfo.RenderShadows() && (pLight->m_Flags & DLF_CASTSHADOW_MAPS) && pLight->m_Id >= 0)
				{
					pLightEntity->UpdateGSMLightSourceShadowFrustum(passInfo);

					if (pLightEntity->GetShadowMapInfo())
					{
						pLight->m_pShadowMapFrustums = reinterpret_cast<ShadowMapFrustum**>(pLightEntity->GetShadowMapInfo()->pGSM);
					}
				}

				if (GetCVars()->e_DynamicLights)
				{
					AddLightToRenderer(*pLight, 1.f, passInfo);
				}

				FreeLightSourceComponents(pLight);
				m_lstDynLights.Delete(i);
				i--;
				continue;
			}

			if (GetRenderer()->EF_IsFakeDLight(pLight))
			{
				// ignored by renderer
				m_lstDynLightsNoLight.Add(pLight);
				m_lstDynLights.Delete(i);
				i--;
				continue;
			}

			const int32 nMaxLightsNum = max((int)GetCVars()->e_DynamicLightsMaxCount, MAX_LIGHTS_NUM);
			if (i >= nMaxLightsNum)
			{
				// ignored by renderer

				assert(i >= nMaxLightsNum);

				if (i >= nMaxLightsNum && !bWarningPrinted && (passInfo.GetMainFrameID() & 7) == 7)
				{
					// no more sources can be accepted by renderer
					Warning("C3DEngine::PrepareLightSourcesForRendering: No more than %d real lsources allowed on the screen", (int)nMaxLightsNum);
					bWarningPrinted = true;
				}

				FreeLightSourceComponents(pLight);
				m_lstDynLights.Delete(i);
				i--;
				continue;
			}
		}

		m_nRealLightsNum = m_lstDynLights.Count();
		m_lstDynLights.AddList(m_lstDynLightsNoLight);

		m_lstDynLightsNoLight.Clear();
	}
}

void C3DEngine::PrepareLightSourcesForRendering_1(const SRenderingPassInfo& passInfo)
{
	FUNCTION_PROFILER_3DENGINE;

	// reset lists of lsource pointers in sectors
	if (passInfo.IsRecursivePass())
	{
		// do not delete lsources during recursion, becasue hmap lpasses are shared between levels
		for (int i = 0; i < m_nRealLightsNum && i < m_lstDynLights.Count(); i++)
		{
			SRenderLight* pLight = m_lstDynLights[i];

			pLight->m_Id = -1;
			GetRenderer()->EF_ADDDlight(pLight, passInfo);
			assert(pLight->m_Id == i);
		}
	}
	else
	{
		for (int i = 0; i < m_nRealLightsNum && i < m_lstDynLights.Count(); i++)
		{
			SRenderLight* pLight = m_lstDynLights[i];

			pLight->m_Id = -1;
			if (pLight->m_Flags & DLF_SUN || GetCVars()->e_DynamicLightsConsistentSortOrder)
				CheckAddLight(pLight, passInfo);
		}

		for (int i = m_nRealLightsNum; i < m_lstDynLights.Count(); i++)
		{
			SRenderLight* pLight = m_lstDynLights[i];

			// ignored by renderer
			pLight->m_Id = -1;
			GetRenderer()->EF_ADDDlight(pLight, passInfo);
			assert(pLight->m_Id == -1);
		}
	}

	if (GetCVars()->e_DynamicLights == 2)
	{
		for (int i = 0; i < m_lstDynLights.Count(); i++)
		{
			const SRenderLight* pLight = m_lstDynLights[i];

			float fSize = 0.05f * (sinf(GetCurTimeSec() * 10.f) + 2.0f);
			DrawSphere(pLight->m_Origin, fSize, pLight->m_Color);
			IRenderAuxText::DrawLabelF(pLight->m_Origin, 1.3f, "id=%d, rad=%.1f, vdr=%d", pLight->m_Id, pLight->m_fRadius, (int)(pLight->m_pOwner ? pLight->m_pOwner->m_ucViewDistRatio : 0));
		}
	}
}

void C3DEngine::InitShadowFrustums(const SRenderingPassInfo& passInfo)
{
	FUNCTION_PROFILER_3DENGINE;

	for (int i = 0; i < m_nRealLightsNum && i < m_lstDynLights.Count(); i++)
	{
		SRenderLight* pLight = m_lstDynLights[i];
		CLightEntity* pLightEntity = (CLightEntity*)pLight->m_pOwner;

		if (passInfo.RenderShadows() && (pLight->m_Flags & DLF_CASTSHADOW_MAPS) && pLight->m_Id >= 0)
		{
			pLightEntity->UpdateGSMLightSourceShadowFrustum(passInfo);

			if (pLightEntity->GetShadowMapInfo())
			{
				pLight->m_pShadowMapFrustums = reinterpret_cast<ShadowMapFrustum**>(pLightEntity->GetShadowMapInfo()->pGSM);
			}
		}

		IMaterial* pMat = pLightEntity->GetMaterial();
		if (pMat)
			pLight->m_Shader = pMat->GetShaderItem();

		// update copy of light ion the renderer
		if (pLight->m_Id >= 0)
		{
			SRenderLight& light = passInfo.GetIRenderView()->GetDynamicLight(pLight->m_Id);

			assert(pLight->m_Id == light.m_Id);
			light.m_pShadowMapFrustums = pLight->m_pShadowMapFrustums;
			light.m_Shader = pLight->m_Shader;
			light.m_Flags = pLight->m_Flags;
		}
	}

	// add per object shadow frustums
	m_nCustomShadowFrustumCount = 0;
	if (passInfo.RenderShadows() && GetCVars()->e_ShadowsPerObject > 0)
	{
		ILightSource* pSun = GetSunEntity();
		if (pSun)
		{
			const uint nFrustumCount = m_lstPerObjectShadows.size();
			if (nFrustumCount > m_lstCustomShadowFrustums.size())
				m_lstCustomShadowFrustums.resize(nFrustumCount, nullptr);

			for (uint i = 0; i < nFrustumCount; ++i)
			{
				if (m_lstPerObjectShadows[i].pCaster)
				{
					ShadowMapFrustum*& pFr = m_lstCustomShadowFrustums[i];
					if (!pFr)
					{
						pFr = new ShadowMapFrustum();
						pFr->AddRef();
					}

					CLightEntity::InitShadowFrustum_OBJECT(pFr, &m_lstPerObjectShadows[i], pSun, passInfo);
					++m_nCustomShadowFrustumCount;
				}
			}
		}
	}

	//shadows frustums intersection test
	if (GetCVars()->e_ShadowsDebug == 4)
	{
		for (int i = 0; i < m_nRealLightsNum && i < m_lstDynLights.Count(); i++)
		{
			for (int j = (m_nRealLightsNum - 1); j >= (i + 1); j--)
			{

				SRenderLight* pLight = m_lstDynLights[i];
				CLightEntity* pLightEntity1 = (CLightEntity*)pLight->m_pOwner;

				pLight = m_lstDynLights[j];
				CLightEntity* pLightEntity2 = (CLightEntity*)pLight->m_pOwner;

				pLightEntity1->CheckFrustumsIntersect(pLightEntity2);
			}
		}
	}

	if (passInfo.RenderShadows())
		ResetCasterCombinationsCache();
}

void C3DEngine::AddPerObjectShadow(IShadowCaster* pCaster, float fConstBias, float fSlopeBias, float fJitter, const Vec3& vBBoxScale, uint nTexSize)
{
	SPerObjectShadow* pOS = GetPerObjectShadow(pCaster);
	if (!pOS)
		pOS = &m_lstPerObjectShadows.AddNew();

	const bool bRequiresObjTreeUpdate = pOS->pCaster != pCaster;

	pOS->pCaster = pCaster;
	pOS->fConstBias = fConstBias;
	pOS->fSlopeBias = fSlopeBias;
	pOS->fJitter = fJitter;
	pOS->vBBoxScale = vBBoxScale;
	pOS->nTexSize = nTexSize;

	if (bRequiresObjTreeUpdate)
	{
		CRY_PROFILE_FUNCTION(PROFILE_3DENGINE);
		static_cast<IRenderNode*>(pCaster)->MarkAsUncompiled();
	}
}

void C3DEngine::RemovePerObjectShadow(IShadowCaster* pCaster)
{
	SPerObjectShadow* pOS = GetPerObjectShadow(pCaster);
	if (pOS)
	{
		CRY_PROFILE_FUNCTION(PROFILE_3DENGINE);
		static_cast<IRenderNode*>(pCaster)->MarkAsUncompiled();

		size_t nIndex = (size_t)(pOS - m_lstPerObjectShadows.begin());
		m_lstPerObjectShadows.Delete(nIndex);
	}
}

struct SPerObjectShadow* C3DEngine::GetPerObjectShadow(IShadowCaster* pCaster)
{
	for (int i = 0; i < m_lstPerObjectShadows.Count(); ++i)
		if (m_lstPerObjectShadows[i].pCaster == pCaster)
			return &m_lstPerObjectShadows[i];

	return NULL;
}

void C3DEngine::GetCustomShadowMapFrustums(ShadowMapFrustum**& arrFrustums, int& nFrustumCount)
{
	if (!m_lstCustomShadowFrustums.empty())
	{
		arrFrustums = reinterpret_cast<ShadowMapFrustum**>(&m_lstCustomShadowFrustums[0]);
		nFrustumCount = m_nCustomShadowFrustumCount;
	}
	else
	{
		arrFrustums = nullptr;
		nFrustumCount = 0;
	}
}

void C3DEngine::FreeLightSourceComponents(SRenderLight* pLight, bool bDeleteLight)
{
	FUNCTION_PROFILER_3DENGINE;

	//  delete pLight->m_pProjCamera;
	//pLight->m_pProjCamera=0;

	//if(pLight->m_pShader)
	//		SAFE_RELEASE(pLight->m_pShader);

	if (bDeleteLight)
		SAFE_DELETE(pLight);
}

namespace
{
static inline bool CmpCastShadowFlag(const SRenderLight* p1, const SRenderLight* p2)
{
	// move sun first
	if ((p1->m_Flags & DLF_SUN) > (p2->m_Flags & DLF_SUN))
		return true;
	else if ((p1->m_Flags & DLF_SUN) < (p2->m_Flags & DLF_SUN))
		return false;

	// move shadow casters first
	if ((p1->m_Flags & DLF_CASTSHADOW_MAPS) > (p2->m_Flags & DLF_CASTSHADOW_MAPS))
		return true;
	else if ((p1->m_Flags & DLF_CASTSHADOW_MAPS) < (p2->m_Flags & DLF_CASTSHADOW_MAPS))
		return false;

	// get some sorting consistency for shadow casters
	if (p1->m_pOwner > p2->m_pOwner)
		return true;
	else if (p1->m_pOwner < p2->m_pOwner)
		return false;

	return false;
}
}

//////////////////////////////////////////////////////////////////////////

void C3DEngine::UpdateLightSources(const SRenderingPassInfo& passInfo)
{
	FUNCTION_PROFILER_3DENGINE;

	m_LightVolumesMgr.Clear(passInfo);

	// sort by cast shadow flag
	if (passInfo.IsGeneralPass())
		std::sort(m_lstDynLights.begin(), m_lstDynLights.end(), CmpCastShadowFlag);

	// process lsources
	for (int i = 0; i < m_lstDynLights.Count(); i++)
	{
		SRenderLight* pLight = m_lstDynLights[i];

		bool bDeleteNow = GetRenderer()->EF_UpdateDLight(pLight);

		if (pLight->m_n3DEngineUpdateFrameID < (passInfo.GetMainFrameID() - 2) || pLight->m_Flags & DLF_DISABLED)
			bDeleteNow = true; // light is too old

		if (bDeleteNow)
		{
			// time is come to delete this lsource
			FreeLightSourceComponents(pLight);
			m_lstDynLights.Delete(i);
			i--;
			continue;
		}

		if (passInfo.IsGeneralPass())
			SetupLightScissors(m_lstDynLights[i], passInfo);
	}
}

//////////////////////////////////////////////////////////////////////////

bool IsSphereInsideHull(const SPlaneObject* pHullPlanes, int nPlanesNum, const Sphere& objSphere);

void C3DEngine::SetupLightScissors(SRenderLight* pLight, const SRenderingPassInfo& passInfo) const
{
	const CCamera& pCam = passInfo.GetCamera();
	Vec3 vViewVec = pLight->m_Origin - pCam.GetPosition();
	float fDistToLS = vViewVec.GetLength();

	// Use max of width/height for area lights.
	float fMaxRadius = pLight->m_fRadius;
	if (pLight->m_Flags & DLF_DEFERRED_CUBEMAPS)
		fMaxRadius = pLight->m_ProbeExtents.len();  // This is not optimal for a box

	ITexture* pLightTexture = pLight->m_pLightImage ? pLight->m_pLightImage : pLight->m_pLightDynTexSource ? pLight->m_pLightDynTexSource->GetTexture() : NULL;
	bool bProjectiveLight = (pLight->m_Flags & DLF_PROJECT) && pLightTexture && !(pLightTexture->GetFlags() & FT_REPLICATE_TO_ALL_SIDES);
	bool bInsideLightVolume = fDistToLS <= fMaxRadius;
	if (bInsideLightVolume && !bProjectiveLight)
	{
		//optimization when we are inside light frustum
		pLight->m_sX = 0;
		pLight->m_sY = 0;
		pLight->m_sWidth = pCam.GetViewSurfaceX();
		pLight->m_sHeight = pCam.GetViewSurfaceZ();

		return;
	}

	Matrix44 mProj, mView;
	mProj = pCam.GetRenderProjectionMatrix();
	mView = pCam.GetRenderViewMatrix();

	Vec3 vCenter = pLight->m_Origin;
	float fRadius = fMaxRadius;

	const int nMaxVertsToProject = 10;
	int nVertsToProject = 4;
	Vec3 pBRectVertices[nMaxVertsToProject];

	Vec4 vCenterVS = Vec4(vCenter, 1) * mView;

	if (!bInsideLightVolume)
	{
		// Compute tangent planes
		float r = fRadius;
		float sq_r = r * r;

		Vec3 vLPosVS = Vec3(vCenterVS.x, vCenterVS.y, vCenterVS.z);
		float lx = vLPosVS.x;
		float ly = vLPosVS.y;
		float lz = vLPosVS.z;
		float sq_lx = lx * lx;
		float sq_ly = ly * ly;
		float sq_lz = lz * lz;

		// Compute left and right tangent planes to light sphere
		float sqrt_d = sqrt_tpl(max(sq_r * sq_lx - (sq_lx + sq_lz) * (sq_r - sq_lz), 0.0f));
		float nx = iszero(sq_lx + sq_lz) ? 1.0f : (r * lx + sqrt_d) / (sq_lx + sq_lz);
		float nz = iszero(lz) ? 1.0f : (r - nx * lx) / lz;

		Vec3 vTanLeft = Vec3(nx, 0, nz).normalized();

		nx = iszero(sq_lx + sq_lz) ? 1.0f : (r * lx - sqrt_d) / (sq_lx + sq_lz);
		nz = iszero(lz) ? 1.0f : (r - nx * lx) / lz;
		Vec3 vTanRight = Vec3(nx, 0, nz).normalized();

		pBRectVertices[0] = vLPosVS - r * vTanLeft;
		pBRectVertices[1] = vLPosVS - r * vTanRight;

		// Compute top and bottom tangent planes to light sphere
		sqrt_d = sqrt_tpl(max(sq_r * sq_ly - (sq_ly + sq_lz) * (sq_r - sq_lz), 0.0f));
		float ny = iszero(sq_ly + sq_lz) ? 1.0f : (r * ly - sqrt_d) / (sq_ly + sq_lz);
		nz = iszero(lz) ? 1.0f : (r - ny * ly) / lz;
		Vec3 vTanBottom = Vec3(0, ny, nz).normalized();

		ny = iszero(sq_ly + sq_lz) ? 1.0f : (r * ly + sqrt_d) / (sq_ly + sq_lz);
		nz = iszero(lz) ? 1.0f : (r - ny * ly) / lz;
		Vec3 vTanTop = Vec3(0, ny, nz).normalized();

		pBRectVertices[2] = vLPosVS - r * vTanTop;
		pBRectVertices[3] = vLPosVS - r * vTanBottom;
	}

	if (bProjectiveLight)
	{

		// todo: improve/simplify projective case

		Vec3 vRight = pLight->m_ObjMatrix.GetColumn2();
		Vec3 vUp = -pLight->m_ObjMatrix.GetColumn1();
		Vec3 pDirFront = pLight->m_ObjMatrix.GetColumn0();
		pDirFront.NormalizeFast();

		// Cone radius
		float fConeAngleThreshold = 0.0f;
		float fConeRadiusScale = /*min(1.0f,*/ tan_tpl((pLight->m_fLightFrustumAngle + fConeAngleThreshold) * (gf_PI / 180.0f));  //);
		float fConeRadius = fRadius * fConeRadiusScale;

		Vec3 pDiagA = (vUp + vRight);
		float fDiagLen = 1.0f / pDiagA.GetLengthFast();
		pDiagA *= fDiagLen;

		Vec3 pDiagB = (vUp - vRight);
		pDiagB *= fDiagLen;

		float fPyramidBase = sqrt_tpl(fConeRadius * fConeRadius * 2.0f);
		pDirFront *= fRadius;

		Vec3 pEdgeA = (pDirFront + pDiagA * fPyramidBase);
		Vec3 pEdgeA2 = (pDirFront - pDiagA * fPyramidBase);
		Vec3 pEdgeB = (pDirFront + pDiagB * fPyramidBase);
		Vec3 pEdgeB2 = (pDirFront - pDiagB * fPyramidBase);

		uint32 nOffset = 4;

		// Check whether the camera is inside the extended bounding sphere that contains pyramid

#if 0 // Don't early out, is possible that sphere test results in reasonable bounds
		if (fDistToLS * fDistToLS <= fRadius * fRadius + fPyramidBase * fPyramidBase)
		{
			const uint32 nPlanes = 5;
			SPlaneObject planes[nPlanes];

			Vec3 NormA = pEdgeA.Cross(pEdgeB);
			Vec3 NormB = pEdgeB.Cross(pEdgeA2);
			Vec3 NormC = pEdgeA2.Cross(pEdgeB2);
			Vec3 NormD = pEdgeB2.Cross(pEdgeA);

			planes[0].plane = Plane::CreatePlane(NormA, vCenter);
			planes[1].plane = Plane::CreatePlane(NormB, vCenter);
			planes[2].plane = Plane::CreatePlane(NormC, vCenter);
			planes[3].plane = Plane::CreatePlane(NormD, vCenter);
			planes[4].plane = Plane::CreatePlane(-pDirFront, vCenter + pEdgeA);

			Sphere CamPosSphere(pCam.GetPosition(), 0.001f);

			if (IsSphereInsideHull(planes, nPlanes, CamPosSphere))
			{
				// we are inside light frustum
				pLight->m_sX = 0;
				pLight->m_sY = 0;
				pLight->m_sWidth = GetRenderer()->GetWidth();
				pLight->m_sHeight = GetRenderer()->GetHeight();

				return;
			}
		}
#endif

		// Put all pyramid vertices in view space
		Vec4 pPosVS = Vec4(vCenter, 1) * mView;
		pBRectVertices[nOffset++] = Vec3(pPosVS.x, pPosVS.y, pPosVS.z);
		pPosVS = Vec4(vCenter + pEdgeA, 1) * mView;
		pBRectVertices[nOffset++] = Vec3(pPosVS.x, pPosVS.y, pPosVS.z);
		pPosVS = Vec4(vCenter + pEdgeB, 1) * mView;
		pBRectVertices[nOffset++] = Vec3(pPosVS.x, pPosVS.y, pPosVS.z);
		pPosVS = Vec4(vCenter + pEdgeA2, 1) * mView;
		pBRectVertices[nOffset++] = Vec3(pPosVS.x, pPosVS.y, pPosVS.z);
		pPosVS = Vec4(vCenter + pEdgeB2, 1) * mView;
		pBRectVertices[nOffset++] = Vec3(pPosVS.x, pPosVS.y, pPosVS.z);

		nVertsToProject = nOffset;
	}

	Vec3 vPMin = Vec3(1, 1, 999999.0f);
	Vec2 vPMax = Vec2(0, 0);
	Vec2 vMin = Vec2(1, 1);
	Vec2 vMax = Vec2(0, 0);

	int nStart = 0;

	if (bInsideLightVolume)
	{
		nStart = 4;
		vMin = Vec2(0, 0);
		vMax = Vec2(1, 1);
	}

	if (GetCVars()->e_ScissorDebug)
		mView.Invert();

	// Project all vertices
	for (int i = nStart; i < nVertsToProject; i++)
	{
		if (GetCVars()->e_ScissorDebug)
		{
			if (GetRenderer()->GetIRenderAuxGeom() != NULL)
			{
				Vec4 pVertWS = Vec4(pBRectVertices[i], 1) * mView;
				Vec3 v = Vec3(pVertWS.x, pVertWS.y, pVertWS.z);
				GetRenderer()->GetIRenderAuxGeom()->DrawPoint(v, RGBA8(0xff, 0xff, 0xff, 0xff), 10);

				int32 nPrevVert = (i - 1) < 0 ? nVertsToProject - 1 : (i - 1);
				pVertWS = Vec4(pBRectVertices[nPrevVert], 1) * mView;
				Vec3 v2 = Vec3(pVertWS.x, pVertWS.y, pVertWS.z);
				GetRenderer()->GetIRenderAuxGeom()->DrawLine(v, RGBA8(0xff, 0xff, 0x0, 0xff), v2, RGBA8(0xff, 0xff, 0x0, 0xff), 3.0f);
			}
		}

		Vec4 vScreenPoint = Vec4(pBRectVertices[i], 1.0) * mProj;

		// convert to NDC
		vScreenPoint.w = max(vScreenPoint.w, 0.00000000000001f);
		vScreenPoint /= vScreenPoint.w;
		vScreenPoint.x = max(-1.0f, min(1.0f, vScreenPoint.x));
		vScreenPoint.y = max(-1.0f, min(1.0f, vScreenPoint.y));

		//output coords
		//generate viewport (x=0,y=0,height=1,width=1)
		Vec2 vWin;
		vWin.x = (1.0f + vScreenPoint.x) * 0.5f;
		vWin.y = (1.0f + vScreenPoint.y) * 0.5f;   //flip coords for y axis

		assert(vWin.x >= 0.0f && vWin.x <= 1.0f);
		assert(vWin.y >= 0.0f && vWin.y <= 1.0f);

		if (bProjectiveLight && i >= 4)
		{
			// Get light pyramid screen bounds
			vPMin.x = min(vPMin.x, vWin.x);
			vPMin.y = min(vPMin.y, vWin.y);
			vPMax.x = max(vPMax.x, vWin.x);
			vPMax.y = max(vPMax.y, vWin.y);

			vPMin.z = min(vPMin.z, vScreenPoint.z); // if pyramid intersects the nearplane, the test is unreliable. (requires proper clipping)
		}
		else
		{
			// Get light sphere screen bounds
			vMin.x = min(vMin.x, vWin.x);
			vMin.y = min(vMin.y, vWin.y);
			vMax.x = max(vMax.x, vWin.x);
			vMax.y = max(vMax.y, vWin.y);
		}
	}

	int iWidth = pCam.GetViewSurfaceX();
	int iHeight = pCam.GetViewSurfaceZ();
	float fWidth = (float)iWidth;
	float fHeight = (float)iHeight;

	if (bProjectiveLight)
	{
		vPMin.x = (float)__fsel(vPMin.z, vPMin.x, vMin.x); // Use sphere bounds if pyramid bounds are unreliable
		vPMin.y = (float)__fsel(vPMin.z, vPMin.y, vMin.y);
		vPMax.x = (float)__fsel(vPMin.z, vPMax.x, vMax.x);
		vPMax.y = (float)__fsel(vPMin.z, vPMax.y, vMax.y);

		// Clamp light pyramid bounds to light sphere screen bounds
		vMin.x = clamp_tpl<float>(vPMin.x, vMin.x, vMax.x);
		vMin.y = clamp_tpl<float>(vPMin.y, vMin.y, vMax.y);
		vMax.x = clamp_tpl<float>(vPMax.x, vMin.x, vMax.x);
		vMax.y = clamp_tpl<float>(vPMax.y, vMin.y, vMax.y);
	}

	pLight->m_sX = (short)(vMin.x * fWidth);
	pLight->m_sY = (short)((1.0f - vMax.y) * fHeight);
	pLight->m_sWidth = (short)ceilf((vMax.x - vMin.x) * fWidth);
	pLight->m_sHeight = (short)ceilf((vMax.y - vMin.y) * fHeight);

	// make sure we don't create a scissor rect out of bound (D3DError)
	pLight->m_sWidth = (pLight->m_sX + pLight->m_sWidth) > iWidth ? iWidth - pLight->m_sX : pLight->m_sWidth;
	pLight->m_sHeight = (pLight->m_sY + pLight->m_sHeight) > iHeight ? iHeight - pLight->m_sY : pLight->m_sHeight;

#if !defined(RELEASE)
	if (GetCVars()->e_ScissorDebug == 2)
	{
		// Render 2d areas additively on screen
		IRenderAuxGeom* pAuxRenderer = gEnv->pRenderer->GetIRenderAuxGeom();
		if (pAuxRenderer)
		{
			SAuxGeomRenderFlags oldRenderFlags = pAuxRenderer->GetRenderFlags();

			SAuxGeomRenderFlags newRenderFlags;
			newRenderFlags.SetDepthTestFlag(e_DepthTestOff);
			newRenderFlags.SetAlphaBlendMode(e_AlphaAdditive);
			newRenderFlags.SetMode2D3DFlag(e_Mode2D);
			pAuxRenderer->SetRenderFlags(newRenderFlags);

			const float screenWidth = float(pAuxRenderer->GetCamera().GetViewSurfaceX());
			const float screenHeight = float(pAuxRenderer->GetCamera().GetViewSurfaceZ());

			// Calc resolve area
			const float left = pLight->m_sX / screenWidth;
			const float top = pLight->m_sY / screenHeight;
			const float right = (pLight->m_sX + pLight->m_sWidth) / screenWidth;
			const float bottom = (pLight->m_sY + pLight->m_sHeight) / screenHeight;

			// Render resolve area
			ColorB areaColor(50, 0, 50, 255);

			if (vPMin.z < 0.0f)
			{
				areaColor = ColorB(0, 100, 0, 255);
			}

			const uint vertexCount = 6;
			const Vec3 vert[vertexCount] = {
				Vec3(left,  top,    0.0f),
				Vec3(left,  bottom, 0.0f),
				Vec3(right, top,    0.0f),
				Vec3(left,  bottom, 0.0f),
				Vec3(right, bottom, 0.0f),
				Vec3(right, top,    0.0f)
			};
			pAuxRenderer->DrawTriangles(vert, vertexCount, areaColor);

			// Set previous Aux render flags back again
			pAuxRenderer->SetRenderFlags(oldRenderFlags);
		}
	}
#endif
}

void C3DEngine::RemoveEntityLightSources(IRenderNode* pEntity)
{
	for (int i = 0; i < m_lstDynLights.Count(); i++)
	{
		if (m_lstDynLights[i]->m_pOwner == pEntity)
		{
			FreeLightSourceComponents(m_lstDynLights[i]);
			m_lstDynLights.Delete(i);
			i--;
		}
	}

	for (int i = 0; i < m_lstStaticLights.Count(); i++)
	{
		if (m_lstStaticLights[i] == pEntity)
		{
			m_lstStaticLights.Delete(i);
			if (pEntity == m_pSun)
				m_pSun = NULL;
			i--;
		}
	}
}

float C3DEngine::GetLightAmountInRange(const Vec3& pPos, float fRange, bool bAccurate)
{
	static Vec3 pPrevPos(0, 0, 0);
	static float fPrevLightAmount = 0.0f, fPrevRange = 0.0f;

	CVisAreaManager* pVisAreaMan(GetVisAreaManager());
	if (!pVisAreaMan)
	{
		return 0.0f;
	}

	// Return cached result instead ( should also check if lights position/range changes - but how todo efficiently.. ? )
	if (fPrevLightAmount != 0.0f && fPrevRange == fRange && pPrevPos.GetSquaredDistance(pPos) < 0.25f)
	{
		return fPrevLightAmount;
	}

	CVisArea* pCurrVisArea(static_cast<CVisArea*>(Get3DEngine()->GetVisAreaFromPos(pPos)));

	Vec3 pAmb;
	if (pCurrVisArea)
		pAmb = pCurrVisArea->GetFinalAmbientColor();
	else
		pAmb = Get3DEngine()->GetSkyColor();

	// Take into account ambient lighting first
	float fAmbLength(pAmb.len2());
	if (fAmbLength > 1.0f)
	{
		// Normalize color (for consistently working with HDR/LDR)
		pAmb /= sqrt_tpl(fAmbLength);
	}

	float fLightAmount((pAmb.x + pAmb.y + pAmb.z) / 3.0f);

	for (int l(0); l < m_lstStaticLights.Count(); ++l)
	{
		SRenderLight& pLight = m_lstStaticLights[l]->GetLightProperties();

		if ((pLight.m_Flags & (DLF_FAKE | DLF_VOLUMETRIC_FOG_ONLY)))
		{
			// Fake and volumetric fog only light source not needed for light amount
			continue;
		}

		CVisArea* pLightVisArea(static_cast<CVisArea*>(m_lstStaticLights[l]->GetEntityVisArea()));

		if