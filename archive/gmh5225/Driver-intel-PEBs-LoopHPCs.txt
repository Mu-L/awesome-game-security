Project Path: arc_gmh5225_Driver-intel-PEBs-LoopHPCs_vpfiqxhf

Source Tree:

```txt
arc_gmh5225_Driver-intel-PEBs-LoopHPCs_vpfiqxhf
├── BranchMonitor.suo
├── BranchMonitor.v11.suo
├── LoopHPCs.filters
├── LoopHPCs.inf
├── LoopHPCs.rc
├── LoopHPCs.sdf
├── LoopHPCs.sln
├── LoopHPCs.sln.bak
├── LoopHPCs.v11.suo
├── LoopHPCs.vcxproj
├── LoopHPCs.vcxproj.bak
├── LoopHPCs.vcxproj.user
├── MyCode.c
├── README.md
├── StopThread.c
├── Test.c
├── UpgradeLog.XML
├── _UpgradeReport_Files
│   ├── UpgradeReport.css
│   ├── UpgradeReport.xslt
│   ├── UpgradeReport_Minus.gif
│   └── UpgradeReport_Plus.gif
├── simple-pebs.c
├── simple-pebs.h
├── src
│   ├── IO
│   │   ├── IO.c
│   │   └── IO.h
│   ├── LBR
│   │   ├── LBR.c
│   │   └── LBR.h
│   ├── LoopHPCs.c
│   ├── MagicCheck
│   │   ├── MagicCheck.c
│   │   └── MagicCheck.h
│   ├── PMI.c
│   ├── Threading
│   │   ├── SuspendThread.cpp
│   │   ├── SuspendThread.h
│   │   ├── thread.c
│   │   └── thread.h
│   ├── WriteFile
│   │   ├── WriteFile.c
│   │   └── WriteFile.h
│   ├── checks
│   │   ├── apic
│   │   │   └── apic.c
│   │   ├── checks.c
│   │   ├── checks.h
│   │   └── cpu
│   │       └── cpuid.c
│   ├── config.h
│   ├── dbg
│   │   ├── debug.c
│   │   └── debug.h
│   ├── device
│   │   ├── device.c
│   │   └── device.h
│   ├── ioctl.h
│   └── list
│       ├── list.c
│       └── list.h
└── x64
    └── Win7Release
        ├── BranchMonitor.Build.CppClean.log
        ├── BranchMonitor.log
        ├── CL.read.1.tlog
        ├── CL.write.1.tlog
        ├── IO.obj
        ├── LBR.obj
        ├── LoopHPCs.Build.CppClean.log
        ├── LoopHPCs.cer
        ├── LoopHPCs.inf
        ├── LoopHPCs.lastbuildstate
        ├── LoopHPCs.log
        ├── LoopHPCs.obj
        ├── LoopHPCs.pdb
        ├── LoopHPCs.res
        ├── LoopHPCs.sys
        ├── MagicCheck.obj
        ├── MyCode.obj
        ├── PMI.obj
        ├── Test.obj
        ├── WriteFile.obj
        ├── apic.obj
        ├── checks.obj
        ├── cl.command.1.tlog
        ├── cpuid.obj
        ├── debug.obj
        ├── device.obj
        ├── link-cvtres.read.1.tlog
        ├── link-cvtres.write.1.tlog
        ├── link.command.1.tlog
        ├── link.read.1.tlog
        ├── link.write.1.tlog
        ├── list.obj
        ├── rc.command.1.tlog
        ├── rc.read.1.tlog
        ├── rc.write.1.tlog
        ├── signtool.command.1.tlog
        ├── signtool.read.1.tlog
        ├── signtool.write.1.tlog
        ├── simple-pebs.obj
        ├── stampinf.command.1.tlog
        ├── stampinf.read.1.tlog
        ├── stampinf.write.1.tlog
        ├── thread.obj
        └── vc110.pdb

```

`LoopHPCs.filters`:

```filters
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <Filter Include="Source Files">
      <UniqueIdentifier>{4FC737F1-C7A5-4376-A066-2A32D752A2FF}</UniqueIdentifier>
      <Extensions>cpp;c;cc;cxx;def;odl;idl;hpj;bat;asm;asmx</Extensions>
    </Filter>
    <Filter Include="Header Files">
      <UniqueIdentifier>{93995380-89BD-4b04-88EB-625FBE52EBFB}</UniqueIdentifier>
      <Extensions>h;hpp;hxx;hm;inl;inc;xsd</Extensions>
    </Filter>
    <Filter Include="Resource Files">
      <UniqueIdentifier>{67DA6AB6-F800-4c08-8B7A-83BB121AAD01}</UniqueIdentifier>
      <Extensions>rc;ico;cur;bmp;dlg;rc2;rct;bin;rgs;gif;jpg;jpeg;jpe;resx;tiff;tif;png;wav;mfcribbon-ms</Extensions>
    </Filter>
    <Filter Include="Driver Files">
      <UniqueIdentifier>{8E41214B-6785-4CFE-B992-037D68949A14}</UniqueIdentifier>
      <Extensions>inf;inv;inx;mof;mc;</Extensions>
    </Filter>
  </ItemGroup>
  <ItemGroup>
    <Inf Include="BranchMonitor.inf">
      <Filter>Driver Files</Filter>
    </Inf>
  </ItemGroup>
  <ItemGroup>
    <ResourceCompile Include="BranchMonitor.rc">
      <Filter>Resource Files</Filter>
    </ResourceCompile>
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="src\checks\checks.c">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="src\checks\apic\apic.c">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="src\checks\cpu\cpuid.c">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="src\dbg\debug.c">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="src\device\device.c">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="src\IO\IO.c">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="src\list\list.c">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="src\Threading\thread.c">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="src\LBR\LBR.c">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="src\PMI.c">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="simple-pebs.c">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="MyCode.c">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="Test.c">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="src\MagicCheck\MagicCheck.c">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="src\WriteFile\WriteFile.c">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="src\LoopHPCs.c">
      <Filter>Source Files</Filter>
    </ClCompile>
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="src\config.h">
      <Filter>Header Files</Filter>
    </ClInclude>
    <ClInclude Include="src\checks\checks.h">
      <Filter>Header Files</Filter>
    </ClInclude>
    <ClInclude Include="src\dbg\debug.h">
      <Filter>Header Files</Filter>
    </ClInclude>
    <ClInclude Include="src\device\device.h">
      <Filter>Header Files</Filter>
    </ClInclude>
    <ClInclude Include="src\IO\IO.h">
      <Filter>Header Files</Filter>
    </ClInclude>
    <ClInclude Include="src\list\list.h">
      <Filter>Header Files</Filter>
    </ClInclude>
    <ClInclude Include="src\Threading\thread.h">
      <Filter>Header Files</Filter>
    </ClInclude>
    <ClInclude Include="src\ioctl.h">
      <Filter>Header Files</Filter>
    </ClInclude>
    <ClInclude Include="src\LBR\LBR.h">
      <Filter>Header Files</Filter>
    </ClInclude>
    <ClInclude Include="simple-pebs.h">
      <Filter>Header Files</Filter>
    </ClInclude>
    <ClInclude Include="src\MagicCheck\MagicCheck.h">
      <Filter>Header Files</Filter>
    </ClInclude>
    <ClInclude Include="src\WriteFile\WriteFile.h">
      <Filter>Header Files</Filter>
    </ClInclude>
  </ItemGroup>
</Project>
```

`LoopHPCs.inf`:

```inf
;;;
;;;LoopHPCs
;;;

[Version]
Signature   = "$Windows NT$"
; TODO - Change the Class and ClassGuid to match the Load Order Group value, see http://msdn.microsoft.com/en-us/windows/hardware/gg462963
; Class       = "ActivityMonitor"                         ;This is determined by the work this filter driver does
; ClassGuid   = {b86dff51-a31e-4bac-b3cf-e8cfe75c9fc2}    ;This value is determined by the Load Order Group value
Class = "_TODO_Change_Class_appropriately_"
ClassGuid = {_TODO_Change_ClassGuid_appropriately_}
Provider    = %ManufacturerName%
DriverVer   = 
CatalogFile = HPCs.cat

[DestinationDirs]
DefaultDestDir          = 12
MiniFilter.DriverFiles  = 12            ;%windir%\system32\drivers

;;
;; Default install sections
;;

[DefaultInstall]
OptionDesc          = %ServiceDescription%
CopyFiles           = MiniFilter.DriverFiles

[DefaultInstall.Services]
AddService          = %ServiceName%,,MiniFilter.Service

;;
;; Default uninstall sections
;;

[DefaultUninstall]
DelFiles   = MiniFilter.DriverFiles

[DefaultUninstall.Services]
DelService = %ServiceName%,0x200      ;Ensure service is stopped before deleting

;
; Services Section
;

[MiniFilter.Service]
DisplayName      = %ServiceName%
Description      = %ServiceDescription%
ServiceBinary    = %12%\%DriverName%.sys        ;%windir%\system32\drivers\
Dependencies     = "FltMgr"
ServiceType      = 2                            ;SERVICE_FILE_SYSTEM_DRIVER
StartType        = 3                            ;SERVICE_DEMAND_START
ErrorControl     = 1                            ;SERVICE_ERROR_NORMAL
; TODO - Change the Load Order Group value, see http://connect.microsoft.com/site221/content/content.aspx?ContentID=2512
; LoadOrderGroup = "FSFilter Activity Monitor"
LoadOrderGroup = "_TODO_Change_LoadOrderGroup_appropriately_"
AddReg           = MiniFilter.AddRegistry

;
; Registry Modifications
;

[MiniFilter.AddRegistry]
HKR,,"DebugFlags",0x00010001 ,0x0
HKR,,"SupportedFeatures",0x00010001,0x3
HKR,"Instances","DefaultInstance",0x00000000,%DefaultInstance%
HKR,"Instances\"%Instance1.Name%,"Altitude",0x00000000,%Instance1.Altitude%
HKR,"Instances\"%Instance1.Name%,"Flags",0x00010001,%Instance1.Flags%

;
; Copy Files
;

[MiniFilter.DriverFiles]
%DriverName%.sys

[SourceDisksFiles]
HPCs.sys = 1,,

[SourceDisksNames]
1 = %DiskId1%,,,

;;
;; String Section
;;

[Strings]
; TODO - Add your manufacturer
ManufacturerName        = "Template"
ServiceDescription      = "HPCs Mini-Filter Driver"
ServiceName             = "HPCs"
DriverName              = "HPCs"
DiskId1                 = "HPCs Device Installation Disk"

;Instances specific information.
DefaultInstance         = "HPCs Instance"
Instance1.Name          = "HPCs Instance"
; TODO - Change the altitude value, see http://connect.microsoft.com/site221/content/content.aspx?ContentID=2512
;Instance1.Altitude      = "370030"
Instance.Altitude       = "_TODO_Change_Altitude_appropriately_"
Instance1.Flags         = 0x0              ; Allow all attachments

```

`LoopHPCs.rc`:

```rc
#include <windows.h>

#include <ntverp.h>

#define VER_FILETYPE    VFT_DRV
#define VER_FILESUBTYPE VFT2_DRV_SYSTEM
#define VER_FILEDESCRIPTION_STR     "LoopHPCs Filter Driver"
#define VER_INTERNALNAME_STR        "LoopHPCs.sys"

#include "common.ver"

```

`LoopHPCs.sln`:

```sln

Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio 2012
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "LoopHPCs", "LoopHPCs.vcxproj", "{85E636CD-AE84-42B2-9226-1C133A236073}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Win7 Release|x64 = Win7 Release|x64
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{85E636CD-AE84-42B2-9226-1C133A236073}.Win7 Release|x64.ActiveCfg = Win7 Release|x64
		{85E636CD-AE84-42B2-9226-1C133A236073}.Win7 Release|x64.Build.0 = Win7 Release|x64
		{85E636CD-AE84-42B2-9226-1C133A236073}.Win7 Release|x64.Deploy.0 = Win7 Release|x64
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
EndGlobal

```

`LoopHPCs.sln.bak`:

```bak

Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio 2012
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "LoopHPCs", "BranchMonitor.vcxproj", "{85E636CD-AE84-42B2-9226-1C133A236073}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Win7 Release|x64 = Win7 Release|x64
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{85E636CD-AE84-42B2-9226-1C133A236073}.Win7 Release|x64.ActiveCfg = Win7 Release|x64
		{85E636CD-AE84-42B2-9226-1C133A236073}.Win7 Release|x64.Build.0 = Win7 Release|x64
		{85E636CD-AE84-42B2-9226-1C133A236073}.Win7 Release|x64.Deploy.0 = Win7 Release|x64
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
EndGlobal

```

`LoopHPCs.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Driver|Win32">
      <Configuration>Driver</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Driver|x64">
      <Configuration>Driver</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8 Debug|Win32">
      <Configuration>Win8 Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8 Release|Win32">
      <Configuration>Win8 Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win7 Debug|Win32">
      <Configuration>Win7 Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win7 Release|Win32">
      <Configuration>Win7 Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Vista Debug|Win32">
      <Configuration>Vista Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Vista Release|Win32">
      <Configuration>Vista Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8 Debug|x64">
      <Configuration>Win8 Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8 Release|x64">
      <Configuration>Win8 Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win7 Debug|x64">
      <Configuration>Win7 Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win7 Release|x64">
      <Configuration>Win7 Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Vista Debug|x64">
      <Configuration>Vista Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Vista Release|x64">
      <Configuration>Vista Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <ItemGroup>
    <ResourceCompile Include="LoopHPCs.rc" />
    <Inf Include="LoopHPCs.inf" />
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <ProjectGuid>{85E636CD-AE84-42B2-9226-1C133A236073}</ProjectGuid>
    <TemplateGuid>{f2f62967-0815-4fd7-9b86-6eedcac766eb}</TemplateGuid>
    <TargetFrameworkVersion>v4.5</TargetFrameworkVersion>
    <MinimumVisualStudioVersion>11.0</MinimumVisualStudioVersion>
    <Configuration>Win8 Debug</Configuration>
    <Platform Condition="'$(Platform)' == ''">Win32</Platform>
  </PropertyGroup>
  <PropertyGroup Label="Globals">
    <RootNamespace>BranchMonitor</RootNamespace>
    <VCTargetsPath Condition="'$(VCTargetsPath11)' != '' and '$(VisualStudioVersion)' == '11.0'">$(VCTargetsPath11)</VCTargetsPath>
    <ProjectName>LoopHPCs</ProjectName>
  </PropertyGroup>
  <PropertyGroup Label="PropertySheets">
    <PlatformToolset>WindowsKernelModeDriver8.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Debug|Win32'" Label="Configuration">
    <TargetVersion>Windows8</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Release|Win32'" Label="Configuration">
    <TargetVersion>Windows8</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Debug|Win32'" Label="Configuration">
    <TargetVersion>Windows7</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Release|Win32'" Label="Configuration">
    <TargetVersion>Windows7</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Driver|Win32'" Label="Configuration">
    <TargetVersion>Windows7</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Vista Debug|Win32'" Label="Configuration">
    <TargetVersion>Vista</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Vista Release|Win32'" Label="Configuration">
    <TargetVersion>Vista</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Debug|x64'" Label="Configuration">
    <TargetVersion>Windows8</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Release|x64'" Label="Configuration">
    <TargetVersion>Windows8</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Debug|x64'" Label="Configuration">
    <TargetVersion>Windows7</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Release|x64'" Label="Configuration">
    <TargetVersion>Windows7</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Driver|x64'" Label="Configuration">
    <TargetVersion>Windows7</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Vista Debug|x64'" Label="Configuration">
    <TargetVersion>Vista</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Vista Release|x64'" Label="Configuration">
    <TargetVersion>Vista</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="ExtensionSettings">
  </ImportGroup>
  <ImportGroup Label="PropertySheets">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <PropertyGroup Label="UserMacros" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Debug|x64'">
    <IncludePath>C:\BranchMonitoringProject\BranchMonitor\src;$(IncludePath)</IncludePath>
  </PropertyGroup>
  <PropertyGroup>
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">
    <TargetExt>.sys</TargetExt>
    <ExecutablePath>d:\WinDDK\7600.16385.1\bin\amd64;$(ExecutablePath)</ExecutablePath>
    <IncludePath>D:\WinDDK\7600.16385.1\inc;D:\WinDDK\7600.16385.1\inc\ddk;D:\WinDDK\7600.16385.1\inc\api;.\src;$(IncludePath)</IncludePath>
    <LibraryPath>D:\WinDDK\7600.16385.1\lib\win7\amd64;$(LibraryPath)</LibraryPath>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Release|x64'">
    <IncludePath>.\src;$(IncludePath)</IncludePath>
    <OutDir>$(SolutionDir)$(Platform)\$(ConfigurationName)\</OutDir>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Release|Win32'">
    <IncludePath>.\src;$(IncludePath)</IncludePath>
    <OutDir>c:\</OutDir>
  </PropertyGroup>
  <ItemDefinitionGroup>
    <Link>
      <AdditionalDependencies>ntoskrnl.lib;Hal.lib;wdm.lib;wdmsec.lib;wmilib.lib;%(AdditionalDependencies);ndis.lib;MSVCRT.LIB;LIBCMT.LIB</AdditionalDependencies>
      <OutputFile Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">c:\$(TargetName)$(TargetExt)</OutputFile>
      <EnableUAC Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">false</EnableUAC>
      <SubSystem Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">Console</SubSystem>
      <EntryPointSymbol Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">DriverEntry</EntryPointSymbol>
      <BaseAddress Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">0X10000</BaseAddress>
      <OutputFile Condition="'$(Configuration)|$(Platform)'=='Win7 Release|x64'">$(OutDir)$(TargetName)$(TargetExt)</OutputFile>
      <OutputFile Condition="'$(Configuration)|$(Platform)'=='Win7 Release|Win32'">c:\$(TargetName)$(TargetExt)</OutputFile>
    </Link>
    <ClCompile>
      <AdditionalIncludeDirectories Condition="'$(Configuration)|$(Platform)'=='Win8 Debug|x64'">%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
      <WarningLevel Condition="'$(Configuration)|$(Platform)'=='Win8 Debug|x64'">TurnOffAllWarnings</WarningLevel>
    </ClCompile>
    <ClCompile>
      <AdditionalIncludeDirectories Condition="'$(Configuration)|$(Platform)'=='Win8 Debug|Win32'">C:\Users\marcus\Documents\BranchMonitor\src;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
    </ClCompile>
    <ClCompile>
      <PreprocessorDefinitions Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">WIN32=100;_X86_=1;WINVER=0x501;DBG=1</PreprocessorDefinitions>
      <CallingConvention Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">StdCall</CallingConvention>
      <ExceptionHandling Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">false</ExceptionHandling>
      <BufferSecurityCheck Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">false</BufferSecurityCheck>
      <CompileAs Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">CompileAsC</CompileAs>
      <RuntimeLibrary Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">MultiThreadedDebug</RuntimeLibrary>
      <Optimization Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">Disabled</Optimization>
    </ClCompile>
    <ClCompile>
      <TreatWarningAsError Condition="'$(Configuration)|$(Platform)'=='Win7 Release|x64'">false</TreatWarningAsError>
      <PreprocessorDefinitions Condition="'$(Configuration)|$(Platform)'=='Win7 Release|x64'">_WIN64;_AMD64_;AMD64;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <SDLCheck Condition="'$(Configuration)|$(Platform)'=='Win7 Release|x64'">false</SDLCheck>
    </ClCompile>
  </ItemDefinitionGroup>
  <ItemGroup>
    <FilesToPackage Include="$(TargetPath)" />
    <FilesToPackage Include="@(Inf->'%(CopyOutput)')" Condition="'@(Inf)'!=''" />
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="MyCode.c" />
    <ClCompile Include="simple-pebs.c" />
    <ClCompile Include="src\LoopHPCs.c" />
    <ClCompile Include="src\checks\apic\apic.c" />
    <ClCompile Include="src\checks\checks.c" />
    <ClCompile Include="src\checks\cpu\cpuid.c" />
    <ClCompile Include="src\dbg\debug.c" />
    <ClCompile Include="src\device\device.c" />
    <ClCompile Include="src\IO\IO.c" />
    <ClCompile Include="src\LBR\LBR.c" />
    <ClCompile Include="src\list\list.c" />
    <ClCompile Include="src\MagicCheck\MagicCheck.c" />
    <ClCompile Include="src\PMI.c" />
    <ClCompile Include="src\Threading\thread.c" />
    <ClCompile Include="src\WriteFile\WriteFile.c" />
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="simple-pebs.h" />
    <ClInclude Include="src\checks\checks.h" />
    <ClInclude Include="src\config.h" />
    <ClInclude Include="src\dbg\debug.h" />
    <ClInclude Include="src\device\device.h" />
    <ClInclude Include="src\ioctl.h" />
    <ClInclude Include="src\IO\IO.h" />
    <ClInclude Include="src\LBR\LBR.h" />
    <ClInclude Include="src\list\list.h" />
    <ClInclude Include="src\MagicCheck\MagicCheck.h" />
    <ClInclude Include="src\Threading\thread.h" />
    <ClInclude Include="src\WriteFile\WriteFile.h" />
  </ItemGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <ImportGroup Label="ExtensionTargets">
  </ImportGroup>
</Project>
```

`LoopHPCs.vcxproj.bak`:

```bak
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Driver|Win32">
      <Configuration>Driver</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Driver|x64">
      <Configuration>Driver</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8 Debug|Win32">
      <Configuration>Win8 Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8 Release|Win32">
      <Configuration>Win8 Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win7 Debug|Win32">
      <Configuration>Win7 Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win7 Release|Win32">
      <Configuration>Win7 Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Vista Debug|Win32">
      <Configuration>Vista Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Vista Release|Win32">
      <Configuration>Vista Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8 Debug|x64">
      <Configuration>Win8 Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8 Release|x64">
      <Configuration>Win8 Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win7 Debug|x64">
      <Configuration>Win7 Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win7 Release|x64">
      <Configuration>Win7 Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Vista Debug|x64">
      <Configuration>Vista Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Vista Release|x64">
      <Configuration>Vista Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <ItemGroup>
    <ResourceCompile Include="LoopHPCs.rc" />
    <Inf Include="BranchMonitor.inf" />
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <ProjectGuid>{85E636CD-AE84-42B2-9226-1C133A236073}</ProjectGuid>
    <TemplateGuid>{f2f62967-0815-4fd7-9b86-6eedcac766eb}</TemplateGuid>
    <TargetFrameworkVersion>v4.5</TargetFrameworkVersion>
    <MinimumVisualStudioVersion>11.0</MinimumVisualStudioVersion>
    <Configuration>Win8 Debug</Configuration>
    <Platform Condition="'$(Platform)' == ''">Win32</Platform>
  </PropertyGroup>
  <PropertyGroup Label="Globals">
    <RootNamespace>BranchMonitor</RootNamespace>
    <VCTargetsPath Condition="'$(VCTargetsPath11)' != '' and '$(VisualStudioVersion)' == '11.0'">$(VCTargetsPath11)</VCTargetsPath>
    <ProjectName>LoopHPCs</ProjectName>
  </PropertyGroup>
  <PropertyGroup Label="PropertySheets">
    <PlatformToolset>WindowsKernelModeDriver8.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Debug|Win32'" Label="Configuration">
    <TargetVersion>Windows8</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Release|Win32'" Label="Configuration">
    <TargetVersion>Windows8</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Debug|Win32'" Label="Configuration">
    <TargetVersion>Windows7</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Release|Win32'" Label="Configuration">
    <TargetVersion>Windows7</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Driver|Win32'" Label="Configuration">
    <TargetVersion>Windows7</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Vista Debug|Win32'" Label="Configuration">
    <TargetVersion>Vista</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Vista Release|Win32'" Label="Configuration">
    <TargetVersion>Vista</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Debug|x64'" Label="Configuration">
    <TargetVersion>Windows8</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Release|x64'" Label="Configuration">
    <TargetVersion>Windows8</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Debug|x64'" Label="Configuration">
    <TargetVersion>Windows7</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Release|x64'" Label="Configuration">
    <TargetVersion>Windows7</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Driver|x64'" Label="Configuration">
    <TargetVersion>Windows7</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Vista Debug|x64'" Label="Configuration">
    <TargetVersion>Vista</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Vista Release|x64'" Label="Configuration">
    <TargetVersion>Vista</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="ExtensionSettings">
  </ImportGroup>
  <ImportGroup Label="PropertySheets">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <PropertyGroup Label="UserMacros" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Debug|x64'">
    <IncludePath>C:\BranchMonitoringProject\BranchMonitor\src;$(IncludePath)</IncludePath>
  </PropertyGroup>
  <PropertyGroup>
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">
    <TargetExt>.sys</TargetExt>
    <ExecutablePath>d:\WinDDK\7600.16385.1\bin\amd64;$(ExecutablePath)</ExecutablePath>
    <IncludePath>D:\WinDDK\7600.16385.1\inc;D:\WinDDK\7600.16385.1\inc\ddk;D:\WinDDK\7600.16385.1\inc\api;.\src;$(IncludePath)</IncludePath>
    <LibraryPath>D:\WinDDK\7600.16385.1\lib\win7\amd64;$(LibraryPath)</LibraryPath>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Release|x64'">
    <IncludePath>.\src;$(IncludePath)</IncludePath>
    <OutDir>$(SolutionDir)$(Platform)\$(ConfigurationName)\</OutDir>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Release|Win32'">
    <IncludePath>.\src;$(IncludePath)</IncludePath>
    <OutDir>c:\</OutDir>
  </PropertyGroup>
  <ItemDefinitionGroup>
    <Link>
      <AdditionalDependencies>ntoskrnl.lib;Hal.lib;wdm.lib;wdmsec.lib;wmilib.lib;%(AdditionalDependencies);ndis.lib;MSVCRT.LIB;LIBCMT.LIB</AdditionalDependencies>
      <OutputFile Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">c:\$(TargetName)$(TargetExt)</OutputFile>
      <EnableUAC Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">false</EnableUAC>
      <SubSystem Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">Console</SubSystem>
      <EntryPointSymbol Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">DriverEntry</EntryPointSymbol>
      <BaseAddress Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">0X10000</BaseAddress>
      <OutputFile Condition="'$(Configuration)|$(Platform)'=='Win7 Release|x64'">$(OutDir)$(TargetName)$(TargetExt)</OutputFile>
      <OutputFile Condition="'$(Configuration)|$(Platform)'=='Win7 Release|Win32'">c:\$(TargetName)$(TargetExt)</OutputFile>
    </Link>
    <ClCompile>
      <AdditionalIncludeDirectories Condition="'$(Configuration)|$(Platform)'=='Win8 Debug|x64'">%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
      <WarningLevel Condition="'$(Configuration)|$(Platform)'=='Win8 Debug|x64'">TurnOffAllWarnings</WarningLevel>
    </ClCompile>
    <ClCompile>
      <AdditionalIncludeDirectories Condition="'$(Configuration)|$(Platform)'=='Win8 Debug|Win32'">C:\Users\marcus\Documents\BranchMonitor\src;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
    </ClCompile>
    <ClCompile>
      <PreprocessorDefinitions Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">WIN32=100;_X86_=1;WINVER=0x501;DBG=1</PreprocessorDefinitions>
      <CallingConvention Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">StdCall</CallingConvention>
      <ExceptionHandling Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">false</ExceptionHandling>
      <BufferSecurityCheck Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">false</BufferSecurityCheck>
      <CompileAs Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">CompileAsC</CompileAs>
      <RuntimeLibrary Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">MultiThreadedDebug</RuntimeLibrary>
      <Optimization Condition="'$(Configuration)|$(Platform)'=='Driver|x64'">Disabled</Optimization>
    </ClCompile>
    <ClCompile>
      <TreatWarningAsError Condition="'$(Configuration)|$(Platform)'=='Win7 Release|x64'">false</TreatWarningAsError>
      <PreprocessorDefinitions Condition="'$(Configuration)|$(Platform)'=='Win7 Release|x64'">_WIN64;_AMD64_;AMD64;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <SDLCheck Condition="'$(Configuration)|$(Platform)'=='Win7 Release|x64'">false</SDLCheck>
    </ClCompile>
  </ItemDefinitionGroup>
  <ItemGroup>
    <FilesToPackage Include="$(TargetPath)" />
    <FilesToPackage Include="@(Inf->'%(CopyOutput)')" Condition="'@(Inf)'!=''" />
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="MyCode.c" />
    <ClCompile Include="simple-pebs.c" />
    <ClCompile Include="src\LoopHPCs.c" />
    <ClCompile Include="src\checks\apic\apic.c" />
    <ClCompile Include="src\checks\checks.c" />
    <ClCompile Include="src\checks\cpu\cpuid.c" />
    <ClCompile Include="src\dbg\debug.c" />
    <ClCompile Include="src\device\device.c" />
    <ClCompile Include="src\IO\IO.c" />
    <ClCompile Include="src\LBR\LBR.c" />
    <ClCompile Include="src\list\list.c" />
    <ClCompile Include="src\MagicCheck\MagicCheck.c" />
    <ClCompile Include="src\PMI.c" />
    <ClCompile Include="src\Threading\thread.c" />
    <ClCompile Include="src\WriteFile\WriteFile.c" />
    <ClCompile Include="Test.c" />
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="simple-pebs.h" />
    <ClInclude Include="src\checks\checks.h" />
    <ClInclude Include="src\config.h" />
    <ClInclude Include="src\dbg\debug.h" />
    <ClInclude Include="src\device\device.h" />
    <ClInclude Include="src\ioctl.h" />
    <ClInclude Include="src\IO\IO.h" />
    <ClInclude Include="src\LBR\LBR.h" />
    <ClInclude Include="src\list\list.h" />
    <ClInclude Include="src\MagicCheck\MagicCheck.h" />
    <ClInclude Include="src\Threading\thread.h" />
    <ClInclude Include="src\WriteFile\WriteFile.h" />
  </ItemGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <ImportGroup Label="ExtensionTargets">
  </ImportGroup>
</Project>
```

`LoopHPCs.vcxproj.user`:

```user
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Release|x64'">
    <SignMode>TestSign</SignMode>
    <TestCertificate>CN="WDKTestCert Administrator,132700495930313205" | 5CF3ECF084BFFC5D2F900F4980AA70CE3111AFFA</TestCertificate>
  </PropertyGroup>
</Project>
```

`MyCode.c`:

```c
#include "dbg\debug.h"
#include "list\list.h"
#include "simple-pebs.h"
#include "LBR\LBR.h"
#include "checks\checks.h"


#define _ECX_MAX_  0x10000
#define _ECX_MIN_  0x10
                                                                                                                                                                                                                                                                                                                                                                                                                                                  
extern PTDS_BASE DS_BASE;

// ISR 
/**************************************************
Overflow Reason
1: store overflow
2: branch overflow
**************************************************/ 
BOOLEAN  bRepMov=FALSE ;
BOOLEAN  bTraceDLA=FALSE ;
UINT64 ddLastDataLA=0;
BOOLEAN bIPinBin=FALSE;
PLIST_ENTRY tempList=NULL;

UINT64  ddBlackList=0;

void MyCode()
{
	UINT64 ddEventingIP=0;
	UINT64 ddNextIP=0;
	UINT64 ddDataLA=0;
	UINT64 ecx=0;
	UINT64 esi=0;
	UINT64 edi=0;
	UINT64 esp=0;
	UINT64 currentEsp=0;
	UINT64 status;
	UINT64 flags;
	UINT64 dse; //Data Source Encoding
	UINT64 lat; //Latency value (core cycles)

	UINT64  ddStores=0;
	unsigned char * pByte=NULL; 
	int Layer=0;
	BOOLEAN bStoreOverflow=FALSE;
	struct pebs_v1 *pebs, *end;
	UINT64  pebs_index=0;
	PDLA 	tempDataLA=NULL;
	PLIST_ENTRY	removed_DLAofMyCode=NULL;
	PLoopList Find_content=NULL;

	PLoopList Find_Loop=NULL;
	PLIST_ENTRY nextLoop=NULL;
	PLIST_ENTRY nextDLA=NULL;
	PDATALA	DLA_Content=NULL;
	char Code[3]={0};
	 	KIRQL OldIrql;
		KIRQL OldIrql2;

	end = (struct pebs_v1 *)DS_BASE->pebs_index;
	// if(IndexofClose==1&&bPrint_pebs_index)
	if(DS_BASE->pebs_index>DS_BASE->pebs_base&&bPrint_pebs_index)
	{
		DbgPrint("pebs_index=%d",(DS_BASE->pebs_index-DS_BASE->pebs_base)/pebs_record_size);
		bPrint_pebs_index=FALSE;
	}

	 pebs = (struct pebs_v1 *)DS_BASE->pebs_base;
	 while(pebs< end)
	{
			 pebs = (struct pebs_v1 *)((char *)pebs + pebs_record_size);
	 }
	 pebs = (struct pebs_v1 *)((char *)pebs- pebs_record_size);

	
	//for (pebs = (struct pebs_v1 *)DS_BASE->pebs_base; pebs< end  ;	pebs = (struct pebs_v1 *)((char *)pebs + pebs_record_size))
	{
	}// end of  for (pebs = (struct pebs_v1 *)DS_BASE->pebs_base; 
		ddEventingIP = ((struct pebs_v2 *)pebs)->eventing_ip&0x00000000FFFFFFFF;
		ddDataLA=((struct pebs_v1 *)pebs)->dataLA&0x00000000FFFFFFFF;
		ddNextIP=((struct pebs_v1 *)pebs)->ip&0x00000000FFFFFFFF;                                                                                                                                                                                                                                                                                                                   
		ecx=((struct pebs_v1 *)pebs)->cx;
		edi=((struct pebs_v1 *)pebs)->di;
		esi=((struct pebs_v1 *)pebs)->si;

		esp=((struct pebs_v1 *)pebs)->sp;
		status=((struct pebs_v1 *)pebs)->status;
		flags=((struct pebs_v1 *)pebs)->flags;
		dse=((struct pebs_v1 *)pebs)->dse;
		lat=((struct pebs_v1 *)pebs)->lat;

		pByte=(unsigned char *)ddEventingIP;
		bRepMov=FALSE;
		bTraceDLA=FALSE ;

		MyDbgPrint("[MyCode]  pebs_index%d: ddEventingIP=%08X,ddNextIP=%08X, ddDataLA=%08X ",pebs_index, ddEventingIP,ddNextIP,ddDataLA);
		pebs_index++;
		//IP not in Bin
		if( ddEventingIP>=_MAX_BIN_||ddNextIP>=_MAX_BIN_||ddDataLA>=_MAX_BIN_)
		{
			return;
			//continue;
		}

		if(ddEventingIP==ddNextIP)
		{
			DbgPrint("[MyCode]  pebs_index%d: ddEventingIP=%08X,ddNextIP=%08X, ddDataLA=%08X ",pebs_index, ddEventingIP,ddNextIP,ddDataLA);
		}

			//Identify the loop 
			get_LBR(DLAListHeader,ddEventingIP,ddNextIP, esp);
	//	}
	return;
}
```

`README.md`:

```md
# LoopHPCs: loop-centric HPCs profiling .


# Introduction
LoopHPCs is an loop-centric HPCs profiling framework.
In the framework, we profile the loop structure of a running program with the help of two hardware mechanisms: LBR and PEBs.
LoopHPCs is suitable to analysis the malware which has distinct hot loop at run-time. The current version of LoopHPCs focus on binary unpacking. In the future, we plan to extend it to analyze other types of malware, such as ransomware and cryptojacking.

# Installation
## requiremtns
Our framework is tested on Windows 10.
before build the framework, corresponding versions of visual studio 2015 (or above)and wdk 10 need to be installed.



# Usage
To load compiled dirver of LoopHPCs into OS, the user can leaverage a driver load tool (e.g., DriverMonitor) or develop a custom driver load application.
The output information can by caputure by the tool of Dbgview.


        


```

`StopThread.c`:

```c
//进程结束内幕：
//openprocess--->NtOpenProcess->ObOpenObjectByPointer--->NtTerminateProcess--->ObReferenceObjectByHandle--->PsGetNextProcessThread--->PspTerminateThreadByPointer--->KeInitializeApc/KeInsertQueueApc--->PspExitThread
//
//
//原理：遍历进程所有线程---初始化APC---插入APC
//结束线程的内核Apc例程

#define PS_CROSS_THREAD_FLAGS_SYSTEM 0x00000010UL

typedef enum _KAPC_ENVIRONMENT {
	OriginalApcEnvironment,
	AttachedApcEnvironment,
	CurrentApcEnvironment,
	InsertApcEnvironment
} KAPC_ENVIRONMENT;

void KeInitializeApc (
	PKAPC Apc,
	PETHREAD Thread,
	KAPC_ENVIRONMENT Environment,
	PKKERNEL_ROUTINE KernelRoutine,
	PKRUNDOWN_ROUTINE RundownRoutine,
	PKNORMAL_ROUTINE NormalRoutine,
	KPROCESSOR_MODE ProcessorMode,
	PVOID NormalContext
	);

BOOLEAN KeInsertQueueApc(PKAPC Apc,PVOID SystemArg1,PVOID SystemArg2,KPRIORITY Increment);

VOID KernelKillThreadRoutine(IN PKAPC Apc,
							 IN OUT PKNORMAL_ROUTINE *NormalRoutine,
							 IN OUT PVOID *NormalContext,
							 IN OUT PVOID *SystemArgument1,
							 IN OUT PVOID *SystemArgument2)
{
	//调用PsTerminateSystemThread结束线程
	//修改当前线程的ThreadFlags为系统线程
	PULONG ThreadFlags;
	ExFreePool(Apc); //释放APC
	ThreadFlags=(ULONG *)((ULONG)PsGetCurrentThread()+0x248); //ETHREAD中CrossThreadFlags的偏移量为0x248
	if(MmIsAddressValid(ThreadFlags)) //地址进行下验证
	{
		*ThreadFlags=(*ThreadFlags) | PS_CROSS_THREAD_FLAGS_SYSTEM; //修改为系统权限
		PsTerminateSystemThread(STATUS_SUCCESS); //结束系统线程，需要修改权限
		//PspExitThread(STATUS_SUCCESS);根据PspTerminateThreadByPointer定位PspExitThread地址
	}
}


VOID KillProcessWithApc(ULONG epro)
{
	//遍历线程有2种做法：1、PsGetNextProcessThread(未导出函数，自己定位地址) 2、从EPROCESS的list链中ActiveThreads记录线程数量
	//3、遍历pspcidtable
	BOOLEAN status;
	PKAPC ExitApc=NULL;
	PEPROCESS eprocess;
	PETHREAD ethread;
	ULONG i;
	ULONG num; //线程数量
	ULONG Head; //链表头
	ULONG address;//地址
	num=*(ULONG *)(epro+0x1a0); //EPROCESS中ActiveThreads的数量 0x1a0是EPROCESS中ActiveThread的偏移量
	KdPrint(("[RecordThreadAddress] num: 0x%x\n",num)); //打印线程数量
	Head=epro+0x190; //List_entry第一个节点地址
	for(i=0;i<num;i++)
	{
		//记录线程地址
		Head=(ULONG)((PLIST_ENTRY)Head)->Flink;
		address=Head-0x22c;
		KdPrint(("[RecordThreadAddress] address: 0x%x\n",address)); //打印线程地址
		ethread=(PETHREAD)address; //转换成线程指针
		ExitApc=(PKAPC)ExAllocatePoolWithTag(NonPagedPool,sizeof(KAPC),MEM_TAG);
		if(ExitApc==NULL)
		{
			KdPrint(("[KillProcessWithApc] malloc memory failed \n"));
			return;
		}
		KeInitializeApc(ExitApc,
			ethread, //线程
			OriginalApcEnvironment,
			KernelKillThreadRoutine,
			NULL,
			NULL,
			KernelMode,
			NULL);//为线程初始化APC
		status=KeInsertQueueApc(ExitApc,ExitApc,NULL,2); //插入Apc到线程队列
		if(status==STATUS_SUCCESS)
			KdPrint(("KeInsertQueueApc success\n"));
		else
			KdPrint(("KeInsertQueueApc failed\n"));
	}
}

//https://blog.csdn.net/u013761036/article/details/60469572
typedef NTSTATUS(__fastcall *ZWTERMINATETHREAD)(HANDLE hThread, ULONG uExitCode);
ZWTERMINATETHREAD ZwTerminateThread = 0Xfffff80012345678; //要修改这个值
//正规方法结束线程
void ZwKillThread()
{
	HANDLE hThread = NULL;
	CLIENT_ID ClientId;
	OBJECT_ATTRIBUTES oa;
	//填充 CID
	ClientId.UniqueProcess = 0;
	ClientId.UniqueThread = (HANDLE)1234; //这里修改为你要的 TID
	//填充 OA
	oa.Length = sizeof(oa);
	oa.RootDirectory = 0;
	oa.ObjectName = 0;
	oa.Attributes = 0;
	oa.SecurityDescriptor = 0;
	oa.SecurityQualityOfService = 0;
	//打开进程，如果句柄有效，则结束进程
	ZwOpenProcess(&hThread, 1, &oa, &ClientId);
	if (hThread)
	{
		ZwTerminateThread(hThread, 0);
		ZwClose(hThread);
	};
}

```

`Test.c`:

```c
#ifdef _TEST_
  This is just a test for BoS
#endif
```

`UpgradeLog.XML`:

```XML
<?xml version="1.0" encoding="UTF-8"?><?xml-stylesheet type='text/xsl' href='_UpgradeReport_Files/UpgradeReport.xslt'?><UpgradeLog>
<Properties><Property Name="Solution" Value="BranchMonitor">
</Property><Property Name="解决方案文件" Value="E:\Paper\WorkingPE\Ref\HA\BTS\BMF\TOP18_Src\BranchMonitoringProject-master\BranchMonitor.NMI\BranchMonitor.sln">
</Property><Property Name="Date" Value="2019年4月7日 星期日">
</Property><Property Name="Time" Value="19:37">
</Property></Properties><Event ErrorLevel="0" Project="" Source="BranchMonitor.sln" Description="文件已成功备份为 E:\Paper\WorkingPE\Ref\HA\BTS\BMF\TOP18_Src\BranchMonitoringProject-master\BranchMonitor.NMI\BranchMonitor.sln.old">
</Event><Event ErrorLevel="3" Project="BranchMonitor" Source="BranchMonitor.vcxproj" Description="无需转换">
</Event><Event ErrorLevel="3" Project="BranchMonitor Package" Source="..\BranchMonitor Package\BranchMonitor Package.vcxproj" Description="无需转换">
</Event><Event ErrorLevel="2" Project="BranchMonitor" Source="BranchMonitor.vcxproj" Description="">
</Event><Event ErrorLevel="2" Project="BranchMonitor Package" Source="..\BranchMonitor Package\BranchMonitor Package.vcxproj" Description="">
</Event><Event ErrorLevel="0" Project="" Source="BranchMonitor.sln" Description="成功转换解决方案">
</Event><Event ErrorLevel="3" Project="" Source="BranchMonitor.sln" Description="Converted">
</Event></UpgradeLog>
```

`_UpgradeReport_Files/UpgradeReport.css`:

```css
BODY
{
	BACKGROUND-COLOR: white;
	FONT-FAMILY: "Verdana", sans-serif;
	FONT-SIZE: 100%;
	MARGIN-LEFT: 0px;
	MARGIN-TOP: 0px
}
P
{
	FONT-FAMILY: "Verdana", sans-serif;
	FONT-SIZE: 70%;
	LINE-HEIGHT: 12pt;
	MARGIN-BOTTOM: 0px;
	MARGIN-LEFT: 10px;
	MARGIN-TOP: 10px
}
.note
{
	BACKGROUND-COLOR:  #ffffff;
	COLOR: #336699;
	FONT-FAMILY: "Verdana", sans-serif;
	FONT-SIZE: 100%;
	MARGIN-BOTTOM: 0px;
	MARGIN-LEFT: 0px;
	MARGIN-TOP: 0px;
	PADDING-RIGHT: 10px
}
.infotable
{
	BACKGROUND-COLOR: #f0f0e0;
	BORDER-BOTTOM: #ffffff 0px solid;
	BORDER-COLLAPSE: collapse;
	BORDER-LEFT: #ffffff 0px solid;
	BORDER-RIGHT: #ffffff 0px solid;
	BORDER-TOP: #ffffff 0px solid;
	FONT-SIZE: 70%;
	MARGIN-LEFT: 10px
}
.issuetable
{
	BACKGROUND-COLOR: #ffffe8;
	BORDER-COLLAPSE: collapse;
	COLOR: #000000;
	FONT-SIZE: 100%;
	MARGIN-BOTTOM: 10px;
	MARGIN-LEFT: 13px;
	MARGIN-TOP: 0px
}
.issuetitle
{
	BACKGROUND-COLOR: #ffffff;
	BORDER-BOTTOM: #dcdcdc 1px solid;
	BORDER-TOP: #dcdcdc 1px;
	COLOR: #003366;
	FONT-WEIGHT: normal
}
.header
{
	BACKGROUND-COLOR: #cecf9c;
	BORDER-BOTTOM: #ffffff 1px solid;
	BORDER-LEFT: #ffffff 1px solid;
	BORDER-RIGHT: #ffffff 1px solid;
	BORDER-TOP: #ffffff 1px solid;
	COLOR: #000000;
	FONT-WEIGHT: bold
}
.issuehdr
{
	BACKGROUND-COLOR: #E0EBF5;
	BORDER-BOTTOM: #dcdcdc 1px solid;
	BORDER-TOP: #dcdcdc 1px solid;
	COLOR: #000000;
	FONT-WEIGHT: normal
}
.issuenone
{
	BACKGROUND-COLOR: #ffffff;
	BORDER-BOTTOM: 0px;
	BORDER-LEFT: 0px;
	BORDER-RIGHT: 0px;
	BORDER-TOP: 0px;
	COLOR: #000000;
	FONT-WEIGHT: normal
}
.content
{
	BACKGROUND-COLOR: #e7e7ce;
	BORDER-BOTTOM: #ffffff 1px solid;
	BORDER-LEFT: #ffffff 1px solid;
	BORDER-RIGHT: #ffffff 1px solid;
	BORDER-TOP: #ffffff 1px solid;
	PADDING-LEFT: 3px
}
.issuecontent
{
	BACKGROUND-COLOR: #ffffff;
	BORDER-BOTTOM: #dcdcdc 1px solid;
	BORDER-TOP: #dcdcdc 1px solid;
	PADDING-LEFT: 3px
}
A:link
{
	COLOR: #cc6633;
	TEXT-DECORATION: underline
}
A:visited
{
	COLOR: #cc6633;
}
A:active
{
	COLOR: #cc6633;
}
A:hover
{
	COLOR: #cc3300;
	TEXT-DECORATION: underline
}
H1
{
	BACKGROUND-COLOR: #003366;
	BORDER-BOTTOM: #336699 6px solid;
	COLOR: #ffffff;
	FONT-SIZE: 130%;
	FONT-WEIGHT: normal;
	MARGIN: 0em 0em 0em -20px;
	PADDING-BOTTOM: 8px;
	PADDING-LEFT: 30px;
	PADDING-TOP: 16px
}
H2
{
	COLOR: #000000;
	FONT-SIZE: 80%;
	FONT-WEIGHT: bold;
	MARGIN-BOTTOM: 3px;
	MARGIN-LEFT: 10px;
	MARGIN-TOP: 20px;
	PADDING-LEFT: 0px
}
H3
{
	COLOR: #000000;
	FONT-SIZE: 80%;
	FONT-WEIGHT: bold;
	MARGIN-BOTTOM: -5px;
	MARGIN-LEFT: 10px;
	MARGIN-TOP: 20px
}
H4
{
	COLOR: #000000;
	FONT-SIZE: 70%;
	FONT-WEIGHT: bold;
	MARGIN-BOTTOM: 0px;
	MARGIN-TOP: 15px;
	PADDING-BOTTOM: 0px
}
UL
{
	COLOR: #000000;
	FONT-SIZE: 70%;
	LIST-STYLE: square;
	MARGIN-BOTTOM: 0pt;
	MARGIN-TOP: 0pt
}
OL
{
	COLOR: #000000;
	FONT-SIZE: 70%;
	LIST-STYLE: square;
	MARGIN-BOTTOM: 0pt;
	MARGIN-TOP: 0pt
}
LI
{
	LIST-STYLE: square;
	MARGIN-LEFT: 0px
}
.expandable
{
	CURSOR: hand
}
.expanded
{
	color: black
}
.collapsed
{
	DISPLAY: none
}
.foot
{
BACKGROUND-COLOR: #ffffff;
BORDER-BOTTOM: #cecf9c 1px solid;
BORDER-TOP: #cecf9c 2px solid
}
.settings
{
MARGIN-LEFT: 25PX;
}
.help
{
TEXT-ALIGN: right;
margin-right: 10px;
}

```

`_UpgradeReport_Files/UpgradeReport.xslt`:

```xslt
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt">

    <xsl:key name="ProjectKey" match="Event" use="@Project"/>

    <xsl:template match="Events" mode="createProjects">
        <projects>
            <xsl:for-each select="Event">
                <!--xsl:sort select="@Project" order="descending"/-->
                <xsl:if test="(1=position()) or (preceding-sibling::*[1]/@Project != @Project)">

                    <xsl:variable name="ProjectName" select="@Project"/>

                    <project>
                        <xsl:attribute name="name">
                            <xsl:value-of select="@Project"/>
                        </xsl:attribute> 

                        <xsl:if test="@Project=''">
                        <xsl:attribute name="solution">
                            <xsl:value-of select="@Solution"/>
                        </xsl:attribute> 
                        </xsl:if>

                        <xsl:for-each select="key('ProjectKey', $ProjectName)">
                            <!--xsl:sort select="@Source" /-->
                            <xsl:if test="(1=position()) or (preceding-sibling::*[1]/@Source != @Source)">

                                <source>
                                    <xsl:attribute name="name">
                                        <xsl:value-of select="@Source"/>
                                    </xsl:attribute>

                                    <xsl:variable name="Source">
                                        <xsl:value-of select="@Source"/>
                                    </xsl:variable>

                                    <xsl:for-each select="key('ProjectKey', $ProjectName)[ @Source = $Source ]">

                                        <event>
                                            <xsl:attribute name="error-level">
                                                <xsl:value-of select="@ErrorLevel"/>
                                            </xsl:attribute> 
                                            <xsl:attribute name="description">
                                                <xsl:value-of select="@Description"/>
                                            </xsl:attribute> 
                                        </event>
                                    </xsl:for-each>
                                </source>
                            </xsl:if>
                        </xsl:for-each>

                    </project>
                </xsl:if>
            </xsl:for-each>
        </projects>
    </xsl:template>

    <xsl:template match="projects">
    <xsl:for-each select="project">
    <xsl:sort select="@Name" order="ascending"/>
        <h2>
        <xsl:if test="@solution"><a _locID="Solution">解决方案</a>: <xsl:value-of select="@solution"/></xsl:if>
        <xsl:if test="not(@solution)"><a _locID="Project">项目</a>: <xsl:value-of select="@name"/>
            <xsl:for-each select="source">
                <xsl:variable name="Hyperlink" select="@name"/>
            <xsl:for-each select="event[@error-level='4']">
             <A class="note"><xsl:attribute name="HREF"><xsl:value-of select="$Hyperlink"/></xsl:attribute><xsl:value-of select="@description"/></A>
                </xsl:for-each>
            </xsl:for-each>
        </xsl:if>
        </h2>

        <table cellpadding="2" cellspacing="0" width="98%" border="1" bordercolor="white" class="infotable">
            <tr>
                <td nowrap="1" class="header" _locID="Filename">文件名</td>
                <td nowrap="1" class="header" _locID="Status">状态</td>
                <td nowrap="1" class="header" _locID="Errors">错误</td>
                <td nowrap="1" class="header" _locID="Warnings">警告</td>
            </tr>

            <xsl:for-each select="source">
                <xsl:sort select="@name" order="ascending"/>
                <xsl:variable name="source-id" select="generate-id(.)"/>

                <xsl:if test="count(event)!=count(event[@error-level='4'])">

                <tr class="row">
                    <td class="content">
                        <A HREF="javascript:"><xsl:attribute name="onClick">javascript:document.images['<xsl:value-of select="$source-id"/>'].click()</xsl:attribute><IMG border="0" _locID="IMG.alt" _locAttrData="alt" alt="展开/折叠节" class="expandable" height="11" onclick="changepic()" src="_UpgradeReport_Files/UpgradeReport_Plus.gif" width="9"><xsl:attribute name="name"><xsl:value-of select="$source-id"/></xsl:attribute><xsl:attribute name="child">src<xsl:value-of select="$source-id"/></xsl:attribute></IMG></A> <xsl:value-of select="@name"/> 
                    </td>
                    <td class="content">
                        <xsl:if test="count(event[@error-level='3'])=1">
                            <xsl:for-each select="event[@error-level='3']">
                            <xsl:if test="@description='Converted'"><a _locID="Converted1">已转换</a></xsl:if>
                            <xsl:if test="@description!='Converted'"><xsl:value-of select="@description"/></xsl:if>
                            </xsl:for-each>
                        </xsl:if>
                        <xsl:if test="count(event[@error-level='3'])!=1 and count(event[@error-level='3' and @description='Converted'])!=0"><a _locID="Converted2">已转换</a>
                        </xsl:if>
                    </td>
                    <td class="content"><xsl:value-of select="count(event[@error-level='2'])"/></td>
                    <td class="content"><xsl:value-of select="count(event[@error-level='1'])"/></td>
                </tr>

                <tr class="collapsed" bgcolor="#ffffff">
                    <xsl:attribute name="id">src<xsl:value-of select="$source-id"/></xsl:attribute>

                    <td colspan="7">
                        <table width="97%" border="1" bordercolor="#dcdcdc" rules="cols" class="issuetable">
                            <tr>
                                <td colspan="7" class="issuetitle" _locID="ConversionIssues">转换报告 - <xsl:value-of select="@name"/>:</td>
                            </tr>

                            <xsl:for-each select="event[@error-level!='3']">
                                <xsl:if test="@error-level!='4'">
                                <tr>
                                    <td class="issuenone" style="border-bottom:solid 1 lightgray">
                                        <xsl:value-of select="@description"/>
                                    </td>
                                </tr>
                                </xsl:if>
                            </xsl:for-each>
                        </table>
                    </td>
                </tr>
                </xsl:if>
            </xsl:for-each>

            <tr valign="top">
                <td class="foot">
                    <xsl:if test="count(source)!=1">
                        <xsl:value-of select="count(source)"/><a _locID="file1"> 个文件</a>
                    </xsl:if>
                    <xsl:if test="count(source)=1">
                        <a _locID="file2">1 个文件</a>
                    </xsl:if>
                </td>
                <td class="foot">
					<a _locID="Converted3">已转换</a>: <xsl:value-of select="count(source/event[@error-level='3' and @description='Converted'])"/><BR/>
					<a _locID="NotConverted">未转换</a>: <xsl:value-of select="count(source) - count(source/event[@error-level='3' and @description='Converted'])"/>
                </td>
                <td class="foot"><xsl:value-of select="count(source/event[@error-level='2'])"/></td>
                <td class="foot"><xsl:value-of select="count(source/event[@error-level='1'])"/></td>
            </tr>
        </table>
    </xsl:for-each>
    </xsl:template>

    <xsl:template match="Property">
        <xsl:if test="@Name!='Date' and @Name!='Time' and @Name!='LogNumber' and @Name!='Solution'">
        <tr><td nowrap="1"><b><xsl:value-of select="@Name"/>: </b><xsl:value-of select="@Value"/></td></tr>
        </xsl:if>
    </xsl:template>

    <xsl:template match="UpgradeLog">
        <html>
            <head>
                <META HTTP-EQUIV="Content-Type" content="text/html; charset=utf-8"/>
                <link rel="stylesheet" href="_UpgradeReport_Files\UpgradeReport.css"/>
                <title _locID="ConversionReport0">转换报告 
                    <xsl:if test="Properties/Property[@Name='LogNumber']">
                        <xsl:value-of select="Properties/Property[@Name='LogNumber']/@Value"/>
                    </xsl:if>
                </title>
                <script language="javascript">
                    function outliner () {
                        oMe = window.event.srcElement
                        //get child element
                        var child = document.all[event.srcElement.getAttribute("child",false)];
                        //if child element exists, expand or collapse it.
                        if (null != child)
                            child.className = child.className == "collapsed" ? "expanded" : "collapsed";
                    }

                    function changepic() {
                        uMe = window.event.srcElement;
                        var check = uMe.src.toLowerCase();
                        if (check.lastIndexOf("upgradereport_plus.gif") != -1)
                        {
                            uMe.src = "_UpgradeReport_Files/UpgradeReport_Minus.gif"
                        }
                        else
                        {
                            uMe.src = "_UpgradeReport_Files/UpgradeReport_Plus.gif"
                        }
                    }
                </script>
            </head>
            <body topmargin="0" leftmargin="0" rightmargin="0" onclick="outliner();">
                <h1 _locID="ConversionReport">转换报告 - <xsl:value-of select="Properties/Property[@Name='Solution']/@Value"/></h1>

                <p><span class="note">
                <b _locID="TimeOfConversion">转换时间:</b>  <xsl:value-of select="Properties/Property[@Name='Date']/@Value"/>  <xsl:value-of select="Properties/Property[@Name='Time']/@Value"/><br/>
                </span></p>

                <xsl:variable name="SortedEvents">
                    <Events>
                        <xsl:for-each select="Event">
                            <xsl:sort select="@Project" order="ascending"/>
                            <xsl:sort select="@Source" order="ascending"/>
                            <xsl:sort select="@ErrorLevel" order="ascending"/>
                            <Event>
                                <xsl:attribute name="Project"><xsl:value-of select="@Project"/> </xsl:attribute> 
                                <xsl:attribute name="Solution"><xsl:value-of select="/UpgradeLog/Properties/Property[@Name='Solution']/@Value"/> </xsl:attribute> 
                                <xsl:attribute name="Source"><xsl:value-of select="@Source"/> </xsl:attribute> 
                                <xsl:attribute name="ErrorLevel"><xsl:value-of select="@ErrorLevel"/> </xsl:attribute> 
                                <xsl:attribute name="Description"><xsl:value-of select="@Description"/> </xsl:attribute> 
                            </Event>
                        </xsl:for-each>     
                    </Events>
                </xsl:variable>
                
                <xsl:variable name="Projects">
                    <xsl:apply-templates select="msxsl:node-set($SortedEvents)/*" mode="createProjects"/>
                </xsl:variable>

                <xsl:apply-templates select="msxsl:node-set($Projects)/*"/>

                <p></p><p>
                <table class="note">
                    <tr>
                        <td nowrap="1">
                            <b _locID="ConversionSettings">转换设置</b>
                        </td>
                    </tr>
                    <xsl:apply-templates select="Properties"/>
                </table></p>
            </body>
        </html>
    </xsl:template>
</xsl:stylesheet>

```

`simple-pebs.c`:

```c

#include "simple-pebs.h"
#include "dbg\debug.h"
#include "checks\checks.h"

#define wrmsrl __writemsr
#define rdmsrl __readmsr


DWORD32 	 StaticMask[Multiplexing][MAX_PMCx][4]=
{
	{	
		{ALL_BRANCHS,		0,STORE_PERIOD,0},  
		{ALL_STORES,	0,STORE_PERIOD,0},
#if MAX_PMCx >=3
		{ALL_STORES ,		0,0,0},  //PMC-ratio[0][2]  
#endif 
#if MAX_PMCx >=4
		{ALL_LOADS,		0,0,0},   //PMC-ratio[0][3]  
#endif

	},
#if Multiplexing>=2
	{	
		{ALL_BRANCHS,		0,STORE_PERIOD,0},
		{ICACHE_Misses,	0,0,0},
#if MAX_PMCx >=3
		{ALL_STORES ,		0,0,0},		 //PMC-ratio[1][2]  
	#endif 
#if MAX_PMCx >=4
		{ALL_LOADS,		0,0,0}      //PMC-ratio[1][3]  
	#endif
	},
#endif
#if Multiplexing>=3
	{
		{ALL_STORES,		0,STORE_PERIOD,0},
		{ALL_BRANCHS,	0,STORE_PERIOD,0},
		{L2_MISS ,		0,0,0},		 //PMC-ratio[2][2]  
		{L2_HIT,		0,0,0}  //PMC-ratio[2][3]  

	},
#endif
#if Multiplexing>=4
	{	
		{ALL_STORES,		0,STORE_PERIOD,0},
		{ALL_BRANCHS,	0,STORE_PERIOD,0},
		{L3_MISS ,		0,0,0},		 //PMC-ratio[3][2]  
		{L3_HIT,		0,0,0}     //PMC-ratio[3][3] 
	}
#endif
};
/*
#define Mask_BR_CONDITIONAL 0x01C4 //Precise
#define Mask_BR_NOTTAKEN  0x10C4  

#define Mask_NEAR_CALL  0x02C4 //Precise
#define   Mask_NEAR_RETURN   0x08C4 //Precise
#define  Mask_ALL_BRANCHS   0x00C4//Precise


// New Event
#define     BR_MISP_RETIRED_CONDITIONAL 0x01C5
#define BR_MISP_RETIRED_NEAR_TAKEN  0x20C5
*/
/*
//------------  precious
#define ALL_BRANCHES_PS 0x04C4
#define  Mask_ALL_LOADS   0x81D0
#define  Mask_ALL_STORES    0x82D0
#define MEM_UOPS_RETIRED_STLB_MISS_LOADS 0x11D0
#define MEM_UOPS_RETIRED_STLB_MISS_STORES 0x12D0
#define L1_MISS  0x08D1
#define L2_MISS  0x10D1
#define L3_MISS  0x20D1
#define L1_HIT  0x01D1
#define L2_HIT  0x02D1
#define L3_HIT  0x04D1
#define BR_MISP_RETIRED_All_branches_PS 0x04C4

//------------           Non precious
 #define ALL_BRANCHES 0x00C4
#define  DTLB_LOAD_MISSES_MISS_CAUSES_A_WALK 0x0108
 #define DTLB_STORE_MISSE_MISS_CAUSES_A_WALK 0x0149
#define BR_MISP_RETIRED_All_branches 0x00C5
//Feature Importance<0.01
#define LLC_Misses 0x412E
 #define ICACHE_MISSES 0x0280
#define SMC  0x04C3	
 */
/*****************************************************
					Fixed counters 
*****************************************************/

/* INST_RETIRED.ANY 
    is counted by a designated fixed counter, leaving the four 
	(eight when Hyperthreading is disabled) programmable counters available for other events.
*/
 void init_instr(){
  unsigned long long tmp;
 tmp= rdmsrl(MSR_PERF_FIXED_CTR_CTRL);
  tmp = tmp | 0x2;
	wrmsrl(MSR_PERF_FIXED_CTR_CTRL, tmp);/*enable fixed counter for #instr*/
  wrmsrl(MSR_FIXED_CTR0, 0);
}


 unsigned long long get_inst( BOOLEAN bPrint)
 {
	 if(bPrint)
	 {
		 MyDbgPrint("get_current_instr=%d ", rdmsrl(MSR_FIXED_CTR0));
	 }
	 return rdmsrl(MSR_FIXED_CTR0);
 }

  void init_cycle(){
	  unsigned long long tmp;
	  tmp=rdmsrl(MSR_PERF_FIXED_CTR_CTRL);
	  tmp = tmp | 0x20;
	  wrmsrl(MSR_PERF_FIXED_CTR_CTRL, tmp);/*enable fixed counter for #cycle*/
	  wrmsrl(MSR_FIXED_CTR1, 0);
  }

  unsigned long long get_cycle(BOOLEAN bPrint){
	  if(bPrint)
	  {
		  MyDbgPrint("get_current_cycle=%d ",rdmsrl(MSR_FIXED_CTR1));
	  }
	  return rdmsrl(MSR_FIXED_CTR1);
  }


/*****************************************************
					Programabled Counters 
*****************************************************/

 //  Config _PMCx_NUM_ (4 or 8)  pairs of ERFEVTSELx and PMCx;
  void init_PMCx(int outset)
  {
	  int i;
	  unsigned long long mask;
	  for (i=outset;i<MAX_PMCx;i++)
	  {
		  // Select the event for  MSR_IA32_EVNTSELx 
		  mask=StaticMask[Multiplex_Index][i][0]|StaticMask[Multiplex_Index][i][1]
		  | EVTSEL_EN | EVTSEL_USR;
		  wrmsrl(MSR_IA32_EVNTSEL0+i,mask);

		  __writemsr(MSR_IA32_PERFCTR0+i,-(int)StaticMask[Multiplex_Index][i][2]);
	  }  
  }


  unsigned long long  get_PMCx(int index, BOOLEAN bPrint)
  {
	  unsigned long long PMCxValue=0;


	  if(index<=NumberofPEBS-1)
	  {

		  if(bPrint)
		  {
			  MyDbgPrint("PMC%d=%d",index,(rdmsrl(MSR_IA32_PERFCTR0+index)+StaticMask[Multiplex_Index][index][_COUNTER_DELTA_]) );
		  }
		  return rdmsrl(MSR_IA32_PERFCTR0+index)+StaticMask[Multiplex_Index][index][_COUNTER_DELTA_];
	  }
	  //Invalid  PMCx
	  else
	  {
		  MyDbgPrint("[get_PMCx] NumberofPEBS=%d, Unused  PMC%d",NumberofPEBS, index);
		  return 0;
	  }
  }




 void enable_PEB( )
{
	int i;
	unsigned long long tmp=1;

	// 	DbgPrint("_PEB_PMCx =%d", _PEB_PMCx_);
	 for (i=0;i<4;i++)
	 {
		 if(tmp&_PEB_PMCx_)
		 {
			DbgPrint("enable_PEB  for PMC%d", i);
		 }
		 tmp=tmp<<1;
	 }

	 //First disable PMU to avoid races
	 __writemsr(MSR_IA32_PEBS_ENABLE, 0);
	 __writemsr(MSR_IA32_GLOBAL_CTRL, 0);


  init_instr();
	 init_cycle();	 

	 init_PMCx(0);
	
		 //enable special PMU register again 
	 wrmsrl(MSR_IA32_PEBS_ENABLE, _PEB_PMCx_);
	 tmp=	  rdmsrl(MSR_IA32_PERF_GLOBAL_CTRL);
	 // enable the  fixed counter 0-1, and PMC 0-3.
	 //20-9-19
	tmp = tmp | _Counter_;
	 wrmsrl(MSR_IA32_PERF_GLOBAL_CTRL, tmp);

	 return;
}

 void disable_PEB()
 {
	 LARGE_INTEGER pa;
	 UINT32* APIC;
	 int IndexofPMC;

	 DbgPrint("disable_PEB");

	 //get_instr(TRUE);

	 get_PMCx(PMC0,TRUE);
	 get_PMCx(PMC1,TRUE);
	 get_PMCx(PMC2,TRUE);
	 get_PMCx(PMC3,TRUE);
	 get_PMCx(PMC4,TRUE);
	 get_PMCx(PMC5,TRUE);
	 get_PMCx(PMC6,TRUE);
	 get_PMCx(PMC7,TRUE);

	 wrmsrl(MSR_IA32_PERF_GLOBAL_CTRL, 0);
	 wrmsrl(MSR_IA32_PEBS_ENABLE, 0);

	 //clear special PMU
	 for(IndexofPMC=0;IndexofPMC<MAX_PMCx;IndexofPMC++)
	 {
		 __writemsr(MSR_IA32_EVNTSEL0+IndexofPMC, 0);
		 __writemsr(MSR_IA32_PERFCTR0+IndexofPMC, 0);
	 }

	 //stop special PMU
	 __writemsr(MSR_PERF_FIXED_CTR_CTRL, 0);

	 //restore the APIC value
	 pa.QuadPart=PERF_COUNTER_APIC;
	 APIC=(UINT32*)MmMapIoSpace(pa,sizeof(UINT32),MmNonCached);
	 *APIC=ORIGINAL_APIC_VALUE;
	 MmUnmapIoSpace(APIC,sizeof(APIC));
	 //In a new thread, it must return at the end of function, otherwise, it will incur BoS.
	 return;
 }



// Changed from BTS to PEBS
void FILL_DS_WITH_BUFFER(PTDS_BASE DS_BASE,PVOID64 PEBS_BUFFER)
{
	int i;
	//memset((void *)DS_BASE->pebs_base, 0, S_PEBS_BUFFER_SIZE);
	DS_BASE->pebs_base=PEBS_BUFFER;
	/* PEBS INDEX */
		/* reset ds */
	DS_BASE->pebs_index=PEBS_BUFFER;
	/* PEBS MAX */
	DS_BASE->pebs_max=DS_BASE->pebs_base+(SIZE_PEBS_BUFFER - 1) *pebs_record_size + 1;
	/* PEBS Threshold */
	DS_BASE->pebs_thresh=(UINT64)PEBS_BUFFER+(SIZE_PEBS_BUFFER -1) * pebs_record_size;
	for (i=0;i<4;i++)
	{
		DS_BASE->pebs_reset[i]=-(int)StaticMask[Multiplex_Index][i][_PERIOD_];
	//	MyDbgPrint("DS_BASE->pebs_reset[%d]=%d",i,DS_BASE->pebs_reset[i]);	
	}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
}


void setup_PEBDS()
{
	LARGE_INTEGER pa;
	UINT32* APIC;
//	pdevice_ext ext;


// Allocate buffers
	DS_BASE= (PTDS_BASE)ExAllocatePool(NonPagedPool,sizeof(TDS_BASE));
	memset(DS_BASE, 0,sizeof(TDS_BASE));
	PEBS_BUFFER=ExAllocatePool(NonPagedPool,	pebs_record_size*SIZE_PEBS_BUFFER);
	memset(PEBS_BUFFER, 0, 	pebs_record_size*SIZE_PEBS_BUFFER);
	FILL_DS_WITH_BUFFER(DS_BASE,PEBS_BUFFER);

#ifdef _PMI_
		/* change APIC */
	pa.QuadPart=PERF_COUNTER_APIC;
	APIC=(UINT32*)MmMapIoSpace(pa,sizeof(UINT32),MmNonCached);
	*APIC=ORIGINAL_APIC_VALUE;
	MmUnmapIoSpace(APIC,sizeof(APIC));
#endif

	/* set ds area register */
	Old_DS=__readmsr(MSR_IA32_DS_AREA);
	__writemsr(MSR_DS_AREA,(UINT_PTR)DS_BASE);
	//wrmsrl(MSR_IA32_DS_AREA, (unsigned long)__this_cpu_read(cpu_ds));
	return ;
}


void clean_PEBDS(  )
{
#ifndef _PMI_
	LARGE_INTEGER pa;
	UINT32* APIC;
#endif


#ifndef _PMI_
		/* change APIC */
	pa.QuadPart=PERF_COUNTER_APIC;
	APIC=(UINT32*)MmMapIoSpace(pa,sizeof(UINT32),MmNonCached);
	*APIC=ORIGINAL_APIC_VALUE;
	MmUnmapIoSpace(APIC,sizeof(APIC));
#endif
	__writemsr(MSR_DS_AREA,(UINT_PTR)Old_DS);

	ExFreePool(PEBS_BUFFER);
	ExFreePool(DS_BASE);
}




```

`simple-pebs.h`:

```h


#pragma once
#include "config.h"
typedef unsigned long long  u64;

  void init_PMCx(int outset);

#define PERF_COUNTER_APIC 0xFEE00340
#define ORIGINAL_APIC_VALUE 254
#define MSR_DS_AREA 0x00000600

/* 
the performance event select MSRs (PerfEvtSel0 and PerfEvtSel1) 
and the performance counter MSRs (PerfCtr0 and PerfCtr1)
 These registers can be read from and written to using the RDMSR and WRMSR instructions, respectively. They can be accessed using these 
instructions only when operating at privilege level 0. The PerfCtr0 and PerfCtr1 MSRs can be read from any privilege 
level using the RDPMC (read performance-monitoring counters) instruction.

The WRMSR instruction cannot arbitrarily write to the performance-monitoring counter MSRs (PerfCtr0 and 
PerfCtr1). Instead, the lower-order 32 bits of each MSR may be written with any value, and the high-order 8 bits 
are sign-extended according to the value of bit 31. This operation allows writing both positive and negative values 
to the performance counters.
*/

//The performance-counter MSRs 
#define MSR_IA32_PERFCTR0               0x000000c1
#define MSR_IA32_PERFCTR1               0x000000c2
#define MSR_IA32_PERFCTR2               0x000000c3
#define MSR_IA32_PERFCTR3               0x000000c4
//[64-ia-32] IA32_PERFEVTSELx MSRs start at address 186H and occupy a contiguous block of MSR address space.
/*Table 18-1
EN—Enable counters
When set, performance counting is enabled in the corresponding 
performance-monitoring counter; when clear, the corresponding counter is disabled. The event logic unit for a 
UMASK must be disabled by setting IA32_PERFEVTSELx[bit 22] = 0, before writing to IA32_PMCx.
INT—APIC interrupt enable
 When set, the logical processor generates an exception through its local APIC on counter overflow.
OS—Operating system mode 
 Specifies that the selected microarchitectural condition is  counted when the logical processor is operating at privilege level 0.
USR—User Mode 
 Specifies that the selected microarchitectural condition is counted when the logical processor is operating at privilege levels 1, 2 or 3
*/

/*   ------------------------    Start and stop PMU    ------------------------
the counters begin counting following the execution of a WRMSR instruction. The counters can 
be stopped by clearing the enable counters flag or by clearing all the bits in the PerfEvtSel0 and PerfEvtSel1 MSRs.
*/
/*   ------------------------    overflows   ------------------------------------
generating a local APIC interrupt when a performance-monitoring counter overflows. 
This mechanism is enabled by setting the interrupt enable flag in either the PerfEvtSel0 or the PerfEvtSel1 MSR. 

Provide an interrupt vector for handling the counter-overflow interrupt.
• Initialize the APIC PERF local vector entry to enable handling of performance-monitor counter overflow events.
• Provide an entry in the IDT that points to a stub exception handler that returns without executing any instruc-
tions.
• Provide an event monitor driver that provides the actual interrupt handler and modifies the reserved IDT entry 
to point to its interrupt routine.

When interrupted by a counter overflow, the interrupt handler needs to perform the following actions:
• Save the instruction pointer (EIP register), code-segment selector, TSS segment selector, counter values and 
other relevant information at the time of the interrupt.
• Reset the counter to its initial setting and return from the interrupt.
*/
#define MSR_IA32_EVNTSEL0               0x00000186
#define MSR_IA32_EVNTSEL1               0x00000187
#define MSR_IA32_EVNTSEL2               0x00000188
#define MSR_IA32_EVNTSEL3               0x00000189



#define MSR_FIXED_CTR0                  0x00000309/*inst_retired.any*/
#define MSR_FIXED_CTR1                  0x0000030a/*cpu_clk_unhalted*/

#define MSR_IA32_GLOBAL_CTRL 		0x38F
#define MSR_PERF_FIXED_CTR_CTRL         0x0000038d

#define MSR_IA32_PERF_CABABILITIES  	  0x00000345
#define MSR_IA32_PERF_GLOBAL_STATUS 	  0x0000038e
// PEBS_Ov Indicates that the PEBS buffer threshold was reached and microcode scheduled a performance interrupt to indicate this condition.
#define PEBS_Ovf 62

#define MSR_IA32_PERF_GLOBAL_CTRL 	    0x0000038f
#define MSR_IA32_PERF_GLOBAL_OVF_CTRL 	0x00000390
#define MSR_IA32_PEBS_ENABLE		        0x000003f1
#define MSR_IA32_DS_AREA     		        0x00000600


#define MSR_IA32_PERF_CAPABILITIES	0x00000345

/*  18.2.3      Architectural Performance Monitoring Version 3   p3365
Each IA32_PERFEVTSELx MSR (starting at MSR address 186H) support the bit field layout defined in Figure 
18-6.
*/
#define EVTSEL_USR 1<<16
#define EVTSEL_OS  1<<17
//#define EVTSEL_OS  0/*BIT(17)*/

//INT—APIC interrupt enable
//When set, the processor generates an exception through its local APIC on counter overflow.
#define EVTSEL_INT 1<<20
//EN—Enable counter
#define EVTSEL_EN  1<<22

//20-9-19
#define 	MSR_PERF_GLOBAL_STATUS   0x0000038E
#define IA32_PERF_GLOBAL_OVF_CTRL 0x00000390 
#define  IA32_PERF_GLOBAL_STATUS_RESET 0x00000390 



unsigned long long      u64_instr;
typedef 	unsigned long long u64 ;

unsigned long long get_inst(BOOLEAN bPrint);
unsigned long long get_cycle(BOOLEAN bPrint);
 unsigned long long  get_PMCx(int index, BOOLEAN bPrint);

void enable_PEB( );
void disable_PEB( );
void setup_PEBDS(  );
void clean_PEBDS(  );


struct pebs_v1 {
	u64 flags;
	u64 ip;
	u64 ax;
	u64 bx;
	u64 cx;
	u64 dx;
	u64 si;
	u64 di;
	u64 bp;
	u64 sp;
	u64 r8;
	u64 r9;
	u64 r10;
	u64 r11;
	u64 r12;
	u64 r13;
	u64 r14;
	u64 r15;
	u64 status;
	u64 dataLA; //Data Linear Address 98H
	u64 dse; //Data Source Encoding
	u64 lat; //Latency value (core cycles)
};

typedef struct pebs_v2 {
	struct pebs_v1 v1;
	u64 eventing_ip;
	u64 tsx; // Transactional Synchronization Extensions 18.3.6.5.1    Intel TSX and PEBS Supports
}TPEBS2_BUFFER,*PTPEBS2_BUFFER;

typedef struct pebs_v3 {
	struct pebs_v2 v2;
	//Time Stamp Counter,  17.17     TIME-STAMP COUNTER (P3327)
	//monitor and identify the relative time occurrence of processor events
	u64 tsc; 

}TPEBS3_BUFFER,*PTPEBS3_BUFFER;


typedef struct st_DSBASE
{
	u64 bts_base;
	u64 bts_index;
	u64 bts_max;
	u64 bts_thresh;

	u64 pebs_base;
	u64 pebs_index;
	u64 pebs_max;
	u64 pebs_thresh;
	u64 pebs_reset[4];
}TDS_BASE,*PTDS_BASE;

PTDS_BASE DS_BASE;

PVOID64 PEBS_BUFFER;
unsigned long Old_DS;

void FILL_DS_WITH_BUFFER(PTDS_BASE DS_BASE,PVOID64 PEBS_BUFFER);


void  MyCode();



/*
Table 18-12.  PEBS Performance Events for Intel® Microarchitecture Code Name Sandy Bridge

Table 19-10.  Performance Events in the Processor Core of 4th Generation Intel® Core™ Processors

Enable specific PMC
0: INST_RETIRED.ANY_P:							EventSel=C0H, UMask=00H,
1: INST_RETIRED.PREC_DIST:					EventSel=C0H, UMask=01H, Precise
2:BR_INST_RETIRED.CONDITIONAL:		EventSel=C4H, UMask=01H, Precise 
3:BR_INST_RETIRED.NOT_TAKEN:			EventSel=C4H, UMask=10H
BR_INST_RETIRED.NEAR_CALL:			EventSel=C4H, UMask=02H, Precise
BR_INST_RETIRED.NEAR_RETURN		EventSel=C4H, UMask=08H, Precise
BR_INST_RETIRED.ALL_BRANCHES,	EventSel=C4H, UMask=00H, Precise
BR_MISP_RETIRED.CONDITIONAL,		EventSel=C5H, UMask=01H, Precise
MACHINE_CLEARS.SMC,						EventSel=C3H, UMask=04H

MEM_INST_RETIRED.ALL_LOADS  EventSel=D0H, UMask=81H, Precise All retired load instructions.
MEM_INST_RETIRED.ALL_STORES   EventSel=D0H, UMask=82H, Precise All retired store instructions.

---------------- MEM_INST_RETIRED  D0H ; PMC4-7 not support ----------------
LOCK_LOADS 21H
SPLIT_LOADS 41H
SPLIT_STORES 42H
ALL_LOADS 81H
ALL_STORES 82H

---------------- MEM_LOAD_RETIRED D1H ; PMC4-7 not support  ----------------
L1_HIT 01H
L2_HIT 02H
L3_HIT 04H
L1_MISS 08H
L2_MISS 10H
L3_MISS 20H
HIT_LFB 40H
*/
#define Mask_INST_ANY 0x00C0
#define Mask_INST_PREC_DIST 0x01C0//Precise
#define BR_CONDITIONAL 0x01C4 //Precise
#define BR_NOTTAKEN  0x10C4  

#define Mask_NEAR_CALL  0x02C4 //Precise
#define   Mask_NEAR_RETURN   0x08C4 //Precise
#define  ALL_BRANCHS   0x00C4//Precise
//#define  Mask_ALL_BRANCHS   0x04C4//Precise

// New Event
#define     BR_MISP_CONDITIONAL 0x01C5
#define BR_MISP_NEAR_TAKEN  0x20C5




//------------  precious

#define  ALL_LOADS   0x81D0
#define  ALL_STORES    0x82D0
#define MEM_UOPS_RETIRED_STLB_MISS_LOADS 0x11D0
#define MEM_UOPS_RETIRED_STLB_MISS_STORES 0x12D0
#define L1_MISS  0x08D1
#define L2_MISS  0x10D1
#define L3_MISS  0x20D1
#define L1_HIT  0x01D1
#define L2_HIT  0x02D1
#define L3_HIT  0x04D1


//------------           Non precious
 #define BRANCHES_PS 0x04C4
 #define BRANCHES 0x00C4
#define  DTLB_LOAD_MISSES_MISS_CAUSES_A_WALK 0x0108
 #define DTLB_STORE_MISSE_MISS_CAUSES_A_WALK 0x0149
#define BR_MISP 0x00C5
#define BR_MISP_PS 0x04C4
//Feature Importance<0.01
#define LLC_Misses 0x412E
 #define ICACHE_Misses 0x0280
#define SMC  0x04C3	

#define LBR_INSERTS 0x20CC //Increments when an entry is added to the Last Branch Record
 

enum PMC
{
	PMC0, 
	PMC1 ,
	PMC2, 
	PMC3,
	PMC4, 
	PMC5 ,
	PMC6, 
	PMC7
};

int IndexofPMI;
int IndexofMyCode;
int pebs_record_size ;

UINT64 previous_INST;
UINT64 previous_CYCLE;
UINT64 previous_PMC0;
UINT64 previous_PMC1;
UINT64 previous_PMC2;
UINT64 previous_PMC3;
UINT64 previous_PMC4;
UINT64 previous_PMC5;
UINT64 previous_PMC6;
UINT64 previous_PMC7;

int iOld_PERFCTR;
int  NumberofPEBS;

/****************
custom Define
************/

enum staticMask_codes
{
	_EVENT_TYPE_, /* In case of no error */
	_bINT_, /* In case of CPU is not Intel */
	_PERIOD_, /* In case of a 32-bit CPU */
	_COUNTER_DELTA_
};



#define MAX_PMCx 2
#define STORE_PERIOD		1
// We define BRANCH_PERIOD as 1. In this way, we can associate the DataLA to the basic block
#define BRANCH_PERIOD		1
//staticMask[i][4] save the delta value of MSR_IA32_PERFCTRx since, the MSR_IA32_PERFCTRx will be reset to x_PERIOD periodically. 
// In this way, we do not need a additional  MSR_IA32_PERFCTRx register to record the event counter

INT16 NumberofPMCs;
 
// since pebs_index=SIZE_PEBS_BUFFER-1, the mininal effected SIZE_PEBS_BUFFER shoud be 1+1
// TOADD
#define SIZE_PEBS_BUFFER 1+1
//#define THRESHOLD_PEBS_BUFFER 1000
#define Target_Core_Number  KeNumberProcessors-1
//#define  _PEB_PMCx_    ( (1<<PMC0) | (1<<PMC1) )

#define  _PEB_PMCx_  ((1<<PMC0) | (1<<PMC1)  )


#define  _Counter_  (0x000000000 | _PEB_PMCx_ )


#define Multiplexing 2
//PMC0-1 are fixed  for Branch, not changed
#define OutSet 1
int Multiplex_Index;
DWORD32 	 StaticMask[Multiplexing][MAX_PMCx][4];
```

`src/IO/IO.c`:

```c


#include "IO.h"
#include "dbg\debug.h"
#include "Threading\thread.h"
#include "list\list.h"
#include "simple-pebs.h"
#include "LBR\LBR.h"
#include "ioctl.h"	
#include "WriteFile\WriteFile.h"
#include<stdlib.h>

ANSI_STRING Ansi_String;

char szProcessName[MAX_PATH]={0};
char szLogFileName [MAX_PATH]="tmp.csv";
int iMLPX=1;

NTSTATUS Read(PDEVICE_OBJECT DeviceObject,PIRP Irp)
{
	PLOOPInfo bdata;
	PVOID userbuffer;
	PIO_STACK_LOCATION PIO_STACK_IRP;
	UINT32 datasize,sizerequired;
	NTSTATUS NtStatus=STATUS_SUCCESS;
	UNREFERENCED_PARAMETER(DeviceObject);
	NtStatus=STATUS_SUCCESS;

#ifdef _MYDEBUG_
	DbgPrint("Dispatch Fucntion to Read");
#endif

	/* remove an item from list */
	if(Remove_LoopList(LoopList_Header)==TRUE)
	{

		/* if data is available, copy to userland */
		userbuffer=Irp->AssociatedIrp.SystemBuffer;
		PIO_STACK_IRP=IoGetCurrentIrpStackLocation(Irp);
		if(PIO_STACK_IRP && userbuffer)
		{
			datasize=PIO_STACK_IRP->Parameters.Read.Length;
			sizerequired=sizeof(LOOPInfo);
			if(datasize>=sizerequired){
				memcpy(userbuffer,&bdata,sizerequired);
				Irp->IoStatus.Status = NtStatus;
				Irp->IoStatus.Information = sizerequired;
			}else{
				Irp->IoStatus.Status = NtStatus;
				Irp->IoStatus.Information = 0;
			}
		}else{
			Irp->IoStatus.Status = NtStatus;
			Irp->IoStatus.Information = 0;
		}
	}else{
		/* if not available, no data is written */
		Irp->IoStatus.Status = NtStatus;
		Irp->IoStatus.Information = 0;
	}

	IoCompleteRequest(Irp, IO_NO_INCREMENT);

	return NtStatus;

}


/* Create File -- start capture mechanism */
NTSTATUS Create(PDEVICE_OBJECT DeviceObject,PIRP Irp)
{
	int i,j;
	NTSTATUS status;
	UNREFERENCED_PARAMETER(DeviceObject);

	DbgPrint("Dispatch Fucntion to IRP_MJ_CREATE");

	/* I don't know if launching threads inside an I/O routine is OK
	* Anyway, an IOCTL would be more suitable
	* The idea here is Create/CLose work as Start/Stop
	*/
	IndexofPMI=0;
	IndexofMyCode=0;
	IndexofLBR=0;
	previous_LBR_TOS=INVALID_TOS_VALUE;

	IndexofOuterLoop=0;
	IndexofInnerLoop=0;
	TotalInnerLoop=0;
	IndexofPeriod=0;

	previous_INST=0;
	previous_CYCLE=0;
	previous_PMC0=0;
	previous_PMC1=0;
	previous_PMC2=0;
	previous_PMC3=0;
	previous_PMC4=0;
	previous_PMC5=0;
	previous_PMC6=0;
	previous_PMC7=0;

	lastLoop=NULL;
	DLAListHeader=NULL;


	Multiplex_Index=0;

		//20-11-20
	if(DLAListHeader==NULL)
	{
		DLAListHeader=(PLIST_ENTRY)ExAllocatePool(NonPagedPool,sizeof(PLIST_ENTRY));
		InitializeListHead(DLAListHeader);
	}

	iOld_PERFCTR=0;

	bIOCTL_SEND_PNAME=FALSE;
	bIOCTL_SEND_LOGFILENAME=FALSE;
	bPrint_pebs_index=TRUE ;
	IndexofClose=0;

	for( i=0;i<MAX_PMCx;i++)
	{
		for( j=0;j<4;j++)
		{
			MyDbgPrint ("staticMask[%d][%d]=%d",i, j,StaticMask[Multiplex_Index][i][j]); 
		}
	}

	//for( i=3;i<MAX_PROC;i++)
	//{
		control_thread(LOAD_BTS,Target_Core_Number);
//	}

	Irp->IoStatus.Status=STATUS_SUCCESS;
	IoCompleteRequest(Irp,IO_NO_INCREMENT);
	status = STATUS_SUCCESS;
	return status;
}


/* CLoseFile/CloseHandle -- stop routine */
NTSTATUS Close(PDEVICE_OBJECT DeviceObject,PIRP Irp)
{
//	 int i;
	NTSTATUS status;

	PLIST_ENTRY	removed_DLA=NULL;
	PDLA 	removed_DLA_Content=NULL;

	UNREFERENCED_PARAMETER(DeviceObject);

	//Waiting for Creat IO finished,
	delay_exec(DELAY_INTERVAL*5);
	DbgPrint("Dispatch Fucntion to IRP_MJ_CLOSE");

	IndexofClose++;



//	for( i=3;i<MAX_PROC;i++)
	//{
		control_thread(UNLOAD_BTS,Target_Core_Number);
//	}

	/*
	debug("clear list entries");
	destroy_list();
	*/
		//20-11-20
		if(DLAListHeader!=NULL)
		{
			while(!IsListEmpty(DLAListHeader))
			{
				removed_DLA=RemoveHeadList(DLAListHeader);
				removed_DLA_Content=CONTAINING_RECORD(removed_DLA,DLA,DataLAList);
				ExFreePool(removed_DLA_Content);	
			}			
			ExFreePool(DLAListHeader);
		}


	Irp->IoStatus.Status=STATUS_SUCCESS;
	IoCompleteRequest(Irp,IO_NO_INCREMENT);
	status = STATUS_SUCCESS;
	return status;
}


//DispatchIoctl
UINT64 PID=0;
UINT64 TID=0;
UINT64 CurrentTID=0;
UINT64 process_address=0;
UINT64 process_size=0;
UINT64 lib_MaxAddress=0;
PVOID64  g_pSemaphore=NULL;
char tmp[256];
#define INVALID_HANDLE_VALUE ((HANDLE)(LONG_PTR)-1)


NTSTATUS DispatchIoctl(PDEVICE_OBJECT pDevObj, PIRP pIrp)
{
	NTSTATUS status = STATUS_INVALID_DEVICE_REQUEST;
	PIO_STACK_LOCATION pIrpStack;
	ULONG uIoControlCode;
	PVOID pIoBuffer;
//	ULONG uInSize;
	ULONG uOutSize=0;
	HANDLE SemaphoreHandle=INVALID_HANDLE_VALUE;


	memset(tmp, 0, sizeof(tmp));

	//获得IRP里的关键数据
	pIrpStack = IoGetCurrentIrpStackLocation(pIrp);
	//这个就是传说中的控制码
	uIoControlCode = pIrpStack->Parameters.DeviceIoControl.IoControlCode;

	//输入和输出的缓冲区（DeviceIoControl的InBuffer和OutBuffer都是它）
	pIoBuffer = pIrp->AssociatedIrp.SystemBuffer;

	/*
	//EXE发送传入数据的BUFFER长度（DeviceIoControl的nInBufferSize）
	uInSize = pIrpStack->Parameters.DeviceIoControl.InputBufferLength;
	//EXE接收传出数据的BUFFER长度（DeviceIoControl的nOutBufferSize）
	uOutSize = pIrpStack->Parameters.DeviceIoControl.OutputBufferLength;
	*/
	switch(uIoControlCode)
	{
		case IOCTL_SEND_PNAME:
		{
			strcpy(tmp,pIoBuffer);
#ifdef _MYDEBUG_ 
			//DbgPrint("case IOCTL_SEND_PNAME");
			DbgPrint("[IO.c] case IOCTL_SEND_PNAME, process name= %s",tmp);
#endif
			strcpy(szProcessName,tmp);
			DbgPrint("[IO.c] case IOCTL_SEND_PNAME, szProcessName = %s",szProcessName);
			//Ansi_String指向tmp，改变tmp，Ansi_String也会变化
			//Ansi_String不需要销毁
			RtlInitAnsiString(&Ansi_String,tmp);
			MyDbgPrint("[IO.c] Ansi_String=%Z",Ansi_String);
			//Unicode_ProcessName需要RtlFreeUnicodeString来销毁
			status =RtlAnsiStringToUnicodeString(&Unicode_ProcessName,&Ansi_String,TRUE);
			MyDbgPrint("[IO.c] Unicode_ProcessName=%wZ",Unicode_ProcessName);
			status = STATUS_SUCCESS;
			bIOCTL_SEND_PNAME=TRUE;
			DbgPrint("[IO.c] case IOCTL_SEND_PNAME, end");
			break;
		}

		case IOCTL_SEND_LOGFILENAME:
		{
			strcpy(tmp,pIoBuffer);
#ifdef _MYDEBUG_ 
			DbgPrint("[IO.c] case IOCTL_SEND_LOGFILENAME, logFileName= %s",tmp);
#endif
			strcpy(szLogFileName,tmp);
			DbgPrint("[IO.c] case IOCTL_SEND_LOGFILENAME, szLogFileName= %s",szLogFileName);
			bIOCTL_SEND_LOGFILENAME=TRUE;
			break;
		}
		
		case IOCTL_SEND_MLPX:
		{
			strcpy(tmp,pIoBuffer);
			iMLPX=atoi(tmp);
#ifdef _MYDEBUG_ 
			DbgPrint("[case IOCTL_SEND_MLPX:] MLPX is %d\n",iMLPX);
#endif
			break;
		}
		//IOCTL_SEND_PID
	case IOCTL_SEND_PID:
		{
			strcpy(tmp,pIoBuffer);
			PID=atoi(tmp);
#ifdef _MYDEBUG_ 
			DbgPrint("case IOCTL_SEND_PID, process id is %X\n",PID);
#endif
			status = STATUS_SUCCESS;
			break;
		}
	case IOCTL_SEND_TID:
		{
			strcpy(tmp,pIoBuffer);
			TID=atoi(tmp);
#ifdef _MYDEBUG_ 
			DbgPrint("case IOCTL_SEND_TID, thread id is %X\n",TID);
#endif
			status = STATUS_SUCCESS;
			break;
		}
			case IOCTL_SEND_CurrentTID:
		{
			strcpy(tmp,pIoBuffer);
			CurrentTID=atoi(tmp);
#ifdef _MYDEBUG_ 
			DbgPrint("[TIME] case IOCTL_SEND_CurrentTID, thread id is %X\n",CurrentTID);
#endif
			status = STATUS_SUCCESS;
			break;
		}

	case IOCTL_SEND_ADDR:
		{
			strcpy(tmp,pIoBuffer);
			process_address=atoi(tmp);
#ifdef _MYDEBUG_ 
			DbgPrint("case IOCTL_SEND_ADDR, process_address is %X\n",process_address);
#endif
			status = STATUS_SUCCESS;
			break;
		}

	case IOCTL_SEND_SIZE:
		{
			strcpy(tmp,pIoBuffer);
			process_size=atoi(tmp);
#ifdef _MYDEBUG_ 
			DbgPrint("case IOCTL_SEND_SIZE, process_size is %X\n",process_size);
#endif
			status = STATUS_SUCCESS;
			break;
		}

		case IOCTL_SEND_LibsAddrMax:
		{
			strcpy(tmp,pIoBuffer);
			lib_MaxAddress=atoi(tmp);
#ifdef _MYDEBUG_ 
			DbgPrint("case IOCTL_SEND_LibsAddrMax, lib_MaxAddress is %X\n",lib_MaxAddress);
#endif
			status = STATUS_SUCCESS;
			break;
		}
		
	case IOCTL_SET_Semp:
		{
			SemaphoreHandle = *(HANDLE *)pIoBuffer;
#ifdef _MYDEBUG_ 
			DbgPrint("case SET_Semp, SemaphoreHandle is %d\n",SemaphoreHandle);
#endif

			/* Get the Object */
			status = ObReferenceObjectByHandle(SemaphoreHandle,SEMAPHORE_MODIFY_STATE, *ExSemaphoreObjectType, KernelMode,(PVOID*)&g_pSemaphore, NULL);
			//status = STATUS_SUCCESS;
			break;
		}

	default:
		break;

	}
	//这里设定DeviceIoControl的*lpBytesReturned的值（如果通信失败则返回0长度）
	if(status == STATUS_SUCCESS)
		pIrp->IoStatus.Information = uOutSize;
	else
		pIrp->IoStatus.Information = 0;
	//这里设定DeviceIoControl的返回值是成功还是失败
	pIrp->IoStatus.Status = status;
	IoCompleteRequest(pIrp, IO_NO_INCREMENT);
	return status;
}



/* generic routine to support non-implemented I/O */
NTSTATUS NotSupported(PDEVICE_OBJECT DeviceObject,PIRP Irp)
{
	NTSTATUS status;
	UNREFERENCED_PARAMETER(DeviceObject);
	debug("Not Supported I/O operation");
	Irp->IoStatus.Status=STATUS_NOT_SUPPORTED;
	IoCompleteRequest(Irp,IO_NO_INCREMENT);
	status = STATUS_NOT_SUPPORTED;
	return status;
}
```

`src/IO/IO.h`:

```h


#include "config.h"

/* I/O routines */
NTSTATUS NotSupported(PDEVICE_OBJECT DeviceObject,PIRP Irp);
NTSTATUS Read(PDEVICE_OBJECT DeviceObject,PIRP Irp);
NTSTATUS Create(PDEVICE_OBJECT DeviceObject,PIRP Irp);
NTSTATUS Close(PDEVICE_OBJECT DeviceObject,PIRP Irp);
NTSTATUS DispatchIoctl(PDEVICE_OBJECT DeviceObject,PIRP Irp);

BOOLEAN bIOCTL_SEND_PNAME;
BOOLEAN bIOCTL_SEND_LOGFILENAME;


```

`src/LBR/LBR.c`:

```c


#include<fltKernel.h>
#include<intrin.h>
#include "LBR.h"
#include "simple-pebs.h"
#include "List\list.h"
#include "dbg\debug.h"



void enable_LBR()
{
	UINT64 mask;
		UINT64 debugctl;

	 DbgPrint("enable LBR");



	 mask = 		LBR_DISABLE_REL_CALL|  //1<<3
		 LBR_DISABLE_IND_CALL	|  //1<<4
		 LBR_DISABLE_NEAR_RET	 | // 1<<5 
		 LBR_DISABLE_NEAR_IND_JMP	| //1<<6
	//	 LBR_DISABLE_NEAR_REL_JMP	| //1<<7
		 LBR_DISABLE_FAR_BRANCH		|  // 1<<8
			LBR_DISABLE_KERNEL; // 1

		MyDbgPrint("mask:%llx,LBR_NO_INFO: %llx ",mask, mask&LBR_NO_INFO );


	__writemsr(MSR_LBR_SELECT,mask);

	mask=__readmsr(MSR_LBR_SELECT);
	MyDbgPrint("read mask= %llx",mask);


	
	debugctl=__readmsr(LBR_MSR);
	debugctl |= LBR_ENABLE ;
//	debugctl |= (LBR_ENABLE | FREEZE_LBRs_ON_PMI);
	__writemsr(LBR_MSR,debugctl);
}

void disable_LBR()
{
	UINT64 debugctl;
		
	DbgPrint("disable LBR");

	debugctl=__readmsr(LBR_MSR);
		debugctl &= ~LBR_ENABLE ;
//	debugctl &= ~(LBR_ENABLE | FREEZE_LBRs_ON_PMI);
	__writemsr(LBR_MSR,debugctl);
}

UINT64 LBR_Info;
void get_LBR(PLIST_ENTRY DLAHeader ,UINT64 LBR_FROM,UINT64 LBR_TO, UINT64 ESP)
{
	int Layer=0;
	int i=0;

	UINT64 current_INST=0;
	UINT64 current_CYCLE=0;
	UINT64 current_PMC[MAX_PMCx]={0};
	UINT64 previous_PMC[MAX_PMCx]={0};


	for (i=OutSet;i<MAX_PMCx;i++)
	{
		current_PMC[i]=get_PMCx(i,FALSE);
	}


	// Not from Bin or to Bin
	if(LBR_FROM>=_MAX_BIN_||LBR_FROM==0x0
		||LBR_TO>=_MAX_BIN_||LBR_TO==0x0
		)
	{
		return;
	}

	Find_Insert_LoopList(LBR_FROM,LBR_TO,1, ESP, current_INST, current_CYCLE, current_PMC,DLAHeader);

}


```

`src/LBR/LBR.h`:

```h
/* 
Ref: Intel Manual
17.12     LAST BRANCH, CALL STACK, INTERRUPT, AND EXCEPTION RECORDING 
FOR PROCESSORS BASED ON SKYLAKE MICROARCHITECTURE  (Page 3318)
*/

/*----------------------------------------------------------    
							Register For LBR
----------------------------------------------------------  */

//#define LBR_SIZE 16
int LBR_SIZE;
#define LBR_MSR 473
#define MSR_IA32_DEBUGCTL 0x1D9

#define LBR_ENABLE 1
#define LBR_DISABLE 0
#define FREEZE_LBRs_ON_PMI 1<<11
//When set, the LBR stack is frozen on a hardware PMI request (e.g. when a counter overflows and is configured to trigger PMI). See Section 17.4.7 for details.
// FREEZE_LBRS_ON_PMI doesn't work in combination with PEBS
#define FREEZE_PERFMON_ON_PMI 1<<12
 //When set, the performance counters (IA32_PMCx and IA32_FIXED_CTRx) are frozen on a PMI request. See Section 17.4.7 for details.
/*				17.4.7      Freezing LBR and Performance Counters on PMI 
				17.12.2    Streamlined Freeze_LBRs_On_PMI Operation  (Page 3319  )
*/
//MSR_IA32_DEBUGCTL bit 0 is for LBR

/*----------------------------------------------------------    
							Register For LBR
			Skylake (and newer) last-branch recording 
#define MSR_SKL_LASTBRANCH_TOS    0x000001c9
481
#define MSR_SKL_LASTBRANCH_0_FROM_IP  0x00000680
482
#define MSR_SKL_LASTBRANCH_0_TO_IP  0x000006c0
483
#define MSR_SKL_LASTBRANCH_0_INFO 0x00000dc0
484
#define NUM_MSR_SKL_LASTBRANCH    32
----------------------------------------------------------  */
#define MSR_LBR_SELECT 456
#define LBR_BASE_FROM 0x680
#define LBR_BASE_TO 0x6c0
#define MSR_LBR_TOS 0x1C9
#define LBR_BITMASK 31
/* 
Table 17-13.   MSR_LBR_SELECT for Intel® microarchitecture code name Haswell  (Page 3316)
*/
#define LBR_DISABLE_KERNEL 1
#define LBR_DISABLE_USER 1<<1
//When set, do not capture conditional branches
#define LBR_DISABLE_JCC 1<<2
//When set, do not capture near relative calls
#define LBR_DISABLE_REL_CALL 1<<3
//When set, do not capture near indirect calls
#define LBR_DISABLE_IND_CALL 1<<4
#define LBR_DISABLE_NEAR_RET 1<<5 
//When set, do not capture near indirect jumps
#define LBR_DISABLE_NEAR_IND_JMP 1<<6
//When set, do not capture near relative jumps
#define LBR_DISABLE_NEAR_REL_JMP 1<<7
//When set, do not capture far branches
#define LBR_DISABLE_FAR_BRANCH 1<<8
//Enable LBR stack to use LIFO filtering to capture Call stack profile
//Must set valid combination of bits 0-8 in conjunction with bit 9 (as described below),
//otherwise the contents of the LBR MSRs are undefined.
#define EN_CALLSTACK 1<<9
// 
#define LBR_NO_INFO2	(1ULL<< 63)
#define LBR_NO_INFO	0x8000000000000000


/*----------------------------------------------------------    

17.12     LAST BRANCH, CALL STACK, INTERRUPT, AND EXCEPTION RECORDING 
FOR PROCESSORS BASED ON SKYLAKE MICROARCHITECTURE

—  MSR_LBR_INFO_x, stores branch prediction flag, TSX info, and elapsed cycle data.

						
17.12.1    MSR_LBR_INFO_x MSR
							Table 17-16.   MSR_LBR_INFO_x  (P3318)
----------------------------------------------------------  */

#define MSR_LBR_INFO_0			0x00000dc0 /* ... 0xddf for _31 */
#define BIT_ULL(nr)		(1ULL << (nr))
//When set, indicates either the target of the branch was mispredicted and/or the  direction (taken/non-taken) was mispredicted; otherwise, the target branch was predicted.
#define LBR_INFO_MISPRED		BIT_ULL(63)
#define LBR_INFO_IN_TX			BIT_ULL(62)
#define LBR_INFO_ABORT			BIT_ULL(61)
//Elapsed core clocks since last update to the LBR stack.
#define LBR_INFO_CYCLES			0xFFFF  //BIT 15:0





 void enable_LBR();
void disable_LBR();
void get_LBR(PLIST_ENTRY ddDataLA ,UINT64 LBR_FROM,UINT64 LBR_TO, UINT64 ESP);
void  get_LBR_disableLBR();

int IndexofLBR;
int IndexofOuterLoop;
int IndexofInnerLoop;
int TotalInnerLoop;
int IndexofPeriod;

int previous_LBR_TOS;

#define INVALID_TOS_VALUE 0x0000FFFF

```

`src/LoopHPCs.c`:

```c

#include "config.h"
#include "dbg\debug.h"
#include "checks\checks.h"
#include "device\device.h"
#include "simple-pebs.h"
#include "list\list.h"
#include "WriteFile\WriteFile.h"
#include "strsafe.h"


/*************************************************************************
    Prototypes
*************************************************************************/

DRIVER_INITIALIZE DriverEntry;
NTSTATUS
DriverEntry (
    _In_ PDRIVER_OBJECT DriverObject,
    _In_ PUNICODE_STRING RegistryPath
    );

VOID LoopHPCsUnload(PDRIVER_OBJECT  DriverObject);
void test_attach_core1(UINT64 id);
void test_attach_core2(UINT64 id);
extern void thread_attach_to_core(unsigned int id);

NTKERNELAPI NTSTATUS PsSuspendProcess(PEPROCESS pEProcess);



/*************************************************************************
    Driver initialization and unload routines.
*************************************************************************/

PDRIVER_OBJECT drv;

extern 	DWORD64 GetAddress(WCHAR APIName[]);
extern BOOLEAN SuspendThread();

 LONG64 beta=0;
 PCHAR szBuffer_BASE=NULL;
 

NTSTATUS
DriverEntry (
    _In_ PDRIVER_OBJECT DriverObject,
    _In_ PUNICODE_STRING RegistryPath
    )

{
//	pdevice_ext ext;

	int ret_code;
    NTSTATUS status=STATUS_SUCCESS;
    UNREFERENCED_PARAMETER(RegistryPath);



	DriverObject->DriverUnload=LoopHPCsUnload;
	NumberofPEBS=PMCx_check();
	thread_attach_to_core(0);

	/* Check all required resources */
	ret_code=perform_checks();
	if(ret_code!=NO_ERROR)
	{
		status=STATUS_NOT_SUPPORTED;
		emit_error(ret_code);
	}


	//StringCbPrintfA(szBuf,100, "%s test %d", "StringCbPrintfW",1);
	//WriteFileA(szBuf);
	//LOG2FILEA("[LOG2FILE] ret_code=%d\r\n",ret_code);
	//LOG2FILEW(L"[LOG2FILE] ret_code\r\n");

	//DbgPrint("perform checks OK");
	/* Set up device */
	if((status=CreateDevice(DriverObject))!=STATUS_SUCCESS)
	{
		DbgPrint("Error Creating Device");
	}

	/* driver data extension */
	debug("Setting driver extension");
	DriverObject->DeviceObject->DeviceExtension=ExAllocatePool(NonPagedPool,sizeof(device_ext));


		/* Hooking PMI handler */
#ifdef _PMI_
	//DbgPrint( "Registering PMI callback");
	hook_handler();
#else
		/* registering NMI callback */
	DbgPrint("Registering NMI callback");
	ext=(pdevice_ext)DriverObject->DeviceObject->DeviceExtension;
	ext->nmicallbackhandler=KeRegisterNmiCallback(&NmiCallback,NULL);
#endif

	drv=DriverObject;


	LoopList_Header =NULL;
	/* create list */
	if(create_list(&LoopList_Header)==FALSE)
	{
		DbgPrint("Create LoopList_Header error");
	}
//	DbgPrint("LoopList_Header=%08X",LoopList_Header);


	//Use NonPagedPool instead of Global Var  to avoid BoS
	if(szBuffer_BASE==NULL)
	{
		szBuffer_BASE=(PCHAR) ExAllocatePool(NonPagedPool,szBuffer_SIZE);
		DbgPrint("[DriverEntry] szBuffer_BASE  is %X",szBuffer_BASE);
		memset(szBuffer_BASE, 0,	szBuffer_SIZE);
	}

	debug("Entry Point: Out");
    return status;
}

/* generic thread controller */
extern void control_thread(int action, int core);
extern int index;
extern ULONG interval_Time;

VOID LoopHPCsUnload(PDRIVER_OBJECT  DriverObject)
{
//	pdevice_ext ext;
	UNICODE_STRING path;
	DbgPrint("LoopHPCs Unload");

	PID=0;


#ifdef _TIME_
	DbgPrint(" interval_Time: %ds,%dms",  interval_Time/1000,  interval_Time%1000);
#endif

#ifdef _PMI_
	DbgPrint( "Unhook PMI handler");
	unhook_handler();
#else
	ext=(pdevice_ext)DriverObject->DeviceObject->DeviceExtension;

		DbgPrint("Unhook NMI callback");
		if(ext->nmicallbackhandler!=NULL)
	{
		KeDeregisterNmiCallback(ext->nmicallbackhandler);
	}
	ExFreePool(ext);

#endif


			/* clear list */
	debug("clear list entries");
	destroy_list();

	debug("Removing Device");

	if(Unicode_ProcessName.Length!=0)
	{	
		RtlFreeUnicodeString(&Unicode_ProcessName);
	}

	RtlInitUnicodeString(&path,DOSDRIVERNAME);
	IoDeleteSymbolicLink(&path);


	if(DriverObject->DeviceObject!=NULL)
	{
		DbgPrint("Delete Device");
		IoDeleteDevice(DriverObject->DeviceObject);
	}

	//clean g_pSemaphore
	if(g_pSemaphore!=NULL)
	{
		ObDereferenceObject(g_pSemaphore);
		g_pSemaphore=NULL;
	}

		ExFreePool(szBuffer_BASE);
		szBuffer_BASE=NULL;

	debug("LoopHPCs Unload");
	return;
}


/* avoid core migration by setting affinity*/
void test_attach_core1(UINT64 id)
{
	KAFFINITY mask;
	ULONG OldCore;
	ULONG NewCore;


	DbgPrint("\nAttaching to core%d",id);
//#pragma warning( disable : 4305 )
//#pragma warning( disable : 4334 )
	mask=(UINT64)1<<id;

	OldCore=KeGetCurrentProcessorNumber ();
	KeSetSystemAffinityThread(mask);
	//KeSetAffinityThread
	NewCore=KeGetCurrentProcessorNumber ();

	DbgPrint("Result: \tcore%d-->core%d",OldCore,NewCore);
// 恢复原来的核号

	OldCore=KeGetCurrentProcessorNumber ();
	KeRevertToUserAffinityThread();
	NewCore=KeGetCurrentProcessorNumber ();
	DbgPrint("Revert: \tcore%d-->core%d",OldCore,NewCore);

	//KeGetCurrentProcessorNumber
}


typedef NTSTATUS (__stdcall * pFnKeSetAffinityThread)(PKTHREAD Thread, KAFFINITY Affinity); 
pFnKeSetAffinityThread KeSetAffinityThread = NULL;
    

/* avoid core migration by setting affinity*/
void test_attach_core2(UINT64 id)
{
	CCHAR OldCurrentProcessor;
	CCHAR NewCurrentProcessor;
	KAFFINITY OrigAffinity;
	KAFFINITY	mask;
	UNICODE_STRING NameString;

	DbgPrint("\nAttaching to core%d",id);

	mask=(UINT64)1<<id;

	if(KeSetAffinityThread==NULL)
	{
	   RtlInitUnicodeString(&NameString, L"KeSetAffinityThread");
		KeSetAffinityThread = (pFnKeSetAffinityThread)MmGetSystemRoutineAddress(&NameString);
	}

	 OldCurrentProcessor = (CCHAR)KeGetCurrentProcessorNumber();
	 //PKTHREAD KeGetCurrentThread();
	OrigAffinity = KeSetAffinityThread(KeGetCurrentThread(), mask); 
	 NewCurrentProcessor = (CCHAR)KeGetCurrentProcessorNumber();
	 DbgPrint("Result: \tcore%d-->core%d",OldCurrentProcessor,NewCurrentProcessor);

	  OldCurrentProcessor = (CCHAR)KeGetCurrentProcessorNumber();
	 KeRevertToUserAffinityThread();
	  NewCurrentProcessor = (CCHAR)KeGetCurrentProcessorNumber();
	   DbgPrint("Revert: \tcore%d-->core%d", id,OldCurrentProcessor,NewCurrentProcessor);
}
```

`src/MagicCheck/MagicCheck.c`:

```c
#include "config.h"

#define _HEAP_MIN_   0x00400000 // 0x02000000  
#define _HEAP_MAX_ 0x00410000 //0x03000000  

BOOLEAN  HeapCheck(DWORD32 lowAddress )
{
	 // [TODO]
	return TRUE;

	if( lowAddress>=_HEAP_MIN_ && lowAddress<_HEAP_MAX_ )
	{
		return TRUE;
	}
	return FALSE;
}

	  INT32  MagicCheck(DWORD64 Address , DWORD64 ddDataLAMax)
{
	PDWORD64 pStartAddress=0;
	DWORD32 lowAddress=0;
	PCHAR pStartAddressByte=0;

	lowAddress=Address&0xFFFFFFFF;

	// Heap Space 0286000D-->0286013D	
	if( HeapCheck (lowAddress)==FALSE )
	{
		return 0;
	}

	pStartAddress=(PDWORD64) (Address&0xFFFFFFFFFFFF0000);

	DbgPrint(" MagicCheck [%08X-->%08X]",pStartAddress, ddDataLAMax);
	 pStartAddressByte=(PCHAR)pStartAddress;
	 for( ; (DWORD64)pStartAddressByte<ddDataLAMax; pStartAddressByte++)
	 {
		 if((*pStartAddressByte)!=0)
		 {
			 DbgPrint("[%08X]=%X",pStartAddressByte,*(pStartAddressByte));
		 }
	 }

	return 1;
}
```

`src/MagicCheck/MagicCheck.h`:

```h
#pragma once

#include "config.h"

  INT32  MagicCheck(DWORD64 Address , DWORD64 ddDataLAMax);
	  BOOLEAN  HeapCheck(DWORD32 lowAddress );

#define RVA_Code 0x1000
#define RVA_Rdata 0x6000
#define RVA_Data 0x7000
#define RVA_End 0xA000


#define MAGIC_Code 0xCC
#define MAGIC_Rdata 0xBB
#define MAGIC_Data 0xAA




```

`src/PMI.c`:

```c


#include "simple-pebs.h"
#include "LBR\LBR.h"
#include "dbg\debug.h"
#include "checks\checks.h"
#include "list\list.h"
#include <stdio.h>


#define _Standard_PMI_

extern PTDS_BASE DS_BASE;

extern BOOLEAN  bSuspend ;


ULONG interval_Time=0;
ULONG PMI_In=0;
ULONG PMI_Out=0;

ULONG QuerySystemTime() 
{ 
	LARGE_INTEGER CurTime, Freq; 
	CurTime = KeQueryPerformanceCounter(&Freq); 
	return (ULONG)((CurTime.QuadPart *1000)/Freq.QuadPart); 
} 


UINT64 last=0;
void PMI(__in struct _KINTERRUPT *Interrupt, __in PVOID ServiceContext) 
{
//	UINT64 TOS;
	LARGE_INTEGER pa;
	UINT32* APIC;
	int i;
	unsigned long long tmp;
	int iOldPMC0;
	UINT64 GLOBAL_STATUS;
	BOOLEAN flag[MAX_PMCx] ; 

#ifdef _Standard_PMI_
	 	//20-9-19
	 // [Step 1] Ensure counters are in disabled.  
	__writemsr(MSR_IA32_PERF_GLOBAL_CTRL, 0);
	// [Step 2] Disable PEBS.
	__writemsr(MSR_IA32_PEBS_ENABLE, 0);

	//The service routine can query MSR_PERF_GLOBAL_STATUS to determine which counter(s) caused of overflow condition
	// The service routine should clear overflow indicator by writing to MSR_PERF_GLOBAL_OVF_CTL. 
	//[Step 3]  Check overflow conditions.
	GLOBAL_STATUS=__readmsr(MSR_PERF_GLOBAL_STATUS);
	 __writemsr(IA32_PERF_GLOBAL_OVF_CTRL,GLOBAL_STATUS);
	MyDbgPrint("GLOBAL_STATUS= %llx ", 	GLOBAL_STATUS);



	/*
	tmp=1;
	for(i=0;i<NumberofPMCs;i++)
	{
		 if(GLOBAL_STATUS&tmp)
		 {
			 DbgPrint("MSR_IA32_PERFCTR %d= %d", i,__readmsr(MSR_IA32_PERFCTR0+i));
			flag[i]=TRUE;
		 }
		 else
		 {
			  flag[i]=FALSE;
		 }
		 tmp=tmp<<1;
	}
	*/
#endif

	//	IndexofPMI++;
/*
	 if(GLOBAL_STATUS&1)
	 {
		DbgPrint("\n*******     Event1%d interupt");
	 }
*/
	MyCode();

Exit:

	//clear interrupt flag 
	pa.QuadPart=PERF_COUNTER_APIC;
	APIC=(UINT32*)MmMapIoSpace(pa,sizeof(UINT32),MmNonCached);
	*APIC=ORIGINAL_APIC_VALUE;
	MmUnmapIoSpace(APIC,sizeof(UINT32));

	if(	DS_BASE->pebs_index==DS_BASE->pebs_thresh)
	{
		DS_BASE->pebs_index=DS_BASE->pebs_base;
	}
		//multiplexing
		init_PMCx(OutSet);

#ifdef _Standard_PMI_
		//   [Step 9~8] 	 Configure/Enable PEBS.
		__writemsr(MSR_IA32_PEBS_ENABLE, _PEB_PMCx_);
		//   [Step 10] 	 Enable counters.
		tmp=	 __readmsr(MSR_IA32_PERF_GLOBAL_CTRL);
		tmp = tmp | _Counter_;
		__writemsr(MSR_IA32_PERF_GLOBAL_CTRL, tmp);

#endif

	
} 


void *perfmon_hook = PMI;
void *restore_hook = NULL;

void unhook_handler()
{
	NTSTATUS status;
	status = HalSetSystemInformation(HalProfileSourceInterruptHandler,sizeof(PVOID*),&restore_hook);
	//emit_status(status);
}

void hook_handler()
{
	NTSTATUS status;
	status = HalSetSystemInformation(HalProfileSourceInterruptHandler,sizeof(PVOID*),&perfmon_hook);
	//emit_status(status);
}
```

`src/Threading/SuspendThread.cpp`:

```cpp



///////////////////////////////////////////////////////////////////////////////   
///   
/// Copyright (c) 2013 - <company name here>   
///   
/// Original filename: SuspendThread.cpp   
/// Project          : SuspendThread   
/// Date of creation : 2013-06-29   
/// Author(s)        : <author name(s)>   
///   
/// Purpose          : <description>   
///   
/// Revisions:   
///  0000 [2013-06-29] Initial revision.   
///   
///////////////////////////////////////////////////////////////////////////////   

// $Id$   

#ifdef __cplusplus   
extern "C" {   
#endif   
#include <ntddk.h>   
#include <string.h>   
#include <wdm.h>   
#ifdef __cplusplus   
}; // extern "C"   
#endif   

#include "SuspendThread.h"   

#ifdef __cplusplus   
namespace { // anonymous namespace to limit the scope of this global variable!   
#endif   
	PDRIVER_OBJECT pdoGlobalDrvObj = 0;   
#ifdef __cplusplus   
}; // anonymous namespace   
#endif   
PSRVTABLE ServiceTable;   

NTSTATUS SUSPENDTHREAD_DispatchCreateClose(   
	IN PDEVICE_OBJECT       DeviceObject,   
	IN PIRP                 Irp   
	)   
{   
	NTSTATUS status = STATUS_SUCCESS;   
	Irp->IoStatus.Status = status;   
	Irp->IoStatus.Information = 0;   
	IoCompleteRequest(Irp, IO_NO_INCREMENT);   
	return status;   
}   

NTSTATUS SUSPENDTHREAD_DispatchDeviceControl(   
	IN PDEVICE_OBJECT       DeviceObject,   
	IN PIRP                 Irp   
	)   
{   
	NTSTATUS status = STATUS_SUCCESS;   
	PIO_STACK_LOCATION irpSp = IoGetCurrentIrpStackLocation(Irp);   

	switch(irpSp->Parameters.DeviceIoControl.IoControlCode)   
	{   
	case IOCTL_SUSPENDTHREAD_OPERATION:   
		// status = SomeHandlerFunction(irpSp);   
		break;   
	default:   
		Irp->IoStatus.Status = STATUS_INVALID_DEVICE_REQUEST;   
		Irp->IoStatus.Information = 0;   
		break;   
	}   

	status = Irp->IoStatus.Status;   
	IoCompleteRequest(Irp, IO_NO_INCREMENT);   
	return status;   
}   

VOID SUSPENDTHREAD_DriverUnload(   
	IN PDRIVER_OBJECT       DriverObject   
	)   
{   
	PDEVICE_OBJECT pdoNextDeviceObj = pdoGlobalDrvObj->DeviceObject;   
	IoDeleteSymbolicLink(&usSymlinkName);   

	// Delete all the device objects   
	while(pdoNextDeviceObj)   
	{   
		PDEVICE_OBJECT pdoThisDeviceObj = pdoNextDeviceObj;   
		pdoNextDeviceObj = pdoThisDeviceObj->NextDevice;   
		IoDeleteDevice(pdoThisDeviceObj);   
	}   
}   

#ifdef __cplusplus   
extern "C" {   
#endif   
	NTSTATUS DriverEntry(   
		IN OUT PDRIVER_OBJECT   DriverObject,   
		IN PUNICODE_STRING      RegistryPath   
		)   
	{   
		PDEVICE_OBJECT pdoDeviceObj = 0;   
		NTSTATUS status = STATUS_UNSUCCESSFUL;   
		pdoGlobalDrvObj = DriverObject;   

		// Create the device object.   
		if(!NT_SUCCESS(status = IoCreateDevice(   
			DriverObject,   
			0,   
			&usDeviceName,   
			FILE_DEVICE_UNKNOWN,   
			FILE_DEVICE_SECURE_OPEN,   
			FALSE,   
			&pdoDeviceObj   
			)))   
		{   
			// Bail out (implicitly forces the driver to unload).   
			return status;   
		};   

		// Now create the respective symbolic link object   
		if(!NT_SUCCESS(status = IoCreateSymbolicLink(   
			&usSymlinkName,   
			&usDeviceName   
			)))   
		{   
			IoDeleteDevice(pdoDeviceObj);   
			return status;   
		}   

		// NOTE: You need not provide your own implementation for any major function that   
		//       you do not want to handle. I have seen code using DDKWizard that left the   
		//       *empty* dispatch routines intact. This is not necessary at all!   
		DriverObject->MajorFunction[IRP_MJ_CREATE] =   
			DriverObject->MajorFunction[IRP_MJ_CLOSE] = SUSPENDTHREAD_DispatchCreateClose;   
		DriverObject->MajorFunction[IRP_MJ_DEVICE_CONTROL] = SUSPENDTHREAD_DispatchDeviceControl;   
		DriverObject->DriverUnload = SUSPENDTHREAD_DriverUnload;   

		//===================================================================   
		PETHREAD hEThread = 0;   
		ULONG PsSuspnedThread = GetFncAddr(367);//NtSuspendThread Index(WIN7)?????NtSuspendThread ??SSDT????Їв?HOOK   
		//PsSuspnedThread = GetNt_OldAddr(L"NtSuspnedThread");//??????????????????????   
		KdPrint(("pNtSuspnedThread addr:0x%X",PsSuspnedThread));   
		if (PsSuspnedThread == 0)   
		{   
			KdPrint(("?NtSuspnedThread??????????"));   
			return STATUS_SUCCESS;   
		}   
		PsSuspnedThread = SearchPsSuspendThreadAddr(PsSuspnedThread + 70);//SearchPsSuspendThreadAddr???????????????WIN7?ІЬ? ??????XP?????+ 70 ???????????????????????   
		if (PsSuspnedThread == 0)   
		{   
			KdPrint(("?PsSuspnedThread??????????"));   
			return STATUS_SUCCESS;   
		}   
		KdPrint(("PsSuspnedThread ?????????0x%X",PsSuspnedThread));   
		PSSUSPENDTHREAD FncPsSuspendThread = (PSSUSPENDTHREAD)PsSuspnedThread;   
		PsLookupThreadByThreadId((HANDLE)212,&hEThread);//212?????ID????????XT??ARK???????????????????System?Їж???????QQProtect.sys   
		if (hEThread != 0)   
		{   
			KdPrint(("QQ.sys EThread:%x",hEThread));   
			if (FncPsSuspendThread(hEThread,NULL) != 0)   
			{   
				KdPrint(("PsSuspendThread ???"));   
			}   
		}   
		else{   
			KdPrint(("PsLookupThreadByThreadId ???"));   
		}   
		//===================================================================   
		return STATUS_SUCCESS;   
	}   
#ifdef __cplusplus   
}; // extern "C"   
#endif   


```

`src/Threading/SuspendThread.h`:

```h




#ifndef __SUSPENDTHREAD_H_VERSION__ 
#define __SUSPENDTHREAD_H_VERSION__ 100 

#if defined(_MSC_VER) && (_MSC_VER = 1020) 
#pragma once 
#endif 


#include msg_SuspendThread.h 
#include drvcommon.h 
#include drvversion.h 

#define DEVICE_NAME			DeviceSUSPENDTHREAD_DeviceName 
#define SYMLINK_NAME		DosDevicesSUSPENDTHREAD_DeviceName 
PRESET_UNICODE_STRING(usDeviceName, DEVICE_NAME); 
PRESET_UNICODE_STRING(usSymlinkName, SYMLINK_NAME); 

#ifndef FILE_DEVICE_SUSPENDTHREAD 
#define FILE_DEVICE_SUSPENDTHREAD 0x8000 
#endif 

Values defined for Method 
	METHOD_BUFFERED 
	METHOD_IN_DIRECT 
	METHOD_OUT_DIRECT 
	METHOD_NEITHER 

	Values defined for Access 
	FILE_ANY_ACCESS 
	FILE_READ_ACCESS 
	FILE_WRITE_ACCESS 

	const ULONG IOCTL_SUSPENDTHREAD_OPERATION = CTL_CODE(FILE_DEVICE_SUSPENDTHREAD, 0x01, METHOD_BUFFERED, FILE_READ_DATA  FILE_WRITE_DATA); 

#define GetSSDTIndex(_function) (PULONG)((PUCHAR)_function+1) 
#define GetFncAddr(_index) (PULONG)((ULONG)KeServiceDescriptorTable-ServiceTableBase + (_index)  4) 

#define IOCTL_TRANSFER_TYPE( _iocontrol)   (_iocontrol & 0x3) 
typedef struct _ServiceDescriptorTable_ { 
	PVOID ServiceTableBase; System Service Dispatch Table ??????   
		PVOID ServiceCounterTable; ?????? SSDT ???????????????????????????????????????sysenter ????. 
		ULONG NumberOfServices;?? ServiceTableBase ???????????????   
		PVOID ParamTableBase; ?????????????????????????????-???????????  
} SRVTABLE, PSRVTABLE; 


typedef NTSTATUS (__stdcall PSSUSPENDTHREAD)( 
	IN PETHREAD Thread, 
	OUT PULONG PreviousSuspendCount); 

extern C NTSYSAPI NTSTATUS NTAPI PsLookupThreadByThreadId( 
	__in HANDLE ThreadId, 
	__deref_out PETHREAD Thread 
	); 
extern C NTSYSAPI NTSTATUS ZwSuspendThread ( 
	__in HANDLE ThreadHandle, 
	__out_opt PULONG PreviousSuspendCount 
	); 

extern C PSRVTABLE KeServiceDescriptorTable; 
#endif  __SUSPENDTHREAD_H_VERSION__ 

ULONG GetNt_OldAddr(IN PCWSTR SourceString)??????????? 
{ 
	UNICODE_STRING Old_NtOpenprocess; 
	ULONG Old_Addr; 
	RtlInitUnicodeString(&Old_NtOpenprocess,SourceString); 
	Old_Addr = (ULONG)MmGetSystemRoutineAddress(&Old_NtOpenprocess);??迆??????? 
		KdPrint((????????Old_NtOpenProcess???? %x,Old_Addr)); 
	return Old_Addr; 
} 
ULONG SearchPsSuspendThreadAddr(ULONG StartAddress) 
{ 
	ULONG	u_index; 

	UCHAR	p = (UCHAR)StartAddress; 
	83eb126b 6a18 
		83eb126d 683851c783  
		for (u_index = 0;u_index  200;u_index++) 
		{ 
			if (p==0x8B&& 
				(p+1)==0x6A&& 
				(p+2)==0x18&& 
				(p+3)==0x68&& 
				(p+4)==0x38&& 
				(p+5)==0x51&& 
				(p+6)==0xC7) 

			{ 
				return (ULONG)p; 
			} 

			p++; 
		} 

		return 0; 
}
```

`src/Threading/thread.c`:

```c

#include "thread.h"
#include "dbg\debug.h"
#include "simple-pebs.h"
#include "LBR\LBR.h"
#include<NDIS.H>


extern PDRIVER_OBJECT drv;
extern PVOID64  g_pSemaphore; 


static KEVENT event;

/* delay execution for a while */
void delay_exec(INT64 interval)
{	
	LARGE_INTEGER _interval;
	LARGE_INTEGER			timeout;
	_interval.QuadPart=interval;
	
	//DbgPrint("KeGetCurrentIrql = %d\n", KeGetCurrentIrql());
	
/*KeSetEvent(&event,0,FALSE);
	timeout.QuadPart = -1 * 10 * 1000 * 1; // 1 sec
	KeWaitForSingleObject(&event, Executive, KernelMode, FALSE, &timeout);
	NdisMSleep(1*1000*1000);
*/
	
		return;
	//Callers of KeDelayExecutionThread must be running at IRQL <= APC_LEVEL.
	KeDelayExecutionThread(KernelMode,FALSE,&_interval);	

}

/* generic thread controller */
void control_thread(int action, int core)
{
	debug("control_thread");

	switch(action)
	{
	case LOAD_BTS:
		//PsCreateSystemThread(&thandle,GENERIC_ALL,NULL,NULL,NULL,ThreadStart,(void*)core);
		//Waiting for the previous new thread finishing, avoid Multi-thread 
		delay_exec(DELAY_INTERVAL);
		ThreadStart((void*)core);
		break;
	case UNLOAD_BTS:
		//	PsCreateSystemThread(&thandle,GENERIC_ALL,NULL,NULL,NULL,ThreadStop,(void*)core);
		//Waiting for the previous new thread finishing, avoid Multi-thread 
		delay_exec(DELAY_INTERVAL);
		// delay execution for a while
		ThreadStop((void*)core);


		break;
	default:
		debug("Invalid Option to control_thread");
		break;
		/* This function can be expanded here to include more thread actions*/
	}
}

/* avoid core migration by setting affinity*/
void thread_attach_to_core(unsigned int id)
{
	KAFFINITY mask;
	//ULONG OldCore;
	//DbgPrint("Attaching thread to core%d", id);
#pragma warning( disable : 4305 )
#pragma warning( disable : 4334 )
	mask=1<<id;

//	OldCore=KeGetCurrentProcessorNumber ();
	KeSetSystemAffinityThread(mask);

//	DbgPrint("core%d-->core%d", OldCore,KeGetCurrentProcessorNumber ());

	// 恢复原来的核号
 //   KeRevertToUserAffinityThread();

}
unsigned long g_OldDS=0;

VOID ThreadStart(_In_ PVOID StartContext)
{
	//UINT64 _eax=0;
	unsigned int id;

#pragma warning( disable : 4305 )
	id=(int)StartContext;

		DbgPrint("\nCore%d ThreadStart",id);

	//delay_exec(DELAY_INTERVAL);
	thread_attach_to_core(id);

#ifdef _PEB_
	/* set up bts */
	setup_PEBDS();
	enable_PEB();
#endif


#ifdef _LBR_
		enable_LBR();
#endif

	
/*
	 KeRevertToUserAffinityThread();

	 thread_attach_to_core(1);
	 */

	 return;


}

VOID ThreadStop(_In_ PVOID StartContext)
{
//	UINT64	_eax=0;
//	pdevice_ext ext;
	unsigned int id;
	#pragma warning( disable : 4305 )
	id=(int)StartContext;

	DbgPrint("\nCore%d ThreadStop",id);
	
	thread_attach_to_core(id);

#ifdef _PEB_
	disable_PEB();
	clean_PEBDS();	
#endif

#ifdef _LBR_
		disable_LBR();
#endif

	//delay_exec(DELAY_INTERVAL);

	KeRevertToUserAffinityThread();

	return;
}
```

`src/Threading/thread.h`:

```h


#include "config.h"

#define DELAY_ONE_MICROSECOND (-10)
#define DELAY_ONE_MILLISECOND (DELAY_ONE_MICROSECOND*1000)
#define DELAY_ONE_SECOND (DELAY_ONE_MILLISECOND*1000)

#define DELAY_INTERVAL DELAY_ONE_MILLISECOND*100
 void delay_exec(INT64 interval);


/* define which action will be performed on a given thread */
enum thread_action
{
	LOAD_BTS,
	UNLOAD_BTS
};

void control_thread(int action, int core);
VOID ThreadStart(_In_ PVOID StartContext);
VOID ThreadStop(_In_ PVOID StartContext);

void thread_attach_to_core(unsigned int id);
```

`src/WriteFile/WriteFile.c`:

```c
#include "config.h"
#include "dbg/debug.h"
#include "WriteFile.h"
#include "..\simple-pebs.h"

#define MAX_PROC_NAME_LEN 256


UNICODE_STRING LogFileNameA=RTL_CONSTANT_STRING(L"\\??\\F:\\HPCs.csv");
UNICODE_STRING LogFileNameW=RTL_CONSTANT_STRING(L"\\??\\F:\\DriverW.log");
UNICODE_STRING Unicode_FileNameHeader=RTL_CONSTANT_STRING(L"\\??\\");
UNICODE_STRING Unicode_DirectoryHeader=RTL_CONSTANT_STRING(L"\\");
UNICODE_STRING Unicode_FileName = { 0 };
UNICODE_STRING Unicode_DirectoryName = { 0 };
WCHAR wcstr[MAX_PROC_NAME_LEN] = { 0 };

WCHAR wcTemp[100] = { 0 };
char szColName [1000]={0};
char szTempName [256]={0};

char szEventName[4][100]={"BRANCHS","ICACHE_Misses","STORES","LOADS"};


BOOLEAN  IniteFileName()
{
	NTSTATUS    ntStatus;
	ANSI_STRING AnsiString;
	UNICODE_STRING UnicodeString;

	RtlInitEmptyUnicodeString(&Unicode_FileName, wcstr, sizeof(wcstr));
	RtlCopyUnicodeString(&Unicode_FileName,&Unicode_FileNameHeader);

	DbgPrint("Unicode_ProcessName=%wZ",&Unicode_ProcessName);
	ntStatus=RtlAppendUnicodeStringToString (&Unicode_FileName,&Unicode_ProcessName);
	if(Unicode_FileName.Length>4)
	{
		Unicode_FileName.Length=Unicode_FileName.Length-8;
	}
	DbgPrint("Unicode_FileName=%wZ",&Unicode_FileName);
	RtlInitEmptyUnicodeString(&Unicode_DirectoryName, wcstr, sizeof(wcstr));
	RtlCopyUnicodeString(&Unicode_DirectoryName,&Unicode_FileName);
	DbgPrint("Unicode_DirectoryName=%wZ",&Unicode_DirectoryName);

	DbgPrint("szLogFileName=%s",szLogFileName);
	RtlInitAnsiString(&AnsiString,	szLogFileName);
	DbgPrint("AnsiString=%Z",&AnsiString);
	RtlAnsiStringToUnicodeString(&UnicodeString, &AnsiString, TRUE);
	RtlAppendUnicodeStringToString (&Unicode_FileName,&Unicode_DirectoryHeader);
	RtlAppendUnicodeStringToString (&Unicode_FileName,&UnicodeString);
	DbgPrint("Unicode_FileName=%wZ",&Unicode_FileName);

	if(ntStatus==STATUS_SUCCESS)
	{
		return TRUE;
	}
	else
	{
		DbgPrint("RtlAppendUnicodeStringToString Fail !");
		return FALSE;
	}	
}


BOOLEAN bHasColname=TRUE;


NTSTATUS CreateDirectory(UNICODE_STRING *pDirName)//L"\\??\\c:\\doc\\"
{
	OBJECT_ATTRIBUTES		objAttrib = { 0 };
	UNICODE_STRING			uDirName = { 0 };
	IO_STATUS_BLOCK 		io_status = { 0 };
	HANDLE					hFile = NULL;
	NTSTATUS				status = 0;

//	RtlInitUnicodeString(&uDirName, szDirName);
	InitializeObjectAttributes(&objAttrib,
		pDirName,
		OBJ_CASE_INSENSITIVE | OBJ_KERNEL_HANDLE,
		NULL,
		NULL);

	status = ZwCreateFile(&hFile,
		GENERIC_READ | GENERIC_WRITE,
		&objAttrib,
		&io_status,
		NULL,
		FILE_ATTRIBUTE_DIRECTORY,
		FILE_SHARE_READ | FILE_SHARE_WRITE | FILE_SHARE_DELETE,
		FILE_OPEN_IF,
		FILE_DIRECTORY_FILE | FILE_SYNCHRONOUS_IO_NONALERT,
		NULL,
		0);
	if (NT_SUCCESS(status))
	{
		ZwClose(hFile);
	}

	return status;
}


BOOLEAN WriteFileA(char szBuffer[] )
{
	OBJECT_ATTRIBUTES object_attributes;
	IO_STATUS_BLOCK ioStatus;
	HANDLE  hFile;
	UNICODE_STRING  log;
	NTSTATUS status;
	PUCHAR	pBuffer;
	ULONG BufferSize=0;
	ULONG ColSize=0;
	int i,j=0;
	IO_STATUS_BLOCK file_status;
	FILE_STANDARD_INFORMATION fsi;
	FILE_POSITION_INFORMATION fpi;


	if (PASSIVE_LEVEL !=  KeGetCurrentIrql()) 
	{
		DbgPrint("[WriteFileA Error] Irql is not  PASSIVE_LEVEL !");
		return FALSE;
	}

	if(IniteFileName()==TRUE)
	{
		LogFileNameA=Unicode_FileName;
	}
	
	CreateDirectory(&Unicode_DirectoryName);
	InitializeObjectAttributes(&object_attributes, &LogFileNameA, OBJ_CASE_INSENSITIVE|OBJ_KERNEL_HANDLE, NULL, NULL);

	status = ZwCreateFile(&hFile,
			GENERIC_READ|GENERIC_WRITE,
		&object_attributes,
		&ioStatus,
			NULL,
			FILE_ATTRIBUTE_NORMAL,
			FILE_SHARE_READ|FILE_SHARE_WRITE,
			FILE_OPEN_IF,
			FILE_NON_DIRECTORY_FILE|FILE_RANDOM_ACCESS|FILE_SYNCHRONOUS_IO_NONALERT,
			NULL,
			0);
	if (!NT_SUCCESS(status)){
		DbgPrint("[WriteFileA Error] Create LogFile Failed !");
		return STATUS_SUCCESS;
	}
	else
	{
		MyDbgPrint("[WriteFileA Success] Create LogFile Success !");
	}

		//以下设置文件日志写入指针为文件未
	ZwQueryInformationFile(hFile,
		&file_status,
		&fsi,
		sizeof(FILE_STANDARD_INFORMATION), 
		FileStandardInformation);

	fpi.CurrentByteOffset = fsi.EndOfFile;        

	MyDbgPrint("fsi.EndOfFile:%lld\n", fsi.EndOfFile);


	BufferSize=(ULONG)strnlen_s(szBuffer,256);
	if(  (ULONG)fsi.EndOfFile.LowPart==0 )
	{
		DbgPrint("[WriteFileA] MLPX is %d\n",iMLPX);
		StringCbCopyA(szColName,sizeof (szColName),"Address,From,To, Counter");
			for(i=0; i<iMLPX; i++)
			{
				for(j=OutSet; j<MAX_PMCx; j++)
				{
					StringCbPrintfA(szTempName, sizeof (szTempName), ",%s%d", szEventName[j], i );
					StringCbCatA(szColName ,sizeof (szColName),szTempName);
				}
			}		
		StringCbCatA(szColName ,sizeof (szColName),"\r\n");
		ColSize=(ULONG)strnlen_s(szColName,sizeof (szColName));
		BufferSize+=ColSize;
	}

	pBuffer = (PUCHAR)ExAllocatePool(PagedPool, BufferSize+1);
	if (pBuffer==NULL){
		DbgPrint("[Error]  Alllocate pBuffer Failed !");
		return FALSE;
	}
	memset(pBuffer, 0, BufferSize+1);
	if(ColSize!=0)
	{
		memcpy(pBuffer, szColName,ColSize);
	}
	memcpy(pBuffer+ColSize, szBuffer,BufferSize-ColSize);
	MyDbgPrint("pBuffer=%s\n", pBuffer);

	ZwSetInformationFile(hFile,
		&file_status,
		&fpi, 
		sizeof(FILE_POSITION_INFORMATION),
		FilePositionInformation);

	ZwWriteFile(hFile, NULL, NULL, NULL, &ioStatus, pBuffer, BufferSize, NULL, NULL);
	MyDbgPrint("WriteByte:%d\n", ioStatus.Information);

	ExFreePool(pBuffer);
	ZwClose(hFile);

	ColSize=0;
	return TRUE;
}
```

`src/WriteFile/WriteFile.h`:

```h
 #include "config.h"
#include "strsafe.h"

BOOLEAN WriteFileA(char szBuffer[] );
BOOLEAN  WriteFileW(WCHAR wBuf[]);

#define MAX_PATH 256
char szBuf[MAX_PATH];
WCHAR wBuf[MAX_PATH];


extern char szProcessName [MAX_PATH];
extern char szLogFileName [MAX_PATH];
extern int iMLPX;

UNICODE_STRING Unicode_ProcessName;


#define LOG_BUILD 1
#define LOG2FILEA(fmt, ...) \
	do { if (LOG_BUILD){ StringCbPrintfA(szBuf,_MAX_LEN_,fmt, ##__VA_ARGS__ ); }  WriteFileA(szBuf);} while (0)


#define LOG2FILEW(fmt, ...) \
	do { if (LOG_BUILD){ StringCbPrintfW(wBuf,_MAX_LEN_,fmt, ##__VA_ARGS__ ); }  WriteFileW(wBuf);} while (0)
```

`src/checks/apic/apic.c`:

```c


#include "dbg\debug.h"
#include "checks\checks.h"

/* Perform APIC check:  Advanced Programmable Interrupt Controller 
 * This driver works when APIC is not relocated
 * In case it was relocated, an error is raised
 */

int check_apic()
{
	UINT64 apic_base;
	debug("Checking APIC");
	/* read APIC MSR */
	apic_base=(__readmsr(MSR_APIC_BASE) & (APIC_MASK));
	/* check the default value */
	if((apic_base>>APIC_MASK_OFFSET)!=APIC_BASE_VALUE)
	{
		return APIC_WAS_REMAPPED;
		/* TODO: support apic remap
		 * Save apic_base value for further usage
		 * APIC value is located at the +0x340 offset
		 */
	}
	
	return NO_ERROR;

}
```

`src/checks/checks.c`:

```c


#include "dbg\debug.h"
#include "checks\checks.h"
#include "simple-pebs.h"
#include "LBR\LBR.h"

/* perform all checks at once */
int perform_checks()
{
	int ret_code;
	UINT64 cap;
	debug("Performing Checks");


	/* check if CPU is Intel
	 * AMD processor uses another kind of branch monitor
	 */
	if((ret_code=CPU_check())!=NO_ERROR)
	{
		return CPU_IS_NOT_INTEL;
	}
	/* check if APIC was changed */
	if((ret_code=check_apic())!=NO_ERROR)
	{
		return APIC_WAS_REMAPPED;
	}
	/* Check if CPU is x64
	 * BTS supports x86; the current implm. doesn't
	 * TODO: change structs to support UINT32
	 */
	if((ret_code=check_is_64())!=NO_ERROR)
	{
		return CPU_IS_NOT_64;
	}
	/* Check if CPU has DS support
	 * This is required for writing on O.S pages
	 * If it doesn't, use LBR instead BTS
	 */
	if((ret_code=check_has_ds())!=NO_ERROR)
	{
		return CPU_HAS_NO_DS;
	}
	/* check BTS support itself */
	if((ret_code=check_has_bts())!=NO_ERROR)
	{
		debug("BTS not support");
		return CPU_HAS_NO_BTS;
	}
	debug("BTS support");

	/* Probably more checks are available
	 * TODO: Check for PERF_COUNT support
	 */
	cap=__readmsr(MSR_IA32_PERF_CAPABILITIES);
	pebs_record_size = 0;
	PEBs_V=(cap >> 8) & 0xf;
		switch (PEBs_V) {
		case 1:
			pebs_record_size = sizeof(struct pebs_v1);
				DbgPrint("pebs_v1  ");
					LBR_SIZE=8;
			break;
		case 2:
			pebs_record_size = sizeof(struct pebs_v2);
			DbgPrint("pebs_v2  ");
				LBR_SIZE=16;
			break;
		case 3:
			pebs_record_size = sizeof(struct pebs_v3);
			LBR_SIZE=32;
				DbgPrint("pebs_v3  ");
			break;
		default:
				DbgPrint("pebs_record_size=%d",pebs_record_size);
				return Unsupported_PEBS_Format;
		}

	return NO_ERROR;
}




```

`src/checks/checks.h`:

```h


#include "config.h"

/* CPUID */

#define CPUID_MAX_STRING 12
#define CPUID_NUM_REGS 4
#define CPUID_VENDOR_INFO 0
#define CPUID_PROC_FEATURES 1
#define CPUID_NUM_PEBS 0x0A

/* MSR */

#define MSR_MISC 416

/* Registers */

#define REG_EAX 0
#define REG_EBX 1
#define REG_ECX 2
#define REG_EDX 3

/* Flags and Offsets */

#define DS_BIT_OFFSET 21
#define x64_BITS_OFFSET 2
#define BTS_BIT_OFFSET 11
#define BIT_ENABLED 1

#define MSR_APIC_BASE 27
#define APIC_MASK 0xFFFFF000
#define APIC_MASK_OFFSET 12
#define APIC_BASE_VALUE 0xfee00
#define PERF_COUNTER_APIC 0xFEE00340

/* Errors and messages */

/* Error messages associated to the following enum */
/* TODO: Find a way of sync */

static const char *enum_string[]={
	"Everything OK",
	"You are not running an Intel CPU",
	"You are not running an x64 CPU",
	"CPU has no DS AREA",
	"CPU has no BTS support",
	"CPU APIC was remapped",
	"Unsupported PEBS format"
};

/* error codes */

enum error_codes
{
	NO_ERROR, /* In case of no error */
	CPU_IS_NOT_INTEL, /* In case of CPU is not Intel */
	CPU_IS_NOT_64, /* In case of a 32-bit CPU */
	CPU_HAS_NO_DS, /* Only LBR support */
	CPU_HAS_NO_BTS, /* Missing BTS support */
	APIC_WAS_REMAPPED ,/* APIC relocation not supported yet */
	Unsupported_PEBS_Format
};

/* Checks prototypes */

int perform_checks();
int CPU_check();
int check_apic();
int check_is_64();
int check_has_ds();
int check_has_bts();
int PMCx_check();
// for PEBS
unsigned pebs_event;


int PEBs_V;


```

`src/checks/cpu/cpuid.c`:

```c


#include "dbg\debug.h"
#include "checks\checks.h"
#include "simple-pebs.h"

/* This file contains all cpu-related checks */

/* check if it is Intel */
int CPU_check()
{
	/* Vendor String */
	char vendor[CPUID_MAX_STRING+1];
	/* ABI registers */
	int regs[CPUID_NUM_REGS];


	debug("Checking CPU Vendor");

	/* CPUID for vendor info*/
	__cpuid(regs,CPUID_VENDOR_INFO);
	
	/* building string -- weird reg order on ABI */
	memcpy(&vendor[0],&regs[REG_EBX],sizeof(int));
	memcpy(&vendor[4],&regs[REG_EDX],sizeof(int));
	memcpy(&vendor[8],&regs[REG_ECX],sizeof(int));
	vendor[CPUID_MAX_STRING]='\0';

	debug(vendor);

	/* Check Intel */
	if(strcmp(vendor,"GenuineIntel")==0)
	{
		return NO_ERROR;
	}

	return CPU_IS_NOT_INTEL;
}


int PMCx_check()
{
	/* Vendor String */
	char vendor[CPUID_MAX_STRING+1];
	/* ABI registers */
	int regs[CPUID_NUM_REGS];


	debug("PMCx_check ");


	/* CPUID for vendor info*/
	__cpuid(regs,CPUID_NUM_PEBS);


	NumberofPMCs=0;
	/* building string -- weird reg order on ABI */
	memcpy(&NumberofPMCs,&regs[REG_EAX],sizeof(int));

	NumberofPMCs=NumberofPMCs>>8;
	DbgPrint("#Core=%d, NumberofPMCs=%d",KeNumberProcessors,NumberofPMCs);
	return NumberofPMCs;
}


/* Check for specific bit values 
 * TODO: Could be a macro
 */
INT64 CHECK_BIT(INT64 var,int pos)
{
	return ((var) & (1LL<<(pos)))>>(pos);
}

/* check if DS structure is 64 bits */

int check_is_64()
{
	int regs[CPUID_NUM_REGS];

	debug("Checking x64 CPU");

	/* cpuid processor features - eax = 1 */
	__cpuid(regs,CPUID_PROC_FEATURES);
	/* 64 bits DS = ECX[2]=1 */
	if(CHECK_BIT(regs[REG_ECX],x64_BITS_OFFSET)==BIT_ENABLED)
	{
		return NO_ERROR;
	}
	return CPU_IS_NOT_64;
}

/* Check if debug store capabilitie is present */
int check_has_ds()
{
	int regs[CPUID_NUM_REGS];

	debug("Check DS support");

	__cpuid(regs,CPUID_PROC_FEATURES);
	/* EDX[21]=1 */
	if(CHECK_BIT(regs[REG_EDX],DS_BIT_OFFSET)==BIT_ENABLED)
	{
		return NO_ERROR;
	}
	return CPU_HAS_NO_DS;
}

/* Check if processor has BTS capabilities */
int check_has_bts()
{
	INT64 msr;

	debug("Check BTS support");

	/* IA32_MISC_MSR - 416 */
	msr=__readmsr(MSR_MISC);
	/* MSR[11]=1 */
	if(CHECK_BIT(msr,BTS_BIT_OFFSET)==BIT_ENABLED)
	{
		return CPU_HAS_NO_BTS;
	}
	return NO_ERROR;
}
```

`src/config.h`:

```h
#pragma warning(disable:4189) // 局部变量已初始化但不引用
#pragma warning(disable:4100) // 未引用的形参
#pragma warning(disable:4102) // 未引用的标签
#pragma warning(disable:4101) //  未引用的局部变量
#pragma warning(disable:4702) //  无法访问的代码
#pragma warning(disable:4201) //  使用了非标准扩展 : 无名称的结构/联合

/* Headers included on all files */

#include<fltKernel.h>
#include <dontuse.h>
#include <suppress.h>
#include<intrin.h> /* MSR support */

/* The following configs apply to whole driver */
#define _MYDEBUG_
//#define DEBUG /* define if debug info will be printed */
#define DRIVER_NAME "[LoopHPCs]" /* define the driver name printed when debugging */
#define DRIVERNAME L"\\Device\\LoopHPCs" /* driver name for windows subsystem */
#define DOSDRIVERNAME L"\\DosDevices\\LoopHPCs" /* driver name for ~DOS~ subsystem */

// bin address
#define BIN_BASE 0x14000000
#define BIN_SIZE 0xA00

#pragma warning(disable : 4995)


/* device extension */
#pragma once

/* additional driver data. This struct should be included on DriverObject */
typedef struct _de
{
	/* ISR handler, used to load/unload it */
	PVOID nmicallbackhandler;
	/* DS and BTS O.S. pages, used to alloc/free it */
	PVOID DS_BASE;
	PVOID BTS_BUFFER;
	//[Q]
	PVOID64 PEB_BUFFER;
	/* APIC pointer, used to set/unset it */
	UINT32* APIC;
} device_ext,*pdevice_ext;

/* generic thread controller */
 void control_thread(int action, int core);
 void unhook_handler();
void hook_handler();

extern UINT64 PID;
extern UINT64 TID;
extern UINT64 CurrentTID;
extern UINT64 process_address;
extern UINT64 process_size;
extern UINT64 lib_MaxAddress;
extern PVOID64  g_pSemaphore; 


#define _PMI_

 /* BTS Core -- while muticore is not supported yet */
#define CORE3 3
#define MAX_PROC 4
```

`src/dbg/debug.c`:

```c


#include "debug.h"
#include "checks\checks.h"

/* DbgPrint wrapper
 * It is a way of automatically printing driver name every call
 * Useful for debug filtering -- string-based
 */
void debug(char msg[])
{
#ifdef DEBUG
	DbgPrint("%s %s",DRIVER_NAME,msg);
#else
	UNREFERENCED_PARAMETER(msg);
	return;
#endif
}



/* Printing error message associated to an error code */
void emit_error(int code){
	DbgPrint("%s ERROR: %s",DRIVER_NAME,enum_string[code]);
}





void GetCurrentTimeString()
{
	static CHAR  szTime[128];
	LARGE_INTEGER SystemTime;
	LARGE_INTEGER LocalTime;
	TIME_FIELDS  timeFiled;

	KeQuerySystemTime(&SystemTime);
	ExSystemTimeToLocalTime(&SystemTime, &LocalTime);
	RtlTimeToTimeFields(&LocalTime, &timeFiled);
	DbgPrint("%02d:%02d:%02d"
		, timeFiled.Hour
		, timeFiled.Minute
		, timeFiled.Second
		);

}
```

`src/dbg/debug.h`:

```h


#include "config.h"




/* Debug messages prototype */

void debug(char msg[]);
void emit_error(int code);
void GetCurrentTimeString();

//#define _DEBUG_


#ifdef _DEBUG_
	#define MyDbgPrint DbgPrint
#else
#define MyDbgPrint
#endif


#define _PEB_
#define _LBR_

 BOOLEAN  bPrint_pebs_index;
 int IndexofClose;
```

`src/device/device.c`:

```c


#include "device.h"
#include "IO\IO.h"

/* Create Device Routine
 * THis driver will work as a FS resource
 * You can open a handle to this driver 
 */
NTSTATUS CreateDevice(PDRIVER_OBJECT DriverObject)
{
	int i;
	NTSTATUS status;
	PDEVICE_OBJECT dev;
	UNICODE_STRING namestring,linkstring;
	debug("Creating Device");


	DriverObject->DeviceObject=NULL;

	RtlInitUnicodeString(&namestring,DRIVERNAME); 
	status=IoCreateDevice(DriverObject,0,&namestring,FILE_DEVICE_DISK_FILE_SYSTEM,FILE_DEVICE_SECURE_OPEN,FALSE,&dev);
	if(!NT_SUCCESS(status))
	{
		DbgPrint("[Error] Creating Device Error");
		return status; /* In Case of failing */
	}

	DriverObject->DeviceObject=dev;

	RtlInitUnicodeString(&linkstring,DOSDRIVERNAME);
	status=IoCreateSymbolicLink(&linkstring,&namestring); /* Linking the name */
	if(!NT_SUCCESS(status))
	{
		debug("Error Creating Link");
		IoDeleteDevice(dev); /* Error, remove and unload */
		return status;
	}


	/* registering generic I/O routines */
	for(i=0;i<IRP_MJ_MAXIMUM_FUNCTION;i++)
	{
		DriverObject->MajorFunction[i]=NotSupported;
	}
	/* registering specific I/O routines */
	DriverObject->MajorFunction[IRP_MJ_CREATE]=Create;
	DriverObject->MajorFunction[IRP_MJ_READ]=Read;
	DriverObject->MajorFunction[IRP_MJ_CLOSE]=Close;
	//register the DispatchIoctl to MajorFunction
	DriverObject->MajorFunction[IRP_MJ_DEVICE_CONTROL] = DispatchIoctl;

	dev->Flags|=DO_BUFFERED_IO;

	return STATUS_SUCCESS;
}

```

`src/device/device.h`:

```h


#include "config.h"
#include "dbg\debug.h"

/* device setup routine */
NTSTATUS CreateDevice(PDRIVER_OBJECT DriverObject);
```

`src/ioctl.h`:

```h


/* avoid multiple includes */
#pragma once

#define FILE_DEVICE_INVERTED 0xCF54

/* Operations - control codes */
#define IOCTL_SEND_LOGFILENAME CTL_CODE(FILE_DEVICE_UNKNOWN, 2048, METHOD_BUFFERED, FILE_ANY_ACCESS)
#define IOCTL_SEND_MLPX CTL_CODE(FILE_DEVICE_UNKNOWN, 2049, METHOD_BUFFERED, FILE_ANY_ACCESS)
#define IOCTL_SEND_PNAME CTL_CODE(FILE_DEVICE_UNKNOWN, 2050, METHOD_BUFFERED, FILE_ANY_ACCESS)
#define IOCTL_SEND_PID CTL_CODE(FILE_DEVICE_UNKNOWN, 2051, METHOD_BUFFERED, FILE_ANY_ACCESS)
#define IOCTL_SEND_TID CTL_CODE(FILE_DEVICE_UNKNOWN, 2052, METHOD_BUFFERED, FILE_ANY_ACCESS)
#define IOCTL_SEND_CurrentTID CTL_CODE(FILE_DEVICE_UNKNOWN, 2053, METHOD_BUFFERED, FILE_ANY_ACCESS)

#define IOCTL_SEND_ADDR CTL_CODE(FILE_DEVICE_UNKNOWN, 2061, METHOD_BUFFERED, FILE_ANY_ACCESS)
#define IOCTL_SEND_SIZE CTL_CODE(FILE_DEVICE_UNKNOWN, 2062, METHOD_BUFFERED, FILE_ANY_ACCESS)
#define IOCTL_SEND_LibsAddrMax CTL_CODE(FILE_DEVICE_UNKNOWN, 2063, METHOD_BUFFERED, FILE_ANY_ACCESS)

#define IOCTL_SET_Semp CTL_CODE(FILE_DEVICE_UNKNOWN, 2071, METHOD_BUFFERED, FILE_ANY_ACCESS)
```

`src/list/list.c`:

```c

#include "MagicCheck/MagicCheck.h"
#include "list.h"
#include "dbg\debug.h"
#include "simple-pebs.h"
#include "WriteFile\WriteFile.h"


enum SortType
{
	Type_Counter, 
	Type_Time,
	Type_Address
};

#define _SortType_ Type_Address


/* some things I have to define as global due to IRQL issues */
KSPIN_LOCK list_lock;
KIRQL irq2;
int LenofLoopList=0;
extern PCHAR szBuffer_BASE;

UINT64  getBaseAddress(UINT64 address)
{
	if(address>=_Original_Code_&&address<_Original_Rdata_)
	{
		return _Original_Code_;
	}
	else
	{
		return address;
	}
}


int ListLength(PLIST_ENTRY List_Header )
{
	PLIST_ENTRY tempEntry=NULL;
	int i=0;
	if(List_Header==NULL)
	{
		return 0;
	}
	tempEntry=List_Header;
	i=0;
	do{
		tempEntry=tempEntry->Flink;
		i++;
	}while(tempEntry!=List_Header);
	i--;
	return i;
}

BOOLEAN create_list(PLIST_ENTRY *List_Header )
{
	if(*List_Header!=NULL)
	{
		return TRUE;
	}
	KeInitializeSpinLock(&list_lock);
	*List_Header=(PLIST_ENTRY)ExAllocatePool(NonPagedPool,sizeof(LIST_ENTRY));
	if(*List_Header==NULL)
	{
		DbgPrint("Allocation List_Header Error !");
		DbgPrint("*List_Header=%08X", *List_Header);
		return FALSE;
	}
	else
	{
		//DbgPrint("Allocation List_Header suscess !");
		InitializeListHead(*List_Header);
	}
	return TRUE;
}
//Delete the inner loop
void CleanLoop()
{
	PLIST_ENTRY Current_Entry=NULL;
	PLIST_ENTRY Next_Entry=NULL;
	PLIST_ENTRY Temp_Entry=NULL;
	PLoopList Current_Content=NULL;
	PLoopList Next_Content=NULL;

	UINT64 MaxCounter=0;
	UINT64 MaxFrom=0;
	UINT64 PMC=0;

	if(LoopList_Header==NULL || IsListEmpty(LoopList_Header))
	{
		return;
	}
		
	ExAcquireSpinLock(&list_lock,&irq2);
	//Search the Max_content in term of LoopInfo.Counter.
	for(Current_Entry = LoopList_Header->Flink ; Current_Entry != LoopList_Header; Current_Entry = Current_Entry->Flink  )
	{
		Current_Content = CONTAINING_RECORD(Current_Entry, LoopList, loopList);
		for(Next_Entry = Current_Entry->Flink ; Next_Entry != Current_Entry;  )
		{
			Next_Content = CONTAINING_RECORD(Next_Entry, LoopList, loopList);
			if(	 Next_Content->LoopInfo.FROM<=Current_Content->LoopInfo.FROM
				&& Next_Content->LoopInfo.TO>=Current_Content->LoopInfo.TO)
			{
				Temp_Entry=Next_Entry;
				Next_Entry = Next_Entry->Flink;
				RemoveEntryList(Temp_Entry);
			}//delete entry		
		}
	}//end of 	Search
	KeReleaseSpinLock(&list_lock,irq2);
}
void destroy_list( )
{
	DbgPrint("[destroy_list] MLPX is %d\n",iMLPX);

	//CleanLoop();

	//Print and Remove the loop list
	if(LoopList_Header!=NULL)
	{
		while(!IsListEmpty(LoopList_Header))
		{
			Remove_LoopList(LoopList_Header);
		}
		ExFreePool(LoopList_Header);
	}


	return;
}


BOOLEAN Remove_LoopList(PLIST_ENTRY LoopList_Header )
{
	PLIST_ENTRY Next_Entry=NULL;
	PLIST_ENTRY Max_Entry=NULL;
	PLoopList next_content=NULL;
	PLoopList Max_content=NULL;
	int i,j=0;
	UINT64 MaxCounter=0;
	UINT64 MaxFrom=0;
	UINT64 PMC=0;

	/*
	ExAcquireSpinLock(&list_lock,&irq2);
	//Search the Max_content in term of LoopInfo.Counter.
	for(Next_Entry = LoopList_Header->Flink ; Next_Entry != LoopList_Header; Next_Entry = Next_Entry->Flink  )
	{
		next_content = CONTAINING_RECORD(Next_Entry, LoopList, loopList);

		if (_SortType_ ==Type_Counter)
		{
			if(	 next_content->LoopInfo.Counter>MaxCounter)
			{
				MaxCounter=next_content->LoopInfo.Counter;
				Max_Entry=  Next_Entry;
			}
		}
		else if (_SortType_ ==Type_Address)
		{
			if(	 ((next_content->LoopInfo.FROM)&0x000000000000FFFF)>MaxFrom)
			{
				MaxFrom= (next_content->LoopInfo.FROM)&0x000000000000FFFF;
				Max_Entry=  Next_Entry;
			}
		}
		else
		{
			Max_Entry= LoopList_Header->Flink;
		}
	}//end of 	Search
	KeReleaseSpinLock(&list_lock,irq2);
	*/

	//Print the Entry in loop list
	Max_Entry= LoopList_Header->Flink;
	Max_content=CONTAINING_RECORD(Max_Entry,LoopList,loopList);
	//If Max_content->LoopInfo.Counter=1, we can't calculate the delta of PEBs
	//MLPX
	if(Max_content->LoopInfo.Counter>1 &&
		(! (Max_content->LoopInfo.FROM>=_Original_Code_ && Max_content->LoopInfo.FROM<_Original_Rdata_) )
		)
	{	
		StringCbPrintfA(szBuffer_BASE, szBuffer_SIZE,"0x%08X,0x%08X,0x%08X,%d",((Max_content->LoopInfo.FROM)&0x000000000000FFFF),Max_content->LoopInfo.FROM, Max_content->LoopInfo.TO, Max_content->LoopInfo.Counter);
		WriteFileA(szBuffer_BASE);
		
		for(i=0; i<iMLPX; i++)
		{
			for(j=OutSet; j<MAX_PMCx; j++)
			{
				PMC=iMLPX*(Max_content->LoopInfo.Counter,Max_content->LoopInfo.PMC_End[i][j]-Max_content->LoopInfo.PMC_Start[i][j]);
				StringCbPrintfA(szBuffer_BASE, szBuffer_SIZE,",%lld", PMC);
				WriteFileA(szBuffer_BASE);
			}
		}
		WriteFileA("\r\n");
	}

	//Remove the Entry in loop list
	ExFreePool(Max_content);
	RemoveEntryList(Max_Entry);
	LenofLoopList--;
	return TRUE;
}



DWORD64  CheckThrehold=0x200; 


BOOLEAN Find_Insert_LoopList(UINT64  FROM,UINT64 TO,UINT64 Counter, UINT64 ESP,UINT64 INST,  UINT64 CYCLE,UINT64 CurrentPMC[],PLIST_ENTRY DLAHeader)
{	
	PLoopList Find_Loop=NULL;
	PLIST_ENTRY next=NULL;
	PLIST_ENTRY nextDLA=NULL;
	PDLA DLA_Content=NULL;
	PLoopList tempData=NULL;
	PDATALA tempDataLA=NULL;
	UINT64 Layer=0;
	BOOLEAN bRepMov=FALSE;
	BOOLEAN bFindLoop=FALSE;
	UINT64 currentEsp=0;
	UINT64 ddDataLA=0;
	int i,j=0;


	if(LoopList_Header==NULL)
	{
		DbgPrint("[Find_Insert_LoopList] LoopList_Header is NULL!");
		return FALSE;
	}

	// Loop search
	for(next = LoopList_Header->Flink  ; next != LoopList_Header; next = next->Flink  )
	{
		Find_Loop = CONTAINING_RECORD(next, LoopList, loopList);

		//negative branch, loop?
		if(FROM>TO&&FROM-TO<0x1000)
		{
			//  Match Exising Loop
			if( Find_Loop->LoopInfo.TO==TO&&Find_Loop->LoopInfo.FROM==FROM)
			{
				bFindLoop=TRUE;
				MyDbgPrint("Matched Loop: %08X-->%08X, Counter=%d",FROM, TO, Find_Loop->LoopInfo.Counter+1 );
				// Enter the loop again
				if(Find_Loop->LoopInfo.bActive==FALSE)
				{
					MyDbgPrint("Enter Loop again: %08X-->%08X", Find_Loop->LoopInfo.FROM, Find_Loop->LoopInfo.TO);
					Find_Loop->LoopInfo.INST_Start+=INST-Find_Loop->LoopInfo.INST_End;
					Find_Loop->LoopInfo.CYCLE_Start+=CYCLE-Find_Loop->LoopInfo.CYCLE_End;
					for(i=OutSet; i<MAX_PMCx;i++)
					{
						Find_Loop->LoopInfo.PMC_Start[Multiplex_Index][i]+=CurrentPMC[i];
					}

					Find_Loop->LoopInfo.bActive=TRUE;
				}

		//		Find_Loop->LoopInfo.INST_End=INST;
		//		Find_Loop->LoopInfo.CYCLE_End=CYCLE;
				for(i=OutSet; i<MAX_PMCx;i++)
				{
					Find_Loop->LoopInfo.PMC_End[Multiplex_Index][i]+=CurrentPMC[i];
				}

			//	Find_Loop->LoopInfo.ESP=ESP;
			//	Layer=Find_Loop->LoopInfo.Layer;	

				Find_Loop->LoopInfo.Counter++;
				Multiplex_Index= (Find_Loop->LoopInfo.Counter)%iMLPX;

			} 	//  End of Match Exising Loop
		/*	else
			{
				DbgPrint("Not Matched Loop : %08X-->%08X", Find_Loop->LoopInfo.FROM, Find_Loop->LoopInfo.TO);
			
			}
			*/
		}//End of  negative branch 

		//determine the "bActive"
		//Inner the  Find_Loop
		if( TO>=Find_Loop->LoopInfo.TO &&TO<=Find_Loop->LoopInfo.FROM)
		{
			Find_Loop->LoopInfo.bActive=TRUE;
			MyDbgPrint(" IP: %08X-->%08X is within  the loop %08X-->%08X", FROM, TO, Find_Loop->LoopInfo.FROM, Find_Loop->LoopInfo.TO);
		}
		else
		{
			MyDbgPrint("IP: %08X-->%08X  exit  the loop %08X-->%08X", FROM, TO, Find_Loop->LoopInfo.FROM, Find_Loop->LoopInfo.TO);
			Find_Loop->LoopInfo.bActive=FALSE;
		}//End of determining the "bActive"

	}//End of  Loop search

	//Since current Loop does not match any existing loop,  we create a new Loop.
	if( (FROM>TO&&FROM-TO<0x1000)
		&& 	bFindLoop==FALSE)
	{	
		//TO-DbgPrint
		MyDbgPrint("New Loop: %08X-->%08X", FROM, TO);
		// Record 0 PEBs value for the first item of loop
		// Insert_LoopList(  FROM, TO, Counter, 0,  0, 0, ddDataLA,ddOriginalCode);
		tempData=(PLoopList)ExAllocatePool(NonPagedPool,sizeof(LoopList));
		if(tempData==NULL)
		{
			DbgPrint("[Insert_LoopList]	 Allocate tempData	 Error");
			return FALSE;
		}
		tempData->LoopInfo.FROM=FROM;
		tempData->LoopInfo.TO=TO;
		tempData->LoopInfo.Counter=	1;
		tempData->LoopInfo.bActive=TRUE;

		for(i=0; i<iMLPX; i++)
		{
			for(j=OutSet; j<MAX_PMCx;j++)
			{
				tempData->LoopInfo.PMC_Start[i][j]=0;
				tempData->LoopInfo.PMC_End[i][j]=0;
			}
		}

		InsertTailList(LoopList_Header,&(tempData->loopList));
		LenofLoopList++;
		lastLoop=tempData;
	}// end of new create loop

	return TRUE;
}

```

`src/list/list.h`:

```h
#include "config.h"
#include "simple-pebs.h"

// For MyCode.
typedef struct st_DLAofMyCode
{
	UINT64  DataLA;
	BOOLEAN  bRepMov;
	UINT64  EventingIP;
	UINT64 NextIP;
	//第二级链表
	LIST_ENTRY DataLAList;
	// Flink 指向下一个 LIST_ENTRY 结构， Blink 指向前一个 LIST_ENTRY 结构。
}DLA,*PDLA;


typedef struct st_DataLA
{
	UINT64  ddDataLAMin;
	UINT64 ddDataLAMax;
	//第二级链表
	LIST_ENTRY DataLAList;
	// Flink 指向下一个 LIST_ENTRY 结构， Blink 指向前一个 LIST_ENTRY 结构。
}DATALA,*PDATALA;


typedef struct st_LayerList
{
	UINT64 ddDataLANode;
	UINT64 ddOriginalPEHeader;
	UINT64	ddOriginalCode;
	UINT64	ddOriginalRdata;
	UINT64	ddOriginalData;
	UINT64 	OriginalDLA;
	UINT64	INST;
	UINT64	CYCLE;
	UINT64 	PMC[Multiplexing][MAX_PMCx];

  //第一级链表
	LIST_ENTRY  layerList ;
	// Flink 指向下一个 LIST_ENTRY 结构， Blink 指向前一个 LIST_ENTRY 结构。
}LayerList,*PLayerList;

typedef struct st_LOOPInfo
{
	UINT64  Layer;
	BOOLEAN bActive; // Is the EIP within the loop?
	BOOLEAN bOriginaCode; // Does the loop generate original code?
	UINT64	FROM;
	UINT64	TO;
	UINT32  Counter;
	//Start Value
	UINT64	INST_Start;
	UINT64	CYCLE_Start;
	UINT64 	PMC_Start[Multiplexing][MAX_PMCx];

	//End Value
	UINT64	INST_End;
	UINT64	CYCLE_End;
	UINT64 	PMC_End[Multiplexing][MAX_PMCx];

	UINT64  ESP;

	UINT64  ddOriginalPEHeader;
	UINT64	ddOriginalCode;
	UINT64	ddOriginalRdata;
	UINT64	ddOriginalData;
}LOOPInfo,*PLOOPInfo;


typedef struct st_list_data
{
	LOOPInfo LoopInfo;
	LIST_ENTRY loopList;
}LoopList,*PLoopList;


/* List operations */
BOOLEAN Remove_LoopList(PLIST_ENTRY LoopList_Header );
BOOLEAN Find_Insert_LoopList(UINT64  FROM,UINT64 TO,UINT64 Counter, UINT64 ESP, UINT64 INST, UINT64 CYCLE,UINT64 CurrentPMC[],PLIST_ENTRY DLAHeader);
BOOLEAN create_list(PLIST_ENTRY *List_Header );
void destroy_list();
BOOLEAN DLA2Layer(UINT64 Layer_Index, PLIST_ENTRY DLAHeader );
int FindLayer(UINT64  FROM,UINT64 TO);
int ListLength(PLIST_ENTRY List_Header );



PLIST_ENTRY LoopList_Header;
// For "exit-then-enter"
PLoopList lastLoop;

PLIST_ENTRY DLAListHeader;


#define  _MAX_BIN_   0x04000000  
//#define  _MAX_BIN_   0x10000000 
// For PEP
#define _SUCCESSIVE_VALUE_  0x200
#define  _CLib_MIN_   0x00400000
#define  _CLib_MAX_ 0x00401000
//_StackTrace_MAX_  is the max value of delta stack value for the call in the loop
// Fit for the PETite packer
#define  _StackTrace_MAX_ 0x10

//#define  _BaseAddress_(x)   (x&0xFFFFFFFFFFFF0000)
// For Normal_160K
/*
#define  _Original_PEHeader_ 0x00400000  
#define  _Original_Code_ 0x00401000  
#define  _Original_Rdata_ 0x00429000   
#define  _Original_Data_ 0x0042A000 
#define  _Original_PETail_ 0x0042A400  
#define _Original_DLA_Min	0x0042A0E2
#define _Original_DLA_Max	0x0042A1AA
*/
// For Normal_3M
#define  _Original_PEHeader_ 0x00400000  
#define  _Original_Code_		0x00401000  
#define  _Original_Rdata_	0x00736000   
#define  _Original_Data_		0x00737000
#define  _Original_PETail_   0x00737200  
#define _Original_DLA_Min	0x007370E2 //0x00737146
#define _Original_DLA_Max	0x007371AA //0x007371A9


#define MIN(X,Y) ((X)>(Y)?(Y):(X))
#define MAX(X,Y) ((X)<(Y)?(Y):(X))

#define szBuffer_SIZE 1000
```

`x64/Win7Release/BranchMonitor.Build.CppClean.log`:

```log
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\TEST.OBJ
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\WRITEFILE.OBJ
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\THREAD.OBJ
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\PMI.OBJ
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\MAGICCHECK.OBJ
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\LIST.OBJ
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\LBR.OBJ
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\IO.OBJ
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\DEVICE.OBJ
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\DEBUG.OBJ
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\CPUID.OBJ
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\CHECKS.OBJ
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\APIC.OBJ
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\BRANCHMONITOR.OBJ
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\SIMPLE-PEBS.OBJ
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\MYCODE.OBJ
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\VC110.PDB
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\BRANCHMONITOR.SYS
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\BRANCHMONITOR.PDB
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\BRANCHMONITOR.RES
E:\PAPER\HPCS\SRC\DRIVER\CURRENT\X64\WIN7RELEASE\BRANCHMONITOR.INF
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\BranchMonitor.cer
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\BranchMonitor.inf
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\apic.obj
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\BranchMonitor.obj
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\checks.obj
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\cpuid.obj
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\debug.obj
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\device.obj
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\IO.obj
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\LBR.obj
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\list.obj
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\MagicCheck.obj
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\MyCode.obj
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\PMI.obj
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\simple-pebs.obj
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\Test.obj
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\thread.obj
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\WriteFile.obj
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\cl.command.1.tlog
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\CL.read.1.tlog
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\CL.write.1.tlog
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\link-cvtres.read.1.tlog
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\link-cvtres.write.1.tlog
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\link.command.1.tlog
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\link.read.1.tlog
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\link.write.1.tlog
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\rc.command.1.tlog
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\rc.read.1.tlog
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\rc.write.1.tlog
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\signtool.command.1.tlog
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\signtool.read.1.tlog
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\signtool.write.1.tlog
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\stampinf.command.1.tlog
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\stampinf.read.1.tlog
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\stampinf.write.1.tlog
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\BranchMonitor.res
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\BranchMonitor.pdb
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\vc110.pdb
E:\Paper\HPCs\Src\Driver\Current\x64\Win7Release\BranchMonitor.sys

```

`x64/Win7Release/CL.read.1.tlog`:

```tlog
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\APIC\APIC.C
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SUPPRESS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DBG\DEBUG.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CONFIG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\FLTKERNEL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\FLTUSERSTRUCTURES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\INITGUID.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DONTUSE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\AMMINTRIN.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\CHECKS.H
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\CPU\CPUID.C
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SUPPRESS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DBG\DEBUG.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CONFIG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\FLTKERNEL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\FLTUSERSTRUCTURES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\INITGUID.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DONTUSE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\AMMINTRIN.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\CHECKS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SIMPLE-PEBS.H
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DBG\DEBUG.C
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SUPPRESS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DBG\DEBUG.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CONFIG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\FLTKERNEL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\FLTUSERSTRUCTURES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\INITGUID.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DONTUSE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\AMMINTRIN.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\CHECKS.H
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\MAGICCHECK\MAGICCHECK.C
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SUPPRESS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CONFIG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\FLTKERNEL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\FLTUSERSTRUCTURES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\INITGUID.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DONTUSE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\AMMINTRIN.H
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\WRITEFILE\WRITEFILE.C
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SUPPRESS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CONFIG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\FLTKERNEL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\FLTUSERSTRUCTURES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\INITGUID.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DONTUSE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\AMMINTRIN.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DBG\DEBUG.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\WRITEFILE\WRITEFILE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\STRSAFE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDIO.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SWPRINTF.INL
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDARG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\VADEFS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SIMPLE-PEBS.H
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\TEST.C
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SUPPRESS.H
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\THREADING\THREAD.C
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SUPPRESS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\THREADING\THREAD.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CONFIG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\FLTKERNEL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\FLTUSERSTRUCTURES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\INITGUID.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DONTUSE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\AMMINTRIN.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DBG\DEBUG.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SIMPLE-PEBS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LBR\LBR.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NDIS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NETEVENT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTDDNDIS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\IFDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\IPIFCONS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DEVPKEY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PCIPROP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WINDOT11.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WLANTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\XFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\QOS.H
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\CHECKS.C
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SUPPRESS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DBG\DEBUG.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CONFIG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\FLTKERNEL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\FLTUSERSTRUCTURES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\INITGUID.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DONTUSE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\AMMINTRIN.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\CHECKS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SIMPLE-PEBS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LBR\LBR.H
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\MYCODE.C
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SUPPRESS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DBG\DEBUG.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CONFIG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\FLTKERNEL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\FLTUSERSTRUCTURES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\INITGUID.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DONTUSE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\AMMINTRIN.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LIST\LIST.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SIMPLE-PEBS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LBR\LBR.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\CHECKS.H
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SIMPLE-PEBS.C
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SUPPRESS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SIMPLE-PEBS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CONFIG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\FLTKERNEL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\FLTUSERSTRUCTURES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\INITGUID.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DONTUSE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\AMMINTRIN.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DBG\DEBUG.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\CHECKS.H
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\IO\IO.C
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SUPPRESS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\IO\IO.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CONFIG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\FLTKERNEL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\FLTUSERSTRUCTURES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\INITGUID.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DONTUSE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\AMMINTRIN.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DBG\DEBUG.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\THREADING\THREAD.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LIST\LIST.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SIMPLE-PEBS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LBR\LBR.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\IOCTL.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\WRITEFILE\WRITEFILE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\STRSAFE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDIO.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SWPRINTF.INL
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDARG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\VADEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDLIB.H
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LBR\LBR.C
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SUPPRESS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\FLTKERNEL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\FLTUSERSTRUCTURES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\INITGUID.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\AMMINTRIN.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LBR\LBR.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SIMPLE-PEBS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CONFIG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DONTUSE.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LIST\LIST.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DBG\DEBUG.H
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LOOPHPCS.C
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SUPPRESS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CONFIG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\FLTKERNEL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\FLTUSERSTRUCTURES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\INITGUID.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DONTUSE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\AMMINTRIN.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DBG\DEBUG.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\CHECKS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DEVICE\DEVICE.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SIMPLE-PEBS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LIST\LIST.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\WRITEFILE\WRITEFILE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\STRSAFE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDIO.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SWPRINTF.INL
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDARG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\VADEFS.H
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\PMI.C
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SUPPRESS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SIMPLE-PEBS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CONFIG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\FLTKERNEL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\FLTUSERSTRUCTURES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\INITGUID.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DONTUSE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\AMMINTRIN.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LBR\LBR.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DBG\DEBUG.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\CHECKS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LIST\LIST.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDIO.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SWPRINTF.INL
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DEVICE\DEVICE.C
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SUPPRESS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DEVICE\DEVICE.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CONFIG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\FLTKERNEL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\FLTUSERSTRUCTURES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\INITGUID.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DONTUSE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\AMMINTRIN.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DBG\DEBUG.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\IO\IO.H
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LIST\LIST.C
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SUPPRESS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\MAGICCHECK\MAGICCHECK.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CONFIG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\FLTKERNEL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\FLTUSERSTRUCTURES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\INITGUID.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DONTUSE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\AMMINTRIN.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LIST\LIST.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SIMPLE-PEBS.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DBG\DEBUG.H
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\WRITEFILE\WRITEFILE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\STRSAFE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDIO.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\SWPRINTF.INL
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\STDARG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\KM\CRT\VADEFS.H

```

`x64/Win7Release/CL.write.1.tlog`:

```tlog
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\MYCODE.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SIMPLE-PEBS.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\APIC\APIC.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\CHECKS.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\CPU\CPUID.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DBG\DEBUG.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DEVICE\DEVICE.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\IO\IO.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LBR\LBR.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LIST\LIST.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LOOPHPCS.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\MAGICCHECK\MAGICCHECK.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\PMI.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\THREADING\THREAD.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\WRITEFILE\WRITEFILE.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\TEST.C
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\TEST.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\WRITEFILE.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\THREAD.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\PMI.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\MAGICCHECK.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LIST.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LBR.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\IO.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\DEVICE.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\DEBUG.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\CPUID.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\CHECKS.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\APIC.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\SIMPLE-PEBS.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\MYCODE.OBJ
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\APIC\APIC.C
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\VC110.PDB
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\CPU\CPUID.C
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\VC110.PDB
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DBG\DEBUG.C
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\VC110.PDB
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\MAGICCHECK\MAGICCHECK.C
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\VC110.PDB
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\WRITEFILE\WRITEFILE.C
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\VC110.PDB
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\TEST.C
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\VC110.PDB
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\MYCODE.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SIMPLE-PEBS.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\CHECKS.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\IO\IO.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LBR\LBR.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\PMI.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\THREADING\THREAD.C
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\CHECKS.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\THREAD.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\PMI.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LBR.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\IO.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\SIMPLE-PEBS.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\MYCODE.OBJ
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\THREADING\THREAD.C
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\VC110.PDB
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\CHECKS.C
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\VC110.PDB
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\MYCODE.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SIMPLE-PEBS.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DEVICE\DEVICE.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\IO\IO.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LBR\LBR.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LIST\LIST.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LOOPHPCS.C|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\PMI.C
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LIST.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\DEVICE.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\PMI.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LBR.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\IO.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\SIMPLE-PEBS.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\MYCODE.OBJ
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\MYCODE.C
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\VC110.PDB
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SIMPLE-PEBS.C
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\VC110.PDB
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\IO\IO.C
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\VC110.PDB
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LBR\LBR.C
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\VC110.PDB
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LOOPHPCS.C
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\VC110.PDB
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\PMI.C
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\VC110.PDB
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DEVICE\DEVICE.C
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\VC110.PDB
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LIST\LIST.C
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\VC110.PDB

```

`x64/Win7Release/LoopHPCs.Build.CppClean.log`:

```log
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\TEST.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\WRITEFILE.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\THREAD.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\PMI.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\MAGICCHECK.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LIST.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LBR.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\IO.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\DEVICE.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\DEBUG.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\CPUID.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\CHECKS.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\APIC.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\SIMPLE-PEBS.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\MYCODE.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\VC110.PDB
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.SYS
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.PDB
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.RES
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.INF
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\LoopHPCs.cer
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\LoopHPCs.inf
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\apic.obj
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\checks.obj
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\cpuid.obj
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\debug.obj
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\device.obj
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\IO.obj
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\LBR.obj
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\list.obj
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\LoopHPCs.obj
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\MagicCheck.obj
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\MyCode.obj
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\PMI.obj
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\simple-pebs.obj
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\Test.obj
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\thread.obj
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\WriteFile.obj
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\cl.command.1.tlog
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\CL.read.1.tlog
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\CL.write.1.tlog
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\link-cvtres.read.1.tlog
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\link-cvtres.write.1.tlog
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\link.command.1.tlog
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\link.read.1.tlog
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\link.write.1.tlog
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\rc.command.1.tlog
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\rc.read.1.tlog
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\rc.write.1.tlog
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\signtool.command.1.tlog
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\signtool.read.1.tlog
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\signtool.write.1.tlog
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\stampinf.command.1.tlog
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\stampinf.read.1.tlog
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\stampinf.write.1.tlog
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\LoopHPCs.res
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\LoopHPCs.pdb
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\vc110.pdb
E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\LoopHPCs.sys

```

`x64/Win7Release/LoopHPCs.inf`:

```inf
;;;
;;;LoopHPCs
;;;

[Version]
Signature   = "$Windows NT$"
; TODO - Change the Class and ClassGuid to match the Load Order Group value, see http://msdn.microsoft.com/en-us/windows/hardware/gg462963
; Class       = "ActivityMonitor"                         ;This is determined by the work this filter driver does
; ClassGuid   = {b86dff51-a31e-4bac-b3cf-e8cfe75c9fc2}    ;This value is determined by the Load Order Group value
Class = "_TODO_Change_Class_appropriately_"
ClassGuid = {_TODO_Change_ClassGuid_appropriately_}
Provider    = %ManufacturerName%
DriverVer=10/07/2021,16.28.58.929
CatalogFile = HPCs.cat

[DestinationDirs]
DefaultDestDir          = 12
MiniFilter.DriverFiles  = 12            ;%windir%\system32\drivers

;;
;; Default install sections
;;

[DefaultInstall]
OptionDesc          = %ServiceDescription%
CopyFiles           = MiniFilter.DriverFiles

[DefaultInstall.Services]
AddService          = %ServiceName%,,MiniFilter.Service

;;
;; Default uninstall sections
;;

[DefaultUninstall]
DelFiles   = MiniFilter.DriverFiles

[DefaultUninstall.Services]
DelService = %ServiceName%,0x200      ;Ensure service is stopped before deleting

;
; Services Section
;

[MiniFilter.Service]
DisplayName      = %ServiceName%
Description      = %ServiceDescription%
ServiceBinary    = %12%\%DriverName%.sys        ;%windir%\system32\drivers\
Dependencies     = "FltMgr"
ServiceType      = 2                            ;SERVICE_FILE_SYSTEM_DRIVER
StartType        = 3                            ;SERVICE_DEMAND_START
ErrorControl     = 1                            ;SERVICE_ERROR_NORMAL
; TODO - Change the Load Order Group value, see http://connect.microsoft.com/site221/content/content.aspx?ContentID=2512
; LoadOrderGroup = "FSFilter Activity Monitor"
LoadOrderGroup = "_TODO_Change_LoadOrderGroup_appropriately_"
AddReg           = MiniFilter.AddRegistry

;
; Registry Modifications
;

[MiniFilter.AddRegistry]
HKR,,"DebugFlags",0x00010001 ,0x0
HKR,,"SupportedFeatures",0x00010001,0x3
HKR,"Instances","DefaultInstance",0x00000000,%DefaultInstance%
HKR,"Instances\"%Instance1.Name%,"Altitude",0x00000000,%Instance1.Altitude%
HKR,"Instances\"%Instance1.Name%,"Flags",0x00010001,%Instance1.Flags%

;
; Copy Files
;

[MiniFilter.DriverFiles]
%DriverName%.sys

[SourceDisksFiles]
HPCs.sys = 1,,

[SourceDisksNames]
1 = %DiskId1%,,,

;;
;; String Section
;;

[Strings]
; TODO - Add your manufacturer
ManufacturerName        = "Template"
ServiceDescription      = "HPCs Mini-Filter Driver"
ServiceName             = "HPCs"
DriverName              = "HPCs"
DiskId1                 = "HPCs Device Installation Disk"

;Instances specific information.
DefaultInstance         = "HPCs Instance"
Instance1.Name          = "HPCs Instance"
; TODO - Change the altitude value, see http://connect.microsoft.com/site221/content/content.aspx?ContentID=2512
;Instance1.Altitude      = "370030"
Instance.Altitude       = "_TODO_Change_Altitude_appropriately_"
Instance1.Flags         = 0x0              ; Allow all attachments

```

`x64/Win7Release/LoopHPCs.lastbuildstate`:

```lastbuildstate
#v4.5:WindowsKernelModeDriver8.0:false
Win7 Release|x64|E:\Paper\HPCs\Src\figshare\LoopHPCs\|

```

`x64/Win7Release/LoopHPCs.log`:

```log
  Stamping x64\Win7Release\LoopHPCs.inf [Version] section with DriverVer=10/07/2021,16.28.58.929
  MyCode.c
  simple-pebs.c
simple-pebs.c(264): warning C4047: “=”:“u64”与“PVOID64”的间接级别不同
simple-pebs.c(267): warning C4047: “=”:“u64”与“PVOID64”的间接级别不同
simple-pebs.c(303): warning C4242: “=”: 从“unsigned __int64”转换到“unsigned long”，可能丢失数据
  IO.c
  LBR.c
  LoopHPCs.c
src\LoopHPCs.c(245): warning C4055: “类型转换”: 从数据指针“PVOID”到函数指针“pFnKeSetAffinityThread”
  PMI.c
src\PMI.c(114): warning C4152: 非标准扩展，表达式中的函数/数据指针转换
  device.c
  list.c
  正在生成代码...
  LoopHPCs.vcxproj -> E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\LoopHPCs.sys
  Done Adding Additional Store
  Successfully signed: E:\Paper\HPCs\Src\figshare\LoopHPCs\x64\Win7Release\LoopHPCs.sys
  

```

`x64/Win7Release/cl.command.1.tlog`:

```tlog
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\APIC\APIC.C
/c /Ix64\Win7Release\ /Zi /nologo /W4 /WX- /sdl- /Ox /Os /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D _WIN64 /D _AMD64_ /D AMD64 /D WIN32_LEAN_AND_MEAN=1 /D _WIN32_WINNT=0x0601 /D WINVER=0x0601 /D WINNT=1 /D NTDDI_VERSION=0x06010000 /GF /Gm- /Zp8 /GS /Gy /fp:precise /Zc:wchar_t- /Zc:forScope- /GR- /Fo"X64\WIN7RELEASE\\" /Fd"X64\WIN7RELEASE\VC110.PDB" /Gz /wd4603 /wd4627 /wd4986 /wd4987 /wd4996 /FI"C:\Program Files (x86)\Windows Kits\8.0\Include\Shared\warning.h" /kernel -cbstring -d2epilogunwind  /d1nodatetime /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\APIC\APIC.C
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\CPU\CPUID.C
/c /Ix64\Win7Release\ /Zi /nologo /W4 /WX- /sdl- /Ox /Os /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D _WIN64 /D _AMD64_ /D AMD64 /D WIN32_LEAN_AND_MEAN=1 /D _WIN32_WINNT=0x0601 /D WINVER=0x0601 /D WINNT=1 /D NTDDI_VERSION=0x06010000 /GF /Gm- /Zp8 /GS /Gy /fp:precise /Zc:wchar_t- /Zc:forScope- /GR- /Fo"X64\WIN7RELEASE\\" /Fd"X64\WIN7RELEASE\VC110.PDB" /Gz /wd4603 /wd4627 /wd4986 /wd4987 /wd4996 /FI"C:\Program Files (x86)\Windows Kits\8.0\Include\Shared\warning.h" /kernel -cbstring -d2epilogunwind  /d1nodatetime /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\CPU\CPUID.C
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DBG\DEBUG.C
/c /Ix64\Win7Release\ /Zi /nologo /W4 /WX- /sdl- /Ox /Os /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D _WIN64 /D _AMD64_ /D AMD64 /D WIN32_LEAN_AND_MEAN=1 /D _WIN32_WINNT=0x0601 /D WINVER=0x0601 /D WINNT=1 /D NTDDI_VERSION=0x06010000 /GF /Gm- /Zp8 /GS /Gy /fp:precise /Zc:wchar_t- /Zc:forScope- /GR- /Fo"X64\WIN7RELEASE\\" /Fd"X64\WIN7RELEASE\VC110.PDB" /Gz /wd4603 /wd4627 /wd4986 /wd4987 /wd4996 /FI"C:\Program Files (x86)\Windows Kits\8.0\Include\Shared\warning.h" /kernel -cbstring -d2epilogunwind  /d1nodatetime /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DBG\DEBUG.C
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\MAGICCHECK\MAGICCHECK.C
/c /Ix64\Win7Release\ /Zi /nologo /W4 /WX- /sdl- /Ox /Os /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D _WIN64 /D _AMD64_ /D AMD64 /D WIN32_LEAN_AND_MEAN=1 /D _WIN32_WINNT=0x0601 /D WINVER=0x0601 /D WINNT=1 /D NTDDI_VERSION=0x06010000 /GF /Gm- /Zp8 /GS /Gy /fp:precise /Zc:wchar_t- /Zc:forScope- /GR- /Fo"X64\WIN7RELEASE\\" /Fd"X64\WIN7RELEASE\VC110.PDB" /Gz /wd4603 /wd4627 /wd4986 /wd4987 /wd4996 /FI"C:\Program Files (x86)\Windows Kits\8.0\Include\Shared\warning.h" /kernel -cbstring -d2epilogunwind  /d1nodatetime /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\MAGICCHECK\MAGICCHECK.C
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\WRITEFILE\WRITEFILE.C
/c /Ix64\Win7Release\ /Zi /nologo /W4 /WX- /sdl- /Ox /Os /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D _WIN64 /D _AMD64_ /D AMD64 /D WIN32_LEAN_AND_MEAN=1 /D _WIN32_WINNT=0x0601 /D WINVER=0x0601 /D WINNT=1 /D NTDDI_VERSION=0x06010000 /GF /Gm- /Zp8 /GS /Gy /fp:precise /Zc:wchar_t- /Zc:forScope- /GR- /Fo"X64\WIN7RELEASE\\" /Fd"X64\WIN7RELEASE\VC110.PDB" /Gz /wd4603 /wd4627 /wd4986 /wd4987 /wd4996 /FI"C:\Program Files (x86)\Windows Kits\8.0\Include\Shared\warning.h" /kernel -cbstring -d2epilogunwind  /d1nodatetime /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\WRITEFILE\WRITEFILE.C
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\TEST.C
/c /Ix64\Win7Release\ /Zi /nologo /W4 /WX- /sdl- /Ox /Os /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D _WIN64 /D _AMD64_ /D AMD64 /D WIN32_LEAN_AND_MEAN=1 /D _WIN32_WINNT=0x0601 /D WINVER=0x0601 /D WINNT=1 /D NTDDI_VERSION=0x06010000 /GF /Gm- /Zp8 /GS /Gy /fp:precise /Zc:wchar_t- /Zc:forScope- /GR- /Fo"X64\WIN7RELEASE\\" /Fd"X64\WIN7RELEASE\VC110.PDB" /Gz /wd4603 /wd4627 /wd4986 /wd4987 /wd4996 /FI"C:\Program Files (x86)\Windows Kits\8.0\Include\Shared\warning.h" /kernel -cbstring -d2epilogunwind  /d1nodatetime /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\TEST.C
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\THREADING\THREAD.C
/c /Ix64\Win7Release\ /Zi /nologo /W4 /WX- /sdl- /Ox /Os /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D _WIN64 /D _AMD64_ /D AMD64 /D WIN32_LEAN_AND_MEAN=1 /D _WIN32_WINNT=0x0601 /D WINVER=0x0601 /D WINNT=1 /D NTDDI_VERSION=0x06010000 /GF /Gm- /Zp8 /GS /Gy /fp:precise /Zc:wchar_t- /Zc:forScope- /GR- /Fo"X64\WIN7RELEASE\\" /Fd"X64\WIN7RELEASE\VC110.PDB" /Gz /wd4603 /wd4627 /wd4986 /wd4987 /wd4996 /FI"C:\Program Files (x86)\Windows Kits\8.0\Include\Shared\warning.h" /kernel -cbstring -d2epilogunwind  /d1nodatetime /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\THREADING\THREAD.C
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\CHECKS.C
/c /Ix64\Win7Release\ /Zi /nologo /W4 /WX- /sdl- /Ox /Os /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D _WIN64 /D _AMD64_ /D AMD64 /D WIN32_LEAN_AND_MEAN=1 /D _WIN32_WINNT=0x0601 /D WINVER=0x0601 /D WINNT=1 /D NTDDI_VERSION=0x06010000 /GF /Gm- /Zp8 /GS /Gy /fp:precise /Zc:wchar_t- /Zc:forScope- /GR- /Fo"X64\WIN7RELEASE\\" /Fd"X64\WIN7RELEASE\VC110.PDB" /Gz /wd4603 /wd4627 /wd4986 /wd4987 /wd4996 /FI"C:\Program Files (x86)\Windows Kits\8.0\Include\Shared\warning.h" /kernel -cbstring -d2epilogunwind  /d1nodatetime /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\CHECKS\CHECKS.C
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\MYCODE.C
/c /Ix64\Win7Release\ /Zi /nologo /W4 /WX- /sdl- /Ox /Os /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D _WIN64 /D _AMD64_ /D AMD64 /D WIN32_LEAN_AND_MEAN=1 /D _WIN32_WINNT=0x0601 /D WINVER=0x0601 /D WINNT=1 /D NTDDI_VERSION=0x06010000 /GF /Gm- /Zp8 /GS /Gy /fp:precise /Zc:wchar_t- /Zc:forScope- /GR- /Fo"X64\WIN7RELEASE\\" /Fd"X64\WIN7RELEASE\VC110.PDB" /Gz /wd4603 /wd4627 /wd4986 /wd4987 /wd4996 /FI"C:\Program Files (x86)\Windows Kits\8.0\Include\Shared\warning.h" /kernel -cbstring -d2epilogunwind  /d1nodatetime /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\MYCODE.C
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SIMPLE-PEBS.C
/c /Ix64\Win7Release\ /Zi /nologo /W4 /WX- /sdl- /Ox /Os /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D _WIN64 /D _AMD64_ /D AMD64 /D WIN32_LEAN_AND_MEAN=1 /D _WIN32_WINNT=0x0601 /D WINVER=0x0601 /D WINNT=1 /D NTDDI_VERSION=0x06010000 /GF /Gm- /Zp8 /GS /Gy /fp:precise /Zc:wchar_t- /Zc:forScope- /GR- /Fo"X64\WIN7RELEASE\\" /Fd"X64\WIN7RELEASE\VC110.PDB" /Gz /wd4603 /wd4627 /wd4986 /wd4987 /wd4996 /FI"C:\Program Files (x86)\Windows Kits\8.0\Include\Shared\warning.h" /kernel -cbstring -d2epilogunwind  /d1nodatetime /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SIMPLE-PEBS.C
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\IO\IO.C
/c /Ix64\Win7Release\ /Zi /nologo /W4 /WX- /sdl- /Ox /Os /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D _WIN64 /D _AMD64_ /D AMD64 /D WIN32_LEAN_AND_MEAN=1 /D _WIN32_WINNT=0x0601 /D WINVER=0x0601 /D WINNT=1 /D NTDDI_VERSION=0x06010000 /GF /Gm- /Zp8 /GS /Gy /fp:precise /Zc:wchar_t- /Zc:forScope- /GR- /Fo"X64\WIN7RELEASE\\" /Fd"X64\WIN7RELEASE\VC110.PDB" /Gz /wd4603 /wd4627 /wd4986 /wd4987 /wd4996 /FI"C:\Program Files (x86)\Windows Kits\8.0\Include\Shared\warning.h" /kernel -cbstring -d2epilogunwind  /d1nodatetime /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\IO\IO.C
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LBR\LBR.C
/c /Ix64\Win7Release\ /Zi /nologo /W4 /WX- /sdl- /Ox /Os /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D _WIN64 /D _AMD64_ /D AMD64 /D WIN32_LEAN_AND_MEAN=1 /D _WIN32_WINNT=0x0601 /D WINVER=0x0601 /D WINNT=1 /D NTDDI_VERSION=0x06010000 /GF /Gm- /Zp8 /GS /Gy /fp:precise /Zc:wchar_t- /Zc:forScope- /GR- /Fo"X64\WIN7RELEASE\\" /Fd"X64\WIN7RELEASE\VC110.PDB" /Gz /wd4603 /wd4627 /wd4986 /wd4987 /wd4996 /FI"C:\Program Files (x86)\Windows Kits\8.0\Include\Shared\warning.h" /kernel -cbstring -d2epilogunwind  /d1nodatetime /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LBR\LBR.C
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LOOPHPCS.C
/c /Ix64\Win7Release\ /Zi /nologo /W4 /WX- /sdl- /Ox /Os /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D _WIN64 /D _AMD64_ /D AMD64 /D WIN32_LEAN_AND_MEAN=1 /D _WIN32_WINNT=0x0601 /D WINVER=0x0601 /D WINNT=1 /D NTDDI_VERSION=0x06010000 /GF /Gm- /Zp8 /GS /Gy /fp:precise /Zc:wchar_t- /Zc:forScope- /GR- /Fo"X64\WIN7RELEASE\\" /Fd"X64\WIN7RELEASE\VC110.PDB" /Gz /wd4603 /wd4627 /wd4986 /wd4987 /wd4996 /FI"C:\Program Files (x86)\Windows Kits\8.0\Include\Shared\warning.h" /kernel -cbstring -d2epilogunwind  /d1nodatetime /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LOOPHPCS.C
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\PMI.C
/c /Ix64\Win7Release\ /Zi /nologo /W4 /WX- /sdl- /Ox /Os /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D _WIN64 /D _AMD64_ /D AMD64 /D WIN32_LEAN_AND_MEAN=1 /D _WIN32_WINNT=0x0601 /D WINVER=0x0601 /D WINNT=1 /D NTDDI_VERSION=0x06010000 /GF /Gm- /Zp8 /GS /Gy /fp:precise /Zc:wchar_t- /Zc:forScope- /GR- /Fo"X64\WIN7RELEASE\\" /Fd"X64\WIN7RELEASE\VC110.PDB" /Gz /wd4603 /wd4627 /wd4986 /wd4987 /wd4996 /FI"C:\Program Files (x86)\Windows Kits\8.0\Include\Shared\warning.h" /kernel -cbstring -d2epilogunwind  /d1nodatetime /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\PMI.C
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DEVICE\DEVICE.C
/c /Ix64\Win7Release\ /Zi /nologo /W4 /WX- /sdl- /Ox /Os /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D _WIN64 /D _AMD64_ /D AMD64 /D WIN32_LEAN_AND_MEAN=1 /D _WIN32_WINNT=0x0601 /D WINVER=0x0601 /D WINNT=1 /D NTDDI_VERSION=0x06010000 /GF /Gm- /Zp8 /GS /Gy /fp:precise /Zc:wchar_t- /Zc:forScope- /GR- /Fo"X64\WIN7RELEASE\\" /Fd"X64\WIN7RELEASE\VC110.PDB" /Gz /wd4603 /wd4627 /wd4986 /wd4987 /wd4996 /FI"C:\Program Files (x86)\Windows Kits\8.0\Include\Shared\warning.h" /kernel -cbstring -d2epilogunwind  /d1nodatetime /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\DEVICE\DEVICE.C
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LIST\LIST.C
/c /Ix64\Win7Release\ /Zi /nologo /W4 /WX- /sdl- /Ox /Os /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D _WIN64 /D _AMD64_ /D AMD64 /D WIN32_LEAN_AND_MEAN=1 /D _WIN32_WINNT=0x0601 /D WINVER=0x0601 /D WINNT=1 /D NTDDI_VERSION=0x06010000 /GF /Gm- /Zp8 /GS /Gy /fp:precise /Zc:wchar_t- /Zc:forScope- /GR- /Fo"X64\WIN7RELEASE\\" /Fd"X64\WIN7RELEASE\VC110.PDB" /Gz /wd4603 /wd4627 /wd4986 /wd4987 /wd4996 /FI"C:\Program Files (x86)\Windows Kits\8.0\Include\Shared\warning.h" /kernel -cbstring -d2epilogunwind  /d1nodatetime /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\SRC\LIST\LIST.C

```

`x64/Win7Release/link.command.1.tlog`:

```tlog
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\APIC.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\CHECKS.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\CPUID.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\DEBUG.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\DEVICE.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\IO.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LBR.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LIST.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.RES|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\MAGICCHECK.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\MYCODE.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\PMI.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\SIMPLE-PEBS.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\THREAD.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\WRITEFILE.OBJ
/OUT:"E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.SYS" /VERSION:"6.2" /INCREMENTAL:NO /NOLOGO /WX /FUNCTIONPADMIN:6 /SECTION:"INIT,d" ntoskrnl.lib Hal.lib wdm.lib wdmsec.lib wmilib.lib "C:\Program Files (x86)\Windows Kits\8.0\lib\win7\KM\x64\BufferOverflowK.lib" "C:\Program Files (x86)\Windows Kits\8.0\lib\win7\KM\x64\ntoskrnl.lib" "C:\Program Files (x86)\Windows Kits\8.0\lib\win7\KM\x64\hal.lib" "C:\Program Files (x86)\Windows Kits\8.0\lib\win7\KM\x64\wmilib.lib" ndis.lib MSVCRT.LIB LIBCMT.LIB "C:\Program Files (x86)\Windows Kits\8.0\lib\win7\KM\x64\hotpatch.obj" /NODEFAULTLIB /MANIFEST:NO /DEBUG /PDB:"E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.PDB" /SUBSYSTEM:NATIVE,"6.01" /Driver /OPT:REF /OPT:ICF /ENTRY:"GsDriverEntry" /RELEASE /IMPLIB:"E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.LIB" /MERGE:"_TEXT=.text;_PAGE=PAGE" /MACHINE:X64 /kernel /IGNORE:4198,4010,4037,4039,4065,4070,4078,4087,4089,4221,4108,4088,4218,4218,4235 /osversion:6.2 /pdbcompress /debugtype:pdata X64\WIN7RELEASE\LOOPHPCS.RESX64\WIN7RELEASE\MYCODE.OBJ"X64\WIN7RELEASE\SIMPLE-PEBS.OBJ"X64\WIN7RELEASE\LOOPHPCS.OBJX64\WIN7RELEASE\APIC.OBJX64\WIN7RELEASE\CHECKS.OBJX64\WIN7RELEASE\CPUID.OBJX64\WIN7RELEASE\DEBUG.OBJX64\WIN7RELEASE\DEVICE.OBJX64\WIN7RELEASE\IO.OBJX64\WIN7RELEASE\LBR.OBJX64\WIN7RELEASE\LIST.OBJX64\WIN7RELEASE\MAGICCHECK.OBJX64\WIN7RELEASE\PMI.OBJX64\WIN7RELEASE\THREAD.OBJX64\WIN7RELEASE\WRITEFILE.OBJ

```

`x64/Win7Release/link.read.1.tlog`:

```tlog
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\APIC.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\CHECKS.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\CPUID.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\DEBUG.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\DEVICE.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\IO.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LBR.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LIST.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.RES|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\MAGICCHECK.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\MYCODE.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\PMI.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\SIMPLE-PEBS.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\THREAD.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\WRITEFILE.OBJ
C:\WINDOWS\GLOBALIZATION\SORTING\SORTDEFAULT.NLS
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\LIB\WIN7\KM\X64\NTOSKRNL.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\LIB\WIN7\KM\X64\HAL.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\LIB\WIN7\KM\X64\WDM.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\LIB\WIN7\KM\X64\WDMSEC.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\LIB\WIN7\KM\X64\WMILIB.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\LIB\WIN7\KM\X64\BUFFEROVERFLOWK.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\LIB\WIN7\KM\X64\NDIS.LIB
D:\PROGRAM FILES (X86)\MICROSOFT VISUAL STUDIO 11.0\VC\LIB\AMD64\MSVCRT.LIB
D:\PROGRAM FILES (X86)\MICROSOFT VISUAL STUDIO 11.0\VC\LIB\AMD64\LIBCMT.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\LIB\WIN7\KM\X64\HOTPATCH.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.RES
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\MYCODE.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\SIMPLE-PEBS.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\APIC.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\CHECKS.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\CPUID.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\DEBUG.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\DEVICE.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\IO.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LBR.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LIST.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\MAGICCHECK.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\PMI.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\THREAD.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\WRITEFILE.OBJ
D:\PROGRAM FILES (X86)\MICROSOFT VISUAL STUDIO 11.0\VC\BIN\CVTRES.EXE
C:\WINDOWS\SYSTEM32\TZRES.DLL
C:\WINDOWS\SYSTEM32\RSAENH.DLL

```

`x64/Win7Release/link.write.1.tlog`:

```tlog
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\APIC.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\CHECKS.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\CPUID.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\DEBUG.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\DEVICE.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\IO.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LBR.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LIST.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.RES|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\MAGICCHECK.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\MYCODE.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\PMI.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\SIMPLE-PEBS.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\THREAD.OBJ|E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\WRITEFILE.OBJ
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.SYS
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.PDB

```

`x64/Win7Release/rc.command.1.tlog`:

```tlog
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\LOOPHPCS.RC
/D _WIN64 /D _AMD64_=1 /D AMD64 /D WIN32_LEAN_AND_MEAN=1 /D _WIN32_WINNT=0x0601 /D WINVER=0x0601 /D WINNT=1 /D NTDDI_VERSION=0x06010000 /D "SMP_ID=\\\"{f2f62967-0815-4fd7-9b86-6eedcac766eb}\\\"" /l"0x0409" /I"C:\Program Files (x86)\Windows Kits\8.0\Include\UM" /Ix64\Win7Release\ /nologo /fo"X64\WIN7RELEASE\LOOPHPCS.RES" LOOPHPCS.RC /D _WIN64 /D _AMD64_=1 /D AMD64 /D WIN32_LEAN_AND_MEAN=1 /D _WIN32_WINNT=0x0601 /D WINVER=0x0601 /D WINNT=1 /D NTDDI_VERSION=0x06010000 /D "SMP_ID=\\\"{f2f62967-0815-4fd7-9b86-6eedcac766eb}\\\"" /l"0x0409" /I"C:\Program Files (x86)\Windows Kits\8.0\Include\UM" /Ix64\Win7Release\ /nologo /fo"X64\WIN7RELEASE\LOOPHPCS.RES" E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\LOOPHPCS.RC

```

`x64/Win7Release/rc.read.1.tlog`:

```tlog
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\LOOPHPCS.RC
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\UM\WINDOWS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\UM\WINRESRC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\UM\WINUSER.RH
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\UM\COMMCTRL.RH
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\UM\DDE.RH
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\UM\WINNT.RH
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\UM\DLGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\UM\WINVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\UM\VERRSRC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTVERP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\NTVERP.VER
C:\PROGRAM FILES (X86)\WINDOWS KITS\8.0\INCLUDE\SHARED\COMMON.VER

```

`x64/Win7Release/rc.write.1.tlog`:

```tlog
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\LOOPHPCS.RC
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.RES

```

`x64/Win7Release/signtool.command.1.tlog`:

```tlog
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.SYS
sign /ph /sha1 "5CF3ECF084BFFC5D2F900F4980AA70CE3111AFFA" E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.SYS

```

`x64/Win7Release/signtool.read.1.tlog`:

```tlog
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.SYS
C:\WINDOWS\GLOBALIZATION\SORTING\SORTDEFAULT.NLS
C:\WINDOWS\SYSTEM32\TZRES.DLL
C:\WINDOWS\SYSTEM32\RSAENH.DLL

```

`x64/Win7Release/signtool.write.1.tlog`:

```tlog
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.SYS
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.SYS

```

`x64/Win7Release/stampinf.command.1.tlog`:

```tlog
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.INF
-d "*" -a "amd64" -v "*" -k "1.11" -u "1.11.0" -f x64\Win7Release\LoopHPCs.inf -f -d "*" -a "amd64" -v "*" -k "1.11" -u "1.11.0" E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.INF

```

`x64/Win7Release/stampinf.read.1.tlog`:

```tlog
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.INF
C:\WINDOWS\GLOBALIZATION\SORTING\SORTDEFAULT.NLS

```

`x64/Win7Release/stampinf.write.1.tlog`:

```tlog
^E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.INF
E:\PAPER\HPCS\SRC\FIGSHARE\LOOPHPCS\X64\WIN7RELEASE\LOOPHPCS.INF

```