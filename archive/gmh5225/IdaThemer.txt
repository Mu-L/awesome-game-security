Project Path: arc_gmh5225_IdaThemer_m9keqsmx

Source Tree:

```txt
arc_gmh5225_IdaThemer_m9keqsmx
├── LICENSE
├── README.md
├── build.bat
├── go.mod
├── go.sum
├── main.go
├── rsrc
│   ├── blank.png
│   ├── chevron-down.png
│   ├── chevron-down.svg
│   ├── chevron-right.svg
│   ├── chrome-maximize.png
│   ├── chrome-maximize.svg
│   ├── chrome-minimize.png
│   ├── chrome-minimize.svg
│   ├── close-hover.png
│   ├── close-hover.svg
│   ├── close.png
│   ├── close.svg
│   ├── kebab-vertical.png
│   ├── kebab-vertical.svg
│   ├── preview.png
│   ├── theme.css
│   ├── theme.json
│   ├── triangle-right.png
│   └── triangle-right.svg
└── theme
    ├── map.go
    └── parser.go

```

`LICENSE`:

```
MIT License

Copyright (c) 2024 Can Bölük

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

```

`README.md`:

```md
# IdaThemer

IdaThemer is a tool for converting Visual Studio Code (VsCode) themes into compatible themes for IDA Pro. This utility leverages a modified version of the [Long Night](https://github.com/ioncodes/long_night) project with Celestial as a basetheme and then remaps the colors defined in the VsCode theme JSON file to create a visually appealing and functional theme for IDA Pro.

Although light themes are supported, the primary focus of this project is to provide a dark theme for IDA Pro. As such, light themes may not be as polished as dark themes.

## Getting Started

### Prerequisites

- Go (1.21 or later) if building from source
- A Visual Studio Code theme

### Usage

1. Build from source (or download the latest release):

   ```bash
   git clone https://github.com/can1357/IdaThemer.git
   cd IdaThemer
   go build
   ```

2. Locate your VsCode theme JSON file.
3. Run IdaThemer with the path to your VsCode theme JSON and the output directory:
   ```bash
   ./IdaThemer "gruvbox.json" "S:\IDA Pro\themes\gruvbox"
   ```
4. Voila! Your theme is now ready to use in IDA Pro.

## License

Distributed under the MIT License. See `LICENSE` for more information.

## Acknowledgments

- [Ioncodes' Long Night](https://github.com/ioncodes/long_night)
- [Celestial](https://github.com/apvarun/celestial-theme)

```

`build.bat`:

```bat
set GOOS=windows
set GOARCH=amd64
go build -o build/idathemer-windows-amd64.exe
set GOOS=linux
set GOARCH=amd64
go build -o build/idathemer-linux-amd64
set GOOS=darwin
set GOARCH=amd64
go build -o build/idathemer-darwin-amd64
set GOOS=linux
set GOARCH=arm64
go build -o build/idathemer-linux-arm64
```

`go.mod`:

```mod
module github.com/can1357/IdaThemer

go 1.21

require github.com/tidwall/jsonc v0.3.2

```

`go.sum`:

```sum
github.com/tidwall/jsonc v0.3.2 h1:ZTKrmejRlAJYdn0kcaFqRAKlxxFIC21pYq8vLa4p2Wc=
github.com/tidwall/jsonc v0.3.2/go.mod h1:dw+3CIxqHi+t8eFSpzzMlcVYxKp08UP5CD8/uSFCyJE=

```

`main.go`:

```go
package main

import (
	"embed"
	"fmt"
	"os"
	"strings"

	"github.com/can1357/IdaThemer/theme"
)

//go:embed rsrc/*.svg rsrc/*.png
var resources embed.FS

//go:embed rsrc/theme.css
var themeCSS string

//go:embed rsrc/theme.json
var themeJSON []byte

func main() {
	// Parse arguments [theme.json] [output dir]
	if len(os.Args) != 3 {
		fmt.Printf("Not enough arguments")
		fmt.Printf("Usage: %s [theme.json] [output dir]\n", os.Args[0])
		os.Exit(1)
	}
	targetTheme := os.Args[1]
	outputDir := os.Args[2]

	// Parse the source theme
	src, err := theme.Parse(themeJSON)
	if err != nil {
		panic(err)
	}

	// Parse the target theme
	dst, err := theme.ReadFile(targetTheme)
	if err != nil {
		panic(err)
	}

	// Remap the colors
	newCSS := src.RemapCSS(themeCSS, dst)
	if dst.Data.Type == "light" {
		newCSS = strings.ReplaceAll(newCSS, `@importtheme "dark";`, "")
	}

	// Create the output directory
	err = os.MkdirAll(outputDir, 0755)
	if err != nil {
		panic(err)
	}

	// Copy all files from resources to output directory
	files, err := resources.ReadDir("rsrc")
	if err != nil {
		panic(err)
	}
	for _, file := range files {
		data, err := resources.ReadFile("rsrc/" + file.Name())
		if err != nil {
			panic(err)
		}
		err = os.WriteFile(outputDir+"/"+file.Name(), data, 0644)
		if err != nil {
			panic(err)
		}
	}

	// Write the new theme.css
	err = os.WriteFile(outputDir+"/theme.css", []byte(newCSS), 0644)
	if err != nil {
		panic(err)
	}
}

```

`rsrc/chevron-down.svg`:

```svg
<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M7.97603 10.0719L12.3333 5.7146L12.9521 6.33332L8.28539 11L7.66667 11L3 6.33332L3.61872 5.7146L7.97603 10.0719Z" fill="#F1EFEC"/>
</svg>

```

`rsrc/chevron-right.svg`:

```svg
<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M5.7 13.7L5 13L9.6 8.4L5 3.7L5.7 3L10.7 8V8.7L5.7 13.7Z" fill="#F1EFEC"/>
</svg>

```

`rsrc/chrome-maximize.svg`:

```svg
<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M3 3V13H13V3H3ZM12 12H4V4H12V12Z" fill="#F1EFEC"/>
</svg>

```

`rsrc/chrome-minimize.svg`:

```svg
<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M14 7.99994V8.99994H3V7.99994H14Z" fill="#F1EFEC"/>
</svg>

```

`rsrc/close-hover.svg`:

```svg
<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M8.00001 8.70711L11.6465 12.3536L12.3536 11.6465L8.70711 8.00001L12.3536 4.35356L11.6465 3.64645L8.00001 7.2929L4.35356 3.64645L3.64645 4.35356L7.2929 8.00001L3.64645 11.6465L4.35356 12.3536L8.00001 8.70711Z" fill="#FF5370"/>
</svg>

```

`rsrc/close.svg`:

```svg
<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M8.00001 8.70711L11.6465 12.3536L12.3536 11.6465L8.70711 8.00001L12.3536 4.35356L11.6465 3.64645L8.00001 7.2929L4.35356 3.64645L3.64645 4.35356L7.2929 8.00001L3.64645 11.6465L4.35356 12.3536L8.00001 8.70711Z" fill="#F1EFEC"/>
</svg>

```

`rsrc/kebab-vertical.svg`:

```svg
<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M7.44443 13.8315C7.60888 13.9414 7.80222 14 8 14C8.26521 14 8.51957 13.8946 8.7071 13.7071C8.89464 13.5196 9 13.2652 9 13C9 12.8022 8.94135 12.6089 8.83147 12.4444C8.72158 12.28 8.56541 12.1518 8.38268 12.0761C8.19995 12.0004 7.99889 11.9806 7.80491 12.0192C7.61093 12.0578 7.43274 12.153 7.29289 12.2929C7.15304 12.4327 7.0578 12.6109 7.01921 12.8049C6.98063 12.9989 7.00043 13.2 7.07612 13.3827C7.1518 13.5654 7.27998 13.7216 7.44443 13.8315ZM8 9C7.80221 9 7.60887 8.94135 7.44443 8.83147C7.27998 8.72159 7.1518 8.56541 7.07612 8.38268C7.00043 8.19996 6.98063 7.99889 7.01921 7.80491C7.0578 7.61093 7.15304 7.43275 7.29289 7.29289C7.43274 7.15304 7.61093 7.0578 7.80491 7.01921C7.99889 6.98063 8.19995 7.00043 8.38268 7.07612C8.56541 7.15181 8.72158 7.27998 8.83147 7.44443C8.94135 7.60888 9 7.80222 9 8C9 8.26522 8.89464 8.51957 8.7071 8.70711C8.51957 8.89464 8.26521 9 8 9ZM8 4C7.80222 4 7.60888 3.94135 7.44443 3.83147C7.27998 3.72159 7.15181 3.56541 7.07612 3.38268C7.00043 3.19996 6.98063 2.99889 7.01922 2.80491C7.0578 2.61093 7.15304 2.43274 7.29289 2.29289C7.43275 2.15304 7.61093 2.0578 7.80491 2.01921C7.99889 1.98063 8.19996 2.00043 8.38268 2.07612C8.56541 2.15181 8.72159 2.27998 8.83147 2.44443C8.94135 2.60888 9 2.80222 9 3C9 3.26522 8.89464 3.51957 8.70711 3.70711C8.51957 3.89464 8.26522 4 8 4Z" fill="#F1EFEC"/>
</svg>

```

`rsrc/theme.css`:

```css
/* NOTE: This is an autogenerated file; please do not edit. */

/* TODO Remove white line between assembly and tabs */
/* TODO Dock lines reappear when undocked and then docked. Do they look bad tho? */
/* TODO Comment window has no borders around input field */

@importtheme "dark";

QWidget
{
    border: 0px solid #434343;
    background-color: #0e0f13;
    color: #F1EFEC;
}
DockWidgetTitle[active="true"]
{
    background-color: #0e0f1321;
}

DockAreaDragTitle
{
    background-color: #0e0f1321;
}


QCheckBox::indicator:unchecked
{
    background-color: #0e0f13;
    border: 1px solid #373737;
    border-radius: 2px;
}

QRadioButton::indicator:unchecked
{
    background-color: #0e0f13;
    border: 1px solid #373737;
    border-radius: 4px;
}

QCheckBox::indicator:checked
{
    background-color: #F78C6C;
    border: 2px solid #F78C6C;
    border-radius: 4px;
}

QRadioButton::indicator:checked
{
    background-color: #9FD2D3;
    border: 2px solid #9FD2D3;
    border-radius: 4px;
}

QTextEdit,
QPlainTextEdit
{
    background-color: #0e0f13;
    border: 1px solid #373737;
    border-radius: 2px;
}

QMenu
{
    border: none;
}

QMenu:icon
{
    padding-left: 20px;
}

QMenu:right-arrow
{
    image: url("$RELPATH/triangle-right.png");
}

QMenuBar,
QMenuBar::item
{
    background-color: #0e0f1321;
    color: #F1EFEC;
}

QMenu::item
{
    background-color: #0e0f1321;
    color: #F1EFEC;
}

QMenu::item:selected
{
    background-color: #434343;
}

QMenuBar::item:hover
{
    background-color: #43434343;
    color: #F1EFEC;
}

QMenu::item:hover
{
    background-color: #43434343;
    color: #F1EFEC;
}

QMenu::item:disabled
{
    color: #666;
}

QMenu::separator
{
    height: 1px;
    background: transparent;
    margin-left: 10px;
    margin-right: 10px;
    margin-top: 5px;
    margin-bottom: 5px;
}

QLineEdit
{
    border: 1px solid #373737;
    min-height: 20px;
    border-radius: 2px;
}

QLineEdit:hover,
QLineEdit:focus
{
    border: 1px solid #FF5370;
}

QTableView
{
    border: none;
    background-color: #0e0f13;
}

QListView::item:hover,
QListView::item:default
{
    color: #F1EFEC;
    background-color: #434343;
}

QHeaderView::section
{
    background-color: #0e0f13;
    border: none;
    padding: 0 10px;
    border-bottom: 1px solid #191919;
}

QHeaderView:horizontal::section
{
    min-height: 20px;
}

QHeaderView:vertical::section
{
}

QTableCornerButton::section
{
    border: none;
}

CustomIDAMemo,
EditContainer
{
    background-color: #0e0f13;
    border: 1px solid #373737;
    border-radius: 2px;
}

IDAView
{
    background-color: #0e0f13;
}

hexview_t
{
    background-color: #0e0f13;
}

QScrollBar
{
    background-color: #0e0f13;
    width: 15px;
    height: 15px;
    margin: 0 0 0 0;
}

QScrollBar::sub-line,
QScrollBar::add-line
{
    width: 0;
    height: 0;
}

QScrollBar::add-page,
QScrollBar::sub-page
{
    background: none;
}

QScrollBar::handle:vertical
{
    min-height: 15px;
}

QScrollBar::handle:horizontal
{
    min-width: 15px;
}

QScrollBar::handle
{
    background-color: #FF5370;
    margin: 3px;
    border-radius: 2px;
}

QToolBar
{
    border: none;
}

QToolBar::handle:horizontal
{
    image: url("$RELPATH/kebab-vertical.png");
}

/*
QToolBar::handle:vertical
{
    image: url("$RELPATH/kebab-vertical.png");
}
*/

QToolBar::separator:horizontal
{
    image: url("$RELPATH/kebab-vertical.png");
}

/*
QToolBar::separator:vertical
{
    image: url("$RELPATH/kebab-vertical.png");
}
*/

QPushButton
{
    background-color: transparent;
    color: #F1EFEC;
    border: 1px solid #373737;
    text-align: center;
    min-height: 20px;
    min-width: 50px;
    padding: 0 6px 0 6px;
    border-radius: 2px;
}

QPushButton:hover,
QPushButton:pressed
{
    background-color: #373737;
}

TNavBand > QPushButton,
nav_scroll_button_t,
RegJumpButton
{
    min-height: 0;
    min-width: 0;
    padding: 0;
    border: none;
}

DockWidgetTitle
{
    color: #F1EFEC;
    background: transparent;
    min-height: 0px;
    height: 25px;
    padding: 0px 10px 0px 10px;
    border: none;
}

DockWidgetTitle QPushButton
{   
    color: #F1EFEC;
    background: transparent;
    border: none;
    min-height: 0;
    min-width: 0;
    margin: 0;
    padding: 0;
}

DockWidgetTitle QPushButton[toolTip="Close"]
{
    qproperty-icon: url("$RELPATH/close.png");
    icon-size: 16px;
}

DockWidgetTitle QPushButton[toolTip="Fullscreen"]
{
    qproperty-icon: url("$RELPATH/chrome-maximize.png");
    icon-size: 16px;
}

DockWidgetTitle QPushButton[toolTip="Float"]
{
    qproperty-icon: url("$RELPATH/chrome-minimize.png");
    icon-size: 16px;
}

IDADockWidget[objectName="Output window"]
{
    qproperty-windowIcon: url("$RELPATH/blank.png");
}

IDADockWidget[objectName="Output window"] DockWidgetTitle
{
    background: #0e0f13;
    color: #F1EFEC;
    margin: 0;
}

IDADockWidget[objectName="Output window"] QTextEdit:focus
{
    border: 1px solid #F07178;
}

IDADockWidget[objectName="Output window"] QLineEdit
{
    padding-bottom: 2px;
}

IDADockWidget[objectName="Output window"] QGroupBox
{
    margin: 0;
    padding: 0;
    border: none;
}

IDADockWidget[objectName="Output window"] QGroupBox QPushButton
{
    border: none;
    min-width: 70px;
}

IDADockWidget[objectName="Output window"] QGroupBox QPushButton:hover
{
    border: none;
}

IDADockWidget[objectName="Output window"] QGroupBox QPushButton:focus
{
    border: none;
}

QComboBox
{
    color: #F1EFEC;
    padding: 1px 0px 1px 3px;
    border: 1px solid #434343;
    border-radius: 2px;
}

QComboBox > QLineEdit,
QComboBox > QLineEdit:hover,
QComboBox > QLineEdit:focus
{
    border: none;
    min-height: default;
}

QComboBox::drop-down
{
    subcontrol-origin: padding;
    subcontrol-position: top right;
    width: 15px;

    background-color: #373737;
    
    border-left-width: 1px;
    border-left-color: #373737;
    border-left-style: solid;
}

QComboBox QAbstractItemView
{
    border: 1px solid #373737;
    selection-background-color: #434343;
}

QComboBox:!editable
{
    background-color: #373737;
}

QComboBox::down-arrow
{
    image: url("$RELPATH/chevron-down.png");
}

IDADockWidget > QWidget > QAbstractButton
{
    background-color: #0e0f13;
    border-radius: 3px;
}

IDADockWidget
{
    border: none;
}

QCheckBox,
QLabel,
QRadioButton
{
    background: transparent;
    color: #F1EFEC;
}

QStatusBar QLabel
{
    border: none;
}

QStatusBar::item
{
    color: #434343;
    background-color: #0e0f13;
}

EditContainer,
ChooserContainer,
QGroupBox,
QListView,
QTreeView
{
    background-color: #0e0f13;
    color: #F1EFEC;
    border: 1px solid #373737;
    outline: 0;
    border-radius: 2px;
}

QGroupBox
{
    border: 1px solid #373737;
    margin-top: 5px;
}

QGroupBox::title
{
    subcontrol-origin: margin;
    subcontrol-position: top center;
}

CLIWidget > QGroupBox > QPushButton,
CLIWidget > QGroupBox > QPushButton:hover,
CLIWidget > QGroupBox > QPushButton:focus
{
    border: none;
}

CLIWidget > QGroupBox
{
    margin-top: 0;
}

QTreeView::item:selected,
QListView::item:selected,
QTableView::item:selected
{
    color: #F1EFEC;
    background-color: #434343;
    outline: 0;
}

QToolTip,
QTipLabel
{
    border: none;
    background: #0e0f13;
    color: #F1EFEC;
    margin: 0;
    padding: 0;
}

QTabBar
{
    background: #0e0f13;
}

QTabWidget::pane
{
    background: transparent;
}

QTabBar::tab
{
    padding: 8px 10px;
    background: #0e0f13;
    color: #F1EFEC;
}

QTabBar::tab:hover
{
    background-color: #0e0f13;
    border-top: 1px solid #FF5370;
    color: #F1EFEC;
}

QTabBar::tab:selected
{
    background-color: #0e0f13;
    border-top: 1px solid #F07178;
    color: #F1EFEC;
}

QTabBar::close-button
{
    image: url("$RELPATH/close.png"); 
}

QTabBar::close-button:hover
{
    image: url("$RELPATH/close-hover.png");
}

QSpinBox
{
    background: transparent;
    border: 1px solid transparent;
    color: #F1EFEC;
}

QAbstractScrollArea
{
    border: 0;
}

QDialogButtonBox 
{
    button-layout: 0;
}

CustomIDAMemo
{
    qproperty-line-fg-default: #7F7E74;
    qproperty-line-fg-regular-comment: #7F7E74;
    qproperty-line-fg-repeatable-comment: #7F7E74;
    qproperty-line-fg-automatic-comment: #7F7E74;
    qproperty-line-fg-insn: #DF9291;
    qproperty-line-fg-dummy-data-name: #D1B8D4;
    qproperty-line-fg-regular-data-name: #AAA99F;
    qproperty-line-fg-demangled-name: #F0D7A4;
    qproperty-line-fg-punctuation: #D0CFC8;
    qproperty-line-fg-charlit-in-insn: #B5D1B0;
    qproperty-line-fg-numlit-in-insn: #F78C6C;
    qproperty-line-fg-void-opnd: #B59180;
    qproperty-line-fg-code-xref: #F0D7A4;
    qproperty-line-fg-data-xref: #F0D7A4;
    qproperty-line-fg-code-xref-to-tail: #F0D7A4;
    qproperty-line-fg-data-xref-to-tail: #F0D7A4;
    qproperty-line-fg-error: #B59180;
    qproperty-line-fg-opcode-byte: #F0D7A4;
    qproperty-line-fg-extra-line: #7F7E74;
    qproperty-line-fg-alt-opnd: #F78C6C;
    qproperty-line-fg-hidden: #D1B8D4;
    qproperty-line-fg-libfunc: #93AFCF;
    qproperty-line-fg-locvar: #DF9291;
    qproperty-line-fg-dummy-code-name: #F07178;
    qproperty-line-fg-asm-directive: #F07178;
    qproperty-line-fg-macro: #F07178;
    qproperty-line-fg-strlit-in-data: #B5D1B0;
    qproperty-line-fg-charlit-in-data: #B5D1B0;
    qproperty-line-fg-numlit-in-data: #E9B08E;
    qproperty-line-fg-keyword: #F07178;
    qproperty-line-fg-register-name: #D1B8D4;
    qproperty-line-fg-import-name: #93AFCF;
    qproperty-line-fg-segment-name: #D1B8D4;
    qproperty-line-fg-dummy-unknown-name: #D1B8D4;
    qproperty-line-fg-code-name: #AAA99F;
    qproperty-line-fg-unknown-name: #AAA99F;
    qproperty-line-fg-collapsed-line: #7F7E74;
    qproperty-line-bg-default: #0e0f13;
    qproperty-line-bg-selected: #353535;
    qproperty-line-pfx-libfunc: #4A4A4A;
    qproperty-line-pfx-func: #4A4A4A;
    qproperty-line-pfx-insn: #4A4A4A;
    qproperty-line-pfx-data: #4A4A4A;
    qproperty-line-pfx-unexplored: #4A4A4A;
    qproperty-line-pfx-extern: #4A4A4A;
    qproperty-line-pfx-current-line: #434343;
    qproperty-line-pfx-current-item: #434343;
    qproperty-line-pfx-lumina: #4A4A4A;
    qproperty-graph-bg-top: #434343;
    qproperty-graph-bg-bottom: #434343;
    qproperty-graph-node-title-normal: #353535;
    qproperty-graph-node-title-selected: #F78C6C;
    qproperty-graph-node-title-current: #B59180;
    qproperty-graph-edge-normal: #93AFCF;
    qproperty-graph-edge-yes: #B5D1B0;
    qproperty-graph-edge-no: #F07178;
    qproperty-graph-edge-current: #FF5370;
    qproperty-line-bg-highlight: #353535;
}

CustomIDAMemo[debugging="true"]
{
    qproperty-line-fg-default: #7F7E74;
    qproperty-line-fg-regular-comment: #7F7E74;
    qproperty-line-fg-repeatable-comment: #7F7E74;
    qproperty-line-fg-automatic-comment: #7F7E74;
    qproperty-line-fg-insn: #DF9291;
    qproperty-line-fg-dummy-data-name: #D1B8D4;
    qproperty-line-fg-regular-data-name: #AAA99F;
    qproperty-line-fg-demangled-name: #F0D7A4;
    qproperty-line-fg-punctuation: #D0CFC8;
    qproperty-line-fg-charlit-in-insn: #B5D1B0;
    qproperty-line-fg-numlit-in-insn: #F78C6C;
    qproperty-line-fg-void-opnd: #B59180;
    qproperty-line-fg-code-xref: #F0D7A4;
    qproperty-line-fg-data-xref: #F0D7A4;
    qproperty-line-fg-code-xref-to-tail: #F0D7A4;
    qproperty-line-fg-data-xref-to-tail: #F0D7A4;
    qproperty-line-fg-error: #B59180;
    qproperty-line-fg-opcode-byte: #F0D7A4;
    qproperty-line-fg-extra-line: #7F7E74;
    qproperty-line-fg-alt-opnd: #F78C6C;
    qproperty-line-fg-hidden: #D1B8D4;
    qproperty-line-fg-libfunc: #93AFCF;
    qproperty-line-fg-locvar: #DF9291;
    qproperty-line-fg-dummy-code-name: #F07178;
    qproperty-line-fg-asm-directive: #F07178;
    qproperty-line-fg-macro: #F07178;
    qproperty-line-fg-strlit-in-data: #B5D1B0;
    qproperty-line-fg-charlit-in-data: #B5D1B0;
    qproperty-line-fg-numlit-in-data: #E9B08E;
    qproperty-line-fg-keyword: #F07178;
    qproperty-line-fg-register-name: #D1B8D4;
    qproperty-line-fg-import-name: #93AFCF;
    qproperty-line-fg-segment-name: #D1B8D4;
    qproperty-line-fg-dummy-unknown-name: #D1B8D4;
    qproperty-line-fg-code-name: #AAA99F;
    qproperty-line-fg-unknown-name: #AAA99F;
    qproperty-line-fg-collapsed-line: #7F7E74;
    qproperty-line-bg-default: #0e0f13;
    qproperty-line-bg-selected: #353535;
    qproperty-line-pfx-libfunc: #4A4A4A;
    qproperty-line-pfx-func: #4A4A4A;
    qproperty-line-pfx-insn: #4A4A4A;
    qproperty-line-pfx-data: #4A4A4A;
    qproperty-line-pfx-unexplored: #4A4A4A;
    qproperty-line-pfx-extern: #4A4A4A;
    qproperty-line-pfx-current-line: #434343;
    qproperty-line-pfx-current-item: #434343;
    qproperty-line-pfx-lumina: #4A4A4A;
    qproperty-graph-bg-top: #434343;
    qproperty-graph-bg-bottom: #434343;
    qproperty-graph-node-title-normal: #353535;
    qproperty-graph-node-title-selected: #F78C6C;
    qproperty-graph-node-title-current: #B59180;
    qproperty-graph-edge-normal: #93AFCF;
    qproperty-graph-edge-yes: #B5D1B0;
    qproperty-graph-edge-no: #F07178;
    qproperty-graph-edge-current: #FF5370;
    qproperty-line-bg-highlight: #353535;
}

CustomIDAMemo[hints="true"]
{
    qproperty-line-fg-default: #7F7E74;
    qproperty-line-fg-regular-comment: #7F7E74;
    qproperty-line-fg-repeatable-comment: #7F7E74;
    qproperty-line-fg-automatic-comment: #7F7E74;
    qproperty-line-fg-insn: #DF9291;
    qproperty-line-fg-dummy-data-name: #D1B8D4;
    qproperty-line-fg-regular-data-name: #AAA99F;
    qproperty-line-fg-demangled-name: #F0D7A4;
    qproperty-line-fg-punctuation: #D0CFC8;
    qproperty-line-fg-charlit-in-insn: #B5D1B0;
    qproperty-line-fg-numlit-in-insn: #F78C6C;
    qproperty-line-fg-void-opnd: #B59180;
    qproperty-line-fg-code-xref: #F0D7A4;
    qproperty-line-fg-data-xref: #F0D7A4;
    qproperty-line-fg-code-xref-to-tail: #F0D7A4;
    qproperty-line-fg-data-xref-to-tail: #F0D7A4;
    qproperty-line-fg-error: #B59180;
    qproperty-line-fg-opcode-byte: #F0D7A4;
    qproperty-line-fg-extra-line: #7F7E74;
    qproperty-line-fg-alt-opnd: #F78C6C;
    qproperty-line-fg-hidden: #D1B8D4;
    qproperty-line-fg-libfunc: #93AFCF;
    qproperty-line-fg-locvar: #DF9291;
    qproperty-line-fg-dummy-code-name: #F07178;
    qproperty-line-fg-asm-directive: #F07178;
    qproperty-line-fg-macro: #F07178;
    qproperty-line-fg-strlit-in-data: #B5D1B0;
    qproperty-line-fg-charlit-in-data: #B5D1B0;
    qproperty-line-fg-numlit-in-data: #E9B08E;
    qproperty-line-fg-keyword: #F07178;
    qproperty-line-fg-register-name: #D1B8D4;
    qproperty-line-fg-import-name: #93AFCF;
    qproperty-line-fg-segment-name: #D1B8D4;
    qproperty-line-fg-dummy-unknown-name: #D1B8D4;
    qproperty-line-fg-code-name: #AAA99F;
    qproperty-line-fg-unknown-name: #AAA99F;
    qproperty-line-fg-collapsed-line: #7F7E74;
    qproperty-line-bg-default: #0e0f13;
    qproperty-line-bg-selected: #353535;
    qproperty-line-pfx-libfunc: #4A4A4A;
    qproperty-line-pfx-func: #4A4A4A;
    qproperty-line-pfx-insn: #4A4A4A;
    qproperty-line-pfx-data: #4A4A4A;
    qproperty-line-pfx-unexplored: #4A4A4A;
    qproperty-line-pfx-extern: #4A4A4A;
    qproperty-line-pfx-current-line: #434343;
    qproperty-line-pfx-current-item: #434343;
    qproperty-line-pfx-lumina: #4A4A4A;
    qproperty-graph-bg-top: #434343;
    qproperty-graph-bg-bottom: #434343;
    qproperty-graph-node-title-normal: #353535;
    qproperty-graph-node-title-selected: #F78C6C;
    qproperty-graph-node-title-current: #B59180;
    qproperty-graph-edge-normal: #93AFCF;
    qproperty-graph-edge-yes: #B5D1B0;
    qproperty-graph-edge-no: #F07178;
    qproperty-graph-edge-current: #FF5370;
    qproperty-line-bg-highlight: #353535;
}

MainMsgList
{
    color: #F07178;
    background-color: #0e0f13;
}

TCpuRegs
{
    background-color: #4D4D4D;
    qproperty-register-defined: white;
    qproperty-register-changed: #FFFF7F;
    qproperty-register-edited: #FF7F17;
    qproperty-register-unavailable: #808080;
}

TCpuRegs IDALabel
{
    color: #AAAAAA;
}

TextArrows
{
    qproperty-jump-in-function: #AAA99F;
    qproperty-jump-external-to-function: #F07178;
    qproperty-jump-under-cursor: #93AFCF;
}

navband_t
{
    qproperty-lib-function: #93AFCF;
    qproperty-function: #DF9291;
    qproperty-code: #F07178;
    qproperty-data: #F0D7A4;
    qproperty-undefined: #D1B8D4;
    qproperty-extern: #89DDFF;
    qproperty-error: #FF5370;
    qproperty-gap: #434343;
    qproperty-cursor: #B59180;
    qproperty-auto-analysis-cursor: #F78C6C;
    qproperty-lumina-function: #B5D1B0;
}

TextEdit
{
    qproperty-keyword1-fg: #7171FF;
    qproperty-keyword2-fg: #C728C7;
    qproperty-keyword3-fg: #FF4545;
    qproperty-string-fg: #E47251;
    qproperty-comment-fg: #5AC35A;
    qproperty-preprocessor-fg: #7171FF;
}

TextEdit QWidget
{
    background-color: transparent;
}

TextEdit text_edit_margin_widget_t
{
    color: lightgrey;
    qproperty-header-color: gainsboro;
}

TChooser
{
    qproperty-highlight-bg-default: red;
    qproperty-highlight-bg-selected: pink;
}

```

`rsrc/theme.json`:

```json
{
	"name": "Celestial",
	"type": "dark",
	"colors": {
		"focusBorder": "#22252e",
		"foreground": "#D5D8DA",
		"widget.shadow": "#16161C",
		"selection.background": "#6C6F9380",
		"errorForeground": "#F43E5C",
		"textLink.activeForeground": "#E9436D",
		"textLink.foreground": "#E95378",
		"button.background": "#2E303E",
		"dropdown.background": "#1b1c25",
		"dropdown.listBackground": "#2E303E",
		"input.background": "#2E303E",
		"inputOption.activeBorder": "#E9436D80",
		"inputValidation.errorBackground": "#F43E5C80",
		"inputValidation.errorBorder": "#F43E5C00",
		"scrollbar.shadow": "#16161C",
		"scrollbarSlider.activeBackground": "#6C6F9380",
		"scrollbarSlider.background": "#6C6F931A",
		"scrollbarSlider.hoverBackground": "#6C6F934D",
		"badge.foreground": "#D5D8DA",
		"badge.background": "#2E303E",
		"progressBar.background": "#E95378",
		"list.activeSelectionBackground": "#2E303E80",
		"list.activeSelectionForeground": "#D5D8DA",
		"list.dropBackground": "#6C6F9380",
		"list.focusBackground": "#2E303E80",
		"list.focusForeground": "#D5D8DA",
		"list.highlightForeground": "#E95378",
		"list.hoverBackground": "#2E303E80",
		"list.hoverForeground": "#D5D8DA",
		"list.inactiveSelectionBackground": "#2E303E4D",
		"list.inactiveSelectionForeground": "#D5D8DA",
		"list.inactiveFocusBackground": "#2E303E80",
		"list.errorForeground": "#F43E5CE6",
		"list.warningForeground": "#27D797B3",
		"activityBar.background": "#0E0F13",
		"activityBar.dropBackground": "#6C6F9380",
		"activityBar.foreground": "#D5D8DAB3",
		"activityBarBadge.background": "#E95378",
		"activityBarBadge.foreground": "#06060C",
		"sideBar.background": "#0E0F13",
		"sideBar.foreground": "#D5D8DA80",
		"sideBar.dropBackground": "#6C6F934D",
		"sideBarSectionHeader.background": "#0E0F13",
		"sideBarSectionHeader.foreground": "#D5D8DAB3",
		"editorGroup.border": "#22252e",
		"editorGroup.dropBackground": "#6C6F934D",
		"editorGroupHeader.tabsBackground": "#0b0c0f",
		"tab.border": "#1C1E2600",
		"tab.activeBorder": "#E95378",
		"tab.inactiveBackground": "#0b0c0f",
		"editor.background": "#0b0c0f",
		"editorLineNumber.foreground": "#D5D8DA1A",
		"editorLineNumber.activeForeground": "#D5D8DA80",
		"editorCursor.background": "#0b0c0f",
		"editorCursor.foreground": "#E95378",
		"editor.selectionBackground": "#2E303EB3",
		"editor.selectionHighlightBackground": "#6C6F934D",
		"editor.wordHighlightBackground": "#6C6F9380",
		"editor.wordHighlightStrongBackground": "#6C6F9380",
		"editor.findMatchBackground": "#6C6F9380",
		"editor.findMatchHighlightBackground": "#6C6F934D",
		"editor.findRangeHighlightBackground": "#6C6F931A",
		"editor.hoverHighlightBackground": "#6C6F934D",
		"editor.lineHighlightBackground": "#2E303E4D",
		"editor.rangeHighlightBackground": "#2E303E80",
		"editorIndentGuide.background": "#2E303E80",
		"editorIndentGuide.activeBackground": "#2E303E",
		"editorRuler.foreground": "#6C6F934D",
		"editorCodeLens.foreground": "#6C6F9380",
		"editorBracketMatch.background": "#6C6F9380",
		"editorBracketMatch.border": "#6C6F9300",
		"editorOverviewRuler.border": "#2E303EB3",
		"editorOverviewRuler.findMatchForeground": "#6C6F93",
		"editorOverviewRuler.modifiedForeground": "#21BFC280",
		"editorOverviewRuler.addedForeground": "#09F7A080",
		"editorOverviewRuler.deletedForeground": "#F43E5C80",
		"editorOverviewRuler.errorForeground": "#F43E5CE6",
		"editorOverviewRuler.warningForeground": "#27D79780",
		"editorOverviewRuler.bracketMatchForeground": "#D5D8DA80",
		"editorError.foreground": "#F43E5C",
		"editorWarning.foreground": "#27D797B3",
		"editorGutter.modifiedBackground": "#21BFC2B3",
		"editorGutter.addedBackground": "#09F7A0B3",
		"editorGutter.deletedBackground": "#F43E5CB3",
		"diffEditor.insertedTextBackground": "#09F7A01A",
		"diffEditor.removedTextBackground": "#F43E5C1A",
		"editorWidget.background": "#1b1c25",
		"editorWidget.border": "#1b1c25",
		"editorSuggestWidget.highlightForeground": "#E95378",
		"notifications.background": "#14151B",
		"peekView.border": "#1A1C23",
		"peekViewEditor.background": "#1b1c25",
		"peekViewEditor.matchHighlightBackground": "#6C6F9380",
		"peekViewResult.background": "#1b1c25",
		"peekViewResult.matchHighlightBackground": "#6C6F9380",
		"peekViewResult.selectionBackground": "#2E303E80",
		"peekViewTitle.background": "#1b1c25",
		"panelTitle.activeBorder": "#E95378",
		"statusBar.background": "#0b0c0f",
		"statusBar.foreground": "#D5D8DA80",
		"statusBar.debuggingBackground": "#E07267",
		"statusBar.debuggingForeground": "#06060C",
		"statusBar.noFolderBackground": "#0b0c0f",
		"statusBarItem.hoverBackground": "#2E303E",
		"statusBarItem.prominentBackground": "#2E303E",
		"statusBarItem.prominentHoverBackground": "#6C6F93",
		"titleBar.activeBackground": "#0b0c0f",
		"titleBar.inactiveBackground": "#0b0c0f",
		"extensionButton.prominentBackground": "#E95378",
		"extensionButton.prominentHoverBackground": "#E9436D",
		"pickerGroup.foreground": "#E95378E6",
		"terminal.foreground": "#D5D8DA",
		"terminal.ansiBlue": "#26BBD9",
		"terminal.ansiBrightBlue": "#3FC4DE",
		"terminal.ansiBrightCyan": "#6BE4E6",
		"terminal.ansiBrightGreen": "#3FDAA4",
		"terminal.ansiBrightMagenta": "#F075B5",
		"terminal.ansiBrightRed": "#EC6A88",
		"terminal.ansiBrightYellow": "#FBC3A7",
		"terminal.ansiCyan": "#59E1E3",
		"terminal.ansiGreen": "#29D398",
		"terminal.ansiMagenta": "#EE64AC",
		"terminal.ansiRed": "#E95678",
		"terminal.ansiYellow": "#FAB795",
		"terminal.selectionBackground": "#6C6F934D",
		"terminalCursor.background": "#D5D8DA",
		"terminalCursor.foreground": "#6C6F9380",
		"debugToolBar.background": "#0b0c0f",
		"walkThrough.embeddedEditorBackground": "#1b1c25",
		"gitDecoration.addedResourceForeground": "#27D797B3",
		"gitDecoration.modifiedResourceForeground": "#E07267",
		"gitDecoration.deletedResourceForeground": "#F43E5C",
		"gitDecoration.untrackedResourceForeground": "#27D797",
		"gitDecoration.ignoredResourceForeground": "#D5D8DA4D",
		"breadcrumbPicker.background": "#232530"
	},
	"tokenColors": [
		{
			"name": "Comments",
			"scope": "comment",
			"settings": {
				"foreground": "#BBBBBB4D",
				"fontStyle": "italic"
			}
		},
		{
			"name": "Constants",
			"scope": "constant",
			"settings": {
				"foreground": "#F09483E6"
			}
		},
		{
			"name": "Escape characters",
			"scope": "constant.character.escape",
			"settings": {
				"foreground": "#25B0BCE6"
			}
		},
		{
			"name": "Named entities",
			"scope": "entity.name",
			"settings": {
				"foreground": "#FAC29AE6"
			}
		},
		{
			"name": "Function names",
			"scope": "entity.name.function",
			"settings": {
				"foreground": "#25B0BCE6"
			}
		},
		{
			"name": "Tags",
			"scope": "entity.name.tag",
			"settings": {
				"foreground": "#E95678E6",
				"fontStyle": "normal"
			}
		},
		{
			"name": "Static types",
			"scope": ["entity.name.type", "storage.type.cs"],
			"settings": {
				"foreground": "#FAC29AE6"
			}
		},
		{
			"name": "Tag attributes",
			"scope": "entity.other.attribute-name",
			"settings": {
				"foreground": "#F09483E6",
				"fontStyle": "italic"
			}
		},
		{
			"name": "Inherited classes",
			"scope": "entity.other.inherited-class",
			"settings": {
				"foreground": "#FAB795E6"
			}
		},
		{
			"name": "CSS ID selectors",
			"scope": "entity.other.attribute-name.id",
			"settings": {
				"foreground": "#25B0BCE6"
			}
		},
		{
			"name": "Pseudo CSS",
			"scope": ["entity.other.attribute-name.pseudo-element", "entity.other.attribute-name.pseudo-class"],
			"settings": {
				"foreground": "#FAB795E6"
			}
		},
		{
			"name": "Variable names",
			"scope": ["entity.name.variable", "variable"],
			"settings": {
				"foreground": "#E95678E6"
			}
		},
		{
			"name": "Keywords",
			"scope": "keyword",
			"settings": {
				"foreground": "#B877DBE6",
				"fontStyle": "italic"
			}
		},
		{
			"name": "Operators",
			"scope": "keyword.operator",
			"settings": {
				"foreground": "#BBBBBB"
			}
		},
		{
			"name": "Special operators",
			"scope": [
				"keyword.operator.new",
				"keyword.operator.expression",
				"keyword.operator.logical",
				"keyword.operator.delete"
			],
			"settings": {
				"foreground": "#B877DBE6"
			}
		},
		{
			"name": "Units",
			"scope": "keyword.other.unit",
			"settings": {
				"foreground": "#F09483E6"
			}
		},
		{
			"name": "Markup quotes",
			"scope": "markup.quote",
			"settings": {
				"foreground": "#FAB795B3",
				"fontStyle": "italic"
			}
		},
		{
			"name": "Markup headings",
			"scope": ["markup.heading", "entity.name.section"],
			"settings": {
				"foreground": "#E95678E6"
			}
		},
		{
			"name": "Markup bold",
			"scope": "markup.bold",
			"settings": {
				"foreground": "#B877DBE6",
				"fontStyle": "bold"
			}
		},
		{
			"name": "Markup italics",
			"scope": "markup.italic",
			"settings": {
				"foreground": "#25B0BCE6",
				"fontStyle": "italic"
			}
		},
		{
			"name": "Markup code",
			"scope": ["markup.inline.raw", "markup.fenced_code.block"],
			"settings": {
				"foreground": "#F09483E6"
			}
		},
		{
			"name": "Markup links",
			"scope": "markup.underline.link",
			"settings": {
				"foreground": "#FAB795E6"
			}
		},
		{
			"name": "Storage keywords",
			"scope": "storage",
			"settings": {
				"foreground": "#B877DBE6",
				"fontStyle": "italic"
			}
		},
		{
			"name": "Strings",
			"scope": ["string.quoted", "string.template"],
			"settings": {
				"foreground": "#FAB795E6"
			}
		},
		{
			"name": "Regex",
			"scope": "string.regexp",
			"settings": {
				"foreground": "#F09483E6"
			}
		},
		{
			"name": "Markup link descriptions",
			"scope": "string.other.link",
			"settings": {
				"foreground": "#F09483E6"
			}
		},
		{
			"name": "Provided (support) values",
			"scope": "support",
			"settings": {
				"foreground": "#E9C9A7E6"
			}
		},
		{
			"name": "Provided functions",
			"scope": "support.function",
			"settings": {
				"foreground": "#25B0BCE6"
			}
		},
		{
			"name": "Provieded variables",
			"scope": "support.variable",
			"settings": {
				"foreground": "#E95678E6"
			}
		},
		{
			"name": "Object/JSON property names",
			"scope": ["support.type.property-name", "meta.object-literal.key"],
			"settings": {
				"foreground": "#E95678E6"
			}
		},
		{
			"name": "CSS property names",
			"scope": "support.type.property-name.css",
			"settings": {
				"foreground": "#BBBBBB"
			}
		},
		{
			"name": "Language variables",
			"scope": ["variable.language"],
			"settings": {
				"foreground": "#FAC29AE6",
				"fontStyle": "italic"
			}
		},
		{
			"name": "Parameters",
			"scope": "variable.parameter",
			"settings": {
				"fontStyle": "italic"
			}
		},
		{
			"name": "Embedded template punctuation",
			"scope": "string.template meta.embedded",
			"settings": {
				"foreground": "#BBBBBB"
			}
		},
		{
			"name": "Tag brackets",
			"scope": "punctuation.definition.tag",
			"settings": {
				"foreground": "#E95678B3",
				"fontStyle": "normal"
			}
		},
		{
			"name": "Key/value separators",
			"scope": "punctuation.separator",
			"settings": {
				"foreground": "#BBBBBB"
			}
		},
		{
			"name": "Template expressions",
			"scope": "punctuation.definition.template-expression",
			"settings": {
				"foreground": "#B877DBE6"
			}
		},
		{
			"name": "Embedded section punctuation",
			"scope": "punctuation.section.embedded",
			"settings": {
				"foreground": "#B877DBE6"
			}
		},
		{
			"name": "Markup list punctuation",
			"scope": "punctuation.definition.list",
			"settings": {
				"foreground": "#F09483E6"
			}
		}
	]
}

```

`rsrc/triangle-right.svg`:

```svg
<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M5.55973 14L5 13.5866L5 2.39328L5.53925 2L11 7.62689L11 8.45378L5.55973 14Z" fill="#F1EFEC"/>
</svg>

```

`theme/map.go`:

```go
package theme

import (
	"fmt"
	"log"
	"regexp"
	"strconv"
	"strings"
)

func toRGB(hex string) string {
	hex = strings.ToUpper(hex)
	switch len(hex) {
	case 4:
		// #RGB -> #RRGGBB
		return fmt.Sprintf("#%c%c%c%c%c%c", hex[1], hex[1], hex[2], hex[2], hex[3], hex[3])
	case 5:
		// #RGBA -> #RRGGBB
		return fmt.Sprintf("#%c%c%c%c%c%c%c%c", hex[1], hex[1], hex[2], hex[2], hex[3], hex[3], hex[4], hex[4])
	case 7:
		// #RRGGBB -> #RRGGBB
		return hex
	case 9:
		// #RRGGBBAA -> #RRGGBB
		return hex[:7]
	default:
		log.Fatalf("Invalid hex color: %s", hex)
		return ""
	}
}
func getComponents(hex string) (r, g, b int64) {
	if len(hex) != 7 && len(hex) != 9 {
		hex = toRGB(hex)
	}
	r, _ = strconv.ParseInt(hex[1:3], 16, 64)
	g, _ = strconv.ParseInt(hex[3:5], 16, 64)
	b, _ = strconv.ParseInt(hex[5:7], 16, 64)
	return
}

func getAlpha(hex string) (res string) {
	defer func() {
		if len(res) == 0 {
			res = "FF"
		}
		if res == "FF" {
			res = ""
		}
	}()

	hex = strings.ToUpper(hex)
	switch len(hex) {
	case 4:
		// #RGB -> FF
		break
	case 5:
		// #RGBA -> AA
		return hex[4:5] + hex[4:5]
	case 7:
		// #RRGGBB -> FF
		break
	case 9:
		// #RRGGBBAA -> AA
		return hex[7:9]
	default:
		return "FF"
	}
	return "FF"
}
func colorDistance(hex1, hex2 string) int64 {
	r1, g1, b1 := getComponents(hex1)
	r2, g2, b2 := getComponents(hex2)
	return (r1-r2)*(r1-r2) + (g1-g2)*(g1-g2) + (b1-b2)*(b1-b2)
}

type Instance struct {
	Data           Data
	Colors         map[string]string   // key -> hex
	InvertedColors map[string][]string // hex -> keys[]
}

func (p *Instance) addColor(key, hex string) {
	if len(hex) == 0 {
		return
	}
	hex = toRGB(hex)
	p.Colors[key] = hex
	p.InvertedColors[hex] = append(p.InvertedColors[hex], key)
}

func (p *Instance) remapRGB(hex string, other *Instance) string {
	if hex == "" {
		return ""
	}

	if v, ok := p.InvertedColors[hex]; ok {
		for _, k := range v {
			if v, ok := other.Colors[k]; ok {
				return v
			}
		}
	} else {
		// Find the closest color
		var closest string
		var minDist int64 = 1<<63 - 1
		for color, _ := range p.InvertedColors {
			dist := colorDistance(hex, color)
			if dist < minDist {
				minDist = dist
				closest = color
			}
		}
		if minDist > 5000 {
			return hex
		}
		return p.remapRGB(closest, other)
	}
	return hex
}

func (p *Instance) RemapCSS(css string, other *Instance) string {
	regexp := regexp.MustCompile(`#[0-9a-fA-F]{3,8};`)
	remapCache := make(map[string]string)
	css = regexp.ReplaceAllStringFunc(css, func(hex string) string {
		hex = hex[:len(hex)-1]
		alpha := getAlpha(hex)
		hex = toRGB(hex)

		if v, ok := remapCache[hex]; ok {
			return v + alpha + ";"
		}
		result := p.remapRGB(hex, other)
		remapCache[hex] = result
		if result != hex {
			fmt.Printf("Remapping %s -> %s (distance %d)\n", hex, result, colorDistance(hex, result))
		}
		return result + alpha + ";"
	})
	return css
}

```

`theme/parser.go`:

```go
package theme

import (
	"encoding/json"
	"os"

	"github.com/tidwall/jsonc"
)

type TokenColors struct {
	Name     string `json:"name,omitempty"`
	Scope    any    `json:"scope,omitempty"` // string or []string
	Settings struct {
		FontStyle  string `json:"fontStyle,omitempty"`
		Foreground string `json:"foreground,omitempty"`
	} `json:"settings,omitempty"`
}

func (tc TokenColors) GetScope() []string {
	switch v := tc.Scope.(type) {
	case string:
		return []string{v}
	case []string:
		return v
	default:
		return nil
	}
}

type Data struct {
	Name        string            `json:"name"`
	Type        string            `json:"type"`
	Colors      map[string]string `json:"colors"`
	TokenColors []TokenColors     `json:"tokenColors,omitempty"`
}

func Parse(data []byte) (*Instance, error) {
	data = jsonc.ToJSON(data)

	var d Data
	err := json.Unmarshal(data, &d)
	if err != nil {
		return nil, err
	}
	parsed := &Instance{
		Data:           d,
		Colors:         make(map[string]string),
		InvertedColors: make(map[string][]string),
	}
	for k, v := range d.Colors {
		parsed.addColor(k, v)
	}
	for _, tc := range d.TokenColors {
		for _, scope := range tc.GetScope() {
			parsed.addColor(scope, tc.Settings.Foreground)
		}
	}

	return parsed, nil
}
func ReadFile(path string) (*Instance, error) {
	data, err := os.ReadFile(path)
	if err != nil {
		return nil, err
	}
	return Parse(data)
}

```