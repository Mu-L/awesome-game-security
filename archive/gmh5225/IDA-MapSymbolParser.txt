Project Path: arc_gmh5225_IDA-MapSymbolParser_92vgpy0b

Source Tree:

```txt
arc_gmh5225_IDA-MapSymbolParser_92vgpy0b
├── IDA-MapSymbolParser.py
├── LICENSE
└── README.md

```

`IDA-MapSymbolParser.py`:

```py
import idaapi
import idautils
import idc
import re

def extract_names_and_rva_base(file_path):
    # Regular expression pattern to match lines with the desired format
    pattern = r"\s(\d+):([a-fA-F0-9]+)\s+(\S+)\s+([a-fA-F0-9]+)\s+(.+)"
    results = []

    # Open the file and read line by line
    with open(file_path, 'r', encoding='utf-8') as file:
        for line in file:
            match = re.search(pattern, line)
            if match:
                # Extract name and Rva+Base
                section_number, offset, name, rva_base, _ = match.groups()
                # Convert Rva+Base to an integer in hexadecimal
                results.append((name, int(rva_base, 16)))  
    return results

def rename_symbols_from_map():
    # Use idaapi.ask_file to show a file selection dialog for choosing a .map file
    map_file_path = idaapi.ask_file(0, "*.map", "Please select a .map file to parse")
    if map_file_path:
        extracted_data = extract_names_and_rva_base(map_file_path)
        for name, rva_base in extracted_data:
            # Use idaapi.set_name to rename the corresponding address, ensuring the address is valid
            if idc.get_segm_name(rva_base) is not None:
                idaapi.set_name(rva_base, name, idaapi.SN_NOWARN)
        print(f"[ParseMap] Processed {len(extracted_data)} symbols.")
    else:
        print("[ParseMap] No .map file selected.")

class ParseMapPlugin(idaapi.plugin_t):
    flags = 0
    comment = 'Parse MAP file'
    help = 'Parse MAP file'
    wanted_name = 'Parse MAP file'
    wanted_hotkey = ''

    def init(self):
        return idaapi.PLUGIN_OK

    def run(self, arg):
        rename_symbols_from_map()

    def term(self):
        pass

def PLUGIN_ENTRY():
    try:
        return ParseMapPlugin()

    except Exception as err:
        import traceback
        print('[ParseMap] Error: %s\n%s' % str((err), traceback.format_exc()))
        raise

# run as script
def main():
    rename_symbols_from_map()

if __name__ == '__main__':
    main()

```

`LICENSE`:

```
MIT License

Copyright (c) 2024 gmh

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

```

`README.md`:

```md
# IDA-MapSymbolParser

This script is designed for use within the IDA Pro disassembler to facilitate the renaming of symbols based on information extracted from `.map` files. It automates the process of symbol naming, enhancing the reverse engineering workflow by incorporating meaningful names into the IDA database from the provided map files.

## Features

- **File Selection Dialog**: Allows users to select a `.map` file directly from the IDA Pro interface.
- **Automatic Symbol Renaming**: Parses the selected `.map` file to extract symbol names and their corresponding addresses (RVA + Base) and renames symbols within IDA Pro to reflect these names, improving readability and navigability of the disassembled code.
- **Hexadecimal Conversion**: Converts extracted addresses to hexadecimal format for compatibility with IDA Pro's addressing.

## Usage

1. Ensure that IDA Pro is running and that you have a project open.
2. Execute the script within IDA Pro's scripting console or load it through the File -> Script file menu option.
3. A file selection dialog will appear. Navigate to and select the `.map` file you wish to parse.
4. The script will process the file, renaming symbols in IDA Pro based on the extracted data.

## Requirements

- IDA Pro with IDAPython plugin installed.





```