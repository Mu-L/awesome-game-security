Project Path: arc_gmh5225_UCFoxi-Shared-FlushFileBuffers-Communication-Update_f2oam03q

Source Tree:

```txt
arc_gmh5225_UCFoxi-Shared-FlushFileBuffers-Communication-Update_f2oam03q
├── README.md
└── UCFoxi-Shared-FlushFileBuffers-Communication-Update
    ├── SharedBufferComm.sln
    ├── kernel
    │   ├── ARM
    │   │   └── Release
    │   │       ├── kernel.tlog
    │   │       │   ├── CL.command.1.tlog
    │   │       │   ├── kernel.lastbuildstate
    │   │       │   └── unsuccessfulbuild
    │   │       └── vc143.pdb
    │   ├── CallbackHandler.cpp
    │   ├── CallbackHandler.h
    │   ├── DriverMain.cpp
    │   ├── Utils.cpp
    │   ├── Utils.h
    │   ├── kernel.inf
    │   ├── kernel.vcxproj
    │   ├── kernel.vcxproj.filters
    │   ├── kernel.vcxproj.user
    │   ├── stdafx.h
    │   └── x64
    │       └── Release
    │           ├── CallbackHandler.obj
    │           ├── Deruta Nigger Pasted.sys.recipe
    │           ├── DriverMain.obj
    │           ├── Utils.obj
    │           ├── kernel.log
    │           ├── kernel.sys.recipe
    │           ├── kernel.tlog
    │           │   ├── CL.command.1.tlog
    │           │   ├── CL.read.1.tlog
    │           │   ├── CL.write.1.tlog
    │           │   ├── kernel.lastbuildstate
    │           │   ├── link.command.1.tlog
    │           │   ├── link.read.1.tlog
    │           │   └── link.write.1.tlog
    │           ├── vc142.pdb
    │           └── vc143.pdb
    └── x64
        └── Release
            ├── Deruta Nigger Pasted.pdb
            ├── Deruta Nigger Pasted.sys
            └── kernel
                └── Deruta Nigger Pasted.sys

```

`README.md`:

```md
# UCFoxi-Shared-FlushFileBuffers-Communication-Update
KeAttachProcess change toKeStackAttachProcess fortnite eac 45lv ud
Discord derutakabu#9948
CFoxi-Shared-FlushFileBuffers-Communication
https://github.com/UCFoxi/Shared-FlushFileBuffers-Communication


```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/SharedBufferComm.sln`:

```sln

Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio Version 17
VisualStudioVersion = 17.4.33213.308
MinimumVisualStudioVersion = 10.0.40219.1
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "kernel", "kernel\kernel.vcxproj", "{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|ARM = Debug|ARM
		Debug|ARM64 = Debug|ARM64
		Debug|x64 = Debug|x64
		Debug|x86 = Debug|x86
		Release|ARM = Release|ARM
		Release|ARM64 = Release|ARM64
		Release|x64 = Release|x64
		Release|x86 = Release|x86
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Debug|ARM.ActiveCfg = Debug|ARM
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Debug|ARM.Build.0 = Debug|ARM
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Debug|ARM.Deploy.0 = Debug|ARM
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Debug|ARM64.ActiveCfg = Debug|ARM64
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Debug|ARM64.Build.0 = Debug|ARM64
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Debug|ARM64.Deploy.0 = Debug|ARM64
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Debug|x64.ActiveCfg = Debug|x64
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Debug|x64.Build.0 = Debug|x64
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Debug|x64.Deploy.0 = Debug|x64
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Debug|x86.ActiveCfg = Debug|Win32
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Debug|x86.Build.0 = Debug|Win32
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Debug|x86.Deploy.0 = Debug|Win32
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Release|ARM.ActiveCfg = Release|ARM
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Release|ARM.Build.0 = Release|ARM
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Release|ARM.Deploy.0 = Release|ARM
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Release|ARM64.ActiveCfg = Release|ARM64
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Release|ARM64.Build.0 = Release|ARM64
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Release|ARM64.Deploy.0 = Release|ARM64
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Release|x64.ActiveCfg = Release|x64
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Release|x64.Build.0 = Release|x64
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Release|x64.Deploy.0 = Release|x64
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Release|x86.ActiveCfg = Release|Win32
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Release|x86.Build.0 = Release|Win32
		{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}.Release|x86.Deploy.0 = Release|Win32
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
	GlobalSection(ExtensibilityGlobals) = postSolution
		SolutionGuid = {0E26C68B-6BB2-4B1F-8B45-6AEB96454037}
	EndGlobalSection
EndGlobal

```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/ARM/Release/kernel.tlog/kernel.lastbuildstate`:

```lastbuildstate
PlatformToolSet=v143:VCToolArchitecture=Native32Bit:VCToolsVersion=14.34.31933:TargetPlatformVersion=10.0.22621.0:
Release|ARM|C:\Users\epic\Desktop\Shared-FlushFileBuffers-Communication-main\|

```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/CallbackHandler.cpp`:

```cpp
#include "stdafx.h"

//Some stuff from: https://github.com/btbd/modmap/blob/master/driver/core.c
NTSTATUS CallbackWRITE(PREQUEST_WRITE args)
{
	if (((PBYTE)args->Src + args->Size < (PBYTE)args->Src) ||
		((PBYTE)args->Dest + args->Size < (PBYTE)args->Dest) ||
		((PVOID)((PBYTE)args->Src + args->Size) > MM_HIGHEST_USER_ADDRESS) ||
		((PVOID)((PBYTE)args->Dest + args->Size) > MM_HIGHEST_USER_ADDRESS)) {
		return STATUS_ACCESS_VIOLATION;
	}

	if (args->bPhysicalMem) {
		PEPROCESS pProcess = NULL;
		if (args->ProcessId == 0) 
			return STATUS_UNSUCCESSFUL;

		NTSTATUS NtRet = PsLookupProcessByProcessId((HANDLE)args->ProcessId, &pProcess);
		if (NtRet != STATUS_SUCCESS) return NtRet;

		ULONG_PTR process_dirbase = Utils::PhysicalMemory::GetProcessCr3(pProcess);
		ObDereferenceObject(pProcess);

		SIZE_T CurOffset = 0;
		SIZE_T TotalSize = args->Size;
		while (TotalSize)
		{
			INT64 CurPhysAddr = Utils::PhysicalMemory::TranslateLinearAddress(process_dirbase, (ULONG64)args->Src + CurOffset);
			if (!CurPhysAddr) return STATUS_UNSUCCESSFUL;

			ULONG64 WriteSize = min(PAGE_SIZE - (CurPhysAddr & 0xFFF), TotalSize);
			SIZE_T BytesWritten = 0;
			NtRet = Utils::PhysicalMemory::WritePhysicalAddress(PVOID(CurPhysAddr), (PVOID)((ULONG64)args->Dest+ CurOffset), WriteSize, &BytesWritten);
			TotalSize -= BytesWritten;
			CurOffset += BytesWritten;
			if (NtRet != STATUS_SUCCESS) break;
			if (BytesWritten == 0) break;
		}
		//*args-> = CurOffset;
		return NtRet;
	}
	else {
		PEPROCESS process = NULL;
		NTSTATUS status = (PsLookupProcessByProcessId)((HANDLE)args->ProcessId, &process);
		if (NT_SUCCESS(status)) {
			SIZE_T outSize = 0;
			status = (MmCopyVirtualMemory)((PsGetCurrentProcess)(), args->Src, process, args->Dest, (SIZE_T)args->Size, KernelMode, &outSize);
			(ObfDereferenceObject)(process);
		}
		return status;
	}
	return STATUS_UNSUCCESSFUL;
}

NTSTATUS CallbackREAD(PREQUEST_READ args)
{
	if (((PBYTE)args->Src + args->Size < (PBYTE)args->Src) ||
		((PBYTE)args->Dest + args->Size < (PBYTE)args->Dest) ||
		((PVOID)((PBYTE)args->Src + args->Size) > MM_HIGHEST_USER_ADDRESS) ||
		((PVOID)((PBYTE)args->Dest + args->Size) > MM_HIGHEST_USER_ADDRESS)) {

		return STATUS_ACCESS_VIOLATION;
	}

	if (args->bPhysicalMem) {
		PEPROCESS pProcess = NULL;
		if (args->ProcessId == 0) return STATUS_UNSUCCESSFUL;

		NTSTATUS NtRet = PsLookupProcessByProcessId((HANDLE)args->ProcessId, &pProcess);
		if (NtRet != STATUS_SUCCESS) return NtRet;

		ULONG_PTR process_dirbase = Utils::PhysicalMemory::GetProcessCr3(pProcess);
		ObDereferenceObject(pProcess);

		SIZE_T CurOffset = 0;
		SIZE_T TotalSize = args->Size;
		while (TotalSize)
		{

			INT64 CurPhysAddr = Utils::PhysicalMemory::TranslateLinearAddress(process_dirbase, (ULONG64)args->Src + CurOffset);
			if (!CurPhysAddr) return STATUS_UNSUCCESSFUL;

			ULONG64 ReadSize = min(PAGE_SIZE - (CurPhysAddr & 0xFFF), TotalSize);
			SIZE_T BytesRead = 0;
			NtRet = Utils::PhysicalMemory::ReadPhysicalAddress(PVOID(CurPhysAddr), (PVOID)((ULONG64)args->Dest + CurOffset), ReadSize, &BytesRead);
			TotalSize -= BytesRead;
			CurOffset += BytesRead;
			if (NtRet != STATUS_SUCCESS) break;
			if (BytesRead == 0) break;
		}
		//*read = CurOffset;
		return NtRet;
	}
	else {
		PEPROCESS process = NULL;
		NTSTATUS status = (PsLookupProcessByProcessId)((HANDLE)args->ProcessId, &process);
		if (NT_SUCCESS(status)) {
			SIZE_T outSize = 0;
			status = (MmCopyVirtualMemory)(process, args->Src, (PsGetCurrentProcess)(), args->Dest, (SIZE_T)args->Size, KernelMode, &outSize);
			(ObfDereferenceObject)(process);
		}
		return status;
	}

	return STATUS_UNSUCCESSFUL;
}

NTSTATUS CallbackPROTECT(PREQUEST_PROTECT args)
{
	if (!args->ProcessId || !args->Address || !args->Size || !args->InOutProtect)
		return STATUS_INVALID_PARAMETER;

	NTSTATUS status = STATUS_SUCCESS;
	PEPROCESS target_process = NULL;

	if (!NT_SUCCESS((PsLookupProcessByProcessId)((HANDLE)args->ProcessId, &target_process)))
	{
		return STATUS_NOT_FOUND;
	}
	SIZE_T size = args->Size;
	DWORD protect = 0;
	RtlCopyMemory(&protect, args->InOutProtect, sizeof(protect));

	KAPC_STATE state;

	(KeStackAttachProcess)((PKPROCESS)target_process, &state);
	status = (ZwProtectVirtualMemory)(NtCurrentProcess(), &args->Address, &size, protect, &protect);
	(KeDetachProcess)();
	if (NT_SUCCESS(status))
		RtlCopyMemory(args->InOutProtect, &protect, sizeof(protect));

	(ObfDereferenceObject)(target_process);
	return status;
}

NTSTATUS CallbackALLOC(PREQUEST_ALLOC args)
{
	PEPROCESS process = NULL;
	NTSTATUS status = (PsLookupProcessByProcessId)((HANDLE)args->ProcessId, &process);
	if (NT_SUCCESS(status)) {
		PVOID address = NULL;
		SIZE_T size = args->Size;

		KAPC_STATE state;

		(KeStackAttachProcess)(process, &state);
		(ZwAllocateVirtualMemory)(NtCurrentProcess(), &address, 0, &size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
		(KeDetachProcess)();

		RtlCopyMemory(args->OutAddress, &address, sizeof(address));

		(ObfDereferenceObject)(process);
	}
	return status;
}

NTSTATUS CallbackFREE(PREQUEST_FREE args)
{
	PEPROCESS process = NULL;
	NTSTATUS status = (PsLookupProcessByProcessId)((HANDLE)args->ProcessId, &process);
	if (NT_SUCCESS(status)) {
		SIZE_T size = 0;

		KAPC_STATE state;

		(KeStackAttachProcess)(process, &state);
		(ZwFreeVirtualMemory)(NtCurrentProcess(), &args->Address, &size, MEM_RELEASE);
		(KeDetachProcess)();

		(ObfDereferenceObject)(process);
	}
	return status;
}

NTSTATUS CallbackMODULE(PREQUEST_MODULE args)
{
	PEPROCESS process = NULL;
	NTSTATUS status = (PsLookupProcessByProcessId)((HANDLE)args->ProcessId, &process);
	if (NT_SUCCESS(status)) {
		PVOID base = NULL;
		DWORD size = 0;

		KAPC_STATE state;

		(KeStackAttachProcess)(process, &state);
		PLDR_DATA_TABLE_ENTRY module = Utils::GetModuleByName(process, args->Module);//L"ReadAndWriteMe.exe");//args->Module);
		if (module) {
			base = module->DllBase;
			size = module->SizeOfImage;
		}
		else {
			status = STATUS_NOT_FOUND;
		}
		(KeDetachProcess)();
		if (NT_SUCCESS(status)) {
			RtlCopyMemory(args->OutAddress, &base, sizeof(base));
			RtlCopyMemory(args->OutSize, &size, sizeof(size));
		}
		(ObfDereferenceObject)(process);
	}
	return status;
}

NTSTATUS CallbackMAINBASE(PREQUEST_MAINBASE args)
{
	PEPROCESS pProcess = NULL;
	if (args->ProcessId == 0)
		return STATUS_UNSUCCESSFUL;

	NTSTATUS NtRet = PsLookupProcessByProcessId((HANDLE)args->ProcessId, &pProcess);
	if (NtRet != STATUS_SUCCESS)
		return STATUS_UNSUCCESSFUL;

	auto base = PsGetProcessSectionBaseAddress(pProcess);
	RtlCopyMemory(args->OutAddress, &base, sizeof(base));
	ObDereferenceObject(pProcess);
	return STATUS_SUCCESS;
}

```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/CallbackHandler.h`:

```h
#pragma once
#define DEFAULT_MAGGICCODE 0x43a6b54CFFCA2AaA //length 16 max

#define CallbackHandler(name)												\
 case REQUEST_TYPE::name: {													\
		REQUEST_##name args;												\
        RtlCopyMemory(&args, data.Arguments, sizeof(args));					\
        *data.Status = Callback##name(&args);								\
        break;																\
    }

typedef enum _REQUEST_TYPE : UINT{
	WRITE,
	READ,
	PROTECT,
	ALLOC,
	FREE,
	MODULE,
	MAINBASE,
	THREADCALL,
} REQUEST_TYPE;

typedef struct _REQUEST_DATA {
	ULONG64* MaggicCode;
	UINT Type;
	PVOID Arguments;
	NTSTATUS* Status;
} REQUEST_DATA, * PREQUEST_DATA;

typedef struct _REQUEST_WRITE {
	DWORD ProcessId;
	PVOID Dest;
	PVOID Src;
	DWORD Size;
	BOOL bPhysicalMem;
} REQUEST_WRITE, * PREQUEST_WRITE;

typedef struct _REQUEST_READ {
	DWORD ProcessId;
	PVOID Dest;
	PVOID Src;
	DWORD Size;
	BOOL bPhysicalMem;
} REQUEST_READ, * PREQUEST_READ;

typedef struct _REQUEST_PROTECT {
	DWORD ProcessId;
	PVOID Address;
	DWORD Size;
	PDWORD InOutProtect;
} REQUEST_PROTECT, * PREQUEST_PROTECT;

typedef struct _REQUEST_ALLOC {
	DWORD ProcessId;
	PVOID OutAddress;
	DWORD Size;
	DWORD Protect;
} REQUEST_ALLOC, * PREQUEST_ALLOC;

typedef struct _REQUEST_FREE {
	DWORD ProcessId;
	PVOID Address;
} REQUEST_FREE, * PREQUEST_FREE;

typedef struct _REQUEST_MODULE {
	DWORD ProcessId;
	WCHAR Module[0xFF];
	PBYTE* OutAddress;
	DWORD* OutSize;
} REQUEST_MODULE, * PREQUEST_MODULE;

typedef struct _REQUEST_MAINBASE {
	DWORD ProcessId;
	PBYTE* OutAddress;
} REQUEST_MAINBASE, * PREQUEST_MAINBASE;

NTSTATUS CallbackWRITE(PREQUEST_WRITE args);
NTSTATUS CallbackREAD(PREQUEST_READ args);
NTSTATUS CallbackPROTECT(PREQUEST_PROTECT args);
NTSTATUS CallbackALLOC(PREQUEST_ALLOC args);
NTSTATUS CallbackFREE(PREQUEST_FREE args);
NTSTATUS CallbackMODULE(PREQUEST_MODULE args);
NTSTATUS CallbackMAINBASE(PREQUEST_MAINBASE args);
```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/DriverMain.cpp`:

```cpp
#include "stdafx.h"

UNICODE_STRING RegPath = RTL_CONSTANT_STRING(L"\\Registry\\Machine\\SOFTWARE\\ucflash");
typedef NTSTATUS(*HookControl_t)(void* a1, void* a2);
HookControl_t OriginalPtr;
PVOID SharedBuffer = 0;
UINT SharedPid = 0;
ULONG64 NewMaggicCode = DEFAULT_MAGGICCODE;

NTSTATUS HookControl(PDEVICE_OBJECT device, PIRP irp) {
	static bool retry = false;
	retry:
	PEPROCESS process = NULL;
	NTSTATUS status = PsLookupProcessByProcessId((HANDLE)SharedPid, &process);
	if (NT_SUCCESS(status) && process) {
		retry = false;
		REQUEST_DATA data;
		SIZE_T outSize = 0; //need to, if not == crash!
		if (NT_SUCCESS(MmCopyVirtualMemory(process, (void*)SharedBuffer, PsGetCurrentProcess(), &data, (SIZE_T)sizeof(REQUEST_DATA), KernelMode, &outSize))) {
			if (*data.MaggicCode == NewMaggicCode) {
				if (NewMaggicCode == DEFAULT_MAGGICCODE) { //reset maggicode to fuck with bad devs ;)
					ULONG time = 0;
					KeQuerySystemTime(&time);
					NewMaggicCode = RtlRandomEx(&time) % MAXULONG64;
					*data.MaggicCode = NewMaggicCode;
					Utils::Registry::WriteRegistry(RegPath, RTL_CONSTANT_STRING(L"xxxx"), &NewMaggicCode, REG_QWORD, 8);
					//print("NewMaggicCode: 0x%llX\n", NewMaggicCode);
				}
				switch (data.Type)
				{
					CallbackHandler(WRITE);
					CallbackHandler(READ);
					CallbackHandler(PROTECT);
					CallbackHandler(ALLOC);
					CallbackHandler(FREE);
					CallbackHandler(MODULE);
					CallbackHandler(MAINBASE);
				case THREADCALL: {
					break;
				}
				case 99:
					break;
				default:
					break;
				}
				ObfDereferenceObject(process);
				IofCompleteRequest(irp, 0);
				return 0;
			}
		}
		ObfDereferenceObject(process);
	}
	else {
		SharedBuffer = (PVOID)Utils::Registry::ReadRegistry<LONG64>(RegPath, RTL_CONSTANT_STRING(L"xxx"));
		SharedPid = (UINT)Utils::Registry::ReadRegistry<LONG64>(RegPath, RTL_CONSTANT_STRING(L"xx"));

		if (!retry) {
			retry = true;
			goto retry;
		}
	}
	return OriginalPtr(device, irp);
}

INT64 driver_main() {
	PDRIVER_OBJECT DriverObject = nullptr;
	UNICODE_STRING DriverObjectName = RTL_CONSTANT_STRING(L"\\Driver\\PEAUTH");
	ObReferenceObjectByName(&DriverObjectName, (ULONG)OBJ_CASE_INSENSITIVE, (PACCESS_STATE)0, (ACCESS_MASK)0, *IoDriverObjectType, KernelMode, (PVOID)0, (PVOID*)&DriverObject);
	if (DriverObject) {
		*(PVOID*)&OriginalPtr = InterlockedExchangePointer((void**)&DriverObject->MajorFunction[IRP_MJ_FLUSH_BUFFERS], HookControl);
		SharedBuffer = (PVOID)Utils::Registry::ReadRegistry<LONG64>(RegPath, RTL_CONSTANT_STRING(L"xxx"));
		SharedPid = (UINT)Utils::Registry::ReadRegistry<LONG64>(RegPath, RTL_CONSTANT_STRING(L"xx"));
		return 0;
	}
	return 1;
}

NTSTATUS DriversMaain(PVOID lpBaseAddress, DWORD32 dwSize) {
	driver_main();
	return -1;
}
```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/Utils.cpp`:

```cpp
#include "stdafx.h"

PLDR_DATA_TABLE_ENTRY Utils::GetModuleByName(PEPROCESS process, PWCHAR moduleName)
{
	UNICODE_STRING moduleNameStr = { 0 };
	RtlInitUnicodeString((PUNICODE_STRING)&moduleNameStr, (PCWSTR)moduleName);

	PLIST_ENTRY list = &((PsGetProcessPeb)(process)->Ldr->InLoadOrderModuleList);
	for (PLIST_ENTRY entry = list->Flink; entry != list; ) {
		PLDR_DATA_TABLE_ENTRY module = CONTAINING_RECORD(entry, LDR_DATA_TABLE_ENTRY, InLoadOrderLinks);

		if ((RtlCompareUnicodeString)(&module->BaseDllName, &moduleNameStr, TRUE) == 0) {
			return module;
		}
		entry = module->InLoadOrderLinks.Flink;
	}
	return NULL;
}

const DWORD Utils::PhysicalMemory::GetUserDirectoryTableBaseOffset()
{
	RTL_OSVERSIONINFOW ver = { 0 };
	RtlGetVersion(&ver);
	switch (ver.dwBuildNumber)
	{
	case WINDOWS_1803:
		return 0x0278;
		break;
	case WINDOWS_1809:
		return 0x0278;
		break;
	case WINDOWS_1903:
		return 0x0280;
		break;
	case WINDOWS_1909:
		return 0x0280;
		break;
	case WINDOWS_2004:
		return 0x0388;
		break;
	case WINDOWS_20H2:
		return 0x0388;
		break;
	case WINDOWS_21H1:
		return 0x0388;
		break;
	default:
		return 0x0388;
	}
}

const UINT64 Utils::PhysicalMemory::GetProcessCr3(const PEPROCESS pProcess)
{
	PUCHAR process = (PUCHAR)pProcess;
	ULONG_PTR process_dirbase = *(PULONG_PTR)(process + 0x28); //dirbase x64, 32bit is 0x18
	if (process_dirbase == 0)
	{
		DWORD UserDirOffset = GetUserDirectoryTableBaseOffset();
		ULONG_PTR process_userdirbase = *(PULONG_PTR)(process + UserDirOffset);
		return process_userdirbase;
	}
	return process_dirbase;
}

const UINT64 Utils::PhysicalMemory::GetKernelDirBase()
{
	PUCHAR process = (PUCHAR)PsGetCurrentProcess();
	ULONG_PTR cr3 = *(PULONG_PTR)(process + 0x28); //dirbase x64, 32bit is 0x18
	return cr3;
}

#define PAGE_OFFSET_SIZE 12
static const UINT64 PMASK = (~0xfull << 8) & 0xfffffffffull;
const UINT64 Utils::PhysicalMemory::TranslateLinearAddress(UINT64 directoryTableBase, UINT64 virtualAddress)
{
	directoryTableBase &= ~0xf;

	UINT64 pageOffset = virtualAddress & ~(~0ul << PAGE_OFFSET_SIZE);
	UINT64 pte = ((virtualAddress >> 12) & (0x1ffll));
	UINT64 pt = ((virtualAddress >> 21) & (0x1ffll));
	UINT64 pd = ((virtualAddress >> 30) & (0x1ffll));
	UINT64 pdp = ((virtualAddress >> 39) & (0x1ffll));

	SIZE_T readsize = 0;
	UINT64 pdpe = 0;
	ReadPhysicalAddress(PVOID(directoryTableBase + 8 * pdp), &pdpe, sizeof(pdpe), &readsize);
	if (~pdpe & 1)
		return 0;

	UINT64 pde = 0;
	ReadPhysicalAddress(PVOID((pdpe & PMASK) + 8 * pd), &pde, sizeof(pde), &readsize);
	if (~pde & 1)
		return 0;

	/* 1GB large page, use pde's 12-34 bits */
	if (pde & 0x80)
		return (pde & (~0ull << 42 >> 12)) + (virtualAddress & ~(~0ull << 30));

	UINT64 pteAddr = 0;
	ReadPhysicalAddress(PVOID((pde & PMASK) + 8 * pt), &pteAddr, sizeof(pteAddr), &readsize);
	if (~pteAddr & 1)
		return 0;

	/* 2MB large page */
	if (pteAddr & 0x80)
		return (pteAddr & PMASK) + (virtualAddress & ~(~0ull << 21));

	virtualAddress = 0;
	ReadPhysicalAddress(PVOID((pteAddr & PMASK) + 8 * pte), &virtualAddress, sizeof(virtualAddress), &readsize);
	virtualAddress &= PMASK;

	if (!virtualAddress)
		return 0;

	return virtualAddress + pageOffset;
}

NTSTATUS Utils::PhysicalMemory::ReadVirtual(UINT64 dirbase, UINT64 address, UINT8* buffer, SIZE_T size, SIZE_T* read)
{
	UINT64 paddress = TranslateLinearAddress(dirbase, address);
	return ReadPhysicalAddress(PVOID(paddress), buffer, size, read);
}

NTSTATUS Utils::PhysicalMemory::WriteVirtual(UINT64 dirbase, UINT64 address, UINT8* buffer, SIZE_T size, SIZE_T* written)
{
	UINT64 paddress = TranslateLinearAddress(dirbase, address);
	return WritePhysicalAddress(PVOID(paddress), buffer, size, written);
}

NTSTATUS Utils::PhysicalMemory::ReadPhysicalAddress(PVOID TargetAddress, PVOID lpBuffer, SIZE_T Size, SIZE_T* BytesRead)
{
	MM_COPY_ADDRESS AddrToRead = { 0 };
	AddrToRead.PhysicalAddress.QuadPart = (LONGLONG)TargetAddress;
	return MmCopyMemory(lpBuffer, AddrToRead, Size, MM_COPY_MEMORY_PHYSICAL, BytesRead);
}

NTSTATUS Utils::PhysicalMemory::WritePhysicalAddress(PVOID TargetAddress, PVOID lpBuffer, SIZE_T Size, SIZE_T* BytesWritten)
{
	if (!TargetAddress)
		return STATUS_UNSUCCESSFUL;

	PHYSICAL_ADDRESS AddrToWrite = { 0 };
	AddrToWrite.QuadPart = LONGLONG(TargetAddress);

	PVOID pmapped_mem = MmMapIoSpaceEx(AddrToWrite, Size, PAGE_READWRITE);

	if (!pmapped_mem)
		return STATUS_UNSUCCESSFUL;

	memcpy(pmapped_mem, lpBuffer, Size);

	*BytesWritten = Size;
	MmUnmapIoSpace(pmapped_mem, Size);
	return STATUS_SUCCESS;
}

ULONG Utils::Registry::GetKeyInfoSize(HANDLE hKey, PUNICODE_STRING Key)
{
	NTSTATUS Status;
	ULONG KeySize;

	Status = ZwQueryValueKey(hKey, Key, KeyValueFullInformation, 0, 0, &KeySize);

	if (Status == STATUS_BUFFER_TOO_SMALL || Status == STATUS_BUFFER_OVERFLOW)
		return KeySize;

	return 0;
}

bool Utils::Registry::WriteRegistry(UNICODE_STRING RegPath, UNICODE_STRING Key, PVOID Address, ULONG Type, ULONG Size)
{
	bool Success = false;
	HANDLE hKey;
	OBJECT_ATTRIBUTES ObjAttr;
	NTSTATUS Status = STATUS_UNSUCCESSFUL;

	InitializeObjectAttributes(&ObjAttr, &RegPath, OBJ_CASE_INSENSITIVE | OBJ_KERNEL_HANDLE, NULL, NULL);

	Status = ZwOpenKey(&hKey, KEY_ALL_ACCESS, &ObjAttr);

	if (NT_SUCCESS(Status))
	{
		Status = ZwSetValueKey(hKey, &Key, NULL, Type, Address, Size);

		if (NT_SUCCESS(Status))
			Success = true;

		ZwClose(hKey);
	}

	return Success;
}

```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/Utils.h`:

```h
#pragma once
#define RVA(addr, size) (uint64_t)((PBYTE)((UINT_PTR)(addr) + *(PINT)((UINT_PTR)(addr) + ((size) - sizeof(INT))) + (size)))

//https://ntdiff.github.io/
#define WINDOWS_1803 17134
#define WINDOWS_1809 17763
#define WINDOWS_1903 18362
#define WINDOWS_1909 18363
#define WINDOWS_2004 19041
#define WINDOWS_20H2 19569
#define WINDOWS_21H1 20180

typedef struct _PEB_LDR_DATA {
	ULONG Length;
	UCHAR Initialized;
	PVOID SsHandle;
	LIST_ENTRY InLoadOrderModuleList;
	LIST_ENTRY InMemoryOrderModuleList;
	LIST_ENTRY InInitializationOrderModuleList;
} PEB_LDR_DATA, * PPEB_LDR_DATA;

typedef struct _PEB {
	UCHAR InheritedAddressSpace;
	UCHAR ReadImageFileExecOptions;
	UCHAR BeingDebugged;
	UCHAR BitField;
	PVOID Mutant;
	PVOID ImageBaseAddress;
	PPEB_LDR_DATA Ldr;
	PVOID ProcessParameters;
	PVOID SubSystemData;
	PVOID ProcessHeap;
	PVOID FastPebLock;
	PVOID AtlThunkSListPtr;
	PVOID IFEOKey;
	PVOID CrossProcessFlags;
	PVOID KernelCallbackTable;
	ULONG SystemReserved;
	ULONG AtlThunkSListPtr32;
	PVOID ApiSetMap;
} PEB, * PPEB;

typedef struct _LDR_DATA_TABLE_ENTRY {
	LIST_ENTRY InLoadOrderLinks;
	LIST_ENTRY InMemoryOrderLinks;
	LIST_ENTRY InInitializationOrderLinks;
	PVOID DllBase;
	PVOID EntryPoint;
	ULONG SizeOfImage;
	UNICODE_STRING FullDllName;
	UNICODE_STRING BaseDllName;
	ULONG Flags;
	USHORT LoadCount;
	USHORT TlsIndex;
	LIST_ENTRY HashLinks;
	ULONG TimeDateStamp;
} LDR_DATA_TABLE_ENTRY, * PLDR_DATA_TABLE_ENTRY;

extern "C" POBJECT_TYPE * IoDriverObjectType;
extern "C" {
	NTSTATUS NTAPI MmCopyVirtualMemory(PEPROCESS SourceProcess, PVOID SourceAddress, PEPROCESS TargetProcess, PVOID TargetAddress, SIZE_T BufferSize, KPROCESSOR_MODE PreviousMode, PSIZE_T ReturnSize);
	NTSYSAPI NTSTATUS NTAPI ObReferenceObjectByName(PUNICODE_STRING ObjectPath, ULONG Attributes, PACCESS_STATE PassedAccessState, ACCESS_MASK DesiredAccess, POBJECT_TYPE ObjectType, KPROCESSOR_MODE AccessMode, PVOID ParseContext, PVOID* ObjectPtr);
	NTKERNELAPI PVOID PsGetProcessSectionBaseAddress(PEPROCESS Process);
	NTKERNELAPI PPEB  NTAPI PsGetProcessPeb(IN PEPROCESS Process);
	NTSTATUS NTAPI ZwProtectVirtualMemory(HANDLE ProcessHandle, PVOID* BaseAddress, SIZE_T* NumberOfBytesToProtect, ULONG NewAccessProtection, PULONG OldAccessProtection);
}

namespace Utils {
	namespace Registry //https://www.unknowncheats.me/forum/3108590-post2.html
	{
		ULONG GetKeyInfoSize(HANDLE hKey, PUNICODE_STRING Key);
		template <typename type>
		type ReadRegistry(UNICODE_STRING RegPath, UNICODE_STRING Key);
		bool WriteRegistry(UNICODE_STRING RegPath, UNICODE_STRING Key, PVOID Address, ULONG Type, ULONG Size);
		template<typename type>
		static type ReadRegistry(UNICODE_STRING RegPath, UNICODE_STRING Key)
		{
			HANDLE hKey;
			OBJECT_ATTRIBUTES ObjAttr;
			NTSTATUS Status = STATUS_UNSUCCESSFUL;

			InitializeObjectAttributes(&ObjAttr, &RegPath, OBJ_CASE_INSENSITIVE | OBJ_KERNEL_HANDLE, NULL, NULL);

			Status = ZwOpenKey(&hKey, KEY_ALL_ACCESS, &ObjAttr);

			if (NT_SUCCESS(Status))
			{
				ULONG KeyInfoSize = GetKeyInfoSize(hKey, &Key);
				ULONG KeyInfoSizeNeeded;

				if (KeyInfoSize == NULL)
				{
					ZwClose(hKey);
					return 0;
				}

				PKEY_VALUE_FULL_INFORMATION pKeyInfo = (PKEY_VALUE_FULL_INFORMATION)ExAllocatePool(NonPagedPool, KeyInfoSize);
				RtlZeroMemory(pKeyInfo, KeyInfoSize);

				Status = ZwQueryValueKey(hKey, &Key, KeyValueFullInformation, pKeyInfo, KeyInfoSize, &KeyInfoSizeNeeded);

				if (!NT_SUCCESS(Status) || (KeyInfoSize != KeyInfoSizeNeeded))
				{
					ZwClose(hKey);
					ExFreePoolWithTag(pKeyInfo, 0);
					return 0;
				}

				ZwClose(hKey);
				ExFreePoolWithTag(pKeyInfo, 0);

				return *(type*)((LONG64)pKeyInfo + pKeyInfo->DataOffset);
			}

			return 0;
		}
	}
	//Defaults:
	//const bool bCheckMask(PCHAR base, PCHAR pattern, PCHAR mask);
	//const UINT64 FindPattern(const UINT64 dwAddress, const UINT dwLen, const PCHAR bMask, const PCHAR szMask);
	PLDR_DATA_TABLE_ENTRY GetModuleByName(PEPROCESS process, PWCHAR moduleName);
	//Physical Memory:
	namespace PhysicalMemory { //https://www.unknowncheats.me/forum/anti-cheat-bypass/444289-read-process-physical-memory-attach.html
		const DWORD GetUserDirectoryTableBaseOffset();
		const UINT64 GetProcessCr3(const PEPROCESS pProcess);
		const UINT64 GetKernelDirBase();
		const UINT64 TranslateLinearAddress(UINT64 directoryTableBase, UINT64 virtualAddress);
		NTSTATUS ReadVirtual(UINT64 dirbase, UINT64 address, UINT8* buffer, SIZE_T size, SIZE_T* read);
		NTSTATUS WriteVirtual(UINT64 dirbase, UINT64 address, UINT8* buffer, SIZE_T size, SIZE_T* written);
		NTSTATUS ReadPhysicalAddress(PVOID TargetAddress, PVOID lpBuffer, SIZE_T Size, SIZE_T* BytesRead);
		NTSTATUS WritePhysicalAddress(PVOID TargetAddress, PVOID lpBuffer, SIZE_T Size, SIZE_T* BytesWritten);
	}
	//Protection:

}

```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/kernel.inf`:

```inf
;
; kernel.inf
;

[Version]
Signature="$WINDOWS NT$"
Class=Sample ; TODO: edit Class
ClassGuid={78A1C341-4539-11d3-B88D-00C04FAD5171} ; TODO: edit ClassGuid
Provider=%ManufacturerName%
CatalogFile=kernel.cat
DriverVer= ; TODO: set DriverVer in stampinf property pages
PnpLockDown=1

[DestinationDirs]
DefaultDestDir = 12
kernel_Device_CoInstaller_CopyFiles = 11

; ================= Class section =====================

[ClassInstall32]
Addreg=SampleClassReg

[SampleClassReg]
HKR,,,0,%ClassName%
HKR,,Icon,,-5

[SourceDisksNames]
1 = %DiskName%,,,""

[SourceDisksFiles]
kernel.sys  = 1,,
WdfCoInstaller$KMDFCOINSTALLERVERSION$.dll=1 ; make sure the number matches with SourceDisksNames

;*****************************************
; Install Section
;*****************************************

[Manufacturer]
%ManufacturerName%=Standard,NT$ARCH$

[Standard.NT$ARCH$]
%kernel.DeviceDesc%=kernel_Device, Root\kernel ; TODO: edit hw-id

[kernel_Device.NT]
CopyFiles=Drivers_Dir

[Drivers_Dir]
kernel.sys

;-------------- Service installation
[kernel_Device.NT.Services]
AddService = kernel,%SPSVCINST_ASSOCSERVICE%, kernel_Service_Inst

; -------------- kernel driver install sections
[kernel_Service_Inst]
DisplayName    = %kernel.SVCDESC%
ServiceType    = 1               ; SERVICE_KERNEL_DRIVER
StartType      = 3               ; SERVICE_DEMAND_START
ErrorControl   = 1               ; SERVICE_ERROR_NORMAL
ServiceBinary  = %12%\kernel.sys

;
;--- kernel_Device Coinstaller installation ------
;

[kernel_Device.NT.CoInstallers]
AddReg=kernel_Device_CoInstaller_AddReg
CopyFiles=kernel_Device_CoInstaller_CopyFiles

[kernel_Device_CoInstaller_AddReg]
HKR,,CoInstallers32,0x00010000, "WdfCoInstaller$KMDFCOINSTALLERVERSION$.dll,WdfCoInstaller"

[kernel_Device_CoInstaller_CopyFiles]
WdfCoInstaller$KMDFCOINSTALLERVERSION$.dll

[kernel_Device.NT.Wdf]
KmdfService =  kernel, kernel_wdfsect
[kernel_wdfsect]
KmdfLibraryVersion = $KMDFVERSION$

[Strings]
SPSVCINST_ASSOCSERVICE= 0x00000002
ManufacturerName="<Your manufacturer name>" ;TODO: Replace with your manufacturer name
ClassName="Samples" ; TODO: edit ClassName
DiskName = "kernel Installation Disk"
kernel.DeviceDesc = "kernel Device"
kernel.SVCDESC = "kernel Service"

```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/kernel.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="12.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Debug|Win32">
      <Configuration>Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|Win32">
      <Configuration>Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|x64">
      <Configuration>Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|ARM">
      <Configuration>Debug</Configuration>
      <Platform>ARM</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|ARM">
      <Configuration>Release</Configuration>
      <Platform>ARM</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|ARM64">
      <Configuration>Debug</Configuration>
      <Platform>ARM64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|ARM64">
      <Configuration>Release</Configuration>
      <Platform>ARM64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <ProjectGuid>{A0EDB9A2-26D0-45CA-8F7D-D881C768E4D9}</ProjectGuid>
    <TemplateGuid>{1bc93793-694f-48fe-9372-81e2b05556fd}</TemplateGuid>
    <TargetFrameworkVersion>v4.5</TargetFrameworkVersion>
    <MinimumVisualStudioVersion>12.0</MinimumVisualStudioVersion>
    <Configuration>Debug</Configuration>
    <Platform Condition="'$(Platform)' == ''">Win32</Platform>
    <RootNamespace>kernel</RootNamespace>
    <WindowsTargetPlatformVersion>$(LatestTargetPlatformVersion)</WindowsTargetPlatformVersion>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
    <Driver_SpectreMitigation>Spectre</Driver_SpectreMitigation>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM64'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM64'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="ExtensionSettings">
  </ImportGroup>
  <ImportGroup Label="PropertySheets">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <PropertyGroup Label="UserMacros" />
  <PropertyGroup />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
    <EnableInf2cat>false</EnableInf2cat>
    <TargetName>Deruta Nigger Pasted</TargetName>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <ClCompile>
      <SuppressStartupBanner>false</SuppressStartupBanner>
    </ClCompile>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <ClCompile>
      <TreatWarningAsError>false</TreatWarningAsError>
      <BufferSecurityCheck>false</BufferSecurityCheck>
      <LanguageStandard>Default</LanguageStandard>
    </ClCompile>
    <Link>
      <EntryPointSymbol>DriversMaain</EntryPointSymbol>
    </Link>
  </ItemDefinitionGroup>
  <ItemGroup>
    <FilesToPackage Include="$(TargetPath)" />
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="CallbackHandler.cpp" />
    <ClCompile Include="DriverMain.cpp" />
    <ClCompile Include="Utils.cpp" />
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="CallbackHandler.h" />
    <ClInclude Include="stdafx.h" />
    <ClInclude Include="Utils.h" />
  </ItemGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <ImportGroup Label="ExtensionTargets">
  </ImportGroup>
</Project>
```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/kernel.vcxproj.filters`:

```filters
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <Filter Include="Source Files">
      <UniqueIdentifier>{4FC737F1-C7A5-4376-A066-2A32D752A2FF}</UniqueIdentifier>
      <Extensions>cpp;c;cc;cxx;def;odl;idl;hpj;bat;asm;asmx</Extensions>
    </Filter>
    <Filter Include="Header Files">
      <UniqueIdentifier>{93995380-89BD-4b04-88EB-625FBE52EBFB}</UniqueIdentifier>
      <Extensions>h;hpp;hxx;hm;inl;inc;xsd</Extensions>
    </Filter>
    <Filter Include="Resource Files">
      <UniqueIdentifier>{67DA6AB6-F800-4c08-8B7A-83BB121AAD01}</UniqueIdentifier>
      <Extensions>rc;ico;cur;bmp;dlg;rc2;rct;bin;rgs;gif;jpg;jpeg;jpe;resx;tiff;tif;png;wav;mfcribbon-ms</Extensions>
    </Filter>
    <Filter Include="Handler">
      <UniqueIdentifier>{687f9b15-2f0d-414f-b596-b8bfe7af80f6}</UniqueIdentifier>
    </Filter>
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="DriverMain.cpp">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="CallbackHandler.cpp">
      <Filter>Handler</Filter>
    </ClCompile>
    <ClCompile Include="Utils.cpp">
      <Filter>Source Files</Filter>
    </ClCompile>
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="stdafx.h">
      <Filter>Header Files</Filter>
    </ClInclude>
    <ClInclude Include="Utils.h">
      <Filter>Header Files</Filter>
    </ClInclude>
    <ClInclude Include="CallbackHandler.h">
      <Filter>Handler</Filter>
    </ClInclude>
  </ItemGroup>
</Project>
```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/kernel.vcxproj.user`:

```user
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="Current" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <SignMode>Off</SignMode>
    <DebuggerFlavor>WindowsLocalDebugger</DebuggerFlavor>
  </PropertyGroup>
</Project>
```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/stdafx.h`:

```h
#pragma once
#pragma warning( disable : 4099 )

#include <ntdef.h>
#include <ntifs.h>
#include <ntddk.h>
#include <windef.h>
#include <wdf.h>
#include <ntimage.h>
#include <intrin.h>

#include "Utils.h"
#include "CallbackHandler.h"

```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/x64/Release/Deruta Nigger Pasted.sys.recipe`:

```recipe
<?xml version="1.0" encoding="utf-8"?>
<Project>
  <ProjectOutputs>
    <ProjectOutput>
      <FullPath>C:\Users\epic\Desktop\Shared-FlushFileBuffers-Communication-main\x64\Release\Deruta Nigger Pasted.sys</FullPath>
    </ProjectOutput>
  </ProjectOutputs>
  <ContentFiles />
  <SatelliteDlls />
  <NonRecipeFileRefs />
</Project>
```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/x64/Release/kernel.log`:

```log
  Building 'kernel' with toolset 'WindowsKernelModeDriver10.0' and the 'Universal' target platform.
  Microsoft(R) C/C++ Optimizing Compiler Version 19.33.31631 for x64
  Copyright (C) Microsoft Corporation.  All rights reserved.
  cl /c /Ix64\Release\ /Zi /W4 /WX- /diagnostics:column /Ox /Os /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D _WIN32_WINNT=0x0A00 /D WINVER=0x0A00 /D WINNT=1 /D NTDDI_VERSION=0xA00000C /D KMDF_VERSION_MAJOR=1 /D KMDF_VERSION_MINOR=15 /GF /Gm- /Zp8 /GS- /guard:cf /Gy /fp:precise /Qspectre /Zc:wchar_t- /Zc:forScope /Zc:inline /GR- /Fo"x64\Release\\" /Fd"x64\Release\vc143.pdb" /external:W4 /Gz /wd4603 /wd4627 /wd4986 /wd4987 /FI"C:\Program Files (x86)\Windows Kits\10\Include\10.0.22621.0\shared\warning.h" /FC /errorReport:prompt /kernel -cbstring -d2epilogunwind  /d1nodatetime /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+ CallbackHandler.cpp DriverMain.cpp Utils.cpp
  CallbackHandler.cpp
C:\Users\epic\Desktop\Shared-FlushFileBuffers-Communication-main\kernel\Utils.h(77,3): warning C4211: 非標準の拡張機能が使用されています: extern が static に再定義されました。
C:\Users\epic\Desktop\Shared-FlushFileBuffers-Communication-main\kernel\CallbackHandler.cpp(31,24): warning C4018: '<': signed と unsigned の数値を比較しようとしました。
C:\Users\epic\Desktop\Shared-FlushFileBuffers-Communication-main\kernel\CallbackHandler.cpp(83,23): warning C4018: '<': signed と unsigned の数値を比較しようとしました。
  DriverMain.cpp
C:\Users\epic\Desktop\Shared-FlushFileBuffers-Communication-main\kernel\Utils.h(77,3): warning C4211: 非標準の拡張機能が使用されています: extern が static に再定義されました。
C:\Users\epic\Desktop\Shared-FlushFileBuffers-Communication-main\kernel\DriverMain.cpp(78,52): warning C4100: 'dwSize': 引数は関数の本体部で 1 度も参照されません。
C:\Users\epic\Desktop\Shared-FlushFileBuffers-Communication-main\kernel\DriverMain.cpp(78,29): warning C4100: 'lpBaseAddress': 引数は関数の本体部で 1 度も参照されません。
C:\Users\epic\Desktop\Shared-FlushFileBuffers-Communication-main\kernel\Utils.h(97,73): warning C4996: 'ExAllocatePool': ExAllocatePool is deprecated, use ExAllocatePool2.
C:\Users\epic\Desktop\Shared-FlushFileBuffers-Communication-main\kernel\DriverMain.cpp(54): message : コンパイル対象の関数 テンプレート インスタンス化 'type Utils::Registry::ReadRegistry<LONG64>(UNICODE_STRING,UNICODE_STRING)' のリファレンスを確認してください
          with
          [
              type=LONG64
          ]
  Utils.cpp
C:\Users\epic\Desktop\Shared-FlushFileBuffers-Communication-main\kernel\Utils.h(77,3): warning C4211: 非標準の拡張機能が使用されています: extern が static に再定義されました。
  コードを生成中...
C:\Users\epic\Desktop\Shared-FlushFileBuffers-Communication-main\kernel\DriverMain.cpp(23): warning C4739: 変数 'time' への参照はそのストレージ領域を超えています
C:\Users\epic\Desktop\Shared-FlushFileBuffers-Communication-main\kernel\CallbackHandler.cpp(105): warning C4702: 制御が渡らないコードです。
C:\Users\epic\Desktop\Shared-FlushFileBuffers-Communication-main\kernel\CallbackHandler.cpp(52): warning C4702: 制御が渡らないコードです。
  kernel.vcxproj -> C:\Users\epic\Desktop\Shared-FlushFileBuffers-Communication-main\x64\Release\Deruta Nigger Pasted.sys
  Driver is 'Universal'.

```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/x64/Release/kernel.sys.recipe`:

```recipe
<?xml version="1.0" encoding="utf-8"?>
<Project>
  <ProjectOutputs>
    <ProjectOutput>
      <FullPath>C:\Users\epic\Desktop\Shared-FlushFileBuffers-Communication-main\x64\Release\kernel.sys</FullPath>
    </ProjectOutput>
  </ProjectOutputs>
  <ContentFiles />
  <SatelliteDlls />
  <NonRecipeFileRefs />
</Project>
```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/x64/Release/kernel.tlog/CL.command.1.tlog`:

```tlog
^C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\DRIVERMAIN.CPP
/c /IX64\RELEASE\ /Zi /W4 /WX- /diagnostics:column /Ox /Os /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D _WIN32_WINNT=0x0A00 /D WINVER=0x0A00 /D WINNT=1 /D NTDDI_VERSION=0xA00000C /D KMDF_VERSION_MAJOR=1 /D KMDF_VERSION_MINOR=15 /GF /Gm- /Zp8 /GS- /guard:cf /Gy /fp:precise /Qspectre /Zc:wchar_t- /Zc:forScope /Zc:inline /GR- /Fo"X64\RELEASE\\" /Fd"X64\RELEASE\VC143.PDB" /external:W4 /Gz /wd4603 /wd4627 /wd4986 /wd4987 /FI"C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\WARNING.H" /FC /kernel -cbstring -d2epilogunwind  /d1nodatetime /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\DRIVERMAIN.CPP
^C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\UTILS.CPP
/c /IX64\RELEASE\ /Zi /W4 /WX- /diagnostics:column /Ox /Os /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D _WIN32_WINNT=0x0A00 /D WINVER=0x0A00 /D WINNT=1 /D NTDDI_VERSION=0xA00000C /D KMDF_VERSION_MAJOR=1 /D KMDF_VERSION_MINOR=15 /GF /Gm- /Zp8 /GS- /guard:cf /Gy /fp:precise /Qspectre /Zc:wchar_t- /Zc:forScope /Zc:inline /GR- /Fo"X64\RELEASE\\" /Fd"X64\RELEASE\VC143.PDB" /external:W4 /Gz /wd4603 /wd4627 /wd4986 /wd4987 /FI"C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\WARNING.H" /FC /kernel -cbstring -d2epilogunwind  /d1nodatetime /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\UTILS.CPP
^C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\CALLBACKHANDLER.CPP
/c /IX64\RELEASE\ /Zi /W4 /WX- /diagnostics:column /Ox /Os /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D _WIN32_WINNT=0x0A00 /D WINVER=0x0A00 /D WINNT=1 /D NTDDI_VERSION=0xA00000C /D KMDF_VERSION_MAJOR=1 /D KMDF_VERSION_MINOR=15 /GF /Gm- /Zp8 /GS- /guard:cf /Gy /fp:precise /Qspectre /Zc:wchar_t- /Zc:forScope /Zc:inline /GR- /Fo"X64\RELEASE\\" /Fd"X64\RELEASE\VC143.PDB" /external:W4 /Gz /wd4603 /wd4627 /wd4986 /wd4987 /FI"C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\WARNING.H" /FC /kernel -cbstring -d2epilogunwind  /d1nodatetime /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\CALLBACKHANDLER.CPP

```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/x64/Release/kernel.tlog/CL.read.1.tlog`:

```tlog
^C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\CALLBACKHANDLER.CPP
C:\WINDOWS\GLOBALIZATION\SORTING\SORTDEFAULT.NLS
C:\PROGRAM FILES\MICROSOFT VISUAL STUDIO\2022\COMMUNITY\VC\TOOLS\MSVC\14.33.31629\BIN\HOSTX64\X64\1041\CLUI.DLL
C:\WINDOWS\SYSTEM32\TZRES.DLL
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SUPPRESS.H
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\STDAFX.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\VADEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\WINPACKAGEFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\WINDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\MINWINDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFGLOBALS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFFUNCENUM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFASSERT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFVERIFIER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFPOOL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFOBJECT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFSYNC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFCORE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFDRIVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFQUERYINTERFACE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFMEMORY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFCHILDLIST.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFFILEOBJECT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFDEVICE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\WDMSEC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFCOLLECTION.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFDPC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFTIMER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFWORKITEM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFINTERRUPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFRESOURCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFREQUEST.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFIOTARGET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFIO.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFFDO.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFPDO.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFCONTROL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFWMI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFSTRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFREGISTRY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFDMAENABLER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFDMATRANSACTION.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFCOMMONBUFFER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFBUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFROLETYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFHWACCESS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\NTIMAGE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\PSHPACK2.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\PSHPACK8.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\ZMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\AMMINTRIN.H
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\UTILS.H
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\CALLBACKHANDLER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\UCRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\UCRT\CORECRT.H
C:\PROGRAM FILES (X86)\MICROSOFT VISUAL STUDIO\2019\COMMUNITY\VC\TOOLS\MSVC\14.29.30133\INCLUDE\VCRUNTIME.H
C:\PROGRAM FILES (X86)\MICROSOFT VISUAL STUDIO\2019\COMMUNITY\VC\TOOLS\MSVC\14.29.30133\INCLUDE\SAL.H
C:\PROGRAM FILES (X86)\MICROSOFT VISUAL STUDIO\2019\COMMUNITY\VC\TOOLS\MSVC\14.29.30133\INCLUDE\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\MICROSOFT VISUAL STUDIO\2019\COMMUNITY\VC\TOOLS\MSVC\14.29.30133\INCLUDE\VADEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\UCRT\CORECRT_WCTYPE.H
^C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\DRIVERMAIN.CPP
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SUPPRESS.H
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\STDAFX.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\VADEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\WINPACKAGEFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\WINDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\MINWINDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFGLOBALS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFFUNCENUM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFASSERT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFVERIFIER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFPOOL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFOBJECT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFSYNC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFCORE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFDRIVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFQUERYINTERFACE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFMEMORY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFCHILDLIST.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFFILEOBJECT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFDEVICE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\WDMSEC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFCOLLECTION.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFDPC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFTIMER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFWORKITEM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFINTERRUPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFRESOURCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFREQUEST.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFIOTARGET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFIO.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFFDO.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFPDO.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFCONTROL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFWMI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFSTRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFREGISTRY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFDMAENABLER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFDMATRANSACTION.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFCOMMONBUFFER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFBUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFROLETYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFHWACCESS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\NTIMAGE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\PSHPACK2.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\PSHPACK8.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\ZMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\AMMINTRIN.H
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\UTILS.H
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\CALLBACKHANDLER.H
^C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\UTILS.CPP
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SUPPRESS.H
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\STDAFX.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\VADEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\WINPACKAGEFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\WINDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\MINWINDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFGLOBALS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFFUNCENUM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFASSERT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFVERIFIER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFPOOL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFOBJECT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFSYNC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFCORE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFDRIVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFQUERYINTERFACE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFMEMORY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFCHILDLIST.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFFILEOBJECT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFDEVICE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\WDMSEC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFCOLLECTION.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFDPC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFTIMER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFWORKITEM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFINTERRUPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFRESOURCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFREQUEST.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFIOTARGET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFIO.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFFDO.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFPDO.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFCONTROL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFWMI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFSTRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFREGISTRY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFDMAENABLER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFDMATRANSACTION.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFCOMMONBUFFER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFBUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFROLETYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\WDF\KMDF\1.15\WDFHWACCESS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\NTIMAGE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\PSHPACK2.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\SHARED\PSHPACK8.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\ZMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.22621.0\KM\CRT\AMMINTRIN.H
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\UTILS.H
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\CALLBACKHANDLER.H

```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/x64/Release/kernel.tlog/CL.write.1.tlog`:

```tlog
^C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\CALLBACKHANDLER.CPP|C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\DRIVERMAIN.CPP|C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\UTILS.CPP
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\VC143.PDB
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\UTILS.OBJ
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\DRIVERMAIN.OBJ
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\VC142.PDB
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\CALLBACKHANDLER.OBJ
^C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\CALLBACKHANDLER.CPP|C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\UTILS.CPP
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\VC143.PDB
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\UTILS.OBJ
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\CALLBACKHANDLER.OBJ
^C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\CALLBACKHANDLER.CPP
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\VC143.PDB
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\CALLBACKHANDLER.OBJ
^C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\DRIVERMAIN.CPP
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\VC143.PDB
^C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\UTILS.CPP
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\VC143.PDB

```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/x64/Release/kernel.tlog/kernel.lastbuildstate`:

```lastbuildstate
PlatformToolSet=WindowsKernelModeDriver10.0:VCToolArchitecture=Native64Bit:VCToolsVersion=14.33.31629:TargetPlatformVersion=10.0.22621.0:
Release|x64|C:\Users\epic\Desktop\Shared-FlushFileBuffers-Communication-main\|

```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/x64/Release/kernel.tlog/link.command.1.tlog`:

```tlog
^C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\CALLBACKHANDLER.OBJ|C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\DRIVERMAIN.OBJ|C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\UTILS.OBJ
/OUT:"C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\X64\RELEASE\DERUTA NIGGER PASTED.SYS" /VERSION:"10.0" /INCREMENTAL:NO /NOLOGO /WX /SECTION:"INIT,d" "C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.22621.0\KM\X64\BUFFEROVERFLOWFASTFAILK.LIB" "C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.22621.0\KM\X64\NTOSKRNL.LIB" "C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.22621.0\KM\X64\HAL.LIB" "C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.22621.0\KM\X64\WMILIB.LIB" "C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\WDF\KMDF\X64\1.15\WDFLDR.LIB" "C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\WDF\KMDF\X64\1.15\WDFDRIVERENTRY.LIB" /NODEFAULTLIB /MANIFEST:NO /DEBUG /PDB:"C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\X64\RELEASE\DERUTA NIGGER PASTED.PDB" /SUBSYSTEM:NATIVE,"10.00" /Driver /OPT:REF /OPT:ICF /ENTRY:"DriversMaain" /RELEASE /IMPLIB:"C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\X64\RELEASE\DERUTA NIGGER PASTED.LIB" /MERGE:"_TEXT=.text;_PAGE=PAGE" /MACHINE:X64 /PROFILE /guard:cf /kernel /IGNORE:4198,4010,4037,4039,4065,4070,4078,4087,4089,4221,4108,4088,4218,4218,4235 /osversion:10.0 /pdbcompress /debugtype:pdata X64\RELEASE\CALLBACKHANDLER.OBJ
X64\RELEASE\DRIVERMAIN.OBJ
X64\RELEASE\UTILS.OBJ

```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/x64/Release/kernel.tlog/link.read.1.tlog`:

```tlog
^C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\CALLBACKHANDLER.OBJ|C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\DRIVERMAIN.OBJ|C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\UTILS.OBJ
C:\WINDOWS\SYSTEM32\C_932.NLS
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.22621.0\KM\X64\BUFFEROVERFLOWFASTFAILK.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.22621.0\KM\X64\NTOSKRNL.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.22621.0\KM\X64\HAL.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.22621.0\KM\X64\WMILIB.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\WDF\KMDF\X64\1.15\WDFLDR.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\WDF\KMDF\X64\1.15\WDFDRIVERENTRY.LIB
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\CALLBACKHANDLER.OBJ
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\DRIVERMAIN.OBJ
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\UTILS.OBJ
C:\WINDOWS\GLOBALIZATION\SORTING\SORTDEFAULT.NLS
C:\WINDOWS\SYSTEM32\TZRES.DLL
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\VC143.PDB
C:\PROGRAM FILES\MICROSOFT VISUAL STUDIO\2022\COMMUNITY\VC\TOOLS\MSVC\14.33.31629\BIN\HOSTX64\X64\VCTIP.EXE

```

`UCFoxi-Shared-FlushFileBuffers-Communication-Update/kernel/x64/Release/kernel.tlog/link.write.1.tlog`:

```tlog
^C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\CALLBACKHANDLER.OBJ|C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\DRIVERMAIN.OBJ|C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\KERNEL\X64\RELEASE\UTILS.OBJ
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\X64\RELEASE\KERNEL.SYS
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\X64\RELEASE\DERUTA NIGGER PASTED.SYS
C:\USERS\EPIC\DESKTOP\SHARED-FLUSHFILEBUFFERS-COMMUNICATION-MAIN\X64\RELEASE\DERUTA NIGGER PASTED.PDB

```