Project Path: arc_gmh5225_shellcode-EntropyFix_lf09hiqk

Source Tree:

```txt
arc_gmh5225_shellcode-EntropyFix_lf09hiqk
├── Entropy
│   ├── Entropy.vcxproj
│   ├── Entropy.vcxproj.filters
│   ├── Entropy.vcxproj.user
│   ├── entropy.c
│   ├── entropy.h
│   └── main.c
├── Entropy.sln
├── README.md
└── images
    ├── Reduced_Entropy.png
    ├── original.png
    └── usage.png

```

`Entropy.sln`:

```sln

Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio Version 17
VisualStudioVersion = 17.1.32421.90
MinimumVisualStudioVersion = 10.0.40219.1
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "Entropy", "Entropy\Entropy.vcxproj", "{7C90DE2B-8744-4D95-A531-3B249E3DABED}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|x64 = Debug|x64
		Debug|x86 = Debug|x86
		Release|x64 = Release|x64
		Release|x86 = Release|x86
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{7C90DE2B-8744-4D95-A531-3B249E3DABED}.Debug|x64.ActiveCfg = Debug|x64
		{7C90DE2B-8744-4D95-A531-3B249E3DABED}.Debug|x64.Build.0 = Debug|x64
		{7C90DE2B-8744-4D95-A531-3B249E3DABED}.Debug|x86.ActiveCfg = Debug|Win32
		{7C90DE2B-8744-4D95-A531-3B249E3DABED}.Debug|x86.Build.0 = Debug|Win32
		{7C90DE2B-8744-4D95-A531-3B249E3DABED}.Release|x64.ActiveCfg = Release|x64
		{7C90DE2B-8744-4D95-A531-3B249E3DABED}.Release|x64.Build.0 = Release|x64
		{7C90DE2B-8744-4D95-A531-3B249E3DABED}.Release|x86.ActiveCfg = Release|Win32
		{7C90DE2B-8744-4D95-A531-3B249E3DABED}.Release|x86.Build.0 = Release|Win32
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
	GlobalSection(ExtensibilityGlobals) = postSolution
		SolutionGuid = {F7F8A248-5657-4E2C-8868-96ABDFFD615C}
	EndGlobalSection
EndGlobal

```

`Entropy/Entropy.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Debug|Win32">
      <Configuration>Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|Win32">
      <Configuration>Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|x64">
      <Configuration>Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <VCProjectVersion>16.0</VCProjectVersion>
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{7c90de2b-8744-4d95-a531-3b249e3dabed}</ProjectGuid>
    <RootNamespace>Entropy</RootNamespace>
    <WindowsTargetPlatformVersion>10.0</WindowsTargetPlatformVersion>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="ExtensionSettings">
  </ImportGroup>
  <ImportGroup Label="Shared">
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <PropertyGroup Label="UserMacros" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <LinkIncremental>true</LinkIncremental>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <LinkIncremental>false</LinkIncremental>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <LinkIncremental>true</LinkIncremental>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <LinkIncremental>false</LinkIncremental>
  </PropertyGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>WIN32;_DEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <IntrinsicFunctions>true</IntrinsicFunctions>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>WIN32;NDEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <EnableCOMDATFolding>true</EnableCOMDATFolding>
      <OptimizeReferences>true</OptimizeReferences>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>_DEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <IntrinsicFunctions>true</IntrinsicFunctions>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>NDEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <EnableCOMDATFolding>true</EnableCOMDATFolding>
      <OptimizeReferences>true</OptimizeReferences>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemGroup>
    <ClCompile Include="entropy.c" />
    <ClCompile Include="main.c" />
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="entropy.h" />
  </ItemGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <ImportGroup Label="ExtensionTargets">
  </ImportGroup>
</Project>
```

`Entropy/Entropy.vcxproj.filters`:

```filters
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <Filter Include="Source Files">
      <UniqueIdentifier>{4FC737F1-C7A5-4376-A066-2A32D752A2FF}</UniqueIdentifier>
      <Extensions>cpp;c;cc;cxx;c++;cppm;ixx;def;odl;idl;hpj;bat;asm;asmx</Extensions>
    </Filter>
    <Filter Include="Header Files">
      <UniqueIdentifier>{93995380-89BD-4b04-88EB-625FBE52EBFB}</UniqueIdentifier>
      <Extensions>h;hh;hpp;hxx;h++;hm;inl;inc;ipp;xsd</Extensions>
    </Filter>
    <Filter Include="Resource Files">
      <UniqueIdentifier>{67DA6AB6-F800-4c08-8B7A-83BB121AAD01}</UniqueIdentifier>
      <Extensions>rc;ico;cur;bmp;dlg;rc2;rct;bin;rgs;gif;jpg;jpeg;jpe;resx;tiff;tif;png;wav;mfcribbon-ms</Extensions>
    </Filter>
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="main.c">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="entropy.c">
      <Filter>Source Files</Filter>
    </ClCompile>
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="entropy.h">
      <Filter>Header Files</Filter>
    </ClInclude>
  </ItemGroup>
</Project>
```

`Entropy/Entropy.vcxproj.user`:

```user
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="Current" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup />
</Project>
```

`Entropy/entropy.c`:

```c
#include <Windows.h>
#include <stdio.h>

// DO NOT CHANGE [NewPayloadSize equation is based on these values]
#define NULL_CHUNKSIZE	5
#define PAYLOADCHUNK	10


PBYTE ReduceEntropy (unsigned char* Payload, SIZE_T PayloadSize, SIZE_T* pNewPayloadSize) {
	
	unsigned int	Loop			= PayloadSize / PAYLOADCHUNK;
	unsigned int	Remainder		= PayloadSize % NULL_CHUNKSIZE;
	unsigned int	NewPayloadSize  = (3 * PayloadSize ) / 2;		

	unsigned char*	NewPayload		= (unsigned char*)malloc(NewPayloadSize + Remainder);
	if (NewPayload == NULL)
		return NULL;
	//printf("[i] NewPayload : [ 0x%p ]  [ %d ] \n", NewPayload, NewPayloadSize);

	ZeroMemory(NewPayload, NewPayloadSize + Remainder);


	unsigned int NPcntr = 0, OPcntr = 0;

	for (size_t z = 0; z < Loop; z++){

		for (size_t i = 0; i < PAYLOADCHUNK; i++) {
			NewPayload[NPcntr] = Payload[OPcntr];
			NPcntr++;
			OPcntr++;
		}
		for (size_t j = 0; j < NULL_CHUNKSIZE; j++){
			NewPayload[NPcntr] = 0x00;
			NPcntr++;
		}
	}

	if (Remainder > 0) {
		for (size_t i = 0; i != Remainder; i++){
			NewPayload[NPcntr] = Payload[OPcntr];
			NPcntr++;
			OPcntr++;
		}
	}

	*pNewPayloadSize = NewPayloadSize;
	return (PBYTE)NewPayload;
}



PBYTE ReverseEntropy(unsigned char* Payload, SIZE_T PayloadSize, SIZE_T* pNewPayloadSize) {
	
	
	unsigned int Remainder			= PayloadSize % NULL_CHUNKSIZE;
	unsigned int NewPayloadSize		= ((PayloadSize / 3) * 2);
	unsigned int Loop				= NewPayloadSize / PAYLOADCHUNK;
	
	unsigned char* NewPayload		= (unsigned char*)malloc(NewPayloadSize + Remainder);
	if (NewPayload == NULL)
		return NULL;

	//printf("[i] NewPayload : [ 0x%p ]  [ %d ] \n", NewPayload, NewPayloadSize);
	ZeroMemory(NewPayload, NewPayloadSize + Remainder);
	unsigned int NPcntr = 0, OPcntr = 0;

	for (size_t i = 0; i < Loop; i++){

		for (size_t j = 0; j < PAYLOADCHUNK; j++){
			NewPayload[NPcntr] = Payload[OPcntr];
			NPcntr++;
			OPcntr++;
		}

		for (size_t z = 0; z < NULL_CHUNKSIZE; z++)
		{
			OPcntr++; // ignoring 5 bytes
		}
	}


	
	if (Remainder > 0) {
		for (size_t i = 0; i != Remainder; i++) {
			NewPayload[NPcntr] = Payload[OPcntr];
			NPcntr++;
			OPcntr++;
		}
	}
	

	*pNewPayloadSize = NewPayloadSize;
	return NewPayload;
}
```

`Entropy/entropy.h`:

```h
#pragma once
#include <Windows.h>




PBYTE ReduceEntropy(unsigned char* Payload, SIZE_T PayloadSize, SIZE_T* NewPayloadSize);
PBYTE ReverseEntropy(unsigned char* Payload, SIZE_T PayloadSize, SIZE_T* pNewPayloadSize);

```

`Entropy/main.c`:

```c
// programmed by @ORCA 8/8/2022

#include <Windows.h>
#include <stdio.h>
#include "entropy.h"


#define FILE_NAME1 "ReducedEntropy.bin"
#define FILE_NAME2 "OriginalEntropy.bin"

// function to read the payload from disk
BOOL ReadPayloadFile(char* FileInput, PDWORD BytesNumber, unsigned char** PayloadRead) {

	HANDLE hFile = INVALID_HANDLE_VALUE;
	DWORD FileSize, lpNumberOfBytesRead;
	BOOL Succ;


	hFile = CreateFileA(FileInput, GENERIC_READ, 0, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_READONLY, NULL);
	if (hFile == INVALID_HANDLE_VALUE) {
		printf("[!] ERROR CreateFileA : %d\n", GetLastError());
		return FALSE;
	}

	FileSize = GetFileSize(hFile, NULL);
	unsigned char* Payload = (unsigned char*)malloc(FileSize);
	ZeroMemory(Payload, sizeof Payload);

	Succ = ReadFile(hFile, Payload, FileSize, &lpNumberOfBytesRead, NULL);
	if (!Succ) {
		printf("[!] ERROR ReadFile : %d\n", GetLastError());
		return FALSE;
	}
#if DEBUG
	printf("[i] Input Size : [ %d ] ; at [ 0x%p ] \n", lpNumberOfBytesRead, Payload);
#endif // DEBUG

	*PayloadRead = Payload;
	*BytesNumber = lpNumberOfBytesRead;

	CloseHandle(hFile);
	
	if (*PayloadRead == NULL || *BytesNumber == NULL)
		return FALSE;


	return TRUE;
}

// function to write the payload to disk
BOOL WritePayloadFile(PBYTE pData, SIZE_T FileSize, int Type) {
	
	HANDLE hFile = INVALID_HANDLE_VALUE;
	char NewFileName[MAX_PATH] ;

	if (Type == 1)
		sprintf_s(NewFileName, MAX_PATH, "%s", FILE_NAME1);
	else
		sprintf_s(NewFileName, MAX_PATH, "%s", FILE_NAME2);

	hFile = CreateFileA(NewFileName, GENERIC_WRITE, 0, NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);
	if (hFile == INVALID_HANDLE_VALUE) {
		printf("[!] ERROR CreateFileA : %d\n", GetLastError());
		return FALSE;
	}
	
	if (!WriteFile(hFile, pData, FileSize, NULL, NULL)) {
		printf("[!] ERROR WriteFile : %d\n", GetLastError());
		return FALSE;
	}

#if DEBUG
	printf("[i] Output Size : [ %d ] ; at [ 0x%p ] \n", FileSize, pData);
#endif // DEBUG

	
	free(pData);
	
	CloseHandle(hFile);
	
	return TRUE;
}

// entry point:


int main(int argc, char* argv[]) {

	if (argc != 3) {
		printf("[i] Usage: %s <input file> <*option>... \n", argv[0]);
		printf("[i] option can be: \n");
		printf("\t\t- 1 : Fix the entropy (reduce it) \n");
		printf("\t\t- 2 : Reverse the algorithm (restore to original) \n\n");
		return -1;

	}

	unsigned char* payload = { 0 };
	size_t payloadsize = 0;
	
	PBYTE NewPayload = NULL;
	SIZE_T NewPayloadSize = 0;



	if(!ReadPayloadFile(argv[1], &payloadsize, &payload)){
		return -1;
	}


	if (atoi(argv[2]) == 1) {
		NewPayload = ReduceEntropy(payload, payloadsize, &NewPayloadSize);
	}
	else if (atoi(argv[2]) == 2) {
		NewPayload = ReverseEntropy(payload, payloadsize, &NewPayloadSize);
#ifdef TEST
		PVOID pAddress = VirtualAlloc(NULL, NewPayloadSize, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
		memcpy(pAddress, NewPayload, NewPayloadSize);
		free(NewPayload);
		(*(void(*)()) pAddress)();
#endif //TEST
	}
	else{
		printf("[-] Please Enter -1- or -2- only \'%s\' is NOT valid .\n", argv[2]);
		return -1;
	}
	

	free(payload);

	if (!WritePayloadFile(NewPayload, NewPayloadSize, atoi(argv[2]))) {
		return -1;
	}


	printf("[+] File Outputted Successfully To %s \n" , atoi(argv[2]) != 2 ? FILE_NAME1 : FILE_NAME2);
#ifdef PAUSE
	printf("[#] Press <Enter> To Quit ... ");
	getchar();
#endif //PAUSE
	return 0;
}




/*

											// entropy: 5.883
				unsigned char payload[272] = {
					0xFC, 0x48, 0x83, 0xE4, 0xF0, 0xE8, 0xC0, 0x00, 0x00, 0x00, 0x41, 0x51,
					0x41, 0x50, 0x52, 0x51, 0x56, 0x48, 0x31, 0xD2, 0x65, 0x48, 0x8B, 0x52,
					0x60, 0x48, 0x8B, 0x52, 0x18, 0x48, 0x8B, 0x52, 0x20, 0x48, 0x8B, 0x72,
					0x50, 0x48, 0x0F, 0xB7, 0x4A, 0x4A, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0,
					0xAC, 0x3C, 0x61, 0x7C, 0x02, 0x2C, 0x20, 0x41, 0xC1, 0xC9, 0x0D, 0x41,
					0x01, 0xC1, 0xE2, 0xED, 0x52, 0x41, 0x51, 0x48, 0x8B, 0x52, 0x20, 0x8B,
					0x42, 0x3C, 0x48, 0x01, 0xD0, 0x8B, 0x80, 0x88, 0x00, 0x00, 0x00, 0x48,
					0x85, 0xC0, 0x74, 0x67, 0x48, 0x01, 0xD0, 0x50, 0x8B, 0x48, 0x18, 0x44,
					0x8B, 0x40, 0x20, 0x49, 0x01, 0xD0, 0xE3, 0x56, 0x48, 0xFF, 0xC9, 0x41,
					0x8B, 0x34, 0x88, 0x48, 0x01, 0xD6, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0,
					0xAC, 0x41, 0xC1, 0xC9, 0x0D, 0x41, 0x01, 0xC1, 0x38, 0xE0, 0x75, 0xF1,
					0x4C, 0x03, 0x4C, 0x24, 0x08, 0x45, 0x39, 0xD1, 0x75, 0xD8, 0x58, 0x44,
					0x8B, 0x40, 0x24, 0x49, 0x01, 0xD0, 0x66, 0x41, 0x8B, 0x0C, 0x48, 0x44,
					0x8B, 0x40, 0x1C, 0x49, 0x01, 0xD0, 0x41, 0x8B, 0x04, 0x88, 0x48, 0x01,
					0xD0, 0x41, 0x58, 0x41, 0x58, 0x5E, 0x59, 0x5A, 0x41, 0x58, 0x41, 0x59,
					0x41, 0x5A, 0x48, 0x83, 0xEC, 0x20, 0x41, 0x52, 0xFF, 0xE0, 0x58, 0x41,
					0x59, 0x5A, 0x48, 0x8B, 0x12, 0xE9, 0x57, 0xFF, 0xFF, 0xFF, 0x5D, 0x48,
					0xBA, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8D, 0x8D,
					0x01, 0x01, 0x00, 0x00, 0x41, 0xBA, 0x31, 0x8B, 0x6F, 0x87, 0xFF, 0xD5,
					0xBB, 0xE0, 0x1D, 0x2A, 0x0A, 0x41, 0xBA, 0xA6, 0x95, 0xBD, 0x9D, 0xFF,
					0xD5, 0x48, 0x83, 0xC4, 0x28, 0x3C, 0x06, 0x7C, 0x0A, 0x80, 0xFB, 0xE0,
					0x75, 0x05, 0xBB, 0x47, 0x13, 0x72, 0x6F, 0x6A, 0x00, 0x59, 0x41, 0x89,
					0xDA, 0xFF, 0xD5, 0x63, 0x61, 0x6C, 0x63, 0x00
				};


											// entropy: 4.660
				unsigned char NewPayload[407] = {
					0xFC, 0x48, 0x83, 0xE4, 0xF0, 0xE8, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x00,
					0x00, 0x00, 0x00, 0x41, 0x51, 0x41, 0x50, 0x52, 0x51, 0x56, 0x48, 0x31,
					0xD2, 0x00, 0x00, 0x00, 0x00, 0x00, 0x65, 0x48, 0x8B, 0x52, 0x60, 0x48,
					0x8B, 0x52, 0x18, 0x48, 0x00, 0x00, 0x00, 0x00, 0x00, 0x8B, 0x52, 0x20,
					0x48, 0x8B, 0x72, 0x50, 0x48, 0x0F, 0xB7, 0x00, 0x00, 0x00, 0x00, 0x00,
					0x4A, 0x4A, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0, 0xAC, 0x3C, 0x00, 0x00,
					0x00, 0x00, 0x00, 0x61, 0x7C, 0x02, 0x2C, 0x20, 0x41, 0xC1, 0xC9, 0x0D,
					0x41, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xC1, 0xE2, 0xED, 0x52, 0x41,
					0x51, 0x48, 0x8B, 0x52, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x8B, 0x42,
					0x3C, 0x48, 0x01, 0xD0, 0x8B, 0x80, 0x88, 0x00, 0x00, 0x00, 0x00, 0x00,
					0x00, 0x00, 0x00, 0x48, 0x85, 0xC0, 0x74, 0x67, 0x48, 0x01, 0x00, 0x00,
					0x00, 0x00, 0x00, 0xD0, 0x50, 0x8B, 0x48, 0x18, 0x44, 0x8B, 0x40, 0x20,
					0x49, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xD0, 0xE3, 0x56, 0x48, 0xFF,
					0xC9, 0x41, 0x8B, 0x34, 0x00, 0x00, 0x00, 0x00, 0x00, 0x88, 0x48, 0x01,
					0xD6, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x00,
					0xAC, 0x41, 0xC1, 0xC9, 0x0D, 0x41, 0x01, 0xC1, 0x38, 0xE0, 0x00, 0x00,
					0x00, 0x00, 0x00, 0x75, 0xF1, 0x4C, 0x03, 0x4C, 0x24, 0x08, 0x45, 0x39,
					0xD1, 0x00, 0x00, 0x00, 0x00, 0x00, 0x75, 0xD8, 0x58, 0x44, 0x8B, 0x40,
					0x24, 0x49, 0x01, 0xD0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x66, 0x41, 0x8B,
					0x0C, 0x48, 0x44, 0x8B, 0x40, 0x1C, 0x49, 0x00, 0x00, 0x00, 0x00, 0x00,
					0x01, 0xD0, 0x41, 0x8B, 0x04, 0x88, 0x48, 0x01, 0xD0, 0x41, 0x00, 0x00,
					0x00, 0x00, 0x00, 0x58, 0x41, 0x58, 0x5E, 0x59, 0x5A, 0x41, 0x58, 0x41,
					0x59, 0x00, 0x00, 0x00, 0x00, 0x00, 0x41, 0x5A, 0x48, 0x83, 0xEC, 0x20,
					0x41, 0x52, 0xFF, 0xE0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x58, 0x41, 0x59,
					0x5A, 0x48, 0x8B, 0x12, 0xE9, 0x57, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00,
					0xFF, 0xFF, 0x5D, 0x48, 0xBA, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
					0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8D, 0x8D, 0x01, 0x01, 0x00,
					0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x41, 0xBA, 0x31, 0x8B, 0x6F, 0x87,
					0xFF, 0xD5, 0xBB, 0xE0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1D, 0x2A, 0x0A,
					0x41, 0xBA, 0xA6, 0x95, 0xBD, 0x9D, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00,
					0xD5, 0x48, 0x83, 0xC4, 0x28, 0x3C, 0x06, 0x7C, 0x0A, 0x80, 0x00, 0x00,
					0x00, 0x00, 0x00, 0xFB, 0xE0, 0x75, 0x05, 0xBB, 0x47, 0x13, 0x72, 0x6F,
					0x6A, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x59, 0x41, 0x89, 0xDA, 0xFF,
					0xD5, 0x63, 0x61, 0x6C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x63, 0x00
				};

*/
```

`README.md`:

```md
#### EntropyFix: a tool to reduce the entropy of your payload, It works By adding null bytes, in an ordered sequence: every 10 bytes it adds 5 null bytes.


#### USAGE:
![img](https://gitlab.com/ORCA000/entropyfix/-/raw/main/images/usage.png)

#### DEMO: `Before`
![img1](https://gitlab.com/ORCA000/entropyfix/-/raw/main/images/original.png)

#### DEMO: `After`
![img2](https://gitlab.com/ORCA000/entropyfix/-/raw/main/images/Reduced_Entropy.png)



 

```