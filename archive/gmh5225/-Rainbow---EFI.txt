Project Path: arc_gmh5225_-Rainbow---EFI_2a2rw7x9

Source Tree:

```txt
arc_gmh5225_-Rainbow---EFI_2a2rw7x9
├── EDK-II
│   ├── BaseCacheMaintenanceLib
│   │   └── BaseCacheMaintenanceLib.vcxproj
│   ├── BaseCpuLib
│   │   └── BaseCpuLib.vcxproj
│   ├── BaseCryptLib
│   │   └── BaseCryptLib.vcxproj
│   ├── BaseDebugPrintErrorLevelLib
│   │   └── BaseDebugPrintErrorLevelLib.vcxproj
│   ├── BaseLib
│   │   ├── BaseLib.vcxproj
│   │   ├── vshacks.h
│   │   └── vshacks.nasm
│   ├── BaseMemoryLib
│   │   └── BaseMemoryLib.vcxproj
│   ├── BasePrintLib
│   │   └── BasePrintLib.vcxproj
│   ├── BaseSynchronizationLib
│   │   └── BaseSynchronizationLib.vcxproj
│   ├── EDK-II.sln
│   ├── GlueLib
│   │   ├── GlueLib.vcxproj
│   │   ├── guid.c
│   │   ├── initlib.c
│   │   └── pcd.c
│   ├── IntrinsicLib
│   │   └── IntrinsicLib.vcxproj
│   ├── MSBuild
│   │   ├── nasm.props
│   │   ├── nasm.targets
│   │   └── nasm.xml
│   ├── OpensslLib
│   │   └── OpensslLib.vcxproj
│   ├── UefiApplicationEntryPoint
│   │   └── UefiApplicationEntryPoint.vcxproj
│   ├── UefiBootServicesTableLib
│   │   └── UefiBootServicesTableLib.vcxproj
│   ├── UefiDebugLibConOut
│   │   └── UefiDebugLibConOut.vcxproj
│   ├── UefiDevicePathLibDevicePathProtocol
│   │   └── UefiDevicePathLibDevicePathProtocol.vcxproj
│   ├── UefiDriverEntryPoint
│   │   └── UefiDriverEntryPoint.vcxproj
│   ├── UefiFileHandleLib
│   │   └── UefiFileHandleLib.vcxproj
│   ├── UefiHiiLib
│   │   └── UefiHiiLib.vcxproj
│   ├── UefiHiiServicesLib
│   │   └── UefiHiiServicesLib.vcxproj
│   ├── UefiLib
│   │   └── UefiLib.vcxproj
│   ├── UefiMemoryAllocationLib
│   │   └── UefiMemoryAllocationLib.vcxproj
│   ├── UefiMemoryLib
│   │   └── UefiMemoryLib.vcxproj
│   ├── UefiRuntimeLib
│   │   └── UefiRuntimeLib.vcxproj
│   ├── UefiRuntimeServicesTableLib
│   │   └── UefiRuntimeServicesTableLib.vcxproj
│   ├── UefiShellLib
│   │   └── UefiShellLib.vcxproj
│   ├── UefiSortLib
│   │   └── UefiSortLib.vcxproj
│   ├── edk2.default.props
│   └── edk2.props
├── LICENSE
├── README.md
├── debugger
│   ├── OVMF_CODE-need-smm.fd
│   ├── OVMF_VARS-need-smm.fd
│   ├── UefiShell.iso
│   ├── efi-e1000.rom
│   ├── kvmvapic.bin
│   └── vgabios-stdvga.bin
├── rainbow
│   ├── LICENSE.txt
│   ├── UefiDriver
│   │   ├── UefiDriver.vcxproj
│   │   ├── console.cpp
│   │   ├── console.h
│   │   ├── general.h
│   │   ├── hooks.cpp
│   │   ├── hooks.h
│   │   ├── main.cpp
│   │   ├── ntdef.h
│   │   ├── utils.cpp
│   │   ├── utils.h
│   │   └── xor.h
│   ├── rainbow.default.props
│   ├── rainbow.props
│   └── rainbow.sln
├── rainbow0.png
├── rainbow1.png
└── rainbow2.png

```

`EDK-II/BaseCacheMaintenanceLib/BaseCacheMaintenanceLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{CE39A737-B7EE-4542-8EF7-B829E8E2FBC0}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseCacheMaintenanceLib\X86Cache.c" />
  </ItemGroup>
</Project>

```

`EDK-II/BaseCpuLib/BaseCpuLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{DEAFD87B-ED44-4D6E-B6AF-46762DD3B02D}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(SolutionDir)\MSBuild\nasm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(SolutionDir)\MSBuild\nasm.targets" />
  <ItemGroup>
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseCpuLib\x64\CpuFlushTlb.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseCpuLib\x64\CpuSleep.nasm" />
  </ItemGroup>
</Project>
```

`EDK-II/BaseCryptLib/BaseCryptLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{6F08C1AF-ECF2-472D-8ABA-686F8F21CA5E}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <PropertyGroup>
    <IncludePath>$(EDK_PATH)\CryptoPkg\Library\Include;$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib;$(OPENSSL_PATH);$(OPENSSL_PATH)\crypto\include;$(OPENSSL_PATH)\crypto\modes;$(IncludePath)</IncludePath>
  </PropertyGroup>
  <ItemDefinitionGroup>
    <ClCompile>
      <UndefinePreprocessorDefinitions>_WIN32;_WIN64;_MSC_VER</UndefinePreprocessorDefinitions>
      <DisableSpecificWarnings>4090</DisableSpecificWarnings>
    </ClCompile>
  </ItemDefinitionGroup>
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Hash\CryptMd4.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Hash\CryptMd5.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Hash\CryptSha1.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Hash\CryptSha256.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Hash\CryptSha512.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Hmac\CryptHmacMd5.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Hmac\CryptHmacSha1.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Hmac\CryptHmacSha256.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Cipher\CryptAes.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Cipher\CryptTdes.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Cipher\CryptArc4.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Pk\CryptRsaBasic.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Pk\CryptRsaExt.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Pk\CryptPkcs5Pbkdf2.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Pk\CryptPkcs7Sign.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Pk\CryptPkcs7VerifyBase.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Pk\CryptPkcs7VerifyCommon.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Pk\CryptDh.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Pk\CryptX509.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Pk\CryptAuthenticode.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Pk\CryptTs.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Pem\CryptPem.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\Rand\CryptRandTsc.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\SysCall\CrtWrapper.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\SysCall\TimerWrapper.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\BaseCryptLib\SysCall\BaseMemAllocation.c" />
  </ItemGroup>
</Project>

```

`EDK-II/BaseDebugPrintErrorLevelLib/BaseDebugPrintErrorLevelLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{7338D0E6-4409-49FA-BD0C-946BE5CE9081}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseDebugPrintErrorLevelLib\BaseDebugPrintErrorLevelLib.c" />
  </ItemGroup>
</Project>

```

`EDK-II/BaseLib/BaseLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{7DEFAA61-169C-48B9-95B8-410B5493033B}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(SolutionDir)\MSBuild\nasm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(SolutionDir)\MSBuild\nasm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\ARShiftU64.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\BitField.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\CheckSum.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\Cpu.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\CpuDeadLoop.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\DivS64x64Remainder.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\DivU64x32.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\DivU64x32Remainder.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\DivU64x64Remainder.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\FilePaths.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\GetPowerOfTwo32.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\GetPowerOfTwo64.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\HighBitSet32.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\HighBitSet64.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\LinkedList.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\LowBitSet32.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\LowBitSet64.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\LRotU32.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\LRotU64.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\LShiftU64.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\Math64.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\ModU64x32.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\MultS64x64.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\MultU64x32.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\MultU64x64.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\RRotU32.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\RRotU64.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\RShiftU64.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\SafeString.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\String.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\SwapBytes16.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\SwapBytes32.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\SwapBytes64.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\Unaligned.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\CpuBreakpoint.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\Non-existing.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadMsr64.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteMsr64.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X86DisablePaging32.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X86DisablePaging64.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X86EnablePaging32.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X86EnablePaging64.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X86FxRestore.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X86FxSave.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X86GetInterruptState.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X86MemoryFence.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X86Msr.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X86ReadGdtr.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X86ReadIdtr.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X86Thunk.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X86WriteGdtr.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X86WriteIdtr.c" />
  </ItemGroup>
  <ItemGroup>
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\CpuId.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\CpuIdEx.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\CpuPause.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\DisableCache.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\DisableInterrupts.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\DisablePaging64.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\EnableCache.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\EnableDisableInterrupts.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\EnableInterrupts.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\FlushCacheLine.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\FxRestore.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\FxSave.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\Invd.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\LongJump.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\Monitor.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\Mwait.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadCr0.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadCr2.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadCr3.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadCr4.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadCs.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadDr0.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadDr1.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadDr2.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadDr3.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadDr4.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadDr5.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadDr6.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadDr7.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadDs.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadEflags.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadEs.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadFs.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadGdtr.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadGs.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadIdtr.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadLdtr.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadMm0.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadMm1.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadMm2.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadMm3.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadMm4.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadMm5.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadMm6.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadMm7.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadPmc.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadSs.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadTr.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\ReadTsc.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\SetJump.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\SwitchStack.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\Wbinvd.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteCr0.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteCr2.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteCr3.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteCr4.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteDr0.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteDr1.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteDr2.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteDr3.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteDr4.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteDr5.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteDr6.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteDr7.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteGdtr.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteIdtr.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteLdtr.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteMm0.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteMm1.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteMm2.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteMm3.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteMm4.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteMm5.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteMm6.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseLib\X64\WriteMm7.nasm" />
  </ItemGroup>
</Project>
```

`EDK-II/BaseLib/vshacks.h`:

```h
#ifdef __cplusplus
extern "C" {
#endif

#include <Uefi.h>

extern UINT32 _PCD_GET_MODE_32_PcdMaximumLinkedListLength;
extern UINT32 _PCD_GET_MODE_32_PcdMaximumAsciiStringLength;
extern UINT32 _PCD_GET_MODE_32_PcdMaximumUnicodeStringLength;
extern UINT32 _PCD_GET_MODE_32_PcdUefiLibMaxPrintBufferSize;
extern UINT32 _PCD_GET_MODE_32_PcdFixedDebugPrintErrorLevel;
extern UINT32 _PCD_GET_MODE_32_PcdDebugPrintErrorLevel;
extern UINT32 _PCD_GET_MODE_32_PcdMaximumDevicePathNodeCount;
extern UINT32 _PCD_GET_MODE_32_PcdSpinLockTimeout;

extern UINT16 _PCD_GET_MODE_16_PcdUefiFileHandleLibPrintBufferSize;

extern BOOLEAN _PCD_GET_MODE_BOOL_PcdVerifyNodeInList;
extern BOOLEAN _PCD_GET_MODE_BOOL_PcdDriverDiagnosticsDisable;
extern BOOLEAN _PCD_GET_MODE_BOOL_PcdComponentNameDisable;
extern BOOLEAN _PCD_GET_MODE_BOOL_PcdComponentName2Disable;
extern BOOLEAN _PCD_GET_MODE_BOOL_PcdUgaConsumeSupport;
extern BOOLEAN _PCD_GET_MODE_BOOL_PcdDriverDiagnostics2Disable;

extern UINT8 _PCD_GET_MODE_8_PcdDebugPropertyMask;
extern UINT8 _PCD_GET_MODE_8_PcdDebugClearMemoryValue;

extern BOOLEAN _PCD_GET_MODE_BOOL_PcdShellLibAutoInitialize;
extern UINT16 _PCD_GET_MODE_16_PcdShellPrintBufferSize;

extern CHAR8 *gEfiCallerBaseName;

#ifdef __cplusplus
}
#endif
```

`EDK-II/BaseLib/vshacks.nasm`:

```nasm
%define ASM_PFX(a) a

%define PcdGet32(a) _gPcd_FixedAtBuild_ %+ a
```

`EDK-II/BaseMemoryLib/BaseMemoryLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{800C8E76-FFE0-4892-BD11-429B51D556D0}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseMemoryLib\CompareMemWrapper.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseMemoryLib\CopyMem.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseMemoryLib\CopyMemWrapper.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseMemoryLib\MemLibGeneric.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseMemoryLib\MemLibGuid.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseMemoryLib\ScanMem16Wrapper.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseMemoryLib\ScanMem32Wrapper.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseMemoryLib\ScanMem64Wrapper.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseMemoryLib\ScanMem8Wrapper.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseMemoryLib\SetMem.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseMemoryLib\SetMem16Wrapper.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseMemoryLib\SetMem32Wrapper.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseMemoryLib\SetMem64Wrapper.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseMemoryLib\SetMemWrapper.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseMemoryLib\ZeroMemWrapper.c" />
  </ItemGroup>
</Project>

```

`EDK-II/BasePrintLib/BasePrintLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{0FF40B47-3294-4652-ADAD-BD484ED6C5B3}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BasePrintLib\PrintLib.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BasePrintLib\PrintLibInternal.c" />
  </ItemGroup>
</Project>

```

`EDK-II/BaseSynchronizationLib/BaseSynchronizationLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{D100C7E5-DECA-4BBE-AE92-4B7ED03873B1}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(SolutionDir)\MSBuild\nasm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(SolutionDir)\MSBuild\nasm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseSynchronizationLib\SynchronizationMsc.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseSynchronizationLib\X64\InterlockedCompareExchange16.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseSynchronizationLib\X64\InterlockedCompareExchange32.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\BaseSynchronizationLib\X64\InterlockedCompareExchange64.c" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseSynchronizationLib\X64\InterlockedDecrement.nasm" />
    <NASM Include="$(EDK_PATH)\MdePkg\Library\BaseSynchronizationLib\X64\InterlockedIncrement.nasm" />
  </ItemGroup>
</Project>

```

`EDK-II/EDK-II.sln`:

```sln

Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio 14
VisualStudioVersion = 14.0.24720.0
MinimumVisualStudioVersion = 10.0.40219.1
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "BaseLib", "BaseLib\BaseLib.vcxproj", "{7DEFAA61-169C-48B9-95B8-410B5493033B}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "BaseCpuLib", "BaseCpuLib\BaseCpuLib.vcxproj", "{DEAFD87B-ED44-4D6E-B6AF-46762DD3B02D}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "UefiLib", "UefiLib\UefiLib.vcxproj", "{1D620CCA-0BD8-4BEB-A0BC-6D7164E95634}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "UefiApplicationEntryPoint", "UefiApplicationEntryPoint\UefiApplicationEntryPoint.vcxproj", "{93D9DC93-154F-47F0-9FCC-C93AA23CB1C3}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "BaseCacheMaintenanceLib", "BaseCacheMaintenanceLib\BaseCacheMaintenanceLib.vcxproj", "{CE39A737-B7EE-4542-8EF7-B829E8E2FBC0}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "UefiMemoryLib", "UefiMemoryLib\UefiMemoryLib.vcxproj", "{450578CF-FB0F-48F3-8249-B4349E252239}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "UefiMemoryAllocationLib", "UefiMemoryAllocationLib\UefiMemoryAllocationLib.vcxproj", "{878366AB-B98A-4933-A487-DCE343F51371}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "BasePrintLib", "BasePrintLib\BasePrintLib.vcxproj", "{0FF40B47-3294-4652-ADAD-BD484ED6C5B3}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "UefiDebugLibConOut", "UefiDebugLibConOut\UefiDebugLibConOut.vcxproj", "{B676BEE0-4049-445C-B20D-C3AD7B3983E4}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "UefiBootServicesTableLib", "UefiBootServicesTableLib\UefiBootServicesTableLib.vcxproj", "{8803BB67-A004-4562-8B61-8F49E313A389}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "BaseDebugPrintErrorLevelLib", "BaseDebugPrintErrorLevelLib\BaseDebugPrintErrorLevelLib.vcxproj", "{7338D0E6-4409-49FA-BD0C-946BE5CE9081}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "UefiDevicePathLibDevicePathProtocol", "UefiDevicePathLibDevicePathProtocol\UefiDevicePathLibDevicePathProtocol.vcxproj", "{61686617-D12A-487E-A519-EC4AE9403730}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "BaseSynchronizationLib", "BaseSynchronizationLib\BaseSynchronizationLib.vcxproj", "{D100C7E5-DECA-4BBE-AE92-4B7ED03873B1}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "UefiFileHandleLib", "UefiFileHandleLib\UefiFileHandleLib.vcxproj", "{F93A3A1B-0311-43FB-A6A8-B7592583EDFB}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "UefiRuntimeServicesTableLib", "UefiRuntimeServicesTableLib\UefiRuntimeServicesTableLib.vcxproj", "{6E4AF2C5-0A16-4467-A6DE-A81E682C2659}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "UefiDriverEntryPoint", "UefiDriverEntryPoint\UefiDriverEntryPoint.vcxproj", "{A2CFE12C-B942-4A78-97AF-8A0F8FF6DDC7}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "GlueLib", "GlueLib\GlueLib.vcxproj", "{DF325AB7-67A6-473E-93FF-16955AFBC063}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "UefiRuntimeLib", "UefiRuntimeLib\UefiRuntimeLib.vcxproj", "{4801026C-F7EA-4D77-A98B-C075C253CF32}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "BaseMemoryLib", "BaseMemoryLib\BaseMemoryLib.vcxproj", "{800C8E76-FFE0-4892-BD11-429B51D556D0}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "OpensslLib", "OpensslLib\OpensslLib.vcxproj", "{362BEE7E-5FBE-45D4-B303-3C0451E87C35}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "BaseCryptLib", "BaseCryptLib\BaseCryptLib.vcxproj", "{6F08C1AF-ECF2-472D-8ABA-686F8F21CA5E}"
	ProjectSection(ProjectDependencies) = postProject
		{362BEE7E-5FBE-45D4-B303-3C0451E87C35} = {362BEE7E-5FBE-45D4-B303-3C0451E87C35}
	EndProjectSection
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "IntrinsicLib", "IntrinsicLib\IntrinsicLib.vcxproj", "{74A1C96B-5DAD-4A89-AFA0-AEB6138C1A74}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "UefiShellLib", "UefiShellLib\UefiShellLib.vcxproj", "{D71E4E3B-6239-4AD1-A1C8-272E8673F980}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "UefiSortLib", "UefiSortLib\UefiSortLib.vcxproj", "{9B66ED85-72D6-4581-9A56-4E1F94D0C787}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "UefiHiiLib", "UefiHiiLib\UefiHiiLib.vcxproj", "{53122BEE-9C19-4380-8B7F-B9D8FFA28AB0}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "UefiHiiServicesLib", "UefiHiiServicesLib\UefiHiiServicesLib.vcxproj", "{8B3E5877-7789-4E21-9E7E-497FCFC70AC4}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Release|x64 = Release|x64
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{7DEFAA61-169C-48B9-95B8-410B5493033B}.Release|x64.ActiveCfg = Release|x64
		{7DEFAA61-169C-48B9-95B8-410B5493033B}.Release|x64.Build.0 = Release|x64
		{DEAFD87B-ED44-4D6E-B6AF-46762DD3B02D}.Release|x64.ActiveCfg = Release|x64
		{DEAFD87B-ED44-4D6E-B6AF-46762DD3B02D}.Release|x64.Build.0 = Release|x64
		{1D620CCA-0BD8-4BEB-A0BC-6D7164E95634}.Release|x64.ActiveCfg = Release|x64
		{1D620CCA-0BD8-4BEB-A0BC-6D7164E95634}.Release|x64.Build.0 = Release|x64
		{93D9DC93-154F-47F0-9FCC-C93AA23CB1C3}.Release|x64.ActiveCfg = Release|x64
		{93D9DC93-154F-47F0-9FCC-C93AA23CB1C3}.Release|x64.Build.0 = Release|x64
		{CE39A737-B7EE-4542-8EF7-B829E8E2FBC0}.Release|x64.ActiveCfg = Release|x64
		{CE39A737-B7EE-4542-8EF7-B829E8E2FBC0}.Release|x64.Build.0 = Release|x64
		{450578CF-FB0F-48F3-8249-B4349E252239}.Release|x64.ActiveCfg = Release|x64
		{450578CF-FB0F-48F3-8249-B4349E252239}.Release|x64.Build.0 = Release|x64
		{878366AB-B98A-4933-A487-DCE343F51371}.Release|x64.ActiveCfg = Release|x64
		{878366AB-B98A-4933-A487-DCE343F51371}.Release|x64.Build.0 = Release|x64
		{0FF40B47-3294-4652-ADAD-BD484ED6C5B3}.Release|x64.ActiveCfg = Release|x64
		{0FF40B47-3294-4652-ADAD-BD484ED6C5B3}.Release|x64.Build.0 = Release|x64
		{B676BEE0-4049-445C-B20D-C3AD7B3983E4}.Release|x64.ActiveCfg = Release|x64
		{B676BEE0-4049-445C-B20D-C3AD7B3983E4}.Release|x64.Build.0 = Release|x64
		{8803BB67-A004-4562-8B61-8F49E313A389}.Release|x64.ActiveCfg = Release|x64
		{8803BB67-A004-4562-8B61-8F49E313A389}.Release|x64.Build.0 = Release|x64
		{7338D0E6-4409-49FA-BD0C-946BE5CE9081}.Release|x64.ActiveCfg = Release|x64
		{7338D0E6-4409-49FA-BD0C-946BE5CE9081}.Release|x64.Build.0 = Release|x64
		{61686617-D12A-487E-A519-EC4AE9403730}.Release|x64.ActiveCfg = Release|x64
		{61686617-D12A-487E-A519-EC4AE9403730}.Release|x64.Build.0 = Release|x64
		{D100C7E5-DECA-4BBE-AE92-4B7ED03873B1}.Release|x64.ActiveCfg = Release|x64
		{D100C7E5-DECA-4BBE-AE92-4B7ED03873B1}.Release|x64.Build.0 = Release|x64
		{F93A3A1B-0311-43FB-A6A8-B7592583EDFB}.Release|x64.ActiveCfg = Release|x64
		{F93A3A1B-0311-43FB-A6A8-B7592583EDFB}.Release|x64.Build.0 = Release|x64
		{6E4AF2C5-0A16-4467-A6DE-A81E682C2659}.Release|x64.ActiveCfg = Release|x64
		{6E4AF2C5-0A16-4467-A6DE-A81E682C2659}.Release|x64.Build.0 = Release|x64
		{A2CFE12C-B942-4A78-97AF-8A0F8FF6DDC7}.Release|x64.ActiveCfg = Release|x64
		{A2CFE12C-B942-4A78-97AF-8A0F8FF6DDC7}.Release|x64.Build.0 = Release|x64
		{DF325AB7-67A6-473E-93FF-16955AFBC063}.Release|x64.ActiveCfg = Release|x64
		{DF325AB7-67A6-473E-93FF-16955AFBC063}.Release|x64.Build.0 = Release|x64
		{4801026C-F7EA-4D77-A98B-C075C253CF32}.Release|x64.ActiveCfg = Release|x64
		{4801026C-F7EA-4D77-A98B-C075C253CF32}.Release|x64.Build.0 = Release|x64
		{800C8E76-FFE0-4892-BD11-429B51D556D0}.Release|x64.ActiveCfg = Release|x64
		{800C8E76-FFE0-4892-BD11-429B51D556D0}.Release|x64.Build.0 = Release|x64
		{362BEE7E-5FBE-45D4-B303-3C0451E87C35}.Release|x64.ActiveCfg = Release|x64
		{362BEE7E-5FBE-45D4-B303-3C0451E87C35}.Release|x64.Build.0 = Release|x64
		{6F08C1AF-ECF2-472D-8ABA-686F8F21CA5E}.Release|x64.ActiveCfg = Release|x64
		{6F08C1AF-ECF2-472D-8ABA-686F8F21CA5E}.Release|x64.Build.0 = Release|x64
		{74A1C96B-5DAD-4A89-AFA0-AEB6138C1A74}.Release|x64.ActiveCfg = Release|x64
		{74A1C96B-5DAD-4A89-AFA0-AEB6138C1A74}.Release|x64.Build.0 = Release|x64
		{D71E4E3B-6239-4AD1-A1C8-272E8673F980}.Release|x64.ActiveCfg = Release|x64
		{D71E4E3B-6239-4AD1-A1C8-272E8673F980}.Release|x64.Build.0 = Release|x64
		{9B66ED85-72D6-4581-9A56-4E1F94D0C787}.Release|x64.ActiveCfg = Release|x64
		{9B66ED85-72D6-4581-9A56-4E1F94D0C787}.Release|x64.Build.0 = Release|x64
		{53122BEE-9C19-4380-8B7F-B9D8FFA28AB0}.Release|x64.ActiveCfg = Release|x64
		{53122BEE-9C19-4380-8B7F-B9D8FFA28AB0}.Release|x64.Build.0 = Release|x64
		{8B3E5877-7789-4E21-9E7E-497FCFC70AC4}.Release|x64.ActiveCfg = Release|x64
		{8B3E5877-7789-4E21-9E7E-497FCFC70AC4}.Release|x64.Build.0 = Release|x64
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
EndGlobal

```

`EDK-II/GlueLib/GlueLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <ProjectGuid>{DF325AB7-67A6-473E-93FF-16955AFBC063}</ProjectGuid>
    <Keyword>Win32Proj</Keyword>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemGroup>
    <ClCompile Include="initlib.c" />
    <ClCompile Include="guid.c" />
    <ClCompile Include="pcd.c" />
  </ItemGroup>
</Project>

```

`EDK-II/GlueLib/guid.c`:

```c
/** @file
  Global GUID Definitions

Copyright (c) 2015, Alex Ionescu. All rights reserved.<BR>
This program and the accompanying materials
are licensed and made available under the terms and conditions of the BSD License
which accompanies this distribution.  The full text of the license may be found at
http://opensource.org/licenses/bsd-license.php

THE PROGRAM IS DISTRIBUTED UNDER THE BSD LICENSE ON AN "AS IS" BASIS,
WITHOUT WARRANTIES OR REPRESENTATIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED.

**/

#include <Uefi.h>
#include <Library/UefiLib.h>

#include <Protocol/HiiFont.h>
#include <Protocol/GraphicsOutput.h>
#include <Protocol/UgaDraw.h>
#include <Protocol/DebugPort.h>
#include <Protocol/DevicePathFromText.h>
#include <Protocol/DevicePathToText.h>
#include <Protocol/DevicePathUtilities.h>
#include <Protocol/PciIo.h>
#include <Protocol/LoadedImage.h>
#include <Protocol/AcpiTable.h>
#include <Protocol/Decompress.h>

#include <Protocol/SerialIo.h>
#include <Protocol/UsbIo.h>

#include <Pi/PiDxeCis.h>
#include <Protocol/MpService.h>

#include <Guid/PcAnsi.h>
#include <Guid/GlobalVariable.h>
#include <Guid/EventGroup.h>

#include <Protocol/EfiShellInterface.h>
#include <Protocol/Shell.h>
#include <Protocol/EfiShellEnvironment2.h>
#include <Protocol/ShellParameters.h>
#include <Protocol/UnicodeCollation.h>

#include <Protocol/HiiDatabase.h>
#include <Protocol/HiiString.h>
#include <Protocol/HiiConfigRouting.h>
#include <Protocol/FormBrowser2.h>
#include <Guid/MdeModuleHii.h>

EFI_GUID gEfiPciIoProtocolGuid = EFI_PCI_IO_PROTOCOL_GUID;
EFI_GUID gEfiDriverDiagnosticsProtocolGuid = EFI_DRIVER_DIAGNOSTICS_PROTOCOL_GUID;
EFI_GUID gEfiDriverDiagnostics2ProtocolGuid = EFI_DRIVER_DIAGNOSTICS2_PROTOCOL_GUID;
EFI_GUID gEfiDriverConfigurationProtocolGuid = EFI_DRIVER_CONFIGURATION_PROTOCOL_GUID;
EFI_GUID gEfiDriverConfiguration2ProtocolGuid = EFI_DRIVER_CONFIGURATION2_PROTOCOL_GUID;
EFI_GUID gEfiComponentName2ProtocolGuid = EFI_COMPONENT_NAME2_PROTOCOL_GUID;
EFI_GUID gEfiComponentNameProtocolGuid = EFI_COMPONENT_NAME_PROTOCOL_GUID;
EFI_GUID gEfiDriverBindingProtocolGuid = EFI_DRIVER_BINDING_PROTOCOL_GUID;
EFI_GUID gEfiSimpleTextOutProtocolGuid = EFI_SIMPLE_TEXT_OUTPUT_PROTOCOL_GUID;
EFI_GUID gEfiGraphicsOutputProtocolGuid = EFI_GRAPHICS_OUTPUT_PROTOCOL_GUID;
EFI_GUID gEfiUgaDrawProtocolGuid = EFI_UGA_DRAW_PROTOCOL_GUID;
EFI_GUID gEfiHiiFontProtocolGuid = EFI_HII_FONT_PROTOCOL_GUID;
EFI_GUID gEfiDevicePathProtocolGuid = EFI_DEVICE_PATH_PROTOCOL_GUID;
EFI_GUID gEfiPcAnsiGuid = EFI_PC_ANSI_GUID;
EFI_GUID gEfiVT100Guid = EFI_VT_100_GUID;
EFI_GUID gEfiVT100PlusGuid = EFI_VT_100_PLUS_GUID;
EFI_GUID gEfiVTUTF8Guid = EFI_VT_UTF8_GUID;
EFI_GUID gEfiUartDevicePathGuid = DEVICE_PATH_MESSAGING_UART_FLOW_CONTROL;
EFI_GUID gEfiSasDevicePathGuid = EFI_SAS_DEVICE_PATH_GUID;
EFI_GUID gEfiDebugPortProtocolGuid = EFI_DEBUGPORT_PROTOCOL_GUID;
EFI_GUID gEfiDevicePathUtilitiesProtocolGuid = EFI_DEVICE_PATH_UTILITIES_PROTOCOL_GUID;
EFI_GUID gEfiDevicePathToTextProtocolGuid = EFI_DEVICE_PATH_TO_TEXT_PROTOCOL_GUID;
EFI_GUID gEfiDevicePathFromTextProtocolGuid = EFI_DEVICE_PATH_FROM_TEXT_PROTOCOL_GUID;
EFI_GUID gEfiGlobalVariableGuid = EFI_GLOBAL_VARIABLE;
EFI_GUID gEfiLoadedImageProtocolGuid = EFI_LOADED_IMAGE_PROTOCOL_GUID;
EFI_GUID gEfiAcpiTableProtocolGuid = EFI_ACPI_TABLE_PROTOCOL_GUID;
EFI_GUID gEfiDecompressProtocolGuid = EFI_DECOMPRESS_PROTOCOL_GUID;

EFI_GUID gEfiEventExitBootServicesGuid = EFI_EVENT_GROUP_EXIT_BOOT_SERVICES;
EFI_GUID gEfiEventVirtualAddressChangeGuid = EFI_EVENT_GROUP_VIRTUAL_ADDRESS_CHANGE;

EFI_GUID gEfiUsbIoProtocolGuid = EFI_USB_IO_PROTOCOL_GUID;
EFI_GUID gEfiSerialIoProtocolGuid = EFI_SERIAL_IO_PROTOCOL_GUID;

EFI_GUID gEfiMpServiceProtocolGuid = EFI_MP_SERVICES_PROTOCOL_GUID;

EFI_GUID gEfiShellInterfaceGuid = SHELL_INTERFACE_PROTOCOL_GUID;
EFI_GUID gEfiShellProtocolGuid = EFI_SHELL_PROTOCOL_GUID;
EFI_GUID gEfiFileInfoGuid = EFI_FILE_INFO_ID;
EFI_GUID gEfiShellEnvironment2Guid = SHELL_ENVIRONMENT_PROTOCOL_GUID;
EFI_GUID gEfiShellEnvironment2ExtGuid = EFI_SE_EXT_SIGNATURE_GUID;
EFI_GUID gEfiSimpleFileSystemProtocolGuid = EFI_SIMPLE_FILE_SYSTEM_PROTOCOL_GUID;
EFI_GUID gEfiShellParametersProtocolGuid = EFI_SHELL_PARAMETERS_PROTOCOL_GUID;
EFI_GUID gEfiUnicodeCollation2ProtocolGuid = EFI_UNICODE_COLLATION_PROTOCOL2_GUID;

EFI_GUID gEfiHiiStringProtocolGuid = EFI_HII_STRING_PROTOCOL_GUID;
EFI_GUID gEfiHiiDatabaseProtocolGuid = EFI_HII_DATABASE_PROTOCOL_GUID;
EFI_GUID gEfiHiiImageProtocolGuid = EFI_HII_IMAGE_PROTOCOL_GUID;
EFI_GUID gEfiHiiConfigRoutingProtocolGuid = EFI_HII_CONFIG_ROUTING_PROTOCOL_GUID;

EFI_GUID gEfiFormBrowser2ProtocolGuid = EFI_FORM_BROWSER2_PROTOCOL_GUID;

EFI_GUID gEdkiiIfrBitVarstoreGuid = EDKII_IFR_BIT_VARSTORE_GUID;

```

`EDK-II/GlueLib/initlib.c`:

```c
/** @file
  Glue Library Initialization Code

Copyright (c) 2015, Alex Ionescu. All rights reserved.<BR>
This program and the accompanying materials
are licensed and made available under the terms and conditions of the BSD License
which accompanies this distribution.  The full text of the license may be found at
http://opensource.org/licenses/bsd-license.php

THE PROGRAM IS DISTRIBUTED UNDER THE BSD LICENSE ON AN "AS IS" BASIS,
WITHOUT WARRANTIES OR REPRESENTATIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED.

**/

#include <Uefi.h>

#include <Library/DevicePathLib.h>
#include <Library/UefiLib.h>
#include <Library/UefiBootServicesTableLib.h>
#include <Library/UefiRuntimeServicesTableLib.h>

EFI_STATUS
EFIAPI
UefiMain (
  IN EFI_HANDLE        ImageHandle,
  IN EFI_SYSTEM_TABLE  *SystemTable
  );

EFI_STATUS
EFIAPI
UefiUnload (
  IN EFI_HANDLE        ImageHandle
  );

EFI_STATUS
EFIAPI
UefiBootServicesTableLibConstructor (
  IN EFI_HANDLE        ImageHandle,
  IN EFI_SYSTEM_TABLE  *SystemTable
);

EFI_STATUS
EFIAPI
UefiRuntimeServicesTableLibConstructor (
  IN EFI_HANDLE        ImageHandle,
  IN EFI_SYSTEM_TABLE  *SystemTable
);

EFI_STATUS
EFIAPI
UefiLibConstructor (
  IN EFI_HANDLE        ImageHandle,
  IN EFI_SYSTEM_TABLE  *SystemTable
);

EFI_STATUS
EFIAPI
DevicePathLibConstructor (
  IN EFI_HANDLE        ImageHandle,
  IN EFI_SYSTEM_TABLE  *SystemTable
);

EFI_STATUS
EFIAPI
RuntimeDriverLibConstruct (
  IN EFI_HANDLE        ImageHandle,
  IN EFI_SYSTEM_TABLE  *SystemTable
);

EFI_STATUS
EFIAPI
RuntimeDriverLibDeconstruct (
  IN EFI_HANDLE        ImageHandle,
  IN EFI_SYSTEM_TABLE  *SystemTable
);

EFI_STATUS
EFIAPI
UefiHiiServicesLibConstructor (
    IN EFI_HANDLE        ImageHandle,
    IN EFI_SYSTEM_TABLE  *SystemTable
);

/**
  Calls library constructors.

  This function calls all the constructors that the UEFI libraries contain. As
  of now this includes the Boot and Runtime Services Table Library constructor,
  the UEFI Library constructor, and the Device Path Library constructor.

  @param  ImageHandle           The image handle of the UEFI Application.
  @param  SystemTable           A pointer to the EFI System Table.

  @retval EFI_SUCCESS           Operation was completed sucessfully.
**/
EFI_STATUS 
EFIAPI
ProcessLibraryConstructorList (
  IN EFI_HANDLE        ImageHandle,
  IN EFI_SYSTEM_TABLE  *SystemTable
  )
{
  UefiBootServicesTableLibConstructor(ImageHandle, SystemTable);

  UefiRuntimeServicesTableLibConstructor(ImageHandle, SystemTable);

  UefiLibConstructor(ImageHandle, SystemTable);

  DevicePathLibConstructor(ImageHandle, SystemTable);

//  RuntimeDriverLibConstruct(ImageHandle, SystemTable);

  UefiHiiServicesLibConstructor(ImageHandle, SystemTable);

  return EFI_SUCCESS;
}

/**
  Call library destructors.

  This function calls all the destructors that the UEFI libraries contain. As
  of now, none of the libraries have any destructors.

  @param  ImageHandle           The image handle of the UEFI Application.
  @param  SystemTable           A pointer to the EFI System Table.
**/
VOID
EFIAPI
ProcessLibraryDestructorList (
  IN EFI_HANDLE        ImageHandle,
  IN EFI_SYSTEM_TABLE  *SystemTable
  )
{
 // RuntimeDriverLibDeconstruct(ImageHandle, SystemTable);
}

/**
  Calls module entrypoints.

  This function calls all the entrypoints that are part of this UEFI module.
  For modules being built with this library, we assume that only one entry
  point exists, and that it is called UefiMain.

  @param  ImageHandle           The image handle of the UEFI Application.
  @param  SystemTable           A pointer to the EFI System Table.

  @retval EFI_SUCCESS           Operation was completed sucessfully.
**/
EFI_STATUS
EFIAPI
ProcessModuleEntryPointList (
  IN EFI_HANDLE        ImageHandle,
  IN EFI_SYSTEM_TABLE  *SystemTable
  )
{
  return UefiMain (ImageHandle, SystemTable);
}

/**
  Calls module unload functions.

  This function calls all the unload functions part of this UEFI module.
  For modules being built with this library, we assume that only one unload
  function exists, and that it is called UefiUnload.

  @param  ImageHandle           The image handle of the UEFI Application.

  @retval EFI_SUCCESS           Operation was completed sucessfully.
**/
EFI_STATUS
EFIAPI
ProcessModuleUnloadList (
  IN EFI_HANDLE        ImageHandle
  )
{
  return UefiUnload (ImageHandle);
}


```

`EDK-II/GlueLib/pcd.c`:

```c
/** @file
  Global Platform Configuration Data (PCD)

Copyright (c) 2015, Alex Ionescu. All rights reserved.<BR>
This program and the accompanying materials
are licensed and made available under the terms and conditions of the BSD License
which accompanies this distribution.  The full text of the license may be found at
http://opensource.org/licenses/bsd-license.php

THE PROGRAM IS DISTRIBUTED UNDER THE BSD LICENSE ON AN "AS IS" BASIS,
WITHOUT WARRANTIES OR REPRESENTATIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED.

**/

#include <Uefi.h>
#include <Library/UefiLib.h>
#include <Pi/PiStatusCode.h>

BOOLEAN _PCD_GET_MODE_BOOL_PcdComponentNameDisable = FALSE;
BOOLEAN _PCD_GET_MODE_BOOL_PcdDriverDiagnosticsDisable = FALSE;
BOOLEAN _PCD_GET_MODE_BOOL_PcdComponentName2Disable = FALSE;
BOOLEAN _PCD_GET_MODE_BOOL_PcdDriverDiagnostics2Disable = FALSE;
BOOLEAN _PCD_GET_MODE_BOOL_PcdUefiVariableDefaultLangDeprecate  = FALSE;
BOOLEAN _PCD_GET_MODE_BOOL_PcdUgaConsumeSupport = TRUE;
BOOLEAN _PCD_GET_MODE_BOOL_PcdVerifyNodeInList = FALSE;
BOOLEAN _PCD_GET_MODE_BOOL_PcdValidateOrderedCollection = FALSE;

UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueEfiWatchDogTimerExpired = EFI_COMPUTING_UNIT_HOST_PROCESSOR | EFI_CU_HP_EC_TIMER_EXPIRED;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueSetVirtualAddressMap = EFI_SOFTWARE_EFI_RUNTIME_SERVICE | EFI_SW_RS_PC_SET_VIRTUAL_ADDRESS_MAP;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueMemoryTestStarted = EFI_COMPUTING_UNIT_MEMORY | EFI_CU_MEMORY_PC_TEST;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueUncorrectableMemoryError = EFI_COMPUTING_UNIT_MEMORY | EFI_CU_MEMORY_EC_UNCORRECTABLE;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueRemoteConsoleError = EFI_PERIPHERAL_REMOTE_CONSOLE | EFI_P_EC_CONTROLLER_ERROR;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueRemoteConsoleReset = EFI_PERIPHERAL_REMOTE_CONSOLE | EFI_P_PC_RESET;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueRemoteConsoleInputError = EFI_PERIPHERAL_REMOTE_CONSOLE | EFI_P_EC_INPUT_ERROR;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueRemoteConsoleOutputError = EFI_PERIPHERAL_REMOTE_CONSOLE | EFI_P_EC_OUTPUT_ERROR;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueMouseInterfaceError = EFI_PERIPHERAL_MOUSE | EFI_P_EC_INTERFACE_ERROR;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueMouseEnable = EFI_PERIPHERAL_MOUSE | EFI_P_PC_ENABLE;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueMouseDisable = EFI_PERIPHERAL_MOUSE | EFI_P_PC_DISABLE;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueKeyboardEnable = EFI_PERIPHERAL_KEYBOARD | EFI_P_PC_ENABLE;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueKeyboardDisable = EFI_PERIPHERAL_KEYBOARD | EFI_P_PC_DISABLE;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueKeyboardPresenceDetect = EFI_PERIPHERAL_KEYBOARD | EFI_P_PC_PRESENCE_DETECT;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueKeyboardReset = EFI_PERIPHERAL_KEYBOARD | EFI_P_PC_RESET;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueKeyboardClearBuffer = EFI_PERIPHERAL_KEYBOARD | EFI_P_KEYBOARD_PC_CLEAR_BUFFER;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueKeyboardSelfTest = EFI_PERIPHERAL_KEYBOARD | EFI_P_KEYBOARD_PC_SELF_TEST;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueKeyboardInterfaceError = EFI_PERIPHERAL_KEYBOARD | EFI_P_EC_INTERFACE_ERROR;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueKeyboardInputError = EFI_PERIPHERAL_KEYBOARD | EFI_P_EC_INPUT_ERROR;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueMouseInputError = EFI_PERIPHERAL_MOUSE | EFI_P_EC_INPUT_ERROR;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueMouseReset = EFI_PERIPHERAL_MOUSE | EFI_P_PC_RESET;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValuePeiHandoffToDxe = EFI_SOFTWARE_PEI_CORE | EFI_SW_PEI_CORE_PC_HANDOFF_TO_NEXT;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValuePeimDispatch = EFI_SOFTWARE_PEI_CORE | EFI_SW_PC_INIT_BEGIN;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValuePeiCoreEntry = EFI_SOFTWARE_PEI_CORE | EFI_SW_PC_INIT;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueDxeCoreEntry = EFI_SOFTWARE_DXE_CORE | EFI_SW_DXE_CORE_PC_ENTRY_POINT;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueDxeCoreHandoffToBds = EFI_SOFTWARE_DXE_CORE | EFI_SW_DXE_CORE_PC_HANDOFF_TO_NEXT;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueBootServiceExit = EFI_SOFTWARE_EFI_BOOT_SERVICE | EFI_SW_BS_PC_EXIT_BOOT_SERVICES;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueDxeDriverBegin = EFI_SOFTWARE_DXE_CORE | EFI_SW_PC_INIT_BEGIN;
UINT32 _PCD_GET_MODE_32_PcdStatusCodeValueDxeDriverEnd = EFI_SOFTWARE_DXE_CORE | EFI_SW_PC_INIT_END;

UINT32 _PCD_GET_MODE_32_PcdFixedDebugPrintErrorLevel = 0xFFFFFFFF;
UINT32 _PCD_GET_MODE_32_PcdMaximumUnicodeStringLength = 1000000;
UINT32 _PCD_GET_MODE_32_PcdMaximumAsciiStringLength = 1000000;
UINT32 _PCD_GET_MODE_32_PcdMaximumLinkedListLength = 1000000;
UINT32 _PCD_GET_MODE_32_PcdMaximumDevicePathNodeCount = 0;
UINT32 _PCD_GET_MODE_32_PcdSpinLockTimeout = 10000000;

UINT8 _PCD_GET_MODE_8_PcdDebugPropertyMask = 0;
UINT32 _PCD_GET_MODE_32_PcdDebugPrintErrorLevel = 0x80000000;
UINT8 _PCD_GET_MODE_8_PcdReportStatusCodePropertyMask = 0;
UINT8 _PCD_GET_MODE_8_PcdDebugClearMemoryValue = 0xAF;
UINT8 _PCD_GET_MODE_8_PcdPerformanceLibraryPropertyMask = 0;

UINT8 _PCD_GET_MODE_8_PcdPostCodePropertyMask = 0;

UINT32 _PCD_GET_MODE_32_PcdFSBClock = 200000000;
UINT32 _PCD_GET_MODE_32_PcdUefiLibMaxPrintBufferSize = 320;

UINT16 _PCD_GET_MODE_16_PcdUefiFileHandleLibPrintBufferSize = 1536;

UINT32 _PCD_GET_MODE_32_PcdMaximumGuidedExtractHandler = 0x10;
UINT32 _PCD_GET_MODE_32_PcdUsbTransferTimeoutValue = 3000;

UINT64 _PCD_GET_MODE_64_PcdGuidedExtractHandlerTableAddress = 0x1000000;
UINT64 _PCD_GET_MODE_64_PcdIoBlockBaseAddressForIpf = 0x0ffffc000000;
UINT64 _PCD_GET_MODE_64_PcdPciExpressBaseAddress = 0xE0000000;

CHAR8* PcdUefiVariableDefaultLangCodes = "engfraengfra";
CHAR8* PcdUefiVariableDefaultLang = "eng";
CHAR8* PcdUefiVariableDefaultPlatformLangCodes = "en;fr;en-US;fr-FR";
CHAR8* PcdUefiVariableDefaultPlatformLang = "en-US";

UINT64 _PCD_GET_MODE_64_PcdUartDefaultBaudRate = 115200;
UINT8 _PCD_GET_MODE_8_PcdUartDefaultDataBits = 8;
UINT8 _PCD_GET_MODE_8_PcdUartDefaultParity = 1;
UINT8 _PCD_GET_MODE_8_PcdUartDefaultStopBits = 1;
UINT8 _PCD_GET_MODE_8_PcdDefaultTerminalType = 0;

UINT16 _PCD_GET_MODE_16_PcdHardwareErrorRecordLevel = 0;
UINT16 _PCD_GET_MODE_16_PcdPlatformBootTimeOut = 0xffff;

BOOLEAN _PCD_GET_MODE_BOOL_PcdShellLibAutoInitialize = FALSE;
UINT16 _PCD_GET_MODE_16_PcdShellPrintBufferSize = 16000;
```

`EDK-II/IntrinsicLib/IntrinsicLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{74A1C96B-5DAD-4A89-AFA0-AEB6138C1A74}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemDefinitionGroup>
    <ClCompile>
      <IntrinsicFunctions>false</IntrinsicFunctions>
      <WholeProgramOptimization>false</WholeProgramOptimization>
    </ClCompile>
  </ItemDefinitionGroup>
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\IntrinsicLib\MemoryIntrinsics.c" />
    <ClCompile Include="$(EDK_PATH)\CryptoPkg\Library\IntrinsicLib\CopyMem.c" />
  </ItemGroup>
</Project>

```

`EDK-II/MSBuild/nasm.props`:

```props
<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup Condition="'$(NASMBeforeTargets)' == '' and '$(NASMAfterTargets)' == '' and '$(ConfigurationType)' != 'Makefile'">
    <NASMBeforeTargets>Midl</NASMBeforeTargets>
    <NASMAfterTargets>CustomBuild</NASMAfterTargets>
  </PropertyGroup>
  <ItemDefinitionGroup>
    <NASM>
      <GenerateDebugInformation>True</GenerateDebugInformation>
      <IncludePaths>$(EDK_PATH)\MdePkg;$(EDK_PATH)\MdePkg\Include;$(EDK_PATH)\MdePkg\Library\BaseLib\X64;$(EDK_PATH)\MdePkg\Include\X64</IncludePaths>
      <PreIncludeFiles>$(SolutionDir)BaseLib\vshacks.nasm</PreIncludeFiles>
      <OutputFormat>$(IntDir)%(FileName).obj</OutputFormat>
      <Outputswitch>1</Outputswitch>
      <CompilerNasm>$(NASM_PREFIX)nasm.exe</CompilerNasm>
      <PackAlignmentBoundary>0</PackAlignmentBoundary>
      <CommandLineTemplate>"%(CompilerNasm)" [AllOptions] [AdditionalOptions] "%(FullPath)"</CommandLineTemplate>
      <ExecutionDescription>Assembling %(Filename)%(Extension)</ExecutionDescription>
    </NASM>
  </ItemDefinitionGroup>
</Project>
```

`EDK-II/MSBuild/nasm.targets`:

```targets
<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <PropertyPageSchema Include="$(MSBuildThisFileDirectory)$(MSBuildThisFileName).xml"/>
    <AvailableItemName Include="NASM">
      <Targets>_NASM</Targets>
    </AvailableItemName>
  </ItemGroup>
  <PropertyGroup>
    <ComputeLinkInputsTargets>
      $(ComputeLinkInputsTargets);
      ComputeNASMOutput;
    </ComputeLinkInputsTargets>
    <ComputeLibInputsTargets>
      $(ComputeLibInputsTargets);
      ComputeNASMOutput;
    </ComputeLibInputsTargets>
  </PropertyGroup>
  <UsingTask TaskName="NASM" TaskFactory="XamlTaskFactory" AssemblyName="Microsoft.Build.Tasks.v4.0">
    <Task>$(MSBuildThisFileDirectory)$(MSBuildThisFileName).xml</Task>
  </UsingTask>
  <Target Name="_NASM" BeforeTargets="$(NASMBeforeTargets)" AfterTargets="$(NASMAfterTargets)" Condition="'@(NASM)' != ''" Outputs="%(NASM.OutputFormat)" Inputs="%(NASM.Identity);%(NASM.AdditionalDependencies);$(MSBuildProjectFile)" DependsOnTargets="_SelectedFiles">
    <ItemGroup Condition="'@(SelectedFiles)' != ''">
      <NASM Remove="@(NASM)" Condition="'%(Identity)' != '@(SelectedFiles)'"/>
    </ItemGroup>
    <ItemGroup>
      <NASM_tlog Include="%(NASM.OutputFormat)" Condition="'%(NASM.OutputFormat)' != '' and '%(NASM.ExcludedFromBuild)' != 'true'">
        <Source>@(NASM, '|')</Source>
      </NASM_tlog>
    </ItemGroup>
    <Message Importance="High" Text="%(NASM.ExecutionDescription)"/>
    <WriteLinesToFile Condition="'@(NASM_tlog)' != '' and '%(NASM_tlog.ExcludedFromBuild)' != 'true'" File="$(IntDir)$(ProjectName).write.1.tlog" Lines="^%(NASM_tlog.Source);@(NASM_tlog-&gt;'%(Fullpath)')"/>
    <NASM Condition="'@(NASM)' != '' and '%(NASM.ExcludedFromBuild)' != 'true'" Inputs="%(NASM.Inputs)" OutputFormat="%(NASM.OutputFormat)" Outputswitch="%(NASM.Outputswitch)" AssembledCodeListingFile="%(NASM.AssembledCodeListingFile)" GenerateDebugInformation="%(NASM.GenerateDebugInformation)" ErrorReporting="%(NASM.ErrorReporting)" IncludePaths="%(NASM.IncludePaths)" PreIncludeFiles="%(NASM.PreIncludeFiles)" PreprocessorDefinitions="%(NASM.PreprocessorDefinitions)" UndefinePreprocessorDefinitions="%(NASM.UndefinePreprocessorDefinitions)" ErrorReportingFormat="%(NASM.ErrorReportingFormat)" TreatWarningsAsErrors="%(NASM.TreatWarningsAsErrors)" floatunderflow="%(NASM.floatunderflow)" macrodefaults="%(NASM.macrodefaults)" user="%(NASM.user)" floatoverflow="%(NASM.floatoverflow)" floatdenorm="%(NASM.floatdenorm)" numberoverflow="%(NASM.numberoverflow)" macroselfref="%(NASM.macroselfref)" floattoolong="%(NASM.floattoolong)" orphanlabels="%(NASM.orphanlabels)" CommandLineTemplate="%(NASM.CommandLineTemplate)" AdditionalOptions="%(NASM.AdditionalOptions)"/>
  </Target>
  <Target Name="ComputeNASMOutput" Condition="'@(NASM)' != ''">
    <ItemGroup>
      <Link Include="@(NASM-&gt;Metadata('OutputFormat')-&gt;Distinct()-&gt;ClearMetadata())" Condition="'%(NASM.ExcludedFromBuild)' != 'true'"/>
      <Lib Include="@(NASM-&gt;Metadata('OutputFormat')-&gt;Distinct()-&gt;ClearMetadata())" Condition="'%(NASM.ExcludedFromBuild)' != 'true'"/>
    </ItemGroup>
  </Target>
</Project>
```

`EDK-II/MSBuild/nasm.xml`:

```xml
<?xml version="1.0" encoding="utf-8"?>
<ProjectSchemaDefinitions xmlns="http://schemas.microsoft.com/build/2009/properties" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:sys="clr-namespace:System;assembly=mscorlib">
  <Rule Name="NASM" PageTemplate="tool" DisplayName="Netwide Assembler" Order="200">
    <Rule.DataSource>
      <DataSource Persistence="ProjectFile" ItemType="NASM"/>
    </Rule.DataSource>
    <Rule.Categories>
      <Category Name="General">
        <Category.DisplayName>
          <sys:String>General</sys:String>
        </Category.DisplayName>
      </Category>
      <Category Name="Preprocessor">
        <Category.DisplayName>
          <sys:String>Preprocessing Options</sys:String>
        </Category.DisplayName>
      </Category>
      <Category Name="Assembler Options">
        <Category.DisplayName>
          <sys:String>Assembler Options</sys:String>
        </Category.DisplayName>
      </Category>
      <Category Name="Advanced">
        <Category.DisplayName>
          <sys:String>Advanced </sys:String>
        </Category.DisplayName>
      </Category>
      <Category Name="Command Line" Subtype="CommandLine">
        <Category.DisplayName>
          <sys:String>Command Line</sys:String>
        </Category.DisplayName>
      </Category>
    </Rule.Categories>
    <StringProperty Name="Inputs" Category="Command Line" IsRequired="true">
      <StringProperty.DataSource>
        <DataSource Persistence="ProjectFile" ItemType="NASM" SourceType="Item"/>
      </StringProperty.DataSource>
    </StringProperty>
    <StringProperty Name="OutputFormat" Category="Assembler Options" HelpUrl="http://www.nasm.us/doc/" DisplayName="Output File Name" Description="Specify Output Filename.-o [value]" Switch="-o &quot;[value]&quot;"/>
    <BoolProperty Name="tasmmode" Category="Advanced" HelpUrl="http://www.nasm.us/doc/" DisplayName="SciTech TASM compatible mode" Description="assemble in SciTech TASM compatible mode" Switch="-t"/>
    <EnumProperty Name="Outputswitch" Category="Assembler Options" HelpUrl="http://www.nasm.us/doc/" DisplayName="Output Switch" Description="Select the type of output format required. Linking Should be disabled for ELF and Binary ,else error will popup">
      <EnumValue Name="0" DisplayName="Object File win32" Switch="-fwin32"/>
      <EnumValue Name="1" DisplayName="Object File win64" Switch="-fwin64"/>
      <EnumValue Name="2" DisplayName="ELF32 (i386) object files (e.g. Linux)" Switch="-felf32"/>
      <EnumValue Name="3" DisplayName="ELF64 (x86_64) object files (e.g. Linux)" Switch="-felf64"/>
    </EnumProperty>
    <StringListProperty Name="AssembledCodeListingFile" Category="Assembler Options" DisplayName="Assembled Code Listing File" Description="Generates an assembled code listing file.     (-l [file])" HelpUrl="http://www.nasm.us/doc/" Switch="-l &quot;[value]&quot;"/>
    <BoolProperty Name="GenerateDebugInformation" Category="Assembler Options" DisplayName="Generate Debug Information" Description="Generates Debug Information.     (-g)" HelpUrl="http://www.nasm.us/doc/" Switch="-g"/>
    <StringListProperty Name="ErrorReporting" Category="Advanced" HelpUrl="http://www.nasm.us/doc/" DisplayName="Redirect Error Messages to File" Description="Drops the error Message on specified device" Switch="-Z &quot;[value]&quot;"/>
    <StringListProperty Name="IncludePaths" Category="General" DisplayName="Include Paths" Description="Sets path for include file.     (-I[path])" HelpUrl="http://www.nasm.us/doc/" Switch="-I&quot;[value]&quot;"/>
    <StringListProperty Name="PreIncludeFiles" Category="General" DisplayName="Pre-Include Files" Description="Sets files for pre-include.     (-P[path])" HelpUrl="http://www.nasm.us/doc/" Switch="-P&quot;[value]&quot;"/>
    <StringListProperty Name="PreprocessorDefinitions" Category="Preprocessor" HelpUrl="http://www.nasm.us/doc/" DisplayName="Preprocessor Definitions" Description="Defines a text macro with the given name.     (-D[symbol])" Switch="-D&quot;[value]&quot;"/>
    <StringListProperty Name="UndefinePreprocessorDefinitions" Category="Preprocessor" HelpUrl="http://www.nasm.us/doc/" DisplayName="Undefine Preprocessor Definitions" Description="Undefines a text macro with the given name.     (-U[symbol])" Switch="-U&quot;[value]&quot;"/>
    <EnumProperty Name="ErrorReportingFormat" Category="Advanced" HelpUrl="http://www.nasm.us/doc/" DisplayName="Error Reporting Format" Description="Select the error reporting format ie. GNU or VC">
      <EnumValue Name="0" DisplayName="-Xgnu GNU format: Default format" Switch="-Xgnu"/>
      <EnumValue Name="1" DisplayName="-Xvc Style used by Microsoft Visual C++" Switch="-Xvc"/>
    </EnumProperty>
    <BoolProperty Name="TreatWarningsAsErrors" Category="Assembler Options" DisplayName="Treat Warnings As Errors" Description="Returns an error code if warnings are generated.     (-Werror)" HelpUrl="http://www.nasm.us/doc/" Switch="-Werror"/>
    <BoolProperty Name="floatunderflow" Category="Advanced" HelpUrl="http://www.nasm.us/doc/" DisplayName="float-underflow" Description="floating point underflow (default off)" Switch="-w+float-underflow"/>
    <BoolProperty Name="macrodefaults" Category="Advanced" HelpUrl="http://www.nasm.us/doc/" DisplayName="Disable macro-defaults" Description="macros with more default than optional parameters (default on)" Switch="-w-macro-defaults"/>
    <BoolProperty Name="user" Category="Advanced" HelpUrl="http://www.nasm.us/doc/" DisplayName="Disable user" Description="%warning directives (default on)" Switch="-w-user"/>
    <BoolProperty Name="floatoverflow" Category="Advanced" HelpUrl="http://www.nasm.us/doc/" DisplayName="Disable float-overflow" Description="floating point overflow (default on)" Switch="-w-float-overflow"/>
    <BoolProperty Name="floatdenorm" Category="Advanced" HelpUrl="http://www.nasm.us/doc/" DisplayName="float-denorm" Description="floating point denormal (default off)" Switch="-w+float-denorm"/>
    <BoolProperty Name="numberoverflow" Category="Advanced" HelpUrl="http://www.nasm.us/doc/" DisplayName="Disable number-overflow" Description="numeric constant does not fit (default on)" Switch="-w-number-overflow"/>
    <BoolProperty Name="macroselfref" Category="Advanced" HelpUrl="http://www.nasm.us/doc/" DisplayName="macro-selfref" Description="cyclic macro references (default off)" Switch="-w+macro-selfref"/>
    <BoolProperty Name="floattoolong" Category="Advanced" HelpUrl="http://www.nasm.us/doc/" DisplayName="Disable float-toolong" Description=" too many digits in floating-point number (default on)" Switch="-w-float-toolong"/>
    <BoolProperty Name="orphanlabels" Category="Advanced" HelpUrl="http://www.nasm.us/doc/" DisplayName="Disable orphan-labels" Description="labels alone on lines without trailing `:' (default on)" Switch="-w-orphan-labels"/>
    <StringProperty Name="CommandLineTemplate" DisplayName="Command Line" Visible="False" IncludeInCommandLine="False"/>
    <DynamicEnumProperty Name="NASMBeforeTargets" Category="General" EnumProvider="Targets" IncludeInCommandLine="False">
      <DynamicEnumProperty.DisplayName>
        <sys:String>Execute Before</sys:String>
      </DynamicEnumProperty.DisplayName>
      <DynamicEnumProperty.Description>
        <sys:String>Specifies the targets for the build customization to run before.</sys:String>
      </DynamicEnumProperty.Description>
      <DynamicEnumProperty.ProviderSettings>
        <NameValuePair Name="Exclude" Value="^NASMBeforeTargets|^Compute"/>
      </DynamicEnumProperty.ProviderSettings>
      <DynamicEnumProperty.DataSource>
        <DataSource Persistence="ProjectFile" ItemType="" HasConfigurationCondition="true"/>
      </DynamicEnumProperty.DataSource>
    </DynamicEnumProperty>
    <DynamicEnumProperty Name="NASMAfterTargets" Category="General" EnumProvider="Targets" IncludeInCommandLine="False">
      <DynamicEnumProperty.DisplayName>
        <sys:String>Execute After</sys:String>
      </DynamicEnumProperty.DisplayName>
      <DynamicEnumProperty.Description>
        <sys:String>Specifies the targets for the build customization to run after.</sys:String>
      </DynamicEnumProperty.Description>
      <DynamicEnumProperty.ProviderSettings>
        <NameValuePair Name="Exclude" Value="^NASMAfterTargets|^Compute"/>
      </DynamicEnumProperty.ProviderSettings>
      <DynamicEnumProperty.DataSource>
        <DataSource Persistence="ProjectFile" ItemType="" HasConfigurationCondition="true"/>
      </DynamicEnumProperty.DataSource>
    </DynamicEnumProperty>
    <StringProperty Name="ExecutionDescription" DisplayName="Execution Description" IncludeInCommandLine="False" Visible="False"/>
    <StringListProperty Name="AdditionalDependencies" DisplayName="Additional Dependencies" IncludeInCommandLine="False" Visible="False"/>
    <StringProperty Subtype="AdditionalOptions" Name="AdditionalOptions" Category="Command Line">
      <StringProperty.DisplayName>
        <sys:String>Additional Options</sys:String>
      </StringProperty.DisplayName>
      <StringProperty.Description>
        <sys:String>Additional Options</sys:String>
      </StringProperty.Description>
    </StringProperty>
  </Rule>
  <ItemType Name="NASM" DisplayName="Netwide Assembler"/>
  <FileExtension Name="*.asm" ContentType="NASM"/>
  <FileExtension Name="*.nasm" ContentType="NASM"/>
  <ContentType Name="NASM" DisplayName="Netwide Assembler" ItemType="NASM"/>
</ProjectSchemaDefinitions>
```

`EDK-II/OpensslLib/OpensslLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{362BEE7E-5FBE-45D4-B303-3C0451E87C35}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <PropertyGroup>
    <IncludePath>$(EDK_PATH)\CryptoPkg\Library\Include;$(EDK_PATH)\CryptoPkg\Library\OpensslLib;$(OPENSSL_PATH);$(OPENSSL_PATH)\crypto\include;$(OPENSSL_PATH)\crypto\modes;$(IncludePath)</IncludePath>
  </PropertyGroup>
  <ItemDefinitionGroup>
    <ClCompile>
      <AdditionalOptions>/wd4133 /wd4244 /wd4245 /wd4267 /wd4701 /wd4305 /wd4306 /wd4702 /wd4706 /wd4311 /wd4090 /wd4146 %(AdditionalOptions)</AdditionalOptions>
      <PreprocessorDefinitions>L_ENDIAN;OPENSSL_SMALL_FOOTPRINT;NO_SYSLOG</PreprocessorDefinitions>
      <UndefinePreprocessorDefinitions>_WIN32;_WIN64;_MSC_VER</UndefinePreprocessorDefinitions>
    </ClCompile>
  </ItemDefinitionGroup>
  <ItemGroup>
    <ClCompile Include="$(OPENSSL_PATH)\crypto\cryptlib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\mem.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\mem_clr.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\mem_dbg.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\cversion.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\ex_data.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\cpt_err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\ebcdic.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\uid.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\o_time.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\o_str.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\o_dir.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\threads_pthread.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\threads_win.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\threads_none.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\o_init.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\o_fips.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\mem_sec.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\init.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\objects\o_names.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\objects\obj_dat.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\objects\obj_lib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\objects\obj_err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\objects\obj_xref.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\md4\md4_dgst.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\md4\md4_one.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\md5\md5_dgst.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\md5\md5_one.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\sha\sha1dgst.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\sha\sha1_one.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\sha\sha256.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\sha\sha512.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\hmac\hmac.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\hmac\hm_ameth.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\hmac\hm_pmeth.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\poly1305\poly1305.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\des\cbc_cksm.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\des\cbc_enc.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\des\cfb64enc.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\des\cfb_enc.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\des\ecb3_enc.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\des\ecb_enc.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\des\fcrypt.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\des\ofb64enc.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\des\ofb_enc.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\des\pcbc_enc.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\des\qud_cksm.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\des\rand_key.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\des\rpc_enc.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\des\set_key.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\des\des_enc.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\des\fcrypt_b.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\des\xcbc_enc.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\des\str2key.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\des\cfb64ede.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\des\ofb64ede.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\aes\aes_core.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\aes\aes_misc.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\aes\aes_ecb.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\aes\aes_cbc.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\aes\aes_cfb.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\aes\aes_ofb.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\aes\aes_ige.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\aes\aes_wrap.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rc4\rc4_skey.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rc4\rc4_enc.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\chacha\chacha_enc.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\modes\cbc128.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\modes\ctr128.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\modes\cts128.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\modes\cfb128.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\modes\ofb128.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\modes\gcm128.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\modes\ccm128.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\modes\xts128.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\modes\wrap128.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\modes\ocb128.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_add.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_div.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_exp.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_lib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_ctx.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_mul.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_mod.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_print.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_rand.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_shift.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_word.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_blind.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_kron.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_sqrt.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_gcd.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_prime.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_sqr.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_asm.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_recp.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_mont.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_mpi.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_exp2.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_gf2m.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_nist.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_depr.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_const.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_x931p.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_intern.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_dh.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bn\bn_srp.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_ossl.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_gen.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_lib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_sign.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_saos.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_pk1.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_ssl.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_none.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_oaep.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_chk.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_null.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_pss.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_x931.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_asn1.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_depr.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_ameth.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_prn.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_pmeth.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_crpt.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rsa\rsa_x931g.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\dh\dh_asn1.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\dh\dh_gen.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\dh\dh_key.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\dh\dh_lib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\dh\dh_check.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\dh\dh_err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\dh\dh_depr.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\dh\dh_ameth.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\dh\dh_pmeth.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\dh\dh_prn.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\dh\dh_rfc5114.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\dh\dh_kdf.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\dso\dso_dl.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\dso\dso_dlfcn.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\dso\dso_err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\dso\dso_lib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\dso\dso_openssl.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\dso\dso_win32.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\dso\dso_vms.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\buffer\buffer.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\buffer\buf_err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\bio_lib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\bio_cb.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\bio_err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\bio_meth.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\bss_mem.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\bss_null.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\bss_fd.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\bss_file.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\bss_sock.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\bss_conn.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\bf_null.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\bf_buff.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\b_dump.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\b_addr.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\b_sock.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\b_sock2.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\bss_acpt.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\bf_nbio.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\bss_log.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\bss_bio.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\bio\bss_dgram.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\stack\stack.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\lhash\lhash.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\lhash\lh_stats.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rand\md_rand.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rand\randfile.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rand\rand_lib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rand\rand_err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rand\rand_egd.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rand\rand_win.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\rand\rand_unix.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\err\err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\err\err_all.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\err\err_prn.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\encode.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\digest.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\evp_enc.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\evp_key.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\evp_cnf.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\e_des.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\e_bf.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\e_idea.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\e_des3.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\e_camellia.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\e_rc4.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\e_aes.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\names.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\e_seed.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\e_xcbc_d.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\e_rc2.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\e_cast.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\e_rc5.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\m_null.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\m_md2.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\m_md4.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\m_md5.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\m_sha1.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\m_wp.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\m_md5_sha1.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\m_mdc2.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\m_ripemd.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\p_open.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\p_seal.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\p_sign.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\p_verify.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\p_lib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\p_enc.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\p_dec.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\bio_md.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\bio_b64.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\bio_enc.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\evp_err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\e_null.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\c_allc.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\c_alld.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\evp_lib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\bio_ok.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\evp_pkey.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\evp_pbe.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\p5_crpt.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\p5_crpt2.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\scrypt.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\e_old.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\pmeth_lib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\pmeth_fn.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\pmeth_gn.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\m_sigver.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\e_aes_cbc_hmac_sha1.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\e_aes_cbc_hmac_sha256.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\e_rc4_hmac_md5.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\e_chacha20_poly1305.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\evp\cmeth_lib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\a_object.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\a_bitstr.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\a_utctm.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\a_gentm.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\a_time.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\a_int.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\a_octet.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\a_print.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\a_type.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\a_dup.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\a_d2i_fp.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\a_i2d_fp.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\a_utf8.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\a_sign.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\a_digest.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\a_verify.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\a_mbstr.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\a_strex.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\x_algor.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\x_val.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\x_sig.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\x_bignum.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\x_long.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\x_info.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\x_spki.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\nsseq.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\d2i_pu.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\d2i_pr.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\i2d_pu.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\i2d_pr.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\t_pkey.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\t_spki.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\t_bitst.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\tasn_new.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\tasn_fre.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\tasn_enc.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\tasn_dec.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\tasn_utl.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\tasn_typ.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\tasn_prn.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\tasn_scn.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\ameth_lib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\f_int.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\f_string.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\n_pkey.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\x_pkey.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\bio_asn1.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\bio_ndef.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\asn_mime.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\asn1_gen.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\asn1_par.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\asn1_lib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\asn1_err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\a_strnid.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\evp_asn1.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\asn_pack.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\p5_pbe.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\p5_pbev2.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\p5_scrypt.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\p8_pkey.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\asn_moid.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\asn1\asn_mstbl.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pem\pem_sign.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pem\pem_info.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pem\pem_lib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pem\pem_all.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pem\pem_err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pem\pem_x509.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pem\pem_xaux.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pem\pem_oth.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pem\pem_pk8.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pem\pem_pkey.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pem\pvkfmt.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509_def.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509_d2.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509_r2x.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509_cmp.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509_obj.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509_req.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509spki.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509_vfy.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509_set.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509cset.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509rset.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509_err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509name.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509_v3.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509_ext.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509_att.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509type.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509_lu.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x_all.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509_txt.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509_trs.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\by_file.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\by_dir.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x509_vpm.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x_crl.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\t_crl.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x_req.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\t_req.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x_x509.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\t_x509.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x_x509a.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x_attrib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x_exten.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x_name.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509\x_pubkey.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_bcons.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_bitst.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_conf.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_extku.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_ia5.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_lib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_prn.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_utl.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_genn.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_alt.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_skey.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_akey.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_pku.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_int.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_enum.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_sxnet.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_cpols.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_crld.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_purp.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_info.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_akeya.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_pmaps.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_pcons.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_ncons.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_pcia.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_pci.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\pcy_cache.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\pcy_node.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\pcy_data.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\pcy_map.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\pcy_tree.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\pcy_lib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_asid.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_addr.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\x509v3\v3_tlsf.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\conf\conf_err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\conf\conf_lib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\conf\conf_api.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\conf\conf_def.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\conf\conf_mod.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\conf\conf_mall.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\conf\conf_sap.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\txt_db\txt_db.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs7\pk7_asn1.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs7\pk7_lib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs7\pkcs7err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs7\pk7_doit.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs7\pk7_smime.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs7\pk7_attr.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs7\pk7_mime.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs7\bio_pk7.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs12\p12_add.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs12\p12_asn.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs12\p12_attr.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs12\p12_crpt.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs12\p12_crt.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs12\p12_decr.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs12\p12_init.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs12\p12_key.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs12\p12_kiss.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs12\p12_mutl.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs12\p12_sbag.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs12\p12_utl.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs12\p12_npas.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs12\pk12err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs12\p12_p8d.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\pkcs12\p12_p8e.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\comp\comp_lib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\comp\comp_err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\comp\c_zlib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\ocsp\ocsp_asn.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\ocsp\ocsp_ext.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\ocsp\ocsp_ht.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\ocsp\ocsp_lib.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\ocsp\ocsp_cl.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\ocsp\ocsp_srv.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\ocsp\ocsp_prn.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\ocsp\ocsp_vfy.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\ocsp\ocsp_err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\ocsp\v3_ocsp.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\cmac\cmac.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\cmac\cm_ameth.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\cmac\cm_pmeth.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\async\async.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\async\async_wait.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\async\async_err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\async\arch\async_posix.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\async\arch\async_win.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\async\arch\async_null.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\kdf\tls1_prf.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\kdf\kdf_err.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\kdf\hkdf.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\blake2\blake2b.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\blake2\m_blake2b.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\blake2\blake2s.c" />
    <ClCompile Include="$(OPENSSL_PATH)\crypto\blake2\m_blake2s.c" />
  </ItemGroup>
</Project>

```

`EDK-II/UefiApplicationEntryPoint/UefiApplicationEntryPoint.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{93D9DC93-154F-47F0-9FCC-C93AA23CB1C3}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiApplicationEntryPoint\ApplicationEntryPoint.c" />
  </ItemGroup>
</Project>

```

`EDK-II/UefiBootServicesTableLib/UefiBootServicesTableLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{8803BB67-A004-4562-8B61-8F49E313A389}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiBootServicesTableLib\UefiBootServicesTableLib.c" />
  </ItemGroup>
</Project>

```

`EDK-II/UefiDebugLibConOut/UefiDebugLibConOut.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{B676BEE0-4049-445C-B20D-C3AD7B3983E4}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiDebugLibConOut\DebugLib.c" />
  </ItemGroup>
</Project>

```

`EDK-II/UefiDevicePathLibDevicePathProtocol/UefiDevicePathLibDevicePathProtocol.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{61686617-D12A-487E-A519-EC4AE9403730}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiDevicePathLibDevicePathProtocol\UefiDevicePathLib.c" />
  </ItemGroup>
</Project>

```

`EDK-II/UefiDriverEntryPoint/UefiDriverEntryPoint.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{A2CFE12C-B942-4A78-97AF-8A0F8FF6DDC7}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiDriverEntryPoint\DriverEntryPoint.c" />
  </ItemGroup>
</Project>

```

`EDK-II/UefiFileHandleLib/UefiFileHandleLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{F93A3A1B-0311-43FB-A6A8-B7592583EDFB}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiFileHandleLib\UefiFileHandleLib.c" />
  </ItemGroup>
</Project>

```

`EDK-II/UefiHiiLib/UefiHiiLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{53122BEE-9C19-4380-8B7F-B9D8FFA28AB0}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\MdeModulePkg\Library\UefiHiiLib\HiiLanguage.c" />
    <ClCompile Include="$(EDK_PATH)\MdeModulePkg\Library\UefiHiiLib\HiiLib.c" />
    <ClCompile Include="$(EDK_PATH)\MdeModulePkg\Library\UefiHiiLib\HiiString.c" />
  </ItemGroup>
</Project>

```

`EDK-II/UefiHiiServicesLib/UefiHiiServicesLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{8B3E5877-7789-4E21-9E7E-497FCFC70AC4}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\MdeModulePkg\Library\UefiHiiServicesLib\UefiHiiServicesLib.c" />
  </ItemGroup>
</Project>

```

`EDK-II/UefiLib/UefiLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{1D620CCA-0BD8-4BEB-A0BC-6D7164E95634}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiLib\Console.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiLib\UefiDriverModel.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiLib\UefiLib.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiLib\UefiLibPrint.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiLib\UefiNotTiano.c" />
  </ItemGroup>
</Project>

```

`EDK-II/UefiMemoryAllocationLib/UefiMemoryAllocationLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{878366AB-B98A-4933-A487-DCE343F51371}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiMemoryAllocationLib\MemoryAllocationLib.c" />
  </ItemGroup>
</Project>

```

`EDK-II/UefiMemoryLib/UefiMemoryLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{450578CF-FB0F-48F3-8249-B4349E252239}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiMemoryLib\CompareMemWrapper.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiMemoryLib\CopyMemWrapper.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiMemoryLib\MemLib.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiMemoryLib\MemLibGeneric.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiMemoryLib\MemLibGuid.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiMemoryLib\ScanMem16Wrapper.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiMemoryLib\ScanMem32Wrapper.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiMemoryLib\ScanMem64Wrapper.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiMemoryLib\ScanMem8Wrapper.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiMemoryLib\SetMem16Wrapper.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiMemoryLib\SetMem32Wrapper.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiMemoryLib\SetMem64Wrapper.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiMemoryLib\SetMemWrapper.c" />
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiMemoryLib\ZeroMemWrapper.c" />
  </ItemGroup>
</Project>

```

`EDK-II/UefiRuntimeLib/UefiRuntimeLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{4801026C-F7EA-4D77-A98B-C075C253CF32}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiRuntimeLib\RuntimeLib.c" />
  </ItemGroup>
</Project>

```

`EDK-II/UefiRuntimeServicesTableLib/UefiRuntimeServicesTableLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{6E4AF2C5-0A16-4467-A6DE-A81E682C2659}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\MdePkg\Library\UefiRuntimeServicesTableLib\UefiRuntimeServicesTableLib.c" />
  </ItemGroup>
</Project>

```

`EDK-II/UefiShellLib/UefiShellLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{D71E4E3B-6239-4AD1-A1C8-272E8673F980}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\ShellPkg\Library\UefiShellLib\UefiShellLib.c" />
  </ItemGroup>
</Project>

```

`EDK-II/UefiSortLib/UefiSortLib.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{9B66ED85-72D6-4581-9A56-4E1F94D0C787}</ProjectGuid>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\edk2.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  <Import Project="$(SolutionDir)\edk2.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemGroup>
    <ClCompile Include="$(EDK_PATH)\MdeModulePkg\Library\UefiSortLib\UefiSortLib.c" />
  </ItemGroup>
</Project>

```

`EDK-II/edk2.default.props`:

```props
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ImportGroup Label="PropertySheets" />
  <PropertyGroup Label="UserMacros">
    <EDK_PATH>$(SolutionDir)..\edk2</EDK_PATH>
    <OPENSSL_PATH>$(SolutionDir)..\openssl</OPENSSL_PATH>
  </PropertyGroup>
  <PropertyGroup>
    <IncludePath>$(EDK_PATH)\MdePkg\Include;$(EDK_PATH)\MdePkg\Include\X64;$(EDK_PATH)\MdeModulePkg\Include;$(EDK_PATH)\ShellPkg\Include;$(EDK_PATH)\CryptoPkg\include;$(OPENSSL_PATH)\include</IncludePath>
  </PropertyGroup>
  <PropertyGroup Label="Configuration">
    <ConfigurationType>StaticLibrary</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>$(DefaultPlatformToolset)</PlatformToolset>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <ItemGroup>
    <BuildMacro Include="EDK_PATH">
      <Value>$(EDK_PATH)</Value>
      <EnvironmentVariable>true</EnvironmentVariable>
    </BuildMacro>
    <BuildMacro Include="OPENSSL_PATH">
      <Value>$(OPENSSL_PATH)</Value>
      <EnvironmentVariable>true</EnvironmentVariable>
    </BuildMacro>
  </ItemGroup>
</Project>

```

`EDK-II/edk2.props`:

```props
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ImportGroup Label="PropertySheets" />
  <PropertyGroup>
    <GenerateManifest />
    <IntDir>$(SolutionDir)$(Platform)\$(Configuration)\obj\$(TargetName)\</IntDir>
    <OutDir>$(SolutionDir)$(Platform)\$(Configuration)\</OutDir>
  </PropertyGroup>
  <ItemDefinitionGroup>
    <ClCompile>
      <WholeProgramOptimization>true</WholeProgramOptimization>
      <WarningLevel>Level4</WarningLevel>
      <TreatWarningAsError>true</TreatWarningAsError>
      <MultiProcessorCompilation>true</MultiProcessorCompilation>
      <Optimization>MinSpace</Optimization>
      <IntrinsicFunctions>true</IntrinsicFunctions>
      <OmitFramePointers>true</OmitFramePointers>
      <InlineFunctionExpansion>AnySuitable</InlineFunctionExpansion>
      <ExceptionHandling>SyncCThrow</ExceptionHandling>
      <BufferSecurityCheck>false</BufferSecurityCheck>
      <ControlFlowGuard>false</ControlFlowGuard>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <ForcedIncludeFiles>$(SolutionDir)\BaseLib\vshacks.h</ForcedIncludeFiles>
      <CallingConvention />
      <TreatWChar_tAsBuiltInType />
      <StringPooling>true</StringPooling>
      <RuntimeTypeInfo>false</RuntimeTypeInfo>
      <ForceConformanceInForLoopScope />
      <AdditionalOptions>/Gs32768 %(AdditionalOptions)</AdditionalOptions>
      <ErrorReporting />
      <FloatingPointModel />
    </ClCompile>
    <Link>
      <AdditionalDependencies />
    </Link>
    <Link>
      <IgnoreAllDefaultLibraries>true</IgnoreAllDefaultLibraries>
      <GenerateDebugInformation>Debug</GenerateDebugInformation>
      <SubSystem>EFI Boot Service Driver</SubSystem>
      <Driver>Driver</Driver>
      <OptimizeReferences>true</OptimizeReferences>
      <EnableCOMDATFolding />
      <LinkTimeCodeGeneration>UseFastLinkTimeCodeGeneration</LinkTimeCodeGeneration>
      <BaseAddress>0</BaseAddress>
      <SectionAlignment>32</SectionAlignment>
      <ImageHasSafeExceptionHandlers>false</ImageHasSafeExceptionHandlers>
      <RegisterOutput>true</RegisterOutput>
      <RandomizedBaseAddress />
      <DataExecutionPrevention />
      <ManifestFile />
      <AllowIsolation />
      <EnableUAC />
      <UACExecutionLevel />
      <UACUIAccess />
      <TypeLibraryResourceID />
      <AdditionalOptions>/OPT:ICF=10 /IGNORE:4001 /IGNORE:4254 /IGNORE:4281 %(AdditionalOptions)</AdditionalOptions>
      <MergeSections>.rdata=.data</MergeSections>
      <SpecifySectionAttributes>.pdata,D</SpecifySectionAttributes>
      <LinkErrorReporting />
      <ProfileGuidedDatabase />
    </Link>
  </ItemDefinitionGroup>
</Project>

```

`LICENSE`:

```
BSD 2-Clause License

Copyright (c) 2021, smUrfsCC
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this
   list of conditions and the following disclaimer.

2. Redistributions in binary form must reproduce the above copyright notice,
   this list of conditions and the following disclaimer in the documentation
   and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

```

`README.md`:

```md
#### Hello Everyone 


> #### I had this in mind for a long time but I finally got to do it. Originally I was intending to either keep it for myself or sell it, but you know what? Fuck it.

> #### This rainbow spoofer essentially hooks ExitBootServices to get return address to OslFwpKernelSetupPhase1, then it runs sigscan to find OslLoaderBlock and other crap from  there. It hooks IopLoadDriver to perform the spoofing and then unhooks itself.

> #### I have decided not to release the source code yet, because I want to keep it fine for some time until it starts to get flagged. Once it gets flagged, I will publish the source code. The source will be pushed to this GitHub repo.

![r8xNj4f](https://user-images.githubusercontent.com/85826349/126073571-3c35c50f-fe28-4fd2-a640-728b2a5da5f1.png)

![6tS6Yxf](https://user-images.githubusercontent.com/85826349/126073581-8360fde5-c8e8-46b4-bcf7-cf3d8bb8345a.png)

![hLGMoiB](https://user-images.githubusercontent.com/85826349/126073582-93669e82-0712-434c-bf81-99265633e031.png)




## See Video [Click Here](https://streamable.com/dg1tew)


## Usage
Download rainbow.efi and a copy of EDK2 efi shell (direct link). Now follow these steps:

1. Extract downloaded efi shell and rename file Shell.efi (should be in folder UefiShell/X64) to bootx64.efi
2. Format some USB drive to FAT32
3. Create following folder structure

##### Code

```
1.USB:.
2. │   rainbow.efi
3. │
4. └───EFI
5.      └───Boot
6.              bootx64.efi
```
4. Boot from the USB drive
5. An UEFI shell should start, change directory to your USB (FS0 should be the USB since we are booting from it) and list files

##### Code

```
1.FS0:
2.ls
```

6. You should see file rainbow.efi, if you do, load it

##### Code

```
load rainbow.efi
```

7. Now you should see output from rainbow. If it was successful, exit and boot into Windows (change to Windows boot media - usually FS1 - and run \EFI\Boot\bootx64.efi)

#### Download

*Version 0.0.1*

- Target Windows build: 20H2 (19042.xxx)
- Download: [Click](https://github.com/SmurfsCC/-Rainbow---EFI/releases/tag/Rainbow)


### Note 

##### to mods: The URL (rainbow.tulach.cc) is just a redirect to that GitHub page. The page itself is my blog (other people have been also linking their blogs so I presume it's fine?). Originally it was intended as a webpage for it, and now I am lazy to rebuild since I am already on my laptop (gonna be midnight). If it's triggering you, I will rebuild it and retake the screenshots and video tomorrow.

### Note

##### to mods 2: The compiled file uses simple compile time XOR for text. I did this to prevent people from simply byte-patching it. If you need PDB files to check it (or even the source) then I will provide it to you.

**EDIT**

###### Source code has been released. Please check out the GitHub repo. The source code is provided "as-is" and I will not be providing any support for that.

              

```

`rainbow/LICENSE.txt`:

```txt
Copyright (c) 2021 Samuel Tulach

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.
```

`rainbow/UefiDriver/UefiDriver.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{DF325AB7-67A6-473E-93FF-16955AFBC063}</ProjectGuid>
    <ProjectName>rainbow</ProjectName>
    <WindowsTargetPlatformVersion>10.0</WindowsTargetPlatformVersion>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(SolutionDir)\rainbow.default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <Import Project="$(SolutionDir)\rainbow.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  <ItemDefinitionGroup>
    <Link>
      <AdditionalDependencies>UefiDriverEntryPoint.lib;%(AdditionalDependencies)</AdditionalDependencies>
      <GenerateDebugInformation Condition="'$(Configuration)|$(Platform)'=='Release|x64'">DebugFull</GenerateDebugInformation>
      <SubSystem Condition="'$(Configuration)|$(Platform)'=='Release|x64'">EFI Runtime</SubSystem>
    </Link>
    <ClCompile>
      <LanguageStandard Condition="'$(Configuration)|$(Platform)'=='Release|x64'">stdcpp17</LanguageStandard>
      <Optimization Condition="'$(Configuration)|$(Platform)'=='Release|x64'">Disabled</Optimization>
      <DisableSpecificWarnings Condition="'$(Configuration)|$(Platform)'=='Release|x64'">4804;4162;4201</DisableSpecificWarnings>
    </ClCompile>
  </ItemDefinitionGroup>
  <ItemGroup>
    <ClCompile Include="console.cpp" />
    <ClCompile Include="hooks.cpp" />
    <ClCompile Include="main.cpp" />
    <ClCompile Include="utils.cpp" />
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="console.h" />
    <ClInclude Include="general.h" />
    <ClInclude Include="hooks.h" />
    <ClInclude Include="ntdef.h" />
    <ClInclude Include="utils.h" />
    <ClInclude Include="xor.h" />
  </ItemGroup>
</Project>
```

`rainbow/UefiDriver/console.cpp`:

```cpp
#include "general.h"

UINTN Console::IntToColor(UINTN input)
{
    switch (input)
    {
    case 0:
        return EFI_LIGHTBLUE;
    case 1:
        return EFI_LIGHTGREEN;
    case 2:
        return EFI_LIGHTCYAN;
    case 3:
        return EFI_LIGHTRED;
    case 4:
        return EFI_LIGHTMAGENTA;
    case 5:
        return EFI_YELLOW;
    case 6:
        return EFI_LIGHTBLUE;
    default:
        return EFI_BLUE;
    }
}

void Console::ClearScreen()
{
    gST->ConOut->SetAttribute(gST->ConOut, EFI_WHITE | EFI_BACKGROUND_BLACK);
    gST->ConOut->ClearScreen(gST->ConOut);
    Print(EW(L"\n"));
}

void Console::PrintTitle()
{
    auto* text = EW(L"rainbow");
    for (INTN i = 0; i < 7; i++)
    {
        gST->ConOut->SetAttribute(gST->ConOut, IntToColor(i) | EFI_BACKGROUND_BLACK);
        Print(EW(L"%c"), text[i]);
    }
    gST->ConOut->SetAttribute(gST->ConOut, EFI_WHITE | EFI_BACKGROUND_BLACK);
    Print(EW(L"\nbuild on %a\n\n"), __DATE__);

    Print(EW(L"For updates visit rainbow.tulach.cc (official project website).\n"));

    gST->ConOut->SetAttribute(gST->ConOut, EFI_RED | EFI_BACKGROUND_BLACK);
    Print(EW(L"Use this at your own risk. This is pre-release version.\n\n"));

    gST->ConOut->SetAttribute(gST->ConOut, EFI_WHITE | EFI_BACKGROUND_BLACK);
    gBS->Stall(SEC_TO_MICRO(3));
}

void Console::Startup()
{
    ClearScreen();
    PrintTitle();
}
```

`rainbow/UefiDriver/console.h`:

```h
#pragma once

namespace Console
{
    UINTN IntToColor(UINTN input);
    void ClearScreen();
    void PrintTitle();
    void Startup();
}
```

`rainbow/UefiDriver/general.h`:

```h
#pragma once

#define EXTERN_C extern "C"
#define UNREFERENCED_PARAMETER(P) (P)

#define BIT32_MAX 0xffffffff
#define BIT64_MAX 0xffffffffffffffff
#define SCAN_MAX 0x5f5e100

#define INFINITE_LOOP() \
    while (TRUE) \
    { \
    }

#define SEC_TO_MICRO(x) ((UINTN)(x) * 1000 * 1000)

EXTERN_C
{
    /*
     * All EDK2 includes are made for C so we need to use
     * extern C with them
     */
    #include <Uefi.h>
    #include <Library/UefiLib.h>
    #include <Library/UefiBootServicesTableLib.h>
    #include <Library/UefiRuntimeServicesTableLib.h>
    #include <Library/UefiRuntimeLib.h>
    #include <Library/DebugLib.h>
    #include <Library/BaseLib.h>
    #include <Library/BaseMemoryLib.h>
    #include <Protocol/LoadedImage.h>
    #include <Library/DevicePathLib.h>

    void _disable(void);
    void _enable(void);
    unsigned __int64 __readcr0(void);
    void __writecr0(unsigned __int64 data);
}

/*
 * Those headers require C++ and CAN NOT be used with pure C
 */
#include "console.h"
#include "xor.h"
#include "ntdef.h"
#include "utils.h"
#include "hooks.h"
```

`rainbow/UefiDriver/hooks.cpp`:

```cpp
#include "general.h"

void Hooks::Hook()
{
    Utils::CopyToReadOnly(function, newData, 15);
}

void Hooks::Unhook()
{
    Utils::CopyToReadOnly(function, originalData, 15);
}

VOID* Hooks::GetModuleBase(const CHAR16* moduleName)
{
    static LIST_ENTRY* PsLoadedModuleList = nullptr;
    if (!PsLoadedModuleList)
        PsLoadedModuleList = *reinterpret_cast<LIST_ENTRY**>(Utils::GetExport(kernelBase, E("PsLoadedModuleList")));

    auto moduleInfo = Utils::GetModule(PsLoadedModuleList, moduleName);
    return moduleInfo.DllBase;
}

EFI_STATUS Hooks::ChangeDiskDispatch()
{
    VOID* base = GetModuleBase(EW(L"CLASSPNP.SYS"));
    if (!base)
        return EFI_NOT_FOUND;

    /*
     * ClassMpdevInternalDeviceControl
     * It will instantly return with unsuccessful status
     */
    UINT64 scan = Utils::FindPatternImage(base, E("40 53 48 83 EC 20 48 8B 41 40 48 8B DA 4C 8B C1 80 B8 ? ? ? ? ? 74 57"));
    if (!scan)
        return EFI_NOT_FOUND;

    static RtlInitUnicodeString_t RtlInitUnicodeString = nullptr;
    if (!RtlInitUnicodeString)
        RtlInitUnicodeString = reinterpret_cast<RtlInitUnicodeString_t>(Utils::GetExport(kernelBase, E("RtlInitUnicodeString")));

    UNICODE_STRING targetName;
    RtlInitUnicodeString(&targetName, EW(L"\\Driver\\Disk"));

    static ObReferenceObjectByName_t ObReferenceObjectByName = nullptr;
    if (!ObReferenceObjectByName)
        ObReferenceObjectByName = reinterpret_cast<ObReferenceObjectByName_t>(Utils::GetExport(kernelBase, E("ObReferenceObjectByName")));

    static POBJECT_TYPE* IoDriverObjectType = nullptr;
    if (!IoDriverObjectType)
        IoDriverObjectType = reinterpret_cast<POBJECT_TYPE*>(Utils::GetExport(kernelBase, E("IoDriverObjectType")));

    PDRIVER_OBJECT driverObject;
    auto status = ObReferenceObjectByName(&targetName, OBJ_CASE_INSENSITIVE | OBJ_KERNEL_HANDLE, nullptr, 0, *IoDriverObjectType, KernelMode, nullptr, reinterpret_cast<VOID**>(&driverObject));
    if (status != 0)
        return EFI_NOT_READY;

    *reinterpret_cast<UINT64*>(&driverObject->MajorFunction[IRP_MJ_DEVICE_CONTROL]) = scan;

    static ObfDereferenceObject_t ObfDereferenceObject = nullptr;
    if (!ObfDereferenceObject)
        ObfDereferenceObject = reinterpret_cast<ObfDereferenceObject_t>(Utils::GetExport(kernelBase, E("ObfDereferenceObject")));

    ObfDereferenceObject(driverObject);
    return EFI_SUCCESS;
}

EFI_STATUS Hooks::ChangeNetworkDispatch()
{
    VOID* base = GetModuleBase(EW(L"ndis.sys"));
    if (!base)
        return EFI_NOT_FOUND;

    /*
     * ndisDummyIrpHandler
     * M$ was so kind to have this function in there
     */
    UINT64 scan = Utils::FindPatternImage(base, E("48 8D 05 ? ? ? ? B9 ? ? ? ? 49 8D 7E 70"));
    if (!scan)
        return EFI_NOT_FOUND;
    scan = reinterpret_cast<UINT64>(RELATIVE_ADDRESS((UINT8*)scan, 7));

    /*
     * _NDIS_M_DRIVER_BLOCK* ndisMiniDriverList
     */
    UINT64 listScan = Utils::FindPatternImage(base, E("48 8B 35 ? ? ? ? 44 0F B6 E0"));
    if (!listScan)
        return EFI_NOT_FOUND;

    bool found = false;
    PNDIS_M_DRIVER_BLOCK block = *static_cast<PNDIS_M_DRIVER_BLOCK*>(RELATIVE_ADDRESS(listScan, 7));
    for (PNDIS_M_DRIVER_BLOCK currentDriver = block; currentDriver; currentDriver = static_cast<PNDIS_M_DRIVER_BLOCK>(currentDriver->NextDriver))
    {
        if (!currentDriver->DriverObject)
            continue;

        if (!currentDriver->DriverObject->MajorFunction)
            continue;

        *reinterpret_cast<UINT64*>(&currentDriver->DriverObject->MajorFunction[IRP_MJ_DEVICE_CONTROL]) = scan;
        found = true;
    }

    return found ? EFI_SUCCESS : EFI_NOT_FOUND;
}

EFI_STATUS Hooks::ZeroSmbiosData()
{
    /*
     * WmipFindSMBiosStructure -> WmipSMBiosTablePhysicalAddress
     */
    auto* physicalAddress = reinterpret_cast<LARGE_INTEGER*>(Utils::FindPatternImage(kernelBase, E("48 8B 0D ? ? ? ? 48 85 C9 74 ? 8B 15")));
    if (!physicalAddress)
        return EFI_NOT_FOUND;

    physicalAddress = reinterpret_cast<LARGE_INTEGER*>(reinterpret_cast<char*>(physicalAddress) + 7 + *reinterpret_cast<int*>(reinterpret_cast<char*>(physicalAddress) + 3));
    if (!physicalAddress)
        return EFI_NOT_FOUND;

    Utils::SetMemory(physicalAddress, 0, sizeof(LARGE_INTEGER));

    return EFI_SUCCESS;
}

INTN Hooks::HookedIopLoadDriver(VOID* KeyHandle)
{
    /*
     * I originally did not want to release this source
     * for one simple reason and that is this "clever DKOM" (kek)
     * I have mentioned. All of this spoofing work in incredibly
     * primitive way.
     *
     * We take the dispatch of given driver (let's say disk.sys)
     * and we simply replace its device control function in its
     * DriverObject.
     *
     * Normally this would be a big red flag so how is that it was
     * not getting people instantly banned?
     *
     * Anticheats do a very simple checks on those dispatches. If
     * it points to a legit driver, it basically means it valid.
     * If you can get it to point to the driver it's actually intended
     * to point in, then congratulations, you won!
     *
     * How can we manage to do such a thing without patching the target
     * driver itself? Well... We can just choose any function that will
     * instantly return! When any software then tries to access the
     * driver's functionality, it will just instantly error out with no data
     * output.
     *
     * In our example of disk.sys, we will point it to ClassMpdevInternalDeviceControl
     * which (as I said before) will immediately return and error out.
     * The system will then think there are not drives attached.
     *
     * To actually detect this, you would have to know where the original function
     * is supposed to be pointing or just start kicking people who's dispatch
     * errors out (because it's basically impossible for it to fail in normal conditions).
     */

     /*
      * Unhook so we can call original
      */
    Unhook();

    /*
     * Call original
     */
    INTN status = function(KeyHandle);

    /*
     * Hook the function back so this will get called again
     */
    Hook();

    /*
     * We don't care if the driver load was unsuccessful
     */
    if (status != 0)
        return status;

    /*
     * Resolve DbgPrintEx for possible debugging
     */
    static DbgPrintEx_t DbgPrintEx = nullptr;
    if (!DbgPrintEx)
        DbgPrintEx = reinterpret_cast<DbgPrintEx_t>(Utils::GetExport(kernelBase, E("DbgPrintEx")));

    /*
     * When everything is done, we will stop hooking
     * and exit
     */
    static bool diskDone = false;
    static bool nicDone = false;
    static bool smbiosDone = false;

    /*
     * Change disk dispatch
     */
    if (!diskDone && ChangeDiskDispatch() == EFI_SUCCESS)
        diskDone = true;

    /*
     * Change dispatch of every network adapter
     */
    if (!nicDone && ChangeNetworkDispatch() == EFI_SUCCESS)
        nicDone = true;

    /*
     * Zero out the address of SMBIOS structure
     */
    if (!smbiosDone && ZeroSmbiosData() == EFI_SUCCESS)
        smbiosDone = true;

    /*
     * Everything is done so do final unhook and bye bye
     */
    if (diskDone && nicDone && smbiosDone)
    {
        /*
         * Oh hey! You actually reading the code?
         * You might want to delete this print...
         */
        DbgPrintEx(0, 0, "[efi] All set, exiting\n");
        Unhook();
    }

    /*
     * Just a quick sidenote here, sometimes it randomly fails to unhook
     * and you will get patchguard crash (+ probably you will get flagged)
     * I am too lazy to figure out what is wrong, you can try that
     */

    return 0;
}
```

`rainbow/UefiDriver/hooks.h`:

```h
#pragma once

namespace Hooks
{
    inline INT8 originalData[15];
    inline INT8 newData[15];
    typedef INTN(__stdcall* IopLoadDriver_t)(VOID* KeyHandle);
    inline IopLoadDriver_t function;
    inline VOID* kernelBase;

    void Hook();
    void Unhook();

    VOID* GetModuleBase(const CHAR16* moduleName);
    EFI_STATUS ChangeDiskDispatch();
    EFI_STATUS ChangeNetworkDispatch();
    EFI_STATUS ZeroSmbiosData();

    INTN HookedIopLoadDriver(VOID* KeyHandle);
}
```

`rainbow/UefiDriver/main.cpp`:

```cpp
#include "general.h"

/*
 * Exports for the VisualUefi and EDK2 driver libraries
 */
EXTERN_C const UINT8 _gDriverUnloadImageCount = 1;
EXTERN_C const UINT32 _gUefiDriverRevision = 0x200;
EXTERN_C const UINT32 _gDxeRevision = 0x200;
/*
 * Requires you to add extern "C" to vshacks.h in VisualUefi
 */
EXTERN_C CHAR8* gEfiCallerBaseName = "BaseLib2";

typedef void(__stdcall* BlpArchSwitchContext_t)(int target);
BlpArchSwitchContext_t BlpArchSwitchContext;

EFI_EXIT_BOOT_SERVICES originalExitBootServices;

#define ContextPrint(x, ...) \
    BlpArchSwitchContext(FirmwareContext); \
    Print(x, __VA_ARGS__); \
    BlpArchSwitchContext(ApplicationContext); \

__forceinline VOID* GetVirtual(VOID* physical)
{
    /*
     * Convert physical address to virtual using EFI
     * runtime services
     * Usable only when calling SetVirtualAddressMap
     */
    VOID* address = physical;
    gRT->ConvertPointer(0, &address);
    return address;
}

EFI_EVENT virtualEvent = NULL;
VOID EFIAPI NotifySetVirtualAddressMap(EFI_EVENT Event, VOID* Context)
{
    /*
     * Believe it or not, we are currently in the application
     * context
     * You could probably not even use BlpArchSwitchContext and you do all
     * the crap from here, but I already wrote what I wrote so fuck it...
     */
    Utils::CopyMemory(Hooks::originalData, Hooks::function, 15);

    /*
     * Simple absolute jump, nothing fancy
     */
    UINT8 jump[] = { 0x48, 0x31, 0xc0, 0x48, 0xb8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xe0 };
    *reinterpret_cast<UINT64*>(reinterpret_cast<UINT64>(jump) + 5) = reinterpret_cast<UINT64>(GetVirtual(Hooks::HookedIopLoadDriver));

    Utils::CopyMemory(Hooks::newData, jump, 15);
    Hooks::Hook();
}

EFI_STATUS HookedExitBootServices(EFI_HANDLE ImageHandle, UINTN MapKey)
{
    /*
     * Will be pointing somewhere in OslFwpKernelSetupPhase1
     */
    UINT64 returnAddress = reinterpret_cast<UINT64>(_ReturnAddress());

    /*
     * Might be called multiple times by winload in a loop failing few times
     */
    gBS->ExitBootServices = originalExitBootServices;

    /*
     * Clean the screen and set the appropriate colors
     */
    gST->ConOut->SetAttribute(gST->ConOut, EFI_WHITE | EFI_BACKGROUND_BLACK);
    gST->ConOut->ClearScreen(gST->ConOut);
    Print(EW(L"OslFwpKernelSetupPhase1   -> (phys) 0x%p\n"), returnAddress);

    /*
     * OslFwpKernelSetupPhase1 -> 00000001800060D8
     * OslExecuteTransition    -> 000000018001639C
     * BlpArchSwitchContext    -> 000000018002CA48
     */

     /*
      * Start of OslExecuteTransition
      */
    UINT64 loaderBlockScan = Utils::FindPattern(reinterpret_cast<VOID*>(returnAddress), SCAN_MAX, E("48 8B 3D ? ? ? ? 48 8B 8F ? ? ? ?"));
    if (!loaderBlockScan)
    {
        Print(EW(L"Failed to find OslExecuteTransition!\n"));
        INFINITE_LOOP();
    }
    Print(EW(L"OslExecuteTransition      -> (phys) 0x%p\n"), loaderBlockScan);

    /*
     * Resolve relative address (instruction end address + instruction offset)
     */
    UINT64 resolvedAddress = *reinterpret_cast<UINT64*>((loaderBlockScan + 7) + *reinterpret_cast<int*>(loaderBlockScan + 3));
    Print(EW(L"OslLoaderBlock            -> (virt) 0x%p\n"), resolvedAddress);

    /*
     * BlpArchSwitchContext
     */
    BlpArchSwitchContext = reinterpret_cast<BlpArchSwitchContext_t>(Utils::FindPattern(reinterpret_cast<VOID*>(returnAddress), SCAN_MAX, E("40 53 48 83 EC 20 48 8B 15")));
    if (!BlpArchSwitchContext)
    {
        Print(EW(L"Failed to find BlpArchSwitchContext!\n"));
        INFINITE_LOOP();
    }
    Print(EW(L"BlpArchSwitchContext      -> (phys) 0x%p\n"), BlpArchSwitchContext);

    /*
     * Switch context to (as defined by winload) application context
     * Within this context only the virtual addresses are valid
     * Real/physical addressing is not used
     * We can not use any EFI services unless we switch back!
     * To print on screen use ContextPrint define
     */
    BlpArchSwitchContext(ApplicationContext);

    PLOADER_PARAMETER_BLOCK loaderBlock = reinterpret_cast<PLOADER_PARAMETER_BLOCK>(resolvedAddress);
    UINT32 majorVersion = loaderBlock->OsMajorVersion;
    UINT32 minorVersion = loaderBlock->OsMinorVersion;
    UINT32 size = loaderBlock->Size;
    ContextPrint(EW(L"LOADER_PARAMETER_BLOCK    -> OsMajorVersion: %d OsMinorVersion: %d Size: %d\n"), majorVersion, minorVersion, size);

    auto kernelModule = Utils::GetModule(&loaderBlock->LoadOrderListHead, EW(L"ntoskrnl.exe"));
    if (!kernelModule.DllBase)
    {
        ContextPrint(EW(L"Failed to find ntoskrnl.exe in OslLoaderBlock!\n"));
        INFINITE_LOOP();
    }
    ContextPrint(EW(L"ntoskrnl.exe              -> (virt) 0x%p\n"), kernelModule.DllBase);

    UINT64 loadDriverScan = Utils::FindPatternImage(kernelModule.DllBase, E("E8 ? ? ? ? 33 D2 8B D8 44 8B FA"));
    if (!loadDriverScan)
    {
        ContextPrint(EW(L"Failed to find reference to IopLoadDriver!\n"));
        INFINITE_LOOP();
    }
    resolvedAddress = (loadDriverScan + 5) + *reinterpret_cast<int*>(loadDriverScan + 1);

    /*
     * We can't perform the hook here since we don't have the virtual address
     * mapping yet
     */
    Hooks::function = reinterpret_cast<Hooks::IopLoadDriver_t>(resolvedAddress);
    Hooks::kernelBase = kernelModule.DllBase;
    ContextPrint(EW(L"IopLoadDriver             -> (virt) 0x%p\n"), Hooks::function);

    /*
     * Switch back to firmware context before calling real ExitBootServices
     */
    BlpArchSwitchContext(FirmwareContext);

    /*
     * Wait so the text on screen is visible
     */
    gBS->Stall(SEC_TO_MICRO(1));

    /*
     * Call the original
     */
    return originalExitBootServices(ImageHandle, MapKey);
}

EXTERN_C EFI_STATUS EFIAPI UefiUnload(EFI_HANDLE ImageHandle)
{
    UNREFERENCED_PARAMETER(ImageHandle);
    return EFI_ACCESS_DENIED;
}

EXTERN_C EFI_STATUS EFIAPI UefiMain(EFI_HANDLE ImageHandle, EFI_SYSTEM_TABLE* SystemTable)
{
    UNREFERENCED_PARAMETER(ImageHandle);
    UNREFERENCED_PARAMETER(SystemTable);

    Console::Startup();

    originalExitBootServices = gBS->ExitBootServices;
    gBS->ExitBootServices = HookedExitBootServices;

    EFI_STATUS status = gBS->CreateEvent(EVT_SIGNAL_VIRTUAL_ADDRESS_CHANGE, TPL_NOTIFY, NotifySetVirtualAddressMap, NULL, &virtualEvent);
    ASSERT_EFI_ERROR(status);

    return EFI_SUCCESS;
}
```

`rainbow/UefiDriver/ntdef.h`:

```h
#pragma once

/*
 * All sorts of defines related to Windows kernel
 * https://www.vergiliusproject.com/
 * Windows SDK/DDK
 */

typedef struct _UNICODE_STRING
{
    UINT16 Length;
    UINT16 MaximumLength;
    CHAR16* Buffer;
} UNICODE_STRING, * PUNICODE_STRING;

typedef struct _KLDR_DATA_TABLE_ENTRY
{
    struct _LIST_ENTRY InLoadOrderLinks;
    VOID* ExceptionTable;
    UINT32 ExceptionTableSize;
    VOID* GpValue;
    struct _NON_PAGED_DEBUG_INFO* NonPagedDebugInfo;
    VOID* DllBase;
    VOID* EntryPoint;
    UINT32 SizeOfImage;
    struct _UNICODE_STRING FullDllName;
    struct _UNICODE_STRING BaseDllName;
    UINT32 Flags;
    UINT16 LoadCount;
    union
    {
        UINT16 SignatureLevel : 4;
        UINT16 SignatureType : 3;
        UINT16 Unused : 9;
        UINT16 EntireField;
    } u1;
    VOID* SectionPointer;
    UINT32 CheckSum;
    UINT32 CoverageSectionSize;
    VOID* CoverageSection;
    VOID* LoadedImports;
    VOID* Spare;
    UINT32 SizeOfImageNotRounded;
    UINT32 TimeDateStamp;
} KLDR_DATA_TABLE_ENTRY, * PKLDR_DATA_TABLE_ENTRY;

typedef struct _LOADER_PARAMETER_BLOCK
{
    UINT32 OsMajorVersion;
    UINT32 OsMinorVersion;
    UINT32 Size;
    UINT32 OsLoaderSecurityVersion;
    struct _LIST_ENTRY LoadOrderListHead;
    struct _LIST_ENTRY MemoryDescriptorListHead;
    struct _LIST_ENTRY BootDriverListHead;
    struct _LIST_ENTRY EarlyLaunchListHead;
    struct _LIST_ENTRY CoreDriverListHead;
    struct _LIST_ENTRY CoreExtensionsDriverListHead;
    struct _LIST_ENTRY TpmCoreDriverListHead;
} LOADER_PARAMETER_BLOCK, * PLOADER_PARAMETER_BLOCK;

#define CONTAINING_RECORD(address, type, field) ((type *)( \
                                                  (char*)(address) - \
                                                  (UINT64)(&((type *)0)->field)))

typedef struct _IMAGE_FILE_HEADER
{
    UINT16 Machine;
    UINT16 NumberOfSections;
    UINT32 TimeDateStamp;
    UINT32 PointerToSymbolTable;
    UINT32 NumberOfSymbols;
    UINT16 SizeOfOptionalHeader;
    UINT16 Characteristics;
} IMAGE_FILE_HEADER, * PIMAGE_FILE_HEADER;

typedef struct _IMAGE_DATA_DIRECTORY
{
    UINT32 VirtualAddress;
    UINT32 Size;
} IMAGE_DATA_DIRECTORY, * PIMAGE_DATA_DIRECTORY;

#define IMAGE_NUMBEROF_DIRECTORY_ENTRIES 16

typedef struct _IMAGE_OPTIONAL_HEADER64
{
    UINT16 Magic;
    UINT8 MajorLinkerVersion;
    UINT8 MinorLinkerVersion;
    UINT32 SizeOfCode;
    UINT32 SizeOfInitializedData;
    UINT32 SizeOfUninitializedData;
    UINT32 AddressOfEntryPoint;
    UINT32 BaseOfCode;
    UINT64 ImageBase;
    UINT32 SectionAlignment;
    UINT32 FileAlignment;
    UINT16 MajorOperatingSystemVersion;
    UINT16 MinorOperatingSystemVersion;
    UINT16 MajorImageVersion;
    UINT16 MinorImageVersion;
    UINT16 MajorSubsystemVersion;
    UINT16 MinorSubsystemVersion;
    UINT32 Win32VersionValue;
    UINT32 SizeOfImage;
    UINT32 SizeOfHeaders;
    UINT32 CheckSum;
    UINT16 Subsystem;
    UINT16 DllCharacteristics;
    UINT64 SizeOfStackReserve;
    UINT64 SizeOfStackCommit;
    UINT64 SizeOfHeapReserve;
    UINT64 SizeOfHeapCommit;
    UINT32 LoaderFlags;
    UINT32 NumberOfRvaAndSizes;
    IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES];
} IMAGE_OPTIONAL_HEADER64, * PIMAGE_OPTIONAL_HEADER64;

typedef struct _IMAGE_NT_HEADERS64
{
    UINT32 Signature;
    IMAGE_FILE_HEADER FileHeader;
    IMAGE_OPTIONAL_HEADER64 OptionalHeader;
} IMAGE_NT_HEADERS64, * PIMAGE_NT_HEADERS64, IMAGE_NT_HEADERS, * PIMAGE_NT_HEADERS;

typedef struct _IMAGE_DOS_HEADER
{
    UINT16 e_magic;                     // Magic number
    UINT16 e_cblp;                      // Bytes on last page of file
    UINT16 e_cp;                        // Pages in file
    UINT16 e_crlc;                      // Relocations
    UINT16 e_cparhdr;                   // Size of header in paragraphs
    UINT16 e_minalloc;                  // Minimum extra paragraphs needed
    UINT16 e_maxalloc;                  // Maximum extra paragraphs needed
    UINT16 e_ss;                        // Initial (relative) SS value
    UINT16 e_sp;                        // Initial SP value
    UINT16 e_csum;                      // Checksum
    UINT16 e_ip;                        // Initial IP value
    UINT16 e_cs;                        // Initial (relative) CS value
    UINT16 e_lfarlc;                    // File address of relocation table
    UINT16 e_ovno;                      // Overlay number
    UINT16 e_res[4];                    // Reserved words
    UINT16 e_oemid;                     // OEM identifier (for e_oeminfo)
    UINT16 e_oeminfo;                   // OEM information; e_oemid specific
    UINT16 e_res2[10];                  // Reserved words
    INT32 e_lfanew;                     // File address of new exe header
} IMAGE_DOS_HEADER, * PIMAGE_DOS_HEADER;

#define IMAGE_SIZEOF_SHORT_NAME 8

typedef struct _IMAGE_SECTION_HEADER
{
    UINT8 Name[IMAGE_SIZEOF_SHORT_NAME];
    union
    {
        UINT32 PhysicalAddress;
        UINT32 VirtualSize;
    } Misc;
    UINT32 VirtualAddress;
    UINT32 SizeOfRawData;
    UINT32 PointerToRawData;
    UINT32 PointerToRelocations;
    UINT32 PointerToLinenumbers;
    UINT16 NumberOfRelocations;
    UINT16 NumberOfLinenumbers;
    UINT32 Characteristics;
} IMAGE_SECTION_HEADER, * PIMAGE_SECTION_HEADER;

#define FIELD_OFFSET(type, field)    ((INT32)(INT64)&(((type *)0)->field))
#define UFIELD_OFFSET(type, field)    ((UINT32)(INT64)&(((type *)0)->field))

#define IMAGE_FIRST_SECTION( ntheader ) ((PIMAGE_SECTION_HEADER)        \
    ((UINT64)(ntheader) +                                            \
     FIELD_OFFSET( IMAGE_NT_HEADERS, OptionalHeader ) +                 \
     ((ntheader))->FileHeader.SizeOfOptionalHeader   \
    ))

enum WinloadContext
{
    ApplicationContext,
    FirmwareContext
};

#define IMAGE_DOS_SIGNATURE 0x5A4D
#define IMAGE_NT_SIGNATURE 0x00004550

#define IMAGE_DIRECTORY_ENTRY_EXPORT 0
#define IMAGE_DIRECTORY_ENTRY_IMPORT 1

typedef struct _IMAGE_EXPORT_DIRECTORY
{
    UINT32 Characteristics;
    UINT32 TimeDateStamp;
    UINT16 MajorVersion;
    UINT16 MinorVersion;
    UINT32 Name;
    UINT32 Base;
    UINT32 NumberOfFunctions;
    UINT32 NumberOfNames;
    UINT32 AddressOfFunctions;
    UINT32 AddressOfNames;
    UINT32 AddressOfNameOrdinals;
} IMAGE_EXPORT_DIRECTORY, * PIMAGE_EXPORT_DIRECTORY;

typedef enum _MODE
{
    KernelMode,
    UserMode,
    MaximumMode
} MODE;

#define OBJ_INHERIT                         0x00000002L
#define OBJ_PERMANENT                       0x00000010L
#define OBJ_EXCLUSIVE                       0x00000020L
#define OBJ_CASE_INSENSITIVE                0x00000040L
#define OBJ_OPENIF                          0x00000080L
#define OBJ_OPENLINK                        0x00000100L
#define OBJ_KERNEL_HANDLE                   0x00000200L
#define OBJ_FORCE_ACCESS_CHECK              0x00000400L
#define OBJ_IGNORE_IMPERSONATED_DEVICEMAP   0x00000800L
#define OBJ_DONT_REPARSE                    0x00001000L
#define OBJ_VALID_ATTRIBUTES                0x00001FF2L

#define IRP_MJ_CREATE                   0x00
#define IRP_MJ_CREATE_NAMED_PIPE        0x01
#define IRP_MJ_CLOSE                    0x02
#define IRP_MJ_READ                     0x03
#define IRP_MJ_WRITE                    0x04
#define IRP_MJ_QUERY_INFORMATION        0x05
#define IRP_MJ_SET_INFORMATION          0x06
#define IRP_MJ_QUERY_EA                 0x07
#define IRP_MJ_SET_EA                   0x08
#define IRP_MJ_FLUSH_BUFFERS            0x09
#define IRP_MJ_QUERY_VOLUME_INFORMATION 0x0a
#define IRP_MJ_SET_VOLUME_INFORMATION   0x0b
#define IRP_MJ_DIRECTORY_CONTROL        0x0c
#define IRP_MJ_FILE_SYSTEM_CONTROL      0x0d
#define IRP_MJ_DEVICE_CONTROL           0x0e
#define IRP_MJ_INTERNAL_DEVICE_CONTROL  0x0f
#define IRP_MJ_SHUTDOWN                 0x10
#define IRP_MJ_LOCK_CONTROL             0x11
#define IRP_MJ_CLEANUP                  0x12
#define IRP_MJ_CREATE_MAILSLOT          0x13
#define IRP_MJ_QUERY_SECURITY           0x14
#define IRP_MJ_SET_SECURITY             0x15
#define IRP_MJ_POWER                    0x16
#define IRP_MJ_SYSTEM_CONTROL           0x17
#define IRP_MJ_DEVICE_CHANGE            0x18
#define IRP_MJ_QUERY_QUOTA              0x19
#define IRP_MJ_SET_QUOTA                0x1a
#define IRP_MJ_PNP                      0x1b
#define IRP_MJ_PNP_POWER                IRP_MJ_PNP
#define IRP_MJ_MAXIMUM_FUNCTION         0x1b

typedef struct _OBJECT_TYPE* POBJECT_TYPE;

typedef struct _DRIVER_OBJECT
{
    INT16 Type;
    INT16 Size;
    struct _DEVICE_OBJECT* DeviceObject;
    UINT32 Flags;
    VOID* DriverStart;
    UINT32 DriverSize;
    VOID* DriverSection;
    struct _DRIVER_EXTENSION* DriverExtension;
    struct _UNICODE_STRING DriverName;
    struct _UNICODE_STRING* HardwareDatabase;
    struct _FAST_IO_DISPATCH* FastIoDispatch;
    UINT32(*DriverInit)(struct _DRIVER_OBJECT* arg1, struct _UNICODE_STRING* arg2);
    VOID(*DriverStartIo)(struct _DEVICE_OBJECT* arg1, struct _IRP* arg2);
    VOID(*DriverUnload)(struct _DRIVER_OBJECT* arg1);
    UINT32(*MajorFunction[28])(struct _DEVICE_OBJECT* arg1, struct _IRP* arg2);
} DRIVER_OBJECT, * PDRIVER_OBJECT;

#define RELATIVE_ADDRESS(address, size) ((VOID*)((UINT8*)(address) + *(INT32*)((UINT8*)(address) + ((size) - (INT32)sizeof(INT32))) + (size)))

typedef struct _NDIS_M_DRIVER_BLOCK
{
    union
    {
        struct
        {
            VOID* Header;
            VOID* NextDriver;
        };
        struct
        {
            char Space[0x028]; // 0x028 DriverObject
            PDRIVER_OBJECT DriverObject;
        };
    };
} NDIS_M_DRIVER_BLOCK, * PNDIS_M_DRIVER_BLOCK;

typedef union _LARGE_INTEGER
{
    struct
    {
        UINT32 LowPart;
        INT32 HighPart;
    } DUMMYSTRUCTNAME;
    struct
    {
        UINT32 LowPart;
        INT32 HighPart;
    } u;
    INT64 QuadPart;
} LARGE_INTEGER;

typedef UINT32(__stdcall* DbgPrintEx_t)(UINT32 ComponentId, UINT32 Level, const CHAR8* Format, ...);
typedef void(__stdcall* RtlInitUnicodeString_t)(PUNICODE_STRING DestinationString, const CHAR16* SourceString);
typedef UINT32(__stdcall* ObReferenceObjectByName_t)(PUNICODE_STRING ObjectName, UINT32 Attributes, VOID* AccessState, UINT32 DesiredAccess, VOID* ObjectType, CHAR8 AccessMode, VOID* ParseContext, VOID** Object);
typedef INT64(__stdcall* ObfDereferenceObject_t)(VOID* Object);
```

`rainbow/UefiDriver/utils.cpp`:

```cpp
#include "general.h"

#define IN_RANGE(x, a, b) (x >= a && x <= b)
#define GET_BITS(x) (IN_RANGE((x&(~0x20)),'A','F')?((x&(~0x20))-'A'+0xA):(IN_RANGE(x,'0','9')?x-'0':0))
#define GET_BYTE(a, b) (GET_BITS(a) << 4 | GET_BITS(b))
UINT64 Utils::FindPattern(VOID* baseAddress, UINT64 size, const CHAR8* pattern)
{
    UINT8* firstMatch = nullptr;
    const CHAR8* currentPattern = pattern;

    UINT8* start = static_cast<UINT8*>(baseAddress);
    UINT8* end = start + size;

    for (UINT8* current = start; current < end; current++)
    {
        UINT8 byte = currentPattern[0]; if (!byte) return reinterpret_cast<UINT64>(firstMatch);
        if (byte == '\?' || *static_cast<UINT8*>(current) == GET_BYTE(byte, currentPattern[1]))
        {
            if (!firstMatch) firstMatch = current;
            if (!currentPattern[2]) return reinterpret_cast<UINT64>(firstMatch);
            ((byte == '\?') ? (currentPattern += 2) : (currentPattern += 3));
        }
        else
        {
            currentPattern = pattern;
            firstMatch = nullptr;
        }
    }

    return 0;
}

UINT64 Utils::FindPatternImage(VOID* base, const CHAR8* pattern)
{
    UINT64 match = 0;

    PIMAGE_NT_HEADERS64 headers = reinterpret_cast<PIMAGE_NT_HEADERS64>(reinterpret_cast<UINT64>(base) + static_cast<PIMAGE_DOS_HEADER>(base)->e_lfanew);
    PIMAGE_SECTION_HEADER sections = IMAGE_FIRST_SECTION(headers);
    for (INTN i = 0; i < headers->FileHeader.NumberOfSections; ++i)
    {
        PIMAGE_SECTION_HEADER section = &sections[i];
        if (*reinterpret_cast<UINT32*>(section->Name) == 'EGAP' || CompareMem(section->Name, ".text", 5) == 0)
        {
            match = FindPattern(reinterpret_cast<void*>(reinterpret_cast<UINT64>(base) + section->VirtualAddress), section->Misc.VirtualSize, pattern);
            if (match)
                break;
        }
    }

    return match;
}

UINT64 Utils::GetExport(VOID* base, const CHAR8* functionName)
{
    PIMAGE_DOS_HEADER dosHeader = static_cast<PIMAGE_DOS_HEADER>(base);
    if (dosHeader->e_magic != IMAGE_DOS_SIGNATURE)
        return 0;

    PIMAGE_NT_HEADERS64 ntHeaders = reinterpret_cast<PIMAGE_NT_HEADERS64>(reinterpret_cast<UINT64>(base) + dosHeader->e_lfanew);

    UINT32 exportsRva = ntHeaders->OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress;
    if (!exportsRva)
        return 0;

    PIMAGE_EXPORT_DIRECTORY exports = reinterpret_cast<PIMAGE_EXPORT_DIRECTORY>(reinterpret_cast<UINT64>(base) + exportsRva);
    UINT32* nameRva = reinterpret_cast<UINT32*>(reinterpret_cast<UINT64>(base) + exports->AddressOfNames);

    for (UINT32 i = 0; i < exports->NumberOfNames; ++i)
    {
        CHAR8* func = reinterpret_cast<CHAR8*>(reinterpret_cast<UINT64>(base) + nameRva[i]);
        if (AsciiStrCmp(func, functionName) == 0)
        {
            UINT32* funcRva = (UINT32*)(reinterpret_cast<UINT64>(base) + exports->AddressOfFunctions);
            UINT16* ordinalRva = (UINT16*)(reinterpret_cast<UINT64>(base) + exports->AddressOfNameOrdinals);

            return reinterpret_cast<UINT64>(base) + funcRva[ordinalRva[i]];
        }
    }

    return 0;
}

KLDR_DATA_TABLE_ENTRY Utils::GetModule(LIST_ENTRY* list, const CHAR16* name)
{
    for (LIST_ENTRY* entry = list->ForwardLink; entry != list; entry = entry->ForwardLink)
    {
        PKLDR_DATA_TABLE_ENTRY module = CONTAINING_RECORD(entry, KLDR_DATA_TABLE_ENTRY, InLoadOrderLinks);

        if (module && StrnCmp(name, module->BaseDllName.Buffer, module->BaseDllName.Length) == 0)
            return *module;
    }

    return {};
}

VOID Utils::CopyMemory(VOID* destination, VOID* source, UINTN size)
{
    /*
     * CopyMem is part of boot services (at least in EDK2 - why??)
     * memcpy? Inconsistent! Sometimes it gets inlined, sometimes
     * you will undefined reference
     */
    UINT8* dst = static_cast<UINT8*>(destination);
    UINT8* src = static_cast<UINT8*>(source);
    for (UINTN i = 0; i < size; i++)
    {
        dst[i] = src[i];
    }
}

VOID Utils::SetMemory(VOID* destination, UINT8 value, UINTN size)
{
    UINT8* dst = static_cast<UINT8*>(destination);
    for (UINTN i = 0; i < size; i++)
    {
        dst[i] = value;
    }
}

VOID Utils::CopyToReadOnly(VOID* destination, VOID* source, UINTN size)
{
    _disable();
    UINT64 cr0 = __readcr0();
    UINT64 oldCr0 = cr0;
    cr0 &= ~(1UL << 16);
    __writecr0(cr0);

    CopyMemory(destination, source, size);

    __writecr0(oldCr0);

    /*
     * Probably could check if interrupts were enabled in first
     * place but eh...
     */
    _enable();
}
```

`rainbow/UefiDriver/utils.h`:

```h
#pragma once

namespace Utils
{
    UINT64 FindPattern(VOID* baseAddress, UINT64 size, const CHAR8* pattern);
    UINT64 FindPatternImage(VOID* base, const CHAR8* pattern);
    UINT64 GetExport(VOID* base, const CHAR8* functionName);
    KLDR_DATA_TABLE_ENTRY GetModule(LIST_ENTRY* list, const CHAR16* name);
    VOID CopyToReadOnly(VOID* destination, VOID* source, UINTN size);
    VOID CopyMemory(VOID* destination, VOID* source, UINTN size);
    VOID SetMemory(VOID* destination, UINT8 value, UINTN size);
}
```

`rainbow/UefiDriver/xor.h`:

```h
#pragma once

namespace crypt
{
#define TBX_XSTR_SEED ((__TIME__[7] - '0') * 1ull    + (__TIME__[6] - '0') * 10ull  + \
                       (__TIME__[4] - '0') * 60ull   + (__TIME__[3] - '0') * 600ull + \
                       (__TIME__[1] - '0') * 3600ull + (__TIME__[0] - '0') * 36000ull)

    constexpr unsigned long long linear_congruent_generator(unsigned rounds)
    {
        return 1013904223ull + (1664525ull * ((rounds > 0) ? linear_congruent_generator(rounds - 1) : (TBX_XSTR_SEED))) % 0xFFFFFFFF;
    }

#define Random() linear_congruent_generator(10)
#define XSTR_RANDOM_NUMBER(Min, Max) (Min + (Random() % (Max - Min + 1)))

    constexpr const unsigned long long XORKEY = XSTR_RANDOM_NUMBER(0, 0xFF);

    template<typename Char >
    constexpr Char encrypt_character(const Char character, int index)
    {
        return (Char)(character ^ (static_cast<Char>(XORKEY) + index));
    }

    template <unsigned size, typename Char>
    class Xor_string
    {
    public:
        const unsigned _nb_chars = (size - 1);
        Char _string[size];

        inline constexpr Xor_string(const Char* string)
            : _string{}
        {
            for (unsigned i = 0u; i < size; ++i)
                _string[i] = encrypt_character<Char>(string[i], i);
        }

        const Char* decrypt() const
        {
            Char* string = const_cast<Char*>(_string);
            for (unsigned t = 0; t < _nb_chars; t++)
            {
                string[t] = (Char)(string[t] ^ (static_cast<Char>(XORKEY) + t));
            }
            string[_nb_chars] = '\0';
            return string;
        }
    };
}

#define E(input_string) []{ constexpr crypt::Xor_string<(sizeof(input_string)/sizeof(char)), char> expr(input_string); return expr; }().decrypt()
#define EW(input_string) (const CHAR16*)[]{ constexpr crypt::Xor_string<(sizeof(input_string)/sizeof(wchar_t)), wchar_t> expr(input_string); return expr; }().decrypt()
```

`rainbow/rainbow.default.props`:

```props
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ImportGroup Label="PropertySheets" />
  <PropertyGroup Label="UserMacros">
    <EDK_PATH>$(SolutionDir)..\edk2</EDK_PATH>
  </PropertyGroup>
  <PropertyGroup>
    <IncludePath>$(EDK_PATH)\MdePkg\Include;$(EDK_PATH)\MdePkg\Include\X64;$(EDK_PATH)\ShellPkg\Include;$(EDK_PATH)\CryptoPkg\Include</IncludePath>
    <LibraryPath>$(SolutionDir)..\EDK-II\$(Platform)\$(Configuration)</LibraryPath>
  </PropertyGroup>
  <PropertyGroup Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>$(DefaultPlatformToolset)</PlatformToolset>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <ItemGroup>
    <BuildMacro Include="EDK_PATH">
      <Value>$(EDK_PATH)</Value>
      <EnvironmentVariable>true</EnvironmentVariable>
    </BuildMacro>
  </ItemGroup>
</Project>

```

`rainbow/rainbow.props`:

```props
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ImportGroup Label="PropertySheets" />
  <PropertyGroup>
    <GenerateManifest />
    <IntDir>$(SolutionDir)$(Platform)\$(Configuration)\obj\$(TargetName)\</IntDir>
    <OutDir>$(SolutionDir)$(Platform)\$(Configuration)\</OutDir>
    <TargetExt>.efi</TargetExt>
  </PropertyGroup>
  <PropertyGroup>
    <LocalDebuggerCommand>..\debugger\qemu.exe</LocalDebuggerCommand>
    <LocalDebuggerCommandArguments>-name "VisualUEFI Debugger" -drive file=OVMF_CODE-need-smm.fd,if=pflash,format=raw,unit=0,readonly=on -drive file=OVMF_VARS-need-smm.fd,if=pflash,format=raw,unit=1 -drive file=fat:rw:..\rainbow\$(Platform)\$(Configuration)\,media=disk,if=virtio,format=raw -drive file=UefiShell.iso,format=raw -m 512 -machine q35,smm=on -nodefaults -vga std -global driver=cfi.pflash01,property=secure,value=on -global ICH9-LPC.disable_s3=1</LocalDebuggerCommandArguments>
    <LocalDebuggerWorkingDirectory>..\..\debugger</LocalDebuggerWorkingDirectory>
    <LocalDebuggerDebuggerType>Script</LocalDebuggerDebuggerType>
    <DebuggerFlavor>WindowsLocalDebugger</DebuggerFlavor>
  </PropertyGroup>
  <ItemDefinitionGroup>
    <ClCompile>
      <WholeProgramOptimization>true</WholeProgramOptimization>
      <WarningLevel>Level4</WarningLevel>
      <TreatWarningAsError>true</TreatWarningAsError>
      <MultiProcessorCompilation>true</MultiProcessorCompilation>
      <Optimization>MinSpace</Optimization>
      <IntrinsicFunctions>true</IntrinsicFunctions>
      <OmitFramePointers>true</OmitFramePointers>
      <InlineFunctionExpansion>AnySuitable</InlineFunctionExpansion>
      <ExceptionHandling>SyncCThrow</ExceptionHandling>
      <BufferSecurityCheck>false</BufferSecurityCheck>
      <ControlFlowGuard>false</ControlFlowGuard>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <ForcedIncludeFiles>$(SolutionDir)..\EDK-II\BaseLib\vshacks.h</ForcedIncludeFiles>
      <CallingConvention />
      <TreatWChar_tAsBuiltInType />
      <StringPooling>true</StringPooling>
      <RuntimeTypeInfo>false</RuntimeTypeInfo>
      <ForceConformanceInForLoopScope />
      <AdditionalOptions>/Gs32768 %(AdditionalOptions)</AdditionalOptions>
      <ErrorReporting />
      <FloatingPointModel />
    </ClCompile>
    <Link>
      <IgnoreAllDefaultLibraries>true</IgnoreAllDefaultLibraries>
      <AdditionalDependencies>UefiHiiLib.lib;UefiHiiServicesLib.lib;UefiSortLib.lib;UefiShellLib.lib;GlueLib.lib;BaseLib.lib;BaseDebugPrintErrorLevelLib.lib;BasePrintLib.lib;UefiLib.lib;UefiBootServicesTableLib.lib;UefiRuntimeServicesTableLib.lib;UefiDevicePathLibDevicePathProtocol.lib;UefiDebugLibConOut.lib;UefiMemoryLib.lib;UefiMemoryAllocationLib.lib;BaseSynchronizationLib.lib;UefiFileHandleLib.lib</AdditionalDependencies>
      <GenerateDebugInformation>DebugFastLink</GenerateDebugInformation>
      <SubSystem>EFI Boot Service Driver</SubSystem>
      <Driver>Driver</Driver>
      <OptimizeReferences>true</OptimizeReferences>
      <EnableCOMDATFolding />
      <LinkTimeCodeGeneration>UseFastLinkTimeCodeGeneration</LinkTimeCodeGeneration>
      <BaseAddress>0</BaseAddress>
      <SectionAlignment>32</SectionAlignment>
      <ImageHasSafeExceptionHandlers>false</ImageHasSafeExceptionHandlers>
      <RandomizedBaseAddress />
      <DataExecutionPrevention />
      <ManifestFile />
      <AllowIsolation />
      <EnableUAC />
      <UACExecutionLevel />
      <UACUIAccess />
      <TypeLibraryResourceID />
      <AdditionalOptions>/OPT:ICF=10 /IGNORE:4001 /IGNORE:4254 /IGNORE:4281 %(AdditionalOptions)</AdditionalOptions>
      <MergeSections>.rdata=.data</MergeSections>
      <SpecifySectionAttributes>.xdata,D</SpecifySectionAttributes>
      <LinkErrorReporting />
      <ProfileGuidedDatabase />
      <EntryPointSymbol>EfiMain</EntryPointSymbol>
    </Link>
  </ItemDefinitionGroup>
</Project>

```

`rainbow/rainbow.sln`:

```sln

Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio Version 16
VisualStudioVersion = 16.0.31129.286
MinimumVisualStudioVersion = 10.0.40219.1
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "UefiDriver", "UefiDriver\UefiDriver.vcxproj", "{DF325AB7-67A6-473E-93FF-16955AFBC063}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Release|x64 = Release|x64
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{DF325AB7-67A6-473E-93FF-16955AFBC063}.Release|x64.ActiveCfg = Release|x64
		{DF325AB7-67A6-473E-93FF-16955AFBC063}.Release|x64.Build.0 = Release|x64
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
	GlobalSection(ExtensibilityGlobals) = postSolution
		SolutionGuid = {5BDD25E1-AD09-4E41-B5E0-EE43A8C044A6}
	EndGlobalSection
EndGlobal

```