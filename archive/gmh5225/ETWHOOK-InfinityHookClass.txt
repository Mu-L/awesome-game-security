Project Path: arc_gmh5225_ETWHOOK-InfinityHookClass_a1vqoazx

Source Tree:

```txt
arc_gmh5225_ETWHOOK-InfinityHookClass_a1vqoazx
├── 9L9K2T7Z}]8W6T}A)S1W(SX.png
├── Global.cpp
├── Global.h
├── InfinityHook.vcxproj
├── InfinityHook.vcxproj.filters
├── UnDocFuncAndStr.h
├── hde
│   ├── hde64.cpp
│   ├── hde64.h
│   ├── pstdint.h
│   └── table64.h
├── hook.cpp
├── main.cpp
├── readme.md
└── x64
    └── Debug
        ├── Global.obj
        ├── InfinityHook.Build.CppClean.log
        ├── InfinityHook.log
        ├── InfinityHook.sys.recipe
        ├── InfinityHook.tlog
        │   ├── CL.command.1.tlog
        │   ├── CL.read.1.tlog
        │   ├── CL.write.1.tlog
        │   ├── InfinityHook.lastbuildstate
        │   ├── link.command.1.tlog
        │   ├── link.read.1.tlog
        │   ├── link.write.1.tlog
        │   ├── signtool.command.1.tlog
        │   ├── signtool.read.1.tlog
        │   ├── signtool.timestamp.1.tlog
        │   └── signtool.write.1.tlog
        ├── hde64.obj
        ├── hook.obj
        ├── main.obj
        └── vc142.pdb

```

`Global.cpp`:

```cpp
#include <ntifs.h>
#include <ntdef.h>
#include <ntddk.h>
#include <intrin.h>
#include <ntimage.h> //Kernel program pe format headfile
#include "UnDocFuncAndStr.h"
#include "Global.h"



#include "hde/hde64.h"

#pragma warning(disable : 4310)
#pragma warning(disable : 4309)
#pragma warning(disable : 4838)

extern void __fastcall hook_etw_call_back(unsigned long ssdt_index, void** ssdt_address);
extern unsigned long long MyHvlGetQpcBias();
extern unsigned long long MyGetCpuClock();



BOOLEAN EtwHook::init()
{
	

	get_os_build_num();

	if (this->dwBuildNumer == 0) return show_err_info("Get osBuildNumer err!");

	KdPrint(("【EtwHook】:Os Build Number:%d\n", this->dwBuildNumer));

	this->uNtoskrnlBase = get_ntoskrnl_base();

	if (this->uNtoskrnlBase == 0) return show_err_info("Get uNtoskrnlBase err!");
	
	KdPrint(("【EtwHook】:uNtoskrnlBase:%p\n",this->uNtoskrnlBase));

	this->uCkclWmiLoggerContext = get_ckclcontext_addr();

	if (this->uCkclWmiLoggerContext == 0) return show_err_info("Get uCkclWmiLoggerContext err!");

	KdPrint(("【EtwHook】:CkclWmiLoggerContext:%p\n", this->uCkclWmiLoggerContext));

	if (!get_cpu_clock()) return show_err_info("Get CpuClock err!");

	KdPrint(("【EtwHook】:Cpuclock:%p\n", this->CpuClock));

	if (!get_syscall_entry()) return show_err_info("Get syscall_entry err!");

	KdPrint(("【EtwHook】:sysentry:%p\n", this->uSystemCall64));

	//if buildnumber>18363
	//the cpuclock is not a pointer but a num
	//we intend to hook pHvlGetQpcBias
	//refer https://www.freebuf.com/articles/system/278857.html
	//because etw logger finally call this func (if cpuclok num is 2)
	//and by the way, this func is not protected by PG
	
	if (dwBuildNumer > 18363) {

			/*.text:00000001403638A0 48 8B 05 D9 8D 99 00      mov     rax, cs:HvlpReferenceTscPage
			.text : 00000001403638A7 48 8B 40 18         mov     rax, [rax + 18h]
			.text:00000001403638AB C3       */      
		//00 ref ?? 

		//qword_140C4A2F8  is pHvlGetQpcBias
		//48 8B 05 5F 84 79 00                          mov     rax, cs:qword_140C4A2F8  
		//	.text : 00000001404B1E99 48 85 C0                                      test    rax, rax
		//	.text : 00000001404B1E9C 74 28                                         jz      short loc_1404B1EC6

		char TscPageshellcode[12] = { 0x48,0x8B,0x05,0x00,0x00,0x00,0x00,0x48,0x8B,0x40,0x18,0xC3 };
		char HvlGetQpcBiasshellcode[15] = { 0x48,0x8B,0x05,0x00,0x00,0x00,0x00,0x48,0x85,0xc0,0x74,0x00,0x48,0x83,0x3d };

		ULONG_PTR _HvlGetQpcBias = get_undoc_func_by_shellcode(TscPageshellcode, sizeof(TscPageshellcode));
		pHvlGetQpcBias = get_undoc_func_by_shellcode(HvlGetQpcBiasshellcode, sizeof(HvlGetQpcBiasshellcode));

		if (!_HvlGetQpcBias || !pHvlGetQpcBias) return show_err_info("get undoc func err!");

		KdPrint(("pHvlGetQpcBias==%p,_HvlGetQpcBias==%p", pHvlGetQpcBias, _HvlGetQpcBias));

		pHvlGetQpcBias = pHvlGetQpcBias+ *(int*)(pHvlGetQpcBias + 3)+7;
		
		if(!_HvlGetQpcBias) return show_err_info("Get _HvlGetQpcBias err!");

		KdPrint(("【EtwHook】:pHvlGetQpcBias:%p\n", pHvlGetQpcBias));
		

		pHvlpReferenceTscPage = _HvlGetQpcBias + *(int*)(_HvlGetQpcBias + 3)+7;

		KdPrint(("【EtwHook】:pHvlpReferenceTscPage:%p\n", this->pHvlpReferenceTscPage));
	}


	return true;
}

BOOLEAN EtwHook::start()
{
	if (!NT_SUCCESS(modify_etw_settings(syscall_trace))) {

		if (!NT_SUCCESS(modify_etw_settings(start_trace))) {
			return show_err_info("start etw err!");

		}

		if (!NT_SUCCESS(modify_etw_settings(syscall_trace))) {
			return show_err_info("start etw err!");
		}
	}

	//KdPrint(("start etw successly\n"));

	//if os buildnum<=18369
	//GetCpuClock is a pointer so we just modify the pointer
	if (dwBuildNumer <= 18363) {
		*(PVOID*)(this->CpuClock) = MyGetCpuClock;

	}
	else {
		//else the CpuClock is a num
		//save the Old Cpuclock
		OriCpuClock = *(ULONG_PTR*)CpuClock;

		*(ULONG_PTR*)CpuClock = 2;
		//in above buildnum 18369 
		//cpuclock=0 call RtlGetSystemTimePrecise PG
		//cpuclock=1 call KeQueryPerformanceCounter PG
		//cpuclock=2 call offset_off_140C009E0 none PG
		//cpuclock=3 call __rdtsc PG
		//and off_140C009E0 = (__int64 (__fastcall *)(_QWORD))HalpTimerQueryHostPerformanceCounter;
		//HalpTimerQueryHostPerformanceCounter call qword_140C4A2F8()
		//qword_140C4A2F8=pHvlGetQpcBias
		//pHvlGetQpcBias return *(_QWORD *)(HvlpReferenceTscPage + 24);
		//we can hook pHvlGetQpcBias and call HvlpReferenceTscPage + 24
		
		//save 
		HvlGetQpcBias = *(ULONG_PTR*)pHvlGetQpcBias;
		*(ULONG_PTR*)pHvlGetQpcBias = (ULONG_PTR)MyHvlGetQpcBias;
	
	}

	KdPrint(("Install etw hook successly\n"));
	return true;
}

void EtwHook::stop()
{

	//disable syscall trace
	modify_etw_settings(stop_trace);

	modify_etw_settings(start_trace);

	//win10 1909 need to resume the envirmonet

	if (dwBuildNumer>18363) {
		*(ULONG_PTR*)this->pHvlGetQpcBias = this->HvlGetQpcBias;
		*(ULONG_PTR*)this->CpuClock = this->OriCpuClock;
	}
	

}

BOOLEAN EtwHook::add_hook(PUNICODE_STRING usHookFuncName, ULONG_PTR MyFunc) {

	for (int i = 0; i < 20; i++) {


		if (!this->HookFuncPointerArr[i]) {
			//add pointer
			ULONG_PTR OriFuncAddr = (ULONG_PTR)MmGetSystemRoutineAddress(usHookFuncName);

			if (!OriFuncAddr) return show_err_info("can not get system addr!");

			this->HookFuncPointerArr[i] = MyFunc;

			this->HookOriFuncPointerArr[i] = OriFuncAddr;

			return true;

		}


	}

	return show_err_info("hook arry has no space!");

}

ULONG_PTR EtwHook::ret_tsc_page()
{
	return this->pHvlpReferenceTscPage;
}

DWORD32 EtwHook::ret_build_num()
{
	return this->dwBuildNumer;
}

ULONG_PTR EtwHook::ret_syscall_entry()
{
	return uSystemCall64;
}

unsigned int EtwHook::get_os_build_num()
{
	DWORD32 dwBuildNum=0;
	RTL_OSVERSIONINFOEXW info = { 0 };
	info.dwOSVersionInfoSize = sizeof(RTL_OSVERSIONINFOEXW);
	
	if (NT_SUCCESS(RtlGetVersion((PRTL_OSVERSIONINFOW)&info))) dwBuildNum = info.dwBuildNumber;

	this->dwBuildNumer = dwBuildNum;
	return dwBuildNum;
}

ULONG_PTR EtwHook::is_hook_func(ULONG_PTR uFuncAddr)
{

	for (int i = 0; i < 20; i++) {

		if (this->HookOriFuncPointerArr[i] == uFuncAddr) {

			return HookFuncPointerArr[i];
		}

	}

	//can not find
	return 0;
}

BOOLEAN EtwHook::show_err_info(const char* szStr)
{
	KdPrint(("【EtwHook】:%s\n",szStr));
	return 0;
}

ULONG_PTR EtwHook::get_ntoskrnl_base()
{
	//ULONG_PTR _uNtoskrnlBase = 0;
	const unsigned long tag = 'etw';
	unsigned long length = 0;
	//UNICODE_STRING usNtoskrnl = RTL_CONSTANT_STRING(L"ntoskrnl.exe");

	//use kernel api rather than LDR_DATA_TABLE_ENTRY 
	// and PsLoadedModuleList traversal 
	//it is better suitable for different os version

	//due to kernel Double-Fetch
	//var length is PSYSTEM_MODULE_INFORMATION 
	//size(Variable length arrry)

	ZwQuerySystemInformation(11, &length, 0, &length);
	
	if (!length) return show_err_info("Get system info err!");

	PSYSTEM_MODULE_INFORMATION system_modules = (PSYSTEM_MODULE_INFORMATION)ExAllocatePoolWithTag(NonPagedPool, length, tag);
	
	if(!system_modules) return show_err_info("alloc system_info err!");
	
	ZwQuerySystemInformation(11, system_modules, length, 0);

	for (DWORD32 i=0;i<system_modules->ulModuleCount ;i++) {
		PSYSTEM_MODULE mod = &system_modules->Modules[i];
		
		if (strcmp("\\SystemRoot\\system32\\ntoskrnl.exe", mod->ImageName)==0) {
			//find
			uNtoskrnlBase = (ULONG_PTR)mod->Base;
			break;
		}
	}

	ExFreePoolWithTag(system_modules, tag);
	return uNtoskrnlBase;
}

ULONG_PTR EtwHook::get_ckclcontext_addr()
{
	ULONG_PTR EtwpHostSiloState = 0;

	//.text:00000001405A13F9 44 8A 44 24 50                                mov     r8b, [rsp + 48h + arg_0]
	//	.text : 00000001405A13FE 41 8B CE                                      mov     ecx, r14d
	//	.text : 00000001405A1401 48 8B 15 00 9C 75 00                          mov     rdx, cs : EtwpHostSiloState

	CHAR EtwHostStateShellcode[] = { 0x44,0x8A,0x44,0x24,0x50,0x41,0x8B,0xCE,0x48,0x8B,0x15 };
	ULONG_PTR* puEtwpDebuggerDataSilo = 0;



	EtwpHostSiloState = get_EtwpHostSiloState(EtwHostStateShellcode, sizeof(EtwHostStateShellcode));

	if (EtwpHostSiloState == 0) return show_err_info("can not get EtwpHostSiloState addr!");

	puEtwpDebuggerDataSilo = (ULONG_PTR*)*(ULONG_PTR*)(*(ULONG_PTR*)EtwpHostSiloState + 0x1c8);

	if(!MmIsAddressValid((PVOID)puEtwpDebuggerDataSilo)) return show_err_info("can not get EtwpHostSiloState addr!");

	return puEtwpDebuggerDataSilo[2];
}

ULONG_PTR EtwHook::get_EtwpHostSiloState(char* shellcode, int size)
{
	int Max = 0x1000;
	BOOLEAN bFind=0;
	int i = 0;
	DWORD32 dwOffset = 0;
	//.text:00000001405A13F9 44 8A 44 24 50                                mov     r8b, [rsp + 48h + arg_0]
	//	.text : 00000001405A13FE 41 8B CE                                      mov     ecx, r14d
	//	.text : 00000001405A1401 48 8B 15 00 9C 75 00                          mov     rdx, cs : EtwpHostSiloState
	UNICODE_STRING usEtwSendTraceBuffer = RTL_CONSTANT_STRING(L"EtwSendTraceBuffer");
	PCHAR EtwSendTraceBuffer = (PCHAR)MmGetSystemRoutineAddress(&usEtwSendTraceBuffer);

	if (EtwSendTraceBuffer == 0) return show_err_info("can not get EtwSendTraceBuffer addr!");
	
	for (; i < Max; i++) {
		if (RtlCompareMemory((PVOID)(EtwSendTraceBuffer+i), shellcode, size)==size) {
			bFind = 1;
			dwOffset = *(PDWORD32)(EtwSendTraceBuffer + size + i);
			break;
		}

	}
	if (bFind) {
		return (ULONG_PTR)EtwSendTraceBuffer + i + size + 4 + (int)dwOffset;
	}
	else return 0;
}

BOOLEAN EtwHook::get_cpu_clock()
{
	//win7 and win11 cpuclock offset is 0x18 win8 -win10 is 0x28;
	if (!MmIsAddressValid((PVOID)uCkclWmiLoggerContext)) return show_err_info("pCkclContext invalid!");

	if (dwBuildNumer <= 7601 || dwBuildNumer == 22000) CpuClock = (ULONG_PTR)(uCkclWmiLoggerContext + 0x18);
	else CpuClock = (ULONG_PTR)(uCkclWmiLoggerContext + 0x28);
	
	return true;
}

BOOLEAN EtwHook::get_syscall_entry()
{
	//if os enable kpti,need to hde disassmbly
	//if os enbale kpti,section headers contains of "KVASCODE"
	//KiSystemCall64Shadow will jmp to(E9) KiSystemCall64

	const CHAR JMP = (char)0xE9;
	const DWORD32 IA_LSTAR_MSR=0xC0000082;
	int _secsize=0;

	ULONG_PTR uKVASCODE = get_image_addr("KVASCODE",&_secsize);


	uSystemCall64 = __readmsr(IA_LSTAR_MSR);
	if (!uKVASCODE) return true;

	if (uSystemCall64<uKVASCODE || uSystemCall64>uKVASCODE + _secsize) return true;

	
	//enable 
	//need to use disassembly engine
	hde64s hde_info{0};

	for (int i = 0;; i += hde_info.len) {
		
		//end
		if (!hde64_disasm(PVOID(i + uSystemCall64), &hde_info)) break;
		
		if (hde_info.opcode != JMP) continue;


		uSystemCall64 += i + hde_info.len + (int)hde_info.imm.imm32;

		//still in shadow func
		if (uSystemCall64 >= __readmsr(IA_LSTAR_MSR) && uSystemCall64 <= uKVASCODE + _secsize) {
			uSystemCall64 = __readmsr(IA_LSTAR_MSR);
			continue;
		}
		
		return 1;
	
	}

	//can not find!
	return 0;
}

ULONG_PTR EtwHook::get_image_addr(const char* szSectionName,int* size)
{
	

	PIMAGE_DOS_HEADER _doshead = (PIMAGE_DOS_HEADER)uNtoskrnlBase;

	//maybe not correct ntoskrbase
	if (_doshead->e_magic != IMAGE_DOS_SIGNATURE) return show_err_info("not valid pe format!");
	
	PIMAGE_NT_HEADERS _nthead = (PIMAGE_NT_HEADERS)(_doshead->e_lfanew + uNtoskrnlBase);

	if(_nthead->Signature != IMAGE_NT_SIGNATURE) return show_err_info("not valid pe format!");

	PIMAGE_SECTION_HEADER _sectionhead = IMAGE_FIRST_SECTION(_nthead);

	for (int i = 0; i < _nthead->FileHeader.NumberOfSections; i++) {
		PIMAGE_SECTION_HEADER _cursectionhead = &_sectionhead[i];
		if (_cursectionhead->Name[0]==szSectionName[0] && _cursectionhead->Name[1]== szSectionName[1] && _cursectionhead->Name[2]== szSectionName[2] && _cursectionhead->Name[3]== szSectionName[3]) {
			*size = _cursectionhead->SizeOfRawData;
			return (ULONG_PTR)_cursectionhead->VirtualAddress+(ULONG_PTR)_cursectionhead;

		}
	}
	
	//can not find kvascode

	return 0;
}

ULONG_PTR EtwHook::get_undoc_func_by_shellcode(char* shellcode, int size)
{
	int _size;
	ULONG_PTR uTextSection = get_image_addr(".text", &_size);

	if (!uTextSection) return 0;
	int j = 0;
	for (int i = 0; i < _size;) {
		for (; j < size;) {
			if (shellcode[j] == 0) {
				i++, j++;
				continue;
			}
			if(MmIsAddressValid((PVOID)(uTextSection + i))){
			//Even though in text section there is still some unread mem
			if (shellcode[j] == *(PCHAR)(uTextSection + i)) {
				i++, j++;
				continue;
			}
			}
			
			i = i - j + 1;
			j = 0;

			if (i >= _size) break;
		}
		
		if(j==size) return uTextSection + i - size;


	}

	return 0;
}

NTSTATUS EtwHook::modify_etw_settings(trace_type type)
{
	const unsigned long tag = 'etwm';

	CKCL_TRACE_PROPERTIES* property = (CKCL_TRACE_PROPERTIES*)ExAllocatePoolWithTag(NonPagedPool, PAGE_SIZE, tag);
	if (!property) return STATUS_MEMORY_NOT_ALLOCATED;

	RtlZeroMemory(property,PAGE_SIZE);

	property->ProviderName = RTL_CONSTANT_STRING(L"Circular Kernel Context Logger");

	property->Wnode.BufferSize = PAGE_SIZE;
	property->Wnode.Flags = 0x00020000;
	GUID ckcl_session_guid = { 0x54dea73a, 0xed1f, 0x42a4, { 0xaf, 0x71, 0x3e, 0x63, 0xd0, 0x56, 0xf1, 0x74 } };
	property->Wnode.Guid = ckcl_session_guid; // It is fixed
	property->Wnode.ClientContext = 3;
	property->BufferSize = sizeof(unsigned long);
	property->MinimumBuffers = 2;
	property->MaximumBuffers = 2;
	property->LogFileMode = 0x00000400;

	
	unsigned long length = 0;
	if (type == trace_type::syscall_trace) property->EnableFlags = 0x00000080;//EVENT_TRACE_FLAG_SYSTEMCALL (0x00000080)
	
	NTSTATUS status = NtTraceControl(type, property, PAGE_SIZE, property, PAGE_SIZE, &length);
	
	ExFreePoolWithTag(property, tag);

	return status;
}


```

`Global.h`:

```h
#pragma once

#pragma warning(disable : 4210)

typedef NTSTATUS(*FNtCreateFile)(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, PIO_STATUS_BLOCK, PLARGE_INTEGER, ULONG, ULONG, ULONG, ULONG, PVOID, ULONG);

typedef enum _trace_type
{
	start_trace = 1,
	stop_trace = 2,
	query_trace = 3,
	syscall_trace = 4,
	flush_trace = 5
}trace_type;




class EtwHook {
private:
	
	ULONG_PTR uCkclWmiLoggerContext;
	ULONG_PTR uNtoskrnlBase;
	DWORD32 dwBuildNumer;
	ULONG_PTR CpuClock;/*In win7-win8 It is a pointer. In win10-win11 It is a num */
	ULONG_PTR uSystemCall64;
	ULONG_PTR pHvlGetQpcBias;//dwBuildNumber>18363
	ULONG_PTR pHvlpReferenceTscPage;//table for pHvlGetQpcBias
	ULONG_PTR HvlGetQpcBias;//saved for hook
	ULONG_PTR OriCpuClock;//for >18363
	ULONG_PTR HookOriFuncPointerArr[20];// maxinum to hook 10 syscall func
	ULONG_PTR HookFuncPointerArr[20];
public:
	BOOLEAN init();
	BOOLEAN start();
	void stop();
	BOOLEAN add_hook(PUNICODE_STRING usHookFuncName,ULONG_PTR MyFunc);
	ULONG_PTR is_hook_func(ULONG_PTR);
	ULONG_PTR ret_tsc_page();
	DWORD32 ret_build_num();
	ULONG_PTR ret_syscall_entry();
	unsigned int get_os_build_num();
	BOOLEAN show_err_info(const char* szStr);
	ULONG_PTR get_ntoskrnl_base();
	ULONG_PTR get_ckclcontext_addr();
	ULONG_PTR get_EtwpHostSiloState(char * shellcode,int size);
	BOOLEAN get_cpu_clock();
	BOOLEAN get_syscall_entry();
	ULONG_PTR get_image_addr(const char* szSectionName,int *);
	ULONG_PTR get_undoc_func_by_shellcode(char* shellcode, int size);
	NTSTATUS modify_etw_settings(trace_type type);
};
```

`InfinityHook.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="12.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Debug|Win32">
      <Configuration>Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|Win32">
      <Configuration>Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|x64">
      <Configuration>Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|ARM">
      <Configuration>Debug</Configuration>
      <Platform>ARM</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|ARM">
      <Configuration>Release</Configuration>
      <Platform>ARM</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|ARM64">
      <Configuration>Debug</Configuration>
      <Platform>ARM64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|ARM64">
      <Configuration>Release</Configuration>
      <Platform>ARM64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <ProjectGuid>{B7A970BD-5C2C-4653-9AB2-F18DF37B538C}</ProjectGuid>
    <TemplateGuid>{dd38f7fc-d7bd-488b-9242-7d8754cde80d}</TemplateGuid>
    <TargetFrameworkVersion>v4.5</TargetFrameworkVersion>
    <MinimumVisualStudioVersion>12.0</MinimumVisualStudioVersion>
    <Configuration>Debug</Configuration>
    <Platform Condition="'$(Platform)' == ''">Win32</Platform>
    <RootNamespace>InfinityHook</RootNamespace>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM64'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM64'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="ExtensionSettings">
  </ImportGroup>
  <ImportGroup Label="PropertySheets">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <PropertyGroup Label="UserMacros" />
  <PropertyGroup />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <ItemGroup>
    <FilesToPackage Include="$(TargetPath)" />
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="Global.cpp" />
    <ClCompile Include="hde\hde64.cpp">
      <ExcludedFromBuild Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">false</ExcludedFromBuild>
    </ClCompile>
    <ClCompile Include="hook.cpp" />
    <ClCompile Include="main.cpp" />
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="Global.h" />
    <ClInclude Include="hde\hde64.h" />
    <ClInclude Include="hde\pstdint.h" />
    <ClInclude Include="hde\table64.h" />
    <ClInclude Include="UnDocFuncAndStr.h" />
  </ItemGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <ImportGroup Label="ExtensionTargets">
  </ImportGroup>
</Project>
```

`InfinityHook.vcxproj.filters`:

```filters
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <Filter Include="Source Files">
      <UniqueIdentifier>{4FC737F1-C7A5-4376-A066-2A32D752A2FF}</UniqueIdentifier>
      <Extensions>cpp;c;cc;cxx;def;odl;idl;hpj;bat;asm;asmx</Extensions>
    </Filter>
    <Filter Include="Header Files">
      <UniqueIdentifier>{93995380-89BD-4b04-88EB-625FBE52EBFB}</UniqueIdentifier>
      <Extensions>h;hpp;hxx;hm;inl;inc;xsd</Extensions>
    </Filter>
    <Filter Include="Resource Files">
      <UniqueIdentifier>{67DA6AB6-F800-4c08-8B7A-83BB121AAD01}</UniqueIdentifier>
      <Extensions>rc;ico;cur;bmp;dlg;rc2;rct;bin;rgs;gif;jpg;jpeg;jpe;resx;tiff;tif;png;wav;mfcribbon-ms</Extensions>
    </Filter>
    <Filter Include="Driver Files">
      <UniqueIdentifier>{8E41214B-6785-4CFE-B992-037D68949A14}</UniqueIdentifier>
      <Extensions>inf;inv;inx;mof;mc;</Extensions>
    </Filter>
    <Filter Include="Hde">
      <UniqueIdentifier>{d6586255-a7e4-4a1d-9950-449c0de5db5e}</UniqueIdentifier>
    </Filter>
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="main.cpp">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="hook.cpp">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="Global.cpp">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="hde\hde64.cpp">
      <Filter>Hde</Filter>
    </ClCompile>
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="Global.h">
      <Filter>Resource Files</Filter>
    </ClInclude>
    <ClInclude Include="UnDocFuncAndStr.h">
      <Filter>Resource Files</Filter>
    </ClInclude>
    <ClInclude Include="hde\hde64.h">
      <Filter>Hde</Filter>
    </ClInclude>
    <ClInclude Include="hde\pstdint.h">
      <Filter>Hde</Filter>
    </ClInclude>
    <ClInclude Include="hde\table64.h">
      <Filter>Hde</Filter>
    </ClInclude>
  </ItemGroup>
</Project>
```

`UnDocFuncAndStr.h`:

```h
#pragma once
typedef struct _SYSTEM_MODULE
{
	ULONG_PTR Reserved[2];
	PVOID Base;
	ULONG Size;
	ULONG Flags;
	USHORT Index;
	USHORT Unknown;
	USHORT LoadCount;
	USHORT ModuleNameOffset;
	CHAR ImageName[256];
} SYSTEM_MODULE, * PSYSTEM_MODULE;

typedef struct _SYSTEM_MODULE_INFORMATION
{
	ULONG_PTR ulModuleCount;
	SYSTEM_MODULE Modules[1];
} SYSTEM_MODULE_INFORMATION, * PSYSTEM_MODULE_INFORMATION;

EXTERN_C  NTSTATUS ZwQuerySystemInformation(
	DWORD32 systemInformationClass,
	PVOID systemInformation,
	ULONG systemInformationLength,
	PULONG returnLength);

#pragma warning(disable : 4201)

/* 微软官方文档定义
*   https://docs.microsoft.com/en-us/windows/win32/etw/wnode-header*/
typedef struct _WNODE_HEADER
{
	ULONG BufferSize;
	ULONG ProviderId;
	union {
		ULONG64 HistoricalContext;
		struct {
			ULONG Version;
			ULONG Linkage;
		};
	};
	union {
		HANDLE KernelHandle;
		LARGE_INTEGER TimeStamp;
	};
	GUID Guid;
	ULONG ClientContext;
	ULONG Flags;
} WNODE_HEADER, * PWNODE_HEADER;

/* 微软文档定义
*   https://docs.microsoft.com/en-us/windows/win32/api/evntrace/ns-evntrace-event_trace_properties*/
typedef struct _EVENT_TRACE_PROPERTIES
{
	WNODE_HEADER Wnode;
	ULONG BufferSize;
	ULONG MinimumBuffers;
	ULONG MaximumBuffers;
	ULONG MaximumFileSize;
	ULONG LogFileMode;
	ULONG FlushTimer;
	ULONG EnableFlags;
	union {
		LONG AgeLimit;
		LONG FlushThreshold;
	} DUMMYUNIONNAME;
	ULONG NumberOfBuffers;
	ULONG FreeBuffers;
	ULONG EventsLost;
	ULONG BuffersWritten;
	ULONG LogBuffersLost;
	ULONG RealTimeBuffersLost;
	HANDLE LoggerThreadId;
	ULONG LogFileNameOffset;
	ULONG LoggerNameOffset;
} EVENT_TRACE_PROPERTIES, * PEVENT_TRACE_PROPERTIES;

/* 这结构是大佬逆向出来的 */
typedef struct _CKCL_TRACE_PROPERIES : EVENT_TRACE_PROPERTIES
{
	ULONG64 Unknown[3];
	UNICODE_STRING ProviderName;
} CKCL_TRACE_PROPERTIES, * PCKCL_TRACE_PROPERTIES;

EXTERN_C
NTSTATUS
NTAPI
NtTraceControl(
	_In_ ULONG FunctionCode,
	_In_reads_bytes_opt_(InBufferLen) PVOID InBuffer,
	_In_ ULONG InBufferLen,
	_Out_writes_bytes_opt_(OutBufferLen) PVOID OutBuffer,
	_In_ ULONG OutBufferLen,
	_Out_ PULONG ReturnLength);
```

`hde/hde64.cpp`:

```cpp
/*
 * Hacker Disassembler Engine 64 C
 * Copyright (c) 2008-2009, Vyacheslav Patkov.
 * All rights reserved.
 *
 */
#include <ntifs.h>
#include <ntdef.h>
#include <ntddk.h>
#include <intrin.h>
#include <ntimage.h> //Kernel program pe format headfile


#if defined(_M_X64) || defined(__x86_64__)
#pragma warning(push, 0)
#pragma warning(disable: 4701 4706 26451)

#include "hde64.h"
#include "table64.h"

unsigned int hde64_disasm(const void* code, hde64s* hs)
{
	uint8_t x, c, * p = (uint8_t*)code, cflags, opcode, pref = 0;
	uint8_t* ht = hde64_table, m_mod, m_reg, m_rm, disp_size = 0;
	uint8_t op64 = 0;

	// Avoid using memset to reduce the footprint.
	memset(hs, 0, sizeof(hde64s));

	for (x = 16; x; x--)
		switch (c = *p++) {
		case 0xf3:
			hs->p_rep = c;
			pref |= PRE_F3;
			break;
		case 0xf2:
			hs->p_rep = c;
			pref |= PRE_F2;
			break;
		case 0xf0:
			hs->p_lock = c;
			pref |= PRE_LOCK;
			break;
		case 0x26: case 0x2e: case 0x36:
		case 0x3e: case 0x64: case 0x65:
			hs->p_seg = c;
			pref |= PRE_SEG;
			break;
		case 0x66:
			hs->p_66 = c;
			pref |= PRE_66;
			break;
		case 0x67:
			hs->p_67 = c;
			pref |= PRE_67;
			break;
		default:
			goto pref_done;
		}
pref_done:

	hs->flags = (uint32_t)pref << 23;

	if (!pref)
		pref |= PRE_NONE;

	if ((c & 0xf0) == 0x40) {
		hs->flags |= F_PREFIX_REX;
		if ((hs->rex_w = (c & 0xf) >> 3) && (*p & 0xf8) == 0xb8)
			op64++;
		hs->rex_r = (c & 7) >> 2;
		hs->rex_x = (c & 3) >> 1;
		hs->rex_b = c & 1;
		if (((c = *p++) & 0xf0) == 0x40) {
			opcode = c;
			goto error_opcode;
		}
	}

	if ((hs->opcode = c) == 0x0f) {
		hs->opcode2 = c = *p++;
		ht += DELTA_OPCODES;
	}
	else if (c >= 0xa0 && c <= 0xa3) {
		op64++;
		if (pref & PRE_67)
			pref |= PRE_66;
		else
			pref &= ~PRE_66;
	}

	opcode = c;
	cflags = ht[ht[opcode / 4] + (opcode % 4)];

	if (cflags == C_ERROR) {
	error_opcode:
		hs->flags |= F_ERROR | F_ERROR_OPCODE;
		cflags = 0;
		if ((opcode & -3) == 0x24)
			cflags++;
	}

	x = 0;
	if (cflags & C_GROUP) {
		uint16_t t;
		t = *(uint16_t*)(ht + (cflags & 0x7f));
		cflags = (uint8_t)t;
		x = (uint8_t)(t >> 8);
	}

	if (hs->opcode2) {
		ht = hde64_table + DELTA_PREFIXES;
		if (ht[ht[opcode / 4] + (opcode % 4)] & pref)
			hs->flags |= F_ERROR | F_ERROR_OPCODE;
	}

	if (cflags & C_MODRM) {
		hs->flags |= F_MODRM;
		hs->modrm = c = *p++;
		hs->modrm_mod = m_mod = c >> 6;
		hs->modrm_rm = m_rm = c & 7;
		hs->modrm_reg = m_reg = (c & 0x3f) >> 3;

		if (x && ((x << m_reg) & 0x80))
			hs->flags |= F_ERROR | F_ERROR_OPCODE;

		if (!hs->opcode2 && opcode >= 0xd9 && opcode <= 0xdf) {
			uint8_t t = opcode - 0xd9;
			if (m_mod == 3) {
				ht = hde64_table + DELTA_FPU_MODRM + t * 8;
				t = ht[m_reg] << m_rm;
			}
			else {
				ht = hde64_table + DELTA_FPU_REG;
				t = ht[t] << m_reg;
			}
			if (t & 0x80)
				hs->flags |= F_ERROR | F_ERROR_OPCODE;
		}

		if (pref & PRE_LOCK) {
			if (m_mod == 3) {
				hs->flags |= F_ERROR | F_ERROR_LOCK;
			}
			else {
				uint8_t* table_end, op = opcode;
				if (hs->opcode2) {
					ht = hde64_table + DELTA_OP2_LOCK_OK;
					table_end = ht + DELTA_OP_ONLY_MEM - DELTA_OP2_LOCK_OK;
				}
				else {
					ht = hde64_table + DELTA_OP_LOCK_OK;
					table_end = ht + DELTA_OP2_LOCK_OK - DELTA_OP_LOCK_OK;
					op &= -2;
				}
				for (; ht != table_end; ht++)
					if (*ht++ == op) {
						if (!((*ht << m_reg) & 0x80))
							goto no_lock_error;
						else
							break;
					}
				hs->flags |= F_ERROR | F_ERROR_LOCK;
			no_lock_error:
				;
			}
		}

		if (hs->opcode2) {
			switch (opcode) {
			case 0x20: case 0x22:
				m_mod = 3;
				if (m_reg > 4 || m_reg == 1)
					goto error_operand;
				else
					goto no_error_operand;
			case 0x21: case 0x23:
				m_mod = 3;
				if (m_reg == 4 || m_reg == 5)
					goto error_operand;
				else
					goto no_error_operand;
			}
		}
		else {
			switch (opcode) {
			case 0x8c:
				if (m_reg > 5)
					goto error_operand;
				else
					goto no_error_operand;
			case 0x8e:
				if (m_reg == 1 || m_reg > 5)
					goto error_operand;
				else
					goto no_error_operand;
			}
		}

		if (m_mod == 3) {
			uint8_t* table_end;
			if (hs->opcode2) {
				ht = hde64_table + DELTA_OP2_ONLY_MEM;
				table_end = ht + sizeof(hde64_table) - DELTA_OP2_ONLY_MEM;
			}
			else {
				ht = hde64_table + DELTA_OP_ONLY_MEM;
				table_end = ht + DELTA_OP2_ONLY_MEM - DELTA_OP_ONLY_MEM;
			}
			for (; ht != table_end; ht += 2)
				if (*ht++ == opcode) {
					if (*ht++ & pref && !((*ht << m_reg) & 0x80))
						goto error_operand;
					else
						break;
				}
			goto no_error_operand;
		}
		else if (hs->opcode2) {
			switch (opcode) {
			case 0x50: case 0xd7: case 0xf7:
				if (pref & (PRE_NONE | PRE_66))
					goto error_operand;
				break;
			case 0xd6:
				if (pref & (PRE_F2 | PRE_F3))
					goto error_operand;
				break;
			case 0xc5:
				goto error_operand;
			}
			goto no_error_operand;
		}
		else
			goto no_error_operand;

	error_operand:
		hs->flags |= F_ERROR | F_ERROR_OPERAND;
	no_error_operand:

		c = *p++;
		if (m_reg <= 1) {
			if (opcode == 0xf6)
				cflags |= C_IMM8;
			else if (opcode == 0xf7)
				cflags |= C_IMM_P66;
		}

		switch (m_mod) {
		case 0:
			if (pref & PRE_67) {
				if (m_rm == 6)
					disp_size = 2;
			}
			else
				if (m_rm == 5)
					disp_size = 4;
			break;
		case 1:
			disp_size = 1;
			break;
		case 2:
			disp_size = 2;
			if (!(pref & PRE_67))
				disp_size <<= 1;
		}

		if (m_mod != 3 && m_rm == 4) {
			hs->flags |= F_SIB;
			p++;
			hs->sib = c;
			hs->sib_scale = c >> 6;
			hs->sib_index = (c & 0x3f) >> 3;
			if ((hs->sib_base = c & 7) == 5 && !(m_mod & 1))
				disp_size = 4;
		}

		p--;
		switch (disp_size) {
		case 1:
			hs->flags |= F_DISP8;
			hs->disp.disp8 = *p;
			break;
		case 2:
			hs->flags |= F_DISP16;
			hs->disp.disp16 = *(uint16_t*)p;
			break;
		case 4:
			hs->flags |= F_DISP32;
			hs->disp.disp32 = *(uint32_t*)p;
		}
		p += disp_size;
	}
	else if (pref & PRE_LOCK)
		hs->flags |= F_ERROR | F_ERROR_LOCK;

	if (cflags & C_IMM_P66) {
		if (cflags & C_REL32) {
			if (pref & PRE_66) {
				hs->flags |= F_IMM16 | F_RELATIVE;
				hs->imm.imm16 = *(uint16_t*)p;
				p += 2;
				goto disasm_done;
			}
			goto rel32_ok;
		}
		if (op64) {
			hs->flags |= F_IMM64;
			hs->imm.imm64 = *(uint64_t*)p;
			p += 8;
		}
		else if (!(pref & PRE_66)) {
			hs->flags |= F_IMM32;
			hs->imm.imm32 = *(uint32_t*)p;
			p += 4;
		}
		else
			goto imm16_ok;
	}

	if (cflags & C_IMM16) {
	imm16_ok:
		hs->flags |= F_IMM16;
		hs->imm.imm16 = *(uint16_t*)p;
		p += 2;
	}
	if (cflags & C_IMM8) {
		hs->flags |= F_IMM8;
		hs->imm.imm8 = *p++;
	}

	if (cflags & C_REL32) {
	rel32_ok:
		hs->flags |= F_IMM32 | F_RELATIVE;
		hs->imm.imm32 = *(uint32_t*)p;
		p += 4;
	}
	else if (cflags & C_REL8) {
		hs->flags |= F_IMM8 | F_RELATIVE;
		hs->imm.imm8 = *p++;
	}

disasm_done:

	if ((hs->len = (uint8_t)(p - (uint8_t*)code)) > 15) {
		hs->flags |= F_ERROR | F_ERROR_LENGTH;
		hs->len = 15;
	}

	return (unsigned int)hs->len;
}

#pragma warning(pop)
#endif // defined(_M_X64) || defined(__x86_64__)
```

`hde/hde64.h`:

```h
/*
 * Hacker Disassembler Engine 64
 * Copyright (c) 2008-2009, Vyacheslav Patkov.
 * All rights reserved.
 *
 * hde64.h: C/C++ header file
 *
 */

#ifndef _HDE64_H_
#define _HDE64_H_

/* stdint.h - C99 standard header
 * http://en.wikipedia.org/wiki/stdint.h
 *
 * if your compiler doesn't contain "stdint.h" header (for
 * example, Microsoft Visual C++), you can download file:
 *   http://www.azillionmonkeys.com/qed/pstdint.h
 * and change next line to:
 *   #include "pstdint.h"
 */
#include "pstdint.h"

#define F_MODRM         0x00000001
#define F_SIB           0x00000002
#define F_IMM8          0x00000004
#define F_IMM16         0x00000008
#define F_IMM32         0x00000010
#define F_IMM64         0x00000020
#define F_DISP8         0x00000040
#define F_DISP16        0x00000080
#define F_DISP32        0x00000100
#define F_RELATIVE      0x00000200
#define F_ERROR         0x00001000
#define F_ERROR_OPCODE  0x00002000
#define F_ERROR_LENGTH  0x00004000
#define F_ERROR_LOCK    0x00008000
#define F_ERROR_OPERAND 0x00010000
#define F_PREFIX_REPNZ  0x01000000
#define F_PREFIX_REPX   0x02000000
#define F_PREFIX_REP    0x03000000
#define F_PREFIX_66     0x04000000
#define F_PREFIX_67     0x08000000
#define F_PREFIX_LOCK   0x10000000
#define F_PREFIX_SEG    0x20000000
#define F_PREFIX_REX    0x40000000
#define F_PREFIX_ANY    0x7f000000

#define PREFIX_SEGMENT_CS   0x2e
#define PREFIX_SEGMENT_SS   0x36
#define PREFIX_SEGMENT_DS   0x3e
#define PREFIX_SEGMENT_ES   0x26
#define PREFIX_SEGMENT_FS   0x64
#define PREFIX_SEGMENT_GS   0x65
#define PREFIX_LOCK         0xf0
#define PREFIX_REPNZ        0xf2
#define PREFIX_REPX         0xf3
#define PREFIX_OPERAND_SIZE 0x66
#define PREFIX_ADDRESS_SIZE 0x67

#pragma pack(push,1)

typedef struct {
    uint8_t len;
    uint8_t p_rep;
    uint8_t p_lock;
    uint8_t p_seg;
    uint8_t p_66;
    uint8_t p_67;
    uint8_t rex;
    uint8_t rex_w;
    uint8_t rex_r;
    uint8_t rex_x;
    uint8_t rex_b;
    uint8_t opcode;
    uint8_t opcode2;
    uint8_t modrm;
    uint8_t modrm_mod;
    uint8_t modrm_reg;
    uint8_t modrm_rm;
    uint8_t sib;
    uint8_t sib_scale;
    uint8_t sib_index;
    uint8_t sib_base;
    union {
        uint8_t imm8;
        uint16_t imm16;
        uint32_t imm32;
        uint64_t imm64;
    } imm;
    union {
        uint8_t disp8;
        uint16_t disp16;
        uint32_t disp32;
    } disp;
    uint32_t flags;
} hde64s;

#pragma pack(pop)

#ifdef __cplusplus
extern "C" {
#endif

/* __cdecl */
unsigned int hde64_disasm(const void *code, hde64s *hs);

#ifdef __cplusplus
}
#endif

#endif /* _HDE64_H_ */

```

`hde/pstdint.h`:

```h
/*
 *  MinHook - The Minimalistic API Hooking Library for x64/x86
 *  Copyright (C) 2009-2017 Tsuda Kageyu. All rights reserved.
 *
 *  Redistribution and use in source and binary forms, with or without
 *  modification, are permitted provided that the following conditions
 *  are met:
 *
 *  1. Redistributions of source code must retain the above copyright
 *     notice, this list of conditions and the following disclaimer.
 *  2. Redistributions in binary form must reproduce the above copyright
 *     notice, this list of conditions and the following disclaimer in the
 *     documentation and/or other materials provided with the distribution.
 *
 *  THIS SOFTWARE IS PROVIDED BY THE AUTHOR "AS IS" AND ANY EXPRESS OR
 *  IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 *  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 *  IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
 *  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 *  DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 *  THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 *  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 *  THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#pragma once

// Integer types for HDE.
typedef INT8   int8_t;
typedef INT16  int16_t;
typedef INT32  int32_t;
typedef INT64  int64_t;
typedef UINT8  uint8_t;
typedef UINT16 uint16_t;
typedef UINT32 uint32_t;
typedef UINT64 uint64_t;

```

`hde/table64.h`:

```h
/*
 * Hacker Disassembler Engine 64 C
 * Copyright (c) 2008-2009, Vyacheslav Patkov.
 * All rights reserved.
 *
 */

#define C_NONE    0x00
#define C_MODRM   0x01
#define C_IMM8    0x02
#define C_IMM16   0x04
#define C_IMM_P66 0x10
#define C_REL8    0x20
#define C_REL32   0x40
#define C_GROUP   0x80
#define C_ERROR   0xff

#define PRE_ANY  0x00
#define PRE_NONE 0x01
#define PRE_F2   0x02
#define PRE_F3   0x04
#define PRE_66   0x08
#define PRE_67   0x10
#define PRE_LOCK 0x20
#define PRE_SEG  0x40
#define PRE_ALL  0xff

#define DELTA_OPCODES      0x4a
#define DELTA_FPU_REG      0xfd
#define DELTA_FPU_MODRM    0x104
#define DELTA_PREFIXES     0x13c
#define DELTA_OP_LOCK_OK   0x1ae
#define DELTA_OP2_LOCK_OK  0x1c6
#define DELTA_OP_ONLY_MEM  0x1d8
#define DELTA_OP2_ONLY_MEM 0x1e7

unsigned char hde64_table[] = {
  0xa5,0xaa,0xa5,0xb8,0xa5,0xaa,0xa5,0xaa,0xa5,0xb8,0xa5,0xb8,0xa5,0xb8,0xa5,
  0xb8,0xc0,0xc0,0xc0,0xc0,0xc0,0xc0,0xc0,0xc0,0xac,0xc0,0xcc,0xc0,0xa1,0xa1,
  0xa1,0xa1,0xb1,0xa5,0xa5,0xa6,0xc0,0xc0,0xd7,0xda,0xe0,0xc0,0xe4,0xc0,0xea,
  0xea,0xe0,0xe0,0x98,0xc8,0xee,0xf1,0xa5,0xd3,0xa5,0xa5,0xa1,0xea,0x9e,0xc0,
  0xc0,0xc2,0xc0,0xe6,0x03,0x7f,0x11,0x7f,0x01,0x7f,0x01,0x3f,0x01,0x01,0xab,
  0x8b,0x90,0x64,0x5b,0x5b,0x5b,0x5b,0x5b,0x92,0x5b,0x5b,0x76,0x90,0x92,0x92,
  0x5b,0x5b,0x5b,0x5b,0x5b,0x5b,0x5b,0x5b,0x5b,0x5b,0x5b,0x5b,0x6a,0x73,0x90,
  0x5b,0x52,0x52,0x52,0x52,0x5b,0x5b,0x5b,0x5b,0x77,0x7c,0x77,0x85,0x5b,0x5b,
  0x70,0x5b,0x7a,0xaf,0x76,0x76,0x5b,0x5b,0x5b,0x5b,0x5b,0x5b,0x5b,0x5b,0x5b,
  0x5b,0x5b,0x86,0x01,0x03,0x01,0x04,0x03,0xd5,0x03,0xd5,0x03,0xcc,0x01,0xbc,
  0x03,0xf0,0x03,0x03,0x04,0x00,0x50,0x50,0x50,0x50,0xff,0x20,0x20,0x20,0x20,
  0x01,0x01,0x01,0x01,0xc4,0x02,0x10,0xff,0xff,0xff,0x01,0x00,0x03,0x11,0xff,
  0x03,0xc4,0xc6,0xc8,0x02,0x10,0x00,0xff,0xcc,0x01,0x01,0x01,0x00,0x00,0x00,
  0x00,0x01,0x01,0x03,0x01,0xff,0xff,0xc0,0xc2,0x10,0x11,0x02,0x03,0x01,0x01,
  0x01,0xff,0xff,0xff,0x00,0x00,0x00,0xff,0x00,0x00,0xff,0xff,0xff,0xff,0x10,
  0x10,0x10,0x10,0x02,0x10,0x00,0x00,0xc6,0xc8,0x02,0x02,0x02,0x02,0x06,0x00,
  0x04,0x00,0x02,0xff,0x00,0xc0,0xc2,0x01,0x01,0x03,0x03,0x03,0xca,0x40,0x00,
  0x0a,0x00,0x04,0x00,0x00,0x00,0x00,0x7f,0x00,0x33,0x01,0x00,0x00,0x00,0x00,
  0x00,0x00,0xff,0xbf,0xff,0xff,0x00,0x00,0x00,0x00,0x07,0x00,0x00,0xff,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xff,0xff,
  0x00,0x00,0x00,0xbf,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7f,0x00,0x00,
  0xff,0x40,0x40,0x40,0x40,0x41,0x49,0x40,0x40,0x40,0x40,0x4c,0x42,0x40,0x40,
  0x40,0x40,0x40,0x40,0x40,0x40,0x4f,0x44,0x53,0x40,0x40,0x40,0x44,0x57,0x43,
  0x5c,0x40,0x60,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,
  0x40,0x40,0x64,0x66,0x6e,0x6b,0x40,0x40,0x6a,0x46,0x40,0x40,0x44,0x46,0x40,
  0x40,0x5b,0x44,0x40,0x40,0x00,0x00,0x00,0x00,0x06,0x06,0x06,0x06,0x01,0x06,
  0x06,0x02,0x06,0x06,0x00,0x06,0x00,0x0a,0x0a,0x00,0x00,0x00,0x02,0x07,0x07,
  0x06,0x02,0x0d,0x06,0x06,0x06,0x0e,0x05,0x05,0x02,0x02,0x00,0x00,0x04,0x04,
  0x04,0x04,0x05,0x06,0x06,0x06,0x00,0x00,0x00,0x0e,0x00,0x00,0x08,0x00,0x10,
  0x00,0x18,0x00,0x20,0x00,0x28,0x00,0x30,0x00,0x80,0x01,0x82,0x01,0x86,0x00,
  0xf6,0xcf,0xfe,0x3f,0xab,0x00,0xb0,0x00,0xb1,0x00,0xb3,0x00,0xba,0xf8,0xbb,
  0x00,0xc0,0x00,0xc1,0x00,0xc7,0xbf,0x62,0xff,0x00,0x8d,0xff,0x00,0xc4,0xff,
  0x00,0xc5,0xff,0x00,0xff,0xff,0xeb,0x01,0xff,0x0e,0x12,0x08,0x00,0x13,0x09,
  0x00,0x16,0x08,0x00,0x17,0x09,0x00,0x2b,0x09,0x00,0xae,0xff,0x07,0xb2,0xff,
  0x00,0xb4,0xff,0x00,0xb5,0xff,0x00,0xc3,0x01,0x00,0xc7,0xff,0xbf,0xe7,0x08,
  0x00,0xf0,0x02,0x00
};

```

`hook.cpp`:

```cpp
#include <ntifs.h>
#include <wdm.h>
#include <intrin.h>
#include "Global.h"


extern EtwHook g_Etwhook;


NTSTATUS MyNtCreateFile(PHANDLE FileHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, PIO_STATUS_BLOCK IoStatusBlock, PLARGE_INTEGER AllocationSize, ULONG FileAttributes, ULONG ShareAccess, ULONG CreateDisposition, ULONG CreateOptions, PVOID EaBuffer, ULONG EaLength);



NTSTATUS MyNtCreateFile(PHANDLE FileHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, PIO_STATUS_BLOCK IoStatusBlock, PLARGE_INTEGER AllocationSize, ULONG FileAttributes, ULONG ShareAccess, ULONG CreateDisposition, ULONG CreateOptions, PVOID EaBuffer, ULONG EaLength)
{
	if (ObjectAttributes && ObjectAttributes->ObjectName && ObjectAttributes->ObjectName->Buffer) {
		if(DesiredAccess>=0x10000)
		KdPrint(("【EtwHook】:Hook Successly.the DesiredAccess==0x%x\n", DesiredAccess));
		


	}
	UNICODE_STRING usNtCreateFile = RTL_CONSTANT_STRING(L"NtCreateFile");
	FNtCreateFile _ori_NtCreateFile = (FNtCreateFile)MmGetSystemRoutineAddress(&usNtCreateFile);


	return _ori_NtCreateFile(FileHandle, DesiredAccess, ObjectAttributes, IoStatusBlock, AllocationSize, FileAttributes, ShareAccess, CreateDisposition, CreateOptions, EaBuffer, EaLength);
	
}

void __fastcall hook_etw_call_back(unsigned long ssdt_index, void** ssdt_address) {
	//this is really hook ntapi func
	//filter the callindex or addr 
	UNREFERENCED_PARAMETER(ssdt_index);
	
	ULONG_PTR uMyFuncAddr=g_Etwhook.is_hook_func((ULONG_PTR)*ssdt_address);

	
	if (uMyFuncAddr) *ssdt_address = (void*)uMyFuncAddr;

}
//os buildnum <18363
unsigned long long MyGetCpuClock() {


	if (ExGetPreviousMode() == KernelMode) return __rdtsc();

	const long SYSCALL_MAGIC_1 = 0x501802;
	const short SYSCALL_MAGIC_2 = 0xf33;
	

	PKTHREAD CurrentThread = (PKTHREAD)__readgsqword(0x188);

	unsigned int call_index = 0;
	DWORD32 dwBuildNumer = g_Etwhook.ret_build_num();

	//get callindex
	if(dwBuildNumer<=7601) call_index = *(unsigned int*)((unsigned long long)CurrentThread + 0x1f8);
	else call_index = *(unsigned int*)((unsigned long long)CurrentThread + 0x80);

	void** stack_max = (void**)__readgsqword(0x1a8);
	void** stack_frame = (void**)_AddressOfReturnAddress();

	//from bottom to top
	for (void** stack_current = stack_max; stack_current > stack_frame; stack_current--) {
		
		if (*(long*)stack_current != SYSCALL_MAGIC_1) continue;

		stack_current--;

		if (*(short*)stack_current != SYSCALL_MAGIC_2) continue;

		//is a syscall

		//find a retvaule in syscall entry range

		for (; stack_current < stack_max; stack_current++) {

			//rough estimate
			if ((ULONG_PTR)(*stack_current) >= g_Etwhook.ret_syscall_entry() && (ULONG_PTR)(*stack_current) <= g_Etwhook.ret_syscall_entry() + 2 * PAGE_SIZE) {

				//find 

				void** syscall_call_func = &stack_current[9];

				//modify syscall_call_func and hook
				hook_etw_call_back(call_index, syscall_call_func);

				break;
			}

		}

		break; //must break in here else the os will crash!!!
	}

	return __rdtsc();
}

unsigned long long MyHvlGetQpcBias() {
	ULONG_PTR pTscpage = g_Etwhook.ret_tsc_page();
	
	
	MyGetCpuClock();


	return *((unsigned long long*)(*((unsigned long long*)pTscpage)) + 3);//HvlGetQpcBias really done

}



```

`readme.md`:

```md
I just make etwhook object-oriented and update the way to find CkclWinloggerContext

still hook HvlGetQpcBias 

for my test,and PatchGuard not be triggerred for 24h.

reference:github project InfinityHookPro


if there are any questions,please contact with me by e-mail 

my email:304914289@qq.com

EteHook class

```

`x64/Debug/InfinityHook.Build.CppClean.log`:

```log
c:\users\administrator\source\repos\自写项目\infinityhook\x64\debug\vc142.pdb
c:\users\administrator\source\repos\自写项目\infinityhook\x64\debug\main.obj
c:\users\administrator\source\repos\自写项目\infinityhook\x64\debug\hook.obj
c:\users\administrator\source\repos\自写项目\infinityhook\x64\debug\hde64.obj
c:\users\administrator\source\repos\自写项目\infinityhook\x64\debug\global.obj
c:\users\administrator\source\repos\自写项目\x64\debug\infinityhook.sys
c:\users\administrator\source\repos\自写项目\x64\debug\infinityhook.pdb
c:\users\administrator\source\repos\自写项目\x64\debug\infinityhook.cer
c:\users\administrator\source\repos\自写项目\infinityhook\x64\debug\infinityhook.tlog\cl.command.1.tlog
c:\users\administrator\source\repos\自写项目\infinityhook\x64\debug\infinityhook.tlog\cl.read.1.tlog
c:\users\administrator\source\repos\自写项目\infinityhook\x64\debug\infinityhook.tlog\cl.write.1.tlog
c:\users\administrator\source\repos\自写项目\infinityhook\x64\debug\infinityhook.tlog\link.command.1.tlog
c:\users\administrator\source\repos\自写项目\infinityhook\x64\debug\infinityhook.tlog\link.read.1.tlog
c:\users\administrator\source\repos\自写项目\infinityhook\x64\debug\infinityhook.tlog\link.write.1.tlog
c:\users\administrator\source\repos\自写项目\infinityhook\x64\debug\infinityhook.tlog\signtool.command.1.tlog
c:\users\administrator\source\repos\自写项目\infinityhook\x64\debug\infinityhook.tlog\signtool.read.1.tlog
c:\users\administrator\source\repos\自写项目\infinityhook\x64\debug\infinityhook.tlog\signtool.timestamp.1.tlog
c:\users\administrator\source\repos\自写项目\infinityhook\x64\debug\infinityhook.tlog\signtool.write.1.tlog

```

`x64/Debug/InfinityHook.log`:

```log
  Building 'InfinityHook' with toolset 'WindowsKernelModeDriver10.0' and the 'Desktop' target platform.
  Global.cpp
  hde64.cpp
  hook.cpp
  main.cpp
  正在生成代码...
  InfinityHook.vcxproj -> C:\Users\Administrator\source\repos\自写项目\x64\Debug\InfinityHook.sys
  Done Adding Additional Store
  Successfully signed: C:\Users\Administrator\source\repos\\x64\Debug\InfinityHook.sys
  
  Inf2Cat task was skipped as there were no inf files to process
  

```

`x64/Debug/InfinityHook.sys.recipe`:

```recipe
<?xml version="1.0" encoding="utf-8"?>
<Project>
  <ProjectOutputs>
    <ProjectOutput>
      <FullPath>C:\Users\Administrator\source\repos\自写项目\x64\Debug\InfinityHook.sys</FullPath>
    </ProjectOutput>
  </ProjectOutputs>
  <ContentFiles />
  <SatelliteDlls />
  <NonRecipeFileRefs />
</Project>
```

`x64/Debug/InfinityHook.tlog/CL.command.1.tlog`:

```tlog
^C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\GLOBAL.CPP
/c /IX64\DEBUG\ /Zi /nologo /W4 /WX /diagnostics:column /Od /Oi /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D DEPRECATE_DDK_FUNCTIONS=1 /D MSC_NOOPT /D _WIN32_WINNT=0x0A00 /D WINVER=0x0A00 /D WINNT=1 /D NTDDI_VERSION=0x0A000007 /D DBG=1 /GF /Gm- /Zp8 /GS /guard:cf /Gy /fp:precise /Qspectre /Zc:wchar_t- /Zc:forScope /Zc:inline /GR- /Fo"X64\DEBUG\\" /Fd"X64\DEBUG\VC142.PDB" /external:W4 /Gz /wd4748 /wd4603 /wd4627 /wd4986 /wd4987 /wd4996 /FI"C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\WARNING.H" /FC /kernel -cbstring -d2epilogunwind /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\GLOBAL.CPP
^C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\HDE\HDE64.CPP
/c /IX64\DEBUG\ /Zi /nologo /W4 /WX /diagnostics:column /Od /Oi /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D DEPRECATE_DDK_FUNCTIONS=1 /D MSC_NOOPT /D _WIN32_WINNT=0x0A00 /D WINVER=0x0A00 /D WINNT=1 /D NTDDI_VERSION=0x0A000007 /D DBG=1 /GF /Gm- /Zp8 /GS /guard:cf /Gy /fp:precise /Qspectre /Zc:wchar_t- /Zc:forScope /Zc:inline /GR- /Fo"X64\DEBUG\\" /Fd"X64\DEBUG\VC142.PDB" /external:W4 /Gz /wd4748 /wd4603 /wd4627 /wd4986 /wd4987 /wd4996 /FI"C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\WARNING.H" /FC /kernel -cbstring -d2epilogunwind /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\HDE\HDE64.CPP
^C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\HOOK.CPP
/c /IX64\DEBUG\ /Zi /nologo /W4 /WX /diagnostics:column /Od /Oi /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D DEPRECATE_DDK_FUNCTIONS=1 /D MSC_NOOPT /D _WIN32_WINNT=0x0A00 /D WINVER=0x0A00 /D WINNT=1 /D NTDDI_VERSION=0x0A000007 /D DBG=1 /GF /Gm- /Zp8 /GS /guard:cf /Gy /fp:precise /Qspectre /Zc:wchar_t- /Zc:forScope /Zc:inline /GR- /Fo"X64\DEBUG\\" /Fd"X64\DEBUG\VC142.PDB" /external:W4 /Gz /wd4748 /wd4603 /wd4627 /wd4986 /wd4987 /wd4996 /FI"C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\WARNING.H" /FC /kernel -cbstring -d2epilogunwind /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\HOOK.CPP
^C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\MAIN.CPP
/c /IX64\DEBUG\ /Zi /nologo /W4 /WX /diagnostics:column /Od /Oi /Oy- /D _WIN64 /D _AMD64_ /D AMD64 /D DEPRECATE_DDK_FUNCTIONS=1 /D MSC_NOOPT /D _WIN32_WINNT=0x0A00 /D WINVER=0x0A00 /D WINNT=1 /D NTDDI_VERSION=0x0A000007 /D DBG=1 /GF /Gm- /Zp8 /GS /guard:cf /Gy /fp:precise /Qspectre /Zc:wchar_t- /Zc:forScope /Zc:inline /GR- /Fo"X64\DEBUG\\" /Fd"X64\DEBUG\VC142.PDB" /external:W4 /Gz /wd4748 /wd4603 /wd4627 /wd4986 /wd4987 /wd4996 /FI"C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\WARNING.H" /FC /kernel -cbstring -d2epilogunwind /d1import_no_registry /d2AllowCompatibleILVersions /d2Zi+  C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\MAIN.CPP

```

`x64/Debug/InfinityHook.tlog/CL.read.1.tlog`:

```tlog
^C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\GLOBAL.CPP
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SUPPRESS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\VADEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\WINPACKAGEFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\AMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\NTIMAGE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\PSHPACK2.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\PSHPACK8.H
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\UNDOCFUNCANDSTR.H
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\GLOBAL.H
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\HDE\HDE64.H
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\HDE\PSTDINT.H
^C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\HDE\HDE64.CPP
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SUPPRESS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\VADEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\WINPACKAGEFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\AMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\NTIMAGE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\PSHPACK2.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\PSHPACK8.H
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\HDE\HDE64.H
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\HDE\PSTDINT.H
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\HDE\TABLE64.H
^C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\HOOK.CPP
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SUPPRESS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\VADEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\WINPACKAGEFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\NTNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\INTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\SETJMP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\IMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\WMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\NMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\SMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\TMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\PMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\EMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\XMMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\MMINTRIN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\AMMINTRIN.H
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\GLOBAL.H
^C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\MAIN.CPP
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\WARNING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SUPPRESS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\NTIFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\NTDDK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\WDM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\EXCPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\CRTDEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\CONCURRENCYSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\VADEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\NTDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\WINPACKAGEFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\CRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\SDKDDKVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\NTSTATUS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\BUGCODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\NTIOLOGC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\MCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\DPFILTER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\EVNTPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\SHARED\DEVPROPDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.18362.0\KM\NTNLS.H
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\GLOBAL.H
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\UNDOCFUNCANDSTR.H

```

`x64/Debug/InfinityHook.tlog/CL.write.1.tlog`:

```tlog
^C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\GLOBAL.CPP|C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\HDE\HDE64.CPP|C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\HOOK.CPP|C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\MAIN.CPP
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\VC142.PDB
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\MAIN.OBJ
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\HOOK.OBJ
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\HDE64.OBJ
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\GLOBAL.OBJ
^C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\GLOBAL.CPP
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\VC142.PDB
^C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\HDE\HDE64.CPP
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\VC142.PDB
^C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\HOOK.CPP
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\VC142.PDB
^C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\MAIN.CPP
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\VC142.PDB

```

`x64/Debug/InfinityHook.tlog/InfinityHook.lastbuildstate`:

```lastbuildstate
PlatformToolSet=WindowsKernelModeDriver10.0:VCToolArchitecture=Native32Bit:VCToolsVersion=14.29.30133:VCServicingVersionMFC=14.29.30136:TargetPlatformVersion=10.0.18362.0:
Debug|x64|C:\Users\Administrator\source\repos\自写项目\|

```

`x64/Debug/InfinityHook.tlog/link.command.1.tlog`:

```tlog
^C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\GLOBAL.OBJ|C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\HDE64.OBJ|C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\HOOK.OBJ|C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\MAIN.OBJ
/OUT:"C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\X64\DEBUG\INFINITYHOOK.SYS" /VERSION:"10.0" /INCREMENTAL:NO /NOLOGO /WX /SECTION:"INIT,d" "C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.18362.0\KM\X64\BUFFEROVERFLOWFASTFAILK.LIB" "C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.18362.0\KM\X64\NTOSKRNL.LIB" "C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.18362.0\KM\X64\HAL.LIB" "C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.18362.0\KM\X64\WMILIB.LIB" /NODEFAULTLIB /MANIFEST:NO /DEBUG /PDB:"C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\X64\DEBUG\INFINITYHOOK.PDB" /SUBSYSTEM:NATIVE,"10.00" /Driver /OPT:REF /OPT:ICF /ENTRY:"GsDriverEntry" /RELEASE /IMPLIB:"C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\X64\DEBUG\INFINITYHOOK.LIB" /MERGE:"_TEXT=.text;_PAGE=PAGE" /MACHINE:X64 /PROFILE /guard:cf /kernel /IGNORE:4198,4010,4037,4039,4065,4070,4078,4087,4089,4221,4108,4088,4218,4218,4235 /osversion:10.0 /pdbcompress /debugtype:pdata X64\DEBUG\GLOBAL.OBJ
X64\DEBUG\HDE64.OBJ
X64\DEBUG\HOOK.OBJ
X64\DEBUG\MAIN.OBJ

```

`x64/Debug/InfinityHook.tlog/link.read.1.tlog`:

```tlog
^C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\GLOBAL.OBJ|C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\HDE64.OBJ|C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\HOOK.OBJ|C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\MAIN.OBJ
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.18362.0\KM\X64\BUFFEROVERFLOWFASTFAILK.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.18362.0\KM\X64\NTOSKRNL.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.18362.0\KM\X64\HAL.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.18362.0\KM\X64\WMILIB.LIB
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\GLOBAL.OBJ
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\HDE64.OBJ
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\HOOK.OBJ
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\MAIN.OBJ
C:\WINDOWS\GLOBALIZATION\SORTING\SORTDEFAULT.NLS
C:\WINDOWS\SYSTEM32\TZRES.DLL

```

`x64/Debug/InfinityHook.tlog/link.write.1.tlog`:

```tlog
^C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\GLOBAL.OBJ|C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\HDE64.OBJ|C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\HOOK.OBJ|C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\INFINITYHOOK\X64\DEBUG\MAIN.OBJ
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\X64\DEBUG\INFINITYHOOK.SYS
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\X64\DEBUG\INFINITYHOOK.PDB

```

`x64/Debug/InfinityHook.tlog/signtool.command.1.tlog`:

```tlog
^C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\X64\DEBUG\INFINITYHOOK.SYS
sign /ph /sha1 "9A967CD2BDC57A0192E681EECD8F07066AA4226E" 

```

`x64/Debug/InfinityHook.tlog/signtool.read.1.tlog`:

```tlog
^C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\X64\DEBUG\INFINITYHOOK.SYS
C:\WINDOWS\SYSTEM32\MFC42LOC.DLL
C:\WINDOWS\GLOBALIZATION\SORTING\SORTDEFAULT.NLS
C:\WINDOWS\SYSTEM32\TZRES.DLL
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\X64\DEBUG\INFINITYHOOK.SYS

```

`x64/Debug/InfinityHook.tlog/signtool.timestamp.1.tlog`:

```tlog
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\X64\DEBUG\INFINITYHOOK.SYS|637986406297682924

```

`x64/Debug/InfinityHook.tlog/signtool.write.1.tlog`:

```tlog
^C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\X64\DEBUG\INFINITYHOOK.SYS
C:\USERS\ADMINISTRATOR\SOURCE\REPOS\自写项目\X64\DEBUG\INFINITYHOOK.SYS

```