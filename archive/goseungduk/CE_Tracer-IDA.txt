Project Path: arc_goseungduk_CE_Tracer-IDA_q9q0exa4

Source Tree:

```txt
arc_goseungduk_CE_Tracer-IDA_q9q0exa4
├── CE_Tracer
│   ├── __init__.py
│   ├── core
│   │   └── Scan.py
│   ├── img
│   │   ├── 1.png
│   │   └── 2.png
│   └── ui
│       ├── TracerGui.py
│       ├── __init__.py
│       ├── helpers
│       │   ├── QtCollect.py
│       │   ├── QtObjs.py
│       │   └── __init__.py
│       ├── icon.png
│       └── widgets
│           └── __init__.py
├── CE_Tracer.py
├── README.md
└── README_ENG.md

```

`CE_Tracer.py`:

```py
import idaapi
from PyQt5 import QtGui
from CE_Tracer.ui.TracerGui import TracerGui

class CE_Tracer(idaapi.plugin_t):
    flags = idaapi.PLUGIN_PROC
    comment = "CE Tracer"
    help = "CE Tracer"
    wanted_name = "CE Tracer"
    wanted_hotkey = "Shift+T"

    def init(self):
        return idaapi.PLUGIN_KEEP
    def term(self):
        pass
    def run(self, arg):
        form = TracerGui()
        form.Show()
        return

def PLUGIN_ENTRY():
    return CE_Tracer()

```

`CE_Tracer/__init__.py`:

```py
tmp = 1234
```

`CE_Tracer/core/Scan.py`:

```py
import idaapi, idautils, idc
import struct
'''
idaapi.dbg_read_memory(address, size)
segs_gen = idautils.Segments()
segs = [ s for s in segs_gen ]
seg = idaapi.getseg(segs[0])
seg.perm # 권한
idc.get_segm_name(segs[0]) # 이름
''' 
UNIT_UNPACK_BYTE = {
    "1": "b",
    "4": "i",
    "8": "q"
}
ELF_BANNED_SEGMENT_KEYWORD = [".so", "got", "LOAD"]

class Scanner:
    def __init__(self):
        segs_gen = idautils.Segments()
        self.segs = [ s for s in segs_gen ]
        self.seg_list = []
        for seg in self.segs:
            seg_obj = idaapi.getseg(seg)
            if(seg_obj.perm & 2 == 0):
                continue
            seg_name = idc.get_segm_name(seg)
            start_ea = seg_obj.start_ea
            end_ea = seg_obj.end_ea
            self.seg_list.append(
                {
                    "name":seg_name, 
                    "start_addr":start_ea, 
                    "end_addr":end_ea
                }
            )

    def do_scan(self, value, byte_split):
        self.scan_res = []
        for segment in self.seg_list:
            for addr in range(segment["start_addr"], segment["end_addr"], int(byte_split)):
                val = idaapi.dbg_read_memory(addr, int(byte_split))
                try:
                    val = struct.unpack(UNIT_UNPACK_BYTE[byte_split], val)[0]
                except:
                    continue # NoneType Error Handling
                if(val == int(value)):
                    self.scan_res.append({
                        "name":segment["name"],
                        "addr":addr, 
                        "value":val, 
                        "prev":val
                    })
    
    def next_scan(self, value, byte_split):
        removed_idx = []
        for idx in range(0,len(self.scan_res)):
            val = idaapi.dbg_read_memory(self.scan_res[idx]["addr"], int(byte_split))
            val = struct.unpack(UNIT_UNPACK_BYTE[byte_split],val)[0]
            if(val != int(value)):
                removed_idx.append(idx)
            else:
                self.scan_res[idx]["value"] = val
        removed_idx.reverse()
        for idx in removed_idx:
            del self.scan_res[idx]


```

`CE_Tracer/ui/TracerGui.py`:

```py
from os.path import dirname, abspath
import idaapi, idc
from CE_Tracer.ui.helpers.QtCollect import QtCollection
from CE_Tracer.core.Scan import Scanner

class TracerGui(idaapi.PluginForm):
    def __init__(self):
        super(TracerGui,self).__init__()
        self.qc = QtCollection()
        self.icon = self.qc.QtGui.QIcon(dirname(abspath(__file__))+"\\icon.png")

    def first_scan_event(self):
        if(self.text_widget.text()==""):
            idc.warning("Type any value in text box")
            return
        self.tableWidget.setRowCount(0)
        self.byte_split = self.bytes_combo.currentText().split(" ")[0]
        self.scanner = Scanner()
        self.scanner.do_scan(self.text_widget.text(), self.byte_split)
        for r in self.scanner.scan_res:
            rowPosition = self.tableWidget.rowCount()
            self.tableWidget.insertRow(rowPosition)
            self.tableWidget.setItem(rowPosition, 0, self.qc.QTableWidgetItem(str(r["name"])))
            self.tableWidget.setItem(rowPosition, 1, self.qc.QTableWidgetItem(hex(r["addr"])))
            self.tableWidget.setItem(rowPosition, 2, self.qc.QTableWidgetItem(str(r["value"])))
            self.tableWidget.setItem(rowPosition, 3, self.qc.QTableWidgetItem(str(r["prev"])))

    def next_scan_event(self):
        if(self.text_widget.text()==""):
            idc.warning("Type any value in text box")
            return
        self.scanner.next_scan(self.text_widget.text(), self.byte_split)
        self.tableWidget.setRowCount(0)
        for r in self.scanner.scan_res:
            rowPosition = self.tableWidget.rowCount()
            self.tableWidget.insertRow(rowPosition)
            self.tableWidget.setItem(rowPosition, 0, self.qc.QTableWidgetItem(str(r["name"])))
            self.tableWidget.setItem(rowPosition, 1, self.qc.QTableWidgetItem(hex(r["addr"])))
            self.tableWidget.setItem(rowPosition, 2, self.qc.QTableWidgetItem(str(r["value"])))
            self.tableWidget.setItem(rowPosition, 3, self.qc.QTableWidgetItem(str(r["prev"])))

    def setupControlPanel(self):
        # Text Field
        self.text_widget = self.qc.QLineEdit()
        # Scan Button
        self.first_scan = self.qc.QPushButton("First Scan")
        self.first_scan.clicked.connect(self.first_scan_event)
        self.next_scan = self.qc.QPushButton("Next Scan")
        self.next_scan.clicked.connect(self.next_scan_event)
        # Value Type
        self.bytes_combo = self.qc.QComboBox()
        self.bytes_combo.addItems(["1 byte", "4 bytes", "8 bytes"])
        self.bytes_combo.insertSeparator(1)
        self.bytes_combo.insertSeparator(2)
        self.bytes_combo.setCurrentIndex(3)
        button_layout = self.qc.QHBoxLayout()
        button_layout.setSpacing(50)
        button_layout.addWidget(self.first_scan)
        button_layout.addWidget(self.next_scan)
        layout = self.qc.QVBoxLayout()
        button_layout.setAlignment(self.qc.Qt.AlignTop) # button layout is placed on the top
        layout.addLayout(button_layout)
        layout.addWidget(self.text_widget)
        layout.addWidget(self.bytes_combo)
        layout.addStretch() # text widget is placed under the button layout
        return layout

    def setupLayout(self):
        self.tableWidget = self.qc.QTableWidget()
        self.tableWidget.setColumnCount(4)
        self.tableWidget.setHorizontalHeaderLabels(["Section","Address","Value","Prev Value"])
        self.tableWidget.horizontalHeader().setSectionResizeMode(self.qc.QHeaderView.Stretch)

        layout = self.qc.QHBoxLayout()
        layout.addWidget(self.tableWidget)
        layout.addLayout(self.setupControlPanel())
        self.parent.setLayout(layout)

    def OnCreate(self, form):
        self.parent = self.FormToPyQtWidget(form)
        self.parent.setWindowIcon(self.icon)
        self.setupLayout()

    def Show(self):
        name = "CE Tracer"
        try:
            options = idaapi.PluginForm.WCLS_CLOSE_LATER |\
                    idaapi.PluginForm.WCLS_SAVE |\
                    idaapi.PluginForm.WOPN_RESTORE
        except:
            options = idaapi.PluginForm.FORM_CLOSE_LATER |\
                        idaapi.PluginForm.FORM_SAVE |\
                        idaapi.PluginForm.FORM_RESORE
        return idaapi.PluginForm.Show(self, name, options=options)
```

`CE_Tracer/ui/helpers/QtCollect.py`:

```py
import CE_Tracer.ui.helpers.QtObjs as QtObjs

class QtCollection():
    def __init__(self):
        self.QtObjs = QtObjs
        self.QtGui = self.QtObjs.get_QtGui()
        self.QtCore = self.QtObjs.get_QtCore()
        self.Qt = self.QtObjs.get_Qt()
        self.QtWidgets = self.QtObjs.get_QtWidgets()
        self.QTableWidget = self.QtObjs.get_QTableWidget()
        self.QHeaderView = self.QtObjs.get_QHeaderView()
        self.QVBoxLayout = self.QtObjs.get_QVBoxLayout()
        self.QHBoxLayout = self.QtObjs.get_QHBoxLayout()
        self.QTextEdit = self.QtObjs.get_QTextEdit()
        self.QLineEdit = self.QtObjs.get_QLineEdit()
        self.QPushButton = self.QtObjs.get_QPushButton()
        self.QTableWidgetItem = self.QtObjs.get_QTableWidgetItem()
        self.QMessageBox = self.QtObjs.get_QMessageBox()
        self.QComboBox = self.QtObjs.get_QComboBox()
```

`CE_Tracer/ui/helpers/QtObjs.py`:

```py
def get_QtGui():
    import PyQt5.QtGui as QtGui
    return QtGui

def get_QtCore():
    import PyQt5.QtCore as QtCore
    return QtCore

def get_Qt():
    from PyQt5.QtCore import Qt
    return Qt
    
def get_QtWidgets():
    import PyQt5.QtWidgets as QtWidgets
    return QtWidgets

def get_QTableWidget():
    from PyQt5.QtWidgets import QTableWidget
    return QTableWidget

def get_QTableWidgetItem():
    from PyQt5.QtWidgets import QTableWidgetItem
    return QTableWidgetItem

def get_QHeaderView():
    from PyQt5.QtWidgets import QHeaderView
    return QHeaderView

def get_QVBoxLayout():
    from PyQt5.QtWidgets import QVBoxLayout
    return QVBoxLayout

def get_QHBoxLayout():
    from PyQt5.QtWidgets import QHBoxLayout
    return QHBoxLayout

def get_QTextEdit():
    from PyQt5.QtWidgets import QTextEdit
    return QTextEdit

def get_QLineEdit():
    from PyQt5.QtWidgets import QLineEdit
    return QLineEdit

def get_QPushButton():
    from PyQt5.QtWidgets import QPushButton
    return QPushButton

def get_QMessageBox():
    from PyQt5.QtWidgets import QMessageBox
    return QMessageBox

def get_QComboBox():
    from PyQt5.QtWidgets import QComboBox
    return QComboBox
```

`README.md`:

```md
# CE_Tracer-IDA

IDA 버전 CheatEngine Memory Tracer

[eng](README_ENG.md)

---

# Info

IDA 에서 사용할 수 있는 값 추적 플러그인 입니다.

![](./CE_Tracer/img/1.png)

![](./CE_Tracer/img/2.png)

# Installation

`(IDA Pro 폴더)\plugins` 에 **CE_Tracer** 플러그인 폴더와 파일을 위치시킨다.

# Usage

원하는 바이너리를 IDA 로 로드 후, 원격 디버깅 시 `Shift+T` 단축키를 통해 **CE_Tracer** 를 실행 시킨다.

찾고 싶은 값을 입력 하고 `First Scan` 후, 코드 진행 하면서 `Next Scan` 을 실행한다.

# More

버그는 issue 탭에, 추가 문의 사항은 [a42873410@gmail.com](a42873410@gmail.com) 으로 주세요

```

`README_ENG.md`:

```md
# CE_Tracer-IDA

CheatEngine Memory Tracer Plugin of IDA

---

# Info

This is Value Tracer Plugin which is usable in IDA.

![](./CE_Tracer/img/1.png)

![](./CE_Tracer/img/2.png)

# Installation

Should place **CE_Tracer** folder and files in `(IDA Directory)\plugins` .

# Usage

First, Load binary with IDA and Press `Shift+T` to run **CE_Tracer** window when do remote debugging.

If **CE_Tracer** windows is opened, type value which you want to find. Then, Press `First Scan` and Press `Next Scan` while proceeding with the code.

# More

If you find bug post that bug on issue tab.

If you have any questions, send mail on [a42873410@gmail.com](a42873410@gmail.com)

```