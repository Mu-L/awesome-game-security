Project Path: arc_Nalen98_AngryGhidra_jaqvxzn0

Source Tree:

```txt
arc_Nalen98_AngryGhidra_jaqvxzn0
├── LICENSE.md
├── Module.manifest
├── README.md
├── angryghidra_script
│   └── angryghidra.py
├── build.gradle
├── extension.properties
├── images
│   ├── AngryPluginDemo.gif
│   ├── ApplyPatchedBytes.png
│   ├── Icon.png
│   ├── Trace.png
│   └── View.png
└── src
    └── main
        ├── java
        │   └── angryghidra
        │       ├── AngrProcessing.java
        │       ├── AngryGhidraPlugin.java
        │       ├── AngryGhidraPopupMenu.java
        │       ├── AngryGhidraProvider.java
        │       ├── HookHandler.java
        │       ├── LocalColorizingService.java
        │       └── UserAddressStorage.java
        └── resources
            └── images
                ├── add.png
                ├── delete.png
                ├── flag.png
                ├── ico.png
                ├── reset.png
                └── stop.png

```

`LICENSE.md`:

```md
MIT License

Copyright (c) 2020 Nalen98

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

```

`README.md`:

```md
# AngryGhidra

<p align="center"><img src="./images/Icon.png" width="360" height="250">

The plugin allows you to use [angr](https://github.com/angr/angr) for binary analysis and symbolic execution in Ghidra interface.

Solving [CTF challenge from SecurityFest 2016 "fairlight"](https://github.com/angr/angr-doc/blob/master/examples/securityfest_fairlight/fairlight) with AngryGhidra plugin:

![AngryGhidra Plugin](./images/AngryPluginDemo.gif)

# Hotkeys

##### Set:
`Z` – **destination** address  
`X` – **start** address  
`J` – **avoid** address (multiple choice)  

##### Reset:
`K` – **destination** address  
`T` – **start** address  
`P` – **avoid** address  

##### Apply bytes:
`U` – apply patched bytes to angr project memory

# Screenshots

Let's keygen:

![AngryGhidraView](./images/View.png)

Apply patched bytes to write them into the memory of angr project:

![ApplyPatchedBytes](./images/ApplyPatchedBytes.png)

# Installation

1) `pip3 install angr`
2) Make sure `python3` directory is added to the `PATH` (required, `Python 3` only)
3) Use Gradle to build the plugin: `GHIDRA_INSTALL_DIR=${GHIDRA_HOME} gradle` and use Ghidra to install it: `File → Install Extensions...`
4) Check the box in the "New Plugins Found" window to apply AngryGhidra plugin to your project
5) If "New Plugins Found" window doesn't appear, go to your CodeBrowser project and tick the plugin in `File → Configure →  Miscellaneous → AngryGhidraPlugin`

```

`angryghidra_script/angryghidra.py`:

```py
import sys
import angr
import claripy
import json

EXPLORE_OPT = {}
REGISTERS = []
SYMVECTORS = []

def hook_function(state):
    global SYMVECTORS
    for object in EXPLORE_OPT["hooks"]:
        for frame in object.items():
            if frame[0] == hex(state.solver.eval(state.regs.ip)):
                for option, data in frame[1].items():
                    if "sv" in data:
                        symbvector_length = int(data[2:], 0)
                        symbvector = claripy.BVS('symvector', symbvector_length * 8)
                        SYMVECTORS.append(symbvector)
                        data = symbvector
                    else:
                        data = int(str(data), 0)
                    for REG in REGISTERS:
                        if REG == option:
                            setattr(state.regs, option, data)
                            break

def main(file):
    global EXPLORE_OPT
    global REGISTERS
    global SYMVECTORS
    find = None
    avoid = None
    blank_state = None
    vectors = None

    with open(file, encoding='utf-8') as json_file:
        EXPLORE_OPT = json.load(json_file)

    if "blank_state" in EXPLORE_OPT:
        blank_state = int(EXPLORE_OPT["blank_state"], 16)

    find = int(EXPLORE_OPT["find_address"], 16)

    if "avoid_address" in EXPLORE_OPT:
        avoid = [int(x, 16) for x in EXPLORE_OPT["avoid_address"].split(',')]

    # User can input hex or decimal value (argv length / symbolic memory length)
    argv = [EXPLORE_OPT["binary_file"]]
    if "arguments" in EXPLORE_OPT:
        index = 1
        for arg, length in EXPLORE_OPT["arguments"].items():
            argv.append(claripy.BVS("argv" + str(index), int(str(length), 0) * 8))
            index += 1

    if "base_address" in EXPLORE_OPT:
        base_address = int(EXPLORE_OPT["base_address"], 16)

    if "raw_binary_arch" in EXPLORE_OPT:
        arch = EXPLORE_OPT["raw_binary_arch"]
        p = angr.Project(EXPLORE_OPT["binary_file"],
                         load_options={'main_opts': {'backend': 'blob', 'arch': arch,
                                                     'base_addr': base_address}, 'auto_load_libs': EXPLORE_OPT["auto_load_libs"]})
    else:
        p = angr.Project(EXPLORE_OPT["binary_file"], load_options={'main_opts': {'base_addr': base_address}, "auto_load_libs": EXPLORE_OPT["auto_load_libs"]})

    REGISTERS = p.arch.default_symbolic_registers

    if len(argv) > 1:
        state = p.factory.entry_state(args=argv)
    elif blank_state != None:
        state = p.factory.blank_state(addr=blank_state)
    else:
        state = p.factory.entry_state()

    # Store symbolic vectors in memory
    if "vectors" in EXPLORE_OPT:
        vectors = {}
        for addr, length in EXPLORE_OPT["vectors"].items():
            symbmem_addr = int(addr, 16)
            symbmem_len = int(length, 0)
            vectors.update({symbmem_addr: symbmem_len})
            symb_vector = claripy.BVS('input', symbmem_len * 8)
            state.memory.store(symbmem_addr, symb_vector)

    # Write to memory
    if "mem_store" in EXPLORE_OPT:
        for addr, value in EXPLORE_OPT["mem_store"].items():
            store_addr = int(addr, 16)
            store_value = int(value, 16)
            store_length = len(value) - 2
            state.memory.store(store_addr, state.solver.BVV(store_value, 4 * store_length))

    # Handle symbolic registers
    if "regs_vals" in EXPLORE_OPT:
        for register, data in EXPLORE_OPT["regs_vals"].items():
            if "sv" in data:
                symbvector_length = int(data[2:], 0)
                symbvector = claripy.BVS('symvector', symbvector_length * 8)
                SYMVECTORS.append(symbvector)
                data = symbvector
            else:
                data = int(str(data), 0)
            for REG in REGISTERS:
                if REG == register:
                    setattr(state.regs, register, data)
                    break

    # Handle hooks
    if "hooks" in EXPLORE_OPT:
        for object in EXPLORE_OPT["hooks"]:
            for frame in object.items():
                hook_address = frame[0]
                for option, data in frame[1].items():
                    data = int(str(data), 0)
                    if option == "length":
                        hook_length = data
                        break
                p.hook(int(hook_address, 16), hook_function, length=hook_length)

    simgr = p.factory.simulation_manager(state)
    if avoid != None:
        simgr.use_technique(angr.exploration_techniques.Explorer(find=find, avoid=avoid))
    else:
        simgr.use_technique(angr.exploration_techniques.Explorer(find=find))
    simgr.run()

    if simgr.found:
        found_path = simgr.found[0]
        win_sequence = ""
        finishedTracing = False
        for win_block in found_path.history.bbl_addrs.hardcopy:
            win_block = p.factory.block(win_block)
            addresses = win_block.instruction_addrs
            for address in addresses:
                win_sequence += 't:' + hex(address) + '\n'
                if address == find:
                    # Prevent sending the rest of the block addresses that aren't desired
                    finishedTracing = True
                    break
            if finishedTracing:
                break
        win_sequence = win_sequence[:-1]
        print(win_sequence)

        if len(argv) > 1:
            for i in range(1, len(argv)):
                print("argv[{id}] = {solution}".format(id=i, solution=found_path.solver.eval(argv[i], cast_to=bytes)))

        if vectors != None and len(vectors) != 0:
            for address, length in vectors.items():
                print("{addr} = {value}".format(addr=hex(address),
                                                value=found_path.solver.eval(found_path.memory.load(address, length),
                                                                             cast_to=bytes)))

        if len(SYMVECTORS) > 0:
            for SV in SYMVECTORS:
                print(found_path.solver.eval(SV, cast_to=bytes))

        found_stdins = found_path.posix.stdin.content
        if len(found_stdins) > 0:
            std_id = 1
            for stdin in found_stdins:
                print(
                    "stdin[{id}] = {solution}".format(id=std_id,
                                                      solution=found_path.solver.eval(stdin[0], cast_to=bytes)))
                std_id += 1
    else:
        print("")
    return


if __name__ == '__main__':
    if len(sys.argv) < 2:
        print("Usage: *thisScript.py* angr_options.json")
        exit()
    main(sys.argv[1])

```

`build.gradle`:

```gradle
// Builds a Ghidra Extension for a given Ghidra installation.
//
// An absolute path to the Ghidra installation directory must be supplied either by setting the 
// GHIDRA_INSTALL_DIR environment variable or Gradle project property:
//
//     > export GHIDRA_INSTALL_DIR=<Absolute path to Ghidra> 
//     > gradle
//
//         or
//
//     > gradle -PGHIDRA_INSTALL_DIR=<Absolute path to Ghidra>
//
// Gradle should be invoked from the directory of the project to build.  Please see the
// application.gradle.version property in <GHIDRA_INSTALL_DIR>/Ghidra/application.properties
// for the correction version of Gradle to use for the Ghidra installation you specify.

//----------------------START "DO NOT MODIFY" SECTION------------------------------
def ghidraInstallDir

if (System.env.GHIDRA_INSTALL_DIR) {
	ghidraInstallDir = System.env.GHIDRA_INSTALL_DIR
}
else if (project.hasProperty("GHIDRA_INSTALL_DIR")) {
	ghidraInstallDir = project.getProperty("GHIDRA_INSTALL_DIR")
}

if (ghidraInstallDir) {
	apply from: new File(ghidraInstallDir).getCanonicalPath() + "/support/buildExtension.gradle"
}
else {
	throw new GradleException("GHIDRA_INSTALL_DIR is not defined!")
}
//----------------------END "DO NOT MODIFY" SECTION-------------------------------

apply plugin: 'base'

repositories {
    mavenCentral()
}

dependencies {
   implementation 'org.json:json:20200518'
}

task copyLib(type: Copy) {
    from configurations.runtimeOnly
    into "lib"
}

tasks.assemble.dependsOn copyLib



```

`extension.properties`:

```properties
name=AngryGhidra
description=One click symbolic execution using Angr from Your Ghidra
author=Nalen98
createdOn=
version=@extversion@

```

`src/main/java/angryghidra/AngrProcessing.java`:

```java
package angryghidra;

import java.awt.Color;
import java.io.BufferedReader;
import java.io.File;
import java.io.InputStreamReader;
import java.net.URISyntaxException;
import java.util.ArrayList;
import java.util.List;

import javax.swing.JLabel;
import javax.swing.JScrollPane;
import javax.swing.SwingUtilities;
import javax.swing.SwingWorker;
import ghidra.program.model.address.Address;
import ghidra.program.model.address.AddressFactory;


public class AngrProcessing {
    private AddressFactory mAddressFactory;
    private LocalColorizingService mColorService;
    private UserAddressStorage mAddressStorage;
    private AngryGhidraProvider mProvider;
    private String solution;
    private JLabel statusLabelFound;
    private JLabel statusLabel;
    private JScrollPane scrollSolutionTextArea;
    private List <String> traceList;

    public AngrProcessing(UserAddressStorage addressStorage, LocalColorizingService colorService,
            AngryGhidraProvider provider, AddressFactory addressFactory) {
        mAddressStorage = addressStorage;
        mColorService = colorService;
        mProvider = provider;
        mAddressFactory = addressFactory;
        traceList = new ArrayList <String>();
        statusLabelFound = provider.getStatusLabelFound();
        scrollSolutionTextArea = provider.getScrollSolutionTextArea();
        statusLabel = provider.getStatusLabel();
    }

    public void setSolutionExternal(String value) {
        solution = value;
    }

    public void preparetoRun(File angrFile) {
        SwingWorker sw = new SwingWorker() {
            @Override
            protected String doInBackground() throws Exception {
                String angrFilePath = angrFile.getAbsolutePath();
                String jarPath = null;
                try {
                    jarPath = new File(AngryGhidraProvider.class.getProtectionDomain().getCodeSource()
                            .getLocation().toURI()).getPath();
                } catch (URISyntaxException e) {
                    e.printStackTrace();
                    angrFile.delete();
                    return null;
                }
                String scriptPath = new File(jarPath.substring(0, jarPath.indexOf("lib")) +
                        "angryghidra_script" + File.separator + "angryghidra.py").getAbsolutePath();

                //PythonVersion check (issue#5)
                if (runAngr("python3", scriptPath, angrFilePath) == 0) {
                    ProcessBuilder pb = new ProcessBuilder("python", "--version");
                    try {
                        Process process = pb.start();
                        BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
                        String line = "";
                        while ((line = reader.readLine()) != null) {
                            String parsedVersion = line.substring(7);
                            if (compareVersion(parsedVersion, "3.4") == -1 &&
                                    compareVersion(parsedVersion, "3.0") == 1) {
                                runAngr("python", scriptPath, angrFilePath);
                            }
                        }
                        process.waitFor();
                        reader.close();
                    } catch (Exception e) {
                        e.printStackTrace();
                    }
                }
                angrFile.delete();
                return null;
            }

            @Override
            protected void done() {
                if (mProvider.getIsTerminated()) {
                    statusLabel.setText(mProvider.configuringString);
                    return;
                }
                if (solution != null && !solution.isEmpty()) {
                    statusLabelFound.setText("[+] Solution's been found:");
                    scrollSolutionTextArea.setVisible(true);
                    mProvider.getSolutionTextArea().setText(solution.trim());
                    for (String traceAddress: traceList) {
                        Address address = mAddressFactory.getAddress(traceAddress);
                        if (!shouldAvoidColor(address)){
                            try {
                                mColorService.setColor(address,
                                        Color.getHSBColor(247, 224, 98));
                            } catch (Exception ex) {}
                        }
                    }
                } else {
                    statusLabelFound.setText("[–] No solution!");
                }
            }
        };
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                statusLabel.setText("[+] angr in progress...");
                scrollSolutionTextArea.setVisible(false);
            }
        });
        sw.execute();
    }

    private int runAngr(String pythonVersion, String scriptPath, String angrFilePath) {
        solution = "";
        ProcessBuilder processBuilder = new ProcessBuilder(pythonVersion, scriptPath, angrFilePath);
        Reader runnable = new Reader(processBuilder);
        Thread thread = new Thread(runnable);
        thread.start();
        while(thread.isAlive()) {
            if (mProvider.getIsTerminated()) {
                thread.interrupt();
                break;
            }
        }
        return runnable.getResult();
    }

    private class Reader implements Runnable {
        private volatile int result = -1;
        private BufferedReader reader;
        private Process proc;

        public Reader(ProcessBuilder processBuilder) {
            try {
                proc = processBuilder.start();
            } catch (Exception ex) {
                setResult(0);
                return;
            }
            reader = new BufferedReader(new InputStreamReader(proc.getInputStream()));
        }

        @Override
        public void run() {
            // BufferedReader is empty because of the exception above, we can't start
            if (getResult() == 0) {
                return;
            }
            String line = "";
            try {
                while ((line = reader.readLine()) != null &&
                        !Thread.currentThread().isInterrupted()) {
                    if (line.contains("t:")) {
                        traceList.add(line.substring(2));
                    } else {
                        solution += line + "\n";
                    }
                }
                if (Thread.currentThread().isInterrupted()) {
                    proc.destroy();
                    reader.close();
                    return;
                }
                proc.waitFor();
                reader.close();
                setResult(1);
                return;
            } catch (Exception e) {
                setResult(0);
                return;
            }
        }

        public int getResult() {
            return result;
        }

        public void setResult(int value) {
            result = value;
        }
    }

    private int compareVersion(String version1, String version2) {
        String[] arr1 = version1.split("\\.");
        String[] arr2 = version2.split("\\.");
        int i=0;
        while (i<arr1.length || i<arr2.length) {
            if (i<arr1.length && i<arr2.length) {
                if (Integer.parseInt(arr1[i]) <Integer.parseInt(arr2[i])) {
                    return -1;
                } else if (Integer.parseInt(arr1[i]) > Integer.parseInt(arr2[i])) {
                    return 1;
                }
            } else if (i<arr1.length) {
                if (Integer.parseInt(arr1[i]) != 0) {
                    return 1;
                }
            } else if (i<arr2.length) {
            if (Integer.parseInt(arr2[i]) != 0) {
                    return -1;
                }
            }
            i++;
        }
        return 0;
    }

    private boolean shouldAvoidColor(Address address){
        Address blankStateAddress = mAddressStorage.getBlankStateAddress();
        Address dstAddress = mAddressStorage.getDestinationAddress();
        boolean isBlankStateNotEmpty = blankStateAddress != null;
        boolean isAddrToFindNotEmpty = dstAddress != null;

        boolean isBlankStateAddr = isBlankStateNotEmpty &&
                address.equals(blankStateAddress);

        boolean isAddrToFind = isAddrToFindNotEmpty &&
                address.equals(dstAddress);
        return isBlankStateAddr || isAddrToFind;
    }

    public void clearTraceList(boolean fullReset){
        if (!traceList.isEmpty()) {
            for (String traceAddress: traceList) {
                Address address = mAddressFactory.getAddress(traceAddress);
                if (fullReset){
                    try {
                        mColorService.resetColor(address);
                    } catch (Exception ex) {}
                } else {
                    if (!shouldAvoidColor(address)){
                        try {
                            mColorService.resetColor(address);
                        } catch (Exception ex) {}
                    }
                }
            }
            traceList = new ArrayList <String>();
        }
    }
}

```

`src/main/java/angryghidra/AngryGhidraPlugin.java`:

```java
package angryghidra;

import ghidra.MiscellaneousPluginPackage;
import ghidra.app.plugin.PluginCategoryNames;
import ghidra.app.plugin.ProgramPlugin;
import ghidra.framework.plugintool.PluginInfo;
import ghidra.framework.plugintool.PluginTool;
import ghidra.framework.plugintool.util.PluginStatus;
import ghidra.program.model.listing.Program;

@PluginInfo(
    status = PluginStatus.STABLE,
    packageName = MiscellaneousPluginPackage.NAME,
    category = PluginCategoryNames.ANALYSIS,
    shortDescription = "Use angr in Ghidra",
    description = "One-click symbolic execution using angr in Ghidra"
)

public class AngryGhidraPlugin extends ProgramPlugin {
    private PluginTool mTool;
    private AngryGhidraProvider provider;
    private AngryGhidraPopupMenu popup;
    private UserAddressStorage addressStorage;
    private LocalColorizingService colorService;
    private Program mProgram;

    public AngryGhidraPlugin(PluginTool tool) {
        super(tool);
        mTool = tool;
        addressStorage = new UserAddressStorage();
        provider = new AngryGhidraProvider(this, getName(), mProgram);
        popup = new AngryGhidraPopupMenu(this);
    }

    @Override
    protected void programActivated(Program program) {
        mProgram = program;
        provider.setProgram(program);
        provideColorService();
    }

    public void provideColorService() {
        colorService = new LocalColorizingService(mTool, mProgram);
        popup.setColorService(colorService);
        provider.setColorService(colorService);
    }

    public AngryGhidraProvider getProvider() {
        return provider;
    }

    public UserAddressStorage getAddressStorage() {
        return addressStorage;
    }
}

```

`src/main/java/angryghidra/AngryGhidraPopupMenu.java`:

```java
package angryghidra;

import java.awt.Color;
import java.awt.GridBagConstraints;
import java.awt.Insets;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyEvent;
import java.math.BigInteger;

import javax.swing.JButton;
import javax.swing.JCheckBox;
import javax.swing.JPanel;
import javax.swing.JTextArea;
import javax.swing.JTextField;

import docking.action.KeyBindingData;
import docking.action.MenuData;
import docking.widgets.textfield.IntegerTextField;
import ghidra.app.context.ListingActionContext;
import ghidra.app.context.ListingContextAction;
import ghidra.framework.plugintool.PluginTool;
import ghidra.program.model.address.Address;
import ghidra.program.model.address.AddressIterator;
import ghidra.program.model.mem.MemoryAccessException;


public class AngryGhidraPopupMenu extends ListingContextAction {
    private final String menuName = "AngryGhidraPlugin";
    private final String groupName = "SymEx";
    private PluginTool tool;
    private LocalColorizingService mColorService;
    private UserAddressStorage mAddressStorage;
    private AngryGhidraProvider provider;
    private JTextField findAddressField;
    private JTextField blankStateAddressField;
    private JTextArea textArea;
    private JCheckBox blankStateCB;
    private JCheckBox avoidAddrsCB;
    private JPanel writeMemoryPanel;
    private IntegerTextField storeAddressTF;
    private IntegerTextField storeValueTF;

    public AngryGhidraPopupMenu(AngryGhidraPlugin plugin) {
        super("AngryGhidraPlugin", plugin.getName());
        tool = plugin.getTool();
        mAddressStorage = plugin.getAddressStorage();
        provider = plugin.getProvider();
        setupActions();
    }

    public void setColorService(LocalColorizingService colorService){
        mColorService = colorService;
    }

    private void setupActions() {
        setupComponents();
        tool.setMenuGroup(new String[] {
            menuName
        }, groupName);

        ListingContextAction setDstAddress = new ListingContextAction("Set destination address", getName()) {
            @Override
            protected void actionPerformed(ListingActionContext context) {
                Address dstAddress = mAddressStorage.getDestinationAddress();
                if (dstAddress != null) {
                    mColorService.resetColor(dstAddress);
                }
                Address thisAddress = context.getLocation().getAddress();
                mAddressStorage.setDestinationAddress(thisAddress);
                mColorService.setColor(thisAddress, Color.GREEN);
                findAddressField.setText("0x" + thisAddress.toString());
            }
        };
        setDstAddress.setKeyBindingData(new KeyBindingData(KeyEvent.VK_Z, 0));
        setDstAddress.setPopupMenuData(new MenuData(new String[] {
            menuName,
            "Set",
            "Address to Find"
        }, null, groupName));
        tool.addAction(setDstAddress);

        ListingContextAction setBlankStateAddr = new ListingContextAction("Set blank state address", getName()) {
            @Override
            protected void actionPerformed(ListingActionContext context) {
                Address blankStateAddress = mAddressStorage.getBlankStateAddress();
                if (blankStateAddress != null) {
                    mColorService.resetColor(blankStateAddress);
                }
                Address thisAddress = context.getLocation().getAddress();
                mAddressStorage.setBlankStateAddress(thisAddress);
                mColorService.setColor(thisAddress, Color.CYAN);
                blankStateCB.setSelected(true);
                blankStateAddressField.setText("0x" + thisAddress.toString());
            }
        };
        setBlankStateAddr.setKeyBindingData(new KeyBindingData(KeyEvent.VK_X, 0));
        setBlankStateAddr.setPopupMenuData(new MenuData(new String[] {
            menuName,
            "Set",
            "Blank State Address"
        }, null, groupName));
        tool.addAction(setBlankStateAddr);

        ListingContextAction setAvoidAddr = new ListingContextAction("Set avoid address", getName()) {
            @Override
            protected void actionPerformed(ListingActionContext context) {
                Address address = context.getLocation().getAddress();
                if (!mAddressStorage.getAvoidAddresses().contains(address)){
                    mColorService.setColor(address, Color.RED);
                    avoidAddrsCB.setSelected(true);
                    String strAddress = "0x" + address.toString();
                    if (textArea.getText().isEmpty()) {
                        textArea.setText(strAddress);
                    } else {
                        textArea.append("," + System.getProperty("line.separator") + strAddress);
                    }
                    mAddressStorage.addAvoidAddress(address);
                }
            }
        };
        setAvoidAddr.setKeyBindingData(new KeyBindingData(KeyEvent.VK_J, 0));
        setAvoidAddr.setPopupMenuData(new MenuData(new String[] {
            menuName,
            "Set",
            "Avoid Address"
        }, null, groupName));
        tool.addAction(setAvoidAddr);

        ListingContextAction resetDstAddress = new ListingContextAction("Reset destination address", getName()) {
            @Override
            protected void actionPerformed(ListingActionContext context) {
                Address dstAddress = mAddressStorage.getDestinationAddress();
                if (dstAddress != null) {
                    Address address = context.getLocation().getAddress();
                    if (address.equals(dstAddress)){
                        mColorService.resetColor(dstAddress);
                        mAddressStorage.setDestinationAddress(null);
                        findAddressField.setText("");
                    }
                }
            }
        };
        resetDstAddress.setKeyBindingData(new KeyBindingData(KeyEvent.VK_K, 0));
        resetDstAddress.setPopupMenuData(new MenuData(new String[] {
            menuName,
            "Unset",
            "Address to Find"
        }, null, groupName));
        tool.addAction(resetDstAddress);

        ListingContextAction resetBlankStateAddr = new ListingContextAction("Reset blank state address", getName()) {
            @Override
            protected void actionPerformed(ListingActionContext context) {
                Address blankStateAddress = mAddressStorage.getBlankStateAddress();
                if (blankStateAddress != null) {
                    Address address = context.getLocation().getAddress();
                    if (address.equals(blankStateAddress)){
                        mColorService.resetColor(blankStateAddress);
                        mAddressStorage.setBlankStateAddress(null);
                        blankStateAddressField.setText("");
                        blankStateCB.setSelected(false);
                    }
                }
            }
        };
        resetBlankStateAddr.setKeyBindingData(new KeyBindingData(KeyEvent.VK_T, 0));
        resetBlankStateAddr.setPopupMenuData(new MenuData(new String[] {
            menuName,
            "Unset",
            "Blank State Address"
        }, null, groupName));
        tool.addAction(resetBlankStateAddr);

        ListingContextAction resetAvoidAddr = new ListingContextAction("Reset avoid address", getName()) {
            @Override
            protected void actionPerformed(ListingActionContext context) {
                Address address = context.getLocation().getAddress();
                if (mAddressStorage.getAvoidAddresses().contains(address)) {
                    mColorService.resetColor(address);
                    String separator = System.getProperty("line.separator");
                    String content = textArea.getText();
                    String addressStr = "0x" + address.toString();
                    int addrIndex = content.indexOf(addressStr);
                    int commaIndex = content.indexOf(",");
                    if (addrIndex == 0 && commaIndex != -1) {
                        content = content.replace(addressStr + "," + separator, "");
                    }
                    if (addrIndex == 0 && commaIndex == -1) {
                        content = content.replace(addressStr, "");
                    }
                    if (addrIndex != 0) {
                        content = content.replace("," + separator + addressStr, "");
                    }
                    textArea.setText(content);
                    mAddressStorage.removeAvoidAddress(address);
                }
            }
        };
        resetAvoidAddr.setKeyBindingData(new KeyBindingData(KeyEvent.VK_P, 0));
        resetAvoidAddr.setPopupMenuData(new MenuData(new String[] {
            menuName,
            "Unset",
            "Avoid Address"
        }, null, groupName));
        tool.addAction(resetAvoidAddr);

        ListingContextAction applyPatchedBytes = new ListingContextAction("Apply patched bytes", getName()) {
            @Override
            protected void actionPerformed(ListingActionContext context) {
                Address minAddress = context.getSelection().getMinAddress();
                AddressIterator addressRange = context.getSelection().getAddresses(true);
                StringBuilder hexStringBuilder = new StringBuilder();
                for (Address address: addressRange) {
                    byte selectedByte = 0;
                    try {
                        selectedByte = context.getProgram().getMemory().getByte(address);
                    } catch (MemoryAccessException e) {
                        e.printStackTrace();
                    }
                    hexStringBuilder.append(String.format("%02X", selectedByte));
                }
                String hexValueString = hexStringBuilder.toString();
                BigInteger hexValue = new BigInteger(hexValueString, 16);

                if (!storeAddressTF.getText().isEmpty()) {
                    int currentGuiStoreCounter = provider.getGuiStoreCounter();
                    IntegerTextField addrTF = new IntegerTextField();
                    addrTF.setHexMode();
                    addrTF.setValue(minAddress.getOffset());
                    GridBagConstraints gbc_addrTF = new GridBagConstraints();
                    gbc_addrTF.fill = GridBagConstraints.HORIZONTAL;
                    gbc_addrTF.anchor = GridBagConstraints.CENTER;
                    gbc_addrTF.gridx = 1;
                    gbc_addrTF.insets = new Insets(0, 0, 0, 5);
                    gbc_addrTF.gridy = currentGuiStoreCounter;
                    gbc_addrTF.weightx = 1;
                    gbc_addrTF.weighty = 0.1;
                    writeMemoryPanel.add(addrTF.getComponent(), gbc_addrTF);

                    IntegerTextField valTF = new IntegerTextField();
                    valTF.setHexMode();
                    valTF.setValue(hexValue);
                    GridBagConstraints gbc_valTF = new GridBagConstraints();
                    gbc_valTF.fill = GridBagConstraints.HORIZONTAL;
                    gbc_valTF.anchor = GridBagConstraints.CENTER;
                    gbc_valTF.insets = new Insets(0, 0, 0, 5);
                    gbc_valTF.gridx = 3;
                    gbc_valTF.gridy = currentGuiStoreCounter;
                    gbc_valTF.weightx = 1;
                    gbc_valTF.weighty = 0.1;
                    writeMemoryPanel.add(valTF.getComponent(), gbc_valTF);
                    provider.putIntoMemStore(addrTF, valTF);

                    JButton btnDel = new JButton("");
                    btnDel.setBorder(null);
                    btnDel.setContentAreaFilled(false);
                    btnDel.setIcon(provider.getDeleteIcon());
                    GridBagConstraints gbc_btnDel = new GridBagConstraints();
                    gbc_btnDel.fill = GridBagConstraints.HORIZONTAL;
                    gbc_btnDel.anchor = GridBagConstraints.CENTER;
                    gbc_btnDel.insets = new Insets(0, 0, 0, 5);
                    gbc_btnDel.gridx = 0;
                    gbc_btnDel.gridy = currentGuiStoreCounter;
                    gbc_btnDel.weighty = 0.1;
                    writeMemoryPanel.add(btnDel, gbc_btnDel);
                    provider.setGuiStoreCounter(++currentGuiStoreCounter);
                    provider.putIntoDelStoreBtns(btnDel);
                    btnDel.addActionListener(new ActionListener() {
                        public void actionPerformed(ActionEvent e) {
                            provider.setGuiStoreCounter(provider.getGuiStoreCounter() - 1);
                            provider.removeFromDelStoreBtns(btnDel);
                            provider.removeFromMemStore(addrTF, valTF);
                            writeMemoryPanel.remove(addrTF.getComponent());
                            writeMemoryPanel.remove(valTF.getComponent());
                            writeMemoryPanel.remove(btnDel);
                            writeMemoryPanel.repaint();
                            writeMemoryPanel.revalidate();
                        }
                    });
                    writeMemoryPanel.repaint();
                    writeMemoryPanel.revalidate();
                }
                else {
                    storeAddressTF.setValue(minAddress.getOffset());
                    storeValueTF.setValue(hexValue);
                }
            }
        };
        applyPatchedBytes.setKeyBindingData(new KeyBindingData(KeyEvent.VK_U, 0));
        applyPatchedBytes.setPopupMenuData(new MenuData(new String[] {
            menuName,
            "Apply Patched Bytes"}, null, groupName));
        tool.addAction(applyPatchedBytes);
    }

    private void setupComponents() {
        findAddressField = provider.getFindAddressTF();
        blankStateAddressField = provider.getBSAddressTF();
        textArea = provider.getTextArea();
        blankStateCB = provider.getCBBlankState();
        avoidAddrsCB = provider.getCBAvoidAddresses();
        writeMemoryPanel = provider.getWriteMemoryPanel();
        storeAddressTF = provider.getStoreAddressTF();
        storeValueTF = provider.getStoreValueTF();
    }
}

```

`src/main/java/angryghidra/AngryGhidraProvider.java`:

```java
package angryghidra;

import java.awt.Color;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.Insets;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.ItemEvent;
import java.awt.event.ItemListener;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;
import java.io.File;
import java.io.FileWriter;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.List;
import java.util.Map.Entry;
import javax.swing.BorderFactory;
import javax.swing.GroupLayout;
import javax.swing.GroupLayout.Alignment;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JCheckBox;
import javax.swing.JComponent;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.JTextField;
import javax.swing.LayoutStyle.ComponentPlacement;
import javax.swing.ScrollPaneConstants;
import javax.swing.SwingConstants;
import javax.swing.border.LineBorder;
import javax.swing.border.TitledBorder;
import org.json.JSONArray;
import org.json.JSONObject;
import docking.ComponentProvider;
import docking.widgets.textfield.IntegerTextField;
import ghidra.program.model.address.Address;
import ghidra.program.model.listing.Program;
import resources.ResourceManager;

public class AngryGhidraProvider extends ComponentProvider {
    public final String htmlString = "<html>Registers<br/>Hint: to create and store symbolic vector enter \"sv{length}\", for example \"sv16\"</html>";
    public final String configuringString = "[+] Configuring options";
    private boolean isHookWindowClosed;
    private boolean isTerminated;
    private boolean isWindows;
    private int guiRegNextId;
    private int guiArgNextId;
    private int guiMemNextId;
    private int guiStoreNextId;
    private String tmpDir;
    private Program thisProgram;
    private LocalColorizingService mColorService;
    private HookHandler hookHandler;
    private AngrProcessing angrProcessing;
    private UserAddressStorage addressStorage;
    private JPanel mainPanel;
    private JPanel customOptionsPanel;
    private JPanel argumentsPanel;
    private JPanel mainOptionsPanel;
    private JPanel statusPanel;
    private JPanel hookLablesPanel;
    private JPanel writeMemoryPanel;
    private JPanel argSetterPanel;
    private JPanel vectorsPanel;
    private JPanel regPanel;
    private JScrollPane scrollSolutionTextArea;
    private JScrollPane scrollAvoidAddrsArea;
    private JTextField blankStateTF;
    private JTextField dstAddressTF;
    private JTextField valueTF;
    private JTextField registerTF;
    private IntegerTextField firstArgTF;
    private IntegerTextField vectorAddressTF;
    private IntegerTextField vectorLenTF;
    private IntegerTextField memStoreAddrTF;
    private IntegerTextField memStoreValueTF;
    private JCheckBox chckbxBlankState;
    private JCheckBox chckbxAvoidAddresses;
    private JCheckBox chckbxAutoLoadLibs;
    private JCheckBox chckbxArg;
    private JTextArea avoidTextArea;
    private JTextArea solutionTextArea;
    private JLabel statusLabel;
    private JLabel statusLabelFound;
    private JLabel lbStatus;
    private JLabel lbStoreAddr;
    private JLabel lbStoreVal;
    private JLabel lblWriteToMemory;
    private JLabel lbArgLen;
    private JButton btnReset;
    private JButton btnRun;
    private JButton btnStop;
    private JButton btnAddWM;
    private JButton btnAddArg;
    private HashMap <IntegerTextField, IntegerTextField> vectors;
    private HashMap <IntegerTextField, IntegerTextField> memStore;
    private HashMap <JTextField, JTextField> presetRegs;
    private HashMap <String[], String[][]> hooks;
    private ArrayList <IntegerTextField> argsTF;
    private ArrayList <JButton> delRegsBtns;
    private ArrayList <JButton> delMemBtns;
    private ArrayList <JButton> delStoreBtns;
    private ArrayList <JButton> delBtnArgs;
    private ArrayList <JButton> delHookBtns;
    private ArrayList <JLabel> lbHooks;
    private ImageIcon deleteIcon;
    private ImageIcon addIcon;

    public AngryGhidraProvider(AngryGhidraPlugin plugin, String owner, Program program) {
        super(plugin.getTool(), owner, owner);
        addressStorage = plugin.getAddressStorage();
        setIcon(ResourceManager.loadImage("images/ico.png"));
        if (program != null){
            setProgram(program);
        }
        initFields();
        buildPanel();
    }

    public void setColorService(LocalColorizingService colorService) {
        mColorService = colorService;
        angrProcessing = new AngrProcessing(addressStorage, mColorService, this, thisProgram.getAddressFactory());
    }

    private void initFields() {
        ImageIcon addIconNonScaled = new ImageIcon(getClass().getResource("/images/add.png"));
        ImageIcon deleteIconNonScaled = new ImageIcon(getClass().getResource("/images/delete.png"));
        addIcon = new ImageIcon(addIconNonScaled.getImage().getScaledInstance(21, 21,  java.awt.Image.SCALE_SMOOTH));
        deleteIcon = new ImageIcon(deleteIconNonScaled.getImage().getScaledInstance(21, 21,  java.awt.Image.SCALE_SMOOTH));

        setHookWindowState(true);
        setIsTerminated(false);
        guiArgNextId = 2;
        guiMemNextId = 2;
        guiRegNextId = 2;
        guiStoreNextId = 2;
        delRegsBtns = new ArrayList <JButton>();
        delBtnArgs = new ArrayList <JButton>();
        delMemBtns = new ArrayList <JButton>();
        delStoreBtns = new ArrayList <JButton>();
        delHookBtns = new ArrayList <JButton>();
        argsTF = new ArrayList <IntegerTextField>();
        presetRegs = new HashMap<>();
        vectors = new HashMap<>();
        memStore = new HashMap<>();
        hooks = new HashMap <String[], String[][]>();
        lbHooks = new ArrayList <JLabel>();
        isWindows = System.getProperty("os.name").contains("Windows");
        tmpDir = System.getProperty("java.io.tmpdir");
        if (!isWindows) {
            tmpDir += "/";
        }
    }

    private void buildPanel() {
        mainPanel = new JPanel();
        mainPanel.setMinimumSize(new Dimension(210, 510));
        setVisible(true);

        // Some preparations
        ImageIcon startIcon = new ImageIcon(getClass().getResource("/images/flag.png"));
        ImageIcon stopIcon = new ImageIcon(getClass().getResource("/images/stop.png"));
        ImageIcon resetIcon = new ImageIcon(getClass().getResource("/images/reset.png"));
        resetIcon = new ImageIcon(resetIcon.getImage().getScaledInstance(18, 18,  java.awt.Image.SCALE_SMOOTH));
        Font sansSerif12 = new Font("SansSerif", Font.PLAIN, 12);
        Font sansSerif13 = new Font("SansSerif", Font.PLAIN, 13);

        TitledBorder borderMPO = BorderFactory.createTitledBorder("Main project options");
        borderMPO.setTitleFont(sansSerif12);

        TitledBorder borderCSO = BorderFactory.createTitledBorder("Custom symbolic options");
        borderCSO.setTitleFont(sansSerif12);

        TitledBorder borderSA = BorderFactory.createTitledBorder("Program arguments");
        borderSA.setTitleFont(sansSerif12);

        argSetterPanel = new JPanel();
        vectorsPanel = new JPanel();
        regPanel = new JPanel();
        writeMemoryPanel = new JPanel();
        hookLablesPanel = new JPanel();
        statusPanel = new JPanel();
        statusPanel.setBorder(null);
        argSetterPanel.setBorder(null);
        writeMemoryPanel.setBorder(null);

        mainOptionsPanel = new JPanel();
        mainOptionsPanel.setForeground(new Color(46, 139, 87));
        mainOptionsPanel.setBorder(borderMPO);

        customOptionsPanel = new JPanel();
        customOptionsPanel.setBorder(borderCSO);

        chckbxArg = new JCheckBox("Arguments");
        chckbxArg.setFont(sansSerif12);

        argumentsPanel = new JPanel();
        argumentsPanel.setForeground(new Color(46, 139, 87));
        argumentsPanel.setBorder(borderSA);

        GroupLayout gl_argumentsPanel = new GroupLayout(argumentsPanel);
        gl_argumentsPanel.setHorizontalGroup(
            gl_argumentsPanel.createParallelGroup(Alignment.TRAILING)
            .addGroup(gl_argumentsPanel.createSequentialGroup()
                .addContainerGap()
                .addComponent(chckbxArg, GroupLayout.DEFAULT_SIZE, 100, Short.MAX_VALUE)
                .addGap(31)
                .addComponent(argSetterPanel, GroupLayout.DEFAULT_SIZE, 116, Short.MAX_VALUE)
                .addContainerGap())
        );
        gl_argumentsPanel.setVerticalGroup(
            gl_argumentsPanel.createParallelGroup(Alignment.LEADING)
            .addGroup(gl_argumentsPanel.createSequentialGroup()
                .addGroup(gl_argumentsPanel.createParallelGroup(Alignment.LEADING)
                    .addGroup(gl_argumentsPanel.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(chckbxArg))
                    .addComponent(argSetterPanel, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE))
                .addGap(20))
        );
        argumentsPanel.setLayout(gl_argumentsPanel);

        GridBagLayout gbl_argSetterPanel = new GridBagLayout();
        gbl_argSetterPanel.columnWidths = new int[] {
            0,
            0,
            0,
            0,
            0
        };
        gbl_argSetterPanel.rowHeights = new int[] {
            0,
            0
        };
        gbl_argSetterPanel.columnWeights = new double[] {
            0.0,
            0.0,
            0.0,
            0.0,
            Double.MIN_VALUE
        };
        gbl_argSetterPanel.rowWeights = new double[] {
            0.0,
            0.0
        };
        argSetterPanel.setLayout(gbl_argSetterPanel);

        btnAddArg = new JButton("");
        GridBagConstraints gbc_btnAddArg = new GridBagConstraints();
        gbc_btnAddArg.anchor = GridBagConstraints.CENTER;
        gbc_btnAddArg.fill = GridBagConstraints.HORIZONTAL;
        gbc_btnAddArg.insets = new Insets(0, 0, 0, 5);
        gbc_btnAddArg.gridx = 0;
        gbc_btnAddArg.gridy = 1;
        gbc_btnAddArg.weighty = 0.1;
        argSetterPanel.add(btnAddArg, gbc_btnAddArg);
        btnAddArg.setContentAreaFilled(false);
        btnAddArg.setIcon(addIcon);
        btnAddArg.setBorder(null);
        btnAddArg.setVisible(false);

        lbArgLen = new JLabel("Length");
        GridBagConstraints gbc_lbArgLen = new GridBagConstraints();
        gbc_lbArgLen.insets = new Insets(0, 0, 0, 5);
        gbc_lbArgLen.anchor = GridBagConstraints.CENTER;
        gbc_lbArgLen.gridwidth = 3;
        gbc_lbArgLen.gridx = 1;
        gbc_lbArgLen.gridy = 0;
        gbc_lbArgLen.weightx = 1;
        argSetterPanel.add(lbArgLen, gbc_lbArgLen);
        lbArgLen.setFont(sansSerif12);
        lbArgLen.setVisible(false);

        firstArgTF = new IntegerTextField();
        GridBagConstraints gbc_TFArglen = new GridBagConstraints();
        gbc_TFArglen.insets = new Insets(0, 0, 0, 5);
        gbc_TFArglen.fill = GridBagConstraints.HORIZONTAL;
        gbc_TFArglen.anchor = GridBagConstraints.NORTH;
        gbc_TFArglen.gridwidth = 3;
        gbc_TFArglen.gridx = 1;
        gbc_TFArglen.gridy = 1;
        gbc_TFArglen.weightx = 1;
        gbc_TFArglen.weighty = 0.1;
        argSetterPanel.add(firstArgTF.getComponent(), gbc_TFArglen);
        firstArgTF.getComponent().setVisible(false);
        chckbxArg.addItemListener(
            new ItemListener() {
                public void itemStateChanged(ItemEvent e) {
                    if (chckbxArg.isSelected()) {
                        firstArgTF.getComponent().setVisible(true);
                        lbArgLen.setVisible(true);
                        btnAddArg.setVisible(true);
                        for (JButton btnDel: delBtnArgs) {
                            btnDel.setVisible(true);
                        }
                        for (IntegerTextField argTF: argsTF) {
                            argTF.getComponent().setVisible(true);
                        }
                    } else {
                        firstArgTF.getComponent().setVisible(false);
                        lbArgLen.setVisible(false);
                        btnAddArg.setVisible(false);
                        for (JButton btnDel: delBtnArgs) {
                            btnDel.setVisible(false);
                        }
                        for (IntegerTextField argTF: argsTF) {
                            argTF.getComponent().setVisible(false);
                        }
                    }
                }
            }
        );

        btnAddArg.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                IntegerTextField argTF = new IntegerTextField();
                GridBagConstraints gbc_TFArg = new GridBagConstraints();
                gbc_TFArg.fill = GridBagConstraints.HORIZONTAL;
                gbc_TFArg.anchor = GridBagConstraints.CENTER;
                gbc_TFArg.gridwidth = 3;
                gbc_TFArg.gridx = 1;
                gbc_TFArg.insets = new Insets(0, 0, 0, 5);
                gbc_TFArg.gridy = guiArgNextId;
                gbc_TFArg.weightx = 1;
                gbc_TFArg.weighty = 0.1;
                argSetterPanel.add(argTF.getComponent(), gbc_TFArg);
                argsTF.add(argTF);

                JButton btnDel = new JButton("");
                btnDel.setBorder(null);
                btnDel.setContentAreaFilled(false);
                btnDel.setIcon(deleteIcon);
                GridBagConstraints gbc_btnDel = new GridBagConstraints();
                gbc_btnDel.insets = new Insets(0, 0, 0, 5);
                gbc_btnDel.fill = GridBagConstraints.HORIZONTAL;
                gbc_btnDel.anchor = GridBagConstraints.CENTER;
                gbc_btnDel.gridx = 0;
                gbc_btnDel.gridy = guiArgNextId++;
                gbc_btnDel.weighty = 0.1;
                argSetterPanel.add(btnDel, gbc_btnDel);
                delBtnArgs.add(btnDel);
                btnDel.addActionListener(new ActionListener() {
                    public void actionPerformed(ActionEvent actionEvent) {
                        guiArgNextId--;
                        argSetterPanel.remove(argTF.getComponent());
                        argSetterPanel.remove(btnDel);
                        delBtnArgs.remove(btnDel);
                        argsTF.remove(argTF);
                        argSetterPanel.repaint();
                        argSetterPanel.revalidate();
                    }
                });
                argSetterPanel.repaint();
                argSetterPanel.revalidate();
            }
        });
        chckbxAutoLoadLibs = new JCheckBox("Auto load libs");
        chckbxAutoLoadLibs.setFont(sansSerif12);
        blankStateTF = new JTextField();
        blankStateTF.setVisible(false);
        blankStateTF.addKeyListener(new KeyAdapter() {
            public void keyReleased(KeyEvent e) {
                Address blankStateAddress = addressStorage.getBlankStateAddress();
                if (blankStateAddress != null) {
                    mColorService.resetColor(blankStateAddress);
                    addressStorage.setBlankStateAddress(null);
                }
            }
        });
        chckbxBlankState = new JCheckBox("Blank state");
        chckbxBlankState.setFont(sansSerif12);
        chckbxBlankState.addItemListener(
            new ItemListener() {
                public void itemStateChanged(ItemEvent e) {
                    if (chckbxBlankState.isSelected()) {
                        blankStateTF.setVisible(true);
                    } else {
                        blankStateTF.setVisible(false);
                    }
                    mainOptionsPanel.revalidate();
                }
            }
        );

        JLabel lbFind = new JLabel("Find address");
        lbFind.setForeground(new Color(60, 179, 113));
        lbFind.setFont(sansSerif12);

        dstAddressTF = new JTextField();
        dstAddressTF.setMinimumSize(new Dimension(100, 20));
        dstAddressTF.addKeyListener(new KeyAdapter() {
            public void keyReleased(KeyEvent e) {
                Address dstAddress = addressStorage.getDestinationAddress();
                if (dstAddress != null) {
                    mColorService.resetColor(dstAddress);
                    addressStorage.setDestinationAddress(null);
                }
            }
        });

        chckbxAvoidAddresses = new JCheckBox("Аvoid addresses");
        chckbxAvoidAddresses.setForeground(new Color(255, 0, 0));
        chckbxAvoidAddresses.setToolTipText("");
        chckbxAvoidAddresses.setFont(sansSerif12);

        avoidTextArea = new JTextArea();
        avoidTextArea.setMinimumSize(new Dimension(40, 40));
        avoidTextArea.setToolTipText("Enter the hex values separated by comma.");
        avoidTextArea.setFont(dstAddressTF.getFont());
        avoidTextArea.addKeyListener(new KeyAdapter() {
            public void keyReleased(KeyEvent e) {
                List<Address> userAvoidAddresses = new ArrayList<Address>(addressStorage.getAvoidAddresses());
                if (!userAvoidAddresses.isEmpty()) {
                    try {
                        List <String> avoidAddresses = Arrays.asList(avoidTextArea.getText().split(","));
                        // Sanitize the list
                        String separator = System.getProperty("line.separator");
                        for (int i = 0; i < avoidAddresses.size(); i++) {
                            avoidAddresses.set(i, avoidAddresses.get(i).replace(separator, ""));
                        }
                        for (int i = 0; i < userAvoidAddresses.size(); i++) {
                            Address address = userAvoidAddresses.get(i);
                            String strAddress = "0x" + address.toString();
                            if (!avoidAddresses.contains(strAddress)) {
                                mColorService.resetColor(address);
                                addressStorage.removeAvoidAddress(address);
                            }
                        }
                    } catch (Exception ex) {}
                }
            }
        });

        scrollAvoidAddrsArea = new JScrollPane(avoidTextArea);
        scrollAvoidAddrsArea.setMinimumSize(new Dimension(50, 50));
        scrollAvoidAddrsArea.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);
        scrollAvoidAddrsArea.setVisible(false);
        chckbxAvoidAddresses.addItemListener(
            new ItemListener() {
                public void itemStateChanged(ItemEvent e) {
                    if (chckbxAvoidAddresses.isSelected()) {
                        scrollAvoidAddrsArea.setVisible(true);
                    } else {
                        scrollAvoidAddrsArea.setVisible(false);
                    }
                    mainOptionsPanel.revalidate();
                }
            }
        );

        // Unfortunately, it was found that GUI gaps look different on different operating systems
        int blankStateTFGap = 10;
        int findAddressGap = 13;
        int blankStateCBGap = 11;
        int scrollAvoidAddrsAreaGap = 11;
        int avoidAreaGap = 11;
        int bufferGap = 8;
        int horizontalFindAddressGap = 22;
        if (isWindows) {
            blankStateTFGap = 11;
            findAddressGap = 10;
            blankStateCBGap = 6;
            scrollAvoidAddrsAreaGap = 13;
            avoidAreaGap = 8;
            bufferGap = 0;
            horizontalFindAddressGap = 21;
        }

        GroupLayout gl_mainOptionsPanel = new GroupLayout(mainOptionsPanel);
        gl_mainOptionsPanel.setHorizontalGroup(
            gl_mainOptionsPanel.createParallelGroup(Alignment.TRAILING)
                .addGroup(gl_mainOptionsPanel.createSequentialGroup()
                        .addGap(11)
                        .addGroup(gl_mainOptionsPanel.createParallelGroup(Alignment.LEADING)
                            .addGroup(gl_mainOptionsPanel.createSequentialGroup()
                                .addComponent(chckbxAutoLoadLibs, GroupLayout.PREFERRED_SIZE, 134, GroupLayout.PREFERRED_SIZE)
                                .addContainerGap(73, Short.MAX_VALUE))
                            .addGroup(gl_mainOptionsPanel.createSequentialGroup()
                                .addGroup(gl_mainOptionsPanel.createParallelGroup(Alignment.LEADING)
                                    .addGroup(gl_mainOptionsPanel.createParallelGroup(Alignment.LEADING)
                                        .addGroup(gl_mainOptionsPanel.createSequentialGroup()
                                            .addComponent(chckbxBlankState, GroupLayout.PREFERRED_SIZE, 134, GroupLayout.PREFERRED_SIZE)
                                            .addPreferredGap(ComponentPlacement.RELATED, 18, Short.MAX_VALUE))
                                        .addGroup(gl_mainOptionsPanel.createSequentialGroup()
                                            .addComponent(chckbxAvoidAddresses, GroupLayout.PREFERRED_SIZE, 134, GroupLayout.PREFERRED_SIZE)
                                            .addPreferredGap(ComponentPlacement.RELATED, 18, Short.MAX_VALUE)))
                                    .addGroup(gl_mainOptionsPanel.createSequentialGroup()
                                        .addGap(horizontalFindAddressGap)
                                        .addComponent(lbFind, GroupLayout.PREFERRED_SIZE, 102, GroupLayout.PREFERRED_SIZE)
                                        .addPreferredGap(ComponentPlacement.RELATED)))
                                .addGroup(gl_mainOptionsPanel.createParallelGroup(Alignment.LEADING)
                                    .addComponent(blankStateTF, GroupLayout.DEFAULT_SIZE, 54, Short.MAX_VALUE)
                                    .addComponent(dstAddressTF, GroupLayout.DEFAULT_SIZE, 54, Short.MAX_VALUE)
                                    .addComponent(scrollAvoidAddrsArea, GroupLayout.DEFAULT_SIZE, 54, Short.MAX_VALUE))
                                .addGap(15))))
        );

        gl_mainOptionsPanel.setVerticalGroup(
            gl_mainOptionsPanel.createParallelGroup(Alignment.LEADING)
                .addGroup(gl_mainOptionsPanel.createSequentialGroup()
                    .addGap(6)
                    .addComponent(chckbxAutoLoadLibs)
                    .addGap(bufferGap)
                    .addGroup(gl_mainOptionsPanel.createParallelGroup(Alignment.BASELINE)
                            .addGroup(gl_mainOptionsPanel.createSequentialGroup()
                                    .addGap(blankStateCBGap)
                                    .addComponent(chckbxBlankState))
                            .addGroup(gl_mainOptionsPanel.createSequentialGroup()
                                    .addGap(blankStateTFGap)
                                    .addComponent(blankStateTF, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE)))
                    .addGroup(gl_mainOptionsPanel.createSequentialGroup()
                        .addGroup(gl_mainOptionsPanel.createParallelGroup(Alignment.BASELINE)
                            .addGroup(gl_mainOptionsPanel.createSequentialGroup()
                                    .addGap(findAddressGap)
                                    .addComponent(lbFind))
                            .addGroup(gl_mainOptionsPanel.createSequentialGroup()
                                    .addGap(10)
                                    .addComponent(dstAddressTF, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE)))
                        .addGroup(gl_mainOptionsPanel.createParallelGroup(Alignment.BASELINE)
                            .addGroup(gl_mainOptionsPanel.createSequentialGroup()
                                .addGap(avoidAreaGap)
                                .addComponent(chckbxAvoidAddresses))
                            .addGroup(gl_mainOptionsPanel.createSequentialGroup()
                                .addGap(scrollAvoidAddrsAreaGap)
                                .addComponent(scrollAvoidAddrsArea, GroupLayout.PREFERRED_SIZE, 45, Short.MAX_VALUE))))
                    .addContainerGap())
        );
        gl_mainOptionsPanel.setAutoCreateContainerGaps(false);
        gl_mainOptionsPanel.setAutoCreateGaps(false);
        gl_mainOptionsPanel.setHonorsVisibility(false);
        mainOptionsPanel.setLayout(gl_mainOptionsPanel);

        JLabel lbMemory = new JLabel("Store symbolic vector:");
        lbMemory.setHorizontalAlignment(SwingConstants.CENTER);
        lbMemory.setFont(sansSerif12);
        JLabel lbRegisters = new JLabel(htmlString);
        lbRegisters.setFont(sansSerif12);

        GridBagLayout gbl_writeMemoryPanel = new GridBagLayout();
        gbl_writeMemoryPanel.columnWidths = new int[] {
            0,
            0,
            0,
            0,
            0,
            0
        };
        gbl_writeMemoryPanel.rowHeights = new int[] {
            0,
            0,
            0
        };
        gbl_writeMemoryPanel.columnWeights = new double[] {
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            Double.MIN_VALUE
        };
        gbl_writeMemoryPanel.rowWeights = new double[] {
            0.0,
            0.0,
            Double.MIN_VALUE
        };
        writeMemoryPanel.setLayout(gbl_writeMemoryPanel);

        lblWriteToMemory = new JLabel("Write to memory:");
        lblWriteToMemory.setHorizontalAlignment(SwingConstants.CENTER);
        lblWriteToMemory.setFont(sansSerif12);

        lbStoreAddr = new JLabel("Address");
        lbStoreAddr.setFont(sansSerif12);
        GridBagConstraints gbc_lbStoreAddr = new GridBagConstraints();
        gbc_lbStoreAddr.weightx = 1.0;
        gbc_lbStoreAddr.insets = new Insets(0, 0, 0, 5);
        gbc_lbStoreAddr.gridx = 1;
        gbc_lbStoreAddr.gridy = 0;
        writeMemoryPanel.add(lbStoreAddr, gbc_lbStoreAddr);

        lbStoreVal = new JLabel("Value");
        lbStoreVal.setFont(sansSerif12);
        GridBagConstraints gbc_lbStoreVal = new GridBagConstraints();
        gbc_lbStoreVal.weightx = 1.0;
        gbc_lbStoreVal.insets = new Insets(0, 0, 0, 5);
        gbc_lbStoreVal.gridx = 3;
        gbc_lbStoreVal.gridy = 0;
        writeMemoryPanel.add(lbStoreVal, gbc_lbStoreVal);

        memStoreAddrTF = new IntegerTextField();
        memStoreAddrTF.setHexMode();
        GridBagConstraints gbc_memStoreAddrTF = new GridBagConstraints();
        gbc_memStoreAddrTF.anchor = GridBagConstraints.CENTER;
        gbc_memStoreAddrTF.fill = GridBagConstraints.HORIZONTAL;
        gbc_memStoreAddrTF.insets = new Insets(0, 0, 0, 5);
        gbc_memStoreAddrTF.gridx = 1;
        gbc_memStoreAddrTF.gridy = 1;
        gbc_memStoreAddrTF.weightx = 1;
        gbc_memStoreAddrTF.weighty = 0.1;
        writeMemoryPanel.add(memStoreAddrTF.getComponent(), gbc_memStoreAddrTF);

        memStoreValueTF = new IntegerTextField();
        memStoreValueTF.setHexMode();
        GridBagConstraints gbc_memStoreValueTF = new GridBagConstraints();
        gbc_memStoreValueTF.insets = new Insets(0, 0, 0, 5);
        gbc_memStoreValueTF.fill = GridBagConstraints.HORIZONTAL;
        gbc_memStoreValueTF.anchor = GridBagConstraints.CENTER;
        gbc_memStoreValueTF.gridx = 3;
        gbc_memStoreValueTF.gridy = 1;
        gbc_memStoreValueTF.weightx = 1;
        gbc_memStoreValueTF.weighty = 0.1;
        writeMemoryPanel.add(memStoreValueTF.getComponent(), gbc_memStoreValueTF);

        btnAddWM = new JButton("");
        btnAddWM.setContentAreaFilled(false);
        btnAddWM.setBorder(null);
        btnAddWM.setIcon(addIcon);
        GridBagConstraints gbc_btnAddWM = new GridBagConstraints();
        gbc_btnAddWM.weighty = 0.1;
        gbc_btnAddWM.fill = GridBagConstraints.HORIZONTAL;
        gbc_btnAddWM.anchor = GridBagConstraints.CENTER;
        gbc_btnAddWM.insets = new Insets(0, 0, 0, 5);
        gbc_btnAddWM.gridx = 0;
        gbc_btnAddWM.gridy = 1;
        gbc_btnAddWM.weighty = 0.1;
        writeMemoryPanel.add(btnAddWM, gbc_btnAddWM);
        btnAddWM.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                IntegerTextField addrTF = new IntegerTextField();
                addrTF.setHexMode();
                GridBagConstraints gbc_addrTF = new GridBagConstraints();
                gbc_addrTF.fill = GridBagConstraints.HORIZONTAL;
                gbc_addrTF.anchor = GridBagConstraints.CENTER;
                gbc_addrTF.gridx = 1;
                gbc_addrTF.insets = new Insets(0, 0, 0, 5);
                gbc_addrTF.gridy = guiStoreNextId;
                gbc_addrTF.weightx = 1;
                gbc_addrTF.weighty = 0.1;
                writeMemoryPanel.add(addrTF.getComponent(), gbc_addrTF);

                IntegerTextField valTF = new IntegerTextField();
                valTF.setHexMode();
                GridBagConstraints gbc_valTF = new GridBagConstraints();
                gbc_valTF.fill = GridBagConstraints.HORIZONTAL;
                gbc_valTF.anchor = GridBagConstraints.CENTER;
                gbc_valTF.insets = new Insets(0, 0, 0, 5);
                gbc_valTF.gridx = 3;
                gbc_valTF.gridy = guiStoreNextId;
                gbc_valTF.weightx = 1;
                gbc_valTF.weighty = 0.1;
                writeMemoryPanel.add(valTF.getComponent(), gbc_valTF);
                memStore.put(addrTF, valTF);

                JButton btnDel = new JButton("");
                btnDel.setBorder(null);
                btnDel.setContentAreaFilled(false);
                btnDel.setIcon(deleteIcon);
                GridBagConstraints gbc_btnDel = new GridBagConstraints();
                gbc_btnDel.fill = GridBagConstraints.HORIZONTAL;
                gbc_btnDel.anchor = GridBagConstraints.CENTER;
                gbc_btnDel.insets = new Insets(0, 0, 0, 5);
                gbc_btnDel.gridx = 0;
                gbc_btnDel.gridy = guiStoreNextId++;
                gbc_btnDel.weighty = 0.1;
                writeMemoryPanel.add(btnDel, gbc_btnDel);
                delStoreBtns.add(btnDel);
                btnDel.addActionListener(new ActionListener() {
                    public void actionPerformed(ActionEvent actionEvent) {
                        guiStoreNextId--;
                        writeMemoryPanel.remove(addrTF.getComponent());
                        writeMemoryPanel.remove(valTF.getComponent());
                        writeMemoryPanel.remove(btnDel);
                        delStoreBtns.remove(btnDel);
                        memStore.remove(addrTF, valTF);
                        writeMemoryPanel.repaint();
                        writeMemoryPanel.revalidate();
                    }
                });
                writeMemoryPanel.repaint();
                writeMemoryPanel.revalidate();
            }
        });

        GroupLayout gl_customOptionsPanel = new GroupLayout(customOptionsPanel);
        gl_customOptionsPanel.setHorizontalGroup(
            gl_customOptionsPanel.createParallelGroup(Alignment.LEADING)
                .addGroup(gl_customOptionsPanel.createSequentialGroup()
                    .addContainerGap()
                    .addComponent(vectorsPanel, GroupLayout.DEFAULT_SIZE, 343, Short.MAX_VALUE)
                    .addGap(25))
                .addGroup(gl_customOptionsPanel.createSequentialGroup()
                    .addContainerGap()
                    .addGroup(gl_customOptionsPanel.createParallelGroup(Alignment.LEADING)
                        .addGroup(gl_customOptionsPanel.createSequentialGroup()
                            .addComponent(lblWriteToMemory)
                            .addPreferredGap(ComponentPlacement.RELATED, 237, GroupLayout.PREFERRED_SIZE))
                        .addComponent(writeMemoryPanel, GroupLayout.DEFAULT_SIZE, 343, Short.MAX_VALUE))
                    .addGap(25))
                .addGroup(gl_customOptionsPanel.createSequentialGroup()
                    .addContainerGap()
                    .addComponent(regPanel, GroupLayout.DEFAULT_SIZE, 343, Short.MAX_VALUE)
                    .addGap(25))
                .addGroup(gl_customOptionsPanel.createSequentialGroup()
                    .addContainerGap()
                    .addComponent(lbRegisters, GroupLayout.PREFERRED_SIZE, 327, Short.MAX_VALUE)
                    )
                .addGroup(gl_customOptionsPanel.createSequentialGroup()
                    .addComponent(lbMemory, GroupLayout.PREFERRED_SIZE, 148, GroupLayout.PREFERRED_SIZE)
                    .addContainerGap(232, Short.MAX_VALUE))
        );
        gl_customOptionsPanel.setVerticalGroup(
            gl_customOptionsPanel.createParallelGroup(Alignment.LEADING)
                .addGroup(gl_customOptionsPanel.createSequentialGroup()
                    .addContainerGap()
                    .addComponent(lbMemory, GroupLayout.PREFERRED_SIZE, 13, GroupLayout.PREFERRED_SIZE)
                    .addPreferredGap(ComponentPlacement.RELATED)
                    .addComponent(vectorsPanel, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE)
                    .addGap(23)
                    .addComponent(lblWriteToMemory)
                    .addPreferredGap(ComponentPlacement.RELATED)
                    .addComponent(writeMemoryPanel, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE)
                    .addGap(18)
                    .addComponent(lbRegisters)
                    .addGap(9)
                    .addComponent(regPanel, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE)
                    .addGap(54))
        );
        customOptionsPanel.setLayout(gl_customOptionsPanel);

        GridBagLayout gbl_regPanel = new GridBagLayout();
        gbl_regPanel.columnWidths = new int[] {
            0,
            0,
            0,
            0,
            0
        };
        gbl_regPanel.rowHeights = new int[] {
            0,
            0
        };
        gbl_regPanel.columnWeights = new double[] {
            0.0,
            0.0,
            0.0,
            0.0,
            Double.MIN_VALUE
        };
        gbl_regPanel.rowWeights = new double[] {
            0.0,
            0.0
        };
        regPanel.setLayout(gbl_regPanel);

        JLabel lblReg = new JLabel("Register");
        lblReg.setFont(sansSerif12);
        GridBagConstraints gbc_lblReg = new GridBagConstraints();
        gbc_lblReg.anchor = GridBagConstraints.SOUTH;
        gbc_lblReg.insets = new Insets(0, 0, 0, 5);
        gbc_lblReg.gridx = 1;
        gbc_lblReg.gridy = 0;
        gbc_lblReg.weightx = 1;
        regPanel.add(lblReg, gbc_lblReg);

        JLabel lblValue = new JLabel("  Value ");
        lblValue.setFont(sansSerif12);
        GridBagConstraints gbc_lblValue = new GridBagConstraints();
        gbc_lblValue.anchor = GridBagConstraints.SOUTH;
        gbc_lblValue.insets = new Insets(0, 0, 0, 5);
        gbc_lblValue.gridx = 3;
        gbc_lblValue.gridy = 0;
        gbc_lblValue.weightx = 1;
        regPanel.add(lblValue, gbc_lblValue);

        JButton btnAddButton = new JButton("");
        GridBagConstraints gbc_btnAddButton = new GridBagConstraints();
        gbc_btnAddButton.anchor = GridBagConstraints.CENTER;
        gbc_btnAddButton.fill = GridBagConstraints.HORIZONTAL;
        gbc_btnAddButton.insets = new Insets(0, 0, 0, 5);
        gbc_btnAddButton.gridx = 0;
        gbc_btnAddButton.gridy = 1;
        gbc_btnAddButton.weighty = 0.1;
        regPanel.add(btnAddButton, gbc_btnAddButton);
        btnAddButton.setBorder(null);
        btnAddButton.setContentAreaFilled(false);
        btnAddButton.setIcon(addIcon);

        valueTF = new JTextField();
        valueTF.setColumns(5);
        GridBagConstraints gbc_valueTF = new GridBagConstraints();
        gbc_valueTF.insets = new Insets(0, 0, 0, 5);
        gbc_valueTF.anchor = GridBagConstraints.CENTER;
        gbc_valueTF.fill = GridBagConstraints.HORIZONTAL;
        gbc_valueTF.gridx = 3;
        gbc_valueTF.gridy = 1;
        gbc_valueTF.weightx = 1;
        gbc_valueTF.weighty = 0.1;
        regPanel.add(valueTF, gbc_valueTF);

        registerTF = new JTextField();
        registerTF.setColumns(5);
        GridBagConstraints gbc_registerTF = new GridBagConstraints();
        gbc_registerTF.anchor = GridBagConstraints.CENTER;
        gbc_registerTF.fill = GridBagConstraints.HORIZONTAL;
        gbc_registerTF.insets = new Insets(0, 0, 0, 5);
        gbc_registerTF.gridx = 1;
        gbc_registerTF.gridy = 1;
        gbc_registerTF.weighty = 0.1;
        regPanel.add(registerTF, gbc_registerTF);

        btnAddButton.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                JTextField regTF = new JTextField();
                regTF.setColumns(5);
                GridBagConstraints gbc_regTF = new GridBagConstraints();
                gbc_regTF.fill = GridBagConstraints.HORIZONTAL;
                gbc_regTF.anchor = GridBagConstraints.CENTER;
                gbc_regTF.gridx = 1;
                gbc_regTF.insets = new Insets(0, 0, 0, 5);
                gbc_regTF.gridy = guiRegNextId;
                gbc_regTF.weightx = 1;
                gbc_regTF.weighty = 0.1;
                regPanel.add(regTF, gbc_regTF);

                JTextField valTF = new JTextField();
                valTF.setColumns(5);
                GridBagConstraints gbc_valTF = new GridBagConstraints();
                gbc_valTF.fill = GridBagConstraints.HORIZONTAL;
                gbc_valTF.anchor = GridBagConstraints.CENTER;
                gbc_valTF.insets = new Insets(0, 0, 0, 5);
                gbc_valTF.gridx = 3;
                gbc_valTF.gridy = guiRegNextId;
                gbc_valTF.weightx = 1;
                gbc_valTF.weighty = 0.1;
                regPanel.add(valTF, gbc_valTF);
                presetRegs.put(regTF, valTF);

                JButton btnDel = new JButton("");
                btnDel.setBorder(null);
                btnDel.setContentAreaFilled(false);
                btnDel.setIcon(deleteIcon);
                GridBagConstraints gbc_btnDel = new GridBagConstraints();
                gbc_btnDel.insets = new Insets(0, 0, 0, 5);
                gbc_btnDel.fill = GridBagConstraints.HORIZONTAL;
                gbc_btnDel.anchor = GridBagConstraints.CENTER;
                gbc_btnDel.gridx = 0;
                gbc_btnDel.gridy = guiRegNextId++;
                gbc_btnDel.weighty = 0.1;
                regPanel.add(btnDel, gbc_btnDel);
                delRegsBtns.add(btnDel);
                btnDel.addActionListener(new ActionListener() {
                    public void actionPerformed(ActionEvent actionEvent) {
                        guiRegNextId--;
                        delRegsBtns.remove(btnDel);
                        presetRegs.remove(regTF, valTF);
                        regPanel.remove(regTF);
                        regPanel.remove(valTF);
                        regPanel.remove(btnDel);
                        regPanel.repaint();
                        regPanel.revalidate();
                    }
                });
                regPanel.repaint();
                regPanel.revalidate();
            }
        });

        GridBagLayout gbl_vectorsPanel = new GridBagLayout();
        gbl_vectorsPanel.columnWidths = new int[] {
            0,
            0,
            0,
            0,
            0,
            0
        };
        gbl_vectorsPanel.rowHeights = new int[] {
            0,
            0
        };
        gbl_vectorsPanel.columnWeights = new double[] {
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            Double.MIN_VALUE
        };
        gbl_vectorsPanel.rowWeights = new double[] {
            0.0,
            0.0
        };
        vectorsPanel.setLayout(gbl_vectorsPanel);
        JButton btnAddMem = new JButton("");
        GridBagConstraints gbc_btnAddMem = new GridBagConstraints();
        gbc_btnAddMem.anchor = GridBagConstraints.CENTER;
        gbc_btnAddMem.fill = GridBagConstraints.HORIZONTAL;
        gbc_btnAddMem.insets = new Insets(0, 0, 0, 5);
        gbc_btnAddMem.gridx = 0;
        gbc_btnAddMem.gridy = 1;
        gbc_btnAddMem.weighty = 0.1;
        vectorsPanel.add(btnAddMem, gbc_btnAddMem);
        btnAddMem.setIcon(addIcon);
        btnAddMem.setBorder(null);
        btnAddMem.setContentAreaFilled(false);

        JLabel lbMemAddr = new JLabel("Address");
        lbMemAddr.setFont(sansSerif12);
        GridBagConstraints gbc_lbMemAddr = new GridBagConstraints();
        gbc_lbMemAddr.insets = new Insets(0, 0, 0, 5);
        gbc_lbMemAddr.gridx = 1;
        gbc_lbMemAddr.gridy = 0;
        gbc_lbMemAddr.weightx = 1;
        vectorsPanel.add(lbMemAddr, gbc_lbMemAddr);

        JLabel lblLentgh = new JLabel("Length");
        lblLentgh.setFont(sansSerif12);
        GridBagConstraints gbc_lblLentgh = new GridBagConstraints();
        gbc_lblLentgh.insets = new Insets(0, 0, 0, 5);
        gbc_lblLentgh.gridx = 3;
        gbc_lblLentgh.gridy = 0;
        gbc_lblLentgh.weightx = 1;
        vectorsPanel.add(lblLentgh, gbc_lblLentgh);

        vectorAddressTF = new IntegerTextField();
        vectorAddressTF.setHexMode();
        GridBagConstraints gbc_vectorAddressTF = new GridBagConstraints();
        gbc_vectorAddressTF.anchor = GridBagConstraints.CENTER;
        gbc_vectorAddressTF.fill = GridBagConstraints.HORIZONTAL;
        gbc_vectorAddressTF.insets = new Insets(0, 0, 0, 5);
        gbc_vectorAddressTF.gridx = 1;
        gbc_vectorAddressTF.gridy = 1;
        gbc_vectorAddressTF.weightx = 1;
        gbc_vectorAddressTF.weighty = 0.1;
        vectorsPanel.add(vectorAddressTF.getComponent(), gbc_vectorAddressTF);

        vectorLenTF = new IntegerTextField();
        GridBagConstraints gbc_vectorLenTF = new GridBagConstraints();
        gbc_vectorLenTF.insets = new Insets(0, 0, 0, 5);
        gbc_vectorLenTF.fill = GridBagConstraints.HORIZONTAL;
        gbc_vectorLenTF.anchor = GridBagConstraints.CENTER;
        gbc_vectorLenTF.gridx = 3;
        gbc_vectorLenTF.gridy = 1;
        gbc_vectorLenTF.weightx = 1;
        gbc_vectorLenTF.weighty = 0.1;
        vectorsPanel.add(vectorLenTF.getComponent(), gbc_vectorLenTF);

        btnAddMem.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                IntegerTextField addrTF = new IntegerTextField();
                addrTF.setHexMode();
                GridBagConstraints gbc_addrTF = new GridBagConstraints();
                gbc_addrTF.fill = GridBagConstraints.HORIZONTAL;
                gbc_addrTF.anchor = GridBagConstraints.CENTER;
                gbc_addrTF.gridx = 1;
                gbc_addrTF.insets = new Insets(0, 0, 0, 5);
                gbc_addrTF.gridy = guiMemNextId;
                gbc_addrTF.weightx = 1;
                gbc_addrTF.weighty = 0.1;
                vectorsPanel.add(addrTF.getComponent(), gbc_addrTF);

                IntegerTextField lenTF = new IntegerTextField();
                GridBagConstraints gbc_lenTF = new GridBagConstraints();
                gbc_lenTF.fill = GridBagConstraints.HORIZONTAL;
                gbc_lenTF.anchor = GridBagConstraints.CENTER;
                gbc_lenTF.insets = new Insets(0, 0, 0, 5);
                gbc_lenTF.gridx = 3;
                gbc_lenTF.gridy = guiMemNextId;
                gbc_lenTF.weightx = 1;
                gbc_lenTF.weighty = 0.1;
                vectorsPanel.add(lenTF.getComponent(), gbc_lenTF);
                vectors.put(addrTF, lenTF);

                JButton btnDel = new JButton("");
                btnDel.setBorder(null);
                btnDel.setContentAreaFilled(false);
                btnDel.setIcon(deleteIcon);
                GridBagConstraints gbc_btnDel = new GridBagConstraints();
                gbc_btnDel.fill = GridBagConstraints.HORIZONTAL;
                gbc_btnDel.anchor = GridBagConstraints.CENTER;
                gbc_btnDel.insets = new Insets(0, 0, 0, 5);
                gbc_btnDel.gridx = 0;
                gbc_btnDel.gridy = guiMemNextId++;
                gbc_btnDel.weighty = 0.1;
                vectorsPanel.add(btnDel, gbc_btnDel);
                delMemBtns.add(btnDel);
                btnDel.addActionListener(new ActionListener() {
                    public void actionPerformed(ActionEvent actionEvent) {
                        guiMemNextId--;
                        vectorsPanel.remove(addrTF.getComponent());
                        vectorsPanel.remove(lenTF.getComponent());
                        vectorsPanel.remove(btnDel);
                        delMemBtns.remove(btnDel);
                        vectors.remove(addrTF, lenTF);
                        vectorsPanel.repaint();
                        vectorsPanel.revalidate();
                    }
                });
                vectorsPanel.repaint();
                vectorsPanel.revalidate();
            }
        });


        lbStatus = new JLabel("Status:");
        lbStatus.setForeground(Color.BLUE);
        lbStatus.setFont(sansSerif13);

        statusLabel = new JLabel(configuringString);
        statusLabel.setFont(sansSerif13);

        statusLabelFound = new JLabel("");
        statusLabelFound.setFont(sansSerif13);

        btnRun = new JButton("Run");
        btnRun.setIcon(startIcon);
        btnRun.setFont(sansSerif12);

        solutionTextArea = new JTextArea();
        solutionTextArea.setFont(sansSerif12);
        scrollSolutionTextArea = new JScrollPane(solutionTextArea);
        solutionTextArea.setEditable(false);
        scrollSolutionTextArea.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_AS_NEEDED);
        scrollSolutionTextArea.setBorder(new LineBorder(Color.blue, 1));
        scrollSolutionTextArea.setVisible(false);

        btnStop = new JButton("Stop");
        btnStop.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                if (new File(tmpDir + "angr_options.json").exists()) {
                    setIsTerminated(true);
                    statusLabel.setText("[+] Stopping...");
                    statusLabelFound.setText("");
                    scrollSolutionTextArea.setVisible(false);
                }
            }
        });
        btnStop.setFont(sansSerif12);
        btnStop.setIcon(stopIcon);

        btnReset = new JButton("Reset");
        btnReset.setIcon(resetIcon);
        btnReset.setFont(sansSerif12);
        btnReset.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                resetState();
            }
        });

        GroupLayout gl_statusPanel = new GroupLayout(statusPanel);
        gl_statusPanel.setHorizontalGroup(
            gl_statusPanel.createParallelGroup(Alignment.LEADING)
                .addGroup(gl_statusPanel.createSequentialGroup()
                    .addGap(10)
                    .addComponent(statusLabelFound, GroupLayout.DEFAULT_SIZE, 127, Short.MAX_VALUE)
                    .addGap(71)
                    .addComponent(scrollSolutionTextArea, GroupLayout.DEFAULT_SIZE, 378, Short.MAX_VALUE)
                    .addGap(10))
                .addGroup(gl_statusPanel.createSequentialGroup()
                    .addGroup(gl_statusPanel.createParallelGroup(Alignment.TRAILING)
                        .addGroup(gl_statusPanel.createSequentialGroup()
                            .addGap(77)
                            .addComponent(btnRun, GroupLayout.DEFAULT_SIZE, 116, Short.MAX_VALUE)
                            .addGap(77)
                            .addComponent(btnStop, GroupLayout.DEFAULT_SIZE, 116, Short.MAX_VALUE)
                            .addGap(77)
                            .addComponent(btnReset, GroupLayout.DEFAULT_SIZE, 116, Short.MAX_VALUE)
                            .addGap(1))
                        .addGroup(gl_statusPanel.createSequentialGroup()
                            .addGap(10)
                            .addComponent(statusLabel, GroupLayout.DEFAULT_SIZE, 495, Short.MAX_VALUE)))
                    .addGap(91))
                .addGroup(gl_statusPanel.createSequentialGroup()
                    .addContainerGap()
                    .addComponent(lbStatus, GroupLayout.PREFERRED_SIZE, 46, GroupLayout.PREFERRED_SIZE)
                    .addContainerGap(538, Short.MAX_VALUE))
        );
        gl_statusPanel.setVerticalGroup(
            gl_statusPanel.createParallelGroup(Alignment.LEADING)
                .addGroup(gl_statusPanel.createSequentialGroup()
                    .addGap(10)
                    .addGroup(gl_statusPanel.createParallelGroup(Alignment.BASELINE)
                        .addComponent(btnRun, GroupLayout.PREFERRED_SIZE, 21, GroupLayout.PREFERRED_SIZE)
                        .addComponent(btnStop, GroupLayout.PREFERRED_SIZE, 21, GroupLayout.PREFERRED_SIZE)
                        .addComponent(btnReset, GroupLayout.PREFERRED_SIZE, 21, GroupLayout.PREFERRED_SIZE))
                    .addPreferredGap(ComponentPlacement.RELATED)
                    .addComponent(lbStatus, GroupLayout.PREFERRED_SIZE, 13, GroupLayout.PREFERRED_SIZE)
                    .addPreferredGap(ComponentPlacement.RELATED)
                    .addComponent(statusLabel, GroupLayout.PREFERRED_SIZE, 17, GroupLayout.PREFERRED_SIZE)
                    .addGroup(gl_statusPanel.createParallelGroup(Alignment.LEADING)
                        .addGroup(gl_statusPanel.createSequentialGroup()
                            .addGap(5)
                            .addComponent(statusLabelFound, GroupLayout.PREFERRED_SIZE, 15, GroupLayout.PREFERRED_SIZE))
                        .addGroup(gl_statusPanel.createSequentialGroup()
                            .addPreferredGap(ComponentPlacement.RELATED)
                            .addComponent(scrollSolutionTextArea, GroupLayout.DEFAULT_SIZE, 36, Short.MAX_VALUE)))
                    .addContainerGap())
        );
        statusPanel.setLayout(gl_statusPanel);

        JPanel hookPanel = new JPanel();
        TitledBorder borderHP = BorderFactory.createTitledBorder("Hook options");
        borderHP.setTitleFont(sansSerif12);
        hookPanel.setBorder(borderHP);

        GroupLayout gl_mainPanel = new GroupLayout(mainPanel);
        gl_mainPanel.setHorizontalGroup(
            gl_mainPanel.createParallelGroup(Alignment.TRAILING)
            .addGroup(gl_mainPanel.createSequentialGroup()
                .addGroup(gl_mainPanel.createParallelGroup(Alignment.LEADING)
                    .addGroup(gl_mainPanel.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(statusPanel, GroupLayout.DEFAULT_SIZE, 550, Short.MAX_VALUE))
                    .addGroup(gl_mainPanel.createSequentialGroup()
                        .addGroup(gl_mainPanel.createParallelGroup(Alignment.LEADING)
                            .addGroup(gl_mainPanel.createSequentialGroup()
                                .addGap(10)
                                .addComponent(mainOptionsPanel, GroupLayout.DEFAULT_SIZE, 275, Short.MAX_VALUE))
                            .addGroup(gl_mainPanel.createSequentialGroup()
                                .addContainerGap()
                                .addComponent(argumentsPanel, GroupLayout.DEFAULT_SIZE, 275, Short.MAX_VALUE))
                            .addGroup(gl_mainPanel.createSequentialGroup()
                                .addContainerGap()
                                .addComponent(hookPanel, GroupLayout.DEFAULT_SIZE, 275, Short.MAX_VALUE)))
                        .addPreferredGap(ComponentPlacement.RELATED)
                        .addComponent(customOptionsPanel, GroupLayout.DEFAULT_SIZE, 269, Short.MAX_VALUE)))
                .addGap(13))
        );
        gl_mainPanel.setVerticalGroup(
            gl_mainPanel.createParallelGroup(Alignment.LEADING)
            .addGroup(gl_mainPanel.createSequentialGroup()
                .addGroup(gl_mainPanel.createParallelGroup(Alignment.LEADING)
                    .addGroup(gl_mainPanel.createSequentialGroup()
                        .addGap(10)
                        .addComponent(mainOptionsPanel, GroupLayout.DEFAULT_SIZE, 178, Short.MAX_VALUE)
                        .addGap(2)
                        .addComponent(argumentsPanel, GroupLayout.DEFAULT_SIZE, 81, Short.MAX_VALUE)
                        .addPreferredGap(ComponentPlacement.RELATED)
                        .addComponent(hookPanel, GroupLayout.DEFAULT_SIZE, 90, Short.MAX_VALUE))
                    .addGroup(gl_mainPanel.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(customOptionsPanel, GroupLayout.DEFAULT_SIZE, 357, Short.MAX_VALUE)))
                .addPreferredGap(ComponentPlacement.UNRELATED)
                .addComponent(statusPanel, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE)
                .addGap(5))
        );
        mainPanel.setLayout(gl_mainPanel);

        JButton btnAddHook = new JButton("Add Hook");
        btnAddHook.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                if (getHookWindowState()) {
                    hookHandler = new HookHandler(AngryGhidraProvider.this);
                    hookHandler.main();
                    setHookWindowState(false);
                } else {
                    hookHandler.toFront();
                }
            }
        });
        btnAddHook.setFont(new Font("SansSerif", Font.PLAIN, 11));

        GroupLayout gl_hookPanel = new GroupLayout(hookPanel);
        gl_hookPanel.setHorizontalGroup(
            gl_hookPanel.createParallelGroup(Alignment.LEADING)
                .addGroup(gl_hookPanel.createSequentialGroup()
                    .addContainerGap()
                    .addComponent(btnAddHook, GroupLayout.PREFERRED_SIZE, 105, Short.MAX_VALUE)
                    .addGap(43)
                    .addComponent(hookLablesPanel, GroupLayout.DEFAULT_SIZE, 105, Short.MAX_VALUE)
                    .addContainerGap())
        );
        gl_hookPanel.setVerticalGroup(
            gl_hookPanel.createParallelGroup(Alignment.TRAILING)
                .addGroup(gl_hookPanel.createSequentialGroup()
                    .addGroup(gl_hookPanel.createParallelGroup(Alignment.TRAILING)
                        .addGroup(Alignment.LEADING, gl_hookPanel.createSequentialGroup()
                            .addContainerGap()
                            .addComponent(btnAddHook))
                        .addGroup(gl_hookPanel.createSequentialGroup()
                            .addGap(10)
                            .addComponent(hookLablesPanel, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE)))
                    .addGap(34))
        );
        hookPanel.setLayout(gl_hookPanel);

        GridBagLayout gbl_hookLablesPanel = new GridBagLayout();
        gbl_hookLablesPanel.columnWidths = new int[] {0};
        gbl_hookLablesPanel.rowHeights = new int[] {0};
        gbl_hookLablesPanel.columnWeights = new double[] {Double.MIN_VALUE};
        gbl_hookLablesPanel.rowWeights = new double[] {Double.MIN_VALUE};
        hookLablesPanel.setLayout(gbl_hookLablesPanel);
        btnRun.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                statusLabel.setText(configuringString);
                statusLabelFound.setText("");
                setIsTerminated(false);
                angrProcessing.clearTraceList(false);
                JSONObject angr_options = new JSONObject();
                Boolean auto_load_libs = false;
                if (chckbxAutoLoadLibs.isSelected()) {
                    auto_load_libs = true;
                }
                angr_options.put("auto_load_libs", auto_load_libs);
                if (chckbxBlankState.isSelected()) {
                    if (!blankStateTF.getText().matches("0x[0-9A-Fa-f]+")) {
                        statusLabel.setForeground(Color.red);
                        statusLabel.setText("[–] Error: enter the correct blank state address value in hex format!");
                        return;
                    }
                    String blank_state = blankStateTF.getText();
                    angr_options.put("blank_state", blank_state);
                }
                if (!dstAddressTF.getText().matches("0x[0-9A-Fa-f]+")) {
                    statusLabel.setForeground(Color.red);
                    statusLabel.setText("[–] Error: enter the correct destination address in hex format!");
                    return;
                }
                String find_addr = dstAddressTF.getText();
                angr_options.put("find_address", find_addr);
                if (chckbxAvoidAddresses.isSelected()) {
                    if (!avoidTextArea.getText().replaceAll("\\s+", "").matches("[0x0-9a-fA-F, /,]+")) {
                        statusLabel.setForeground(Color.red);
                        statusLabel.setText("[–] Error: enter the correct avoid addresses in hex format separated by comma!");
                        return;
                    }
                    String avoid = avoidTextArea.getText().replaceAll("\\s+", "");
                    angr_options.put("avoid_address", avoid);
                }
                if (chckbxArg.isSelected()) {
                    if (!firstArgTF.getText().isEmpty()) {
                        JSONObject argDetails = new JSONObject();
                        int id = 1;
                        argDetails.put(String.valueOf(id++), firstArgTF.getText());
                        for (IntegerTextField itf : argsTF) {
                            String value = itf.getText();
                            if (!value.isEmpty()) {
                                argDetails.put(String.valueOf(id), value);
                            }
                            id++;
                        }
                        angr_options.put("arguments", argDetails);
                    }
                }
                if (!vectorAddressTF.getText().isEmpty() &&
                        !vectorLenTF.getText().isEmpty()) {
                    JSONObject vectorDetails = new JSONObject();
                    vectorDetails.put(vectorAddressTF.getText(), vectorLenTF.getText());
                    for (Entry<IntegerTextField, IntegerTextField> entry : vectors.entrySet()) {
                        String addr = entry.getKey().getText();
                        String len = entry.getValue().getText();
                        if (!addr.isEmpty() && !len.isEmpty()) {
                            vectorDetails.put(addr, len);
                        }
                    }
                    angr_options.put("vectors", vectorDetails);
                }
                if (!memStoreAddrTF.getText().isEmpty() && !memStoreValueTF.getText().isEmpty()) {
                    JSONObject storeDetails = new JSONObject();
                    storeDetails.put(memStoreAddrTF.getText(), memStoreValueTF.getText());
                    for (Entry<IntegerTextField, IntegerTextField> entry : memStore.entrySet()) {
                        String addr = entry.getKey().getText();
                        String val = entry.getValue().getText();
                        if (!addr.isEmpty() && !val.isEmpty()) {
                            storeDetails.put(addr, val);
                        }
                    }
                    angr_options.put("mem_store", storeDetails);
                }
                String reg1 = registerTF.getText();
                String val1 = valueTF.getText();
                if (symbolicVectorInputCheck(reg1, val1)) {
                    JSONObject regDetails = new JSONObject();
                    regDetails.put(reg1, val1);
                    for (Entry <JTextField, JTextField> entry : presetRegs.entrySet()) {
                        String reg = entry.getKey().getText();
                        String val = entry.getValue().getText();
                        if (symbolicVectorInputCheck(reg, val)) {
                            regDetails.put(reg, val);
                        }
                    }
                    angr_options.put("regs_vals", regDetails);
                }
                if (!hooks.isEmpty()) {
                    JSONArray hookList = new JSONArray();
                    for (Entry <String[], String[][]> entry: hooks.entrySet()) {
                        JSONObject hookDetails = new JSONObject();
                        String[] hookOptions = entry.getKey();
                        String hookAddress = hookOptions[0];
                        hookDetails.put("length", hookOptions[1]);
                        String[][] regs = entry.getValue();
                        for (int i = 0; i <regs[0].length; i++) {
                            if (regs[0][i] != null && regs[1][i] != null) {
                                hookDetails.put(regs[0][i], regs[1][i]);
                            }
                        }
                        JSONObject newHook = new JSONObject();
                        newHook.put(hookAddress, hookDetails);
                        hookList.put(newHook);
                    }
                    angr_options.put("hooks", hookList);
                }
                String binary_path = thisProgram.getExecutablePath();
                if (isWindows) {
                    binary_path = binary_path.replaceFirst("/", "");
                    binary_path = binary_path.replace("/", "\\");
                }
                angr_options.put("binary_file", binary_path);
                angr_options.put("base_address", "0x" + Long.toHexString(thisProgram.getMinAddress().getOffset()));
                if (thisProgram.getExecutableFormat().contains("Raw Binary")) {
                    String language = thisProgram.getLanguage().toString();
                    String arch = language.substring(0, language.indexOf("/"));
                    angr_options.put("raw_binary_arch", arch);
                }
                statusLabel.setForeground(Color.black);
                mainPanel.revalidate();
                File angrOptionsFile = new File(tmpDir + "angr_options.json");
                if (angrOptionsFile.exists()) {
                    angrOptionsFile.delete();
                }
                try {
                    FileWriter file = new FileWriter(tmpDir + "angr_options.json");
                    file.write(angr_options.toString());
                    file.flush();
                    file.close();
                } catch (Exception ex) {}
                angrProcessing.preparetoRun(angrOptionsFile);
            }
        });
    }

    private void resetState() {
        setIsTerminated(false);
        statusLabel.setText(configuringString);
        statusLabel.setForeground(Color.black);
        statusLabelFound.setText("");
        solutionTextArea.setText("");
        scrollSolutionTextArea.setVisible(false);
        chckbxAutoLoadLibs.setSelected(false);
        angrProcessing.setSolutionExternal(null);
        angrProcessing.clearTraceList(true);

        // Reset blank state address
        blankStateTF.setText("");
        chckbxBlankState.setSelected(false);
        Address blankStateAddress = addressStorage.getBlankStateAddress();
        if (blankStateAddress != null) {
            mColorService.resetColor(blankStateAddress);
            addressStorage.setBlankStateAddress(null);
        }

        // Reset find address
        dstAddressTF.setText("");
        Address dstAddress = addressStorage.getDestinationAddress();
        if (dstAddress != null) {
            mColorService.resetColor(dstAddress);
            addressStorage.setDestinationAddress(null);
        }

        // Reset avoid addresses mainPanel
        avoidTextArea.setText("");
        for (Address address : addressStorage.getAvoidAddresses()){
            mColorService.resetColor(address);
        }
        addressStorage.clearAvoidAddresses();
        chckbxAvoidAddresses.setSelected(false);
        scrollAvoidAddrsArea.setVisible(false);
        mainOptionsPanel.revalidate();

        // Reset arguments mainPanel
        guiArgNextId = 2;
        lbArgLen.setVisible(false);
        btnAddArg.setVisible(false);
        for (JButton btnDel: delBtnArgs) {
            argSetterPanel.remove(btnDel);
        }
        for (IntegerTextField argTF : argsTF) {
            argSetterPanel.remove(argTF.getComponent());
        }
        delBtnArgs.clear();
        argsTF.clear();
        firstArgTF.setText("");
        firstArgTF.getComponent().setVisible(false);
        chckbxArg.setSelected(false);
        argSetterPanel.repaint();
        argSetterPanel.revalidate();

        // Reset symbolic vectors in memory
        guiMemNextId = 2;
        vectorAddressTF.setText("");
        vectorLenTF.setText("");
        for (Entry<IntegerTextField, IntegerTextField> entry : vectors.entrySet()) {
            IntegerTextField addrTF = entry.getKey();
            IntegerTextField lenTF = entry.getValue();
            vectorsPanel.remove(addrTF.getComponent());
            vectorsPanel.remove(lenTF.getComponent());
        }
        for (JButton button : delMemBtns) {
            vectorsPanel.remove(button);
        }
        vectors.clear();
        delMemBtns.clear();
        vectorsPanel.repaint();
        vectorsPanel.revalidate();

        // Reset mem set contents
        guiStoreNextId = 2;
        for (Entry<IntegerTextField, IntegerTextField> entry : memStore.entrySet()) {
            IntegerTextField addrTF = entry.getKey();
            IntegerTextField valTF = entry.getValue();
            writeMemoryPanel.remove(addrTF.getComponent());
            writeMemoryPanel.remove(valTF.getComponent());
        }
        for (JButton button : delStoreBtns) {
            writeMemoryPanel.remove(button);
        }
        memStoreAddrTF.setText("");
        memStoreValueTF.setText("");
        memStore.clear();
        delStoreBtns.clear();
        writeMemoryPanel.repaint();
        writeMemoryPanel.revalidate();

        // Reset preset registers
        guiRegNextId = 2;
        for (Entry<JTextField, JTextField> entry : presetRegs.entrySet()) {
            JTextField regTF = entry.getKey();
            JTextField valTF = entry.getValue();
            regPanel.remove(regTF);
            regPanel.remove(valTF);
        }
        for (JButton button : delRegsBtns) {
            regPanel.remove(button);
        }
        registerTF.setText("");
        valueTF.setText("");
        delRegsBtns.clear();
        presetRegs.clear();
        regPanel.repaint();
        regPanel.revalidate();

        // Reset all hooks
        if (hookHandler != null) {
            hookHandler.requestClearHooks();
        }
        hooks.clear();
        for (JButton button : delHookBtns) {
            hookLablesPanel.remove(button);
        }
        for (JLabel label : lbHooks) {
            hookLablesPanel.remove(label);
        }
        lbHooks.clear();
        delHookBtns.clear();
        hookLablesPanel.repaint();
        hookLablesPanel.revalidate();
    }

    public boolean symbolicVectorInputCheck(String reg, String value) {
        return !reg.isEmpty() && !value.isEmpty() && (value.matches("0x[0-9A-Fa-f]+") ||
                value.matches("[0-9]+") || value.contains("sv"));
    }

    public JTextField getFindAddressTF() {
        return dstAddressTF;
    }

    public JTextField getBSAddressTF() {
        return blankStateTF;
    }

    public JTextArea getTextArea() {
        return avoidTextArea;
    }

    public JCheckBox getCBBlankState() {
        return chckbxBlankState;
    }

    public JCheckBox getCBAvoidAddresses() {
        return chckbxAvoidAddresses;
    }

    public JPanel getWriteMemoryPanel() {
        return writeMemoryPanel;
    }

    public JPanel getHookLablesPanel() {
        return hookLablesPanel;
    }

    public int getGuiStoreCounter() {
        return guiStoreNextId;
    }

    public void setGuiStoreCounter(int value) {
        guiStoreNextId = value;
    }

    public IntegerTextField getStoreAddressTF() {
        return memStoreAddrTF;
    }

    public IntegerTextField getStoreValueTF() {
        return memStoreValueTF;
    }

    public void putIntoMemStore(IntegerTextField tf1, IntegerTextField tf2) {
        memStore.put(tf1, tf2);
    }

    public void removeFromMemStore(IntegerTextField tf1, IntegerTextField tf2) {
        memStore.remove(tf1, tf2);
    }

    public void putIntoDelStoreBtns(JButton button) {
        delStoreBtns.add(button);
    }

    public void removeFromDelStoreBtns(JButton button) {
        delStoreBtns.remove(button);
    }

    public void putIntoDelHookBtns(JButton button) {
        delHookBtns.add(button);
    }

    public void removeFromDelHookBtns(JButton button) {
        delHookBtns.remove(button);
    }

    public ImageIcon getDeleteIcon() {
        return deleteIcon;
    }

    public ImageIcon getAddIcon() {
        return addIcon;
    }

    public void putIntoHooks(String[] options, String[][] regs) {
        hooks.put(options, regs);
    }

    public void removeFromHooks(String[] options, String[][] regs) {
        hooks.remove(options, regs);
    }

    public void putIntoLbHooks(JLabel label) {
        lbHooks.add(label);
    }

    public void removeFromLbHooks(JLabel label) {
        lbHooks.remove(label);
    }

    public Boolean getIsTerminated() {
        return isTerminated;
    }

    public void setIsTerminated(Boolean value) {
        isTerminated = value;
    }

    public JLabel getStatusLabel() {
        return statusLabel;
    }

    public JLabel getStatusLabelFound() {
        return statusLabelFound;
    }

    public JScrollPane getScrollSolutionTextArea() {
        return scrollSolutionTextArea;
    }

    public JTextArea getSolutionTextArea() {
        return solutionTextArea;
    }

    public void setProgram(Program program) {
        if (program != null) {
            thisProgram = program;
        }
    }

    public void setHookWindowState(boolean value) {
        isHookWindowClosed = value;
    }

    public boolean getHookWindowState() {
        return isHookWindowClosed;
    }

    @Override
    public JComponent getComponent() {
        return mainPanel;
    }
}

```

`src/main/java/angryghidra/HookHandler.java`:

```java
package angryghidra;

import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.Font;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.Insets;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Map.Entry;
import javax.swing.GroupLayout;
import javax.swing.GroupLayout.Alignment;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.LayoutStyle.ComponentPlacement;
import javax.swing.WindowConstants;
import javax.swing.border.Border;
import docking.widgets.textfield.IntegerTextField;
import resources.ResourceManager;

public class HookHandler {
    private AngryGhidraProvider mProvider;
    private int hookNextId;
    private int hookRegNextId;
    private JFrame frame;
    private JPanel regPanel;
    private IntegerTextField addressTF;
    private JTextField hookRegTF;
    private JTextField hookValTF;
    private HashMap <JTextField, JTextField> regsVals;
    private ArrayList <JButton> delButtons;
    private IntegerTextField lengthTF;

    public HookHandler(AngryGhidraProvider provider) {
        mProvider = provider;
    }

    public void main() {
        EventQueue.invokeLater(new Runnable() {
            public void run() {
                try {
                    showWindow();
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        });
    }

    private void showWindow() {
        setFields();
        initializeGui();
        frame.setVisible(true);
    }

    private void setFields() {
        hookNextId = 2;
        hookRegNextId = 2;
        delButtons = new ArrayList <JButton>();
        regsVals = new HashMap<>();
    }

    private void initializeGui() {
        frame = new JFrame();
        frame.getContentPane().setMinimumSize(new Dimension(500, 333));
        frame.setTitle("Add hook");
        frame.setMinimumSize(new Dimension(500, 333));
        frame.setLocationRelativeTo(null);
        frame.setDefaultCloseOperation(WindowConstants.DISPOSE_ON_CLOSE);
        frame.setIconImage(ResourceManager.loadImage("images/ico.png").getImage());
        frame.addWindowListener(new WindowAdapter() {
            @Override
            public void windowClosing(WindowEvent e) {
                mProvider.setHookWindowState(true);
            }
        });

        addressTF = new IntegerTextField();
        Border border = addressTF.getComponent().getBorder();
        addressTF.setHexMode();
        GridBagConstraints gbc_addressTF = new GridBagConstraints();
        gbc_addressTF.anchor = GridBagConstraints.CENTER;
        gbc_addressTF.fill = GridBagConstraints.HORIZONTAL;
        gbc_addressTF.gridx = 0;
        gbc_addressTF.gridy = 1;

        Font sansSerif = new Font("SansSerif", Font.PLAIN, 12);
        JPanel hookLablesPanel = mProvider.getHookLablesPanel();
        JButton btnCreate = new JButton("Add");
        btnCreate.setFont(sansSerif);
        btnCreate.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                if (!addressTF.getText().isEmpty() && !lengthTF.getText().isEmpty()) {
                    String[] options = new String[2];
                    options[0] = addressTF.getText();
                    options[1] = lengthTF.getText();
                    String[][] regs = new String[2][regsVals.size() + 1];

                    String reg1 = hookRegTF.getText();
                    String val1 = hookValTF.getText();
                    int id = 0;
                    if (mProvider.symbolicVectorInputCheck(reg1, val1)) {
                        regs[0][id] = reg1;
                        regs[1][id++] = val1;
                        for (Entry<JTextField, JTextField> entry : regsVals.entrySet()) {
                            String reg = entry.getKey().getText();
                            String val = entry.getValue().getText();
                            if (mProvider.symbolicVectorInputCheck(reg, val)) {
                                regs[0][id] = reg;
                                regs[1][id] = val;
                            }
                            id++;
                        }
                        mProvider.putIntoHooks(options, regs);
                        JLabel lbHook = new JLabel("Hook at " + addressTF.getText());
                        lbHook.setFont(sansSerif);
                        GridBagConstraints gbc_lbHook = new GridBagConstraints();
                        gbc_lbHook.fill = GridBagConstraints.HORIZONTAL;
                        gbc_lbHook.anchor = GridBagConstraints.CENTER;
                        gbc_lbHook.gridwidth = 3;
                        gbc_lbHook.gridx = 1;
                        gbc_lbHook.insets = new Insets(0, 0, 0, 5);
                        gbc_lbHook.gridy = hookNextId;
                        gbc_lbHook.weightx = 1;
                        gbc_lbHook.weighty = 0.1;
                        hookLablesPanel.add(lbHook, gbc_lbHook);
                        mProvider.putIntoLbHooks(lbHook);

                        JButton btnDel = new JButton("");
                        btnDel.setBorder(null);
                        btnDel.setContentAreaFilled(false);
                        btnDel.setIcon(mProvider.getDeleteIcon());
                        GridBagConstraints gbc_btnDel = new GridBagConstraints();
                        gbc_btnDel.insets = new Insets(0, 0, 0, 5);
                        gbc_btnDel.fill = GridBagConstraints.HORIZONTAL;
                        gbc_btnDel.anchor = GridBagConstraints.CENTER;
                        gbc_btnDel.gridx = 0;
                        gbc_btnDel.gridy = hookNextId++;
                        gbc_btnDel.weighty = 0.1;
                        hookLablesPanel.add(btnDel, gbc_btnDel);
                        mProvider.putIntoDelHookBtns(btnDel);
                        btnDel.addActionListener(new ActionListener() {
                            public void actionPerformed(ActionEvent actionEvent) {
                                hookNextId--;
                                mProvider.removeFromHooks(options, regs);
                                mProvider.removeFromDelHookBtns(btnDel);
                                mProvider.removeFromLbHooks(lbHook);
                                hookLablesPanel.remove(lbHook);
                                hookLablesPanel.remove(btnDel);
                                hookLablesPanel.repaint();
                                hookLablesPanel.revalidate();
                            }
                        });
                        hookLablesPanel.repaint();
                        hookLablesPanel.revalidate();
                    }
                }
            }
        });
        JLabel lbRegisters = new JLabel(mProvider.htmlString);
        lbRegisters.setFont(sansSerif);

        regPanel = new JPanel();
        GridBagLayout gbl_regPanel = new GridBagLayout();
        gbl_regPanel.columnWidths = new int[]{0, 0, 0, 0, 0, 0};
        gbl_regPanel.rowHeights = new int[]{0, 0, 0};
        gbl_regPanel.columnWeights = new double[]{0.0, 0.0, 0.0, 0.0, 0.0, Double.MIN_VALUE};
        gbl_regPanel.rowWeights = new double[]{0.0, 0.0, Double.MIN_VALUE};
        regPanel.setLayout(gbl_regPanel);

        JLabel lblReg = new JLabel("Register");
        lblReg.setFont(sansSerif);
        GridBagConstraints gbc_lblReg = new GridBagConstraints();
        gbc_lblReg.anchor = GridBagConstraints.SOUTH;
        gbc_lblReg.insets = new Insets(0, 0, 0, 5);
        gbc_lblReg.gridx = 1;
        gbc_lblReg.gridy = 0;
        gbc_lblReg.weightx = 1;
        regPanel.add(lblReg, gbc_lblReg);

        JLabel lblValue = new JLabel("  Value ");
        lblValue.setFont(sansSerif);
        GridBagConstraints gbc_lblValue = new GridBagConstraints();
        gbc_lblValue.anchor = GridBagConstraints.SOUTH;
        gbc_lblValue.insets = new Insets(0, 0, 0, 5);
        gbc_lblValue.gridx = 3;
        gbc_lblValue.gridy = 0;
        gbc_lblValue.weightx = 1;
        regPanel.add(lblValue, gbc_lblValue);

        JButton btnAddButton = new JButton("");
        GridBagConstraints gbc_btnAddButton = new GridBagConstraints();
        gbc_btnAddButton.anchor = GridBagConstraints.CENTER;
        gbc_btnAddButton.fill = GridBagConstraints.HORIZONTAL;
        gbc_btnAddButton.insets = new Insets(0, 0, 0, 5);
        gbc_btnAddButton.gridx = 0;
        gbc_btnAddButton.gridy = 1;
        gbc_btnAddButton.weighty = 0.1;
        regPanel.add(btnAddButton, gbc_btnAddButton);
        btnAddButton.setBorder(null);
        btnAddButton.setContentAreaFilled(false);
        btnAddButton.setIcon(mProvider.getAddIcon());

        hookRegTF = new JTextField();
        hookRegTF.setBorder(border);
        hookRegTF.setColumns(5);
        GridBagConstraints gbc_TFReg1 = new GridBagConstraints();
        gbc_TFReg1.anchor = GridBagConstraints.CENTER;
        gbc_TFReg1.fill = GridBagConstraints.HORIZONTAL;
        gbc_TFReg1.insets = new Insets(0, 0, 0, 5);
        gbc_TFReg1.gridx = 1;
        gbc_TFReg1.gridy = 1;
        gbc_TFReg1.weighty = 0.1;
        regPanel.add(hookRegTF, gbc_TFReg1);
        hookRegTF.setBorder(border);

        hookValTF = new JTextField();
        hookValTF.setBorder(border);
        hookValTF.setColumns(5);
        GridBagConstraints gbc_TFVal1 = new GridBagConstraints();
        gbc_TFVal1.insets = new Insets(0, 0, 0, 5);
        gbc_TFVal1.anchor = GridBagConstraints.CENTER;
        gbc_TFVal1.fill = GridBagConstraints.HORIZONTAL;
        gbc_TFVal1.gridx = 3;
        gbc_TFVal1.gridy = 1;
        gbc_TFVal1.weightx = 1;
        gbc_TFVal1.weighty = 0.1;
        regPanel.add(hookValTF, gbc_TFVal1);

        btnAddButton.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                JTextField regTF = new JTextField();
                regTF.setBorder(border);
                regTF.setColumns(5);
                GridBagConstraints gbc_TFReg = new GridBagConstraints();
                gbc_TFReg.fill = GridBagConstraints.HORIZONTAL;
                gbc_TFReg.anchor = GridBagConstraints.CENTER;
                gbc_TFReg.gridx = 1;
                gbc_TFReg.insets = new Insets(0, 0, 0, 5);
                gbc_TFReg.gridy = hookRegNextId;
                gbc_TFReg.weightx = 1;
                gbc_TFReg.weighty = 0.1;
                regPanel.add(regTF, gbc_TFReg);

                JTextField valTF = new JTextField();
                valTF.setColumns(5);
                valTF.setBorder(border);
                GridBagConstraints gbc_TFVal = new GridBagConstraints();
                gbc_TFVal.fill = GridBagConstraints.HORIZONTAL;
                gbc_TFVal.anchor = GridBagConstraints.CENTER;
                gbc_TFVal.insets = new Insets(0, 0, 0, 5);
                gbc_TFVal.gridx = 3;
                gbc_TFVal.gridy = hookRegNextId;
                gbc_TFVal.weightx = 1;
                gbc_TFVal.weighty = 0.1;
                regPanel.add(valTF, gbc_TFVal);
                regsVals.put(regTF, valTF);

                JButton btnDel = new JButton("");
                btnDel.setBorder(null);
                btnDel.setContentAreaFilled(false);
                btnDel.setIcon(mProvider.getDeleteIcon());
                GridBagConstraints gbc_btnDel = new GridBagConstraints();
                gbc_btnDel.insets = new Insets(0, 0, 0, 5);
                gbc_btnDel.fill = GridBagConstraints.HORIZONTAL;
                gbc_btnDel.anchor = GridBagConstraints.CENTER;
                gbc_btnDel.gridx = 0;
                gbc_btnDel.gridy = hookRegNextId++;
                gbc_btnDel.weighty = 0.1;
                regPanel.add(btnDel, gbc_btnDel);
                delButtons.add(btnDel);
                btnDel.addActionListener(new ActionListener() {
                    public void actionPerformed(ActionEvent actionEvent) {
                        hookRegNextId--;
                        delButtons.remove(btnDel);
                        regsVals.remove(regTF, valTF);
                        regPanel.remove(regTF);
                        regPanel.remove(valTF);
                        regPanel.remove(btnDel);
                        regPanel.repaint();
                        regPanel.revalidate();
                        frame.setSize(frame.getWidth(), frame.getHeight() - 25);
                    }
                });
                regPanel.repaint();
                regPanel.revalidate();
                frame.setSize(frame.getWidth(), frame.getHeight() + 25);
            }
        });

        JPanel AddrPanel = new JPanel();
        GroupLayout groupLayout = new GroupLayout(frame.getContentPane());
        groupLayout.setHorizontalGroup(
            groupLayout.createParallelGroup(Alignment.TRAILING)
                .addGroup(groupLayout.createSequentialGroup()
                    .addGap(18)
                    .addComponent(AddrPanel, GroupLayout.DEFAULT_SIZE, 129, Short.MAX_VALUE)
                    .addGap(39)
                    .addGroup(groupLayout.createParallelGroup(Alignment.LEADING)
                        .addComponent(regPanel, GroupLayout.DEFAULT_SIZE, 238, Short.MAX_VALUE)
                        .addComponent(lbRegisters, GroupLayout.DEFAULT_SIZE, 238, Short.MAX_VALUE))
                    .addContainerGap())
                .addGroup(groupLayout.createSequentialGroup()
                    .addGap(129)
                    .addComponent(btnCreate, GroupLayout.DEFAULT_SIZE, 184, Short.MAX_VALUE)
                    .addGap(121))
        );
        groupLayout.setVerticalGroup(
            groupLayout.createParallelGroup(Alignment.LEADING)
                .addGroup(groupLayout.createSequentialGroup()
                    .addGap(20)
                    .addGroup(groupLayout.createParallelGroup(Alignment.LEADING, false)
                        .addGroup(groupLayout.createSequentialGroup()
                            .addComponent(lbRegisters, GroupLayout.PREFERRED_SIZE, 47, GroupLayout.PREFERRED_SIZE)
                            .addPreferredGap(ComponentPlacement.UNRELATED)
                            .addComponent(regPanel, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE))
                        .addComponent(AddrPanel, 0, 0, Short.MAX_VALUE))
                    .addPreferredGap(ComponentPlacement.RELATED, 130, Short.MAX_VALUE)
                    .addComponent(btnCreate)
                    .addGap(27))
        );
        GridBagLayout gbl_AddrPanel = new GridBagLayout();
        gbl_AddrPanel.columnWidths = new int[]{0, 0};
        gbl_AddrPanel.rowHeights = new int[]{0, 0, 0, 0, 0};
        gbl_AddrPanel.columnWeights = new double[]{1.0, Double.MIN_VALUE};
        gbl_AddrPanel.rowWeights = new double[]{0.0, 0.0, 0.0, 0.0, Double.MIN_VALUE};
        AddrPanel.setLayout(gbl_AddrPanel);

        JLabel lbAddress = new JLabel("Hook address:");
        lbAddress.setFont(sansSerif);
        GridBagConstraints gbc_lbAddress = new GridBagConstraints();
        gbc_lbAddress.anchor = GridBagConstraints.SOUTH;
        gbc_lbAddress.insets = new Insets(0, 0, 5, 5);
        gbc_lbAddress.gridx = 0;
        gbc_lbAddress.gridy = 0;
        AddrPanel.add(lbAddress, gbc_lbAddress);

        addressTF = new IntegerTextField();
        addressTF.setHexMode();
        GridBagConstraints gbc_AddrPanel = new GridBagConstraints();
        gbc_AddrPanel.fill = GridBagConstraints.HORIZONTAL;
        gbc_AddrPanel.gridx = 0;
        gbc_AddrPanel.gridy = 1;
        AddrPanel.add(addressTF.getComponent(), gbc_AddrPanel);

        JLabel lblHookLength = new JLabel("Hook length:");
        lblHookLength.setFont(sansSerif);
        GridBagConstraints gbc_lblHookLength = new GridBagConstraints();
        gbc_lblHookLength.anchor = GridBagConstraints.SOUTH;
        gbc_lblHookLength.insets = new Insets(0, 0, 5, 5);
        gbc_lblHookLength.gridx = 0;
        gbc_lblHookLength.gridy = 2;
        AddrPanel.add(lblHookLength, gbc_lblHookLength);

        lengthTF = new IntegerTextField();
        lengthTF.setDecimalMode();
        GridBagConstraints gbc_lengthTF = new GridBagConstraints();
        gbc_lengthTF.fill = GridBagConstraints.HORIZONTAL;
        gbc_lengthTF.gridx = 0;
        gbc_lengthTF.gridy = 3;
        AddrPanel.add(lengthTF.getComponent(), gbc_lengthTF);
        frame.getContentPane().setLayout(groupLayout);
    }

    public void requestClearHooks() {
        hookNextId = 2;
        hookRegNextId = 2;
        if (regPanel == null) {
            return;
        }
        if (delButtons != null){
            for (JButton button : delButtons) {
                regPanel.remove(button);
            }
            delButtons.clear();
        }
        if (regsVals != null){
            for (Entry<JTextField, JTextField> entry : regsVals.entrySet()) {
                regPanel.remove(entry.getKey());
                regPanel.remove(entry.getValue());
            }
            regsVals.clear();
        }
        regPanel.repaint();
        regPanel.revalidate();
    }

    public void toFront() {
        frame.toFront();
    }
}

```

`src/main/java/angryghidra/LocalColorizingService.java`:

```java
package angryghidra;

import java.awt.Color;
import ghidra.framework.plugintool.PluginTool;
import ghidra.program.model.address.Address;
import ghidra.program.model.listing.Program;
import ghidra.app.plugin.core.colorizer.ColorizingService;

public class LocalColorizingService {
    private ColorizingService mCService;
    private Program mProgram;

    public LocalColorizingService(PluginTool tool, Program program) {
        mCService = tool.getService(ColorizingService.class);
        mProgram = program;
    }

    public void resetColor(Address address) {
        int TransactionID = mProgram.startTransaction("resetColor");
        mCService.clearBackgroundColor(address, address);
        mProgram.endTransaction(TransactionID, true);
    }

    public void setColor(Address address, Color color) {
        int TransactionID = mProgram.startTransaction("setColor");
        mCService.setBackgroundColor(address, address, color);
        mProgram.endTransaction(TransactionID, true);
    }
}

```

`src/main/java/angryghidra/UserAddressStorage.java`:

```java
package angryghidra;

import java.util.ArrayList;
import java.util.List;
import ghidra.program.model.address.Address;

public class UserAddressStorage {
    private Address currentDestAddr;
    private Address currentBlankStateAddr;
    private List <Address> currentAvoidAddresses;

    public UserAddressStorage() {
        currentDestAddr = null;
        currentBlankStateAddr = null;
        currentAvoidAddresses = new ArrayList <Address>();
    }

    public Address getDestinationAddress() {
        return currentDestAddr;
    }

    public Address getBlankStateAddress() {
        return currentBlankStateAddr;
    }

    public List <Address> getAvoidAddresses() {
        return currentAvoidAddresses;
    }

    public Address getAvoidAddress(int index) {
        return currentAvoidAddresses.get(index);
    }

    public void setDestinationAddress(Address address) {
        currentDestAddr = address;
    }

    public void setBlankStateAddress(Address address) {
        currentBlankStateAddr = address;
    }

    public void setAvoidAddresses(List <Address> addresses) {
        currentAvoidAddresses = addresses;
    }

    public void addAvoidAddress(Address address) {
        currentAvoidAddresses.add(address);
    }

    public void removeAvoidAddress(Address address) {
        currentAvoidAddresses.remove(address);
    }

    public void removeAvoidAddress(int index) {
        currentAvoidAddresses.remove(index);
    }

    public void clearAvoidAddresses() {
        currentAvoidAddresses.clear();
    }
}

```