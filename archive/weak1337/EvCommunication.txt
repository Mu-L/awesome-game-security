Project Path: arc_weak1337_EvCommunication_nr_yas6d

Source Tree:

```txt
arc_weak1337_EvCommunication_nr_yas6d
├── Driver
│   └── Driver
│       ├── Driver.cpp
│       ├── Driver.inf
│       ├── Driver.vcxproj
│       ├── Driver.vcxproj.filters
│       ├── hook.cpp
│       ├── hook.h
│       ├── includes.h
│       ├── mem.cpp
│       ├── mem.h
│       ├── nt.cpp
│       └── nt.h
├── EventCommunication.sln
├── README.md
└── User
    ├── User.vcxproj
    ├── User.vcxproj.filters
    ├── User.vcxproj.user
    └── main.cpp

```

`Driver/Driver/Driver.cpp`:

```cpp
#include "includes.h"
Hook NtTokenManager;

struct Info {
	DWORD type;
};

void handler(uintptr_t user_paramter) {
	DbgPrint("Hook got called\n");
	NtTokenManager.hook_undo();

	uintptr_t address_of_buffer = user_paramter;
	Info* info = (Info*)address_of_buffer;

	WCHAR user_event[0xFF] = L"\\BaseNamedObjects\\Global\\bruhmomentumuser";
	WCHAR kernel_event[0xFF] = L"\\BaseNamedObjects\\Global\\bruhmomentumkernel";
	NTSTATUS status;
	//
	UNICODE_STRING event_user;
	RtlInitUnicodeString(&event_user, user_event);
	HANDLE handle_to_user_event;
	OBJECT_ATTRIBUTES ObjectAttributes;
	InitializeObjectAttributes(&ObjectAttributes, &event_user, OBJ_CASE_INSENSITIVE | OBJ_KERNEL_HANDLE, NULL,0);
	status= ZwOpenEvent(&handle_to_user_event, EVENT_ALL_ACCESS, &ObjectAttributes);
	//
	UNICODE_STRING event_kernel;
	RtlInitUnicodeString(&event_kernel, kernel_event);
	HANDLE handle_to_kernel_event;
	OBJECT_ATTRIBUTES ObjectAttributes2;
	InitializeObjectAttributes(&ObjectAttributes2, &event_kernel, OBJ_CASE_INSENSITIVE | OBJ_KERNEL_HANDLE, NULL, 0);
	status = ZwOpenEvent(&handle_to_kernel_event, EVENT_ALL_ACCESS, &ObjectAttributes2);
	//

	LONG last;
	ZwSetEvent(handle_to_kernel_event, &last); //Signal usermode we are done
	
	LARGE_INTEGER Timeout;
	Timeout.QuadPart = (-60 * 3) * 1000 * 1000 * 10;
	bool terminate = false;
	while (!terminate)
	{
		
		status = ZwWaitForSingleObject(handle_to_user_event, TRUE, &Timeout); //Wait for SetEvent(user_event_handle)
		if (status == STATUS_TIMEOUT || status == STATUS_ALERTED)
		{
			terminate = true;
			break;
		}
		DbgPrint("Communication got called with param: %x\n", info->type);
		if (!NT_SUCCESS(ZwSetEvent(handle_to_kernel_event, &last))) { //Signal usermode -> operation done
			terminate = true;
		}
	}
}

NTSTATUS DriverEntry(){
	uintptr_t base;
	size_t size;
	NTSTATUS status;
	if (!NT_SUCCESS(status = nt::find_kernel_module("dxgkrnl.sys", &base, &size)))
		return status;
	uintptr_t function_address;
	if (!NT_SUCCESS(status = nt::find_export(base, "NtTokenManagerCreateFlipObjectReturnTokenHandle", &function_address)))
		return status;
	DbgPrint("Found NtTokenManagerCreateFlipObjectReturnTokenHandle at %p\n", function_address);
	NtTokenManager.initialize(function_address, (uintptr_t)&handler);
	NtTokenManager.hook_do();
	return STATUS_SUCCESS;
}

NTSTATUS fake_entry(PDRIVER_OBJECT driver, PUNICODE_STRING registryPath) {
	return DriverEntry();
}


```

`Driver/Driver/Driver.inf`:

```inf
;
; Driver.inf
;

[Version]
Signature="$WINDOWS NT$"
Class=Sample ; TODO: edit Class
ClassGuid={78A1C341-4539-11d3-B88D-00C04FAD5171} ; TODO: edit ClassGuid
Provider=%ManufacturerName%
CatalogFile=Driver.cat
DriverVer= ; TODO: set DriverVer in stampinf property pages

[DestinationDirs]
DefaultDestDir = 12
Driver_Device_CoInstaller_CopyFiles = 11

; ================= Class section =====================

[ClassInstall32]
Addreg=SampleClassReg

[SampleClassReg]
HKR,,,0,%ClassName%
HKR,,Icon,,-5

[SourceDisksNames]
1 = %DiskName%,,,""

[SourceDisksFiles]
Driver.sys  = 1,,
WdfCoInstaller$KMDFCOINSTALLERVERSION$.dll=1 ; make sure the number matches with SourceDisksNames

;*****************************************
; Install Section
;*****************************************

[Manufacturer]
%ManufacturerName%=Standard,NT$ARCH$

[Standard.NT$ARCH$]
%Driver.DeviceDesc%=Driver_Device, Root\Driver ; TODO: edit hw-id

[Driver_Device.NT]
CopyFiles=Drivers_Dir

[Drivers_Dir]
Driver.sys

;-------------- Service installation
[Driver_Device.NT.Services]
AddService = Driver,%SPSVCINST_ASSOCSERVICE%, Driver_Service_Inst

; -------------- Driver driver install sections
[Driver_Service_Inst]
DisplayName    = %Driver.SVCDESC%
ServiceType    = 1               ; SERVICE_KERNEL_DRIVER
StartType      = 3               ; SERVICE_DEMAND_START
ErrorControl   = 1               ; SERVICE_ERROR_NORMAL
ServiceBinary  = %12%\Driver.sys

;
;--- Driver_Device Coinstaller installation ------
;

[Driver_Device.NT.CoInstallers]
AddReg=Driver_Device_CoInstaller_AddReg
CopyFiles=Driver_Device_CoInstaller_CopyFiles

[Driver_Device_CoInstaller_AddReg]
HKR,,CoInstallers32,0x00010000, "WdfCoInstaller$KMDFCOINSTALLERVERSION$.dll,WdfCoInstaller"

[Driver_Device_CoInstaller_CopyFiles]
WdfCoInstaller$KMDFCOINSTALLERVERSION$.dll

[Driver_Device.NT.Wdf]
KmdfService =  Driver, Driver_wdfsect
[Driver_wdfsect]
KmdfLibraryVersion = $KMDFVERSION$

[Strings]
SPSVCINST_ASSOCSERVICE= 0x00000002
ManufacturerName="<Your manufacturer name>" ;TODO: Replace with your manufacturer name
ClassName="Samples" ; TODO: edit ClassName
DiskName = "Driver Installation Disk"
Driver.DeviceDesc = "Driver Device"
Driver.SVCDESC = "Driver Service"

```

`Driver/Driver/Driver.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="12.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Debug|Win32">
      <Configuration>Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|Win32">
      <Configuration>Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|x64">
      <Configuration>Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|ARM">
      <Configuration>Debug</Configuration>
      <Platform>ARM</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|ARM">
      <Configuration>Release</Configuration>
      <Platform>ARM</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|ARM64">
      <Configuration>Debug</Configuration>
      <Platform>ARM64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|ARM64">
      <Configuration>Release</Configuration>
      <Platform>ARM64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <ProjectGuid>{71AF30DA-F5FA-4C1B-902E-89D94589D80E}</ProjectGuid>
    <TemplateGuid>{1bc93793-694f-48fe-9372-81e2b05556fd}</TemplateGuid>
    <TargetFrameworkVersion>v4.5</TargetFrameworkVersion>
    <MinimumVisualStudioVersion>12.0</MinimumVisualStudioVersion>
    <Configuration>Debug</Configuration>
    <Platform Condition="'$(Platform)' == ''">Win32</Platform>
    <RootNamespace>Driver</RootNamespace>
    <WindowsTargetPlatformVersion>$(LatestTargetPlatformVersion)</WindowsTargetPlatformVersion>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
    <SpectreMitigation>false</SpectreMitigation>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM64'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM64'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="ExtensionSettings">
  </ImportGroup>
  <ImportGroup Label="PropertySheets">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <PropertyGroup Label="UserMacros" />
  <PropertyGroup />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
    <ReferencePath>$(VC_ReferencesPath_x64);</ReferencePath>
    <IncludePath>$(VC_IncludePath);$(IncludePath)</IncludePath>
    <EnableInf2cat>false</EnableInf2cat>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <ClCompile>
      <LanguageStandard>stdcpp17</LanguageStandard>
      <WarningLevel>TurnOffAllWarnings</WarningLevel>
      <TreatWarningAsError>false</TreatWarningAsError>
      <BufferSecurityCheck>false</BufferSecurityCheck>
    </ClCompile>
    <Link>
      <EntryPointSymbol>fake_entry</EntryPointSymbol>
    </Link>
  </ItemDefinitionGroup>
  <ItemGroup>
    <Inf Include="Driver.inf" />
  </ItemGroup>
  <ItemGroup>
    <FilesToPackage Include="$(TargetPath)" />
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="Driver.cpp" />
    <ClCompile Include="hook.cpp" />
    <ClCompile Include="mem.cpp" />
    <ClCompile Include="nt.cpp" />
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="hook.h" />
    <ClInclude Include="includes.h" />
    <ClInclude Include="mem.h" />
    <ClInclude Include="nt.h" />
  </ItemGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <ImportGroup Label="ExtensionTargets">
  </ImportGroup>
</Project>
```

`Driver/Driver/Driver.vcxproj.filters`:

```filters
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <Filter Include="Source Files">
      <UniqueIdentifier>{4FC737F1-C7A5-4376-A066-2A32D752A2FF}</UniqueIdentifier>
      <Extensions>cpp;c;cc;cxx;def;odl;idl;hpj;bat;asm;asmx</Extensions>
    </Filter>
    <Filter Include="Header Files">
      <UniqueIdentifier>{93995380-89BD-4b04-88EB-625FBE52EBFB}</UniqueIdentifier>
      <Extensions>h;hpp;hxx;hm;inl;inc;xsd</Extensions>
    </Filter>
    <Filter Include="Resource Files">
      <UniqueIdentifier>{67DA6AB6-F800-4c08-8B7A-83BB121AAD01}</UniqueIdentifier>
      <Extensions>rc;ico;cur;bmp;dlg;rc2;rct;bin;rgs;gif;jpg;jpeg;jpe;resx;tiff;tif;png;wav;mfcribbon-ms</Extensions>
    </Filter>
    <Filter Include="Driver Files">
      <UniqueIdentifier>{8E41214B-6785-4CFE-B992-037D68949A14}</UniqueIdentifier>
      <Extensions>inf;inv;inx;mof;mc;</Extensions>
    </Filter>
    <Filter Include="Header Files\nt">
      <UniqueIdentifier>{e0e03659-86b2-4730-81db-641192c87d57}</UniqueIdentifier>
    </Filter>
    <Filter Include="Header Files\hook">
      <UniqueIdentifier>{0d1b03ef-0ead-4bb0-93cd-45c79a1d561a}</UniqueIdentifier>
    </Filter>
    <Filter Include="Header Files\memory">
      <UniqueIdentifier>{2b5b4b99-cfe2-41db-99cc-2916201aca51}</UniqueIdentifier>
    </Filter>
  </ItemGroup>
  <ItemGroup>
    <Inf Include="Driver.inf">
      <Filter>Driver Files</Filter>
    </Inf>
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="Driver.cpp">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="nt.cpp">
      <Filter>Header Files\nt</Filter>
    </ClCompile>
    <ClCompile Include="hook.cpp">
      <Filter>Header Files\hook</Filter>
    </ClCompile>
    <ClCompile Include="mem.cpp">
      <Filter>Header Files\memory</Filter>
    </ClCompile>
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="includes.h">
      <Filter>Header Files</Filter>
    </ClInclude>
    <ClInclude Include="nt.h">
      <Filter>Header Files\nt</Filter>
    </ClInclude>
    <ClInclude Include="hook.h">
      <Filter>Header Files\hook</Filter>
    </ClInclude>
    <ClInclude Include="mem.h">
      <Filter>Header Files\memory</Filter>
    </ClInclude>
  </ItemGroup>
</Project>
```

`Driver/Driver/hook.cpp`:

```cpp
#include "includes.h"


void Hook::initialize(uintptr_t to_hook, uintptr_t handler) {
	this->address_original = to_hook;
	this->address_handler = handler;
	memcpy((void*)this->original, (void*)to_hook, sizeof(this->original));
	*(uintptr_t*)(&this->jmp[2]) = this->address_handler;
}
void Hook::hook_do() {
	mem::write_ro(this->address_original, (uintptr_t)this->jmp, sizeof(this->jmp));
	DbgPrint("Function hooked\n");
}
void Hook::hook_undo() {
	mem::write_ro(this->address_original, (uintptr_t)this->original, sizeof(this->original));
	DbgPrint("Function unhooked\n");
}
```

`Driver/Driver/hook.h`:

```h
class Hook {
private:
	uintptr_t address_original;
	uintptr_t address_handler;
	BYTE original[12];
	BYTE jmp[12] = { 0x48, 0xB8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xE0 };
public:
	void initialize(uintptr_t to_hook, uintptr_t handler);
	void hook_do();
	void hook_undo();

};
```

`Driver/Driver/includes.h`:

```h
#include <ntifs.h>
#include <windef.h>
#include <cstdint>
#include <intrin.h>
#include "nt.h"
#include "mem.h"
#include "hook.h"
```

`Driver/Driver/mem.cpp`:

```cpp
#include "includes.h"

KIRQL wp_off()
{
	KIRQL  irql = KeRaiseIrqlToDpcLevel();
	UINT64  cr0 = __readcr0();
	cr0 &= 0xfffffffffffeffff;
	__writecr0(cr0);
	_disable();
	return  irql;
}

void wp_on(KIRQL irql)
{
	UINT64 cr0 = __readcr0();
	cr0 |= 0x10000;
	_enable();
	__writecr0(cr0);
	KeLowerIrql(irql);
}

void mem::write_ro(uintptr_t dst, uintptr_t src, size_t size) {
	KIRQL irql = wp_off();
	memcpy((void*)dst, (void*)src, size);
	wp_on(irql);
}
```

`Driver/Driver/mem.h`:

```h
namespace mem {
	void write_ro(uintptr_t dst, uintptr_t src, size_t size);
}
```

`Driver/Driver/nt.cpp`:

```cpp
#include "includes.h"

NTSTATUS nt::find_kernel_module(const char* moduleName, uintptr_t* moduleStart, size_t* moduleSize) {
	DWORD size = 0x0;
	ZwQuerySystemInformation(0xB, nullptr, size, reinterpret_cast<PULONG>(&size));

	auto listHeader = ExAllocatePool(NonPagedPool, size);

	if (!listHeader)
		return STATUS_MEMORY_NOT_ALLOCATED;


	if (const auto status = ZwQuerySystemInformation(0xB, listHeader, size, reinterpret_cast<PULONG>(&size))) {
		ExFreePoolWithTag(listHeader, 0);
		return status;
	}

	auto currentModule = reinterpret_cast<PSYSTEM_MODULE_INFORMATION>(listHeader)->Module;

	for (size_t i{}; i < reinterpret_cast<PSYSTEM_MODULE_INFORMATION>(listHeader)->Count; ++i, ++currentModule) {
		const auto currentModuleName = reinterpret_cast<const char*>(currentModule->FullPathName + currentModule->OffsetToFileName);
		if (!strcmp(moduleName, currentModuleName)) {
			*moduleStart = reinterpret_cast<uintptr_t>(currentModule->ImageBase);
			*moduleSize = currentModule->ImageSize;
			ExFreePoolWithTag(listHeader, 0);
			return STATUS_SUCCESS;
		}
	}
	ExFreePoolWithTag(listHeader, 0);
	return STATUS_NOT_FOUND;
}

NTSTATUS nt::find_export(const uintptr_t imageBase, const char* exportName, uintptr_t* functionPointer) {
	if (!imageBase)
		return STATUS_INVALID_PARAMETER_1;

	if (reinterpret_cast<PIMAGE_DOS_HEADER>(imageBase)->e_magic != 0x5A4D)
		return STATUS_INVALID_IMAGE_NOT_MZ;

	const auto ntHeader = reinterpret_cast<PIMAGE_NT_HEADERS64>(imageBase + reinterpret_cast<PIMAGE_DOS_HEADER>(imageBase)->e_lfanew);
	const auto exportDirectory = reinterpret_cast<PIMAGE_EXPORT_DIRECTORY>(imageBase + ntHeader->OptionalHeader.DataDirectory[0].VirtualAddress);
	if (!exportDirectory)
		STATUS_INVALID_IMAGE_FORMAT;

	const auto exportedFunctions = reinterpret_cast<DWORD*>(imageBase + exportDirectory->AddressOfFunctions);
	const auto exportedNames = reinterpret_cast<DWORD*>(imageBase + exportDirectory->AddressOfNames);
	const auto exportedNameOrdinals = reinterpret_cast<UINT16*>(imageBase + exportDirectory->AddressOfNameOrdinals);

	for (size_t i{}; i < exportDirectory->NumberOfNames; ++i) {
		const auto functionName = reinterpret_cast<const char*>(imageBase + exportedNames[i]);
		if (!strcmp(exportName, functionName)) {
			*functionPointer = imageBase + exportedFunctions[exportedNameOrdinals[i]];
			return STATUS_SUCCESS;
		}
	}

	return STATUS_NOT_FOUND;
}
```

`Driver/Driver/nt.h`:

```h
extern "C" {
	NTSTATUS NTAPI ZwQuerySystemInformation(_In_ ULONG SystemInformationClass, _Inout_ PVOID SystemInformation, _In_ ULONG SystemInformationLength, _Out_opt_ PULONG ReturnLength);
}

namespace nt {
	NTSTATUS find_kernel_module(const char* moduleName, uintptr_t* moduleStart, size_t* moduleSize);
	NTSTATUS find_export(const uintptr_t imageBase, const char* exportName, uintptr_t* functionPointer);
}

typedef struct _SYSTEM_MODULE_ENTRY {
	HANDLE Section;
	PVOID MappedBase;
	PVOID ImageBase;
	ULONG ImageSize;
	ULONG Flags;
	USHORT LoadOrderIndex;
	USHORT InitOrderIndex;
	USHORT LoadCount;
	USHORT OffsetToFileName;
	UCHAR FullPathName[256];
} SYSTEM_MODULE_ENTRY, * PSYSTEM_MODULE_ENTRY;

typedef struct _SYSTEM_MODULE_INFORMATION {
	ULONG Count;
	SYSTEM_MODULE_ENTRY Module[1];
} SYSTEM_MODULE_INFORMATION, * PSYSTEM_MODULE_INFORMATION;

typedef struct _IMAGE_DOS_HEADER {
	WORD   e_magic;
	WORD   e_cblp;
	WORD   e_cp;
	WORD   e_crlc;
	WORD   e_cparhdr;
	WORD   e_minalloc;
	WORD   e_maxalloc;
	WORD   e_ss;
	WORD   e_sp;
	WORD   e_csum;
	WORD   e_ip;
	WORD   e_cs;
	WORD   e_lfarlc;
	WORD   e_ovno;
	WORD   e_res[4];
	WORD   e_oemid;
	WORD   e_oeminfo;
	WORD   e_res2[10];
	LONG   e_lfanew;
} IMAGE_DOS_HEADER, * PIMAGE_DOS_HEADER;

typedef struct _IMAGE_DATA_DIRECTORY {
	DWORD   VirtualAddress;
	DWORD   Size;
} IMAGE_DATA_DIRECTORY, * PIMAGE_DATA_DIRECTORY;

typedef struct _IMAGE_OPTIONAL_HEADER64 {
	WORD        Magic;
	BYTE        MajorLinkerVersion;
	BYTE        MinorLinkerVersion;
	DWORD       SizeOfCode;
	DWORD       SizeOfInitializedData;
	DWORD       SizeOfUninitializedData;
	DWORD       AddressOfEntryPoint;
	DWORD       BaseOfCode;
	ULONGLONG   ImageBase;
	DWORD       SectionAlignment;
	DWORD       FileAlignment;
	WORD        MajorOperatingSystemVersion;
	WORD        MinorOperatingSystemVersion;
	WORD        MajorImageVersion;
	WORD        MinorImageVersion;
	WORD        MajorSubsystemVersion;
	WORD        MinorSubsystemVersion;
	DWORD       Win32VersionValue;
	DWORD       SizeOfImage;
	DWORD       SizeOfHeaders;
	DWORD       CheckSum;
	WORD        Subsystem;
	WORD        DllCharacteristics;
	ULONGLONG   SizeOfStackReserve;
	ULONGLONG   SizeOfStackCommit;
	ULONGLONG   SizeOfHeapReserve;
	ULONGLONG   SizeOfHeapCommit;
	DWORD       LoaderFlags;
	DWORD       NumberOfRvaAndSizes;
	IMAGE_DATA_DIRECTORY DataDirectory[16];
} IMAGE_OPTIONAL_HEADER64, * PIMAGE_OPTIONAL_HEADER64;

typedef struct _IMAGE_FILE_HEADER {
	WORD  Machine;
	WORD  NumberOfSections;
	DWORD TimeDateStamp;
	DWORD PointerToSymbolTable;
	DWORD NumberOfSymbols;
	WORD  SizeOfOptionalHeader;
	WORD  Characteristics;
} IMAGE_FILE_HEADER, * PIMAGE_FILE_HEADER;

typedef struct _IMAGE_NT_HEADERS64 {
	DWORD Signature;
	IMAGE_FILE_HEADER FileHeader;
	IMAGE_OPTIONAL_HEADER64 OptionalHeader;
} IMAGE_NT_HEADERS64, * PIMAGE_NT_HEADERS64;

typedef struct _IMAGE_EXPORT_DIRECTORY {
	DWORD   Characteristics;
	DWORD   TimeDateStamp;
	WORD    MajorVersion;
	WORD    MinorVersion;
	DWORD   Name;
	DWORD   Base;
	DWORD   NumberOfFunctions;
	DWORD   NumberOfNames;
	DWORD   AddressOfFunctions;
	DWORD   AddressOfNames;
	DWORD   AddressOfNameOrdinals;
} IMAGE_EXPORT_DIRECTORY, * PIMAGE_EXPORT_DIRECTORY;

typedef struct _IMAGE_SECTION_HEADER {
	BYTE  Name[8];
	union {
		DWORD PhysicalAddress;
		DWORD VirtualSize;
	} Misc;
	DWORD VirtualAddress;
	DWORD SizeOfRawData;
	DWORD PointerToRawData;
	DWORD PointerToRelocations;
	DWORD PointerToLinenumbers;
	WORD  NumberOfRelocations;
	WORD  NumberOfLinenumbers;
	DWORD Characteristics;
} IMAGE_SECTION_HEADER, * PIMAGE_SECTION_HEADER;
```

`EventCommunication.sln`:

```sln

Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio Version 16
VisualStudioVersion = 16.0.30517.126
MinimumVisualStudioVersion = 10.0.40219.1
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "Driver", "Driver\Driver\Driver.vcxproj", "{71AF30DA-F5FA-4C1B-902E-89D94589D80E}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "User", "User\User.vcxproj", "{40EFF6BB-65E9-4B32-BEED-E3274CC136A9}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|ARM = Debug|ARM
		Debug|ARM64 = Debug|ARM64
		Debug|x64 = Debug|x64
		Debug|x86 = Debug|x86
		Release|ARM = Release|ARM
		Release|ARM64 = Release|ARM64
		Release|x64 = Release|x64
		Release|x86 = Release|x86
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Debug|ARM.ActiveCfg = Debug|ARM
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Debug|ARM.Build.0 = Debug|ARM
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Debug|ARM.Deploy.0 = Debug|ARM
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Debug|ARM64.ActiveCfg = Debug|ARM64
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Debug|ARM64.Build.0 = Debug|ARM64
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Debug|ARM64.Deploy.0 = Debug|ARM64
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Debug|x64.ActiveCfg = Debug|x64
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Debug|x64.Build.0 = Debug|x64
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Debug|x64.Deploy.0 = Debug|x64
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Debug|x86.ActiveCfg = Debug|Win32
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Debug|x86.Build.0 = Debug|Win32
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Debug|x86.Deploy.0 = Debug|Win32
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Release|ARM.ActiveCfg = Release|ARM
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Release|ARM.Build.0 = Release|ARM
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Release|ARM.Deploy.0 = Release|ARM
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Release|ARM64.ActiveCfg = Release|ARM64
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Release|ARM64.Build.0 = Release|ARM64
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Release|ARM64.Deploy.0 = Release|ARM64
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Release|x64.ActiveCfg = Release|x64
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Release|x64.Build.0 = Release|x64
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Release|x64.Deploy.0 = Release|x64
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Release|x86.ActiveCfg = Release|Win32
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Release|x86.Build.0 = Release|Win32
		{71AF30DA-F5FA-4C1B-902E-89D94589D80E}.Release|x86.Deploy.0 = Release|Win32
		{40EFF6BB-65E9-4B32-BEED-E3274CC136A9}.Debug|ARM.ActiveCfg = Debug|Win32
		{40EFF6BB-65E9-4B32-BEED-E3274CC136A9}.Debug|ARM64.ActiveCfg = Debug|Win32
		{40EFF6BB-65E9-4B32-BEED-E3274CC136A9}.Debug|x64.ActiveCfg = Debug|x64
		{40EFF6BB-65E9-4B32-BEED-E3274CC136A9}.Debug|x64.Build.0 = Debug|x64
		{40EFF6BB-65E9-4B32-BEED-E3274CC136A9}.Debug|x86.ActiveCfg = Debug|Win32
		{40EFF6BB-65E9-4B32-BEED-E3274CC136A9}.Debug|x86.Build.0 = Debug|Win32
		{40EFF6BB-65E9-4B32-BEED-E3274CC136A9}.Release|ARM.ActiveCfg = Release|Win32
		{40EFF6BB-65E9-4B32-BEED-E3274CC136A9}.Release|ARM64.ActiveCfg = Release|Win32
		{40EFF6BB-65E9-4B32-BEED-E3274CC136A9}.Release|x64.ActiveCfg = Release|x64
		{40EFF6BB-65E9-4B32-BEED-E3274CC136A9}.Release|x64.Build.0 = Release|x64
		{40EFF6BB-65E9-4B32-BEED-E3274CC136A9}.Release|x86.ActiveCfg = Release|Win32
		{40EFF6BB-65E9-4B32-BEED-E3274CC136A9}.Release|x86.Build.0 = Release|Win32
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
	GlobalSection(ExtensibilityGlobals) = postSolution
		SolutionGuid = {147C134A-B4E3-412B-902E-381787440C0B}
	EndGlobalSection
EndGlobal

```

`README.md`:

```md
# EvCommunication
c Allah

```

`User/User.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Debug|Win32">
      <Configuration>Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|Win32">
      <Configuration>Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|x64">
      <Configuration>Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <VCProjectVersion>16.0</VCProjectVersion>
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{40eff6bb-65e9-4b32-beed-e3274cc136a9}</ProjectGuid>
    <RootNamespace>User</RootNamespace>
    <WindowsTargetPlatformVersion>10.0</WindowsTargetPlatformVersion>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>v142</PlatformToolset>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>v142</PlatformToolset>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>v142</PlatformToolset>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>v142</PlatformToolset>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <CharacterSet>MultiByte</CharacterSet>
    <SpectreMitigation>false</SpectreMitigation>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="ExtensionSettings">
  </ImportGroup>
  <ImportGroup Label="Shared">
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <PropertyGroup Label="UserMacros" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <LinkIncremental>true</LinkIncremental>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <LinkIncremental>false</LinkIncremental>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <LinkIncremental>true</LinkIncremental>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <LinkIncremental>false</LinkIncremental>
  </PropertyGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>WIN32;_DEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <IntrinsicFunctions>true</IntrinsicFunctions>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>WIN32;NDEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <EnableCOMDATFolding>true</EnableCOMDATFolding>
      <OptimizeReferences>true</OptimizeReferences>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>_DEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <IntrinsicFunctions>true</IntrinsicFunctions>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>NDEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
      <LanguageStandard>stdcpp17</LanguageStandard>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <EnableCOMDATFolding>true</EnableCOMDATFolding>
      <OptimizeReferences>true</OptimizeReferences>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemGroup>
    <ClCompile Include="main.cpp" />
  </ItemGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <ImportGroup Label="ExtensionTargets">
  </ImportGroup>
</Project>
```

`User/User.vcxproj.filters`:

```filters
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <Filter Include="Quelldateien">
      <UniqueIdentifier>{4FC737F1-C7A5-4376-A066-2A32D752A2FF}</UniqueIdentifier>
      <Extensions>cpp;c;cc;cxx;c++;cppm;ixx;def;odl;idl;hpj;bat;asm;asmx</Extensions>
    </Filter>
    <Filter Include="Headerdateien">
      <UniqueIdentifier>{93995380-89BD-4b04-88EB-625FBE52EBFB}</UniqueIdentifier>
      <Extensions>h;hh;hpp;hxx;h++;hm;inl;inc;ipp;xsd</Extensions>
    </Filter>
    <Filter Include="Ressourcendateien">
      <UniqueIdentifier>{67DA6AB6-F800-4c08-8B7A-83BB121AAD01}</UniqueIdentifier>
      <Extensions>rc;ico;cur;bmp;dlg;rc2;rct;bin;rgs;gif;jpg;jpeg;jpe;resx;tiff;tif;png;wav;mfcribbon-ms</Extensions>
    </Filter>
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="main.cpp">
      <Filter>Ressourcendateien</Filter>
    </ClCompile>
  </ItemGroup>
</Project>
```

`User/User.vcxproj.user`:

```user
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="Current" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup />
</Project>
```

`User/main.cpp`:

```cpp
#include <Windows.h>
#include <iostream>
struct Info {
	DWORD type;
};
static Info* test_stuff;
int main() {
	LoadLibraryA("user32.dll");
	HMODULE winlib = LoadLibraryA("win32u.dll");
	uintptr_t function = (uintptr_t)GetProcAddress(winlib, "NtTokenManagerCreateFlipObjectReturnTokenHandle");

	WCHAR user_event[0xFF] = L"\\BaseNamedObjects\\Global\\bruhmomentumuser";
	WCHAR kernel_event[0xFF] = L"\\BaseNamedObjects\\Global\\bruhmomentumkernel";

	HANDLE event_user = CreateEventW(NULL, FALSE, FALSE, &user_event[18]);
	HANDLE event_kernel = CreateEventW(NULL, FALSE, FALSE, &kernel_event[18]);

	test_stuff = new Info();
	test_stuff->type = 0xC0FFE;
	CreateThread(0, 0, (LPTHREAD_START_ROUTINE)function, test_stuff, 0, 0);
	WaitForSingleObject(event_kernel, 3 * 1000 * 60);
	printf("%x %x\n", event_user, event_kernel);


	test_stuff->type = 0x6969;
	SetEvent(event_user);
	WaitForSingleObject(event_kernel, 3 * 1000 * 60);

	test_stuff->type = 0x1337;
	SetEvent(event_user);
	WaitForSingleObject(event_kernel, 3 * 1000 * 60);

	test_stuff->type = 0x420;
	SetEvent(event_user);
	WaitForSingleObject(event_kernel, 3 * 1000 * 60);
	system("pause");
}
```