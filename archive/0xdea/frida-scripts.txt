Project Path: arc_0xdea_frida-scripts_p20oj4a5

Source Tree:

```txt
arc_0xdea_frida-scripts_p20oj4a5
├── CHANGELOG.md
├── LICENSE
├── README.md
├── android-snippets
│   ├── raptor_frida_android_bypass.js
│   ├── raptor_frida_android_debug.js
│   ├── raptor_frida_android_findClass1.js
│   ├── raptor_frida_android_findClass2.js
│   └── raptor_frida_android_lowlevel.js
├── ios-snippets
│   ├── raptor_frida_ios_autoIntercept.js
│   ├── raptor_frida_ios_bypass1.js
│   ├── raptor_frida_ios_bypass2.js
│   ├── raptor_frida_ios_call.js
│   ├── raptor_frida_ios_debug.js
│   ├── raptor_frida_ios_lowlevel1.js
│   ├── raptor_frida_ios_lowlevel2.js
│   ├── raptor_frida_ios_stalker.js
│   └── raptor_frida_ios_touchid.js
├── raptor_frida_android_enum.js
├── raptor_frida_android_trace.js
├── raptor_frida_ios_enum.js
├── raptor_frida_ios_trace.js
├── raptor_frida_linux_enum.js
└── raptor_frida_linux_trace.js

```

`CHANGELOG.md`:

```md
# Changelog for frida-scripts

All notable changes to this project are documented in this file.

## [Unreleased]

### Changed

* Improve documentation.

## [0.2] - 2025-10-02

New release of main scripts ported to Frida >= 17.

### Added

* Add Linux enumeration script.
* Add Linux trace script.
* Add CHANGELOG.md.

### Changed

* Improve documentation.

### Fixed

* Port iOS trace script to Frida 17.x.
* Port Android trace script to Frida 17.x.

## [0.1] - 2024-01-04

Historical battle-tested stable release that used to work before the [breaking changes](https://frida.re/news/2025/05/17/frida-17-0-0-released/) in Frida 17.x.

[unreleased]: https://github.com/0xdea/frida-scripts/compare/v0.2...HEAD

[0.2]: https://github.com/0xdea/frida-scripts/compare/v0.1...v0.2

[0.1]: https://github.com/0xdea/frida-scripts/releases/tag/v0.1

```

`LICENSE`:

```
MIT License

Copyright (c) 2017 Marco Ivaldi <raptor@0xdeadbeef.info>

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

```

`README.md`:

```md
# frida-scripts

[![](https://img.shields.io/github/stars/0xdea/frida-scripts.svg?style=flat&color=yellow)](https://github.com/0xdea/frida-scripts)
[![](https://img.shields.io/github/forks/0xdea/frida-scripts.svg?style=flat&color=green)](https://github.com/0xdea/frida-scripts)
[![](https://img.shields.io/github/watchers/0xdea/frida-scripts.svg?style=flat&color=red)](https://github.com/0xdea/frida-scripts)
[![](https://img.shields.io/badge/frida-17.3.2-violet)](https://www.frida.re/)
[![](https://img.shields.io/badge/twitter-%400xdea-blue.svg)](https://twitter.com/0xdea)
[![](https://img.shields.io/badge/mastodon-%40raptor-purple.svg)](https://infosec.exchange/@raptor)

A collection of my Frida.re instrumentation scripts to facilitate reverse engineering of mobile apps and more.

*Note: My iOS and Android scripts might require some tweakings. For a well-maintained project that includes some of my Frida scripts, refer to [Brida](https://github.com/federicodotta/Brida).*

![](https://raw.githubusercontent.com/0xdea/frida-scripts/master/.img/bin.jpg)

## Blog post  

* <https://web.archive.org/web/20200623001844/https://techblog.mediaservice.net/2017/09/tracing-arbitrary-methods-and-function-calls-on-android-and-ios/>

## See also

* <https://codeshare.frida.re/>

## Compatibility

* Tested with Frida 17.3.2

## Scripts

### iOS

* [**raptor_frida_ios_trace.js**](raptor_frida_ios_trace.js). Full-featured ObjC and Module tracer for iOS.
* [**raptor_frida_ios_enum.js**](raptor_frida_ios_enum.js). Collection of functions to enumerate ObjC classes and methods.
* [**ios-snippets/**](ios-snippets). Miscellaneous script snippets for iOS (tested with Frida before 17.0.0).

### Android

* [**raptor_frida_android_trace.js**](raptor_frida_android_trace.js). Full-featured Java and Module tracer for Android.
* [**raptor_frida_android_enum.js**](raptor_frida_android_enum.js). Collection of functions to enumerate Java classes and methods.
* [**android-snippets/**](android-snippets). Miscellaneous script snippets for Android (tested with Frida before 17.0.0).

### Linux

* [**raptor_frida_linux_trace.js**](raptor_frida_linux_trace.js). Full-featured function call tracer for Linux.
* [**raptor_frida_linux_enum.js**](raptor_frida_linux_enum.js). Collection of functions to enumerate modules and functions in a binary.

## Changelog

* [CHANGELOG.md](CHANGELOG.md)

## TODO

* Test extensively with real-world apps.
* Add Windows and macOS scripts.

```

`android-snippets/raptor_frida_android_bypass.js`:

```js
/*
 * raptor_frida_android_*.js - Frida snippets for Android
 * Copyright (c) 2017 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Frida.re JS script snippets for Android instrumentation.
 * See https://www.frida.re/ and https://codeshare.frida.re/
 * for further information on this powerful tool.
 *
 * "We want to help others achieve interop through reverse
 * engineering" -- @oleavr
 *
 * Many thanks to Maurizio Agazzini <inode@wayreth.eu.org>
 * and Federico Dotta <federico.dotta@mediaservice.net>.
 *
 * Example usage:
 * # frida -U -f com.xxx.yyy -l raptor_frida_android.js --no-pause
 */

setTimeout(function() { // avoid java.lang.ClassNotFoundException

	Java.perform(function() {

		// Root detection bypass example

		var hook = Java.use("com.target.utils.RootCheck");
		console.log("info: hooking target class");

		hook.isRooted.overload().implementation = function() {
			console.log("info: entered target method");
			
			// obtain old retval
			var retval = this.isRooted.overload().call(this);
			console.log("old ret value: " + retval);

			// set new retval
			var retnew = false;
			console.log("new ret value: " + retnew);
			return retnew;
		}

	});   

}, 0);

```

`android-snippets/raptor_frida_android_debug.js`:

```js
/*
 * raptor_frida_android_*.js - Frida snippets for Android
 * Copyright (c) 2017 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Frida.re JS script snippets for Android instrumentation.
 * See https://www.frida.re/ and https://codeshare.frida.re/
 * for further information on this powerful tool.
 *
 * "We want to help others achieve interop through reverse
 * engineering" -- @oleavr
 *
 * Many thanks to Maurizio Agazzini <inode@wayreth.eu.org>
 * and Federico Dotta <federico.dotta@mediaservice.net>.
 *
 * Example usage:
 * # frida -U -f com.xxx.yyy -l raptor_frida_android.js --no-pause
 */

setTimeout(function() { // avoid java.lang.ClassNotFoundException

	Java.perform(function() {

		// Debug some methods

		var CryptoUtils = Java.use("com.target.app.CryptoUtils");
		console.log("info: hooking class CryptoUtils");
		var PrefUtils = Java.use("com.target.app.PrefUtils");
		console.log("info: hooking class PrefUtils");

		CryptoUtils.decrypt.overload("java.lang.String").implementation = function(arg0) {
			console.warn("\n*** entered CryptoUtils.decrypt(java.lang.String arg0)");
			var retval = this.decrypt.overload("java.lang.String").call(this, arg0);
			console.log("\narg0: " + arg0);
			console.log("\nretval: " + retval);
			console.warn("\n*** exiting CryptoUtils.decrypt(java.lang.String arg0)");
			return retval;
		}

		CryptoUtils.decrypt.overload("java.lang.String", "java.lang.String").implementation = function(arg0, arg1) {
			console.warn("\n*** entered CryptoUtils.decrypt(java.lang.String arg0, java.lang.String arg1)");
			var retval = this.decrypt.overload("java.lang.String", "java.lang.String").call(this, arg0, arg1);
			console.log("\narg0: " + arg0);
			console.log("arg1: " + arg1);
			console.log("\nretval: " + retval);
			console.warn("\n*** exiting CryptoUtils.decrypt(java.lang.String arg0, java.lang.String arg1)");
			return retval;
		}

		// overload not really necessary here
		CryptoUtils.genIv.overload().implementation = function() {
			console.warn("\n*** entered CryptoUtils.genIv()");
			var retval = this.genIv.overload().call(this);
			console.log("\nretval: " + retval);
			console.warn("\n*** exiting CryptoUtils.genIv()");
			// XXX print IvParameterSpec | javax.crypto.spec.IvParameterSpec
			return retval;
		}

		// overload not really necessary here
		PrefUtils.saveUser.overload("java.util.List").implementation = function(arg0) {
			console.warn("\n*** entered PrefUtils.saveUser(java.util.List arg0)");
			var retval = this.saveUser.overload("java.util.List").call(this, arg0);
			console.log("\narg0: " + arg0);
			console.log("\nretval: " + retval);
			console.warn("\n*** exiting PrefUtils.saveUser(java.util.List arg0)");
			return retval;
		}

	});   

}, 0);

```

`android-snippets/raptor_frida_android_findClass1.js`:

```js
/*
 * raptor_frida_android_*.js - Frida snippets for Android
 * Copyright (c) 2017 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Frida.re JS script snippets for Android instrumentation.
 * See https://www.frida.re/ and https://codeshare.frida.re/
 * for further information on this powerful tool.
 *
 * "We want to help others achieve interop through reverse
 * engineering" -- @oleavr
 *
 * Many thanks to Maurizio Agazzini <inode@wayreth.eu.org>
 * and Federico Dotta <federico.dotta@mediaservice.net>.
 *
 * Example usage:
 * # frida -U -f com.xxx.yyy -l raptor_frida_android.js --no-pause
 */

// find loaded classes that match a pattern (sync)
function findClass(pattern)
{
	console.warn("\n*** finding all classes that match pattern: " + pattern + "\n");

	var allClasses = Java.enumerateLoadedClassesSync();
	allClasses.forEach(function(aClass) {
		if (aClass.match(pattern))
			console.log(aClass);
	});
}

// usage examples
setTimeout(function() { // avoid java.lang.ClassNotFoundException

	Java.perform(function() {

		//findClass();		// print all loaded classes
		//findClass("Root");	// print all classes that match a string
		//findClass(/root/i);	// print all classes that match a regex (e.g., case insensitive)

	});   

}, 0);

```

`android-snippets/raptor_frida_android_findClass2.js`:

```js
/*
 * raptor_frida_android_*.js - Frida snippets for Android
 * Copyright (c) 2017 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Frida.re JS script snippets for Android instrumentation.
 * See https://www.frida.re/ and https://codeshare.frida.re/
 * for further information on this powerful tool.
 *
 * "We want to help others achieve interop through reverse
 * engineering" -- @oleavr
 *
 * Many thanks to Maurizio Agazzini <inode@wayreth.eu.org>
 * and Federico Dotta <federico.dotta@mediaservice.net>.
 *
 * Example usage:
 * # frida -U -f com.xxx.yyy -l raptor_frida_android.js --no-pause
 */

// find loaded classes that match a pattern (async)
function findClass(pattern)
{
	console.warn("\n*** finding all classes that match pattern: " + pattern + "\n");

	Java.enumerateLoadedClasses({
		onMatch: function(aClass) {
			if (aClass.match(pattern))
				console.log(aClass);
		},
		onComplete: function() {}
	});
}

// usage examples
setTimeout(function() { // avoid java.lang.ClassNotFoundException

	Java.perform(function() {

		//findClass();		// print all loaded classes
		//findClass("Root");	// print all classes that match a string
		//findClass(/root/i);	// print all classes that match a regex (e.g., case insensitive)

	});   

}, 0);

```

`android-snippets/raptor_frida_android_lowlevel.js`:

```js
/*
 * raptor_frida_android_*.js - Frida snippets for Android
 * Copyright (c) 2017 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Frida.re JS script snippets for Android instrumentation.
 * See https://www.frida.re/ and https://codeshare.frida.re/
 * for further information on this powerful tool.
 *
 * "We want to help others achieve interop through reverse
 * engineering" -- @oleavr
 *
 * Many thanks to Maurizio Agazzini <inode@wayreth.eu.org>
 * and Federico Dotta <federico.dotta@mediaservice.net>.
 *
 * Example usage:
 * # frida -U -f com.xxx.yyy -l raptor_frida_android.js --no-pause
 */

setTimeout(function() { // avoid java.lang.ClassNotFoundException

	Java.perform(function() {
		
		// Low-level intercept and backtrace example

		Interceptor.attach(Module.findExportByName("/system/lib/libc.so", "open"), {

			onEnter: function(args) {

				// debug only the intended calls
				this.flag = false;
				// var filename = Memory.readCString(ptr(args[0]));
				// if (filename.indexOf("XYZ") === -1 && filename.indexOf("ZYX") === -1) // exclusion list
				// if (filename.indexOf("my.interesting.file") !== -1) // inclusion list
					this.flag = true;

				if (this.flag) {
					console.warn("\n*** entered open");

					var filename = Memory.readCString(ptr(args[0]));
					console.log("\nfile name: " + filename);

					// print backtrace
					console.log("\nBacktrace:\n" + Thread.backtrace(this.context, Backtracer.ACCURATE)
							.map(DebugSymbol.fromAddress).join("\n"));
				}
			},

			onLeave: function(retval) {

				if (this.flag) {
					// print retval
					console.log("\nretval: " + retval);
					console.warn("\n*** exiting open");
				}
			}

		});   

	});   

}, 0);

```

`ios-snippets/raptor_frida_ios_autoIntercept.js`:

```js
/*
 * raptor_frida_ios_*.js - Frida script snippets for iOS
 * Copyright (c) 2017 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Frida.re JS script snippets for iOS/ObjC instrumentation.
 * See https://www.frida.re/ and https://codeshare.frida.re/
 * for further information on this powerful tool.
 *
 * "We want to help others achieve interop through reverse
 * engineering" -- @oleavr
 *
 * Many thanks to Maurizio Agazzini <inode@wayreth.eu.org>
 * and Federico Dotta <federico.dotta@mediaservice.net>.
 *
 * Example usage:
 * # frida -U -f com.xxx.yyy -l raptor_frida_ios.js --no-pause
 */

// print arg/ret type
function printType(desc, arg)
{
	try {
		console.log(desc + ObjC.Object(arg).$class + " " + ObjC.Object(arg).$className);
	}
	catch(err) {
		// do nothing
	}
}

// print arg/ret value
function printValue(desc, arg)
{
	try {
		console.log(desc + ObjC.Object(arg));
	}
	catch(err) {
		console.log(desc + arg);
	}
}

// main interceptor
function autoIntercept(target)
{
	var className = target.match(/^[-+]\[(.*)\s/)[1];
	var methodType = target.match(/^([-+])/)[1];	
	var methodName = target.match(/^[-+]\[.*\s(.*)\]/)[1];
	var argCount = (methodName.match(/:/g) || []).length;

	console.log("\ninfo: trying to intercept", target);
	var oldImpl = ObjC.classes[className][methodType + " " + methodName];

	Interceptor.attach(oldImpl.implementation, {

		onEnter: function(args) {

			// debug only the intended calls
			this.flag = 0;
			//if (ObjC.Object(args[2]).toString() == "1234567890abcdef1234567890abcdef12345678")
				this.flag = 1;

			if (this.flag) {

				console.log("\n*** entered", target, "***");

				// print args
				for (var i = 0; i < argCount; i++) {
					printType("\narg " + (i + 1) + " type:\t", args[i + 2]);
					printValue("arg " + (i + 1) + " value:\t", args[i + 2]);
				}
			}
		},

		onLeave: function(retval) {

			if (this.flag) {

				// print retval
				printType("\nretval type:\t", retval);
				printValue("retval value:\t", retval);

				console.log("\n*** exiting", target, "***");
			}
		}

	});
}

if (ObjC.available) {

	// autoIntercept("-[CredManager setPassword:]");
	
} else {
 	send("error: Objective-C Runtime is not available!");
}

```

`ios-snippets/raptor_frida_ios_bypass1.js`:

```js
/* 
 * raptor_frida_ios_*.js - Frida script snippets for iOS
 * Copyright (c) 2017 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Frida.re JS script snippets for iOS/ObjC instrumentation.
 * See https://www.frida.re/ and https://codeshare.frida.re/
 * for further information on this powerful tool.
 *
 * "We want to help others achieve interop through reverse
 * engineering" -- @oleavr
 * 
 * Many thanks to Maurizio Agazzini <inode@wayreth.eu.org>
 * and Federico Dotta <federico.dotta@mediaservice.net>.
 *
 * Example usage:
 * # frida -U -f com.xxx.yyy -l raptor_frida_ios.js --no-pause
 */

if (ObjC.available) {

	// SSL pinning bypass: change retval, reimplementation technique

	var CertPinning = ObjC.classes.CertPinning;
	var getID = CertPinning["- getID:"];
	var getID_oldImpl = getID.implementation;

	getID.implementation = ObjC.implement(getID, function (handle, selector, arg1) {
		//return getID_oldImpl(handle, selector, arg1);
    		console.log("info: entered getID");
    		var retnew = ObjC.classes.NSString.stringWithString_("151f09ff42c55a4fcbae2246eb58f1d2f2168c0d");
		return retnew;
	});

} else {
 	send("error: Objective-C Runtime is not available!");
}

```

`ios-snippets/raptor_frida_ios_bypass2.js`:

```js
/*
 * raptor_frida_ios_*.js - Frida script snippets for iOS
 * Copyright (c) 2017 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Frida.re JS script snippets for iOS/ObjC instrumentation.
 * See https://www.frida.re/ and https://codeshare.frida.re/
 * for further information on this powerful tool.
 *
 * "We want to help others achieve interop through reverse
 * engineering" -- @oleavr
 *
 * Many thanks to Maurizio Agazzini <inode@wayreth.eu.org>
 * and Federico Dotta <federico.dotta@mediaservice.net>.
 *
 * Example usage:
 * # frida -U -f com.xxx.yyy -l raptor_frida_ios.js --no-pause
 */

if (ObjC.available) {

	// Jailbreak detection bypass: change retval, onLeave technique

	var hook = ObjC.classes.JailbreakChecks["- isJailbroken"];

	Interceptor.attach(hook.implementation, {

		onLeave: function(retval) {
			console.log("info: exiting isJailbroken");

			// read retval
			var obj = ObjC.Object(retval);
			console.log("retval type:", obj.$class, obj.$className);
			console.log("old retval value:", obj.toString());

			// change retval
			var retnew = ObjC.classes.NSString.stringWithString_("false");
			retval.replace(retnew);
			console.log("new retval value:", obj.toString());
		} 
	});

} else {
 	send("error: Objective-C Runtime is not available!");
}

```

`ios-snippets/raptor_frida_ios_call.js`:

```js
/*
 * raptor_frida_ios_*.js - Frida script snippets for iOS
 * Copyright (c) 2017 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Frida.re JS script snippets for iOS/ObjC instrumentation.
 * See https://www.frida.re/ and https://codeshare.frida.re/
 * for further information on this powerful tool.
 *
 * "We want to help others achieve interop through reverse
 * engineering" -- @oleavr
 *
 * Many thanks to Maurizio Agazzini <inode@wayreth.eu.org>
 * and Federico Dotta <federico.dotta@mediaservice.net>.
 *
 * Example usage:
 * # frida -U -f com.xxx.yyy -l raptor_frida_ios.js --no-pause
 */

if (ObjC.available) {

	// Call an Objective-C method with arbitrary parameters

	var oldImpl = ObjC.classes.MyClass["+ sendStrings:array:"];

	Interceptor.attach(oldImpl.implementation, {

		onEnter: function(args) {
			console.log("info: entered sendStrings");

			// 1st arg
			var obj = ObjC.Object(args[2]);
			console.log("args[2] type:", obj.$class, obj.$className);
			console.log("args[2] value:", obj.toString());

			// 2nd arg
			var obj = ObjC.Object(args[3]);
			console.log("args[3] type:", obj.$class, obj.$className);
			console.log("args[3] value:", obj.toString());

			// 2nd arg's contents (array)
			for (var i = 0; i < obj.count(); i++)
				console.log(ObjC.Object(obj.objectAtIndex_(i)).$class);
		},

		onLeave: function(retval) {
			console.log("info: exiting sendStrings");

			// retval
			var obj = ObjC.Object(retval);
			console.log("retval type:", obj.$class, obj.$className);
			console.log("retval value:", obj.toString());
		}

	});

	// build 1st arg (string)
	// "somestring"
	var arg1 = ObjC.classes.NSString.stringWithString_("somestring");

	// build 2nd arg (NSMutableArray)
	// (
	// "foo",
	// "bar",
	// "someotherstring"
	// )
	var arg2_1 = ObjC.classes.NSString.stringWithString_("foo");
	var arg2_2 = ObjC.classes.NSString.stringWithString_("bar");
	var arg2_3 = ObjC.classes.NSString.stringWithString_("someotherstring");
	var arg2 = ObjC.classes.NSMutableArray.alloc().init();
	arg2.addObject_(arg2_1);
	arg2.addObject_(arg2_2);
	arg2.addObject_(arg2_3);

	// call the target method
	var token = ObjC.classes.MyClass.sendStrings_array_(arg1, arg2);
	console.log(token.toString());

} else {
 	send("error: Objective-C Runtime is not available!");
}

```

`ios-snippets/raptor_frida_ios_debug.js`:

```js
/*
 * raptor_frida_ios_*.js - Frida script snippets for iOS
 * Copyright (c) 2017 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Frida.re JS script snippets for iOS/ObjC instrumentation.
 * See https://www.frida.re/ and https://codeshare.frida.re/
 * for further information on this powerful tool.
 *
 * "We want to help others achieve interop through reverse
 * engineering" -- @oleavr
 *
 * Many thanks to Maurizio Agazzini <inode@wayreth.eu.org>
 * and Federico Dotta <federico.dotta@mediaservice.net>.
 *
 * Example usage:
 * # frida -U -f com.xxx.yyy -l raptor_frida_ios.js --no-pause
 */

if (ObjC.available) {

	// Debug a method

	var oldImpl = ObjC.classes.KeychainManager["+ readKey:"];

	// console.log(ptr(oldImpl.implementation)); // DEBUG

	Interceptor.attach(oldImpl.implementation, {

		onEnter: function(args) {

			// debug only the intended calls
			this.flag = 0;
			//if (ObjC.Object(args[2]).toString() == "1234567890abcdef1234567890abcdef12345678")
				this.flag = 1;
			
			if (this.flag) {
				console.log("info: entered method");

				// 1st arg
				if (args[2]) {
					var obj = ObjC.Object(args[2]);
					console.log("args[2] type:", obj.$class, obj.$className);
					console.log("args[2] value:", obj.toString());
				}

				// 2nd arg
				if (args[3]) {
					var obj = ObjC.Object(args[3]);
					console.log("args[3] type:", obj.$class, obj.$className);
					console.log("args[3] value:", obj.toString());
				}
			}
		},

		onLeave: function(retval) {

			if (this.flag) {
				console.log("info: exiting method");

				// retval
				if (retval) {
					var obj = ObjC.Object(retval);
					console.log("retval type:", obj.$class, obj.$className);
					console.log("retval value:", obj.toString());
				}
			}
		}

	});

} else {
 	send("error: Objective-C Runtime is not available!");
}

```

`ios-snippets/raptor_frida_ios_lowlevel1.js`:

```js
/*
 * raptor_frida_ios_*.js - Frida script snippets for iOS
 * Copyright (c) 2017 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Frida.re JS script snippets for iOS/ObjC instrumentation.
 * See https://www.frida.re/ and https://codeshare.frida.re/
 * for further information on this powerful tool.
 *
 * "We want to help others achieve interop through reverse
 * engineering" -- @oleavr
 *
 * Many thanks to Maurizio Agazzini <inode@wayreth.eu.org>
 * and Federico Dotta <federico.dotta@mediaservice.net>.
 *
 * Example usage:
 * # frida -U -f com.xxx.yyy -l raptor_frida_ios.js --no-pause
 */

if (ObjC.available) {

	// Low-level intercept and binary data print example

	Interceptor.attach(Module.findExportByName("libSystem.B.dylib", "CCCrypt"), {

		onEnter: function(args) {
			console.log("\n*** entered CCCrypt ***");
			console.log("\nkey:");
			console.log(hexdump(ptr(args[3]), {
				offset:	0,
				length:	parseInt(args[4]),
				header:	true,
				ansi:	true
			}));
			console.log("\ndataIn:");
			console.log(hexdump(ptr(args[6]), {
				offset:	0,
				length:	parseInt(args[7]),
				header:	true,
				ansi:	true
			}));
			this.ret = args[8];
			this.retlen = args[9];
		},

		onLeave: function(retval) {
			console.log("\ndataOut:");
			console.log(hexdump(ptr(this.ret), {
				offset:	0,
				length:	parseInt(this.retlen),
				header:	true,
				ansi:	true
			}));
			console.log("\n*** exiting CCCrypt ***");
		}
	});

} else {
 	send("error: Objective-C Runtime is not available!");
}

```

`ios-snippets/raptor_frida_ios_lowlevel2.js`:

```js
/*
 * raptor_frida_ios_*.js - Frida script snippets for iOS
 * Copyright (c) 2017 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Frida.re JS script snippets for iOS/ObjC instrumentation.
 * See https://www.frida.re/ and https://codeshare.frida.re/
 * for further information on this powerful tool.
 *
 * "We want to help others achieve interop through reverse
 * engineering" -- @oleavr
 *
 * Many thanks to Maurizio Agazzini <inode@wayreth.eu.org>
 * and Federico Dotta <federico.dotta@mediaservice.net>.
 *
 * Example usage:
 * # frida -U -f com.xxx.yyy -l raptor_frida_ios.js --no-pause
 */

if (ObjC.available) {

	// Low-level intercept and backtrace example 

	Interceptor.attach(Module.findExportByName("libSystem.B.dylib", "open"), {

		onEnter: function(args) {

			// debug only the intended calls
			this.flag = 0;
			var filename = Memory.readCString(ptr(args[0]));

			//if (filename.indexOf("Bundle") == -1 && filename.indexOf("Cache") == -1) // exclusion list
			if (filename.indexOf("my.interesting.file") != -1) // inclusion list
				this.flag = 1;
			
			if (this.flag) {
 				console.log("\nopen called from:\n",
            				Thread.backtrace(this.context, Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join("\n"), 
						"\n");
				//console.log(filename); // DEBUG
			}
		}
	});

} else {
 	send("error: Objective-C Runtime is not available!");
}

```

`ios-snippets/raptor_frida_ios_stalker.js`:

```js
/*
 * raptor_frida_ios_*.js - Frida script snippets for iOS
 * Copyright (c) 2017 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Frida.re JS script snippets for iOS/ObjC instrumentation.
 * See https://www.frida.re/ and https://codeshare.frida.re/
 * for further information on this powerful tool.
 *
 * "We want to help others achieve interop through reverse
 * engineering" -- @oleavr
 *
 * Many thanks to Maurizio Agazzini <inode@wayreth.eu.org>
 * and Federico Dotta <federico.dotta@mediaservice.net>.
 *
 * Example usage:
 * # frida -U -f com.xxx.yyy -l raptor_frida_ios.js --no-pause
 */

// is stalker active?
var active = false;

// generic stalker
function stalk(pattern)
{
	var type = (pattern.indexOf(' ') === -1) ? 'module' : 'objc';
	var res = new ApiResolver(type);
	var matches = res.enumerateMatchesSync(pattern);
	var targets = uniqBy(matches, JSON.stringify);

	targets.forEach(function(target) {
		stalkFunction(target.address, target.name);
	});
}

// remove duplicates from array
function uniqBy(array, key) 
{
	var seen = {};
	return array.filter(function(item) {
		var k = key(item);
		return seen.hasOwnProperty(k) ? false : (seen[k] = true);
	});
}

// actual stalker function
function stalkFunction(impl, name)
{
	console.log("Stalking " + name);

	Interceptor.attach(impl, {

		onEnter: function(args) {

			// return if stalker is already active
			if (active)
				return;

			// initialize flag
			var flag = {};
			this.flag = flag;

			// activate stalker
			active = true;
			// console.warn("\n*** Stalker activated on " + name); // DEBUG

			Stalker.follow({

				events: {
					call:	true, 	// CALL instructions: yes please
					ret:	false, 	// RET instructions: no thanks
					exec:	false 	// all instructions: no thanks
				},

				// onReceive: function (events) { // TODO
					// Called with `events` containing a binary blob which is one or more
					// GumEvent structs.  See `gumevent.h` for the format. This is obviously a
					// terrible API that is subject to change once a better trade-off between
					// ease-of-use and performance has been found.
				// },

				onCallSummary: function (summary) {
					// Called with `summary` being a key-value mapping of call target to number
					// of calls, in the current time window. You would typically implement this
					// instead of `onReceive` for efficiency.
					console.log();
					Object.keys(summary).forEach(function (target) {
						console.log(name + " > " + DebugSymbol.fromAddress(ptr(target)).toString());
						flag[target] = true;
					});
				}

			});
		},

		onLeave: function(retval) {

			// return if no flag
			var flag = this.flag;
			if (flag === undefined)
				return;

			// deactivate stalker
			Stalker.unfollow();
			active = false;
			// console.warn("*** Stalker deactivated on " + name + "\n"); // DEBUG
		}

	});
}

// some examples
if (ObjC.available) {

	// stalk("*[OWSMessageSender *]"); // Signal
	// stalk("-[OWSMessageSender attemptToSendMessage*]"); // Signal
	// stalk("-[OWSMessageSender tag]"); // Signal
	// stalk("*[* *Password:*]");
	// stalk("exports:libSystem.B.dylib!open");
	// stalk("exports:*!open*");
	
} else {
 	send("error: Objective-C Runtime is not available!");
}

```

`ios-snippets/raptor_frida_ios_touchid.js`:

```js
/*
 * raptor_frida_ios_*.js - Frida script snippets for iOS
 * Copyright (c) 2017 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * Frida.re JS script snippets for iOS/ObjC instrumentation.
 * See https://www.frida.re/ and https://codeshare.frida.re/
 * for further information on this powerful tool.
 *
 * "We want to help others achieve interop through reverse
 * engineering" -- @oleavr
 *
 * Useful snippet ripped from @henryhoggard's Needle module
 * "hooking/frida/script_touch-id-bypass".
 *
 * Example usage:
 * # frida -U -f com.xxx.yyy -l raptor_frida_ios.js --no-pause
 * <IMPORTANT: afterwards tap "Cancel" in the Touch ID popup>
 */

if (ObjC.available) {

	/*
	 * method to hook:
	 * - (void)evaluatePolicy:(LAPolicy)policy 
       	 *        localizedReason:(NSString *)localizedReason 
	 *                  reply:(void (^)(BOOL success, NSError *error))reply;
	 */
	var hook = ObjC.classes.LAContext["- evaluatePolicy:localizedReason:reply:"];

	Interceptor.attach(hook.implementation, {

		onEnter: function(args) {
			console.log("info: hooking Touch ID");

			var block = new ObjC.Block(args[4]); // hook the reply callback
			var callback = block.implementation;
			block.implementation = function(error, value) {
				var reply = callback(1, null); // always return YES
				return reply;
			};
		}
	});

} else {
	send("error: Objective-C Runtime is not available!");
}

```

`raptor_frida_android_enum.js`:

```js
/*
 * raptor_frida_android_enum.js - Java class and method enumerator
 * Copyright (c) 2017-2025 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * "For all is like an ocean, all flows and connects; 
 * touch it in one place and it echoes at the other end of the world."
 *                        -- Fyodor Dostoevsky, The Brothers Karamazov
 * 
 * Frida.re JS code to enumerate Java classes and methods declared in an 
 * Android app. See https://www.frida.re/ and https://codeshare.frida.re/ for 
 * further information on this world-class dynamic instrumentation toolkit.
 *
 * Example usage:
 * $ uv tool install frida-tools
 * $ frida -U -f com.target.app -l raptor_frida_android_enum.js
 *
 * Tested with:
 * Frida 17.3.2 on macOS 15.6.1 with Redmi Note 10S (Android 11)
 *
 * Get the latest version at:
 * https://github.com/0xdea/frida-scripts/
 */

// Enumerate all Java classes
function enumAllClasses()
{
	var allClasses = [];
	var classes = Java.enumerateLoadedClassesSync();

	classes.forEach(function(aClass) {
		try {
			var className = aClass.match(/[L](.*);/)[1].replace(/\//g, ".");
		}
		catch(err) {return;} // Avoid TypeError: cannot read property 1 of null
		allClasses.push(className);
	});

	return allClasses;
}

// Find all Java classes that match a pattern
function findClasses(pattern)
{
	var allClasses = enumAllClasses();
	var foundClasses = [];

	allClasses.forEach(function(aClass) {
		try {
			if (aClass.match(pattern)) {
				foundClasses.push(aClass);
			}
		}
		catch(err) {} // Avoid TypeError: cannot read property 'match' of undefined
	});

	return foundClasses;
}

// Enumerate all methods declared in a Java class
function enumMethods(targetClass)
{
	var hook = Java.use(targetClass);
	var ownMethods = hook.class.getDeclaredMethods();
	hook.$dispose;

	return ownMethods;
}

/*
 * The following functions were not implemented because deemed impractical:
 *
 * enumAllMethods() - enumerate all methods declared in all Java classes
 * findMethods(pattern) - find all Java methods that match a pattern
 *
 * See raptor_frida_ios_enum.js for a couple of ObjC implementation examples.
 */

// Usage examples
setTimeout(function() { // Avoid java.lang.ClassNotFoundException

	Java.perform(function() {

		// enumerate all classes
		/*
		var a = enumAllClasses();
		a.forEach(function(s) { 
			console.log(s); 
		});
		*/

		// find classes that match a pattern
		/*
		var a = findClasses(/password/i);
		a.forEach(function(s) { 
			console.log(s); 
		});
		*/

		// enumerate all methods in a class
		/*
		var a = enumMethods("com.target.app.PasswordManager")
		a.forEach(function(s) { 
			console.log(s); 
		});
		*/

	});
}, 0);

```

`raptor_frida_android_trace.js`:

```js
/*
 * raptor_frida_android_trace.js - Java/Module tracer for Android
 * Copyright (c) 2017-2025 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * "Life is not like water. Things in life don't necessarily 
 * flow over the shortest possible route."
 *                                  -- Haruki Murakami, 1Q84
 * 
 * Frida.re JS code to trace arbitrary Java methods and Module functions calls
 * in an Android app for debugging and reverse engineering. See https://www.frida.re/ 
 * and https://codeshare.frida.re/ for further information on this world-class
 * dynamic instrumentation toolkit.
 *
 * Example usage:
 * $ uv tool install frida-tools
 * $ frida -U -f com.target.app -l raptor_frida_android_trace.js
 *
 * Tested with:
 * Frida 17.3.2 on macOS 15.6.1 with Redmi Note 10S (Android 11)
 * 
 * Thanks:
 * @inode-, @federicodotta, @leonjza, @dankluev
 *
 * Get the latest version at:
 * https://github.com/0xdea/frida-scripts/
 */

// Generic trace
function trace(pattern)
{
	var type = (pattern.toString().indexOf("!") === -1) ? "java" : "module";

	if (type === "module") {

		// trace Module
		var res = new ApiResolver("module");
		var matches = res.enumerateMatches(pattern);
		var targets = uniqBy(matches, JSON.stringify);
		targets.forEach(function(target) {
			traceModule(target.address, target.name);
		});

	} else if (type === "java") {

		// Trace Java class
		var found = false;
		Java.enumerateLoadedClasses({
			onMatch: function(aClass) {
				if (aClass.match(pattern)) {
					found = true;
					try {
						var className = aClass.match(/[L](.*);/)[1].replace(/\//g, ".");
					}
					catch(err) {return;} // Avoid TypeError: cannot read property 1 of null
					traceClass(className);
				}
			},
			onComplete: function() {}
		});

		// Trace Java method
		if (!found) {
			try {
				traceMethod(pattern);
			}
			catch(err) { // Catch non-existing classes/methods
				console.error(err);
			}
		}
	}
}

// Find and trace all methods declared in a Java class
function traceClass(targetClass)
{
	var hook = Java.use(targetClass);
	var methods = hook.class.getDeclaredMethods();
	hook.$dispose;

	var parsedMethods = [];
	methods.forEach(function(method) {
		parsedMethods.push(method.toString().replace(targetClass + ".", "TOKEN").match(/\sTOKEN(.*)\(/)[1]);
	});

	var targets = uniqBy(parsedMethods, JSON.stringify);
	targets.forEach(function(targetMethod) {
		traceMethod(targetClass + "." + targetMethod);
	});
}

// Trace a specific Java method
function traceMethod(targetClassMethod)
{
	var delim = targetClassMethod.lastIndexOf(".");
	if (delim === -1) return;

	var targetClass = targetClassMethod.slice(0, delim)
	var targetMethod = targetClassMethod.slice(delim + 1, targetClassMethod.length)

	var hook = Java.use(targetClass);
	var overloadCount = hook[targetMethod].overloads.length;

	console.log("Tracing " + targetClassMethod + " [" + overloadCount + " overload(s)]");

	for (var i = 0; i < overloadCount; i++) {

		hook[targetMethod].overloads[i].implementation = function() {
			console.warn("\n*** entered " + targetClassMethod);

			// Print backtrace
			// Java.perform(function() {
			//	var bt = Java.use("android.util.Log").getStackTraceString(Java.use("java.lang.Exception").$new());
			//	console.log("\nBacktrace:\n" + bt);
			// });   

			// Print args
			// TODO: double check this works without the occasional crash
			if (arguments.length) console.log();
			for (var j = 0; j < arguments.length; j++) {
				console.log("arg[" + j + "]: " + arguments[j]);
			}

			// Print retval
			var retval = this[targetMethod].apply(this, arguments); // Rare crash (Frida bug?)
			console.log("\nretval: " + retval);
			console.warn("\n*** exiting " + targetClassMethod);
			return retval;
		}
	}
}

// Trace Module functions
function traceModule(impl, name)
{
	console.log("Tracing " + name);

	Interceptor.attach(impl, {

		onEnter: function(args) {

			// Trace only intended calls
			this.flag = false;
			// var filename = args[0].readCString();
			// if (filename.indexOf("XYZ") === -1 && filename.indexOf("ZYX") === -1) // exclusion list
			// if (filename.indexOf("my.interesting.file") !== -1) // inclusion list
				this.flag = true;

			if (this.flag) {
				console.warn("\n*** entered " + name);

				// Print backtrace
				// TODO: understand why this crashes sometimes
				// console.log("\nBacktrace:\n" + Thread.backtrace(this.context, Backtracer.ACCURATE)
				// 		.map(DebugSymbol.fromAddress).join("\n"));
			}
		},

		onLeave: function(retval) {

			if (this.flag) {
				// Print retval
				console.log("\nretval: " + retval);
				console.warn("\n*** exiting " + name);
			}
		}

	});
}

// Remove duplicates from array
function uniqBy(array, key)
{
        var seen = {};
        return array.filter(function(item) {
                var k = key(item);
                return seen.hasOwnProperty(k) ? false : (seen[k] = true);
        });
}

// Usage examples
setTimeout(function() { // Avoid java.lang.ClassNotFoundException

	Java.perform(function() {

		// trace("com.target.utils.CryptoUtils.decrypt");
		// trace("android.os.storage.StorageVolume");
		// trace("com.target.utils.CryptoUtils");
		// trace("CryptoUtils");
		// trace(/crypto/i);
		// trace("exports:*!open*");

	});   
}, 0);

```

`raptor_frida_ios_enum.js`:

```js
/*
 * raptor_frida_ios_enum.js - ObjC class and method enumerator
 * Copyright (c) 2017-2025 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * "For all is like an ocean, all flows and connects; 
 * touch it in one place and it echoes at the other end of the world."
 *                        -- Fyodor Dostoevsky, The Brothers Karamazov
 *
 * Frida.re JS code to enumerate ObjC classes and methods declared in an
 * iOS app. See https://www.frida.re/ and https://codeshare.frida.re/ for 
 * further information on this world-class dynamic instrumentation toolkit.
 *
 * Example usage:
 * $ uv tool install frida-tools
 * $ frida -U -f com.target.app -l raptor_frida_ios_enum.js
 *
 * Tested with:
 * Frida 17.3.2 on macOS 15.6.1 with iPhone 8 (iOS 16.5 + https://palera.in/)
 * 
 * Get the latest version at:
 * https://github.com/0xdea/frida-scripts/
 */

// Enumerate all ObjC classes
function enumAllClasses()
{
	var allClasses = [];

	for (var aClass in ObjC.classes) {
		if (ObjC.classes.hasOwnProperty(aClass)) {
			allClasses.push(aClass);
		}
	}

	return allClasses;
}

// Find all ObjC classes that match a pattern
function findClasses(pattern)
{
	var allClasses = enumAllClasses();
	var foundClasses = [];

	allClasses.forEach(function(aClass) {
		if (aClass.match(pattern)) {
			foundClasses.push(aClass);
		}
	});

	return foundClasses;
}

// Enumerate all methods declared in an ObjC class
function enumMethods(targetClass)
{
	var ownMethods = ObjC.classes[targetClass].$ownMethods;

	return ownMethods;
}

// Enumerate all methods declared in all ObjC classes
function enumAllMethods()
{
	var allClasses = enumAllClasses();
	var allMethods = {}; 

	allClasses.forEach(function(aClass) {
		enumMethods(aClass).forEach(function(method) {
			if (!allMethods[aClass]) allMethods[aClass] = [];
			allMethods[aClass].push(method);
		});
	});

	return allMethods;
}

// Find all ObjC methods that match a pattern
function findMethods(pattern)
{
	var allMethods = enumAllMethods();
	var foundMethods = {};

	for (var aClass in allMethods) {
		allMethods[aClass].forEach(function(method) {
			if (method.match(pattern)) {
				if (!foundMethods[aClass]) foundMethods[aClass] = [];
				foundMethods[aClass].push(method);
			}
		});
	}

	return foundMethods;
}

// Usage examples
if (ObjC.available) {

	// Enumerate all classes
	/*
	var a = enumAllClasses();
	a.forEach(function(s) { 
		console.log(s); 
	});
	*/

	// Find classes that match a pattern
	/*
	var a = findClasses(/password/i);
	a.forEach(function(s) { 
		console.log(s); 
	});
	*/

	// Enumerate all methods in a class
	/*
	var a = enumMethods("PasswordManager")
	a.forEach(function(s) { 
		console.log(s); 
	});
	*/

	// Enumerate all available methods
	// TODO: understand why this doesn't work in script, but works in REPL
	/*
	var d = enumAllMethods();
	for (k in d) {
		console.log(k);
		d[k].forEach(function(s) {
			console.log("\t" + s);
		});
	}
	*/

	// Find methods that match a pattern
	// TODO: understand why this doesn't work in script, but works in REPL
	/*
	var d = findMethods(/password/i);
	for (k in d) {
		console.log(k);
		d[k].forEach(function(s) {
			console.log("\t" + s);
		});
	}
	*/

} else {
 	send("error: Objective-C Runtime is not available!");
}

```

`raptor_frida_ios_trace.js`:

```js
/*
 * raptor_frida_ios_trace.js - ObjC and Module tracer for iOS
 * Copyright (c) 2017-2025 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * "Life is not like water. Things in life don't necessarily 
 * flow over the shortest possible route."
 *                                  -- Haruki Murakami, 1Q84
 * 
 * Frida.re JS code to trace arbitrary ObjC methods and Module functions calls 
 * in an iOS app for debugging and reverse engineering. See https://www.frida.re/ 
 * and https://codeshare.frida.re/ for further information on this world-class
 * dynamic instrumentation toolkit.
 *
 * Example usage:
 * $ uv tool install frida-tools
 * $ frida -U -f com.target.app -l raptor_frida_ios_trace.js
 *
 * Tested with:
 * Frida 17.3.2 on macOS 15.6.1 with iPhone 8 (iOS 16.5 + https://palera.in/)
 * 
 * Thanks:
 * @inode-, @federicodotta, @mrmacete, @dankluev
 * 
 * Get the latest version at:
 * https://github.com/0xdea/frida-scripts/
 */

// Generic trace
// TODO: support the "swift" type
function trace(pattern)
{
	var type = (pattern.indexOf(" ") === -1) ? "module" : "objc";
	var res = new ApiResolver(type);
	var matches = res.enumerateMatches(pattern);
	var targets = uniqBy(matches, JSON.stringify);

	targets.forEach(function(target) {
		if (type === "objc")
			traceObjC(target.address, target.name);
		else if (type === "module")
			traceModule(target.address, target.name);
	});
}

// Remove duplicates from array
function uniqBy(array, key) 
{
	var seen = {};
	return array.filter(function(item) {
		var k = key(item);
		return seen.hasOwnProperty(k) ? false : (seen[k] = true);
	});
}

// Trace ObjC methods
function traceObjC(impl, name)
{
	console.log("Tracing " + name);

	Interceptor.attach(impl, {

		onEnter: function(args) {

			// Trace only the intended calls
			this.flag = 0;
			// if (ObjC.Object(args[2]).toString() === "1234567890abcdef1234567890abcdef12345678")
				this.flag = 1;

			if (this.flag) {
				console.warn("\n*** entered " + name);

				// Print full backtrace
				// console.log("\nBacktrace:\n" + Thread.backtrace(this.context, Backtracer.ACCURATE)
				//		.map(DebugSymbol.fromAddress).join("\n"));

				// Print caller
				console.log("\nCaller: " + DebugSymbol.fromAddress(this.returnAddress));

				// Print args
				if (name.indexOf(":") !== -1) {
					console.log();
					var par = name.split(":");
					par[0] = par[0].split(" ")[1];
					for (var i = 0; i < par.length - 1; i++)
						printArg(par[i] + ": ", args[i + 2]);
				}
			}
		},

		onLeave: function(retval) {

			if (this.flag) {
				// Print retval
				printArg("\nretval: ", retval);
				console.warn("\n*** exiting " + name);
			}
		}

	});
}

// Trace Module functions
function traceModule(impl, name)
{
	console.log("Tracing " + name);

	Interceptor.attach(impl, {

		onEnter: function(args) {

			// Trace only intended calls
			this.flag = 0;
			// var filename = args[0].readCString();
			// if (filename.indexOf("Bundle") === -1 && filename.indexOf("Cache") === -1) // exclusion list
			// if (filename.indexOf("my.interesting.file") !== -1) // inclusion list
				this.flag = 1;

			if (this.flag) {
				console.warn("\n*** entered " + name);

				// Print backtrace
				console.log("\nBacktrace:\n" + Thread.backtrace(this.context, Backtracer.ACCURATE)
						.map(DebugSymbol.fromAddress).join("\n"));
			}
		},

		onLeave: function(retval) {

			if (this.flag) {
				// Print retval
				printArg("\nretval: ", retval);
				console.warn("\n*** exiting " + name);
			}
		}

	});
}

// Print helper
// TODO: implement a safe way to print ObjC objects and especially NSStrings/CStrings
function printArg(desc, arg)
{
	/*
	try {
		console.log(desc + ObjC.Object(arg));
	}
	catch(err) {
		console.log(desc + arg);
	}
	*/
	console.log(desc + arg);
}

// Usage examples
if (ObjC.available) {

	// trace("-[CredManager setPassword:]");
	// trace("*[CredManager *]");
	// trace("*[* *Password:*]");
	// trace("exports:libSystem.B.dylib!CCCrypt");
	// trace("exports:libSystem.B.dylib!open");
	// trace("exports:*!open*");
	
} else {
 	send("error: Objective-C Runtime is not available!");
}

```

`raptor_frida_linux_enum.js`:

```js
/*
 * raptor_frida_linux_enum.js - Module/function enumerator
 * Copyright (c) 2025 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * "For all is like an ocean, all flows and connects; 
 * touch it in one place and it echoes at the other end of the world."
 *                        -- Fyodor Dostoevsky, The Brothers Karamazov
 *
 * Frida.re JS code to enumerate modules and functions present in a Linux ELF
 * binary. See https://www.frida.re/ and https://codeshare.frida.re/ for
 * further information on this world-class dynamic instrumentation toolkit.
 *
 * Example usage:
 * $ uv tool install frida-tools
 * $ frida -f hello-vuln -l raptor_frida_linux_enum.js --pause
 * 
 * Tested with:
 * Frida 17.2.1 on Ubuntu 24.0
 *
 * Get the latest version at:
 * https://github.com/0xdea/frida-scripts/
 */

// Enumerate all loaded modules
function enumAllModules()
{
	return Process.enumerateModules();
}

// Find all loaded modules that match a pattern
function findModules(pattern)
{
	var allModules = enumAllModules();
	var foundModules = [];

	allModules.forEach(function(aModule) {
		if (aModule.name.match(pattern)) {
			foundModules.push(aModule);
		}
	});

	return foundModules;
}

// Enumerate all functions using the `DebugSymbol` API
// NOTE: `Module.enumerateSymbols()` and `Module.findSymbolByName()` don't work
function enumAllFunctions()
{
	var allFunctions = [];

	for (const aFunction of DebugSymbol.findFunctionsMatching("*")) {
		allFunctions.push(DebugSymbol.fromAddress(ptr(aFunction)));
	}

	return allFunctions;
}

// Find all functions that match a glob using the `DebugSymbol` API
// NOTE: `Module.enumerateSymbols()` and `Module.findSymbolByName()` don't work
function findFunctions(glob)
{
	var foundFunctions = []

	for (const aFunction of DebugSymbol.findFunctionsMatching(glob)) {
		foundFunctions.push(DebugSymbol.fromAddress(ptr(aFunction)));
	}

	return foundFunctions;
}

// Enumerate all functions in a module using the `DebugSymbol` API
// NOTE: `Module.enumerateSymbols()` and `Module.findSymbolByName()` don't work
function enumModuleFunctions(moduleName)
{
	var moduleFunctions = [];

	for (const aFunction of enumAllFunctions()) {
		if (aFunction.moduleName === moduleName) {
			moduleFunctions.push(aFunction)
		}
	}

	return moduleFunctions;
}

// Enumerate the imports of a module
function enumModuleImports(moduleName)
{
	for (const aModule of enumAllModules()) {
		if (aModule.name === moduleName) {
			return aModule.enumerateImports();
		}
	}
}

// Enumerate the exports of a module
function enumModuleExports(moduleName)
{
	for (const aModule of enumAllModules()) {
		if (aModule.name === moduleName) {
			return aModule.enumerateExports();
		}
	}
}

// Usage examples

// Enumerate all modules
/*
var l = enumAllModules()
l.forEach(function(m) { 
	//console.log(m.base, m.size, m.name, m.path); 
	console.log(m.base, m.name, m.path); 
});
*/

// Find modules that match a pattern
/*
var l = findModules(/lib/i);
l.forEach(function(m) { 
	//console.log(m.base, m.size, m.name, m.path); 
	console.log(m.base, m.name, m.path); 
});
*/

// Enumerate all functions
/*
var l = enumAllFunctions()
l.forEach(function(f) { 
	//console.log(f.address, f.name, f.moduleName, f.fileName, f.lineNumber);
	console.log(f.toString());
});
*/

// Find functions that match a glob
/*
var l = findFunctions("*printf*");
l.forEach(function(f) {
	//console.log(f.address, f.name, f.moduleName, f.fileName, f.lineNumber);
	console.log(f.toString())
});
*/

// Enumerate all functions in a module
/*
var l = enumModuleFunctions("hello-vuln")
l.forEach(function(f) { 
	console.log(f); 
});
*/

// Enumerate the imports of a module
/*
var l = enumModuleImports("hello-vuln");
l.forEach(function(i) {
	console.log(i.name);
});
*/

// Enumerate the exports of a module
/*
var l = enumModuleExports("libc.so.6");
l.forEach(function(e) {
	console.log(e.name);
});
*/

```

`raptor_frida_linux_trace.js`:

```js
/*
 * raptor_frida_linux_trace.js - Function tracer for Linux
 * Copyright (c) 2025 Marco Ivaldi <raptor@0xdeadbeef.info>
 *
 * "Life is not like water. Things in life don't necessarily 
 * flow over the shortest possible route."
 *                                  -- Haruki Murakami, 1Q84
 *
 * Frida.re JS code to trace arbitrary function calls in a Linux ELF binary
 * for debugging and reverse engineering. See https://www.frida.re/ and
 * https://codeshare.frida.re/ for further information on this world-class
 * dynamic instrumentation toolkit.
 *
 * Example usage:
 * $ uv tool install frida-tools
 * $ frida -f hello-vuln -l raptor_frida_linux_trace.js
 * 
 * Tested with:
 * Frida 17.2.1 on Ubuntu 24.0
 *
 * Get the latest version at:
 * https://github.com/0xdea/frida-scripts/
 */

// Generic trace
function trace(pattern)
{
	var type = (pattern.toString().indexOf("!") === -1) ? "function" : "module";

	// Trace exported and imported functions of shared libraries
	if (type === "module") {
		var res = new ApiResolver("module");
		var matches = res.enumerateMatches(pattern);
		var targets = uniqBy(matches, JSON.stringify);

		targets.forEach(function(target) {
			traceFunction(target.address, target.name);
		});

	// Trace functions in the target binary
	} else if (type === "function") {
		var targets = []

		for (const f of DebugSymbol.findFunctionsMatching(pattern)) {
			targets.push(DebugSymbol.fromAddress(ptr(f)));
		}
		targets.forEach(function(target) {
			traceFunction(target.address, target.name);
		});
	}
}

// Trace a function call
function traceFunction(impl, name)
{
	console.log("Tracing " + name);

	Interceptor.attach(impl, {

		onEnter: function(args) {
			// Trace only the intended calls
      this.flag = 0;
      //if (args[0].readUtf8String().match("AAA"))
        this.flag = 1;

			if (this.flag) {
				console.warn("\n*** entered " + name);

				// Print full backtrace
				console.log("\nBacktrace:\n" + Thread.backtrace(this.context, Backtracer.ACCURATE)
					.map(DebugSymbol.fromAddress).join("\n"));

				// Print caller
				//console.log("\nCaller: " + DebugSymbol.fromAddress(this.returnAddress))

				// Print args (see https://frida.re/docs/javascript-api/#interceptor)
				//console.log();
				//console.log("arg1: " + args[0]);
				//console.log("arg2: " + args[1]);
				//console.log("arg3: " + args[2].readUtf8String());
				//console.log("arg4: " + args[3].readUtf8String());
			}
		},

		onLeave: function(retval) {
			if (this.flag) {
				// Print retval
				console.log("\nretval: " + retval);

				console.warn("\n*** exiting " + name);
			}
		}

	});
}

// Remove duplicates from an array
function uniqBy(array, key)
{
	var seen = {};
	return array.filter(function(item) {
		var k = key(item);
 		return seen.hasOwnProperty(k) ? false : (seen[k] = true);
 	});
}

// Usage examples

// Trace all imports
//trace("imports:*!*");

// Trace potential command injection sinks
//trace("imports:*!system");
//trace("imports:*!popen");

// Trace an export
//trace("exports:*!snprintf");

// Trace a function that matches a glob pattern
//trace("main")

```